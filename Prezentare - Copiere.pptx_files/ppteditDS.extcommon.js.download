'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1036:function(I,Y,d){I=d(0);var h;(function(n){n[n.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";n[n.peopleImageClassName=1]="peopleImageClassName";n[n.peopleImageClusterPath=4]="peopleImageClusterPath";n[n.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";n[n.imageDimension=6]="imageDimension";n[n.rtl=8]="rtl";n[n.pointerInputManager=9]="pointerInputManager";n[n.clickInputManager=
10]="clickInputManager";n[n.vertical=11]="vertical";n[n.zIndex=12]="zIndex";n[n.contextMenuInputManager=13]="contextMenuInputManager";n[n.imageDomElement=14]="imageDomElement";n[n.useIdleTooltip=15]="useIdleTooltip";n[n.viewportBoundsCallback=16]="viewportBoundsCallback";n[n.flipHorizontalDirection=17]="flipHorizontalDirection";n[n.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";n[n.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";n[n.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(I.b)("PresenceTooltipSettingKeys",h);d.d(Y,"a",function(){return e});class e{constructor(){this.Ny={}}get(n,m=null){n=h[n];return"number"===typeof m?(m=this.Ny[n])?Number.parseInvariant(m.toString()):0:this.Ny[n]}add(n,m){this.Ny[h[n]]=m}MD(n,m){h[n]in this.Ny||(this.Ny[h[n]]=m)}remove(n){delete this.Ny[h[n]]}}Object(I.a)(e,"PresenceTooltipSettings",null,[])},1141:function(I,Y,d){I=d(0);var h=d(387),e=d(14),n=d(237),m=d(238);class z{static s6d(F,sa,ia){return z.t6d(F,sa,ia,!0)}static t6d(F,
sa,ia,Na){const Ca=document.createElementNS(z.gmb,"svg");Ca.setAttribute("viewBox",String.format(z.sZd,z.Xuc,z.Wuc));Ca.appendChild(z.C$d(F,sa,ia,Na));return Ca}static C$d(F,sa,ia,Na){const Ca=z.Xuc/F,ha=sa/2*Ca,Ba=z.Wuc/2;let va=0;Na&&(va=(F-3*sa-4*ia)*Ca/2);F=document.createElementNS(z.gmb,"g");Sys.UI.DomElement.addCssClass(F,z.rZd);for(Na=1;3>=Na;Na++)F.appendChild(z.S5d(Na,ha,va+(Na*(sa+ia)-sa/2)*Ca,Ba));return F}static S5d(F,sa,ia,Na){const Ca=document.createElementNS(z.gmb,"circle");Sys.UI.DomElement.addCssClass(Ca,
String.format("{0}-{1}",z.WUd,F));Ca.setAttribute("cx",String.format("{0}",ia));Ca.setAttribute("cy",String.format("{0}",Na));Ca.setAttribute("r",String.format("{0}",sa));return Ca}}z.gmb="http://www.w3.org/2000/svg";z.rZd="prDancingDots";z.WUd="prAnimateCircle";z.sZd="0 0 {0} {1}";z.Wuc=40;z.Xuc=120;Object(I.a)(z,"ModernPresenceTooltipDancingDots",null,[]);var B=d(27),v=d(174),y=d(75),A=d(67),E=d(134),u=d(199),J=d(97),G=d(47),S=d(2);class P extends n.a{constructor(F,sa){super(F);this.RXb=this.gS=
this.u2a=this.gN=this.bN=this.$o=this.Ln=null;this.lI=sa.get(8,!1);this.dS=sa.get(6,0);this.cNd=sa.get(15,!1);this.Jc=sa;this.mSb=0;this.element=F;this.element.className=P.W8a;this.Ws=document.createElement("span");this.element.appendChild(this.Ws);this.oAd=z.s6d(sa.get(6,0),4,2);this.OJ(sa);this._state=5}bW(F){this.addHandler(m.a.kp,F)}g1(F){this.removeHandler(m.a.kp,F)}get user(){return this.RXb}get state(){return this._state}dispose(){this.element&&(this.Ln.yb(A.a.click,this.element,Object(e.a)(this,
this.onClick,"onClick")),this.Ln.yb(A.a.doubleClick,this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(A.a.pointerDown,this.element,Object(e.a)(this,this.ixa,"onPointerDown")),this.$o.yb(A.a.pointerOut,this.element,Object(e.a)(this,this.yz,"onPointerOut")),this.$o.yb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver")),this.bN.yb(this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}OJ(F){this.Ln=
F.get(10);this.Ln.pb(A.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.Ln.pb(A.a.doubleClick,this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"));this.$o=F.get(9);this.$o.pb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver"));this.$o.pb(A.a.pointerOut,this.element,Object(e.a)(this,this.yz,"onPointerOut"));this.$o.pb(A.a.pointerDown,this.element,Object(e.a)(this,this.ixa,"onPointerDown"));this.bN=F.get(13);this.bN.pb(this.element,
Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"))}hide(F=null,sa=0,ia=0){this.cNd&&F?this.BYe(F,sa,ia):(3===this.state&&this.noc(),this.visible=!1,this._state=5)}BYe(F,sa,ia=0){this.show(F,sa,15,4,void 0,ia)}krc(F,sa,ia,Na=!1,Ca=!1,ha=!1,Ba=0){this.show(F,sa,ia+20,Na?2:Ca?1:0,ha,Ba)}qYe(F,sa,ia,Na=!1,Ca=0){this.show(F,sa,ia+20,3,Na,Ca)}show(F,sa,ia,Na=3,Ca=!1,ha=0){!F||Na===this.state&&this.bce(sa,ia)||(this.gOd(Na,Ca,ha),this.Xx(F,Na,ha),this._state=Na,4===ha||0===ha&&!this.lI?
this.element.style.left=sa+"px":this.element.style.right=sa+"px",this.element.style.top=ia+"px",this.visible=!0)}Xx(F,sa,ia){this.RXb=F;J.a.Au(this.Ws);u.a.CFf(this.Ws);this.Ws.id="fly_"+F.clientId;this.Ws.style.backgroundColor=F.color;4!==sa?(this.Ws.style.height=this.dS+"px",this.Ws.style.lineHeight=this.dS+"px",u.a.JY(this.Ws,"border-radius",this.dS+"px")):4===ia||0===ia&&!this.lI?this.Ws.style.left="0px":this.Ws.style.right="0px";2!==sa&&(4===sa?J.a.Nx(this.Ws,""):1===sa?this.Ws.appendChild(this.oAd):
(this.Ws.setAttribute("dir","auto"),ia=G.a.K7d(F.userName,!1),(!F.isAnonymous||B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ia||0!==sa?(F=F.userName,0===sa&&(F=ia,u.a.JY(this.Ws,"text-align","center")),J.a.Nx(this.Ws,F)):(this.gN||(this.gN=this.vXd()),this.Ws.appendChild(this.gN),u.a.JY(this.Ws,"text-align","start"))))}onClick(F){if(0===this.state)return this.raiseEvent(m.a.kp,new m.a(1,F)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,
302,50,"User clicked on presence pill.");return!1}yz(F){3===this.state&&this.raiseEvent(m.a.kp,new m.a(3,F));return!1}cD(F){3!==F.Xf&&this.raiseEvent(m.a.kp,new m.a(2,F));return!1}ixa(F){if(3!==F.Xf)return!0;this.raiseEvent(m.a.kp,new m.a(4,F));return!1}vXd(){const F=document.createElement("img");F.src=v.a.XK("doughperson_white_glyph.svg");F.setAttribute("Unselectable","on");E.a.eP(F,E.a.ef,E.a.nN);return y.createClusteredImageFromClusterWithImageClass(this.dS,this.dS,null,null,P.e4d,"",!1,"",this.element.ownerDocument,
F)}gOd(F,sa=!1,ia=0){if(!this.Pka(this.state)||!this.Pka(F))switch(Sys.UI.DomElement.removeCssClass(this.element,this.u2a),this.state){case 4:3===F?this.mN(P.X8a,P.B4b):this.Pka(F)&&this.mN(P.V8a,P.B4b);break;case 3:4===F?this.mN(P.Z8a,P.A4b):this.Pka(F)&&(sa&&this.noc(),this.mN(P.V8a,P.A4b,sa?P.d4d:""));break;case 0:case 1:case 2:4===F?this.mN(P.Z8a,P.Y8a):3===F&&(sa&&this.tOd(),this.mN(P.X8a,P.Y8a,sa?P.C4b:"",3===ia?P.g4d:P.f4d));break;default:4===F?this.mN(P.Z8a):3===F?this.mN(P.X8a):this.Pka(F)&&
this.mN(P.V8a)}}mN(...F){this.u2a=F.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.u2a)}tOd(){this.mSb=window.setTimeout(()=>{this.element&&(this.gS=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.gS),this.element.style.zIndex="2",this.gS.style.zIndex="1")},300)}noc(){window.clearTimeout(this.mSb);this.gS&&(Sys.UI.DomElement.removeCssClass(this.gS,P.Y8a+" "+P.C4b),Sys.UI.DomElement.addCssClass(this.gS,P.c4d),S.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===
this.gS.parentNode&&this.element.parentNode.removeChild(this.gS)}),u.a.jKb(this.element,"z-index"))}Pka(F){return 0===F||1===F||2===F}bce(F,sa){const ia=u.a.FH(this.element.style.top);return u.a.FH(this.element.style.left)===F&&ia===sa}Rib(F){3===F&&u.a.$P(this.element,"left")?(F=u.a.FH(this.element.style.left),u.a.jKb(this.element,"left"),this.element.style.right=-1*F+"px"):4===F&&u.a.$P(this.element,"right")&&(F=u.a.FH(this.element.style.right),u.a.jKb(this.element,"right"),this.element.style.left=
-1*F+"px")}}P.W8a="prModernFlyout UIFont";P.Z8a="flyoutIdle";P.X8a="flyoutExpanded";P.V8a="flyoutCollapsed";P.B4b="flyoutFromIdle";P.A4b="flyoutFromExpanded";P.Y8a="flyoutFromCollapsed";P.C4b="flyoutStacked";P.d4d="flyoutFromStacked";P.c4d="flyoutFadeOut";P.e4d="cui-img-cont-float cui-img-20by20";P.f4d="flyoutLtrDir";P.g4d="flyoutRtlDir";Object(I.a)(P,"ModernPresenceTooltipFlyoutControl",n.a,[]);class Q{constructor(F,sa,ia=2,Na=4){this.offsetTop=F;this.offsetLeft=sa;this.Puc=ia;this.c8b=Na}}Object(I.a)(Q,
"FlyoutsPositioningInfo",null,[]);var D=d(65);class O{constructor(F=!1,sa=!1){this.Vi=F;this.a3a=sa}S7d(F,sa,ia,Na,Ca,ha,Ba){const va=Ba.y,ta=Ba.height;var Fa=this.K5d(ha);const pa=Fa+sa;Ca=F*ia+(F-1)*Ca;ia=null;1===F||this.WTd(Fa,Ca,va,ta)?F=new Q(0,0,2):(F=this.Q3d(pa,Ca,va,ta),F.offsetTop-=Fa);this.a3a?ia=new Q(0,0,void 0,this.Vi?4:3):(ha=this.J5d(ha,Ba),Fa=Math.max(0,Ba.x),Ba=Ba.width,sa=ha+sa,this.XTd(ha,Na,Fa,Ba)?ia=new Q(0,0,void 0,this.Vi?3:4):this.YTd(sa,Na,Fa)&&(ia=new Q(0,0,void 0,this.Vi?
4:3)),ia||(ia=this.P3d(ha,sa,Fa,Ba)));return new Q(F.offsetTop,ia.offsetLeft,F.Puc,ia.c8b)}K5d(F){return D.a.uRc(F)}J5d(F,sa){return this.Vi?sa.width-D.a.WZf(F):D.a.tRc(F)}WTd(F,sa,ia,Na){return F+sa<=ia+Na}Q3d(F,sa,ia,Na){let Ca=1,ha=Math.max(ia,F-sa);sa>F-ia&&(Ca=2,ha=sa<Na?Na-sa:ia);return new Q(ha,0,Ca)}XTd(F,sa,ia,Na){return F+sa<=ia+Na}YTd(F,sa,ia){return sa<=F-ia}P3d(F,sa,ia,Na){Na-sa>=F-ia?F=4:(sa=F,F=3);return new Q(0,sa,void 0,F)}}Object(I.a)(O,"ModernPresenceTooltipPositioner",null,[]);
class X{constructor(F,sa,ia,Na,Ca,ha,Ba){this.Yv=F;this._parent=sa;this.XQb=ia;this.Nyd=Na;this.uCd=Ca;this.E7=ha;this.lI=Ba;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(F,sa){if(3!==F)if(5!==F&&this.Yv&&this.Yv.length){if(4===F){var ia=this.uCd;var Na=(this.E7-ia)/2;this.element.style.height=this.E7+"px";this.element.style.width=this.E7+"px";F=u.a.FH(this.Yv[0].element.style.top);sa=u.a.FH(this.lI?this.Yv[0].element.style.right:
this.Yv[0].element.style.left)}else ia=this.XQb,Na=(this.E7-ia)/2,this.element.style.height=this.E7+"px",this.element.style.width=this.Z5d()+2*Na+"px",F=u.a.FH(this.Yv[this.Yv.length-1].element.style.top),sa=this.KTd(this.Yv[this.Yv.length-1].element,ia,sa);u.a.JY(this.element,"border-radius",this.E7+"px");this.element.style.top=F-Na-ia+"px";this.lI?this.element.style.right=sa-Na+"px":this.element.style.left=sa-Na+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&
this.element.parentNode.removeChild(this.element)}KTd(F,sa,ia){return this.lI&&!ia?u.a.FH(F.style.right):this.lI||ia?this.lI&&ia?-u.a.FH(F.style.left)-sa:-u.a.FH(F.style.right)-sa:u.a.FH(F.style.left)}Z5d(){return this.Yv&&this.Yv.length?this.XQb+Math.min(this.Yv.length-1,2)*this.Nyd:0}}Object(I.a)(X,"ModernPresenceTooltipTarget",null,[]);var N=d(71),aa=d(118),V=d(201);class ca extends n.a{constructor(F,sa,ia){super(F);this.x7=this.eI=this.nTb=this.vZ=!1;this.Df=[];this.AAa={};this.Jc=ia;this.Vi=
ia.get(8,!1);this.$Sb=ia.get(15,!1);this.xzd=ia.get(12,0);this.KS=ia.get(6,0);this.f5a=sa;this.TXb=ia.get(16);this.a3a=ia.get(17,!1);this.wCd=ia.get(19,!1);this.uId=ia.get(20,!1);this.GAa=0;this.oId=new O(this.Vi,this.a3a);this.Rga=this.s5b();this.x4a=!1;this.YM=[];this.wha=[];this.element.id=ca.i9a();this.element.className=n.a.aub("prControl",this.Vi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Vi;this.Djb(sa);this.iF=this.createElement("div");this.iF.className="prFlyoutContainer";
this.element.appendChild(this.iF);this.Yv=[];this.lS=new X(this.ft,this.element,this.KS,4,6,32,this.Vi);this.$o=ia.get(9);this.$o.pb(A.a.pointerDown,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.pb(A.a.pointerOver,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.pb(A.a.pointerOut,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"))}get Khb(){return V.a.clone(this.Df)}get ft(){return this.Yv}get defaultZIndex(){return this.xzd}get FN(){return this.ft?this.ft.length:
0}get lV(){return 0<this.FN?this.ft[0].state:5}get Fab(){return 3===this.lV&&!this.vZ}bW(F){this.addHandler(m.a.kp,F)}g1(F){this.removeHandler(m.a.kp,F)}dispose(){if(this.Fab)this.x4a=!0;else{if(this.ft)for(const F of this.ft)F.g1(Object(e.a)(this,this.fG,"onInteractivityChanged")),aa.a.Kx(F);this.Yv=null;this.$o.yb(A.a.pointerDown,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.yb(A.a.pointerOver,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.yb(A.a.pointerOut,
this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));super.dispose()}}iga(){this.XZ();this.visible=!0}skb(){this.visible=!0;this.L3b();this.vZ=!0}Lya(){this.skb()}hide(){this.ooc();this.ON();this.lS.update(this.lV,this.x7)}Xx(F){const sa=this.lV,ia=this.vZ;F.clientId||(F.clientId=(ca.Cha++).toString());if(F.clientId in this.AAa){var Na=this.bT(F.clientId);if(0<=Na){Na=this.Df[Na];if(Na.color===F.color&&Na.userName===F.userName)return;this.RJ(F.clientId)}}this.hide();Na=new P(this.createElement("div"),
this.Jc);Na.bW(Object(e.a)(this,this.fG,"onInteractivityChanged"));this.iF.insertBefore(Na.element,this.iF.firstChild);this.AAa[F.clientId]=Na;Array.add(this.Df,F);Array.add(this.ft,Na);this.wuc(sa,ia);this.visible=!0}RJ(F){if(this.Fab)Array.add(this.wha,F);else{var sa=this.lV,ia=this.vZ;this.hide();this.hoa(F);this.wuc(sa,ia)}}qgb(F){const sa=this.bT(F);if(!(0>=sa)){var ia=this.Df[sa];F=this.AAa[F];Array.removeAt(this.Df,sa);Array.insert(this.Df,0,ia);Array.removeAt(this.ft,sa);Array.insert(this.ft,
0,F);this.iF.removeChild(F.element);this.iF.appendChild(F.element);this.XZ()}}wuc(F,sa){0>=this.Df.length?this.hide():3===F&&sa?this.skb():this.iga()}Zjb(F,sa){sa?this.$Nd(F):this.hoc(F)}F3b(F){if(this.Fab&&this.wCd)return!1;F=ca.X9a(F);if(this.iF!==F&&J.a.mua(this.iF,F))return!0;for(const sa of this.ft)if(J.a.mua(sa.element,F))return!0;return!1}position(F,sa){this.element.style.top=sa+"px";this.element.style.left=F+"px"}XZ(F=!1){if(!F||this.eI){this.nTb&&this.hqc(!0);var sa=Math.min(3,this.FN)-1;
F=0;var ia=1,Na=0;this.x7&&(F=this.Rga,ia=-1,Na=-this.KS);for(let Ca=this.FN-1;Ca>sa;Ca--)this.ft[Ca].krc(this.Df[Ca],-4*sa*ia+Na,0,!0,!1,!0,F);for(;0<=sa;sa--)this.ft[sa].krc(this.Df[sa],-4*sa*ia+Na,0,0<sa,Array.contains(this.YM,this.Df[sa].clientId),sa!==this.GAa,F);this.GAa=0;this.lS.update(0,this.x7);this.zIndex=this.defaultZIndex;this.vZ=!1;this.ooc(0);this.x4a&&this.dispose()}}L3b(){this.nTb&&this.hqc(!1);this.zIndex=this.defaultZIndex+1;let F,sa,ia;({offsetX:sa,offsetY:F,b8b:ia}=this.EVe());
for(let Na=0;Na<this.FN;Na++)this.ft[Na].qYe(this.Df[Na],sa,F+(this.KS+2)*Na,Na!==this.GAa,ia)}ON(){let F=0,sa=0;this.x7&&(F=this.Rga,sa=-6);for(let ia=0;ia<this.FN;ia++)this.ft[ia].hide(this.Df[ia],sa,F);this.zIndex=this.defaultZIndex;this.visible=this.vZ=!1;this.x4a&&this.dispose()}l7a(F=0){F?(this.eI=!0,S.Task.delay(F).continueWith(()=>{this.$Sb?this.Ece():this.XZ(!0);this.eI=!1})):this.$Sb?this.hide():this.XZ()}Ece(){this.eI&&this.hide()}rSd(){if(B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.o9&&
N.c()){const F=appChrome.selectors.getShyState();return F.isActive&&0!==F.state}return!1}fG(F,sa){F=this.lV;this.rSd()||2!==sa.type&&(4!==sa.type||3===F)?4===sa.type&&3===F?(this.eI&&(this.eI=!1),this.l7a()):3!==sa.type||3!==F||this.vZ||(1<this.FN?(this.eI=!0,S.Task.delay(250).continueWith(()=>{this.XZ(!0);this.eI=!1})):this.l7a()):(this.eI&&(this.eI=!1),3!==F&&(this.L3b(),3===sa.Xi.Xf&&this.l7a(2E3)));this.raiseEvent(m.a.kp,sa)}daa(F){3===F.Xf?this.fG(this,new m.a(4,F)):F.eventName===A.a.pointerOver?
this.fG(this,new m.a(2,F)):F.eventName===A.a.pointerOut&&this.fG(this,new m.a(3,F));return!1}Djb(F){this.element.style.width=F+"px";this.element.style.height=this.KS+"px"}hoa(F){this.hoc(F);F=this.bT(F);if(!(0>F)){var sa=this.Df[F];Array.removeAt(this.Df,F);delete this.AAa[sa.clientId];sa=this.ft[F];this.iF.removeChild(sa.element);this.Jc.get(18,!1)&&sa.g1(Object(e.a)(this,this.fG,"onInteractivityChanged"));Array.removeAt(this.ft,F);sa.dispose()}}ooc(F=5){if(this.wha.length){this.visible&&this.ON();
for(let sa=0;sa<this.wha.length;sa++)this.hoa(this.wha[sa]);Array.clear(this.wha);0>=this.Df.length||5===F?this.hide():0===F&&this.iga()}}bT(F){for(let sa=0;sa<this.Df.length;sa++)if(this.Df[sa].clientId===F)return sa;return-1}$Nd(F){if(-1===this.bT(F))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.YM,F)){if(this.Df[0].clientId===F)return;Array.remove(this.YM,F)}Array.add(this.YM,F);this.qgb(F);1!==this.lV&&this.XZ()}}hoc(F){-1===
this.bT(F)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.YM,F)&&(Array.remove(this.YM,F),this.Df[0].clientId===F&&0<this.YM.length&&this.qgb(this.YM[this.YM.length-1]),this.Df[0].clientId===F&&1===this.lV&&this.XZ())}hqc(F){F?Sys.UI.DomElement.addCssClass(this.iF,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.iF,"prBackgroundSelection")}EVe(){let F,sa;sa=F=0;var ia=this.Rga;if(this.TXb){const Na=this.TXb(this);if(!Na)return{offsetX:F,
offsetY:sa,b8b:ia};const Ca=4===this.lV;ia=this.oId.S7d(this.FN,Ca?6:this.KS,this.KS,150,2,this.element,Na);sa=ia.offsetTop;this.GAa=this.J7d(ia.Puc,ia.offsetTop);ia=ia.c8b;ia!==this.Rga&&(this.Rib(ia),this.element.dir=3===ia?"rtl":"ltr",this.Rga=ia);ia!==this.s5b()?(F=this.uId?-2:Ca?-6:-this.KS,this.x7=!0):this.x7=!1}return{offsetX:F,offsetY:sa,b8b:ia}}J7d(F,sa){if(1===F)return this.FN-1;F=Math.abs(sa);return 0<F?F/(this.KS+2):0}Rib(F){for(let sa=0;sa<this.FN;sa++)this.ft[sa].Rib(F)}s5b(){return this.Vi?
3:4}static i9a(){return String.format("{0}-{1}","presencetooltip",ca.Cha++)}static X9a(F){return F.qc.rawEvent.relatedTarget}}ca.Cha=0;Object(I.a)(ca,"ModernPresenceTooltipControl",n.a,[487,106]);var fa=d(225),ma=d(289),da=d(267);d.d(Y,"a",function(){return qa});class qa{constructor(F){this.Jc=F;this.Jc.MD(10,fa.a.instance);this.Jc.MD(9,da.a.instance);this.Jc.MD(6,20);this.Jc.MD(13,ma.a.instance);this.Jc.MD(17,!1)}zLc(F,sa){this.Jc.MD(15,!1);return new ca(F,sa,this.Jc)}Ttb(F){this.Jc.MD(15,!1);return new ca(F,
20,this.Jc)}}Object(I.a)(qa,"ModernPresenceTooltipFactory",null,[486])},1246:function(I,Y,d){d.r(Y);I=d(0);var h=d(346),e=d(70),n=d(437),m=d(1200),z=d(75);class B{constructor(Ha){this.qe=Ha}MXd(Ha,Ya,Ka,Pa,Oa,oa){const Xa=this.qe.qk(Ka+".png");Ka=z.getImageClassWithCluster(Ka,Pa);return z.createClusteredImageFromClusterWithImageClass(Ha,Ya,Ka,Xa,32===Ha&&32===Ya?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,Oa,null,oa)}}Object(I.a)(B,"ShapeGlyphImageFactory",null,[400]);
var v=d(447),y=d(68);class A{constructor(Ha,Ya){this.n5c=this.h0=null;this.wre=this.iGg=0;this.Le=Ha;this.Kc=Ya}dispose(){this.clear();this.h0.parentNode.removeChild(this.h0)}add(Ha,Ya){this.oVe(!1);Ha=this.i6h(Ha,Ya);this.kNj()||this.LUj(Ha)?this.nVe(-1*(Math.ceil(Ha.offsetWidth)+2)):this.nVe(this.wre);this.oVe(!0)}clear(){this.Le.Au(this.n5c);this.oVe(!1);this.nVe(0)}Sia(Ha,Ya,Ka){this.iGg=Ka;this.wre=Ya;this.h0=this.Le.Ie();this.h0.className="prFlyout UISmallFont";Ha.appendChild(this.h0);this.n5c=
this.Le.E1b();this.h0.appendChild(this.n5c)}i6h(Ha,Ya){const Ka=this.Le.iKf();Ka.style.backgroundColor=Ha;Ka.style.lineHeight=this.Le.Pc(this.iGg);this.Le.Nx(Ka,Ya);this.n5c.appendChild(Ka);return Ka}LUj(Ha){Ha=this.Le.$h(Ha);const Ya=this.Le.$h(this.Kc.Ic.JB);return Ha.x+Ha.width+this.wre>Ya.x+Ya.width}kNj(){return 0>this.Le.Fn(this.h0.style.left)}oVe(Ha){this.h0.style.visibility=Ha?y.a.visible:y.a.hidden}nVe(Ha){this.h0.style.left=this.Le.Pc(Ha)}}Object(I.a)(A,"ShapePawnFlyout",null,[451]);var E=
d(692),u=d(1036),J=d(1141),G=d(27),S=d(14),P=d(330),Q=d(28),D=d(49),O=d(116);class X{constructor(Ha,Ya,Ka,Pa,Oa){this.h_b=1;this.Agc=[];this.zcb=null;this.zcc=this.uEb=!1;this.HXa=this.hi=this.iu=null;(this.Hv=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))?(this.hi=Ha,this.HXa=Oa,this.MFi()):this.kr=Object(m.a)(v.a,Pa.tYd(Ha,Ya,Ka,Object(S.a)(this,this.cD,"onPointerOver"),Object(S.a)(this,this.yz,"onPointerOut"),Oa))}M8(){if(this.Hv)return this.Lfj();const Ha=Array.clone(this.Kfa);
if(this.vW){let Ya=!1;for(const Ka of this.Kfa)if(Ka.clientId===this.vW.clientId){Ya=!0;break}Ya||Array.add(Ha,this.vW)}return Ha}dispose(){this.Hv?this.ANi():(this.Agc=this.zcb=null,this.kr.dispose())}Xx(Ha){if(this.Hv)this.k8h(Ha);else if(Ha){for(const Ya of this.Kfa)if(Ya.clientId===Ha.clientId)return;Array.add(this.Kfa,Ha);this.refresh()}}RJ(Ha){if(this.Hv)this.FXk(Ha);else if(Ha)for(const Ya of this.Kfa)if(Ya.clientId===Ha.clientId){Array.remove(this.Kfa,Ya);this.refresh();break}}clear(){this.Hv?
this.Ysi():(this.Agc=[],this.kr.clear())}get vW(){return this.zcb}set vW(Ha){this.zcb!==Ha&&(this.zcb=Ha,this.zcb||(this.zcc=!1),this.Hv||this.refresh())}pYe(){this.Hv||(this.vW?(this.zcc=!0,this.VJb()):Q.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}QYe(){this.Hv?this.Xll():(this.uEb=!0,this.zcb&&(this.zcc=!0),this.VJb())}wce(){this.Hv?this.rzj():(this.uEb=!1,this.VJb())}setZIndex(Ha){this.Hv?this.dfl(Ha):this.kr.setZIndex(Ha)}get Dfa(){return this.vW?
this.vW.color:this.Kfa&&this.Kfa.length?this.Kfa[this.Kfa.length-1].color:O.a.none}LVc(){return!!this.zcb||0<this.Agc.length}get Kfa(){return this.Hv?this.iu.Khb:this.Agc}hzj(){this.kr.FKb();this.kr.qtb()}yz(){this.LVc()&&(this.uEb=!1,this.VJb());return!0}cD(){this.LVc()&&(this.uEb=!0,this.VJb());return!0}JDl(){this.LVc()?this.kr.God(1<this.Agc.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.Dfa):this.kr.Ura()}refresh(){this.JDl();this.VJb()}VJb(){this.hzj();if(this.uEb)if(this.vW){this.kr.Z5a(this.vW.color,
String.format(ResourceStrings.l_TypingHint,this.vW.userName));for(const Ha of this.Kfa)this.vW.clientId!==Ha.clientId&&this.kr.Z5a(Ha.color,Ha.userName)}else for(const Ha of this.Kfa)this.kr.Z5a(Ha.color,Ha.userName);else this.zcc&&(this.vW?this.kr.Z5a(this.vW.color,String.format(ResourceStrings.l_TypingHint,this.vW.userName)):Q.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.uEb||this.zcc)&&this.kr.Jic()}Zjb(Ha,Ya){this.iu&&
this.iu.Zjb(Ha,Ya)}ANi(){this.iu&&this.iu.dispose()}WLe(){return D.a.$h(document.body)}k8h(Ha){Ha?this.iu?(Q.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",Ha.clientId),this.iu.Xx(Ha)):Q.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):Q.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}FXk(Ha){Ha?this.iu?(Q.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",
Ha.clientId),this.iu.RJ(Ha.clientId)):Q.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):Q.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}Ysi(){if(this.iu){Q.a.J(42472543,814,50,"ShapePresencePawn:Clear at PresencePawn ");var Ha=this.M8();if(Ha)for(const Ya of Ha)this.RJ(Ya);else Q.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else Q.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}Lfj(){return this.iu?
this.iu.Khb:null}Xll(){this.iu&&(this.iu.iga(),this.iu.Lya())}rzj(){this.iu&&this.iu.iga()}dfl(Ha){this.hi.style.zIndex=String(Ha)}Hmj(Ha){const Ya=new u.a;Ya.add(0,z.getImageClassWithCluster(G.AFrameworkApplication.PN,"MoreUsersGlyph_16x16x32"));Ya.add(5,G.AFrameworkApplication.rm);Ya.add(1,z.getImageClassWithCluster(G.AFrameworkApplication.PN,"DoughboyWhiteGlyph_20x20x32"));Ya.add(4,G.AFrameworkApplication.rm);Ya.add(6,20);Ya.add(8,G.AFrameworkApplication.isRtl);Ya.add(12,Ha);Ya.add(11,!1);Ya.add(16,
Object(S.a)(this,this.WLe,"presenceViewportBoundsCallback"));return new J.a(Ya)}MFi(){this.iu=this.Hmj(this.G3f()).Ttb(this.hi);Sys.UI.DomElement.addCssClass(this.iu.element,"ShapePawnContainer")}Jti(){const Ha=this.M8();if(Ha)for(const Ya of Ha)this.Zjb(Ya.clientId,!1)}G3f(){return this.h_b+P.a.jba+P.a.jba}Jic(){this.HXa.xa.style.zIndex=String(this.G3f())}}Object(I.a)(X,"ShapePresencePawn",null,[448,449,106,398]);var N=d(689);class aa{constructor(Ha,Ya,Ka,Pa,Oa){this.qp=Ha;this.Zc=Ya;this.Le=Ka;
this.hIa=Pa;this.Kc=Oa}DGi(Ha,Ya,Ka,Pa){this.Le.addCssClass(Ha,"ShapeModernCatchupPawnContainer");return new N.a(Ha,Ya,"pegal",this,Ka,Pa)}BGi(Ha,Ya,Ka){this.Le.addCssClass(Ha,"ShapePawnContainer");return new X(Ha,Ya,"per",this,Ka)}tYd(Ha,Ya,Ka,Pa,Oa,oa){return new v.a(Ha,Ya,Ka,Pa,Oa,null,this,this.hIa,this.Le,this.qp,this.Zc,oa)}ZKf(){return new A(this.Le,this.Kc)}$Kf(){return new E.a(this.Le)}}Object(I.a)(aa,"ShapePawnFactory",null,[399]);var V=d(55),ca=d(582),fa=d(132),ma=d(167),da=d(58),qa=d(60),
F=d(642),sa=d(138),ia=d(169),Na=d(188),Ca=d(187);class ha{constructor(Ha,Ya,Ka,Pa,Oa,oa=16){this.jBg=!1;this.tn=null;this.Cdb=!1;this.wic=this.yB=this.xB=0;this.vd=1;this.rdc=!1;this.Eb=this.Ubc=!0;this.iA=!1;this.eU=!0;this.lse=!1;this.bU=oa;this.iIa=new sa.a;this.X_=new Na.a;this.vx=new ia.a;this.XF=new ia.a;this.rH=new ia.a;this.R4=new sa.a;this.wE=new Ca.a;this.mu=new Ca.a;this.ob=Ha;this.kr=Ya?Ya(this.R4.xa,this.bU,Oa):null;this.ta=Ka;this.K9=Pa}dispose(){this.K9();this.iIa&&(this.iIa.xa.parentNode&&
this.iIa.zq(),this.X_&&this.X_.viewport&&this.X_.viewport.zq(),this.vx&&this.vx.zq(),this.XF&&this.XF.zq(),this.rH&&this.XF.zq());this.kr&&this.kr.dispose();this.R4=this.rH=this.XF=this.vx=this.X_=this.iIa=null;this.Eb=!1}get Hsh(){return this.kr}get shape(){return this.ta}get qab(){return this.jBg}set qab(Ha){this.bU=Ha?20:16;this.jBg=Ha}get akg(){return this.Cdb}set akg(Ha){this.bU=16;this.Cdb=Ha}Jm(Ha){this.iIa.appendChild(this.X_.viewport);this.iIa.appendChild(this.R4);this.vx.OE(O.a.none);this.Cdb?
this.vx.mr(qa.a.WWe):this.vx.mr(qa.a.ZWe);this.XF.OE(O.a.none);this.XF.mr(F.a.sKc);this.rH.OE(O.a.none);this.rH.mr(F.a.WVd);this.X_.appendChild(this.rH);this.X_.appendChild(this.XF);this.X_.appendChild(this.vx);this.setVisibility();this.gQf();Ha.appendChild(this.iIa)}lD(){}Yp(){return this.X_.Yp()}azb(){return!1}Ox(){}setVisibility(){const Ha=this.Eb&&(!this.iA||!this.eU);this.R4.Qd(Ha);this.vx.Qd(Ha);this.XF.Qd(Ha);this.rH.Qd(Ha);this.iIa.Qd(this.Eb)}Ty(){}cE(){return null}GB(){return[]}gQf(){this.tn=
this.ta.fp.copy();this.vx.mr(this.lse?F.a.cHf:this.Cdb?qa.a.WWe:qa.a.ZWe);this.XF.mr(F.a.sKc);this.rH.mr(F.a.WVd);this.Xr();this.setVisibility()}draw(){this.visible=!0;this.gQf()}get visible(){return this.Eb}set visible(Ha){this.Eb!==Ha&&(this.Eb=Ha,this.setVisibility(),this.Xr())}get msb(){return this.Ubc}set msb(Ha){this.Ubc=Ha;this.vx.Qd(this.Eb&&this.Ubc);this.XF.Qd(this.Eb&&this.Ubc);this.rH.Qd(this.Eb&&this.Ubc)}setPosition(Ha,Ya){this.xB=Ha;this.yB=Ya;this.Xr()}Ij(Ha){this.vd=Ha;this.Xr()}Qq(Ha){this.wE=
Ha;this.Xr()}Xu(Ha){this.mu=Ha;this.Xr()}setZIndex(Ha){this.wic=Ha;this.iIa.LB(this.wic);this.X_.LB(this.wic);this.R4.LB(this.wic);this.kr&&this.kr.setZIndex(this.wic)}NE(Ha,Ya){this.iA=Ha;this.eU=Ya;this.setVisibility()}$Ob(Ha=null){this.kr&&this.vx.Yu(Ha||this.kr.Dfa);this.vx&&(this.vx.Goa(""),this.vx.OE(O.a.none),this.Cdb?this.vx.mr(qa.a.WWe):this.vx.mr(qa.a.ZWe),this.vx.JY(""))}Vsi(){this.vx&&this.XF&&this.rH&&(this.lse=!1,this.vx.JY(""),this.XF.JY(""),this.vx.Yu(O.a.none),this.vx.Cya(0),this.XF.Yu(O.a.none),
this.XF.Cya(0),this.rH.Yu(O.a.none),this.rH.Cya(0))}m4e(Ha,Ya=!1){if(this.vx&&this.XF&&this.rH){this.lse=!0;var Ka=0===Ha;this.vx.mr(F.a.cHf);this.XF.mr(2===Ha?F.a.Pvi:F.a.sKc);this.rH.mr(F.a.WVd);this.vx.Yu(Ka?O.a.none:F.a.Nvi);this.XF.Yu(Ka?O.a.none:F.a.Jvi);switch(Ha){case 2:this.rH.Yu(F.a.Mvi);break;case 1:this.rH.Yu(F.a.Kvi);break;default:this.rH.Yu(F.a.Lvi)}1===Ha?this.JUf():Ya?this.JUf():(this.vx.Cya(1),this.XF.Cya(1),this.rH.Cya(1))}}JUf(){this.KUf(0)}KUf(Ha){this.vx&&this.XF&&this.rH&&!(1<
Ha)&&(Ha+=.05,this.vx.Cya(Ha),this.XF.Cya(Ha),this.rH.Cya(Ha),window.setTimeout(()=>{this.KUf(Ha)},10))}Xr(){if(this.tn){var Ha=this.tn.copy();this.wE.El(Ha);this.mu.El(Ha);Ha.move(this.xB,this.yB);Ha.scale(this.vd,this.vd);this.vCl(Ha);this.NEl(Ha)}}vCl(Ha){if(this.vx&&this.XF&&this.rH&&Ha){var Ya=this.mCf(F.a.Ovi,Ha),Ka=this.mCf(F.a.sKc,Ya);this.rH.zt(Ka.points);this.X_.Rl();this.rH.Qd(this.Eb&&(!this.iA||!this.eU));this.XF.zt(Ya.points);this.X_.Rl();this.XF.Qd(this.Eb&&(!this.iA||!this.eU));this.vx.zt(Ha.points);
this.X_.Rl();this.vx.Qd(this.Eb&&(!this.iA||!this.eU));V.a.Vab&&this.ta&&this.ta.ud&&this.ob.ogg()&&this.X_.viewport.lh(this.X_.viewport.width,0)}}ajc(){if(this.qab){var Ha=this.R4.x,Ya=this.R4.y;this.ob.fX(this.ta)&&!this.rdc&&(this.R4.setPosition(Ha,Ya-18),this.rdc=!0)}}NEe(){if(this.qab){var Ha=this.R4.x,Ya=this.R4.y;this.rdc&&!this.ob.fX(this.ta)&&(this.R4.setPosition(Ha,Ya+18),this.rdc=!1)}}mCf(Ha,Ya){var Ka=Ya.rk(ma.a.DE),Pa=Ya.rk(ma.a.Qu);Ka=ca.a.YO(da.a.MG(Pa,Ka));new da.a(0,0);let Oa;new da.a(0,
0);let oa;new da.a(0,0);new da.a(0,0);Ya.rotate(-Ka);const Xa=Ya.points;Pa=new da.a(Xa[0]._x+Ha,Xa[0]._y+Ha);Oa=new da.a(Xa[1]._x-Ha,Xa[1]._y+Ha);oa=new da.a(Xa[2]._x-Ha,Xa[2]._y-Ha);Ha=new da.a(Xa[3]._x+Ha,Xa[3]._y-Ha);Ha=new fa.a(Pa,Oa,oa,Ha);Ha.rotate(Ka);Ya.rotate(Ka);return Ha}NEl(Ha){if(Ha){var Ya=Ha.rk(ma.a.DE),Ka=Ha.rk(ma.a.Qu),Pa=ca.a.YO(da.a.MG(Ka,Ya));Ya=Ha.rk(ma.a.DE);Ka=Ha.rk(ma.a.Qu);90<=Pa&&(Ya=Ha.rk(ma.a.Qu),Ka=Ha.rk(ma.a.PH));180<=Pa&&(Ya=Ha.rk(ma.a.PH),Ka=Ha.rk(ma.a.VE));270<=Pa&&
(Ya=Ha.rk(ma.a.VE),Ka=Ha.rk(ma.a.DE));Pa=da.a.MG(Ka,Ya);var Oa=this.hfj(Pa);Ha=Math.cos(Pa)*Oa;Pa=Math.sin(Pa)*Oa;Oa=this.qab?this.bU/2-1:this.Cdb?this.bU/2:this.bU;this.Cdb?this.R4.setPosition(Ka.x-Oa,Ka.y-Oa):this.R4.setPosition(Ya.x-Ha,Ya.y-Pa-Oa);this.R4.Qd(this.Eb&&(!this.iA||!this.eU));this.qab&&(this.rdc=!1,this.ajc())}}hfj(Ha){return(this.qab?10:15)-ca.a.YO(Ha)/6}}Object(I.a)(ha,"ShapePawnView",null,[447]);class Ba{uYd(Ha,Ya,Ka,Pa,Oa){return new ha(Ha,Ya,Ka,Pa,Oa,16)}}Object(I.a)(Ba,"ShapePawnViewFactory",
null,[401]);class va extends Sys.EventArgs{constructor(Ha){super();this.shape=Ha}}Object(I.a)(va,"ShapeViewElementPresenceStateChangedEventArgs",Sys.EventArgs,[]);class ta{constructor(Ha,Ya){this.Ag=Ha;this.ta=this.Ag.shape;this.ta.As=!1;this.ltg=new va(this.ta);this.aj=Object(m.a)(X,this.Ag.Hsh);this.NWg=Ya;(this.hxg=G.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.Ag&&(this.Ag.qab=!0)}Jm(Ha){this.Ag.Jm(Ha)}lD(Ha){this.Ag.lD(Ha)}Yp(){return this.Ag.Yp()}LN(Ha){return this.Ag.azb(Ha)}Ox(Ha){this.Ag.Ox(Ha)}ajc(){this.Ag.ajc()}NEe(){this.Ag.NEe()}dispose(){this.Ag.dispose()}Ty(){this.Ag.Ty()}cE(Ha){return this.Ag.cE(Ha)}GB(Ha){return this.Ag.GB(Ha)}draw(Ha,
Ya){this.Ag.draw(Ha,Ya)}get visible(){return this.Ag.visible}set visible(Ha){this.Ag.visible=Ha}setPosition(Ha,Ya){this.Ag.setPosition(Ha,Ya)}Ij(Ha){this.Ag.Ij(Ha)}Qq(Ha){this.Ag.Qq(Ha)}Xu(Ha){this.Ag.Xu(Ha)}setZIndex(Ha){this.Ag.setZIndex(Ha)}NE(Ha,Ya){this.Ag.NE(Ha,Ya)}setSelection(){}yia(Ha){Ha&&(this.bQa(),this.aj.Xx(Ha),this.Ag.$Ob(),this.Ag.setVisibility(),Q.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",Ha.clientId,this.aj.Dfa,
this.ta?this.ta.Er:"null_moniker"))}i_a(Ha){if(Ha&&this.aj){this.aj.RJ(Ha);this.Ag.$Ob();var Ya=this.aj.M8();Ya&&Ya.length?Q.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",Ha.clientId,this.aj.Dfa,this.ta?this.ta.Er:""):Q.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",Ha.clientId,this.ta?this.ta.Er:"null_moniker");this.Ag.setVisibility();
this.XBa()}}wFf(){this.aj.clear();this.Ag.$Ob();this.XBa()}pYe(){this.aj.pYe()}Yjl(){this.aj.QYe()}t_(){this.aj.wce()}Pud(Ha){Ha&&this.bQa();this.aj&&(this.aj.vW=Ha);this.Ag.$Ob();this.hxg&&this.aj&&(this.aj.vW?this.aj.Zjb(Ha.clientId,!0):this.aj.Jti());Ha||this.XBa()}get Jhb(){return this.aj}get Zbe(){return this.aj.LVc()}get msb(){return this.Ag.msb}set msb(Ha){this.Ag.msb=Ha}bQa(){this.ta.As||this.Zbe||(this.ta.As=!0,this.NWg.Ceh(this.ltg))}XBa(){this.ta.As&&!this.Zbe&&(this.ta.As=!1,this.NWg.Ceh(this.ltg))}}
Object(I.a)(ta,"ShapePresenceView",null,[429,430,431,106]);var Fa=d(280);class pa{get name(){return"PowerPointWebEditor.ShapePresence"}Zb(Ha){Ha.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().oa(()=>new Fa.a((Ya,Ka)=>{let Pa=null;const Oa=Object(m.a)(117,Ya.sc(Ha.resolve("Box4.IPageView").Ma));Oa&&!Oa.Al&&(Ya=Ha.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").uYd(Ha.resolve("PowerPointWebEditor.IPptSelectionManager"),
(oa,Xa,Hb)=>Object(m.a)(398,Ha.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").BGi(oa,Xa,Hb)),Ya,Ka,Oa.SU),Pa=new ta(Ya,Ha.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),Pa.Jm(Oa.SU),Oa.rra(Pa,1),Pa.visible=Oa.BQ||Oa.Un);return Pa}));Ha.register(399,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().oa(()=>new aa(Ha.resolve("Common.IPointerInputManager"),Ha.resolve("Common.IClickInputManager"),Ha.resolve("PowerPoint.IBrowserHelperManager"),Ha.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
Ha.resolve("PowerPointWebEditor.IActiveSlideViewManager")));Ha.register(400,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().oa(()=>new B(Ha.resolve("PowerPoint.IPathManager")));Ha.register(401,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().oa(()=>new Ba)}init(){}dispose(){}static main(){e.a.instance.Dc(new pa)}}Object(I.a)(pa,"PPTWebEditorShapePresencePackage",null,[2,3]);class ka{constructor(){this.K=null;this.OX=[new pa]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}Zb(Ha){this.K=
Ha;for(const Ya of this.OX)Ya.Zb(Ha)}init(){for(const Ha of this.OX)Ha.init();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").pig=!0;h.a.instance.ic(n.a.j2d,(new Date).getTime())}dispose(){}static main(){h.a.instance.ic(n.a.l2d,(new Date).getTime());e.a.instance.Dc(new ka)}}Object(I.a)(ka,"PptExtCommonPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.ShapePresence");Type.registerNamespace("Common.App.CollabControls");ka.main();
pa.main()},237:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=
String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Px(){return!0}static aub(e,n){return e+(n?"Rtl":"")}}Object(I.a)(h,"BasePresenceControl",d.a,[106,484])},238:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n){super();this.type=e;this.Xi=n}}h.kp="InteractivityChanged";Object(I.a)(h,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},280:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(1019);class e{constructor(n){this.kl=new h.a;this.sYa=n}ZG(n){const m=n.id;let z=null;this.kl.Hb(m)?z=this.kl.ga(m):(this.sYa&&(z=this.sYa(n,()=>{this.loc(m)})),z&&this.kl.$(m,z));return z}IF(n){n=n.id;return this.kl.Hb(n)?this.kl.ga(n):null}loc(n){this.kl.remove(n)}}Object(I.a)(e,"ShapeComponentViewManager",null,[397])},447:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(67),e=d(14),n=d(330),m=d(116);
class z{constructor(B,v,y,A,E,u,J,G,S,P,Q,D){this.h_b=1;this.bU=v;this.hi=B;this.Bqe=y;this.Le=S;this.qp=P;this.Zc=Q;this.hIa=G;this.FHa=E;this.GHa=A;this.AO=u;this.Le.addCssClass(this.hi,"prControl");this.hi.style.width=this.Le.Pc(v);this.Kr=J.$Kf();this.PGa=J.ZKf();this.Kr.Sia(B);this.PGa.Sia(B,v,v);this.HXa=D;this.Zna()}dispose(){this.cuc();this.clear();this.Kr.dispose();this.PGa.dispose();this.Le.removeCssClass(this.hi,"prControl")}get Dfa(){return m.a.none}clear(){this.Ura();this.qtb();this.FKb()}setZIndex(B){this.hi.style.zIndex=
String(B)}Jic(){this.HXa.xa.style.zIndex=String(this.h_b+n.a.jba)}FKb(){this.HXa.xa.style.zIndex="0"}God(B,v,y=null){B=this.hIa.MXd(this.bU,this.bU,this.Bqe,B,"",y);this.Kr.Eoa(B,v)}Z5a(B,v){this.PGa.add(B,v)}qtb(){this.PGa.clear()}Ura(){this.Kr.clear()}onClick(){return!0}Zna(){this.GHa&&this.qp.pb(h.a.pointerOver,this.hi,this.GHa);this.FHa&&this.qp.pb(h.a.pointerOut,this.hi,this.FHa);this.AO?this.Zc.pb(h.a.click,this.hi,this.AO):this.Zc.pb(h.a.click,this.hi,Object(e.a)(this,this.onClick,"onClick"));
this.Zc.pb(h.a.doubleClick,this.hi,Object(e.a)(this,this.onClick,"onClick"))}cuc(){this.GHa&&this.qp.yb(h.a.pointerOver,this.hi,this.GHa);this.FHa&&this.qp.yb(h.a.pointerOut,this.hi,this.FHa);this.AO?this.Zc.yb(h.a.click,this.hi,this.AO):this.Zc.yb(h.a.click,this.hi,Object(e.a)(this,this.onClick,"onClick"));this.Zc.yb(h.a.doubleClick,this.hi,Object(e.a)(this,this.onClick,"onClick"))}}Object(I.a)(z,"ShapePawn",null,[398])},689:function(I,Y,d){d.d(Y,"a",function(){return y});I=d(0);var h=d(1200),e=
d(14),n=d(104),m=d(37),z=d(28),B=d(447),v=d(116);class y{constructor(A,E,u,J,G,S){this.w4a=this.GGa=null;this.kr=Object(h.a)(B.a,J.tYd(A,E,u,Object(e.a)(this,this.cD,"onPointerOver"),Object(e.a)(this,this.yz,"onPointerOut"),G));this.MHa=0;this.Oc=S;this.Oc.KA(Object(e.a)(this,this.DB,"onSessionEnd"));this.clear()}dispose(){this.kr.dispose();this.GGa=null}get Dfa(){return this.w4a}setZIndex(A){this.kr.setZIndex(A)}ntf(A,E,u){this.w4a=A;this.GGa=E;this.kr.God("UnreadNotification_16x16x32",this.Dfa,
u)}clear(){this.kr.clear();this.w4a=v.a.none}Nya(){this.t_();this.kr.Z5a(this.Dfa,this.w2b);this.kr.Jic()}t_(){this.kr.qtb();this.kr.FKb()}DB(){z.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.MHa);0<this.MHa&&n.c(m.a.nUd)}get w2b(){return this.GGa?this.GGa():""}cD(){this.Nya();z.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.MHa+=1;return!0}yz(){this.t_();return!0}}Object(I.a)(y,"ShapeRevisionTrackingPawn",null,[398])},692:function(I,Y,d){d.d(Y,"a",
function(){return e});I=d(0);var h=d(68);class e{constructor(n){this.R9=this.Xla=null;this.Le=n}dispose(){this.clear();this.Xla.parentNode.removeChild(this.Xla)}Sia(n){this.Xla=this.l1b(n,"prContainerHr");this.R9=this.l1b(this.Xla,"prGlyph")}clear(){this.doa()}Eoa(n,m){n&&(this.doa(),this.R9.appendChild(n),this.R9.style.backgroundColor=m,this.Xla.style.visibility=h.a.visible)}l1b(n,m){const z=this.Le.Ie();this.Le.addCssClass(z,m);n.appendChild(z);return z}doa(){this.R9.firstChild&&this.R9.removeChild(this.R9.firstChild)}}
Object(I.a)(e,"ShapePawnGlyph",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.extcommon.js.map