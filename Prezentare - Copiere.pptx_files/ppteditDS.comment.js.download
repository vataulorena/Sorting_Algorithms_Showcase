'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1240:function(I,Y,d){d.r(Y);var h=d(0),e=d(27),n=d(387),m=d(18),z=d(24);class B{}B.beginDraftingAsync="OSC:BDA";B.SZi="OSC:FEQ";B.selectComment="OSC:SC";Object(h.a)(B,"CommentTaskNames",null,[]);class v{constructor(Z){this.QGa=Z;this.O7j=[]}get handler(){return this.QGa}get t8(){return this.O7j}}Object(h.a)(v,"RegisteredListener",null,[]);class y{constructor(Z,Da){this.type=0;this.payload=null;this.type=Z;this.payload=
Da}}Object(h.a)(y,"OfficeSharedCommentsEvent",null,[1510]);class A{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(A,"ViewContainerEvent",null,[1510]);var E=d(666);class u{constructor(Z){this.bve=!1;this.KX=new m.a;this.zb=Z}mUk(Z){Z=new v(Z);this.KX.add(Z)}AFh(Z){for(let Da=0;Da<this.KX.count;++Da)if(this.KX.ga(Da).handler===Z){this.KX.removeAt(Da);break}}woa(Z=!1){const Da=()=>{if(e.AFrameworkApplication.Ug)n.ULS.sendTraceTag(40420181,201,
50,"Skipped processing comment pane events since app is shutting down.");else for(let nb=0;nb<this.KX.count;++nb){const jc=this.KX.ga(nb);for(;0<jc.t8.length;){var Wa=Array.dequeue(jc.t8);if(Object(z.a)(A,Wa)){var ib=jc.handler;ib(Wa)}else Object(z.a)(y,Wa)&&(ib=jc.handler,ib(Wa.type,Wa.payload))}}};Z?Da():this.bve||(this.bve=!0,E.a.arb(this.zb,()=>{Da();this.bve=!1},B.SZi))}}Object(h.a)(u,"GenericEventHost",null,[]);class J extends u{constructor(Z){super(Z)}EVk(Z){this.mUk(Z)}LBl(Z){this.AFh(Z)}Zrh(Z){Z=
this.zCi(Z);for(let Da=0;Da<this.KX.count;++Da)Array.enqueue(this.KX.ga(Da).t8,Z);this.woa(!0)}zCi(Z){const Da=new A;Da.eventType=3;Da.viewContainerVisibilityState=Z;return Da}b_i(){const Z=this.VHi();for(let Da=0;Da<this.KX.count;++Da)Array.enqueue(this.KX.ga(Da).t8,Z);this.woa(!0)}VHi(){const Z=new A;Z.eventType=2;return Z}}Object(h.a)(J,"ViewContainerEventHost",u,[1491]);class G{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=
this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(G,"BasicEventPayload",null,[1557]);class S{constructor(Z){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=Z}}Object(h.a)(S,"CommentContextDetails",null,[]);class P{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(P,"ContextChangeWithSelectedThreadIndex",null,[1557]);class Q{constructor(){this.tasks=this.comments=null}}Object(h.a)(Q,"LoadCommentsNoVirtualization",null,[1557]);class D extends u{constructor(Z){super(Z);this.VZh=0}EUk(Z,Da,Wa,ib,nb,jc,cc=0){Z=new v(Z);jc&&Array.enqueue(Z.t8,this.jCi(jc,this.VZh));jc=Da?Da.length:0;Array.enqueue(Z.t8,this.zJf(jc,
Wa,ib,cc,null));jc&&Array.enqueue(Z.t8,this.mKf(Da,nb));this.KX.add(Z);this.woa()}e4e(Z){this.AFh(Z)}wUe(Z,Da,Wa,ib=0,nb=null){this.jUa(this.zJf(Z,Da,Wa,ib,nb));this.woa()}F7k(Z,Da,Wa,ib,nb=null){this.jUa(this.DCi(Z,Da,Wa,ib,nb));this.woa()}Goh(Z,Da,Wa){this.jUa(this.GCi(Z,Da,Wa));this.woa()}AUe(Z,Da){this.jUa(this.mKf(Z,Da));this.woa()}selectComment(Z){this.jUa(this.UKf(Z,6));this.woa()}highlightComment(Z){this.jUa(this.UKf(Z,7));this.woa()}A1a(Z,Da){this.jUa(this.YEi(Z,Da));this.woa()}dGk(Z,Da){this.jUa(this.cHi(Z,
Da));this.woa()}jCi(Z,Da=0){const Wa=new G;Wa.modelCapabilityFlags=Z;Wa.richTextCapabilityFlags=Da;return new y(12,Wa)}zJf(Z,Da,Wa,ib,nb=null){const jc=new G;jc.numberOfComments=Z;jc.numberOfThreads=Da;jc.contextDetails=Object.assign(new S(Wa),{nextPopulatedContextDetails:ib});jc.contextDrafts=nb;jc.rehydrationDrafts=null;return new y(0,jc)}DCi(Z,Da,Wa,ib,nb=null){const jc=new P;jc.numberOfComments=Z;jc.numberOfThreads=Da;jc.selectedThreadIndex=Wa;jc.contextDetails=Object.assign(new S(ib),{nextPopulatedContextDetails:0});
jc.contextDrafts=nb;jc.rehydrationDrafts=null;return new y(0,jc)}GCi(Z,Da,Wa){const ib=new G;ib.comments=Z;ib.numberOfThreads=Da;ib.tasks=Wa;return new y(2,ib)}mKf(Z,Da){const Wa=new Q;Wa.comments=Z;Wa.tasks=Da;return new y(1,Wa)}UKf(Z,Da){const Wa=new G;Wa.commentId="";Z&&(Wa.commentId=Z);return new y(Da,Wa)}YEi(Z,Da){const Wa=new G;Wa.changes=[];Wa.contextDetails=Object.assign(new S(Da),{nextPopulatedContextDetails:Z});return new y(10,Wa)}cHi(Z,Da){const Wa=new G;Wa.commentId=Z;Wa.smartReplies=
Da;return new y(15,Wa)}jUa(Z){for(let Da=0;Da<this.KX.count;++Da)Array.enqueue(this.KX.ga(Da).t8,Z)}}Object(h.a)(D,"OfficeSharedCommentsEventHost",u,[1548]);var O=d(1199);class X{constructor(){this.eof=this.mpf=!1;this.g2h=[]}get EOb(){return this.g2h}get Okb(){return this.mpf}set Okb(Z){this.mpf=Z;for(const Da of this.EOb)Da.Okb=Z}get Kjb(){return this.eof}set Kjb(Z){this.eof=Z;for(const Da of this.EOb)Da.Kjb=Z}bMa(Z){for(const Da of this.EOb)Z=Da.bMa(Z);return Z}}Object(h.a)(X,"AggregateCommentTaskPersonTransformer",
null,[1574]);var N=d(106);class aa{constructor(Z,Da,Wa,ib,nb=!1){this.priority=this.completion=-1;this.type=Z;this.user=Da;this.time=Wa;this.recordId=ib;this.isLossy=nb}}Object(h.a)(aa,"HistoryRecord",null,[]);class V{constructor(Z,Da){this.mVh=new O.a(()=>Da.bMa(Z.value))}u7i(){return new Date}ICa(Z,Da,Wa){if(0===Z)throw n.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");
const ib=N.a.create().toString();Wa=new aa(Z,this.mVh.value,Wa,ib,!1);Wa.commentId=Da;n.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",Z);return Wa}}Object(h.a)(V,"HistoryRecordFactory",null,[1575]);class ca{constructor(){this.endDate=this.startDate=null}}Object(h.a)(ca,"CommentTaskSchedule",null,[]);class fa{constructor(Z,Da,Wa,ib,nb,jc){this.isLossy=Z;this.title=Da;this.assignees=Wa;this.schedule=ib;this.completion=nb;this.priority=jc}}Object(h.a)(fa,"CommentTaskState",
null,[]);class ma{constructor(){this.commentId=null}}Object(h.a)(ma,"HistoryItem",null,[]);class da{constructor(Z,Da,Wa,ib,nb,jc,cc){this.gDd=!1;if(1!==Da.type)throw Error.argument("createRecord");this.zRb=Wa;this.wRb=ib;this.xRb=nb;this.ojf=1;this.izc=Z;this.EWh=jc;this._state=new fa(!1,this.zRb,cc,new ca,this.xRb,this.wRb);this._history=[];this.xKf(Da)}cub(Z,Da){if(1!==Z.type)throw Error.argument("createRecordTemplate");const Wa=da.plj(Z,this.ojf);this.ojf++;return Object.assign(new aa(Da,Z.user,
Z.time,Wa),{commentId:Z.commentId})}get Dog(){return this.history[this.history.length-1]}get Zag(){return this.state.completion===this.xRb}get Yag(){return this.state.priority===this.wRb}get $ag(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get abg(){return this.state.title===this.zRb}xKf(Z){Z=Object.assign(new ma,{commentId:Z.commentId,records:[Z]});this.history.push(Z)}EZf(Z){let Da=
-1;for(let Wa=0;Wa<this.state.assignees.length;Wa++)if(this.izc.equals(this.state.assignees[Wa],Z)){Da=Wa;break}return Da}Dgl(Z){const Da=this.Dog,Wa=Da.records[Da.records.length-1];return this.izc.equals(Wa.user,Z.user)&&Da.commentId===Z.commentId&&Wa.time.getTime()===Z.time.getTime()?!0:!1}wGl(Z){switch(Z.type){case 2:-1===this.EZf(Z.assignee)&&this.state.assignees.push(Z.assignee);break;case 3:const Da=this.EZf(Z.assignee);0<=Da&&this.state.assignees.splice(Da,1);break;case 4:Array.clear(this.state.assignees);
break;case 5:this.state.schedule=Z.schedule;break;case 6:this.state.completion=Z.completion;break;case 9:this.state.title=Z.title;break;case 10:this.state.priority=Z.priority;break;case 0:this.state.isLossy=!0;break;case 1:n.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.gDd=!0;break;case 8:this.gDd=!1;break;case -1:n.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}Z.isLossy&&(this.state.isLossy=
!0);this.Dgl(Z)?this.Dog.records.push(Z):this.xKf(Z)}get isDeleted(){return this.gDd}get state(){return this._state}get history(){return this._history}N$i(Z){if(!Z)return this.history;const Da=Array.clone(this.history),Wa=Da[0],ib=Wa.records.shift();if(!this.EWh){var nb=this.cub(ib,4);Wa.records.unshift(nb)}!Z.Zag&&this.Zag&&(nb=this.cub(ib,6),nb.completion=this.xRb,Wa.records.unshift(nb));!Z.Yag&&this.Yag&&(nb=this.cub(ib,10),nb.priority=this.wRb,Wa.records.unshift(nb));!Z.$ag&&this.$ag&&(nb=this.cub(ib,
5),nb.schedule=new ca,Wa.records.unshift(nb));!Z.abg&&this.abg&&(nb=this.cub(ib,9),nb.title=this.zRb,Wa.records.unshift(nb));Z.isDeleted&&(Z=this.cub(ib,8),Wa.records.unshift(Z));return Da}static plj(Z,Da){return"Synthesized-"+Z.recordId+"-"+Da}}Object(h.a)(da,"CommentTaskStateBuilder",null,[]);var qa=d(717);class F{constructor(Z,Da,Wa,ib){this.id=Z;this.commentId=Da;this.currentState=Wa;this.history=ib}}Object(h.a)(F,"CommentTaskItem",null,[]);class sa{constructor(Z,Da="",Wa="",ib=""){this.IsCurrentUser=
!1;this.UserId=Z;this.Provider=Da;this.DisplayName=Wa;this.Email=ib}}Object(h.a)(sa,"CommentTaskPerson",null,[1569]);const ia=Z=>{const Da=new sa(Z.UserId,Z.Provider,Z.DisplayName,Z.Email);Da.IsCurrentUser=Z.IsCurrentUser;return Da};var Na=d(1019);d(287);class Ca{constructor(Z){this.extensions=Z}}Object(h.a)(Ca,"ExtensionList",null,[]);class ha{static clone(Z){Z=ha.lui(Z.extensions);return new Ca(Z)}static UFf(Z){return Z?ha.clone(Z):null}static isEmpty(Z){return!Z.extensions||!Z.extensions.count}static Wa(Z){return!Z||
ha.isEmpty(Z)}static lui(Z){if(!Z)return null;const Da=new Na.a;Z.forEach((Wa,ib)=>{Da.add(Wa,ib);return!0});return Da}}Object(h.a)(ha,"ExtensionListExtensions",null,[]);class Ba{static clone(Z){var Da=ia(Z.user);Da=new aa(Z.type,Da,Z.time,Z.recordId,Z.isLossy);Da.commentId=Z.commentId;Da.anchorExtensionList=ha.UFf(Z.anchorExtensionList);Da.recordExtensionList=ha.UFf(Z.recordExtensionList);Z.assignee&&(Da.assignee=ia(Z.assignee));if(Z.schedule){var Wa=Z.schedule;const ib=new ca;ib.startDate=Wa.startDate;
ib.endDate=Wa.endDate;Da.schedule=ib}Da.completion=Z.completion;Da.title=Z.title;Da.priority=Z.priority;Da.undoId=Z.undoId;return Da}}Object(h.a)(Ba,"HistoryRecordExtensions",null,[]);class va{constructor(Z,Da,Wa,ib,nb,jc,cc,Ad=!1){this.izc=Z;this.hCc=Da;this.Dqa=Wa;this.fPh=ib;this.zRb=nb;this.wRb=jc;this.xRb=cc;this.Rzc=Ad}AHi(Z,Da,Wa,ib=null){if(!Z)throw n.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Da)throw n.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),
Error.argumentNull("parentCommentId");if(!Wa||!Wa.length)throw n.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Wa[0].type)throw n.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var nb=[],jc=null,cc=this.OKk(Wa);for(var Ad of Wa)if(!cc.contains(Ad.recordId))if(Wa=this.p8f(Ad.commentId,ib),Wa=this.d2i(Ad,Wa),1===Wa.type){let xe=[];this.Rzc&&jc&&jc.state&&(xe=
jc.state.assignees);jc=new da(this.izc,Wa,this.zRb,this.wRb,this.xRb,this.Rzc,xe);nb.push(jc)}else if(jc)jc.wGl(Wa);else throw n.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");cc=null;Ad=[];if(jc){jc.isDeleted||(cc=jc.state);jc=null;for(var Xd of nb)nb=Xd.N$i(jc),Array.addRange(Ad,nb),jc=Xd}Xd=this.p8f(Da,
ib);cc&&(cc.completion=this.Fwi(Da,ib,cc.completion));return new F(Z,Xd,cc,Ad)}x1i(Z,Da,Wa,ib=null){if(!Da)throw n.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Wa&&!Z)throw n.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const nb=[],jc=this.Dqa.u7i();if(Wa){var cc=this.Dqa.ICa(1,Z,jc);nb.push(cc)}cc=null;if(Da.assigneeUpdate){if(!Da.assigneeUpdate.assigneesToAdd||!Da.assigneeUpdate.assigneesToRemove)throw n.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Ad=0;Ad<Da.assigneeUpdate.assigneesToAdd.length;Ad++){var Xd=this.yKf(2,Da.assigneeUpdate.assigneesToAdd[Ad],Z,jc);Xd&&nb.push(Xd)}for(Ad=0;Ad<Da.assigneeUpdate.assigneesToRemove.length;Ad++)(Xd=this.yKf(3,Da.assigneeUpdate.assigneesToRemove[Ad],Z,jc))&&nb.push(Xd)}else Da.assignee&&(Wa||(cc=this.Dqa.ICa(4,Z,jc),nb.push(cc)),Ad=this.Dqa.ICa(2,Z,jc),cc=this.hCc.bMa(Da.assignee),Ad.assignee=cc,nb.push(Ad));
Da.title?(ib=this.Dqa.ICa(9,Z,jc),ib.title=Da.title,nb.push(ib)):Wa&&ib&&(Ad=this.Dqa.ICa(9,Z,jc),Ad.title=this.fPh.anj(ib,cc),nb.push(Ad));if(Da.schedule){if(Da.schedule.startDate>Da.schedule.endDate)throw n.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");ib=this.Dqa.ICa(5,Z,jc);ib.schedule=Da.schedule;nb.push(ib)}if(void 0!==Da.completion&&null!==Da.completion){ib=Da.completion;if(0>ib||100<ib)throw n.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");Wa||n.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",ib);Wa=this.Dqa.ICa(6,Z,jc);Wa.completion=ib;nb.push(Wa)}if(void 0!==Da.priority&&null!==Da.priority){Da=Da.priority;if(0>Da||10<Da)throw n.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");Z=this.Dqa.ICa(10,Z,jc);Z.priority=Da;nb.push(Z)}return nb}yKf(Z,Da,Wa,ib){if(2!==Z&&3!==Z)return n.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;Z=this.Dqa.ICa(Z,Wa,ib);Z.assignee=this.hCc.bMa(Da);return Z}OKk(Z){const Da=new qa.a,Wa=new qa.a;for(let ib=Z.length-1;0<=ib;ib--){const nb=Z[ib],jc=Wa.contains(nb.recordId);jc||-1!==nb.type||(Wa.contains(nb.undoId)?n.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):Wa.add(nb.undoId));if(jc||-1===nb.type)Da.contains(nb.recordId)?n.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
Da.add(nb.recordId)}return Da}d2i(Z,Da){const Wa=Ba.clone(Z);Wa.commentId=Da;Wa.user=this.hCc.bMa(Z.user);Wa.assignee=this.hCc.bMa(Z.assignee);return Wa}Fwi(Z,Da,Wa){let ib=Wa;Z&&Da&&(({value:Da}=Da.Uf(Z)).returnValue?(ib=Da.ResolveState?100:100===Wa?0:Wa,ib!==Wa&&n.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",Z)):n.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",Z));
return ib}p8f(Z,Da){let Wa=Z;Z&&Da&&(({value:Da}=Da.Uf(Z)).returnValue?Wa=Da.CommentId:(n.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",Z),Wa=Z));return Wa}}Object(h.a)(va,"CommentTaskTranslatorImpl",null,[1041]);class ta{constructor(){this.P2a={};this.P2a.ops=[]}FGj(Z){const Da=this.P2a.ops;if(Da.length){var Wa=Da.length-1;const ib=Da[Wa];if(!ib.attributes){ib.insert+=Z;Da[Wa]=ib;this.P2a.ops=Da;return}}Wa={};Wa.insert=Z;Array.add(Da,
Wa)}dGj(Z,Da,Wa){var ib={};ib.fullName=Da.fullName;ib.email=Da.email;ib.resolveState=Da.resolveState;Da={};Da.atmention=ib;Z=this.dYd(Z,Da);Wa&&(ib={},ib.contentId=Wa.contentId,Wa={},Wa.atmention=ib,Z.optional=Wa);Array.add(this.P2a.ops,Z)}insertImage(Z,Da){Z=this.dYd(Z,{});const Wa={};Wa.base64=Da.base64;Da={};Da.image=Wa;Z.optional=Da;Array.add(this.P2a.ops,Z)}insertHyperLink(Z,Da){const Wa={};Wa.link=Da.link;this.Pcl(Wa,Da);Array.add(this.P2a.ops,this.dYd(Z,Wa))}T7i(){return Sys.Serialization.JavaScriptSerializer.serialize(this.P2a)}dYd(Z,
Da){const Wa={};Wa.insert=Z;Wa.attributes=Da;return Wa}Pcl(Z,Da){this.zjb(Da.weight>=ta.dmk,Z,"weight",Da.weight);this.zjb(Da.italic,Z,"italic",!0);this.zjb(Da.underline,Z,"underline",!0);this.zjb(Da.strikethrough,Z,"strikethrough",!0);this.zjb(!!Da.highlight,Z,"highlight",Da.highlight);this.zjb(!!Da.color,Z,"color",Da.color);this.zjb(!!Da.paragraph,Z,"paragraph",Da.paragraph)}zjb(Z,Da,Wa,ib){Z&&(Da[Wa]=ib)}static R0f(Z){return Sys.Serialization.JavaScriptSerializer.deserialize(Z,!0)}}ta.dmk=700;
Object(h.a)(ta,"DeltaFormatCreator",null,[1539]);var Fa=d(527),pa=d(1147);class ka{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}anj(Z,Da){if(!Z)throw n.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var Wa=ta.R0f(Z)}catch(Xd){throw n.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var ib=Z=0,nb=0;const jc=RegExp("\\s+","g"),cc=new Sys.StringBuilder;
for(var Ad of Wa.ops)Ad.attributes&&Ad.attributes.atmention&&Ad.attributes.atmention.email&&Da&&(Wa=Ad.attributes.atmention.email,0<Wa.length&&(Wa===Da.UserId||Wa===Da.Email||Wa===Fa.a.E8a(Da.UserId))&&(ib=Z,nb=ib+Ad.insert.length)),Wa=Ad.insert.replace(jc," "),Z+=Wa.length,cc.append(Wa);!nb&&Da&&n.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Da.Provider);Da=cc.toString().trimEnd();Z=Da.length;255<Z?(Ad=(255-(nb-ib))/2,0>ib-Ad?(Z=pa.a.instance.C5d(Da,255-this.ellipsis.length),
nb=Da.substring(0,Z)+this.ellipsis,Z="Trimmed End"):nb+Ad>Z?(ib=pa.a.instance.GSc(Da,Z-255+this.ellipsis.length),nb=this.ellipsis+Da.substring(ib,Z),Z="Trimmed Start"):(ib=pa.a.instance.GSc(Da,ib-Ad+this.ellipsis.length),Z=pa.a.instance.C5d(Da,nb+Ad-this.ellipsis.length),nb=this.ellipsis+Da.substring(ib,Z)+this.ellipsis,Z="Trimmed Both")):(Z="No Trim",nb=Da);n.ULS.sendTraceTag(592998804,327,50,Z);return nb}}Object(h.a)(ka,"ContentExtractor",null,[]);class Ha{constructor(Z,Da){this.OSh=Z;this.nVh=
Da;this.Kjb=this.Okb=!1}bMa(Z){if(!Z)return null;if(void 0===Z.UserId||null===Z.UserId)throw n.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(Z.IsCurrentUser||!this.OSh.equals(this.nVh.value,Z))return Z;Z=ia(Z);Z.IsCurrentUser=!0;return Z}}Object(h.a)(Ha,"EnsureIsCurrentUserSetTransformer",null,[1574]);class Ya{constructor(){this.Kjb=this.Okb=!1}bMa(Z){if(!Z)return null;if(void 0===Z.UserId||null===Z.UserId)return Z;if(!Z.Email||""===Z.Email){let Da;
if(Da=Fa.a.E8a(Z.UserId))return Z=ia(Z),Z.Email=Da,Z}return Z}}Object(h.a)(Ya,"RestoreEmailTransformer",null,[1574]);class Ka{constructor(){this.Kjb=this.Okb=!1}bMa(Z){if(!Z)return null;if(void 0!==Z.UserId&&null!==Z.UserId)return Z;switch(this.Okb?this.Kjb?2:1:0){case 0:if(void 0===Z.UserId||null===Z.UserId)throw n.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");Z=ia(Z);break;case 1:if(void 0===Z.Id||null===Z.Id)throw n.ULS.sendTraceTag(593368214,327,
10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===Z.Email||null===Z.Email)throw n.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Da=Ka.o9g(Z.Id,Z.Email,null);if(!Da||""===Da)throw n.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Wa=e.AFrameworkApplication.fa.Ga("HostAuthType")||"";if("aad"!==Wa.toLowerCase()||Da.startsWith("S::")){if("msa"===Wa.toLowerCase())throw n.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");n.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Wa)}else throw n.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");Z=new sa(Da,"AD",Z.DisplayName,Z.Email);break;case 2:if(void 0===Z.UserPrincipalName||null===Z.UserPrincipalName)throw n.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==Z.SuggestionSubtype&&null!==Z.SuggestionSubtype)if("OrganizationUser"===Z.SuggestionSubtype)Da="AD";else throw n.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",Z.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw n.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Wa=Ka.o9g(Z.Id,Z.UserPrincipalName,Z.AadObjectId);if(!Wa||""===Wa)throw n.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),
Error.argument("UserId");if("AD"===Da&&!Wa.startsWith("S::"))throw n.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");Z=new sa(Wa,Da,Z.Name,Z.UserPrincipalName);break;default:throw n.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return Z}static o9g(Z,Da,Wa){if(!Da||""===Da)return n.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),Z;if(Wa&&""!==Wa)return"S::"+Da+"::"+Wa;if(!Z||""===Z)return n.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),Z;if(Z.startsWith("S::"))return Z;if(-1!==Z.indexOf("@")){Wa=Z.split("@");if(N.a.isValid(Wa[0]))return"S::"+Da+"::"+Wa[0];n.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return Z}}Object(h.a)(Ka,"UserIdCanonicalizationTransformer",null,[1574]);class Pa{constructor(Z,Da,Wa=!1,ib=!1){this.OQh=Z;this.U8e=Da;this.GVh=Wa;this.Rzc=ib}xCi(){const Z=new Fa.a;var Da=new O.a(Pa.i7i);const Wa=new X;this.U8e&&(Wa.EOb.push(new Ka),Wa.EOb.push(new Ya));this.OQh&&
Wa.EOb.push(new Ha(Z,Da));Wa.Okb=this.U8e;Wa.Kjb=this.GVh;Da=new V(Da,Wa);const ib=new ka;return new va(Z,Wa,Da,ib,Pa.hKi,Pa.UJi,Pa.VJi,this.Rzc)}static i7i(){const Z=new sa(e.AFrameworkApplication.fa.Ga("PresenceUserId")||"",e.AFrameworkApplication.fa.Ga("PresenceProvider")||"",e.AFrameworkApplication.userName||"");Z.IsCurrentUser=!0;return Z}}Pa.hKi="";Pa.UJi=5;Pa.VJi=0;Object(h.a)(Pa,"CommentTaskTranslatorFactory",null,[1568]);class Oa{constructor(){this.BKd=this.r7e=!1;this.eqb=this.Ts=this.aef=
this.Mhf=this.Kqf=this.Vkf=this.Cpf=this.H9e=this.Sw=this.KWb=null}initialize(Z,Da,Wa,ib=null,nb=null,jc=null,cc=null,Ad=null,Xd=null,xe=null){this.Sw=Z;this.H9e=Da;this.Cpf=Wa;this.Vkf=ib;this.Kqf=nb;this.Mhf=jc;this.aef=cc;this.Ts=Ad;this.r7e=!0;this.eqb=Xd;this.KWb=xe}V8b(Z=null,Da=null){if(!this.r7e)return n.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Wa,ib)=>{ib(E.a.Ys(-2130915313))});if(this.BKd)return n.ULS.sendTraceTag(41424204,
201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.KWb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.KWb=appResourceLoader.loadChunk("sharedComments"):this.KWb=this.Sw.loadScript("sharedComments"));return this.KWb.then(()=>{Z&&Z();this.BKd||(this.eqb&&this.eqb.execute(Wa=>{Wa.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Da&&Da(),sharedComments.instantiate(this.H9e,
this.Cpf,this.Vkf,this.Kqf,this.Mhf,this.aef,this.Ts));this.BKd=!0})}}Object(h.a)(Oa,"CommentActivationManager",null,[1570]);var oa=d(14);class Xa{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(Xa,"CommentUIActionPayload",null,[]);var Hb=d(259);class Ob{constructor(Z,Da){this.Ca=Z;this.Z1a=Da;this.Bwd=new Hb.a;for(let Wa of this.Z1a)this.Bwd.$(Wa.value.canvasActionId,Wa.key),Z=Wa.value,Z.delayActionsUntilRegistration||this.ya(Z)}ya(Z){Z.withFlags?this.Ca.ra(Z.canvasActionId,Z.canvasContextId,
Object(oa.a)(this,this.jYb,"actionHandler"),97):this.Ca.ya(Z.canvasActionId,Z.canvasContextId,Object(oa.a)(this,this.jYb,"actionHandler"))}Uxa(Z,Da){this.Z1a.Hb(Z)&&(this.Z1a.ga(Z).delayActionsUntilRegistration&&this.ya(this.Z1a.ga(Z)),this.Z1a.ga(Z).registeredCallback=Da)}jYb(Z,Da,Wa,ib,nb){if(this.Bwd.Hb(Z)){var jc=this.Bwd.ga(Z);if(!this.Z1a.Hb(jc))return 8;const cc=this.Z1a.ga(jc);if(cc.preCallback){const Ad=cc.preCallback(Z,Da,Wa,ib,nb);if(2!==Ad)return Ad}if(!cc.registeredCallback)return 1===
Wa?8:2;jc=Object.assign(new Xa,{actionType:jc});1===Wa&&(jc.actionBehavior=1);jc=cc.registeredCallback(jc);return cc.postCallback?cc.postCallback(jc,Z,Da,Wa,ib,nb):jc?32:8}return 2}}Object(h.a)(Ob,"OfficeSharedCommentsActionHost",null,[1550]);var eb=d(346),Eb=d(37),oc=d(192);class Sb{}Object(h.a)(Sb,"CommentActivityData",null,[]);var qc=d(142),$a=d(73);class ab{constructor(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd,xe=null,Ff=null){this.Nrf={["CancelCommentCreateThreadAction"]:Eb.a.Wsh,["CommitComment"]:Eb.a.Xsh,
["CommitDraftAction"]:Eb.a.Ysh,["CommitDraftCreateAction"]:Eb.a.fXe,["CommitDraftEditAction"]:Eb.a.hXe,["CommitDraftReplyAction"]:Eb.a.eXe,["CreateReplyAction"]:Eb.a.eXe,["CreateReplyWithMentions"]:Eb.a.Zsh,["CreateReplyWithTaskAssigned"]:Eb.a.$sh,["CreateThreadAction"]:Eb.a.fXe,["CreateThreadWithMentions"]:Eb.a.ath,["CreateThreadWithTaskAssigned"]:Eb.a.bth,["DeletePostAction"]:Eb.a.cth,["DeleteThreadAction"]:Eb.a.dth,["DeleteThreadWithTask"]:Eb.a.eth,["DiscardDraftAsync"]:Eb.a.fth,["PresentLinkToCommentAction"]:Eb.a.gth,
["ResolveThreadAction"]:Eb.a.kth,["ResolveThreadWithTask"]:Eb.a.lth,["ReopenThreadAction"]:Eb.a.hth,["ReopenThreadWithTask"]:Eb.a.ith,["RequestInitCommentSession"]:Eb.a.jth,["SelectCommentAction"]:Eb.a.mth,["UpdateCommentBodyAction"]:Eb.a.hXe};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=Z;this.appVersion=Da;this.releaseAudience=Wa;this.releaseChannel=ib;this.sessionId=
nb;this.ring=jc;this.dataCenter=cc;this.disableUpload=Ad;this.sovereignEnvironmentName=Ff;this.Ca=Xd;this.Xkf=xe;this.GFj()}GFj(){this.Ca.ya(Eb.a.Wsh,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.Xsh,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.Ysh,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.eXe,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.Zsh,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.$sh,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.fXe,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.ath,
$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.bth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.cth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.dth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.eth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.fth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.gth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.kth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.lth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.hth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.ith,
$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.jth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.mth,$a.a.frame,oc.ActionManager.Mg);this.Ca.ya(Eb.a.hXe,$a.a.frame,oc.ActionManager.Mg)}sendULSTrace(Z,Da,Wa,ib){n.ULS.sendTraceTag(Z,Da,Wa,ib)}recordActivity(Z){this.Nrf[Z]&&this.Ca.processAction(this.Nrf[Z],2)}sendOtelEvent(Z){qc.a.sendOtelEvent(Z)}recordPerfData(Z,Da){this.Xkf&&(Z=Object.assign(new Sb,{durationMs:Da,name:Z}),this.Xkf.Wna(Z))}}Object(h.a)(ab,"OfficeSharedCommentsTelemetry",null,[]);
var Ib=d(270);class gc{constructor(Z,Da,Wa,ib){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=Z;this.appLocale=Da;this.uiCulture=Wa;this.dataCulture=ib}}Object(h.a)(gc,"LocalizationDetails",null,[]);var Ta=d(291),Ab=d(67),kc=d(93);class fb{constructor(Z,Da){this.i3h=Z;this.ibf=Da}getViewContainer(){return this.i3h}registerForViewContainerEvents(Z){this.ibf.EVk(Z)}unregisterForViewContainerEvents(Z){this.ibf.LBl(Z)}}Object(h.a)(fb,"ViewContainerProvider",
null,[1490]);var Qb=d(70),mb=d(1200),Jb=d(36),Ub=d(29),tb=d(250),Bc=d(210),Gb=d(28),Hc=d(236),$b=d(637);class lc{static O2f(Z){return Z===lc.create?0:Z===lc.reply?1:Z===lc.edit?2:Z===lc.metadata?3:null}}lc.create="CREATE";lc.reply="REPLY";lc.edit="EDIT";lc.metadata="METADATA";Object(h.a)(lc,"CommentSessionType",null,[]);class Vb{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)(Vb,"InitCommentSessionResult",
null,[]);class ic extends Vb{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(ic,"BeginDraftingHostResult",Vb,[]);class qb{constructor(Z,Da="",Wa="",ib="",nb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=Z;this.Provider=Da;this.DisplayName=Wa;this.Email=ib;this.IsCurrentUser=nb}}Object(h.a)(qb,"OfficeSharedCommentUser",null,[]);var Wb=d(47),Xc=d(57),xb=d(193),Rb=d(35);class wc{constructor(Z,Da,Wa){this.Lq=Z;this.x7j=Da;
this.A6j=Wa;this.cxg=null;this.hEg=!1}get IQa(){return this.Lq}get rC(){return this.x7j}get commentId(){return this.A6j}get w8(){return this.cxg}set w8(Z){this.cxg=Z}get P_c(){return this.hEg}set P_c(Z){this.hEg=Z}}Object(h.a)(wc,"ActiveCommentSession",null,[]);var ud=d(683);class uc{static get Vkk(){return 50}static h3i(Z){return uc.P5i(Z)}static ofj(Z){if(""===Z)return"";let Da=0,Wa="";try{const ib=ta.R0f(Z);for(const nb of ib.ops)if(uc.fua(nb))Da||(Wa+=uc.O9i(nb.attributes.atmention.fullName)),
Da+=1;else{const jc=nb.insert?nb.insert:"";" "!==jc&&0<jc.length&&(Da=0,Wa+=jc)}}catch(ib){n.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Wa}static P5i(Z){Z=uc.ofj(Z);return 0<Z.length&&Z.split(" ").length<=uc.Vkk?Z:null}static O9i(Z){let Da="";Z&&(Z=Z.split(" "),0<Z.length&&(Da=Z[0]));return Da}static fua(Z){return!!Z.attributes&&!!Z.attributes.atmention}}Object(h.a)(uc,"BaseCommentSmartReplyHelpers",null,[]);
class db{constructor(Z){this.Rqe=Z}YHl(Z,Da,Wa,ib){-1===Wa||Da||(Da=ib[Wa],Wa=Da.author?Da.author.IsCurrentUser:!1,Da&&Da.commentBody&&!Wa&&(Da=uc.h3i(Da.commentBody))&&this.Rqe.invoke(Z,Da))}}Object(h.a)(db,"CommentSmartReplyHelpers",null,[]);var Yb=d(55),Zc=d(76),Kb=d(33),Yc=d(90),ec=d(92),rb=d(51);class ac{constructor(){this.wAd=this.kLd=this.EOa=null;this.Xag=!1;this.ysd=this.zsd=this.endPos=this.startPos=0}get paragraphs(){return this.EOa}get ZU(){return this.kLd}set ZU(Z){this.kLd=Z;this.EOa=
[];this.EOa.push(this.kLd)}get o3(){return this.wAd}set o3(Z){this.wAd=Z;this.EOa&&this.X$b&&this.EOa.push(this.wAd)}BVi(){for(const Z of this.EOa){const Da=Object(mb.a)(5,Z);if(Da&&-1!==Da.Hwb().indexOf("\ufffc"))return!0}return!1}fng(Z){const Da=(this.ysd&4294967295)>>>0;Z.TextBodyLength!==this.zsd||Da===Z.TextBodyHash||ac.Xmh.contains(this.ysd)||(ac.Xmh.add(this.ysd),Gb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.BVi()));
return Z.TextBodyLength===this.zsd}get Zeh(){let Z=0;if(this.isValid)if(this.X$b){Z+=Kb.ParagraphReader.textLength(this.ZU)-this.startPos;Z+=this.endPos;for(let Da=1;Da<this.paragraphs.length-1;Da++){const Wa=this.paragraphs[Da];Wa&&(Z+=Kb.ParagraphReader.textLength(Wa)+1)}}else Z=this.endPos-this.startPos;return Z}get PLa(){if(!this.isValid)return Yc.a.auto;var Z=rb.a.Lj(this.ZU,this.startPos+1);if(!Z)return Yc.a.auto;Z=ec.a.xs(Z);return Z?(Z=Z.cache)&&Z.P3?Z.fontColor:Yc.a.auto:Yc.a.auto}get isValid(){return!!this.ZU&&
!!this.o3&&!!this.paragraphs}get X$b(){return!this.ZU.equals(this.o3)}H6h(Z){this.EOa&&Z&&this.EOa.push(Z)}FHj(){if(this.isValid&&(this.ZU.Bv(16,!0),this.X$b))for(let Z=1;Z<this.paragraphs.length;Z++){const Da=this.paragraphs[Z];Da&&Da.Bv(16,!0)}}hLj(Z,Da){if(!this.isValid)return!1;const Wa=Object(mb.a)(Zc.AParagraphNode,Z.node),ib=Object(mb.a)(Zc.AParagraphNode,Da.node);return!(Wa&&ib&&Array.contains(this.paragraphs,Wa)&&Array.contains(this.paragraphs,ib))||Wa.equals(this.ZU)&&(0>Z.Qa||Z.Qa<this.startPos)||
ib.equals(this.o3)&&(0>Da.Mb||Da.Mb>this.endPos)?!1:!0}h1f(Z){let Da=3;Z&&(!this.X$b&&this.ZU.equals(Z)?Da=2:this.ZU.equals(Z)?Da=0:this.o3.equals(Z)&&(Da=1));return Da}}ac.Xmh=new qa.a;Object(h.a)(ac,"TextAnchorParagraphInfo",null,[]);class Jc{static yvb(Z,Da){return Z||Da?Z&&Da?Z.commentId===Da.commentId:!1:!0}static jPc(Z){return!!Z.Children&&0<Z.Children.length}static Iej(Z,Da){Z=Z.Hwb()+"\r";for(let Wa=0;Wa<Z.length;Wa++){let ib=Z.charCodeAt(Wa);160===ib&&(ib=32);Da=(Da<<5>>>0)+Da+ib}return Da}static EN(Z){return!!Z&&
!!Z.textAnchoringInfo&&Z.textAnchoringInfo.EndPos>Z.textAnchoringInfo.StartPos&&0<Z.textAnchoringInfo.TextBodyLength}static K6b(Z,Da){if(!Jc.EN(Z))return null;if(!Da||1>Da.$D().length)return Gb.a.J(509220243,805,Da?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!Da),null;let Wa=null,ib=null,nb=null;Z.textAnchoringInfo.AnchoringShape&&(Z.textAnchoringInfo.AnchoringShape.TableCell?(Wa=N.a.Hf(Z.textAnchoringInfo.AnchoringShape.TableCell.RowId),
ib=N.a.Hf(Z.textAnchoringInfo.AnchoringShape.TableCell.ColId)):Z.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(nb=Z.textAnchoringInfo.AnchoringShape.SmartArtNodeId,nb.startsWith("{")||(nb="{"+nb),nb.endsWith("}")||(nb+="}")));let jc=Z.textAnchoringInfo.StartPos;Z=Z.textAnchoringInfo.EndPos;let cc=0,Ad=0;const Xd=new ac;Da=Da.$D();for(let Ff=0;Ff<Da.length;Ff++){const xg=Da[Ff],Eg=Kb.ParagraphReader.textLength(Object(mb.a)(Zc.AParagraphNode,xg));if(Wa&&ib){var xe=xg.jL();if(!xe||!Wa.equals(xe.rowId)||
!ib.equals(xe.cellId))continue}else if(nb&&(!xg.get_smartArtModelId()||nb!==xg.get_smartArtModelId()))continue;if(!Xd.isValid&&(Eg>jc||Xd.ZU)){if(!Xd.ZU&&(Xd.ZU=Object(mb.a)(Zc.AParagraphNode,xg),Xd.startPos=jc,!Xd.ZU))return null;xe=Ff===Da.length-1||!!nb&&Jc.lQj(nb,Da[Ff+1])||!!Wa&&!!ib&&Jc.kQj(Wa,ib,Da[Ff+1]);xe=Eg<Z&&0<Eg&&xe;if((Eg>=Z||xe)&&!Xd.o3){if(xe&&(Z=Eg),Xd.o3=Object(mb.a)(Zc.AParagraphNode,xg),Xd.endPos=Z,!Xd.o3)return null}else xg.equals(Xd.ZU)||Xd.H6h(Object(mb.a)(Zc.AParagraphNode,
xg))}cc+=Eg+1;Ad=Jc.Iej(xg,Ad);Xd.ZU||(jc-=Eg+1);Z-=Eg+1}Xd.zsd=cc;Xd.ysd=Ad;return Xd}static lQj(Z,Da){return Da.get_smartArtModelId()&&Da.get_smartArtModelId()===Z?!1:!0}static kQj(Z,Da,Wa){return(Wa=Wa.jL())&&Z.equals(Wa.rowId)&&Da.equals(Wa.cellId)?!1:!0}static Ulj(Z,Da,Wa,ib){Wa=ib=-1;if(!Z)return Gb.a.J(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,xLa:Wa,tDa:ib};let nb=Object(mb.a)(5,Da.Ua.node);const jc=Object(mb.a)(5,Da.Ye.node);
if(!nb||!jc)return Gb.a.J(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",!nb,!jc),{returnValue:null,xLa:Wa,tDa:ib};const cc=Da.Ua.U5a,Ad=Da.Ye.oYb;var Xd=Kb.ParagraphReader.textLength(Da.Ua.node);Da=Kb.ParagraphReader.textLength(Da.Ye.node);if(0>cc||0>=Ad||cc===Ad&&nb===jc||cc>Xd||Ad>Da)return Gb.a.J(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",
cc,Ad,Xd,Da),{returnValue:null,xLa:Wa,tDa:ib};Z=Z.$D();if(!Z)return Gb.a.J(509220239,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,xLa:Wa,tDa:ib};Xd=0;for(const xe of Z){if(jc.get_smartArtModelId()){if(xe.get_smartArtModelId()!==jc.get_smartArtModelId())continue;nb.get_smartArtModelId()!==jc.get_smartArtModelId()&&(nb=xe)}if(jc.Cs()){if(xe.jL()!==jc.jL())continue;nb.jL()!==jc.jL()&&(nb=xe)}nb===xe&&(Wa=cc+Xd);jc===xe&&
(ib=Ad+Xd);if(0<=Wa&&0<=ib)return{returnValue:nb,xLa:Wa,tDa:ib};Xd+=xe.Hwb().length+1}0<=Wa&&-1===ib&&(nb.get_smartArtModelId()||nb.Cs())&&(ib=Xd-1);return{returnValue:nb,xLa:Wa,tDa:ib}}static get jIc(){return Yb.a.eg||Yb.a.HUa}static get nPc(){return!Yb.a.Ni}}Object(h.a)(Jc,"CommentUtilities",null,[]);const Db=(Z,Da)=>{var Wa,ib;if(null===Z||void 0===Z||!Z.ReactionList)return Z;for(const nb in Z.ReactionList)Z.ReactionList[nb].ReactionInstances=null===(ib=null===(Wa=Z.ReactionList[nb])||void 0===
Wa?void 0:Wa.ReactionInstances)||void 0===ib?void 0:ib.filter(jc=>jc.User.UserId!=Da.UserId);Z.ReactionList=Z.ReactionList.filter(nb=>0!=nb.ReactionInstances.length);0==Z.ReactionList.length&&(Z.ReactionList=void 0);return Z},dd=Z=>Z.ka("PPTOCommentReactionsUIEnabled");class Cd{constructor(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd,xe,Ff,xg,Eg,De,zd,Gd){this.L8c=!1;this.kb=Z;this.wHa=Da;this.jse=Wa;this.k5j=ib;this.zb=nb;this.Pb=jc;this.zbd=cc;this.G6j=Ad;this.Yva=Xd;this.Rqe=Ff;this.T7j=xg;this.tva=Eg;this.w9c=De;
this.y6j=zd;this.ia=Gd}beginDraftingAsync(Z){if(!Z)return new Promise((Wa,ib)=>{ib(E.a.Ys(-2130915327))});const Da=lc.O2f(Z.sessionType);return void 0===Da||null===Da?new Promise((Wa,ib)=>{ib(E.a.Ys(-2130915317))}):2===Da&&Z.commentId===Cd.BGb?new Promise((Wa,ib)=>{ib(E.a.Ys(-2130915324))}):new Promise((Wa,ib)=>{E.a.arb(this.zb,()=>{var nb=this.kb.M8d(),jc=null;let cc=-1;Gb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",Da);try{switch(Da){case 0:if(this.w9c)try{cc=this.kb.I2f(!0)}catch(Ff){Gb.a.J(512496832,
801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",Ff),cc=nb.length}else cc=nb.length;jc=new wc(Da,Z,"");this.L8c=!0;break;case 1:if(!Z.threadId||!Z.threadId.length)throw E.a.Ys(-2130915324);cc=Cd.uaj(nb,Z.threadId);if(-1===cc)throw E.a.Ys(-2130915323);if(this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Ad=Z.threadId;(new db(this.Rqe)).YHl(Ad,Cd.xxj(nb,Ad),Cd.H7d(nb,Ad),nb)}jc=new wc(Da,Z,Z.threadId);break;case 2:if(!Z.commentId||!Z.commentId.length)throw E.a.Ys(-2130915324);
cc=Cd.H7d(nb,Z.commentId);if(-1===cc)throw E.a.Ys(-2130915323);jc=new wc(Da,Z,Z.commentId);break;case 3:cc=Cd.H7d(nb,Z.threadId);jc=new wc(Da,Z,Z.threadId);break;default:throw E.a.Ys(-2130915322);}if(!jc)throw E.a.Ys(-2130915322);var Xd=this.kb.MCj(jc);if(Xd)throw Xd;}catch(Ff){ib(Ff);return}nb=new ic;jc=this.Pb.Ga("UserName");Xd=this.Pb.Ga("387");Ad=this.Pb.Ga("388");const xe=Rb.a("PPTPlumbEmailThroughCG")?Fa.a.E8a(Xd||""):"";Xd=new qb(Xd,Ad,jc,xe,!0);nb.author=Xd;nb.insertIndex=cc;nb.authorName=
jc;nb.authorIdentity=new String;Wa(nb)})})}commit(Z,Da,Wa){if(!this.kb.iMc)throw Gb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.kb.Uvi),E.a.Ys(-2130915320);var ib=this.kb.iMc.rC;if(!ib)throw Gb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),E.a.Ys(-2130915320);const nb=lc.O2f(ib.sessionType);if(void 0===nb||null===nb)throw E.a.Ys(-2130915317);if(Z!==ib.draftId)throw E.a.Ys(-2130915327);const jc=
this.tva?xb.e(N.a.create().toString()):"";this.kb.JOf();switch(nb){case 0:return Gb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",jc),ib={},this.kb.W_k(jc),ib.commentId=jc,this.L8c=!1,this.kb.A_g=jc,Cd.gDh(Wa),Cd.fDh(),this.createComment(Da,ib,Wa);case 1:return Gb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",ib.threadId,jc),Z={},Z.parentId=ib.threadId,Z.commentId=jc,Cd.gDh(Wa),Cd.fDh(),this.createComment(Da,Z,Wa);case 2:return Gb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",
ib.commentId),Wa={},Wa.commentBody=Da,this.LCl(ib.commentId,Wa),Z;case 3:return Gb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",ib.threadId),dd(this.Pb)?this.MCl(ib.threadId,Wa):this.gGh(ib.threadId,Wa),ib.threadId;default:throw E.a.Ys(-2130915322);}}endCommentSession(Z){Gb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",Z);this.kb.endCommentSession(Z,this.L8c?9:1);this.L8c=!1}createComment(Z,Da,Wa){const ib=this.zbd.ttd(Z,new Date);let nb="";this.tva&&(nb=Wb.a.Wa(Da.commentId)?
N.a.create().toString():Da.commentId);let jc=null;void 0!==Wa&&null!==Wa&&(jc=this.zbd.wxl(nb,Wa.Task,Z));Z=this.kb.Jnd;if(Wa=Da.parentId?null:this.kb.Vlj())Z=this.kb.k7k;this.wHa.a5h(nb,ib.plainText,Da.parentId,Z,this.kb.anchorNode,ib.v_g,jc,Wa);return Wb.a.Wa(nb)?Cd.BGb:nb}deleteComment(Z){if(Z===Cd.BGb)throw E.a.Ys(-2130915327);Gb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",Z);this.wHa.deleteComment(Z)}selectComment(Z){Z!==Cd.BGb&&this.kb.Yfa(Z,0,!1)}highlightComment(Z){Z!==Cd.BGb&&
this.kb.d4h(Z)}fGh(Z,Da,Wa){const ib=Array.clone(this.kb.M8d());var nb=null;for(var jc of ib)if(jc.commentId===Z){nb=jc;break}if(!nb)throw Gb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),E.a.Ys(-2130915323);(jc=e.AFrameworkApplication.userName)&&0<jc.length&&jc!==nb.author.DisplayName&&Gb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.Ylb||e.AFrameworkApplication.PQ);jc=new Date;nb=this.zbd.ttd(nb.commentBody,
null).plainText;Da=this.zbd.ttd(Da.commentBody,jc);this.wHa.yPi(Da.plainText,Z,Da.v_g);Wa||nb!==Da.plainText||this.jse.Goh(ib,this.kb.B0g,Array.clone(this.kb.p4f()))}LCl(Z,Da){if(Z===Cd.BGb)throw E.a.Ys(-2130915327);Da.commentBody&&(this.Pb.ka("896")?this.fGh(Z,Da,!0):E.a.arb(this.zb,()=>{this.fGh(Z,Da,!1)}))}MCl(Z,Da){if(!((null===Da||void 0===Da?0:Da.Resolve)||(null===Da||void 0===Da?0:Da.Reaction)))throw E.a.Ys(-2130915327);(null===Da||void 0===Da?0:Da.Resolve)&&this.gGh(Z,Da);(null===Da||void 0===
Da?0:Da.Reaction)&&this.OCl(Z,Da)}gGh(Z,Da){if(void 0===Da.Resolve||null===Da.Resolve)throw E.a.Ys(-2130915327);const Wa=Da.Resolve.isResolved;let ib=Wa?100:0;void 0!==Da.Task&&null!==Da.Task&&(ib=Da.Task.completion);this.wHa.hGh(Z,Wa?1:0,ib);Wa&&this.kb.d$k()}OCl(Z,Da){if(dd(this.Pb)){if(null==(null===Da||void 0===Da?void 0:Da.Reaction))throw E.a.Ys(-2130915327);a:{switch(Da.Reaction.reactionType){case 1:var Wa="\ud83d\udc4d";break a;default:Gb.a.J(509220244,805,50,"Unsupported reaction type")}Wa=
void 0}void 0!==Wa&&(this.wHa.PCl(Z,Wa,Da.Reaction.isActive),this.kb.Rrk())}}setThreadResolvedState(Z,Da){this.wHa.hGh(Z,Da?1:0,Da?100:0);Da&&this.kb.PNf(Z)}selectFirstThreadInNextCommentContext(){this.kb.V6k()}selectLastThreadInPreviousCommentContext(){this.kb.Y6k()}presentLinkToComment(Z){if(Z=this.wHa.Jjj(Z)){Z=JSON.stringify({["sId"]:Z.sid,["cId"]:Z.cid});var Da={};Da.nav=ud.a(Z);Da.mode="copy";Gb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",Z);this.ia.La(Eb.a.Tsa,2,Da)}else Gb.a.J(512496793,
805,50,"PresentLinkToComment failed")}registerForCommentEvents(Z){this.y6j.Wcj().then(Da=>{this.jse.EUk(Z,this.kb.M8d(),this.kb.B0g,this.kb.isReadOnly,this.kb.p4f(),Da,this.G6j.k1c)})}unregisterForCommentEvents(Z){this.jse.e4e(Z)}registerForAction(Z,Da){this.k5j.Uxa(Z,Da);this.kb.XSk()}unregisterForAction(){}loadThreads(){Gb.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(Z=>{e.AFrameworkApplication.fa.gf(()=>{this.Yva?this.Yva.atMentionsEnabledAsync().then(Da=>
{Z(Da);return null}):Z(!1)})})}resolveSupported(){return this.T7j}static uaj(Z,Da){let Wa=!1;for(let ib=0;ib<Z.length;ib++){if(Wa&&Z[ib].commentId!==Da&&Z[ib].parentId!==Da)return ib;Z[ib].commentId===Da&&(Wa=!0)}return Wa?Z.length:-1}static xxj(Z,Da){let Wa=!1;for(let ib=0;ib<Z.length;ib++)if(Z[ib].commentId===Da&&(Wa=!0),Wa&&Z[ib].parentId===Da)return!0;return!1}static H7d(Z,Da){for(let Wa=0;Wa<Z.length;Wa++)if(Z[Wa].commentId===Da)return Wa;return-1}static fDh(){if(Rb.a("CommentsFpsIsEnabled"))try{const Z=
Xc.a.instance.Ja("Common.ISystemInitiatedFeedback");Z&&Z.execute(Da=>{Da.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(Z){Gb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",Z)}}static gDh(Z){if(Rb.a("CommentsTasksFpsIsEnabled")&&Z&&Z.Task)try{const Da=Xc.a.instance.Ja("Common.ISystemInitiatedFeedback");Da&&Da.execute(Wa=>{Wa.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(Da){Gb.a.J(512496789,
805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",Da)}}}Cd.BGb="temp-id";Object(h.a)(Cd,"CommentAPI",null,[1072,1073]);var pd=d(201),Ge=d(352),kd=d(688);class Xf{constructor(Z,Da,Wa){this.ilc=Z;this.commentId=Da;this.state=Wa}}Object(h.a)(Xf,"CommentTextAnchorToHighlight",null,[]);class Kd extends Sys.EventArgs{constructor(Z){super();this.Sfl=Z}}Object(h.a)(Kd,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class lg{constructor(Z,Da,Wa,ib,nb,jc,cc,
Ad,Xd,xe){this.dTg=[];this.rcd=null;this.Xpd=!1;if(!xe)throw Error.argumentNull("viewElementEventNotifier");this.Kc=Da;this.sBe=this.whc=!1;this.D3c=Z;this.Kfk=Wa;this.ycb=this.iWa=null;this.hl=ib;this.pa=nb;this.UVa=jc;this.tGa=cc;this.Aea=Ad;this.B6j=Xd;this.CJ=xe;this.Aea.fQe(this.B6j)}get xW(){return this.iWa&&this.iWa.isConnected?this.iWa:null}get Nwh(){return this.whc}jqc(Z,Da,Wa=!1,ib=!1){const nb=this.Kfk.ZG(Z);if(nb)switch(Da){case 0:nb.display(Wa,ib);this.iWa=Z;break;case 1:nb.activate();
this.ycb=Z;break;case 2:nb.dismiss();this.iWa=null;break;case 3:this.xW&&this.xW===Z&&this.I7a&&this.H2d(this.I7a,Z)?nb.display(Jc.EN(this.I7a),ib):nb.dismiss();this.ycb=null;break;case 4:nb.pNi(Wa),this.iWa=Z}}hpd(Z){if(this.Kc&&this.Kc.Ic)switch(Z){case 0:this.Kc.Ic.highlight();this.whc=!0;break;case 2:this.Kc.Ic.oFh();this.whc=!1;break;case 1:this.Kc.Ic.highlight();this.sBe=!0;break;case 3:this.Kc.Ic.oFh(),this.sBe=!1}}TMc(){this.D3c&&(this.whc?this.hpd(2):this.xW&&this.jqc(this.xW,2),this.Dub(null))}H2d(Z,
Da){if(!Jc.EN(Z))return!0;Z=this.hl.Wy();return pd.a.any(Z,Wa=>!Jc.EN(Wa)&&Wa.anchorShape===Da.get_shapeId())}hUe(Z,Da,Wa,ib=!1,nb=!1){if(this.D3c&&Z&&(!ib||lg.Oub(this.hl.Wy(),Z))){ib=this.B8(Z);var jc=this.xW!==ib&&!!this.xW;jc&&this.pa.p8(this.xW);this.TMc();if(ib){const cc=Jc.EN(Z);this.ycb===ib?this.H2d(Z,ib)?this.jqc(ib,4,cc,cc&&jc):this.iWa=ib:this.H2d(Z,ib)?this.jqc(ib,0,cc,Wa&&jc):this.iWa=ib;Da=!!Da&&Da===Z.commentId;(cc||Da)&&nb||this.D7k(ib,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,
Z.authorName,Z.dt.toDateString(),Z.dt.toLocaleTimeString()))}else this.hpd(0),this.Kc&&this.Kc.Ic&&this.Kc.Ic.Fd&&this.Qnd(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Kc.Ic.Fd.le+1).toString(),this.Kc.Ic.Fd.title));!nb&&jc&&this.pa.selectShape(this.xW,!0,!1);this.Dub(null)}}c4h(Z){if(this.D3c){var Da=this.B8(Z);Da?Jc.EN(Z)?this.ycb=Da:this.jqc(Da,1):this.hpd(1);this.Dub(Z)}}vMc(){this.ycb&&this.jqc(this.ycb,3);this.sBe&&!this.whc&&this.hpd(3);this.Dub(null)}B8(Z){if(!Z)return null;
try{return this.tGa.iRc(Z)}catch(Da){return Gb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",Da),null}}Dub(Z){const Da=[];var Wa=this.ycb;Z&&!Wa&&(Wa=this.xW);const ib=this.xW?this.xW:this.pa.Jp();ib||Z&&Wa||this.eDh(Da);let nb=null;const jc=[];var cc=!1;if(Jc.EN(Z)&&Wa&&0<Wa.$D().length&&(!this.I7a||Z.commentId!==this.I7a.commentId)){var Ad=Jc.K6b(Z,Wa);Ad&&Ad.isValid&&(cc=Ge.a.Hf("{"+Z.commentId+"}{1}"),Da.push(new Xf(Ad,cc,1)),cc=!0,Wa=this.tGa.$k(Wa))&&
(jc.push(Wa),(Wa=Wa.shapeNode)&&Wa.Rf&&(nb=Wa))}if(this.Xpd||ib&&0<ib.$D().length)if(Wa=this.hl.Wy())for(var Xd of Wa){if(!Jc.EN(Xd)||!this.Xpd&&Xd.anchorShape!==ib.get_shapeId()||cc&&Xd.commentId===Z.commentId)continue;Ad=this.Xpd?this.B8(Xd):ib;if(!Ad)continue;let xe=Jc.K6b(Xd,Ad);if(!xe||!xe.isValid)continue;let Ff=5;(Wa=!!this.I7a&&Xd.commentId===this.I7a.commentId)&&(Ff=0);const xg=Ge.a.Hf("{"+Xd.commentId+"}{1}");Da.push(new Xf(xe,xg,Ff));if(Ad=this.tGa.$k(Ad))jc.push(Ad),Ad=Ad.shapeNode,!nb&&
Ad&&Wa&&Ad.Rf&&(nb=Ad)}for(const xe of this.dTg)!xe||Array.contains(jc,xe)||xe.shapeNode&&xe.shapeNode.Rf||(xe.yje=!1,xe.$p||!xe.Un||xe.hy||xe.LNb());Z=null;for(const xe of jc)(Xd=xe.shapeNode)&&Xd.Rf?(Z||(Z=Xd),nb||ib!==Xd||(nb=Xd)):(xe.yje=!0,xe.Un||(Gb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),xe.Rrd()));nb||this.pa.FL()||!Z||(nb=Z);this.dTg=jc;this.CJ.xNk(new Kd(nb));this.eDh(Da)}eDh(Z){Z=Object.assign(new kd.a,{action:0,
type:0,Ada:Z,Ohb:this.Aea.Fbb?this.Aea.Fbb.Ada:null});this.Aea.xod(Z)}Qnd(Z){this.UVa.Nfa(Z)}D7k(Z,Da){this.UVa.pfh(Z,Da)}aVe(Z){this.D3c=Z}get I7a(){return this.rcd&&this.rcd.kLb?this.rcd.kLb.comment:null}static Oub(Z,Da){if(Z)for(const Wa of Z)if(Da.commentId===Wa.commentId)return!0;return!1}}Object(h.a)(lg,"CommentAnchoringHighlightsHelper",null,[]);var ve=d(43);class Ua{constructor(Z,Da,Wa,ib,nb,jc,cc){this.oc=Z;this.ua=Da;this.j5c=Wa;this.kO=ib;this.Sfk=nb;this.Rb=jc;this.zb=cc;this.Mgf=0}A1a(Z,
Da){if(Z||1!==this.k1c)if(2>this.oc.pj())this.i4h?this.NVe(5):this.NVe(1);else{const Wa=ve.a.yk("UpdateNextPopulatedContextDetails",2);this.j5c.z3d((ib,nb,jc)=>{this.etk(ib,nb,jc,Wa,Da)},Wa)}}get k1c(){return this.Mgf}etk(Z,Da,Wa,ib,nb){let jc=1;if(this.ua.Ba){const cc=this.ua.Ba.le;let Ad=!1,Xd=!1,xe=!1;Da&&Z&&(Z=Z.le,Z<cc?Ad=!0:Z===cc?Xd=!0:(xe=!0,Wa||(Ad=!0)));0<=nb&&(nb<cc?Ad=!0:nb===cc?Xd=!0:xe=!0);xe?jc=Ad||Xd?3:2:Ad?jc=4:Xd&&(jc=5)}this.NVe(jc);ib.finish();E.a.arb(this.zb,()=>{this.Rb.updateCommandUI()})}NVe(Z){this.Mgf=
Z;this.Sfk.A1a(Z,1===this.Rb.mode)}get i4h(){return!!this.ua.Ba&&this.kO.COi(this.ua.Ba)}}Object(h.a)(Ua,"CommentContextDetailsUpdateHelper",null,[1043]);var Bb=d(39);class mc{e$k(Z){if(null===Z)throw Error.argumentNull("comment");Z.setValue(Bb.a.commentId,"")}a$k(Z,Da){if(null===Z)throw Error.argumentNull("comment");Z.setValue(Bb.a.qVd,Da)}c$k(Z){if(null===Z)throw Error.argumentNull("comment");if(Z=Object(mb.a)(1068,Z))Z.ztb=ResourceStrings.anonymousCommentAuthor}TLb(Z){if(null===Z)throw Error.argumentNull("comment");
Z.setValue(Bb.a.v0b,!0)}Fph(Z,Da,Wa,ib){if(null===Z)throw Error.argumentNull("comment");if(Z=Object(mb.a)(1068,Z))Z.authorName=Da,Z.BZb=Wa,Z.QHc=ib}g$k(Z,Da){if(null===Z)throw Error.argumentNull("comment");Z.setValue(Bb.a.w0b,Da)}f$k(Z,Da){if(!Z)throw Error.argumentNull("comment");Da=Jb.c(Da);Z.setValue(Bb.a.reactions,Da)}}Object(h.a)(mc,"CommentEditor",null,[1071]);var Nc=d(32),nd=d(84),Dd=d(58);class La{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=
null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(La,"Comment",null,[]);var gb=d(299),vc=d(897),td=d(283),Nd=d(30);class Od{constructor(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd,xe,Ff,xg,Eg,De,zd){this.jea=null;this.CBb=ib;this.Jb=nb;this.ua=jc;this.hB=cc;this.C9=Ad;this.Pb=Xd;this.Qb=xe;this.pa=Ff;this.mE=xg;this.tre=Eg;this.jc=De;this.mR=zd;this.qR=Z;this.z6j=Wa;this.S7j=0===Da;this.NFh();this.joe()}dispose(){}get userName(){return this.Pb.appSettings.UserName}get userId(){return this.Pb.appSettings["387"]}get providerId(){return this.Pb.appSettings["388"]}get isTasksHistoryEnabled(){return this.Pb.ka("TasksHistoryEnabled")}get m9b(){return this.Pb.ka("PPTOBlueDotsForComments")}get Qjg(){return Rb.a("Comments.LogTasksTelemetry")}get DDa(){return this.Pb.ka("SlideResizePerfImprovementEnabled")}addComment(Z,
Da,Wa){this.dsf("",Z,Da,Wa,null,null,null,null)}a5h(Z,Da,Wa,ib,nb,jc,cc,Ad){this.dsf(Z,Da,Wa,ib,nb,jc,cc,Ad)}dsf(Z,Da,Wa,ib,nb,jc,cc,Ad){const Xd=this.qR.Ci("UserAction","AddComment");e.AFrameworkApplication.fa.Mda?this.fsf(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd):this.Pb.gf(()=>{this.fsf(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd)})}fsf(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd){this.z6j.Ytb().then(xe=>{Od.Mmh&&(Gb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.S7j,xe),this.mE.N1j(xe),Od.Mmh=
!1);this.$4h(Z,Da,Wa,ib,nb,jc,cc,Ad);Xd&&Xd.stop();return xe}).catch(xe=>{Gb.a.J(512262930,805,10,JSON.stringify(xe));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}$4h(Z,Da,Wa,ib,nb,jc,cc,Ad){if(this.ezb()){var Xd=!1,xe=0,Ff=0;ib&&(Xd=!0,xe=ib.x,Ff=ib.y);ib=this.Jb.me(15);try{var xg=this.jea;ib.nc(xg);const Eg=Nc.GraphIterator.nb(xg),De=Object(mb.a)(nd.a,this.CBb.createInstance(1074135127));this.C9.TLb(De);this.C9.e$k(De);this.C9.a$k(De,Z);xg=null;const zd=
Object(mb.a)(1068,De);if(zd){if(zd.Btb=Xd)zd.Aca=Object.assign(new vc.a,{X:xe,Y:Ff});zd.UBh=this.tre.Bmj();zd.LHc=jc;if(xg=Object(mb.a)(4,nb))zd.t0b=xg.get_shapeId();Wa&&(zd.yxa=Wa);cc&&(zd.taskInfo=cc);Ad&&(zd.textAnchoringInfo=Ad);zd.Zra=Da}let Gd=this.userId;nb=!Gd;const fd=!this.providerId,Mc=!this.userName;(nb||fd)&&Gb.a.J(512262928,805,nb&&!fd?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",nb,fd,Mc);Rb.a("Comments.UseNameInPlaceOfUserId")&&nb&&!fd&&(Gd=Mc?ResourceStrings.anonymousCommentAuthor:
this.userName);this.C9.Fph(De,this.userName,Gd,this.providerId);Mc&&this.C9.c$k(De);Eg.Cl(De,1);Gb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",Z,!!cc,!!Ad,!!xg)}finally{ib&&ib.dispose()}this.f1j(Z,Wa,Da,Ad,cc)}else Gb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}f1j(Z,Da,Wa,ib,nb){this.Qjg?Da?(Da=this.qta(Da))?(Da=this.mta(Da))?
this.mE.g1j(Z,Wa.length-1,!!ib,Da.taskInfo,nb):Gb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Gb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.mE.h1j(Z,Wa.length-1,!!ib,!!nb):this.mE.goe(Z,Wa.length-1,!!ib,!!nb)}deleteComment(Z){this.mE.$3j();if(this.ezb()){var Da=this.Jb.Ad(15);try{Da.nc(this.jea),this.UZd(Z,this.jea),Da.jd=Nd.a.deleteComment}finally{Da&&Da.dispose()}}else Gb.a.J(512262924,
805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}UZd(Z,Da){Rb.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.pa.z_()&&(Gb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.pa.Qh());const Wa=this.M5i(Z,Da);if(Wa&&0<Wa.count){this.C9.TLb(Da);for(let ib of Wa)Da=Nc.GraphIterator.nb(ib),Da.rc(39),Da.Mi();Gb.a.J(512262922,805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",Z)}else Gb.a.J(512262921,
805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",Z);this.mE.oSk()}nRa(){const Z=Date.now();this.mE.R1j();const Da=this.Wy();if(Da){var Wa=this.Jb.Ad(15);try{Wa.nc(this.ua.Ba);for(const ib of Da)this.UZd(ib.commentId,this.jea);Wa.jd=Nd.a.nRa}finally{Wa&&Wa.dispose()}Gb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-Z)}else Gb.a.J(512262920,805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}i2b(Z){const Da=
Date.now();Z?this.mE.S1j():this.mE.Q1j();const Wa=this.ua.presentation;if(Wa){var ib=Wa.slides;if(ib){var nb=this.Jb.Ad(15);try{nb.nc(Wa);for(const jc of ib){const cc=Object(mb.a)(116,jc);if(!cc||!cc.XD()){Gb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",cc);continue}const Ad=Nc.GraphIterator.nb(cc).Bb(16);for(const Xd of this.nta(cc.XD()))(Z?1===Xd.status:1)&&this.UZd(Xd.commentId,Ad)}nb.jd=Z?Nd.a.wub:Nd.a.vub}finally{nb&&nb.dispose()}Gb.a.J(512262917,
805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-Da,Z)}}}editComment(Z,Da){this.sQf(Z,Da,null)}yPi(Z,Da,Wa){this.sQf(Z,Da,Wa)}sQf(Z,Da,Wa){if(this.ezb()){var ib=this.qta(Da);if(ib){const nb=this.Jb.me(15);try{nb.nc(ib);this.C9.TLb(ib);const jc=Object(mb.a)(1068,ib);jc&&(jc.Zra=Z,jc.LHc=Wa)}finally{nb&&nb.dispose()}Gb.a.J(512262915,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",Da)}else Gb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",
Da);this.mE.W1j()}else Gb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}mGb(Z,Da){if(this.ezb()){var Wa=this.qta(Z);if(Wa){if(null===Da)throw Error.argumentNull("pos");const ib=this.Jb.me(15);try{ib.nc(Wa),this.C9.TLb(Wa),Object(mb.a)(1068,Wa).Aca=Object.assign(new vc.a,{X:Da.x,Y:Da.y})}finally{ib&&ib.dispose()}Gb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",Z)}else Gb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",
Z);this.mE.h3j(Z)}else Gb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}PCl(Z,Da,Wa){this.Pb.gf(()=>{this.QCl(Z,Da,Wa)})}QCl(Z,Da,Wa){if(this.ezb()){var ib=this.qta(Z);if(ib){var nb=this.Jb.me(15);try{nb.nc(ib);this.C9.TLb(ib);const xe=Object(mb.a)(1068,ib);if(xe){var jc=xe.reactions,cc={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,UserId:this.userId};if(Wa){let Ff;Ff=Db(jc,cc);a:{Z=Ff;var Ad;let xg={Time:new Date,
User:cc};if(Z&&Z.ReactionList){for(const [Eg,De]of Z.ReactionList.entries())if(De.Type===Da){null===(Ad=Z.ReactionList[Eg].ReactionInstances)||void 0===Ad?void 0:Ad.push(xg);Ff=Z;break a}Z.ReactionList.push({Type:Da,ReactionInstances:[xg]})}else Z={ReactionList:[{Type:Da,ReactionInstances:[xg]}]};Ff=Z}var Xd=Ff}else Xd=Db(jc,cc);this.C9.f$k(ib,Xd)}else Gb.a.J(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",Z)}finally{null===nb||void 0===nb?void 0:
nb.dispose()}}else Gb.a.J(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",Z)}else Gb.a.J(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}hGh(Z,Da,Wa){if(this.ezb()){var ib=this.qta(Z);if(ib){const nb=this.Jb.me(15);try{nb.nc(ib),this.C9.TLb(ib),this.C9.g$k(ib,Da),Object(mb.a)(1068,ib).blb=Wa,this.isTasksHistoryEnabled&&this.C9.Fph(ib,this.userName,this.userId,this.providerId)}finally{nb&&nb.dispose()}if(this.Qjg){Wa=
this.mta(ib);if(!Wa){Gb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===Da?this.mE.J3j(!!Wa.taskInfo):0===Da&&this.mE.z4j(!!Wa.taskInfo)}else 1===Da&&this.mE.K3j();Gb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",Z,Da)}else Gb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",Z)}else Gb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}Wy(){return this.nta(this.jea)}nta(Z){const Da=
[];if(!Z||39!==Z.type)return Da;Z=Nc.GraphIterator.nb(Z);for(var Wa=Z.Gi();Wa;){if(40===Wa.type){const ib=Object(mb.a)(1068,Wa).yxa;Wa=this.mta(Wa);if(ib)for(const nb of Da)nb.commentId===ib&&(nb.Children||(nb.Children=[]),nb.Children.push(Wa));else Da.push(Wa)}Wa=Z.jp()}return Da}NFh(){const Z=this.ua.Ba;this.jea=Z?Nc.GraphIterator.nb(Z).Bb(16):null}r$i(){if(!this.jea)return!1;const Z=Nc.GraphIterator.nb(this.jea);if(this.hB.Z_f(this.jea))return!0;let Da=Z.Gi();for(;Da;){if(this.hB.Z_f(Da))return!0;
Da=Z.jp()}return!1}CXi(Z,Da){return this.EVf(Z,Da,!1)}OXi(Z,Da){return this.EVf(Z,Da,!0)}EVf(Z,Da,Wa){if(!Z)return null;if(Z=Z.XD()){Z=this.Qb.Nc(Z);let ib=Wa?Z.a7b():Z.Gi();for(;ib;){if(!(this.hB.J_c(ib)||Da&&0!==this.hB.QRc(ib)))return this.mta(ib);ib=Wa?Z.Jta():Z.jp()}}return null}COi(Z){return Z?(Z=Z.XD())?!!this.Qb.Nc(Z).Gi():!1:!1}RRc(Z){if(!Z)return 0;var Da=Z.XD();Z=0;if(Da){Da=this.Qb.Nc(Da);let Wa=Da.Gi();for(;Wa;)this.hB.J_c(Wa)||Z++,Wa=Da.jp()}return Z}ezb(){return!!this.jea&&this.jea.isConnected}M5i(Z,
Da){Da=Nc.GraphIterator.nb(Da);var Wa=Da.Gi();const ib=new m.a;for(;Wa;){const nb=this.hB.ORc(Wa),jc=Object(mb.a)(1068,Wa).yxa;Z!==nb&&Z!==jc||ib.add(Wa);Wa=Da.jp()}return ib}qta(Z){const Da=Nc.GraphIterator.nb(this.jea);let Wa=Da.Gi();for(;Wa;){const ib=this.hB.ORc(Wa);if(Z===ib)return Wa;Wa=Da.jp()}return null}E9d(Z){Z=this.qta(Z);if(!Z)return null;const Da=Object(mb.a)(1068,Z).yxa;return Wb.a.Wa(Da)?Z:this.qta(Da)}mta(Z){if(Rb.a("GetCommentFromGraphNodeNullSafety")){var Da=Object(mb.a)(1068,Z);
if(!Da)return null;var Wa=new La;Wa.dt=Da.H1b;Wa.text=Da.Zra;Wa.status=this.hB.QRc(Z);Wa.userId=Da.BZb;Wa.commentId=this.hB.ORc(Z);Wa.authorName=Da.authorName;Wa.providerId=Da.QHc;Wa.anchorShape=Da.t0b;Wa.pos=Object.assign(new gb.a,{X:Da.Aca.X,Y:Da.Aca.Y});Wa.taskInfo=Da.taskInfo;Wa.textAnchoringInfo=Da.textAnchoringInfo;this.m9b&&(Wa.changesData=Da.changesData,Wa.isUnread=this.mR.instance&&this.mR.instance.chg(Da));dd(this.Pb)&&(Wa.reactions=Da.reactions);return Wa}if(Z){Da=this.hB.ORc(Z);Wa=new La;
const ib=Object(mb.a)(1068,Z);if(ib){Wa.dt=ib.H1b;Wa.anchorShape=ib.t0b;const nb=ib.Aca;Wa.pos=Object.assign(new gb.a,{X:nb.X,Y:nb.Y});Wa.text=ib.Zra;Wa.authorName=ib.authorName;Wa.userId=ib.BZb;Wa.providerId=ib.QHc;this.m9b&&(Wa.changesData=ib.changesData,Wa.isUnread=this.mR.instance&&this.mR.instance.chg(ib));dd(this.Pb)&&(Wa.reactions=ib.reactions)}Wa.status=this.hB.QRc(Z);Wa.commentId=Da;Wa.taskInfo=Object(mb.a)(1068,ib).taskInfo;Wa.textAnchoringInfo=Object(mb.a)(1068,ib).textAnchoringInfo;return Wa}return null}v9a(Z){if(!Z)return[];
const Da=this.nta(Z.XD());if(!Da||this.DDa&&!Da.length){if(!Da)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return Da}Da.sort((Wa,ib)=>{var nb=this.jc.$9d(Z,Wa.anchorShape);nb=nb?nb.mD:new Dd.a(0,0);var jc=this.jc.$9d(Z,ib.anchorShape);jc=jc?jc.mD:new Dd.a(0,0);nb.y+=Wa.pos.Y;jc.y+=ib.pos.Y;nb.x+=Wa.pos.X;jc.x+=ib.pos.X;let cc=nb.y-jc.y;cc||(cc=nb.x-jc.x)||(cc=+Wa.dt-+ib.dt);return cc});return Da}Jjj(Z){var Da=this.ua.presentation;if(!Da)return null;Da=Da.slides;
if(!Da)return null;for(const Wa of Da)if(Da=Object(mb.a)(td.a,Wa))for(const ib of this.nta(Da.XD())){if(Z===ib.commentId)return Wa;if(ib.Children)for(const nb of ib.Children)if(Z===nb.commentId)return Wa}return null}joe(){let Z=0,Da=0;var Wa=this.ua.presentation;if(Wa){var ib=Wa.slides;if(ib){Wa=new m.a;for(const nb of ib)if((ib=Object(mb.a)(td.a,nb))&&ib.XD())for(const jc of this.nta(ib.XD()))Jc.EN(jc)?Da+=1:jc.textAnchoringInfo&&Wa.add(jc.commentId),Z+=1;this.mE.joe(Z,Da,Wa)}}}}Od.Mmh=!0;Object(h.a)(Od,
"CommentManager",null,[1069,1070,106]);var Oc=d(132);class Af{constructor(Z,Da,Wa,ib){this.kO=Z;this.Kc=Da;this.Fb=Wa;this.yc=ib}Tij(Z){if(null===Z)throw Error.argumentNull("comment");if(Z=this.iRc(Z))if(Z=this.$k(Z))return Z.xa.xa;return null}f3i(Z){if(null===Z)throw Error.argumentNull("comment");if(Z=this.iRc(Z)){if(Z.ud){var Da=this.yc.JN(Z);if(!Da)return Gb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",Z.get_shapeId()),null;Da=Da.sc(this.Fb.Ma);
return Da&&Da.htmlElement?Oc.a.fda(new Sys.UI.Bounds(Da.htmlElement.clientLeft,Da.htmlElement.clientTop,Da.htmlElement.clientWidth,Da.htmlElement.clientHeight)):(Gb.a.J(595133521,805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",Z.get_shapeId()),null)}if(Z=this.$k(Z))return Z=Z.xa.xa,Oc.a.fda(new Sys.UI.Bounds(Z.clientLeft,Z.clientTop,Z.clientWidth,Z.clientHeight))}return null}iRc(Z){if(null===Z)throw Error.argumentNull("comment");if(!Z.anchorShape)return null;Z=
this.kO.E9d(Z.commentId);Z=this.kO.mta(Z);if(!Z)return null;const Da=this.Kc.Ic?this.Kc.Ic.Fd:null;return Da?Da.wC(Z.anchorShape):(Gb.a.J(557090388,805,50,"ActiveSlide is null"),null)}g3i(Z){if(null===Z)throw Error.argumentNull("comment");if(!Z.anchorShape)return 0;if(Z=this.iRc(Z))if(Z=this.$k(Z))return Z.rotation;return 0}$k(Z){if(null===Z)throw Error.argumentNull("shapeNode");return Object(mb.a)(117,Z.sc(this.Fb.Ma))}}Object(h.a)(Af,"CommentMarkerAnchorHelper",null,[1037]);var Ae=d(582),Ye=d(115);
class Wd{constructor(Z,Da,Wa){this.J9=Z;this.Kc=Da;this.Pqe=Wa}BOi(Z){const Da=Object(mb.a)(1068,this.Pqe.qta(Z.commentId));if(!Da)throw n.ULS.sendTraceTag(595203538,805,10,"There is no graph node for comment {0}",Z.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!Da.Aca}Vgj(Z,Da){if(!Z)throw Error.argumentNull("commentMarkerViewElement");if(!Da)throw Error.argumentNull("comment");if(!this.Pqe.qta(Da.commentId))return n.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",
Da.commentId),new Dd.a(0,Number.MIN_VALUE);const Wa=Z.fp;Z=Z.bhd;if(!this.BOi(Da)||!Da.pos.X&&!Da.pos.Y){if(Wa)return Da=new Dd.a(Wa.$b-Wa.hc-Wd.Umd.width-Wd.Imh.width,Wd.Imh.height),Wd.jag(Da,Wa,Z),Da;if(this.Kc.Ic&&this.Kc.Ic.JB)return new Dd.a(this.Kc.Ic.JB.clientWidth-Wd.Umd.width,0);n.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new Dd.a(0,0)}Da=new Dd.a(this.J9.Pe(Da.pos.X,0),this.J9.Pe(Da.pos.Y,
1));Da=new Dd.a(Da._x-Wd.F_a._x,Da._y-Wd.F_a._y);Wa&&(Da._x=Math.max(0,Da._x),Da._y=Math.max(0,Da._y),Da._x=Math.min(Da._x,Wa.$b-Wa.hc-Wd.Umd.width),Da._y=Math.min(Da._y,Wa.Yb-Wa.kc-Wd.Umd.height),Wd.jag(Da,Wa,Z));return Da}NCl(Z,Da){var Wa=new Dd.a(Z.element.offsetLeft,Z.element.offsetTop);Wa=new Dd.a(Wa._x+Wd.F_a._x,Wa._y+Wd.F_a._y);const ib=Z.fp;ib&&Z.bhd%360&&Wd.vxf(Wa,0-Z.bhd,ib.Wf());Da.pos.X=this.J9.rf(Wa._x,0);Da.pos.Y=this.J9.rf(Wa._y,1);this.Pqe.mGb(Da.commentId,new Dd.a(Da.pos.X,Da.pos.Y))}static jag(Z,
Da,Wa){if(Da&&Wa%360){var ib=new Dd.a(Z._x+Wd.F_a._x,Z._y+Wd.F_a._y);Wd.vxf(ib,Wa,Da.Wf());Z.update(ib._x-Wd.F_a._x,ib._y-Wd.F_a._y)}}static vxf(Z,Da,Wa){Z.nM(0-Wa._x,0-Wa._y);Da=Ae.a.PZd(Da);Z.update(Z._x*Math.cos(Da)-Z._y*Math.sin(Da)+Wa._x,Z._x*Math.sin(Da)+Z._y*Math.cos(Da)+Wa._y)}}Wd.Umd=new Ye.a(20,20);Wd.Imh=new Ye.a(4,4);Wd.F_a=new Dd.a(4,20);Object(h.a)(Wd,"CommentMarkerPositionHelper",null,[1038]);var je=d(134),dg=d(75),nf=d(49);class Cb{constructor(Z,Da){this.tIa=this.HHa=this.kze=null;
this.ncc=Z;this.Mq=Da}Cv(){return!0}Tu(Z){if(!Z)return!1;this.tIa=this.ncc.element.style;this.kze=new Dd.a(Z.clientPoint.x,Z.clientPoint.y);this.HHa=new Dd.a(parseInt(this.tIa.left),parseInt(this.tIa.top));this.Cw(Z);return!0}Cw(Z){if(!Z)return!1;Z=this.U3f(new Dd.a(Z.clientPoint.x,Z.clientPoint.y),this.kze);this.tIa.left=nf.a.Pc(this.HHa._x+Z._x);this.tIa.top=nf.a.Pc(this.HHa._y+Z._y);return!0}ao(Z){if(Z){Z=this.U3f(new Dd.a(Z.clientPoint.x,Z.clientPoint.y),this.kze);var Da=this.HHa._x+Z._x,Wa=this.HHa._y+
Z._y,ib=this.ncc.fp;ib&&(Da=Math.max(ib.hc,Da),Da=Math.min(ib.$b-this.ncc.element.clientWidth,Da),Wa=Math.max(ib.kc,Wa),Wa=Math.min(ib.Yb-this.ncc.element.clientHeight,Wa),Z._x=Da-this.HHa._x,Z._y=Wa-this.HHa._y);this.tIa.left=nf.a.Pc(Da);this.tIa.top=nf.a.Pc(Wa);this.ncc.CZg(Z)}}ou(){this.tIa.left=nf.a.Pc(this.HHa._x);this.tIa.top=nf.a.Pc(this.HHa._y)}U3f(Z,Da){Z=Dd.a.bV(Z,Da);return new Dd.a(this.Mq.Qm(Z.x),this.Mq.Qm(Z.y))}}Object(h.a)(Cb,"CommentMarkerDragAdapter",null,[240]);class Cf{constructor(Z,
Da,Wa,ib,nb,jc,cc,Ad){this.N9=null;this.rWa=this.sWa=!1;if(!Da)throw Error.argumentNull("parentElement");this.hCb=Ad;this.B9=Z;this.kq=Wa;this.Sla=ib;this.KC=nb;this.Y4c=cc;this.zm=document.createElement("div");this.zm.className=Jc.jPc(Z)?this.KC.WXg:this.KC.VXg;this.zm.title=ResourceStrings.L_CommentMarkerTooltip;this.zm.style.display=this.Y4c||this.hCb?"none":"block";this.zm.setAttribute("data-pptcommentid",String.format("{0}",Z.commentId));this.gA=document.createElement("img");this.gA.alt=ResourceStrings.L_CommentMarkerTooltip;
this.gA.src=Wa.frame.qk(Wa.frame.NS+".png");this.gA.setAttribute(je.a.ef,je.a.yu);this.zm.appendChild(this.gA);this.v1a();this.frame.Zc.pb(Ab.a.click,this.zm,Object(oa.a)(this,this.iC,"clickHandler"));Jc.nPc&&(kc.a.addHandler(this.zm,Ab.a.mq,Object(oa.a)(this,this.Uwa,"mouseOverHandler")),kc.a.addHandler(this.zm,Ab.a.Ns,Object(oa.a)(this,this.Yic,"mouseOutHandler")));Jc.jIc&&kc.a.addHandler(this.gA,Ab.a.mouseDown,Object(oa.a)(this,this.Amc,"preventNativeDragMouseDownHandler"));Da.appendChild(this.zm);
jc||this.HXd()}dispose(){this.gA&&(Jc.jIc&&kc.a.removeHandler(this.gA,Ab.a.mouseDown,Object(oa.a)(this,this.Amc,"preventNativeDragMouseDownHandler")),this.frame.Zc.yb(Ab.a.click,this.zm,Object(oa.a)(this,this.iC,"clickHandler")),this.gA.parentNode&&this.gA.parentNode.removeChild(this.gA),this.gA=null);this.zm&&(Jc.nPc&&(kc.a.removeHandler(this.zm,Ab.a.mq,Object(oa.a)(this,this.Uwa,"mouseOverHandler")),kc.a.removeHandler(this.zm,Ab.a.Ns,Object(oa.a)(this,this.Yic,"mouseOutHandler"))),this.Sla&&(this.Sla.gUd(),
this.Sla.$E(this.zm,this.N9)),this.zm.parentNode&&this.zm.parentNode.removeChild(this.zm));this.kq=this.B9=null}get comment(){return this.B9}get element(){return this.zm}get frame(){return this.kq.frame}HXd(){this.Sla&&(this.N9=new Cb(this,Xc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Sla.NJ(this.zm,this.N9))}updatePosition(Z){this.zm.style.left=nf.a.Pc(Z._x-(this.kq.isRightToLeft?this.KC.KDe:0));this.zm.style.top=nf.a.Pc(Z._y)}CZg(Z){this.kq.mGb(this.B9,Z)}select(Z){this.sWa=
Z;this.v1a()}activate(Z){this.rWa=Z;this.v1a()}vvh(){}setVisibility(Z){this.zm.style.display=Z&&!this.hCb?"block":"none"}v1a(){this.hCb||(this.gA.className=Jc.jPc(this.B9)?this.sWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.ZXg):this.rWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.XXg):dg.getImageClassWithCluster(this.frame.NS,this.KC.YXg):this.sWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.UXg):this.rWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.JDe):dg.getImageClassWithCluster(this.frame.NS,
this.KC.Cic))}get fp(){return null}get bhd(){return 0}iC(Z){if(Z.sA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.B9,null,!1,!0,Z.Xf,1,!1);Z=Z.qc;Z.preventDefault();Z.stopPropagation();return!0}Uwa(){this.frame.Pqb(this.B9,1)}Yic(){this.frame.Pqb(null,1)}Amc(Z){Z.preventDefault()}}Object(h.a)(Cf,"LegacyCommentMarkerViewElement",null,[1085]);var of=d(97),Lg=d(642);class vd{constructor(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd){this.N9=null;this.xxg=this.rWa=this.sWa=!1;if(!Da)throw Error.argumentNull("parentElement");
this.B9=Z;this.kq=Wa;this.Sla=ib;this.KC=nb;this.tGa=jc;this.B3c=cc;this.Y4c=Xd;this.zm=document.createElement("div");this.zm.className=Jc.jPc(Z)?this.KC.WXg:this.KC.VXg;Sys.UI.DomElement.addCssClass(this.zm,"CommentMarker");this.zm.title=ResourceStrings.L_CommentMarkerTooltip;this.zm.style.display="none";this.zm.setAttribute("data-pptcommentid",String.format("{0}",Z.commentId));this.gA=document.createElement("img");this.gA.alt=ResourceStrings.L_CommentMarkerTooltip;this.gA.src=Wa.frame.qk(Wa.frame.NS+
".png");this.gA.setAttribute(je.a.ef,je.a.yu);this.zm.appendChild(this.gA);this.v1a();this.frame.Zc.pb(Ab.a.click,this.zm,Object(oa.a)(this,this.iC,"clickHandler"));Jc.nPc&&(kc.a.addHandler(this.zm,Ab.a.mq,Object(oa.a)(this,this.Uwa,"mouseOverHandler")),kc.a.addHandler(this.zm,Ab.a.Ns,Object(oa.a)(this,this.Yic,"mouseOutHandler")));Jc.jIc&&kc.a.addHandler(this.gA,Ab.a.mouseDown,Object(oa.a)(this,this.Amc,"preventNativeDragMouseDownHandler"));Da.appendChild(this.zm);Ad||this.HXd()}dispose(){this.gA&&
(Jc.jIc&&kc.a.removeHandler(this.gA,Ab.a.mouseDown,Object(oa.a)(this,this.Amc,"preventNativeDragMouseDownHandler")),this.frame.Zc.yb(Ab.a.click,this.zm,Object(oa.a)(this,this.iC,"clickHandler")),this.gA.parentNode&&this.gA.parentNode.removeChild(this.gA),this.gA=null);this.zm&&(Jc.nPc&&(kc.a.removeHandler(this.zm,Ab.a.mq,Object(oa.a)(this,this.Uwa,"mouseOverHandler")),kc.a.removeHandler(this.zm,Ab.a.Ns,Object(oa.a)(this,this.Yic,"mouseOutHandler"))),this.Sla&&(this.Sla.gUd(),this.Sla.$E(this.zm,this.N9)),
this.zm.parentNode&&this.zm.parentNode.removeChild(this.zm));this.kq=this.B9=null}get comment(){return this.B9}get element(){return this.zm}get frame(){return this.kq.frame}HXd(){this.Sla&&(this.N9=new Cb(this,Xc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Sla.NJ(this.zm,this.N9))}updatePosition(){const Z=this.B3c.Vgj(this,this.comment);this.zm.style.left=Z._x+"px";this.zm.style.top=Z._y+"px"}CZg(){this.B3c.NCl(this,this.comment)}select(Z){this.sWa=Z;this.v1a();this.onVisibilityChange()}activate(Z){this.rWa=
Z;this.v1a();this.onVisibilityChange()}vvh(Z){this.xxg=Z;this.v1a();this.onVisibilityChange()}setVisibility(Z){this.Y4c=!Z;this.onVisibilityChange()}onVisibilityChange(){!this.Y4c&&(this.sWa||this.rWa||this.xxg)?(this.updatePosition(this.frame.DCa(this.comment.pos.X,this.comment.pos.Y)),this.zm.style.display="block",of.a.zI(this.zm,Lg.a.vKc)):(this.zm.style.display="none",of.a.pKa(this.zm,Lg.a.vKc))}get fp(){return this.tGa.f3i(this.B9)}get bhd(){return this.tGa.g3i(this.B9)}v1a(){this.gA.className=
Jc.jPc(this.B9)?this.sWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.ZXg):this.rWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.XXg):dg.getImageClassWithCluster(this.frame.NS,this.KC.YXg):this.sWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.UXg):this.rWa?dg.getImageClassWithCluster(this.frame.NS,this.KC.JDe):dg.getImageClassWithCluster(this.frame.NS,this.KC.Cic)}iC(Z){if(Z.sA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.B9,null,!1,!0,Z.Xf,1,!1);Z=Z.qc;Z.preventDefault();
Z.stopPropagation();return!0}Uwa(){this.gA.className=dg.getImageClassWithCluster(this.frame.NS,this.KC.JDe)}Yic(){this.gA.className=dg.getImageClassWithCluster(this.frame.NS,this.KC.Cic)}Amc(Z){Z.preventDefault()}}Object(h.a)(vd,"ModernCommentMarkerViewElement",null,[1085]);class Lh{constructor(Z,Da,Wa,ib,nb,jc){this.tGa=Z;this.B3c=Da;this.KC=Wa;this.qdc=nb;this.hCb=jc;ib.Ytb().then(cc=>{cc||this.CWe(!1)})}dispose(){this.KC=null}create(Z,Da,Wa,ib,nb,jc){if(this.qdc){const cc=this.tGa.Tij(Z);return new vd(Z,
cc||Da,Wa,ib,this.KC,this.tGa,this.B3c,nb,jc)}return new Cf(Z,Da,Wa,ib,this.KC,nb,jc,this.hCb)}CWe(Z){this.hCb=this.qdc=Z;this.KC.CWe(Z)}}Object(h.a)(Lh,"CommentMarkerViewElementFactory",null,[1039,106]);var tf=d(78);class Ue extends tf.a{constructor(){super()}bbi(Z){this.addHandler(Ue.pyh,Z)}g0g(){this.raiseEvent(Ue.pyh)}}Ue.pyh="S";Object(h.a)(Ue,"ATransactionCompletedProcessor",tf.a,[1084]);var ff=d(40);class Ef extends Ue{constructor(Z,Da,Wa){super();this.hik=Z;this.A5c=Da;this.CX=Wa}get index(){return 0}run(){this.hik()}eHf(Z,
Da){Da.property!==Bb.a.Aca&&Da.property!==Bb.a.Zra&&Da.property!==Bb.a.commentId&&Da.property!==Bb.a.v0b&&Da.property!==Bb.a.w0b&&Da.property!==Bb.a.Tsc&&Da.property!==Bb.a.Ssc&&Da.property!==Bb.a.reactions||this.g0g()}PGf(Z,Da){Da.property!==ff.a.SA&&Da.property!==Bb.a.v0b||this.g0g()}Azj(){this.A5c.yd(39).jk(Object(oa.a)(this,this.PGf,"commentContentPropertyChanged"));this.A5c.yd(40).jk(Object(oa.a)(this,this.eHf,"commentPropertyChanged"));this.CX.D9k(this)}KAl(){this.A5c.yd(40).Cm(Object(oa.a)(this,
this.eHf,"commentPropertyChanged"));this.A5c.yd(39).Cm(Object(oa.a)(this,this.PGf,"commentContentPropertyChanged"))}}Object(h.a)(Ef,"CommentPropertyTracker",Ue,[]);var wh=d(660),xh=d(143);class qd extends wh.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new xh.a,{T_:qd.getTypeName(),B_:qd.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(h.a)(qd,"CommentSmartReplySignal",
wh.a,[]);var Hf=d(609);class Ag extends Hf.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new xh.a,{T_:Ag.getTypeName(),B_:Ag.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(h.a)(Ag,"SmartReply",Hf.a,[]);var He=d(348),af=d(379);class yd{constructor(Z,Da){this.POh=Z;this.Y7e=Da}initialize(){this.Y7e.execute(Z=>{const Da=
Ag.getTypeName();Z.pia(Da);Z.kKa(Da,Object(oa.a)(this,this.s_,"handleAnnotationEvent"))})}invoke(Z,Da){const Wa=Object.assign(new He.a,{parentPath:["Signal",qd.getTypeName()],items:[Object.assign(new af.a,{body:Object.assign(new qd,{commentId:Z,comment:Da})})]});this.Y7e.execute(ib=>{ib.submitOperation(Wa)})}s_(Z){if(Z){var Da=new m.a;if(Z&&Z.CommentId&&Z.ResultSets&&0<Z.ResultSets.length&&Z.ResultSets[0].Documents&&0<Z.ResultSets[0].Documents.length){for(const Wa of Z.ResultSets[0].Documents)Da.add(Wa.Caption);
0<Da.count&&this.POh.dGk(Z.CommentId,Da.toArray())}else Gb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Gb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(yd,"CommentSmartReplyProvider",null,[]);var me=d(314),Ic=d(288),Fe=d(282),Uc=d(98),Uf=d(181),vg=d(130),Yg=d(63),Cc=d(437);class Rc{constructor(Z,Da,Wa,ib,nb){this.Sqe=this.Fre=this.cse=this.L2c=0;this.hug=new m.a;this.rCe=this.vug=this.Uqe=this.Vgc=this.Mye=0;this.mAe=new m.a;this.kpe=
this.jpe=this.lpe=this.ipe=0;this.gsg=new m.a;this.dad=new m.a;this.Dre=this.Bre=this.Cre=this.Ere=this.awe=this.$ve=this.bwe=this.cwe=0;this.O2c=this.$ue=this.E3c=Ub.App.Vm;this.iXa=null;this.mCe=this.nCe=this.hbd=this.Gbd=this.r$c=this.hpe=0;if(!Z)throw Error.argumentNull("coreEventHandler");if(!Da)throw Error.argumentNull("appSettingsManager");this.Oc=Z;this.Pb=Da;this.ua=Wa;this.hB=ib;this.Nqe=nb;this.Oc.fC(Object(oa.a)(this,this.Do,"onSessionRehydrated"));this.Oc.KA(Object(oa.a)(this,this.DB,
"onSessionEnd"))}get aWd(){return this.Pb.ka("CommentTextAnchoringCreateNewEnabled")}get Ptl(){return this.Pb.ka("TasksForCommentsEnabled")}goe(Z,Da,Wa,ib){this.L2c+=1;this.Sqe+=Da;Wa&&(this.ipe+=1,this.mAe.add(Z));ib&&(this.hpe+=1)}h1j(Z,Da,Wa,ib){this.hbd=ib?this.hbd+1:this.hbd;this.goe(Z,Da,Wa,ib)}g1j(Z,Da,Wa,ib,nb){(nb=!!nb)&&ib?this.nCe+=1:nb&&(this.mCe+=1);this.goe(Z,Da,Wa,nb)}l4j(){this.lpe+=1}i4j(){this.jpe+=1}j4j(){this.kpe+=1}k4j(Z,Da,Wa,ib){this.zjg(Z.commentId)||(Wa&&!this.QVj(Da,Wa.$D(),
ib)?this.Zqg(Z,Wa,!0):this.Zqg(Z,Wa,!1))}oSk(){this.Fre+=1}$3j(){this.Ere+=1}R1j(){this.Cre+=1}Q1j(){this.Bre+=1}S1j(){this.Dre+=1}W1j(){this.cse+=1}h3j(Z){this.hug.contains(Z)||(this.Mye+=1,this.hug.add(Z))}J3j(Z){this.r$c=Z?this.r$c+1:this.r$c;this.Vgc+=1}z4j(Z){this.Gbd=Z?this.Gbd+1:this.Gbd}K3j(){this.Vgc+=1}joe(Z,Da,Wa){this.Uqe=Z;this.rCe=Da;this.gsg=Wa;this.Iqg()}N1j(Z){this.vug=Z?1:2}Nrk(Z){this.E3c===Ub.App.Vm&&(this.E3c=new Date,this.aGa("OnCollabCornerCommentsEnabled",this.E3c,Z),this.vUe("CollabCornerCommentsEnabled",
this.E3c))}itk(Z){this.$ue===Ub.App.Vm&&(this.$ue=new Date,this.aGa("OnFloatingCommentsRendered",this.$ue,Z))}Jqk(Z){this.O2c===Ub.App.Vm&&(this.O2c=new Date,this.aGa("OnAllFloatingContainersVisible",this.O2c,Z),this.vUe("AllFloatingContainersVisible",this.O2c))}ksk(Z){const Da=new Date;this.aGa("OnDeepLinkedCommentSelected",Da,Z);this.vUe("DeepLinkedCommentSelected",Da)}zjg(Z){return this.gsg.contains(Z)||this.dad.contains(Z)}QVj(Z,Da,Wa){let ib=0;for(const jc of Da)if(Da=Object(mb.a)(477,jc.sc(Wa))){Da=
Da.htmlElement.getElementsByClassName(Uc.a.L1b);for(let cc=0;cc<Da.length;cc++){var nb=Da[cc];const Ad=me.a.Be(nb,Uc.a.ZVd);Ad&&(ib+=pd.a.contains(Ad,Z)?1:0);(nb=me.a.Be(nb,Uc.a.VVd))&&(ib+=pd.a.contains(nb,Z)?1:0);if(2===ib)return!0}}return!1}Zqg(Z,Da,Wa){if(Z&&Z.textAnchoringInfo&&!this.zjg(Z.commentId))if(Z.textAnchoringInfo.EndPos<=Z.textAnchoringInfo.StartPos){if(Da){if(Wa){this.awe+=1;this.dad.add(Z.commentId);return}this.bwe+=1}else this.cwe+=1;this.dad.add(Z.commentId)}else 0>=Z.textAnchoringInfo.TextBodyLength&&
(this.mAe.contains(Z.commentId)?this.mAe.remove(Z.commentId):(this.$ve+=1,this.dad.add(Z.commentId)))}aGa(Z,Da,Wa){const ib={};ib.Event=Z;ib.Time=Da.getTime();ib.SlideId=Wa.toString();ib.LandingSlide=this.hbj();ib.SessionDimensions=this.R9d();ib.PerfMetrics=this.s3i();ib.CommentPerfMetrics=this.O5i();ib.CommentFileType=this.Nqe;ib.CommentDeepLinkedOpen=!!this.Pb.Ga("CurrentCommentId");ib.StandaloneCommentJsEnabled=!0;ib.LoadSharedCommentsEarly=!0;ib.FetchFullAppSettingsOnBoot=this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",
!1);ib.PrefetchCommentCloudPolicy=this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",!1);Gb.a.J(509703831,805,15,Jb.c(ib))}Iqg(){Gb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.Uqe,this.Nqe);Gb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.rCe);Gb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.aWd,this.Ptl)}log(){Gb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",
this.L2c,this.cse,this.Fre,this.Sqe/this.L2c,this.Mye,this.Vgc,this.Uqe,this.Nqe,this.vug);Gb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.rCe,this.ipe,this.lpe,this.jpe,this.kpe,this.bwe,this.$ve,this.cwe,this.awe);Gb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.Ere,this.Cre,this.Bre,
this.Dre);this.g4j()}g4j(){Gb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.hpe);const Z={};Z.ResolvedTasksCount=this.r$c;Z.UnresolvedTasksCount=this.Gbd;Z.TasksCreatedNewThreadCount=this.hbd;Z.TasksReassignedInReplyCount=this.nCe;Z.TasksCreatedInReplyCount=this.mCe;Gb.a.J(509703823,845,15,Jb.c(Z))}Do(){this.Iqg()}DB(){this.log()}hbj(){if(this.iXa)return this.iXa;this.iXa={};var Z=parseInt(this.Pb.Ga("CurrentSlideId"));Z=Z!==Yg.a.empty.sid?Yg.a.UE(Z,0):this.ua.presentation.e$a(0);if(!Z)return this.iXa;
this.iXa.SlideId=Z.toString();if(Z=this.ua.presentation.i$d(Z.sid))Z=Object(mb.a)(116,Z).XD(),this.iXa.HasComments=this.hB.Uag(Z),this.iXa.HasActiveComments=this.hB.Jag(Z);return this.iXa}R9d(){const Z={};Z.Ring=e.AFrameworkApplication.gd.Ring;Z.Host=e.AFrameworkApplication.gd.Host;Z.UiHost=e.AFrameworkApplication.gd.UiHost;Z.SessionOrigin=e.AFrameworkApplication.gd.SessionOrigin;Z.ApplicationMode=e.AFrameworkApplication.gd.ApplicationMode;Z.Browser=e.AFrameworkApplication.gd.Browser;Z.Os=e.AFrameworkApplication.gd.Os;
return Z}s3i(){const Z={};Z[Ic.a.CPb]=eb.a.instance.hh(Ic.a.CPb);Z.DocPageNavigationStart=eb.a.instance.hh("DocPageNavigationStart");Z[Ic.a.L4b]=eb.a.instance.hh(Ic.a.L4b);Z[Cc.a.gSe]=eb.a.instance.hh(Cc.a.gSe);Z[Cc.a.fSe]=eb.a.instance.hh(Cc.a.fSe);Z[Cc.a.ukh]=eb.a.instance.hh(Cc.a.ukh);Z[Cc.a.k2d]=eb.a.instance.hh(Cc.a.k2d);Z[Cc.a.l2d]=eb.a.instance.hh(Cc.a.l2d);Z[Cc.a.j2d]=eb.a.instance.hh(Cc.a.j2d);Z[Cc.a.VUd]=eb.a.instance.hh(Cc.a.VUd);Z[Ic.a.Bvd]=0<Fe.a.instance.Rfh();return Z}O5i(){const Z=
{};Z[$b.a.YVd]=eb.a.instance.hh($b.a.YVd);Z[$b.a.cWd]=eb.a.instance.hh($b.a.cWd);Z[$b.a.D8b]=eb.a.instance.hh($b.a.D8b);Z[$b.a.Vde]=eb.a.instance.hh($b.a.Vde);Z[$b.a.gXe]=eb.a.instance.hh($b.a.gXe);Z[$b.a.V8b]=eb.a.instance.hh($b.a.V8b);Z[$b.a.Wde]=eb.a.instance.hh($b.a.Wde);Z[$b.a.Tne]=eb.a.instance.hh($b.a.Tne);Z[$b.a.W3d]=eb.a.instance.hh($b.a.W3d);Z[$b.a.X3d]=eb.a.instance.hh($b.a.X3d);Z[$b.a.Ppd]=eb.a.instance.hh($b.a.Ppd);Z[$b.a.aYd]=eb.a.instance.hh($b.a.aYd);Z[$b.a.$Xd]=eb.a.instance.hh($b.a.$Xd);
return Z}Lij(){const Z=eb.a.instance.hh("DocPageNavigationStart");if(!eb.a.instance.hh(Ic.a.CPb))return Z;const Da=eb.a.instance.hh(Ic.a.CPb);return 6E4>Z-Da?Da:Z}vUe(Z,Da){const Wa=[];Array.add(Wa,Object.assign(new vg.a,{name:"EventName",string:Z}));qc.a.sendActivityEvent(Object.assign(new Uf.a,{name:"CommentsBootEvents",durationMs:Da.getTime()-this.Lij(),dataFields:Wa}))}}Object(h.a)(Rc,"CommentTelemetryManager",null,[1067]);var Ve=d(685),ob=d(686),Mb=d(687);class nc extends Ve.a{constructor(Z,
Da){super();this.t$j=Z;this.Bi=Da;this.Ave=[new ob.a(Uc.a.SGf,null),new ob.a(Uc.a.TGf,null),new ob.a(Uc.a.UGf,null),new ob.a(Uc.a.XGf,null),new ob.a(Uc.a.aHf,null),new ob.a(Uc.a.bHf,null),new ob.a(Uc.a.$Gf,null),new ob.a(Uc.a.VGf,null),new ob.a(Uc.a.WGf,null),new ob.a(Uc.a.YGf,null),new ob.a(Uc.a.ZGf,null)]}get isInHighContrastMode(){return!!this.Bi&&this.Bi.isInHighContrastMode}get dyb(){return this.t$j}get Hce(){return this.Ave}nkc(Z,Da){var Wa=this.u_.qja;if(Wa&&0===Wa.type&&(Wa=this.u_.qja.Ada,
Wa=Object(z.a)(Array,Wa)?Wa:null)){var ib=null,nb=null,jc=new Na.a;for(const cc of Wa)cc.ilc.isValid&&Array.contains(cc.ilc.paragraphs,Z)&&(0===cc.state?ib=cc.commentId:1===cc.state&&(nb=cc.commentId),jc.$(cc.commentId,cc.ilc));this.tei(Da.querySelectorAll("*"),jc,Z,ib,nb)}}$8b(Z,Da){Z=Object(z.a)(Array,Z)?Array.isArray(Z)?Z:null:null;if(!Z||0<Z.length&&!Object(mb.a)(Xf,Z[0]))return Da;for(const Wa of Z)if(Wa.ilc.isValid)for(const ib of Wa.ilc.paragraphs)ib&&(Mb.b(ib),Da.add(ib));return Da}xVi(Z,
Da){Z=Z.PLa;const Wa=Da?nc.V6j:nc.W6j;Da=Yc.a.Q_f(Z,Da?nc.Mak:nc.Nak);Z=Yc.a.Q_f(Z,Wa);return Da<Z}tei(Z,Da,Wa,ib,nb){const jc=new qa.a,cc=new qa.a;for(let xe=0;xe<Z.length;xe++){const Ff=Z[xe];this.Zkd(Ff);if(!Ff.parentNode)continue;var Ad=me.a.Be(Ff,Uc.a.ZVd),Xd=me.a.Be(Ff,Uc.a.VVd);const xg=[!1,!1,!1];if(Ad)for(const Eg of Ad)if(Da.Hb(Eg)){Ad=Da.ga(Eg).h1f(Wa);if(Da.ga(Eg).Xag||(2===Ad||0===Ad)&&!this.isInHighContrastMode&&this.xVi(Da.ga(Eg),Eg===nb))Da.ga(Eg).Xag=!0,jc.add(Eg);cc.add(Eg);this.bOf(Da,
Wa,Eg,ib,nb,xg,!0)}if(Xd)for(const Eg of Xd)cc.contains(Eg)&&(cc.remove(Eg),jc.remove(Eg),this.bOf(Da,Wa,Eg,ib,nb,xg,!1));if(0!==Mb.a(Ff)){Xd=(Ad=0<jc.count)&&!!nb&&jc.contains(nb);const Eg=!!ib&&cc.contains(ib),De=!!nb&&cc.contains(nb);0<cc.count&&!this.isInHighContrastMode&&0<=Ff.parentNode.className.indexOf(Uc.a.QLa)&&(of.a.zI(Ff.parentNode,Uc.a.SGf),De?of.a.zI(Ff.parentNode,Xd?Uc.a.WGf:Uc.a.VGf):Eg?(of.a.zI(Ff.parentNode,Uc.a.TGf),Ad=Ff.parentNode.className.match(new RegExp("\\b"+Uc.a.ocg+"\\b")),
(!Ad||1>Ad.length)&&of.a.zI(Ff.parentNode,Uc.a.UGf)):of.a.zI(Ff.parentNode,Ad?Uc.a.bHf:Uc.a.aHf));xg[1]?of.a.zI(Ff,Xd?Uc.a.ZGf:Uc.a.YGf):xg[0]?of.a.zI(Ff,Uc.a.XGf):xg[2]&&of.a.zI(Ff,Uc.a.$Gf)}}}bOf(Z,Da,Wa,ib,nb,jc,cc){Z=Z.ga(Wa).h1f(Da);if(2===Z||(cc?0===Z:1===Z))ib&&ib.equals(Wa)&&(jc[0]=!0),nb&&nb.equals(Wa)&&(jc[1]=!0),jc[2]=!0}}nc.Nak="#F5E7F6";nc.W6j="#503355";nc.Mak="#F2E1F4";nc.V6j="#4C3050";Object(h.a)(nc,"CommentTextAnchorHighlightActor",Ve.a,[]);class Qc{constructor(Z){let Da;this.bWh=
20;Da=Z?Z="SharedCommentBubble":Z="SharedCommentBubbleSelected";this.XVh=this.pSa("SharedCommentBubble");this.WVh=this.pSa("SharedCommentBubbleHover");this.lif=this.pSa(Z);this.aWh=this.pSa("SharedCommentBubble");this.$Vh=this.pSa("SharedCommentBubbleHover");this.mif=this.pSa(Da);this.YVh="ModernCommentMarkerElementSingle cui-img-cont-float";this.ZVh="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get VXg(){return this.YVh}get WXg(){return this.ZVh}get KDe(){return this.bWh}get Cic(){return this.XVh}get JDe(){return this.WVh}get UXg(){return this.lif}get YXg(){return this.aWh}get XXg(){return this.$Vh}get ZXg(){return this.mif}CWe(Z){const Da=
Z?this.Cic:"SharedCommentBubbleSelected";Z=Z?this.Cic:Da;this.lif=this.pSa(Da);this.mif=this.pSa(Z)}pSa(Z){return String.format("{0}_{1}x{2}x32",Z,this.KDe,this.KDe)}}Object(h.a)(Qc,"CommentViewHelper",null,[]);class id{constructor(Z,Da,Wa,ib,nb,jc){this.Oc=Z;this.ua=Da;this.zb=Wa;this.mQg=ib;this.kb=jc;this.mQg.vF(Object(oa.a)(this,this.ggd,"onSlideOrderChanged"));this.Oc.M8h(Object(oa.a)(this,this.n2g,"onCommentsChanged"))}dispose(){this.Oc.SXk(Object(oa.a)(this,this.n2g,"onCommentsChanged"));this.mQg.bP(Object(oa.a)(this,
this.ggd,"onSlideOrderChanged"))}n2g(){const Z=this.ua.Ba;E.a.arb(this.zb,()=>{this.uGk(Z)})}ggd(Z,Da){if(2===Da.TZ){const Wa=this.ua.Ba;E.a.arb(this.zb,()=>{this.nah(Wa)})}}nah(Z){this.ua.Ba===Z&&Z&&this.kb.A1a(!0)}uGk(Z){this.nah(Z)}}Object(h.a)(id,"CommentsChangeListener",null,[106]);var ld=d(141),xd=d(279),ue=d(173);class Rd{static JCa(Z,Da,Wa,ib,nb,jc,cc){const Ad=nf.a.RA();Ad.alt=jc;Ad.className=dg.getImageClassWithCluster(Da,nb);Ad.setAttribute(je.a.ef,je.a.yu);Ad.src=Z.qk(Da+".png");Ad.setAttribute("Unselectable",
"on");Z=nf.a.Qn();Z.className=Wa+" cui-img-cont-float";Z.setAttribute(je.a.ef,je.a.yu);Z.appendChild(Ad);Wa=nf.a.Qn();Wa.className=ib;Wa.setAttribute("Unselectable","on");Wa.setAttribute(je.a.ef,je.a.yu);Wa.appendChild(Z);ib=nf.a.Eca();ib.className=Rd.n4k+" cui-ctl";ib.title=jc;ib.setAttribute(je.a.ef,je.a.yu);ib.setAttribute(je.a.ns,jc);ib.appendChild(Wa);cc&&(jc=nf.a.Qn(),jc.className="cui-ctl-mediumlabel",jc.setAttribute("Unselectable","on"),jc.setAttribute(je.a.ef,je.a.yu),jc.innerText=cc,ib.appendChild(jc));
return ib}static KCa(Z,Da){return Rd.JCa(Z,Z.NS,"cui-img-16by16","cui-ctl-iconContainer",Da,CommonUIStrings.l_DialogClose,null)}}Rd.l4k="CommentPaneLTR";Rd.m4k="CommentPaneRTL";Rd.n4k="CommentPaneWithBorderButton";Rd.B4k=300;Object(h.a)(Rd,"CommentPaneHelper",null,[]);var ce=d(48);class Ne{constructor(Z,Da,Wa,ib,nb){this.Sdc=this.aIa=null;new xd.a(0,0,0,0);this.TWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.jug=null;this.$th=!1;this.tH=nb;
this.lJ=Z;this.Rb=Da;this.tH||(this.aIa=document.createElement("div"),this.aIa.className="CommentPanel",this.aIa.style.position="absolute");this.Eb=!1;this.vO=Wa;this.XUg=ib}dispose(){}layout(Z,Da){if(this.TWa)return Z;if(null===Z)throw Error.argumentNull("availableArea");const Wa=Da?Z.oD(this.width):Z.pD(this.width);this.isVisible&&(Da?Wa.oD(1):Wa.pD(1));this.tH||nf.a.t1(this.aIa,Wa);return Z}Uce(Z){this.Sdc=Z}h$k(Z){this.jug=Z}xp(Z,Da){this.Eb=Z;this.TWa?this.tH?this.FM(this.Eb):this.XUg.FM(this,
this.Eb,ResourceStrings.L_Comments,ce.a.Hp):(this.Rb.ygb(this.vO&&Da?1:2),this.lJ.updateCommandUI())}FM(Z){ld.UISurfaces.zr().then(Da=>{Z?Da.showTaskPane(ce.a.Hp,this.jug):Da.hideTaskPane(ce.a.Hp,2);return null}).catch(Da=>{Gb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",Da.toString(),Z.toString())})}mUe(){ld.UISurfaces.zr().then(Z=>{Z.setSelectedTaskPane(ce.a.Hp);return null}).catch(Z=>{Gb.a.J(572339909,833,10,"CommentsPane::SelectPane exception: {0}",Z.toString())})}R6k(){try{this.tH?
this.mUe():this.XUg.mUe(ce.a.Hp)}catch(Z){Gb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",Z)}}ygb(Z){this.Rb.ygb(this.vO&&Z?1:2)}get isVisible(){return this.Eb}get xa(){return this.aIa}get order(){return 18}get width(){return this.isVisible?Rd.B4k+1:0}}Object(h.a)(Ne,"CommentsPane",null,[1044,718,106,1063]);class oe{constructor(){this.r_a=this.yLa=0;this.Uc=this.V_a=this.cja=null}}Object(h.a)(oe,"FindCommentContext",null,[]);var Yd;(function(Z){Z[Z.findNextComment=
0]="findNextComment";Z[Z.findPreviousComment=1]="findPreviousComment";Z[Z.findNextActiveComment=2]="findNextActiveComment";Z[Z.findPreviousActiveComment=3]="findPreviousActiveComment"})(Yd||(Yd={}));Object(h.b)("FindCommentRequestType",Yd);class Id{constructor(Z,Da,Wa,ib,nb,jc){this.oc=Z;this.ua=Da;this.Tue=Wa;this.kO=ib;this.PBg=nb;this.Bd=new oe;this.I8j=jc}get zCa(){return this.I8j.value}dispose(){this.Tue.dispose();this.Bd=this.Tue=null}y3d(Z,Da,Wa){this.u3d(0,!1,Z,Da,Wa)}F3d(Z,Da,Wa){this.u3d(1,
!1,Z,Da,Wa)}z3d(Z,Da){this.u3d(0,!0,Z,Da,!1)}u3d(Z,Da,Wa,ib,nb){var jc=this.ua.presentation;if(!jc)throw Error.argumentNull("Presentation is null");ib||(ib=ve.a.yk("FindComment",0),ib.Va("FindCommentRequestType",Yd[Z]));ib.Va(Id.oTd,"true");if(this.PBg&&this.ua.Ba){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const cc=this.ua.Ba.le;jc=jc.slides||[];this.Bd.cja=Wa;this.Bd.r_a=Id.E9i(Z,nb);this.Bd.Uc=ib;Da?this.v3d(jc[cc>=jc.length-1?0:cc+1]):1===Z?this.TVf(jc,cc-1,nb):this.QVf(jc,
cc+1,nb)}else ib.Va(Id.Kmi,this.PBg.toString()),Wa(null,null,!1,!1)}QVf(Z,Da,Wa){this.Bd.V_a=null;this.Bd.yLa=Da;for(let ib=Da;ib<Z.length;ib++)if(Z[ib]&&this.rmg(Z[ib])){const nb=this.J9i(Z[ib],Wa);if(nb){this.Bd.cja(Z[ib],nb,!1,!1);return}}else{this.v3d(Z[ib]);return}0<Da?this.RXi(Wa):this.notFound()}TVf(Z,Da,Wa){this.Bd.V_a=null;this.Bd.yLa=Da;for(let ib=Da;-1<ib;ib--)if(Z[ib]&&this.rmg(Z[ib])){const nb=this.nbj(Z[ib],Wa);if(nb){this.Bd.cja(Z[ib],nb,!1,!1);return}}else{this.v3d(Z[ib]);return}Da<
Z.length-1?this.ZXi(Wa):this.notFound()}v3d(Z){this.Bd.Uc.Xm(Id.oni,new Date);Z&&this.Tue.find(Z.Cb,this.Bd.r_a,Object(oa.a)(this,this.wxk,"onServerFindSucceeded"),Object(oa.a)(this,this.vxk,"onServerFindFailed"))}wxk(Z){this.Bd.Uc.PB(Id.oTd,"false");this.Bd.Uc.Xm(Id.VBf,new Date);this.Bd.Uc.Va(Id.EBf,"true");Z?(this.Bd.V_a=Z,-1===this.r6b(this.Bd.V_a.TargetSlideId)?this.notFound():this.Bd.cja(this.Rvl(this.Bd.V_a.TargetSlideId),this.Bd.V_a.TargetComment,this.Bd.V_a.IsFirstComment,this.Bd.V_a.IsLastComment)):
this.notFound()}vxk(){this.Bd.Uc.PB(Id.oTd,"false");this.Bd.Uc.Xm(Id.VBf,new Date);this.Bd.Uc.Va(Id.EBf,"false");Gb.a.J(512496786,805,50,"OnServerFindFailed");this.notFound()}RXi(Z){var Da=this.ua.presentation;if(!Da)throw Error.argumentNull("Presentation is null");Da=Da.slides||[];pd.a.Wa(Da)?this.notFound():this.QVf(Da,0,Z)}ZXi(Z){var Da=this.ua.presentation;if(!Da)throw Error.argumentNull("Presentation is null");Da=Da.slides||[];pd.a.Wa(Da)?this.notFound():this.TVf(Da,Da.length-1,Z)}J9i(Z,Da){Z=
this.oc.zl(Z.Cb);if(this.zCa){const Wa=(Z=this.kO.v9a(Z))?Z.length:0;for(let ib=0;ib<Wa;ib++){const nb=Z[ib];if(Id.Eng(nb,Da))return nb}return null}return this.kO.CXi(Z,Da)}nbj(Z,Da){Z=this.oc.zl(Z.Cb);if(this.zCa){var Wa=(Z=this.kO.v9a(Z))?Z.length:0;for(--Wa;0<=Wa;Wa--){const ib=Z[Wa];if(Id.Eng(ib,Da))return ib}return null}return this.kO.OXi(Z,Da)}rmg(Z){return Z.fE}r6b(Z){var Da=this.ua.presentation;if(!Da)throw Error.argumentNull("Presentation is null");if(Z){Da=Da.slides||[];Z=new Yg.a(Z);for(let Wa=
0;Wa<Da.length;Wa++)if(Da[Wa]&&Yg.a.z0b(Da[Wa].Cb,Z))return Wa}return-1}Rvl(Z){return Z?this.oc.kka(new Yg.a(Z)):null}notFound(){this.Bd.cja&&this.Bd.cja(null,null,!1,!1)}static E9i(Z,Da){if(Da)switch(Z){case 0:return 2;case 1:return 3}return Z}static Eng(Z,Da){return!Da||0===Z.status}}Id.oTd="IsCompletedSearchInClient";Id.oni="ServerSearchStartTime";Id.VBf="ServerSearchEndTime";Id.EBf="IsServerSearchSucceeded";Id.Kmi="IsBRSOn";Object(h.a)(Id,"FindCommentLogic",null,[1042,106]);var zf=d(81);class od{constructor(){this.type=
0;this.cja=this.Uc=null;this.UNd=!1}}Object(h.a)(od,"Entry",null,[]);class gf{constructor(Z,Da){this.M4c=null;this.Qp=Z;this.zb=Da;this.Bma=[];this.Fye=0}dispose(){this.Qp.dispose();this.Bma=this.Qp=null;Gb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.Fye)}y3d(Z,Da,Wa){this.enqueue(1,Z,Da,Wa)}F3d(Z,Da,Wa){this.enqueue(0,Z,Da,Wa)}z3d(Z,Da){this.enqueue(2,Z,Da,!1)}enqueue(Z,Da,Wa,ib){Wa.Va("AlreadyQueuedEntryCount",this.Bma.length.toString());Z=Object.assign(new od,{type:Z,cja:(nb,jc,cc,Ad)=>{Da(nb,
jc,cc,Ad);this.M4c=null;this.W9g()},Uc:Wa,UNd:ib});Array.enqueue(this.Bma,Z);this.Fye=Math.max(this.Fye,this.Bma.length);this.W9g()}W9g(){0<this.Bma.length&&!this.M4c&&(this.M4c=new zf.a(2,1,0,Object(oa.a)(this,this.oKk,"processOneEntry"),90,"49"),this.zb.Db(this.M4c))}oKk(){const Z=Array.dequeue(this.Bma);1===Z.type?this.Qp.y3d(Z.cja,Z.Uc,Z.UNd):0===Z.type?this.Qp.F3d(Z.cja,Z.Uc,Z.UNd):this.Qp.z3d(Z.cja,Z.Uc)}}Object(h.a)(gf,"FindCommentLogicDecorator",null,[1042,106]);var Lf=d(389),ke=d(110);class vf extends ke.a{constructor(Z,
Da){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===Z)throw Error.argumentNull("slideId");this.RequestType=Da;this.StartSlideId=Z.toString();this.FFindModernComments=!0}Zk(){return 88}}Object(h.a)(vf,"FindCommentRequest",ke.a,[]);class ng extends Lf.a{constructor(Z){super();this.Cwa=null;this.vRg=0;this.wIa=this.MGa=null;this.enabled=2;this.SDb=0;this.Hk=!1;this.Mm=Z;this.Mm.register(this)}dispose(){this.Hk||(1===this._state&&this.Mm.unregister(this),this.Hk=
!0,this.SDb=0)}find(Z,Da,Wa,ib){0<this.SDb&&null!==Wa&&(Gb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.SDb),Wa(null));this.Cwa=Z;this.vRg=Da;this.DF(Wa,ib,null)}tka(){return 0<this.SDb&&!this.Hk}NN(){return!1}MTa(){return this.Ilg||this.tka()}uKb(){if(1===this._state)this.Vd.JH=new vf(this.Cwa,this.vRg),this.Vd.status=1,this._state=3;else if(3===this._state&&this.Ilg)if(Gb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",
this.Vd.Qld,this.Vd.Xt,this.Vd.pv),2===this.Vd.statusCode&&this.Vd.Qr&&1===this.Vd.Qr.length){const Z=this.Vd.Qr[0];0!==Z.StatusCode?this.DH(Z):this.R0(Z)}else this.DH()}DF(Z,Da){this.SDb++;this.wIa=Z;this.MGa=Da;this.Mm.zaa()}forceOutbound(){}DH(Z=null){Gb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.Vd.zv,this.Vd.statusCode,Z?Z.StatusCode:-1);this.Q3g(Z,!1)}R0(Z){this.Q3g(Z,!0)}get Ilg(){return!!this.Vd&&
2===this.Vd.status}Q3g(Z,Da){this.SDb--;this._state=1;if(Da){Da=null;try{Da=Sys.Serialization.JavaScriptSerializer.deserialize(Z.FindCommentResult)}catch(Wa){Gb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",Wa)}this.wIa(Da)}else this.MGa(null,-1)}}Object(h.a)(ng,"FindCommentReplicator",Lf.a,[106]);class wg{constructor(){this.Ts=null;this.Tvc=this.slf=this.X7e=this.uEc=this.Qqf=this.mjf=this.Bmf=!1}qjj(){this.Ts||(n.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.vrh());return this.Ts}Wcj(){return new Promise((Z,Da)=>{this.Tvc?Z(this.O3f()):this.rph().then(()=>{Z(this.O3f())}).catch(Wa=>{Da(Wa)})})}O3f(){this.Tvc||n.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let Z;Z=33;this.X7e&&(Z|=2);this.Bmf&&(Z|=8);this.Qqf&&(Z|=16);this.mjf&&(Z|=4);this.uEc&&(Z|=64);this.slf&&(Z|=128);return Z}}Object(h.a)(wg,"OfficeSharedCommentsAppCapabilities",null,
[1549]);class bf extends wg{constructor(Z,Da,Wa,ib,nb,jc){super();this.Pb=Z;this.Ha=Da;this.uIg=Wa;this.C8c=jc;this.Tdl(ib,nb);this.vrh();this.rph()}Tdl(Z,Da){this.uEc=this.Pb.ka("TasksForCommentsEnabled")&&!Z;this.Qqf=!1;this.Bmf=Da;this.slf=this.mjf=!0}vrh(){this.Ts={};const Z=this.uEc&&this.Ha.IVj;this.Ts.CommentsFluentUI="true";this.Ts.CommentsFluentUIV2="true";this.Ts.CommentTasks=this.uEc.toString();Rb.a("DeprecateIE.SharedCommentAppCapabilities")?this.Ts.DisabledChangeGates=this.Pb.Ga("DisabledChangeGatesInSharedComments"):
this.Ts.DisabledChangeGates=Yb.a.Ej?"WebThemeIntegrationHighContrastFixes,":""+this.Pb.Ga("DisabledChangeGatesInSharedComments");this.Ts.DiscreteHostedComments="true";this.Ts.CommentReactions=dd(this.Pb).toString();this.Ts.NewCommentButton="true";this.Ts.PersonaColor="true";this.Ts.LivePersonaPicker="true";this.Ts.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.Ts.CommentTasksFromReply=Z.toString();this.Ts.LogDraftCommentIdPair=this.C8c.toString();
this.Ts.HyperlinksInComments="true";this.Ts.SmartReplies=this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.Ts.NewModelState="true";this.Ts.TaskPaneWithNewInfrastructure=this.Ha.dWd.toString();this.Ts.NewSelectionInteractions="true";this.Ts.ExtendedDrafting="true";this.Ts.LinkToComment="true";this.Ts.PersonaIconImageForWeb="true";this.Ts.NoDiscardOnFocusLoss="true";this.Ts.WebThemeIntegration="true";this.Ts.TaskHistoryRecordIDs=this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1).toString()}rph(){return new Promise((Z,Da)=>{this.uIg?this.uIg.atMentionsEnabledAsync().then(Wa=>{this.X7e=Wa;this.Tvc=!0;Z(this.Tvc)}):(n.ULS.sendTraceTag(509645712,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Da(E.a.Ys(-2130915320)))})}}Object(h.a)(bf,"PPTSharedCommentAppCapabilities",wg,[]);class Pd{constructor(Z){this.Ag=Z}display(Z,Da){this.Ag.m4e(Z?0:2,Da);this.Ag.setVisibility()}dismiss(){this.Ag.Vsi();
this.Ag.setVisibility()}activate(){this.Ag.m4e(1);this.Ag.setVisibility()}pNi(Z){this.Ag.m4e(Z?0:2)}Jm(Z){this.Ag.Jm(Z)}lD(Z){this.Ag.lD(Z)}Yp(){return this.Ag.Yp()}LN(Z){return this.Ag.azb(Z)}Ox(Z){this.Ag.Ox(Z)}dispose(){this.Ag.dispose()}Ty(){this.Ag.Ty()}cE(Z){return this.Ag.cE(Z)}GB(Z){return this.Ag.GB(Z)}draw(Z,Da){this.Ag.draw(Z,Da)}get visible(){return this.Ag.visible}set visible(Z){this.Ag.visible=Z}setPosition(Z,Da){this.Ag.setPosition(Z,Da)}Ij(Z){this.Ag.Ij(Z)}Qq(Z){this.Ag.Qq(Z)}Xu(Z){this.Ag.Xu(Z)}setZIndex(Z){this.Ag.setZIndex(Z)}NE(Z,
Da){this.Ag.NE(Z,Da)}setSelection(){}}Object(h.a)(Pd,"ShapeCommentsAnchoredSelectionView",null,[1066,430,431,106]);class Md{constructor(Z,Da){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=Z;this.canvasContextId=Da}}Object(h.a)(Md,"CommentUIAction",null,[]);var Mh=d(65),Bh=d(648),Vh=d(121),Jg=d(180),Of=d(1121),bi=d(532);class ij{constructor(){this.draftId=null;this.insertIndex=
0;this.anchorHintText=null}}Object(h.a)(ij,"CurrentContextDraft",null,[]);class ig{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(ig,"IContentAnchorPosition",null,[]);class oj{constructor(){this.y=this.x=this.height=this.width=0}}Object(h.a)(oj,"IViewportInfo",null,[]);class fh{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=
this.paneClosedCallback=null}}Object(h.a)(fh,"FloatingContainerManagerCreationParams",null,[]);var Qd=d(140),$e=d(53),yh=d(821),Ti=d(418),fe=d(385),gi=d(900),vi;(function(Z){Z[Z.line=0]="line";Z[Z.lineInv=1]="lineInv";Z[Z.triangle=2]="triangle";Z[Z.rtTriangle=3]="rtTriangle";Z[Z.rect=4]="rect";Z[Z.diamond=5]="diamond";Z[Z.parallelogram=6]="parallelogram";Z[Z.trapezoid=7]="trapezoid";Z[Z.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";Z[Z.pentagon=9]="pentagon";Z[Z.hexagon=10]="hexagon";Z[Z.heptagon=
11]="heptagon";Z[Z.octagon=12]="octagon";Z[Z.decagon=13]="decagon";Z[Z.dodecagon=14]="dodecagon";Z[Z.star4=15]="star4";Z[Z.star5=16]="star5";Z[Z.star6=17]="star6";Z[Z.star7=18]="star7";Z[Z.star8=19]="star8";Z[Z.star10=20]="star10";Z[Z.star12=21]="star12";Z[Z.star16=22]="star16";Z[Z.star24=23]="star24";Z[Z.star32=24]="star32";Z[Z.roundRect=25]="roundRect";Z[Z.round1Rect=26]="round1Rect";Z[Z.round2SameRect=27]="round2SameRect";Z[Z.round2DiagRect=28]="round2DiagRect";Z[Z.snipRoundRect=29]="snipRoundRect";
Z[Z.snip1Rect=30]="snip1Rect";Z[Z.snip2SameRect=31]="snip2SameRect";Z[Z.snip2DiagRect=32]="snip2DiagRect";Z[Z.plaque=33]="plaque";Z[Z.ellipse=34]="ellipse";Z[Z.teardrop=35]="teardrop";Z[Z.homePlate=36]="homePlate";Z[Z.chevron=37]="chevron";Z[Z.pieWedge=38]="pieWedge";Z[Z.pie=39]="pie";Z[Z.blockArc=40]="blockArc";Z[Z.donut=41]="donut";Z[Z.noSmoking=42]="noSmoking";Z[Z.rightArrow=43]="rightArrow";Z[Z.leftArrow=44]="leftArrow";Z[Z.upArrow=45]="upArrow";Z[Z.downArrow=46]="downArrow";Z[Z.stripedRightArrow=
47]="stripedRightArrow";Z[Z.notchedRightArrow=48]="notchedRightArrow";Z[Z.bentUpArrow=49]="bentUpArrow";Z[Z.leftRightArrow=50]="leftRightArrow";Z[Z.upDownArrow=51]="upDownArrow";Z[Z.leftUpArrow=52]="leftUpArrow";Z[Z.leftRightUpArrow=53]="leftRightUpArrow";Z[Z.quadArrow=54]="quadArrow";Z[Z.leftArrowCallout=55]="leftArrowCallout";Z[Z.rightArrowCallout=56]="rightArrowCallout";Z[Z.upArrowCallout=57]="upArrowCallout";Z[Z.downArrowCallout=58]="downArrowCallout";Z[Z.leftRightArrowCallout=59]="leftRightArrowCallout";
Z[Z.upDownArrowCallout=60]="upDownArrowCallout";Z[Z.quadArrowCallout=61]="quadArrowCallout";Z[Z.bentArrow=62]="bentArrow";Z[Z.uturnArrow=63]="uturnArrow";Z[Z.circularArrow=64]="circularArrow";Z[Z.leftCircularArrow=65]="leftCircularArrow";Z[Z.leftRightCircularArrow=66]="leftRightCircularArrow";Z[Z.curvedRightArrow=67]="curvedRightArrow";Z[Z.curvedLeftArrow=68]="curvedLeftArrow";Z[Z.curvedUpArrow=69]="curvedUpArrow";Z[Z.curvedDownArrow=70]="curvedDownArrow";Z[Z.swooshArrow=71]="swooshArrow";Z[Z.cube=
72]="cube";Z[Z.can=73]="can";Z[Z.lightningBolt=74]="lightningBolt";Z[Z.heart=75]="heart";Z[Z.sun=76]="sun";Z[Z.moon=77]="moon";Z[Z.smileyFace=78]="smileyFace";Z[Z.irregularSeal1=79]="irregularSeal1";Z[Z.irregularSeal2=80]="irregularSeal2";Z[Z.foldedCorner=81]="foldedCorner";Z[Z.bevel=82]="bevel";Z[Z.frame=83]="frame";Z[Z.halfFrame=84]="halfFrame";Z[Z.corner=85]="corner";Z[Z.diagStripe=86]="diagStripe";Z[Z.chord=87]="chord";Z[Z.arc=88]="arc";Z[Z.leftBracket=89]="leftBracket";Z[Z.rightBracket=90]="rightBracket";
Z[Z.leftBrace=91]="leftBrace";Z[Z.rightBrace=92]="rightBrace";Z[Z.bracketPair=93]="bracketPair";Z[Z.bracePair=94]="bracePair";Z[Z.straightConnector1=95]="straightConnector1";Z[Z.bentConnector2=96]="bentConnector2";Z[Z.bentConnector3=97]="bentConnector3";Z[Z.bentConnector4=98]="bentConnector4";Z[Z.bentConnector5=99]="bentConnector5";Z[Z.curvedConnector2=100]="curvedConnector2";Z[Z.curvedConnector3=101]="curvedConnector3";Z[Z.curvedConnector4=102]="curvedConnector4";Z[Z.curvedConnector5=103]="curvedConnector5";
Z[Z.callout1=104]="callout1";Z[Z.callout2=105]="callout2";Z[Z.callout3=106]="callout3";Z[Z.accentCallout1=107]="accentCallout1";Z[Z.accentCallout2=108]="accentCallout2";Z[Z.accentCallout3=109]="accentCallout3";Z[Z.borderCallout1=110]="borderCallout1";Z[Z.borderCallout2=111]="borderCallout2";Z[Z.borderCallout3=112]="borderCallout3";Z[Z.accentBorderCallout1=113]="accentBorderCallout1";Z[Z.accentBorderCallout2=114]="accentBorderCallout2";Z[Z.accentBorderCallout3=115]="accentBorderCallout3";Z[Z.wedgeRectCallout=
116]="wedgeRectCallout";Z[Z.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";Z[Z.wedgeEllipseCallout=118]="wedgeEllipseCallout";Z[Z.cloudCallout=119]="cloudCallout";Z[Z.cloud=120]="cloud";Z[Z.ribbon=121]="ribbon";Z[Z.ribbon2=122]="ribbon2";Z[Z.ellipseRibbon=123]="ellipseRibbon";Z[Z.ellipseRibbon2=124]="ellipseRibbon2";Z[Z.leftRightRibbon=125]="leftRightRibbon";Z[Z.verticalScroll=126]="verticalScroll";Z[Z.horizontalScroll=127]="horizontalScroll";Z[Z.wave=128]="wave";Z[Z.doubleWave=129]="doubleWave";
Z[Z.plus=130]="plus";Z[Z.flowChartProcess=131]="flowChartProcess";Z[Z.flowChartDecision=132]="flowChartDecision";Z[Z.flowChartInputOutput=133]="flowChartInputOutput";Z[Z.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";Z[Z.flowChartInternalStorage=135]="flowChartInternalStorage";Z[Z.flowChartDocument=136]="flowChartDocument";Z[Z.flowChartMultidocument=137]="flowChartMultidocument";Z[Z.flowChartTerminator=138]="flowChartTerminator";Z[Z.flowChartPreparation=139]="flowChartPreparation";Z[Z.flowChartManualInput=
140]="flowChartManualInput";Z[Z.flowChartManualOperation=141]="flowChartManualOperation";Z[Z.flowChartConnector=142]="flowChartConnector";Z[Z.flowChartPunchedCard=143]="flowChartPunchedCard";Z[Z.flowChartPunchedTape=144]="flowChartPunchedTape";Z[Z.flowChartSummingJunction=145]="flowChartSummingJunction";Z[Z.flowChartOr=146]="flowChartOr";Z[Z.flowChartCollate=147]="flowChartCollate";Z[Z.flowChartSort=148]="flowChartSort";Z[Z.flowChartExtract=149]="flowChartExtract";Z[Z.flowChartMerge=150]="flowChartMerge";
Z[Z.flowChartOfflineStorage=151]="flowChartOfflineStorage";Z[Z.flowChartOnlineStorage=152]="flowChartOnlineStorage";Z[Z.flowChartMagneticTape=153]="flowChartMagneticTape";Z[Z.flowChartMagneticDisk=154]="flowChartMagneticDisk";Z[Z.flowChartMagneticDrum=155]="flowChartMagneticDrum";Z[Z.flowChartDisplay=156]="flowChartDisplay";Z[Z.flowChartDelay=157]="flowChartDelay";Z[Z.flowChartAlternateProcess=158]="flowChartAlternateProcess";Z[Z.flowChartOffpageConnector=159]="flowChartOffpageConnector";Z[Z.actionButtonBlank=
160]="actionButtonBlank";Z[Z.actionButtonHome=161]="actionButtonHome";Z[Z.actionButtonHelp=162]="actionButtonHelp";Z[Z.actionButtonInformation=163]="actionButtonInformation";Z[Z.actionButtonForwardNext=164]="actionButtonForwardNext";Z[Z.actionButtonBackPrevious=165]="actionButtonBackPrevious";Z[Z.actionButtonEnd=166]="actionButtonEnd";Z[Z.actionButtonBeginning=167]="actionButtonBeginning";Z[Z.actionButtonReturn=168]="actionButtonReturn";Z[Z.actionButtonDocument=169]="actionButtonDocument";Z[Z.actionButtonSound=
170]="actionButtonSound";Z[Z.actionButtonMovie=171]="actionButtonMovie";Z[Z.gear6=172]="gear6";Z[Z.gear9=173]="gear9";Z[Z.funnel=174]="funnel";Z[Z.mathPlus=175]="mathPlus";Z[Z.mathMinus=176]="mathMinus";Z[Z.mathMultiply=177]="mathMultiply";Z[Z.mathDivide=178]="mathDivide";Z[Z.mathEqual=179]="mathEqual";Z[Z.mathNotEqual=180]="mathNotEqual";Z[Z.cornerTabs=181]="cornerTabs";Z[Z.squareTabs=182]="squareTabs";Z[Z.plaqueTabs=183]="plaqueTabs";Z[Z.chartX=184]="chartX";Z[Z.chartStar=185]="chartStar";Z[Z.chartPlus=
186]="chartPlus"})(vi||(vi={}));Object(h.b)("ST_ShapeType",vi);var bk=d(154);class Zg{constructor(){this.RowId=this.ColId=null}}Object(h.a)(Zg,"TableCellInfo",null,[]);var Ek=d(899),Ch=d(52),Ui=d(186),pg=d(124),Mg=d(168),gh=d(1118),Ie=d(928),Ia=d(929),lb=d(351),Lb=d(108);class hc{constructor(Z,Da){this.mwa=this.NBb=null;this.xEg=!1;this.iBe=Z;this.Og=Da}get WUj(){return this.xEg}cKb(Z,Da){Da&&Z.removeNotification(Da);return Da}rWk(Z){this.NBb=this.cKb(Z,this.NBb);this.cKb(Z,this.mwa);this.mwa=this.NBb=
null}iml(Z,Da,Wa){Z?this.iBe.Am.isVisible&&1===Z.AM.length&&Da.Ba&&Yg.a.Jaa(Z.S8a.Cb,Da.Ba.Cb)||ld.UISurfaces.mL().then(ib=>{this.mwa=this.cKb(ib,this.mwa);this.mwa=null;var nb=Object.assign(new gh.a,{label:Z.MIb,onExecute:()=>{Z.primaryButtonAction(this.iBe,Da);Da.Ba.le!==Z.S8a.le&&Wa.GJ(Z.S8a.le);this.cKb(ib,this.mwa);this.mwa=null}}),jc=Object.assign(new gh.a,{label:Z.ind,onExecute:()=>{this.xEg=!0;this.cKb(ib,this.mwa);this.mwa=null}});jc=Object.assign(new Ie.a,{target:".EditingRibbonPanel",title:Z.title,
content:Z.content,primaryButtonProps:nb,secondaryButtonProps:jc,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new Ia.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.Og.Ko(ce.a.s0a)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});nb=Object.assign(new lb.a,{onShow:()=>{this.Og.pI(ce.a.s0a)}});jc=ib.callout(jc);this.mwa=ib.addNotification(jc,nb)}):Gb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}hvh(Z,
Da){const Wa=new Lb.StandardDialog;Wa.xd=4;Wa.Gx(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,Da?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,ib=>{1===ib?(Z.i2b(Da),this.iBe.D2d(Da)?this.ivh():this.gvh(Da?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Gb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",
Da)):Gb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Da)})}ivh(){const Z=new Lb.StandardDialog;Z.xd=0;Z.Gx(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}gvh(Z){const Da=()=>{this.Og.pI(ce.a.s0a)},Wa=()=>{this.Og.Ko(ce.a.s0a)};ld.UISurfaces.mL().then(ib=>{this.cKb(ib,this.NBb);this.NBb=null;var nb=Object.assign(new Ie.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,
content:Z,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new Ia.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Wa,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const jc=Object.assign(new lb.a,{onShow:Da});nb=ib.callout(nb);this.NBb=ib.addNotification(nb,jc)})}}Object(h.a)(hc,"CommentCalloutDialogManager",null,[]);var Pc=d(962);class Td{constructor(Z){this.wHa=Z;this.Bma=[];this.Are=new Pc.a(1E3,Object(oa.a)(this,this.perform,"perform"))}rGk(Z){Array.contains(this.Bma,
Z)||Array.add(this.Bma,Z);this.Are.perform()}perform(){const Z=this.Bma;this.Bma=[];for(let Da=0;Da<Z.length;Da++){const Wa=Z[Da];this.wHa.mGb(Wa.commentId,new Dd.a(Wa.pos.X,Wa.pos.Y))}}}Object(h.a)(Td,"CommentKeyboardMoveController",null,[]);class ie{constructor(Z,Da,Wa,ib,nb){this.fGa=this.pwa=null;this.Pea=[];if(!Z)throw Error.argumentNull("parentElement");if(!Da)throw Error.argumentNull("frame");this.GDb=Wa;this.hi=Z;this.kb=Da;this.Gxg=ib;this.Qxg=nb}dispose(){this.wQe();this.kb=this.hi=null}wQe(){this.fGa=
this.pwa=null;if(this.Pea&&0<this.Pea.length){for(const Z of this.Pea)Z&&Z.dispose();Array.clear(this.Pea)}}j_(Z){if(!this.DDa)return!0;if(!Z||!Z.length)return!1;Z=Mg.e(Z,Da=>0===Da.status);return!!Z&&0<Z.length}Ikd(Z){this.wQe();if(Z&&this.hi){var Da=this.kb.isReadOnly?null:this.kb.au;for(const Wa of Z)this.Pea.push(this.GDb.create(Wa,this.hi,this,Da,this.kb.isReadOnly,Jc.EN(Wa)||!this.Qxg));this.j_(Z)&&this.R4e()}}selectComment(Z,Da){if(!(!Z&&!this.pwa||this.pwa&&Jc.yvb(Z,this.pwa.comment))&&(this.pwa&&
this.pwa.select(!1),this.pwa=null,Z))for(const Wa of this.Pea){if(Jc.yvb(Wa.comment,Z)){this.pwa=Wa;Wa.select(!0);break}if(Da&&Wa.comment.Children)for(const ib of Wa.comment.Children)if(Jc.yvb(ib,Z)){this.pwa=Wa;Wa.select(!0);return}}}Pqb(Z,Da){if(!(!Z&&!this.fGa||this.fGa&&Jc.yvb(Z,this.fGa.comment))&&(this.fGa&&this.fGa.activate(!1),this.fGa=null,Z))for(const Wa of this.Pea){if(Jc.yvb(Wa.comment,Z)){this.fGa=Wa;Wa.activate(!0);break}if(Da&&Wa.comment.Children)for(const ib of Wa.comment.Children)if(Jc.yvb(ib,
Z)){this.fGa=Wa;Wa.activate(!0);return}}}wvh(Z){for(const Da of this.Pea)Da.vvh(Z)}R4e(){for(const Z of this.Pea)Z.updatePosition(this.kb.DCa(Z.comment.pos.X,Z.comment.pos.Y))}mGb(Z,Da){Da=this.kb.JIf(Da._x,Da._y);Z.pos.X+=Da._x;Z.pos.Y+=Da._y;Da=new Dd.a(Z.pos.X,Z.pos.Y);this.kb.selectComment(Z,null,!0,!1,0,1,!1);this.kb.manager.mGb(Z.commentId,Da)}sEl(Z){for(const Da of this.Pea)if(Da.comment===Z){Da.updatePosition(this.kb.DCa(Da.comment.pos.X,Da.comment.pos.Y));break}}tEl(Z){for(const Da of Z)for(const Wa of this.Pea)Wa.comment.commentId===
Da.commentId&&Wa.updatePosition(this.kb.DCa(Wa.comment.pos.X,Wa.comment.pos.Y))}setVisibility(Z){this.Qxg=Z;for(const Da of this.Pea)Da.setVisibility(!Jc.EN(Da.comment)&&Z)}get frame(){return this.kb}get isRightToLeft(){return this.Gxg}set isRightToLeft(Z){this.Gxg=Z}get parentElement(){return this.hi}set parentElement(Z){this.hi=Z}get kLb(){return this.pwa}get DDa(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(ie,"CommentMarkerView",
null,[]);class Sd{constructor(){this.comment=this.slide=null;this.direction=0;this.gUe=null}}Object(h.a)(Sd,"CommentSelectContext",null,[]);var wf;(function(Z){Z[Z.previous=0]="previous";Z[Z.next=1]="next"})(wf||(wf={}));Object(h.b)("CommentSelectDirection",wf);class Pf{constructor(Z,Da){if(!Z||1>Z.length)throw Error.argument("ISlideNode[] slides");if(!Da)throw Error.argumentNull("ICommentGraphManager graphManager");this.xgk=Z;this.hl=Da;this.GAe=[];this.init()}get AJa(){return this.xgk}get AM(){return this.GAe}get S8a(){return this.AM[this.AM.length-
1]}get MIb(){return 1<this.AM.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get ind(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.Jnl()}init(){for(const Z of this.AJa)for(const Da of this.hl.nta(Z.XD()))if(1===Da.status){this.GAe.push(Z);break}if(1>this.GAe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");
}Jnl(){switch(this.AM.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.AM[1].le+1,this.AM[0].le+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.AM[2].le+1,this.AM[1].le+1,this.AM[0].le+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,this.AM[3].le+1,this.AM[2].le+1,this.AM[1].le+1);
default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.AM[this.AM.length-1].le+1,this.AM[this.AM.length-2].le+1,this.AM[this.AM.length-3].le+1,this.AM.length-3)}}S9i(){for(const Z of this.hl.v9a(this.S8a))if(1===Z.status)return Z;return null}primaryButtonAction(Z,Da){if(!Da.presentation||!Da.presentation.slides)return Gb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",Da.presentation?"Presentation.Slides":
"Presentation"),null;const Wa=this.S9i();if(!Wa)return null;Z.Am.isVisible||Z.oqd();if(Da.Ba&&Yg.a.Jaa(Da.Ba.Cb,this.S8a.Cb))Z.Yfa(Wa.commentId,1,!0);else for(const ib of Da.presentation.slides)if(Yg.a.Jaa(ib.Cb,this.S8a.Cb))return Object.assign(new Sd,{slide:this.S8a,comment:Wa,direction:1,gUe:ve.a.yk("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(Pf,"ResolvedCommentsCalloutParams",null,[]);class og{constructor(){this.type="SharedCommentsTaskPaneProps";this.focusCallback=null}}Object(h.a)(og,
"SharedCommentsTaskPaneProps",null,[]);var Dh=d(971),Bi=d(436),Vi=d(158);class kh{constructor(Z,Da,Wa,ib,nb,jc,cc,Ad,Xd,xe,Ff,xg,Eg,De,zd,Gd,fd,Mc,uk,Ki,bj,wi,za,sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg,hh,qj,de,Yf,vk,Gj,Pm,ok,wk,Am,Fk,Ih,yj,zj,Zl,vn,lm,$l,mm,xk,cl,If,Bl,rj,Bm,dn){this.aBe=this.ln=null;this.Xcb=!0;this.Ro=this.qte=this.tdc=this.Zse=this.Zcb=!1;this.heb=0;this.T$c=this.PEb=!1;this.uGa=this.c$c=this.ei=this.RVa=this.nfb=this.A$=this.isg=null;this.Jxg=this.XWa=!1;this.Jr=null;this.lBe=this.Jse=!1;
this.BRg=null;this.uBf=[ce.a.Az,ce.a.Hp,ce.a.qW,ce.a.Ivi];this.nmb=2147483647;this.cBb=0;this.UFg=-1;this.eug=0;this.Dfc=null;this.f9c=this.Q9c=this.Lqe=!1;this.iZa=(xa,hi)=>{hi.slide===this.ua.Ba&&(xa=this.mR.instance.Bbe||this.mR.instance.Cbe,!hi.slide.isUnread||xa)&&(hi=this.hl.Wy(),this.TJb(hi,e.AFrameworkApplication.isRtl,!0))};if(!Yf)throw Error.argumentNull("appSettingsManager");if(!wi)throw Error.argumentNull("commentEventHost");if(!Da)throw Error.argumentNull("commentTelemetryManager");if(cl.Jn&&
!dn)throw Error.argumentNull("sorterViewActorLazy");this.tH=mm;this.ia=Wa;this.Rb=ib;this.Am=nb;this.au=jc;this.Zc=cc;this.Ea=Ad;this.Og=Xd;this.qe=xe;this.pa=Ff;this.Kc=Eg;this.uy=De;this.lq=zd;this.hl=Z;this.mE=Da;this.Aak=new Td(Z);this.RX=Gd;this.ua=fd;this.jbd=Mc.yd(40);this.cIg=Rb.a("PreventCommentDraftDeletionOnPageContentChange")?Mc.yd(7):Mc.yd(8);this.cEb=xg;this.yO=Eg.Ic?Eg.Ic.XVd:null;this.Iva=Nb;this.zb=Ki;this.$_=wi;this.Wfb=za;this.TGg=bj;this.M$c=sb;this.Mqe=Ac;this.j5c=Jd;this.Ge=
Xe;this.a9c=ge;this.Nq=re;this.L3c=$f;this.Mv=Tg;this.GDb=hh;this.qR=qj;this.Yn=de;this.Pb=Yf;this.Es=Gj;this.kxg=Pm;this.n4=new m.a;this.Rd=ok;this.Xa=wk;this.kfb=Fk;this.tva=Am;this.Lc=Ih;this.Fa=Zl;this.zfk=vn;this.jJ=lm;this.xdc=$l;this.Ha=cl;this.Ik=If;this.vX=Bl;this.qdc=zj;this.lHa=!1;this.ia.oaa(this);this.tcb=new hc(this,this.Og);this.mR=rj;this.b5=Bm;this.bYa=dn;if(!vk)throw Error.argumentNull("InteractiveViewManagerFuture");this.SAg=vk;this.o5j=this.EBi();this.tH&&this.Am.h$k(this.Dej());
this.Qb=xk;yj.Ytb().then(xa=>{xa||this.aVe(!1)})}get hPc(){return this.kxg}get I2d(){return this.Pb.ka("195")}get sUf(){return this.tva}get c2b(){return this.Pb.Ga("CurrentCommentId")}get yZd(){return this.Pb.Ga("CurrentSlideId")}get x0b(){return this.Pb.ka("PptReactTabbedTaskPanesM2IsEnabled")}get NHk(){return this.Pb.ka("PPTSafeLinksIsEnabledForModernComments")}get Wvi(){return this.Pb.ka("CommentTextAnchoringReadWriteEnabled")}get aWd(){return this.Pb.ka("CommentTextAnchoringCreateNewEnabled")}get gRf(){return this.Pb.ka("EnableDeleteAllComments")}get DDa(){return this.Pb.ka("SlideResizePerfImprovementEnabled")}get cvb(){return Rb.a("CompactingDHCsEnabled")}get iUf(){return Rb.a("CanvasToCommentFocusFixV2")}get m9b(){return this.Pb.ka("PPTOBlueDotsForComments")}initialize(){this.Ro=
1===this.Rb.mode;this.tH||(this.Iva?Sys.UI.DomElement.addCssClass(this.cEb,Rd.m4k):Sys.UI.DomElement.addCssClass(this.cEb,Rd.l4k));const Z=this.Ea.Fc(ce.a.Hp);Z.bJ=!0;Z.I1a=!0;Z.kca(Wa=>{const ib=!Rb.a("FixAltF12KeboardingInCommentPane")||!Wa||Wa.name!==ce.a.LM;this.Wjc(!0,!Wa||Wa.name!==ce.a.Az&&ib,!0)});Z.OBa((Wa,ib)=>{Wa=(ib.name===ce.a.ZO||ib.name===ce.a.waa)&&Wa.name===ce.a.Hp;this.Wjc(!1,!1,ib.name===ce.a.Hp||ib.name===ce.a.sg||ib.name===ce.a.Az||ib.name===ce.a.qW||this.x0b&&ib.name===ce.a.LM||
Wa)});const Da=this.Ea.Fc(ce.a.Az);Da.kca((Wa,ib)=>{this.vwk(Wa,ib)});Da.OBa(()=>{this.uwk()});this.tH||this.Zc.$Jb(Ab.a.click,this.cEb,Object(oa.a)(this,this.$Gb,"onCommentPaneParentDivClick"),null,Z.I1a);this.wb();this.uy.mPd(Object(oa.a)(this,this.fJa,"onBeforeSlideSwitched"));this.uy.aW(Object(oa.a)(this,this.p4e,"updateCommentsWhenNavigateSlide"));this.lq.DPa(Object(oa.a)(this,this.Krf,"activeSlideDOMDisplayed"));this.Nq.Y$h(Object(oa.a)(this,this.N4g,"onPageViewZoomChanged"));this.Es.Tuf(Object(oa.a)(this,
this.onShapeSelected,"onShapeSelected"));this.Es.Cai(Object(oa.a)(this,this.K5g,"onShapeDeselected"));this.uy.NYb(Object(oa.a)(this,this.V5g,"onShapeTextSelected"));this.uy.HPd(Object(oa.a)(this,this.gZa,"onSlideBackgroundClicked"));this.qdc&&(this.uy.OYb(Object(oa.a)(this,this.byk,"onSlideSizeUpdated")),this.uy.Jai(Object(oa.a)(this,this.T5g,"onShapeRotatedOrBoundsUpdated")),this.uy.Fai(Object(oa.a)(this,this.T5g,"onShapeRotatedOrBoundsUpdated")));this.jbd.jk(Object(oa.a)(this,this.P6g,"onTextAnchorPropertyChanged"));
this.cIg.vF(Object(oa.a)(this,this.CB,"onChildTopologyChanged"));this.jbd.TBa(Object(oa.a)(this,this.S1g,"onBeforeTextAnchorDisconnect"));this.kfb.jk(Object(oa.a)(this,this.xkc,"onShapePropertyChange"));this.kfb.V$h(Object(oa.a)(this,this.O5g,"onShapeInvalidation"));this.Lc.Y8h(Object(oa.a)(this,this.a3g,"onF6FocusDocument"));this.Lc.zGc(Object(oa.a)(this,this.Wgb,"onSetFocus"));this.m9b&&this.b5.execute(Wa=>{Wa.IPd(this.iZa)});this.L3c.EPd(Object(oa.a)(this,this.agd,"onSessionExpired"));this.L3c.KA(Object(oa.a)(this,
this.nxa,"onSessionEnded"));this.Kc.Ic&&this.Kc.Ic.XVd&&(this.fJa(this,null),this.p4e(this,null));this.Rb.PK(Object(oa.a)(this,this.z1g,"onAppModeSwitched"));this.Rb.FPa(Object(oa.a)(this,this.jY,"onSetOffline"));this.lq.grb(Object(oa.a)(this,this.cgd,"onShapeViewElementAddedOrRemoved"));this.lq.Vuf(Object(oa.a)(this,this.cgd,"onShapeViewElementAddedOrRemoved"));this.pa.wF(Object(oa.a)(this,this.EH,"onSelectionChanged"))}cgd(Z,Da){this.ln&&(Z=Da.Jw)&&Z.shapeNode&&this.iUj(Z.shapeNode.slideId)&&this.ln.Ikd(this.hl.Wy())}iUj(Z){return!!this.ua&&
!!this.ua.ak&&this.ua.ak.equals(Z)}aVe(Z){this.tva=this.kxg=Z;this.Yn.aVe(Z)}byk(){this.ln&&this.ln.R4e()}T5g(Z,Da){if(this.ln){const Wa=Da.Jw.shapeNode;if(Wa){if((Z=this.hl.Wy())&&Z.length){Da=[];for(const ib of Z)ib.anchorShape===Wa.get_shapeId()&&Da.push(ib);this.ln.tEl(Da)}}else Gb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}SDl(){try{if(this.x0b&&this.Am){const Z=Object(mb.a)(1063,this.Am);Z&&(Z.$th=!!this.ei)}}catch(Z){Gb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",
Z)}}nUf(){return this.ei&&this.ei.w8&&this.ua.Ba?!Yg.a.Jaa(this.ei.w8,this.ua.Ba.Cb):!1}rvb(){return this.ei&&this.ua.Ba?!this.ei.w8||Yg.a.Jaa(this.ei.w8,this.ua.Ba.Cb):!1}kjh(){if(this.Jr&&this.Jr.isIntegratedExtensionEnabled()){const Z=this.hl.Wy(),Da=!this.DDa||!this.lHa;Z&&0<Z.length&&(this.GR(!0,!0,Da),this.Cld());this.rvb()&&this.jjh(this.ei)}}Ovk(){if(this.Jr){this.SDl();this.kjh();const Z=this.hLb;Z&&0!==Z.status&&this.jMa(1)}}Pvk(){this.m2b();const Z=!this.DDa||!(this.j_()&&this.lHa);this.GR(!1,
!1,Z)}bwk(Z){this.cBb!==Z&&(this.cBb=Z,this.Kc&&this.Kc.Ic&&this.Kc.Ic.eHh(2,!1,this.cBb))}Ydg(){const Z=Object.assign(new fh,{paneClosedCallback:Object(oa.a)(this,this.Ovk,"onPaneClosedCallback"),paneOpenedCallback:Object(oa.a)(this,this.Pvk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(oa.a)(this,this.bwk,"onPositionUpdatedScrollHeightCallback")});Z.allContainersVisibleCallback=Object(oa.a)(this,this.Iqk,"onAllContainersVisible");this.Jr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(Z)}nFj(){this.NHk&&
this.zfk.execute(Z=>{const Da=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();Da?Da.registerSafelinksNavigator(Object(oa.a)(Z,Z.Ktd,"tryNavigate")):Gb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}WCj(){this.Ydg();this.GR(!0,!1,!0);this.Jse=!0;const Z=this.m5b();kc.a.Okd(Z,[Ab.a.contextMenu]);if(this.Jr){this.Jr.setDhcContainerPanel(Z,this.Iva);var Da=Object.assign(new oj,{width:parseFloat(Z.style.width),
height:this.nmb,x:0,y:0});this.Jr.updateViewport(Da);this.Jr.setCompactContainers(this.cvb)}this.Cld();this.mE.itk(this.ua.ak);Da=this.Ea.Fc(ce.a.qW);Da.bJ=!0;Da.I1a=!0;Da.kca(Wa=>{this.Wjc(!0,!Wa||Wa.name!==ce.a.Az,!0)});Da.OBa((Wa,ib)=>{Wa=(ib.name===ce.a.ZO||ib.name===ce.a.waa)&&Wa.name===ce.a.qW;this.Wjc(!1,!1,ib.name===ce.a.Hp||ib.name===ce.a.sg||ib.name===ce.a.Az||ib.name===ce.a.qW||this.x0b&&ib.name===ce.a.LM||Wa)});this.Ea.$Wc(ce.a.qW,ce.a.gj,Z);this.zgh();this.ia.ya(Nd.a.j6,$a.a.frame,Object(oa.a)(this,
this.j6,"showHideComments"))}Cld(){const Z=this.hl.Wy();this.gjh(Z)}zgh(){if(this.Jr){const Z=this.m5b();if(Z){const Da=this.Ea.Fc(ce.a.qW);this.Zc.$Jb(Ab.a.click,Z,Object(oa.a)(this,this.$Gb,"onCommentPaneParentDivClick"),null,Da.I1a)}}}DFh(){if(this.Jr){const Z=this.m5b();Z&&this.Zc.yb(Ab.a.click,Z,Object(oa.a)(this,this.$Gb,"onCommentPaneParentDivClick"))}}m5b(){const Z=this.Kc&&this.Kc.Ic?this.Kc.Ic.Bca:null;return Z?Z.xa:null}gjh(Z){if(this.Kc.Ic&&this.Jse){if(!this.Jr)try{this.Ydg(),Gb.a.J(512496782,
801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.Jr)}catch(ib){Gb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",ib);return}var Da=Date.now();if((Z=this.QNf(Z))&&Z.length){var Wa=this.m5b();Wa.setAttribute(je.a.ef,"group");if(Wa){this.n4=this.d6i(Z);Gb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.n4.count);if(!this.n4.count&&
!this.AUa){this.GR(!1,!1,!0);Gb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-Da);return}this.Jr.setDhcContainerPanel(Wa,this.Iva);this.Jr.attachContainers(this.n4.toArray());this.GR(!0,!1,!0)}Gb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",Date.now()-Da)}}}QNf(Z){if(!Z||!Z.length)return Z;const Da=new m.a;for(const Wa of Z)0!==Wa.status?this.PNf(Wa.commentId):Da.add(Wa);return Da.toArray()}rFl(){this.Lqe=
!1;if(!this.Yn.Nwh&&!this.Yn.xW&&this.Kc.Ic){var Z=this.hl.v9a(this.Kc.Ic.Fd);for(const Da of Z)if(0===Da.status){this.selectComment(Da,null,!0,!0,0,0,!1);break}}}Ljj(){if(!this.Kc||!this.Kc.Ic||!this.Kc.Ic.Fd)return this.nmb;var Z=this.Kc.Ic.Fd;if(isNaN(Z.Vk))return this.nmb;Z=Z.Vk;return 0>Z?this.nmb:Z}tZf(Z){var Da=this.Yn.B8(Z);Z=Z.pos.Y;Da&&(Z+=Da.mD.y,Da.Ng&&(Da=this.Fa.ys(Da),Z+=Da&&Da.mD?Da.mD.y:0));return this.DCa(0,Z).y}t4e(){if(this.Jr){const Z=this.Ljj();Z!==this.UFg&&(this.UFg=Z,this.Jr.setSlideHeight(Z))}}jjh(Z){if(Z&&
0===Z.IQa){var Da=0;if(this.cvb)Da=-this.nmb,this.t4e();else{const Wa=this.pa.Jp();Wa&&(Da=this.DCa(0,Wa.mD.y).y)}Da=Object.assign(new ig,{contentId:Z.rC.draftId,containerContentType:0,anchorTop:Da,anchorLeft:0});this.GR(!0,!0,!0);this.Jr.setDhcContainerPanel(this.m5b(),this.Iva);this.Jr.updateDrafting(Da,!0);this.Jr.selectContainer(Z.rC.draftId,!0)}}W_k(Z){if(this.n4){var Da=0,Wa="";if(this.cvb){var ib=this.pa.Jp();ib&&(Da=this.DCa(0,ib.mD.y).y);if(ib=this.hl.Wy())for(const nb of ib)Wb.a.Wa(nb.commentId)||
this.tZf(nb)!==Da||(Wa=nb.commentId)}Da=Object.assign(new ig,{contentId:Z,containerContentType:0,anchorTop:Da,anchorLeft:0});this.cvb?this.Jr.updateDraftingAndPosition(Da,!1,Wa):this.Jr.updateDrafting(Da,!1);this.Jr.selectContainer(Z,!0)}}PNf(Z){if(this.Jr&&this.n4){for(let Da of this.n4)kh.aYg(Da,Z)&&(this.Jr.detachContainers([Da]),this.n4.remove(Da));this.j_()||this.AUa||this.GR(!1,!1,!0)}}d$k(){this.Lqe=!0}BOc(){this.x0b&&this.Am&&this.Am.isVisible&&this.Am.R6k()}ZUi(){var Z=this.ua.presentation;
if(!Z)return!1;Z=Z.slides;if(!Z)return!1;for(const Da of Z)if(Z=Object(mb.a)(td.a,Da))for(const Wa of this.hl.nta(Z.XD()))if(Jc.EN(Wa))return!0;return!1}k$d(Z){var Da=this.ua.presentation;if(!Da)return null;Da=Da.slides;if(!Da)return null;for(const Wa of Da)if(Da=Object(mb.a)(td.a,Wa),Yg.a.Jaa(Da.Cb,Z))return Da;return null}RUi(){return this.aWd||this.Wvi&&this.ZUi()}z7f(){const Z=this.pa.Na.mb,Da=this.pa.Na.t6;if(!Z||!Da)return null;var Wa=Object(mb.a)(5,Z.Ua.node),ib=Object(mb.a)(5,Da.Ua.node);
if(!Wa||!ib)return null;Wa=Object(mb.a)(Ui.TableCellNode,Wa.jL());ib=Object(mb.a)(Ui.TableCellNode,ib.jL());return Wa&&ib?Wa.rowIndex>ib.rowIndex?Z:Da:null}Vlj(){if(!this.RUi()||!this.pa.z_())return null;Gb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var Z=0,Da=0;if(this.pa.Na.Hl){var Wa=this.z7f();if(!Wa)return Gb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var ib=Wa}else ib=
this.pa.Na.mb;if(!ib)return Gb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const nb=({xLa:Z,tDa:Da}=Jc.Ulj(this.pa.o_(),ib,Z,Da)).returnValue;if(!nb||0>Z||0>Da||0>=Da-Z)return Gb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!nb,Da,Z),null;Wa=new Ek.a;Wa.StartPos=Z;Wa.EndPos=Da;if(this.pa.dVa()&&nb.get_smartArtModelId()){Gb.a.J(512496773,
805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Wa.AnchoringShape=new gi.a;Z=N.a.Hf(nb.get_smartArtModelId()).toString();if(!Z||!N.a.isValid(Z))return Gb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!Z),null;Wa.AnchoringShape.SmartArtNodeId=Z;this.mE.i4j()}else if(nb.Cs()){Gb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");
Da=Object(mb.a)(Ui.TableCellNode,nb.jL());if(!Da)return Gb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;Z=Da.rowId.toString();Da=Da.cellId.toString();if(!(Z&&Da&&N.a.isValid(Z)&&N.a.isValid(Da)))return Gb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!Z,!Da),null;Wa.AnchoringShape=new gi.a;Wa.AnchoringShape.TableCell=new Zg;Wa.AnchoringShape.TableCell.RowId=
Z;Wa.AnchoringShape.TableCell.ColId=Da;this.mE.j4j()}Z=Object(mb.a)(5,ib.Ua.node);ib=Object(mb.a)(5,ib.Ye.node);Z!==ib&&this.mE.l4j();Gb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Wa}zLi(Z){if(this.Jr&&Z){for(const Da of this.n4.toArray()){let Wa=!1;for(const ib of Z)if(kh.aYg(Da,ib.commentId)){Wa=!0;break}Wa||(this.Jr.detachContainers([Da]),this.n4.remove(Da),Gb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",Da.contentId))}this.j_()||
this.AUa||this.GR(!1,!1,!0)}}m2b(){if(this.Jr){for(const Z of this.n4.toArray())this.Jr.detachContainers([Z]);this.n4.clear()}this.j_()||this.AUa||(this.DDa&&!this.lHa?this.GR(!1,!1,!1):this.GR(!1,!1,!0))}JZe(Z){if(!Z)return null;Z.sort((Da,Wa)=>{var ib=this.Yn.B8(Da);ib=ib?ib.mD:new Dd.a(0,0);var nb=this.Yn.B8(Wa);nb=nb?nb.mD:new Dd.a(0,0);ib.y+=Da.pos.Y;nb.y+=Wa.pos.Y;ib.x+=Da.pos.X;nb.x+=Wa.pos.X;let jc=ib.y-nb.y;jc||(jc=ib.x-nb.x)||(jc=+Da.dt-+Wa.dt);return jc});return Z}d6i(Z){const Da=new m.a;
if(Z){this.cvb&&this.t4e();for(const Wa of Z)Wb.a.Wa(Wa.commentId)||(Z=this.tZf(Wa),Z=Object.assign(new ig,{contentId:Wa.commentId,containerContentType:0,anchorTop:Z,anchorLeft:0}),Da.add(Z))}return Da}jY(Z){this.Y3g(Z)}hhh(Z,Da){for(let Wa=0;Wa<Z.Ra.length;Wa++){const ib=Z.Ra.ga(Wa);if(!ib.yg)continue;const nb=[];for(let jc=0;jc<ib.yg.length;jc++){const cc=ib.yg.ga(jc);cc.uI.equals(Da)&&nb.push(cc)}if(!(1>nb.length))try{Z.Yoa=!0;for(const jc of nb)ib.yg.remove(jc)}catch(jc){Gb.a.J(512496738,805,
10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",jc.toString())}finally{Z.Yoa=!1}}}esf(Z,Da,Wa){Z.yg||(Z.yg=new Ti.a(Z));const ib=Z.yg.He.paragraph;Da=new yh.a(Z.yg.He,null,Da,Wa);Z.yg.add(Da);ib.fv()}sLc(Z){return Ge.a.Hf("{"+Z+"}{1}")}uYb(Z,Da,Wa,ib){let nb=null;for(let jc=0;jc<Z.Ra.length;jc++){let cc=Z.Ra.ga(jc);if(cc.cp>=Wa){try{Z.Yoa=!0;if(cc.cp>Wa||!cc.formatting)this.jJ.lga(Z,jc,Wa,nb),cc=Z.Ra.ga(jc);this.esf(cc,Da,ib)}catch(Ad){Gb.a.J(512496737,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Ad.toString())}finally{Z.Yoa=!1}return}cc.formatting&&(nb=cc.formatting)}if(Kb.ParagraphReader.textLength(Z)>=Wa)try{Z.Yoa=!0;this.jJ.lga(Z,Z.Ra.length,Wa,nb);const jc=Z.Ra.ga(Z.Ra.length-1);this.esf(jc,Da,ib)}catch(jc){Gb.a.J(512496736,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",jc.toString())}finally{Z.Yoa=!1}}X2b(){var Z=this.hl.Wy();
if(Z){var Da=Date.now(),Wa=!1,ib=new Na.a;for(var nb of Z){var jc=Jc.K6b(nb,this.Yn.B8(nb));ib.$(nb.commentId,jc)}for(var cc of Z)if(cc.textAnchoringInfo&&(nb=this.Yn.B8(cc))&&(jc=ib.ga(cc.commentId),!jc||!jc.isValid||jc.fng(cc.textAnchoringInfo)))for(var Ad of nb.$D())this.hhh(Object(mb.a)(Zc.AParagraphNode,Ad),this.sLc(cc.commentId));for(const Xd of Z)if((Z=ib.ga(Xd.commentId))&&Z.isValid&&Z.fng(Xd.textAnchoringInfo)&&(this.Am.isVisible||0===Xd.status)){Wa=this.sLc(Xd.commentId);this.uYb(Z.ZU,Wa,
Z.startPos,!0);if(Z.X$b)for(cc=1;cc<Z.paragraphs.length;cc++){if(Ad=Z.paragraphs[cc])this.uYb(Ad,Wa,0,!0),Z.o3.equals(Ad)?this.uYb(Z.o3,Wa,Z.endPos,!1):this.uYb(Ad,Wa,Kb.ParagraphReader.textLength(Ad),!1)}else this.uYb(Z.o3,Wa,Z.endPos,!1);Z.FHj();Wa=!0}Wa&&Gb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-Da)}}P6g(Z,Da){if((Z=this.hl.mta(Da.node))&&(Da.property===Bb.a.Tsc||Da.property===Bb.a.Ssc||Da.property===Bb.a.wsd||Da.property===Bb.a.xsd)){const Wa=
Jc.EN(Z);Wa&&this.X2b();!Z.textAnchoringInfo||Wa||Da.property!==Bb.a.xsd&&Da.property!==Bb.a.wsd||this.mE.k4j(Z,this.sLc(Z.commentId),this.Yn.B8(Z),this.Kc.Ic.Ma)}}CRf(){this.ei&&this.A$&&(this.$_.wUe(this.A$.length,this.heb,this.Ro,this.Mqe.k1c),this.$_.AUe(Array.clone(this.A$),Array.clone(this.nfb)),this.lEf(2))}NUj(Z,Da){Da=this.Qb.Nc(Da);for(var Wa=Da.Bb(2);Wa;Wa=Da.Cf(2))if((Wa=Object(mb.a)(115,Wa))&&Yg.a.Jaa(Wa.Cb,Z))return!0;return!1}CB(Z,Da){Da&&(Z=Object(mb.a)(537,Da.node),Da=Da.TZ,Z&&2===
Da&&((Da=this.RX.Ef)&&Da.slides&&0>=Da.slides.length&&this.Am.isVisible&&this.Vnc(!1,!1),this.ei&&(Da=this.ei.w8,!Da&&this.ua.Ba&&(Da=this.ua.Ba.Cb),this.NUj(Da,Z)||this.CRf())))}S1g(Z,Da){if((Z=this.hl.mta(Da.node))&&Jc.EN(Z)&&(Da=this.Yn.B8(Z)))for(const Wa of Da.$D())this.hhh(Object(mb.a)(Zc.AParagraphNode,Wa),this.sLc(Z.commentId))}O5g(Z,Da){(Z=Object(mb.a)(4,Da.node))&&0<Z.$D().length&&(Da.Dfg&192||Da.Dfg&4)&&this.X2b()}xkc(Z,Da){Z=Da.property;Da=Da.node;if(Z===ff.a.wy||Z===ff.a.yy)if(Z=this.hl.Wy()){for(const Wa of Z)Wa.pos.Y=
Da.mD.y,Wa.pos.X=Da.mD.x;this.Cld()}}agd(){Gb.a.J(512496734,805,this.B$a?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.B$a)}nxa(Z,Da){Gb.a.J(512496733,805,this.B$a?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",Bi.a[Da.lG],this.B$a)}dispose(){this.ln&&(this.ln.dispose(),this.ln=null);this.GDb&&(this.GDb.dispose(),this.GDb=null);this.uy.jih(Object(oa.a)(this,this.fJa,"onBeforeSlideSwitched"));this.uy.ioa(Object(oa.a)(this,this.p4e,"updateCommentsWhenNavigateSlide"));
this.uy.mKb(Object(oa.a)(this,this.Krf,"activeSlideDOMDisplayed"));this.Nq.oZk(Object(oa.a)(this,this.N4g,"onPageViewZoomChanged"));this.Es.Tih(Object(oa.a)(this,this.onShapeSelected,"onShapeSelected"));this.Es.CZk(Object(oa.a)(this,this.K5g,"onShapeDeselected"));this.uy.wld(Object(oa.a)(this,this.V5g,"onShapeTextSelected"));this.uy.mRe(Object(oa.a)(this,this.gZa,"onSlideBackgroundClicked"));this.kfb.Cm(Object(oa.a)(this,this.xkc,"onShapePropertyChange"));this.kfb.lZk(Object(oa.a)(this,this.O5g,"onShapeInvalidation"));
this.Lc.ZXk(Object(oa.a)(this,this.a3g,"onF6FocusDocument"));this.Lc.eRe(Object(oa.a)(this,this.Wgb,"onSetFocus"));this.m9b&&this.b5.execute(Z=>{Z.oRe(this.iZa)});this.jbd.Cm(Object(oa.a)(this,this.P6g,"onTextAnchorPropertyChanged"));this.cIg.bP(Object(oa.a)(this,this.CB,"onChildTopologyChanged"));this.jbd.rKa(Object(oa.a)(this,this.S1g,"onBeforeTextAnchorDisconnect"));this.Rb.yY(Object(oa.a)(this,this.z1g,"onAppModeSwitched"));this.L3c.Qih(Object(oa.a)(this,this.agd,"onSessionExpired"));this.L3c.paa(Object(oa.a)(this,
this.nxa,"onSessionEnded"));this.Rb.oKb(Object(oa.a)(this,this.jY,"onSetOffline"));this.tH||this.Zc.yb(Ab.a.click,this.cEb,Object(oa.a)(this,this.$Gb,"onCommentPaneParentDivClick"));this.DFh();this.yO=this.cEb=null;this.lq.uoc(Object(oa.a)(this,this.cgd,"onShapeViewElementAddedOrRemoved"));this.lq.HZk(Object(oa.a)(this,this.cgd,"onShapeViewElementAddedOrRemoved"));this.pa.aya(Object(oa.a)(this,this.EH,"onSelectionChanged"))}get isReadOnly(){return this.Ro}get AUa(){return!!this.ei}get hasFocus(){return this.Zse}EBi(){const Z=
new Vi.a;var Da=new Md(Nd.a.iUa,Ch.a.application);Da.preCallback=Object(oa.a)(this,this.CJc,"claimFocus");Da.postCallback=Object(oa.a)(this,this.IOf,"disableOnEmptyDeckAndReadOnly");Z.$(0,Da);Da=new Md(Nd.a.deleteComment,Ch.a.application);Da.preCallback=Object(oa.a)(this,this.CJc,"claimFocus");Da.postCallback=Object(oa.a)(this,this.IOf,"disableOnEmptyDeckAndReadOnly");Z.$(3,Da);Da=new Md(Nd.a.dMe,Ch.a.application);Da.preCallback=Object(oa.a)(this,this.CJc,"claimFocus");Da.postCallback=Object(oa.a)(this,
this.fah,"postCommentAction");Z.$(2,Da);Da=new Md(Nd.a.rFe,Ch.a.application);Da.preCallback=Object(oa.a)(this,this.CJc,"claimFocus");Da.postCallback=Object(oa.a)(this,this.fah,"postCommentAction");Z.$(1,Da);Da=new Md(Eb.a.nOb,Ch.a.application);Da.preCallback=Object(oa.a)(this,this.fll,"showHideActionPreCallback");Da.postCallback=Object(oa.a)(this,this.ell,"showHideActionPostCallback");Da.delayActionsUntilRegistration=this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Rb.a("DelayCommentsShowHideAction");Z.$(6,Da);return Z}fll(Z,Da,Wa,ib,nb){if(1===Wa)return!this.ua.Ba||this.isDisabled?8:2;Gb.a.J(36983504,805,50,"New Comment Pane opened.");this.Am.ygb(!!nb&&nb.AutoShowHide);return 2}ell(Z,Da,Wa,ib,nb,jc){if(1===ib)return Z&&this.mE.Nrk(this.ua.ak),Z?32:8;this.svf(this.Am.isVisible,!!jc&&jc.AutoShowHide);return Z?32:8}CJc(Z,Da,Wa,ib,nb){if(1===Wa&&this.pa.tUa())return 8;1!==Wa&&((this.tdc=!!nb&&nb.ShouldCanvasTakeFocus)||this.Gsa(),this.pa.ay(),this.qte=!0);
return 2}fah(Z,Da,Wa,ib){if(1===ib&&(this.XWa||!this.A$))return 8;this.tdc=!1;return Z?32:8}IOf(Z,Da,Wa,ib){return(1!==ib||!this.Ro&&this.A$)&&this.Kc.Ic?Z?32:8:8}DCa(Z,Da){return new Dd.a(this.a9c.Pe(Z,0),this.a9c.Pe(Da,1))}JIf(Z,Da){return new Dd.a(this.a9c.rf(Z,0),this.a9c.rf(Da,1))}twb(Z){Z=this.hl.qta(Z);return this.hl.mta(Z)}Yfa(Z,Da,Wa){!this.nUf()||Z!==this.ei.rC.draftId&&Z!==this.ei.commentId?this.rvb()&&Z===this.ei.rC.draftId?(this.$_.selectComment(Z),this.Jr&&this.Jr.selectContainer(Z,
!0),this.iUf&&!this.hasFocus&&1!==Da&&this.Gsa()):this.selectComment(this.twb(Z),null,!0,!0,0,Da,Wa):(Z=this.k$d(this.ei.w8),Z)?1!==Da&&(this.ei.P_c=!0,this.Ha.Jn?this.bYa.GJ(Z.le):this.Ge.GJ(Z.le)):(Gb.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.ei.rC.draftId,0))}selectComment(Z,Da,Wa,ib,nb,jc,cc){this.pa.ay();Da=this.hLb?this.hLb.commentId:null;cc||this.BOc();0!==jc?Z?this.$_.selectComment(Z.commentId):
this.$_.selectComment(null):0===jc&&(jc=this.Yn.B8(Z))&&jc.RK&&this.Yn.Qnd(vi[jc.RK]);this.ln&&this.ln.selectComment(Z,!0);!this.Am.isVisible&&this.Jr&&Z&&Z!==this.RVa&&(jc=this.hl.E9d(Z.commentId))&&(jc=this.hl.mta(jc),this.Jr.selectContainer(jc.commentId,!this.tdc&&!cc&&!this.qte),this.qte=!1,this.Kc&&this.Kc.Ic&&this.Kc.Ic.Gud(5,!1,this.cBb));cc||this.tdc||this.Gsa();!this.Yn||!this.Am.isVisible&&this.Am.isVisible||(this.Yn.hUe(Z,Da,!0,!1,cc),Jc.EN(Z)&&!cc&&this.X2b());this.Rb.updateCommandUI()}get hLb(){return this.ln&&
this.ln.kLb?this.ln.kLb.comment:null}V6k(){if(!this.XWa){const Z=ve.a.yk("SelectNextCommentCrossSlide",1),Da=!this.Am.isVisible;this.XWa=!0;this.j5c.y3d((Wa,ib)=>{this.q3g(Wa,ib,1,Z)},Z,Da)}}Y6k(){if(!this.XWa){const Z=ve.a.yk("SelectPreviousCommentCrossSlide",1),Da=!this.Am.isVisible;this.XWa=!0;this.j5c.F3d((Wa,ib)=>{this.q3g(Wa,ib,0,Z)},Z,Da)}}q3g(Z,Da,Wa,ib){ib.Xm("FindCommentEndTime",new Date);this.zb.Db(new zf.a(2,1,100,()=>{this.XWa&&(this.XWa=!1,this.$hl(Z,Da,Wa)?this.Yfa(this.ei.commentId||
this.ei.rC.draftId,0,!1):Da&&Z&&this.Kc.Ic.Fd?Z.Cb.equals(this.Kc.Ic.Fd.Cb)?(this.selectComment(Da,null,!0,!0,2,1,!1),ib.Va("CircularSelectCommentInSingleSlide",wf[Wa]),ib.finish()):(this.uGa=Object.assign(new Sd,{slide:Z,comment:Da,direction:Wa,gUe:ib}),this.Ha.Jn?this.bYa.GJ(Z.le):this.Ge.GJ(Z.le)):(this.Rb.updateCommandUI(),ib.Va("NoCommentFound",wf[Wa]),ib.finish()))},90,"47"))}M2f(){let Z=-1;if(!this.ei)return Z;if(this.ei.w8){const Da=this.k$d(this.ei.w8);Da&&(Z=Da.le)}else this.Kc.Ic&&this.Kc.Ic.Fd&&
(Z=this.Kc.Ic.Fd.le);return Z}$hl(Z,Da,Wa){if(!this.ei||this.ei.rC.sessionType!==lc.create)return!1;const ib=this.M2f();if(0>ib)return!1;if(!Da||!Z)return!0;Da=this.Kc.Ic.Fd.le;if(1===Wa)return Wa=ib<=Da&&Da<Z.le,Da=Z.le<=Da&&Da<ib,ib<=Z.le&&!Wa||Da;Wa=ib>=Da&&Da>Z.le;Da=Z.le>=Da&&Da>ib;return ib>Z.le&&!Wa||Da}jMa(Z){0!==Z&&this.$_.selectComment(null);this.ln&&this.ln.selectComment(null,!1);if(this.Jr&&(this.Jr.deselectContainer(),this.Kc&&this.Kc.Ic)){let Da=5;const Wa=this.pa.Jp();Wa&&Wa.Rf&&(Da=
2);this.Kc.Ic.Gud(Da,!1,this.cBb)}this.Yn&&0!==Z&&(this.Yn.TMc(),this.Yn.vMc());this.Rb.updateCommandUI()}d4h(Z){this.Pqb(this.twb(Z),0)}Pqb(Z,Da){this.RVa!==Z&&(this.Yn&&(Z?this.Yn.c4h(Z):this.Yn.vMc()),this.RVa=Z,0!==Da&&(this.RVa?this.$_.highlightComment(this.RVa.commentId):this.$_.highlightComment(null)),this.ln&&this.ln.Pqb(this.RVa,!0))}T6k(){if(this.c2b){var Z=this.twb(this.c2b),Da=this.Kc.Ic.Fd.sid,Wa=Da===parseInt(this.yZd);Z?(1!==Z.status&&2!==Z.status||this.oqd(),this.selectComment(Z,null,
!0,!0,0,1,!1),this.mE.ksk(this.ua.ak),Gb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",this.c2b,this.yZd)):(Wa&&this.Rd.zs(Object.assign(new bk.a,{Code:389,Source:4}),this.Xa.podSessionId),Gb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.c2b,this.yZd,parseInt(Da)))}}get manager(){return this.hl}get NS(){return"per"}get $Xg(){return this.yO}set $Xg(Z){this.yO=Z;this.ln&&
(this.ln.parentElement=Z)}get A_g(){return this.Dfc}set A_g(Z){this.Dfc=Z}Ikd(Z){this.TJb(Z,void 0,!0)}zU(Z,Da){Da=!Rb.a("FixAltF12KeboardingInCommentPane")||Da;this.Wjc(Z,Da,!0)}YPe(){!this.tH&&this.Am&&(this.cEb.style.display=this.Am.isVisible?"flex":"none");this.ln&&(this.ln.setVisibility(this.Xcb),this.ln.wvh(this.Zcb),this.Yn.Dub(this.RVa))}Vnc(Z,Da){this.xEh(Z,Da);this.YPe();this.svf(Z,Da)}N4g(){this.ln&&!this.qdc&&this.ln.R4e();this.Cld();this.cvb&&this.t4e()}lbh(){this.XWa=!1;this.URf();this.ln&&
this.ln.wQe();this.PEb=!1;this.DFh()}URf(){this.hl.NFh()}fJa(){this.lHa=this.j_()||this.rvb();this.Yn&&this.lHa&&(this.Yn.TMc(),this.Yn.vMc());this.I2d&&(this.lbh(),this.Zyf())}Dil(){return this.ei&&this.ei.w8&&this.ua.Ba?this.ei.P_c&&Yg.a.Jaa(this.ei.w8,this.ua.Ba.Cb):!1}p4e(){this.I2d||this.lbh();this.ua.Ba||this.fJa(this,null);this.URf();this.Kc.Ic&&(this.$Xg=this.Kc.Ic.XVd);const Z=this.Kc&&this.Kc.Ic?this.hl.v9a(this.Kc.Ic.Fd):this.hl.Wy(),Da=this.vaj(Z),Wa=this.j_()||this.rvb();this.Q9c||Wa||
(this.Ik.aaa(this.Ik.kUd,this.Ik.$Vd),this.Q9c=!0);this.Am.isVisible||(Wa?(this.m2b(),this.kjh()):this.j_()?(this.m2b(),this.GR(!0,!1,!0)):this.DDa&&!this.lHa?this.GR(!1,!1,!1):this.GR(!1,!1,!0),this.zgh());this.TJb(Z,e.AFrameworkApplication.isRtl,!1,Da);this.Dil()?(this.Yfa(this.ei.commentId||this.ei.rC.draftId,0,!1),this.ei.P_c=!1):-1<Da&&this.Yfa(Z[Da].commentId,0,!1);this.uGa&&(this.uGa.gUe.finish(),this.uGa=null);this.A1a(!1);-1!==Da&&this.ln&&(this.ln.Pqb(null,!1),this.ln.selectComment(Z[Da],
!1));this.I2d||this.Zyf()}Krf(){if(this.lBe){try{this.tcb.iml(this.BRg,this.ua,this.Ge)}catch(Z){Gb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",Z)}this.lBe=!1}}A1a(Z){const Da=this.M2f();this.Mqe.A1a(Z,Da)}kDl(Z){this.ei&&!this.ei.w8&&(this.ei.w8=Z)}onShapeSelected(Z,Da){this.hPc&&(Z=Da.shapeNode,this.aXe(Z),Z&&0<Z.$D().length&&this.X2b())}V5g(Z,Da){this.hPc&&(this.aXe(Da.Jw.shapeNode),this.X2b())}EH(Z,Da){if(Da&&Da.ll&&this.pa.z_()&&
(Z=this.hl.Wy())){Da=!1;for(var Wa of Z)if(Jc.EN(Wa)){Da=!0;break}Da&&((Wa=this.pa.o_())?this.aXe(Wa):Gb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}aXe(Z){Z.get_shapeId()&&(this.Yn&&Z!==this.Yn.xW&&this.jMa(1),this.ioh(Z.get_shapeId(),!0))}ioh(Z,Da){var Wa=this.hl.Wy();if(Wa){var ib=null,nb=null,jc=0,cc=null;for(const Ad of Wa)if((this.Am.isVisible||0===Ad.status)&&Ad.anchorShape===Z)if(this.pa.z_()&&Jc.EN(Ad)){Wa=this.pa.Na.mb.Ua;
const Xd=this.pa.Na.mb.Ye,xe=Jc.K6b(Ad,this.Yn.B8(Ad));xe&&xe.isValid?(this.hLb&&this.hLb.commentId===Ad.commentId||xe.zsd===Ad.textAnchoringInfo.TextBodyLength)&&xe.hLj(Wa,Xd)&&(nb?(Wa=xe.Zeh,Wa<jc&&(nb=Ad,jc=Wa)):(nb=Ad,jc=xe.Zeh)):(ib=Ad,Gb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else nb||cc||Jc.EN(Ad)||(cc=Ad);nb?this.Yfa(nb.commentId,1,Da):cc?this.Yfa(cc.commentId,1,Da):this.pa.z_()&&!ib?this.Yn&&this.jMa(1):ib&&this.Yfa(ib.commentId,
1,Da)}}K5g(){if(this.hPc){var Z=this.q6d();this.Yn.Qnd(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,Z.toString()));this.jMa(1)}}q6d(){const Z=this.hl.Wy();let Da=[];Z&&(Da=Mg.e(Z,Wa=>0===Wa.status));return Da.length}gZa(){this.hPc&&this.jMa(1)}a3g(Z,Da){Da.vgb===ce.a.sg&&this.Yn.Qnd(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.q6d().toString()));Da.JIb===ce.a.sg&&this.jMa(1)}Wgb(Z,Da){this.iUf&&Da.vgb!==ce.a.qW&&
(Da.JIb===ce.a.qW||ce.a.Az)&&this.B$a&&this.jMa(1)}vaj(Z){let Da=-1;if(this.uGa&&this.Kc.Ic)if(this.uGa.slide!==this.Kc.Ic.Fd)Gb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");else if(Z&&0<Z.length){if(this.Am.isVisible)Da=1===this.uGa.direction?0:Z.length-1;else if(1===this.uGa.direction)for(var Wa=0;Wa<Z.length;Wa++){if(0===Z[Wa].status){Da=Wa;break}}else for(Wa=Z.length-1;0<=Wa;Wa--)if(0===Z[Wa].status){Da=Wa;break}0<=Da&&Da<Z.length&&
(Z=Z[Da],Wa=this.uGa.comment,Wa.dt===Z.dt&&Wa.commentId===Z.commentId&&Wa.authorName===Z.authorName||Gb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return Da}aHe(){!this.hl.r$i()||this.f9c?(this.TJb(this.hl.Wy(),e.AFrameworkApplication.isRtl,!0),this.f9c&&(this.f9c=!1)):this.ei&&(0===this.ei.IQa||1===this.ei.IQa?(this.sUf&&this.TJb(this.hl.Wy(),e.AFrameworkApplication.isRtl,!0),0===this.ei.IQa&&(this.T$c=!0)):this.ei&&2===this.ei.IQa&&this.sUf&&
this.TJb(this.hl.Wy(),e.AFrameworkApplication.isRtl,!0))}Rrk(){dd(this.Pb)&&(this.f9c=!0,this.aHe())}get Jnd(){const Z=this.pa.Jp();if(Z){const Da=Z.mD;this.aBe=new Dd.a(e.AFrameworkApplication.isRtl?Da.x:Da.x+Z.rx,Da.y)}else this.aBe=null;return this.aBe}get k7k(){if(!this.pa.z_())return null;var Z=Object(mb.a)(5,this.pa.Na.mb.Ye.node);if(!Z)return null;const Da=Object(mb.a)(477,Z.sc(this.Kc.Ic.Ma));if(!Da)return null;var Wa=null,ib=Da.htmlElement.getElementsByClassName("Selected");if(0<ib.length)Wa=
ib[ib.length-1];else if(this.pa.Na.Hl){if(ib=this.z7f())if(ib=Object(mb.a)(5,ib.Ye.node))if(ib!==Z){if(Z=Object(mb.a)(477,ib.sc(this.Kc.Ic.Ma)))Wa=Z.htmlElement}else Wa=Da.htmlElement}else return null;Z=this.pa.Jp();if(!Z||!Wa)return null;Z=Object(mb.a)(117,Z.sc(this.Kc.Ic.Ma));if(!Z)return null;Wa=Mh.a.$h(Wa);Z=Mh.a.$h(Z.qq);if(0>=Wa.width+Wa.height&&0>=Z.width+Z.height)return null;Z=Dd.a.bV(new Dd.a(Wa.x,Wa.y),new Dd.a(Z.x,Z.y));return this.JIf(Z.x+Wa.width-5,Z.y+10)}get anchorNode(){const Z=this.pa.Jp();
return this.isg=Z?Z:this.Kc.Ic.Fd}xEh(Z,Da){this.Am&&(Da||this.Gph(),this.Wfb.Zrh(Z?3:1),!this.isDisabled&&Z&&Rb.a("CommentShimmerBugFix")&&this.vX&&this.vX.isVisible&&(this.vX.jcg(),this.Rb.ygb(1)),this.GR(!Z,!1,!0),this.Am.xp(!this.isDisabled&&Z,Da),this.Am.isVisible&&(this.Xcb=!0))}GR(Z,Da,Wa){const ib=this.j_();Wa&&(!ib&&!this.lHa||ib&&this.lHa)&&Gb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");
!this.j_()&&!this.AUa&&Z&&!Da||this.Am.isVisible&&Z&&!Da||this.j_()&&this.vX&&this.vX.isVisible&&!Z&&!Da||!this.Kc.Ic||!(Da=this.Kc.Ic.Bca)||(Da.setVisibility(Z),Z=new Dh.a(Z),this.uy.Qdh(Z),Wa?this.Rb.ygb(1):Gb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Kc.Ic.Gud(5,!1,this.cBb))}hAl(Z){this.Am&&(this.Xcb=!this.isDisabled&&Z,this.Xcb||(this.Wfb.Zrh(1),this.Am.xp(!1,!1),this.Ea.Cj(ce.a.Hp,!1)))}Dej(){const Z=
new og;Z.focusCallback=Object(oa.a)(this,this.oQc,"focusFirstPaneElement");return Object.assign(new Bh.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.wNl?300:320),contentProps:Z,location:2,onOpen:Da=>{kc.a.Okd(Da,[Ab.a.contextMenu]);const Wa=this.Ea.Fc(ce.a.Hp);this.Zc.$Jb(Ab.a.click,Da,Object(oa.a)(this,this.$Gb,"onCommentPaneParentDivClick"),null,Wa.I1a)},onClose:Da=>{this.Vnc(!1,!1);this.Zc.yb(Ab.a.click,Da,Object(oa.a)(this,this.$Gb,"onCommentPaneParentDivClick"))},isModernPane:!0})}Zyf(){if(!this.Jxg){var Z=
this.hl.Wy();Z=!!Z&&0<Z.length;Gb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",Z);Z?this.j_()&&this.GR(!0,!1,!0):(this.m2b(),this.DDa&&!this.lHa?this.GR(!1,!1,!1):this.GR(!1,!1,!0))}}oqd(){this.Am.isVisible||this.ia.processAction(Nd.a.j6,2);this.BOc()}dzj(){this.Am.isVisible&&this.ia.processAction(Nd.a.j6,2)}qk(Z){return this.qe.qk(Z)}get isDisabled(){const Z=this.RX.Ef;return Z?Z.E$a:!0}ftf(){this.c$c||(this.c$c=new zf.a(0,1,0,Object(oa.a)(this,this.OSk,"refreshCommentsTask"),
90,"48"),this.zb.Db(this.c$c))}z1g(Z){this.Y3g(1===Z.mode)}Y3g(Z){this.Ro=Z;this.ftf();Rb.a("PreventCommentPaneCloseOnReadOnlyChanged")?this.CRf():this.Am.isVisible&&this.Ro&&this.dzj()}M8d(){return this.A$?this.A$:[]}p4f(){return this.nfb?this.nfb:[]}get B0g(){return this.heb}get iMc(){return this.ei}I2f(Z){const Da=this.Kc&&this.Kc.Ic?this.hl.v9a(this.Kc.Ic.Fd):this.JZe(this.hl.Wy());if(!Da||!Da.length)return 0;let Wa=null;this.Jnd&&(Wa=this.DCa(this.Jnd.x,this.Jnd.y));let ib=-1,nb=0;for(let Xd=
0;Xd<Da.length;Xd++){var jc=this.Yn.B8(Da[Xd]);if(!Wa&&jc)break;if(jc&&Wa){var cc=jc.mD.x,Ad=jc.mD.y;cc+=Da[Xd].pos.X;Ad+=Da[Xd].pos.Y;jc.Ng&&(jc=this.Fa.ys(jc),cc+=jc&&jc.mD?jc.mD.x:0,Ad+=jc&&jc.mD?jc.mD.y:0);Ad=this.DCa(cc,Ad);cc=Ad.y;Ad=Ad.x;if(Wa.y<cc)break;if(Wa.y>cc||Wa.y===cc&&Wa.x>=Ad)ib=Xd,Da[Xd].Children&&Z&&(nb+=Da[Xd].Children.length)}else jc||(ib=Xd,Da[Xd].Children&&Z&&(nb+=Da[Xd].Children.length))}return ib+nb+1}MCj(Z){if(!this.Jse)throw Gb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),
E.a.Ys(-2130915320);if(this.ei)return Gb.a.J(512496720,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),E.a.Ys(-2130915319);if(null===Z)throw Error.argumentNull("session");if(!Z.commentId.length&&0!==Z.IQa)return E.a.Ys(-2130915327);this.ei=Z;this.A1a(!0);0===Z.IQa&&(this.jMa(0),this.Am.isVisible||this.jjh(Z));if(this.Am.isVisible||!this.Am.isVisible)this.Gsa(),this.IQi();let Da="";Z.rC&&(Da=Z.rC.draftId);Gb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",
Da);return null}endCommentSession(Z,Da){if(this.ei){if(this.ei.rC&&this.ei.rC.draftId!==Z)throw Gb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",Z,this.ei.rC.draftId),E.a.Ys(-2130915327);this.eug=Da}9!==Da||this.Am.isVisible||this.Ea.iD(ce.a.sg);this.ei=null;this.Rb.updateCommandUI();if(this.Jr&&!this.Am.isVisible){const Wa=[Object.assign(new ig,{contentId:Z,containerContentType:0,anchorTop:0,anchorLeft:0})];this.Jr.detachContainers(Wa);
this.j_()||this.GR(!1,!1,!0)}this.M$c.Nlg&&this.JOf();Gb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",Z,Da)}get Uvi(){return this.eug}d6(){this.Gsa()}YNf(Z){if(this.Ha.ka("CommentCopyPasteEnabled")&&!this.tcb.WUj)for(const Da of Z)for(const Wa of this.hl.nta(Da.XD()))if(1===Wa.status){this.BRg=new Pf(Z,this.hl);this.lBe=!0;return}}wb(){1!==this.xdc.eja&&(this.ia.ya(Nd.a.nrc,Ch.a.application,Object(oa.a)(this,this.j6,"showHideComments")),this.ia.ra(Nd.a.bOe,
Ch.a.application,Object(oa.a)(this,this.cKa,"queryShowHideComments"),97));this.gRf&&(this.ia.ya(Nd.a.nRa,Ch.a.application,Object(oa.a)(this,this.i2b,"deleteAllComments")),this.ia.ya(Nd.a.vub,Ch.a.application,Object(oa.a)(this,this.i2b,"deleteAllComments")),this.ia.ya(Nd.a.wub,Ch.a.application,Object(oa.a)(this,this.i2b,"deleteAllComments")));this.ia.ya(Nd.a.NMb,Ch.a.application,Object(oa.a)(this,this.j6,"showHideComments"));this.ia.ra(Eb.a.JOe,$a.a.frame,Object(oa.a)(this,this.cKa,"queryShowHideComments"),
97);this.ia.ra(Nd.a.cKa,Ch.a.application,Object(oa.a)(this,this.cKa,"queryShowHideComments"),97);this.ia.ra(Nd.a.zJb,Ch.a.application,Object(oa.a)(this,this.cKa,"queryShowHideComments"),97);this.ia.ra(Nd.a.Mjd,Ch.a.application,Object(oa.a)(this,this.cKa,"queryShowHideComments"),97);this.ia.ya(Nd.a.CEe,Ch.a.application,Object(oa.a)(this,this.Udd,"nudgeCommentMarker"));this.ia.ya(Nd.a.DEe,Ch.a.application,Object(oa.a)(this,this.Udd,"nudgeCommentMarker"));this.ia.ya(Nd.a.EEe,Ch.a.application,Object(oa.a)(this,
this.Udd,"nudgeCommentMarker"));this.ia.ya(Nd.a.FEe,Ch.a.application,Object(oa.a)(this,this.Udd,"nudgeCommentMarker"));this.ia.ya(Nd.a.mOb,Ch.a.application,Object(oa.a)(this,this.mOb,"toggleCommentAnchoringFocus"));this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.ya(Eb.a.Oub,Ch.a.application,Object(oa.a)(this,this.Oub,"doesCommentExist")),this.ia.ya(Eb.a.s0b,Ch.a.application,Object(oa.a)(this,this.s0b,"commentActivitySelected")));this.Ee()}Ee(){var Z=
this.Ea.Fc(Vh.AFrame.gj),Da=this.Ea.Fc(ce.a.Az);const Wa=this.Ea.Fc(ce.a.MR);Z.bindAction(Jg.KeyInputManager.Oa(ue.a.Pza,1),Nd.a.mOb);Da.bindAction(Jg.KeyInputManager.Oa(ue.a.Pza,1),Nd.a.mOb);Wa.bindAction(Jg.KeyInputManager.Oa(ue.a.Pza,1),Nd.a.mOb);Z=this.Ea.Fc(ce.a.Hp);Da=[Z,this.Ea.Fc(pg.a.PD),this.Ea.Fc(pg.a.T2),this.Ea.Fc(ce.a.sg),this.Ea.Fc(ce.a.lQ)];for(const ib of Da)ib.bindAction(Jg.KeyInputManager.Oa(ue.a.Qga,Jg.KeyInputManager.Oe|(Yb.a.vk?4:1)),Nd.a.iUa);Z.bindAction(Jg.KeyInputManager.Oa(ue.a.Qza,
1),Nd.a.iUa)}TJb(Z,Da,Wa,ib=-1){this.Iva=Da;!this.ln&&this.yO&&(this.ln=new ie(this.yO,this,this.GDb,this.Iva,this.Xcb),this.Yn.rcd=this.ln);if(Z){kh.H1j(Z);Da=null;this.pa.z_()&&(Da=this.pa.Na);var nb=0<Z.length?Z[Z.length-1]:null;if(this.ln){var jc=this.ln.kLb?this.ln.kLb.comment:null;const cc=jc?jc.commentId:null;this.ln.isRightToLeft=this.Iva;this.ln.Ikd(Z);this.Yn&&(this.j_()||this.rvb())&&(this.Yn.TMc(),this.Yn.vMc());this.ln.selectComment(null,!1);if(this.ei)jc=this.twb(this.ei.commentId),
this.Yn&&this.Yn.hUe(jc,cc,!1),this.ln.selectComment(jc,!0);else if(Wa&&jc){const Ad=this.twb(jc.commentId);this.Yn&&(this.Am.isVisible||!Ad||1!==Ad.status&&2!==Ad.status)&&(this.ln.selectComment(jc,!1),this.Yn.hUe(jc,cc,!1,!0))}else this.T$c&&nb&&(this.Yfa(nb.commentId,1,!1),this.ln.selectComment(nb,!1));this.ln.wvh(this.Zcb);this.Zcb&&this.Yn.Dub(this.RVa)}this.heb=Z.length;Z=this.JZe(Z);this.A$=this.TGg.rxl(Z,this.Ro);this.nfb=this.TGg.qxl(Z);Wa?(this.A1a(!0),this.$_.Goh(Array.clone(this.A$),this.heb,
Array.clone(this.nfb)),this.T$c&&nb&&this.$_.selectComment(nb.commentId)):(Wa=[],this.rvb()&&(Wa=this.I2f(!1),Wa=[Object.assign(new ij,{draftId:this.ei.rC.draftId,insertIndex:0>ib?0:Wa})]),0>ib?this.$_.wUe(this.A$.length,this.heb,this.Ro,this.Mqe.k1c,Wa):this.$_.F7k(this.A$.length,this.heb,ib,this.Ro,Wa),this.$_.AUe(Array.clone(this.A$),Array.clone(this.nfb)));if(this.Dfc){if(ib=this.twb(this.Dfc))this.selectComment(ib,null,!0,!0,0,1,!1),this.Dfc=null}else Da&&this.pa.QE(Da);Z=this.QNf(Z);this.n4&&
Z&&this.n4.count>Z.length&&this.zLi(Z);this.gjh(Z);this.Lqe&&this.rFl();this.T$c=!1}else this.$_.wUe(0,0,this.Ro,1),this.$_.AUe([],[]),this.heb=0,this.ln&&(this.ln.isRightToLeft=this.Iva,this.ln.Ikd(null)),this.nfb=this.A$=null,this.xEh(!1,!1),this.m2b()}Gsa(){this.x0b&&this.BOc();this.hasFocus?this.ei&&this.M$c.Nlg&&!this.nUf()&&this.Ea.iD(ce.a.Az):this.Ea.iD(this.Am.isVisible?ce.a.Hp:ce.a.qW)}OSk(){this.c$c=null;this.aHe()}$Gb(){this.Gsa();this.pa.ay();return!1}lEf(Z){if(this.ei){if(!this.ei.rC)throw Gb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",Z),E.a.Ys(-2130915320);this.endCommentSession(this.ei.rC.draftId,Z)}else Gb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",Z),this.endCommentSession("",Z)}IQi(){this.PEb=this.Ea.Ae.name===(this.Am.isVisible?ce.a.Hp:ce.a.qW);this.M$c.nvf(!0)}JOf(){this.M$c.nvf(!1);this.PEb&&(this.Ea.iD(this.Am.isVisible?ce.a.Hp:ce.a.qW),this.PEb=
!1)}vwk(Z,Da){if(Z&&Z.name!==ce.a.Hp&&Z.name!==ce.a.qW&&Da.name===ce.a.Az)if(this.Am.isVisible)this.oQc();else if(this.ei){Z="";switch(this.ei.IQa){case 0:Z=this.ei.rC?this.ei.rC.draftId:"";break;case 1:case 2:if(Da=this.hl.E9d(this.ei.commentId))Z=this.hl.mta(Da).commentId}this.Jr.selectContainer(Z,!0)}this.PEb=!0}uwk(){this.PEb=!1}oQc(){this.Am.isVisible&&this.Wfb.b_i()}Wjc(Z,Da,Wa){this.Zse=Z;this.Rb.updateCommandUI();(Rb.a("FixAltF12KeboardingInCommentPane")||!this.tH)&&this.Zse&&Da&&this.oQc();
Z||Wa||this.jMa(1)}D2d(Z){var Da=this.ua.presentation;if(!Da)return!1;Da=Da.slides;if(!Da)return!1;for(const Wa of Da)if(Da=Object(mb.a)(td.a,Wa))if(Da=this.hl.nta(Da.XD()),Z)for(const ib of Da){if(1===ib.status)return!0}else{if(Da&&0<Da.length)return!0}else Gb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}yKi(){this.hl.nRa();const Z=this.hl.Wy();Z&&Z.length?this.tcb.ivh():this.tcb.gvh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}Udd(Z,Da,
Wa){if(1===Wa)return 32;if(null!==this.toh){Da=this.toh;switch(Z){case Nd.a.CEe:Da.pos.Y+=20;break;case Nd.a.DEe:Da.pos.X-=20;break;case Nd.a.EEe:Da.pos.X+=20;break;case Nd.a.FEe:Da.pos.Y-=20}this.ln.sEl(Da);this.Aak.rGk(Da)}return 32}i2b(Z,Da,Wa){return!this.gRf||this.Ro||this.ei&&this.ei.rC?8:1===Wa?this.P7i(Z):this.wKi(Z)}P7i(Z){switch(Z){case Nd.a.nRa:return this.hl.Wy()&&this.hl.Wy().length?32:8;case Nd.a.vub:return this.D2d(!1)?32:8;case Nd.a.wub:return 1!==this.xdc.eja&&this.D2d(!0)?32:8;default:return Gb.a.J(512496712,
805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",Z),2}}wKi(Z){switch(Z){case Nd.a.nRa:this.yKi();break;case Nd.a.vub:this.tcb.hvh(this.hl,!1);break;case Nd.a.wub:this.tcb.hvh(this.hl,!0);break;default:return Gb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",Z),2}return 32}j6(Z,Da,Wa,ib,nb){if(1===Wa)return!this.ua.Ba||this.isDisabled?8:32;Da=!this.Am.isVisible;Wa=this.qR.Ci("UserAction",String.format("ShowHideComments: {0}",
Da?"ShowPane":"HidePane"));Gb.a.J(36983504,805,50,"New Comment Pane opened.");Z===Nd.a.NMb?(this.hAl(!this.Xcb),this.YPe()):Z===Nd.a.nrc?(this.Zcb=!this.Zcb,this.Yn.Xpd=this.Zcb,this.YPe()):this.Vnc(Da,!!nb&&nb.AutoShowHide);Wa&&Wa.stop();return 32}wRi(){this.Am.isVisible&&this.Yfa(this.ei.rC.draftId,1,!1)}mOb(){var Z=this.Ea.Ae.name;if(this.ei&&this.ei.rC)return Z===ce.a.sg?(this.Gsa(),Rb.a("FixAltF12KeboardingInCommentPane")||Rb.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.wRi()):this.Ea.tf(ce.a.sg),
32;if(this.Yn.Nwh||this.Yn.xW){if(Z===ce.a.sg||Z===ce.a.MR){var Da=this.Yn.xW;this.Am.isVisible||(Z=0,Da&&(Z=Da.get_shapeId()),this.ioh(Z,!1));this.Gsa();return 32}if(pd.a.contains(this.uBf,Z)){if((Da=this.hLb)&&Jc.EN(Da)){if(Z=Jc.K6b(Da,this.Yn.xW),Z.isValid){const Wa=[];for(let nb=0;nb<Z.paragraphs.length;nb++){const jc=Z.paragraphs[nb];jc&&Wa.push($e.SelectionFactory.f3(jc,Z.ZU.equals(jc)?Z.startPos:0,Z.o3.equals(jc)?Z.endPos:Kb.ParagraphReader.textLength(jc)))}const ib=new Qd.SelectionCollection(Wa,
0);Da.textAnchoringInfo.AnchoringShape&&Da.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Ea.tf(ce.a.MR),this.SAg.execute(nb=>{(nb=Object(mb.a)(299,nb.Pd))&&this.SAg.instance.Yrh(Object(mb.a)(fe.a,nb),ib)})):(this.Ea.tf(ce.a.sg),this.pa.QE(ib))}}else this.Ea.tf(ce.a.sg);return 32}}else{if(pd.a.contains(this.uBf,Z))this.Ea.tf(ce.a.sg);else{Z=null;Z=this.Kc&&this.Kc.Ic?this.hl.v9a(this.Kc.Ic.Fd):this.JZe(this.hl.Wy());if(!pd.a.Wa(Z))for(Da of Z)if(this.Am.isVisible||0===Da.status){this.Yfa(Da.commentId,
1,!1);break}this.Gsa()}return 32}return 8}svf(Z,Da){Z&&!Da?this.tH?this.BOc():(this.Ea.Cj(ce.a.Hp,!0),this.Gsa(),this.oQc()):Da?Z&&this.Ea.X8(ce.a.Hp,ce.a.gj,this.Am,!1):0<this.q6d()||this.ei&&this.ei.rC?this.Ea.Cj(ce.a.qW,!0):this.Ea.Cj(ce.a.Hp,!1);Da||this.Gph()}Iqk(){this.Q9c||(this.Ik.baa(this.Ik.kUd,this.Ik.$Vd),this.Ik.Z$(this.Ik.kUd,this.Ik.$Vd),this.Q9c=!0,this.mE.Jqk(this.ua.ak));this.vX&&this.vX.PVi()}Gph(){const Z=this.hl.Wy();Z&&0<Z.length&&(this.Jxg=!0)}j_(){var Z=this.hl.Wy();if(!Z||
!Z.length)return!1;Z=Mg.e(Z,Da=>0===Da.status);return!!Z&&0<Z.length}cKa(Z,Da,Wa,ib,nb){Z===Nd.a.cKa?nb[Of.a.On]=this.Am.isVisible:Z===Nd.a.zJb||Z===Eb.a.JOe?nb[bi.a.On]=this.Am.isVisible:Z===Nd.a.Mjd?nb[bi.a.On]=this.Xcb:Z===Nd.a.bOe&&(nb[bi.a.On]=this.Zcb);return!this.ua.Ba||this.isDisabled?16:32}Oub(Z,Da,Wa,ib,nb){return 2!==Wa?32:(Z=this.dUf(nb))&&this.findComment(Z)?32:8}s0b(Z,Da,Wa,ib,nb){return 2!==Wa?32:(Z=this.dUf(nb))&&this.snk(Z)?32:8}dUf(Z){if(!Z)return null;Z=Z.NavigationId;if(!Z)return null;
try{return JSON.parse(Z)}catch(Da){return Gb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",Da),null}}snk(Z){if(Z.sId!==this.Kc.Ic.Fd.sid){var Da=Yg.a.UE(Z.sId,Z.cId);Da=this.k$d(Da);if(!Da)return!1;this.Ha.Jn?this.bYa.GJ(Da.le):this.Ge.GJ(Da.le)}Da=this.findComment(Z);if(!Da)return!1;1!==Da.status&&2!==Da.status||this.oqd();this.Yfa(Z.commentId,1,!1);return!0}findComment(Z){var Da=this.ua.presentation;if(!Da)return null;Da=Da.slides;if(!Da)return null;for(const Wa of Da)if((Da=
Object(mb.a)(td.a,Wa))&&Da.sid===Z.sId){Da=this.hl.nta(Da.XD());for(const ib of Da){if(ib.commentId===Z.commentId)return ib;if(ib.Children&&ib.Children.length)for(const nb of ib.Children)if(nb.commentId===Z.commentId)return nb}}return null}isCollapsed(){return!1}get toh(){return null}clearSelection(){}XSk(){this.Rb.updateCommandUI()}get B$a(){return!!this.ei}Tsi(){this.ei&&this.lEf(8)}D5(Z){2===Z.behavior&&Z.actionId===Nd.a.FZa&&(Z=this.Mv.dSc(!0),Z!==Nd.a.qhd&&Z!==Nd.a.jQ&&Z!==Nd.a.nRa&&Z!==Nd.a.vub&&
Z!==Nd.a.wub||ld.UISurfaces.mL().then(Da=>{this.tcb.rWk(Da)}))}C5(){}static aYg(Z,Da){return Z.contentId===Da}static H1j(Z){let Da="";if(Z){for(const Wa of Z)if(Da+=Wa.commentId+";",Wa.Children)for(const ib of Wa.Children)Da+=ib.commentId+";";Gb.a.J(512496659,805,15,"LogCommentIds() - {0}",Da)}}}Object(h.a)(kh,"SharedCommentFrame",null,[1064,106,1065,141]);class mi{constructor(Z,Da,Wa,ib,nb,jc,cc=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=
null;this.commentId=Z;this.parentId=Da;this.commentBody=Wa;this.author=ib;this.date=nb;this.commentFlags=jc;this.usersByReactionType=cc}}Object(h.a)(mi,"OfficeSharedCommentModel",null,[]);class sh{constructor(Z,Da){this.CommentId=Z;this.ResolveState=Da}}Object(h.a)(sh,"CommentProperties",null,[]);class Ng{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(h.a)(Ng,"AtMentionAttributes",null,[]);class Wh{constructor(){this.contentId=""}}Object(h.a)(Wh,"AtMentionOptionalAttributes",
null,[]);class Gg{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(Gg,"DeltaAttributes",null,[]);var eg;(function(Z){Z[Z.Undo=-1]="Undo";Z[Z.Unknown=0]="Unknown";Z[Z.Create=1]="Create";Z[Z.Assign=2]="Assign";Z[Z.Unassign=3]="Unassign";Z[Z.UnassignAll=4]="UnassignAll";Z[Z.Schedule=5]="Schedule";Z[Z.Progress=6]="Progress";Z[Z.Delete=7]="Delete";Z[Z.Restore=
8]="Restore";Z[Z.SetTitle=9]="SetTitle";Z[Z.Priority=10]="Priority"})(eg||(eg={}));Object(h.b)("HistoryRecordType",eg);class Tj{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(h.a)(Tj,"CommentAtMention",null,[]);var aj=d(898);class pj{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(pj,"UserInfo",null,[]);class Ji{constructor(Z,Da){this.plainText=Z;this.v_g=Da}}Object(h.a)(Ji,"TextTranslationResult",null,[]);var yg=d(69);
class Aa{constructor(Z,Da,Wa){this.y2k="[";this.ngi=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.g_j=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.ogi=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.grg=!1;this.PHi=ib=>{if(!ib)return null;let nb={};for(const jc of ib){a:{switch(jc.Type){case "\ud83d\udc4d":ib=1;break a;default:Gb.a.J(509220245,805,50,"Unsupported reaction type")}ib=void 0}void 0!==ib&&(nb[ib.toString()]=this.xKk(jc.ReactionInstances))}return nb};
this.xKk=ib=>{let nb=[];for(const jc of ib)ib=jc.User,nb.push({DateUtc:jc.Time,DisplayName:ib.DisplayName,Email:ib.Email,Provider:ib.ProviderId,UserId:ib.UserId,IsCurrentUser:this.isCurrentUser(jc.User.UserId,jc.User.ProviderId)});return nb};this.Pb=Z;this.jBe=Da;this.yxe=Wa}get userId(){return this.Pb.appSettings["387"]}get providerId(){return this.Pb.appSettings["388"]}pjj(Z,Da){let Wa=0;if(1===Z.status||2===Z.status)Wa|=8;Da&&(Wa|=1);this.xil(Z)&&(Wa|=16);this.Pb.ka("PPTOBlueDotsForComments")&&
Z.isUnread&&(Wa|=32);return Wa}isCurrentUser(Z,Da){return Z?"Author"===Z||this.userId===Z&&Da===Da?!0:!1:!1}PKj(Z){return this.isCurrentUser(Z.userId,Z.providerId)}xil(Z){return""===Z.userId||"Author"===Z.userId||!this.wIl(Z.userId)||this.userId===Z.userId&&this.providerId===Z.providerId?!1:!0}wIl(Z){return 3===Z.split("::").length}KCh(Z,Da,Wa){var ib;if(null===Z)throw Error.argumentNull("comment");const nb=this.txl(Z.text);var jc=Z.authorName,cc=Rb.a("PPTPlumbEmailThroughCG")?Fa.a.E8a(Z.userId||
""):"";const Ad=Z.dt;Wa=this.pjj(Z,Wa);jc=new qb(Z.userId,Z.providerId,jc,cc,this.PKj(Z));return dd(this.Pb)&&(null===Z||void 0===Z?0:Z.reactions)?(cc=this.PHi(null===(ib=Z.reactions)||void 0===ib?void 0:ib.ReactionList),new mi(Z.commentId,Da,nb,jc,Ad,Wa,cc)):new mi(Z.commentId,Da,nb,jc,Ad,Wa)}rxl(Z,Da){if(null===Z)throw Error.argumentNull("comments");const Wa=new m.a;for(const ib of Z)if(Wa.add(this.KCh(ib,"",Da)),ib.Children&&0<ib.Children.length)for(const nb of ib.Children)Wa.add(this.KCh(nb,ib.commentId,
Da));return Wa.toArray()}xxl(Z,Da,Wa,ib){const nb=Object.assign(new aj.a,{Asignees:[]});Z=this.jBe.x1i(Z,Da,!Da.taskId,Wa);for(const jc of Z)2===jc.type?jc.assignee?(Z=Object.assign(new pj,{DisplayName:jc.assignee.DisplayName,FullName:jc.assignee.DisplayName,UserId:jc.assignee.UserId,ProviderId:jc.assignee.Provider,Email:jc.assignee.Email}),nb.Asignees.push(Z)):Gb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===jc.type&&(nb.Title=
jc.title);if(!nb.Asignees)return Gb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;nb.Title||(Gb.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),nb.Title=ib);return nb}vxl(Z,Da){const Wa=new aj.a;if(Z.assignee){const ib=new pj,nb=Z.assignee;ib.DisplayName=nb.Name;ib.FullName=nb.Name;ib.UserId=nb.UserPrincipalName;ib.ProviderId="O365";ib.Email=nb.UserPrincipalName;Wa.Asignees=[ib]}Wa.Title=
Z.title?Z.title:Da;return Wa}wxl(Z,Da,Wa){if(!Da)return null;try{const ib=this.ttd(Wa,new Date).plainText,nb=this.yxe?this.xxl(Z,Da,Wa,ib):this.vxl(Da,ib);if(!nb)return null;nb.CompletionPercentage=Da.completion?Da.completion:0;return nb}catch(ib){Gb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",ib)}return null}qxl(Z){if(null===Z)throw Error.argumentNull("comments");const Da=new m.a;for(const Wa of Z)Wa.taskInfo&&Wa.taskInfo.Asignees&&0<Wa.taskInfo.Asignees.length&&
(Z=this.pxl(Wa))&&Da.add(Z);return Da.toArray()}pxl(Z){if(this.yxe&&this.jBe&&0<Z.taskInfo.TaskHistoryRecords.length)try{const Da=Aa.qAi(Z.taskInfo.TaskHistoryRecords),Wa=new yg.a;Wa.add(Z.commentId,new sh(Z.commentId,100===Z.taskInfo.CompletionPercentage));const ib=this.jBe.AHi(Z.commentId,Z.commentId,Da,Wa);Aa.Uqi(Z,ib,this.yxe);return ib}catch(Da){return Gb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",Da.message),this.JCh(Z)}else return this.JCh(Z)}JCh(Z){var Da=
new ca;Da.startDate=Z.taskInfo.StartDate;Da.endDate=Z.taskInfo.DueDate;const Wa=new sa(Z.taskInfo.Asignees[0].UserId);Wa.DisplayName=Z.taskInfo.Asignees[0].DisplayName;Wa.Provider=Z.taskInfo.Asignees[0].ProviderId;Wa.Email=Z.taskInfo.Asignees[0].Email;const ib=Array(1);ib[0]=Wa;Da=new fa(!1,Z.taskInfo.Title,ib,Da,Z.taskInfo.CompletionPercentage,0);return new F(Z.commentId,Z.commentId,Da,[])}txl(Z){if(null===Z)throw Error.argumentNull("nativeText");const Da=new ta;Z=Z.split(this.ogi);for(const ib of Z){var Wa=
this.ngi.exec(ib);Wa&&3===Wa.length?(Z=new Ng,Wa[0].substring(0,1)===this.y2k?(Z.fullName=Wa[2],Z.resolveState=1):(Z.fullName=Wa[1],Z.resolveState=0),Z.email="UnknownEmail",Wa=new Wh,Wa.contentId="Pre-existing Mention",Da.dGj("@"+Z.fullName,Z,Wa),this.grg||(this.grg=!0,Gb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(Z=this.g_j.exec(ib))&&1===Z.length?(Z=Z[0],Da.insertHyperLink(Z,Object.assign(new Gg,{link:Z}))):Da.FGj(ib)}return Da.T7i()}ttd(Z,Da){var Wa=Sys.Serialization.JavaScriptSerializer.deserialize(Z);
Z=[];Da||(Da=new Date);const ib=new Sys.StringBuilder;for(const nb of Wa.ops)if(nb.attributes){if(nb.attributes.atmention){const jc=1<nb.insert.length?nb.insert.substring(1,nb.insert.length):"";if(nb.optional&&nb.optional.atmention&&nb.optional.atmention.contentId)Wa=Aa.T2f(jc,1===nb.attributes.atmention.resolveState);else{Wa=Aa.T2f(jc,1===nb.attributes.atmention.resolveState);const cc=Aa.zdj(Da,1===nb.attributes.atmention.resolveState);Array.add(Z,Object.assign(new Tj,{FullName:nb.attributes.atmention.fullName,
DispName:jc,Id:cc,Email:nb.attributes.atmention.email}));Da=new Date(Da.getTime()+1)}}else nb.attributes.link||Gb.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Wa=nb.insert;ib.append(Wa)}else ib.append(nb.insert);return new Ji(ib.toString(),Z)}static PAi(Z){switch(Z){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static MAi(Z){var Da=
null;Z.User&&(Da=new sa(Z.User.UserId,Z.User.ProviderId,Z.User.DisplayName));Da=new aa(Aa.PAi(Z.HistoryRecordType),Da,Z.DtTime,Z.RecordId);Da.commentId=Z.CommentId;Z.Assignee&&(Da.assignee=new sa(Z.Assignee.UserId,Z.Assignee.ProviderId,Z.Assignee.DisplayName));Z.StartDate&&Z.DueDate?(Da.schedule=new ca,Da.schedule.startDate=Z.StartDate?Z.StartDate:null,Da.schedule.endDate=Z.DueDate?Z.DueDate:null):Z.StartDate&&!Z.DueDate?Gb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):
!Z.StartDate&&Z.DueDate&&Gb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Wa=Z.Priority;0<Wa?Da.priority=Wa:Gb.a.J(512496649,845,10,"Priority is negative");Wa=Z.CompletionPercentage;0<=Wa?Da.completion=Wa:Gb.a.J(512496648,845,10,"Percent complete is negative");Da.title=Z.Title;Da.undoId=Z.UndoId;return Da}static qAi(Z){const Da=Z.length,Wa=Array(Da);for(let ib=0;ib<Da;++ib)Wa[ib]=Aa.MAi(Z[ib]);return Wa}static Uqi(Z,Da,Wa){const ib=
Da.currentState,nb=Z.taskInfo;let jc=!1;const cc=Rb.a("SetTaskFromTaskStateInsteadOfHistory");nb.StartDate.toString()!==ib.schedule.startDate.toString()&&(cc&&(ib.schedule.startDate=nb.StartDate),jc=!0,Gb.a.J(512496647,845,10,"Start Date does not match."));nb.DueDate.toString()!==ib.schedule.endDate.toString()&&(cc&&(ib.schedule.endDate=nb.DueDate),jc=!0,Gb.a.J(512496646,845,10,"End Date does not match."));nb.CompletionPercentage!==ib.completion&&(cc&&(ib.completion=nb.CompletionPercentage),jc=!0,
Gb.a.J(512496645,845,10,"Completion percentage does not match."));nb.Title!==ib.title&&(cc&&(ib.title=nb.Title),jc=!0,Gb.a.J(512496644,845,10,"Title does not match."));nb.Asignees[0].UserId!==ib.assignees[0].UserId&&(cc&&(ib.assignees[0].UserId=nb.Asignees[0].UserId),jc=!0,Gb.a.J(512496643,845,10,"Assigned to user id does not match."));nb.Asignees[0].DisplayName!==ib.assignees[0].DisplayName&&(cc&&(ib.assignees[0].DisplayName=nb.Asignees[0].DisplayName),jc=!0,Gb.a.J(512496642,845,10,"Assigned to display name does not match."));
nb.Asignees[0].ProviderId!==ib.assignees[0].Provider&&(cc&&(ib.assignees[0].Provider=nb.Asignees[0].ProviderId),jc=!0,Gb.a.J(512496641,845,10,"Assigned to provider id does not match."));nb.Asignees[0].Email!==ib.assignees[0].Email&&(cc&&(ib.assignees[0].Email=nb.Asignees[0].Email),Wa||(jc=!0,Gb.a.J(512496640,845,10,"Assigned to email does not match.")));if(jc&&Wa&&(Aa.f4j(Z,Da),Rb.a("IsThrowForTaskStateMismatchEnabled")))throw Gb.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),
Error.create("TaskStateMismatch");}static f4j(Z,Da){const Wa=new m.a;for(const ib of Da.history)for(const nb of ib.records)Wa.add(eg[nb.type]);if(Wa.count!==Z.taskInfo.TaskHistoryRecords.length){Da=new m.a;for(const ib of Z.taskInfo.TaskHistoryRecords)Da.add(eg[ib.HistoryRecordType]);Gb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static zdj(Z,Da){Z=Z._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return Da?Z+"_Z":Z}static T2f(Z,Da){return Da?"[@"+Z+"]":
"<@"+Z+">"}}Object(h.a)(Aa,"SharedCommentModelTranslator",null,[1062]);class Ma{constructor(Z,Da,Wa){this.TWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.Off=!1;this.Ea=Z;this.Og=Da;this.GBb=Wa}nvf(Z){Z?(this.TWa&&this.GBb&&this.GBb.isVisible||this.Og.pI(ce.a.Az),this.Og.Ko(ce.a.Hp),this.Ea.iD(ce.a.Az)):(this.Og.Ko(ce.a.Az),this.GBb.isVisible&&!this.TWa&&this.Og.pI(ce.a.Hp));
this.Off=Z}get Nlg(){return this.Off}}Object(h.a)(Ma,"SharedCommentsRTEFocusActionHelper",null,[1040]);class cb{constructor(Z,Da,Wa,ib){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=Z;this.body=Da;this.confirmButton=Wa;this.cancelButton=ib}}Object(h.a)(cb,"ViewContainerModalDialogStrings",null,[]);class Fb{constructor(Z,Da,Wa){this.containerType="full-pane";this.identifier=null;this.kb=Z;this.Ea=Da;this.identifier=Wa}closeView(){this.kb.Vnc(!1,!1)}openView(){this.kb.Vnc(!0,
!1)}invokeModalConfirmationDialog(Z,Da,Wa){const ib=new Lb.StandardDialog;Wa&&Wa.title&&Wa.body&&Wa.confirmButton&&Wa.cancelButton||(Gb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),Wa=new cb("","","",""));ib.xd=1;ib.Xe(1,Wa.confirmButton);ib.Xe(0,Wa.cancelButton);ib.Y7a=this.Ea.Ae.name;ib.yjc=!0;ib.Gx(Wa.title,Wa.body,1,nb=>{1===nb?(Z(),ib.Y7a=null):Da()})}}Object(h.a)(Fb,"ViewContainerAPI",null,[1060,1061]);class dc extends Sys.EventArgs{constructor(){super()}}
Object(h.a)(dc,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var zc=d(280);class Vc{constructor(){this.nGg=this.$Ug=this.Wfb=this.LWg=this.Yva=this.A3c=this.aIa=this.C3c=this.XQ=this.K=null;this.Vcb=this.tva=this.iCb=!1;this.qR=this.Tqe=null;this.eIg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.kO=null;this.TWa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.tH=!1}Zb(Z){this.K=Z;this.tH=this.K.resolve("PowerPointWebEditor.IApplicationSettings").dWd;
this.qR=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.Wfb=new J(e.AFrameworkApplication.ye,"CommentPane");Z.register(mc,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().oa(()=>new mc);const Da=this.K.resolve("PowerPointWebEditor.IFileInfo").eja,Wa=2===Da||3===Da;this.iCb=Wa;this.Vcb=1===Da;Z.register(Rc,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().oa(()=>new Rc(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),Da));Z.register(Od,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().oa(()=>new Od(this.qR,Da,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ja("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));
const ib=this.iCb||!this.Vcb;this.kO=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");ib&&Z.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().oa(()=>new zc.a((Xd,xe)=>{let Ff=null;const xg=Object(mb.a)(117,Xd.sc(Z.resolve("Box4.IPageView").Ma));xg&&!xg.Al&&(Xd=Z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").uYd(Z.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Xd,xe,xg.SU),
Ff=new Pd(Xd),Ff.Jm(xg.SU),xg.rra(Ff,5),Ff.visible=xg.BQ||xg.Un);return Ff}));this.K.register(1037,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().oa(()=>new Af(this.kO,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),Z.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(1038,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().oa(()=>new Wd(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ld,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.kO));const nb=this.iCb||!this.Vcb;this.K.register(1039,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().oa(()=>new Lh(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new Qc(nb),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),nb,nb));this.K.register(nc,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().oa(()=>
new nc(!this.Vcb,this.K.resolve("Common.Utils.IHighContrastDetector")));const jc=new lg(ib,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),ib?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.kO,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),
this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));Z.register(1040,"PowerPointWebEditor.IRTEFocusActionHelper").ma().oa(()=>new Ma(Z.resolve("Common.IFocusManager"),Z.resolve("Common.IF6Manager"),Z.resolve("PowerPointWebEditor.ICommentsPane")));this.K.register(D,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().oa(()=>new D(this.K.resolve("Common.ITaskManager")));
const cc=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");cc&&this.K.register(1041,"Common.Comments.ICommentTaskTranslator").ma().oa(()=>(new Pa(!0,cc,!0)).xCi());this.K.register(Aa,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().oa(()=>new Aa(this.K.resolve("Common.IAppSettingsManager"),cc?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,cc));this.K.register(Oa,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().oa(()=>
new Oa);this.tva=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(Wa||!this.Vcb);this.K.register(kh,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().oa(()=>new kh(this.kO,this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").xa,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Wfb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ld,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.qR,jc,this.K.resolve("Common.IAppSettingsManager"),this.K.Ja("Box4.IInteractiveViewManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),ib,Z.resolve("PowerPointWebEditor.IErrorHandler"),Z.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.tva,Z.resolve("Box4.Graph.IGraphInstance").yd(10),Z.resolve("PowerPointWebEditor.View.IViewEventSource"),Z.resolve("PowerPointWebEditor.ICommentCloudPolicy"),nb,Z.resolve("PowerPointWebEditor.IShapeReader"),Z.Ja("Common.App.SafeLinks.ISafeLinksManager"),Z.resolve("Box4.ICharacterPropertiesEditor"),Z.resolve("PowerPointWebEditor.IFileInfo"),
this.tH,Z.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").QIa?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):null,this.K.Ja("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ja("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jn?
this.K.resolve("PowerPointWebEditor.ISorterViewActorLazy"):null));this.K.register(Ob,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().oa(()=>new Ob(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").o5j));this.K.register(Fb,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().oa(()=>new Fb(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.eIg));const Ad=new Id(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new ng(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.kO,this.K.resolve("Common.IAppSettingsManager").ka("459"),this.K.ie("PowerPointWeb.Comments.ICommentFrame"));this.K.register(1042,"PowerPointWebEditor.IFindCommentLogic").ma().oa(()=>new gf(Ad,this.K.resolve("Common.ITaskManager")));this.K.register(id,"PowerPointWebEditor.CommentsChangeListener").ma().oa(()=>
new id(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(1043,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().oa(()=>new Ua(this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.kO,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));this.K.register(Ef,"PowerPointWebEditor.CommentPropertyTracker").ma().oa(()=>new Ef(Object(oa.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").aHe,
"onCommentPropertiesUpdated"),Ub.App.lP.fV,tb.GraphTransactionManager.instance));this.K.register(1044,"PowerPointWebEditor.ICommentsPane").ma().oa(()=>new Ne(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Dua,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.tH));this.K.register(yd,"PowerPointWebEditor.CommentSmartReplyProvider").ma().oa(()=>new yd(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){eb.a.instance.ic($b.a.cWd,(new Date).getTime());const Z=this.qR.Ci("UserAction","InitCommentsPackage"),Da={};this.tH||(this.aIa=this.K.resolve("PowerPointWebEditor.ICommentsPane").xa);this.XQ=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");this.XQ.initialize();var Wa=Z.Vq;Da.CommentFrameInitMS=Wa;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.C3c=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");
this.C3c.Azj();const ib=Z.Vq;Da.CommentPropertyTrackerInitMS=ib-Wa;this.Tqe=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.LWg=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var nb=Jb.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Wa=nb.Ring||"Unknown";nb=nb.WACDatacenter||"Unknown";const jc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").hJj;var cc=e.AFrameworkApplication.fa.Ga("LokiComplianceEnvironment");cc=cc&&""!==cc?cc:
e.AFrameworkApplication.fa.Ga("SovereignEnvironmentName");this.$Ug=new ab("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,Wa,nb,!jc,this.K.resolve("Common.IActionManagerExtended"),null,cc);Wa=Ib.a.xe(e.AFrameworkApplication.lcid);this.nGg=new gc(e.AFrameworkApplication.isRtl,Wa?Wa.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.tH||(this.aIa.id=this.eIg);this.D8b();e.AFrameworkApplication.fa.gf(Object(oa.a)(this,
this.Pm,"onFullAppSettingsReady"));(Wa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Wa.wNk(new dc);Wa=Z.Vq;Da.CommentReactPaneInitMS=Wa-ib;this.NCj();Da.CommentPaneInitMS=Z.Vq-Wa;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();Z.stop();Gb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
Da,this.K.resolve("Common.IAppSettingsManager").ka("896"))}NCj(){const Z=this.K.resolve("PowerPointWebEditor.ICommentsPane"),Da=this.K.resolve("PowerPointWebEditor.IPaneManager");this.tH||(!this.TWa||this.TWa&&!document.getElementsByClassName("CommentPanel").length)&&Da.RP(Z);Da.PAb(2);this.K.resolve("PowerPointWebEditor.IFocusManager").X8(ce.a.Hp,ce.a.gj,Z,!Z.isVisible)}D8b(){eb.a.instance.ic($b.a.D8b,(new Date).getTime());const Z=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").Ytb().then(Da=>
{eb.a.instance.ic($b.a.Vde,(new Date).getTime());Ta.a.$u(Z.K.Ja("Common.App.People.IExternalPeopleAPI")).continueWith(Wa=>{Z.Yva=Wa.result;Z.Yva||Gb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");Z.K.resolve("PowerPointWebEditor.IApplicationSettings").vg&&(Wa=Z.K.resolve("Common.IAppSettingsManager").Ga("368"),Z.Yva.f8g(Wa+"p"));Wa=[Ab.a.contextMenu];Z.tH||kc.a.Okd(Z.aIa,Wa);const ib=Da&&(Z.iCb||!Z.Vcb),nb=Z.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");
Z.K.register(bf,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().oa(()=>new bf(Z.K.resolve("Common.IAppSettingsManager"),Z.K.resolve("PowerPointWebEditor.IApplicationSettings"),Z.Yva,Z.Vcb,ib,Z.tva));Z.K.register(Cd,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().oa(()=>new Cd(Z.K.resolve("PowerPointWeb.Comments.ICommentFrame"),Z.kO,Z.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
Z.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),Z.K.resolve("Common.ITaskManager"),Z.K.resolve("Common.IAppSettingsManager"),Z.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),Z.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),Z.Yva,Z.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Z.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),ib,Z.tva,nb,Z.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Z.K.resolve("Common.IActionManagerExtended"),
Z.K.resolve("PowerPointWebEditor.IApplicationSettings")));Z.A3c=Z.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{Z.A3c&&Z.A3c.checkAtMentionCapability().then(Wa=>{Wa&&((Wa=Z.K.Ja("Common.ISystemInitiatedFeedback"))?Wa.execute(ib=>{ib.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Gb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});Z.LCj()})})}LCj(){eb.a.instance.ic($b.a.gXe,
(new Date).getTime());const Z=this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw,Da=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Wa=this.K.resolve("Common.Comments.ICommentActivationManager");eb.a.instance.ic("CommentActivationManagerInitStart",(new Date).getTime());Wa.initialize(Z,this.A3c,this.$Ug,this.Yva,new fb(this.LWg,this.Wfb),this.nGg,null,Da.qjj());eb.a.instance.ic($b.a.V8b,(new Date).getTime());Wa.V8b().then(()=>{eb.a.instance.ic($b.a.Wde,(new Date).getTime());
this.XQ.nFj();eb.a.instance.ic($b.a.Tne,(new Date).getTime());Hc.a(this.K)("floatingContainerManager").then(()=>{eb.a.instance.ic($b.a.W3d,(new Date).getTime());this.XQ.WCj();eb.a.instance.ic($b.a.X3d,(new Date).getTime());if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").sfi){const ib=this.kO.Wy();ib&&0<ib.length?(this.XQ.T6k(),eb.a.instance.ic($b.a.Ppd,(new Date).getTime()),Bc.App.pLb(null,$b.a.Ppd)):Gb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(ib=>
{Gb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+ib.toString())})})}Pm(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.C3c&&this.C3c.KAl();this.XQ&&this.XQ.dispose();this.Tqe&&this.Tqe.dispose();this.Yva=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){eb.a.instance.ic($b.a.YVd,(new Date).getTime());Qb.a.instance.Dc(new Vc)}}Object(h.a)(Vc,"CommentsPackage",null,[2,3]);var rd=d(12);Type.registerNamespace("Common.App.SharedComments");
Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Object(rd.c)("Comment");Vc.main();Object(rd.b)("Comment")},280:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(1019);class e{constructor(n){this.kl=new h.a;this.sYa=n}ZG(n){const m=n.id;let z=null;this.kl.Hb(m)?z=this.kl.ga(m):(this.sYa&&(z=this.sYa(n,
()=>{this.loc(m)})),z&&this.kl.$(m,z));return z}IF(n){n=n.id;return this.kl.Hb(n)?this.kl.ga(n):null}loc(n){this.kl.remove(n)}}Object(I.a)(e,"ShapeComponentViewManager",null,[397])},685:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(18),e=d(97),n=d(29),m=d(50);d(98);class z{constructor(){this.u_=null}get dyb(){return!1}XCh(B,v){let y=new h.a;const A=new m.GraphTransaction(3);try{A.kd(n.App.Kb.Kd.Dn.xg),this.wac(v)&&(y=this.$8b(v,y)),v!==B&&this.wac(B)&&(y=this.$8b(B,y))}finally{A&&
A.dispose()}return y.toArray()}wac(B){return!!B}Zkd(B){let v=!1;for(const y of this.Hce)v||!Sys.UI.DomElement.containsCssClass(B,y.className)&&!Sys.UI.DomElement.containsCssClass(B,y.h7b)||(v=!0),e.a.pKa(B,y.className),e.a.pKa(B,y.h7b)}}Object(I.a)(z,"AHighlightActor",null,[985])},686:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.className=e;this.h7b=n}}Object(I.a)(h,"HighlightCssClassPair",null,[])},687:function(I,Y,d){d.d(Y,"b",function(){return m});d.d(Y,
"a",function(){return z});var h=d(97);d(29);var e=d(50);d(33);d(94);var n=d(98);const m=B=>{const v=new e.GraphTransaction(3);try{v.kd(B),B.Bv(32,!0)}finally{v&&v.dispose()}},z=B=>{if(B){B=h.a.Yja(B);if(-1===B.indexOf(n.a.h8)&&-1!==B.indexOf(n.a.pN)&&-1===B.indexOf(n.a.M1b))return 2;if(-1===B.indexOf(n.a.h8)&&(-1!==B.indexOf(n.a.L1b)||-1!==B.indexOf(n.a.CN)||-1!==B.indexOf(n.a.M1b)||-1!==B.indexOf(n.a.tKc)||-1!==B.indexOf(n.a.gMc)||-1!==B.indexOf(n.a.eMc)||-1!==B.indexOf(n.a.dMc)||-1!==B.indexOf(n.a.WYd)||
-1!==B.indexOf(n.a.RYd)||-1!==B.indexOf(n.a.TYd)||-1!==B.indexOf(n.a.fMc)||-1!==B.indexOf(n.a.QYd)))return 1;if(-1!==B.indexOf("WACImageContainer"))return 3}return 0}},688:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.type=this.action=0;this.Ohb=this.Ada=null}}Object(I.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.comment.js.map