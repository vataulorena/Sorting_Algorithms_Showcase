window.Microsoft||(window.Microsoft = {});Microsoft.Office=Microsoft.Office||{},Microsoft.Office.PowerPoint=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}({16:function(e,t,i){"use strict";i.r(t);var n=[[/!/g,"%21"],[/'/g,"%27"],[/\(/g,"%28"],[/\)/g,"%29"],[/\*/g,"%2A"]],o=["eurppc"];function r(e){return 8===e.toLowerCase().indexOf("ffc")}function s(e){return 8===e.toLowerCase().indexOf("ppc")}function a(e,t){if(!t||-1===o.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function c(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function u(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function d(e,t,i){i&&(e[t.toLowerCase()]=i)}function f(e,t){e[t.toLowerCase()]=""}function l(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function h(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var u=c.index+1,d=o.indexOf("&",u);o=o.substring(0,u)+a+i+(-1===d?"":o.substring(d))}return o}return o.concat(s,a,i)}function p(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}function v(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}function m(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function w(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!!o&&(!i||o[1]===i)}function g(e,t){var i=l(e,t);return i?decodeURI(i):i}function S(e){return l(window.location.href,e)}function I(e){var t=encodeURIComponent(e);return n.forEach((function(e){t=t.replace(e[0],e[1])})),t}function b(e){var t=(e+"===").substring(0,e.length+(4-e.length%4)%4);return t=(t=t.replace(/-/g,"+")).replace(/_/g,"/"),atob(t)}function _(e){var t=document.createElement("a");t.href=e;var i=t.port||80,n=window.location.port||80;return t.hostname===window.location.hostname&&i===n}function C(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function T(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}function y(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return E&&(!t||t(e))},preconnect:function(t){return T(e?m(t):t)}}}var U,A,P,E=!0;function O(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(U||(U={})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=225]="msoulscat_MSOSP_OTelJS",e[e.U=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.A=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.P=301]="msoulscat_Wac_WordViewer",e[e.O=306]="msoulscat_Wac_BrowserGeneral",e[e.N=320]="msoulscat_Wac_TaskPane",e[e.R=339]="msoulscat_Wac_OneNoteGeneral",e[e.F=340]="msoulscat_Wac_Ribbon",e[e.k=379]="msoulscat_Wac_WopiPendingApplication",e[e.B=383]="msoulscat_Wac_Telemetry",e[e.H=391]="msoulscat_Wac_WacCatchUpActivities",e[e.J=394]="msoulscat_Wac_Dictation",e[e.j=395]="msoulscat_Wac_OneNoteSync",e[e.q=700]="msoulscat_Wac_VisioApp",e[e.K=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.Z=800]="msoulscat_Wac_PptAnimation",e[e.$=833]="msoulscat_Wac_PptLive",e[e.X=834]="msoulscat_Wac_PptMWeb",e[e.Y=844]="msoulscat_Wac_PptDataSync",e[e.ee=815]="msoulscat_Wac_PptShape",e[e.te=817]="msoulscat_Wac_PptSession",e[e.ie=830]="msoulscat_Wac_PptSlideshow",e[e.ne=822]="msoulscat_Wac_PptView",e[e.oe=2300]="msoulscat_Wac_VersionHistory",e[e.re=302]="msoulscat_Wac_WordPresence",e[e.se=3e3]="msoulscat_Wac_OAuth",e[e.ae=3005]="msoulscat_Wac_WordVersionHistory",e[e.ce=3006]="msoulscat_Wac_LivePersonaCard",e[e.ue=3012]="msoulscat_Wac_CatchUpFlyout",e[e.de=3016]="msoulscat_Wac_WordDesigner",e[e.fe=3021]="msoulscat_Wac_ModernFontPicker",e[e.le=3027]="msoulscat_Wac_UnifiedUiHost",e[e.he=3033]="msoulscat_Wac_EquationTools",e[e.pe=1401]="msoulscat_Osf_Latency",e[e.ve=1402]="msoulscat_Osf_Notification",e[e.me=1403]="msoulscat_Osf_Runtime",e[e.we=3041]="msoulscat_Wac_AiMaker",e[e.ge=3043]="msoulscat_Wac_AiRewrite",e[e.Se=3044]="msoulscat_Wac_AiInsert"}(A||(A={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(P||(P={}));var N={BUILD_NUMBER:"16.0.16311.40509"};function R(){try{return"16.0.16311.40509"}catch(e){return N.BUILD_NUMBER}}function F(){return 1631140509}var k;function x(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t,payloadJson:JSON.stringify(i)};O(JSON.stringify(o),e,n)}(e,"JSAPI_STATE",{application:t,build:R(),state:i})}function D(e,t,i,n){var o=[],r=e.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,n,o)})),s=function(e,t,i,n,o){var r={};r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o);return r.V=1,r}(n,r,t,i,o);return JSON.stringify(s)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(k||(k={}));var M,W=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function B(){return W?window.performance.now():Date.now()}function H(){if(!M){var e=window.performance;M=W&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return M()}var L,V,J=function(){function e(e){var t=this;this.Ie=3e4,this.be=30,this._e=0,this.Ce=[],this.Te=H(),this.ye=[],this.Ue="",this.Ae=0,this.flushOnClose=function(){t.Pe(!1,!1)},this.flush=function(){t.Ee()},this.flushAndSetNewEndpoint=function(e,i){var n,o=t.Oe(e);o.localeCompare(null!==(n=t.Ne)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t.ye.push((function(){t.Ne=o,i&&i()})),t.Pe(!0,!0))},this.Oe=function(e){return e+"?usid="+t.Ue+"&officeserverversion="+R()},this.Ee=function(){window.setTimeout((function(){return t.Pe(!0,!0)}),0)},this.Pe=function(e,i){var n=B();if(window.clearTimeout(t.Re),t.Ne){if(t.Ce.length>0)t._e+=1,O(D(t.Ce.splice(0,e?t.be:t.Ce.length),t.Ue,t._e,t.Te),t.Ne,i),t.Te=H();0===t.Ce.length&&t.ye.length>0&&(t.ye.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.ye=[]),e&&(t.Re=window.setTimeout((function(){t.Ee()}),t.Ce.length>t.be||t.ye.length>0?1e3:t.Ie)),t.Ae+=B()-n}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Ae},e.prototype.addLoggingTime=function(e){this.Ae+=e},e.prototype.configure=function(e){var t=this,i=B();if(e.uploadCadenceInMs&&(this.Ie=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.be=e.uploadTriggerSize),e.sessionId&&(this.Ue=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Ne)throw new Error("Remote ULS endpoint is already set");this.Ne=this.Oe(e.remoteUlsEndpoint),this.Te=H(),window.setTimeout((function(){return t.Pe(!0,!0)}),0)}this.Ae+=B()-i},e.prototype.handleTrace=function(e){var t=B();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Ce.push(e),(this.Ce.length>this.be||e.level===P.Error)&&this.Ee(),this.Ae+=B()-t},e}(),j=[];!function(e){e.Fe="BootstrapperMaxUlsHeartbeatTime",e.ke="BootstrapperNoCompleteWarning1Time",e.xe="BootstrapperNoCompleteWarning2Time",e.De="RemoteUlsETag",e.Me="RemoteUlsSuppressions",e.We="BootstrapperSettingsFetchPeriod",e.Be="timestamp",e.He="BootstrapperUlsHeartbeatIntervalMs",e.Le="BootstrapperUlsHeartBeatIsEnabled",e.Ve="BootstrapperUlsUploadCadenceMs",e.Je="WordConsumptionViewToEditRedirectIsEnabled",e.je="RequestedCallThrottlingDefaultToViewMinimumValue",e.Ge="BulsEndpointUrl",e.ze="EnableCommonHostDiagnosticsParams"}(V||(V={}));var G;function z(e){var t=new J(e);function i(e,i,n,o){var r=B();if(!function(e){return 1===j[e]}(e)){var s={timestamp:H(),category:i,tag:e,level:n,type:k.Trace,message:o,correlationId:""};t.addLoggingTime(B()-r),t.handleTrace(s)}}return{ULS:{qe:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,o){n&&i(e,t,P.Error,o)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.Ke.getValue(V.Me,""),n=e.Ke.getValue(V.De,""),L&&n===L||(j=[],L=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(j[t]=1)}))),t.configure({uploadCadenceInMs:e.Ke.getValue(V.Ve,6e4)});var o=e.Ke.getValue(V.Ge,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},flushAndSetNewEndpoint:function(e,i){t.flushAndSetNewEndpoint(e,i)}}}function q(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function K(e,t){return void 0===t?null:t}function Z(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}function $(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(!t)return;try{return t(e)}catch(e){i&&i.ULS.qe(594883024,A.k,P.Error,"IsFeatureEnabled callback error: "+Z(e))}return}(i,e,t)}}}function X(e,t){var i={};if(Object.keys(G).forEach((function(t){var n=e.isFeatureEnabled(G[t]);void 0!==n&&(i[G[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[G.Ze]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}!function(e){e.Ze="EnterpriseTemplates",e.$e="ExcelAdaptiveLayoutDownload",e.Xe="ExcelLandingPageOfflineTelemetry",e.Qe="ExcelLandingPageObserverRetry",e.Ye="H2StaticContent",e.et="HashedUrl",e.tt="ODCShareLinkPreload",e.it="OfficeComExcelJsApiV2",e.nt="OfficeComPptJsApiV2",e.ot="OfficeComUiHost",e.rt="OfficeComWordJsApiV2",e.st="OfficeHwaUiHost",e.ct="OfficeUnifiedUiHostTeams",e.ut="WordViewToUnifiedRead"}(G||(G={}));var Q,Y,ee,te,ie,ne,oe=function(){function e(){this.dt=[]}return e.prototype.add=function(e){e&&this.dt.push(e)},e.prototype.remove=function(e){if(e){var t=this.dt.indexOf(e);t>-1&&this.dt.splice(t,1)}},e.prototype.removeAll=function(){this.dt=[]},e.prototype.dispatch=function(e,t){this.dt.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),re=function(){function e(e,t){var i=this;this.ft=0,this.lt=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.ht);if(!e)return;var t=JSON.parse(e);i.pt(t)}catch(e){i.vt.ULS.qe(592836768,A.k,P.Warning,"Failed to get settings from localStorage: "+Z(e))}},this.pt=function(e){return!!i.wt(e)&&(i.gt=e,i.St.dispatch({Ke:i},(function(e){i.vt.ULS.qe(592836769,A.k,P.Error,"Settings listener error: "+Z(e))})),!0)},this.wt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(V.Be)&&!isNaN(e.timestamp))return!0;i.vt.ULS.qe(592836770,A.k,P.Error,"Received invalid settings")}return!1},this.It=function(){if(i.bt){var e=new XMLHttpRequest;e.open("GET",i.bt),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i._t(e.response),i.ft=0):(i.vt.ULS.qe(592836771,A.k,P.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.ft)),i.ft+=1),!(i.ft>7)){var t=i.getValue(V.We,3e5);i.ft>3&&(t+=(i.ft-3+1)*(t/2)),i.Ct=window.setTimeout(i.It,t)}}}},this._t=function(e){"requestIdleCallback"in window?(i.Tt&&self.cancelIdleCallback(i.Tt),i.Tt=window.requestIdleCallback((function(){return i.yt(e)}),{timeout:1e4})):window.setTimeout((function(){return i.yt(e)}),0)},this.yt=function(e){if(i.pt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.ht,t)}catch(e){i.vt.ULS.qe(592836800,A.k,P.Warning,"Failed to set localStorage: "+Z(e))}}},this.Ut=e,this.ht="Prod"+e+"Settings",this.vt=t,this.St=new oe,this.lt()}return e.prototype.initializePeriodicFetch=function(e,t){this.ht=(r(e)?"FF":"Prod")+this.Ut+"Settings",this.lt(),this.bt=e+"AppSettingsHandler.ashx?app="+this.Ut+"&usid="+t+"&build="+R(),this.Ct||(this.Ct=window.setTimeout(this.It,3e4))},e.prototype.getValue=function(e,t){if(this.gt||this.lt(),!this.gt||!this.gt.hasOwnProperty(e))return t;var i=this.gt[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.St.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.St.remove(e)},e.prototype.dispose=function(){this.Ct&&window.clearTimeout(this.Ct),this.Tt&&self.cancelIdleCallback(this.Tt),this.Ct=void 0,this.Tt=void 0,this.gt=void 0,this.St.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete"}(Q||(Q={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared"}(Y||(Y={})),function(e){e.At="App_AccessibilityLoopComplete",e.Pt="Wac_ActionComplete",e.Et="WacInitialize_Ready",e.Ot="Wac_AppFailed",e.Nt="Wac_AppBootState",e.Rt="Wac_AppCompleted",e.Ft="BrowserEvent",e.kt="UI_Close",e.xt="App_CloseTab",e.Dt="UI_Conversation",e.Mt="UI_CopyAndEdit",e.Wt="App_CreateNewDocument",e.Bt="Wac_AppDataSavedStatus",e.Ht="UI_Download",e.Lt="UI_Edit",e.Vt="Error",e.Jt="UI_FileEmbed",e.jt="UI_FileProperties",e.Gt="File_Rename",e.zt="File_RenameFailed",e.qt="UI_FileVersions",e.Kt="StateChanged",e.Zt="App_IsFrameTrusted",e.$t="GetAccessToken",e.Xt="App_GetAuthToken",e.Qt="App_GetCustomAuthConfig",e.Yt="App_GetHostKeyValue",e.ei="App_WopiInfoFromUrl",e.ti="App_DavUrlFromIds",e.ii="App_LoadingStatus",e.ni="App_SwitchMode",e.oi="App_MoveToFolder",e.ri="UI_OpenInMobileApp",e.si="UI_OpenInBrowser",e.ai="UI_OpenInClient",e.ci="PageChanged",e.di="App_PushCommentContext",e.fi="App_PushState",e.li="App_DocReboot",e.hi="UI_RedeemForCommenting",e.pi="App_RefreshSessionInfo",e.vi="UI_ReplyWithChanges",e.mi="UI_ReportAbuse",e.wi="App_FilePicker",e.gi="UI_SaveStatus",e.Si="WopiSession_Complete_Ack",e.Ii="SetOverlayContent",e.bi="UI_Sharing",e._i="UI_ShareForm",e.Ci="UI_SignIn",e.Ti="App_StoreHostKeyValue",e.yi="App_Unloaded",e.Ui="App_UlsLog",e.Ai="Wac_UnloadingApp",e.Pi="App_UpdateBootComplete",e.Ei="PageCount",e.Oi="UI_CheckUserAccessAndGrantPermissions",e.Ni="User_Activity",e.Ri="Edit_Notification",e.Fi="UI_Workflow",e.ki="ZoomChanged",e.xi="CAAEMessage",e.Di="Excel_HostFrameCacheSave",e.Mi="Excel_HostFrameCacheEvict",e.Wi="Excel_RegenerateFileBundle",e.Bi="App_SwitchToWacFrame",e.Hi="App_SaveSSRData",e.Li="App_PurgeDataInHostCache",e.Vi="App_SaveHostRenderingV2Data",e.Ji="App_SaveHostUtilsData",e.ji="AcquireOAuthTokenTeams",e.Gi="App_SwitchNotebook",e.zi="FailedBoot_CheckFileInfo",e.qi="GetTeamsUsers",e.Ki="SendTeamsUserMention",e.Zi="NavigateBackToHost",e.$i="App_GetClientUrlComplete",e.Xi="App_GetWebUrlComplete",e.Qi="App_CopyLinkComplete",e.Yi="App_SendConversationId",e.en="CloseTeamsConversation",e.tn="PageLoaded",e.in="Visio_BRS",e.nn="Visio_SendLicenseInfo",e.on="Visio_Consumption_CLTComplete",e.rn="Visio_SwitchMode_FromViewFrame",e.sn="Visio_ModeSwitch_ToHost_Ack",e.an="Visio_UpdateEditUrl",e.cn="Visio_PageViewLoaded",e.un="Visio_ActiveAppFrameLoadFailed",e.dn="Visio_DisposeBkgFrame",e.fn="Visio_ReadyToReceiveDocData",e.ln="Visio_DocReboot_HostNav",e.hn="Visio_SwitchToVisioFrame",e.pn="WacAppPerfMetric"}(ee||(ee={})),function(e){e.vn="Ack",e.mn="WacInitialize_Ready_Ack",e.wn="Wac_BeforeUnloadApp",e.gn="Blur_Focus",e.Sn="Wac_AppFailed_Ack",e.In="Wac_AppCompleted_Ack",e.bn="WopiStartSession_Complete",e._n="WopiPendingSession_Complete",e.Cn="Host_AccessibilityLoopComplete",e.Zt="Host_IsFrameTrusted",e.Tn="Grab_Focus",e.yn="HostCacheDiagnostic",e.Un="Host_KeyValue",e.An="JsApiDiagnostics",e.oi="Host_MoveToFolder",e.Pn="PageChanged_Ack",e.En="App_PopState",e.On="Host_SendChannelId",e.Nn="Host_SendConversationId",e.Rn="GetTeamsUsers_Reply",e.Fn="SendTeamsUserMention_Reply",e.kn="Host_BackButtonPressed",e.xn="Host_GetClientUrl",e.Dn="Host_GetWebUrl",e.Mn="File_Rename",e.wi="Host_FilePicker",e.Wn="PostAccessToken",e.Bn="Host_SetAuthToken",e.Hn="Host_SetCustomAuthConfig",e.Ln="App_PushCommentContext",e.Vn="CanEmbed",e.Jn="Host_RefreshSessionInfo",e.jn="CheckUserAccessAndGrantPermissions_Result",e.Gn="Host_WopiInfoFromUrl",e.zn="Host_DavUrlFromIds",e.qn="SetCurrentPage",e.Kn="SetZoomLevel",e.Zn="WopiPendingSession_Fail",e.$n="SetOverlayContent",e.Xn="WopiPendingApplicationComplete_Received",e.Qn="Host_SwitchMode",e.Yn="Host_Unload",e.eo="PageCount_Ack",e.to="ZoomChanged_Ack",e.io="Host_ShareUI",e.no="Host_Telemetry",e.oo="Visio_ConsumptionCLTComplete_Ack",e.ro="Visio_SwitchMode_FromHF_Ack",e.so="Visio_SwitchMode_FromHostFrame",e.ao="Visio_FallbackToLegacySwitch",e.co="Visio_DocumentData"}(te||(te={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="App_LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(ie||(ie={}));var se=((ne={})[Y.boot]={uo:Q.boot},ne[Y.createNew]={uo:Q.createNew},ne[Y.dispose]={uo:Q.dispose},ne[Y.rename]={uo:Q.rename},ne[Y.switchMode]={uo:Q.switchMode},ne[ee.Nt]={uo:Q.handleBootState},ne[ee.xt]={uo:Q.closeTab},ne[ee.Zt]={uo:Q.frameTrust},ne[ee.Xt]={uo:Q.getAuthToken},ne[ee.Yt]={uo:Q.getHostKeyValue},ne[ee.li]={uo:Q.appReboot},ne[ee.Ii]={uo:Q.setOverlayContent},ne[ee.Ti]={uo:Q.storeHostKeyValue},ne[ee.Pi]={uo:Q.updateBootComplete},ne[Y.blurFocus]={do:te.gn},ne[Y.continueAccessibilityLoop]={do:te.Cn},ne[Y.grabFocus]={do:te.Tn},ne[Y.moveToFolder]={do:te.oi},ne[Y.popState]={do:te.En},ne[Y.sendChannelId]={do:te.On},ne[Y.sendConvId]={do:te.Nn},ne[Y.teamsUsersReply]={do:te.Rn},ne[Y.teamsUserMentionReply]={do:te.Fn},ne[Y.backButtonPressed]={do:te.kn},ne[Y.getClientUrl]={do:te.xn},ne[Y.getWebUrl]={do:te.Dn},ne[Y.sendAccessToken]={do:te.Wn},ne[Y.sendAuthToken]={do:te.Bn},ne[Y.sendHWRTelemetry]={do:te.no},ne[Y.sendCustomAuthConfig]={do:te.Hn},ne[Y.sendDavUrl]={do:te.zn},ne[Y.sendEmbeddedViewUrl]={do:te.Vn},ne[Y.sendFrameTrustResult]={do:te.Zt},ne[Y.sendSessionInfo]={do:te.Jn},ne[Y.sendUserAccessAndPermissions]={do:te.jn},ne[Y.sendWopiInfo]={do:te.Gn},ne[Y.signalShared]={do:te.io},ne[Y.completeSharedFilePicker]={do:te.wi},ne[ee.At]={fo:ie.AccessibilityLoopCompleted},ne[ee.Pt]={fo:ie.ActionCompleted},ne[ee.Ft]={fo:ie.BrowserEvent},ne[ee.xi]={fo:ie.CAAEMessage},ne[ee.kt]={fo:ie.Close},ne[ee.Dt]={fo:ie.Conversation},ne[ee.Mt]={fo:ie.CopyAndEdit},ne[ee.Wt]={fo:ie.CreateNewDocument},ne[ee.Ht]={fo:ie.Download},ne[ee.Lt]={fo:ie.Edit},ne[ee.Vt]={fo:ie.Error},ne[ee.Jt]={fo:ie.FileEmbed},ne[ee.jt]={fo:ie.FileProperties},ne[ee.Gt]={fo:ie.FileRenamed},ne[ee.qt]={fo:ie.FileVersions},ne[ee.$t]={fo:ie.GetAccessToken},ne[ee.ti]={fo:ie.GetDavUrlFromIds},ne[ee.Qt]={fo:ie.GetCustomAuthConfig},ne[ee.ei]={fo:ie.GetWopiInfoFromUrl},ne[ee.Kt]={fo:ie.FrameStateChanged},ne[ee.ni]={fo:ie.ModeSwitched},ne[ee.oi]={fo:ie.MoveToFolder},ne[ee.ri]={fo:ie.OpenInMobileApp},ne[ee.si]={fo:ie.OpenInBrowser},ne[ee.ai]={fo:ie.OpenInClient},ne[ee.ci]={fo:ie.PageChanged},ne[ee.fi]={fo:ie.PushState},ne[ee.hi]={fo:ie.RedeemForCommenting},ne[ee.pi]={fo:ie.RefreshSessionInfo},ne[ee.vi]={fo:ie.ReplyWithChanges},ne[ee.wi]={fo:ie.SharedFilePicker},ne[ee.mi]={fo:ie.ReportAbuse},ne[ee.gi]={fo:ie.SaveStatus},ne[ee.bi]={fo:ie.Share},ne[ee._i]={fo:ie.ShareForm},ne[ee.Ci]={fo:ie.SignIn},ne[ee.Oi]={fo:ie.UserAccessAndPermissions},ne[ee.Ni]={fo:ie.UserActivity},ne[ee.Ri]={fo:ie.UserEditActivity},ne[ee.Fi]={fo:ie.Workflow},ne[ee.ki]={fo:ie.ZoomChanged},ne[ee.ji]={fo:ie.AcquireOAuthTokenTeams},ne[ee.ii]={fo:ie.LoadingStatus},ne[ee.Gi]={fo:ie.SwitchNotebook},ne[ee.zi]={fo:ie.FailedBootCheckFileInfo},ne[ee.qi]={fo:ie.GetTeamsUsers},ne[ee.Ki]={fo:ie.SendTeamsUserMention},ne[ee.Zi]={fo:ie.NavigateBackToHost},ne[ee.$i]={fo:ie.GetClientUrlComplete},ne[ee.Xi]={fo:ie.GetWebUrlComplete},ne[ee.Qi]={fo:ie.CopyLinkComplete},ne[ee.Yi]={fo:ie.SendConversationId},ne[ee.en]={fo:ie.CloseTeamsConversation},ne[ee.tn]={fo:ie.PageLoaded},ne);function ae(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(Z(e)))}}t.perfNow=W;for(var n=0;n<e.length;n+=1){try{if(W){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(Z(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}function ce(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,ue)}function ue(){var e=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):Math.floor(16*Math.random()).toString(16)}var de=function(e,t){return(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};var fe=function(){return(fe=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function le(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function he(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;var pe;Object.create;!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(pe||(pe={}));var ve=window.navigator,me=ve?ve.userAgent:void 0;function we(){if(me){if(me.indexOf("Firefox")>-1)return pe.Firefox;if(me.indexOf("Opera")>-1||me.indexOf("OPR")>-1)return pe.Opera;if(me.indexOf("Trident")>-1)return pe.IE;if(me.indexOf("Electron")>-1&&me.indexOf("Teams")>-1)return pe.TeamsElectron;if(me.indexOf("Edg")>-1)return pe.Edge;if(me.indexOf("Chrome")>-1)return pe.Chrome;if(me.indexOf("Safari")>-1)return pe.Safari}return pe.Unknown}function ge(){try{return!!me&&me.indexOf("iPad")>=0||!!me&&me.indexOf("Macintosh")>=0&&ye()&&!_e()||!!me&&me.indexOf("Android")>=0||ye()}catch(e){return!1}}function Se(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function Ie(){return we()===pe.IE&&!function(){if(we()!==pe.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function be(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function _e(){return!!me&&me.indexOf("iPhone")>=0}function Ce(){return _e()||/android.+mobile/i.test(ve.userAgent)}function Te(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1}function ye(){return!!ve&&ve.maxTouchPoints>0}function Ue(e,t){t&&Object.keys(t).forEach((function(i){e[i]=t[i]}))}function Ae(e,t){try{if(void 0===window.performance)return void t.ULS.qe(595948609,A.k,P.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.qe(595948610,A.k,P.Info,"No resources under performance");for(var n=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),o=i.length-1;o>=0;o-=1){var r=i[o],s=r.name.match(n);if(s){var a=JSON.stringify(r);return a=a.replace(new RegExp(r.name,"g"),s[0]),void t.ULS.qe(595948616,A.k,P.Info,a)}}t.ULS.qe(595948484,A.k,P.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.qe(595948617,A.k,P.Info,"Could not trace the resource timing: ".concat(Z(e)))}}function Pe(e){var t,i,n=fe(fe({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=fe({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c,u,d=e.wopi;return{accessToken:d?{length:d.accessToken.length,expiry:d.expiry}:"N/A",bootParams:e.bootParams,build:R(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:(c=e.appBaseUrl,u=c.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i),u&&u[1]?u[1]:"public"),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function Ee(){var e={perfNowSupported:W,browser:pe[we()],touchMode:ge(),highContrast:Se(),windows10x:be()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function Oe(){try{return localStorage.setItem("Test","Test"),localStorage.removeItem("Test"),!0}catch(e){return!1}}var Ne;function Re(e,t){try{var i=parseInt(e,10);if(!i)return;if(i<=H()-6e4)t.ULS.qe(558155805,A.k,P.Warning,"Bad userClickTime or host took 60+s to kick off the session from click");else if(Oe()){var n=i.toString(),o=localStorage.getItem("lastUserClickTime");if(o){var r=parseInt(o,10);r&&i<=r?t.ULS.qe(558155806,A.k,P.Warning,"Bad userClickTime: less than or equal to lastUserClickTime, delta: "+(r-i)):localStorage.setItem("lastUserClickTime",n)}else localStorage.setItem("lastUserClickTime",n)}}catch(e){t.ULS.qe(558155807,A.k,P.Error,"Error when tracking userClickTime: "+Z(e))}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(Ne||(Ne={}));var Fe=function(){function e(e,t){this.lo=function(){return ke(e,"OnBeforeUnload",t)},this.ho=function(){return ke(e,"OnPageHide",t)},this.po=function(){return ke(e,"VisibilityChange_"+document.visibilityState,t)},this.vo=function(){return ke(e,"OnUnload",t)},window.addEventListener("beforeunload",this.lo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.ho,{capture:!0}),window.addEventListener("visibilitychange",this.po,{capture:!0}),window.addEventListener("unload",this.vo,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.lo,{capture:!0}),window.removeEventListener("pagehide",this.ho,{capture:!0}),window.removeEventListener("visibilitychange",this.po,{capture:!0}),window.removeEventListener("unload",this.vo,{capture:!0})},e}();function ke(e,t,i){e.ULS.qe(595957843,A.k,P.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var xe=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a"],De=function(){function e(e){var t=this;this.mo={},this.wo=[],this.So=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var n=JSON.parse(i),o=n.AddinTrustId;o&&"AddinTrustedOrigin"===n.MessageId&&(t.vt.ULS.qe(560754784,A.k,P.Info,"didReceiveMessage addinTrustId ".concat(o)),t.mo[o]=e.origin,t.wo.forEach((function(t){t(o,e.origin)})))}}catch(e){t.vt.ULS.qe(560754785,A.k,P.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.vt=e,window.addEventListener("message",this.So)}return e.prototype.isResourceTrustedForMessage=function(e){return le(this,void 0,void 0,(function(){var t,i,n,o,r,s,a,c,u=this;return he(this,(function(d){switch(d.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(n=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=xe;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,n]:this.mo[i]?[2,Me(t,this.mo[i])]:(r=new Promise((function(e){o=function(n,o){i===n&&e(Me(t,o))},u.wo.push(o)})),s=-1,2e3,a=new Promise((function(e){s=window.setTimeout((function(){u.vt.ULS.qe(560754786,A.k,P.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([r,a])])):[2,!1];case 1:return c=d.sent(),this.wo=this.wo.filter((function(e){return e!==o})),window.clearTimeout(s),[2,c]}}))}))},e.prototype.dispose=function(){this.mo={},this.wo=[],window.removeEventListener("message",this.So)},e}();function Me(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var We=function(){function e(e,t,i,n,o,r,s){var a,c=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.Io={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},n=c.Io[t];if(n&&n.length>0)c.bo(t,i);else{var o=se[t];if(o){var r=o.uo,s=o.fo;r?(c.logger.ULS.qe(574654543,A.k,P.Info,"Running flow: ".concat(r)),c._o[r](t,i,c,c.Co[r]).catch((function(e){c.To(r,e)}))):s&&c.raiseEvent(s,i)}}},this.To=function(e,t){c.logger.ULS.qe(596459925,A.k,P.Error,"".concat(e," flow error: ").concat(Z(t))),c.remoteTelemetryUrl&&x(c.remoteTelemetryUrl,c.appInfo.name,"flowException")},this.bo=function(e,t){c.logger.ULS.qe(574654544,A.k,P.Info,"Dispatching action: ".concat(e));for(var i=c.Io[e].slice().reverse(),n=i.length-1;n>-1;n-=1)try{i[n](e,t)}catch(t){c.logger.ULS.qe(596444186,A.k,P.Error,"".concat(e," action handler error: ").concat(Z(t)))}return Promise.resolve({completion:"success"})},this.state=U.Unknown;var u=ae(),d=u[0],f=u[1];this.logger=z(),this.logger.ULS.qe(593506837,A.k,P.Info,JSON.stringify(f)),this.sessionId=d,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=n,this.appInfo=t,this.session=o,this.featureManager=$(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.Ke=new re(t.name,this.logger),this.preloader=t.preloader,a=r(this.featureManager),this._o=a[0],this.Co=a[1],this.yo=s,this.Ke.addSettingsChangeListener(this.logger.settingsChangeHandler),this.clientDiagnostics=Ee(),this.pageStateObserver=new Fe(this.logger,!0),this.authTokenTrustValidator=new De(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.qe(574654541,A.k,P.Info,"Raising event: ".concat(e));try{this.yo(e,t)}catch(e){this.logger.ULS.qe(593506838,A.k,P.Error,"Event handler error: ".concat(Z(e)))}},e.prototype.addActionHandler=function(e,t){this.Io[e]||(this.Io[e]=[]),this.Io[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.Io[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var n=this;if(this.state===U.Disposed&&this.backgroundSession)return this.logger.ULS.qe(525203609,A.k,P.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var o=[],r=this.Io[e];if(r&&r.length>0)o.push(this.bo(e,t));else{var s=se[e];if(s){var a=s.uo,c=s.do;if(a){this.logger.ULS.qe(574654542,A.k,P.Info,"Running flow: ".concat(a));var u=this._o[a](e,t,this,this.Co[a],i).catch((function(e){return n.To(a,e),{completion:"failure",error:e}}));o.push(u)}else c&&(this.container&&this.container.postMessage(c,t),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.qe(593500189,A.k,P.Warning,"Unhandled command: ".concat(e))}return Promise.race(o)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.Ke.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.Io={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}();var Be,He=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i);this.Uo=new We(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.Uo.state=U.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.Uo.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.Uo.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.Uo.run(e,t,i)},e.prototype.boot=function(e,t){return this.Uo.run(Y.boot,e,t)},e.prototype.dispose=function(e){return this.Uo.run(Y.dispose,void 0,e)},e}(),Le=function(){function e(e,t,i){var n,o,r=this;this.Ao="",this.Po="",this.Eo=!1,this.Oo=!1,this.No=!1,this.Ro=!1,this.Fo=function(e){var t,i=!1,n=!0,o="",s=!1;if(r.ko&&r.ko.contentWindow&&(i=!0,n=e.source===r.ko.contentWindow),e.origin&&(s=(o=u(e.origin,2).toLowerCase())===r.Po),!r.Eo&&(!r.Oo||s&&n)||r.vt.ULS.qe(593232850,A.k,P.Info,"Window: available["+i+"] valid["+n+"]; Origin: valid["+s+"] expected["+r.Po+"] actual["+o+"]"),s&&(!r.No||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void r.vt.ULS.qe(593232851,A.k,P.Info,"Failed to parse event data: ".concat(Z(e)))}var c=a.MessageId;if(c){if(r.vt.ULS.qe(593232854,A.k,P.Info,"Received message: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ee.Rt&&c!==ee.ii||r.setTargetOrigin(e.origin),a.Values&&a.Values.ackExpected&&r.postMessage(te.vn,void 0,a.CorrelationId),r.Ro&&c===ee.pn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);if(r.xo)try{r.xo(a)}catch(e){r.vt.ULS.qe(594556386,A.k,P.Error,"Message handler error: ".concat(Z(e)))}else r.vt.ULS.qe(591933923,A.k,P.Error,"No message handler")}else(r.Eo||r.Oo)&&r.vt.ULS.qe(593232853,A.k,P.Info,"Missing message id")}},this.vt=t,this.setTargetOrigin(e),i&&this.setMessageHandler(i),this.Ro=!!(null===(o=null===(n=window.location)||void 0===n?void 0:n.search)||void 0===o?void 0:o.match(/wdpa=1/gi)),window.addEventListener("message",this.Fo,!1)}return e.prototype.setTargetOrigin=function(e){var t=c(e).toLowerCase();this.Ao&&this.Ao!==t&&this.vt.ULS.qe(593232847,A.k,P.Warning,"Updating origin: [".concat(C(this.Ao),"]->[").concat(C(t),"]")),this.Ao=t,this.Po=u(t,2),this.Eo=r(t),this.Oo=s(t)},e.prototype.setTargetFrame=function(e,t){this.ko=e,this.No=!!t},e.prototype.setMessageHandler=function(e){this.xo=e},e.prototype.removeMessageHandler=function(){this.xo=void 0},e.prototype.postMessage=function(e,t,i){if(this.ko&&this.ko.contentWindow){this.vt.ULS.qe(593232849,A.k,P.Info,"Sending message: "+e);var n={MessageId:e,SendTime:H(),CorrelationId:i,Values:t};this.ko.contentWindow.postMessage(JSON.stringify(n),this.Ao)}else this.vt.ULS.qe(593232848,A.k,P.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.Fo,!1),this.xo=void 0},e}();!function(e){e.Do="access_token",e.Mo="access_token_ttl",e.Wo="bundleSrc",e.Bo="bundleStaleness",e.Ho="DocID",e.Lo="SiteID",e.Vo="WebID",e.Jo="ETag",e.jo="feature_status",e.Go="fileExtension",e.zo="fileGetUrl",e.qo="customFontCatalogUrl",e.Ko="fileName",e.Zo="fileSize",e.$o="forceSLR",e.Xo="frameHeightPx",e.Qo="frameWidthtPx",e.Yo="highContrast",e.er="highDpi",e.tr="host_diagnostics",e.ir="hostName",e.nr="huictrls",e.or="owner_id",e.rr="sc",e.sr="softBlockedBrowser",e.ar="templateUrl",e.cr="touchMode",e.ur="user_id",e.dr="hfck",e.lr="hfcv",e.hr="timeZoneId",e.pr="darkCssMedia",e.vr="caae",e.mr="meetingId",e.wr="meetingTitle",e.gr="meetingType",e.Sr="scheduledStartTime",e.Ir="scheduledEndTime",e.br="isPresenter",e._r="meetingOrganizerId",e.Cr="meetingJoinUrl",e.Tr="isMeetingTeamsRoom",e.yr="jsapibuild",e.Ur="owlver",e.Ar="owlro"}(Be||(Be={}));function Ve(e,t){we()===pe.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function Je(e,t){d(t,Be.Xo,String(e.offsetHeight)),d(t,Be.Qo,String(e.offsetWidth)),d(t,Be.cr,String(ge())),d(t,Be.Yo,String(Se())),d(t,Be.$o,String(be())),d(t,Be.pr,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function je(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.qe(591525084,A.k,P.Info,"Trust check error: ".concat(Z(t))),!1}}function Ge(e){return!(!e||!e.parentNode)&&(e.id?!!document.getElementById(e.id):void 0!==e.isConnected?e.isConnected:document.body.contains(e))}var ze=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.Pr=e,this.Er=t,this.Or=t+"_Form",this.Nr=je()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Pr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Er},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.Or},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.Nr},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,n){this.vt=i,this.Rr=new Le(e,i,this.xo);var o=n.useAdditionalDiv,r=n.permissionsPolicy;this.Fr&&!o?(this.Fr.setAttribute("allow",r),this.vt.ULS.qe(588793045,A.k,P.Info,"Wac frame reused")):(this.Fr=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,u=c.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",i),Ve(u,s),n&&(e.style.minHeight=n,u.style.minHeight=n),o&&(e.style.minWidth=o,u.style.minWidth=o),a&&u.setAttribute("role","none"),r){var d=c.createElement("div");d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.backgroundColor="#393a3d",d.style.backfaceVisibility="hidden",n&&(d.style.minHeight=n),o&&(d.style.minWidth=o),d.appendChild(u),e.appendChild(d)}else e.appendChild(u);return u}(this.Pr,this.Er,r,n.minHeight,n.minWidth,o,n.isInvisible,n.setNoneRole),this.vt.ULS.qe(588793046,A.k,P.Info,"Wac frame created")),this.Rr.setTargetFrame(this.Fr,n.enforceSameWindow),o&&(this.kr=this.Fr.parentElement),Je(this.Fr,t),this.xr=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Pr,this.Er,this.Or,e,t),this.xr.submit()},e.prototype.setVisibility=function(e){this.Fr&&Ve(this.Fr,e)},e.prototype.setMessageHandler=function(e){this.xo=e,this.Rr&&this.Rr.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Dr=e},e.prototype.removeMessageHandler=function(){this.xo=void 0,this.Rr&&this.Rr.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Dr?this.Dr(e,t):this.Rr&&this.Rr.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.xr&&(i.Pr.removeChild(i.xr),i.xr=void 0),i.Rr&&(i.Rr.dispose(),i.Rr=void 0,i.xo=void 0),i.Dr&&(i.Dr=void 0),i.vt=void 0,!i.Fr||!i.kr&&e)n();else{var o=function(){i.kr?(i.kr.removeChild(i.Fr),i.Pr.removeChild(i.kr)):i.Pr.removeChild(i.Fr),i.Fr=void 0,i.kr=void 0,n()};t?o():(i.Fr.src="about:blank",window.setTimeout(o,0))}}))},e}();var qe=function(){function e(e,t,i){var n,o=this;this.sessions=[],this.containers=[],this.Mr=function(e){o.Wr.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.Br=e,this.Hr=t,this.Lr=i,this.Wr=new oe,(n=e.host.owlVersion)&&(N.BUILD_NUMBER=n),"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Hr.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return R()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.Wr.add(e)},e.prototype.removeEventListener=function(e){this.Wr.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.Hr.name,"_").concat(this.containers.length),i=new ze(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new He(this.Br,this.Hr,e,this,this.Mr,this.Lr);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.Wr.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}();function Ke(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}function Ze(e){return function(e,t){var i={};t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]}));return e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),e)}function $e(e,t,i){var n=fe(fe(fe({},p(e.appUrl)),function(e){var t={};d(t,"jsapi","1"),d(t,"jsapiver","v2"),d(t,"corrid",e.sessionId),d(t,"usid",e.sessionId),d(t,"newsession","1"),d(t,"sftc","1"),e.hostSessionId&&d(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&d(t,"uih",i.uiHostName),i.uiHostIntegrationType&&d(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&d(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&d(t,"accloop","1"),n.rebootDoc&&d(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&d(t,"scnd","1"),n.authToken&&d(t,"sat","1"),n.customAuthConfig&&d(t,"cac","1"),n.refreshAccessToken&&d(t,"rat","1"),n.atMentions&&d(t,"sams","1"),n.moveToFolder&&d(t,"mtf","1"),n.noBrowserModalDialogs&&d(t,"nbmd","1"),n.commonFilePicker&&d(t,"sfp","1"),n.directDownload&&d(t,"sdd","1"),n.directPrint&&d(t,"sdp","1"));var o=e.ui;o.language&&d(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&d(t,"uiembed","1"),o.hideHeader&&d(t,"hhdr","1"),o.highContrast&&d(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&d(t,"hodflp","1"),o.hideAppLauncherInHeader&&d(t,"halh","1"),o.hideChatInHeader&&d(t,"hch","1"),o.hideMeInHeader&&d(t,"hmh","1"),o.hideSearchInHeader&&d(t,"hsh","1"),o.hideWorkflowInHeader&&d(t,"hwfh","1"),o.hideSettingsInHeader&&d(t,"hsth","1"),o.showAppIconInHeader&&d(t,"sih","1"),o.useNeutralColorInHeader&&d(t,"unh","1"),o.openLinksInNewWindow&&d(t,"onw","1"),o.useDarkTheme&&d(t,"udt","1"),"DocGen"===o.contentAssemblyMode&&d(t,"readOnly","1");var r=e.wopi;r&&r.source&&d(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&d(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&d(t,"readonly","1"),s.disableChat&&d(t,"dchat","1"),s.cookieCompliant&&d(t,"mscc","1"),s.isNewFile&&(d(t,"new","1"),s.isFromHostTemplate&&d(t,"wdtpl","fromhost"))),e.user.isLicensed&&d(t,"islicenseduser","1"),e.user.isSynthetic&&d(t,"syn","1"),e.actNavId&&d(t,"actnavid",e.actNavId),e.sessionContext&&d(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)d(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&d(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&d(t,"preseededwacsessionid",encodeURIComponent(u.id)));var l=e.throttling;l&&(l.protection&&d(t,"ctp",l.protection),l.request&&d(t,"rct",l.request));var h=e.hostInitDiagnostics;h&&(h.entryPoint&&d(t,"wdorigin",encodeURI(h.entryPoint)),h.userClickTime&&d(t,"wdhostclicktime",h.userClickTime.toString()));var p=e.rebootOverride;return p&&p.previousSessionId&&d(t,"wdprevioussession",p.previousSessionId),f(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=fe(fe({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function Xe(e,t){var i=function(e){var t={};d(t,"highdpi",String(window.devicePixelRatio>1.24)),d(t,"softblockedbrowser",String(Ie())),d(t,"hostname",e.hostName),d(t,"feature_status",X(e.featureManager,e.wdParams)),d(t,"jsapibuild",R());var i=e.wopi;i&&(d(t,"access_token",i.accessToken),d(t,"access_token_ttl",i.expiry.toString()));var n=e.customFontCatalogUrl;n&&d(t,"customfontcatalogurl",n);var o=e.contentBundle;if(o&&o.url){d(t,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&d(t,Be.Bo,r.toString()),e.logger.ULS.qe(577783775,A.k,P.Info,"Content bundle staleness: "+(s?r:"N/A"))}var a=e.file,c=a.name;if(c){d(t,"filename",c);var u=q(c);u&&d(t,"fileextension",u)}a.getUrl&&d(t,"filegeturl",a.getUrl),a.size&&d(t,"filesize",a.size.toString()),a.eTag&&d(t,"etag",a.eTag),a.cTag&&d(t,"revid",a.cTag),a.uniqueId&&d(t,"docid",a.uniqueId);var f=e.newFileTemplate;f&&(f.getUrl&&d(t,"templateurl",f.getUrl),f.size&&d(t,"filesize",f.size.toString()),f.eTag&&d(t,"etag",f.eTag),f.uniqueId&&d(t,"docid",f.uniqueId)),e.user.id&&d(t,"user_id",e.user.id),e.ownerId&&d(t,"owner_id",e.ownerId),e.sessionContext&&d(t,"sc",e.sessionContext);var l=e.ui;l.controls&&d(t,"huictrls",JSON.stringify(l.controls)),l.contentAssembly&&d(t,"caae","1"),"Templatization"!==l.contentAssemblyMode&&"DocGen"!==l.contentAssemblyMode||d(t,"caae","1");var h=e.meeting;h&&(h.id&&d(t,"meetingId",h.id),h.title&&d(t,"meetingTitle",h.title),h.type&&d(t,"meetingType",h.type),h.scheduledStartTime&&d(t,"scheduledStartTime",h.scheduledStartTime),h.scheduledEndTime&&d(t,"scheduledEndTime",h.scheduledEndTime),h.isPresenter&&d(t,"isPresenter",h.isPresenter.toString()),h.organizerId&&d(t,"meetingOrganizerId",h.organizerId),h.joinUrl&&d(t,"meetingJoinUrl",encodeURIComponent(h.joinUrl)),h.isMeetingTeamsRoom&&d(t,"isMeetingTeamsRoom",h.isMeetingTeamsRoom.toString()));var p=e.host;return p.owlVersion&&d(t,"owlver",p.owlVersion),p.owlRollout&&d(t,"owlro",p.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var Qe;function Ye(e,t){var i=function(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);if(!n||n.length<2)return"";return n[1]}(e);return"true"===i||"false"!==i&&t}function et(e,t,i,n){void 0===n&&(n=Qe.none);var o=e+"="+t,r="",s=new Date;s.setTime(s.getTime()+31536e6);var a=new Date;a.setTime(a.getTime()+864e5*i),a>s&&(a=s),a&&(r=";expires="+a.toUTCString());var c=";SameSite="+Qe[n];return document.cookie=o+r+c,!(!document.cookie||-1===document.cookie.indexOf(o))||n===Qe.none&&et(e,t,i,Qe.doNotSet)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Qe||(Qe={}));var tt=function(){function e(e,t,i,n,o){this.Vr=0,this.Jr=[],this.Eo=!1,this.Eo=e,this.jr=t,this.vt=i,this.Gr=n,this.zr=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.jr.getValue(V.Le,!1);this.Vr=B()+(this.zr?this.zr:this.jr.getValue(V.Fe,6e5));var i=this.Eo?3e3:5e3;this.qr=window.setInterval((function(){t&&e.vt.ULS.qe(595724178,A.k,P.Info,"Boot_HeartBeat"),B()>e.Vr&&(e.stop(),it(e.vt),e.Gr&&e.Gr())}),this.jr.getValue(V.He,i)),this.Jr.push(window.setTimeout(it,this.jr.getValue(V.ke,6e4),this.vt,1)),this.Jr.push(window.setTimeout(it,this.jr.getValue(V.xe,18e4),this.vt,2))},e.prototype.stop=function(){this.Vr=0,this.qr&&(window.clearInterval(this.qr),this.qr=void 0),this.Jr.forEach((function(e){window.clearTimeout(e)})),this.Jr=[]},e}();function it(e,t){e.ULS.qe(594901218,A.k,P.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}var nt=function(e,t,i,n,o){return e!==Y.boot?Promise.reject("Wrong flow"):new Promise((function(e){var s,u=H();if(i.state=U.Booting,i.pendingReboot=!1,function(e,t){if(!e)throw new TypeError("SessionBootParams");var i=e.appUrl,n=e.appBaseUrl;if(!i&&!n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(i&&"string"!=typeof i)throw new TypeError("AppUrl");if(n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");var o=e.file;if(!o||!o.name)throw new TypeError("FileInfo");var r=e.container;if(!r||!(r instanceof ze)&&!r.appendChild)throw new TypeError("Container");if(!t&&!Ke(e.wopi))throw new TypeError("WopiInfo")}(t,i.skipWopiValidation),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=Ze(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=fe(fe({},t.diagnostics),{hostInitializeCallTime:u}),i.Ke.getValue(V.ze,!1)&&function(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var i=window.performance.navigation;if(i){void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount);var n="UNKNOWN";switch(i.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}e.hostPageNavigationType=n}}(i.hostInitDiagnostics),t.appUrl){var d=t.appUrl;i.appUrl=d;var f=i.bootParams;if(w(d,"new")&&(f.isNewFile=!0),!f.dataLanguage)(h=g(d,"rs"))&&(f.dataLanguage=h);var h,p=i.ui;if(w(d,"uiembed")&&(p.uiEmbed=!0),!p.language)(h=g(d,"ui"))&&(p.language=h);if(!i.hostInitDiagnostics.entryPoint){var v=g(d,"wdorigin");v&&(i.hostInitDiagnostics.entryPoint=v)}if(!i.host.uiHostName){var S=g(d,"uih");S&&(i.host.uiHostName=S)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():c(t.appUrl).toLowerCase(),i.appBaseUrl=a(i.appBaseUrl,l(i.appUrl,"region")),n.initializeAppContext(i,e,t),i.appBasePath=n.buildAppBasePath(i),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),x(i.remoteTelemetryUrl,i.appInfo.name,"init");var I=!1,b=i.preseededSession;i.appInfo.usePreseededSessionId&&b&&b.id&&(i.sessionId=b.id,I=!0);var _,C=!1,T=t.hostGeneratedSessionId;!I&&T&&(i.sessionId=T,C=!0),t.rebootOverride&&(I||C||(s=ae(),i.sessionId=s[0],_=s[1]),i.Ke.addSettingsChangeListener(i.logger.settingsChangeHandler),i.pageStateObserver=new Fe(i.logger,!0),i.authTokenTrustValidator=new De(i.logger)),i.logger.ULS.qe(38580693,A.k,P.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(I,", is host generated: ").concat(C));var y=i.Ke.getValue(V.Ge,"").toString();if(""===y&&(y=i.appBasePath+"RemoteUls.ashx"),i.logger.configure({remoteUlsEndpoint:y,sessionId:i.sessionId}),i.Ke.initializePeriodicFetch(i.appBasePath,i.sessionId),_&&i.logger.ULS.qe(590966790,A.k,P.Info,JSON.stringify(_)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.qe(558155803,A.k,P.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.qe(596444237,A.k,P.Info,JSON.stringify({session:Pe(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.qe(558155804,A.k,P.Error,"Failed to log init info: ".concat(Z(t)))}}(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:R(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var E=t.container;i.container=E instanceof ze?E:i.application.createContainer(E)}i.container.setMessageHandler(i.onMessage);var O=!!n.ignoreCompletionMessage&&n.ignoreCompletionMessage(i),N=function(e,t){i.successTime=H(),O||(i.container.postMessage(te.In,void 0),Ue(i.appInitDiagnostics,t.Diagnostics)),n.onSuccess&&n.onSuccess(i,t),i.logger.ULS.qe(596448985,A.k,P.Info,JSON.stringify(i.diagnostics)),x(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(te.An,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=U.Booted,k({completion:"success"}),Ae(i.appInfo.name,i.logger)},F=function(e,t){i.failureTime=H(),n.onFailure&&n.onFailure(i,t.Error),i.logger.ULS.qe(596448986,A.k,P.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),x(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=U.Failed,k({completion:"failure"}),Ae(i.appInfo.name,i.logger)},k=function(t){O||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(ee.Rt,N),i.removeActionHandler(ee.Ot,F)),e(t)};o&&o.subscribe((function(){k({completion:o.reason||"cancelled"})})),O||(i.addActionHandler(ee.Rt,N),i.addActionHandler(ee.Ot,F)),function(e){return"wdjs"in e||"wd1js"in e}(i.wdParams)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?et("sideLoadingIsEnabled","false",0):Ye("sideLoadingIsEnabled",!1)||et("sideLoadingIsEnabled","true",1));var D=n.buildBootRequestParams(i),M=$e(i,D.appPageName,D.queryParamsOverrides),W=Xe(i,D.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(M))try{n.beforePreload&&n.beforePreload(i);var B=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(G.Ye)&&(i.logger.ULS.qe(590966791,A.k,P.Info,"HTTP2 preload enabled"),B=m(B)),i.preloader.preload(B,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.qe(590966792,A.k,P.Error,Z(e))}n.beforeContainerBoot&&n.beforeContainerBoot(i,M),i.appInitDiagnostics.officeFrameCreateTime=H(),i.container.boot(M,W,i.logger,n.buildContainerBootParams(i)),O?N(ee.Rt,{Diagnostics:{}}):(i.bootHeartBeat=new tt(r(i.appBaseUrl),i.Ke,i.logger,(function(){i.timeoutTime=H(),n.onTimeout&&n.onTimeout(i),x(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),k({completion:"timeout"}),o&&o.cancel()}),o&&n.overrideBootTimeout?Math.min(o.timeoutInMs,n.overrideBootTimeout(i)):o?o.timeoutInMs:n.overrideBootTimeout?n.overrideBootTimeout(i):void 0),n.beforeBootCompletionMessage&&n.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=H(),n.onException&&n.onException(i,e),i.remoteTelemetryUrl&&x(i.remoteTelemetryUrl,i.application.name,"bootException"),e}))},ot=function(e,t,i){return new Promise((function(t){i.logger.ULS.qe(590111070,A.k,P.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))};var rt=function(e,t,i,n,o){return e!==Y.createNew?Promise.reject("Wrong flow"):new Promise((function(r){var s={wopiPendingInitializeTime:H()},a=!!(n&&n.parallelizeStartSessionRequest&&n.buildStartSessionRequestParams)&&n.parallelizeStartSessionRequest(i),c=!1,u=!1,d=!1,f=!1,l=void 0,h=void 0,p=!1,v=!1;if(we()===pe.IE||n&&n.fallBackToSingleStepBootFlow&&n.fallBackToSingleStepBootFlow(i,t))!function(){i.logger.ULS.qe(578074079,A.k,P.Info,"Waiting for WOPI info to start boot");var e=function(e,r){if(c)i.logger.ULS.qe(578074080,A.k,P.Warning,"completeCreateNew already called");else{if(c=!0,s.wopiPendingCompleteTime=H(),"failure"===r.state)return O(r.reason),i.state=U.Failed,void n({completion:"failure"});st(r.newFile),i.run(Y.boot,fe(fe({},t),{wopi:r.wopi}),o).then((function(e){n(e)}))}};i.addActionHandler(Y.completeCreateNew,e);var n=function(t){i.removeActionHandler(Y.completeCreateNew,e),r(t)};o&&o.subscribe((function(){n({completion:"cancelled"})}))}();else{var m=function(e,t){c?i.logger.ULS.qe(587236372,A.k,P.Warning,"completeCreateNew already called"):(c=!0,s.wopiPendingCompleteTime=H(),"failure"!==t.state?Ke(l=t.wopi)?(i.wopi=l,i.logger.ULS.qe(587286030,A.k,P.Info,"WOPI info received. Access token: "+JSON.stringify({length:l.accessToken.length,expiry:l.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:a,wacFrameLoaded:u,wacCanAcceptStartSessionResponse:d})),!a||u&&!d?u&&_():g(),u&&i.container&&i.container.postMessage(te.Xn,void 0),st(t.newFile)):w("InvalidWopiInfo"):w(t.reason))},w=function(e){O(e),u&&i.container&&i.container.postMessage(te.Zn,void 0)},g=function(){i.logger.ULS.qe(587233056,A.k,P.Info,"Making parallelized StartSession request");var t=n.buildStartSessionRequestParams(i,e,l),o=$e(i,t.appPageName,t.queryParamsOverrides),r={"Content-Type":"application/x-www-form-urlencoded"},a="access_token="+encodeURIComponent(l.accessToken)+"&access_token_ttl="+encodeURIComponent(l.expiry.toString());s.startSessionStartTime=H(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(o,a,r,S)},S=function(e){var t=H();s.startSessionCompleteTime=t,i.logger.ULS.qe(587233057,A.k,P.Info,"StartSession request completed. Status code: ".concat(e.status,", time: ").concat(t)),h={RequestStatus:e.status,ResponseText:e.responseText},u&&d?b():i.logger.ULS.qe(587233058,A.k,P.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:u,wacCanAcceptStartSessionResponse:d,wopiInfoSent:p,startSessionResponseSent:v}))},I=function(e,t){s.readyMessageReceiveTime=H(),i.container&&i.container.postMessage(te.mn,void 0),u||(u=!0,d=t.CanAcceptStartSessionComplete,i.logger.ULS.qe(587321567,A.k,P.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:a,wacCanAcceptStartSessionResponse:d,startSessionResponseAvailable:!!h,wopiInfoAvailable:!!l})),c&&i.container&&i.container.postMessage(l?te.Xn:te.Zn,void 0),a&&d?b():_(),Ue(i.appInitDiagnostics,t.Diagnostics))},b=function(){v||p||!h||(200===h.RequestStatus?(v=!0,s.completeMessageCreateTime=H(),C(te.bn,{StartSessionResponse:h,Diagnostics:s},3)):_())},_=function(){v||p||!l||(p=!0,s.completeMessageCreateTime=H(),n&&n.sendCreateNewWopiInfo?n.sendCreateNewWopiInfo(i):C(te._n,{WopiDetails:{WopiSrc:l.source,AccessToken:l.accessToken,AccessTokenTtl:l.expiry.toString()},Diagnostics:s},3))},C=function(e,t,n){var o=H();n<=0?i.logger.ULS.qe(587233165,A.k,P.Error,"Attempted to complete but no ack. Time: ".concat(o)):(i.logger.ULS.qe(587233166,A.k,P.Info,"Sending complete message. Retries left: ".concat(n-1,", Time: ").concat(o)),s.completeMessageSendTime=o,i.container&&i.container.postMessage(e,t),window.setTimeout(T,1e3,e,t,n-1))},T=function(e,t,n){f||(i.logger.ULS.qe(587233167,A.k,P.Info,"Timeout session complete ack. Retries left: ".concat(n)),C(e,t,n))},y=function(e,t){f=!0},E=function(e){i.removeActionHandler(Y.completeCreateNew,m),i.removeActionHandler(ee.Et,I),i.removeActionHandler(ee.Si,y),r(e)};i.addActionHandler(Y.completeCreateNew,m),i.addActionHandler(ee.Et,I),i.addActionHandler(ee.Si,y),o&&o.subscribe((function(){E({completion:"cancelled"})})),i.skipWopiValidation=!0,i.wopi=void 0,i.run(Y.boot,t,o).then((function(e){i.skipWopiValidation=!1,i.wopi=l,E(e)}))}function O(e){i.logger.ULS.qe(596444188,A.k,P.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}}))};function st(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}var at=function(){function e(e){var t=this;this.Kr=!1,this.Zr="",this.$r=[],this.Xr=function(e){t.Kr||(t.Kr=!0,t.Zr=e?"timeout":"cancelled",t.$r.map((function(e){return e()})),t.$r=[])},this.Qr=e,window.setTimeout((function(){return t.Xr(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.Kr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.Qr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.Zr},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.Xr(!1)},e.prototype.subscribe=function(e){this.Kr?e():this.$r.push(e)},e}();function ct(e){return new at(e)}var ut=function(e,t,i,n,o){return e!==Y.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.qe(595714433,A.k,P.Info,"start disposing the application");var r=i.host.requireExplicitUnload,s={disposeStartTime:H(),forceAppUnload:r};i.state=U.Disposing;var a=function(){i.state=U.Disposed,e({completion:"success"})},c=function(e){n&&n.disposeAppSpecificResources&&n.disposeAppSpecificResources(i,t),i.dispose(),s.disposeEndTime=H(),function(e,t,i){if(i){var n=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-t.appUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.qe(592524822,A.k,P.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,s,e),i.container?i.container.dispose(i.pendingReboot,r).then(a):a()};if(r){s.appUnloadStartTime=H();i.addActionHandler(ee.yi,(function(e,t){s.appUnloadEndTime=H(),c(t)})),(o||new at(5e3)).subscribe((function(){i.state===U.Disposing&&(s.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(te.Yn,void 0)}else c()}))};var dt=function(e,t,i,n,o){return e!==ee.Zt?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(ie.FrameTrust,t);else{var n=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.qe(592445957,A.k,P.Info,"Top frame is trusted: ".concat(n)),i.container&&i.container.postMessage(te.Zt,{isTopFrameTrusted:n})}e({completion:"success"})}))},ft=function(e,t,i,n,o){return e!==ee.Xt?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(ie.GetAuthToken,t):(i.container.postMessage(te.Bn,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(te.Bn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},lt=function(e,t,i,n,o){return e!==ee.Nt?Promise.reject("Wrong flow"):new Promise((function(e){var o=t&&t.state?t.state:"Unknown";i.logger.ULS.qe(592839750,A.k,P.Info,"Boot state: [".concat(o,"]")),n&&n.beforeComplete&&n.beforeComplete(o),e({completion:"success"})}))},ht=function(e,t,i,n,o){return e!==Y.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(ee.Gt,n),i.removeActionHandler(ee.zt,r),e(t)};i.addActionHandler(ee.Gt,n),i.addActionHandler(ee.zt,r),(o||new at(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(te.Mn,t)}))};var pt,vt=function(e,t,i,n,o){return e!==ee.Ii?Promise.reject("Wrong flow"):new Promise((function(e){!function(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)t.virtualKeyboard.overlaysContent=e}(t.overlayContent),i.container&&i.container.postMessage(te.$n,void 0),e({completion:"success"})}))};!function(e){e[e.NotCreateNew=0]="NotCreateNew",e[e.UnifiedCreateNew=1]="UnifiedCreateNew",e[e.LegacyCreateNew=2]="LegacyCreateNew"}(pt||(pt={}));var mt,wt="powerpoint.officeapps.live.com",gt="https://ffc-"+wt,St="https://ppc-"+wt,It="https://eurppc-"+wt,bt="https://usc-"+wt,_t="https://euc-"+wt,Ct="https://cac-"+wt,Tt="https://ukc-"+wt,yt="https://auc-"+wt,Ut="https://jpc-"+wt,At="https://inc-"+wt,Pt="https://krc-"+wt,Et="https://frc-"+wt,Ot="https://sgc-"+wt,Nt="https://zac-"+wt,Rt="https://aec-"+wt,Ft="https://gbc-"+wt,kt="https://dec-"+wt,xt="https://chc-"+wt,Dt="https://noc-"+wt,Mt="https://brc-"+wt,Wt="https://sec-"+wt,Bt="https://qtc-"+wt,Ht="https://"+wt,Lt="https://cnc-powerpoint.partner.officewebapps.cn",Vt="https://powerpoint.gov.online.office365.us",Jt="https://powerpoint.dod.online.office365.us",jt="https://powerpoint.wac.online.office.eaglex.ic.gov",Gt="https://powerpoint.wac.online.office.microsoft.scloud",zt="https://c4-powerpoint-15.cdn.office.net/pods/s/",qt="https://c1-powerpoint-15.cdn.office.net/pods/s/",Kt=((mt={})[gt]=Zt(gt,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),mt[St]=Zt(St,zt),mt[It]=Zt(It,zt),mt[Ht]=Zt(Ht),mt[bt]=Zt(bt),mt[_t]=Zt(_t),mt[Ct]=Zt(Ct),mt[Tt]=Zt(Tt),mt[yt]=Zt(yt),mt[Ut]=Zt(Ut),mt[At]=Zt(At),mt[Pt]=Zt(Pt),mt[Et]=Zt(Et),mt[Ot]=Zt(Ot),mt[Nt]=Zt(Nt),mt[Rt]=Zt(Rt),mt[kt]=Zt(kt),mt[xt]=Zt(xt),mt[Dt]=Zt(Dt),mt[Mt]=Zt(Mt),mt[Wt]=Zt(Wt),mt[Bt]=Zt(Bt),mt["https://powerpoint.online.office.de"]=Zt("https://powerpoint.online.office.de","https://powerpoint.cdn.office.de/pods/s/"),mt[Lt]=Zt(Lt,"https://cdn.partner.officewebapps.cn/pods/s/"),mt[Vt]=Zt(Vt,"https://powerpoint.cdn.office365.us/pods/s/"),mt[Ft]=Zt(Ft,"https://powerpoint.cdn.office365.us/pods/s/"),mt[Jt]=Zt(Jt,"https://powerpoint.dod.cdn.office365.us/pods/s/"),mt[jt]=Zt(jt,"https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/"),mt[Gt]=Zt(Gt,"https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/"),mt);function Zt(e,t){return void 0===t&&(t=qt),{PodsUrl:e+"/pods/",WacCdnStaticServer:t}}function $t(e){var t=e.substring(0,e.indexOf("/p/"));return Kt[t.toLowerCase()]}var Xt=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"];function Qt(e,t,i){if(!t)return e;var n=e,o=null==i,r=n.indexOf("?");if(-1===r)return o?e:n+"?"+t+"="+i;for(var s=n.substr(r+1),a=s.split("&"),c=t+"=",u=!1,d=0;d<a.length;d+=1)if(0===a[d].indexOf(c)){n=n.replace(a[d],o?"":c+i),u=!0;break}return u||o||(s.length>0&&(n+="&"),n+=c+i),n}function Yt(e,t){return!e||"wd"!==e.substring(0,2)||Xt.indexOf(e)>=0?"":e+"="+t}function ei(e){for(var t=e,i="",n=0,o=window.location.search.substring(1).split("&");n<o.length;n++){"wdoverrides"===(u=o[n].split("="))[0]&&(i=u[1]);var r=Yt(u[0],u[1]);r&&(t+="&"+r)}for(var s=[],a=0,c=(i=i||"").split(/,|%2C/);a<c.length;a++){var u;2===(u=c[a].split(/:|%3A/)).length&&"devicepixelratio"!==u[0].toLowerCase()&&s.push(u[0]+":"+u[1])}return s.push("devicepixelratio:"+Te()),s.push("RenderGifSlideShow:true"),t=Qt(t,"wdoverrides",s.join(","))}function ti(e){var t=S("wdPodsUrl");return t&&!_(t)&&(t=""),t||(t=e),"/"!==t.substr(t.length-1)&&(t+="/"),t}function ii(e,t){var i=e.bootParams,n=e.file;if(!i.isNewFile){if(!n.getUrl)throw Error("Missing FileGetUrl");if(!n.name)throw Error("Missing FileName")}var o=e.preseededSession;o&&o.key&&("_._._."===o.key.slice(0,6)&&"-.-.-."===o.key.slice(-6)||(o.key="_._._."+o.key+"-.-.-."));var r=e.appContext;r.wopiInfoSent=!1,r.bootComplete=!1,r.bootFlowResolve=t,r.bootRecorded=!1;var s=Kt[e.appBaseUrl];e.appBasePath=s?s.PodsUrl:e.appBaseUrl+"/pods/";var a=e.wdParams,c=a.wdpodsurl;c&&!_(c)&&(c=""),c||(c=e.appBasePath);var u=/\/$/;if(u.test(c)||(c+="/"),!c)throw Error("Invalid PODS URL");r.podsUrl=c;var d=a.wdpopsurl;if(d&&!_(d)&&(d=""),d||(d=(d=c).substring(0,d.indexOf("/pods/"))),u.test(d)||(d+="/"),!d)throw Error("Invalid POPS URL");if(r.popsUrl=d,e.bootstrapperUrl){r.cdnBasePath=e.bootstrapperUrl.split("/pods/s/")[0]+"/pods/s/"}else r.cdnBasePath=s?s.WacCdnStaticServer:qt;r.createNewScenario=function(e,t,i,n){var o=pt.NotCreateNew,r="NotCreateNew";t.isNewFile?i.size?(o=pt.LegacyCreateNew,r="CreateNewWithNonZeroByteFile"):(o=pt.UnifiedCreateNew,r="IsNewFile"):t.isFromHostTemplate?(o=pt.UnifiedCreateNew,r="CreateNewFromHostTemplate"):n&&n.getUrl&&(o=pt.UnifiedCreateNew,r="CreateNewFromTemplateSourceUrl");var s={CreateNewScenario:pt[o],reason:r};return e.ULS.qe(34932951,A.k,P.Info,JSON.stringify(s)),o}(e.logger,i,n,e.newFileTemplate),r.shouldUsePods=function(e,t,i,n,o,r,s){var a=!1,c=!1,u="";t?(a="false"!==t,c=!0,u="wdPodsEnabled is available"):i?e===pt.LegacyCreateNew?(a=!1,c=!1,u="Legacy Create New Scenario because non-zero file size"):n?(a=!1,c=!1,u="Embed View fallback to WAC"):(a=!0,c=!0,u="Supported Region"):(a=!1,c=!1,u="Wac region not currently supported by PODS",s.ULS.qe(589168768,A.k,P.Warning,u+": "+r));o||e!==pt.NotCreateNew||(a=!1,c=!1,u+=" | FileGetUrl is empty");var d={ShouldUsePodsOrCached:a,ShouldUsePods:a,CanUsePods:c,ApplicationUrl:r,Reason:u,CreateNewScenario:pt[e]};return s.ULS.qe(561640788,A.k,P.Info,JSON.stringify(d)),a}(r.createNewScenario,a.wdpodsenabled,!!s,w(e.appUrl,"embed"),!!n.getUrl,C(e.appBaseUrl),e.logger);var f=e.hostInitDiagnostics;f&&f.userClickTime&&Re(f.userClickTime,e.logger),function(e){var t=e.hostInitDiagnostics,i=e.bootParams,n=e.file,o=!!n.getUrl,r=!!e.customFontCatalogUrl,s=e.contentBundle,a={BootstrapperType:"TypeScript",JsApiVersion:"v2",Preview:!1,Scenario:"Unified App",ApplicationUrl:C(e.appBaseUrl),IsDeepLink:!!S("nav"),BootstrapperInstanceId:ce(),IsMobileView:Ce(),ApplicationCustomSettings:{OnDemandServer:C(e.appBasePath),EnableWacFallback:!0},SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:i.dataLanguage,DocumentClickTime:t.userClickTime,CurrentTime:H(),UiHost:e.host.uiHostName,WdParams:e.wdParams},Diagnostics:{EntryPoint:t.entryPoint,FileHost:e.host.storageHostName,PodsRing:"",UnifiedUiHostDiagnostics:t.unifiedUiHostDiagnostics},WopiPrecheckInfo:{FileSize:n.size,FileGetUrlBool:o,CustomFontCatalogBool:r,FileGetUrlLength:o?n.getUrl.length:null,FileNameBool:!!n.name,ReadOnly:i.readOnly,IrmEnabled:i.irmEnabled,SupportsDecryptedContentDownload:i.supportsDecryptedContentDownload,ViewOnly:i.viewOnly,PreseededSessionKey:!!e.preseededSession&&!!e.preseededSession.key,FileExtension:q(n.name)||null,BundleInfo:s?{MajorVersion:s.majorVersion,URLBool:!!s.url}:{}},AppInfo:{AppVersionMajor:1,AppVersionMinor:F(),Environment:"wac",UserAgent:window.navigator.userAgent},AdditionalTelemetry:{PostMessageToken:e.sessionId}};e.logger.ULS.qe(22357763,A.k,P.Info,JSON.stringify(a,K))}(e)}function ni(e){return e.appBasePath}function oi(e){return t=e.appBasePath,i=e.sessionId,t+"RemoteTelemetry.ashx"+(i?"?usid="+i:"");var t,i}function ri(e){return!e.appContext.shouldUsePods}var si="\n  @media screen and (-ms-high-contrast:active)\n  {\n   div#".concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n   {\n  \tbackground-image: none !important;\n   }\n  }\n  \n  div#").concat("highContrastDetectionDiv","\n  {\n   background-color: Window;\n   position: absolute;\n   top: 0px;\n   left: -99999px;\n   width: 1px;\n   height: 1px;\n   opacity: 0;\n   overflow: hidden;\n  }\n  \n  div#").concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n  {\n   background-image: url('data:image/png;base64,").concat("highcontrastdetectordefault","');\n  }\n");function ai(e){var t=e.ownerDocument.createElement("div");t.id="highContrastDetectionDiv",t.ariaHidden="true";var i=e.ownerDocument.createElement("a");i.id="highContrastDetectionAnchor",i.setAttribute("href","#"),i.ariaHidden="true",t.appendChild(i),e.appendChild(t);var n=e.ownerDocument.createElement("style");n.innerHTML=si,e.ownerDocument.head.appendChild(n);var o=function(){e.ownerDocument.head.removeChild(n),e.removeChild(t)},r=di(t),s=di(i);if(r&&s){if(-1===s.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")){var a=function(e,t,i){var n=ci(e),o=ci(t),r=ci(i);if(!n||!o||!r)return;return{foregroundTextColor:n,backgroundColor:o,linkColor:r}}(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),s.color.toLowerCase());return o(),{isInHighContrastMode:!0,highContrastColors:a}}return o(),{isInHighContrastMode:!1}}o()}function ci(e){return new RegExp("#[0-9A-Fa-f]{6}").test(e)?e:"transparent"===e||"window"===e?"transparent":function(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(t&&4===t.length){var i=t[1],n=t[2],o=t[3];return function(e,t,i){return"#"+ui(Number(e),2)+ui(Number(t),2)+ui(Number(i),2)}(i,n,o)}return}(e)}function ui(e,t){for(var i=e.toString(16);i.length<t;)i="0"+i;return i.toLowerCase()}function di(e){if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)return e.ownerDocument.defaultView.getComputedStyle(e)}var fi;function li(){var e,t,i,n=(e={width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight-50},t={width:e.width,height:e.height},(i=t.width<320)&&(t.height-=17),t.height<256&&(t.width-=17),!i&&t.width<320&&(i=!0,t.height-=17),t.width=Math.max(t.width,320),t.height=Math.max(t.height,256),t);return(""+document.cookie).indexOf("WACRibbonMinimizedPPT=true")>=0&&(n.height-=ge()?108:94),n.height-=30,n.height-=23,n}function hi(e){var t,i,n={height:e.height-32-1,width:e.width-238-1-17};return(i={width:(t=n).width-20,height:t.height-20}).width<424?i.width=424:i.width>1696&&(i.width=1696),i.height<238.5?i.height=238.5:i.height>954&&(i.height=954),i}function pi(e){if(!e.ApplicationUrl)return null;var t=g(e.ApplicationUrl,"wdOrigin");return t||(e.Diagnostics&&e.Diagnostics.entryPoint?e.Diagnostics.entryPoint:null)}function vi(e,t,i){if(e)for(var n=0;n<e.length;n+=1){var o=e[n];if(o.name.indexOf(t)>=0)return o.name.toLowerCase()!==t.toLowerCase()&&i.ULS.qe(38147726,A.k,P.Info,"Found partial match for bootstrapper URL perf entry"),o}}function mi(e,t){if(t)try{if(!e)return void t.ULS.qe(557454687,A.k,P.Info,"Missing BootstrapperUrl");if(!window.performance)return void t.ULS.qe(557454688,A.k,P.Info,"Performance API not found on browser");var i=void 0;if(window.performance.getEntriesByName&&(i=vi(window.performance.getEntriesByName(e),e,t)),!i&&window.performance.getEntries&&(t.ULS.qe(557454689,A.k,P.Info,"Searching all entries for bootstrapper timing entry"),i=vi(window.performance.getEntries(),e,t)),!i)return void t.ULS.qe(557454690,A.k,P.Info,"Unable to extract Bootstrapper perf info");var n={name:e,logReason:"UnifiedTSBoot",nameMatchesExpected:i.name===e,connectEnd:i.connectEnd,connectStart:i.connectStart,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,fetchStart:i.fetchStart,initiatorType:i.initiatorType,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,duration:i.duration,entryType:i.entryType,startTime:i.startTime,nextHopProtocol:i.nextHopProtocol,workerStart:i.workerStart,secureConnectionStart:i.secureConnectionStart,transferSize:i.transferSize,encodedBodySize:i.encodedBodySize,decodedBodySize:i.decodedBodySize};t.ULS.qe(34928845,A.k,P.Info,JSON.stringify(n))}catch(e){t.ULS.qe(557454691,A.te,P.Warning,"Exception extracting Bootstrapper perf info: ".concat(Z(e)))}}function wi(e){return!e||e.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):e}function gi(e,t){var i=e,n=function(e){if(e.SessionInformation.UiLocale)return e.SessionInformation.UiLocale;return g(e.ApplicationUrl,"ui")}(t);n&&(i=Qt(i,"ui",n));var o=function(e){if(e.SessionInformation.DataLocale)return e.SessionInformation.DataLocale;return g(e.ApplicationUrl,"rs")}(t);o&&(i=Qt(i,"rs",o));var r=l(t.ApplicationUrl,"mscc");r&&(i=Qt(i,"mscc",r));var s=l(t.ApplicationUrl,"wdFR");s&&(i=Qt(i,"wdFR",s));var a=pi(t);a&&(i=Qt(i,"wdOrigin",I(a)));var c=wi(t.PostMessageToken);return t.PostMessageToken&&(i+="&postMessageToken="+c),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=Qt(i,"dchat","1")),i=function(e,t){var i=t.indexOf("?");if(-1===i)return e;for(var n=e,o=0,r=t.substring(i+1).split("&");o<r.length;o++){var s=r[o].split("=");if(""===l(e,s[0])){var a=Yt(s[0],s[1]);a&&(n+="&"+a)}}return n}(i,t.ApplicationUrl)}function Si(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return e;default:return""}}function Ii(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return e}}function bi(e,t,i){if(e){var n="Page lifecycle: "+t+" fired.";i&&(n+="Flushing ULS logger",e.ULS.flushOnClose()),e.ULS.qe(579384268,A.k,P.Warning,n)}}function _i(e){return e.toLocaleLowerCase().indexOf("pod")>=0||e.toLocaleLowerCase().indexOf("pop")>=0}function Ci(e){var t="";for(var i in e)_i(i)||(t+="&"+i+"="+e[i]);return t}function Ti(e){var t=e.wdParams,i=Ce(),n="true"===t.wdembedview||w(e.appUrl,"embed"),o=e.appContext,r=i?"pptmobileapp.aspx":n?"pptembed.aspx":"ppt.aspx",s={},a={};Xt.forEach((function(e){f(s,e)}));var c=["devicepixelratio:"+Te(),"RenderGifSlideShow:true"],u=t.wdoverrides;u&&u.split(/,|%2C/).forEach((function(e){var t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&c.push(t[0]+":"+t[1])})),d(s,"wdoverrides",c.join(",")),n&&(f(s,"corrid"),f(s,"usid")),ge()&&d(a,"touchdevice","1");var h=window.document.documentElement;h&&(void 0!==h.clientWidth&&d(a,"windowwidth",h.clientWidth.toString()),void 0!==h.clientHeight&&d(a,"windowheight",h.clientHeight.toString()));var p=S("previoussessionid");p&&d(a,"previoussessionid",p),Oe()&&d(a,"lssupported","1");var v=e.host.capabilities;v&&(v.rebootDoc&&(d(a,"sdr",v.rebootDoc.toString()),f(s,"sdr")),v.createNewDoc&&(d(a,"scnd","1"),f(s,"scnd")),v.authToken&&(d(a,"sat","1"),f(s,"sat")),v.customAuthConfig&&(d(a,"cac","1"),f(s,"cac")),v.refreshAccessToken&&(d(a,"rat","1"),f(s,"rat")),v.atMentions&&(d(a,"sams","1"),f(s,"sams")),v.moveToFolder&&(d(a,"mtf","1"),f(s,"mtf")),v.noBrowserModalDialogs&&(d(a,"nbmd","1"),f(s,"nbmd")),v.commonFilePicker&&(d(a,"sfp","1"),f(s,"sfp")),v.directDownload&&(d(a,"sdd","1"),f(s,"sdd")),v.directPrint&&(d(a,"sdp","1"),f(s,"sdp")));var m=e.ui;m.hideHeader&&(d(a,"hhdr","1"),f(s,"hhdr")),m.hideFileLocationPicker&&(d(a,"hodflp","1"),f(s,"hodflp")),m.hideAppLauncherInHeader&&(d(a,"halh","1"),f(s,"halh")),m.hideChatInHeader&&(d(a,"hch","1"),f(s,"hch")),m.hideMeInHeader&&(d(a,"hmh","1"),f(s,"hmh")),m.hideSearchInHeader&&(d(a,"hsh","1"),f(s,"hsh")),m.hideWorkflowInHeader&&(d(a,"hwfh","1"),f(s,"hwfh")),m.hideSettingsInHeader&&(d(a,"hsth","1"),f(s,"hsth")),m.showAppIconInHeader&&(d(a,"sih","1"),f(s,"sih")),m.useNeutralColorInHeader&&(d(a,"unh","1"),f(s,"unh")),e.hostName&&d(a,"filesrc",e.hostName),e.user.id&&d(a,"userid",e.user.id),m.openLinksInNewWindow&&(d(a,"onw","1"),f(s,"onw")),m.useDarkTheme&&(d(a,"udt","1"),f(s,"udt"));var g=e.viewMode;g&&g.hideToolbar&&d(a,"hvt","1");var _=e.file;_.name&&(d(s,"filename",I(_.name)),f(a,"filename")),_.getUrl&&(d(a,"fileurl",_.getUrl),f(a,"filegeturl")),d(s,"filegeturlbool",_.getUrl?"true":"false"),_.size&&(d(s,"fs",_.size.toString()),f(a,"filesize"));var C=e.newFileTemplate;C&&C.size&&(d(s,"fs",C.size.toString()),f(a,"filesize"));var T=e.contentBundle;T&&T.url&&(d(a,"bundleurl",T.url),f(a,"bundlesrc"));var y=e.bootParams;y.irmEnabled&&d(a,"irmenabled",y.irmEnabled.toString()),y.supportsDecryptedContentDownload&&d(a,"supportsdecryptedcontentdownload",y.supportsDecryptedContentDownload.toString()),y.readOnly&&f(s,"readonly"),d(s,"ro",y.readOnly?y.readOnly.toString():"false"),y.viewOnly&&d(a,"viewonly",y.viewOnly.toString()),y.openViewByDefault&&d(a,"ovbd",y.openViewByDefault.toString());var U=e.preseededSession;U&&(U.key&&(n||d(a,"preseededsessionkey",U.key),f(s,"preseededsessionkey")),U.id&&f(s,"preseededwacsessionid"));var E=e.throttling;E&&(E.protection&&(d(a,"ctp",E.protection),f(s,"ctp")),E.request&&(d(a,"rct",E.request),f(s,"rct")));var O=S("nav");if(O||(O=e.actNavId?e.actNavId:l(e.appUrl,"actnavid")),O){try{var N=b(O),R=JSON.parse(N),k=R.sId;k&&(d(s,"wdslideid",k),d(s,"dc","1"));var x=R.commentId;x&&"null"!==x&&d(s,"wdcommentid",x);var D=R.openMode;D&&"null"!==D&&d(s,"wdopenmode",D)}catch(t){e.logger.ULS.qe(560329684,A.k,P.Error,"Failed to parse navigation id: ".concat(O))}f(s,"actnavid")}if(o.shouldUsePods){e.appBasePath=o.podsUrl,f(s,"powerpointview"),d(s,"wdpodsurl",I(o.podsUrl)),d(s,"wdpopsurl",I(o.popsUrl)),d(s,"fastboot","true"),d(s,"noauth","1");var M=li(),W=hi(M);d(s,"thpanel",M.height.toString()),d(s,"sw",W.width.toString()),d(s,"sh",W.height.toString());var B=t.wdfs;B&&d(s,"fslide",B);var H=t.wdfsection;H&&d(s,"fsection",H),(B||H||t.wdincludehosturl&&"false"!==t.wdincludehosturl)&&d(s,"frameurl",I(window.location.href));var L=S("automation");L&&d(s,"automation",L);var V=S("startrehearsal");if(V&&d(s,"startrehearsal",V),d(s,"postmessagetoken",e.sessionId),d(a,"postmessagetoken",e.sessionId),e.wdParams){var J=Ci(e.wdParams);J&&d(a,"wdparams",J)}if(d(a,"jsapiversionminor",F().toString()),(G=e.wopi)&&G.source&&(d(a,"wopisrc",G.source),f(s,"wopisrc")),e.container){var j=ai(e.container.element);j&&j.isInHighContrastMode&&(d(a,"isinhighcontrastmode","true"),j.highContrastColors&&d(a,"clientcolorsettings",j.highContrastColors.foregroundTextColor+"_"+j.highContrastColors.backgroundColor+"_"+j.highContrastColors.linkColor))}}else{e.appBasePath||d(s,"nolog","True");var G,z=e.appUrl.substring(0,e.appUrl.indexOf("?")),q=z.lastIndexOf("/")+1;if(e.appBasePath=z.substring(0,q),r=z.substring(q),(G=e.wopi)&&G.source){var K=G.source;K.toLowerCase().indexOf("powerpointframe.aspx")>=0&&(K=decodeURIComponent(l(K,"wopisrc"))),d(s,"wopisrc",I(K))}d(s,"wdenableroaming","1"),d(s,"wdo","1")}return{appPageName:r,queryParamsOverrides:s,postDataOverrides:a}}function yi(e){if(e.appContext.shouldUsePods){var t=function(i,n){Ui(e),e.removeActionHandler(ee.Et,t)};e.addActionHandler(ee.Et,t);e.addActionHandler(ee.Ui,(function(t,i){t===ee.Ui&&function(e,t){var i=t;if(!i||"number"!=typeof i.Tag||"number"!=typeof i.Category||"number"!=typeof i.Level||"string"!=typeof i.Message)return;try{e.logger.ULS.qe(i.Tag,i.Category,i.Level,i.Message)}catch(t){e.logger.ULS.qe(512235072,A.k,P.Error,"ulsLog exception: "+t)}}(e,i)}))}mi(e.bootstrapperUrl,e.logger),window.setTimeout((function(){e.logger.ULS.flush()}),1e4)}function Ui(e){var t,i=e.appContext;if(!i.wopiInfoSent&&e.wopi){i.wopiInfoSent=!0;var n="";e.wdParams&&(n=Object.keys(e.wdParams).filter((function(e){return!/po[d/p]/i.test(e)})).reduce((function(t,i){return"".concat(t,"&").concat(i,"=").concat(e.wdParams[i])}),""));var o=e.bootParams,r=e.wopi,s=e.hostInitDiagnostics,a={WopiSrc:r.source,AccessToken:r.accessToken,AccessTokenTTL:r.expiry,ReadOnly:o.readOnly,IrmEnabled:o.irmEnabled,SupportsDecryptedContentDownload:o.supportsDecryptedContentDownload,FileName:e.file.name,SessionContext:e.sessionContext,WdParams:n,DocumentURL:window.location.href,PreviousSessionID:S("PreviousSessionID"),FirstPageFlushTime:window.WOPIPerf_FirstPageFlush,BootJsStartTime:window.WOPIPerf_BootJsStartTime,BootJsEndTime:window.WOPIPerf_BootJsEndTime,InitializeWacTime:window.WOPIPerf_InitializeWac,UserClickTime:null!==(t=window.WOPIPerf_UserClick)&&void 0!==t?t:s.userClickTime,UnifiedUiHostDiagnostics:s.unifiedUiHostDiagnostics,ClientDiagnostics:e.clientDiagnostics};if(window.performance){var c=window.performance.timing;c&&(a.NavigationStart=c.navigationStart,a.FetchStart=c.fetchStart,a.RequestStart=c.requestStart,a.ResponseStart=c.responseStart,a.ResponseEnd=c.responseEnd);var u=window.performance.navigation;u&&(a.NavigationType=u.type,a.NavigationRedirects=u.redirectCount)}e.container.postMessage(te._n,a)}}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(fi||(fi={}));var Ai="WebApplicationFrame";function Pi(e,t){var i=document.createElement("input");return i.type="hidden",i.name=e,i.value=t,i}var Ei,Oi=function(){function e(e){this.Yr=e}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return R()},e.prototype.GetSessionId=function(){return this.Yr},e.prototype.RegisterEventHandler=function(){},e.prototype.RemoveEventHandler=function(){},e.prototype.RegisterErrorHandler=function(){},e.prototype.RemoveErrorHandler=function(){},e.prototype.PostCommand=function(){},e.prototype.Dispose=function(){},e}();function Ni(e,t){if(!e.IsFileNew){if(!e.WopiPrecheckInfo.FileGetUrl)throw Error("Missing FileGetUrl from contentParams");if(!e.WopiPrecheckInfo.FileName)throw Error("Null or Empty Filename")}var i=ti(e.OnDemandServer);if(!i)throw Error("Invalid Pods URL");var n,o,r=(n=e.OnDemandServer,(o=S("wdPopsUrl"))&&!_(o)&&(o=""),o||(o=(o=ti(n)).substr(0,o.indexOf("/pods/"))),"/"!==o.substr(o.length-1)&&(o+="/"),o);if(!r)throw Error("Invalid Pops URL");var s=li(),a=hi(s),c="true"===S("wdEmbedView")||w(e.ApplicationUrl,"embed"),u=c?"pptembed.aspx":"ppt.aspx",d=Ce();t.ULS.qe(51380293,A.k,P.Info,"IsRequestForMobileView:".concat(d));var f=i+(u=d?"pptmobileapp.aspx":u)+"?wdPodsUrl="+I(i)+"&wdPopsUrl="+I(r)+"&fastBoot=true&sw="+a.width+"&sh="+a.height+"&thPanel="+s.height+"&ro="+e.WopiPrecheckInfo.ReadOnly+"&sftc=1&NoAuth=1&jsApi=1&jsapiver=v1";e.WopiPrecheckInfo.FileName&&(f+="&fileName="+I(e.WopiPrecheckInfo.FileName)),"DocGen"===e.SessionInformation.ContentAssemblyMode&&(f+="&readonly=1");var h=S("wdfs");h&&(f+="&fslide="+h);var p=S("wdfsection");p&&(f+="&fsection="+p);var v=S("wdIncludeHostUrl");(h||p||v&&"false"!==v)&&(f=Qt(f,"frameURL",I(window.location.href))),f=gi(f=ei(f),e),e.IsFileNew&&(f+="&new=1"),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileSize?f+="&fs="+e.NewFileTemplateSource.FileSize:e.WopiPrecheckInfo.FileSize&&(f+="&fs="+e.WopiPrecheckInfo.FileSize);var m,C=!(m=e.SessionInformation.HostSessionId)||m.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):m;e.SessionInformation.HostSessionId&&(f+="&hid="+C);var T=S("Automation");T&&(f+="&Automation="+T);var y=S("StartRehearsal");y&&(f+="&StartRehearsal="+y),c||(f+="&usid="+e.SessionId),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&(f+="&uiEmbed=1"),e.SessionInformation.SupportsAccessibilityLoop&&(f+="&accloop=1"),e.SessionInformation.IsSynthetic&&(f+="syn=1");var U=g(e.ApplicationUrl,"uih");U&&(f+="&uih="+U),e.SessionInformation.UiHostIntegrationType&&(f+="&uihit="+I(e.SessionInformation.UiHostIntegrationType)),e.SessionInformation.MetaUiHostVersion&&(f+="&muv="+I(e.SessionInformation.MetaUiHostVersion)),e.SessionInformation.HighContrastMode&&(f+="&hcm="+I(e.SessionInformation.HighContrastMode));var E=S("nav");if(E||(E=l(e.ApplicationUrl,"actNavId")),E)try{var O=b(E),N=JSON.parse(O),k=N.sId;k&&(f=Qt(f,"wdSlideId",k),f=Qt(f,"DC","1"));var x=N.commentId;x&&"null"!==x&&(f=Qt(f,"wdCommentId",x));var D=N.openMode;D&&"null"!==D&&(f=Qt(f,"wdOpenMode",D))}catch(e){t.ULS.qe(38580688,A.k,P.Error,"Failed to parse navigation ID: ".concat(E))}var M=e.Container;if(M){var W=document.createElement("iframe");W.id=Ai,W.name="wac_frame",W.title="Office Online Frame",W.frameBorder="0",W.style.top="0",W.style.bottom="0",W.style.left="0",W.style.right="0",W.style.height="100%",W.style.width="100%",W.style.minHeight="200px",W.style.minWidth="300px",W.style.position="absolute",W.setAttribute("allowfullscreen","true"),W.setAttribute("allowTransparency","true");var B="";if(we()===pe.Safari)B+="autoplay;",B+="microphone;",B+="camera;",B+="clipboard-read;";else{var H=i+" "+function(e,t){if(t){return t.split("/pods/s/")[0]+"/pods/s/"}if(e){var i=$t(e);if(i)return i.WacCdnStaticServer;throw Error("Application url provided but region not in region allow list")}return qt}(e.ApplicationUrl,e.BootstrapperUrl)+";";B+="autoplay "+H,B+="microphone "+H,B+="camera "+H,B+="clipboard-read "+H,B+="display-capture "+H}W.setAttribute("allow",B),M.style.top="0",M.style.bottom="0",M.style.left="0",M.style.right="0",M.style.height="100%",M.style.width="100%",M.style.minHeight="200px",M.style.minWidth="300px",M.appendChild(W);var L=Date.now(),V=e.WopiPrecheckInfo.FileGetUrl;t.ULS.qe(38580689,A.k,P.Info,V?V.toString().length.toString():"null"),f+="&fileGetUrlBool="+!!V;var J=document.createElement("form");if(J.name="frameForm",J.id="frameForm",J.target="wac_frame",J.action=f,J.method="post",M.appendChild(J),e.WopiInfo){var j=e.WopiInfo.WopiSrc;j&&J.appendChild(Pi("WOPISrc",j));var G=e.WopiInfo.AccessToken;G&&J.appendChild(Pi("access_token",I(G)));var z=e.WopiInfo.AccessTokenExpiry;z&&J.appendChild(Pi("access_token_ttl",z.getTime().toString()))}var q=e.SessionInformation.SessionContext;if(q&&J.appendChild(Pi("sc",q)),e.SessionInformation.WdParams){var K=Ci(e.SessionInformation.WdParams);K&&J.appendChild(Pi("wdparams",K))}J.appendChild(Pi("jsapiversionminor",F().toString())),e.SessionInformation.HideViewerToolbar&&J.appendChild(Pi("hvt","1")),V&&J.appendChild(Pi("fileUrl",V));var Z=e.WopiPrecheckInfo.CustomFontCatalogUrl;Z&&J.appendChild(Pi("customFontCatalogUrl",Z)),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileGetUrl&&J.appendChild(Pi("templateUrl",e.NewFileTemplateSource.FileGetUrl)),e.SessionInformation.UserId&&(J.appendChild(Pi("UserID",e.SessionInformation.UserId)),J.appendChild(Pi("user_id",e.SessionInformation.UserId))),e.WopiPrecheckInfo.IrmEnabled&&J.appendChild(Pi("irmEnabled",e.WopiPrecheckInfo.IrmEnabled.toString())),e.WopiPrecheckInfo.SupportsDecryptedContentDownload&&J.appendChild(Pi("SupportsDecryptedContentDownload",e.WopiPrecheckInfo.SupportsDecryptedContentDownload.toString())),e.WopiPrecheckInfo.ViewOnly&&J.appendChild(Pi("ViewOnly",e.WopiPrecheckInfo.ViewOnly.toString())),e.NewFileTemplateSource&&e.NewFileTemplateSource.ETag?J.appendChild(Pi("ETag",e.NewFileTemplateSource.ETag)):e.WopiPrecheckInfo.ETag&&J.appendChild(Pi("ETag",e.WopiPrecheckInfo.ETag)),e.WopiPrecheckInfo.CTag&&J.appendChild(Pi("RevID",e.WopiPrecheckInfo.CTag)),e.NewFileTemplateSource&&e.NewFileTemplateSource.DocUniqueId?J.appendChild(Pi("DocID",e.NewFileTemplateSource.DocUniqueId)):e.WopiPrecheckInfo.DocUniqueId&&J.appendChild(Pi("DocID",e.WopiPrecheckInfo.DocUniqueId)),e.WopiPrecheckInfo.BundleInfo&&e.WopiPrecheckInfo.BundleInfo.Url&&J.appendChild(Pi("bundleUrl",e.WopiPrecheckInfo.BundleInfo.Url)),e.WopiPrecheckInfo.PreseededSessionKey&&!c&&J.appendChild(Pi("PreseededSessionKey",e.WopiPrecheckInfo.PreseededSessionKey)),e.SessionInformation.HostName&&J.appendChild(Pi("fileSrc",e.SessionInformation.HostName)),e.ApplicationCustomSettings&&e.ApplicationCustomSettings.HostUIControls&&J.appendChild(Pi("huictrls",JSON.stringify(e.ApplicationCustomSettings.HostUIControls))),J.appendChild(Pi("feature_status",X(e.FeatureManager,{wdFlights:S("wdFlights")}))),ge()&&J.appendChild(Pi("touchDevice","1")),window.document.documentElement&&(void 0!==window.document.documentElement.clientWidth&&J.appendChild(Pi("windowWidth",window.document.documentElement.clientWidth.toString())),void 0!==window.document.documentElement.clientHeight&&J.appendChild(Pi("windowHeight",window.document.documentElement.clientHeight.toString())));var $=S("PreviousSessionID");if($&&J.appendChild(Pi("PreviousSessionID",$)),Oe()&&J.appendChild(Pi("LSSupported","1")),J.appendChild(Pi("postMessageToken",e.PostMessageToken)),(e.SessionInformation.HideHeader||"teams"===U&&"UnifiedUiHostTeams"!==e.SessionInformation.UiHostIntegrationType||"owa"===U)&&J.appendChild(Pi("hhdr","1")),e.SessionInformation.HideAppLauncherInHeader&&J.appendChild(Pi("halh","1")),e.SessionInformation.HideSearchInHeader&&J.appendChild(Pi("hsh","1")),e.SessionInformation.HideMeInHeader&&J.appendChild(Pi("hmh","1")),e.SessionInformation.HideChatInHeader&&J.appendChild(Pi("hch","1")),e.SessionInformation.HideWorkflowInHeader&&J.appendChild(Pi("hwfh","1")),e.SessionInformation.HideSettingsInHeader&&J.appendChild(Pi("hsth","1")),e.SessionInformation.ShowAppIconInHeader&&J.appendChild(Pi("sih","1")),e.SessionInformation.UseNeutralColorInHeader&&J.appendChild(Pi("unh","1")),e.SessionInformation.SupportsAuthToken&&J.appendChild(Pi("sat","1")),e.SessionInformation.SupportsCustomAuthConfig&&J.appendChild(Pi("cac","1")),e.SessionInformation.SupportsCreateNewDocument&&J.appendChild(Pi("scnd","1")),e.SessionInformation.UseDarkTheme&&J.appendChild(Pi("udt","1")),e.SessionInformation.SupportsDirectPrint&&J.appendChild(Pi("sdp","1")),e.SessionInformation.SupportsDirectDownload&&J.appendChild(Pi("sdd","1")),(e.SessionInformation.ContentAssembly||"Templatization"===e.SessionInformation.ContentAssemblyMode||"DocGen"===e.SessionInformation.ContentAssemblyMode)&&J.appendChild(Pi("caae","1")),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&e.SessionInformation.SupportsDocReboot&&J.appendChild(Pi("sdr",!0===e.SessionInformation.SupportsDocReboot?"1":e.SessionInformation.SupportsDocReboot.toString())),e.SessionInformation.HideWACOneDriveFileLocationPicker&&J.appendChild(Pi("hodflp","1")),e.SessionInformation.SupportsAtMentions&&J.appendChild(Pi("sams","1")),e.WopiPrecheckInfo.RequestedCallThrottling){var Q=e.WopiPrecheckInfo.RequestedCallThrottling;J.appendChild(Pi("rct",Q))}if(e.WopiPrecheckInfo.ClientThrottlingProtection){var Y=e.WopiPrecheckInfo.ClientThrottlingProtection;J.appendChild(Pi("ctp",Y))}e.WopiPrecheckInfo.OpenViewByDefault&&J.appendChild(Pi("ovbd",e.WopiPrecheckInfo.OpenViewByDefault.toString())),e.SessionInformation.SupportsMoveToFolder&&J.appendChild(Pi("mtf","1")),e.SessionInformation.NoBrowserModalDialogs&&J.appendChild(Pi("nbmd","1")),e.SessionInformation.SupportsCommonFilePicker&&J.appendChild(Pi("sfp","1")),e.SessionInformation.OpenLinksInNewWindow&&J.appendChild(Pi("onw","1"));var ee=ai(M);ee&&ee.isInHighContrastMode&&(J.appendChild(Pi("IsInHighContrastMode","true")),ee.highContrastColors&&J.appendChild(Pi("ClientColorSettings",ee.highContrastColors.foregroundTextColor+"_"+ee.highContrastColors.backgroundColor+"_"+ee.highContrastColors.linkColor)));var te=e.SessionInformation.OwlVersion;te&&J.appendChild(Pi("owlver",te));var ie=e.SessionInformation.OwlRollout;return ie&&J.appendChild(Pi("owlro",ie)),J.appendChild(Pi("jsapibuild",R())),J.submit(),{IFrameElement:W,FrameCreateTime:L}}}function Ri(e,t,i,n,o){i.ULS.qe(38147724,A.k,P.Info,"Launching Wac Fallback");var r=document.createElement("iframe");r.id=Ai,r.name="wac_frame",r.title="Office Online Frame",r.frameBorder="0",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.height="100%",r.style.width="100%",r.style.minHeight="200px",r.style.minWidth="300px",r.style.position="absolute",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),r.style.minHeight="150px";var s=t.Container;s.style.top="0",s.style.bottom="0",s.style.left="0",s.style.right="0",s.style.height="100%",s.style.width="100%",s.style.minHeight="150px";var a=document.createElement("div");a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight="150px",a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden";var c=document.createElement("form");c.name="wac_form",c.id="wac_form",c.target="wac_frame",c.action=function(e,t){if(e.WopiSrc.indexOf("PowerPointFrame.aspx")>=0){var i=e.WopiSrc.substr(e.WopiSrc.indexOf("WOPISrc=")+8),n=i.indexOf("&");e.WopiSrc=n<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,n))}var o=t.ApplicationUrl,r=o.indexOf("?"),s=o.substring(0,r);return s=Qt(s+="?wdEnableRoaming=1&wdo=1","PowerPointView",l(o,"PowerPointView")),w(o,"new")&&(s=Qt(s,"New","1")),w(o,"embed")&&(s=Qt(s,"Embed","1")),t.OnDemandServer||(s=Qt(s,"noLog","True")),e.WopiSrc&&(s=Qt(s,"WOPISrc",I(e.WopiSrc))),s=ei(s)}(e,t),c.method="post",c.appendChild(Pi("access_token",e.AccessToken)),c.appendChild(Pi("access_token_ttl",e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0")),s.appendChild(c),s.appendChild(a),a.appendChild(r),c.submit();var u={};n.stop();var d=n.getVisibilityChangeEvents();d&&d.length>0&&(u.documentLoadedWithTabSwitch=!0,i.ULS.qe(38147725,A.k,P.Info,"Visibility Change Events:"+JSON.stringify(d))),t.FnOnInitializeSuccess(new Oi(o),u)}function Fi(e){var t=e.appContext,i="";if(we()===pe.Safari)i+="autoplay;microphone;camera;clipboard-read;";else{var n=t.podsUrl+" "+t.cdnBasePath+";";i+="autoplay "+n,i+="microphone "+n,i+="camera "+n,i+="clipboard-read "+n,i+="display-capture "+n}return{permissionsPolicy:i,minHeight:t.shouldUsePods?"200px":"150px",minWidth:"300px",useAdditionalDiv:!t.shouldUsePods}}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Ei||(Ei={}));function ki(e,t){return e+"RemoteTelemetry.ashx"+(t?"?usid="+t:"")}function xi(e,t){return ki(Di(e),t)}function Di(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}var Mi={errorType:Ei.AppInitError,errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:5,ErrorName:"TimeoutInitialize",EventType:13,ExtraInfo:"Initialization timeout"},Wi=function(e,t){var i=this;if(this.es=0,this.ts=0,this.ns=0,this.os=0,this.rs=!1,this.ss=function(e,t){i.es=H();var n=6e5,o=S("wdOnSuccessTimeout");o&&parseInt(o,10).toString()===o&&(n=parseInt(o,10),t.ULS.qe(527521921,A.k,P.Warning,"App Timeout is overridden with url override param wdOnSuccessTimeout: ".concat(n))),n&&window.setTimeout((function(){return i.as(e,t)}),n)},this.cs=function(e,t,n,o){var r={Message:"Received ".concat(e," callback after timeout had elapsed"),timeoutTimeMs:i.os,successTimeMs:i.ts,startTimeMs:i.es,appInitDiagnostics:n,error:o};t&&t.ULS.qe(38589660,A.k,P.Info,JSON.stringify(r))},this.as=function(e,t){if(!(i.ns||i.ts||i.os)){i.os=H();try{if(Ge(e.Container)){if(t){var n="Timed out waiting for FnOnInitializeSuccess to be called. startMs:".concat(i.es,", timeoutMs:").concat(i.os,", scenario:Unified, hostSessionId:").concat(e.SessionInformation.HostSessionId,", host: ").concat(e.SessionInformation.HostName);t.ULS.qe(38589661,A.k,P.Error,n),Bi(e,5,"TimeoutInitialize",n,t,i.os,!0)}e.FnOnInitializeFailure&&e.FnOnInitializeFailure(Mi)}else t&&(t.ULS.qe(579604899,A.k,P.Warning,"App container is unloaded. Scenario: Unified"),Bi(e,7,"AppContainerUnloadedTimeout","App container is unloaded",t,i.os,!1))}catch(e){t&&t.ULS.qe(579604898,A.k,P.Error,"timeoutIfSuccessNotCalled exception: "+Z(e))}}},e.FnOnInitializeSuccess){var n=e.FnOnInitializeSuccess;e.FnOnInitializeSuccess=function(o,r){i.ts=H(),i.rs||(i.rs=!0,i.os?i.cs("success",t,r):(t&&(t.ULS.qe(38836226,A.k,P.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),Bi(e,void 0,void 0,void 0,t,H(),!1,r)),n(o,r)))}}if(e.FnOnInitializeFailure){var o=e.FnOnInitializeFailure;e.FnOnInitializeFailure=function(n,r){i.ns=H(),i.rs||(i.rs=!0,i.os&&n!==Mi?i.cs("failure",t,r,n):(t&&(Bi(e,n.Code,n.ErrorName,n.errorObject,t,H(),!1,r),t.ULS.qe(38836227,A.k,P.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")),o(n,r)))}}this.ss(e,t)};function Bi(e,t,i,n,o,r,s,a){var c=null==t&&null==i&&null==n&&!s,u=e.SessionInformation,d=e.WopiPrecheckInfo,f=d.BundleInfo,l=0;null!=u.DocumentClickTime&&u.DocumentClickTime.getTime&&(l=u.DocumentClickTime.getTime());var h={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:d.FileSize,ApiStartTime:0,HostInitTime:u.HostInitTime,AppVersion:"1."+F(),UseBabylon:"",EntryPoint:pi(e),SessionId:e.SessionId,UserAgent:window.navigator.userAgent,WACRegion:C(e.ApplicationUrl),FileHost:Ii(u.HostName),Host:u.HostName,PodsRing:"",UiHost:Si(u.HostName)},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:l,BootSuccess:c,BootTime:r,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!d.FileGetUrl,FileNameBool:!!d.FileName,ReadOnly:d.ReadOnly,SupportsDecryptedContentDownload:d.SupportsDecryptedContentDownload,ViewOnly:d.ViewOnly,PreseededSessionKey:d.PreseededSessionKey,BundleInfo:f?{MajorVersion:f.MajorVersion,URLBool:!!f.Url}:""},AppBootTimings:a?a.appBootTimingDict:""};o.ULS.qe(s?592007955:587843200,A.k,s?P.Error:P.Info,JSON.stringify(h)),x(xi(e.ApplicationUrl,e.SessionId),"PowerPoint",c?"bootSuccess":"bootFailure")}function Hi(e){var t=6e5,i=e.wdParams.wdonsuccesstimeout;return i&&parseInt(i,10).toString()===i&&(t=parseInt(i,10)),t}function Li(e){e.appContext.bootComplete=!0,Vi(e),e.logger.ULS.qe(34932955,A.k,P.Warning,JSON.stringify(e.diagnostics)),Ji(e)}function Vi(e){if(e.appContext.shouldUsePods){var t=e.appInitDiagnostics;t.officeFrameServerDocumentFlushTime=t.documentFlushTime,t.officeFrameServerFirstFlushTime=t.serverFirstFlushTime,t.officeFrameServerStartTime=t.serverStartTime,t.officeServerDocumentProcessStartTime=t.bootStartMs,t.officeServerDocumentProcessEndTime=t.bootEndMs,t.fileRequestsData=[{browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest",correlationId:t.downloadCorrelation,startTime:t.downloadStartMs,endTime:t.downloadEndMs,size:t.downloadSize,incremental:t.incDownload}],delete t.documentFlushTime,delete t.serverFirstFlushTime,delete t.serverStartTime,delete t.bootStartMs,delete t.bootEndMs,delete t.downloadCorrelation,delete t.downloadStartMs,delete t.downloadEndMs,delete t.downloadSize,delete t.incDownload}}function Ji(e,t,i,n){var o=e.appContext;if(!o.bootRecorded){o.bootRecorded=!0;var r=void 0!==t||void 0!==i||void 0!==n,s=!!e.timeoutTime,a=!!e.failureTime,c=!(!e.successTime||s||a||r),u=c?e.successTime:a?e.failureTime:e.timeoutTime,d=e.file,f=e.hostInitDiagnostics,l=e.bootParams,h=e.contentBundle,p=e.preseededSession,v=e.appInitDiagnostics,m={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:d.size,ApiStartTime:0,HostInitTime:f.hostInitializeCallTime,AppVersion:"1."+F(),UseBabylon:"",EntryPoint:f.entryPoint,SessionId:e.sessionId,UserAgent:window.navigator.userAgent,WACRegion:C(e.appBasePath),FileHost:e.host.storageHostName,Host:e.hostName,PodsRing:"",UiHost:e.host.uiHostName},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:f.userClickTime,BootSuccess:c,BootTime:u,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!d.getUrl,FileNameBool:!!d.name,ReadOnly:l.readOnly,SupportsDecryptedContentDownload:l.supportsDecryptedContentDownload,ViewOnly:l.viewOnly,PreseededSessionKey:p?p.key:void 0,BundleInfo:h?{MajorVersion:h.majorVersion,URLBool:!!h.url}:""},AppBootTimings:v?v.appBootTimingDict:""};e.logger.ULS.qe(s?592007955:587843200,A.k,s?P.Error:P.Info,JSON.stringify(m))}}function ji(e,t){Ji(e,void 0,t.errorType,Z(t.errorObject))}function Gi(e){try{var t=!e.container||!Ge(e.container.element),i=t?7:5,n=t?"AppContainerUnloadedTimeout":"TimeoutInitialize",o=t?"App container is unloaded":"Timed out waiting for boot success. startMs:".concat(e.hostInitDiagnostics.hostInitializeCallTime,", timeoutMs:").concat(e.timeoutTime,", scenario:Unified, hostSessionId:").concat(e.hostSessionId,", host: ").concat(e.hostName);if(t)e.failureTime=e.timeoutTime,e.timeoutTime=0;else if(e.appContext.shouldUsePods){var r=function(t,i){Ue(e.appInitDiagnostics,i.Diagnostics),Vi(e);var n=fe({message:"Received success message after timeout had elapsed",timeoutTime:e.timeoutTime,currentTime:H()},e.diagnostics);e.logger.ULS.qe(558195677,A.k,P.Info,JSON.stringify(n)),e.removeActionHandler(ee.Rt,r)};e.addActionHandler(ee.Rt,r)}Ji(e,i,n,o)}catch(t){e.logger.ULS.qe(558893250,A.k,P.Error,"onTimeout exception: "+Z(t))}}function zi(e,t){Ji(e,void 0,"AppInitError",Z(t))}function qi(){return!1}function Ki(e){e.appContext.shouldUsePods&&Ui(e)}var Zi=function(e,t,i,n,o){return e!==ee.li?Promise.reject("Wrong flow"):i.ui.uiEmbed?function(e,t,i,n,o){return e!==ee.li?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var n=void 0;if(t.queryOverrides)try{n=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.qe(592217694,A.k,P.Error,"Failed to parse queryOverrides: ".concat(n))}i.raiseEvent(ie.Reboot,fe(fe({},t),{previousSessionId:i.sessionId,queryOverrides:n})),e({completion:"success"})}))}(e,t,i):new Promise((function(e){var n=window.location.href;w(n,"wdccsoff")&&(n=v(n,"wdccsoff")),n=h(n,"previoussessionid",i.sessionId,!0),t.controllerServicesParam&&(n=h(n,t.controllerServicesParamName,t.controllerServicesParam)),i.logger.ULS.qe(560740507,A.k,P.Info,"Updating window.location.href"),window.location.href=n,e({completion:"success"})}))},$i=function(e,t,i,n,o){return e!==ee.Pi?Promise.reject("Wrong flow"):new Promise((function(e){var n=i.appContext;"FatalError"===t.Reason?function(e,t){var i=e.hostInitDiagnostics,n={ErrorName:t,BootCompleted:e.appContext.bootComplete,SessionInfo:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:e.bootParams.dataLanguage,DocumentClickTime:i.userClickTime,HostInitTime:i.hostInitializeCallTime,UiHost:e.host.uiHostName,WdParams:e.wdParams}};e.logger.ULS.qe(587236555,A.k,P.Error,JSON.stringify(n))}(i,t.ErrorName):i.logger.ULS.qe(558421913,A.k,P.Info,"Updating boot complete - reason [".concat(t.Reason,"]")),n.bootComplete||(i.bootHeartBeat&&i.bootHeartBeat.stop(),n.bootFlowResolve({completion:"success"})),i.successTime=H(),Ji(i),e({completion:"success"})}))};var Xi,Qi=function(){var e,t;return[(e={},e[Q.appReboot]=Zi,e[Q.boot]=nt,e[Q.closeTab]=ot,e[Q.createNew]=rt,e[Q.dispose]=ut,e[Q.frameTrust]=dt,e[Q.getAuthToken]=ft,e[Q.getHostKeyValue]=ot,e[Q.handleBootState]=lt,e[Q.rename]=ht,e[Q.setOverlayContent]=vt,e[Q.storeHostKeyValue]=ot,e[Q.switchMode]=ot,e[Q.updateBootComplete]=$i,e),(t={},t[Q.boot]={initializeAppContext:ii,buildAppBasePath:ni,buildRemoteTelemetryUrl:oi,ignoreCompletionMessage:ri,buildBootRequestParams:Ti,beforeContainerBoot:yi,buildContainerBootParams:Fi,overrideBootTimeout:Hi,onSuccess:Li,onFailure:ji,onTimeout:Gi,onException:zi},t[Q.createNew]={parallelizeStartSessionRequest:qi,sendCreateNewWopiInfo:Ki},t)]};!function(e){e[e.AppPageLoading=0]="AppPageLoading",e[e.AppReadyForPostMessage=1]="AppReadyForPostMessage",e[e.AppBootComplete=2]="AppBootComplete",e[e.DEPRECATED=3]="DEPRECATED",e[e.RefreshPage=4]="RefreshPage",e[e.UpdateInitializationComplete=6]="UpdateInitializationComplete",e[e.ProfileClientResourceUsage=7]="ProfileClientResourceUsage",e[e.ULSLog=8]="ULSLog"}(Xi||(Xi={}));var Yi=function(){function e(){var t=this;this.us={},this.ds=function(e,i){for(var n in t.us){var o=t.us[n];o&&o.log(e,i)}},this.fs=function(t){var i;try{i=JSON.parse(t.data)}catch(e){i=null}if(i){var n=i.m_id||i.Token;if(n){var o=e.getInstance(),r=o.get(n);r?r.onMessage(i,t.source):o.ds("Message received with no targetApi. Id: "+n.toString(),t.data)}}},window.addEventListener("message",this.fs)}return e.getInstance=function(){return this.ls||(this.ls=new e),this.ls},e.prototype.add=function(e,t){this.us[e]=t},e.prototype.get=function(e){return this.us[e]},e.prototype.remove=function(e){this.us[e]=null},e}();function en(e,t,i,n){return{ShouldUsePODS:e,CanUsePODS:t,Reason:i,CreateNewScenario:n}}function tn(e,t){var i,n,o=e.WopiPrecheckInfo,r=e.ApplicationUrl,s=function(e,t,i,n){var o,r;e.CreateNewInfo?(r=pt.UnifiedCreateNew,o="CreateNewInfo"):e.IsNewFile?(r=pt.UnifiedCreateNew,o="CreateNewInfoIsNewFile"):e.IsNewFileFromHostTemplate?(r=pt.UnifiedCreateNew,o="CreateNewInfoFromHostTemplate"):i&&i.FileGetUrl?(r=pt.UnifiedCreateNew,o="CreateNewInfoFromTemplateSourceUrl"):w(t,"new")?0!==e.FileSize?(r=pt.LegacyCreateNew,o="ApplicationUrlContainsNewAndNonZeroByteFile"):(r=pt.UnifiedCreateNew,o="ApplicationUrlContainsNew"):(r=pt.NotCreateNew,o="NotCreateNew");var s={};return s.CreateNewScenario=pt[r],s.reason=o,n.ULS.qe(34932951,A.k,P.Info,JSON.stringify(s)),r}(o,r,e.NewFileTemplateSource,t),a=S("wdPodsEnabled");return i=o.FileGetUrl,n=a?en("false"!==a,!0,"wdPodsEnabled is available",s):function(e,t,i){if($t(e))return t===pt.LegacyCreateNew?en(!1,!1,"Legacy Create New Scenario because application url contains new, but non-zero file size",t):-1!==e.indexOf("&Embed=1")?en(!1,!1,"Embed View fallback to WAC",t):en(!0,!0,"Supported Region",t);var n="Wac region not currently supported by PODS: "+(C(e)||"");return i.ULS.qe(589168768,A.k,P.Warning,n),en(!1,!1,n,t)}(r,s,t),i||n.CreateNewScenario!==pt.NotCreateNew?n:en(!1,!1,n.Reason+"| FileGetUrl is empty",n.CreateNewScenario)}var nn,on,rn=function(){function e(){var e=this;if(this.hs=[],this.ps=[],this.vs=function(){var t={visibility:document.visibilityState,time:H(),initialState:!1};e.hs.push(t);for(var i=0,n=e.ps;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:H(),initialState:!0};this.hs.push(t)}document.addEventListener("visibilitychange",this.vs)}return e.prototype.registerEventHandler=function(e){this.ps.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.ps.indexOf(e);this.ps.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.vs)},e.prototype.getVisibilityChangeEvents=function(){return this.hs},e.prototype.dispose=function(){this.stop(),this.ps=[],this.hs=[]},e}(),sn=((nn={})[Y.blurFocus]=te.gn,nn[Y.continueAccessibilityLoop]=te.Cn,nn[Y.grabFocus]=te.Tn,nn[Y.moveToFolder]=te.oi,nn[Y.popState]=te.En,nn[Y.rename]=te.Mn,nn[Y.sendAccessToken]=te.Wn,nn[Y.sendAuthToken]=te.Bn,nn[Y.sendCustomAuthConfig]=te.Hn,nn[Y.sendEmbeddedViewUrl]=te.Vn,nn[Y.sendSessionInfo]=te.Jn,nn[Y.sendUserAccessAndPermissions]=te.jn,nn[Y.sendWopiInfo]=te.Gn,nn[Y.sendDavUrl]=te.zn,nn[Y.completeSharedFilePicker]=te.wi,nn[Y.switchMode]=te.Qn,nn[Y.signalShared]=te.io,nn),an=function(){function e(e,t){var i,n,o=this;if(this.ms=!1,this.ps={},this.Ao="",this.Po="",this.No=!1,this.Eo=!1,this.Oo=!1,this.Ro=!1,this.ws=[],this.gs=!0,this.Ss=function(e,t,i){if(e){var n={MessageId:te.vn,CorrelationId:i,SendTime:H()};o.vt.ULS.qe(595732176,A.k,P.Info,"Sending Ack back"),e.postMessage(JSON.stringify(n),t)}else o.vt.ULS.qe(595736136,A.k,P.Info,"Missing target to send Ack back")},this.Is=function(e){var t,i=!1,n=!0,r="",s=!1;if(o.bs&&o.bs.contentWindow&&(i=!0,n=e.source===o.bs.contentWindow),e.origin&&(s=(r=u(e.origin,2).toLowerCase())===o.Po),!o.Eo&&(!o.Oo||s&&n)||o.vt.ULS.qe(595730526,A.k,P.Info,"Window is available: ".concat(i,", window is valid: ").concat(n,", origin is valid: ").concat(s,", expected origin: ").concat(o.Po,", actual origin: ").concat(r)),s&&(!o.No||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void o.vt.ULS.qe(596464282,A.k,P.Info,"Failed to parse event data: ".concat(Z(e),"."))}var c=a.MessageId;if(c){if(o.vt.ULS.qe(595714715,A.k,P.Info,"Received messageId: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ee.Rt&&c!==ee.ii||o._s(e.origin),o.Ro&&c===ee.pn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);a.Values&&a.Values.ackExpected&&o.Ss(e.source,e.origin,a.CorrelationId);var d=o.ps[c];if(!d)return o.vt.ULS.qe(596464289,A.k,P.Info,"No handler found for message id: ".concat(c)),void(o.gs&&c===ee.Xt&&(o.ws.push(a),o.vt.ULS.qe(543207888,A.k,P.Info,"Kept for later process: ".concat(c))));o.vt.ULS.qe(596464288,A.k,P.Info,"Processing message: ".concat(c));try{d(a.Values||{})}catch(e){o.vt.ULS.qe(593773704,A.k,P.Error,"Handler error: ".concat(Z(e)))}0}else(o.Eo||o.Oo)&&o.vt.ULS.qe(595730520,A.k,P.Info,"Could not find message id")}},this.Cs=function(){o.gs=!1,o.ws.forEach((function(e){var t=e.MessageId,i=o.ps[t];if(i){o.vt.ULS.qe(543207890,A.k,P.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){o.vt.ULS.qe(543207891,A.k,P.Error,"Handler error: ".concat(Z(e)))}}else o.vt.ULS.qe(543207889,A.k,P.Info,"No handler found after boot complete: ".concat(t))})),o.ws=[]},this.Ts=function(e,t,i){e.postMessage(t,i)},this._s=function(e){var t=e.toLowerCase();o.Ao&&o.Ao!==t&&o.vt.ULS.qe(596128131,A.k,P.Warning,"Updating origin: [".concat(C(o.Ao),"]->[").concat(C(t),"]")),o.Ao=t,o.Po=u(t,2),o.Eo=r(t),o.Oo=s(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.Eo=r(e),this.Oo=s(e),this.vt=t,this._s(e),this.Ro=!!(null===(n=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===n?void 0:n.match(/wdpa=1/gi))}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.ps[e])throw new Error("Duplicate registration!");this.ps[e]=t},e.prototype.removeMessageHandler=function(e){delete this.ps[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this.vt.ULS.qe(596464334,A.k,P.Info,"Sending message: "+t);var n={MessageId:t,SendTime:H(),Values:i};this.Ts(e.contentWindow,JSON.stringify(n),this.Ao)}else this.vt.ULS.qe(595948308,A.k,P.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.bs=e,this.No=!!t,this.ms||(window.addEventListener("message",this.Is,!1),this.ms=!0)},e.prototype.postMessageForCommand=function(e,t,i){var n=sn[t];n?(this.vt.ULS.qe(595702598,A.k,P.Info,"Sending message ".concat(n," for command ").concat(t)),this.sendPostMessage(e,n,i)):this.vt.ULS.qe(595702599,A.k,P.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.ps={},this.ms&&(window.removeEventListener("message",this.Is,!1),this.ms=!1)},e}();!function(e){e.BrowserEvent="BrowserEvent",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(on||(on={}));var cn=!1,un=!1;function dn(e,t,i,n,o,r,s){if(t.ULS.qe(595714433,A.k,P.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(cn,"; unloading:").concat(un)),cn||un&&e)t.ULS.qe(595714908,A.k,P.Info,"Application is already disposed or unloading");else{var a,c={logger:t,postMessenger:i,innerApplicationFrame:n,onDisposed:o,onFrameRemoved:r,unloadTimeoutInMs:s||1e3,forceAppUnload:!1,disposeStartTime:H(),appUnloadTimedOut:!1};if(e&&n)return un=!0,c.forceAppUnload=!0,(a=c).forceAppUnloadStartTime=H(),a.logger.ULS.qe(595855490,A.k,P.Info,"Sending postmessage to unload app"),a.logger.ULS.flush(),a.postMessenger.registerMessagePayloadHandler(ee.yi,(function(e){return function(e,t){e.forceAppUnloadEndTime=H(),e.appUnloadedMessageValues=t,e.logger.ULS.qe(595855491,A.k,P.Info,"AppUnloaded received from app"),fn(e)}(a,e)})),a.postMessenger.sendPostMessage(a.innerApplicationFrame,te.Yn,{}),void window.setTimeout((function(){return function(e){!un&&cn||(e.appUnloadTimedOut=!0,e.logger.ULS.qe(595855492,A.k,P.Info,"ApplicationUnload timed out, forcing dispose"),fn(e))}(a)}),a.unloadTimeoutInMs);fn(c)}}function fn(e){if(!cn)try{cn=!0,un=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:H(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,n=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-e.forceAppUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.qe(595855436,A.k,P.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.qe(595714434,A.k,P.Error,"Error disposing: ".concat(Z(t)))}}var ln=function(){function e(e,t,i,n,o){var r=this;this.ps={},this.ys=function(){r.Us.registerMessagePayloadHandler(ee.li,r.As),r.Us.registerMessagePayloadHandler(ee.ei,r.Ps),r.Us.registerMessagePayloadHandler(ee.ti,r.Es),r.Us.registerMessagePayloadHandler(ee.Xt,r.Os),r.Us.registerMessagePayloadHandler(ee.bi,r.Ns),r.Us.registerMessagePayloadHandler(ee.Qt,r.Rs),r.Us.registerMessagePayloadHandler(ee.oi,r.Fs),r.Us.registerMessagePayloadHandler(ee.wi,r.ks)},this.xs=function(e,t){var i=r.ps[e];if(i)try{i(t||{})}catch(e){r.vt.ULS.qe(593773706,A.k,P.Error,"Handler error: ".concat(Z(e)))}},this.As=function(e){e.previousSessionId=r.Yr,r.xs(on.DocumentReboot,e)},this.Ps=function(e){r.xs(on.WopiInfoFromUrl,e)},this.Es=function(e){r.xs(on.DavUrlFromIds,e)},this.Os=function(e){Promise?r.Ds.isResourceTrustedForMessage(e).then((function(t){t?r.xs(on.GetAuthToken,e):r.Us.sendPostMessage(r.bs,te.Bn,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){r.Us.sendPostMessage(r.bs,te.Bn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):r.Us.sendPostMessage(r.bs,te.Bn,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.Ns=function(e){r.xs(on.FileShare,e)},this.Rs=function(e){r.xs(on.GetCustomAuthConfig,e)},this.Fs=function(e){r.xs(on.MoveToFolder,e)},this.ks=function(e){r.xs(on.SharedFilePicker,e)},this.Yr=e,this.vt=t,this.bs=o.innerApplicationFrame,this.Us=i,this.Ms=n,this.Ds=new De(t),this.ys(),cn=!1}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return R()},e.prototype.GetSessionId=function(){return this.Yr},e.prototype.RegisterEventHandler=function(e,t){switch(e){case on.Unloaded:case on.Disposed:case on.DocumentReboot:case on.WopiInfoFromUrl:case on.DavUrlFromIds:case on.GetAuthToken:case on.GetCustomAuthConfig:case on.MoveToFolder:case on.SharedFilePicker:case on.SetOverlayContent:case on.FileShare:if(this.ps[e])throw new Error("Duplicate registration");this.ps[e]=t;break;default:this.Us.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case on.Unloaded:case on.Disposed:case on.DocumentReboot:case on.FileShare:case on.WopiInfoFromUrl:case on.DavUrlFromIds:case on.GetAuthToken:case on.GetCustomAuthConfig:case on.MoveToFolder:case on.SharedFilePicker:case on.SetOverlayContent:if(this.ps[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.ps[e];break;default:this.Us.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.Us.postMessageForCommand(this.bs,e,t)},e.prototype.Dispose=function(e,t){var i=this;dn(e||!1,this.vt,this.Us,this.bs,(function(){delete i.bs,i.Ms(),i.Us.dispose(),i.xs(on.Unloaded,{})}),(function(){try{i.xs(on.Disposed,{}),i.ps={}}catch(e){i.vt.ULS.qe(589108815,A.k,P.Error,"onFrameRemoved error: ".concat(Z(e)))}}),t)},e}();var hn,pn=function(e){function t(t,i,n,o,r){var s=e.call(this,t,i,n,o,r)||this;return s.Ws={},s.Bs=!1,s.Hs=!1,s.Ls=function(){s.Hs||(s.Hs=!0,s.Bs=!1,s.Ms&&s.Ms(),s.xs(on.Unloaded,{}),s.xs(on.Disposed,{}),s.Ws.disposeEndTime=H(),s.vt.ULS.qe(41710159,A.k,P.Info,JSON.stringify(s.Ws)),s.ps={})},s.Vs=function(e){s.Ws.appUnloadEndTime=H(),e&&(s.Ws.wacDisposeTelemetry=e),s.Ls()},s.Js=function(){!s.Bs&&s.Hs||(s.vt.ULS.qe(41710160,A.k,P.Warning,"Unload timed out"),s.Ws.appUnloadTimedOut=!0),s.Ls()},s.Us.registerMessagePayloadHandler(ee.yi,s.Vs),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}de(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.Dispose=function(e,t){if(!(this.Hs||this.Bs&&e))if(this.Ws.disposeStartTime=H(),e){this.Bs=!0,this.Ws.appUnloadStartTime=H(),this.Ws.forceAppUnload=e,this.Us.sendPostMessage(this.bs,te.Yn,{});var i=t||1e3;window.setTimeout(this.Js,i)}else this.Ls()},t}(ln),vn=function(){function e(){this.hasAppBooted=!1}return e.prototype.getIfAllFieldsSet=function(){if(this.wopiInfo&&this.hasAppBooted&&this.iframe&&this.podsUrl)return{wopiInfo:this.wopiInfo,iframe:this.iframe,podsUrl:this.podsUrl,readonly:this.readonly,hasAppBooted:this.hasAppBooted,irmEnabled:this.irmEnabled,supportsDecryptedContentDownload:this.supportsDecryptedContentDownload,fileName:this.fileName}},e}(),mn=function(){function e(e,t,i,n,o){var r,s=this;this.js=new vn,this.Gs=!1,this.zs=new rn,this.qs=function(){var e=Yi.getInstance();e&&s.Ks&&e.remove(s.Ks.PptInitParams.PostMessageToken),s.Rr&&s.Rr.dispose(),s.Zs&&s.Zs.parentElement&&s.Zs.parentElement.removeChild(s.Zs),s.Zs&&delete s.Zs,s.$s(),s.vt.ULS.qe(587552790,A.k,P.Warning,"PPTUnifiedSessionLoader::dispose:: App dispose"),s.zs.stop()},this.Xs=function(){var e=s.js&&s.js.getIfAllFieldsSet();if(!s.Qs&&e&&e.iframe.contentWindow){var t={};t.WopiSrc=e.wopiInfo.WopiSrc,t.AccessToken=e.wopiInfo.AccessToken,t.AccessTokenTTL=e.wopiInfo.AccessTokenExpiry?e.wopiInfo.AccessTokenExpiry.getTime():0,t.ReadOnly=e.readonly,t.IrmEnabled=e.irmEnabled,t.SupportsDecryptedContentDownload=e.supportsDecryptedContentDownload,t.FileName=e.fileName,t.SessionContext=s.Ys,t.WdParams=s.ea,t.DocumentURL=window.location.href;var i=S("PreviousSessionID");i&&(t.PreviousSessionID=i),s.ta(t),e.iframe.contentWindow.postMessage(JSON.stringify(t),e.podsUrl),s.Qs=!0}},this.ta=function(e){var t,i,n,o=window.WOPIPerf_FirstPageFlush;o&&(e.FirstPageFlushTime=o);var r=window.WOPIPerf_BootJsStartTime;r&&(e.BootJsStartTime=r);var a=window.WOPIPerf_BootJsEndTime;a&&(e.BootJsEndTime=a);var c=window.WOPIPerf_InitializeWac;c&&(e.InitializeWacTime=c);var u=window.WOPIPerf_UserClick,d=s.Ks&&s.Ks.AppInitDiagnostics&&s.Ks.AppInitDiagnostics.userClickTime;if(u?e.UserClickTime=u:d&&(e.UserClickTime=d),window.performance){var f=window.performance.timing;f&&(e.NavigationStart=f.navigationStart,e.FetchStart=f.fetchStart,e.RequestStart=f.requestStart,e.ResponseStart=f.responseStart,e.ResponseEnd=f.responseEnd);var l=window.performance.navigation;l&&(e.NavigationType=l.type,e.NavigationRedirects=l.redirectCount)}e.UnifiedUiHostDiagnostics=null===(i=null===(t=s.Ks)||void 0===t?void 0:t.AppInitDiagnostics)||void 0===i?void 0:i.unifiedUiHostDiagnostics,e.ClientDiagnostics=null===(n=s.Ks)||void 0===n?void 0:n.PptInitParams.ClientDiagnostics},this.ia=function(e,t,i){s.js&&(s.js.wopiInfo=e),t===pt.UnifiedCreateNew&&function(e){if(e&&e.NewFilePath)window.history.replaceState(null,"",e.NewFilePath),e.UpdatedPageTitle&&(window.document.title=e.UpdatedPageTitle);else if(window.location.href.indexOf("action=editnew")>=0){var t=window.location.href.replace("action=editnew","action=edit");window.history.replaceState(null,window.document.title||"",t)}}(i),window.setTimeout(s.Xs,1)},this.$s=function(){window.removeEventListener("beforeunload",s.lo,{capture:!0}),window.removeEventListener("pagehide",s.ho,{capture:!0}),window.removeEventListener("visibilitychange",s.po,{capture:!0})},this.na=function(){var e=je(s.vt);s.Rr?s.Rr.sendPostMessage(s.Zs,te.Zt,{isTopFrameTrusted:e}):s.vt.ULS.qe(51237655,A.k,P.Error,"Trust frame request received but the wac frame is null")};var u,d=void 0;try{var f=void 0,h=!1;e.WopiPrecheckInfo&&e.WopiPrecheckInfo.PreseededWacSessionId?(u=e.WopiPrecheckInfo.PreseededWacSessionId,h=!0):i?u=i:(u=(r=ae())[0],f=r[1]),x(xi(e.ApplicationUrl,u),"PowerPoint","init"),function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){!e.WopiPrecheckInfo.PreseededSessionKey||"_._._."===e.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)&&"-.-.-."===e.WopiPrecheckInfo.PreseededSessionKey.slice(-6)||(e.WopiPrecheckInfo.PreseededSessionKey="_._._."+e.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.")}(e),e.ApplicationUrl=a(e.ApplicationUrl,l(e.ApplicationUrl,"region")),e.ApplicationUrl=v(e.ApplicationUrl,"region");var p=function(e){if(e){var t=$t(e);return t?t.PodsUrl:e.substring(0,e.toLowerCase().indexOf("powerpointframe.aspx")).replace("/p/","/pods/")}return""}(e.ApplicationUrl);d=t||z({remoteUlsEndpoint:p+"RemoteUls.ashx",sessionId:u}),this.vt=d;var m=wi(e.SessionInformation.HostSessionId),w=fe(fe({},e),{SessionId:u,PostMessageToken:m,OnDemandServer:p,FeatureManager:n||$(e.FnIsFeatureEnabled,d),SettingsManager:o||new re("PowerPoint",d),UsePodsDetails:tn(e,d),ClientDiagnostics:Ee()});o||(w.SettingsManager.addSettingsChangeListener(d.settingsChangeHandler),w.SettingsManager.initializePeriodicFetch(p,u)),new Wi(w,d),d.ULS.qe(38580693,A.k,P.Warning,"PPTBootstrapper - initializing session. Build version: ".concat(R(),"; UserSessionId: ").concat(u,"; IsSessionIdPreseeded: ").concat(h,"; IsSessionIdToUseProvided: ").concat(!!i)),d.ULS.qe(38580694,A.k,P.Info,"Bootstrapper Init Time: ".concat((new Date).getTime())),f&&d.ULS.qe(572618978,A.k,P.Info,JSON.stringify(f)),window.addEventListener("unload",(function(){d.ULS.qe(41157219,A.k,P.Warning,"Unloading bootstrapper window."),d.ULS.flushOnClose()})),this.lo=function(){return bi(d,"OnBeforeUnload",!0)},this.ho=function(){return bi(d,"OnPageHide",!0)},this.po=function(){return bi(d,"VisibilityChange_"+document.visibilityState,!0)},window.addEventListener("beforeunload",this.lo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.ho,{capture:!0}),window.addEventListener("visibilitychange",this.po,{capture:!0}),d.ULS.qe(38580695,A.k,P.Info,"Application.InitializeWopiPending"),function(e,t){var i={BootstrapperType:"TypeScript",JsApiVersion:"v1",Preview:!1,Scenario:"Unified App",ApplicationUrl:C(e.ApplicationUrl)||null,IsDeepLink:!!S("nav"),BootstrapperInstanceId:ce(),IsMobileView:Ce()};i.ApplicationCustomSettings={OnDemandServer:C(e.OnDemandServer)||null,EnableWacFallback:!0};var n=e.SessionInformation,o=e.Diagnostics,r=o&&o.userClickTime?o.userClickTime:n.DocumentClickTime?n.DocumentClickTime.getTime():null;i.SessionInformation={HostName:n.HostName,HostSessionId:n.HostSessionId,UiLocale:n.UiLocale,DataLocale:n.DataLocale,DocumentClickTime:r,HostInitTime:n.HostInitTime,CurrentTime:H(),UiHost:Si(n.HostName),WdParams:n.WdParams},i.Diagnostics={EntryPoint:pi(e),FileHost:Ii(e.SessionInformation.HostName),PodsRing:"",UnifiedUiHostDiagnostics:o?o.unifiedUiHostDiagnostics:null};var s=e.WopiPrecheckInfo,a=!!s.FileGetUrl,c=!!s.CustomFontCatalogUrl;i.WopiPrecheckInfo={FileSize:s.FileSize,FileGetUrlBool:a,CustomFontCatalogBool:c,FileGetUrlLength:a?s.FileGetUrl.length:null,FileNameBool:!!s.FileName,ReadOnly:s.ReadOnly,IrmEnabled:s.IrmEnabled,SupportsDecryptedContentDownload:s.SupportsDecryptedContentDownload,ViewOnly:s.ViewOnly,PreseededSessionKey:!!s.PreseededSessionKey,FileExtension:q(s.FileName)||null,BundleInfo:s.BundleInfo?{MajorVersion:s.BundleInfo.MajorVersion,URLBool:!!s.BundleInfo.Url}:{}},i.AppInfo={AppVersionMajor:1,AppVersionMinor:F(),Environment:"wac",UserAgent:window.navigator.userAgent},i.AdditionalTelemetry={PostMessageToken:e.PostMessageToken},t.ULS.qe(22357763,A.k,P.Info,JSON.stringify(i,K))}(w,d);var g=w.UsePodsDetails;!function(e,t,i){var n={ShouldUsePodsOrCached:e.ShouldUsePODS,ShouldUsePods:e.ShouldUsePODS,CanUsePods:e.CanUsePODS,ApplicationUrl:C(t)||null,Reason:e.Reason,CreateNewScenario:pt[e.CreateNewScenario]};i.ULS.qe(38580687,A.k,P.Info,JSON.stringify(n))}(g,w.ApplicationUrl,d);var I=g.ShouldUsePODS;if(I){w.Diagnostics&&w.Diagnostics.userClickTime&&Re(w.Diagnostics.userClickTime,d),w.IsFileNew=g.CreateNewScenario!==pt.NotCreateNew,w.WopiPrecheckInfo.ReadOnly=w.WopiPrecheckInfo.ReadOnly||!1;var b=Ni(w,d);if(!b){var _={Message:"Error creating IFrame",HostSessionId:w.SessionInformation.HostSessionId};throw d.ULS.qe(38580696,A.k,P.Error,JSON.stringify(_)),Error("Error Creating IFrame")}d.ULS.qe(50376725,A.k,P.Warning,"Assigning wopiBootParams"),this.Zs=b.IFrameElement,this.js&&(this.js.iframe=b.IFrameElement,this.js.podsUrl=ti(w.OnDemandServer),this.js.readonly=w.WopiPrecheckInfo.ReadOnly,this.js.irmEnabled=w.WopiPrecheckInfo.IrmEnabled,this.js.supportsDecryptedContentDownload=w.WopiPrecheckInfo.SupportsDecryptedContentDownload,this.js.fileName=w.WopiPrecheckInfo.FileName),this.Rr=new an(c(w.ApplicationUrl),d),this.Rr.activate(b.IFrameElement),w.SessionInformation.SupportsFrameTrustCheck||this.Rr.registerMessagePayloadHandler(ee.Zt,this.na),this.Ys=w.SessionInformation.SessionContext?w.SessionInformation.SessionContext:"",this.ea="",w.SessionInformation.WdParams&&(this.ea=Ci(w.SessionInformation.WdParams)),this.ea&&d.ULS.qe(539837381,A.k,P.Warning,"Non-empty WdParams Assigned");var T=fe(fe({},w.Diagnostics),{hostName:w.SessionInformation.HostName});T.officeFrameCreateTime=b.FrameCreateTime,T.cacheHit=!1,this.Ks={AppInitDiagnostics:T,PptInitParams:w};var y=Yi.getInstance();y&&y.add(m,this)}d.ULS.qe(50376727,A.k,P.Warning,"Creating WopiPendingApplication"),this.oa={Complete:function(e,t){I?s.ia(e,g.CreateNewScenario,t):Ri(e,w,d,s.zs,m)},Fail:function(e){s.vt.ULS.qe(38293905,A.k,P.Info,"Host failed to give us WopiInfo")},Dispose:function(e,t){s.qs(),t&&t()}},mi(w.BootstrapperUrl,d),window.setTimeout((function(){d&&d.ULS.flush()}),1e4)}catch(t){d&&(d.ULS.qe(38580697,A.k,P.Error,Ei.AppInitError+": "+Z(t)),d.ULS.flushOnClose()),e&&(e.ApplicationUrl&&x(xi(e.ApplicationUrl,u),"PowerPoint","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Ei.AppInitError,errorObject:t}))}}return e.prototype.log=function(e){this.vt.ULS.qe(39978262,A.k,P.Info,e)},e.prototype.onMessage=function(e,t){try{if(!e||!this.Ks)return void this.vt.ULS.qe(39978263,A.k,P.Error,"Missing message data: "+!e+" or appData: "+!this.Ks);switch(this.Zs&&this.Zs.contentWindow===t||this.vt.ULS.qe(39978264,A.k,P.Error,"Message with the right postMessageToken came from an unexpected iframe"),!e.Data.officeSessionId&&this.Ks.AppInitDiagnostics.officeSessionId&&(e.Data.officeSessionId=this.Ks.AppInitDiagnostics.officeSessionId),e.Data.messageType||(e.Data.messageType=e.Type),this.vt.ULS.qe(38580691,A.k,P.Warning,JSON.stringify(e.Data)),e.Type){case Xi.AppPageLoading:break;case Xi.AppReadyForPostMessage:this.js&&(this.js.hasAppBooted=!0),e.Data.officeSessionId&&(this.Ks.AppInitDiagnostics.officeSessionId=e.Data.officeSessionId),window.setTimeout(this.Xs,1);break;case Xi.AppBootComplete:if(this.Gs=!0,this.Ks.PptInitParams.FnOnInitializeSuccess){this.Ks.AppInitDiagnostics.officeBootstrapperVersion=R(),e.Data.officeAppEndpoint&&(this.Ks.AppInitDiagnostics.officeAppEndpoint=e.Data.officeAppEndpoint),e.Data.officeServerVersion&&(this.Ks.AppInitDiagnostics.officeServerVersion=e.Data.officeServerVersion),e.Data.documentLoadedTime&&(this.Ks.AppInitDiagnostics.documentLoadedTime=e.Data.documentLoadedTime,this.Ks.AppInitDiagnostics.appCompletedTime=e.Data.documentLoadedTime),e.Data.officeFrameFirstFlushTime&&(this.Ks.AppInitDiagnostics.officeFrameFirstFlushTime=e.Data.officeFrameFirstFlushTime),e.Data.officeFrameDocumentFlushTime&&(this.Ks.AppInitDiagnostics.officeFrameDocumentFlushTime=e.Data.officeFrameDocumentFlushTime),e.Data.documentFlushTime&&(this.Ks.AppInitDiagnostics.officeFrameServerDocumentFlushTime=e.Data.documentFlushTime),e.Data.serverFirstFlushTime&&(this.Ks.AppInitDiagnostics.officeFrameServerFirstFlushTime=e.Data.serverFirstFlushTime),e.Data.serverStartTime&&(this.Ks.AppInitDiagnostics.officeFrameServerStartTime=e.Data.serverStartTime),e.Data.bootStartMs&&(this.Ks.AppInitDiagnostics.officeServerDocumentProcessStartTime=e.Data.bootStartMs),e.Data.bootEndMs&&(this.Ks.AppInitDiagnostics.officeServerDocumentProcessEndTime=e.Data.bootEndMs),e.Data.cacheHit&&(this.Ks.AppInitDiagnostics.cacheHit=e.Data.cacheHit);var i={browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest"};e.Data.downloadCorrelation&&(i.correlationId=e.Data.downloadCorrelation),e.Data.downloadStartMs&&(i.startTime=e.Data.downloadStartMs),e.Data.downloadEndMs&&(i.endTime=e.Data.downloadEndMs),e.Data.downloadSize&&(i.size=e.Data.downloadSize),e.Data.incDownload&&(i.incremental=e.Data.incDownload),this.Ks.AppInitDiagnostics.fileRequestsData=[i],this.zs.stop();var n=this.zs.getVisibilityChangeEvents();if(n&&n.length>0&&(this.Ks.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,this.vt.ULS.qe(38580692,A.k,P.Info,"Visibility Change Events:"+JSON.stringify(n))),this.vt.ULS.qe(34932955,A.k,P.Warning,JSON.stringify(this.Ks.AppInitDiagnostics)),!this.Rr)throw this.vt.ULS.qe(51448022,A.k,P.Warning,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),Error("m_postMessageHandler");this.ra=new pn(this.Ks.PptInitParams.PostMessageToken,this.vt,this.Rr,this.qs,{innerApplicationFrame:this.Zs}),this.Ks.PptInitParams.FnOnInitializeSuccess(this.ra,this.Ks.AppInitDiagnostics),this.Rr.Cs()}break;case Xi.RefreshPage:if(this.Ks.PptInitParams.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&this.Ks.PptInitParams.SessionInformation.SupportsDocReboot)break;var o=window.location.href;-1!==o.indexOf("&wdccsoff=1")&&(o=v(o,"wdccsoff")),e.Data.officeSessionId&&(o=Qt(o,"PreviousSessionID",e.Data.officeSessionId)),e.Data.ControllerServicesParam&&(o=Qt(o,e.Data.ControllerServicesParamName,e.Data.ControllerServicesParam)),this.vt.ULS.qe(594068673,A.k,P.Info,"PPTUnifiedSessionLoader::onMessage::RefreshPage Updating window.location.href"),window.location.href=o;break;case Xi.UpdateInitializationComplete:try{if("FatalError"===e.Data.Reason){var r={ErrorName:e.Data.ErrorName,BootCompleted:this.Gs,SessionInfo:(a=this.Ks.PptInitParams,u=a.SessionInformation,d=a.Diagnostics,{HostName:u.HostName,HostSessionId:u.HostSessionId,UiLocale:u.UiLocale,DataLocale:u.DataLocale,DocumentClickTime:d&&d.userClickTime?d.userClickTime:u.DocumentClickTime?u.DocumentClickTime.getTime():void 0,HostInitTime:u.HostInitTime,UiHost:Si(u.HostName),WdParams:u.WdParams})};this.vt.ULS.qe(587236555,A.k,P.Error,JSON.stringify(r))}else this.vt.ULS.qe(576583120,A.k,P.Info,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete - Reason: ".concat(e.Data.Reason))}catch(e){this.vt.ULS.qe(576582732,A.k,P.Error,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete Caught exception: "+e)}this.Rr||(this.vt.ULS.qe(51448024,A.k,P.Info,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),this.Rr=new an(c(this.Ks.PptInitParams.ApplicationUrl),this.vt),this.Rr.activate(this.Zs)),this.ra=new pn(this.Ks.PptInitParams.PostMessageToken,this.vt,this.Rr,this.qs,{innerApplicationFrame:this.Zs}),this.Ks.PptInitParams.FnOnInitializeSuccess(this.ra,this.Ks.AppInitDiagnostics),this.Rr.Cs();break;case Xi.ProfileClientResourceUsage:this.vt.ULS.qe(541388952,A.k,P.Info,JSON.stringify(e.Data));break;case Xi.ULSLog:var s=e.Data;if(!s||"number"!=typeof s.Tag||"number"!=typeof s.Category||"number"!=typeof s.Level||"string"!=typeof s.Message)break;try{this.vt.ULS.qe(s.Tag,s.Category,s.Level,s.Message)}catch(e){this.vt.ULS.qe(512235073,A.k,P.Error,"PPTUnifiedSessionLoader::onMessage ULSLog exception: "+e)}}}catch(e){this.vt.ULS.qe(594121922,A.k,P.Error,"PPTUnifiedSessionLoader::onMessage Caught exception: "+e)}var a,u,d},e.prototype.getWopiPendingApplication=function(){return this.oa},e}(),wn=function(){function e(){}return e.prototype.GetVersion=function(){return R()},e.prototype.GetMinContentVersion=function(){return 1},e.prototype.Prefetch=function(){},e.prototype.InitializeWopiPending=function(e,t,i,n,o,r){return new mn(e,t,i,o,r).getWopiPendingApplication()},e}();!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(hn||(hn={})),i.d(t,"Application",(function(){return gn})),i.d(t,"createApplication",(function(){return Sn})),i.d(t,"DocRebootSupportMode",(function(){return hn})),i.d(t,"CommandIds",(function(){return Y})),i.d(t,"EventIds",(function(){return ie})),i.d(t,"createCancellationToken",(function(){return ct}));var gn=new wn,Sn=function(e){var t={name:"PowerPoint",usePreseededSessionId:!0,preconnector:y()};return new qe(e,t,Qi)}}});

"use strict";function getLogger(n,t){var i=new bUlsCache(n,t);return{ULS:{trace:function(n,t,r){return traceTagImpl(i,0,n,t,r)},traceTag:function(n,t,r,u){return traceTagImpl(i,n,t,r,u)},flush:i.flush,flushOnClose:i.flushOnClose}}}function getExperimentLogger(n,t,i,r){var u=new bUlsCache(n,t);return u.configure(i,r),{ULS:{trace:function(n,t,i){return traceTagImpl(u,0,n,t,i)},traceTag:function(n,t,i,r){return traceTagImpl(u,n,t,i,r)},flush:u.flush,flushOnClose:u.flushOnClose}}}function traceTagImpl(n,t,i,r,u){if(!(r>currentLevel)){var f={timestamp:Date.now(),category:i,tag:t,level:r,type:logType.Trace,message:u};n.handleTrace(f)}}function formatForUpload(n,t,i,r){var u=n.map(function(n){return getLogEntryInWireFormat(n,r)}),f=getLogBatchInWireFormat(r,u,t,i);return JSON.stringify(f)}function getLogEntryInWireFormat(n,t){var i={},r;return i.G=n.tag,i.T=n.timestamp-t,i.M=n.message,i.C=n.category,r=n.type*shiftFactory+n.level,i.D=r,i}function getLogBatchInWireFormat(n,t,i,r){var u={};return u.T=n,u.L=t,u.S=i,u.I=r,u.V=1,u}function uploadLogs(n,t,i){if(t!==""){var r=new XMLHttpRequest;(r.readyState===XMLHttpRequest.UNSENT||r.readyState===XMLHttpRequest.DONE)&&(r.open("POST",t,i),r.send(n))}}var logLevel,ULS,currentLevel,bUlsCache,shiftFactory,logCategory,logType,PowerPointOnline;(function(n){n[n.Spam=200]="Spam";n[n.Verbose=100]="Verbose";n[n.Info=50]="Info";n[n.Warning=15]="Warning";n[n.Error=10]="Error"})(logLevel||(logLevel={}));ULS={getLogger:getLogger,getExperimentLogger:getExperimentLogger};currentLevel=logLevel.Info;bUlsCache=function(){function n(n,t){var i=this;this.uploadCadenceInMsSec=3e4;this.uploadTriggerSize=30;this.uploadId=0;this.logCache=[];this.timestampBase=Date.now();this.userSessionId="00000000-0000-0000-0000-000000000000";this.flushOnClose=function(){i.triggerUpload(!1,!1)};this.flush=function(){i.triggerUploadAsync()};this.triggerUploadAsync=function(){window.setTimeout(function(){return i.triggerUpload(!0,!0)},0)};this.triggerUpload=function(n,t){if(window.clearTimeout(i.timeoutId),i.logCache.length>0){i.uploadId+=1;var r=formatForUpload(i.logCache,i.userSessionId,i.uploadId,i.timestampBase);uploadLogs(r,i.remoteUrlEndpoint,t);i.logCache=[];i.timestampBase=Date.now()}n&&(i.timeoutId=window.setTimeout(i.triggerUploadAsync,i.uploadCadenceInMsSec))};this.userSessionId=n;this.remoteUrlEndpoint=t+"?usid="+n;window.setTimeout(function(){return i.triggerUpload(!0,!0)},0)}return n.prototype.configure=function(n,t){this.uploadCadenceInMsSec=n;this.uploadTriggerSize=t},n.prototype.handleTrace=function(t){t.message.length>n.messageMaxChars&&(t.message=t.message.substr(0,n.messageMaxChars-n.trimedMessage.length)+n.trimedMessage);this.logCache.push(t);(this.logCache.length>this.uploadTriggerSize||t.level===logLevel.Error)&&this.triggerUploadAsync()},n.messageMaxChars=3072,n.trimedMessage="... [Trimmed]",n}();shiftFactory=1e3,function(n){n[n.WordViewer=301]="WordViewer";n[n.WopiPendingApplication=379]="WopiPendingApplication";n[n.VisioApp=700]="VisioApp";n[n.PptNavigation=810]="PptNavigation";n[n.PptSession=817]="PptSession";n[n.PptVersionHistory=832]="PptVersionHistory";n[n.PptLive=833]="PptLive"}(logCategory||(logCategory={})),function(n){n[n.Trace=0]="Trace";n[n.Assert=1]="Assert"}(logType||(logType={})),function(n){var t;(function(n){var r=function(){function n(){}return n.prototype.trace=function(n,t,i){this.traceTag(0,n,t,i)},n.prototype.traceTag=function(n,t,i,r){var u=null;switch(i){case logLevel.Verbose:u=console.debug;break;case logLevel.Info:u=console.log;break;case logLevel.Warning:case logLevel.Error:u=console.error;break;default:u=console.error}u(r)},n}(),t,i;n.ConsoleSessionLogger=r;t=function(){function n(n,t){try{this.logger=ULS.getLogger(n,t+"RemoteUls.ashx")}catch(i){}}return n.prototype.trace=function(n,t,i){this.logger!=null&&this.logger.ULS.trace(n,t,i)},n.prototype.traceTag=function(n,t,i,r){this.logger!=null&&this.logger.ULS.traceTag(n,t,i,r)},n.prototype.flush=function(){this.logger!=null&&this.logger.ULS.flush()},n.prototype.flushOnClose=function(){this.logger!=null&&this.logger.ULS.flushOnClose()},n}();n.UlsSessionLogger=t;i=function(){function n(){}return n.init=function(n){this.logger=n},n.trace=function(n,t,i){this.logger!=null&&this.logger.trace(n,t,i)},n.traceTag=function(n,t,i,r){this.logger!=null&&this.logger.traceTag(n,t,i,r)},n}();n.SessionLogger=i})(t=n.Telemetry||(n.Telemetry={}))}(PowerPointOnline||(PowerPointOnline={}));
var healthSmall=function(i){var t={};function n(e){if(t[e])return t[e].exports;var o=t[e]={i:e,l:!1,exports:{}};return i[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=i,n.c=t,n.d=function(i,t,e){n.o(i,t)||Object.defineProperty(i,t,{enumerable:!0,get:e})},n.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,t){if(1&t&&(i=n(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.__esModule)return i;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var o in i)n.d(e,o,function(t){return i[t]}.bind(null,o));return e},n.n=function(i){var t=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(t,"a",t),t},n.o=function(i,t){return Object.prototype.hasOwnProperty.call(i,t)},n.p="",n(n.s=0)}([function(i,t,n){"use strict";function e(i){if(i)return i}function o(i){if(null!=i)return i}function r(i){return null!=i&&i}function s(i){if(i){var t=new Map;return i.forEach((function(i,n){n&&i&&t.set(n,i)})),t}}function u(i){if(i){var t=new Set;return i.forEach((function(i){i&&t.add(i)})),t}}function l(i){if(i)return{durationMs:e(i.durationMs),extendedProperties:s(i.extendedProperties)}}function a(i){if(i){var t={};return i.forEach((function(i,n){n&&(t[n]=i)})),t}}function d(i,t){var n=[],e=new Set;return i.concat(t).forEach((function(i){return e.add(i)})),e.forEach((function(i){return n.push(i)})),n}n.r(t);var c=function(){function i(){var i=this;this._={},this.S=[],this.M={},this.I=0,this.U={H:3e5,O:!1,D:!1,A:3e4,K:25,P:"",T:864e5,F:"",R:"",V:3,W:3,B:15e3,C:new Set},this.L=!1,this.X=0,this.J=!1,this.N=0,this.G=!0,this.Y=function(){return!1},this.Z={},this.$=[],this.ii=0,this.ti=0,this.ni=void 0,this.ei=[],this.oi=[],this.ri=[],this.si=[],this.ui=0,this.li=0,this.ai=0,this.di=[],this.ci=!1,this.fi=0,this.vi=!1,this.hi=function(){i.ui&&(window.clearTimeout(i.ui),i.ui=0)},this.pi=function(){i.$=[],i.ei=[],i.oi=[],i.ni=void 0,i.ri=[],i.si=[],i.ii=0,i.ti=0},this.bi=function(){try{if(i.ii<=0)return;var t=i.mi();i.yi(t,i.I,i.U.W),i.pi()}catch(i){}},this.mi=function(){return{d:i.M,a:i._,b:i.$,e:i.oi,h:i.ni,q:i.ri,k:i.ei,l:i.si,type:"h_v2"}},this.wi=function(t,n,e,o){var r;if(void 0===o&&(o=!1),n&&!i.U.C.has(e))if(i.G){switch(t){case 0:i.$.push(n);break;case 1:i.ei.push(n);break;case 2:i.oi.push(n);break;case 3:-1===i.ri.map((function(i){return i.n})).indexOf(n.n)&&i.ri.push(n);break;case 4:i.si.push(n)}if(i.ii+=1,4!==t&&3!==t&&(i.ti+=1),i.Y()&&!o)return void i.bi();i.ii>=i.U.K&&(i.hi(),i._i())}else n.o=(new Date).toJSON(),null===(r=i.Si)||void 0===r||r.postMessage({t:t,k:i.M.w+"."+i.I,m:i.M,c:i._,v:n})},this.Mi=function(){i.hi(),i.ui=window.setTimeout((function(){i._i()}),i.U.A)},this._i=function(t){void 0===t&&(t=!1),t&&i.ti<=0||(i.bi(),i.Mi())},this.Ii=function(){if(i.di||i.Z){i.ni||(i.ii+=1);var t={p:i.ni?d(i.ni.p,i.di):i.di,k:i.ni?d(i.ni.k,i.S):i.S,i:i.U.H,o:i.X};i.ni=t,i.X=(i.X+1)%1e3}},this.xi=function(t,n,e,o,r,s,u,l,d,c){if(!n||i.Z[t]){n||i.Ui(t,l,d,c);var f=i.Z[t],v={n:f.k,e:e,t:f.t,a:f.a,f:f.o,d:null==o?void 0:o.durationMs,p:a(null==o?void 0:o.extendedProperties)};if(r){var h={n:r,x:u,z:s};v.k=h}i.wi(1,v,t)}},this.gi=function(){var t=i.U.M;t&&(i.M={a:t.application,b:t.applicationLcid,c:t.applicationMode,d:t.applicationModeExtended,e:t.arrVersion,f:t.browser,g:t.browserLcid,h:t.browserMajorVersion,i:t.browserVersion,j:t.clientVersion,k:t.datacenter,l:t.dataCulture,m:t.flightsImpressionId,n:t.host,o:t.isAnonymousUser,p:t.isBusinessUser,q:t.isEduUser,r:t.isSynthetic,s:t.loggableUserId,t:t.loggableUserIdSpace,u:t.ring,v:t.serverDocId,w:t.session_id,x:t.sessionOrigin,y:t.tenantId,z:t.uiHost,aa:t.wfeVersion,ab:t.fileExtension,ac:t.uiHostIntegrationType,ad:t.osVersion})},this.Hi=function(){i.Ii(),i.N=window.setTimeout((function(){i.Hi()}),i.U.H)},this.Oi=function(){i.di&&i.di.forEach((function(t){t&&i.ki(t,!0)}))},this.ki=function(t,n){var e={};e.n=t,i.wi(3,e,t,n)},this.Ei=function(){i.di&&(i.li=Date.now(),i.Oi()),i.ji()},this.ji=function(t){void 0===t&&(t=i.U.T),i.ai=window.setTimeout((function(){i.Ei()}),t)},this.Di=function(){i.L||(i.L=!0,i.J=!0,i.Hi())},this.Ai=function(){0!==i.ai&&(window.clearTimeout(i.ai),i.ai=0)},this.Ki=function(){if(i.U.O&&i.U.D&&i.U.R&&""!==i.U.R&&i.U.P&&""!==i.U.P)try{if("undefined"==typeof Worker)return void i.Pi(1);if(!i.U.P)return void i.Pi(2);i.Pi(3);var t=new Blob(["try{importScripts('"+encodeURI(i.U.P)+"');}catch(e){self.postMessage({i:14,l:'W',c:e})}"],{type:"application/javascript"});i.Si=new Worker(URL.createObjectURL(t)),i.Si.onmessage=function(t){try{var n=t.data;i.Pi(n.i,n.r)}catch(t){i.Pi(5,t)}},i.Si.postMessage({t:5,v:i.U.R}),i.Si.postMessage({t:6})}catch(t){i.Pi(6,t)}},this.Ti=function(t,n){var e;(t.b.length>0||t.e.length>0||t.q.length>0||t.k.length>0||t.l.length>0)&&(null===(e=i.Si)||void 0===e||e.postMessage({t:7,k:t.d.w+"."+n,v:t}))},this.Ui=function(t,n,e,o){t&&void 0!==n&&(i.Z[t]||(i.Z[t]={k:t,t:n,a:!0===e,o:o},e&&(i.S.push(t),i.Ii())))},this.Fi=function(t){i.X=0,t?(i.li=Date.now(),i.ji(),i.Di()):i.Ii()},this.Qi=function(t){return!!i.vi||(i.Pi(0,null==t?void 0:t.toString()),!1)},this.yi=function(t,n,e){if(t){var o=i.U.F;if(i.ci&&(e<=0||!i.G))i.Ti(t,n);else if(!(e<=0)){if(i.Y())try{if(void 0!==navigator.sendBeacon)return void navigator.sendBeacon(o,(r=t,JSON.stringify(r)))}catch(i){}var r,s=new XMLHttpRequest;s.open("POST",o,!0),t.d.w&&s.setRequestHeader("X-UserSessionId",t.d.w),s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(200===s.status?i.ci||(i.ci=!0):i.fi<i.U.V?(i.fi+=1,window.setTimeout((function(){i.fi-=1,i.yi(t,n,e-1)}),i.U.B)):i.ci&&i.Ti(t,n))},s.send(JSON.stringify(t))}}},this.Pi=function(t,n){var e={i:t,r:n};i.wi(4,e,t.toString())}}return i.getInstance=function(){return i.Ri||(i.Ri=new i),this.Ri},i.prototype.initialize=function(i){if(i)try{return this.U=function(i){var t,n,e,o,r,s,u,l,a,d,c;return{M:i.dimensions,H:null!==(t=i.heartbeatIntervalMs)&&void 0!==t?t:3e5,O:i.isHealthEnabled,D:i.isOfflineEnabled,A:null!==(n=i.maxIntervalMs)&&void 0!==n?n:3e4,K:null!==(e=i.maxQueueSize)&&void 0!==e?e:25,P:null!==(o=i.offlineWorkerUrl)&&void 0!==o?o:"",R:null!==(r=i.absoluteTelemetryUrl)&&void 0!==r?r:"",T:null!==(s=i.pillarIntervalMs)&&void 0!==s?s:864e5,F:null!==(u=i.telemetryUrl)&&void 0!==u?u:"",V:null!==(l=i.maxConcurrentRetries)&&void 0!==l?l:3,W:null!==(a=i.retryMaxAttempts)&&void 0!==a?a:3,B:null!==(d=i.retryDelayMs)&&void 0!==d?d:15e3,C:null!==(c=i.disabledHealthEvents)&&void 0!==c?c:new Set}}(i),this.gi(),this.Mi(),this.Ki(),this.vi=!0,void this.Pi(7)}catch(i){}this.vi=!1},i.prototype.addOrUpdatePartCDimension=function(i,t){this.Qi(0)&&i&&(this._.hasOwnProperty(i)&&this._[i]===t||(this._i(!0),this._[i]=t,this.I+=1,this.Ii(),this.Oi()))},i.prototype.addQosPillar=function(i){if(i){var t=0===this.di.length;-1===this.di.indexOf(i)&&(this.di.push(i),this.ki(i,!1),this.Fi(t))}},i.prototype.recordBsqmQosError=function(i,t,n){if(this.Qi(1)&&(this.stopAllHealthTimers(),this.Oi(),i)){var e={b:i,v:t,d:null==n?void 0:n.durationMs,p:a(null==n?void 0:n.extendedProperties),s:this.di};this.wi(0,e,i),this.shutdown()}},i.prototype.recordKpiFailure=function(i,t,n,e,o){this.xi(i,!0,0,o,t,e,n)},i.prototype.recordKpiImpliedFailure=function(i,t,n,e,o,r){this.xi(i,!1,1,r,t,e,n,0,!1,o)},i.prototype.recordKpiImpliedSuccess=function(i,t,n){this.xi(i,!1,2,n,void 0,void 0,void 0,0,!1,t)},i.prototype.recordKpiSuccess=function(i,t){this.xi(i,!0,3,t)},i.prototype.recordKpiUsage=function(i,t,n,e){this.xi(i,!1,4,{extendedProperties:e},void 0,void 0,void 0,t,!1,n)},i.prototype.recordKpiUsageForAlertableKpi=function(i,t,n){var e=!0,o=this.Z[i];o&&(e=0===o.t),this.xi(i,!1,4,{extendedProperties:n},void 0,void 0,void 0,0,!0,t),e&&this.Di()},i.prototype.recordQosError=function(i,t,n,e,o,r,s){if((!r||this.Qi(2))&&i&&t){var u={n:i,x:n,z:e,l:o,v:t,e:r,d:null==s?void 0:s.durationMs,p:a(null==s?void 0:s.extendedProperties),s:this.di};this.wi(2,u,i),r&&(this.stopAllHealthTimers(),this.Oi(),this.shutdown())}},i.prototype.removeQosPillar=function(i){var t=this.di.indexOf(i);t>-1&&(this.di.splice(t,1),this.Fi(!1)),0===this.di.length&&this.Ai()},i.prototype.resumeAllHealthTimers=function(){if(this.L&&!this.J&&this.Hi(),0===this.ai&&0!==this.li){var i=Date.now()-this.li;i>=this.U.T||i<=0?this.Ei():this.ji(this.U.T-i)}},i.prototype.setHandlerForIsAppShuttingDown=function(i){i&&(this.Y=i)},i.prototype.setIsAppOnline=function(i){var t;this.Qi(3)&&(!this.G&&i&&(null===(t=this.Si)||void 0===t||t.postMessage({t:6})),this.G=i)},i.prototype.shutdown=function(){var i;this.U.O&&(this.hi(),this.stopAllHealthTimers(),this.Y=function(){return!0},this.bi(),null===(i=this.Si)||void 0===i||i.terminate())},i.prototype.stopAllHealthTimers=function(){this.J=!1,this.X=0,0!==this.N&&(window.clearTimeout(this.N),this.N=0),this.Ai()},i.prototype.updatePartADimensions=function(i){var t=this;if(this.Qi(4)){var n=!1;Object.keys(i).forEach((function(e){void 0!==i[e]&&null!==i[e]&&""!==i[e]&&t.U.M[e]!==i[e]&&(t.U.M[e]=i[e],n=!0)})),n&&(this._i(),this.gi(),this.I+=1,this.Ii(),this.Oi())}},i}();function f(i,t){i&&t&&c.getInstance().addOrUpdatePartCDimension(i,t)}function v(i){i&&c.getInstance().addQosPillar(i)}function h(i,t,n){i&&c.getInstance().recordBsqmQosError(i,function(i){if(i){var t=[];return i.forEach((function(i){i&&t.push(i)})),t}}(t),l(n))}function p(i,t,n,o,r){i&&c.getInstance().recordKpiFailure(i,e(t),n,o,l(r))}function b(i,t,n,o,r,s){i&&c.getInstance().recordKpiImpliedFailure(i,e(t),n,o,e(r),l(s))}function m(i,t,n){i&&c.getInstance().recordKpiImpliedSuccess(i,e(t),l(n))}function y(i,t){i&&c.getInstance().recordKpiSuccess(i,l(t))}function w(i,t,n,o){i&&c.getInstance().recordKpiUsage(i,function(i){return i===k.FailureBased?0:1}(t),e(n),s(o))}function _(i,t,n){i&&c.getInstance().recordKpiUsageForAlertableKpi(i,e(t),s(n))}function S(i,t,n,e,o,r,s){i&&t&&c.getInstance().recordQosError(i,function(i){if(!i)return[];var t=[];return i.forEach((function(i){i&&t.push(i)})),t}(t),n,e,o,r,l(s))}function M(i){i&&c.getInstance().removeQosPillar(i)}function I(){c.getInstance().resumeAllHealthTimers()}function x(i){i&&c.getInstance().setHandlerForIsAppShuttingDown(i)}function U(i){c.getInstance().setIsAppOnline(i)}function g(){c.getInstance().shutdown()}function H(){c.getInstance().stopAllHealthTimers()}function O(i){c.getInstance().updatePartADimensions(e(i))}var k,E=function(){function i(){}return i.prototype.getHealthInstance=function(i){var t=function(i){var t,n,s,l,a,d,c,f,v,h,p,b,m,y,w,_,S,M,I,x,U,g,H,O,k,E,j,D,A,K;if(i)return{absoluteTelemetryUrl:e(i.absoluteRemoteTelemetryUrlForOfflineWorker),dimensions:{application:e(null===(t=i.dimensions)||void 0===t?void 0:t.application),applicationLcid:e(null===(n=i.dimensions)||void 0===n?void 0:n.applicationLcid),applicationMode:e(null===(s=i.dimensions)||void 0===s?void 0:s.applicationMode),applicationModeExtended:e(null===(l=i.dimensions)||void 0===l?void 0:l.applicationModeExtended),arrVersion:e(null===(a=i.dimensions)||void 0===a?void 0:a.arrVersion),browser:e(null===(d=i.dimensions)||void 0===d?void 0:d.browser),browserLcid:e(null===(c=i.dimensions)||void 0===c?void 0:c.browserLcid),browserMajorVersion:e(null===(f=i.dimensions)||void 0===f?void 0:f.browserMajorVersion),browserVersion:e(null===(v=i.dimensions)||void 0===v?void 0:v.browserVersion),clientVersion:e(null===(h=i.dimensions)||void 0===h?void 0:h.clientVersion),datacenter:e(null===(p=i.dimensions)||void 0===p?void 0:p.datacenter),dataCulture:e(null===(b=i.dimensions)||void 0===b?void 0:b.dataCulture),flightsImpressionId:e(null===(m=i.dimensions)||void 0===m?void 0:m.flightsImpressionId),host:e(null===(y=i.dimensions)||void 0===y?void 0:y.host),isAnonymousUser:o(null===(w=i.dimensions)||void 0===w?void 0:w.isAnonymousUser),isBusinessUser:o(null===(_=i.dimensions)||void 0===_?void 0:_.isBusinessUser),isEduUser:o(null===(S=i.dimensions)||void 0===S?void 0:S.isEduUser),isSynthetic:o(null===(M=i.dimensions)||void 0===M?void 0:M.isSynthetic),loggableUserId:e(null===(I=i.dimensions)||void 0===I?void 0:I.loggableUserId),loggableUserIdSpace:e(null===(x=i.dimensions)||void 0===x?void 0:x.loggableUserIdSpace),ring:e(null===(U=i.dimensions)||void 0===U?void 0:U.ring),serverDocId:e(null===(g=i.dimensions)||void 0===g?void 0:g.serverDocId),session_id:e(null===(H=i.dimensions)||void 0===H?void 0:H.session_id),sessionOrigin:e(null===(O=i.dimensions)||void 0===O?void 0:O.sessionOrigin),tenantId:e(null===(k=i.dimensions)||void 0===k?void 0:k.tenantId),uiHost:e(null===(E=i.dimensions)||void 0===E?void 0:E.uiHost),wfeVersion:e(null===(j=i.dimensions)||void 0===j?void 0:j.wfeVersion),fileExtension:e(null===(D=i.dimensions)||void 0===D?void 0:D.fileExtension),uiHostIntegrationType:e(null===(A=i.dimensions)||void 0===A?void 0:A.uiHostIntegrationType),osVersion:e(null===(K=i.dimensions)||void 0===K?void 0:K.osVersion)},disabledHealthEvents:u(i.disabledHealthEvents),heartbeatIntervalMs:e(i.heartbeatIntervalMs),isHealthEnabled:r(i.isHealthEnabled),isOfflineEnabled:r(i.isOfflineEnabled),maxConcurrentRetries:e(i.maxConcurrentRetries),maxIntervalMs:e(i.loggerMaxIntervalMs),maxQueueSize:e(i.loggerMaxQueueSize),offlineWorkerUrl:e(i.offlineWorkerUrl),pillarIntervalMs:e(i.recordPillarToWarmPipelineIntervalMs),retryDelayMs:e(i.retryDelayMs),retryMaxAttempts:e(i.retryMaxAttempts),telemetryUrl:e(i.remoteTelemetryUrl)}}(i);if(t)return c.getInstance().initialize(t),{addOrUpdatePartCDimension:f,addQosPillar:v,recordBsqmQosError:h,recordKpiFailure:p,recordKpiImpliedFailure:b,recordKpiImpliedSuccess:m,recordKpiSuccess:y,recordKpiUsage:w,recordKpiUsageForAlertableKpi:_,recordQosError:S,removeQosPillar:M,resumeAllHealthTimers:I,setHandlerForIsAppShuttingDown:x,setIsAppOnline:U,shutdown:g,stopAllHealthTimers:H,updatePartADimensions:O}},i}();!function(i){i[i.FailureBased=0]="FailureBased",i[i.SuccessBased=1]="SuccessBased"}(k||(k={}));var j=new E;n.d(t,"KpiTypeSS",(function(){return k})),n.d(t,"HealthFactorySSGlobal",(function(){return j})),n.d(t,"Health",(function(){return c})),n.d(t,"HealthFactorySS",(function(){return E}))}]);
//# sourceMappingURL=healthSmall.min.js.map
"use strict";function createPODSRegion(n,t,i,r){return t===void 0&&(t="https://c1-powerpoint-15.cdn.office.net/pods/s/"),i===void 0&&(i="5"),r===void 0&&(r=!1),{PodsURL:n,WacCdnStaticServer:t,PreviewerRolloutRing:i,IsGoLocalRoutedToPublic:r}}function createSNAPRegion(n,t,i,r){return t===void 0&&(t="5"),i===void 0&&(i=0),r===void 0&&(r=!1),{SnapURL:n,PreviewerRolloutRing:t,RolloutPercentage:i,IsGoLocalRoutedToPublic:r}}function createUseSnapDetails(n,t){return{UseSnap:n,Reason:t}}function createUsePODSDetails(n,t,i){return{ShouldUsePODS:n,CanUsePODS:t,Reason:i}}function tryReadBoolDefaultTrue(n){return n!=undefined?n:!0}var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Configuration=function(){function n(){}return n.HostCallbackTimeout=6e4,n}(),BuildVersionConfig=function(){function n(){}return Object.defineProperty(n,"BUILD_NUMBER",{get:function(){return"16.0.16311.40509"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"BUILD_NUMBER_MINOR",{get:function(){return 1631140509},enumerable:!1,configurable:!0}),Object.defineProperty(n,"BUILD_CDN_NUMBER",{get:function(){return"161631140509"},enumerable:!1,configurable:!0}),n}(),ApplicationErrorMap=function(){function n(){}return n.convertServerErrorToAppErrorCode=function(n,t){var i=n;n.indexOf("Server")==0&&(i=n.slice(6).trim());switch(i){case"ErrorWorkerCannotOpenDocument":return 5308422;case"ErrorWorkerCannotOpenDocumentFileType":return 5341186;case"ErrorWorkerCannotOpenDocumentIRM":case"ErrorFileDownloadNotSupportedFileType":return 5341187;case"ErrorWorkerCannotOpenDocumentPassword":return 5341188;case"ErrorCannotInstallFonts":return 5341190;case"ErrorCannotRender":return 5341281;case"ErrorWorkerCannotOpenDocumentMacro":return 5341217;case"ErrorWorkerCannotOpenDocumentSigned":return 5341219;case"ErrorWorkerCannotOpenDocumentWrongExt":return 5341260;case"ErrorWorkerCannotOpenDocumentStgDocFileCorrupt":return 5341261;case"ErrorWorkerCannotOpenDocumentMmcfPackagePartNotFound":return 5341263;case"ErrorWorkerCannotOpenDocumentArchiveError":return 5341264;case"ErrorWorkerCannotOpenDocumentTooLarge":return 5341301;case"ErrorFileDownloadZeroByteFile":return 5341338;case"ErrorFileNotFound":return 5341412;case"Unauthorized":case"ErrorFileDownloadStatusCodeUnauthorized":return 5341414;case"ErrorFileDownloadStatusCodeForbidden":return 5341415;case"ErrorFileDownloadStatusCodeNotFound":return 5341417;case"ErrorFileDownloadFailed":return 5341421;case"ErrorFileDownloadStatusCodeTooManyRequests":return 5341437;case"ErrorCannotOpenFileMetroFileCorruption":return 5341440;case"ErrorFileDownloadTimedOut":return 5341460;case"GetItemsFailedDownloadFile":return 5341461;case"Failed to fetch":case"ErrorFailedToFetch":return 5341599;case"ErrorRESERVEDItemFailed":return 5341600;case"ErrorRequestTimeout":return 5341601;case"ErrorFileDownloadResourceInconsistent":return 5341602;case"ErrorGeneralUnknown":return 5341603;case"ErrorRequestFailed":return 5341610;case"ErrorWorkerExceedLimit":return 5341612;case"ErrorConnectionLost":return 5341613;case"ErrorFileDownloadNetworkError":return 5341614;case"ErrorWorkerCannotOpenDocumentStgFileAlreadyExists":return 5341615;case"ErrorInvalidItem":return 5341617;case"ResourceLoaderFailed":return 5341618;case"ErrorFileDownloadFailedToParseEndOfCentralDirectory":return 5341619;case"ErrorWorkerFailed":return 5373969;default:return t&&t.ULS.traceTag(557417609,logCategory.PptSession,logLevel.Warning,"Bootstrapper::convertToAppErrorCode: "+i+" is converted to 5001"),5001}},n.ModernBootStageToTimeoutErrorNameMap={SlideShowAppStart:{errorName:"BootTimeoutAtSlideShowAppStart",errorCode:51},GetItemsCall:{errorName:"BootTimeoutAtGetItemsCall",errorCode:52},DownloadResponseStream:{errorName:"BootTimeoutAtDownloadResponseStream",errorCode:53},ParseMultipartResponse:{errorName:"BootTimeoutAtParseMultipartResponse",errorCode:54},InitViewController:{errorName:"BootTimeoutAtInitViewController",errorCode:55},GotoTargetSlide:{errorName:"BootTimeoutAtGotoTargetSlide",errorCode:56},RenderingTransition:{errorName:"BootTimeoutAtRenderingTransition",errorCode:57},RenderingSlide:{errorName:"BootTimeoutAtRenderingSlide",errorCode:58},FlushingShaders:{errorName:"BootTimeoutAtFlushingShaders",errorCode:59},PreparingSBItems:{errorName:"BootTimeoutAtPreparingSBItems",errorCode:60},SwitchingToSVG:{errorName:"BootTimeoutAtSwitchingToSVG",errorCode:61},FinishingHandshake:{errorName:"BootTimeoutAtFinishingHandshake",errorCode:63},ReEnsureTextureLoaded:{errorName:"BootTimeoutAtReEnsureTextureLoaded",errorCode:62}},n}(),BrowserUtils=function(){function n(){}return n.devicePixelRatio=function(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1},n.isSafari=function(){var n=window.navigator.userAgent.toLowerCase();return n.indexOf(" applewebkit/")>-1&&n.indexOf("version/")>-1&&n.indexOf("edge/")<0},n.isBrowserSupportedForModernSlideShow=function(t,i,r){var e,o,f,a,s,h,c,u,l;try{if(e=window.navigator.userAgent.toLowerCase(),e==null)return t&&t.ULS.traceTag(558438435,logCategory.PptSession,logLevel.Error,"IsBrowserSupportedForModernSlideShow: userAgent is null, defaulting to false"),!1;if(e.indexOf("trident/")>=0||e.indexOf("msie/")>=0)return t&&t.ULS.traceTag(558438464,logCategory.PptSession,logLevel.Info,"IsBrowserSupportedForModernSlideShow IE"),!1;if(o=!1,f=n.getBrowserInfo(),r){for(a=r.split(";"),s=0,h=a;s<h.length;s++)if(c=h[s],c.split(":")[0].toLowerCase()==f.name.toLowerCase()&&parseInt(f.version,10)<parseInt(c.split(":")[1],10)){o=!0;break}}else t===null||t===void 0?void 0:t.ULS.traceTag(558438465,logCategory.PptSession,logLevel.Info,"pptFeatureGates.modernSlideShowBlockListForBrowserVersion undefined or null");return u="Unknown OS",navigator.userAgent.indexOf("Win")!=-1&&(u="Windows"),navigator.userAgent.indexOf("Mac")!=-1&&(u="Macintosh"),navigator.userAgent.indexOf("Linux")!=-1&&(u="Linux"),navigator.userAgent.indexOf("Android")!=-1&&(u="Android"),navigator.userAgent.indexOf("like Mac")!=-1&&(u="iOS"),l=i?i.indexOf(u)>=0:!1,t&&t.ULS.traceTag(558438466,logCategory.PptSession,logLevel.Info,"IsBrowserSupportedForModernSlideShow Name "+f.name+", Version "+f.version+", OSName "+u+", BlockedBrowser "+o+", BlockedOS "+l),!l&&!o}catch(v){return t===null||t===void 0?void 0:t.ULS.traceTag(558438467,logCategory.PptSession,logLevel.Error,"Unexpected exception in ModernSlideShowEnabledHelper: "+v),!1}},n.getBrowserInfo=function(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:t[1]||""}):n[1]==="Chrome"&&(t=i.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?{name:t[1].replace("OPR","Opera"),version:t[2]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})},n.isBrowserShapeBuilderCompatible=function(t,i,r){var c,l,f,b,o,a,v,e,u,p,s,tt,h,w,it;try{if(c=!1,l="PowerVR Rogue GX6250;SwiftShader",r){for(f=n.getBrowserInfo(),b=r.split(";"),o=0,a=b;o<a.length;o++)if(v=a[o],v.split(":")[0].toLowerCase()==f.name.toLowerCase()&&parseInt(f.version,10)<parseInt(v.split(":")[1],10))return c=!0,i&&i.ULS.traceTag(554505223,logCategory.PptSession,logLevel.Info,"IsBrowserModernWebGLCompatible Name "+f.name+", Version "+f.version+", FakkbackBrowser "+c),!1}else i&&i.ULS.traceTag(554505224,logCategory.PptSession,logLevel.Info,"pptFeatureGates.modernWebGLBlockListForBrowserVersion undefined or null");if(e=document.createElement("canvas"),e.addEventListener("webglcontextcreationerror",function(n){return t.webglcontextcreationerror=""+(n.statusMessage||"Unknown error")}),u=e.getContext("webgl"),u==null&&(u=e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0}),t.WebGLExperimental=!0),u==null)return t.GLIncompatible="CanvasRenderingContext",u=e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!1}),u!=null&&(t.WebGLExperimentalWithPerfCaveat=!0),!1;if(!u.getExtension("EXT_blend_minmax"))return t.GLIncompatible="MinMax",!1;if(!u.getExtension("ANGLE_instanced_arrays"))return t.GLIncompatible="Instancing",!1;var k=u.getParameter(u.MAX_VERTEX_ATTRIBS),rt=u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS),d=u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=u.getParameter(u.MAX_VARYING_VECTORS),nt=u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS),ut=u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS),y=u.getParameter(u.MAX_TEXTURE_SIZE);if(y<4096)return t.GLIncompatible="TextureSize",!1;t.VERTEX_ATTRIBS=k;t.VERTEX_UNIFORM_VECTORS=rt;t.VERTEX_TEXTURE_IMAGE_UNITS=d;t.VARYING_VECTORS=g;t.FRAGMENT_UNIFORM_VECTORS=nt;t.TEXTURE_IMAGE_UNITS=ut;t.TEXTURE_SIZE=y;try{if(p=u.getExtension("WEBGL_debug_renderer_info"),p)if(s={},s.WebGLRenderer=u.getParameter(p.UNMASKED_RENDERER_WEBGL),l){for(tt=l.split(";"),h=0,w=tt;h<w.length;h++)if(it=w[h],s.WebGLRenderer.toLowerCase().indexOf(it.toLowerCase())>=0)return i&&i.ULS.traceTag(558438468,logCategory.PptSession,logLevel.Info,"isBrowserShapeBuilderCompatible - Unsupported GPU Renderer: "+s.WebGLRenderer),t.GLIncompatible="UnsupportedGPURenderer",!1}else i&&i.ULS.traceTag(512558470,logCategory.PptSession,logLevel.Info,"pptFeatureGates.modernWebGLBlockListForGPURenderer undefined or null")}catch(ft){}return k<16||d<4||g<8||nt<64||y<4096?(t.GLIncompatible="InsufficientCapabilities",i&&i.ULS.traceTag(546182111,logCategory.PptSession,logLevel.Info,"isBrowserShapeBuilderCompatible is true"),!1):!0}catch(et){return t.GLIncompatible="Exception",!1}finally{t&&Object.keys(t).length>0&&i&&i.ULS.traceTag(588105736,logCategory.PptSession,logLevel.Info,JSON.stringify(t))}},n}(),HTMLHelper=function(){function n(){}return n.toPx=function(n){return isNaN(n)?"":n.toString()+"px"},n.floatToPercent=function(n){return(n*100).toString()+"%"},n.isInDomTree=function(n){return!n||!n.parentNode?!1:n.id?!!document.getElementById(n.id):n.isConnected!==undefined?n.isConnected:document.body.contains(n)},n}(),DocRebootSupportMode,MathHelper,ConditionalAction,PPTPreviewerBootstrapper,PptSessionBootStatus,PresentationUrlGuaranteeLevel,PPTPreviewerGetPptFileData,PPTBootstrapSettings;(function(n){n[n.NotSupported=0]="NotSupported";n[n.SameDocOnly=1]="SameDocOnly";n[n.AnyDoc=2]="AnyDoc"})(DocRebootSupportMode||(DocRebootSupportMode={}));MathHelper=function(){function n(){}return n.hash=function(n){for(var t=0,i=0;i<n.length;i+=1)t=(t<<5)-t+n.charCodeAt(i),t=t&t;return t},n}();var PodsRegionInfo=function(){function n(){}return n.getWacToPodsUnifiedMap=function(){var n={};return n[this.ffcUrl]=createPODSRegion(this.ffcUrl+this.pods,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),n[this.ppcUrl]=createPODSRegion(this.ppcUrl+this.pods,"https://c4-powerpoint-15.cdn.office.net/pods/s/"),n[this.prodUrl]=createPODSRegion(this.prodUrl+this.pods),n[this.uscUrl]=createPODSRegion(this.uscUrl+this.pods),n[this.eucUrl]=createPODSRegion(this.eucUrl+this.pods),n[this.cacUrl]=createPODSRegion(this.cacUrl+this.pods),n[this.ukcUrl]=createPODSRegion(this.ukcUrl+this.pods),n[this.aucUrl]=createPODSRegion(this.aucUrl+this.pods),n[this.jpcUrl]=createPODSRegion(this.jpcUrl+this.pods),n[this.incUrl]=createPODSRegion(this.incUrl+this.pods),n[this.krcUrl]=createPODSRegion(this.krcUrl+this.pods),n[this.frcUrl]=createPODSRegion(this.frcUrl+this.pods),n[this.sgcUrl]=createPODSRegion(this.sgcUrl+this.pods),n[this.zacUrl]=createPODSRegion(this.zacUrl+this.pods),n[this.aecUrl]=createPODSRegion(this.aecUrl+this.pods),n[this.decUrl]=createPODSRegion(this.decUrl+this.pods),n[this.chcUrl]=createPODSRegion(this.chcUrl+this.pods),n[this.nocUrl]=createPODSRegion(this.nocUrl+this.pods),n[this.secUrl]=createPODSRegion(this.secUrl+this.pods),n[this.qtcUrl]=createPODSRegion(this.qtcUrl+this.pods),n[this.brcUrl]=createPODSRegion(this.brcUrl+this.pods),n[this.eurppcUrl]=createPODSRegion(this.eucUrl+this.pods),n[this.blackforestUrl]=createPODSRegion(this.blackforestUrl+this.pods,"https://powerpoint.cdn.office.de/pods/s/"),n[this.gallatinUrl]=createPODSRegion(this.gallatinUrl+this.pods,"https://cdn.partner.officewebapps.cn/pods/s/"),n[this.usGovUrl]=createPODSRegion(this.usGovUrl+this.pods,"https://powerpoint.cdn.office365.us/pods/s/"),n[this.gbcUrl]=createPODSRegion(this.gbcUrl+this.pods,"https://powerpoint.cdn.office365.us/pods/s/"),n[this.usDoDUrl]=createPODSRegion(this.usDoDUrl+this.pods,"https://powerpoint.dod.cdn.office365.us/pods/s/"),n},n.getWacToPodsPreviewerMap=function(){var t={};return t[this.ffcUrl]=this.ShouldRerouteEdogToProd?createPODSRegion(this.https+"usc"+n.hostOSIPodsService,"https://c4-powerpoint-15.cdn.office.net/pods/s/"):createPODSRegion(this.https+"pods.edog.officeapps.live.com/","https://c5-powerpoint-15.cdn.office.net/pods/s/","1"),t[this.ppcUrl]=createPODSRegion(this.https+"msit"+n.hostOSIPodsService,"https://c4-powerpoint-15.cdn.office.net/pods/s/","2"),t[this.prodUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.uscUrl]=createPODSRegion(this.https+"usc"+n.hostOSIPodsService),t[this.brcUrl]=createPODSRegion(this.https+"brc"+n.hostOSIPodsService),t[this.eucUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.cacUrl]=createPODSRegion(this.https+"canc"+n.hostOSIPodsService),t[this.ukcUrl]=createPODSRegion(this.https+"ukc"+n.hostOSIPodsService),t[this.aucUrl]=createPODSRegion(this.https+"ausc"+n.hostOSIPodsService),t[this.jpcUrl]=createPODSRegion(this.https+"jpc"+n.hostOSIPodsService),t[this.incUrl]=createPODSRegion(this.https+"inc"+n.hostOSIPodsService),t[this.krcUrl]=createPODSRegion(this.https+"krc"+n.hostOSIPodsService),t[this.frcUrl]=createPODSRegion(this.https+"frc"+n.hostOSIPodsService),t[this.sgcUrl]=createPODSRegion(this.https+"sgc"+n.hostOSIPodsService),t[this.eurppcUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.usGovUrl]=createPODSRegion(this.https+"pods.osi.office365.us/","https://powerpoint.cdn.office365.us/pods/s/","6"),t[this.gbcUrl]=createPODSRegion(this.https+"pods.osi.office365.us/","https://powerpoint.cdn.office365.us/pods/s/","6"),t[this.usDoDUrl]=createPODSRegion(this.https+"pods.osi.apps.mil/","https://powerpoint.dod.cdn.office365.us/pods/s/","6"),t[this.airGap08Url]=createPODSRegion(this.https+"pods.osi.eaglex.ic.gov/","https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/","7"),t[this.airGap09Url]=createPODSRegion(this.https+"pods.osi.microsoft.scloud/","https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/","7"),t.edog=createPODSRegion(this.https+"pods.edog.officeapps.live.com/","https://c5-powerpoint-15.cdn.office.net/pods/s/","1"),t[this.zacUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.zacUrl].IsGoLocalRoutedToPublic=!0,t[this.aecUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.aecUrl].IsGoLocalRoutedToPublic=!0,t[this.qtcUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.qtcUrl].IsGoLocalRoutedToPublic=!0,t[this.decUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.decUrl].IsGoLocalRoutedToPublic=!0,t[this.chcUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.chcUrl].IsGoLocalRoutedToPublic=!0,t[this.nocUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.nocUrl].IsGoLocalRoutedToPublic=!0,t[this.secUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.secUrl].IsGoLocalRoutedToPublic=!0,t},n.shouldRouteToEdog=function(n,t,i){return!t||!t.SessionInformation||i=="6"?!1:t.SessionInformation.UiHostRing&&this.TeamsRingsInEdog.indexOf(t.SessionInformation.UiHostRing.toLowerCase())>=0?!0:this.HostsWithFFInEdog.indexOf(t.SessionInformation.HostName)>=0&&n===this.ffcUrl?!0:!1},n.tryGetPodsRegion=function(n,t,i){var u=n.substring(0,n.indexOf("/p/")),r;return i?this.WacToPodsUnifiedMap[u.toLowerCase()]:(r=this.WacToPodsPreviewerMap[u.toLowerCase()],r&&this.shouldRouteToEdog(u.toLowerCase(),t,r.PreviewerRolloutRing)&&(r=this.WacToPodsPreviewerMap.edog),r)?r:this.RouteToWacPodsRegion(u)},n.GetDefaultProdRegion=function(){return this.WacToPodsPreviewerMap[this.prodUrl]},n.RouteToWacPodsRegion=function(n){return this.WacToPodsUnifiedMap[n.toLowerCase()]},n.getPodsRing=function(n){if(n.ApplicationUrl){var t=this.tryGetPodsRegion(n.ApplicationUrl,n,!1);return t&&t.PreviewerRolloutRing?t.PreviewerRolloutRing:"-4"}return"-4"},n.getWACRegion=function(n){return n?n.substring(0,n.indexOf("/p/")).toLowerCase():""},n.getFileHost=function(n){if(!n)return"";if(n.Diagnostics&&n.Diagnostics.fileHost)return n.Diagnostics.fileHost;if(n.SessionInformation&&n.SessionInformation.HostName){var t=n.SessionInformation.HostName;switch(t){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return t}}return""},n.getUiHost=function(n){if(!n)return"";switch(n){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return n;default:return""}},n.ShouldRerouteEdogToProd=window.location.search.indexOf("wdTestPreviewerInEdog")>=0?!1:!0,n.HostsWithFFInEdog=["TeamsiOS"],n.TeamsRingsInEdog=["ring0","ring0_s"],n.https="https://",n.pods="/pods/",n.hostWAC="-powerpoint.officeapps.live.com",n.hostOSIPodsService=".pods.officeapps.live.com/",n.ffcUrl=n.https+"ffc"+n.hostWAC,n.ppcUrl=n.https+"ppc"+n.hostWAC,n.uscUrl=n.https+"usc"+n.hostWAC,n.eucUrl=n.https+"euc"+n.hostWAC,n.eurppcUrl=n.https+"eurppc"+n.hostWAC,n.cacUrl=n.https+"cac"+n.hostWAC,n.ukcUrl=n.https+"ukc"+n.hostWAC,n.aucUrl=n.https+"auc"+n.hostWAC,n.jpcUrl=n.https+"jpc"+n.hostWAC,n.incUrl=n.https+"inc"+n.hostWAC,n.krcUrl=n.https+"krc"+n.hostWAC,n.frcUrl=n.https+"frc"+n.hostWAC,n.sgcUrl=n.https+"sgc"+n.hostWAC,n.zacUrl=n.https+"zac"+n.hostWAC,n.aecUrl=n.https+"aec"+n.hostWAC,n.gbcUrl=n.https+"gbc"+n.hostWAC,n.decUrl=n.https+"dec"+n.hostWAC,n.chcUrl=n.https+"chc"+n.hostWAC,n.nocUrl=n.https+"noc"+n.hostWAC,n.secUrl=n.https+"sec"+n.hostWAC,n.qtcUrl=n.https+"qtc"+n.hostWAC,n.brcUrl=n.https+"brc"+n.hostWAC,n.blackforestUrl=n.https+"powerpoint.online.office.de",n.gallatinUrl=n.https+"cnc-powerpoint.partner.officewebapps.cn",n.usGovUrl=n.https+"powerpoint.gov.online.office365.us",n.usDoDUrl=n.https+"powerpoint.dod.online.office365.us",n.airGap08Url=n.https+"powerpoint.wac.online.office.eaglex.ic.gov",n.airGap09Url=n.https+"powerpoint.wac.online.office.microsoft.scloud",n.prodUrl=n.https+n.hostWAC.substring(1),n.WacToPodsUnifiedMap=n.getWacToPodsUnifiedMap(),n.WacToPodsPreviewerMap=n.getWacToPodsPreviewerMap(),n}(),PPTBootstrapper=function(){function n(){}return n.ensureInitializeParametersAreTheRightType=function(n){n.WopiPrecheckInfo.PreseededSessionKey&&(n.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)!=="_._._."||n.WopiPrecheckInfo.PreseededSessionKey.slice(-6)!=="-.-.-.")&&(n.WopiPrecheckInfo.PreseededSessionKey="_._._."+n.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.");n.ApplicationCustomSettings&&n.ApplicationCustomSettings.EnableWacFallback==null&&(n.ApplicationCustomSettings.EnableWacFallback=!0)},n.getOnDemandServer=function(n,t){var i,r,u;if(t===void 0&&(t=!1),n&&n.ApplicationCustomSettings&&n.ApplicationCustomSettings.OnDemandServer)return n.ApplicationCustomSettings.OnDemandServer;if(n&&n.ApplicationUrl&&(i=PodsRegionInfo.tryGetPodsRegion(n.ApplicationUrl,n,t),i))return i.PodsURL;r=PPTBootstrapSettings.getAppMetadata();u=r?r.Environment:"";switch(u){case"wac":return n&&n.ApplicationUrl?n.ApplicationUrl.substring(0,n.ApplicationUrl.indexOf("PowerPointFrame.aspx")).replace("/p/","/pods/"):"";default:return"https://localhost:8080/"}},n.getWacStaticResourcesServer=function(n,t,i,r){var u,f;if(n&&n.WacStaticResourcesServer)return n.WacStaticResourcesServer;if(i)return u="pods/s/",i.split(u)[0]+u;if(t){if(f=PodsRegionInfo.tryGetPodsRegion(t,r,!1),f)return f.WacCdnStaticServer;throw Error("Application url provided but region not in region allowlist");}return"https://c1-powerpoint-15.cdn.office.net/pods/s/"},n.getStaticResourcesServerHostName=function(t,i){try{return UrlUtils.getHostname(n.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t))}catch(r){return i.ULS.traceTag(554776468,logCategory.PptSession,logLevel.Error,"PPTBootstrapper.getStaticResourcesServerHostName: Caught exception "+r+"."),""}},n.isDoDRegion=function(n,t){return this.getStaticResourcesServerHostName(n,t)=="powerpoint.dod.cdn.office365.us"},n.getUrlDomain=function(n,t){try{return n?UrlUtils.getHostname(n):""}catch(i){return t.ULS.traceTag(539820259,logCategory.PptSession,logLevel.Error,"PPTBootstrapper.getUrlDomain: Caught exception "+i+"."),""}},n.generateRandomHexChar=function(){var n=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(n),Math.floor(n[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(n),Math.floor(n[0]/16).toString(16)):Math.floor(Math.random()*16).toString(16)},n.generateRandomUUID=function(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,this.generateRandomHexChar)},n.getBrowserTechnology=function(n,t){return this.getSlideShowKind(n,t)=="Modern"?n.SessionInformation.WdParams&&!n.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible?"SVG":"WebGL":""},n.isScenarioBlockedForModernSS=function(n,t){var f,e,o,s,h=(e=(f=n.SessionInformation)===null||f===void 0?void 0:f.HostName)===null||e===void 0?void 0:e.toLowerCase(),r=PPTBootstrapperFeatureGatesHelper.getFeatureGates(n,t),u="",i=!1;return h==="msteams"&&(n.SessionInformation.WdParams?((o=n.SessionInformation.WdParams)===null||o===void 0?void 0:o.wdBrowserCompatible)===undefined?(i=!BrowserUtils.isBrowserSupportedForModernSlideShow(t,r===null||r===void 0?void 0:r.ModernSlideShowBlockListForOS,r===null||r===void 0?void 0:r.ModernSlideShowBlockListForBrowserVersion),i&&(u="UnsupportedBrowser")):(t.ULS.traceTag(545927457,logCategory.PptSession,logLevel.Info,"wdBrowserCompatible: "+n.SessionInformation.WdParams.wdBrowserCompatible),i=!n.SessionInformation.WdParams.wdBrowserCompatible,i&&(u="UnsupportedBrowser")):t.ULS.traceTag(545927456,logCategory.PptSession,logLevel.Error,"WdParam is null - Sanitize initParams and set it to not null"),r.AllowSingleWindowElectronTraffic||((s=n.SessionInformation.HostExperience)===null||s===void 0?void 0:s.toLocaleLowerCase())!="singlewindow"||window.navigator.userAgent.toLowerCase().indexOf("electron")==-1||(t.ULS.traceTag(545122067,logCategory.PptSession,logLevel.Info,"Blocking ModernSS for SingleWindow in Electron scenarios"),i=!0,u="SingleWindowElectron")),t.ULS.traceTag(545927458,logCategory.PptSession,logLevel.Info,"unsupportedModernSSScenario: "+i),i&&t.ULS.traceTag(545122068,logCategory.PptSession,logLevel.Info,"ModernUnsupportedReason: "+u),i},n.getSlideShowKind=function(t,i){var r=PPTBootstrapperFeatureGatesHelper.getFeatureGates(t,i);return r.RevertNewGetSlideShowKindLogic?n.getSlideShowKindOldVersion(t,i,r):n.getSlideShowKindUpdatedVersion(t,i,r)},n.getSlideShowKindOldVersion=function(n,t,i){var r="Modern",e="Legacy",o,f;try{if(t&&t.ULS.traceTag(559495312,logCategory.PptSession,logLevel.Info,"pptFeatureGates - "+JSON.stringify(i)),i===null||i===void 0?void 0:i.ForceLegacySlideShow)return e;if(n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdBrowserCompatible===undefined&&(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserCompatible:BrowserUtils.isBrowserSupportedForModernSlideShow(t,i?i.ModernSlideShowBlockListForOS:undefined,i?i.ModernSlideShowBlockListForBrowserVersion:undefined)})),n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible==null&&(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserShapeBuilderCompatible:BrowserUtils.isBrowserShapeBuilderCompatible({},t,i?i.ModernWebGLBlockListForBrowserVersion:undefined)&&n.SessionInformation.WdParams.wdBrowserCompatible})),n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow==null&&(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdIsFileTypeSupportedForModernSlideShow:this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i?i.ModernSlideShowAllowListForFileType:undefined)})),o=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0||n.SessionInformation&&n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdForceModernSlideShowInTeams,o)return t&&t.ULS.traceTag(556615647,logCategory.PptSession,logLevel.Info,"modern slideshow forced from wdparam or from Teams client"),r;t&&this.s_logModernCompatibility&&(BrowserUtils.isBrowserSupportedForModernSlideShow(t,i?i.ModernSlideShowBlockListForOS:undefined,i?i.ModernWebGLBlockListForBrowserVersion:undefined),BrowserUtils.isBrowserShapeBuilderCompatible({},t,i?i.ModernWebGLBlockListForBrowserVersion:undefined),this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i?i.ModernSlideShowAllowListForFileType:undefined),this.s_logModernCompatibility=!1);var u=n.SessionInformation.WdParams&&(n.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible||n.SessionInformation.WdParams.wdBrowserCompatible)&&n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow,s=n.SessionInformation&&n.SessionInformation.IsPresenter&&i.EnableModernSlideShowForPresenter,h=n.SessionInformation&&n.SessionInformation.UiHostIsHighContrast&&i.EnableModernSlideShowForHighContrast;if(u?s?h||(this.s_fallbackReason="NotUseModernForHighContrast"):this.s_fallbackReason="NotUseModernForPresenter":this.s_fallbackReason=n.SessionInformation.WdParams?n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow?"BrowserNotShapeBuilderCompatibleAndBlockedConfig":"FileTypeNotSupported":"SessionInfomationWdParamsMissing",u&&s)return t&&t.ULS.traceTag(573862238,logCategory.PptSession,logLevel.Info,"Always use Modern for Presenter"),r;if(u&&h)return t&&t.ULS.traceTag(573698710,logCategory.PptSession,logLevel.Info,"Always use Modern for HighContrast"),r;if(f=n.SessionInformation.HostName.toLowerCase()==="teamsandroid"||n.SessionInformation.HostName.toLowerCase()==="msteams"||n.SessionInformation.HostName.toLowerCase()==="teamsios"||n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdModernSlideShowInTeams,this.s_fallbackReason=!f&&this.s_fallbackReason===""?"ModernDisabled":this.s_fallbackReason,u&&f)return t&&t.ULS.traceTag(556615650,logCategory.PptSession,logLevel.Info,"Using modern slideshow for compatible client and is enabled from Teams client for rings"),r}catch(c){t&&t.ULS.traceTag(573862240,logCategory.PptSession,logLevel.Warning,"Exception in getSlideShowKind. "+c)}return(n.ApplicationUrl===null)?"StaticHtml":(t&&t.ULS.traceTag(556615651,logCategory.PptSession,logLevel.Info,"returning legacy. fallbackReason:"+this.s_fallbackReason),this.s_fallbackReason=this.s_fallbackReason===""?"MissingApplicationUrl":this.s_fallbackReason,e)},n.getSlideShowKindUpdatedVersion=function(n,t,i){var r,u,f,e,o,s,h,c,l,a=(u=(r=n.SessionInformation)===null||r===void 0?void 0:r.HostName)===null||u===void 0?void 0:u.toLowerCase(),p=a==="msteams"||a==="teamsandroid"||a==="teamsios",b=p,w,v,y;try{if(t===null||t===void 0?void 0:t.ULS.traceTag(545275915,logCategory.PptSession,logLevel.Info,"pptFeatureGates - "+JSON.stringify(i)),i===null||i===void 0?void 0:i.ForceLegacySlideShow)return"Legacy";if(((f=n.SessionInformation.WdParams)===null||f===void 0?void 0:f.wdBrowserCompatible)||(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserCompatible:BrowserUtils.isBrowserSupportedForModernSlideShow(t,i===null||i===void 0?void 0:i.ModernSlideShowBlockListForOS,i===null||i===void 0?void 0:i.ModernSlideShowBlockListForBrowserVersion)})),((e=n.SessionInformation.WdParams)===null||e===void 0?void 0:e.wdBrowserShapeBuilderCompatible)||(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserShapeBuilderCompatible:BrowserUtils.isBrowserShapeBuilderCompatible({},t,i===null||i===void 0?void 0:i.ModernWebGLBlockListForBrowserVersion)&&n.SessionInformation.WdParams.wdBrowserCompatible})),((o=n.SessionInformation.WdParams)===null||o===void 0?void 0:o.wdIsFileTypeSupportedForModernSlideShow)||(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdIsFileTypeSupportedForModernSlideShow:this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i===null||i===void 0?void 0:i.ModernSlideShowAllowListForFileType,b)})),w=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0||n.SessionInformation&&((s=n.SessionInformation.WdParams)===null||s===void 0?void 0:s.wdForceModernSlideShowInTeams),w)return t===null||t===void 0?void 0:t.ULS.traceTag(545275916,logCategory.PptSession,logLevel.Info,"modern slideshow forced from wdparam or from Teams client"),"Modern";if(t&&this.s_logModernCompatibility&&(BrowserUtils.isBrowserSupportedForModernSlideShow(t,i===null||i===void 0?void 0:i.ModernSlideShowBlockListForOS,i===null||i===void 0?void 0:i.ModernWebGLBlockListForBrowserVersion),BrowserUtils.isBrowserShapeBuilderCompatible({},t,i===null||i===void 0?void 0:i.ModernWebGLBlockListForBrowserVersion),this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i===null||i===void 0?void 0:i.ModernSlideShowAllowListForFileType),this.s_logModernCompatibility=!1),v=(((h=n.SessionInformation.WdParams)===null||h===void 0?void 0:h.wdBrowserShapeBuilderCompatible)||((c=n.SessionInformation.WdParams)===null||c===void 0?void 0:c.wdBrowserCompatible))&&((l=n.SessionInformation.WdParams)===null||l===void 0?void 0:l.wdIsFileTypeSupportedForModernSlideShow),v||(this.s_fallbackReason=n.SessionInformation.WdParams?n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow?"BrowserNotShapeBuilderCompatibleAndBlockedConfig":"FileTypeNotSupported":"SessionInfomationWdParamsMissing"),y=p||n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdModernSlideShowInTeams,this.s_fallbackReason=!y&&this.s_fallbackReason===""?"ModernDisabled":this.s_fallbackReason,v&&y)return t===null||t===void 0?void 0:t.ULS.traceTag(545275918,logCategory.PptSession,logLevel.Info,"Using modern slideshow for compatible client and is enabled from Teams client for rings"),"Modern"}catch(k){t===null||t===void 0?void 0:t.ULS.traceTag(545275919,logCategory.PptSession,logLevel.Warning,"Exception in getSlideShowKind. "+k)}return(n.ApplicationUrl===null)?"StaticHtml":(t===null||t===void 0?void 0:t.ULS.traceTag(545275920,logCategory.PptSession,logLevel.Info,"returning legacy. fallbackReason:"+this.s_fallbackReason),this.s_fallbackReason=this.s_fallbackReason===""?"MissingApplicationUrl":this.s_fallbackReason,"Legacy")},n.getSlideShowHostContainer=function(n){var t,i;return((i=(t=n===null||n===void 0?void 0:n.SessionInformation)===null||t===void 0?void 0:t.WdParams)===null||i===void 0?void 0:i.enablePptSharingWebviewContainer)&&n.WebviewRef?"Webview":"Iframe"},n.getFallbackReason=function(){return this.s_fallbackReason},n.isFileTypeSupportedForModernSlideShow=function(n,t,i,r){var e=this.getFileExtension(n,t),u,f;if(r)return!0;i||(i="pptx;ppsx;potx;pptm;ppsm;potm",t&&t.ULS.traceTag(558438469,logCategory.PptSession,logLevel.Info,"isFileTypeSupportedForModernSlideShow FeatureGate modernSlideShowAllowListForFileType is undefined. Setting to default value: "+i));u=i.split(";");for(f in u)if(u[f].toLowerCase()==e.toLowerCase())return!0;return!1},n.isFileTypeSupportedForLegacySlideShow=function(n,t){var i=this.getFileExtension(n,t),r="pptx;ppsx;potx;pptm;ppsm;potm;ppt;pps;pot".split(";");for(var u in r)if(r[u].toLowerCase()==i.toLowerCase())return t&&t.ULS.traceTag(556282498,logCategory.PptSession,logLevel.Info,"File has a valid ppt extension. Supported by Legacy SS: "+i),!0;return t&&t.ULS.traceTag(556282499,logCategory.PptSession,logLevel.Error,"File doesnt have a valid ppt extension. Supported by Legacy SS: "+i),!1},n.getFileExtension=function(n,t){var i,r;return n&&(i=n.split("."),i&&i.length>1)?(r=i[i.length-1].toLowerCase(),t&&t.ULS.traceTag(578930325,logCategory.PptSession,logLevel.Info,"getFileExtension fileExtension: "+r),r):""},n.isBinaryFile=function(n,t){var i=this.getFileExtension(n,t),r="ppt;pps;pot;odp".split(";");for(var u in r)if(r[u].toLowerCase()==i.toLowerCase())return t&&t.ULS.traceTag(545887873,logCategory.PptSession,logLevel.Info,"File extension is binary : "+i),!0;return!1},n.sendInitialLog=function(n,t,i,r){var f,l,u,o,v,e,h,a,s,c;this.s_bootstrapperInstanceIdentifier===""&&(this.s_bootstrapperInstanceIdentifier=this.generateRandomUUID());f={};f.BootstrapperType="TypeScript";f.Preview=t==="Previewer"?!0:!1;f.Scenario=t;f.ApplicationUrl=this.extractHostname(n.ApplicationUrl);f.IsDeepLink=!!UrlUtils.getQueryStringParam("nav");f.BootstrapperInstanceId=this.s_bootstrapperInstanceIdentifier;l={};f.ApplicationCustomSettings=l;n.ApplicationCustomSettings&&(l.OnDemandServer=this.extractHostname(n.ApplicationCustomSettings.OnDemandServer),l.EnableWacFallback=n.ApplicationCustomSettings.EnableWacFallback);u={};f.SessionInformation=u;u.HostName=n.SessionInformation.HostName;u.HostSessionId=n.SessionInformation.HostSessionId;u.UiLocale=n.SessionInformation.UiLocale;u.DataLocale=n.SessionInformation.DataLocale;n.Diagnostics&&n.Diagnostics.userClickTime?u.DocumentClickTime=n.Diagnostics.userClickTime:n.SessionInformation&&n.SessionInformation.DocumentClickTime&&(u.DocumentClickTime=n.SessionInformation.DocumentClickTime.getTime());u.HostInitTime=n.SessionInformation.HostInitTime;u.CurrentTime=(new Date).getTime();u.ParticipantId=n.SessionInformation.ParticipantId;u.CallId=n.SessionInformation.CallId;u.TenantId=n.SessionInformation.TenantId;u.ContentId=n.SessionInformation.ContentId;u.EndpointId=n.SessionInformation.EndpointId;u.IsPresenter=n.SessionInformation.IsPresenter;u.UiHost=PodsRegionInfo.getUiHost(n.SessionInformation.HostName);u.UiHostRing=n.SessionInformation.UiHostRing;u.UiHostIsHighContrast=n.SessionInformation.UiHostIsHighContrast;u.UiHostHighContrastColorSettings=n.SessionInformation.UiHostHighContrastColorSettings;u.PreviewerPosition=n.SessionInformation.Position;u.WdParams=n.SessionInformation.WdParams;u.HostExperience=n.SessionInformation.HostExperience;u.SlideShowKind=this.getSlideShowKind(n,r);u.BrowserTechnology=this.getBrowserTechnology(n,r);u.ForceModernSlideShowInTeamsQueryParam=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0;u.IsRetry=n.SessionInformation&&n.SessionInformation.IsRetry?n.SessionInformation.IsRetry:!1;u.PreviousSessionErrorName=n.SessionInformation&&n.SessionInformation.PreviousSessionErrorName?n.SessionInformation.PreviousSessionErrorName:"";u.PreviousHostSessionId=n.SessionInformation&&n.SessionInformation.PreviousHostSessionId?n.SessionInformation.PreviousHostSessionId:"";u.StateServiceFeatures=n.SessionInformation.EnableStateServiceInPreviewerFeatures;u.TeamsBuildVersion=n.SessionInformation.TeamsBuildVersion;u.DeviceMetadata=n.SessionInformation.DeviceMetadata;o={};f.Diagnostics=o;v=this.getEntryPoint(n);o.EntryPoint=v;o.FileHost=PodsRegionInfo.getFileHost(n);o.PodsRing=n.ApplicationUrl?PodsRegionInfo.getPodsRing(n):"";o.PresentationUrlEnabled=this.getPresentationUrlFlag(n,r);e={};f.WopiPrecheckInfo=e;e.FileSize=n.WopiPrecheckInfo.FileSize;e.FileGetUrlBool=!!n.WopiPrecheckInfo.FileGetUrl;e.CustomFontCatalogUrlBool=!!n.WopiPrecheckInfo.CustomFontCatalogUrl;e.FileNameBool=!!n.WopiPrecheckInfo.FileName;e.ReadOnly=n.WopiPrecheckInfo.ReadOnly;e.IrmEnabled=n.WopiPrecheckInfo.IrmEnabled;e.SupportsDecryptedContentDownload=n.WopiPrecheckInfo.SupportsDecryptedContentDownload;e.ViewOnly=n.WopiPrecheckInfo.ViewOnly;e.PreseededSessionKey=!!n.WopiPrecheckInfo.PreseededSessionKey;!n.WopiPrecheckInfo.FileName||(e.FileExtension=this.getFileExtension(n.WopiPrecheckInfo.FileName,r));h={};n.WopiPrecheckInfo.BundleInfo&&(a=n.WopiPrecheckInfo.BundleInfo,h.MajorVersion=a.MajorVersion,h.URLBool=!!a.Url,h.CrossOrigin=a.CrossOrigin);e.BundleInfo=h;s={};f.AppInfo=s;c=PPTBootstrapSettings.getAppMetadata();c&&(s.AppVersionMajor=c.AppVersionMajor,s.AppVersionMinor=c.AppVersionMinor,s.Environment=c.Environment);s.UserAgent=window.navigator.userAgent;i&&(f.AdditionalTelemetry=i);r.ULS.traceTag(22357763,logCategory.PptSession,logLevel.Info,JSON.stringify(f,this.undefinedReplacer))},n.undefinedReplacer=function(n,t){return typeof t=="undefined"?null:t},n.shouldUsePresentationUrlHandler=function(n,t){return window.location.search.indexOf("wdPresentationUrlFlowEnabled")>=0?(t&&t.ULS.traceTag(557417435,logCategory.PptSession,logLevel.Info,"wdPresentationUrlFlowEnabled is set, hence using presentation url boot flow"),!0):n.SessionInformation.IsPresenter&&n.Diagnostics&&n.Diagnostics.presentationUrlFlag?(t&&t.ULS.traceTag(557417436,logCategory.PptSession,logLevel.Info,"PresentationUrl flag is true for presenter, hence using presentation url boot flow"),!0):!1},n.getPresentationUrlFlag=function(n,t){if(window.location.search.indexOf("wdPresentationUrlFlowEnabled")>=0||n.Diagnostics&&n.Diagnostics.presentationUrlFlag===!0)return!0;var i=PPTBootstrapperFeatureGatesHelper.getStateServiceFeatureGates(n,t)||[];return i.indexOf("PresUrlBoot")>-1?!0:!1},n.podsFlighting=function(n,t){var i=PodsRegionInfo.tryGetPodsRegion(n.ApplicationUrl,n,!1);return i?window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0?createUsePODSDetails(!0,!0,"Supported Region and wdTestPreviewer/wdTestUnified set to true in Host Page URL"):createUsePODSDetails(!0,!0,"Supported Region"):(t.ULS.traceTag(589168768,logCategory.PptSession,logLevel.Info,"Wac region not currently supported by PODS"),createUsePODSDetails(!1,!1,"Wac region not currently supported by PODS"))},n.launchWacFallback=function(n,t,i,r,u,f,e){var c,s,h,l,a,p,y,v;u.ULS.traceTag(38147724,logCategory.PptSession,logLevel.Info,"Launching Wac Fallback");var o=document.createElement("iframe");o.frameBorder="0";o.style.top=HTMLHelper.toPx(0);o.style.bottom=HTMLHelper.toPx(0);o.style.left=HTMLHelper.toPx(0);o.style.right=HTMLHelper.toPx(0);o.style.height=HTMLHelper.floatToPercent(1);o.style.width=HTMLHelper.floatToPercent(1);o.style.minWidth=HTMLHelper.toPx(300);o.style.minHeight=HTMLHelper.toPx(200);o.style.position="absolute";o.setAttribute("allowfullscreen",(!0).toString());o.setAttribute("allowTransparency",(!0).toString());o.id="WebApplicationFrame";o.title="Office Online Frame";o.name="wac_frame";c=HTMLHelper.floatToPercent(1);t.Container.style.width=c;t.Container.style.height=c;t.Container.style.minHeight=HTMLHelper.toPx(150);t.Container.style.left=HTMLHelper.toPx(0);t.Container.style.right=HTMLHelper.toPx(0);t.Container.style.bottom=HTMLHelper.toPx(0);t.Container.style.top=HTMLHelper.toPx(0);s=document.createElement("div");s.style.backgroundColor="#393a3d";s.style.backfaceVisibility="hidden";s.style.width=c;s.style.height=c;s.style.minHeight=HTMLHelper.toPx(150);s.style.left=HTMLHelper.toPx(0);s.style.right=HTMLHelper.toPx(0);s.style.bottom=HTMLHelper.toPx(0);s.style.top=HTMLHelper.toPx(0);o.style.width=c;o.style.minHeight=HTMLHelper.toPx(150);o.style.height=c;h=document.createElement("form");h.name="wac_form";h.id="wac_form";h.target="wac_frame";h.action=i(n,t);h.method="post";l=document.createElement("input");l.type="hidden";l.name="access_token";l.value=n.AccessToken;h.appendChild(l);a=document.createElement("input");a.type="hidden";a.name="access_token_ttl";a.value=!n.AccessTokenExpiry?"0":n.AccessTokenExpiry.getTime().toString();h.appendChild(a);t.Container.appendChild(h);t.Container.appendChild(s);s.appendChild(o);h.submit();p=r&&r.Code===5308440?"CannotLoadBundleItem":"FatalError";y={errorObject:{errorType:p,errorObject:r}};f.stop();v=f.getVisibilityChangeEvents();v&&v.length>0&&(y.documentLoadedWithTabSwitch=!0,u.ULS.traceTag(38147725,logCategory.PptSession,logLevel.Info,"Visibility Change Events:"+JSON.stringify(v)));t.FnOnInitializeSuccess(new PPTDisabledApplication(e),y)},n.extractHostname=function(n){return n?n.indexOf("://")>-1?n.split("/")[2]:n.split("/")[0]:null},n.getEntryPoint=function(n){if(!n.ApplicationUrl)return null;var t=UrlUtils.getParameterValueDecoded(n.ApplicationUrl,"wdOrigin");return t?t:n.Diagnostics&&n.Diagnostics.entryPoint?n.Diagnostics.entryPoint:null},n.findBootstrapperPerfEntry=function(n,t,i){var r,u;if(n)for(r=0;r<n.length;r+=1)if(u=n[r],u.name.indexOf(t)>=0)return u.name.toLowerCase()!==t.toLowerCase()&&i.ULS.traceTag(38147726,logCategory.PptSession,logLevel.Info,"Found partial match for bootstrapper URL perf entry"),u;return null},n.logBootstrapperPerformanceInfo=function(n,t,i){var e,f,r,u;if(i)try{if(e="https://contentstorage.osi.office.net/boot/ppt.boot.js",f=n||e,n||i.ULS.traceTag(38147727,logCategory.PptSession,logLevel.Info,"Missing BootstrapperUrl, defaulting to "+e),!window.performance){i.ULS.traceTag(38147728,logCategory.PptSession,logLevel.Info,"Performance API not found on browser");return}if(r=undefined,window.performance.getEntriesByName&&(r=this.findBootstrapperPerfEntry(window.performance.getEntriesByName(f),f,i)),!r&&window.performance.getEntries&&(i.ULS.traceTag(38147729,logCategory.PptSession,logLevel.Info,"Searching all entries for bootstrapper timing entry."),r=this.findBootstrapperPerfEntry(window.performance.getEntries(),f,i)),!r){i.ULS.traceTag(38147730,logCategory.PptSession,logLevel.Info,"Unable to extract Bootstrapper perf info.");return}u={};u.name=f;u.logReason=t;u.nameMatchesExpected=r.name===f;u.connectEnd=r.connectEnd;u.connectStart=r.connectStart;u.domainLookupEnd=r.domainLookupEnd;u.domainLookupStart=r.domainLookupStart;u.fetchStart=r.fetchStart;u.initiatorType=r.initiatorType;u.redirectEnd=r.redirectEnd;u.redirectStart=r.redirectStart;u.requestStart=r.requestStart;u.responseEnd=r.responseEnd;u.responseStart=r.responseStart;u.duration=r.duration;u.entryType=r.entryType;u.startTime=r.startTime;u.nextHopProtocol=r.nextHopProtocol;u.workerStart=r.workerStart;u.secureConnectionStart=r.secureConnectionStart;u.transferSize=r.transferSize;u.encodedBodySize=r.encodedBodySize;u.decodedBodySize=r.decodedBodySize;i.ULS.traceTag(34928845,logCategory.PptSession,logLevel.Info,JSON.stringify(u))}catch(o){i.ULS.traceTag(38147731,logCategory.PptSession,logLevel.Warning,"Exception extracting Bootstrapper perf info. "+o)}},n.getPostMessageToken=function(n){return!n||n.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):n},n.appendCommonFrameUrlQueryParams=function(n,t){var i=n,o=this.getUI(t),r,u,f,e,s;return o&&(i=UrlUtils.addOrReplaceParameterValue(i,"ui",o)),r=this.getDataLocale(t),r&&(i=UrlUtils.addOrReplaceParameterValue(i,"rs",r)),u=UrlUtils.getParameterValue(t.ApplicationUrl,"mscc"),u&&(i=UrlUtils.addOrReplaceParameterValue(i,"mscc",u)),f=UrlUtils.getParameterValue(t.ApplicationUrl,"wdFR"),f&&(i=UrlUtils.addOrReplaceParameterValue(i,"wdFR",f)),e=this.getEntryPoint(t),e&&(i=UrlUtils.addOrReplaceParameterValue(i,"wdOrigin",UrlUtils.urlKeyValueEncode(e))),s=this.getPostMessageToken(t.PostMessageToken),t.PostMessageToken&&(i+="&postMessageToken="+s),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=UrlUtils.addOrReplaceParameterValue(i,"dchat","1")),UrlOverrideUtils.forwardMissingWdParamsFromApplicationUrl(i,t.ApplicationUrl)},n.getUI=function(n){return n.SessionInformation.UiLocale?n.SessionInformation.UiLocale:UrlUtils.getParameterValueDecoded(n.ApplicationUrl,"ui")},n.getDataLocale=function(n){return n.SessionInformation.DataLocale?n.SessionInformation.DataLocale:UrlUtils.getParameterValueDecoded(n.ApplicationUrl,"rs")},n.s_bootstrapperInstanceIdentifier="",n.s_logModernCompatibility=!0,n.s_fallbackReason="",n}(),PPTBootstrapperFeatureGatesHelper=function(){function n(){}return n.getFeatureGates=function(n,t){var i;try{return i="{}",n&&n.SessionInformation&&n.SessionInformation.PptFeatureGates&&(i=decodeURIComponent(n.SessionInformation.PptFeatureGates).replace(/\u200B/g,"")),JSON.parse(i)}catch(r){return t&&t.ULS.traceTag(578933140,logCategory.PptSession,logLevel.Warning,"Exception parsing ppt feature gates: "+JSON.stringify(r)),{}}},n.getStateServiceFeatureGates=function(n,t){if(n&&n.SessionInformation&&n.SessionInformation.EnableStateServiceInPreviewerFeatures)try{var r=typeof n.SessionInformation.EnableStateServiceInPreviewerFeatures=="string"?JSON.parse(n.SessionInformation.EnableStateServiceInPreviewerFeatures):n.SessionInformation.EnableStateServiceInPreviewerFeatures,i=r.filter(function(n){return n&&n.length!=0});return i.length===0?undefined:i}catch(u){t.ULS.traceTag(546169615,logCategory.PptSession,logLevel.Warning,"Exception parsing state service feature gates: "+JSON.stringify(u))}return undefined},n}(),PPTBootstrapperLogger=function(){function n(){}return n.recordBootstrapperTimeoutFailure=function(n,t,i,r,u,f,e,o){if(!this.isBootSuccess(t,i,r)){var s={AppMetadata:this.getAppMetadata(n,PPTBootstrapSettings.getAppMetadata(),u),BootInfo:this.getBootInfo(n,u,f,!1,o),BundleMetadata:"[]",FatalErrors:this.getFatalErrorInfo(t,i,r),NonFatalErrors:e,WopiPrecheckInfo:this.getWopiPrecheckInfo(n,u)};u.ULS.traceTag(592007955,logCategory.PptSession,logLevel.Error,JSON.stringify(s))}},n.recordBootCompleted=function(n,t,i,r,u,f,e,o,s){var h={AppMetadata:this.getAppMetadata(n,PPTBootstrapSettings.getAppMetadata(),u),BootInfo:this.getBootInfo(n,u,f,this.isBootSuccess(t,i,r),s),BundleMetadata:"[]",FatalErrors:this.getFatalErrorInfo(t,i,r),NonFatalErrors:e,WopiPrecheckInfo:this.getWopiPrecheckInfo(n,u),AppBootTimings:o?o.appBootTimingDict:""};u.ULS.traceTag(587843200,logCategory.PptSession,logLevel.Info,JSON.stringify(h));this.recordNetworkLatency(u)},n.getWopiPrecheckInfo=function(n,t){return n&&n.WopiPrecheckInfo?{FileGetUrlBool:n.WopiPrecheckInfo.FileGetUrl?!0:!1,CustomFontCatalogUrlBool:n.WopiPrecheckInfo.CustomFontCatalogUrl?!0:!1,FileNameBool:n.WopiPrecheckInfo.FileName?!0:!1,ReadOnly:n.WopiPrecheckInfo.ReadOnly,SupportsDecryptedContentDownload:n.WopiPrecheckInfo.SupportsDecryptedContentDownload,ViewOnly:n.WopiPrecheckInfo.ViewOnly,PreseededSessionKey:n.WopiPrecheckInfo.PreseededSessionKey,BundleInfo:this.getBundleInfo(n.WopiPrecheckInfo.BundleInfo),FileExtFromHost:PPTBootstrapper.getFileExtension(n.WopiPrecheckInfo.FileName,t)}:""},n.getBundleInfo=function(n){if(n){var t=n;return{MajorVersion:t.MajorVersion,URLBool:t.Url,CrossOrigin:t.CrossOrigin}}return""},n.getAppMetadata=function(n,t,i){return n?{BrowserTechnology:PPTBootstrapper.getBrowserTechnology(n,i),FileSizeHint:n.WopiPrecheckInfo.FileSize,ApiStartTime:0,HostInitTime:n.SessionInformation.HostInitTime,AppVersion:t.AppVersionMajor+"."+t.AppVersionMinor,ViewerMode:n.ApplicationCustomSettings&&n.ApplicationCustomSettings.ViewerMode?n.ApplicationCustomSettings.ViewerMode:0,EntryPoint:PPTBootstrapper.getEntryPoint(n),SessionId:n.SessionInformation.HostSessionId,UserAgent:window.navigator.userAgent,ApplicationUrl:n.ApplicationUrl,WACRegion:PodsRegionInfo.getWACRegion(n.ApplicationUrl),FileHost:PodsRegionInfo.getFileHost(n),Host:n.SessionInformation.HostName,PodsRing:n.ApplicationUrl?PodsRegionInfo.getPodsRing(n):"",UiHost:PodsRegionInfo.getUiHost(n.SessionInformation.HostName),UiHostRing:n.SessionInformation.UiHostRing,UiHostIsHighContrast:n.SessionInformation.UiHostIsHighContrast,CallId:n.SessionInformation.CallId,ContentId:n.SessionInformation.ContentId,HostContainer:PPTBootstrapper.getSlideShowHostContainer(n),SlideShowKind:PPTBootstrapper.getSlideShowKind(n,i),HostWindowVersion:this.getHostWindowVersion(),IsTestSession:this.getIsTestSession(),FallbackReason:PPTBootstrapper.getFallbackReason(),HostExperience:n.SessionInformation.HostExperience,ParticipantId:n.SessionInformation.ParticipantId,EndpointId:n.SessionInformation.EndpointId,HostSessionId:n.HostSessionId,isRetry:n.SessionInformation.IsRetry,previousSessionErrorName:n.SessionInformation.PreviousSessionErrorName,PreviousHostSessionId:n.SessionInformation.PreviousHostSessionId?n.SessionInformation.PreviousHostSessionId:"",IsPresenter:n.SessionInformation.IsPresenter,CDNHost:PPTBootstrapper.getStaticResourcesServerHostName(n,i),CDNVersion:t.WacCdnVersion,SnapServiceUrl:PPTBootstrapper.getUrlDomain(n.SessionInformation.SnapUrl,i),UseSnapService:n.SessionInformation.UseSnapService,UsingSnapServiceAttendee:PPTBootstrapper.getUrlDomain(n.WopiPrecheckInfo.PresentationUrl,i),TeamsBuildVersion:n.SessionInformation.TeamsBuildVersion,DeviceMetadata:n.SessionInformation.DeviceMetadata}:""},n.getHostWindowVersion=function(){var n=new URLSearchParams(window.location.search);return n.has("version")?n.get("version"):""},n.getIsTestSession=function(){var n,t=new URLSearchParams(window.location.search);return t.has("setting")&&t.get("setting")?((n=t.get("setting"))===null||n===void 0?void 0:n.indexOf("test:run"))!==-1:!1},n.getFatalErrorInfo=function(n,t,i){return this.isBootSuccess(n,t,i)?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:n,ErrorName:t,Message:i}},n.getBootInfo=function(n,t,i,r,u){var f=0;return n.SessionInformation.DocumentClickTime!=null&&n.SessionInformation.DocumentClickTime.getTime&&(f=n.SessionInformation.DocumentClickTime.getTime()),{PreloadCompleteTime:0,DocumentClickTime:f,BootSuccess:r,BootTime:i,BootMode:"",PresentationUrlEnabled:PPTBootstrapper.getPresentationUrlFlag(n,t),BootStageInfo:u&&u.length>0?u:""}},n.isBootSuccess=function(n,t,i){return n==null&&t==null&&i==null},n.recordNetworkLatency=function(n){var t,i,r;try{window.navigator&&(t=window.navigator.connection,t&&(i=t.effectiveType,r=t.downlink,n.ULS.traceTag(562368730,logCategory.PptSession,logLevel.Info,'{"networkType": '+i+', "bandwidth": '+r+"}")))}catch(u){n.ULS.traceTag(562368731,logCategory.PptSession,logLevel.Info,"Exception trying to fetch netowrk speed: "+u)}},n.initializeHealthLogger=function(n,t,i){try{var r=this.getAppMetadata(n,PPTBootstrapSettings.getAppMetadata(),i),f={application:"PowerPoint",applicationMode:"Slideshow",applicationModeExtended:r.SlideShowKind=="Modern"?"SLIDESHOWAPP":"PREVIEWER",browser:r.Browser,clientVersion:BuildVersionConfig.BUILD_NUMBER,host:r.FileHost,loggableUserId:this.getLoggableUserId(n.SessionInformation.UserId),ring:r.PodsRing,serverDocId:n.WopiPrecheckInfo.DocUniqueId,session_id:n.SessionInformation.HostSessionId,tenantId:n.SessionInformation.TenantId,uiHost:r.Host},u=healthSmall.Health.getInstance();return u.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,telemetryUrl:t+"/RemoteTelemetry.ashx",dimensions:f}),u.addOrUpdatePartCDimension("component","bootstrapper"),u.addOrUpdatePartCDimension("uiHostRing",r.UiHostRing),u.addOrUpdatePartCDimension("TeamsCallId",r.CallId),u.addOrUpdatePartCDimension("HostExperience",r.HostExperience),u.addOrUpdatePartCDimension("FileSizeBytes",r.FileSizeHint),u.addOrUpdatePartCDimension("ContentId",r.ContentId),u.addOrUpdatePartCDimension("ParticipantId",r.ParticipantId),u.addOrUpdatePartCDimension("EndpointId",r.EndpointId),u.addOrUpdatePartCDimension("StartAsPresenter",r.IsPresenter),u.addOrUpdatePartCDimension("IsRetrySession",r.isRetry),u.addQosPillar("Open"),u}catch(e){return i&&i.ULS.traceTag(556097945,logCategory.PptSession,logLevel.Error,"Failed to initialize HealthLogger. err: {0}"+JSON.stringify(e)),undefined}},n.getLoggableUserId=function(n){if(!n)return n;var t=n;return t.indexOf("urn%3aspo%3")>-1?t="":t.toLowerCase().indexOf("8:orgid:")==0&&(t=t.substring(8,t.length)),t},n}(),PPTDisabledApplication=function(){function n(n){this.m_sessionId=n}return n.prototype.GetApplicationType=function(){return"PowerPoint"},n.prototype.GetVersion=function(){return BuildVersionConfig.BUILD_NUMBER},n.prototype.GetSessionId=function(){return this.m_sessionId},n.prototype.RegisterEventHandler=function(){},n.prototype.RemoveEventHandler=function(){},n.prototype.RegisterErrorHandler=function(){},n.prototype.RemoveErrorHandler=function(){},n.prototype.AddEventHandler=function(){},n.prototype.dispose=function(){},n.prototype.Dispose=function(){},n.prototype.GetIsDisabled=function(){return!0},n.prototype.GetPercievedBoot=function(){return null},n.prototype.UsingCached=function(){return!1},n.prototype.GetCurrentSlideDimensions=function(){},n.prototype.GetSlidesInShowCount=function(){},n.prototype.GetTimeLineInfos=function(){},n.prototype.GetCurrentPosition=function(){},n.prototype.GetId=function(){},n.prototype.Next=function(){},n.prototype.PausePresentation=function(){},n.prototype.PlayPresentation=function(){},n.prototype.GetPresentationPlaybackState=function(){},n.prototype.NextSlide=function(){},n.prototype.Prev=function(){},n.prototype.PrevSlide=function(){},n.prototype.GoToNextSlide=function(){},n.prototype.GoToPrevSlide=function(){},n.prototype.GoToSlide=function(){},n.prototype.GoToSlideId=function(){},n.prototype.DisplayBlackSlide=function(){},n.prototype.DisplayWhiteSlide=function(){},n.prototype.Popout=function(){},n.prototype.PlayMedia=function(){},n.prototype.PauseMedia=function(){},n.prototype.RestoreFocus=function(){},n.prototype.StopMedia=function(){},n.prototype.SeekMedia=function(){},n.prototype.GetCurrentMediaStates=function(){},n.prototype.SetNavigationOptions=function(){},n}(),PPTMessageListenerRegistry=function(){function n(){this.m_apiRegistry={};window.addEventListener("message",this.onMessage)}return n.getInstance=function(){return this.s_singleton||(this.s_singleton=new n),this.s_singleton},n.prototype.add=function(n,t,i,r){r===void 0&&(r="");this.m_apiRegistry[n]=t;i&&this.sendLogToAllListeners("Add to Message Registry: "+n+", Reason: "+r,this.getLoggableDataFromMessageListenerRegistry())},n.prototype.get=function(n){return this.m_apiRegistry[n]},n.prototype.remove=function(n,t,i){i===void 0&&(i="");this.m_apiRegistry[n]=null;t&&this.sendLogToAllListeners("Remove from Message Registry: "+n+", Reason: "+i,this.getLoggableDataFromMessageListenerRegistry())},n.prototype.setSliceLoaded=function(){var t,n;for(t in this.m_apiRegistry)n=this.m_apiRegistry[t],n&&n.onSliceLoaded()},n.prototype.sendLogToAllListeners=function(n,t){var r,i;for(r in this.m_apiRegistry)i=this.m_apiRegistry[r],i&&i.log(n,t)},n.prototype.getLoggableDataFromMessageListenerRegistry=function(){var i={},n,t;for(n in this.m_apiRegistry)t=this.m_apiRegistry[n],i[n]=t?t.hasOwnProperty("c_activated")?"PreviewSessionLoader":"PreviewSessionManagerV0":"API is Null";return JSON.stringify(i)},n.prototype.onMessage=function(t){var i,r,u,f;try{i=JSON.parse(t.data)}catch(e){i=null}if(i&&(r=i.m_id||i.Token,r)){if(u=n.getInstance(),f=u.get(r),!f){u.sendLogToAllListeners("Message received with no targetApi. Id: "+r.toString(),t.data);return}f.onMessage(i,t.source)}},n}();var SnapRegionInfo=function(){function n(){}return n.getWacToSnapPreviewerMap=function(){var t={};return t[PodsRegionInfo.ffcUrl]=this.ShouldRerouteEdogToProd?createSNAPRegion(this.https+"usc"+n.hostOSISnapService,"5",1):createSNAPRegion(this.https+"snap.edog.officeapps.live.com/","1",1),t[PodsRegionInfo.ppcUrl]=createSNAPRegion(this.https+"msit"+n.hostOSISnapService,"2",1),t[PodsRegionInfo.prodUrl]=createSNAPRegion(this.https+n.hostOSISnapService.substring(1),"5",1),t[PodsRegionInfo.uscUrl]=createSNAPRegion(this.https+"usc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.brcUrl]=createSNAPRegion(this.https+"brc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.eucUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.cacUrl]=createSNAPRegion(this.https+"canc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.ukcUrl]=createSNAPRegion(this.https+"ukc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.aucUrl]=createSNAPRegion(this.https+"ausc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.jpcUrl]=createSNAPRegion(this.https+"jpc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.incUrl]=createSNAPRegion(this.https+"inc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.krcUrl]=createSNAPRegion(this.https+"krc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.frcUrl]=createSNAPRegion(this.https+"frc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.sgcUrl]=createSNAPRegion(this.https+"sgc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.eurppcUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.usGovUrl]=createSNAPRegion(this.https+"snap.osi.office365.us/","6"),t[PodsRegionInfo.gbcUrl]=createSNAPRegion(this.https+"snap.osi.office365.us/","6"),t[PodsRegionInfo.usDoDUrl]=createSNAPRegion(this.https+"snap.osi.apps.mil/","6"),t[PodsRegionInfo.airGap08Url]=createSNAPRegion(this.https+"snap.osi.eaglex.ic.gov/","7"),t[PodsRegionInfo.airGap09Url]=createSNAPRegion(this.https+"snap.osi.microsoft.scloud/","7"),t.edog=createSNAPRegion(this.https+"snap.edog.officeapps.live.com/","1",1),t[PodsRegionInfo.zacUrl]=createSNAPRegion(this.https+n.hostOSISnapService.substring(1),"5",1),t[PodsRegionInfo.zacUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.aecUrl]=createSNAPRegion(this.https+n.hostOSISnapService.substring(1),"5",1),t[PodsRegionInfo.aecUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.decUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.decUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.chcUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.chcUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.nocUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.nocUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.secUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.secUrl].IsGoLocalRoutedToPublic=!0,t},n.shouldRouteToEdog=function(n,t,i){return!t||!t.SessionInformation||i=="6"?!1:t.SessionInformation.UiHostRing&&this.TeamsRingsInEdog.indexOf(t.SessionInformation.UiHostRing.toLowerCase())>=0?!0:this.HostsWithFFInEdog.indexOf(t.SessionInformation.HostName)>=0&&n===PodsRegionInfo.ffcUrl?!0:!1},n.tryGetSnapRegion=function(n,t){var r=n.substring(0,n.indexOf("/p/")),i=this.WacToSnapPreviewerMap[r.toLowerCase()];return i&&this.shouldRouteToEdog(r.toLowerCase(),t,i.PreviewerRolloutRing)&&(i=this.WacToSnapPreviewerMap.edog),i},n.GetDefaultProdRegion=function(){return this.WacToSnapPreviewerMap[PodsRegionInfo.prodUrl]},n.getSnapRing=function(n){if(n.ApplicationUrl){var t=this.tryGetSnapRegion(n.ApplicationUrl,n);return t&&t.PreviewerRolloutRing?t.PreviewerRolloutRing:"-4"}return"-4"},n.getOnDemandSnapServer=function(t,i){var r,u,f;if(t&&(r=n.tryGetSnapRegion(t,i),r))return r.SnapURL;u=PPTBootstrapSettings.getAppMetadata();f=u?u.Environment:"";switch(f){case"wac":return t?t.substring(0,t.indexOf("PowerPointFrame.aspx")).replace("/p/","/"):"";default:return"https://localhost:8083/"}},n.getFlightingNumber=function(n){return n!=""?Math.abs(MathHelper.hash(n))/100%1:Math.random()},n.snapFlighting=function(t,i,r,u){var f=n.tryGetSnapRegion(t,r),e;if(window.location.search.indexOf("wdTestSnapService=1")>=0||window.location.hash.indexOf("wdTestSnapService=1")>=0)return createUseSnapDetails(!0,"Supported Region");if(f){if(f.RolloutPercentage<=0)return createUseSnapDetails(!1,"Snap region Disabled");if(e=this.getFlightingNumber(i),u!=null&&u.ULS.traceTag(540567040,logCategory.PptSession,logLevel.Info,"RolloutPercentage - "+f.RolloutPercentage+"; RolloutNumber - "+e),f.RolloutPercentage>=e)return createUseSnapDetails(!0,"Could use snap as evaluated rollout number is less than rollout percent")}return createUseSnapDetails(!1,"Not yet enabled Region")},n.ShouldRerouteEdogToProd=window.location.search.indexOf("wdTestPreviewerInEdog")>=0?!1:!0,n.HostsWithFFInEdog=["TeamsiOS"],n.TeamsRingsInEdog=["ring0","ring0_s"],n.https="https://",n.hostOSISnapService=".snap.officeapps.live.com/",n.WacToSnapPreviewerMap=n.getWacToSnapPreviewerMap(),n}(),SnapRegions=function(){function n(){}return n.aue="aue",n.ause="ause",n.brzs="brzs",n.canc="canc",n.cane="cane",n.cus="cus",n.eus="eus",n.eus2="eus2",n.frc="frc",n.inc="inc",n.ins="ins",n.inw="inw",n.jpe="jpe",n.jpw="jpw",n.krc="krc",n.krs="krs",n.ncus="ncus",n.neu="neu",n.scus="scus",n.sea="sea",n.uks="uks",n.ukw="ukw",n.wcus="wcus",n.weu="weu",n.wus="wus",n.wus2="wus2",n}(),PodsRegion=function(){function n(){}return n.aueRegion="aue-dc",n.auseRegion="ause-dc",n.brzsRegion="brzs-dc",n.cancRegion="canc-dc",n.caneRegion="cane-dc",n.cusRegion="cus-dc",n.eusRegion="eus-dc",n.eus2Region="eus2-dc",n.frcRegion="frc-dc",n.incRegion="inc-dc",n.insRegion="ins-dc",n.inwRegion="inw-dc",n.jpeRegion="jpe-dc",n.jpwRegion="jpw-dc",n.krcRegion="krc-dc",n.krsRegion="krs-dc",n.ncusRegion="ncus-dc",n.neuRegion="neu-dc",n.seaRegion="sea-dc",n.scusRegion="scus-dc",n.uksRegion="uks-dc",n.ukwRegion="ukw-dc",n.weuRegion="weu-dc",n.wcusRegion="wcus-dc",n.wusRegion="wus-dc",n.wus2Region="wus2-dc",n}(),SnapUrlToPodsRegion=function(){function n(){}return n.getSnapToPodsRegionMap=function(){var n={};return n[SnapRegions.aue]=PodsRegion.aueRegion,n[SnapRegions.ause]=PodsRegion.auseRegion,n[SnapRegions.brzs]=PodsRegion.brzsRegion,n[SnapRegions.cus]=PodsRegion.cusRegion,n[SnapRegions.canc]=PodsRegion.cancRegion,n[SnapRegions.cane]=PodsRegion.caneRegion,n[SnapRegions.eus]=PodsRegion.eusRegion,n[SnapRegions.eus2]=PodsRegion.eus2Region,n[SnapRegions.frc]=PodsRegion.frcRegion,n[SnapRegions.inc]=PodsRegion.incRegion,n[SnapRegions.ins]=PodsRegion.insRegion,n[SnapRegions.inw]=PodsRegion.inwRegion,n[SnapRegions.jpe]=PodsRegion.jpeRegion,n[SnapRegions.jpw]=PodsRegion.jpwRegion,n[SnapRegions.krc]=PodsRegion.krcRegion,n[SnapRegions.krs]=PodsRegion.krsRegion,n[SnapRegions.ncus]=PodsRegion.ncusRegion,n[SnapRegions.neu]=PodsRegion.neuRegion,n[SnapRegions.scus]=PodsRegion.scusRegion,n[SnapRegions.sea]=PodsRegion.seaRegion,n[SnapRegions.uks]=PodsRegion.uksRegion,n[SnapRegions.ukw]=PodsRegion.ukwRegion,n[SnapRegions.wcus]=PodsRegion.wcusRegion,n[SnapRegions.weu]=PodsRegion.weuRegion,n[SnapRegions.wus]=PodsRegion.wusRegion,n[SnapRegions.wus2]=PodsRegion.wus2Region,n},n.getSnapRegion=function(n){var t=n.hostname,i;return t==null?"":(t=t.toLowerCase(),t=t.replace("www.",""),i=t.split("-"),i[0])},n.tryGetPodsRegionSpecificUrl=function(t,i){if(t===undefined||t.hostname.search(".snap.")==-1||t.hostname.search("localhost")>=0)return i&&i.ULS.traceTag(528868489,logCategory.PptSession,logLevel.Warning,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl snapUrl is matching the condition."),"";try{var u=n.getSnapToPodsRegionMap(),r=n.getSnapRegion(t);if(r!="")return t.toString().indexOf("edog")>0?n.https+u[r]+n.hostOSIPodsServiceEdog:n.https+u[r]+n.hostOSIPodsService;i&&i.ULS.traceTag(528868490,logCategory.PptSession,logLevel.Info,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl snapRegion evaluated empty")}catch(f){i&&i.ULS.traceTag(528868491,logCategory.PptSession,logLevel.Error,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl failed with exception "+f)}return""},n.https="https://",n.hostOSIPodsService=".pods.officeapps.live.com/",n.hostOSIPodsServiceEdog=".pods.edog.officeapps.live.com/",n}(),TimeoutClock=function(){function n(n,t,i){this.m_pausedTimeMs=0;this.m_resumedTimeMs=0;this.m_maxTimeoutDurationMs=i===null||i===void 0?void 0:i.maxTimeoutDurationMs;this.m_callback=n;this.m_timeoutMs=t;this.m_startTimeMs=Date.now();this.updateTimeout()}return n.prototype.pause=function(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())},n.prototype.resume=function(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())},n.prototype.addTime=function(n){this.m_timeoutMs+=n;this.updateTimeout()},n.prototype.abort=function(){window.clearTimeout(this.m_timeoutId);this.m_callback=function(){}},Object.defineProperty(n.prototype,"isPaused",{get:function(){return this.m_pausedTimeMs>this.m_resumedTimeMs},enumerable:!1,configurable:!0}),n.prototype.updateTimeout=function(){window.clearTimeout(this.m_timeoutId);var n=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(n)&&(this.m_timeoutId=window.setTimeout(this.m_callback,n-(Date.now()-this.m_startTimeMs)))},n}(),TimeoutWrapper=function(){function n(n,t,i,r,u){var f=this,s,h,c,l,a,v,y,e,o,p,w;this.m_initialTicks=0;this.m_onSuccessTicks=0;this.m_onFailureTicks=0;this.m_onTimeoutTicks=0;this.m_fCallbackCalled=!1;this.m_scenario="";this.m_hostSessionId="";this.m_host="";this.errorCode=5;this.errorName="TimeoutInitialize";this.m_bootStageInfo=[];this.m_timeAddedMs=0;this.m_aborted=!1;this.m_callbackTimeoutError={errorType:"AppInitError",errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:this.errorCode,ErrorName:this.errorName,EventType:13,ExtraInfo:"Initialization timeout"};this.m_scenario=i;this.m_appErrors=r;this.m_bootStageInfo[0]={n:"Bootstrapper",s:Date.now()};n&&(this.m_featureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(n,t),n.FnOnInitializeSuccess&&(v=n.FnOnInitializeSuccess,n.FnOnInitializeSuccess=function(i,r){var u,e;f.m_onSuccessTicks=Date.now();f.m_fCallbackCalled||(f.m_fCallbackCalled=!0,f.m_onTimeoutTicks?f.logCallbackArrivedAfterTimeout("success",r,t):(t&&(t.ULS.traceTag(38836226,logCategory.PptSession,logLevel.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),e=f.m_bootStageInfo.length,f.m_bootStageInfo[e-1].e=Date.now(),t.ULS.traceTag(545925074,logCategory.PptSession,logLevel.Info,"fnOnInitializeSuccess - boot stage info: "+JSON.stringify(f.m_bootStageInfo)),PPTBootstrapperLogger.recordBootCompleted(n,null,null,null,t,Date.now(),f.m_appErrors,r,((u=f.m_featureGates)===null||u===void 0?void 0:u.ShouldDisableBootStageInfoInSuccessSession)?[]:f.m_bootStageInfo)),v(i,r)))}),n.FnOnInitializeFailure&&(y=n.FnOnInitializeFailure,n.FnOnInitializeFailure=function(i,r){if(f.m_onFailureTicks=Date.now(),!f.m_fCallbackCalled)if(f.m_fCallbackCalled=!0,f.m_onTimeoutTicks&&i!==f.m_callbackTimeoutError)f.logCallbackArrivedAfterTimeout("failure",r,t,i);else{if(t){var u=i;PPTBootstrapperLogger.recordBootCompleted(n,u.Code,u.ErrorName,u.errorObject,t,Date.now(),f.m_appErrors,r?r:f.m_appInitDiagnostics,f.m_bootStageInfo.length>1?f.m_bootStageInfo:[]);t.ULS.traceTag(38836227,logCategory.PptSession,logLevel.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")}y(i,r)}}),n.SessionInformation&&(this.m_hostSessionId=n.SessionInformation.HostSessionId,this.m_host=n.SessionInformation.HostName));this.m_initialTicks=Date.now();e=Configuration.HostCallbackTimeout;((s=this.m_featureGates)===null||s===void 0?void 0:s.HostBootTimeoutConfigInMs)&&((h=this.m_featureGates)===null||h===void 0?void 0:h.HostBootTimeoutConfigInMs)>0&&(e=this.m_featureGates.HostBootTimeoutConfigInMs);o=UrlUtils.getQueryStringParam("wdOnSuccessTimeout");!o||parseInt(o,10).toString()!==o||(e=parseInt(o,10));e&&(p=function(){return f.timeoutIfSuccessNotCalled(n,t,u)},w=((c=this.m_featureGates)===null||c===void 0?void 0:c.MaxBootTimeoutInMs)&&((l=this.m_featureGates)===null||l===void 0?void 0:l.MaxBootTimeoutInMs)>0?(a=this.m_featureGates)===null||a===void 0?void 0:a.MaxBootTimeoutInMs:72e5,this.m_timeoutClock=new TimeoutClock(p,e,{maxTimeoutDurationMs:w}))}return n.addTimeoutWrappersToHostCallbacks=function(t,i,r,u,f){return new n(t,i,r,u,f)},n.prototype.failByHost=function(n,t,i,r){var u,f,e;this.m_onFailureTicks||this.m_onSuccessTicks||this.m_onTimeoutTicks||this.m_aborted||(this.m_aborted=!0,(u=this.m_timeoutClock)===null||u===void 0?void 0:u.abort(),f=i,e=f==null?"":f.message,PPTBootstrapperLogger.recordBootCompleted(n,6,"AbortByHost",e,t,Date.now(),r))},n.prototype.addTimeIfNotAddedInMs=function(n){!this.m_timeoutClock||this.m_timeAddedMs>=n||(this.m_timeoutClock.addTime(n-this.m_timeAddedMs),this.m_timeAddedMs=n)},n.prototype.pause=function(){var n;(n=this.m_timeoutClock)===null||n===void 0?void 0:n.pause()},n.prototype.resume=function(){var n;(n=this.m_timeoutClock)===null||n===void 0?void 0:n.resume()},n.prototype.tryUpdateTimeoutErrorStage=function(n,t){try{if(!ApplicationErrorMap.ModernBootStageToTimeoutErrorNameMap[n]){t&&t.ULS.traceTag(557417806,logCategory.PptSession,logLevel.Error,"TimeoutWrapper: "+n+" not exist in map");return}this.errorName=ApplicationErrorMap.ModernBootStageToTimeoutErrorNameMap[n].errorName;this.m_callbackTimeoutError.ErrorName=this.errorName;this.errorCode=ApplicationErrorMap.ModernBootStageToTimeoutErrorNameMap[n].errorCode;this.m_callbackTimeoutError.Code=this.errorCode;this.m_callbackTimeoutError.ExtraInfo="Boot timeout at "+n;this.m_callbackTimeoutError.errorObject="Timed out waiting for boot at "+n;var i=this.m_bootStageInfo.length;this.m_bootStageInfo[i-1].e=Date.now();this.m_bootStageInfo[i]={n:n,s:Date.now()}}catch(r){t&&t.ULS.traceTag(557434064,logCategory.PptSession,logLevel.Error,"TimeoutWrapper: exception in tryUpdateTimeoutErrorStage: "+r)}},n.prototype.setAppInitDiagnostics=function(n){this.m_appInitDiagnostics=n},n.prototype.logCallbackArrivedAfterTimeout=function(n,t,i,r){var u={};u.Message="Received "+n+" callback after timeout had elapsed";u.timeoutTimeMs=this.m_onTimeoutTicks;u.successTimeMs=this.m_onSuccessTicks;u.startTimeMs=this.m_initialTicks;u.appInitDiagnostics=t;r&&(u.error=r);i&&i.ULS.traceTag(38589660,logCategory.PptSession,logLevel.Info,JSON.stringify(u))},n.prototype.timeoutIfSuccessNotCalled=function(n,t,i){var r;if(!this.m_onFailureTicks&&!this.m_onSuccessTicks&&!this.m_onTimeoutTicks&&!this.m_aborted){this.m_onTimeoutTicks=Date.now();try{PPTPreviewerBootstrapperUtils.tryGetHostNetworkMetricsFromCallback(n,t);var u=n.Container,f=!HTMLHelper.isInDomTree(u),e=this.m_bootStageInfo.length;this.m_bootStageInfo[e-1].e=Date.now();f?t&&(t.ULS.traceTag(579604899,logCategory.PptSession,logLevel.Warning,"App container is unloaded. Scenario: "+this.m_scenario),PPTBootstrapperLogger.recordBootCompleted(n,7,"AppContainerUnloadedTimeout","App container is unloaded",t,this.m_onTimeoutTicks,this.m_appErrors,undefined,this.m_bootStageInfo.length>1?this.m_bootStageInfo:[])):(t&&(r="Timed out waiting for FnOnInitializeSuccess to be called. startMs:"+this.m_initialTicks+", timeoutMs:"+this.m_onTimeoutTicks+", scenario:"+this.m_scenario+", hostSessionId:"+this.m_hostSessionId+", host: "+this.m_host,t.ULS.traceTag(38589661,logCategory.PptSession,logLevel.Error,r),i&&i.recordQosError(this.errorName,["FileOpenFailed"],!1,!0,!0,!0),n.SessionInformation.PreviousSessionErrorName=this.errorName,PPTBootstrapperLogger.recordBootstrapperTimeoutFailure(n,this.errorCode,this.errorName,r,t,this.m_onTimeoutTicks,this.m_appErrors,this.m_bootStageInfo.length>1?this.m_bootStageInfo:[])),this.m_bootStageInfo.length>1&&t.ULS.traceTag(557434065,logCategory.PptSession,logLevel.Error,"Timeout boot stage info: "+JSON.stringify(this.m_bootStageInfo)),n.FnOnInitializeFailure&&n.FnOnInitializeFailure(this.m_callbackTimeoutError,this.m_appInitDiagnostics))}catch(o){t&&t.ULS.traceTag(579604898,logCategory.PptSession,logLevel.Error,"timeoutIfSuccessNotCalled exception: "+o)}}},n}(),QueryStringParamForwarder=function(){function n(){}return n.forward=function(n,t){return!n||n.substr(0,2)!=="wd"||this.noForwardArray.indexOf(n)>=0?null:n+"="+t},n.noForwardArray=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"],n}(),UrlOverrideUtils=function(){function n(){}return n.forwardMissingWdParamsFromApplicationUrl=function(n,t){var e=t.indexOf("?"),i,u,s,r,f;if(-1===e)return n;var h=t.substr(e+1),c=h.split("&"),o=n;for(i=0,u=c;i<u.length;i++)s=u[i],r=s.split("="),UrlUtils.getParameterValue(n,r[0])===""&&(f=QueryStringParamForwarder.forward(r[0],r[1]),f&&(o+="&"+f));return o},n}(),UrlUtils=function(){function n(){}return n.getParameterValue=function(n,t){var i=n.indexOf("&"+t+"="),r,u;return(i===-1&&(i=n.indexOf("?"+t+"=")),i===-1)?"":(r=i+(t.length+2),u=n.indexOf("&",r),u===-1)?n.substr(r):n.substring(r,u)},n.getParameterValueDecoded=function(n,t){var i=this.getParameterValue(n,t);return i?decodeURI(i):i},n.addOrReplaceParameterValue=function(n,t,i){var u;if(!t)return n;var r=n,f=i==null,s=r.indexOf("?");if(-1===s)return f?n:r+"?"+t+"="+i;var h=r.substr(s+1),e=h.split("&"),o=t+"=",c=!1;for(u=0;u<e.length;u=u+1)if(0===e[u].indexOf(o)){r=r.replace(e[u],f?"":o+i);c=!0;break}return c||f||(h.length>0&&(r+="&"),r+=o+i),r},n.getQueryStringParam=function(n){return this.getParameterValue(window.location.href,n)},n.urlKeyValueEncode=function(n){var t=encodeURIComponent(n);return this.encodeString(t,this.urlKeyValueEncodeReplacements)},n.encodeString=function(n,t){for(var r=n,u=t.length,i=0;i<u;i=i+1)r=r.replace(t[i].FindExpression,t[i].ReplaceValue);return r},n.getHostname=function(n){if(!n)return"";var t=document.createElement("a");return t.href=n,t.hostname},n.urlKeyValueEncodeReplacements=[{FindExpression:new RegExp("!","g"),ReplaceValue:"%21"},{FindExpression:new RegExp("'","g"),ReplaceValue:"%27"},{FindExpression:new RegExp("\\(","g"),ReplaceValue:"%28"},{FindExpression:new RegExp("\\)","g"),ReplaceValue:"%29"},{FindExpression:new RegExp("\\*","g"),ReplaceValue:"%2A"}],n}();var WacFallbackController=function(){function n(n,t,i,r,u,f,e){this.BootFailed=!1;this.InitializeWopiPendingParameters=n;this.m_forceWacFallback=t;this.GetFallbackUrl=i;this.OnSuccessWopiInfoCallback=r;this.logger=u;this.windowVisibilityMetrics=f;this.m_postMessageToken=e}return n.prototype.wopiPendingApplicationComplete=function(n,t){this.m_forceWacFallback||this.BootFailed?PPTBootstrapper.launchWacFallback(n,this.InitializeWopiPendingParameters,this.GetFallbackUrl,this.BootFailureInfo,this.logger,this.windowVisibilityMetrics,this.m_postMessageToken):(this.ReturnedWopiInfo=n,this.OnSuccessWopiInfoCallback&&this.OnSuccessWopiInfoCallback(this.ReturnedWopiInfo,t))},n.prototype.wopiPendingApplicationFail=function(){this.logger.ULS.traceTag(38293905,logCategory.PptSession,logLevel.Info,"Host failed to give us WopiInfo")},n}(),WindowVisibilityMetrics=function(){function n(){var t=this,n;this.visibilityChangeEvents=[];this.handleVisibilityChange=function(){var n={visibility:document.visibilityState,time:Date.now(),initialState:!1};t.visibilityChangeEvents.push(n)};document.visibilityState==="hidden"&&(n={visibility:document.visibilityState,time:Date.now(),initialState:!0},this.visibilityChangeEvents.push(n));document.addEventListener("visibilitychange",this.handleVisibilityChange)}return n.prototype.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},n.prototype.getVisibilityChangeEvents=function(){return this.visibilityChangeEvents},n}(),WebViewerBaseMessage=function(){function n(n,t){this.m_id=n;this.m_type=t}return n}(),WebViewerBaseInternalMessage=function(){function n(n){this.m_type=n}return n}(),HandshakeWebViewerInternalMessage=function(n){function t(t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){var ut=n.call(this,0)||this;return ut.m_id=t,ut.m_fEnableKeyboardNavigation=i,ut.m_contentMetadata=r,ut.m_fileUrl=u,ut.m_fileSize=f,ut.m_fileName=e,ut.m_presentationId=o,ut.m_startingSlideId=s,ut.m_startingSlideIndex=h,ut.m_hostName=c,ut.m_entryPoint=l,ut.m_apiStartTime=a,ut.m_documentClickTime=v,ut.m_hostInitTime=y,ut.m_fEnableAdvanceOnTap=p,ut.m_fileHost=w,ut.m_vetoAppSettingsStr=b,ut.m_disabledTransitionsList=k,ut.m_customTransitionResourceUrl=d,ut.m_streamUseThinEmbed=g,ut.m_disabledChangeGates=nt,ut.m_wacRegion=tt,ut.m_areThirdPartyAddInsAllowed=it,ut.m_allowExternalMarketplace=rt,ut}return __extends(t,n),t}(WebViewerBaseInternalMessage),BootTimingFromApiInternalMessage=function(n){function t(t){var i=n.call(this,26)||this;return i.m_apiTimings=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),RecordStartedSlideShowTimestampInternalMessage=function(n){function t(t){var i=n.call(this,33)||this;return i.m_startSlideShowTime=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),PowerPointWebViewerEventHandlerList=function(){function n(){this.m_list=[]}return n.prototype.Add=function(n){for(var t=0;t<this.m_list.length;t++)if(this.m_list[t]==n)return;this.m_list.push(n)},n.prototype.Remove=function(n){for(var t=0;t<this.m_list.length;++t)if(this.m_list[t]==n){this.m_list.splice(t,1);return}},n.prototype.Get=function(n){return n<this.m_list.length?this.m_list[n]:null},n.prototype.Clear=function(){this.m_list.length=0},n.prototype.Length=function(){return this.m_list.length},n}(),PreviewSessionManagerV0=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this.m_automationDiv=null;this.m_hitNetworkHealthEvent=!1;this.m_anchor=n;this.m_iframe=t;this.m_frameContainerContext=i;this.m_id=r;this.m_bootedCached=u;this.m_appVersion=f;this.m_slideShowKind=e;this.m_initParams=o;this.m_percievedBootTime=s;this.m_disposeCallback=h;this.m_logger=c;this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,{});this.m_timeoutWrapper=l===null||l===void 0?void 0:l.timeoutWrapper;this.m_eventHandlers=new PowerPointWebViewerEventHandlerList;try{StateServiceClientLoader.SendMessage(new RecordMetricsWebViewerInternalMessage("PostMessageReady",{}))}catch(a){this.m_logger.ULS.traceTag(512336899,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage PostMessageReady error "+a)}}return n.prototype.dispose=function(){this.Dispose()},n.prototype.Dispose=function(){this.ExitSlideshow();this.m_logger.ULS.traceTag(39203540,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::Dispose - removing anchor:"+(this.m_anchor!=null).toString());this.m_automationDiv=null;this.m_iframe!=null&&(this.m_iframe.src="");this.m_anchor!=null&&this.m_anchor.parentNode!=null&&this.m_anchor.parentNode.removeChild(this.m_anchor);this.m_anchor=null;this.m_iframe=null;this.m_eventHandlers.Clear();try{StateServiceClientLoader.TryDisconnectStateService(this.m_logger)}catch(n){this.m_logger.ULS.traceTag(571355283,logCategory.PptSession,logLevel.Error,"PreviewSessionManagerV0::Dispose StateServiceClient error "+n)}this.m_disposeCallback(this.m_id)},n.prototype.GetApplicationType=function(){return"PowerPoint"},n.prototype.GetVersion=function(){return this.m_appVersion},n.prototype.GetSessionId=function(){return this.m_id},n.prototype.GetPercievedBoot=function(){return this.m_percievedBootTime||null},n.prototype.UsingCached=function(){return this.m_bootedCached},n.prototype.GetIsDisabled=function(){return!1},n.prototype.log=function(n){this.m_logger.ULS.traceTag(39978267,logCategory.PptSession,logLevel.Info,n)},n.prototype.onMessage=function(t,i){var k,d,g,a,nt,o,v,f,et,tt,ot,s,y,st,ht,u,r,p,ct,it,rt,c,l,lt,w,ut,b,ft,h,at,vt,yt,pt,wt,e;if(this.m_frameContainerContext.isReceivedMessageValid(t,i)){t=t;switch(t.m_type){case WebViewerMessageType.GetSlidesInShowCount:a=t;!isNaN(a.m_slidesCount)&&a.m_slidesCount>=0&&this.TriggerEvent(new GetSlidesInShowCountParams(a.m_slidesCount));break;case WebViewerMessageType.GetTimeLineInfos:nt=t;nt.m_timeLineInfos!=null&&this.TriggerEvent(new GetTimeLineInfosParams(nt.m_timeLineInfos));break;case WebViewerMessageType.GetCurrentPosition:o=t;!isNaN(o.m_slideIndex)&&o.m_slideIndex>=0&&!isNaN(o.m_slideId)&&o.m_slideId>=0&&o.m_timeLineMappings!=null&&(this.m_lastPositionWebViewerMessage=o,this.TriggerEvent(new GetCurrentPositionParams(o.m_slideIndex,o.m_slideId,o.m_timeLineMappings)));break;case WebViewerMessageType.GetId:v=t;!isNaN(v.m_slideId)&&v.m_slideId>=0&&this.TriggerEvent(new GetIdParams(v.m_slideId));break;case WebViewerMessageType.OnPositionChanged:f=t;f.m_metadata&&(f.m_metadata.Bootstrapper_Notified=Date.now());!isNaN(f.m_slideIndex)&&f.m_slideIndex>=0&&!isNaN(f.m_slideId)&&f.m_slideId>=0&&f.m_timeLineMappings!=null&&(this.m_lastPositionWebViewerMessage=f,this.TriggerEvent(new OnPositionChangedParams(f.m_slideIndex,f.m_slideId,f.m_timeLineMappings,f.m_metadata)));break;case WebViewerMessageType.TogglePrivateViewing:et=t;this.TriggerEvent(new TogglePrivateViewingParams(et.m_enabled));break;case WebViewerMessageType.GoToPresenter:this.TriggerEvent(new GoToPresenterParams);break;case WebViewerMessageType.CopyFileLinktoClipboard:this.TriggerEvent(new CopyFileLinktoClipboardParams);break;case WebViewerMessageType.PasteFileLinktoChat:this.TriggerEvent(new PasteFileLinktoChatParams);break;case WebViewerMessageType.ShowWeatherPerson:tt=t;this.TriggerEvent(new ShowWeatherPersonParams(tt.m_show,tt.m_metadata));break;case WebViewerMessageType.RoleChangedOutbound:ot=t;this.TriggerEvent(new RoleChangedOutboundParams(ot.m_role));break;case WebViewerMessageType.MediaEvent:s=t;n.IsValidMediaEventType(s.m_mediaEventType)&&this.TriggerEvent(new OnMediaEventParams(s.m_mediaPlayerName,s.m_mediaEventType,s.m_mediaPosition,s.m_mediaHostName,s.m_mediaVolume,s.m_metadata));break;case WebViewerMessageType.GetCurrentMediaStates:y=t;this.TriggerEvent(new GetCurrentMediaStatesParams(y.m_slideIndex,y.m_slideId,y.m_mediaStates));break;case WebViewerMessageType.GetPresentationPlaybackState:st=t;this.TriggerEvent(new GetPresentationPlaybackStateParams(st.m_playbackState));break;case WebViewerMessageType.OnPresentationPlaybackStateChanged:ht=t;this.TriggerEvent(new OnPresentationPlaybackStateChangedParams(ht.m_playbackState));break;case WebViewerMessageType.GetCurrentSlideDimensions:u=t;!isNaN(u.m_slideWidth)&&u.m_slideWidth>=0&&!isNaN(u.m_slideHeight)&&u.m_slideHeight>=0&&(!isNaN(u.m_slideLeftBound)&&u.m_slideLeftBound>=0&&!isNaN(u.m_slideBottomBound)&&u.m_slideBottomBound>=0?this.TriggerEvent(new GetCurrentSlideDimensionsParams(u.m_slideWidth,u.m_slideHeight,u.m_slideLeftBound,u.m_slideBottomBound)):this.TriggerEvent(new GetCurrentSlideDimensionsParams(u.m_slideWidth,u.m_slideHeight,-1,-1)));break;case WebViewerMessageType.OnError:r=t;!isNaN(r.m_code)&&r.m_code>=0?(r.m_message=r.m_message?r.m_message:"",p=ErrorCategory.Fatal,ct=r.m_code+"_"+p+"_"+r.m_message+"_"+r.m_extraInfo+"_"+r.m_correlationId,this.m_logger.ULS.traceTag(553673368,logCategory.PptSession,logLevel.Info,"OnError Called with error code:"+r.m_code+", and message:"+r.m_message),this.AddAutomationData("OnError",ct),this.TriggerEvent(new OnErrorParams(p,r.m_message,r.m_extraInfo,r.m_sessionId,r.m_correlationId)),this.TriggerEvent(new OnApiErrorParams(r.m_code,p,r.m_extraInfo,r.m_sessionId))):this.m_logger.ULS.traceTag(553673369,logCategory.PptSession,logLevel.Warning,"OnError Called with invalid error code:"+r.m_code+", and message:"+r.m_message);break;case WebViewerMessageType.OnSpecialKey:it=t;n.FIsUintValid(it.m_key)&&this.TriggerEvent(new OnSpecialKeyParams(it.m_key));break;case WebViewerMessageType.OnUlsLog:rt=t;rt.m_logs&&this.TriggerEvent(new OnUlsLogParams(rt.m_logs));break;case WebViewerMessageType.OnNetworkHealthChanged:if(c=t,c.m_isHealthy===undefined)return;c.m_addTimeoutTimeMs&&((k=this.m_timeoutWrapper)===null||k===void 0?void 0:k.addTimeIfNotAddedInMs(c.m_addTimeoutTimeMs));c.m_isHealthy?(d=this.m_timeoutWrapper)===null||d===void 0?void 0:d.resume():(g=this.m_timeoutWrapper)===null||g===void 0?void 0:g.pause();break;case WebViewerMessageType.OnBrowserEvent:l=t;l.m_event&&this.TriggerEvent(new OnBrowserEventParams(l.m_event,l.m_clientX,l.m_clientY));break;case WebViewerMessageType.OnEnterEndOfSlideshow:this.TriggerEvent(new OnEnterEndOfSlideshowParams);break;case WebViewerMessageType.OnLeaveEndOfSlideshow:this.TriggerEvent(new OnLeaveEndOfSlideshowParams);break;case WebViewerMessageType.OnContentRefreshBegin:lt=t;this.TriggerEvent(new ContentRefreshBeginParams(lt.m_reason));break;case WebViewerMessageType.OnContentRefreshEnd:this.TriggerEvent(new ContentRefreshEndParams);this.GetSlidesInShowCount();break;case WebViewerMessageType.OnExitSlideshow:w=t;this.TriggerEvent(new OnExitSlideshowParams(w.m_slideId,w.m_slideIndex,w.m_isFromEndOfSlideshow));break;case WebViewerMessageType.OnContextMenu:ut=t;this.TriggerEvent(new OnContextMenuParams(ut.m_clientX,ut.m_clientY));break;case WebViewerMessageType.OnPodSessionExpired:b=t;this.TriggerEvent(new OnPodSessionExpiredParams(b.m_code,b.m_reason,b.m_podSessionId));break;case WebViewerMessageType.OnRenderedToBuffer:ft=t;this.TriggerEvent(new OnRenderedToBufferParams(ft.m_slideIndex,ft.m_img));break;case WebViewerMessageType.RecordQosError:h=t;this.TriggerEvent(new RecordQosErrorParams(h.m_errorName,h.m_vetoName,h.m_isIntentional,h.m_isInternal,h.m_alertOnPillar,h.m_isSessionEndingError,h.m_durationMs));break;case WebViewerMessageType.OnSlideViewBoundsChanged:at=t;this.TriggerEvent(new OnSlideViewBoundsChangedParams(at.m_slideViewBounds));break;case WebViewerMessageType.CameoDetectedInPresentation:vt=t;this.TriggerEvent(new CameoDetectedInPresentationParams(vt.m_fCameoDetectedInPresentation));break;case WebViewerMessageType.CameoFrameRequestForSlide:yt=t;this.TriggerEvent(new CameoFrameRequestForSlideParams(yt.m_cameoInSlide));break;case WebViewerMessageType.RenderingModeChangedToSVG:this.TriggerEvent(new RenderingModeChangedToSVGParams);break;case WebViewerMessageType.BlankSlideState:pt=t;this.TriggerEvent(new BlankSlideStateParams(pt.m_blankSlideState));break;case WebViewerMessageType.AadTokenRequest:wt=t;this.m_logger.ULS.traceTag(574386265,logCategory.PptSession,logLevel.Info,"AAD Token Auth: Sent request to Host");this.TriggerEvent(new AadTokenRequestParams(wt.m_resourceId));break;case WebViewerMessageType.FrameTrustCheck:this.m_initParams.ApplicationCustomSettings.OverrideFrameTrustCheck?this.TriggerEvent(new FrameTrustCheckParams):this.SetFrameTrustStatus(this.defaultFrameTrustCheck());break;case WebViewerMessageType.StartCoach:this.TriggerEvent(new StartCoachParams);break;case WebViewerMessageType.StopCoach:this.TriggerEvent(new StopCoachParams);break;case WebViewerMessageType.CheckCoachStatus:this.TriggerEvent(new CheckCoachStatusParams);break;case WebViewerMessageType.TakeControl:e=t;e.m_metadata&&(e.m_metadata.Bootstrapper_Notified=Date.now());!isNaN(e.m_slideIndex)&&e.m_slideIndex>=0&&!isNaN(e.m_slideId)&&e.m_slideId>=0&&e.m_timeLineMappings!=null&&this.TriggerEvent(new TakeControlParams(e.m_slideIndex,e.m_slideId,e.m_timeLineMappings,e.m_metadata));break;case WebViewerMessageType.MediaDetectedInPresentation:this.TriggerEvent(new MediaDetectedInPresentation)}}},n.prototype.defaultFrameTrustCheck=function(){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(n){}return!1},n.ValidateTimeLineMappings=function(t){var i=!Array.isArray(t),r;if(!i)for(r in t)if(t[r].TimeLineId==null||!n.FIsUintValid(t[r].Step)){i=!0;break}if(i)throw Error("ValidateTimeLineMappings");return t},n.prototype.AddAutomationData=function(n,t){this.EnsureAutomationDiv();var i=document.createElement("p");i.innerText=n+":"+t;this.m_automationDiv.appendChild(i)},n.FIsUintValid=function(n){return!(n==null||n<0||isNaN(n))},n.IsValidMediaEventType=function(n){return n>=0&&n<=4},n.prototype.EnsureAutomationDiv=function(){this.m_automationDiv||(this.m_automationDiv=document.createElement("div"),this.m_automationDiv.id="pptAutomation-"+this.m_id,this.m_automationDiv.style.visibility="hidden",this.m_anchor.appendChild(this.m_automationDiv))},n.prototype.TriggerEvent=function(n){for(var i,t=0;t<this.m_eventHandlers.Length();++t)i=this.m_eventHandlers.Get(t),i(n)},n.prototype.PostMessageDownward=function(n){if(!this.m_iframe){this.m_logger.ULS.traceTag(39203541,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageDownward iframe is null");return}this.m_frameContainerContext&&this.m_frameContainerContext.postMessageDownward(n)},n.prototype.PostMessageWithArrayBufferDownward=function(n,t){if(!this.m_iframe){this.m_logger.ULS.traceTag(556672282,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageWithArrayBufferDownward iframe is null");return}this.m_frameContainerContext&&this.m_frameContainerContext.postMessageWithArrayBufferDownward(n,t)},n.prototype.GetSlidesInShowCount=function(){var n=new GetSlidesInShowCountWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetTimeLineInfos=function(t){if(n.FIsUintValid(t)){var i=new GetTimeLineInfosWebViewerInternalMessage(t);this.PostMessageDownward(i)}},n.prototype.GetCurrentPosition=function(){var n=new GetCurrentPositionWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetCurrentPositionWithTimeLines=function(){var n=new GetCurrentPositionWithTimeLinesWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetCurrentSlideDimensions=function(){var n=new GetCurrentSlideDimensionsWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetId=function(t){n.FIsUintValid(t)&&this.PostMessageDownward(new GetIdWebViewerInternalMessage(t))},n.prototype.Next=function(n){this.PostMessageDownward(new NextWebViewerInternalMessage(n))},n.prototype.PausePresentation=function(){this.PostMessageDownward(new PausePresentationWebViewerInternalMessage)},n.prototype.PlayPresentation=function(){this.PostMessageDownward(new PlayPresentationWebViewerInternalMessage)},n.prototype.GetPresentationPlaybackState=function(){this.PostMessageDownward(new GetPresentationPlaybackStateInternalMessage)},n.prototype.NextSlide=function(){this.PostMessageDownward(new NextSlideWebViewerInternalMessage)},n.prototype.Prev=function(n){this.PostMessageDownward(new PrevWebViewerInternalMessage(n))},n.prototype.PrevSlide=function(){this.PostMessageDownward(new PrevSlideWebViewerInternalMessage)},n.prototype.GoToNextSlide=function(){this.PostMessageDownward(new GoToNextSlideWebViewerInternalMessage)},n.prototype.GoToPrevSlide=function(){this.PostMessageDownward(new GoToPrevSlideWebViewerInternalMessage)},n.prototype.GoToSlide=function(t,i,r){if(n.FIsUintValid(t)&&n.ValidateTimeLineMappings(i)){try{typeof t=="string"&&(t=parseInt(t))}catch(u){this.m_logger.ULS.traceTag(559708181,logCategory.PptSession,logLevel.Error,"Failed to parse go To Slide Index value. Received value: "+t+". Exception: "+u)}r&&(r.Bootstrapper_Local=Date.now());this.PostMessageDownward(new GoToSlideWebViewerInternalMessage(t,i,r));try{StateServiceClientLoader.SendMessage(new RecordMetricsWebViewerInternalMessage("NavigationMetadata",r||{}))}catch(u){this.m_logger.ULS.traceTag(557175650,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage GoToSlide error "+u)}}else this.m_logger.ULS.traceTag(570730066,logCategory.PptSession,logLevel.Warning,"GoToSlide: Invalid slideIndex: "+t+", or timelineMapping: "+JSON.stringify(i))},n.prototype.GoToSlideId=function(t,i){n.FIsUintValid(t)&&n.ValidateTimeLineMappings(i)&&this.PostMessageDownward(new GoToSlideIdWebViewerInternalMessage(t,i))},n.prototype.SwitchRole=function(n){this.m_logger.ULS.traceTag(578671050,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::SwitchRoleWebViewerInternalMessage role="+n.toString());this.PostMessageDownward(new SwitchRoleWebViewerInternalMessage(n));this.PostMessageDownward(new SwitchRoleV2WebViewerInternalMessage(n));try{StateServiceClientLoader.SendMessage(new SwitchRoleV2WebViewerInternalMessage(n))}catch(t){this.m_logger.ULS.traceTag(561111502,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage SwitchRole error "+t)}},n.prototype.SendiOSAuthTokenWithConfigs=function(n){this.m_logger.ULS.traceTag(543307339,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::SendiOSAuthTokenWithConfigInternalMessage sending configs");try{StateServiceClientLoader.SendMessage(new SendiOSAuthTokenWithConfigInternalMessage(n))}catch(t){this.m_logger.ULS.traceTag(545032028,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage SendiOSAuthTokenWithConfigs error "+t)}},n.prototype.ChangeTheme=function(n,t){this.PostMessageDownward(new ChangeThemeWebViewerInternalMessage(n,t))},n.prototype.SendPresenterStateDuringPrivateViewing=function(n,t,i){this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForAttendee&&this.PostMessageDownward(new SendPresenterStateDuringPrivateViewingInternalMessage(n,t,i))},n.prototype.PlayMedia=function(n,t){this.PostMessageDownward(new PlayMediaInternalMessage(n,t))},n.prototype.PauseMedia=function(n,t){this.PostMessageDownward(new PauseMediaInternalMessage(n,t))},n.prototype.RestoreFocus=function(){this.PostMessageDownward(new RestoreFocusInternalMessage)},n.prototype.StopMedia=function(n,t){this.PostMessageDownward(new StopMediaInternalMessage(n,t))},n.prototype.SeekMedia=function(n,t,i){this.PostMessageDownward(new SeekMediaInternalMessage(n,t,i))},n.prototype.SetMediaVolume=function(n,t,i){this.PostMessageDownward(new SetMediaVolumeInternalMessage(n,t,i))},n.prototype.GetCurrentMediaStates=function(){this.PostMessageDownward(new GetCurrentMediaStatesInternalMessage)},n.prototype.ExitSlideshow=function(){this.PostMessageDownward(new ExitSlideshowInternalMessage)},n.prototype.RefreshPodSession=function(n,t){this.PostMessageDownward(new RefreshPodSessionInternalMessage(n,t))},n.prototype.SetNavigationOptions=function(n,t){this.PostMessageDownward(new SetNavigationOptionsMessage(n,t))},n.prototype.ShowHideCursor=function(n){this.PostMessageDownward(new ShowHideCursorWebViewerInternalMessage(n))},n.prototype.PostMessageToInkManager=function(n,t){this.PostMessageDownward(new InkManagerInternalMessage(n,t))},n.prototype.PPTSharingLayoutChanged=function(n){n===void 0&&(n="ContentOnly");this.m_logger.ULS.traceTag(541885442,logCategory.PptSession,logLevel.Info,"PPTSharingLayoutChanged: sharingLayoutMode "+n);this.PostMessageDownward(new PPTSharingLayoutChangedInternalMessage(n))},n.prototype.SetAadToken=function(n){this.m_logger.ULS.traceTag(574386266,logCategory.PptSession,logLevel.Info,"AAD Token Auth: Sent response to PPT");this.PostMessageDownward(new SetAadTokenInternalMessage(n))},n.prototype.SetFrameTrustStatus=function(n){n||this.m_logger.ULS.traceTag(523077399,logCategory.PptSession,logLevel.Warning,"Trust check failed");this.PostMessageDownward(new SetFrameTrustStatusInternalMessage(n))},n.prototype.SetPrivateViewingToggle=function(n){this.m_logger.ULS.traceTag(573137920,logCategory.PptSession,logLevel.Info,"Attendee received private viewing is now "+n?"enabled":"disabled");this.PostMessageDownward(new SetPrivateViewingToggleInternalMessage(n))},n.prototype.UpdateMeetingCoachStatus=function(n){this.PostMessageDownward(new UpdateMeetingCoachStatusInternalMessage(n))},n.prototype.UpdateBufferInfoForCameo=function(n){this.PostMessageDownward(new UpdateBufferInfoForCameoInternalMessage(n))},n.prototype.VideoFrameToPptForCameo=function(n,t){this.PostMessageWithArrayBufferDownward(n,t)},n.prototype.UpdatePresenterName=function(n){this.m_logger.ULS.traceTag(521175364,logCategory.PptSession,logLevel.Info,"Update presenter name in PPT");this.PostMessageDownward(new UpdatePresenterNameInternalMessage(n))},n.prototype.ReturnToPresenterInbound=function(){this.PostMessageDownward(new ReturnToPresenterInboundInternalMessage)},n.prototype.CustomBackgroundForAPL=function(n){this.m_logger.ULS.traceTag(528263117,logCategory.PptSession,logLevel.Info,"CustomBackgroundForAPL image URL: "+n);this.PostMessageDownward(new CustomBackgroundForAPLInternalMessage(n))},n.prototype.SetGlobalMute=function(n){this.m_logger.ULS.traceTag(525162530,logCategory.PptSession,logLevel.Info,"Global Mute: Sent updated Muted value to PPT: "+n);this.PostMessageDownward(new SetGlobalMuteInternalMessage(n))},n.prototype.HideCameo=function(n,t){this.m_logger.ULS.traceTag(520734491,logCategory.PptSession,logLevel.Info,"Hide cameo: "+n+"reason: "+t);this.PostMessageDownward(new HideCameoInternalMessage(n,t))},n.prototype.SetLaserPointerActivation=function(n,t){this.m_logger.ULS.traceTag(525115935,logCategory.PptSession,logLevel.Info,"Laser Pointer Activation: sent activation value to PPT: "+n+", with metadata:"+JSON.stringify(t));this.PostMessageDownward(new SetLaserPointerActivationInternalMessage(n,t))},n.prototype.SendSessionMetadata=function(n,t){try{n!=null&&t!=null?(this.m_logger.ULS.traceTag(588804101,logCategory.PptSession,logLevel.Info,n+": "+JSON.stringify(t)),n=="NavMetric"&&this.PostMessageDownward(new RecordMetricsWebViewerInternalMessage("TeamsNavMetric",t))):this.m_logger.ULS.traceTag(588804100,logCategory.PptSession,logLevel.Warning,"SendSessionMetadata called with null params")}catch(i){this.m_logger.ULS.traceTag(588804099,logCategory.PptSession,logLevel.Error,"SendSessionMetadata error: "+JSON.stringify(i))}},n.prototype.onSliceLoaded=function(){},n.prototype.AddEventHandler=function(n){n&&this.m_eventHandlers.Add(n)},n.prototype.RegisterEventHandler=function(n,t){var i=this;t||(t=n,n="*");n=="*"&&this.m_eventHandlers.Add(function(n){i.filterEventOrErrorHandler(n,!1,t)});n=="ContentRefreshBegin"&&this.m_eventHandlers.Add(function(n){n.EventType==21&&t(n)});n=="ContentRefreshEnd"&&this.m_eventHandlers.Add(function(n){n.EventType==22&&t(n)})},n.prototype.RegisterErrorHandler=function(n){var t=this;n&&this.m_eventHandlers.Add(function(i){t.filterEventOrErrorHandler(i,!0,n)})},n.prototype.RemoveEventHandler=function(n,t){var i=this;t||(t=n,n="*");n=="*"&&this.m_eventHandlers.Remove(function(n){i.filterEventOrErrorHandler(n,!1,t)});n=="ContentRefreshBegin"&&this.m_eventHandlers.Remove(function(n){n.EventType==21&&t(n)});n=="ContentRefreshEnd"&&this.m_eventHandlers.Remove(function(n){n.EventType==22&&t(n)});n||this.m_eventHandlers.Remove(t)},n.prototype.RemoveErrorHandler=function(n){var t=this;n&&this.m_eventHandlers.Remove(function(i){t.filterEventOrErrorHandler(i,!0,n)})},n.prototype.filterEventOrErrorHandler=function(n,t,i){if(n.EventType==13&&t){var r=n;i(r)}n.EventType==13||t||i(n)},n}(),PreviewAPIV0Factory=function(){function n(){}return n.prototype.GetPreviewAPIV1=function(n,t,i,r,u,f,e,o,s,h,c,l){return new PreviewSessionManagerV0(n,t,i,r,u,f,e,o,s,h,c,l)},n}(),ViewerEventParams=function(){function n(n){this.EventType=n}return n}(),ViewerEventType=function(){function n(){}return n.GetSlidesInShowCount=0,n.GetTimeLineInfos=1,n.GetCurrentPosition=2,n.GetId=3,n.GetPresentationName=4,n.OnPositionChanged=5,n.OnPresentationOpened=6,n.GetCurrentSlideDimensions=7,n.OnMediaEvent=9,n.GetCurrentMediaStates=10,n.OnError=11,n.OnSpecialKey=12,n.OnApiError=13,n.OnUlsLog=14,n.OnNetworkHealthChanged=15,n.GetPresentationPlaybackState=16,n.OnPresentationPlaybackStateChanged=17,n.OnBrowserEvent=18,n.OnEnterEndOfSlideshow=19,n.OnLeaveEndOfSlideshow=20,n.ContentRefreshBegin=21,n.ContentRefreshEnd=22,n.OnExitSlideshow=23,n.OnContextMenu=24,n.GoToPresenter=25,n.OnPodSessionExpired=27,n.OnRenderedToBuffer=28,n.RecordQosError=33,n.TogglePrivateViewing=47,n.OnSlideViewBoundsChanged=48,n.AadTokenRequest=49,n.StartCoach=50,n.StopCoach=51,n.CheckCoachStatus=52,n.BlankSlideState=54,n.ShowWeatherPerson=55,n.RoleChangedOutbound=57,n.PasteFileLinktoChat=60,n.CopyFileLinktoClipboard=61,n.CameoDetectedInPresentation=66,n.CameoFrameRequestForSlide=67,n.RenderingModeChangedToSVG=68,n.FrameTrustCheck=69,n.TakeControl=72,n.MediaDetectedInPresentation=73,n}(),OnApiErrorParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.OnApiError)||this;return f.Code=t,f.Category=i,f.ExtraInfo=r,f.SessionId=u,f.errorType=f.EventType.toString(),f.errorObject=null,f}return __extends(t,n),t}(ViewerEventParams),GetSlidesInShowCountParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetSlidesInShowCount)||this;return i.SlidesCount=t,i}return __extends(t,n),t}(ViewerEventParams),GetTimeLineInfosParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetTimeLineInfos)||this;return i.TimeLineInfos=t,i}return __extends(t,n),t}(ViewerEventParams),GetCurrentPositionParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.GetCurrentPosition)||this;return u.SlideIndex=t,u.SlideId=i,u.TimeLineMappings=r,u}return __extends(t,n),t}(ViewerEventParams),GetCurrentSlideDimensionsParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.GetCurrentSlideDimensions)||this;return f.SlideWidth=t,f.SlideHeight=i,f.SlideLeftBound=r,f.SlideBottomBound=u,f}return __extends(t,n),t}(ViewerEventParams),GetIdParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetId)||this;return i.SlideId=t,i}return __extends(t,n),t}(ViewerEventParams),OnPositionChangedParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.OnPositionChanged)||this;return f.SlideIndex=t,f.SlideId=i,f.TimeLineMappings=r,f.Metadata=u,f}return __extends(t,n),t}(ViewerEventParams),OnPresentationPlaybackStateChangedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnPresentationPlaybackStateChanged)||this;return i.PlaybackState=t,i}return __extends(t,n),t}(ViewerEventParams),OnMediaEventParams=function(n){function t(t,i,r,u,f,e){var o=n.call(this,ViewerEventType.OnMediaEvent)||this;return o.MediaPlayerName=t,o.MediaEventType=i,o.MediaPosition=r,o.MediaVolume=f,u&&(o.MediaHostName=u),o.Metadata=e?e:{},o}return __extends(t,n),t}(ViewerEventParams),GetCurrentMediaStatesParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.GetCurrentMediaStates)||this;return u.SlideIndex=t,u.SlideId=i,u.MediaStates=r,u}return __extends(t,n),t}(ViewerEventParams),GetPresentationPlaybackStateParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetPresentationPlaybackState)||this;return i.PlaybackState=t,i}return __extends(t,n),t}(ViewerEventParams),OnPresentationOpenedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnPresentationOpened)||this;return i.SessionId=t,i}return __extends(t,n),t}(ViewerEventParams),OnErrorParams=function(n){function t(t,i,r,u,f){var e=n.call(this,ViewerEventType.OnError)||this;return e.Category=t,e.Message=i,e.ExtraInfo=r,e.SessionId=u,e.CorrelationId=f,e}return __extends(t,n),t}(ViewerEventParams),OnSpecialKeyParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnSpecialKey)||this;return i.Key=t,i}return __extends(t,n),t}(ViewerEventParams),OnUlsLogParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnUlsLog)||this;return i.Logs=t,i}return __extends(t,n),t}(ViewerEventParams),OnBrowserEventParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnBrowserEvent)||this;return u.BrowserEvent=t,u.ClientX=i,u.ClientY=r,u}return __extends(t,n),t}(ViewerEventParams),OnEnterEndOfSlideshowParams=function(n){function t(){return n.call(this,ViewerEventType.OnEnterEndOfSlideshow)||this}return __extends(t,n),t}(ViewerEventParams),OnLeaveEndOfSlideshowParams=function(n){function t(){return n.call(this,ViewerEventType.OnLeaveEndOfSlideshow)||this}return __extends(t,n),t}(ViewerEventParams),ContentRefreshBeginParams=function(n){function t(t){var i=n.call(this,ViewerEventType.ContentRefreshBegin)||this;return i.reason=t,i}return __extends(t,n),t}(ViewerEventParams),ContentRefreshEndParams=function(n){function t(){var t=n.call(this,ViewerEventType.ContentRefreshEnd)||this;return t.succeeded=!0,t}return __extends(t,n),t}(ViewerEventParams),OnExitSlideshowParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnExitSlideshow)||this;return u.SlideId=t,u.SlideIndex=i,u.IsFromEndOfSlideshow=r,u}return __extends(t,n),t}(ViewerEventParams),OnContextMenuParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.OnContextMenu)||this;return r.ClientX=t,r.ClientY=i,r}return __extends(t,n),t}(ViewerEventParams),OnPodSessionExpiredParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnPodSessionExpired)||this;return u.Code=t,u.Reason=i,u.PodSessionId=r,u}return __extends(t,n),t}(ViewerEventParams),OnRenderedToBufferParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.OnRenderedToBuffer)||this;return r.SlideIndex=t,r.Img=i,r}return __extends(t,n),t}(ViewerEventParams),RecordQosErrorParams=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,ViewerEventType.RecordQosError)||this;return s.ErrorName=t,s.VetoName=i,s.IsIntentional=r,s.IsInternal=u,s.AlertOnPillar=f,s.IsSessionEndingError=e,s.DurationMs=o,s}return __extends(t,n),t}(ViewerEventParams),GoToPresenterParams=function(n){function t(){return n.call(this,ViewerEventType.GoToPresenter)||this}return __extends(t,n),t}(ViewerEventParams),TogglePrivateViewingParams=function(n){function t(t){var i=n.call(this,ViewerEventType.TogglePrivateViewing)||this;return i.Enabled=t,i}return __extends(t,n),t}(ViewerEventParams),ShowWeatherPersonParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.ShowWeatherPerson)||this;return r.Show=t,r.Metadata=i,r}return __extends(t,n),t}(ViewerEventParams),RoleChangedOutboundParams=function(n){function t(t){var i=n.call(this,ViewerEventType.RoleChangedOutbound)||this;return i.Role=t,i}return __extends(t,n),t}(ViewerEventParams),PasteFileLinktoChatParams=function(n){function t(){return n.call(this,ViewerEventType.PasteFileLinktoChat)||this}return __extends(t,n),t}(ViewerEventParams),CopyFileLinktoClipboardParams=function(n){function t(){return n.call(this,ViewerEventType.CopyFileLinktoClipboard)||this}return __extends(t,n),t}(ViewerEventParams),OnSlideViewBoundsChangedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnSlideViewBoundsChanged)||this;return i.SlideViewBounds=t,i}return __extends(t,n),t}(ViewerEventParams),CameoDetectedInPresentationParams=function(n){function t(t){var i=n.call(this,ViewerEventType.CameoDetectedInPresentation)||this;return i.CameoDetectedInPresentation=t,i}return __extends(t,n),t}(ViewerEventParams),CameoFrameRequestForSlideParams=function(n){function t(t){var i=n.call(this,ViewerEventType.CameoFrameRequestForSlide)||this;return i.CameoInSlide=t,i}return __extends(t,n),t}(ViewerEventParams),RenderingModeChangedToSVGParams=function(n){function t(){return n.call(this,ViewerEventType.RenderingModeChangedToSVG)||this}return __extends(t,n),t}(ViewerEventParams),BlankSlideStateParams=function(n){function t(t){var i=n.call(this,ViewerEventType.BlankSlideState)||this;return i.BlankSlideState=t,i}return __extends(t,n),t}(ViewerEventParams),AadTokenRequestParams=function(n){function t(t){var i=n.call(this,ViewerEventType.AadTokenRequest)||this;return i.ResourceId=t,i}return __extends(t,n),t}(ViewerEventParams),FrameTrustCheckParams=function(n){function t(){return n.call(this,ViewerEventType.FrameTrustCheck)||this}return __extends(t,n),t}(ViewerEventParams),StartCoachParams=function(n){function t(){return n.call(this,ViewerEventType.StartCoach)||this}return __extends(t,n),t}(ViewerEventParams),StopCoachParams=function(n){function t(){return n.call(this,ViewerEventType.StopCoach)||this}return __extends(t,n),t}(ViewerEventParams),CheckCoachStatusParams=function(n){function t(){return n.call(this,ViewerEventType.CheckCoachStatus)||this}return __extends(t,n),t}(ViewerEventParams),TakeControlParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.TakeControl)||this;return f.SlideIndex=t,f.SlideId=i,f.TimeLineMappings=r,f.Metadata=u,f}return __extends(t,n),t}(ViewerEventParams),MediaDetectedInPresentation=function(n){function t(){return n.call(this,ViewerEventType.MediaDetectedInPresentation)||this}return __extends(t,n),t}(ViewerEventParams),WebViewerInternalMessageType;(function(n){n[n.Handshake=0]="Handshake";n[n.GetSlidesInShowCount=1]="GetSlidesInShowCount";n[n.GetTimeLineInfos=2]="GetTimeLineInfos";n[n.GetCurrentPosition=3]="GetCurrentPosition";n[n.GetId=4]="GetId";n[n.Next=5]="Next";n[n.NextSlide=6]="NextSlide";n[n.Prev=7]="Prev";n[n.PrevSlide=8]="PrevSlide";n[n.GoToSlide=9]="GoToSlide";n[n.GoToSlideId=10]="GoToSlideId";n[n.Popout=11]="Popout";n[n.GetCurrentSlideDimensions=12]="GetCurrentSlideDimensions";n[n.DisplayBlackSlide=13]="DisplayBlackSlide";n[n.DisplayWhiteSlide=14]="DisplayWhiteSlide";n[n.PlayMedia=15]="PlayMedia";n[n.PauseMedia=16]="PauseMedia";n[n.StopMedia=17]="StopMedia";n[n.SeekMedia=18]="SeekMedia";n[n.GetCurrentMediaStates=19]="GetCurrentMediaStates";n[n.PausePresentation=20]="PausePresentation";n[n.PlayPresentation=21]="PlayPresentation";n[n.GetCurrentPlayModeState_Unused=22]="GetCurrentPlayModeState_Unused";n[n.GetPresentationPlaybackState=23]="GetPresentationPlaybackState";n[n.GoToNextSlide=24]="GoToNextSlide";n[n.GoToPrevSlide=25]="GoToPrevSlide";n[n.BootTimingFromApi=26]="BootTimingFromApi";n[n.GenericULSLog=27]="GenericULSLog";n[n.RestoreFocus=28]="RestoreFocus";n[n.ExitSlideshow=29]="ExitSlideshow";n[n.RefreshPodSession=30]="RefreshPodSession";n[n.SetNavigationOptions=31]="SetNavigationOptions";n[n.ShowHideCursor=32]="ShowHideCursor";n[n.RecordStartedSlideShowTimestamp=33]="RecordStartedSlideShowTimestamp";n[n.GetCurrentPositionWithTimeLines=34]="GetCurrentPositionWithTimeLines";n[n.InkManager=35]="InkManager";n[n.SwitchRole=34]="SwitchRole";n[n.RecordMetrics=36]="RecordMetrics";n[n.ChangeTheme=37]="ChangeTheme";n[n.SwitchRoleV2=45]="SwitchRoleV2";n[n.PPTSharingLayoutChanged=46]="PPTSharingLayoutChanged";n[n.SetPrivateViewingToggle=47]="SetPrivateViewingToggle";n[n.SendPresenterStateDuringPrivateViewing=48]="SendPresenterStateDuringPrivateViewing";n[n.SetAadToken=49]="SetAadToken";n[n.UpdateMeetingCoachStatus=50]="UpdateMeetingCoachStatus";n[n.VolumeMedia=55]="VolumeMedia";n[n.SendiOSAuthTokenWithConfig=56]="SendiOSAuthTokenWithConfig";n[n.ReturnToPresenterInbound=60]="ReturnToPresenterInbound";n[n.CustomBackgroundForAPL=61]="CustomBackgroundForAPL";n[n.SetGlobalMute=62]="SetGlobalMute";n[n.LaserPointerActivation=63]="LaserPointerActivation";n[n.UpdateBufferInfoForCameo=64]="UpdateBufferInfoForCameo";n[n.SetFrameTrustStatus=65]="SetFrameTrustStatus";n[n.HideCameo=66]="HideCameo";n[n.UpdatePresenterName=75]="UpdatePresenterName";n[n.VideoFrameToPptForCameo=99]="VideoFrameToPptForCameo"})(WebViewerInternalMessageType||(WebViewerInternalMessageType={}));var GetCurrentSlideDimensionsWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentSlideDimensions)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetSlidesInShowCountWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetSlidesInShowCount)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetTimeLineInfosWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.GetTimeLineInfos)||this;return i.m_slideIndex=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentPositionWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentPosition)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentPositionWithTimeLinesWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentPositionWithTimeLines)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetIdWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.GetId)||this;return i.m_slideIndex=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),NextWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.Next)||this;return i.m_metadata=t?t:{},i}return __extends(t,n),t}(WebViewerBaseInternalMessage),NextSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.NextSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToNextSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GoToNextSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToPrevSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GoToPrevSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PausePresentationWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PausePresentation)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PlayPresentationWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PlayPresentation)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetPresentationPlaybackStateInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetPresentationPlaybackState)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PrevWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.Prev)||this;return i.m_metadata=t?t:{},i}return __extends(t,n),t}(WebViewerBaseInternalMessage),DisplayBlackSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.DisplayBlackSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),DisplayWhiteSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.DisplayWhiteSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PrevSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PrevSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToSlideWebViewerInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.GoToSlide)||this;return u.m_slideIndex=t,u.m_timeLineMappings=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToSlideIdWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.GoToSlideId)||this;return r.m_slideId=t,r.m_timeLineMappings=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PopoutInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.Popout)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PlayMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.PlayMedia)||this;return r.m_mediaPlayerName=t,r.m_metadata=i?i:{},r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PauseMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.PauseMedia)||this;return r.m_mediaPlayerName=t,r.m_metadata=i?i:{},r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetMediaVolumeInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.VolumeMedia)||this;return u.m_mediaPlayerName=t,u.m_volume=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),RestoreFocusInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.RestoreFocus)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),StopMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.StopMedia)||this;return r.m_mediaPlayerName=t,r.m_metadata=i?i:{},r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SeekMediaInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.SeekMedia)||this;return u.m_mediaPlayerName=t,u.m_position=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentMediaStatesInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentMediaStates)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GenericULSLogInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.GenericULSLog)||this;return r.m_tagID=t,r.m_message=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),ExitSlideshowInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.ExitSlideshow)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),RefreshPodSessionInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.RefreshPodSession)||this;return r.m_podSessionId=t,r.m_wacCluster=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetNavigationOptionsMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.SetNavigationOptions)||this;return r.m_enableAdvanceOnClick=t,r.m_enableKeyboardNavigation=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),ShowHideCursorWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.ShowHideCursor)||this;return i.m_fShow=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),InkManagerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.InkManager)||this;return r.m_item=t,r.m_color=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SwitchRoleWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SwitchRole)||this;return i.m_role=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SwitchRoleV2WebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SwitchRoleV2)||this;return i.m_role=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SendiOSAuthTokenWithConfigInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SendiOSAuthTokenWithConfig)||this;return i.m_configs={},i.m_configs=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),ChangeThemeWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.ChangeTheme)||this;return r.m_isHighContrast=t,r.m_highContrastColorSettings=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SendPresenterStateDuringPrivateViewingInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.SendPresenterStateDuringPrivateViewing)||this;return u.m_slideIndex=t,u.m_timeLineMappings=i,u.m_metadata=r,u}return __extends(t,n),t}(WebViewerBaseInternalMessage),RecordMetricsWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.RecordMetrics)||this;return r.m_statName=t,r.m_data=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PPTSharingLayoutChangedInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.PPTSharingLayoutChanged)||this;return i.m_sharingLayoutMode=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetAadTokenInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetAadToken)||this;return i.m_token=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetFrameTrustStatusInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetFrameTrustStatus)||this;return i.m_isTrusted=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),UpdateBufferInfoForCameoInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.UpdateBufferInfoForCameo)||this;return i.m_bufferName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),ReturnToPresenterInboundInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.ReturnToPresenterInbound)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),CustomBackgroundForAPLInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.CustomBackgroundForAPL)||this;return i.m_backgroundUrl=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),UpdatePresenterNameInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.UpdatePresenterName)||this;return i.m_presenterDisplayName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetPrivateViewingToggleInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetPrivateViewingToggle)||this;return i.m_enabled=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),UpdateMeetingCoachStatusInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.UpdateMeetingCoachStatus)||this;return i.m_isCoachOn=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetGlobalMuteInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetGlobalMute)||this;return i.m_fMuted=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetLaserPointerActivationInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.LaserPointerActivation)||this;return r.m_fActivate=t,r.m_metadata=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),HideCameoInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.HideCameo)||this;return r.m_fHide=t,r.m_reason=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),WebViewerMessageType;(function(n){n[n.Handshake=0]="Handshake";n[n.GetSlidesInShowCount=1]="GetSlidesInShowCount";n[n.GetTimeLineInfos=2]="GetTimeLineInfos";n[n.GetCurrentPosition=3]="GetCurrentPosition";n[n.GetId=4]="GetId";n[n.OnPositionChanged=5]="OnPositionChanged";n[n.OpenPresentation=6]="OpenPresentation";n[n.GetCurrentSlideDimensions=7]="GetCurrentSlideDimensions";n[n.MediaEvent=8]="MediaEvent";n[n.GetCurrentMediaStates=9]="GetCurrentMediaStates";n[n.OnError=10]="OnError";n[n.OnSpecialKey=11]="OnSpecialKey";n[n.OnRefresh=12]="OnRefresh";n[n.RejectedMessage=13]="RejectedMessage";n[n.OnUlsLog=14]="OnUlsLog";n[n.OnNetworkHealthChanged=15]="OnNetworkHealthChanged";n[n.GetPresentationPlaybackState=16]="GetPresentationPlaybackState";n[n.OnPresentationPlaybackStateChanged=17]="OnPresentationPlaybackStateChanged";n[n.OnBrowserEvent=18]="OnBrowserEvent";n[n.OnEnterEndOfSlideshow=19]="OnEnterEndOfSlideshow";n[n.OnLeaveEndOfSlideshow=20]="OnLeaveEndOfSlideshow";n[n.OnContentRefreshBegin=21]="OnContentRefreshBegin";n[n.OnContentRefreshEnd=22]="OnContentRefreshEnd";n[n.OnExitSlideshow=23]="OnExitSlideshow";n[n.OnContextMenu=24]="OnContextMenu";n[n.GoToPresenter=25]="GoToPresenter";n[n.OnPodSessionExpired=27]="OnPodSessionExpired";n[n.AppReadyForPostMessage=28]="AppReadyForPostMessage";n[n.OnRenderedToBuffer=29]="OnRenderedToBuffer";n[n.RecordQosError=33]="RecordQosError";n[n.SwitchRole=34]="SwitchRole";n[n.ChangeTheme=37]="ChangeTheme";n[n.LogToBootstrapper=40]="LogToBootstrapper";n[n.PostAppErrorUpwardsForTelemetry=41]="PostAppErrorUpwardsForTelemetry";n[n.AppBootPerfDict=42]="AppBootPerfDict";n[n.SwitchRoleV2=45]="SwitchRoleV2";n[n.TogglePrivateViewing=47]="TogglePrivateViewing";n[n.OnSlideViewBoundsChanged=48]="OnSlideViewBoundsChanged";n[n.AadTokenRequest=49]="AadTokenRequest";n[n.StartCoach=50]="StartCoach";n[n.StopCoach=51]="StopCoach";n[n.CheckCoachStatus=52]="CheckCoachStatus";n[n.BlankSlideState=54]="BlankSlideState";n[n.ShowWeatherPerson=55]="ShowWeatherPerson";n[n.BootStageChanged=56]="BootStageChanged";n[n.RoleChangedOutbound=57]="RoleChangedOutbound";n[n.PasteFileLinktoChat=60]="PasteFileLinktoChat";n[n.CopyFileLinktoClipboard=61]="CopyFileLinktoClipboard";n[n.CameoDetectedInPresentation=66]="CameoDetectedInPresentation";n[n.CameoFrameRequestForSlide=67]="CameoFrameRequestForSlide";n[n.RenderingModeChangedToSVG=68]="RenderingModeChangedToSVG";n[n.FrameTrustCheck=69]="FrameTrustCheck";n[n.TakeControl=72]="TakeControl";n[n.MediaDetectedInPresentation=73]="MediaDetectedInPresentation"})(WebViewerMessageType||(WebViewerMessageType={}));var HandshakeWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.Handshake)||this;return f.m_sessionId=i,f.m_percievedBootTime=r,f.m_data=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetSlidesInShowCountWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetSlidesInShowCount)||this;return r.m_slidesCount=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetTimeLineInfosWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetTimeLineInfos)||this;return r.m_timeLineInfos=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentPositionWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.GetCurrentPosition)||this;return f.m_slideIndex=i,f.m_slideId=r,f.m_timeLineMappings=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentSlideDimensionsWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.GetCurrentSlideDimensions)||this;return e.m_slideWidth=i,e.m_slideHeight=r,e.m_slideLeftBound=u,e.m_slideBottomBound=f,e}return __extends(t,n),t}(WebViewerBaseMessage),GetIdWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.Handshake)||this;return r.m_slideId=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnPositionChangedWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.OnPositionChanged)||this;return e.m_slideIndex=i,e.m_slideId=r,e.m_timeLineMappings=u,e.m_metadata=f?f:{},e}return __extends(t,n),t}(WebViewerBaseMessage),TogglePrivateViewingWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.TogglePrivateViewing)||this;return r.m_enabled=i,r}return __extends(t,n),t}(WebViewerBaseMessage),ShowWeatherPersonWebViewerMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.ShowWeatherPerson)||this;return u.m_show=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseMessage),RoleChangedOutboundWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.RoleChangedOutbound)||this;return r.m_role=i,r}return __extends(t,n),t}(WebViewerBaseMessage),CopyFileLinktoClipboardWebViewerMessage=function(n){function t(t){return n.call(this,t,WebViewerMessageType.CopyFileLinktoClipboard)||this}return __extends(t,n),t}(WebViewerBaseMessage),PasteFileLinktoChatWebViewerMessage=function(n){function t(t){return n.call(this,t,WebViewerMessageType.PasteFileLinktoChat)||this}return __extends(t,n),t}(WebViewerBaseMessage),MediaEventWebViewerMessage=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,WebViewerMessageType.MediaEvent)||this;return s.m_mediaPlayerName=i,s.m_mediaEventType=r,s.m_mediaPosition=u,s.m_mediaVolume=e,f&&(s.m_mediaHostName=f),s.m_metadata=o?o:{},s}return __extends(t,n),t}(WebViewerBaseMessage),OnErrorWebViewerMessage=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,WebViewerMessageType.OnError)||this;return o.m_code=i,o.m_message=r,o.m_extraInfo=u,o.m_sessionId=f,o.m_correlationId=e,o}return __extends(t,n),t}(WebViewerBaseMessage),OnSpecialKeyWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnSpecialKey)||this;return r.m_key=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentMediaStatesWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.GetCurrentMediaStates)||this;return f.m_slideIndex=i,f.m_slideId=r,f.m_mediaStates=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetPresentationPlaybackStateWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetPresentationPlaybackState)||this;return r.m_playbackState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnPresentationPlaybackStateChangedWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnPresentationPlaybackStateChanged)||this;return r.m_playbackState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),RejectedMessageWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.RejectedMessage)||this;return r.m_data=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnUlsLogWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnUlsLog)||this;return r.m_logs=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnNetworkHealthChangedWebViewerMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnNetworkHealthChanged)||this;return u.m_isHealthy=i,u.m_addTimeoutTimeMs=r,u}return __extends(t,n),t}(WebViewerBaseMessage),OnBrowserEventMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnBrowserEvent)||this;return f.m_event=i,f.m_clientX=r,f.m_clientY=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnContentRefreshBeginMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnContentRefreshBegin)||this;return r.m_reason=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnExitSlideshowMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnExitSlideshow)||this;return f.m_slideId=i,f.m_slideIndex=r,f.m_isFromEndOfSlideshow=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnContextMenuMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnContextMenu)||this;return u.m_clientX=i,u.m_clientY=r,u}return __extends(t,n),t}(WebViewerBaseMessage),OnPodSessionExpiredMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnPodSessionExpired)||this;return f.m_code=i,f.m_reason=r,f.m_podSessionId=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnRenderedToBufferMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnRenderedToBuffer)||this;return u.m_slideIndex=i,u.m_img=r,u}return __extends(t,n),t}(WebViewerBaseMessage),RecordQosErrorMessage=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,WebViewerMessageType.RecordQosError)||this;return h.m_errorName=i,h.m_vetoName=r,h.m_isIntentional=u,h.m_isInternal=f,h.m_alertOnPillar=e,h.m_isSessionEndingError=o,h.m_durationMs=s,h}return __extends(t,n),t}(WebViewerBaseMessage),OnSlideViewBoundsChangedMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnSlideViewBoundsChanged)||this;return r.m_slideViewBounds=i,r}return __extends(t,n),t}(WebViewerBaseMessage),BlankSlideStateMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.BlankSlideState)||this;return r.m_blankSlideState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),AadTokenRequestMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.AadTokenRequest)||this;return r.m_resourceId=i,r}return __extends(t,n),t}(WebViewerBaseMessage),CameoDetectedInPresentationMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.CameoDetectedInPresentation)||this;return r.m_fCameoDetectedInPresentation=i,r}return __extends(t,n),t}(WebViewerBaseMessage),CameoFrameRequestForSlideMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.CameoDetectedInPresentation)||this;return r.m_cameoInSlide=i,r}return __extends(t,n),t}(WebViewerBaseMessage),TakeControlWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.TakeControl)||this;return e.m_slideIndex=i,e.m_slideId=r,e.m_timeLineMappings=u,e.m_metadata=f,e}return __extends(t,n),t}(WebViewerBaseMessage),ErrorCategory;(function(n){n[n.Fatal=0]="Fatal";n[n.FatalDocument=1]="FatalDocument";n[n.FatalContent=2]="FatalContent";n[n.Informational=3]="Informational";n[n.ActionRequested=4]="ActionRequested"})(ErrorCategory||(ErrorCategory={}));ConditionalAction=function(){function n(n,t){var i=this;if(this.m_conditions={},t.length==0)throw Error("conditions");this.m_action=n;t.forEach(function(n){i.m_conditions[n]=!1})}return n.prototype.SetCondition=function(n){if(this.m_conditions[n]==null)throw Error("condition");this.m_conditions[n]=!0;this.CheckConditions()},n.prototype.AddNewCondition=function(n){if(n in this.m_conditions)throw Error("condition");this.m_conditions[n]=!1},n.prototype.GetCondition=function(n){if(this.m_conditions[n]==null)throw Error("condition");return this.m_conditions[n]},n.prototype.CheckConditions=function(){var n,t;if(this.m_action!=null){n=!0;for(t in this.m_conditions)n=n&&this.m_conditions[t];n&&(this.m_action(),this.m_action=null)}},n}();PPTPreviewerBootstrapper=function(){function n(){var n=this;this.m_appErrors=[];this.m_awaitPresentationUrlStartTime=0;this.m_isPresentationUrlSet=!1;this.m_presentationUrlSetTimeout=0;this.onPresentationUrlSet=function(t,i){var r,u=undefined;if(!i){t.ULS.traceTag(554268612,logCategory.PptSession,logLevel.Error,"onPresentationUrlSet: data is null.");return}if(!i.url&&((r=i.metadata)===null||r===void 0?void 0:r.presenterErrorInfo))u=i.metadata.presenterErrorInfo;else if(n.m_isPresentationUrlSet){t.ULS.traceTag(544282375,logCategory.PptSession,logLevel.Info,"onPresentationUrlSet: m_isPresentationUrlSet is already true.");return}try{n.m_isPresentationUrlSet=!0;n.m_presentationUrlSetTimeout&&clearTimeout(n.m_presentationUrlSetTimeout);var f=i.isPresentationUrlEnabled||!1,e=i.url||"",o=i.metadata||{},s=(new Date).getTime(),h=s-n.m_awaitPresentationUrlStartTime,c=n.m_onPresentationUrlSetCreateViewerCallback!==undefined;t.ULS.traceTag(554268613,logCategory.PptSession,logLevel.Info,"onPresentationUrlSet: isPresentationUrlEnabled: "+f+"; presUrlLength: "+e.length+"; hasCallback: "+c+"; metadata: "+JSON.stringify(o)+"; startWaitingTime: "+n.m_awaitPresentationUrlStartTime+", elapsed: "+h+"; hasError: "+(u!==undefined)+";");n.m_onPresentationUrlSetCreateViewerCallback!==undefined?n.m_onPresentationUrlSetCreateViewerCallback(f,e,u):t.ULS.traceTag(544282376,logCategory.PptSession,logLevel.Error,"onPresentationUrlSet: m_onPresentationUrlSetCreateViewerCallback is undefined.")}catch(l){t.ULS.traceTag(554259402,logCategory.PptSession,logLevel.Error,"Exception in onPresentationUrlSet: "+JSON.stringify(l))}}}return n.TryLoadSlice=function(n,t,i,r){var u,f,o,s,e;try{return PreviewSessionLoader.s_previewAPIFactory?!0:(u=PPTBootstrapSettings.getAppMetadata(),f=PPTBootstrapSettings.viewerSliceBootstrapper(),u.Environment=="wac"&&(o=PPTBootstrapper.getWacStaticResourcesServer(n,t,i,r),f=o+u.WacCdnVersion+"_pptscripts/powerpoint.boot.vslice.js"),s=PPTPreviewerBootstrapperUtils.getTrustedScriptUrl(f,r,"VSlice",undefined),e=document.createElement("script"),e.src=s,document.head.insertBefore(e,document.head.firstChild),!0)}catch(h){return!1}},n.prototype.InitializeWopiPending=function(t){var et=this,g,nt,p,s,a,h,c,i,l,tt,b,v,f,k,y,it,e,ut,w,ot,ft,d,u;this.m_appErrors.length=0;this.m_awaitPresentationUrlStartTime=0;this.m_isPresentationUrlSet=!1;var st=Date.now(),ht=n.TryLoadSlice(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),ct=Date.now(),o=undefined,r=undefined;try{if(p=t.SessionInformation.HostSessionId,t.ApplicationCustomSettings&&t.ApplicationCustomSettings.ForceHttp||(t.SessionInformation.HostSessionId=PPTBootstrapper.generateRandomUUID()),(window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0||window.location.search.indexOf("wdTestWacPreviewer=1")>=0)&&(s=new URLSearchParams(window.location.search),s.has("wdIsPresenter")&&(t.SessionInformation.IsPresenter=s.get("wdIsPresenter")==="1"),s.has("wdCallId")&&(t.SessionInformation.CallId=s.get("wdCallId")||"testdevcall"),s.has("wdDocId")&&(t.WopiPrecheckInfo.DocUniqueId=s.get("wdDocId")||t.WopiPrecheckInfo.FileGetUrl)),PPTBootstrapper.ensureInitializeParametersAreTheRightType(t),t.ApplicationCustomSettings=n.InitAppSettingsWithDefaults(t),t.WopiPrecheckInfo.BundleInfo&&t.WopiPrecheckInfo.BundleInfo.Url||(t.WopiPrecheckInfo.BundleInfo={MajorVersion:0}),t.PreviewerRolloutRing=PodsRegionInfo.getPodsRing(t),a=PPTBootstrapper.getOnDemandServer(t),a||t.ApplicationCustomSettings.EnableWacFallback&&t.ApplicationUrl||(h=ULS.getLogger(t.SessionInformation.HostSessionId,PodsRegionInfo.GetDefaultProdRegion().PodsURL+"RemoteUls.ashx"),h.ULS.traceTag(556869333,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session for Host Session Id:  "+p),h.ULS.traceTag(556869334,logCategory.PptSession,logLevel.Info,"Bootstrap - no onDemandServer for applicationUrl: "+t.ApplicationUrl.replace("https://","")),c=PPTBootstrapperLogger.initializeHealthLogger(t,PodsRegionInfo.GetDefaultProdRegion().PodsURL,h),u=void 0,t.WopiPrecheckInfo&&!PPTBootstrapper.isFileTypeSupportedForLegacySlideShow(t.WopiPrecheckInfo.FileName,h)?(u={errorType:"AppInitError",errorObject:"File type not supported",Category:0,Code:4,ErrorName:"UnsupportedFileTypeDetectedInBootstrapper",EventType:13,ExtraInfo:"Confirm ppt file type is received from Host",SessionId:t.SessionInformation.HostSessionId},PPTBootstrapperLogger.recordBootCompleted(t,4,"UnsupportedFileTypeDetectedInBootstrapper","Unsupported fileType - host is not supposed to call init on this fileType",h,Date.now(),[]),c===null||c===void 0?void 0:c.recordQosError(u.ErrorName,["FileOpenFailed"],!0,!1,!1,!0)):(u={errorType:"AppInitError",errorObject:"Region not suppported",Category:0,Code:8,ErrorName:"RegionNotSupported",EventType:13,ExtraInfo:"Confirm right applicationUrl is received from Host",SessionId:t.SessionInformation.HostSessionId},PPTBootstrapperLogger.recordBootCompleted(t,8,"RegionNotSupported","Region not supported. Check the ApplicationUrl",h,Date.now(),[]),c===null||c===void 0?void 0:c.recordQosError(u.ErrorName,["FileOpenFailed"],!0,!1,!1,!0),t.FnOnInitializeFailure(u))),l=PPTBootstrapperFeatureGatesHelper.getFeatureGates(t,null),l&&l.RemoteUlsExperimentEnabled?(i=o=ULS.getExperimentLogger(t.SessionInformation.HostSessionId,a+"RemoteUls.ashx",l.RemoteUlsExperimentUploadCadenceInMsSec!==undefined?l.RemoteUlsExperimentUploadCadenceInMsSec:6e4,l.RemoteUlsExperimentUploadTriggerSize!==undefined?l.RemoteUlsExperimentUploadTriggerSize:50),i.ULS.traceTag(0,logCategory.PptSession,logLevel.Info,"using experimental logger")):i=o=ULS.getLogger(t.SessionInformation.HostSessionId,a+"RemoteUls.ashx"),this.m_frameContainerContext=new FrameContainerContext(t,i),i.ULS.traceTag(38286563,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session. Build version: "+this.GetVersion()),i.ULS.traceTag(40206739,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session. Slice load initated: "+ht),i.ULS.traceTag(590140833,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session for Host Session Id:  "+p),tt=(new Date).getTime(),i.ULS.traceTag(38286592,logCategory.PptSession,logLevel.Info,"Bootstrapper Init Time: "+tt),t!=null&&t.ApplicationCustomSettings!=null&&i.ULS.traceTag(593295124,logCategory.PptSession,logLevel.Info,"StartingSlideIndex: "+t.ApplicationCustomSettings.StartingSlideIndex),(t===null||t===void 0?void 0:t.SessionInformation)!=null&&(((nt=(g=t===null||t===void 0?void 0:t.SessionInformation)===null||g===void 0?void 0:g.StateServiceSettings)===null||nt===void 0?void 0:nt.stateServiceProxySettings)&&i.ULS.traceTag(543769175,logCategory.PptSession,logLevel.Info,"StateServiceSettings: "+JSON.stringify(t.SessionInformation.StateServiceSettings.stateServiceProxySettings)),i.ULS.traceTag(543769176,logCategory.PptSession,logLevel.Info,"EnableStateServiceInPreviewerFeatures: "+JSON.stringify(t.SessionInformation.EnableStateServiceInPreviewerFeatures))),t=PPTPreviewerBootstrapperUtils.SanitizeInitialParameters(t,i),this.windowVisibilityMetrics=new WindowVisibilityMetrics,b=PPTBootstrapper.getPostMessageToken(t.SessionInformation.HostSessionId),t.PostMessageToken=b,t.SnapRequestID="snapRequestID_"+PPTBootstrapper.generateRandomUUID(),v=n.ShouldUsePODS(t,i),n.LogShouldUsePodsOrCachedResult(v,t.ApplicationUrl,v.Reason,i),this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(t,i),f=t.ApplicationCustomSettings,f&&(f.DisabledChangeGates=PPTPreviewerBootstrapperFeatureGatesHelper.CombineDisabledChangeGates(f,this.m_pptFeatureGates)),t.HostSessionId=p,r=PPTBootstrapperLogger.initializeHealthLogger(t,a,i),this.m_pptFeatureGates&&!this.m_pptFeatureGates.AllowModernSlideShowBlockedScenarios&&PPTBootstrapper.isScenarioBlockedForModernSS(t,i)){u={errorType:"AppInitError",errorObject:"Platform not supported for modernSlideShow",Category:0,Code:12,ErrorName:"UnsupportedModernSlideShowPlatforms",EventType:13,ExtraInfo:"Modern slideshow cant run on old browsers and TSW Electron platforms",SessionId:t.SessionInformation.HostSessionId};PPTBootstrapperLogger.recordBootCompleted(t,12,"UnsupportedModernSlideShowPlatforms","Modern slideshow cant run on old browsers and TSW Electron platforms",i,Date.now(),[]);r===null||r===void 0?void 0:r.recordQosError(u.ErrorName,["FileOpenFailed"],!0,!0,!0,!0);t.FnOnInitializeFailure(u);return}k=TimeoutWrapper.addTimeoutWrappersToHostCallbacks(t,i,"Previewer",this.m_appErrors,r);y={};y.PostMessageToken=b;y.UsePODSDetails=v;y.HostSessionId=p;it=t;v.ShouldUsePODS||(y.FallbackPreBoot=!0,it=n.SanitizeInputParametersForFallbackLog(t));PPTBootstrapper.sendInitialLog(it,"Previewer",y,i);e=PPTBootstrapperFeatureGatesHelper.getStateServiceFeatureGates(t,i)||[];!this.m_pptFeatureGates.DisableStateServiceInking&&e.indexOf("Ink")<0&&t.SessionInformation.HostName!="MSTeams"&&PPTBootstrapper.isDoDRegion(t,i)&&t.SessionInformation.HostExperience!="SingleWindow"&&e.push("Ink");i.ULS.traceTag(558187592,logCategory.PptSession,logLevel.Info,"StateService enabledFeatures: "+(e?e.toString():"None"));try{this.trimEnabledStateServiceFeatures(t,e,i);this.m_awaitPresentationUrlStartTime=(new Date).getTime();e.length>0&&StateServiceClientLoader.TryLoadStateServiceClient(t,i,e,this.onPresentationUrlSet.bind(this,i),this.m_frameContainerContext,r,this.m_pptFeatureGates.DisableCachedStateServiceClientJS||!1,t.SessionInformation.StateServiceSettings)}catch(rt){i.ULS.traceTag(554259401,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapper: error in init StateServiceClient: "+JSON.stringify(rt))}if(v.ShouldUsePODS){if(!f){i.ULS.traceTag(554251101,logCategory.PptSession,logLevel.Info,"null ApplicationCustomSettings");throw Error("null ApplicationCustomSettings");}}else return i.ULS.traceTag(38836228,logCategory.PptSession,logLevel.Info,"Previewer unsupported region"),(f===null||f===void 0?void 0:f.EnableWacFallback)&&t.ApplicationUrl?(i.ULS.traceTag(38836229,logCategory.PptSession,logLevel.Info,"Previewer setting up wacFallbackController"),w=new WacFallbackController(t,!0,function(t,i){return n.GetWacPreviewURL(t,i)},null,i,this.windowVisibilityMetrics,b),ut={Complete:function(n,t){w?w.wopiPendingApplicationComplete(n,t):null},Fail:function(n){w?w.wopiPendingApplicationFail(n):null}}):(i.ULS.traceTag(38836230,logCategory.PptSession,logLevel.Info,"Previewer returning error for unsupported region"),u={errorType:"AppInitError",errorObject:"Region not suppported",Category:0,Code:8,ErrorName:"RegionNotSupported",EventType:13,ExtraInfo:"Region not suppported"},r===null||r===void 0?void 0:r.recordQosError(u.ErrorName,["FileOpenFailed"],!0,!0,!0,!0),t.FnOnInitializeFailure(u),ut={Complete:function(){},Fail:function(u){k.failByHost(t,i,u,et.m_appErrors);r===null||r===void 0?void 0:r.recordQosError("AbortByHost",["FileOpenFailed"],!0,!1,!1,!0);n.WopiPendingFail(t.SessionInformation.HostSessionId,u,i)}}),ut;return f.OnDemandServer=a,ot=PPTBootstrapSettings.getAppMetadata(),ot.Environment=="wac"&&(f.WacStaticResourcesServer=PPTBootstrapper.getWacStaticResourcesServer(f,t.ApplicationUrl,t.BootstrapperUrl,t)),ft={initWopiTime:st,bootstrapperInitTime:tt,sliceLoadTime:ct},n.s_prefetchStartTime>0&&(ft.prefetchStartTime=n.s_prefetchStartTime,n.s_prefetchStartTime=0),this.BootWithMeetingCoordination(t,e,i,ft,k,r),PPTBootstrapper.logBootstrapperPerformanceInfo(t.BootstrapperUrl,"PreviewerTSBoot",i),window.setTimeout(function(){i&&i.ULS.flush()},1e4),{Complete:function(){},Fail:function(u){k.failByHost(t,i,u,et.m_appErrors);r===null||r===void 0?void 0:r.recordQosError("AbortByHost",["FileOpenFailed"],!0,!1,!1,!0);n.WopiPendingFail(t.SessionInformation.HostSessionId,u,i)}}}catch(rt){if(o&&(d=o,d.ULS.traceTag(38286593,logCategory.PptSession,logLevel.Error,"AppInitError: "+JSON.stringify(rt)),d.ULS.traceTag(590140832,logCategory.PptSession,logLevel.Error,"Host Session Id from Teams: "+t&&t.SessionInformation?t.SessionInformation.HostSessionId:""),d.ULS.flushOnClose()),u={errorType:"AppInitError",errorObject:rt,Category:0,Code:1,ErrorName:"InvalidInputParameters",EventType:13,ExtraInfo:"Exception caught"},r)try{r.recordQosError(u.ErrorName,["FileOpenFailed"],!1,!0,!0,!0)}catch(lt){o===null||o===void 0?void 0:o.ULS.traceTag(556097944,logCategory.PptSession,logLevel.Error,"Exception recording QoS error: "+JSON.stringify(lt))}t.FnOnInitializeFailure(u)}return undefined},n.prototype.trimEnabledStateServiceFeatures=function(t,i,r){var u,f,e,o;if(i.length!=0){o=t.Diagnostics?t.Diagnostics.entryPoint:"";o=="deepLink"&&i&&((u=this.m_pptFeatureGates)===null||u===void 0?void 0:u.DisabledScenariosForPresentationUrl)&&this.m_pptFeatureGates.DisabledScenariosForPresentationUrl.indexOf(o)>-1&&(n.removeStateServiceFeature("PresUrl",i,r,"DeepLink"),n.removeStateServiceFeature("PresUrlBoot",i,r,"DeepLink"));var s=i.indexOf("PresUrlBinary")>-1,h=t.WopiPrecheckInfo.FileName||"",c=PPTBootstrapper.isBinaryFile(h,r);c&&(s?(n.addStateServiceFeature("PresUrl",i,r,"BinaryFile"),n.addStateServiceFeature("PresUrlBoot",i,r,"BinaryFile")):(n.removeStateServiceFeature("PresUrl",i,r,"BinaryFile"),n.removeStateServiceFeature("PresUrlBoot",i,r,"BinaryFile")));((e=(f=t.SessionInformation)===null||f===void 0?void 0:f.WdParams)===null||e===void 0?void 0:e.isMovePrivateViewingToPPTEnabled)||n.removeStateServiceFeature("NavSync",i,r,"PVdisabled");t.SessionInformation.EnableStateServiceInPreviewerFeatures=i}},n.removeStateServiceFeature=function(n,t,i,r){var u=t.indexOf(n);u>-1&&(t.splice(u,1),i.ULS.traceTag(542946185,logCategory.PptSession,logLevel.Info,"StateServiceFeatures: Removing "+n+"; reason:"+r+";"))},n.addStateServiceFeature=function(n,t,i,r){var u=t.indexOf(n);u<0&&(t.push(n),i.ULS.traceTag(542765315,logCategory.PptSession,logLevel.Info,"StateServiceFeatures: Adding "+n+"; reason:"+r+";"))},n.prototype.BootWithMeetingCoordination=function(n,t,i,r,u,f){var e=this,a,v,y,o=t.indexOf("PresUrlBoot")>-1,p=t.indexOf("PresUrl")>-1,w=t.indexOf("PresUrlBinary")>-1,h=((a=this.m_pptFeatureGates)===null||a===void 0?void 0:a.PresUrlBootTimeoutMS)!==undefined?this.m_pptFeatureGates.PresUrlBootTimeoutMS:4e3,c=n.SessionInformation.IsPresenter,b=n.WopiPrecheckInfo.FileName||"",s=PPTBootstrapper.isBinaryFile(b,i),l;s&&(h=((v=this.m_pptFeatureGates)===null||v===void 0?void 0:v.PresUrlBootTimeoutBinaryMS)!==undefined?this.m_pptFeatureGates.PresUrlBootTimeoutBinaryMS:3e4);i.ULS.traceTag(542946186,logCategory.PptSession,logLevel.Info,"BootWithMeetingCoordination Start. fUsePresUrlToBoot:"+o+"; fUsePresUrlDark:"+p+"; isPresenter:"+c+"; isBinary:"+s+"; fUsePresUrlBinary:"+w+"; waitTimeout:"+h);(o||p)&&c&&n.SessionInformation.HostName==="MSTeams"?(r.getPresentationUrlStartTime=Date.now(),PPTPreviewerGetPptFileData.getPresentationUrl(n,i,this.m_pptFeatureGates).then(function(t){var h,c,s;r.getPresentationUrlEndTime=Date.now();(t===null||t===void 0?void 0:t.presentationUrl)?(i.ULS.traceTag(554268609,logCategory.PptSession,logLevel.Info,"PresentationUrl: detected stateService flag so got presUrl, posting downward; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime)+"."),c={m_type:"presentationUrl",m_url:t.presentationUrl,m_metadata:r},StateServiceClientLoader.SendMessage(c),o&&(n.WopiPrecheckInfo.PresentationUrl=t.presentationUrl,((h=e.m_pptFeatureGates)===null||h===void 0?void 0:h.DisableSnapToPodsRegionSpecificUrl)||!n.ApplicationCustomSettings||!n.ApplicationCustomSettings.OnDemandServer||(s=SnapUrlToPodsRegion.tryGetPodsRegionSpecificUrl(new URL(t===null||t===void 0?void 0:t.presentationUrl),i),i.ULS.traceTag(528868487,logCategory.PptSession,logLevel.Info,"PresentationUrl: podsDCSpecificUrl "+s+", pods url "+n.ApplicationCustomSettings.OnDemandServer),s!=""&&(n.ApplicationCustomSettings.OnDemandServer=s)))):(i.ULS.traceTag(554268610,logCategory.PptSession,logLevel.Error,"PresentationUrl: null response received from service, fail the session; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime)+";"),e.HandleGetPresentationUrlError("Presentation Url missing in response",n,i,r,f));e.SendSnapAndCreateViewer(n,i,r,u,f,o)}).catch(function(t){e.HandleGetPresentationUrlError(t.message,n,i,r,f)})):o&&(c===!1||n.SessionInformation.HostName!=="MSTeams")?(this.m_onPresentationUrlSetCreateViewerCallback=function(t,o,h){var c=t&&o!==undefined;i.ULS.traceTag(544282372,logCategory.PptSession,logLevel.Info,"PresentationUrl: onPresentationUrlSetCreateViewerCallback invoked. fUsePresUrl: "+c+", isPresUrlDefined:"+(o!=="")+"; isBinary:"+s+"; error: "+(h?JSON.stringify(h):""));h!==undefined?(f===null||f===void 0?void 0:f.recordQosError(h.ErrorName,["FileOpenFailed"],!1,!0,!0,!0),n.FnOnInitializeFailure(h)):(o&&(n.WopiPrecheckInfo.PresentationUrl=o),e.SendSnapAndCreateViewer(n,i,r,u,f,c));e.m_onPresentationUrlSetCreateViewerCallback=undefined},this.m_presentationUrlSetTimeout=window.setTimeout(function(){e.m_isPresentationUrlSet||(e.m_isPresentationUrlSet=!0,i.ULS.traceTag(544282373,logCategory.PptSession,logLevel.Info,"PresentationUrl: Timeout after "+h+"ms, fallback to SPO boot; isBinary:"+s+"."),e.SendSnapAndCreateViewer(n,i,r,u,f,!1));e.m_onPresentationUrlSetCreateViewerCallback=undefined},h)):(i.ULS.traceTag(544282374,logCategory.PptSession,logLevel.Info,"Boot without using presentationUrl. fUsePresUrlToBoot:"+o+"; fUsePresUrlDark:"+p+"; isPresenter:"+c+"; isBinary:"+s+";"),this.SendSnapAndCreateViewer(n,i,r,u,f,o),!((y=this.m_pptFeatureGates)===null||y===void 0?void 0:y.DisableSnapToPodsRegionSpecificUrl)&&n.WopiPrecheckInfo.FileGetUrl&&n.ApplicationCustomSettings&&n.ApplicationCustomSettings.OnDemandServer&&(l=SnapUrlToPodsRegion.tryGetPodsRegionSpecificUrl(new URL(n.WopiPrecheckInfo.FileGetUrl),i),i.ULS.traceTag(528868488,logCategory.PptSession,logLevel.Info,"PresentationUrl: podsDCSpecificUrl "+l+", pods url "+n.ApplicationCustomSettings.OnDemandServer),l!=""&&(n.ApplicationCustomSettings.OnDemandServer=l)))},n.prototype.HandleGetPresentationUrlError=function(n,t,i,r,u){r.getPresentationUrlEndTime=Date.now();i.ULS.traceTag(540669892,logCategory.PptSession,logLevel.Error,"PresentationUrl: error getting PresUrl; fail the session: "+n+"; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime));var f=ApplicationErrorMap.convertServerErrorToAppErrorCode(n,i),e={errorType:"AppInitError",errorObject:n,Category:0,Code:f!==5001?f:103,ErrorName:f!==5001?n:"GetPresentationUrlException",EventType:13,ExtraInfo:"Exception during getPresentationUrl: "+n,SessionId:t.SessionInformation.HostSessionId},o=__assign(__assign({},r),{presenterErrorInfo:e}),s={m_type:"presentationUrl",m_url:"",m_metadata:o};StateServiceClientLoader.SendMessage(s);u===null||u===void 0?void 0:u.recordQosError(e.ErrorName,["FileOpenFailed"],!1,!0,!0,!0);t.FnOnInitializeFailure(e)},n.prototype.SendSnapAndCreateViewer=function(t,i,r,u,f,e){PPTBootstrapper.getSlideShowKind(t,i)!="Modern"||e||this.SendSnapDownloadUrlRequest(t,i);this.m_frameContainerContext||(i.ULS.traceTag(528867784,logCategory.PptSession,logLevel.Info,"Bootstrap - create frameContainerContext in SendSnapAndCreateViewer"),this.m_frameContainerContext=new FrameContainerContext(t,i));i.ULS.traceTag(527958918,logCategory.PptSession,logLevel.Info,"Bootstraper - SendSnapAndCreateViewer");n.CreateViewer(t,this.m_frameContainerContext,i,r,this.m_appErrors,u,f)},n.prototype.SendSnapDownloadUrlRequest=function(t,i){var f,e,o;try{if(t==null||t.ApplicationCustomSettings==null||t.SessionInformation==null)return;var c=t.SessionInformation.HostSessionId||"",l=t.SessionInformation.HostName||"",a=t.SnapRequestID||"",s=t.SessionInformation.CallId||"",v=t.WopiPrecheckInfo.FileGetUrl||"",y=t.WopiPrecheckInfo.FileSize||0,p=t.WopiPrecheckInfo.ETag||"",w=t.WopiPrecheckInfo.DocUniqueId||"",b=t.ApplicationCustomSettings.OnDemandServer||"",h=t.WopiPrecheckInfo.FileName||"",k=PPTBootstrapper.isBinaryFile(h,i),r=null,u="";try{u=SnapRegionInfo.getOnDemandSnapServer(t.ApplicationUrl,t);r=SnapRegionInfo.snapFlighting(t.ApplicationUrl,s,t,i);i.ULS.traceTag(540567008,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapper: snap region: "+u==null?"":u.replace("https://","").replace("http://",""));r&&(t.SessionInformation.UseSnapService=r.UseSnap,i.ULS.traceTag(540567009,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapper: snap region:"+r.UseSnap+", isenabled: "+r.Reason+" "))}catch(d){i.ULS.traceTag(540567010,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapper: error in getting snap region: "+JSON.stringify(d))}(k||((f=this.m_pptFeatureGates)===null||f===void 0?void 0:f.DisableNewSnapService))&&(r=null,u="",t.SessionInformation.UseSnapService=!1);t.SessionInformation.SnapUrl=u;n.SendSnapDownloadUrlRequestCore("OnBoot",c,l,a,s,v,p,w,b,u,r,h,(e=this.m_pptFeatureGates)===null||e===void 0?void 0:e.ForceMediaProtocol,(o=this.m_pptFeatureGates)===null||o===void 0?void 0:o.PdfLiveEnabled,i,y)}catch(g){i.ULS.traceTag(588107799,logCategory.PptSession,logLevel.Error,"Exception in SendSnapDownloadUrlRequest: "+g.message)}},n.SendSnapDownloadUrlRequestCore=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){var ut=(new Date).getTime(),d,it,k,w,rt;try{if(d=PPTBootstrapper.isBinaryFile(l,y),d){y&&y.ULS.traceTag(545887843,logCategory.PptSession,logLevel.Info,"Skiping call for binary files");return}}catch(g){y===null||y===void 0?void 0:y.ULS.traceTag(545887872,logCategory.PptSession,logLevel.Error,"Exception in SendSnapDownloadUrlRequestCore while evaluating binary file extension: "+g.message)}y===null||y===void 0?void 0:y.ULS.traceTag(588107801,logCategory.PptSession,logLevel.Info,"SendSnapDownloadUrlRequestCore with callId: "+u+"; triggerOrigin: "+n+"; snapRequestId: "+r+";");try{var ft=PPTBootstrapper.getFileExtension(l,y),b=PPTPreviewerBootstrapperUtils.createSnapRequestHeaders(t,i,r,u),nt=window.location.search.indexOf("wdAuthHeaderForHostDownloadEnabled")>=0,tt=window.location.search.indexOf("wdUseSpoProxy")>=0;v&&ft.toLowerCase()=="pdf"?(k={ID:r,DownloadUrl:f,FileLengthHint:p,ETag:e,DocID:o,MultiRangeEnabled:!1,TailRangeEnabled:!0,AuthHeaderForHostDownloadEnabled:nt,SpoClientEnabled:tt,FileType:"pdf"},w="",c!=null&&c.UseSnap?(y===null||y===void 0?void 0:y.ULS.traceTag(540567011,logCategory.PptSession,logLevel.Info,"SendSnapDownloadUrlRequestCore to snap service"),fetch(h+"SnapFileHandler.ashx",{method:"POST",headers:b,body:JSON.stringify(k)})):fetch(s+"SnapFileHandler.ashx",{method:"POST",headers:b,body:JSON.stringify(k)})):(it={ID:r,DownloadUrl:f,FileLengthHint:p,ETag:e,DocID:o,MultiRangeEnabled:!1,TailRangeEnabled:!0,AuthHeaderForHostDownloadEnabled:nt,SpoClientEnabled:tt},w="",c!=null&&c.UseSnap?(y===null||y===void 0?void 0:y.ULS.traceTag(527979679,logCategory.PptSession,logLevel.Info,"SendSnapDownloadUrlRequestCore to snap service"),w=h+"SnapUrlHandler.ashx"):w=s+"SnapUrlHandler.ashx",a!==undefined&&(w=UrlUtils.addOrReplaceParameterValue(w,"forceMediaProtocol",a)),fetch(w,{method:"POST",headers:b,body:JSON.stringify(it)}));y&&(rt={SendSnapDownloadUrlStart:ut,SendSnapDownloadUrlEnd:(new Date).getTime(),CallId:u},y.ULS.traceTag(588107800,logCategory.PptSession,logLevel.Info,JSON.stringify(rt,PPTBootstrapper.undefinedReplacer)))}catch(g){y===null||y===void 0?void 0:y.ULS.traceTag(577013019,logCategory.PptSession,logLevel.Error,"Exception in SendSnapDownloadUrlRequestCore: "+g.message)}},n.InitAppSettingsWithDefaults=function(n){n.ApplicationCustomSettings||(n.ApplicationCustomSettings={});var t=n.ApplicationCustomSettings;return t.AddShadowBorder=!!t.AddShadowBorder,t.EnableAdvanceOnClick=tryReadBoolDefaultTrue(t.EnableAdvanceOnClick),t.EnableAutoAdvance=t.EnableAutoAdvance!=undefined?t.EnableAutoAdvance:PodsRegionInfo.getUiHost(n.SessionInformation.HostName)!="teams",t.EnableKeyboardNavigation=tryReadBoolDefaultTrue(t.EnableKeyboardNavigation),t.EnableWacFallback=tryReadBoolDefaultTrue(t.EnableWacFallback),t.ForceHttp=!!t.ForceHttp,t.PreserveDrawingBuffer=!!t.PreserveDrawingBuffer,t.TakeFocusOnBoot=tryReadBoolDefaultTrue(t.TakeFocusOnBoot),t.UseTransparentBackground=tryReadBoolDefaultTrue(t.UseTransparentBackground),t.EnableAdvanceOnTap=!!t.EnableAdvanceOnTap,t},n.WopiPendingFail=function(t,i,r){var u=i,e=u==null?"":u.message,f;r.ULS.traceTag(38286594,logCategory.PptSession,logLevel.Warning,"WopiPendingFail - message: "+e);f=u==null?!1:u.shutdownApp==!0;f&&n.CleanupWopiPending(t)},n.CleanupWopiPending=function(n){var i=PPTMessageListenerRegistry.getInstance(),t=i.get(n);t===null||t===void 0?void 0:t.Dispose()},n.SanitizeInputParametersForFallbackLog=function(n){return{BootstrapperUrl:n.BootstrapperUrl,Container:n.Container,PostMessageToken:n.PostMessageToken,PreviewerRolloutRing:n.PreviewerRolloutRing,SessionInformation:{HostName:n.SessionInformation.HostName,HostSessionId:n.SessionInformation.HostSessionId,UserId:""},ApplicationUrl:n.ApplicationUrl,WopiPrecheckInfo:{FileName:""},NewFileTemplateSource:{},ApplicationCustomSettings:n.ApplicationCustomSettings,Diagnostics:n.Diagnostics,FnOnInitializeSuccess:n.FnOnInitializeSuccess,FnOnInitializeFailure:n.FnOnInitializeFailure}},n.ShouldUsePODS=function(n,t){var i;return window.location.search.indexOf("wdTestWac=1")>=0||window.location.search.indexOf("wdTestWac=1")>=0?createUsePODSDetails(!1,!1,"wdTestWac set to true in Host Page URL"):((i=n.ApplicationCustomSettings)===null||i===void 0?void 0:i.OnDemandServer)?createUsePODSDetails(!0,!0,"OnDemandServer provided by Host"):!n.ApplicationUrl&&n.SessionInformation.HostName!="MSTeams"&&n.SessionInformation.HostName!="TeamsiOS"&&n.SessionInformation.HostName!="apiTest"&&n.SessionInformation.HostName!="TeamsAndroid"?createUsePODSDetails(!1,!1,"No Application URL provided (Sharepoint)"):n.ApplicationUrl?window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0||window.location.search.indexOf("wdTestWacPreviewer=1")>=0?createUsePODSDetails(!0,!0,"wdTestPreviewer set to true in Host Page URL"):PPTBootstrapper.podsFlighting(n,t):createUsePODSDetails(!0,!0,"No Application URL provided")},n.LogShouldUsePodsOrCachedResult=function(n,t,i,r){var u={ShouldUsePods:n.ShouldUsePODS,CanUsePods:n.CanUsePODS,ApplicationUrl:PPTBootstrapper.extractHostname(t),Reason:i};r.ULS.traceTag(38286595,logCategory.PptSession,logLevel.Info,JSON.stringify(u))},n.GetWacPreviewURL=function(n,t){var i,u,f,r;return n.WopiSrc.indexOf("PowerPointFrame.aspx")>=0&&(i=n.WopiSrc.substr(n.WopiSrc.indexOf("WOPISrc=")+8),u=i.indexOf("&"),n.WopiSrc=u<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,u))),f=t.ApplicationUrl.indexOf("?"),r=t.ApplicationUrl.substring(0,f)+"?PowerPointView=ReadingView&wdnc=1&wdEnableRoaming=1&wdo=1",r=PPTBootstrapper.appendCommonFrameUrlQueryParams(r,t),PPTPreviewerBootstrapperUtils.AppendCommonFallbackQueryParams(r,t,n.WopiSrc)},n.prototype.InitializePodsExisting=function(t){var s=n.TryLoadSlice(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),i,r,e,u,f,o;t.WopiPrecheckInfo.BundleInfo||(t.WopiPrecheckInfo.BundleInfo={MajorVersion:0});t.ApplicationCustomSettings=n.InitAppSettingsWithDefaults(t);!t.ApplicationCustomSettings.OnDemandServer&&window.location.href&&(t.ApplicationCustomSettings.OnDemandServer=window.location.href.split("SlideShowFrame.html")[0]);i=ULS.getLogger(t.SessionInformation.HostSessionId,t.ApplicationCustomSettings.OnDemandServer+"RemoteUls.ashx");i.ULS.traceTag(40206740,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing PodsExisting. Slice load initated: "+s);PPTBootstrapper.sendInitialLog(t,"Slide Show",null,i);r=PPTBootstrapSettings.getAppMetadata();r&&r.Environment=="wac"&&(t.ApplicationCustomSettings.WacStaticResourcesServer=PPTBootstrapper.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t));e={podsSessionId:t.WopiPrecheckInfo.PodSessionId};i.ULS.traceTag(38540374,logCategory.PptSession,logLevel.Info,JSON.stringify(e));u=PPTMessageListenerRegistry.getInstance().get(t.SessionInformation.HostSessionId);u&&(i.ULS.traceTag(39416217,logCategory.PptSession,logLevel.Error,"InitializePodsExisting found a session already created for this id. Disposing it"),u.DisposePreloadedApp());this.m_frameContainerContext=new FrameContainerContext(t,i);f=new PreviewSessionLoader(t,this.m_frameContainerContext,i,r,this.m_appErrors,!1);f.LoadApp(t.WopiPrecheckInfo.PodSessionId,!1,{});o=t.ApplicationCustomSettings&&t.ApplicationCustomSettings.AllowExternalMarketplace!=undefined?!!t.ApplicationCustomSettings.AllowExternalMarketplace:!0;f.LaunchFromSlide({PresentationId:t.WopiPrecheckInfo.PodSessionId,StartingSlideId:t.ApplicationCustomSettings.StartingSlideId,StartingSlideIndex:t.ApplicationCustomSettings.StartingSlideIndex,Diagnostics:t.Diagnostics,SendInitialLog:!1,StreamVideoUseThinEmbed:!1,DisabledChangeGates:t.ApplicationCustomSettings.DisabledChangeGates,AreThirdPartyAddInsAllowed:!!t.ApplicationCustomSettings.AreThirdPartyAddInsAllowed,AllowExternalMarketplace:o});PPTBootstrapper.logBootstrapperPerformanceInfo(t.BootstrapperUrl,"InitializePodsExisting",i)},n.prototype.PreloadApp=function(t){var e=(new Date).getTime(),o=n.TryLoadSlice(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),i,r,u,f;return t.WopiPrecheckInfo.BundleInfo||(t.WopiPrecheckInfo.BundleInfo={MajorVersion:0}),t.ApplicationCustomSettings=n.InitAppSettingsWithDefaults(t),i=ULS.getLogger(t.SessionInformation.HostSessionId,t.ApplicationCustomSettings.OnDemandServer+"RemoteUls.ashx"),i.ULS.traceTag(40206741,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session. Slice load initated: "+o),PPTBootstrapper.sendInitialLog(t,"Preload App",null,i),r=PPTBootstrapSettings.getAppMetadata(),r.Environment=="wac"&&(t.ApplicationCustomSettings.WacStaticResourcesServer=PPTBootstrapper.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t)),this.m_frameContainerContext=new FrameContainerContext(t,i),u=new PreviewSessionLoader(t,this.m_frameContainerContext,i,r,this.m_appErrors,!1),u.LoadApp(null,!0,{}),f={PreloadAppFunctionStart:e,PreloadAppFunctionEnd:(new Date).getTime()},i.ULS.traceTag(38286596,logCategory.PptSession,logLevel.Info,JSON.stringify(f,PPTBootstrapper.undefinedReplacer)),PPTBootstrapper.logBootstrapperPerformanceInfo(t.BootstrapperUrl,"PreloadApp",i),u},n.prototype.GetVersion=function(){return BuildVersionConfig.BUILD_NUMBER},n.GetMinContentVersion=function(){return 1},n.Prefetch=function(t){var i;if((n.s_prefetchStartTime=(new Date).getTime(),n.prefetchRequiredOnly(t,[]),t!=null)&&(i=t.IsModernSlideShowInTeamsEnabled!=null&&t.IsModernSlideShowInTeamsEnabled,i&&t.FileGetUrl!=null&&t.WacUrl!=null)){var u="snapRequestID_"+PPTBootstrapper.generateRandomUUID(),r=PodsRegionInfo.tryGetPodsRegion(t.WacUrl,null,!1),f=SnapRegionInfo.snapFlighting(t.WacUrl,"",null,null),e=SnapRegionInfo.getOnDemandSnapServer(t.WacUrl,null);r&&n.SendSnapDownloadUrlRequestCore("Prefetch","",t.HostName,u,t.CallId,t.FileGetUrl,t.ETag,t.DocId,r.PodsURL,e,f,"",undefined,undefined,undefined,t.FileSize)}},n.prefetchRequiredOnly=function(t,i){var e=(t===null||t===void 0?void 0:t.IsLegacyAspxInTeamsEnabled)!=null&&(t===null||t===void 0?void 0:t.IsLegacyAspxInTeamsEnabled),o=!!(t===null||t===void 0?void 0:t.IsModernSlideShowInTeamsEnabled),r=[],u,f;r=e?o?["pptscripts/slideshowapp.js","pptscripts/slideshowui.js",]:["pptscripts/microsoftajax.js","pptscripts/bootview.js","pptscripts/WebViewerPreboot.js","pptscripts/ppt.slideshowplayer.api.js","pptscripts/ppt.inkcanvasmanager.js","pptscripts/transitions.js","pptscripts/ppttelemetry.js"]:["powerpointframe.html"];u=PPTBootstrapSettings.getAppMetadata();t&&u.Environment!="wac"&&r.push("AppMetadata.js");f=r.concat(i);n.PrefetchSpecifiedResources(t,f)},n.PrefetchSpecifiedResources=function(t,i){var u=PPTBootstrapSettings.getAppMetadata(),r=null;r=(t===null||t===void 0?void 0:t.IsModernSlideShowInTeamsEnabled)?PPTBootstrapper.getWacStaticResourcesServer(null,null,t===null||t===void 0?void 0:t.BootstrapperUrl,null)+u.WacCdnVersion+"_":PPTBootstrapper.getWacStaticResourcesServer(null,null,t===null||t===void 0?void 0:t.BootstrapperUrl,null)+u.WacCdnVersion+"_slideshowresources/";i.forEach(function(t){try{ViewerBrowserUtils.SupportPreloadLink()?t==="powerpointframe.html"?n.CreatePrefetchLink(r+t):n.CreatePreloadLink(r+t,"script"):n.CreatePrefetchLink(r+t)}catch(i){}})},n.CreatePreloadLink=function(n,t){var i=document.createElement("link");i.rel="preload";i.href=n;t!==""&&i.setAttribute("as",t);document.getElementsByTagName("head")[0].appendChild(i)},n.CreatePrefetchLink=function(n){var t=document.createElement("link");t.rel="prefetch";t.href=n;document.getElementsByTagName("head")[0].appendChild(t)},n.CreateViewer=function(n,t,i,r,u,f,e){var h,a,v,o,c,l,s;if(r.createViewerTime=Date.now(),a=PPTBootstrapSettings.getAppMetadata(),v=PPTBootstrapper.getOnDemandServer(n),i=ULS.getLogger(n.SessionInformation.HostSessionId,v+"RemoteUls.ashx"),!n.WopiPrecheckInfo.FileGetUrl){o={EventType:13,Code:10,ErrorName:"MissingFileGetUrl",Category:0,ExtraInfo:"",SessionId:n.SessionInformation.HostSessionId,errorType:"AppInitError",errorObject:"wopiPrecheckInfo.FileGetUrl not included"};e===null||e===void 0?void 0:e.recordQosError(o.ErrorName,["FileOpenFailed"],!1,!1,!0,!0);n.FnOnInitializeFailure(o);return}if(!n.Container){o={EventType:13,Code:11,ErrorName:"NoAppContainer",Category:0,ExtraInfo:"",SessionId:n.SessionInformation.HostSessionId,errorType:"AppInitError",errorObject:"Container"};e===null||e===void 0?void 0:e.recordQosError(o.ErrorName,["FileOpenFailed"],!1,!1,!0,!0);n.FnOnInitializeFailure(o);return}if(c="",(h=n.SessionInformation)===null||h===void 0?void 0:h.WdParams)for(l in n.SessionInformation.WdParams)c=c+"&"+l+"="+n.SessionInformation.WdParams[l];var p=BrowserUtils.devicePixelRatio(),w=n.ApplicationCustomSettings.AddShadowBorder?10:0,b=n.Container.getBoundingClientRect(),y="";n.WopiPrecheckInfo.BundleInfo&&(n.WopiPrecheckInfo.BundleInfo.Url=undefined,i.ULS.traceTag(38540377,logCategory.PptSession,logLevel.Info,"Cleared bundle info url"));s=new PreviewSessionLoader(n,t,i,a,u,!0,f,e);s.LoadApp(y,!1,r);s.LaunchFromSlide({PresentationId:y,StartingSlideId:n.ApplicationCustomSettings.StartingSlideId,StartingSlideIndex:n.ApplicationCustomSettings.StartingSlideIndex,Diagnostics:n.Diagnostics,SendInitialLog:!1,StreamVideoUseThinEmbed:!1,DisabledChangeGates:n.ApplicationCustomSettings.DisabledChangeGates,AreThirdPartyAddInsAllowed:n.ApplicationCustomSettings.AreThirdPartyAddInsAllowed!=null?n.ApplicationCustomSettings.AreThirdPartyAddInsAllowed:!1,AllowExternalMarketplace:n.ApplicationCustomSettings.AllowExternalMarketplace!=null?n.ApplicationCustomSettings.AllowExternalMarketplace:!1});r.bootstrapperInitTime&&s.RecordBootStrapperInitTime(r.bootstrapperInitTime)},n.s_prefetchStartTime=0,n}();var PPTPreviewerBootstrapperUtils=function(){function n(){}return n.SanitizeInitialParameters=function(n,t){var u,i,r;if(n.SessionInformation.WdParams||(n.SessionInformation.WdParams={}),n.SessionInformation&&n.SessionInformation.DocumentClickTime)try{u=n.SessionInformation.DocumentClickTime.getTime()}catch(f){t.ULS.traceTag(590123598,logCategory.PptSession,logLevel.Warning,"DocumentClickTime was not of type Date");n.SessionInformation.DocumentClickTime=undefined}try{n.SessionInformation.HostName=="TeamsAndroid"&&(!n.SessionInformation.ContentId&&n.ContentID&&(n.SessionInformation.ContentId=n.ContentID),!n.SessionInformation.UserId&&n.UserId&&(n.SessionInformation.UserId=n.UserId?n.UserId:""),!n.SessionInformation.TenantId&&n.TenantId&&(n.SessionInformation.TenantId=n.TenantId),!n.SessionInformation.EndpointId&&n.EndpointID&&(n.SessionInformation.EndpointId=n.EndpointID),!n.SessionInformation.IsPresenter&&n.IsPresenter&&(n.SessionInformation.IsPresenter=n.IsPresenter))}catch(f){t.ULS.traceTag(587327070,logCategory.PptSession,logLevel.Warning,"Exception trying to parse Android session params")}try{if(n.SessionInformation.HostName=="TeamsiOS"){if(n.SessionInformation.WdParams)for(i in n.SessionInformation.WdParams)(n.SessionInformation.WdParams[i]==="0"||n.SessionInformation.WdParams[i]==="false")&&(t.ULS.traceTag(546182108,logCategory.PptSession,logLevel.Info,"Converting "+i+" from "+n.SessionInformation.WdParams[i]+" to false"),n.SessionInformation.WdParams[i]=!1),(n.SessionInformation.WdParams[i]==="1"||n.SessionInformation.WdParams[i]==="true")&&(t.ULS.traceTag(546182109,logCategory.PptSession,logLevel.Info,"Converting "+i+" from "+n.SessionInformation.WdParams[i]+" to true"),n.SessionInformation.WdParams[i]=!0);r=String(n.SessionInformation.IsPresenter);(r==="0"||r==="false")&&(n.SessionInformation.IsPresenter=!1);(r==="1"||r==="true")&&(n.SessionInformation.IsPresenter=!0);n.SessionInformation.CallId&&(n.SessionInformation.CallId=n.SessionInformation.CallId.toLowerCase());n.SessionInformation.ContentId&&(n.SessionInformation.ContentId=n.SessionInformation.ContentId.toLowerCase());n.SessionInformation.ParticipantId&&(n.SessionInformation.ParticipantId=n.SessionInformation.ParticipantId.toLowerCase())}}catch(f){t.ULS.traceTag(546182110,logCategory.PptSession,logLevel.Warning,"Exception trying to parse iOS session params")}return n},n.AppendCommonFallbackQueryParams=function(n,t,i){return t.SessionInformation.HostSessionId&&(n=UrlUtils.addOrReplaceParameterValue(n,"hid",t.SessionInformation.HostSessionId)),i&&(n=UrlUtils.addOrReplaceParameterValue(n,"WOPISrc",UrlUtils.urlKeyValueEncode(i))),n},n.IsTeamsPreviewerSession=function(n,t){return!t&&!!n&&!!n.SessionInformation&&!!n.SessionInformation.HostName&&n.SessionInformation.HostName.indexOf("Teams")>=0},n.createSnapRequestHeaders=function(n,t,i,r){var u=new Headers;return u.append("X-UserSessionId",n),u.append("callercorrelationid",i),u.append("X-WacNoAuth","1"),u.append("Scenario","Previewer"),u.append("Client",t+"-Bootstrapper"),u.append("Content-Type","application/json; charset=utf-8"),u.append("CallId",r),u},n.tryGetHostNetworkMetricsFromCallback=function(n,t){var i,r;try{if(!t)return;((i=n===null||n===void 0?void 0:n.SessionInformation)===null||i===void 0?void 0:i.WdParams)?n.SessionInformation.WdParams.enablePptSharingNetworkHealthMetricsCallback&&n.FnGetHostNetworkMetrics&&(t.ULS.traceTag(555045533,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - call FnGetHostNetworkMetrics"),r=(new Date).getTime(),n.FnGetHostNetworkMetrics().then(function(n){var i=(new Date).getTime()-r;t.ULS.traceTag(555045534,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - FnGetHostNetworkMetrics network metrics: "+JSON.stringify(n)+". callbackDuration: "+i)}).catch(function(n){t.ULS.traceTag(555045535,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - exception when executing FnGetHostNetworkMetrics: "+n)})):t.ULS.traceTag(555045536,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - no valid initParams")}catch(u){t&&t.ULS.traceTag(555045537,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - exception when calling FnGetHostNetworkMetrics: "+u)}},n.getTrustedScriptUrl=function(n,t,i,r){var e,o,f="PPTPreviewerBootstrapperUtils::getTrustedScriptUrl-"+i,s,h,u;try{if(s=((o=(e=t.SessionInformation)===null||e===void 0?void 0:e.WdParams)===null||o===void 0?void 0:o.enablePptLiveTrustedScriptUrl)||!1,!s)return n;if(t.FnGetTrustedScriptUrl&&(h=(new Date).getTime(),r&&r.ULS.traceTag(512493647,logCategory.PptSession,logLevel.Info,f+" - start try GetTrustedScriptUrl; dirtyStringLength: "+n.length+";"),u=t.FnGetTrustedScriptUrl(n),r&&r.ULS.traceTag(512493646,logCategory.PptSession,logLevel.Info,f+" - got TrustedScriptUrlLength: "+(u?u.toString().length:0)+"; elapsed: "+((new Date).getTime()-h)+"ms"),u))return u}catch(c){r&&r.ULS.traceTag(512493645,logCategory.PptSession,logLevel.Error,f+" - Exception getting TrustedScriptUrl: "+c)}return r&&r.ULS.traceTag(512493648,logCategory.PptSession,logLevel.Error,f+" - not able to get TrustedScriptUrl, return dirtyUrl."),n},n}(),PreviewSessionLoader=function(){function n(t,i,r,u,f,e,o,s){if(this.m_startingSlideId=-1,this.m_startingSlideIndex=-1,this.m_vetoAppSettingsStr="",this.m_disabledTransitionsList="",this.m_customTransitionResourceUrl="",this.m_streamUseThinEmbed=!1,this.m_disabledChangeGates="",this.m_iframe=null,this.m_bootTimingDict={},this.m_appBootTimingDict={},this.m_contentMetadata=null,this.m_appInitDiagnostics={},this.m_iframeReadyForPostMessage=!1,this.m_fShouldUseLegacySlideShowAspx=!1,this.m_slideshowKind="",this.m_iframeLoadTimeout=undefined,this.m_retryPreviewerTimeout=undefined,this.m_bootCompleted=!1,this.c_appErrorThrottleCount=5,this.c_iframeLoaded="iframeLoaded",this.c_contentMetadataLoadedOrDoesNotExist="contentMetadataLoaded",this.c_activated="activated",this.c_minHeight=100,this.c_minIframeHeight=100,this.m_callbackIframeLoadFailed={errorType:"AppInitError",errorObject:"Failed to load iframe",Category:0,Code:101,ErrorName:"FailedToLoadIframe",EventType:13,ExtraInfo:"Iframe load Error"},!t)throw Error("initParams is null");if(!t.SessionInformation.HostSessionId)throw Error("sessionId is null");this.m_apiId=t.SessionInformation.HostSessionId;this.m_appMetaData=u;this.m_apiStartTime=Date.now();this.m_logger=r;this.m_appErrors=f;this.m_healthLogger=s;this.m_frameContainerContext=i;o&&(o.setAppInitDiagnostics(this.m_appInitDiagnostics),this.m_timeoutWrapper=o);t.ApplicationCustomSettings&&!t.ApplicationCustomSettings.OnDemandServer&&(t.ApplicationCustomSettings.OnDemandServer=PPTBootstrapper.getOnDemandServer(null));this.m_initParams=t;this.m_fShouldUseLegacySlideShowAspx=e;this.m_slideshowKind=PPTBootstrapper.getSlideShowKind(this.m_initParams,r);this.m_frameContainerContext.slideshowKind=this.m_slideshowKind;this.m_frameContainerContext.shouldUseAspxForLegacy=this.m_fShouldUseLegacySlideShowAspx;this.m_anchor=t.Container;t.ApplicationCustomSettings?(this.m_fVariableWidth=!n.FIsUintValid(t.ApplicationCustomSettings.Width),this.m_fVariableHeight=!n.FIsUintValid(t.ApplicationCustomSettings.Height),this.m_startingSlideId=t.ApplicationCustomSettings.StartingSlideId||-1,this.m_startingSlideIndex=t.ApplicationCustomSettings.StartingSlideIndex||-1):(this.m_fVariableWidth=!0,this.m_fVariableHeight=!0);t.Diagnostics&&t.Diagnostics.userClickTime?this.m_bootTimingDict.DocumentClickTime=t.Diagnostics.userClickTime:t.SessionInformation.DocumentClickTime&&(this.m_bootTimingDict.DocumentClickTime=t.SessionInformation.DocumentClickTime.getTime());r.ULS.traceTag(556057426,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader starting with shouldUseAspxPage:"+this.m_fShouldUseLegacySlideShowAspx.toString()+", slideshowKind:"+this.m_slideshowKind);this.m_slideShowLoader=new SlideShowLoader(t,this.m_frameContainerContext,r,u);PPTMessageListenerRegistry.getInstance().get(this.m_apiId)&&r.ULS.traceTag(39203528,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader is about to overwrite value in PPTMessageListenerRegistry");PPTMessageListenerRegistry.getInstance().add(this.m_apiId,this,!0,"PreviewSessionLoader")}return n.FIsUintValid=function(n){return!(n==null||n<0||isNaN(n))},n.UpdateBaseIframe=function(n,t,i){return t.id="pptframe-"+n,t.frameBorder="0",t.style.top=HTMLHelper.toPx(0),t.style.bottom=HTMLHelper.toPx(0),t.style.left=HTMLHelper.toPx(0),t.style.right=HTMLHelper.toPx(0),t.style.width=HTMLHelper.floatToPercent(1),t.style.height=HTMLHelper.floatToPercent(1),t.setAttribute("allowfullscreen",(!0).toString()),t.setAttribute("allowTransparency",(!0).toString()),t.setAttribute("allow","autoplay "+i),t},n.prototype.registerOnLoadEvent=function(){var n=this;this.removeIframeOnLoadEvent();this.m_onLoad=function(){return n.OnIframeLoaded()};this.m_iframe.addEventListener("load",this.m_onLoad,!1)},n.prototype.registerOnUnloadEvent=function(){var n=this;this.m_iframe.addEventListener("unload",function(){n.m_logger.ULS.traceTag(588044115,logCategory.PptSession,logLevel.Warning,"Unloading previewer iframe");n.m_appErrors.length>0&&n.m_logger.ULS.traceTag(588044114,logCategory.PptSession,logLevel.Warning,JSON.stringify(n.m_appErrors));n.m_logger.ULS.flushOnClose()})},n.prototype.registerOnLoadErrorEvent=function(){var n=this;this.m_onLoadError=function(){return n.OnIframeLoadError()};this.m_iframe.addEventListener("error",this.m_onLoadError,!1)},n.prototype.removeIframeOnLoadEvent=function(){this.m_onLoad&&this.m_iframe.removeEventListener("load",this.m_onLoad)},n.prototype.OnIframeLoaded=function(){var n=this;this.m_logger.ULS.traceTag(39416209,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::OnIframeLoaded");this.m_bootTimingDict.iFrameOnloadEventInApi=Date.now();this.m_iframeReadyForPostMessage||(this.m_iframeLoadTimeout=window.setTimeout(function(){return n.IframeLoadTimeout()},15e3))},n.prototype.OnIframeLoadError=function(){this.m_logger.ULS.traceTag(590424142,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::OnIframeLoadError : iframe Id: "+this.m_iframe.id);this.m_healthLogger&&this.m_healthLogger.recordQosError(this.m_callbackIframeLoadFailed.ErrorName,["FileOpenFailed"],!1,!0,!0,!0);this.m_initParams.FnOnInitializeFailure&&this.m_initParams.FnOnInitializeFailure(this.m_callbackIframeLoadFailed);this.m_onLoadError&&this.m_iframe.removeEventListener("error",this.m_onLoadError)},n.prototype.IframeLoadTimeout=function(){var t,n,r,i;if(this.m_iframeReadyForPostMessage){this.m_logger.ULS.traceTag(39416210,logCategory.PptSession,logLevel.Warning,"IFrameLoadTimeout called even though iframe is ready for postmessage");return}if(!this.m_apiId){this.m_logger.ULS.traceTag(39416211,logCategory.PptSession,logLevel.Warning,"IFrameLoadTimeout called after m_apiId is null");return}r=(t=this.m_initParams)===null||t===void 0?void 0:t.Container;i=!HTMLHelper.isInDomTree(r);this.m_logger.ULS.traceTag(545378775,logCategory.PptSession,logLevel.Warning,"App container is unloaded: "+i);n=i?{EventType:13,Code:7,ErrorName:"AppContainerUnloadedTimeout",Category:0,ExtraInfo:"App container uploaded before iframe loaded",SessionId:this.m_apiId,errorType:"13",errorObject:null}:{EventType:13,Code:100,ErrorName:"TimeoutWaitingForIframeToLoad",Category:0,ExtraInfo:"Timeout waiting for iframe to load",SessionId:this.m_apiId,errorType:"13",errorObject:null};PPTBootstrapperLogger.recordBootstrapperTimeoutFailure(this.m_initParams,n===null||n===void 0?void 0:n.Code,n===null||n===void 0?void 0:n.ErrorName,n===null||n===void 0?void 0:n.ExtraInfo,this.m_logger,Date.now(),this.m_appErrors);this.FailToBoot(n)},n.prototype.Activate=function(){if(!this.m_apiId){this.m_logger.ULS.traceTag(38540363,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::Activate is missing apiId or presentationId");return}this.m_logger.ULS.traceTag(38540364,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::Activate");(this.m_iframe==null||this.m_iframe.parentElement==null)&&this.m_logger.ULS.traceTag(39203531,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::Activate - iframe is null or detached from parent");this.m_bootTimingDict.ActivateInApi=Date.now();var n=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation!=undefined?this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation:!0,t=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnTap!=undefined?this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnTap:!1,i=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed!=undefined?this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed:!1,r=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace!=undefined?this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace:!0;if(this.PostMessageDownward(new HandshakeWebViewerInternalMessage(this.m_apiId,n,this.m_contentMetadata,this.m_initParams.WopiPrecheckInfo.FileGetUrl,this.m_initParams.WopiPrecheckInfo.FileSize,this.m_initParams.WopiPrecheckInfo.FileName,this.m_presentationId,this.m_startingSlideId,this.m_startingSlideIndex,this.m_initParams.SessionInformation.HostName,this.m_initParams.Diagnostics?this.m_initParams.Diagnostics.entryPoint:"",this.m_apiStartTime,this.m_initParams.Diagnostics?this.m_initParams.Diagnostics.userClickTime?this.m_initParams.Diagnostics.userClickTime:0:0,this.m_initParams.SessionInformation.HostInitTime?this.m_initParams.SessionInformation.HostInitTime:0,t,PodsRegionInfo.getFileHost(this.m_initParams),this.m_vetoAppSettingsStr,this.m_disabledTransitionsList,this.m_customTransitionResourceUrl,this.m_streamUseThinEmbed,this.m_disabledChangeGates,PodsRegionInfo.getWACRegion(this.m_initParams.ApplicationUrl),i,r)),!this.m_finishedBootingConditional){this.m_logger.ULS.traceTag(51448026,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::OnMesssage - Conditional Action uninitialized");throw Error("m_finishedBootingConditional");}this.m_finishedBootingConditional.SetCondition(this.c_activated)},n.prototype.PostMessageDownward=function(n){this.m_frameContainerContext.postMessageDownward(n)},n.prototype.FailToBoot=function(n){if(this.m_logger.ULS.traceTag(38540365,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::FailToBoot: "+JSON.stringify(n)),this.m_healthLogger){var t=n.ErrorName;t||(t=n.Code?n.Code.toString():"UnknownFailToBootError");this.m_healthLogger.recordQosError(t,["FileOpenFailed"],!1,!0,!0,!0)}this.Dispose();this.m_initParams.FnOnInitializeFailure(n,{appBootTimingDict:JSON.stringify(this.m_appBootTimingDict)})},n.prototype.FinishBoot=function(n,t){if(!this.m_apiId||!this.m_anchor||!this.m_iframe){this.m_logger.ULS.traceTag(38540366,logCategory.PptSession,logLevel.Error,"FinishBoot is missing parameters");return}this.m_logger.ULS.traceTag(38540367,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::FinishBoot");var u=this.m_appMetaData?this.m_appMetaData.AppVersionMajor+"."+this.m_appMetaData.AppVersionMinor:"Not Ready",f=function(n){var t=PPTMessageListenerRegistry.getInstance();t&&t.remove(n,!0,"FinishBoot::DisposeCallBack")},i=n.GetPreviewAPIV1(this.m_anchor,this.m_iframe,this.m_frameContainerContext,this.m_apiId,!1,u,this.m_slideshowKind,this.m_initParams,t.perceivedLoadTime,f,this.m_logger,{timeoutWrapper:this.m_timeoutWrapper}),r=PPTMessageListenerRegistry.getInstance();r.remove(this.m_apiId,!0,"FinishBoot::TransferRegistration");r.add(this.m_apiId,i,!0,"FinishBoot::TransferRegistration");this.DisposeForTransferToPreviewAPI();this.m_logger.ULS.traceTag(38540368,logCategory.PptSession,logLevel.Info,"FinishBoot - returning FnOnInitializeSuccess");this.m_initParams.FnOnInitializeSuccess(i,t)},n.prototype.onSliceLoaded=function(){this.m_apiId&&this.m_bootCompleted&&n.s_previewAPIFactory?this.FinishBoot(n.s_previewAPIFactory,this.m_appInitDiagnostics):this.m_apiId&&this.m_logger.ULS.traceTag(38540369,logCategory.PptSession,logLevel.Info,"onSliceLoaded: App is not ready yet - "+this.m_apiId.toString())},n.prototype.log=function(n,t){this.m_logger.ULS.traceTag(39978265,logCategory.PptSession,logLevel.Info,n);t!=null&&this.m_logger.ULS.traceTag(591946190,logCategory.PptSession,logLevel.Info,t)},n.prototype.onMessage=function(t,i){var f,e,o,s,c,l,r,a,v,u,h;if(this.m_frameContainerContext.isReceivedMessageValid(t,i)){if(t=t,!t||t.m_type==undefined){this.m_logger.ULS.traceTag(39978266,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::onMessage - received message with the wrong syntax");return}switch(t.m_type){case 0:this.m_bootCompleted=!0;this.m_logger.ULS.traceTag(38540370,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::onMessage - received Handshake from iframe");s=t;c=s.m_percievedBootTime?new Date(s.m_percievedBootTime):undefined;this.m_appInitDiagnostics.perceivedLoadTime=c;this.m_contentMetadata||(l={HttpStatus:this.m_contentMetadataHttpStatusCode},this.m_appInitDiagnostics.errorObject={errorType:"CannotLoadBundleItem",errorObject:l});n.s_previewAPIFactory?this.FinishBoot(n.s_previewAPIFactory,this.m_appInitDiagnostics):this.m_logger.ULS.traceTag(38540371,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::onMessage - Handshake received but PreviewAPIFactory is not available");break;case 10:r=t;!isNaN(r.m_code)&&r.m_code>=0&&(a=0,v={EventType:13,Code:r.m_code,ErrorName:r.m_errorName,Category:a,ExtraInfo:r.m_extraInfo,SessionId:r.m_sessionId,errorType:"13",errorObject:null},this.FailToBoot(v));break;case WebViewerMessageType.OnNetworkHealthChanged:if(u=t,u.m_isHealthy===undefined)return;u.m_addTimeoutTimeMs&&((f=this.m_timeoutWrapper)===null||f===void 0?void 0:f.addTimeIfNotAddedInMs(u.m_addTimeoutTimeMs));u.m_isHealthy?(e=this.m_timeoutWrapper)===null||e===void 0?void 0:e.resume():(o=this.m_timeoutWrapper)===null||o===void 0?void 0:o.pause();break;case 28:if(this.m_bootTimingDict.AppReadyForPostMessage=Date.now(),this.m_logger.ULS.traceTag(39416212,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::onMessage - AppReadyForPostMessage"),this.m_iframeReadyForPostMessage=!0,this.m_iframeLoadTimeout&&(window.clearTimeout(this.m_iframeLoadTimeout),this.m_iframeLoadTimeout=undefined),this.m_retryPreviewerTimeout&&(window.clearTimeout(this.m_retryPreviewerTimeout),this.m_retryPreviewerTimeout=undefined),!this.m_readyToActivateConditional){this.m_logger.ULS.traceTag(51448027,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::onMessage - Conditional Action uninitialized");throw Error("m_readyToActivateConditional");}this.m_readyToActivateConditional.SetCondition(this.c_iframeLoaded);break;case 40:h=t.m_logs;h&&this.m_logger.ULS.traceTag(590885717,logCategory.PptSession,logLevel.Info,h);break;case 41:if(this.m_appErrors.length>=this.c_appErrorThrottleCount)break;t.ErrorName?this.m_appErrors.push({DuringBoot:!this.m_bootCompleted,ErrorName:t.ErrorName,Tag:t.Tag}):this.m_logger.ULS.traceTag(588044113,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::onMessage::PostAppErrorUpwardsForTelemetry message data is missing required field");break;case 42:if(this.m_bootCompleted)break;t.m_appBootTimingDict&&(Object.assign?(Object.assign(this.m_appBootTimingDict,t.m_appBootTimingDict),this.m_appInitDiagnostics.appBootTimingDict=JSON.stringify(this.m_appBootTimingDict)):this.m_logger.ULS.traceTag(577282078,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::onMessage::AppBootPerfDict Object.assign is not supported"));break;case 56:this.m_timeoutWrapper&&this.m_timeoutWrapper.tryUpdateTimeoutErrorStage(t.m_stageInfo,this.m_logger)}}},n.prototype.GenerateSlideShowParams=function(t,i){var r={},o,f,s,h,e,u;if(this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.ExtraUrlParams)for(o=this.m_initParams.ApplicationCustomSettings.ExtraUrlParams.split("&"),f=0;f<o.length;f++)s=o[f].split("="),r[s[0]]=s[1];return this.m_fShouldUseLegacySlideShowAspx?(h=this.m_initParams.ApplicationCustomSettings.WacStaticResourcesServer+this.m_appMetaData.WacCdnVersion,r.staticCdn=encodeURIComponent(h)):this.m_appMetaData.Environment=="wac"&&(r.wacCdnVersion=this.m_appMetaData.WacCdnVersion),t&&(r.pid=encodeURIComponent(t)),r.PowerPointView="ChromelessView",n.FIsUintValid(this.m_startingSlideId)&&this.m_startingSlideId!=0?r.wdSlideId=UrlUtils.urlKeyValueEncode(this.m_startingSlideId.toString()):n.FIsUintValid(this.m_startingSlideIndex)&&(r.wdSlideIndex=UrlUtils.urlKeyValueEncode(this.m_startingSlideIndex.toString())),this.m_initParams.SessionInformation.DataLocale&&(r.rs=this.m_initParams.SessionInformation.DataLocale),this.m_initParams.SessionInformation.UiLocale&&(r.ui=this.m_initParams.SessionInformation.UiLocale),this.m_initParams.SessionInformation.HostSessionId&&(r.hsi=this.m_initParams.SessionInformation.HostSessionId),this.m_initParams.SessionInformation.UseSnapService&&(r.UseSnapService=this.m_initParams.SessionInformation.UseSnapService),this.m_initParams.SessionInformation.SnapUrl&&(r.SnapUrl=UrlUtils.urlKeyValueEncode(this.m_initParams.SessionInformation.SnapUrl)),r.utb=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.UseTransparentBackground!=undefined?this.m_initParams.ApplicationCustomSettings.UseTransparentBackground:!0).toString()),r.wdEaa=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableAutoAdvance!=undefined?this.m_initParams.ApplicationCustomSettings.EnableAutoAdvance?1:0:0).toString()),r.eac=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnClick!=undefined?this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnClick:!0).toString()),r.ekn=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation!=undefined?this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation:!0).toString()),r.vm=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.ViewerMode?this.m_initParams.ApplicationCustomSettings.ViewerMode:0).toString()),r.co=UrlUtils.urlKeyValueEncode(this.m_initParams.WopiPrecheckInfo.BundleInfo.CrossOrigin?this.m_initParams.WopiPrecheckInfo.BundleInfo.CrossOrigin:"anonymous"),r.lcid=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.LCID?this.m_initParams.ApplicationCustomSettings.LCID:"1033").toString()),r.hostname=UrlUtils.urlKeyValueEncode(n.GetHostName(this.m_initParams)),r.ua=UrlUtils.urlKeyValueEncode((!0).toString()),r.asb=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AddShadowBorder!=undefined?this.m_initParams.ApplicationCustomSettings.AddShadowBorder:!1).toString()),r.apiStartTime=UrlUtils.urlKeyValueEncode(this.m_apiStartTime.toString()),r.preloadApp=UrlUtils.urlKeyValueEncode(i.toString()),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.TakeFocusOnBoot&&(r.takeFocusOnBoot=UrlUtils.urlKeyValueEncode(UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.TakeFocusOnBoot.toString()))),r.isCombineRequest=UrlUtils.urlKeyValueEncode(UrlUtils.urlKeyValueEncode((!0).toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.NoCacheToken&&(r.noCacheToken=UrlUtils.urlKeyValueEncode(UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.NoCacheToken))),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EndSlideShowText&&(r.endSlideShowText=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.EndSlideShowText)),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.HostSupportsSessionRefreshEnabled&&(r.hostSupportsSessionRefreshEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.HostSupportsSessionRefreshEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.InkingEnabled&&(r.inkingEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.InkingEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsNewSlideShowToolbarEnabled&&(r.isNewSlideShowToolbarEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsNewSlideShowToolbarEnabled.toString())),this.m_appMetaData&&this.m_initParams.ApplicationCustomSettings&&!this.m_initParams.ApplicationCustomSettings.Url&&(r.aVMa=UrlUtils.urlKeyValueEncode(this.m_appMetaData.AppVersionMajor.toString()),r.aVMi=UrlUtils.urlKeyValueEncode(this.m_appMetaData.AppVersionMinor.toString()),r.cVMa=UrlUtils.urlKeyValueEncode(this.m_appMetaData.ContentVersionMajor.toString()),r.cVMi=UrlUtils.urlKeyValueEncode(this.m_appMetaData.ContentVersionMinor.toString()),r.env=UrlUtils.urlKeyValueEncode(this.m_appMetaData.Environment.toString()),r.cdnMA=UrlUtils.urlKeyValueEncode("1"),this.m_appMetaData.Environment!="wac"&&(e=PPTBootstrapSettings.getCDNManifestMapping(),r.cdnRD=UrlUtils.urlKeyValueEncode(e["pptscripts/reader.dione.js"].toString()),r.cdnRC=UrlUtils.urlKeyValueEncode(e["pptscripts/reader.calypso.js"].toString()),r.cdnB=UrlUtils.urlKeyValueEncode(e["pptscripts/babylon.js"].toString()))),this.m_initParams.WopiPrecheckInfo.BundleInfo.Url&&(r.dce=encodeURIComponent(this.m_initParams.WopiPrecheckInfo.BundleInfo.Url)),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.OnDemandServer&&(r.odvs=this.m_initParams.ApplicationCustomSettings.OnDemandServer),r.odve="podView.svc/jsonAnonymous",this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.PreserveDrawingBuffer&&(r.wgl_pdb=this.m_initParams.ApplicationCustomSettings.PreserveDrawingBuffer.toString()),(window.location.search.indexOf("wdDev=1")>=0||window.location.hash.indexOf("wdDev=1")>=0)&&(r.wdDev="1"),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.WacCluster&&(r.wacCluster=this.m_initParams.ApplicationCustomSettings.WacCluster),this.isNeedToAddSBOverride()?(u=UrlUtils.getParameterValue(window.location.search,"wdoverrides"),u?u.indexOf("useshapebuilderviewing")<0&&(u=u+",useshapebuilderviewing:true,rendergifslideshow:true,videothrutransparentcanvas:true"):u="useshapebuilderviewing:true,rendergifslideshow:true,videothrutransparentcanvas:true",r.wdoverrides=u):window.location.search.indexOf("wdoverrides=")>=0&&(r.wdoverrides=UrlUtils.getParameterValue(window.location.search,"wdoverrides")),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.LiveBroadcastEnabled&&(r.LiveBroadcastEnabled=this.m_initParams.ApplicationCustomSettings.LiveBroadcastEnabled.toString()),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsVideoThruTransparentCanvas&&(r.isVideoThruTransparentCanvas=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsVideoThruTransparentCanvas.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsFlipgridVideoEnabled&&(r.isFlipgridVideoEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsFlipgridVideoEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsTEDVideoEnabled&&(r.isTEDVideoEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsTEDVideoEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed&&(r.AreThirdPartyAddInsAllowed=this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed.toString()),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace!=undefined&&(r.allowExternalMarketplace=this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace.toString()),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.UserId&&(r.user_id=encodeURIComponent(this.m_initParams.SessionInformation.UserId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.TenantId&&(r.tid=encodeURIComponent(this.m_initParams.SessionInformation.TenantId)),this.m_initParams.WopiPrecheckInfo&&this.m_initParams.WopiPrecheckInfo.DocUniqueId&&this.m_initParams.WopiPrecheckInfo.DocUniqueId!=""&&(r.docId=encodeURIComponent(this.m_initParams.WopiPrecheckInfo.DocUniqueId),this.m_logger.ULS.traceTag(579187410,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::GenerateSlideShowParams docId present in intiailize")),this.m_initParams.WopiPrecheckInfo&&this.m_initParams.WopiPrecheckInfo.FileSize&&this.m_logger.ULS.traceTag(579187409,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::GenerateSlideShowParams FileSize: "+this.m_initParams.WopiPrecheckInfo.FileSize),this.m_initParams.ApplicationUrl&&(r.ring=this.m_initParams.PreviewerRolloutRing),r.fh=encodeURIComponent(PodsRegionInfo.getFileHost(this.m_initParams)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.HostName&&(r.uih=encodeURIComponent(PodsRegionInfo.getUiHost(this.m_initParams.SessionInformation.HostName))),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.UiHostRing&&(r.uihRing=encodeURIComponent(this.m_initParams.SessionInformation.UiHostRing)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.CallId&&(r.callId=encodeURIComponent(this.m_initParams.SessionInformation.CallId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.ContentId&&(r.contentId=encodeURIComponent(this.m_initParams.SessionInformation.ContentId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.IsPresenter&&(r.isPresenter=this.m_initParams.SessionInformation.IsPresenter),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.ParticipantId&&(r.participantId=encodeURIComponent(this.m_initParams.SessionInformation.ParticipantId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.EndpointId&&(r.endpointId=encodeURIComponent(this.m_initParams.SessionInformation.EndpointId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.IsRetry&&(r.isRetry=this.m_initParams.SessionInformation.IsRetry),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.PreviousSessionErrorName&&(r.previousSessionErrorName=this.m_initParams.SessionInformation.PreviousSessionErrorName),r},n.prototype.LoadIframe=function(t,i){var f,r,u;if(i===void 0&&(i=undefined),this.m_anchor==null||this.m_iframe==null){this.m_logger.ULS.traceTag(39416213,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadIframe is missing parameters");return}this.m_iframe.parentNode||this.m_anchor.appendChild(this.m_iframe);f=PPTBootstrapSettings.getCDNManifestMapping();r=this.m_initParams&&this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.Url?ViewerUrlUtils.HTMLEncode(this.m_initParams.ApplicationCustomSettings.Url)+"powerpointframe.html":this.m_appMetaData.Environment=="wac"?this.m_initParams.ApplicationCustomSettings.WacStaticResourcesServer+this.m_appMetaData.WacCdnVersion+"_slideshowresources/powerpointframe.html":ViewerUrlUtils.HTMLEncode("https://contentstorage.osi.office.net/pages/"+f["pptpages/powerpointframe.html"].toString()+"#powerpointframe.html");(this.m_initParams.WopiPrecheckInfo.BundleInfo.Url&&this.m_initParams.WopiPrecheckInfo.BundleInfo.Url.substr(0,5)=="http:"||this.m_initParams.ApplicationCustomSettings.Url&&this.m_initParams.ApplicationCustomSettings.Url.substr(0,4)!="http"&&window.location.protocol=="http:"||this.m_initParams.ApplicationCustomSettings.OnDemandServer&&this.m_initParams.ApplicationCustomSettings.OnDemandServer.substr(0,5)=="http:"||this.m_initParams.ApplicationCustomSettings.ForceHttp)&&r.substr(0,5)=="https"&&(u=document.createElement("a"),u.href=n.EscapeHtml(r),r=u.href,r="http"+r.substr(5));t&&Object.keys(t).forEach(function(n){r=UrlUtils.addOrReplaceParameterValue(r,n,t[n])});r=r.replace("?","#");this.m_iframe&&(this.m_logger.ULS.traceTag(590424141,logCategory.PptSession,logLevel.Info,"Iframe src: "+r),i&&i(r),this.m_iframe.src=r)},n.prototype.isNeedToAddSBOverride=function(){if(!PPTPreviewerBootstrapperUtils.IsTeamsPreviewerSession(this.m_initParams,!1)||this.m_initParams&&this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.HostName&&this.m_initParams.SessionInformation.HostName.toLowerCase().indexOf("ios")>=0)return!1;var n=this.m_initParams.ApplicationUrl;return n?this.m_initParams.PreviewerRolloutRing!="6":!1},n.prototype.LoadApp=function(t,i,r){var e=this,f,u;r.previewSessionLoadAppTime=Date.now();this.m_logger.ULS.traceTag(38540372,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::LoadApp");PPTPreviewerBootstrapperUtils.tryGetHostNetworkMetricsFromCallback(this.m_initParams,this.m_logger);r.prefetchStartTime&&(this.m_bootTimingDict.PrefetchStart=r.prefetchStartTime);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.WdParams!=null&&this.m_initParams.SessionInformation.WdParams.wdLegacyAspxInTeams!=null&&(this.m_bootTimingDict.wdLegacyAspxInTeams=this.m_initParams.SessionInformation.WdParams.wdLegacyAspxInTeams?1:0);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.WdParams!=null&&this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams!=null&&(this.m_bootTimingDict.wdModernSlideShowInTeams=this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams?1:0);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.HostExperience!=null&&(this.m_bootTimingDict.HostExperience=this.m_initParams.SessionInformation.HostExperience);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.UiHostRing!=null&&(this.m_bootTimingDict.UiHostRing=this.m_initParams.SessionInformation.UiHostRing);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.IsPresenter!=null&&(this.m_bootTimingDict.IsPresenter=this.m_initParams.SessionInformation.IsPresenter);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.Position!=null&&(this.m_bootTimingDict.PreviewerPosition=this.m_initParams.SessionInformation.Position);this.m_bootTimingDict.LoadApp=Date.now();this.m_readyToActivateConditional=new ConditionalAction(function(){return e.Activate()},[this.c_iframeLoaded,this.c_contentMetadataLoadedOrDoesNotExist]);this.m_iframe&&this.m_iframe.id&&this.m_logger.ULS.traceTag(590424140,logCategory.PptSession,logLevel.Info,"iframe about to be replaced with new iframe: Old iframe Id: "+this.m_iframe.id+"  , New iframe Id: "+this.m_initParams.SessionInformation.HostSessionId);this.m_initParams.ApplicationCustomSettings&&(f=this.m_initParams.ApplicationCustomSettings.OnDemandServer);this.m_iframe=n.UpdateBaseIframe(this.m_initParams.SessionInformation.HostSessionId,this.m_frameContainerContext.frameRef,f);this.m_logger.ULS.traceTag(39203533,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::LoadApp creating new iframe - "+this.m_iframe.id.toString());u=this.GenerateSlideShowParams(t,i);this.m_slideshowKind=="Modern"?this.m_slideShowLoader.LoadSlideShow(this.m_iframe,u,this.m_slideshowKind,r):this.m_fShouldUseLegacySlideShowAspx?this.m_slideShowLoader.LoadSlideShow(this.m_iframe,u,"Legacy",r):(this.registerOnLoadErrorEvent(),this.LoadIframe(u));this.registerOnLoadEvent();this.registerOnUnloadEvent();this.m_bootTimingDict.iframeURLset=Date.now()},n.prototype.LaunchFromSlide=function(n){var r=this,i,t;if(!this.m_iframe){this.m_logger.ULS.traceTag(39416214,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::LaunchFromSlide iframe is null");return}if(this.m_logger.ULS.traceTag(39416215,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::LaunchFromSlide"),this.m_initParams.ApplicationCustomSettings&&n.WacCluster&&(this.m_initParams.ApplicationCustomSettings.WacCluster=n.WacCluster),this.m_initParams.Diagnostics=n.Diagnostics,this.m_presentationId=n.PresentationId,this.m_apiStartTime=Date.now(),this.m_bootTimingDict.ApiStartTime=this.m_apiStartTime,this.m_streamUseThinEmbed=n.StreamVideoUseThinEmbed,n.SendInitialLog&&PPTBootstrapper.sendInitialLog(this.m_initParams,"Slide Show",null,this.m_logger),i=this.m_presentationId,this.m_startingSlideId=n.StartingSlideId||-1,this.m_startingSlideIndex=n.StartingSlideIndex||-1,this.m_vetoAppSettingsStr=n.VetoAppSettingsStr||"",this.m_disabledTransitionsList=n.DisabledTransitionsList||"",this.m_customTransitionResourceUrl=n.CustomTransitionResourceUrl||"",this.m_disabledChangeGates=n.DisabledChangeGates||"",this.m_initParams.ApplicationCustomSettings!=null&&n.AreThirdPartyAddInsAllowed!=null&&(this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed=n.AreThirdPartyAddInsAllowed),this.m_initParams.ApplicationCustomSettings!=null&&n.AllowExternalMarketplace!=null&&(this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace=n.AllowExternalMarketplace),t=HTMLHelper.floatToPercent(1),this.m_anchor.style.width=this.m_fVariableWidth?t:HTMLHelper.toPx(this.m_initParams.ApplicationCustomSettings.Width),this.m_anchor.style.height=this.m_fVariableHeight?t:HTMLHelper.toPx(this.m_initParams.ApplicationCustomSettings.Height),this.m_fVariableHeight&&(this.m_anchor.style.minHeight=HTMLHelper.toPx(this.c_minHeight)),this.m_anchor.style.left=HTMLHelper.toPx(0),this.m_anchor.style.right=HTMLHelper.toPx(0),this.m_anchor.style.bottom=HTMLHelper.toPx(0),this.m_anchor.style.top=HTMLHelper.toPx(0),this.m_fVariableHeight?this.m_iframe.style.minHeight=HTMLHelper.toPx(this.c_minIframeHeight):this.m_iframe.style.height=HTMLHelper.toPx(Math.max(this.m_initParams.ApplicationCustomSettings.Height,0)),(this.m_fShouldUseLegacySlideShowAspx||this.m_slideshowKind=="Modern")&&this.m_slideShowLoader.LaunchSlideShow(),this.m_finishedBootingConditional=new ConditionalAction(function(){return r.SendBootTelemetry()},[this.c_activated]),this.m_startingSlideIndex>=1&&this.GetPreviewImageFromPods(i,this.m_startingSlideIndex),!this.m_readyToActivateConditional){this.m_logger.ULS.traceTag(51448028,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::OnMesssage - Conditional Action uninitialized");throw Error("m_readyToActivateConditional");}this.m_readyToActivateConditional.SetCondition(this.c_contentMetadataLoadedOrDoesNotExist)},n.prototype.SendBootTelemetry=function(){this.m_logger.ULS.traceTag(38540373,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::SendBootTelemetry");var n=new BootTimingFromApiInternalMessage(this.m_bootTimingDict);this.PostMessageDownward(n)},n.prototype.RecordStartedSlideShowTimestamp=function(n){this.m_logger.ULS.traceTag(39683465,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::RecordStartedSlideShowTimestamp Time that SlideShow started in ms: "+n);var t=new RecordStartedSlideShowTimestampInternalMessage(n);this.PostMessageDownward(t)},n.prototype.GetPreviewImageFromPods=function(n,t){var u,i,f,r;this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.OnDemandServer&&(this.m_logger.ULS.traceTag(39203537,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::GetPreviewImageFromPods"),u=void 0,u=this.m_initParams.ApplicationCustomSettings.OnDemandServer,i="fullSizePreview.png",t>1&&(i=t-1+"_"+i),f=void 0,f=u+"imagehandler.ashx?PV=6&PF=4&Rid="+i+"&Pid="+n+"&X-SupportSVGInWebGL="+(ViewerBrowserUtils.SupportSVGInWebGL()?"1":"0"),r=document.createElement("img"),r.style.visibility="hidden",r.style.position="absolute",r.src=f)},n.GetHostName=function(n){return n.SessionInformation.HostName?n.SessionInformation.HostName:window.location.hostname},n.EscapeHtml=function(n){return n.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},n.prototype.Dispose=function(){this.m_logger.ULS.traceTag(39203539,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::Dispose - removeAnchor: "+(this.m_anchor!=null).toString()+", removeAPI: "+(this.m_apiId!=null).toString());this.m_anchor&&this.m_anchor.parentNode&&this.m_anchor.parentNode.removeChild(this.m_anchor);this.m_apiId&&PPTMessageListenerRegistry.getInstance().remove(this.m_apiId,!0,"Dispose from PreviewSessionLoader");this.DisposeForTransferToPreviewAPI()},n.prototype.DisposeForTransferToPreviewAPI=function(){this.m_anchor=null;this.m_iframe=null;this.m_apiId=null;this.m_healthLogger&&this.m_healthLogger.shutdown()},n.prototype.DisposePreloadedApp=function(){this.m_logger.ULS.traceTag(39416216,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::DisposePreloadedApp");this.m_iframe&&this.m_iframe.parentNode&&this.m_iframe.parentNode.removeChild(this.m_iframe);this.m_apiId&&PPTMessageListenerRegistry.getInstance().remove(this.m_apiId,!0,"Dispose PreloadApp");this.DisposeForTransferToPreviewAPI()},n.prototype.RecordBootStrapperInitTime=function(n){this.m_bootTimingDict.BootstrapperInitTime=n},n}(),SlideShowLoader=function(){function n(n,t,i,r){this.m_iframe=null;this.m_frameForm=null;this.m_formData={};this.m_appMetadata=r;this.m_logger=i;this.m_initParams=n;this.m_frameContainerContext=t;this.m_anchor=n.Container;this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,this.m_logger)}return n.prototype.LoadSlideShow=function(t,i,r,u,f){var e=this,d,l,a,o,h,g,nt,tt,it,s,v,y,p,c,rt,w,ut,b,ft,st,ht;if(f===void 0&&(f=undefined),d=Date.now(),this.m_iframe=t,this.m_anchor==null||this.m_iframe==null){this.m_logger.ULS.traceTag(592732160,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadModernSlideShowFrame is missing parameters");return}if(l=r=="Legacy"?this.m_initParams.ApplicationCustomSettings.OnDemandServer+"legacySlideshow.aspx":this.m_initParams.ApplicationCustomSettings.OnDemandServer+"slideshow.aspx",a="slideshowframe-"+this.m_iframe.id.toString(),this.m_iframe.name=a,this.m_frameForm=document.createElement("form"),this.m_frameForm.name="frameform-"+this.m_iframe.id.toString(),this.m_frameForm.id="frameform-"+this.m_iframe.id.toString(),this.m_frameForm.target=a,this.m_frameForm.action=l,this.m_frameForm.method="post",this.m_iframe.parentNode||this.m_anchor.appendChild(this.m_iframe),this.m_logger.ULS.traceTag(527958914,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::LoadModernSlideShowFrame. iframe: "+this.m_frameForm.id),o=window.origin,o&&(this.m_formData.parentWindowOrigin=o,this.m_logger.ULS.traceTag(521179736,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::LoadModernSlideShowFrame. parentWindowOrigin is an absolute URI: "+(o.indexOf("http")||o.indexOf("https")))),this.m_initParams.WopiPrecheckInfo.FileGetUrl&&(this.m_formData.fileurl=this.m_initParams.WopiPrecheckInfo.FileGetUrl),this.m_initParams.WopiPrecheckInfo.CustomFontCatalogUrl&&(this.m_formData.customFontCatalogUrl=this.m_initParams.WopiPrecheckInfo.CustomFontCatalogUrl),this.m_initParams.WopiPrecheckInfo.PresentationUrl&&(this.m_formData.presentationUrl=this.m_initParams.WopiPrecheckInfo.PresentationUrl),this.m_initParams.WopiPrecheckInfo.FileName&&(this.m_formData.fileName=UrlUtils.urlKeyValueEncode(this.m_initParams.WopiPrecheckInfo.FileName)),h=this.GetPodsUrl(this.m_initParams),h!=null&&h!==""&&(this.m_formData.podsurl=h),!this.m_initParams.SessionInformation.HostSessionId)throw"SessionInformation.HostSessionId is not provided";if(this.m_formData.hostsessionid=this.m_initParams.SessionInformation.HostSessionId,this.m_formData["X-UserSessionId"]=this.m_initParams.SessionInformation.HostSessionId,this.m_formData.ApiId=this.m_initParams.SessionInformation.HostSessionId,this.m_initParams.ApplicationCustomSettings.StartingSlideIndex!=null&&(this.m_formData.startingslideindex=this.m_initParams.ApplicationCustomSettings.StartingSlideIndex.toString()),this.m_initParams.ApplicationCustomSettings.StartingTimelineMappings!=null&&(this.m_formData.startingtimelinemappings=JSON.stringify(this.m_initParams.ApplicationCustomSettings.StartingTimelineMappings)),this.m_initParams.SessionInformation.HostName!=null&&(this.m_formData.hostname=this.m_initParams.SessionInformation.HostName),this.m_initParams.SessionInformation.UiHostIsHighContrast!=null&&(this.m_formData.isHighContrast=this.m_initParams.SessionInformation.UiHostIsHighContrast),this.m_initParams.SessionInformation.UiHostHighContrastColorSettings!=null&&(this.m_formData.highContrastColorSettings=this.m_initParams.SessionInformation.UiHostHighContrastColorSettings),this.m_initParams.SessionInformation.HostExperience!=null&&(this.m_formData.hostExperience=this.m_initParams.SessionInformation.HostExperience),this.m_initParams.SessionInformation.PreviousSessionErrorName!=null&&(this.m_formData.previousSessionErrorName=this.m_initParams.SessionInformation.PreviousSessionErrorName),this.m_initParams.SessionInformation.IsRtl!=null&&(this.m_formData.isRtl=this.m_initParams.SessionInformation.IsRtl),this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed!=null&&(this.m_formData.areThirdPartyAddInsAllowed=this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed),this.m_formData.SupportsDecryptedContentDownload=!0,this.m_initParams.SessionInformation.DocumentClickTime!=null)try{this.m_formData.startFromTime=this.m_initParams.SessionInformation.DocumentClickTime.getTime()}catch(ct){this.m_logger.ULS.traceTag(590221380,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadSlideShow exception thrown: "+ct)}this.m_initParams.Diagnostics&&(this.m_initParams.Diagnostics.docClickTime&&!this.m_formData.startFromTime&&(this.m_formData.startFromTime=this.m_initParams.Diagnostics.docClickTime),this.m_initParams.Diagnostics.loadingSpinnerStartTime&&(this.m_formData.uiHostLoadingSpinnerStartTime=this.m_initParams.Diagnostics.loadingSpinnerStartTime),this.m_initParams.Diagnostics.spoApiCallsCount&&(this.m_formData.spoApiCallsCount=this.m_initParams.Diagnostics.spoApiCallsCount),this.m_initParams.Diagnostics.driveItemRequestStartTime&&(this.m_formData.driveItemRequestStartTime=this.m_initParams.Diagnostics.driveItemRequestStartTime),this.m_initParams.Diagnostics.driveItemRequestEndTime&&(this.m_formData.driveItemRequestEndTime=this.m_initParams.Diagnostics.driveItemRequestEndTime),this.m_initParams.Diagnostics.timeFromPresenterStartToAttendee&&(this.m_formData.timeFromPresenterStartToAttendee=this.m_initParams.Diagnostics.timeFromPresenterStartToAttendee),this.m_initParams.Diagnostics.presenterStartTime&&(this.m_formData.presenterStartTime=this.m_initParams.Diagnostics.presenterStartTime),this.m_initParams.Diagnostics.bootstrapperScriptPreloadFlag&&(this.m_formData.bootstrapperScriptPreloadFlag=this.m_initParams.Diagnostics.bootstrapperScriptPreloadFlag),this.m_initParams.Diagnostics.bootstrapperScriptLoadPoint&&(this.m_formData.bootstrapperScriptLoadPoint=this.m_initParams.Diagnostics.bootstrapperScriptLoadPoint),this.m_initParams.Diagnostics.officeBootstrapperStartTime&&(this.m_formData.bootstrapperScriptLoadStartTime=this.m_initParams.Diagnostics.officeBootstrapperStartTime),this.m_initParams.Diagnostics.officeBootstrapperEndTime&&(this.m_formData.bootstrapperScriptLoadEndTime=this.m_initParams.Diagnostics.officeBootstrapperEndTime),this.m_initParams.Diagnostics.incomingSessionJoinedTime&&(this.m_formData.incomingSessionJoinedTime=this.m_initParams.Diagnostics.incomingSessionJoinedTime),this.m_initParams.Diagnostics.presentationUrlUpdateMetadata&&(this.m_formData.presentationUrlUpdateMetadata=this.m_initParams.Diagnostics.presentationUrlUpdateMetadata),this.m_initParams.Diagnostics.bootTimings&&(this.m_initParams.Diagnostics.bootTimings.containerCreationStartTime&&(this.m_formData.containerCreationStartTime=this.m_initParams.Diagnostics.bootTimings.containerCreationStartTime),this.m_initParams.Diagnostics.bootTimings.containerCreationEndTime&&(this.m_formData.containerCreationEndTime=this.m_initParams.Diagnostics.bootTimings.containerCreationEndTime)));this.m_formData.presentationUrlFlagEnabled=PPTBootstrapper.getPresentationUrlFlag(this.m_initParams,this.m_logger);this.m_pptFeatureGates!=null&&(g=this.m_pptFeatureGates.EnableSnapUrlForPresenterInLegacy||!1,this.m_formData.enableSnapUrlForPresenterInLegacy=g,nt=this.m_pptFeatureGates.PresenterViewForLegacyEnabled||!1,this.m_formData.presenterViewForLegacyEnabled=nt,tt=this.m_pptFeatureGates.ShowSlideShowKindVisualCue||!1,this.m_formData.showSlideShowKindVisualCue=tt,it=this.m_pptFeatureGates.PdfLiveEnabled||!1,this.m_formData.pdfLiveEnabled=it);s=PPTBootstrapperFeatureGatesHelper.getStateServiceFeatureGates(this.m_initParams,this.m_logger);s!=null&&(this.m_formData.isStateServiceNavTelemetryEnabled=s.indexOf("Nav")>=0,this.m_formData.isStateServiceNavSyncEnabled=s.indexOf("NavSync")>=0,this.m_formData.isStateServiceMediaSyncEnabled=s.indexOf("Media")>=0);this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.WdParams&&(this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams&&(this.m_formData.wdModernSlideShowInTeams=this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams),this.m_initParams.SessionInformation.WdParams.wdPresenterViewInTeams&&(this.m_formData.wdPresenterViewInTeams=this.m_initParams.SessionInformation.WdParams.wdPresenterViewInTeams),this.m_initParams.SessionInformation.WdParams&&(this.m_formData.enablePptSharingWebviewContainer=this.m_initParams.SessionInformation.WdParams.enablePptSharingWebviewContainer),v=window.location.search.indexOf("isMovePrivateViewingToPPTEnabled")>=0,v?this.m_formData.enableMovePrivateViewingToPPT=v:this.m_initParams.SessionInformation.WdParams.isMovePrivateViewingToPPTEnabled&&(this.m_formData.enableMovePrivateViewingToPPT=this.m_initParams.SessionInformation.WdParams.isMovePrivateViewingToPPTEnabled),this.m_initParams.SessionInformation.WdParams.enableMoveTakeControlButtonToPPT&&(this.m_formData.enableMoveTakeControlButtonToPPT=this.m_initParams.SessionInformation.WdParams.enableMoveTakeControlButtonToPPT),this.m_initParams.SessionInformation.WdParams.enableMovePresenterNameToPPT&&(this.m_formData.enableMovePresenterNameToPPT=this.m_initParams.SessionInformation.WdParams.enableMovePresenterNameToPPT),y=window.location.search.indexOf("isPasteFileLinktoChatEnabled")>=0,y?this.m_formData.enablePPTLiveCopyLinkToChatInPresenterView=y:this.m_initParams.SessionInformation.WdParams.isPasteFileLinktoChatEnabled&&(this.m_formData.enablePPTLiveCopyLinkToChatInPresenterView=this.m_initParams.SessionInformation.WdParams.isPasteFileLinktoChatEnabled),p=window.location.search.indexOf("isCopyFileLinktoClipboardEnabled")>=0,p?this.m_formData.enablePPTLiveCopyLinkInPresenterView=p:this.m_initParams.SessionInformation.WdParams.isCopyFileLinktoClipboardEnabled&&(this.m_formData.enablePPTLiveCopyLinkInPresenterView=this.m_initParams.SessionInformation.WdParams.isCopyFileLinktoClipboardEnabled),c=window.location.search.indexOf("disableTeamsPptSharingNavControlsForPresenter")>=0,c?this.m_formData.enableSSToolbarNavControlsForPresenter=c:this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForPresenter&&(this.m_formData.enableSSToolbarNavControlsForPresenter=this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForPresenter),rt=window.location.search.indexOf("disableTeamsPptSharingNavControlsForAttendee")>=0,c?this.m_formData.enableSSToolbarNavControlsForAttendee=rt:this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForAttendee&&(this.m_formData.enableSSToolbarNavControlsForAttendee=this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForAttendee),w=window.location.search.indexOf("disableTeamsPptSharingPrivateViewingControlForPresenter")>=0,w?this.m_formData.enableSSToolbarTogglePrivateViewingControl=w:this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingPrivateViewingControlForPresenter&&(this.m_formData.enableSSToolbarTogglePrivateViewingControl=this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingPrivateViewingControlForPresenter),this.m_initParams.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible&&(this.m_formData.wdBrowserShapeBuilderCompatible=this.m_initParams.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible),this.m_initParams.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow&&(this.m_formData.wdIsFileTypeSupportedForModernSlideShow=this.m_initParams.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow),this.m_initParams.SessionInformation.WdParams.wdset?this.m_formData.wdset=this.m_initParams.SessionInformation.WdParams.wdset:this.m_pptFeatureGates&&this.m_pptFeatureGates.wdset&&(this.m_formData.wdset=this.m_pptFeatureGates.wdset),ut=this.m_formData.wdset&&this.m_formData.wdset.indexOf("slideshowcore.forceSvg:")>=0,this.m_initParams.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible||ut||(this.m_formData.wdset=(this.m_formData.wdset||"")+",slideshowcore.forceSvg:true"),b=window.location.search.indexOf("showCoachButtonInPresentationSharing")>=0,b?this.m_formData.enableCoach=b:this.m_initParams.SessionInformation.WdParams.showCoachButtonInPresentationSharing&&(this.m_formData.enableCoach=this.m_initParams.SessionInformation.WdParams.showCoachButtonInPresentationSharing));u!=null&&(u.initWopiTime!=null&&(this.m_formData.initWopiTime=u.initWopiTime.toFixed(),this.m_formData.startFromTime||(this.m_formData.startFromTime=u.initWopiTime.toFixed(),this.m_logger.ULS.traceTag(587830343,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadSlideShow startFromTime was not present, so will use initWopiTime instead"))),u.bootstrapperInitTime!=null&&(this.m_formData.bootstrapperInitTime=u.bootstrapperInitTime.toFixed()),u.sliceLoadTime!=null&&(this.m_formData.sliceLoadTime=u.sliceLoadTime.toFixed()),u.createViewerTime!=null&&(this.m_formData.createViewerTime=u.createViewerTime.toFixed()),u.previewSessionLoadAppTime!=null&&(this.m_formData.previewSessionLoadAppTime=u.previewSessionLoadAppTime.toFixed()),u.getPresentationUrlStartTime!=null&&(this.m_formData.getPresentationUrlStartTime=u.getPresentationUrlStartTime.toFixed()),u.getPresentationUrlEndTime!=null&&(this.m_formData.getPresentationUrlEndTime=u.getPresentationUrlEndTime.toFixed()));this.m_formData.loadSlideShowTime=d.toFixed();this.m_formData.wdForcePresenterViewInTeams=window.location.search.indexOf("wdForcePresenterViewInTeams")>=0;this.m_formData.wdEnablePresenterViewInkInTeams=window.location.search.indexOf("wdEnablePresenterViewInkInTeams")>=0;this.m_formData.wdEnableAnnotationsUI=window.location.search.indexOf("wdEnableAnnotationsUI")>=0;this.m_formData.wdInkMaster=window.location.search.indexOf("wdInkMaster")>=0;this.m_formData.wdEnableCursorMoveEvent=window.location.search.indexOf("wdEnableCursorMoveEvent")>=0;this.m_formData.wdEnableMouseStrokeSmooth=window.location.search.indexOf("wdEnableMouseStrokeSmooth")>=0;this.m_formData.wdEnableStraightLine=window.location.search.indexOf("wdEnableStraightLine")>=0;this.m_formData.wdEnablePressAndHoldStraightLine=window.location.search.indexOf("wdEnablePressAndHoldStraightLine")>=0;this.m_formData.wdEnableStrokeArrowHead=window.location.search.indexOf("wdEnableStrokeArrowHead")>=0;this.m_formData.wdEnableInkEffectPen=window.location.search.indexOf("wdEnableInkEffectPen")>=0;this.m_formData.wdEnableInstantInkingBehavior=window.location.search.indexOf("wdEnableInstantInkingBehavior")>=0;this.m_formData.wdEnableCustomCursor=window.location.search.indexOf("wdEnableCustomCursor")>=0;this.m_formData.wdEnablePersistentLaserCursor=window.location.search.indexOf("wdEnablePersistentLaserCursor")>=0;this.m_pptFeatureGates&&this.m_pptFeatureGates.ForceSlideShareAnnotation!=undefined&&(ft=this.m_pptFeatureGates.ForceSlideShareAnnotation||!1,this.m_formData.forceSlideShareAnnotation=ft);this.m_initParams.WopiPrecheckInfo.FileSize&&(this.m_formData.fileSize=this.m_initParams.WopiPrecheckInfo.FileSize,this.m_formData.fileLengthHint=this.m_initParams.WopiPrecheckInfo.FileSize);this.m_initParams.WopiPrecheckInfo.DocUniqueId&&(this.m_formData.DocID=this.m_initParams.WopiPrecheckInfo.DocUniqueId);this.m_initParams.WopiPrecheckInfo.ETag&&(this.m_formData.ETag=this.m_initParams.WopiPrecheckInfo.ETag);this.m_initParams.SnapRequestID&&(this.m_formData.snapRequestID=this.m_initParams.SnapRequestID);this.m_formData.authHeaderForHostDownloadEnabled=window.location.search.indexOf("wdAuthHeaderForHostDownloadEnabled")>=0;var k=BrowserUtils.devicePixelRatio(),et=this.m_initParams.ApplicationCustomSettings.AddShadowBorder?10:0,ot=this.m_initParams.Container.getBoundingClientRect();this.m_formData.availableWidth=Math.round(k*Math.max(Math.ceil(ot.width),300)-2*et);this.m_formData.availableHeight=Math.round(k*Math.max(Math.ceil(ot.height),201)-2*et);this.m_formData.dpr=k;this.m_formData.SupportSVGInWebGL=ViewerBrowserUtils.SupportSVGInWebGL();i&&Object.keys(i).forEach(function(n){e.m_formData[n.toLowerCase()]=i[n]});st=PPTBootstrapper.getSlideShowHostContainer(this.m_initParams);ht=st!="Webview"?!1:this.m_pptFeatureGates!=null&&this.m_pptFeatureGates.RemoveExtraFrameFormForWebview;ht||(Object.keys(this.m_formData).forEach(function(t){e.m_frameForm!=null?e.m_frameForm.appendChild(n.CreateHiddenInputElement(t,e.m_formData[t])):e.m_logger.ULS.traceTag(527958915,logCategory.PptSession,logLevel.Warning,"PreviewerSessionLoader:::LoadSlideShow frame form is empty.")}),f&&f(l),this.m_anchor.appendChild(this.m_frameForm))},n.prototype.LaunchSlideShow=function(){this.m_frameForm?(this.m_logger.ULS.traceTag(527786396,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::LaunchSlideshow iframe: "+this.m_frameForm.id+"; numParams: "+Object.keys(this.m_formData).length+"; numChildren "+this.m_frameForm.childElementCount+"."),this.m_frameContainerContext.initMessageListener(),this.m_frameContainerContext.load(this.m_frameForm,this.m_formData)):this.m_logger.ULS.traceTag(527958917,logCategory.PptSession,logLevel.Warning,"PreviewerSessionLoader::LaunchSlideshow with empty m_frameForm.")},n.CreateHiddenInputElement=function(n,t){var i=document.createElement("input");return i.type="hidden",i.name=n,i.value=t,i},n.prototype.GetPodsUrl=function(n){var t=UrlUtils.getQueryStringParam("wdPodsUrl");return t&&!this.validateUrlHostMatchesWindowHost(t)&&(t=""),t||(t=PPTBootstrapper.getOnDemandServer(n,!0)),t.substr(t.length-1)!="/"&&(t+="/"),t},n.prototype.validateUrlHostMatchesWindowHost=function(n){var t=document.createElement("a"),i,r;return t.href=n,i=t.port||80,r=window.location.port||80,t.hostname==window.location.hostname&&i==r},n}(),StateServiceClientInitStatus;(function(n){n[n.Uninitialized=0]="Uninitialized";n[n.Initializing=1]="Initializing";n[n.Success=2]="Success";n[n.Failure=3]="Failure"})(StateServiceClientInitStatus||(StateServiceClientInitStatus={})),function(n){n[n.Initializing=0]="Initializing";n[n.Success=1]="Success";n[n.Failure=2]="Failure"}(PptSessionBootStatus||(PptSessionBootStatus={}));var StateServiceLoggerWrapper=function(){function n(n){this.logger=n}return n.prototype.sendTraceTag=function(n,t,i,r){this.logger.ULS.traceTag(n,t,i,r)},n}(),StateServiceClientLoader=function(){function n(){}return n.IsStateServiceClientInitComplete=function(n){return n==StateServiceClientInitStatus.Success||n==StateServiceClientInitStatus.Failure},n.TryDisconnectStateService=function(t){var i;n.stateServiceClient&&(t.ULS.traceTag(571355284,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: Closing State Service connection. ClientID: "+((i=n.stateServiceClient)===null||i===void 0?void 0:i.clientId)),n.stateServiceClient.close(),n.stateServiceClient=undefined,n.stateServiceClientInitStatus=StateServiceClientInitStatus.Uninitialized)},n.SendMessage=function(t){if(n.stateServiceClientInitStatus==StateServiceClientInitStatus.Success)n.stateServiceClient.onMessage(t);else{var i=t?t.m_type:"";switch(i){case WebViewerInternalMessageType.RecordMetrics:if(t.m_statName=="PostMessageReady"&&(n.pptSessionBootStatus=PptSessionBootStatus.Success,n.stateServiceClientInitStatus==StateServiceClientInitStatus.Failure)){n.RecordSharingNotSyncingVeto("VetoedTeamsSharingStateServiceConnection");break}this.storedMessages.push(t);break;case"presentationUrl":this.storedMessages.push(t);break;default:throw new Error("StateServiceClient::SendMessage messageType: "+i+" stateServiceClient is null");}}},n.RecordSharingNotSyncingVeto=function(t){n.healthLogger&&n.healthLogger.recordQosError(t,["SharingNotSyncing"],!1,!0,!1,!1)},n.TryLoadStateServiceClient=function(t,i,r,u,f,e,o,s){try{n.stateServiceClientInitStatus=StateServiceClientInitStatus.Uninitialized;n.healthLogger=e;var c=PPTBootstrapSettings.getAppMetadata(),l=PPTBootstrapper.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),a=l+c.WacCdnVersion+"_pptscripts/stateservicepreviewerclient.js",v=PPTPreviewerBootstrapperUtils.getTrustedScriptUrl(a,t,"StateServiceClient",i),h=document.createElement("script");return window.StateServicePreviewerClient&&window.StateServicePreviewerClient.StateServiceClient&&i.ULS.traceTag(520664784,logCategory.PptSession,logLevel.Warning,"StateServiceClientLoader: StateServiceClient JS already exists. Host:"+t.SessionInformation.HostName+";"),window.StateServicePreviewerClient&&window.StateServicePreviewerClient.StateServiceClient&&t.SessionInformation.HostName==="MSTeams"&&!o?(i.ULS.traceTag(520664783,logCategory.PptSession,logLevel.Warning,"StateServiceClientLoader: StateServiceClient JS already exists. Beginning Init."),n.TryLoadStateServiceClientImpl(t,i,r,u,f,e,s),!0):(i.ULS.traceTag(520664782,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: StateServiceClient JS doesn't exist, going to load it."),h.onload=function(){n.TryLoadStateServiceClientImpl(t,i,r,u,f,e,s)},h.onerror=function(){i.ULS.traceTag(538564750,logCategory.PptSession,logLevel.Error,"StateServiceClientLoader: Fail to load StateServiceClientJS.")},h.src=v,document.head.insertBefore(h,document.head.firstChild),!0)}catch(y){return i.ULS.traceTag(573154445,logCategory.PptSession,logLevel.Error,"StateServiceClientLoader: Caught exception "+y+"."),!1}},n.TryLoadStateServiceClientImpl=function(t,i,r,u,f,e,o){var h,c,l,a,s;n.stateServiceClient&&(i.ULS.traceTag(571355286,logCategory.PptSession,logLevel.Warning,"StateServiceClientLoader: Trying to create StateServiceClient instance again. ClientID: "+((h=n.stateServiceClient)===null||h===void 0?void 0:h.clientId)),n.TryDisconnectStateService(i));a={webviewContainerEnabled:((l=(c=t===null||t===void 0?void 0:t.SessionInformation)===null||c===void 0?void 0:c.WdParams)===null||l===void 0?void 0:l.enablePptSharingWebviewContainer)&&(t===null||t===void 0?void 0:t.WebviewRef)};n.stateServiceClient=new StateServicePreviewerClient.StateServiceClient(a,f);i.ULS.traceTag(571355285,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: Creating StateServiceClient instance.");var v=t.SessionInformation.HostSessionId,y={HostName:t.SessionInformation.HostName,Ring:t.SessionInformation.UiHostRing},w=o!==undefined?__assign(__assign({},o.stateServiceProxySettings),{correlationId:v,metadata:y}):{batchedRequestsEnabled:!1,maxRoundtripRaw:300,pingTimeoutInMs:15e3,pongTimeoutInMs:15e3,retryIntervalsInMs:[1e3,2e3,4e3],verbose:!1,websocketAliveTimeAfterLoseFocusInMS:3e4,maxSessionRetries:15,autoRoutingEnabled:!0,offlineMessageCacheEnabled:!0,maxOfflineMessageCacheTimeInMs:2e4,maxOfflineMessageCacheLength:64,allowReconnectOnSendMessage:!0,unacknowledgeMessageTimeoutInMs:12e3,useServiceGeneratedClientId:!0,correlationId:v,metadata:y},p=window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0||window.location.search.indexOf("wdTestWacPreviewer=1")>=0;p&&(s=new URLSearchParams(window.location.search),s.has("wdIsPresenter")&&(t.SessionInformation.IsPresenter=s.get("wdIsPresenter")==="1"),s.has("wdCallId")&&(t.SessionInformation.CallId=s.get("wdCallId")||"testdevcall"));t.SessionInformation.CallId||i.ULS.traceTag(573154444,logCategory.PptSession,logLevel.Error,"StateServiceClientLoader: Not initializing StateServiceClient since CallId is null.");n.stateServiceClient&&(i.ULS.traceTag(520135637,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: StateServiceClient begin init."),n.stateServiceClientInitStatus=StateServiceClientInitStatus.Initializing,n.stateServiceClient.init(w,p,new StateServiceLoggerWrapper(i),t.SessionInformation.HostSessionId,t.SessionInformation.IsPresenter||!1,t.SessionInformation.CallId,t.WopiPrecheckInfo.FileGetUrl,r||[],e,u,o?o.regionalEndpointUrl:undefined,o?o.userId:undefined,o?o.stateServiceUser:undefined,o?o.authEnabled:undefined,{rosterCheckEnabled:o?o.rosterCheckEnabled:!1,isPresenterInRoster:o?o.isPresenterInRoster:undefined}).then(function(t){var u,r;if(t){n.stateServiceClientInitStatus=StateServiceClientInitStatus.Success;i.ULS.traceTag(520135636,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: StateServiceClient initialized.");for(u in n.storedMessages)if(r=n.storedMessages[u],r){n.stateServiceClient.onMessage(r);i.ULS.traceTag(554268579,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: sending Stored message "+(r.m_type||"")+".");delete n.storedMessages[u]}}else n.stateServiceClientInitStatus=StateServiceClientInitStatus.Failure,n.pptSessionBootStatus==PptSessionBootStatus.Success&&n.RecordSharingNotSyncingVeto("VetoedTeamsSharingStateServiceConnection")}))},n.stateServiceClientInitStatus=StateServiceClientInitStatus.Uninitialized,n.pptSessionBootStatus=PptSessionBootStatus.Initializing,n.storedMessages=[],n}(),PPTPreviewerBootstrapperFeatureGatesHelper=function(){function n(){}return n.CombineDisabledChangeGates=function(n,t){var i="";return n&&n.DisabledChangeGates&&(i+=n.DisabledChangeGates+";"),t&&t.PPTDisabledChangeGates&&(i+=t.PPTDisabledChangeGates),i},n}(),ViewerBrowserUtils=function(){function n(){}return n.SupportPreloadLink=function(){return this.GetChromeVersion()>=50},n.GetChromeVersion=function(){var n=window.navigator.userAgent.toLowerCase(),t;if(n.indexOf("chrome/")>=0&&(t=n.indexOf("chrome/"),t>=0)){var i=t+7,r=n.indexOf(".",i),u=n.substring(i,r);return+u}return 0},n.SupportSVGInWebGL=function(){var r=!1,n,t,i;if(!this.iOS9OrOlderDetected()&&!BrowserUtils.isSafari())try{n=document.createElement("canvas");(n.getContext("webgl")||document.createElement("canvas").getContext("experimental-webgl"))&&(t=document.createElement("canvas").getContext("2d"),t&&(i=document.createElement("img"),i.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E",t.drawImage(i,0,0,10,10),n.toDataURL("image/png"),r=!0))}catch(u){}return r},n.iOS9OrOlderDetected=function(){var n=window.navigator.userAgent.toLowerCase(),r,t,i;return(n.indexOf("iphone")!=-1||n.indexOf("ipad")!=-1||n.indexOf("ipod")!=-1)&&(r=new RegExp("os (\\d+)_"),t=r.exec(n),t&&t.length>=2)?(i=parseInt(t[1]),!isNaN(i)&&i<=9):!1},n}(),ViewerUrlUtils=function(){function n(){}return n.HTMLEncode=function(n){return UrlUtils.encodeString(n,this.htmlEncodeReplacements)},n.htmlEncodeReplacements=[{FindExpression:new RegExp("&","g"),ReplaceValue:"&#"+"&".charCodeAt(0)+";"},{FindExpression:new RegExp("<","g"),ReplaceValue:"&#"+"<".charCodeAt(0)+";"},{FindExpression:new RegExp(">","g"),ReplaceValue:"&#"+">".charCodeAt(0)+";"},{FindExpression:new RegExp("'","g"),ReplaceValue:"&#"+"'".charCodeAt(0)+";"},{FindExpression:new RegExp("\\\\","g"),ReplaceValue:"&#"+"\\\\".charCodeAt(0)+";"},{FindExpression:new RegExp('"',"g"),ReplaceValue:"&#"+'"'.charCodeAt(0)+";"},],n}(),FrameContainerContext=function(){function n(n,t){var i,r,u;this.m_initParams=n;this.m_logger=t;this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,null);((u=(r=(i=this.m_initParams)===null||i===void 0?void 0:i.SessionInformation)===null||r===void 0?void 0:r.WdParams)===null||u===void 0?void 0:u.enablePptSharingWebviewContainer)&&this.m_initParams.WebviewRef?(this.m_frameRef=this.m_initParams.WebviewRef,this.m_initParams.Container.style.display="none",this.m_frameContainerStrategy=new WebviewFrameStrategy(this.m_frameRef,this.m_logger,this.m_initParams.SessionInformation.HostSessionId,this.m_pptFeatureGates)):(this.m_frameRef=document.createElement("iframe"),this.m_frameContainerStrategy=new IFrameStrategy(this.m_frameRef,this.m_logger,this.m_pptFeatureGates))}return n.prototype.initMessageListener=function(){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.initMessageListener()},n.prototype.addMessageListener=function(n){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.addMessageListener(n)},n.prototype.removeEventListener=function(n){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.removeEventListener(n)},n.prototype.isReceivedMessageValid=function(n,t){return this.m_frameContainerStrategy?this.m_frameContainerStrategy.isReceivedMessageValid(n,t):!1},Object.defineProperty(n.prototype,"frameRef",{get:function(){return this.m_frameRef},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"logger",{set:function(n){this.m_logger=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"slideshowKind",{set:function(n){this.m_frameContainerStrategy&&(this.m_frameContainerStrategy.slideshowKind=n)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldUseAspxForLegacy",{set:function(n){this.m_frameContainerStrategy&&(this.m_frameContainerStrategy.shouldUseAspxForLegacy=n)},enumerable:!1,configurable:!0}),n.prototype.load=function(n,t){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.load(n,t)},n.prototype.postMessageDownward=function(n){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.postMessageDownward(n)},n.prototype.postMessageWithArrayBufferDownward=function(n,t){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.postMessageWithArrayBufferDownward(n,t)},n}(),IFrameStrategy=function(){function n(n,t,i){var r;this.m_slideshowKind="Modern";this.m_shouldUseAspxForLegacy=!1;this.m_iframe=n;this.m_logger=t;this.m_pptFeatureGates=i;(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(527958919,logCategory.PptSession,logLevel.Info,"IFrameStrategy::Ctor.")}return n.prototype.initMessageListener=function(){},n.prototype.addMessageListener=function(n){window.addEventListener("message",n)},n.prototype.removeEventListener=function(n){window.removeEventListener("message",n)},n.prototype.isReceivedMessageValid=function(n,t){var i,r,u;if(this.m_iframe){if(this.m_iframe.contentWindow!=t)return(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(528623698,logCategory.PptSession,logLevel.Error,"IFrameStrategy::isReceivedMessageValid - received a message with wrong source"),!1;if(!n)return(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(528623699,logCategory.PptSession,logLevel.Error,"IFrameStrategy::isReceivedMessageValid - no actual data"),!1}else return(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(528623697,logCategory.PptSession,logLevel.Error,"IFrameStrategy::isReceivedMessageValid - iframe is invalid but received a message"),!1;return!0},Object.defineProperty(n.prototype,"slideshowKind",{set:function(n){this.m_slideshowKind=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldUseAspxForLegacy",{set:function(n){this.m_shouldUseAspxForLegacy=n},enumerable:!1,configurable:!0}),n.prototype.load=function(n){var i,r,u,f,e,t,o,s,h;try{for(f=[],e=n.children,t=0;t<e.length;t++)o=e[t],o.value!=""&&f.push(o.name);(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(527958920,logCategory.PptSession,logLevel.Info,"IFrameStrategy::Load; children: "+f+"; numChildren "+n.childElementCount)}catch(c){(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(527786397,logCategory.PptSession,logLevel.Error,"IFrameStrategy::Load; exception "+c)}this.m_pptFeatureGates.DisableIframeDomCheckWhenFormSubmit==!0?n.submit():(s=n.target.replace("slideshowframe-",""),h=document.querySelector("#"+s),h?n.submit():(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(527577626,logCategory.PptSession,logLevel.Error,"IFrameStrategy::Load; form target: "+n.target+" not in DOM"))},n.prototype.postMessageDownward=function(n){var t,r=this.m_slideshowKind=="Modern"||this.m_shouldUseAspxForLegacy,i;this.m_iframe&&(this.m_iframe.src.length!=0||r)&&this.m_iframe.contentWindow?(i=JSON.stringify(n),this.m_iframe.contentWindow.postMessage(i,this.m_iframe.src==""?"*":this.m_iframe.src)):(t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(39203532,logCategory.PptSession,logLevel.Error,"IFrameStrategy::PostMessageDownward - iframe is invalid")},n.prototype.postMessageWithArrayBufferDownward=function(n,t){var i,f=this.m_iframe.name.indexOf("slideshowframe")>=0;if((this.m_iframe.src.length!=0||f)&&this.m_iframe.contentWindow!=null){var u=this.m_iframe.src==""?"*":this.m_iframe.src,r={bufferMetadata:n,arrayBuffer:t},e=JSON.parse(n);e.sharedArrayBuffer?this.m_iframe.contentWindow.postMessage(r,u):this.m_iframe.contentWindow.postMessage(r,u,[r.arrayBuffer])}else(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(556672283,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageWithArrayBufferDownward iframe src or contentWindow is empty")},n}(),WebviewFrameStrategy=function(){function n(n,t,i,r){var u;this.webviewToParentChannelName="ppt-webview-to-main-renderer-postmessage";this.parentToWebviewChannelName="ppt-main-renderer-to-webview-postmessage";this.m_slideshowKind="Modern";this.m_shouldUseAspxForLegacy=!1;this.m_listenerList=[];this.m_startTimeDomReady=0;this.m_endTimeDomReady=0;this.m_logger=t;this.m_webviewFrame=n;this.m_hostSessionId=i;this.m_pptFeatureGates=r;(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(527958913,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::Ctor "+i+".")}return n.prototype.initMessageListener=function(){this.m_webviewFrame.addEventListener("ipc-message",this.onMessageReceived.bind(this))},n.prototype.addMessageListener=function(n){this.m_listenerList.push(n)},n.prototype.removeEventListener=function(n){var t=this;this.m_listenerList.forEach(function(i,r){i===n&&t.m_listenerList.splice(r,1)})},n.prototype.isReceivedMessageValid=function(n){var t,i;if(n){if(n.m_id!=this.m_hostSessionId)return(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(528623696,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::isReceivedMessageValid - invalid id in message, m_id:"+n.m_id+", hostSessionId:"+this.m_hostSessionId),!1}else return(t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(528623695,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::isReceivedMessageValid - no actual data"),!1;return!0},n.prototype.load=function(n,t){var i=this,r,u;this.m_webviewFrame.style.display="flex";r=function(){var u,f,e;try{i.m_endTimeDomReady=Date.now();(u=i.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(512553557,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::load - startTimeDomReady: "+i.m_startTimeDomReady+", endTimeDomReady: "+i.m_endTimeDomReady);i.m_webviewFrame&&(e=JSON.stringify(t),i.m_webviewFrame.executeJavaScript('\n                        let frameForm = document.createElement("form");\n                        frameForm.name = "frameform-'+n.id+'";\n                        frameForm.id = "frameform-'+n.id+'";\n                        frameForm.action = "'+n.action+'";\n                        frameForm.method = "post";\n                        let formParams = '+e+';\n                        Object.keys(formParams).forEach(function (key) {\n                           let inputElement = document.createElement("input");\n                           inputElement.type = "hidden";\n                           inputElement.name = key;\n                           inputElement.value = formParams[key];\n                           frameForm.appendChild(inputElement);\n                        });\n                        document.body.appendChild(frameForm);\n                        frameForm.submit();\n                  '),i.m_webviewFrame.removeEventListener("dom-ready",r))}catch(o){(f=i.m_logger)===null||f===void 0?void 0:f.ULS.traceTag(528824523,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::LaunchSlideShow - exception when form posting slideshow.aspx: "+o)}};this.m_webviewFrame.addEventListener("dom-ready",r);this.m_startTimeDomReady=Date.now();u=t.podsurl+"PowerPointLoader.aspx";this.m_webviewFrame.src=""+u},n.prototype.postMessageDownward=function(n){var t;try{n&&n.m_id==null&&(n.m_id=this.m_hostSessionId);this.m_webviewFrame.send(this.parentToWebviewChannelName,n)}catch(i){(t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(528824524,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::postMessageDownward - exception: "+i)}},n.prototype.postMessageWithArrayBufferDownward=function(n,t){var u,i,f,e,r,o;try{i=void 0;this.m_pptFeatureGates.DisableWebviewVideoFrameCopy||t instanceof ArrayBuffer?i=t:(f=new Uint8Array(t),i=new ArrayBuffer(t.byteLength),e=new Uint8Array(i),e.set(f),r=JSON.parse(n),r&&r.sharedArrayBuffer==!0&&(r.sharedArrayBuffer=!1,n=JSON.stringify(r)));o={m_type:99,bufferMetadata:n,arrayBuffer:i};this.postMessageDownward(o)}catch(s){(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(527303712,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::postMessageWithArrayBufferDownward - exception: "+s)}},Object.defineProperty(n.prototype,"slideshowKind",{set:function(n){this.m_slideshowKind=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldUseAspxForLegacy",{set:function(n){this.m_shouldUseAspxForLegacy=n},enumerable:!1,configurable:!0}),n.prototype.onMessageReceived=function(n){var t,i,r,e=n&&n.channel,u,f;if((t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(523383114,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::onMessageReceived - event object: "+n+", event channel: "+(n===null||n===void 0?void 0:n.channel)+", event args: "+(n===null||n===void 0?void 0:n.args)+", event as string: "+JSON.stringify(n)),e===this.webviewToParentChannelName&&n.args&&n.args[1])if((i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(523383115,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::onMessageReceived - passed event format check"),u=n.args[1],f=PPTMessageListenerRegistry.getInstance(),f){f.onMessage(u);this.m_listenerList.forEach(function(n){n(u)})}else(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(528824525,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::onMessageReceived - no messageRegistry instance")},n}();Microsoft.Office.PowerPoint.Bootstrap=new PPTPreviewerBootstrapper;Microsoft.Office.PowerPoint.Bootstrap.Prefetch=PPTPreviewerBootstrapper.Prefetch;Microsoft.Office.PowerPoint.Bootstrap.GetMinContentVersion=PPTPreviewerBootstrapper.GetMinContentVersion;Microsoft.Office.PowerPoint.Bootstrap.SetPreviewAPIFactory=function(n){PreviewSessionLoader.s_previewAPIFactory=n;PPTMessageListenerRegistry.getInstance().setSliceLoaded()},function(n){n[n.None=0]="None";n[n.Metadata=1]="Metadata";n[n.AllParts=2]="AllParts"}(PresentationUrlGuaranteeLevel||(PresentationUrlGuaranteeLevel={}));PPTPreviewerGetPptFileData=function(){function n(){}return n.isNetworkError=function(n){return n&&n.message=="Failed to fetch"},n.getPresentationUrl=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var w,e,h,b,s,k,d,u,f,c,o,l,a,v,y,p;return __generator(this,function(g){switch(g.label){case 0:if(g.trys.push([0,8,,9]),t==null||t.ApplicationCustomSettings==null||t.SessionInformation==null)return[2,Promise.reject(new Error("Empty params"))];w="snapRequestID_"+PPTBootstrapper.generateRandomUUID();e=t.ApplicationCustomSettings.OnDemandServer||"";h=PPTPreviewerBootstrapperUtils.createSnapRequestHeaders(t.SessionInformation.HostSessionId||"",t.SessionInformation.HostName||"",w,t.SessionInformation.CallId||"");b=window.location.search.indexOf("wdAuthHeaderForHostDownloadEnabled")>=0;s={CallID:t.SessionInformation.CallId||"",ContentId:t.SessionInformation.ContentId||"",DownloadUrl:t.WopiPrecheckInfo.FileGetUrl||"",CustomFontCatalogUrl:t.WopiPrecheckInfo.CustomFontCatalogUrl||"",FileExtension:PPTBootstrapper.getFileExtension(t.WopiPrecheckInfo.FileName,i),FileLengthHint:t.WopiPrecheckInfo.FileSize,ETag:t.WopiPrecheckInfo.ETag||"",DocId:t.WopiPrecheckInfo.DocUniqueId||"",MultiRangeEnabled:!1,TailRangeEnabled:!0,AuthHeaderForHostDownloadEnabled:b,GuaranteeLevel:PresentationUrlGuaranteeLevel.Metadata};k=t.WopiPrecheckInfo.FileName||"";d=PPTBootstrapper.isBinaryFile(k,i);u=null;f="";try{f=SnapRegionInfo.getOnDemandSnapServer(t.ApplicationUrl,t);u=SnapRegionInfo.snapFlighting(t.ApplicationUrl,s.CallID,t,i);i.ULS.traceTag(540317531,logCategory.PptSession,logLevel.Info,"getPresentationUrl: snap region: "+f==null?"":f.replace("https://","").replace("http://",""));u&&(t.SessionInformation.UseSnapService=u.UseSnap,i.ULS.traceTag(540317532,logCategory.PptSession,logLevel.Info,"getPresentationUrl: snap region enabled:"+u.UseSnap+", isenabled: "+u.Reason+" "))}catch(nt){i.ULS.traceTag(540317533,logCategory.PptSession,logLevel.Error,"getPresentationUrl: error in getting snap region: "+JSON.stringify(nt))}return(d||(r===null||r===void 0?void 0:r.DisableNewSnapService))&&(u=null,f="",t.SessionInformation.UseSnapService=!1),t.SessionInformation.SnapUrl=f,f!=""&&u!=null&&u.UseSnap&&(e=f),e+="GetDownloadUrl.ashx",c=r===null||r===void 0?void 0:r.ForceMediaProtocol,c!==undefined&&(e=UrlUtils.addOrReplaceParameterValue(e,"forceMediaProtocol",c)),[4,n._getPresentationUrlWithRetries(e,s,h,i,2)];case 1:return o=g.sent(),[4,o.json()];case 2:return(l=g.sent(),!o.ok)?[3,3]:[2,Promise.resolve({presentationUrl:l.SnapUrl})];case 3:return(a=n.s_retryGetPresentationUrlHttpCodes.indexOf(o.status)!==-1,i.ULS.traceTag(538478227,logCategory.PptSession,logLevel.Warning,"getPresentationUrl: service error code "+o.status+"; isRetriable: "+a),!a)?[3,6]:[4,n._getPresentationUrl(e,s,h)];case 4:return v=g.sent(),[4,v.json()];case 5:return y=g.sent(),v.ok?[2,Promise.resolve({presentationUrl:y.SnapUrl})]:[2,Promise.reject(new Error(y.ErrorCode||"UnknownError"))];case 6:return[2,Promise.reject(new Error(l.ErrorCode||"UnknownError"))];case 7:return[3,9];case 8:return p=g.sent(),i.ULS.traceTag(510251284,logCategory.PptSession,logLevel.Error,"getPresentationUrl: caught exception "+p),[2,Promise.reject(p)];case 9:return[2]}})})},n._getPresentationUrlWithRetries=function(t,i,r,u,f){return __awaiter(this,void 0,void 0,function(){var s,e,h,o;return __generator(this,function(c){switch(c.label){case 0:s=new Error("UnknownError");e=0;c.label=1;case 1:if(!(e<f))return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,n._getPresentationUrl(t,i,r)];case 3:return h=c.sent(),u.ULS.traceTag(509747974,logCategory.PptSession,logLevel.Info,"getPresentationUrlWithRetries succeeded after retry "+e),[2,h];case 4:return o=c.sent(),s=o,n.isNetworkError(o)?(u.ULS.traceTag(509747973,logCategory.PptSession,logLevel.Error,"getPresentationUrlWithRetries caught retryable exception "+o+", retries left: "+(f-e)),[3,5]):(u.ULS.traceTag(509747972,logCategory.PptSession,logLevel.Error,"getPresentationUrlWithRetries throwing nonretryable exception "+o),[3,6]);case 5:return e++,[3,1];case 6:throw s;}})})},n._getPresentationUrl=function(n,t,i){return fetch(n,{method:"POST",headers:i,body:JSON.stringify(t)})},n.s_retryGetPresentationUrlHttpCodes=[403,404,503],n}();Microsoft.Office.PowerPoint.Bootstrap&&Microsoft.Office.PowerPoint.Bootstrap.SetPreviewAPIFactory(new PreviewAPIV0Factory);PPTBootstrapSettings=function(){function n(){}return n.getAppMetadata=function(){return{AppVersionMajor:1,AppVersionMinor:BuildVersionConfig.BUILD_NUMBER_MINOR,ContentVersionMajor:1,ContentVersionMinor:BuildVersionConfig.BUILD_NUMBER_MINOR,WacCdnVersion:BuildVersionConfig.BUILD_CDN_NUMBER,Environment:"wac"}},n.getCDNManifestMapping=function(){var n={};return n["pptscripts/reader.dione.js"]="pptscripts/c7a3970be8730f48.js",n["pptscripts/reader.calypso.js"]="pptscripts/9f57755d98d16eca.js",n["pptscripts/babylon.js"]="pptscripts/9ae9bf21b21daf84.js",n["pptpages/powerpointframe.html"]="pptpages/7a8dfc5352779a35.html",n["pptscripts/powerpoint.boot.vslice.js"]="pptscripts/a6ef2382d7350cb0.js",n},n.viewerSliceBootstrapper=function(){return"https://contentstorage.osi.office.net/scripts/pptscripts/a6ef2382d7350cb0.js"},n}();