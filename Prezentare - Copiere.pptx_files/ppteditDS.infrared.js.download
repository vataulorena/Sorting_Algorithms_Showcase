'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1245:function(I,Y,d){d.r(Y);I=d(0);var h=d(70),e=d(28),n=d(192),m=d(52),z=d(30);class B{constructor(Ba,va){this.ia=Ba;this.ia.ra(z.a.OAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.PAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.QAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.RAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.SAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.TAj,
m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.UAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.zAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.AAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.BAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.CAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.DAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.EAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.FAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.yAj,
m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.GAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.HAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.JAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.KAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.LAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.MAj,m.a.application,n.ActionManager.uv,4);this.ia.ra(z.a.NAj,m.a.application,n.ActionManager.uv,4);this.Gug=JSON.parse(va.Ga("674"));for(const ta of this.Gug)ta.regex=
new RegExp(ta.pattern)}trackAction(Ba){for(const va of this.Gug)va.regex.test(Ba)&&this.ia.processAction(va.actionId,2)}}Object(I.a)(B,"IdeasActionTracker",null,[808]);class v{constructor(){this.pdb=this.wCe=this.DBe=null;this.oOj=this.iOl}addSlideSuggestionsListener(Ba){this.DBe=Ba}addTextToSmartArtSuggestionListener(Ba){this.wCe=Ba}AOd(Ba){this.pdb=Ba}notifySlideSuggestion(Ba,va){this.DBe&&(this.DBe(Ba,va),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",va?va.suggestions.length:0,va?
va.correlationId:"0"))}notifyTextToSmartArtSuggestion(Ba,va){this.wCe&&(this.wCe(Ba,va),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",va?va.suggestions.length:0,va?va.correlationId:"0"))}Sdd(Ba){this.pdb&&this.pdb(Ba)}}Object(I.a)(v,"InfraredDesignerServiceProvider",null,[807]);class y{constructor(){this.pdb=null}AOd(Ba){this.pdb=Ba}Sdd(Ba){this.pdb&&this.pdb(Ba)}}Object(I.a)(y,"InfraredTelemetryListener",null,[805]);var A=d(201),E=d(1019),u=d(47),J=d(14),G=d(36);class S{}Object(I.a)(S,
"EntityGroup",null,[]);class P extends S{}Object(I.a)(P,"Idea",S,[]);var Q=d(543);class D{}Object(I.a)(D,"ProviderResult",null,[]);var O=d(337),X=d(440),N=d(439),aa=d(336),V=d(542),ca=d(27),fa=d(270);class ma{}ma.AGk="PowerPoint";ma.rJl="WAC";Object(I.a)(ma,"ApplicationPropertiesConstants",null,[]);class da{}Object(I.a)(da,"EnterpriseUserInfo",null,[]);class qa{}Object(I.a)(qa,"Message",null,[]);class F extends qa{}F.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(I.a)(F,
"PowerPointTextTileChangedMessage",qa,[]);class sa{}Object(I.a)(sa,"RankerConfiguration",null,[]);class ia{constructor(Ba){this.gXg=Ba}m2i(Ba,va){return new Promise((ta,Fa)=>{this.gXg&&Ba&&va||Fa("wopiIdentityManager or tokenParameter or clientWoipId is null");this.gXg.getAccessToken(Ba,va).then(pa=>{pa?ta(pa.accessToken):Fa("auth token is null")},pa=>{Fa(pa)})})}}Object(I.a)(ia,"AuthenticationProvider",null,[825]);class Na{constructor(Ba,va,ta,Fa,pa=""){this.resource=Ba;this.scope=va;this.silentLogin=
ta;this.options=Fa;this.correlationId=pa}}Object(I.a)(Na,"InfraredTokenParameters",null,[450]);class Ca{constructor(Ba,va,ta,Fa,pa,ka,Ha,Ya,Ka){this.AAg=this.Mpe=this.Gdf=null;this.kAg=!1;this.Uxe=null;this.kBe=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.cFb=Ba;this.z9j=Ha;this.Ive=Ka;this.hbk=Ba.ka("659");this.kFb=Ba.Ga("750");Ha=window.location.hostname;Ka=Ba.Ga("816");Ha&&0<Ha.length&&Ka&&0<Ka.length&&0<=Ka.toLowerCase().indexOf(Ha.toLowerCase())&&(this.kFb=
"");this.HWa=va;this.adc=ka;if(this.Yik=Ba.ka("688"))this.AAg=Ba.Ga("689"),this.Mpe=new ia(Ya);this.HWa.addSlideSuggestionsListener(Object(J.a)(this,this.dyk,"onSlideSuggestion"));this.HWa.addTextToSmartArtSuggestionListener(Object(J.a)(this,this.Dyk,"onTextToSmartArtSuggestion"));this.HWa.AOd(Object(J.a)(this,this.L3g,"onIdeasSessionTelemetry"));ta.AOd(Object(J.a)(this,this.L3g,"onIdeasSessionTelemetry"));this.adc&&this.adc.execute(Pa=>{Pa.muf(Object(J.a)(this,this.qHe,"onEditorCritiques"))});this.ia=
Fa;(this.OT=pa)&&this.OT.execute(Pa=>{Pa.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new N.a,{name:"InfraredSlideTextTileLambda",inputSchema:X.a.Grc,outputSchema:X.a.Grc,func:(Oa,oa,Xa)=>{this.eyk(Oa);Xa(null)}}))});this.Ffl()}get jyb(){return this.Gdf}Ffl(){var Ba=JSON.parse(this.cFb.Ga("612"));Ba=Object.assign(new sa,{rankingOrder:Ba});var va=IdeasInfraredConnector,ta=va.setup,Fa=e.a.J,pa=Object(J.a)(this,this.VAj,"ideasPaneVisibilityStatusCallback"),ka=this.cFb;const Ha=
{};Ha.appName=2===ca.AFrameworkApplication.Aa.hb.Uk?ma.AGk:"unknown";Ha.appVersion=ca.AFrameworkApplication.buildVersion;Ha.appPlatform=ma.rJl;Ha.lcid=ca.AFrameworkApplication.lcid;var Ya=fa.a.xe(ca.AFrameworkApplication.lcid);Ya=Ya?Ya.name:null;const Ka=Ya.split("-");Ha.market=Ka[Ka.length-1];Ha.uiLanguage=Ya;Ha.sessionId=ca.AFrameworkApplication.userSessionId;Ha.tenantRoot=ka.Ga("748");Ha.shredderServiceEndpoint=ka.Ga("749");this.Gdf=ta.call(va,Ba,Fa,pa,Ha,this.z9j,Object(J.a)(this,this.z6f,"getShredderServiceAuthTokenPromise"))}VAj(Ba){this.kAg=
Ba;(this.HWa.oOj=Ba)?(this.ia.processAction(z.a.Evb,2),this.Zbh()):this.ia.La(z.a.noa,2,new V.a(!0,aa.a.ade))}dyk(Ba,va){const ta=[];ta.push(Object.assign(new P,{providerId:Q.a.Twh,groupTypeId:Q.a.Swh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:va}));try{this.jyb.pushProviderResult(Object.assign(new D,{providerId:Q.a.Twh,resultStatus:Ba,entityGroups:ta}))}catch(Fa){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Fa)}"Success"===Ba&&(A.a.Wa(va.suggestions)||this.Ive.itd(0))}Dyk(Ba,va){const ta=[];ta.push(Object.assign(new P,{providerId:Q.a.bxh,groupTypeId:Q.a.axh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:va}));try{this.jyb.pushProviderResult(Object.assign(new D,{providerId:Q.a.bxh,resultStatus:Ba,entityGroups:ta}))}catch(Fa){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Fa)}}L3g(Ba){try{this.jyb.trackIdeasProviderAction(Ba.cardId,
Ba.actionType,Ba.actionEngagement)}catch(va){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",va)}}eyk(Ba){if(this.hbk)if(Ba)if(Ba){try{const va=G.a(Ba.Content);this.Rgi(this.Uxe,va)&&(this.Uxe=va,this.kBe=!0)}catch(va){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.kAg&&this.Zbh()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}Rgi(Ba,
va){if(!Ba&&va||Ba&&!va)return!0;if(!Ba&&!va)return!1;if(!Ba.drawingElems&&va.drawingElems||Ba.drawingElems&&!va.drawingElems)return!0;const ta=new E.a;for(const Fa of Ba.drawingElems)if(Ba=Fa.text)for(const pa of Ba.paragraphs)pa&&(u.a.Wa(pa.id)||u.a.Wa(pa.chars)||ta.$(pa.id,pa.chars));for(const Fa of va.drawingElems)if(va=Fa.text)for(const pa of va.paragraphs)if(pa&&!(u.a.Wa(pa.id)||u.a.Wa(pa.chars)||ta.Hb(pa.id)&&ta.ga(pa.id)===pa.chars))return!0;return!1}Zbh(){if(this.kBe){try{this.jyb.postMessage(Object.assign(new F,
{messageType:F.PowerPointTextTileChangedMessageType,data:this.Uxe}))}catch(Ba){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",Ba)}this.Ive.itd(1);this.kBe=!1}}qHe(Ba,va){try{Ba=[],Ba.push(Object.assign(new P,{groupTypeId:Q.a.JQf,providerId:Q.a.PQf,notificationConfidence:va.Dka?va.Dka.notificationConfidence:0,shouldRaiseNotification:va.Dka?va.Dka.shouldRaiseNotification:!1,confidence:va.Dka?va.Dka.confidence:0,data:va.d3b})),this.jyb.pushProviderResult(Object.assign(new D,
{providerId:Q.a.PQf,resultStatus:va.Dka?va.Dka.resultStatus:O.a.invalid,entityGroups:Ba}))}catch(ta){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",ta)}va.Dka&&"Success"===va.Dka.resultStatus&&va.d3b&&!A.a.Wa(va.d3b.critiques)&&this.Ive.itd(2)}z6f(){if(!this.Mpe)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.kFb&&0<this.kFb.length)return this.Mpe.m2i(new Na(this.kFb,"user_impersonation",!0,
{}),this.AAg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(Ba){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",Ba),null}}f9i(){return new Promise(Ba=>{const va=this.cFb.Ga("749"),ta=this.z6f();va&&va.length&&ta?ta.then(Fa=>{Fa&&Fa.length?(Fa=new da,Fa.CountryCode="US",Fa.IsEnabled=!1,Fa.IsEnterpriseEnabled=!0,Fa.IsGoLocal=!1,Fa.ServiceEndpoint=va,Fa.TenantRoot="",Ba(Fa)):Ba(null)},()=>{Ba(null)}):
Ba(null)})}}Object(I.a)(Ca,"PPTWebEditorInfraredRuntimeManager",null,[782]);class ha{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Zb(Ba){this.K=Ba;this.K.register(v,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().oa(()=>new v);this.K.register(y,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().oa(()=>new y);this.K.register(B,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().oa(()=>
new B(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(Ca,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().oa(()=>new Ca(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ja("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const Ba=this.K.resolve("Common.IAppSettingsManager");Ba.gf(()=>{Ba.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Dc(new ha)}}Object(I.a)(ha,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");ha.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.infrared.js.map