'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1236:function(I,Y,d){d.r(Y);var h=d(0),e=d(70),n=d(387),m=d(14),z=d(27),B=d(198),v=d(142),y;(function(r){r[r.error=0]="error";r[r.warning=1]="warning";r[r.tip=2]="tip";r[r.intelligentService=3]="intelligentService"})(y||(y={}));Object(h.b)("AccessibilityRuleCategory",y);var A=d(57),E=d(73),u=d(37),J=d(130),G=d(182),S=d(109);class P{constructor(r,R,la=null){this.uwd=null;this.gff=this.Cef=!1;this.JBa=r;this.Bvc=
R;this.Ca=la;this.An.ya(u.a.mui,E.a.frame,Object(m.a)(this,this.WK,"closePane"))}get An(){return this.Ca||(this.Ca=z.AFrameworkApplication.Ta)}set An(r){this.Ca=r}zRi(){this.Cef||(this.JBa.initialize(this),this.Bvc.initialize(this),this.Cef=!0)}PGe(){S.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.Bvc.b4k()}Ql(r,R,la){if(1===la)return B.SessionStatusManager.instance.uka?8:32;this.JBa.isVisible||this.zRi();this.Rll();return 32}WK(r,R,la){1!==la&&this.JBa.Cr();return 32}yIe(){this.JBa.Cvh(!0)}W_d(r){if(r){if(r.AccessibilityRules&&
Object.keys(r.AccessibilityRules).length){const la=r.AccessibilityRules;for(let Ea in la){var R=Ea;const Qa=la[Ea].RuleId+"";R!==Qa&&S.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",R,Qa)}this.uwd=la}else!this.uwd&&r.Results&&0<r.Results.length?(S.c(18993251,200,15,"No accessibility rule definitions available"),r.IsSuccess=!1):r.AccessibilityRules=this.uwd;r.IsSuccess||S.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.WWk(r);this.R3j(r);this.JBa.W_d(r)}}WWk(r){const R=
r.AccessibilityRules;if(r=r.Results)for(let la=r.length-1;0<=la;la--){const Ea=r[la];let Qa="";const wb=Ea.RuleId;Ea.ContentName||(Qa+="Result does not have content name. ");wb in R||(Qa+=String.format("No accessibility check rule exists for ID {0}.",wb));0<Qa.length&&(S.c(36214999,200,15,"Omitting invalid accessibility check result: "+Qa),Array.removeAt(r,la))}}Vhj(){return z.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):
A.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Sw.loadScript("accessibility-checker-pane-strings")}Rll(){this.gff?this.JBa.Ql():this.Vhj().then(()=>{this.gff=!0;this.JBa.Ql()}).catch(r=>n.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",r))}R3j(r){var R={};const la={};var Ea=r.Results,Qa=[];Array.add(Qa,Object.assign(new J.a,{name:"FinalViolationCount",int64:0}));Array.add(Qa,Object.assign(new J.a,{name:"FinalErrorCount",string:"0"}));
Array.add(Qa,Object.assign(new J.a,{name:"FinalWarningCount",string:"0"}));Array.add(Qa,Object.assign(new J.a,{name:"FinalTipCount",string:"0"}));Array.add(Qa,Object.assign(new J.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ea){for(const xc of Ea)if(r.AccessibilityRules){var wb=r.AccessibilityRules[xc.RuleId];if(wb){if(R[y[wb.Category]]){let ed=R[y[wb.Category]];R[y[wb.Category]]=++ed}else R[y[wb.Category]]=1;la[xc.RuleId]?(wb=la[xc.RuleId],la[xc.RuleId]=++wb):la[xc.RuleId]=1}}Qa[0].int64=
Ea.length;for(var Pb in R)switch(r=R[Pb],Ea=Pb,Ea="Final"+Ea.charAt(0).toUpperCase()+Ea.substring(1,Ea.length)+"Count",Ea){case "FinalErrorCount":Qa[1].string=r.toString();break;case "FinalWarningCount":Qa[2].string=r.toString();break;case "FinalTipCount":Qa[3].string=r.toString();break;case "FinalIntelligentServiceCount":Qa[4].string=r.toString()}}v.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Qa}));for(let xc in la)R=
xc,Qa=la[xc],Pb=[],Array.add(Pb,Object.assign(new J.a,{name:"RuleID",string:R})),Array.add(Pb,Object.assign(new J.a,{name:"FinalViolationCount",string:Qa.toString()})),v.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Pb}))}dispose(){this.JBa&&this.JBa.dispose();this.Bvc&&this.Bvc.dispose()}}Object(h.a)(P,"AAccessibilityCheckManager",null,[178,106]);var Q=d(81),D=d(1200),O=d(63),X=d(297),N=d(28);class aa extends P{constructor(r,
R,la,Ea,Qa,wb,Pb,xc,ed){super(r,R);this.Reb=this.QHa=null;this.Ea=la;this.zb=Ea;this.Nq=Qa;this.RX=wb;this.ua=Pb;this.pa=xc;this.Tb=ed;this.uBe=!1}fal(r){if(!r)return N.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(r.sldIdField){var R=new O.a(Object.assign(new X.a,{Sid:r.sldIdField.sidField,Cid:r.sldIdField.cidField}));R=this.Tb.kka(R);if(!R)return!1;let la=null;if(r.spIdFieldSpecified&&(la=R.wC(r.spIdField),!la&&this.uBe))return!1;this.a7k(R,la)}else N.a.J(19227929,334,
15,"There is no slide id info in violation data");return!0}PGe(){this.uBe=!1;super.PGe()}yIe(){this.uBe=!0;super.yIe()}a7k(r,R){if(r){const la=this.ua.Ba!==r?!0:!1;R&&(this.Reb=R,la?this.Nq.aW(Object(m.a)(this,this.VGb,"onActiveSlideDomChanged")):this.noh());la&&(this.RX.Ba=r);this.pa.ay();this.Ea.Ed()}}VGb(){this.Nq.ioa(Object(m.a)(this,this.VGb,"onActiveSlideDomChanged"));this.QHa||(this.QHa=new Q.a(2,1,0,Object(m.a)(this,this.rIe,"onPostActiveSlideDomChangedTask"),90,"20"),this.zb.Db(this.QHa))}rIe(){this.QHa=
null;this.noh()}Ed(){this.RX.MK.lp||this.Ea.Ed()}noh(){if(this.Reb){const r=Object(D.a)(117,this.Reb.mg(this.RX.MK.Ma));r?r.Al?N.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.Reb.id):r.$p?r.Fqd():this.pa.selectShape(this.Reb,!0):N.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.Reb.id);this.Ed();this.Reb=null}}}Object(h.a)(aa,"PptAccCheckManager",P,[]);class V{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=
!1;this.Results=null}static deserialize(r){r=Sys.Serialization.JavaScriptSerializer.deserialize(r);const R=r.AccessibilityRules,la={};if(R)for(let Ea=0;Ea<R.length;++Ea){const Qa=R[Ea];la[Qa.Key]=Qa.Value}r.AccessibilityRules=la;return r}}Object(h.a)(V,"AccessibilityCheckResultCollection",null,[]);class ca{}Object(h.a)(ca,"AccessibilityCheckResult",null,[]);class fa{}Object(h.a)(fa,"AccessibilityCheckRule",null,[]);class ma{constructor(r){this.GMa=null;this.ucf=r}get fileId(){return this.ucf?this.ucf():
null}initialize(r){this.GMa=r}d2g(r){this.GMa.W_d(r)}}Object(h.a)(ma,"AAccessibilityCheckService",null,[177,106]);var da=d(18),qa=d(110);class F extends qa.a{constructor(){super()}Zk(){return 56}}Object(h.a)(F,"AccCheckRequest",qa.a,[]);var sa=d(246);class ia extends ma{constructor(r,R){super(null);this.vi=r;this.AXa=R}b4k(){const r=new sa.a(new F,Object(m.a)(this,this.Zpk,"onAccCheckSucceed"),Object(m.a)(this,this.Ypk,"onAccCheckFailed"));this.vi.Db(r)}dispose(){}get mIj(){return 0<this.AXa.gYb.length}Zpk(r){if(r&&
r.ACResult&&(r=this.yji(r.ACResult))){this.d2g(r);N.a.J(19227935,334,50,"Acc-check succeeded");return}this.EXg("Succeeded but response is invalid")}Ypk(r){this.EXg(r.toString());return!0}EXg(r){N.a.J(19227937,334,50,String.format("Acc-check failed: {0}",r));r=new V;r.IsSuccess=!1;this.d2g(r)}yji(r){if(r){var R=null;try{R=JSON.parse(r)}catch(la){return N.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",la.toString()),null}if(R){r=new V;r.IsSuccess=!0;r.IsPartialResult=R.isPartialResultField;
r.AccessibilityRules={};if(R.violatedRulesField){const la=new da.a;for(const Ea of R.violatedRulesField)if(R=this.Aji(Ea)){r.AccessibilityRules[R.RuleId]=R;for(const Qa of Ea.violationsField){const wb=new ca;wb.RuleId=R.RuleId;wb.ContentName=Qa.labelField;wb.ContentId=Qa;la.add(wb)}}r.Results=la.toArray()}return r}}return null}Aji(r){if(!r)return null;if(r.ruleIdField>=this.AXa.gYb.length)return N.a.J(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",r.ruleIdField,this.AXa.gYb.length),
null;const R=new fa;R.RuleId=r.ruleIdField.toString();R.RuleName=this.AXa.gYb[r.ruleIdField].ruleTextField;switch(this.AXa.gYb[r.ruleIdField].ruleTypeField){case 0:R.Category=0;break;case 1:R.Category=1;break;case 2:R.Category=2;break;case 3:R.Category=3}return R}}Object(h.a)(ia,"PptAccCheckService",ma,[1036,177,106]);class Na{get Izi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Jzi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Kzi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get xAk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Sgd(){return CommonUIStrings.l_AccCheckerPaneTitle}get gDk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(h.a)(Na,"AccessibilityCheckStringsProvider",null,[176]);class Ca{constructor(){this.omh=this.contentId=null}}Object(h.a)(Ca,"ResultIds",null,[]);var ha=d(67),Ba=d(173);class va{constructor(r,R){this._element=null;this.Ln=R;this.Rg=r}get element(){this._element||(this._element=this.GXd(),this.Vu());return this._element}$jb(r){this._element=r}dispose(){this.element&&(this.kpa(),this.$jb(null))}Vu(){this.Ln&&this.Rg?(this.Ln.pb(ha.a.click,this.element,Object(m.a)(this,this.onClick,"onClick")),
this.Rg.pb(ha.a.Yf,this.element,Object(m.a)(this,this.$3g,"onKeyPress"))):n.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}kpa(){this.Ln&&this.Rg&&(this.Ln.yb(ha.a.click,this.element,Object(m.a)(this,this.onClick,"onClick")),this.Rg.yb(ha.a.Yf,this.element,Object(m.a)(this,this.$3g,"onKeyPress")))}onClick(){this.W3g();return!0}$3g(r){return this.fPj(r.qc.keyCode)?(this.W3g(),!0):!1}fPj(r){return r===
Ba.a.DPb||r===Ba.a.tq}}Object(h.a)(va,"AInteractivePaneElement",null,[245,106]);const ta=(r,R,la)=>{r=document.createElement(r);R&&(r.id=R);la&&(r.className=la);r.setAttribute("Unselectable","on");return r};var Fa=d(75),pa=d(134),ka=d(97);class Ha extends va{constructor(r,R,la){super(r,R);this.lXh=la}hide(){this.element.removeAttribute(pa.a.ef);pa.a.eP(this.element,pa.a.QK,pa.a.gC);this.element.style.display="none"}show(){pa.a.eP(this.element,pa.a.QK,pa.a.Iia);pa.a.eP(this.element,pa.a.ef,pa.a.vRd);
this.element.style.display="block"}GXd(){const r=ta("div",this.b0g,"AccCheckerNotification");pa.a.eP(r,pa.a.wRd,pa.a.gC);pa.a.eP(r,pa.a.P2,this.GFe);r.tabIndex=0;const R=ta("span",this.a0g,"AccCheckerNotificationIcon");var la=Fa.createClusteredImage(16,16,"Info_16x16x32","",!0,"");R.appendChild(la);la=ta("span",this.GFe,"AccCheckerNotificationText");ka.a.Nx(la,this.c0g);r.appendChild(R);r.appendChild(la);return r}W3g(){this.lXh()}}Object(h.a)(Ha,"APopupNotification",va,[244,245,106]);class Ya extends Ha{constructor(r,
R,la,Ea){super(r,R,la);this.Zba=Ea}get b0g(){return"AccCheckerOutOfSyncNotificationId"}get a0g(){return"AccCheckerOutOfSyncNotificationIconId"}get GFe(){return"AccCheckerOutOfSyncNotificationTextId"}get c0g(){return this.Zba.xAk}}Object(h.a)(Ya,"OutOfSyncNotification",Ha,[]);class Ka extends Ha{constructor(r,R,la,Ea){super(r,R,la);this.Zba=Ea}get b0g(){return"AccCheckerPartialResultNotificationId"}get a0g(){return"AccCheckerPartialResultNotificationIconId"}get GFe(){return"AccCheckerPartialResultNotificationTextId"}get c0g(){return this.Zba.gDk}}
Object(h.a)(Ka,"PartialResultNotification",Ha,[]);var Pa=d(121),Oa=d(108);class oa{constructor(r,R,la,Ea=null,Qa=null,wb=null,Pb=null){this.Hmf=this.B7=this.Rg=this.GMa=null;this.Abb=Ea;this.Ln=r;this.Nd=R;this.vK=la;this.Zba=Pb||new Na;this.zHd=Qa||new Ya(this.Abb,this.Ln,Object(m.a)(this,this.CMi,"dimissOutOfSyncNotification"),this.Zba);this.PHd=wb||new Ka(this.Abb,this.Ln,Object(m.a)(this,this.DMi,"dimissPartialResultNotification"),this.Zba)}show(){}hide(){}get Abb(){return this.Rg||(this.Rg=z.AFrameworkApplication.Aa.qG)}set Abb(r){this.Rg=
r}CJf(){}Cr(){}dispose(){}xFh(){}yod(){}WHj(r){var R=this.Hmf[r];r=R.contentId;if((R=R.omh+"")&&R.length){const la=[];Array.add(la,Object.assign(new J.a,{name:"RuleID",string:R}));v.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}",oa.$0e,"ViolationSelected"),dataFields:la}))}this.tnk(r)}tnk(r){r&&this.GMa.fal(r)||(this.Nd.HU(Pa.AFrame.VV,!1),this.skl())}CMi(){this.Cvh(!1);this.yod()}DMi(){this.Evh(!1);this.yod()}skl(){const r=Object.assign(new Oa.StandardDialog(!0),{Ar:z.AFrameworkApplication.Kda,
xd:1,B0a:!1});r.xya(1);r.Xe(1,this.Zba.Izi);r.Xe(0,CommonUIStrings.l_DialogCancel);r.fP(this.Zba.Kzi,this.Zba.Jzi,R=>{1===R&&this.bie()})}gli(r){let R=null;if(r.Results&&0<r.Results.length){R={};let la=0;for(const Ea of r.Results)Ea.ResultId=oa.J3h+ ++la,r=new Ca,r.contentId=Ea.ContentId,r.omh=Ea.RuleId,R[Ea.ResultId]=r}return R}Z3j(){v.a.addNamespaceMapping(oa.$0e,oa.aul);v.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}",oa.$0e,"ShowTaskpane")}))}}oa.J3h="AccCheckResult";
oa.$0e="Office.UX.AccChecker";oa.aul="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(h.a)(oa,"BaseAccessibilityCheckPane",null,[179,106]);class Xa{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(h.a)(Xa,"AccCheckerTaskPaneProps",null,[]);
var Hb=d(1158),Ob=d(282);class eb{constructor(){this.pwc=new da.a}lKa(r){this.pwc.add(r)}vcl(r){for(let R of this.pwc)R(r)}}Object(h.a)(eb,"ReactTaskPaneManager",null,[203]);var Eb=d(648),oc=d(141);class Sb extends oa{constructor(r,R,la,Ea,Qa=null,wb=null,Pb,xc=null,ed=null){super(R,la,Ea,wb,void 0,void 0,xc);this.k7e=null;this.Ulf=this.OHd=this.PBc=this.pDc=this.aDc=!1;this.ZMd=null;this.ULd=!!z.AFrameworkApplication.Aa&&!!z.AFrameworkApplication.Aa.hb&&z.AFrameworkApplication.Aa.hb.nme;this.wSb=
this.zpa=null;this.WSb=0;this.Xyc=null;this.pxd=Qa;ed&&(this.zpa=ed.W3h,this.wSb=ed.QYi,this.WSb=ed.Zyj);this.Aqa=new eb}get isVisible(){return this.Ulf}qMb(r){this.Ulf=r}W_d(r){r&&(this.k7e=r,r.IsSuccess&&(this.Hmf=this.gli(r),r.IsPartialResult&&this.Evh(!0)),this.aDc=!0,this.pDc=!1,this.ouc())}Cvh(r){this.isVisible&&r!==this.PBc&&(this.PBc=r,this.ouc())}Evh(r){this.OHd=r;this.ouc()}Ql(){this.pDc||oc.UISurfaces.zr().then(r=>{Ob.a.instance.L2(Sb.Y1a+":PaneOpen:Start");r.showTaskPane(Sb.Y1a,this.Jca());
this.bie();return null});this.isVisible?oc.UISurfaces.zr().then(r=>{r.setSelectedTaskPane(Sb.Y1a);return null}):this.Z3j()}ouc(){oc.UISurfaces.zr().then(r=>{r.updateTaskPane(Sb.Y1a,this.Jca());return null})}Jca(){var r=new Xa;this.Aqa.vcl(r);r=Object.assign(new Eb.a,{title:this.Zba.Sgd,hideHeader:!1,width:320,location:2,contentProps:r,onOpen:()=>{this.ial();this.qMb(!0);z.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.Eod();this.qMb(!1);this.pDc=this.aDc=!1;this.ouc();z.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.ULd&&(r.enableResize=!0,r.minResizeWidth=268,r.maxResizeWidth=920);return r}initialize(r){const R=this.Nd.Fc(Sb.Y1a);R.parent=Pa.AFrame.gj;R.bJ=!0;this.GMa=r;this.k4h()}dispose(){this.xFh();this.zHd&&(this.zHd.dispose(),this.zHd=null);this.PHd&&(this.PHd.dispose(),this.PHd=null);super.dispose()}k4h(){this.Aqa.lKa(this.onRecheckExecute());this.Aqa.lKa(this.n2i());this.Aqa.lKa(this.chj());this.Aqa.lKa(this.onInvokeNavigateExecute());this.Aqa.lKa(this.K$i());this.Aqa.lKa(this.yej());
this.Aqa.lKa(this.afj());this.Aqa.lKa(this.updateLastScanTime());this.Aqa.lKa(this.showHelpPane())}onRecheckExecute(){return r=>{r.onRecheckExecute=()=>{this.bie()}}}n2i(){return r=>{r.accessibilityCheckResultCollection=this.k7e}}chj(){return r=>{r.resultsReady=this.aDc}}onInvokeNavigateExecute(){return r=>{r.onInvokeNavigateExecute=R=>{this.WHj(R)}}}K$i(){return r=>{r.helpLink=this.vUi}}yej(){return r=>{r.outOfSync=this.PBc}}afj(){return r=>{r.partialResult=this.OHd}}updateLastScanTime(){return r=>
{r.updateLastScanTime=R=>{this.ZMd=R}}}showHelpPane(){return r=>{r.showHelpPane=()=>{z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?z.AFrameworkApplication.wsa||this.Oxf()?this.Xyc?this.Xyc():this.zpa.value&&this.wSb&&this.WSb&&this.zpa.value.La(this.WSb,2,this.wSb):this.lwh():this.Oxf()?this.Xyc?this.Xyc():this.zpa.value&&this.wSb&&this.WSb&&this.zpa.value.La(this.WSb,2,this.wSb):this.lwh()}}}Oxf(){return!this.pxd||
!this.pxd.value}lwh(){const r=this.pxd.value;if(r){var R={};R.query=Sb.ZYh+Sb.bCd;R=Object.assign(new Hb.a,{nonPersistedSettings:R});r.gga(Sb.aCd,R)}}bie(){this.OHd=this.PBc=this.aDc=!1;this.ZMd&&this.ZMd();this.ouc();this.pDc=!0;this.GMa.PGe()}ial(){this.Nd.tf(Sb.Y1a)}Eod(){this.mme()&&this.Nd.tf(this.Nd.n8)}mme(){return!!this.Nd.Ae&&this.Nd.Ae.name===Sb.Y1a}}Sb.Y1a="AccessibilityCheckerPane";Sb.bCd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Sb.aCd="FA000000012";Sb.ZYh="AssetID=";Object(h.a)(Sb,"ReactAccessibilityCheckPane",
oa,[]);class qc{constructor(r,R,la){this.W3h=r;this.QYi=R;this.Zyj=la}}Object(h.a)(qc,"HelpPaneProperties",null,[]);var $a=d(104),ab=d(30);class Ib extends Sb{constructor(r,R,la,Ea,Qa,wb,Pb,xc){super(null,R,la,Ea,void 0,null,void 0,void 0,new qc(Pb,Ib.d7d(),ab.a.gga));this.rgc=r;this.g5j=Qa;this.zH=wb;this.eGg=Pb;this.pB=xc}get isVisible(){return!!this.rgc&&this.rgc.isVisible}qMb(r){this.rgc&&(this.rgc.isVisible=r)}get vUi(){return this.g5j}Ql(){this.qMb(!0);this.zH.FM(this.rgc,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
Pa.AFrame.VV);super.Ql();if(this.eGg){var r=this.eGg.value;if(r){r.processAction(ab.a.NNd,1);r=!1;try{this.pB.selectRibbonTabById("AccessibleAuthoring"),r=!0}catch(R){N.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",R.toString())}$a.a("AccessibleAuthoringTab",r)}else N.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else N.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Yed(){}onBeforeLoadContent(){}onAfterLoadContent(){this.GMa&&
this.GMa.yIe()}onAfterFirstSaveContent(){}static d7d(){const r={};r.WE=ResourceStrings.L_Help;r.assetId="FA000000012";r.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return r}}Object(h.a)(Ib,"PptReactAccCheckControl",Sb,[798]);class gc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Zb(r){this.K=r;this.K.register(ia,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().oa(()=>
new ia(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(179,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().oa(()=>new Ib(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.ie("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(178,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().oa(()=>new aa(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Dc(new gc)}}Object(h.a)(gc,"PptAccessibilityPackage",null,[2,3]);var Ta=d(179),Ab=d(1205),kc=d(239),fb=d(180),Qb=d(532),mb=d(52),Jb=d(124);class Ub{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed){this.ia=r;this.la=R;this.h5j=la;this.i5j=Ea;this.Wbb=Qa;this.pB=Pb;this.AXa=wb;this.Ea=xc;this.oc=ed;this.AXa.z9h(Object(m.a)(this,this.$fh,"refreshAccCheckButtonStatus"))}wb(){this.la.powerPointEnableAccCheck&&
(this.ia.ra(ab.a.jLe,mb.a.application,Object(m.a)(this,this.Kqi,"checkAccessibility"),4),this.ia.ra(ab.a.hMk,mb.a.application,Object(m.a)(this,this.DLk,"queryCheckAccessibility"),97))}Ee(){this.la.powerPointEnableAccCheck&&this.Ea.Fc(Jb.a.jBf).bindAction(fb.KeyInputManager.Oa(Ba.a.rvc,fb.KeyInputManager.Oe|1),ab.a.jLe)}Kqi(r,R,la,Ea,Qa){return 1===la?this.oc.pj()?this.i5j.mIj?32:8:8:this.h5j.Ql(r,R,la,Ea,Qa)}DLk(r,R,la,Ea,Qa){Qa[Qb.a.On]=this.Wbb.isVisible;return 32}dispose(){this.AXa.nYk(Object(m.a)(this,
this.$fh,"refreshAccCheckButtonStatus"))}$fh(){this.pB.HH()}}Object(h.a)(Ub,"AccCheckActor",null,[352,106]);class tb{constructor(){this.ybc=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Zb(r){this.K=r}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Pyb(()=>{this.xyb()})}xyb(){const r=this.K.resolve("Common.AFrameworkApplication").FS.od,R=this.K.resolve("Common.IActionManagerExtended");r.powerPointEnableAccCheck&&(this.ybc=new Ub(R,r,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.ybc.wb(),this.ybc.Ee());r.Une&&Ta.a.get_instance().ek(7,Object(m.a)(this,this.Une,"loadInternalSlice"))}Une(){const r=Ab.a.create("pptedit.internal",
null,()=>d.e(17).then(d.bind(null,1250)));kc.a.ey(r)}dispose(){this.ybc&&this.ybc.dispose()}static main(){e.a.instance.Dc(new tb)}}Object(h.a)(tb,"PptLazyActorsPackage",null,[2,3]);var Bc=d(212),Gb=d(582),Hc=d(1208),$b=d(187),lc=d(167),Vb=d(58),ic=d(49),qb=d(68),Wb=d(138),Xc=d(629);class xb extends Xc.a{constructor(){super();this.pe=this.createElement(qb.a.D1e)}gel(r){this.xa.textContent=r}appendChild(r){if(!r.xa||!this.xa)throw Error.argumentNull();this.xa.appendChild(r.xa)}}Object(h.a)(xb,"HTMLText",
Xc.a,[]);var Rb=d(329),wc=d(196);class ud{constructor(r,R,la,Ea,Qa,wb,Pb,xc){this.vd=1;this.UAe=null;this.D0=new $b.a;this.mu=new $b.a;this.tn=null;this.Ro=!1;this.k4c=null;this.oAg="";this.DGa=this.B$=!1;this.jfb=this.kWa=this.Fcb=this.CGa=this.QBb=this.tea=null;this.gVa=!1;this.ta=r;this.zb=R;this.qe=la;this.la=Ea;this.ia=Qa;this.Zc=wb;this.ob=Pb;this.YC=xc}pll(r){this.tea&&this.jfb&&(this.B$=!0,this.jfb.appendChild(this.tea.xa),this.ob.wF(Object(m.a)(this,this.iY,"onSelectionChange")),this.k4c=
new Q.a(3,1,this.la.Kvh,Object(m.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.MGh(r))}UDl(r){this.ta===r&&this.B$&&this.MGh(this.ta.get_alt())}Jm(r){this.jfb=r.xa;this.VCi()}lD(r){if(this.B$&&!this.Ro)switch(r){case 1:r=this.qe.qk("formatpainterobject.cur");this.CGa.nl(ic.a.fQ(r,qb.a.$rc));break;case 0:this.CGa.nl(qb.a.$rc)}}Yp(){return null}LN(){return!1}Ox(r){this.Ro=r}dispose(){this.uNc();this.tea&&(this.kWa=this.Fcb=this.QBb=this.CGa=this.tea=null)}Ty(){}cE(){return null}GB(){return[]}draw(){this.B$&&
this.v4e(!0)}get visible(){return this.DGa}set visible(r){this.B$&&(this.DGa!==r&&(this.DGa=r,this.tea.setVisibility(this.DGa)),this.DGa||this.uNc())}setPosition(){}Ij(r){this.vd=r;this.B$&&(this.did(),this.LGh())}Qq(r){this.D0=r;this.B$&&this.did()}Xu(r){this.mu=r;this.B$&&this.did()}setZIndex(r){this.B$&&this.tea.LB(r)}NE(r,R){this.B$&&(this.v4e(!r&&R||!R),r||this.zb.V5(this.k4c,this.la.Kvh))}setSelection(){}VCi(){this.tea=new Wb.a;this.CGa=new Rb.a;this.CGa.Aoa("ImageDescriptionBarBackground");
this.Zc.pb(ha.a.click,this.CGa.xa,Object(m.a)(this,this.euk,"onImageDescriptonBarClickHandler"));this.QBb=new wc.a;this.QBb.appendChild(this.CGa);this.Fcb=new xb;this.Fcb.ur("ImageDescriptionBarText");this.LGh();this.kWa=new Wb.a;this.kWa.ur("ImageDescriptionBarTextWrappingDiv");this.kWa.appendChild(this.Fcb);this.tea.appendChild(this.QBb);this.tea.appendChild(this.kWa)}MGh(r){const R=r.indexOf("\n");this.oAg=-1===R?r:r.substring(0,R);this.Fcb.gel(ResourceStrings.L_ShapeAltText+": "+this.oAg);this.v4e(!0)}v4e(r){this.tn=
this.ta.fp;this.DGa=r;this.did();this.tea.setVisibility(this.DGa);this.gVa||(this.gVa=!0,this.zb.Db(this.k4c))}LGh(){this.Fcb.xa.style.fontSize=this.YC.kja(29)}euk(){this.ia.processAction(ab.a.xrb,2);return!0}iY(){this.uNc()}dismissImageDescriptionBarTask(){this.uNc()}uNc(){this.B$&&(this.DGa=this.B$=!1,this.ob.aya(Object(m.a)(this,this.iY,"onSelectionChange")),this.gVa&&(this.zb.Lg(this.k4c),this.gVa=!1),this.jfb&&this.jfb.contains(this.tea.xa)&&this.jfb.removeChild(this.tea.xa))}did(){if(this.B$&&
this.tn){var r=this.tn.copy();this.D0.El(r);this.mu.El(r);this.UAe=Gb.a.YO(Vb.a.MG(r.ga(0),r.ga(1)));var R=r.rk(new lc.a(6)),la=r.rk(new lc.a(4));r=r.rk(new lc.a(2));r=Vb.a.nm(la,r)*this.vd;la=Vb.a.nm(R,la)*this.vd;if(60>la||80>r)this.DGa=!1;else{r=this.jfb.children[0].style;this.QBb.setPosition(this.ROb(r.left),this.ROb(r.top));this.QBb.lh(this.ROb(r.width),this.ROb(r.height));var Ea=this.YC.Pe(Hc.a.rf(40,1),1);this.kWa.setPosition(R.x*this.vd,R.y*this.vd-Ea);this.kWa.lh(la,Ea);this.kWa.xa.style.transform=
this.lRa(this.UAe);this.Fcb.lh(la-9,Ea-6);var Qa=new $b.a;Qa.L7(this.UAe,new Vb.a(0,Ea));Qa.eC(R.x*this.vd-this.ROb(r.left),R.y*this.vd-this.ROb(r.top)-Ea);this.CGa.PE(Qa,1);this.CGa.lh(la,Ea)}}}ROb(r){r=parseFloat(r);return isNaN(r)?0:r}lRa(r){return"rotate("+r.toString()+"deg)"}}Object(h.a)(ud,"ImageDescriptionBarView",null,[721,430,431,106]);var uc=d(1019),db=d(47),Yb=d(39);class Zc{constructor(r,R,la,Ea){this.shapeNode=r;this.uPc=R;this.DRj=la;this.imageDescription=Ea}}Object(h.a)(Zc,"ImageDescriptionCache",
null,[]);var Kb=d(219);class Yc{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd){this.U9=new uc.a;this.Fb=r;this.vi=R;this.Nq=Pb;this.xcb=la;this.ob=Ea;this.j0=wb;this.D9j=Qa;this.eu=xc;this.Jb=ed;this.fc=jd;this.Lve=bd}initialize(){this.eu.jk(Object(m.a)(this,this.kh,"onPropertyChanged"));this.Nq.zuf(Object(m.a)(this,this.sHb,"onShapeImageFirstDraw"));this.Nq.p$h(Object(m.a)(this,this.n4g,"onLocalImageViewDismissed"));this.xcb.k$h(Object(m.a)(this,this.M3g,"onImageDescriptionReady"))}dispose(){this.eu.Cm(Object(m.a)(this,
this.kh,"onPropertyChanged"));this.Nq.fRe(Object(m.a)(this,this.sHb,"onShapeImageFirstDraw"));this.Nq.QYk(Object(m.a)(this,this.n4g,"onLocalImageViewDismissed"));this.xcb.MYk(Object(m.a)(this,this.M3g,"onImageDescriptionReady"))}kh(r,R){(r=R.node)&&r.Fj&&(R=R.property,R===Yb.a.alt?((R=Object(D.a)(117,r.sc(this.Fb.Ma)))&&R.BQ&&r.get_alt()&&this.Lve.ZG(r).UDl(r),this.D9j.hCl(r),r.get_alt()&&this.Bqd(r,r.get_alt())):R===Yb.a.zC?r.zC&&(R=Object(D.a)(117,r.sc(this.Fb.Ma)))&&R.BQ&&(this.Lve.ZG(r).visible=
!1):R===Yb.a.ih&&r.ih!==Kb.a.pT&&(R=Object(D.a)(117,r.sc(this.Fb.Ma)))&&R.BQ&&!r.gea&&this.U9.ga(r.id)&&this.U9.ga(r.id).uPc&&(this.cwb(r,R),this.U9.remove(r.id)))}M3g(r,R){if(r=R.iVc){var la=R.confidence,Ea=R.imageDescription,Qa=R.JNj;R=R.uPc;var wb=this.j0.qda(r),Pb=wb?Object(D.a)(117,wb.sc(this.Fb.Ma)):null;R?Pb&&Pb.BQ&&!wb.isLocal&&!wb.zC?this.cwb(wb,Pb):this.U9.add(r,new Zc(wb,!0,!0,Ea)):!Ea||!Qa&&60>la?N.a.J(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Qa,la):(Ea=this.uwi(la,
Ea),Qa?this.TUe(wb,Ea,!1):(N.a.J(34194368,815,50,"Image description ready for show and save"),Pb&&Pb.BQ?(N.a.J(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",r.toString(),(new Date).getTime()),this.Bqd(wb,Ea),wb.isLocal?this.U9.add(r,new Zc(wb,!1,!1,Ea)):(N.a.J(34194372,815,50,"Save image description immediately"),this.TUe(wb,Ea,!0))):this.U9.add(r,new Zc(wb,!1,!0,Ea))))}else N.a.J(33609503,815,15,"Graph node id is null")}sHb(r,R){r=R.iVc;N.a.J(34194374,815,50,
"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",r?r.toString():"",(new Date).getTime());this.U9.Hb(r)?this.hch(r):(r=this.j0.qda(r))&&r.get_alt()&&this.Bqd(r,r.get_alt())}uwi(r,R){R+=String.fromCharCode(10,10);return R=80<=r?R+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=r?R+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=r?R+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=r?R+ResourceStrings.L_ImageDescriptionWithLowConfidence:R+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}n4g(r,
R){(r=R.Kol)&&this.U9.Hb(r.id)&&this.hch(r.id)}hch(r){const R=this.U9.ga(r).shapeNode;if(R){var la=this.U9.ga(r).uPc,Ea=this.U9.ga(r).DRj,Qa=this.U9.ga(r).imageDescription;la?(la=Object(D.a)(117,R.sc(this.Fb.Ma)))&&this.cwb(R,la):(Ea&&this.Bqd(R,Qa),R.isLocal?N.a.J(33609539,815,15,"Try to save alt text for local picture"):this.TUe(R,Qa,!0));this.U9.remove(r)}else N.a.J(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}cwb(r,R){this.vi.generateImageDescription(r.id,R.NZe,
r.get_isSVGBlipFilled(),!1)}TUe(r,R,la){if(!la||!r.get_alt()){var Ea=this.Jb.me(la?7:15);Ea.nc(r);r.C0a=la;r.set_alt(db.a.$Ta(R));Ea.dispose();la&&this.vi.forceOutbound()}}Bqd(r,R){if(r.Fj){this.fc.$c(r)&&N.a.J(34079445,815,50,"Graph node or parents blocked");var la=this.ob.Wd();la&&this.ob.fX(r)?(N.a.J(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",r.id.toString(),(new Date).getTime()),this.Lve.ZG(r).pll(R)):N.a.J(33609543,815,50,"Is selected shapes empty: {0}",
!la)}else N.a.J(33609541,815,50,"ShapeNode.IsPicture: {0}",r.Fj)}}Object(h.a)(Yc,"ImageDescriptionManager",null,[106]);var ec=d(95),rb=d(341),ac=d(60),Jc=d(72),Db=d(35),dd=d(48);class Cd{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce){this.ta=null;this.UT=0;this.i7c=!0;this.Nve=new uc.a(0);this.kF=!!z.AFrameworkApplication.Aa&&!!z.AFrameworkApplication.Aa.hb&&z.AFrameworkApplication.Aa.hb.eX;this.Og=r;this.Rb=R;this.qe=la;this.Ea=jd;this.vi=Ea;this.Zc=Qa;this.ob=wb;this.oE=Pb;this.m0=xc;this.Jb=ed;
this.xcb=bd;this.zH=Ce;this.rb=document.createElement("div");this.rb.className=ac.a.jdg;this.rb.id=ac.a.jdg;this.rb.style.position=Jc.a.Xoa;this.rb.setAttribute(pa.a.ef,pa.a.bCa);this.rb.setAttribute(pa.a.P2,"ImageDescriptionPaneLabel");this.Zc.pb(ha.a.click,this.rb,Object(m.a)(this,this.Tlh,"rootElementClickHandler"));this.m0.addHandler(this.rb,ha.a.Yf,Object(m.a)(this,this.Xta,"inputKeyPressHandler"));this.Eb=!1;this.RGa=ic.a.Ie();this.RGa.className="ImageDescriptionPaneLayoutRoot";this.yo=this.KCa("per",
"ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.yo,"ImageDescriptionPaneCloseButton");this.yo.setAttribute(pa.a.ef,pa.a.yu);this.RGa.appendChild(this.yo);this.Zc.pb(ha.a.click,this.yo,Object(m.a)(this,this.utb,"closeButtonClickHandler"));this.m0.addHandler(this.yo,ha.a.focus,Object(m.a)(this,this.bHb,"onElementFocused"));this.Wdc=ic.a.Ie();this.Wdc.id="ImageDescriptionPaneLabel";this.Wdc.className="PaneLabel";this.Wdc.innerText=ResourceStrings.L_ShapeAltText;this.RGa.appendChild(this.Wdc);
this.Y5c=ic.a.Ie();this.Y5c.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.Y5c.className="ImageDescriptionLabel";this.RGa.appendChild(this.Y5c);this.X5c=ic.a.Ie();this.X5c.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.X5c.className="ImageDescriptionHint";this.RGa.appendChild(this.X5c);this.Mve=ic.a.Ie();this.hJ=document.createElement("textarea");this.hJ.className="AltTextTextArea";this.hJ.setAttribute(pa.a.ns,ResourceStrings.L_ShapeAltText);this.hJ.tabIndex=0;this.Mve.appendChild(this.hJ);
this.RGa.appendChild(this.Mve);this.Zc.pb(ha.a.click,this.hJ,Object(m.a)(this,this.Svf,"altTextboxClickHandler"));this.m0.addHandler(this.hJ,ha.a.Yf,Object(m.a)(this,this.Tvf,"altTextboxTypingHandler"));this.m0.addHandler(this.hJ,ha.a.focus,Object(m.a)(this,this.bHb,"onElementFocused"));r=ic.a.Qn();r.className="GenerateDescriptionButtonText";r.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;r.setAttribute("Unselectable","on");this.ZT=ic.a.Eca();this.ZT.className="ImageDescriptionPaneButton cui-ctl";
this.ZT.setAttribute(pa.a.ef,pa.a.yu);this.ZT.tabIndex=0;this.ZT.appendChild(r);this.RGa.appendChild(this.ZT);this.Zc.pb(ha.a.click,this.ZT,Object(m.a)(this,this.MYf,"generateDescriptionClickHandler"));this.m0.addHandler(this.ZT,ha.a.focus,Object(m.a)(this,this.bHb,"onElementFocused"));this.oE.X8(dd.a.zka,dd.a.gj,this.rb,()=>{this.zU(!0)},()=>{this.zU(!1)},!0);this.oE.X8(dd.a.nQd,dd.a.gj,this.hJ,()=>{this.w3g(!0)},()=>{this.w3g(!1)},!0);this.xcb.N$h(Object(m.a)(this,this.$5g,"onShowHideAltTextPane"))}WDj(){this.Lqi()&&
(this.hJ.disabled=!1,this.hJ.value=this.ta.get_alt(),this.rb.appendChild(this.RGa),this.ZT.style.display=this.ta.isLocal?Jc.a.Gf:Jc.a.Wk,this.Eb=!0,this.rb.style.display=Jc.a.Wk,this.kF?(this.PFc(this.rb),this.zH.FM(this,this.Eb,ResourceStrings.L_ShapeAltText,dd.a.zka)):this.Rb.Oq(),this.ob.wF(Object(m.a)(this,this.iY,"onSelectionChange")),N.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.DJc();this.xcb.fZk(Object(m.a)(this,this.$5g,"onShowHideAltTextPane"));this.Zc.yb(ha.a.click,
this.rb,Object(m.a)(this,this.Tlh,"rootElementClickHandler"));this.m0.removeHandler(this.rb,ha.a.Yf,Object(m.a)(this,this.Xta,"inputKeyPressHandler"));this.Zc.yb(ha.a.click,this.yo,Object(m.a)(this,this.utb,"closeButtonClickHandler"));this.m0.removeHandler(this.yo,ha.a.focus,Object(m.a)(this,this.bHb,"onElementFocused"));this.Zc.yb(ha.a.click,this.hJ,Object(m.a)(this,this.Svf,"altTextboxClickHandler"));this.m0.removeHandler(this.hJ,ha.a.Yf,Object(m.a)(this,this.Tvf,"altTextboxTypingHandler"));this.m0.removeHandler(this.hJ,
ha.a.focus,Object(m.a)(this,this.bHb,"onElementFocused"));this.Zc.yb(ha.a.click,this.ZT,Object(m.a)(this,this.MYf,"generateDescriptionClickHandler"));this.m0.removeHandler(this.ZT,ha.a.focus,Object(m.a)(this,this.bHb,"onElementFocused"));this.ZT=this.hJ=this.Mve=this.X5c=this.Y5c=this.Wdc=null;N.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}hCl(r){this.ta&&r===this.ta&&this.Eb&&(this.Nve.Hb(r.id.toString())&&this.ta.ih!==this.Nve.ga(r.id.toString())&&N.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),
2!==this.UT&&(this.hJ.value=this.ta.get_alt()))}layout(r,R){const la=R?r.oD(this.width):r.pD(this.width);this.Eb&&(R?(Sys.UI.DomElement.addCssClass(this.rb,ac.a.ldg),la.oD(ac.a.ide)):(Sys.UI.DomElement.addCssClass(this.rb,ac.a.kdg),la.pD(ac.a.ide)));ic.a.t1(this.rb,la);return r}get isVisible(){return this.Eb}get xa(){return this.rb}get order(){return 10}zU(r){this.Eb&&(r?0===this.UT&&this.CDh():this.UT=0)}w3g(r){this.Eb&&(r||this.AVe(),this.Rb.updateCommandUI())}Tvf(r){r.keyCode===Ba.a.eZ&&r.ctrlKey?
this.LLb():(2!==this.UT&&this.Rph(),this.UT=2)}Xta(r){this.Eb&&(r.keyCode===Ba.a.tq||r.keyCode===Ba.a.pP?1===this.UT?this.WK():3===this.UT?this.cwb():2===this.UT&&(this.ZT.style.display=Jc.a.Wk):2===this.UT&&(this.ZT.style.display=Jc.a.Wk))}CDh(){ec.FocusManager.Wr(this.yo)?(this.LLb(),this.UT=1):N.a.J(512233505,815,50,"Fail to set focus on close button")}LLb(){this.Ea.iD(dd.a.zka)}Rph(){this.Ea.iD(dd.a.nQd)}Lqi(){const r=this.ob.Wd();if(!r||1<r.length||!r[0].Fj)return N.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",
!r),!1;this.ta=r[0];return!0}utb(){this.WK();return!0}WK(){this.Eb&&(this.DJc(),this.Ea.Cj(dd.a.zka,!1),N.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}Tlh(){this.Eb&&(this.LLb(),this.UT=0);return!0}Svf(){this.Rph();this.UT=2;return!0}MYf(){this.LLb();this.cwb();return!0}cwb(){this.UT=3;this.ZT.style.display=Jc.a.Gf;this.CDh();const r=this.ta?Object(D.a)(117,this.ta.sc(0)):null;r?(this.Nve.add(this.ta.id.toString(),this.ta.ih),
this.vi.generateImageDescription(this.ta.id,r.NZe,this.ta.get_isSVGBlipFilled(),!0)):N.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ta)}$5g(){this.Eb?this.DJc():(this.WDj(),this.UT=0);this.Ea.Cj(dd.a.zka,this.Eb);N.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Eb)}iCl(r){r=r.Wd();this.i7c&&this.AVe();1===r.length&&r[0].Fj?(this.ta=r[0],this.i7c=!0,this.hJ.value=this.ta.get_alt(),this.hJ.disabled=!1,this.ZT.style.display=
this.ta.isLocal?Jc.a.Gf:Jc.a.Wk):(this.ZT.style.display=Jc.a.Gf,this.hJ.disabled=!0,this.hJ.value=null,this.i7c=!1)}iY(r){Db.a("ChangePictureAltTextFixEnabled")?this.iCl(r):this.DJc();this.Og.Ko(dd.a.zka)}bHb(r){this.Eb&&(r.target===this.yo?this.UT=1:r.target===this.hJ?this.UT=2:r.target===this.ZT&&(this.UT=3))}DJc(){this.Eb&&(this.ob.aya(Object(m.a)(this,this.iY,"onSelectionChange")),this.i7c&&this.AVe(),this.Eb=!1,this.rb.removeChild(this.RGa),this.rb.style.display=Jc.a.Gf,this.kF?(this.PFc(this.rb),
this.zH.FM(this,this.Eb,ResourceStrings.L_ShapeAltText,dd.a.zka)):this.Rb.Oq(),N.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}PFc(r){z.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(r,ac.a.ldg):Sys.UI.DomElement.addCssClass(r,ac.a.kdg)}AVe(){const r=this.hJ.value;if(!(Db.a("ChangePictureAltTextFixEnabled")&&null===r||r===this.ta.get_alt())){var R=this.Jb.me(15);R.nc(this.ta);this.ta.C0a=!1;this.ta.set_alt(r);R.dispose()}}KCa(r,R){return this.JCa(r,"cui-img-16by16","cui-ctl-iconContainer",
R,CommonUIStrings.l_DialogClose,null)}JCa(r,R,la,Ea,Qa,wb){const Pb=ic.a.RA();Pb.alt=Qa;Pb.className=Fa.getImageClassWithCluster(r,Ea);Pb.src=this.qe.qk(r+".png");Pb.setAttribute("Unselectable","on");r=ic.a.Qn();r.className=R+" cui-img-cont-float";r.appendChild(Pb);R=ic.a.Qn();R.className=la;R.setAttribute("Unselectable","on");R.appendChild(r);la=ic.a.Eca();la.className="ImageDescriptionPaneNoBorderButton cui-ctl";la.title=Qa;la.setAttribute(pa.a.ef,pa.a.yu);la.tabIndex=0;la.appendChild(R);wb&&(Qa=
ic.a.Qn(),Qa.className="cui-ctl-mediumlabel",Qa.setAttribute("Unselectable","on"),Qa.innerText=wb,la.appendChild(Qa));return la}get width(){return this.Eb?ac.a.sBj+ac.a.ide+rb.a.HKa:0}}Object(h.a)(Cd,"ImageDescriptionPane",null,[699,718,106]);var pd=d(280);class Ge{constructor(){this.K=null;this.kF=!!z.AFrameworkApplication.Aa&&!!z.AFrameworkApplication.Aa.hb&&z.AFrameworkApplication.Aa.hb.eX}get name(){return"PowerPointWebEditor.ImageDescription"}Zb(r){this.K=r;this.K.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().oa(()=>
new pd.a(R=>{let la=null;const Ea=Object(D.a)(117,R.sc(r.resolve("Box4.IPageView").Ma));Ea&&!Ea.Al&&(la=new ud(R,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Ld),la.Jm(Ea.SU),Ea.rra(la,4));return la}));this.K.register(699,"PowerPointWebEditor.IImageDescriptionPane").ma().oa(()=>
new Cd(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Yc,"PowerPointWebEditor.ImageDescriptionManager").ma().oa(()=>new Yc(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),
this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").EUa&&
(this.kF||this.K.resolve("PowerPointWebEditor.IPaneManager").RP(this.K.resolve("PowerPointWebEditor.IImageDescriptionPane")),this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").EUa&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Dc(Bc.a(new Ge,0))}}Object(h.a)(Ge,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var kd=d(82);class Xf extends kd.a{constructor(r){super(!1,
!1,!0);this.Cvc=r}start(){const r={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.Cvc.Vce}};this.Zi("",Object(m.a)(this,this.Y2k,"resultHandler"),r)}Y2k(r,R){1===r&&(this.Cvc.Vce=R.tooltipPersistenceEnabled)}}Object(h.a)(Xf,"AccessibilitySettingsDialog",kd.a,[]);class Kd{constructor(r,R){this.Ca=r;this.Cvc=R}wb(){this.Ca.ya(u.a.Sjl,E.a.frame,Object(m.a)(this,this.Tjl,"showAccessibilitySettingsDialogHandler"))}Tjl(){(new Xf(this.Cvc)).start();return 32}}Object(h.a)(Kd,
"AccessibilitySettingsDialogActor",null,[771]);var lg=d(1062);const ve=r=>{const R=new lg.a;z.AFrameworkApplication.Ke.mj(Ua(r),1,null,null,!0,2,la=>{200===la.data.oe?R.Gg("true"===la.data.Sd.toLowerCase()):R.Gg(!1)},()=>{R.Gg(!1)},null,void 0,void 0,void 0,void 0,"7");return R.task},Ua=r=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",z.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",r,z.AFrameworkApplication.gh);var Bb=d(71);class mc{constructor(){this.job=
null}get Vce(){return!!this.job}set Vce(r){r!==this.job&&(this.job=r,Bb.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(r),this.Klg()&&z.AFrameworkApplication.Ke.mj(Ua("saveHoverableRibbonTooltipIsEnabled"),2,r.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}$_j(){const r=new lg.a;if(this.job)r.Gg(this.job);else if(this.Klg()){const R=ve("getHoverableRibbonTooltipIsEnabled");R.continueWith(()=>{this.job=R.result;Bb.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(R.result);r.Gg(R.result)},8)}else r.Gg(!1)}Klg(){const r=z.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),R=z.AFrameworkApplication.fa.ka("IsAnonymousUser");return r&&!R}}Object(h.a)(mc,"AccessibilitySettingsInfo",null,[761]);class Nc{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}Zb(r){this.Da=r;this.Da.register(mc,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").oa(()=>
new mc).ma();this.Da.register(Kd,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").oa(()=>new Kd(z.AFrameworkApplication.Ta,this.Da.ub("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const r=this.Da.ub("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),R=this.Da.ub("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");r&&R?(R.wb(),r.$_j()):S.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Dc(new Nc)}}Object(h.a)(Nc,"AccessibilitySettingsPackage",null,[2,3]);var nd=d(93),Dd=d(220),La=d(1129),gb=d(80),vc=d(709);class td extends Oa.StandardDialog{constructor(r,R,la,Ea=null){super();this.B2=this.hs=this.vNa=null;this.dw=[];this.bCc=R;this.GP=r;this.ySh=la;this.ADc=Ea;this.nqb=new vc.a("LoadResource","LoadPrintablePdf")}Cja(){this.xd=
5;this.width=40;const r=document.createElement("span");r.id=this.Nh("DirectPrintHeaderContent");const R=document.createElement("span");R.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(R,"DirectPrintHeader");this.B2=document.createElement("iframe");this.B2.name="pdfObjectFrame";this.B2.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.B2.onload=Object(m.a)(this,this.tJk,"printablePdfLoaded");if(this.ADc&&0<this.ADc.count){var la=gb.a.b9d(this.bCc,this.ADc);const Ea=
gb.a.JQe(this.bCc,this.ADc);this.hs=document.createElement("form");this.hs.id="printPreviewPostForm";this.hs.method="POST";this.hs.target=this.B2.name;this.hs.action=Ea;for(let Qa of la)la=document.createElement("input"),la.type="hidden",la.name=Qa.key,la.value=Qa.value,this.hs.appendChild(la)}else this.B2.setAttribute("src",this.bCc);Sys.UI.DomElement.addCssClass(this.B2,Dd.a.Ljf);this.ySh?(Sys.UI.DomElement.addCssClass(this.B2,"DirectPrintPdfObjectHidden"),R.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
pa.a.eP(this.B2,pa.a.QK,pa.a.gC)):(Sys.UI.DomElement.addCssClass(this.B2,"DirectPrintPdfObject"),this.dw.push(this.B2));r.appendChild(R);r.appendChild(document.createElement("br"));r.appendChild(this.B2);this.hs&&r.appendChild(this.hs);r.appendChild(document.createElement("br"));r.appendChild(this.Syi(this.hs?"#":this.bCc));this.nqb.start();this.cGb(CommonUIStrings.l_AppTitle,null,null,null,null,r);this.c6(this.Nh("DirectPrintHeaderContent"));this.hs&&this.hs.submit();this.vDi();n.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}Syi(r){const R=document.createElement("span");var la=document.createElement("span");la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;R.appendChild(la);z.AFrameworkApplication.fa&&(2===z.AFrameworkApplication.Aa.hb.Uk&&z.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===z.AFrameworkApplication.Aa.hb.Uk&&z.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(r=document.createElement("span"),2===
z.AFrameworkApplication.Aa.hb.Uk?r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===z.AFrameworkApplication.Aa.hb.Uk&&(r.innerText=CommonUIStrings.l_InternalError_Directive,n.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.vNa=r,R.appendChild(document.createElement("br")),R.appendChild(r)):(la=document.createElement("a"),la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,la.href=r,la.target="_blank",la.id="PrintPDFLink",la.className=
"AllowBrowserClick",this.vNa=la,R.appendChild(document.createElement("br")),R.appendChild(la),this.hs&&nd.a.addHandler(la,"click",Object(m.a)(this,this.LIe,"onSubmit")),this.GP.pb(ha.a.click,this.vNa,Object(m.a)(this,this.VPf,"downloadPDFLinkClicked"),null));this.dw.push(this.vNa);return R}LIe(r){this.hs&&(this.hs.target="_blank",this.hs.submit());r.preventDefault()}vDi(){if(0<this.dw.length){const r=new La.a(this.dw),R=ec.FocusManager.instance().yl();R&&(this.vNa.focus(),R.vj=r,R.nX=!0)}}VPf(){n.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}Rbb(){n.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}tJk(){n.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.nqb&&this.nqb.stop()}dispose(){this.vNa&&(this.GP.yb(ha.a.click,this.vNa,Object(m.a)(this,this.VPf,"downloadPDFLinkClicked")),this.vNa=null);ka.a.$O(this.B2);this.B2=null;super.dispose()}}Object(h.a)(td,"DirectPrintDialog",Oa.StandardDialog,[840]);class Nd{constructor(r){this.GP=
r}h8i(r,R){return new td(this.GP,r,R,null)}}Object(h.a)(Nd,"DirectPrintDialogFactory",null,[803]);var Od=d(1199),Oc=d(65);class Af{constructor(r,R){this._url=r;this.wXh=R}yPf(){this.wXh?Oc.a.downloadFile(this._url):Oc.a.vn(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(h.a)(Af,"OpenUrlInTabDialogDownloadBehavior",null,[826,106]);var Ae=d(55);class Ye extends Oa.StandardDialog{constructor(r,R=!0,la=!1,Ea=null,Qa=null,wb=!1){super();this.$nb=this.Znb=this.hs=
this.Jba=null;var Pb=this.V1e?this.V1e:CommonUIStrings.l_DefaultDialogTitle;Ye.ayb=wb;this.fAd=Ea||new Af(r,!0);const xc=[],ed=[];Ye.Q1&&(this.QGc&&this.QGc.forEach(Ce=>{Array.add(xc,Ce)}),this.hvf&&this.hvf.forEach(Ce=>{Array.add(ed,Ce)}));R?la?(this.xd=4,this.Xe(1,this.buttonText),this.Xe(2,CommonUIStrings.l_DialogClose)):(this.xd=6,this.Xe(0,CommonUIStrings.l_DialogClose)):this.xd=5;wb=document.createElement("span");this.K1b&&(wb.className=this.K1b);Ea=document.createElement("a");Ea.innerText=
this.RAb;Ea.href=r;Ea.target="_blank";Ea.id=this.Vac;Ea.className=Pa.AFrame.Nvf;var jd=!Ae.a.wT&&!!Qa&&0<Qa.count;if(jd){const Ce=gb.a.b9d(r,Qa);Qa=gb.a.JQe(r,Qa);Ea.href="#";Ea.target="_self";this.hs=document.createElement("form");this.hs.id="printPreviewPostForm1";this.hs.method="post";this.hs.target="_blank";this.hs.action=Qa;for(var bd of Ce)Qa=document.createElement("input"),Qa.type="hidden",Qa.name=bd.key,Qa.value=bd.value,this.hs.appendChild(Qa)}else this.hs=null;this.hs||Ye.ayb?Ye.ayb||Array.add(ed,
{["type"]:"AppLinkProps",["id"]:this.Vac,["text"]:this.RAb,["onExecute"]:()=>{this.bfh()}}):Array.add(ed,{["type"]:"AppLinkProps",["id"]:this.Vac,["text"]:this.RAb,["handler"]:{["href"]:jd?"#":r,["target"]:jd?"_self":"_blank"}});this.dna&&Array.add(xc,this.dna);la?(r=document.createElement("span"),r.innerText=this.dna.replace("{0}",""),wb.appendChild(r)):this.RYg?(r=document.createElement("span"),r.id=this.Nh("message"),bd=document.createElement("span"),Qa=document.createElement("span"),jd=this.dna.split("{0}"),
bd.innerText=jd[0],Qa.innerText=jd[1],r.appendChild(bd),r.appendChild(Ea),r.appendChild(Qa),wb.appendChild(r)):(r=document.createElement("span"),r.innerText=this.dna,wb.appendChild(r),wb.appendChild(document.createElement("br")),wb.appendChild(document.createElement("br")),wb.appendChild(Ea),Ye.ayb||Array.add(xc,"{0}"));this.hs&&wb.appendChild(this.hs);Ye.Q1&&(this.tVa&&(this.Sac?this.tsf(this.tVa,this.Sac):(Array.add(xc,"{0}"),Array.add(ed,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.tVa,
["onExecute"]:()=>{this.C1c()}}))),this.MFc(xc,ed));this.cGb(Pb,null,this.Zce,null,Object(m.a)(this,this.j3,"dialogHandler"),Ye.Q1?null:wb);this.c6(this.Nh("message"));!Ye.Q1&&this.Sac&&this.tVa&&(Pb=document.createElement("div"),Pb.className="WACDialogLearnMoreLinkContainer",this.Jba=document.createElement("a"),this.Jba.innerText=this.tVa,this.Jba.href=this.Sac,this.Jba.target="_blank",this.Jba.id=this.Nh("LearnMoreLinkId"),this.Jba.className=Pa.AFrame.Nvf,Pb.appendChild(this.Jba),R?this.Gb.insertBefore(Pb,
this.Gb.lastChild):this.Gb.appendChild(Pb),this.c6(String.format("{0} {1}",this.Nh("message"),this.Nh("LearnMoreLinkId"))));this.NRb=Ea;la?this.HR(this.wD):this.HR(this.NRb);this.kbc();z.AFrameworkApplication.Aa.TR.pb(ha.a.click,this.NRb,Object(m.a)(this,this.UPf,"downloadLinkClicked"),null);this.Jba&&z.AFrameworkApplication.Aa.TR.pb(ha.a.click,this.Jba,Object(m.a)(this,this.C1c,"learnMoreLinkClicked"),null);this.caf=!1}get Zce(){return null}get V1e(){return null}get dna(){return null}get Sac(){return null}get tVa(){return null}get RYg(){return!1}get buttonText(){return CommonUIStrings.l_Open}get K1b(){return null}get QGc(){return null}get hvf(){return null}X7(){this.hs&&
(this.Znb||(this.Znb=Object(m.a)(this,this.cqk,"onActionButtonClicked"),this.yn.pb(ha.a.click,this.wD,this.Znb)),this.$nb||(this.$nb=Object(m.a)(this,this.dqk,"onActionButtonKeyUp"),this.Rg.pb(ha.a.Il,this.wD,this.$nb)));super.X7()}cqk(r){this.mTf(r);return!0}dqk(r){return this.Z0c(r,Object(m.a)(this,this.mTf,"executeDismissActionButtonFromArgs"))}mTf(r){this.hs&&this.hs.submit();this.t8a(r.Ec)}Rbb(){}UPf(){this.mbc();this.hs?this.hs.submit():this.fAd.yPf();return!0}C1c(){return!1}dispose(){this.fAd.dispose();
this.NRb&&(z.AFrameworkApplication.Aa.TR.yb(ha.a.click,this.NRb,Object(m.a)(this,this.UPf,"downloadLinkClicked")),this.NRb=null);this.Jba&&(z.AFrameworkApplication.Aa.TR.yb(ha.a.click,this.Jba,Object(m.a)(this,this.C1c,"learnMoreLinkClicked")),this.Jba=null);this.yn&&this.Znb&&(this.yn.yb(ha.a.click,this.wD,this.Znb),this.Znb=null);this.Rg&&this.$nb&&(this.Rg.yb(ha.a.Il,this.wD,this.$nb),this.$nb=null);super.dispose()}bfh(){this.hs&&(document.body.appendChild(this.hs),this.hs.submit(),document.body.removeChild(this.hs))}j3(r){1===
r&&(this.Rbb(),this.hs?Ye.Q1&&this.bfh():this.fAd.yPf());this.dispose()}static get Q1(){return z.AFrameworkApplication.Aa.hb.GC&&z.AFrameworkApplication.Aa.hb.wlg}static get ayb(){return Ye.gdf}static set ayb(r){Ye.gdf=r}}Ye.gdf=!1;Object(h.a)(Ye,"ADialogWithLinkToResource",Oa.StandardDialog,[]);class Wd extends Ye{constructor(r,R,la=null,Ea=!0,Qa=!1){super(r,!0,!(Wd.L1a&&Ea),new Af(r,R),la,Qa);Wd.L1a=Wd.L1a&&Ea;if(Wd.L1a){R=document.createElement("iframe");Ea=null;Qa=this.dMi;R.name="pdfObjectFrame";
R.id="pdfObjectIFrame";if(la&&0<la.count){const wb=gb.a.b9d(r,la);r=gb.a.JQe(r,la);Ea=document.createElement("form");Ea.id="printPreviewPostForm";Ea.method="POST";Ea.target=R.name;Ea.action=r;for(let Pb of wb)r=document.createElement("input"),r.type="hidden",r.name=Pb.key,r.value=Pb.value,Ea.appendChild(r)}else R.src=r;Qa.appendChild(R);Ea&&(Qa.appendChild(Ea),Ea.submit());Sys.UI.DomElement.addCssClass(R,"DirectPrintPdfObjectHidden");pa.a.eP(R,pa.a.QK,pa.a.gC)}}get Zce(){return"Print_32x32x32"}get V1e(){return Wd.L1a?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get dna(){return Wd.L1a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get QGc(){const r=[];Array.add(r,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Ye.ayb){let R=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==z.AFrameworkApplication.Aa.hb.ZLf&&(R=z.AFrameworkApplication.Aa.hb.ZLf);Array.add(r,R)}return Wd.L1a?r:null}get RAb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Vac(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get K1b(){return z.AFrameworkApplication.usa?
"UIFontDialogTextLarge":null}kbc(){n.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}mbc(){z.AFrameworkApplication.jj.bab(9540,1);n.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Rbb(){n.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get L1a(){return!!z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.GC&&z.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Ae.a.wT||Ae.a.Ej||Ae.a.eg||Ae.a.L$b)&&!z.AFrameworkApplication.oac&&
z.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set L1a(r){}}Object(h.a)(Wd,"PrintDialogWithLinkToPdf",Ye,[]);class je{constructor(r){this.isEnabled=Boolean.parse(r.DirectPrintIsEnabled||"false");this.uSj=Boolean.parse(r.DirectPrintProbeIsEnabled||"false");this.TOj=Boolean.parse(r.DirectPrintEnabledForInternetExplorer||"false");this.Pkb=(r.DirectPrintSupportedMimeTypes||"").split(je.A_d);this.V0a=(r.DirectPrintSupportedPlugins||"").split(je.A_d);this.TBj=(r.DirectPrintImmersivePreviewPlugins||
"").split(je.A_d);this.Vhg=Boolean.parse(r.DirectPrintEnabledForEdge||"false");this.yKj=Boolean.parse(r.ChromePrintLayoutFixIsEnabled||"false");this.ssi=parseInt(r.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.fEe=14;this.TYg=14394;if(r=r.DirectPrintMinimalSupportedEdgeVersion){const R=r.split(".");2===R.length?(this.fEe=parseInt(R[0]),this.TYg=parseInt(R[1])):n.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",r)}else n.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}je.A_d=",";Object(h.a)(je,"DirectPrintBrsSettings",null,[]);class dg{constructor(r,R){this.Z_e=r;this.V0a=R}}Object(h.a)(dg,"DirectPrintProbeResults",null,[]);var nf=d(201),Cb=d(105);class Cf{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd){this.hFc=null;this.fQh=r;this.YUb=R;this.yGd=la;this.NTh=Ea;this.HUh=Qa;this.MVb=new Od.a(Object(m.a)(this,this.Wfj,"getProbeResults"));this.Kzd=wb;this.vhf=ed;this.pLd=Pb;this.IUh=
xc;this.WUh=jd}get aL(){return this.fQh}start(){}GJk(){this.aL.uSj&&this.z3j()}GMk(){const r=Array(this.aL.Pkb.length);if(void 0!==this.YUb&&null!==this.YUb)for(let R=0;R<this.aL.Pkb.length;R++)r[R]=this.aL.Pkb[R]in this.YUb&&this.NTh(this.YUb[this.aL.Pkb[R]]);return r}HMk(){const r=Array(this.aL.V0a.length),R=!(void 0===this.yGd||null===this.yGd);for(let la=0;la<this.aL.V0a.length;la++){const Ea=this.aL.V0a[la];r[la]=R&&Ea in this.yGd?!0:this.HUh(Ea)}return r}mlj(){const r=this.GMk(),R=Array(r.length);
for(let la=0;la<r.length;la++)R[la]=r[la]?this.FUi(this.YUb[this.aL.Pkb[la]]):null;return R}FUi(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name}z3j(){n.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.MVb.value.Z_e,this.MVb.value.V0a)}Wfj(){var r=this.mlj();const R=this.HMk(),la={},Ea={};for(let Qa=0;Qa<this.aL.Pkb.length;Qa++)la[this.aL.Pkb[Qa]]=r[Qa];for(r=0;r<this.aL.V0a.length;r++)Ea[this.aL.V0a[r]]=R[r];return new dg(la,Ea)}Kjl(){return this.WUh||
!this.aL.isEnabled||z.AFrameworkApplication.oac?!1:this.Prl()}Uuh(){if(null!=this.hFc)return this.hFc;const r=Cf.Thg(this.aL);return this.hFc=this.aL.Vhg&&r||this.vKj()}vKj(){return Ae.a.Tj&&this.aL.yKj&&Ae.a.BJc>=this.aL.ssi?!0:!1}Prl(){if(!this.IUh(this.aL))return!1;var r=Cb.a.oae(this.MVb.value.Z_e);for(const R of r)if(void 0!==R&&null!==R)return!0;r=Cb.a.oae(this.MVb.value.V0a);for(const R of r)if(R)return!0;return!1}Nxj(){const r=Cb.a.oae(this.MVb.value.Z_e);for(const R of r)if(nf.a.contains(this.aL.TBj,
R))return!0;return!1}Wvh(r){z.AFrameworkApplication.Aa&&z.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.vhf(r,null):this.Kjl()?this.nNi(r,this.Nxj()&&!0):this.vhf(r,null)}nNi(r,R){const la=this.pLd.Ci("UserAction","OpenDirectPrintDialog");this.Kzd.h8i(r,R).Cja();la.stop()}static eVj(r){try{return new ActiveXObject(r),!0}catch(R){n.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1}static AMj(r){return void 0===r||null===
r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)}static create(r){const R=new je(z.AFrameworkApplication.fa.appSettings);let la=null;try{la=window.navigator.mimeTypes}catch(jd){n.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let Ea=null;try{Ea=window.navigator.plugins}catch(jd){n.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Qa=Cf.AMj,wb=Cf.eVj;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Pb=z.AFrameworkApplication.Aa.gV,
xc=Cf.fVj,ed=!!z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.GC&&!z.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new Cf(R,la,Ea,Qa,wb,r,Pb,xc,(jd,bd)=>new Wd(jd,!1,bd,!0,ed),z.AFrameworkApplication.isEmbedded)}static fVj(r){return Ae.a.Tj||Ae.a.Ej&&r.TOj||r.Vhg&&Cf.Thg(r)?!0:!1}static Thg(r){var R=Ae.a.ARa;if(R){var la=R.split(".");if(2===la.length)return R=parseInt(la[0]),la=parseInt(la[1]),R>r.fEe||R===r.fEe&&la>=r.TYg}return!1}}Object(h.a)(Cf,"DirectPrintManager",
null,[751]);class of{constructor(){this.U$e=this.Da=null}get name(){return"Common.App.DirectPrint"}Zb(r){this.Da=r;r.register(Nd,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().oa(()=>new Nd(z.AFrameworkApplication.Aa.TR));r.register(751,"Common.App.DirectPrint.IDirectPrintManager").ma().oa(()=>Cf.create(this.Da))}init(){this.U$e=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.U$e.start()}dispose(){}}Object(h.a)(of,"PackageManager",null,[2,3]);var Lg=d(1132),vd=d(304);class Lh{constructor(r,
R){this.eSb=null;this.Ca=r;this.$a=R}wb(){(this.eSb=this.$a.Ga("StatusBarEnvironmentNameToUse"))&&""!==this.eSb&&this.Ca.ra(u.a.tNe,E.a.frame,Object(m.a)(this,this.wDl,"updateEnvironmentName"),96)}wDl(r,R,la,Ea,Qa){if(1===la)return 32;Qa[Lg.a.Value]=this.eSb;Qa[vd.a.labelText]=this.eSb;Qa[Lg.a.Visible]=!0;return 32}}Object(h.a)(Lh,"DisplayEnvironmentName",null,[]);class tf{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}Zb(r){this.Da=r;this.Da.register(Lh,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().oa(()=>
new Lh(z.AFrameworkApplication.Ta,z.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").wb()}dispose(){}static main(){e.a.instance.Dc(new tf)}}Object(h.a)(tf,"DisplayEnvironmentNamePackage",null,[2,3]);var Ue=d(174),ff=d(551);class Ef extends ff.a{constructor(r){super(r)}get e1b(){return!1}createElement(){const r=document.createElement("link");r.setAttribute("rel","stylesheet");r.setAttribute("type","text/css");r.setAttribute("href",this.yt);
return r}DLc(){return null}goc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.CM.yt)}}Object(h.a)(Ef,"CssResource",ff.a,[]);var wh=d(284),xh=d(2);class qd{constructor(){this.nCc=this.vyc=null}X_j(){this.vyc||(n.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.vyc=xh.Task.WAA(qd.f0j(),qd.M_j()),this.vyc.continueWith(r=>{n.ULS.sendTraceTag(21030599,324,10,"{0}",db.a.J6d(r.Yi))},5));return this.vyc}Y_j(){if(!this.nCc)try{n.ULS.sendTraceTag(39978390,
324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.nCc=xh.Task.WAA(qd.l1d(wh.a.create(z.AFrameworkApplication.fa.Ga("DimeUrl"),null,null))),this.nCc.continueWith(r=>{n.ULS.sendTraceTag(39978391,324,10,"{0}",db.a.J6d(r.Yi))},5)}catch(r){n.ULS.sendTraceTag(594874951,324,10,"{0}",db.a.J6d(r))}return this.nCc}static f0j(){var r=qd.MUc("inproductmessaging.js");r=wh.a.create(r,null,null);return qd.l1d(r)}static M_j(){var r=qd.MUc("inproductmessaging.css");r=new Ef(r);return qd.l1d(r)}static MUc(r){return Ue.a.y0b(String.format("ipm/{0}",
r))}static l1d(r){kc.a.ey(r);return r.XFa}}Object(h.a)(qd,"DependencyDownloader",null,[775]);class Hf{}Hf.TAk="inProductMessagingOverlayDiv";Hf.REk="PlayButtonImage";Hf.h0k="ReplayButtonImage";Object(h.a)(Hf,"Constants",null,[]);class Ag{constructor(){this.yof=this.Pif=this.e8e=!0;this.i0k=this.SEk=null;this.mnk=!1;this.locale=null;this.XEh={}}get autoPlay(){return this.e8e}set autoPlay(r){this.e8e=r}get oZg(){return this.Pif}set oZg(r){this.Pif=r}get Nvh(){return this.yof}set Nvh(r){(this.yof=r)&&
this.fcl()}fcl(){this.Ltf(Hf.REk,this.SEk);this.Ltf(Hf.h0k,this.i0k)}Ltf(r,R){R&&(this.XEh[r]=R)}}Object(h.a)(Ag,"FirstRunExperienceUISettings",null,[774]);class He{constructor(){this.completed=this.ZVk=!1}}Object(h.a)(He,"FirstRunExperienceViewData",null,[772]);var af=d(192);class yd{constructor(r,R,la){this.Ca=r;this.Rh=R;this.nzc=la}wb(){this.Ca.ra(u.a.UYi,E.a.frame,Object(m.a)(this,this.TYi,"firstRunExperienceHandler"),64);this.Ca.ya(u.a.GWf,E.a.frame,Object(m.a)(this,this.$Bj,"inProductMessagingTabHandler"));
this.Ca.ya(u.a.FWf,E.a.frame,Object(m.a)(this,this.ZBj,"inProductMessagingShiftTabHandler"));this.Ca.ya(u.a.AMi,E.a.frame,Object(m.a)(this,this.BMi,"dimeLaunchHandler"));this.Ca.ya(u.a.Ljh,E.a.frame,af.ActionManager.Mg);this.Ca.ya(u.a.B0k,E.a.frame,af.ActionManager.Mg);this.Ca.ya(u.a.C0k,E.a.frame,af.ActionManager.Mg);this.Rh&&this.Rh.updateCommandUI()}TYi(r,R,la,Ea,Qa){2===la&&this.nzc.aZj(Qa);return 32}BMi(r,R,la,Ea,Qa){2===la&&this.nzc.$Yj(Qa);return 32}$Bj(r,R,la){return 2===la?this.nzc.IEe():
32}ZBj(r,R,la){return 2===la?this.nzc.AEe():32}}Object(h.a)(yd,"InProductMessagingActor",null,[]);class me{constructor(){this.Tgh=this.W5=this.NAh=this.z1c=this.instance=null}}Object(h.a)(me,"DimeExperienceUISettings",null,[]);var Ic=d(522);class Fe{constructor(r,R,la,Ea,Qa){this.NQc=!1;this.q2b=null;this.Ca=r;this.C5a=R;this.XCc=la;this.Vga=Ea;this.Uga=Qa}BEj(r){Bb.b("getHeaderApi")?r.isFeatureEnabled("MsoPremiumBadge",!0).then(R=>{const la=r.isFreemiumUpsellEnabled();la&&(appChrome.getHeaderApi().then(Ea=>
{Ea.updatePremiumStatus(R,la);return null}),r.rib("MsoPremiumBadge",Ea=>{appChrome.getHeaderApi().then(Qa=>{Qa.updatePremiumStatus(Ea.isEnabled,la);return null})}));return null}):n.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}aZj(r){this.XCc.X_j().continueWith(()=>{this.C5a.Nml(r)})}$Yj(r){let R="gopremium",la=null,Ea=()=>{};r?(r.experience&&""!==Object(D.a)(String,r.experience)&&(R=Object(D.a)(String,r.experience)),r.onTaskComplete&&(Ea=r.onTaskComplete),r.campaignId&&""!==Object(D.a)(String,
r.campaignId)&&(la=Object(D.a)(String,r.campaignId))):n.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Uog(R,Ea,la)}Uog(r,R,la=null){if(this.NQc&&this.q2b){const Ea={};Ea.experience=r||"gopremium";Ea.campaignId=la||Ic.b(this.Vga,this.Uga,Object(D.a)(String,Ea.experience),!0);this.Ca.processAction(u.a.Ljh,2);n.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Ea.experience);try{const Qa=Object.assign(new me,{instance:this.q2b,z1c:Ea,NAh:R||
(()=>{}),W5:wb=>{n.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+wb.status)},Tgh:()=>{n.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.NQc=!1;this.q2b=null}});this.C5a.$kl(Qa)}catch(Qa){n.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Qa.message),this.NQc=!1,this.q2b=null,this.Ca.La(u.a.OQc,2,{["experience"]:Ea.experience})}}else n.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.La(u.a.OQc,2,{["experience"]:r})}Z_j(){this.XCc.Y_j().continueWith(()=>
{try{var r=db.a.qg(z.AFrameworkApplication.uiCulture);const Ea=Ic.c(this.Vga);if(Ea){var R={};R.partnerId=Ea;R.language=r;R.sessionId=z.AFrameworkApplication.userSessionId;R.authHint=z.AFrameworkApplication.fa.Ga("UserPrincipalName");var la=z.AFrameworkApplication.fa.Ga("Puid")||"";""!==la&&(r={},r.puid=la,R.userInfo=r);this.q2b=new Dime(R);this.NQc=!0;n.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else n.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Ea){n.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+Ea.message)}},3)}IEe(){return this.C5a.IEe()}AEe(){return this.C5a.AEe()}}Object(h.a)(Fe,"InProductMessagingUIManager",null,[750]);class Uc{constructor(){this.Xpf=0;this.Rob=Array(5);this.Rob[0]=10;this.Rob[1]=15;this.Rob[2]=50;this.Rob[3]=100;this.Rob[4]=200}Init(r){this.Xpf=r}SendTrace(r,R){n.ULS.sendTraceTag(34182235,this.Xpf,this.Rob[r],"{0}",R)}}Object(h.a)(Uc,"DefaultNetworkingManager",null,[794]);var Uf=d(200);class vg{constructor(r){this.Nd=
r}Nml(r){r&&(InProductMessaging.Networking.NetworkingMgr=new Uc,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(r.Nvh,r.oZg,r.autoPlay,r.mnk,r.locale,Object(m.a)(this,this.Hsk,"onDismissFirstRunExperience"),r.XEh),this.d6(Hf.TAk,!0))}$kl(r){if(r&&r.instance&&r.z1c){let R=document.getElementById("wacDimeContainer");R||(R=document.createElement("div"),R.id="wacDimeContainer",document.body.appendChild(R));z.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.d6("wacDimeContainer",
!1);r.z1c.parentElementId="wacDimeContainer";r.instance.launch(r.z1c,r.NAh).then(la=>{this.coa();document.body.removeChild(R);r.W5(la)}).catch(la=>{this.coa();document.body.removeChild(R);r.Tgh(la)})}else throw Error.argument("DimeExperienceUISettings");}d6(r,R){if(this.Nd&&r&&(r=document.getElementById(r),this.rEj(r),r=this.Nd.uQ("InProductMessagingFocusId"))){const la=this.Nd.Ae;la&&"InProductMessagingFocusId"===la.name||this.Nd.HU("InProductMessagingFocusId",!1);R&&this.vPe(r.scope)}}rEj(r){var R=
this.Nd.Fc("InProductMessagingFocusId");R.parent=Pa.AFrame.ND;const la=new Uf.DOMFocusListing(()=>r);la.wib=!1;la.Go(3);la.Go(2);la.Go(4);R=this.Nd.Tia(()=>r,R,la);R.xib();R.nX=!0;R.KQa=!0}vPe(r){r.zp(ec.FocusManager.instance().Rqa);r.zp(ec.FocusManager.instance().Sqa);r.bindAction(ec.FocusManager.instance().Rqa,u.a.GWf);r.bindAction(ec.FocusManager.instance().Sqa,u.a.FWf)}coa(){this.Nd&&(this.Nd.X0("InProductMessagingFocusId"),this.Nd.iKb("InProductMessagingFocusId"))}Hsk(r,R){this.coa();r=Object.assign(new He,
{completed:r,ZVk:R});z.AFrameworkApplication.Ta.La(u.a.SYi,2,r)}IEe(){const r=document.activeElement,R=this.Nd.yl();return r&&R&&R.vj&&r===R.vj.FAb?(R.vj.YE(r),R.nGb()?32:8):4}AEe(){const r=document.activeElement,R=this.Nd.yl();return r&&R&&R.vj&&r===R.vj.Pja?(R.vj.YE(r),R.lGb()?32:8):4}}Object(h.a)(vg,"InProductMessagingUIWrapper",null,[749]);class Yg{constructor(){this.Da=null}get name(){return"Common.App.InProductMessaging"}Zb(r){r.register(qd,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().oa(()=>
new qd);r.register(vg,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().oa(()=>new vg(ec.FocusManager.instance()));r.register(Fe,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().oa(()=>new Fe(z.AFrameworkApplication.Ta,r.resolve("Common.IInProductMessagingUIWrapper"),r.resolve("Common.App.InProductMessaging.IDependencyDownloader"),z.AFrameworkApplication.Aa.hb.Uk,z.AFrameworkApplication.Aa.hb.$Ia));
r.register(yd,"Common.App.InProductMessaging.InProductMessagingActor").ma().oa(()=>new yd(z.AFrameworkApplication.Ta,z.AFrameworkApplication.Aa,r.resolve("Common.IInProductMessagingUIManager")));r.register(Ag,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().oa(()=>new Ag);r.register(He,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().oa(()=>new He);this.Da=r}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").wb();
z.AFrameworkApplication.fa.gf(()=>{z.AFrameworkApplication.Aa.hb.$N&&Ta.a.get_instance().ek(15,()=>{this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").BEj(r)})});z.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&Ic.a()&&!Ae.a.mx&&1!==z.AFrameworkApplication.Aa.hb.Uk&&this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("MsoPremiumBadge",
!0).then(R=>{!R&&r.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Z_j();return null})})})}dispose(){}static main(){e.a.instance.Dc(new Yg)}}Object(h.a)(Yg,"InProductMessagingPackage",null,[2,3]);var Cc=d(392),Rc=d(564);class Ve{static QQi(r){return Ve.MAf("New",r)}static RQi(r){return Ve.MAf("Open",r)}static tAf(r,R){return Ve.H6a("LoadingMenuSection",Ve.T0j,r,Ve.WZb("lblLoading",R))}static XZb(r,R,la=null,Ea=null){return Ve.H6a("MessageMenuSection",
Ve.QZg,R,Ve.WZb("lblMessage",r,la,Ea))}static Mki(r){return Ve.tAf(r,CommonUIStrings.l_VoicedLoadingText)}static Nki(r,R){return Ve.XZb(CommonUIStrings.l_NewCreationLocationMessage,r.labelText,R.AR,R.zLa)}static Lki(r,R){return Ve.XZb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,R.zLa,"\n\n"),r.labelText)}static vAf(r){return Ve.XZb(CommonUIStrings.l_NewGenericErrorMessage,r.labelText)}static Jki(r,R,la){return Ve.H6a("menuNewBlank",Ve.Nyj,la?r.labelText:null,Ve.SZb(r.Jbg,r.Kbg,r.Lbg,
null,r.LEa,r.u8b,R,"blank"))}static vli(){return Ve.WZb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static JAf(){return Ve.WZb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static wli(r,R){return Ve.H6a("menuNewTemplates",r,null,R)}static Hki(r,R){return Ve.H6a("menuNewMoreTemplates",Ve.EXf,null,Ve.SZb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,r,R))}static Iji(r,R,la){let Ea="";la&&R&&(Ea=Ve.H6a("BrowseMoreMenuSection",
Ve.EXf,null,Ve.SZb("btnBrowseMore",R,R,null,null,null,r||"1959943459",la)));return Ea}static WZb(r,R,la=null,Ea=null){let Qa=Ea;R&&0<R.length&&(Qa=Ve.u_g.CJa(R).trimEnd(),Qa=0<=Qa.indexOf("{0}")?String.format(Qa,Ea):String.format("{0} {1}",Qa,Ea));la=la&&Ea?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',db.a.ue(la),db.a.ue(Ea),db.a.ue(Qa)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
db.a.ue(r||""),Ve.u_g.CJa(db.a.ue(R||"")),la)}static SZb(r,R,la,Ea,Qa,wb,Pb,xc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',db.a.ue(r||""),db.a.ue(R||""),db.a.ue(la||""),Ea||"32by32",db.a.ue(Qa||""),db.a.ue(wb||""),Pb,db.a.ue(xc||""))}static MAf(r,R){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
r,R)}static H6a(r,R,la,Ea){la=la?String.format('Title="{0}"',db.a.ue(la)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',db.a.ue(r||""),db.a.ue(R||""),la,Ea)}}Ve.QZg="MenuMru";Ve.T0j="MenuLoading";Ve.Nyj="MenuHeader";Ve.EXf="MenuFooter";Ve.u_g=Rc.a.Zw("\n","&#10;");Object(h.a)(Ve,"NewAndOpenXmlUtilities",
null,[]);var ob=d(96);class Mb{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(h.a)(Mb,"HostInformation",null,[]);var nc=d(133),Qc=d(175),id=d(126),ld=d(438),xd=d(523);class ue{constructor(r,R,la,Ea,Qa,wb){this.xEc=this.jo=this.jwc=null;this.PDc=this.SKd=!1;this.Bif=0;this.GKd=this.XDd=!1;this.Lha=r;this.sSb=R;this.sha=new Od.a(()=>new Cc.a(la.value,Object(m.a)(this,this.iEa,"getMoreInfoEventReceived")));this.AWh=Ea;this.rOa=Qa;this.l0h=wb;this.OWb=this.gqd;2===
this.fY.Wwa&&(this.GKd=!0);z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.DWi()}get O2(){switch(this.fY.Wwa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}DWi(){nc.a.instance.Db(new Q.a(5,1,0,()=>{this.getTemplateListJson()}))}wb(){const r=this.fY.AGb;r.ya(u.a.newDocument,E.a.frame,Object(m.a)(this,this.newDocument,"newDocument"));r.ya(u.a.Ulc,
E.a.frame,Object(m.a)(this,this.Ulc,"populateNewMenu"))}newDocument(r,R,la,Ea,Qa){if(1===la)return 32;if(2===la&&Qa){if(z.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Qa.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),z.AFrameworkApplication.Ta.processAction(u.a.vIk,2);if(Qa.MenuItemId&&Qa.SourceControlId)return"NewDocumentHome"===Qa.SourceControlId&&$a.a("NewDocumentFromHomeTab"),this.E7a(Qa.MenuItemId,Qa.SourceControlId)}return 8}E7a(r,
R){var la=this.ydd.bYd;if(null===la)return 8;var Ea=z.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(z.AFrameworkApplication.ubb&&Ea){n.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Qa={};Qa[Qc.a.iBh]=r;Qa[Qc.a.O2]=this.O2;Qa[Qc.a.lcid]=z.AFrameworkApplication.lcid.toString();Qa[Qc.a.reason]=ld.a.SEi;z.AFrameworkApplication.kT().execute(wb=>{wb.sendMessage(id.a.E7a,Qa)})}else Ea=(new Date).getTime(),
R=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",la,db.a.Ne(this.Xwa),db.a.Ne(r),db.a.Ne(this.O2),db.a.Ne(z.AFrameworkApplication.lcid.toString()),db.a.Ne(Ea.toString()),db.a.Ne(R),db.a.Ne(z.AFrameworkApplication.canary),z.AFrameworkApplication.gh),(la=z.AFrameworkApplication.fa.Ga("ScenarioId"))&&""!==la&&(R+="&wdscenarioid="+db.a.Ne(la)),R+="&"+z.AFrameworkApplication.jTa(),z.AFrameworkApplication.LUa&&(R+="&"+z.AFrameworkApplication.iTc()),
(la=this.jo?this.jo.AR:null)&&(R+="&DestinationUrl="+db.a.Ne(la)),Oc.a.vn(R,"_blank",void 0,"CreateNewDocument");2===this.fY.Wwa&&n.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:xd.a[this.fY.Wwa],["Template"]:r});return 32}q4j(r){let R=Number.MAX_VALUE,la=Number.MIN_VALUE;const Ea=window.performance;if(Ea&&"undefined"!==typeof Ea.getEntriesByName){for(let wb=0;wb<r.length;wb++){var Qa=Ea.getEntriesByName(r[wb]);Qa&&0<Qa.length&&(Qa=Qa[0],R=Math.min(parseInt(String(Qa.fetchStart)),
R),la=Math.max(parseInt(String(Qa.responseEnd)),la))}la>R&&n.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:la-R,["MinFetchStart"]:R,["MaxResponseEnd"]:la})}}Ulc(r,R,la,Ea,Qa){if(1===la)return this.GKd&&(z.AFrameworkApplication.JL("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.GKd=!1),32;2!==la||this.XDd||(this.Bif=(new Date).getTime(),n.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.gqd,
["CachedNewMenuXmlExists"]:!!this.jwc,["ShouldCallGetMoreInfo"]:this.fY.ALa}));z.AFrameworkApplication.bGa("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");z.AFrameworkApplication.bGa("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.UFk(Qa)}UFk(r){r&&(this.jwc?r.PopulationXML=this.jwc:(this.fY.ALa&&!this.jo&&this.Qnk.pda("Opened New menu",!0),r.PopulationXML=this.h2i(this.getTemplateListJson())));return 32}Alg(){return!this.fY.ALa||!!this.jo&&3===this.jo.state&&!!this.jo.zLa&&
!!this.jo.AR}NSj(){return z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.EFa?!0:this.Alg()}getTemplateListJson(){if(!this.gqd||!this.NSj())return null;if(this.OWb&&!this.PDc){var r="9";z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(r="21");const R=z.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in R&&(r=R.NumberOfTemplatesInBackstage);let la=this.O2;"TemplateCollectionId"in
R&&(la=R.TemplateCollectionId);z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(la="WordConsumerWAC",r="23");r=String.format(this.fY.lna+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",db.a.Ne(z.AFrameworkApplication.lcid.toString()),db.a.Ne(la),r);Boolean.parse(R.AppendOriginQueryParam||"false")&&(r+="&org=backstage");Boolean.parse(R.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in R&&(r+="&templateTier="+R.TemplateTier);
r+="&"+z.AFrameworkApplication.jTa();z.AFrameworkApplication.LUa&&(r+="&"+z.AFrameworkApplication.iTc());this.fY.rjc.mj(r,1,null,null,!1,2,Ea=>{this.fY.Sbb("CreateNewActor.GetTemplateListJson",Ea.data);this.hul(Ea.data.Sd)},Ea=>{this.fY.Sbb("CreateNewActor.GetTemplateListJson",Ea.data);this.gul()},null,void 0,void 0,void 0,void 0,"5");this.OWb=!1}return this.xEc}hul(r){z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.xEc=this.mXi(r):this.xEc=r;this.OWb=!1;this.Unc();if(z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.EFa&&Bb.c()){r=z.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const R=z.AFrameworkApplication.ubb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.xEc,!0,r&&R))}}gul(){this.PDc=this.OWb=!0;this.Unc();z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.EFa&&Bb.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));ob.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}mXi(r){r=JSON.parse(r);const R=new da.a;R.add("TM00002102");R.add("TM00002101");R.add("TM16392939");const la=nf.a.upa(r,Ea=>R.contains(Ea.AssetId));r=r.slice(0,9);r.splice.apply(r,[2,0].concat(la));return JSON.stringify(r)}zmj(r){var R=0;for(var la=0;la<r.length;la++)if("ST"===r[la].ImageType){R=la;break}const Ea=r.length?r[R]:null;r=Ea?Ea.Url||"":"";var Qa;let wb=la=R=!1;if(Ea&&
(Qa=Ea.AspectRatio))Qa=parseFloat(Qa),1>Qa?R=!0:1.5<Qa?la=!0:1===Qa&&(wb=!0);else switch(n.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:r}),this.fY.Wwa){case 3:R=!0;break;case 2:la=!0;break;case 5:wb=!0}return{returnValue:r,uL:R?"95by123":la?"123by69":wb?"100by100":"123by95"}}h2i(r){const R=({Upd:r}=this.Kki(r,this.ydd,this.ydd.c_b||"1056925771")).returnValue;r&&(this.jwc=R,n.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.Bif}));return R}iEa(r,R){n.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.jo||3!==r.state?2===r.state&&(n.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.SKd=!0,this.Unc()):(this.jo=r,R||this.Unc(),z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.EFa&&Bb.c()&&Bb.d("setFileMenuHostInformation")&&(r=Object.assign(new Mb,{hostUrl:this.jo.AR,hostName:this.jo.zLa,folderUrl:z.AFrameworkApplication.breadcrumbFolderUrl,
folderName:z.AFrameworkApplication.breadcrumbFolderName}),n.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(r))))}Kki(r,R,la){let Ea;Ea=!1;const Qa=this.Alg();let wb="";this.fY.ALa&&(this.SKd?(wb=Ve.vAf(R),this.SKd=!1,n.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.jo?Qa?wb=Ve.Nki(R,this.jo):this.jo.eHj?(Ea=!0,this.OWb=!1,wb=Ve.Lki(R,this.jo),
n.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Ea=!0,wb=Ve.vAf(R),n.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.jo.AR,["StorageServiceDisplayNameIsSet"]:!!this.jo.zLa})):(wb=Ve.Mki(R.labelText),n.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Qa&&(wb+=Ve.Jki(R,la,!wb)+({Upd:Ea}=this.uli(r,la)).returnValue);
return{returnValue:Ve.QQi(wb),Upd:Ea}}uli(r,R){let la;la=!1;if(!this.gqd)return la=!0,n.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Upd:la};let Ea="",Qa="",wb="MenuTemplate";if(this.PDc)Ea=Ve.JAf(),this.PDc=!1,n.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(r){try{const Pb=Sys.Serialization.JavaScriptSerializer.deserialize(r,!0);Ea=this.tli(Pb,R);n.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");
z.AFrameworkApplication.w_g&&"OneDrive"===this.Xwa&&(Qa=Ve.Hki(this.Rnk,z.AFrameworkApplication.w_g))}catch(Pb){n.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:r}),Ea=Ve.JAf()}la=!0}else wb="MenuLoading",Ea=Ve.vli(),n.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Ve.wli(wb,Ea)+Qa,Upd:la}}tli(r,R){let la="";const Ea=[];for(let wb=0;wb<r.length;wb++){var Qa=r[wb];let Pb="";if(Qa){const xc=
Qa.Title,ed=Qa.AssetId;Qa=Qa.Thumbnails;ed&&xc&&Qa&&({uL:Qa,returnValue:Pb}=this.zmj(Qa),la+=Ve.SZb("jbtnNewTemplate"+wb,xc,null,Qa,null,Pb,R,ed))}Ea[wb]=Pb}r=new Q.a(4,1,5E3,()=>{this.q4j(Ea)},106);this.fY.wdd.Db(r);return la}Unc(){this.XDd=!0;this.fY.r_g.P1(this.ydd.z4b);this.XDd=!1}get fY(){return this.Lha.value}get ydd(){return this.sSb.value}get Qnk(){return this.sha.value}get Rnk(){return this.AWh.value}get Xwa(){return this.rOa.value}get gqd(){return this.l0h.value}}Object(h.a)(ue,"CreateNewActor",
null,[]);class Rd{constructor(){this._initialized=!1;this.vLd={}}yC(r){this.CSf();return this.get(r)}contains(r){this.CSf();return r.toString()in this.vLd}CSf(){this._initialized||(this.D7h(),this._initialized=!0)}$qb(r,R){this.vLd[r.toString()]=R}get(r){return this.vLd[r.toString()]}}Object(h.a)(Rd,"AIntlHelper",null,[]);class ce extends Rd{constructor(){super()}D7h(){this.$qb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.$qb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.$qb(2,CommonUIStrings.l_Open);
this.$qb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.$qb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.$qb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return ce.Ka||(ce.Ka=new ce)}static Wzk(r){return ce.instance.yC(r)}}ce.Ka=null;Object(h.a)(ce,"MruActorIntlHelper",Rd,[]);var Ne;(function(r){r[r.success=0]="success";r[r.failure=1]="failure";r[r.spinner=2]="spinner";r[r.none=3]="none"})(Ne||(Ne={}));Object(h.b)("DisplayState",Ne);var oe=d(36);class Yd{constructor(r,R,la,Ea,Qa,
wb,Pb,xc){this.cyd=null;this.oNd=!0;this.iwc="";this.c2h=0;this.Qob=null;this.SEd=3;this.$a=xc;this.Lha=r;this.Zba=R;this.oRh=la;this.RNh=Ea;this.QNh=Qa;this.sha=new Od.a(()=>new Cc.a(wb.value,null));this.YRh=new Od.a(()=>new Cc.a(Pb.value,Object(m.a)(this,this.dnk,"mruEventResultReceived")));this.$a.ka("WacInTabOpenMRUIsEnabledForUiHost");this.$a.ka("UiHostSupportsDocRebootFeatures")}dnk(r,R){this.Qob=r;R||this.fgh()}fVk(){this.VO.AGb.ra(u.a.$hd,E.a.frame,Object(m.a)(this,this.$hd,"populateMruMenu"),
96)}$hd(r,R,la,Ea,Qa){return 1!==la&&Qa?this.TFk(Qa):32}TFk(r){this.tRi();this.sRi();r.PopulationXML=Ve.RQi(this.iwc+this.cyd);return 32}tRi(){var r=3;let R=!1;if(this.iwc&&this.c2h===this.Qob.Fvl)n.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),r=this.SEd;else{n.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var la=this.VO.EF();this.Qob=this.cnk.pda("File Open opened",
!0);this.iwc&&2!==this.SEd&&3!==this.Qob.state?R=!0:(r=this.Bij(this.Qob),z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.EFa&&Bb.c()&&r&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)),this.iwc=({Gnk:r}=this.i2i(this.Qob)).returnValue);la=this.VO.EF()-la;n.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:la})}2!==r&&(la={["DisplayState"]:Ne[r]},1!==r&&(la.IsStale=R),n.ULS.sendTraceTag(5849630,
202,50,"MRU section display state {0}",la));this.SEd=r}Bij(r){let R;try{R=oe.c(r.ZEe)}catch(la){R=null,n.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",la)}return R}sRi(){this.oNd?(n.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.cyd=({AJl:this.oNd}=this.ojk()).returnValue):n.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");n.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",
{["WaitingOnLinkInfo"]:this.oNd,["NotDisplayingLink"]:!this.cyd})}i2i(r){let R;1===r.state||0===r.state?(n.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),r=2,R=Ve.tAf(this.wEa(2),this.wEa(5))):3===r.state&&r.ZEe?(R=this.Iki(r.ZEe),r=0):(n.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),R=Ve.XZb(this.wEa(1),this.wEa(2)),r=1);return{returnValue:R,Gnk:r}}Iki(r){let R;const la=this.Mic.c_b||"2155708348";if(r.length){R=Ve.WZb("lblRecentDocuments",
this.wEa(3));let Ea=0;for(let Qa=0;Qa<r.length;Qa++){const wb=r[Qa];"FileName"in wb&&"DocumentUrl"in wb&&"Path"in wb&&(R+=Ve.SZb("MruButton"+Qa,wb.FileName.toString(),wb.Path.toString(),null,this.Mic.LEa,this.Mic.u8b,la,wb.DocumentUrl.toString()),wb.IsPinned&&Ea++)}R=Ve.H6a("RecentDocumentsMenuSection",Ve.QZg,this.wEa(2),R);n.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:r.length,["NumPinnedDocuments"]:Ea})}else R=Ve.XZb(this.wEa(0),this.wEa(2)),
n.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return R}ojk(){let r;r=!0;let R=this.$ii;var la=this.Zii;if(R&&la||!this.VO.ALa)r=!1;else{const Ea=this.mTc.pda("File Open",!1);3===Ea.state&&(R=Ea.AR,la=Ea.zLa,r=!1)}la=la?String.format(this.wEa(4),la):null;return{returnValue:Ve.Iji(this.Mic.c_b,la,R),AJl:r}}fgh(){this.VO.r_g.P1(this.Mic.z4b)}get VO(){return this.Lha.value}get wEa(){return this.Zba.value}get Mic(){return this.oRh.value}get $ii(){return this.RNh.value}get Zii(){return this.QNh.value}get mTc(){return this.sha.value}get cnk(){return this.YRh.value}}
Object(h.a)(Yd,"MruRenderer",null,[]);var Id=d(176),zf=d(449);class od{constructor(r,R,la,Ea,Qa,wb,Pb){this.jo=null;this.Anf=!1;this.yNa=this.G8e=0;this.LWh=r;this.dpb=R;this.hBc=la;this.sSb=Ea;this.rOa=Qa;this.Lha=wb;this.sha=new Od.a(()=>new Cc.a(Pb.value,Object(m.a)(this,this.iEa,"getMoreInfoEventReceived")))}E7a(){!this.jo&&this.lFe.ALa?this.mTc.pda("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}iEa(r){if(!this.jo&&3===r.state)this.jo=r;else if(2===r.state){this.Anf?n.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.mTc.pda("NewDocumentFromStream",!0),this.Anf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.G8e=(new Date).getTime();var r=this.LWi.bYd;if(null===r)this.dpb(null);else{var R=this.hBc.menuItemId,la=this.hBc.XU,Ea=this.hBc.drl,Qa=this.hBc.SWi;this.yNa="streamBase64"===Ea?Qa.length/1024:0;n.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.O2,this.yNa);var wb=(new Date).getTime();r=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
r,db.a.Ne(this.Xwa),db.a.Ne(R),db.a.Ne(this.O2),db.a.Ne(z.AFrameworkApplication.lcid.toString()),db.a.Ne(wb.toString()),db.a.Ne(la),db.a.Ne(z.AFrameworkApplication.canary),z.AFrameworkApplication.gh,db.a.Ne(Ea));r+="&"+z.AFrameworkApplication.jTa();z.AFrameworkApplication.LUa&&(r+="&"+z.AFrameworkApplication.iTc());(R=this.jo?this.jo.AR:null)&&(r+="&DestinationUrl="+db.a.Ne(R));this.lFe.rjc.mj(r,2,Qa,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(m.a)(this,this.Knk,"newDocumentFromStreamSuccessHandler"),
Object(m.a)(this,this.Jnk,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Knk(r){if(r&&r.data&&r.data.Sd){var R;({rv:R}=oe.d(r.data.Sd)).returnValue?(r=R,r.StatusCode!==Id.a.Uv&&r.StatusCode!==Id.a.G1b?(n.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.O2,this.yNa,r.StatusCode),this.dpb(null)):r.NewDocumentUrl&&""!==r.NewDocumentUrl?(n.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.O2,this.yNa,(new Date).getTime()-this.G8e),this.LWh(r.NewDocumentUrl)):(n.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.O2,this.yNa),this.dpb(null))):(n.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.O2,this.yNa,{["ResponseData"]:zf.a.Otc(r.data.Sd)}),this.dpb(null))}else n.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.O2,this.yNa),this.dpb(null)}Jnk(r){r&&r.data&&n.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.O2,this.yNa,r.data.status);this.dpb(null)}get O2(){switch(this.lFe.Wwa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get LWi(){return this.sSb.value}get Xwa(){return this.rOa.value}get lFe(){return this.Lha.value}get mTc(){return this.sha.value}}
Object(h.a)(od,"NewDocumentFromStreamOperation",null,[]);class gf{constructor(r,R,la,Ea){this.sSb=r;this.rOa=R;this.Lha=la;this.XRh=Ea}create(r,R,la){return new od(r,R,la,this.sSb,this.rOa,this.Lha,this.XRh)}}Object(h.a)(gf,"NewDocumentFromStreamOperationFactory",null,[793]);var Lf=d(291);class ke{get name(){return"Common.App.NewAndOpen.UX"}Zb(r){r.register(gf,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().oa(()=>
new gf(new Od.a(()=>z.AFrameworkApplication.Aa.hb.S6d()),new Od.a(()=>z.AFrameworkApplication.Xwa),new Od.a(()=>r.ub("Common.INewAndOpenCommonHelpers")),new Od.a(()=>r.ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){z.AFrameworkApplication.fa.gf(()=>{this.PEa()})}PEa(){const r=Lf.a.$u(A.a.instance.Ja("Common.INewAndOpenCommonHelpers")),R=Lf.a.$u(A.a.instance.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));z.AFrameworkApplication.Xwa&&xh.Task.WAA.call(null,r,R).continueWith(()=>
{const la=new ue(new Od.a(()=>r.result),new Od.a(()=>z.AFrameworkApplication.Aa.hb.S6d()),new Od.a(()=>R.result),new Od.a(()=>z.AFrameworkApplication.Aa.hb.T6d().c_b||"1959943459"),new Od.a(()=>z.AFrameworkApplication.Xwa),new Od.a(()=>z.AFrameworkApplication.hQj));la.wb();la.Unc()});if(z.AFrameworkApplication.rPe){const la=Lf.a.$u(A.a.instance.Ja("Common.IEventEmitter<Common.IMruResult>"));xh.Task.WAA.call(null,r,R,la).continueWith(()=>{const Ea=new Yd(new Od.a(()=>r.result),new Od.a(()=>ce.Wzk),
new Od.a(()=>z.AFrameworkApplication.Aa.hb.T6d()),new Od.a(()=>z.AFrameworkApplication.Vzk),new Od.a(()=>z.AFrameworkApplication.Uzk),new Od.a(()=>R.result),new Od.a(()=>la.result),z.AFrameworkApplication.fa);Ea.fVk();Ea.fgh()})}}dispose(){}}Object(h.a)(ke,"UXPackageManager",null,[2,3,106]);class vf extends Oa.StandardDialog{constructor(){super();this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}tv(r){this.Gy(r,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}iDa(r){this.Gy(r,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(h.a)(vf,"ErrorDialog",Oa.StandardDialog,[776]);class ng{xZf(){n.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const r=new lg.a;r.Gg("api.onedrive.com");return r.task}}Object(h.a)(ng,"OneDriveConsumerEndpointHelper",null,[717]);var wg=d(166);class bf{constructor(r,R,la,Ea){this.p4a=this.yna=null;this.yKd=this.AKd=!1;this.jpb=null;this.$a=r;this.Kmb=R;this.Q3a=la;this.HA=Ea}get fwf(){return this.Kmb}get fa(){return this.$a}axb(){this.jpb||
(this.jpb=this.yHb?wh.a.create(this.yHb,null,null,null,!1):null);return this.jpb}setup(r){this.p4a=r;this.AKd||this.yKd?this.AKd&&this.p4a&&this.p4a(!0):(r=this.axb())?(this.yKd=!0,r.XFa.continueWith(R=>{this.wvk(R)}),kc.a.ey(r)):(n.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.p4a(!1))}VHe(r){n.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",r.Yi?r.Yi.toString():"No error detail.")}wvk(r){this.yKd=!1;
if(r.tm)this.VHe(r),this.p4a(!1);else try{this.AKd=!0,n.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.aee(),n.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.p4a(!0)}catch(R){n.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",R.toString()),this.p4a(!1)}}Vrc(r){this.yna=r;this.Q3a?n.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(m.a)(this,this.nGe,"onApiReady")))}nGe(r){r?this.A1c():this.At()}At(){this.HA().tv(wg.a.uzk)}onSuccess(r){n.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.yna&&this.yna(!0,r)}dispose(){this.jpb&&this.jpb.dispose()}}Object(h.a)(bf,"AOneDriveFilePickerApiManager",null,[806,106]);class Pd extends bf{constructor(r,R,la,Ea,Qa,wb){super(R,la,Ea,wb);this.ol=null;this.Yba=r;this.q0h=Qa}get yHb(){return this.fa.Ga("OneDriveApiUrl")}start(r,R){this.ol=
r;this.Vrc(R)}aee(){WL.init(1===this.fwf||2===this.fwf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Vrc(r){this.yna=r;!this.Q3a&&this.Yba.wie?(n.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(m.a)(this,this.nGe,"onApiReady"))):(n.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.q0h())}A1c(){try{n.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.ol).then(Object(m.a)(this,this.onSuccess,"onSuccess"),Object(m.a)(this,this.xz,"onFailure"))}catch(r){n.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",r,r.stack),this.At()}}xz(r){if(r&&r.error){if("user_canceled"===r.error.code){n.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}n.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",r.error.code,r.error.message)}else n.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.yna&&this.yna(!1,r);this.At()}}Object(h.a)(Pd,"OneDriveFilePickerApiManagerV5",bf,[]);class Md extends bf{constructor(r,R,la,Ea,Qa){super(r,R,la,Ea);this.$yc=this.dkf=null;this.NQh=Qa;this.options={};this.options.clientId=this.fa.Ga("OneDriveApiV7ClientId");this.options.cancel=Object(m.a)(this,this.ctd,"toggleHostDivVisibility")}get yHb(){return this.fa.Ga("OneDriveApiV72Url")}start(r,R){this.$yc=R;const la=this.NQh.xZf();la.continueWith(()=>{n.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.dkf=la.result;this.Vrc((Ea,Qa)=>{this.ctd();r(Ea,Qa)})},3);la.continueWith(()=>{n.ULS.sendTraceTag(24134242,352,15,la.Yi.message);this.ctd()},5)}aee(){this.options.success=r=>{const R={};R.data=r;this.onSuccess(R)};this.options.error=r=>{const R={};R.error=r;this.xz(R)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.dkf;this.options.advanced.iframeParentDiv=this.$yc}A1c(){try{n.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.ctd(),OneDrive.open(this.options)}catch(r){n.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",r.message),this.At()}}xz(r){this.yna&&this.yna(!1,r);this.At()}ctd(){this.$yc.style.visibility="hidden"===this.$yc.style.visibility?"":"hidden"}}Object(h.a)(Md,"OneDriveFilePickerApiManagerV7",bf,[]);class Mh extends bf{constructor(r,R,la,Ea){super(r,R,la,Ea);this.dNh=r;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ga("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get yHb(){return this.fa.Ga("OneDriveApiV72Url")}start(r,R,la,Ea){this.options.advanced.iframeParentDiv=la;this.options.advanced.endpointHint=Ea;this.options.cancel=R;this.dNh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.Vrc(r)}Vrc(r){this.yna=r;this.Q3a?n.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(m.a)(this,this.nGe,"onApiReady")))}aee(){this.options.success=r=>{const R={};R.data=r;this.onSuccess(R)};this.options.error=r=>{const R={};R.error=r;this.xz(R)}}A1c(){try{n.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(r){n.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",r.message,r.stack),this.At()}}VHe(r){n.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",r.Yi?r.Yi.toString():"No error detail.");kc.a.vXk(this.yHb);this.jpb=null}At(){this.HA().iDa(wg.a.i5k)}xz(r){this.yna&&this.yna(!1,r)}}Object(h.a)(Mh,"OneDriveFilePickerApiManagerV72",bf,[]);class Bh{constructor(r){this.olsSessionId=this.value=this.key=null;this.olsSessionId=r}}Object(h.a)(Bh,"IExtraData",null,
[]);class Vh extends Mh{constructor(r,R,la,Ea){super(r,R,la,Ea);this.options.advanced.filter=r.Ga("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=z.AFrameworkApplication.rwf;r.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=r.Ga("OneDriveApiV72CommandMode")||"none");r.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new Bh(z.AFrameworkApplication.userSessionId))}get yHb(){return this.fa.Ga("OneDriveApiV72Url")}A1c(){try{n.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",z.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(r){n.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",r.message,r.stack),this.At()}}}Object(h.a)(Vh,"OneDriveFilePickerApiOpenManagerV72",
Mh,[]);class Jg{constructor(r){this.$v=null;this.Xh=r;this.vJd=3}xZf(){this.$v=new lg.a;n.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.yUe();return this.$v.task}yUe(r=null){const R=String.format("GetMoreInfoHandler.ashx?{0}",z.AFrameworkApplication.H7a);this.Xh.ZV(R,1,null,r,["PersonalFileStorageUrl","X-NewKey"],2,Object(m.a)(this,this.gdj,"getMoreInfoSucceeded"),Object(m.a)(this,this.edj,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}edj(r){if(r.data.oe===Id.a.umc&&"X-NewKey"in r.data.sj){n.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const R={};R["X-Key"]=r.data.sj["X-NewKey"];this.yUe(R)}else 0<this.vJd?(n.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.vJd),this.vJd--,this.yUe()):(n.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.$v.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}gdj(r){"PersonalFileStorageUrl"in r.data.sj&&""!==r.data.sj.PersonalFileStorageUrl?(n.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.$v.Gg(r.data.sj.PersonalFileStorageUrl)):(n.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.$v.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(h.a)(Jg,"OneDriveForBusinessEndpointHelper",null,[717]);var Of=d(355);class bi{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Zb(r){this.Da=r;this.Da.register(Pd,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().oa(()=>new Pd(Of.a.instance,z.AFrameworkApplication.fa,z.AFrameworkApplication.TRa,z.AFrameworkApplication.PQ,z.AFrameworkApplication.$vh,()=>
new vf));z.AFrameworkApplication.kAb?this.Da.register(717,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new ng):this.Da.register(717,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().oa(()=>new Jg(z.AFrameworkApplication.Ke));this.Da.register(Md,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().oa(()=>new Md(z.AFrameworkApplication.fa,z.AFrameworkApplication.TRa,z.AFrameworkApplication.PQ,()=>new vf,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Da.register(Mh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().oa(()=>new Mh(z.AFrameworkApplication.fa,z.AFrameworkApplication.TRa,z.AFrameworkApplication.PQ,()=>new vf));this.Da.register(Vh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().oa(()=>new Vh(z.AFrameworkApplication.fa,z.AFrameworkApplication.TRa,z.AFrameworkApplication.PQ,()=>new vf))}static main(){e.a.instance.Dc(new bi)}}Object(h.a)(bi,"PackageManager",null,[2,3]);var ij=d(172),
ig=d(181);class oj{constructor(r){this.kcb=this.Pze=this.Ieb=this.J7c=0;this.rye=this.sIg=null;r?(this.zb=r,this.a2b=Date.now,this.zFi(),this.UUk()):n.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}dcl(){this.sIg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}UUk(){window.document.body.addEventListener("pointerenter",Object(m.a)(this,this.$vk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(m.a)(this,this.awk,
"onPointerLeave"));A.a.instance.Ja("Common.App.VisibilityManagement.IVisibilityManager").execute(r=>{r.FGc(Object(m.a)(this,this.C7b,"handleVisibilityChange"))})}$vk(r){"pen"!==r.pointerType||this.Ieb||(this.Ieb=Math.floor(this.a2b()/1E3),this.Ieb<=this.J7c&&(this.Ieb=this.J7c),this.Pze=0)}awk(){this.V$f()}V$f(){const r=Math.ceil(this.a2b()/1E3);this.Ieb&&r>this.J7c&&(this.Pze=r,this.kcb+=this.Pze-this.Ieb);this.J7c=r;this.Ieb=0}C7b(r,R){0!==R.newState&&this.V$f()}zFi(){this.rye=new Q.a(4,2,6E4,Object(m.a)(this,
this.v3j,"logPenUsage"));this.zb.Db(this.rye)}v3j(){0<this.kcb&&this.Ooh(this.kcb);this.kcb=0}Ooh(r){const R=new ig.a;R.name=this.sIg;const la=[];(r=ij.a.I8("PenInputSec",r.toString(),3))&&Array.add(la,r);R.dataFields=la;v.a.sendActivityEvent(R)}dispose(){0<this.kcb&&this.Ooh(this.kcb);this.zb.Lg(this.rye)}}Object(h.a)(oj,"PenMinutesManager",null,[715]);class fh{constructor(){this.ZHd=this.Da=null}get name(){return"Common.App.PenMinutesManager"}Zb(r){this.Da=r;const R=z.AFrameworkApplication.ye;this.Da.register(715,
"Common.App.PenMinutesManager.IPenMinutesManager").ma().oa(()=>new oj(R))}init(){this.ZHd=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.ZHd&&this.ZHd.dispose()}static main(){e.a.instance.Dc(new fh)}}Object(h.a)(fh,"PenMinutesManagerPackage",null,[2,3]);class Qd extends Oa.StandardDialog{constructor(r,R){super();this.lpb=!1;this.wK=null;this.Ca=r;this.kSb=R;this.B0a=!1}tv(r,R,la){this.wK=R;this.lpb=la;n.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
r,la);r=this.JUd(r);0===r?(this.xd=6,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.xd=0,this.Xe(1,CommonUIStrings.l_DialogClose));0===r&&n.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Gy(wg.a.h5k,this.b8i(r),this.a8i(r,R),Object(m.a)(this,this.MSe,"retryDialogHandler"),!0)}MSe(r){1===r?(n.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.wK?this.Ca.La(u.a.TKb,2,[this.wK,this.lpb]):this.Ca.processAction(u.a.TKb,2)):n.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}JUd(r){return 0>r||6<r?(n.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",r),0):r}a8i(r,R){r=this.JUd(r);return this.kSb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,R),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][r]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,R),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][r]}b8i(r){r=this.JUd(r);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][r]}}
Object(h.a)(Qd,"ErrorRetryDialog",Oa.StandardDialog,[905]);class $e{constructor(r,R){this.$a=r;this.Ca=R;this.kSb=this.$a.ka("SaveToHostWithExtraCharsInFileName")}create(){return new Qd(this.Ca,this.kSb)}}Object(h.a)($e,"ErrorRetryDialogFactory",null,[883]);class yh extends kd.a{constructor(r,R,la,Ea,Qa,wb,Pb=null){super();this.zV=null;this.Ca=R;this.nba=Ea;this.CBa=wb;this.$a=r;this.HA=Qa;this.Rh=la;this.kSb=this.$a.ka("SaveToHostWithExtraCharsInFileName");this.ol=Pb;this.Xe(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Rh}KOf(r,
R){this.jD(1,!!r&&r!==R);this.zV=document.getElementById(yh.nVf);nd.a.addHandler(this.zV,"change",Object(m.a)(this,this.Red,"onFileNameChange"));nd.a.addHandler(this.zV,"input",Object(m.a)(this,this.Red,"onFileNameChange"));this.zV.focus()}mVf(r){return this.kSb?(new RegExp("["+this.XSf('\\/:*?"<>|')+"]")).test(r):(new RegExp("["+this.XSf('\\/:*?"<>|#{}%~&')+"]")).test(r)}XSf(r){return r.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}$ae(){const r=db.a.XG(z.AFrameworkApplication.Eu.Xw);this.jD(1,
!!this.zV&&""!==this.zV.value&&this.zV.value!==r)}Red(){this.zV&&window.setTimeout(()=>{this.$ae()},0)}DPc(r,R){if(1!==r)n.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{r=R[yh.nVf];R=yh.h8g in R?R[yh.h8g]:!1;n.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",db.a.Vfh(r),R);const la=db.a.fT(z.AFrameworkApplication.fileName);(r=r?r.trim():null)&&""!==r&&""!==la||1===this.Aa.state?
this.mVf(r)?this.HA.create().tv(1,r,R):this.CBa.E1(r+la,R,this.ol):this.HA.create().tv(2,r,R)}}dispose(){this.zV&&(nd.a.removeHandler(this.zV,"change",Object(m.a)(this,this.Red,"onFileNameChange")),nd.a.removeHandler(this.zV,"input",Object(m.a)(this,this.Red,"onFileNameChange")),this.zV=null);super.dispose()}}yh.nVf="txtFileName";yh.h8g="chkOverwrite";Object(h.a)(yh,"FileNameDialogBase",kd.a,[]);class Ti{static get rg(){return kd.a.sC(Ti.so,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Ti.so="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(h.a)(Ti,"FileNameDialogHtml",null,[]);class fe extends yh{constructor(r,R,la,Ea,Qa,wb){super(r,R,la,Ea,Qa,wb);this.rg=Ti.rg;this.hg="FileNameDialog-SaveAsToHost"}Cja(r,R){const la=db.a.XG(z.AFrameworkApplication.Eu.Xw);R={["txtFileName"]:r||la,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:R};this.Zi(CommonUIStrings.L_SaveAs,Object(m.a)(this,this.DPc,"fileNameDialogHandler"),R);this.KOf(r,la)}}Object(h.a)(fe,"FileNameDialog",yh,[904]);class gi{constructor(r,R,la,Ea,Qa,
wb){this.Ca=R;this.$a=r;this.nba=Ea;this.CBa=wb;this.HA=Qa;this.Rh=la}create(){return new fe(this.$a,this.Ca,this.Rh,this.nba,this.HA,this.CBa)}}Object(h.a)(gi,"FileNameDialogFactory",null,[882]);class vi{constructor(r,R,la){this.CBa=la;this.WAd=R;this.$a=r}wb(){2===z.AFrameworkApplication.Aa.hb.Uk?z.AFrameworkApplication.Ta.ra(u.a.TKb,E.a.frame,Object(m.a)(this,this.inh,"saveAsToHostActionDispatcher"),4):z.AFrameworkApplication.Ta.ya(u.a.TKb,E.a.frame,Object(m.a)(this,this.inh,"saveAsToHostActionDispatcher"))}inh(r,
R,la,Ea,Qa){return R.contextId!==E.a.frame||r!==u.a.TKb?2:this.$a.ka("SaveAsToHostBrsIsEnabled")?1===la?B.SessionStatusManager.instance.uka||z.AFrameworkApplication.KQ?8:32:2===la?(n.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),r=this.WAd.create(),Qa&&Object.getType(Qa)===Array&&2===Qa.length?r.Cja(Qa[0],!!Qa[1]):r.Cja(null,!1),32):8:8}}Object(h.a)(vi,"SaveAsToHostActor",null,[]);class bk{constructor(r,R,la,Ea,Qa,wb,Pb,xc){this.Nn=null;this.lpb=this.o2=
!1;this.BBa=this.ol=this.wK=null;this.$a=R;this.GBa=this.$a.appSettings.SaveAsToHostWebServiceBase;this.vef=Ea;this.xqa=Qa;this.Xh=la;this.HA=wb;this.Yh=xc;this.Rh=Pb;this.Ca=r;this.wAa=R.Ga("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}zrc(){1!==this.Rh.state&&(this.Nn=this.xqa(),this.Nn.message=CommonUIStrings.l_CommentProgressTooltip,this.Nn.xd=5,this.Nn.Ar=!1,this.Nn.Qoa(CommonUIStrings.l_DefaultDialogTitle,null,null))}QY(r=0){1!==this.Rh.state&&this.HA.create().tv(r,db.a.XG(this.wK),
this.lpb)}pib(){const r=this.$a.appSettings.BreadcrumbFolderUrl;n.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Oc.a.vn(r,Oc.a.hba(3),void 0,"UploadToHostManager.RedirectToFolder")}oib(r){let R=!1,la=!1;this.$a&&(R=this.$a.ka("SaveACopyIsEnabledForUiHost"),la=this.$a.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",r,R,la);if(R&&la){n.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ea={};Ea[Qc.a.PJb]="1";Ea[Qc.a.documentUrl]=r;Ea[Qc.a.reason]=ld.a.CTe;z.AFrameworkApplication.kT().execute(Qa=>{Qa.sendMessage(id.a.lDa,Ea)})}else R&&!la&&z.AFrameworkApplication.uua?Oc.a.vn(r,Oc.a.hba(4),void 0,"UploadToHostManager.RedirectToEditUrl"):Oc.a.vn(r,Oc.a.hba(3),void 0,"UploadToHostManager.RedirectToEditUrl")}E1(r,R,la=null){n.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.vef&&
!this.vef()&&this.Xh&&(this.Yh&&(this.BBa=this.Yh.Ci("DialogShown","SaveAsToHostUploadTime")),this.zrc(),this.lpb=R,this.wK=r,(this.ol=la)&&"true"===this.ol.SkipSaveToHost?this.WOc():this.q3())}q3(){32!==this.Ca.processAction(u.a.H_a,1)?(n.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.WOc()):this.Ca.La(u.a.H_a,2,[()=>{n.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.WOc()},(r,R)=>{n.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.QY(R)}])}czk(r){this.Z7a();this.o2=!1;if(r&&r.data&&r.data.Sd)if(({rv:R}=oe.d(r.data.Sd)).returnValue)if(r=R,r.StatusCode!==Id.a.Uv&&r.StatusCode!==Id.a.G1b){n.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var R={};R.FailureReason=r.StatusCode.toString();R.ExtraInfo=r.ExtraInfo;this.bya(R);this.QY(parseInt(r.ExtraInfo))}else{n.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.XRe();try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.oib(r.NewDocumentUrl):this.pib()}catch(la){n.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",la.toString())}this.zlc()}else n.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:zf.a.Otc(r.data.Sd)}),this.bya({["FailureReason"]:"Failed to deserialize response"}),this.QY();else n.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.bya({["FailureReason"]:"null response"}),this.QY()}bzk(r){5!==r.data.status&&12!==r.data.status||this.o2?(n.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:r.data.status,["HttpStatus"]:r.data.oe}),this.bya({["FailureReason"]:r.data.oe.toString()}),this.Z7a(),this.QY(),this.zlc()):(n.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.o2=!0,this.ol&&"true"===this.ol.SkipSaveToHost?this.WOc():this.q3())}Z7a(){this.Nn&&
(this.Nn.close(),this.Nn=null)}zlc(){this.BBa&&(this.BBa.stop(),this.BBa=null)}XRe(){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.processAction(u.a.Pld,2)}bya(r){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.La(u.a.YRe,2,r)}WOc(){let r=this.GBa+this.wAa;r=gb.a.Ki(r,"qs",db.a.Ne(z.AFrameworkApplication.gh));r=gb.a.Ki(r,"n",db.a.Ne((new Date).getTime().toString()));r=gb.a.Ki(r,"ov",db.a.Ne(this.lpb.toString()));r=gb.a.Ki(r,"fn",db.a.Ne(this.wK));this.ol&&this.ol.FileDownloadUrl&&
(r=gb.a.Ki(r,"furl",db.a.Ne(this.ol.FileDownloadUrl)));this.Xh.mj(r,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(m.a)(this,this.czk,"onUploadFinished"),Object(m.a)(this,this.bzk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(h.a)(bk,"UploadToHostManager",null,[748]);var Zg=d(555);class Ek{constructor(){this.Da=null}get name(){return"Common.App.SaveAsToHost"}init(){z.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){z.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").wb()}Zb(r){this.Da=r;this.Da.register($e,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").oa(()=>new $e(z.AFrameworkApplication.fa,z.AFrameworkApplication.Ta)).ma();this.Da.register(bk,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").oa(()=>new bk(z.AFrameworkApplication.Ta,z.AFrameworkApplication.fa,z.AFrameworkApplication.Ke,()=>z.AFrameworkApplication.Ug,
()=>(new Zg.a).create(),r.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),z.AFrameworkApplication.Aa,z.AFrameworkApplication.Aa.gV)).ma();this.Da.register(gi,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").oa(()=>new gi(z.AFrameworkApplication.fa,z.AFrameworkApplication.Ta,z.AFrameworkApplication.Aa,z.AFrameworkApplication.Aa.hb,r.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),r.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Da.register(vi,"Common.App.SaveAsToHost.SaveAsToHostActor").oa(()=>new vi(z.AFrameworkApplication.fa,r.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),r.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Dc(new Ek)}}Object(h.a)(Ek,"SaveAsToHostPackage",null,[2,3]);class Ch extends Oa.StandardDialog{constructor(){super();this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}tv(r,R){this.fPf(r,R,wg.a.j5k)}fPf(r,R,la){n.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",la);this.Gy(la,r,R,null)}iDa(r,R){n.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Gy(wg.a.l5k,r,R,null,!0)}}Object(h.a)(Ch,"ErrorDialog",Oa.StandardDialog,[928]);class Ui{static get rg(){return kd.a.sC(Ui.so,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Ui.so="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(h.a)(Ui,"FileNameDialogHtml",null,[]);class pg extends yh{constructor(r,R,la,Ea,Qa,wb,Pb,xc){super(r,R,la,Ea,Qa,wb,xc);this.JNa=this.ZJd=this.mI=null;this.Nli=CommonUIStrings.l_SaveToAnotherFolder;this.rg=Ui.rg;this.hg="FileNameDialog-SaveToSharePoint";this.vWb=Pb;this.yXh=xc}Cja(r){const R=db.a.XG(z.AFrameworkApplication.Eu.Xw),la=z.AFrameworkApplication.breadcrumbFolderName,Ea=z.AFrameworkApplication.breadcrumbBrandName,Qa={["txtFileName"]:r||R};let wb=CommonUIStrings.L_SaveAs;2===z.AFrameworkApplication.Aa.hb.Uk&&
(wb=CommonUIStrings.L_SaveACopy);this.Zi(wb,Object(m.a)(this,this.DPc,"fileNameDialogHandler"),Qa);this.KOf(r,R);this.t_d.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");z.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.mI=document.getElementById("anotherFolder"),r=document.getElementById("folderLocation"),this.ZJd=pa.a.uwf(r,this.mI,"anotherFolderDescribedBy",""),this.mI.className="WACButton WACDialogButtonNormal",
r=!1,la&&la.length?(this.Yrf(this.mI,this.ZJd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ea,la)),r=this.w4h(Ea,la)):this.Yrf(this.mI,this.ZJd,CommonUIStrings.l_CurrentOnlineFolder),this.U5h(this.mI),this.y4h(this.mI),r?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.mI,"SaveToAnotherLocationTwo"),n.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.mI,"SaveToAnotherLocationOne"),
nd.a.addHandler(this.mI,ha.a.click,Object(m.a)(this,this.CIe,"onSaveToAnotherLocationClick")),nd.a.addHandler(this.mI,ha.a.Yf,Object(m.a)(this,this.A5g,"onSaveToAnotherLocationKeyDown")))}w4h(r,R){let la;la=!1;const Ea=document.getElementById("currentLocation");Ea.innerText="";const Qa=this.W3f(Ea,r),wb=this.W3f(Ea,R);let Pb=255,xc=255;255<Qa+wb&&(Pb=Math.max(238,408-Qa),xc=Math.max(170,408-wb),la=!0);this.s7h(Ea,r,xc,R,Pb);return la}W3f(r,R){const la=document.createElement("div");la.innerText=R;
la.style.visibility="hidden";r.appendChild(la);R=la.clientWidth;r.removeChild(la);return R}s7h(r,R,la,Ea,Qa){R&&(this.Xrf(r,R,la),this.h7h(r));Ea&&this.Xrf(r,Ea,Qa)}Xrf(r,R,la){const Ea=document.createElement("div");Ea.innerText=R;Ea.title=R;Ea.className="SaveToAnotherFolderBreadcrumb";Ea.style.maxWidth=la.toString()+"px";r.appendChild(Ea)}h7h(r){const R=document.createElement("span");R.id="FolderSeparator";const la=document.createElementNS("http://www.w3.org/2000/svg","svg");la.setAttribute("class",
"SeparatorCaret");const Ea=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ea.setAttribute("points","1 4 1 11 5 7.5");la.appendChild(Ea);R.appendChild(la);r.appendChild(R)}Yrf(r,R,la){la=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,la);R&&(R.innerText=la);r.tabIndex=0;r.setAttribute(pa.a.ef,pa.a.yu)}y4h(r){const R=document.createElement("span");R.id="anotherFolderText";R.innerText=this.Nli;R.className="AnotherFolderTextSpan";r.appendChild(R)}U5h(r){const R=
document.createElement("span");R.className="cui-img-cont-float cui-img-16by16 ";this.JNa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.JNa.setAttribute("class","FolderIconSVG");const la=document.createElementNS("http://www.w3.org/2000/svg","path");la.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.JNa.appendChild(la);R.appendChild(this.JNa);r.appendChild(R)}A5g(r){!r||r.keyCode!==
Ba.a.tq&&r.keyCode!==Ba.a.DPb||this.CIe(r)}CIe(){if(this.zV){const r=db.a.fT(z.AFrameworkApplication.fileName);let R=this.zV.value;this.hide();R&&""!==R&&""!==r||1===this.Aa.state?(""!==r&&(R+=r),this.mVf(R)?this.HA.create().tv(1,R,!1):this.vWb.start(R,this.yXh)):this.HA.create().tv(2,R,!1)}}Bqi(r){this.mI&&this.JNa&&(r?(this.mI.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.mI,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.JNa,"DisabledFolderIconSVG")):(this.mI.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.mI,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.JNa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.mI,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.JNa,"DisabledFolderIconSVG"))))}$ae(){super.$ae();this.Bqi(!!this.zV&&""!==this.zV.value)}dispose(){this.mI&&(nd.a.removeHandler(this.mI,ha.a.click,Object(m.a)(this,this.CIe,"onSaveToAnotherLocationClick")),nd.a.removeHandler(this.mI,ha.a.Yf,Object(m.a)(this,this.A5g,"onSaveToAnotherLocationKeyDown")),this.mI=
null);super.dispose()}}Object(h.a)(pg,"FileNameDialog",yh,[964]);var Mg=d(1201),gh=d(1202),Ie=d(917),Ia=d(221);class lb{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(h.a)(lb,"SaveAsDialogInput",null,[]);class Lb{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(h.a)(Lb,"SaveLocation",null,[]);var hc=d(89);class Pc{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed){this.lFd=null;this.wK="";this.vWb=r;this.HA=
R;this.ol=ed;this.CBa=la;this.Rh=Qa;this.fF=Ea;this.H5a=Pb;this.Ypb=xc;wb&&(this.lFd=new Od.a(()=>new Cc.a(wb.value,null)))}g7i(){const r=new Mg.a(gh.a.to());r.$("type","currentHost");return Object.assign(new Lb,{folderName:this.fF.breadcrumbFolderName,friendlyPath:this.fF.breadcrumbBrandName,properties:r})}oUj(r){return!!r&&"ClassicMru"===r.type&&!!r.service_info&&!!r.service_info.service_id&&-1!==r.service_info.service_id.indexOf("SHAREPOINT")}tjj(){if(!this.lFd||!this.H5a)return null;var r=this.lFd.value.pda("SaveAsToSharePointDialog",
!1);if(!r||3!==r.state||!r.RZg)return null;r=r.RZg;const R=new da.a;let la=0,Ea=0;for(var Qa=0;Qa<r.length;Qa++){var wb=r[Qa];if(!this.oUj(wb))continue;la++;if(!wb.sharepoint_info)continue;const Pb=wb.url,xc=wb.sharepoint_info.site_url,ed=wb.title;wb=Ie.b(wb,z.AFrameworkApplication.isRtl);if(!(Pb&&xc&&ed&&wb))continue;Ea++;const jd=new Mg.a(gh.a.to());jd.$("type","SharePoint");jd.$("siteUrl",xc);jd.$("folderUrl",Pb);Ea++;R.add(Object.assign(new Lb,{folderName:ed,friendlyPath:wb,properties:jd}))}Qa=
new Map;Qa.set("NumPlaces",r.length.toString());Qa.set("NumSharepointPlaces",la.toString());Qa.set("placesWithMetadata",Ea.toString());ob.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Qa);0<la&&(Ea?.5>1*Ea/la&&ob.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):ob.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return R}$7i(){const r=new da.a;r.add(this.g7i());const R=
this.tjj();R&&r.addRange(R);return Object.assign(new lb,{enableMoreLocations:!z.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.wK,extension:db.a.fT(this.fF.Xw),saveLocations:r.toArray(),scenario:"SaveToSharePoint"})}gSc(){const r=Object(m.a)(this,this.$7i,"getDialogInput"),R={};R.inputPropsCallback=r;return R}Cja(r){this.wK=r;this.wK||(this.wK=String.format(CommonUIStrings.l_SaveACopy_Filename,db.a.XG(this.fF.Xw)));r={["id"]:"SaveAsDialog",["bodyControls"]:this.gSc()};
let R=CommonUIStrings.L_SaveAs;2===this.Rh.hb.Uk&&(R=CommonUIStrings.L_SaveACopy);const la=new kd.a(!1,!1,!0);la.xd=1;la.hg="SaveAsDialog";la.Xe(1,CommonUIStrings.l_SaveButtonLabel);la.Zi(R,Object(m.a)(this,this.f5k,"saveAsDialogHandler"),r)}Gll(r,R){r&&""!==r&&""!==R||1===this.Rh.state?this.nUj()?this.r0j(r,R):(""!==R&&(r+=R),this.vWb.start(r,this.ol)):(n.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.HA.create().tv(2,r,!1))}r0j(r,R){ob.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const la=this.Ypb.KXd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Ypb.U6d(la).then(Ea=>{if(Ea&&0<Ea.length){const Qa=Ea[0][Qc.a.yEk];Ea=Ea[0][Qc.a.EKe];if(""!==Qa&&""!==Ea)this.H5a.E1(Ea,r+R,Qa,this.ol),ob.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.HA.create().tv(0,r,!1);const wb=Ia.a.Rz();wb&&(wb.set("SiteUrlAvailable",""===Qa?"false":"true"),wb.set("FolderUrlAvailable",""===Ea?"false":
"true"));ob.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new hc.a,{extendedProperties:wb}))}}else this.HA.create().tv(0,r,!1),ob.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ea=>{"Canceled"===Ea?((Ea=Ia.a.Rz())&&Ea.set("IsCanceled","true"),ob.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new hc.a,{extendedProperties:Ea}))):ob.Health.instance.recordKpiFailure("SaveACopySFP",
Ea,!1,!1,null)})}nUj(){return this.Ypb?this.Ypb.Jle():(n.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}f5k(r,R){if(R&&1===r){r=R.fileName;var la=db.a.fT(this.fF.Xw);R.moreLocationsSelected&&this.Gll(r,la);if(R.locationCallback){var Ea=R.locationCallback();Ea?Ea.properties&&"currentHost"===Ea.properties.ga("type")?this.CBa.E1(r+la,!1,this.ol):Ea.properties&&"SharePoint"===Ea.properties.ga("type")?(R=Ea.properties.ga("siteUrl"),Ea=Ea.properties.ga("folderUrl"),this.H5a.E1(Ea,
r+la,R,this.ol)):n.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):n.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else n.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(h.a)(Pc,"ReactSaveAsDialog",null,[964]);class Td{constructor(r,R,la,Ea,Qa,wb,Pb,xc=null,ed=null,jd=null){this.Ca=R;this.$a=r;this.nba=Ea;this.CBa=wb;this.HA=Qa;this.Rh=la;this.vnf=Pb;this.qVh=xc;this.H5a=ed;this.Ypb=jd}create(r){return this.Rh&&this.Rh.hb.GC?new Pc(this.vnf,
this.HA,this.CBa,z.AFrameworkApplication.Eu,this.Rh,this.qVh,this.H5a,this.Ypb,r):new pg(this.$a,this.Ca,this.Rh,this.nba,this.HA,this.CBa,this.vnf,r)}}Object(h.a)(Td,"FileNameDialogFactory",null,[927]);class ie{constructor(r,R,la,Ea){this.jo=this.Pha=null;this.$2a=r;this.Rh=la;this.hYh=Ea;this.sha=new Od.a(()=>new Cc.a(R.value,Object(m.a)(this,this.iEa,"getMoreInfoEventReceived")))}get zHb(){this.Pha||(this.sha.value.pda("Save As",!0),this.jo&&this.jo.AR&&this.jo.AR.length&&(this.Pha=this.N8d(this.jo.AR)));
return this.Pha}start(r){if(!this.zHb)if(z.AFrameworkApplication.breadcrumbFolderUrl&&z.AFrameworkApplication.breadcrumbFolderUrl.length)this.Pha=z.AFrameworkApplication.breadcrumbFolderUrl;else return n.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.jo),!1;const R=this.hYh();R.OYe();const la=R.g9d();if(!la)return n.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.$2a.start((Ea,Qa)=>{R.hide();r(Ea,Qa)},()=>{this.NGe(R)},la,this.Pha);return!0}NGe(r){r.hide();n.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}N8d(r){r=r.toLowerCase();r.endsWith("/")||(r+="/");const R=r.indexOf("/documents/");return-1!==R?r.substring(0,R+1)+"_layouts/15/onedrive.aspx":""}iEa(r){this.jo||3!==r.state||(this.jo=r)}}Object(h.a)(ie,"OneDriveFilePickerHelper",null,[926]);class Sd extends kd.a{constructor(){super()}OYe(){this.vxc="FilePickerDialog";
this.rg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.hg="PickerDialog-MsoSp";this.showDialog("",null)}g9d(){return document.getElementById("FilePickerDiv")}AA(){}naa(){}}Object(h.a)(Sd,"PickerDialog",kd.a,[887]);var wf=d(486);class Pf{constructor(r,R,la,Ea,Qa,wb,Pb){this.$a=r;this.WAd=la;this.Ca=R;this.vWb=Ea;this.$2a=Qa;this.oHd=wb;this.iOh=Pb}wb(){const r=this.$2a.axb();r?Ae.a.mx||this.$a.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.ra(u.a.jjb,E.a.frame,Object(m.a)(this,
this.Bnh,"saveToSharePointActionDispatcher"),64):(r.XFa.continueWith(R=>{R.tm&&this.$2a.VHe(R)}),this.RIc()):n.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}RIc(){kc.a.Nkd(Object(m.a)(this,this.Bnh,"saveToSharePointActionDispatcher"));kc.a.s3b([new wf.a(u.a.jjb,E.a.frame,0)],this.$2a.axb())}get wAb(){return this.$a.ka("SaveToAnotherFolderBrsIsEnabled")}get jDf(){return this.$a.ka("UserCanWriteRelative")}Bnh(r,R,la,Ea,Qa){return R.contextId!==E.a.frame||
r!==u.a.jjb?2:this.wAb&&(this.oHd.zHb||this.jDf)?1===la?B.SessionStatusManager.instance.uka||z.AFrameworkApplication.KQ?8:this.iOh()?32:8:2===la?(n.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Qa&&Qa.SaveEntryPoint&&"VersionHistory"===Qa.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.jDf?(n.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.WAd.create(Qa).Cja(null)):(n.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.vWb.start(null,Qa)),32):8:8}}Object(h.a)(Pf,"SaveToSharePointActor",null,[]);class og{constructor(r,R,la,Ea){this.ol=this.ijf=null;this.H5a=r;this.HA=R;this.oHd=la;this.Rh=Ea}start(r,R){n.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.ijf=r;this.ol=R;this.oHd.start((la,Ea)=>{this.PIb(la,Ea)})||this.PYe()}PIb(r,R){if(r)this.onSuccess(R);else this.xz(R)}PYe(){1!==this.Rh.state&&this.HA().iDa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(r){n.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(r&&r.data&&r.data.value&&r.data.value.length&&r.data.value[0].sharePoint){const R=r.data.value[0].sharePoint.url;r=r.data.value[0].sharePoint.listUrl;let la=null;if(R&&(la=r?this.Cjj(r):this.Bjj(R))){this.H5a.E1(R,this.ijf,la,this.ol);return}n.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!R,!la)}n.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.PYe()}Bjj(r){r.endsWith("/")||(r+="/");let R=0;for(let la=0;la<r.length;la++)if("/"===r.charAt(la)&&5===++R)return r.substr(0,la);return null}Cjj(r){r.endsWith("/")&&(r=r.substring(0,r.length-1));const R=r.lastIndexOf("/");return-1!==R?r.substring(0,R):null}xz(r){n.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");r&&r.error?n.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",r.error.errorCode,r.error.message):n.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.PYe()}}Object(h.a)(og,"SaveToSharePointManager",null,[886]);class Dh{constructor(r,R,la,Ea,Qa,wb,Pb,xc){this.GBa=r;this.wK=R;this.Vnb=Ea;this.JId=wb;this.bqa=la;this.B0h=Qa;this.wAa=Pb;this.ol=xc}execute(r,R){if(!z.AFrameworkApplication.Ug&&z.AFrameworkApplication.Ke){var la=this.GBa+this.wAa;la=gb.a.Ki(la,"fu",db.a.Ne(this.bqa));la=gb.a.Ki(la,"su",db.a.Ne(this.B0h));la=gb.a.Ki(la,"fn",db.a.Ne(this.wK));la=gb.a.Ki(la,"n",db.a.Ne((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(la=gb.a.Ki(la,"furl",db.a.Ne(this.ol.FileDownloadUrl)));la=la+"&"+this.JId;this.Vnb&&this.Vnb.length?la=gb.a.Ki(la,"fnn",db.a.Ne(this.Vnb)):n.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");n.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");z.AFrameworkApplication.Ke.mj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,r,R,null,void 0,void 0,void 0,void 0,"9")}}}Object(h.a)(Dh,"SharePointSaveAsCaller",
null,[906]);class Bi{constructor(r){this.dra=r.appSettings.SaveAsToHostWebServiceBase;this.wK=r.appSettings.FileName;this.wAa=r.Ga("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(r,R,la,Ea){return new Dh(this.dra,this.wK,r,R,la,z.AFrameworkApplication.gh,this.wAa,Ea)}}Object(h.a)(Bi,"SharePointUploadCallerFactory",null,[885]);var Vi=d(496);class kh{constructor(r,R,la,Ea,Qa){this.Nn=this.JQb=null;this.exd=!1;this.WJd=this.bqa=null;this.aNd=R;this.xqa=la;this.HA=Ea;this.Rh=Qa;this.Ca=
r}E1(r,R,la,Ea){this.exd=!1;n.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.zrc();this.bqa=r;Ea&&Ea.SaveEntryPoint&&(this.WJd=Ea.SaveEntryPoint);this.JQb=this.aNd.create(r,R,la,Ea);Ea&&"true"===Ea.SkipSaveToHost?this.q3():this.F_i()}F_i(){const r=()=>{n.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.q3()};32!==this.Ca.La(u.a.H_a,2,[()=>{n.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.q3()},r])&&r()}q3(){n.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.JQb.execute(Object(m.a)(this,this.hxk,"onSaveToSharePointUploadFinished"),Object(m.a)(this,this.gxk,"onSaveToSharePointUploadFailed"))}hxk(r){if(r&&r.data&&r.data.Sd){var R;if(({rv:R}=oe.d(r.data.Sd)).returnValue)if(R.StatusCode!==Id.a.Uv&&R.StatusCode!==Id.a.G1b)n.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
r.data.status,R.StatusCode),R.StatusCode!==Id.a.okh&&this.DPf(r.data.status)||(this.bya(R.StatusCode.toString()),this.Jkl(R.StatusCode));else{n.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.XRe();try{R.NewDocumentUrl?this.oib(R.NewDocumentUrl):this.pib()}catch(la){n.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",la.toString())}}else n.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:zf.a.Otc(r.data.Sd)}),
this.FNc()||(this.bya("Failed to deserialize response"),this.xrc())}else n.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.FNc()||(this.bya("Unknown"),this.xrc())}gxk(r){r&&r.data?this.DPf(r.data.status)||(n.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.bya(Vi.a[r.data.status]),this.xrc()):(n.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.FNc()||(this.bya("Unknown"),this.xrc()))}FNc(){if(!this.exd)return n.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.exd=!0,this.q3(),!0;n.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}DPf(r){n.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",r);return this.FNc()}pib(){n.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Oc.a.vn(this.bqa,Oc.a.hba(3),void 0,"UploadToSharePointManager.RedirectToFolder")}oib(r){let R=!1,la=!1;z.AFrameworkApplication.fa&&(R=z.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
la=z.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",r,R);if(R&&la){n.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ea={};Ea[Qc.a.PJb]="1";Ea[Qc.a.documentUrl]=r;Ea[Qc.a.reason]=ld.a.CTe;z.AFrameworkApplication.kT().execute(Qa=>{Qa.sendMessage(id.a.lDa,Ea)})}else Oc.a.vn(r,Oc.a.hba(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}zrc(){this.Rh&&
1===this.Rh.state||(this.Nn=this.xqa(),this.Nn.message=CommonUIStrings.l_CommentProgressTooltip,this.Nn.xd=5,this.Nn.Ar=!1,this.Nn.Qoa(CommonUIStrings.l_DefaultDialogTitle,null,null))}Z7a(){this.Nn&&(this.Nn.close(),this.Nn=null)}xrc(){this.At(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Kll(){this.At(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Qkl(){const r=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.At(CommonUIStrings.l_SaveAsFileTooLargeTitle,r,wg.a.g5k)}At(r,R,la=wg.a.k5k){n.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",r,R);this.Z7a();1!==this.Rh.state&&this.HA().fPf(r,R,la)}Jkl(r){n.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",r);switch(r){case Id.a.dFh:this.Kll();break;case Id.a.okh:this.Qkl();break;default:this.xrc()}}XRe(){"VersionHistory"===this.WJd&&this.Ca.processAction(u.a.Pld,2)}bya(r){"VersionHistory"===this.WJd&&this.Ca.La(u.a.YRe,
2,{["FailureReason"]:r})}}Object(h.a)(kh,"UploadToSharePointManager",null,[884]);class mi{constructor(){this.FDc=this.rGd=this.lGd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Zb(r){this.Da=r;this.lGd=Lf.a.$u(r.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.rGd=Lf.a.$u(r.Ja("Common.IEventEmitter<Common.IMruResult>"));this.FDc=Lf.a.$u(r.Ja("Common.App.SharedFilePicker.ISharedFilePicker"));xh.Task.WAA.call(null,this.lGd,this.rGd,this.FDc).continueWith(()=>
{this.kTk()})}kTk(){this.Da.register(Bi,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").oa(()=>new Bi(z.AFrameworkApplication.fa)).ma();this.Da.register(kh,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").oa(()=>new kh(z.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Zg.a).create(),()=>new Ch,
z.AFrameworkApplication.Aa)).ma();this.Da.register(og,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").oa(()=>new og(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Ch,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),z.AFrameworkApplication.Aa)).ma();this.Da.register(ie,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").oa(()=>
new ie(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Od.a(()=>this.lGd.result),z.AFrameworkApplication.Aa,()=>new Sd)).ma();this.Da.register(Td,"Common.App.SaveToSharePoint.FileNameDialogFactory").oa(()=>new Td(z.AFrameworkApplication.fa,z.AFrameworkApplication.Ta,z.AFrameworkApplication.Aa,z.AFrameworkApplication.Aa.hb,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Od.a(()=>this.rGd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.FDc?this.FDc.result:null)).ma();this.Da.register(Pf,"Common.App.SaveToSharePoint.SaveToSharePointActor").oa(()=>new Pf(z.AFrameworkApplication.fa,z.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>z.AFrameworkApplication.Aa.aJc)).ma();z.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").wb()}static main(){e.a.instance.Dc(new mi)}}Object(h.a)(mi,"PackageManager",null,[2,3]);class sh extends Oa.StandardDialog{constructor(){super();this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose)}tv(r){this.Gy(r,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(h.a)(sh,"ErrorDialog",Oa.StandardDialog,[934]);class Ng{}Ng.default=0;Object(h.a)(Ng,"SaveToCloudErrorCodes",null,[]);class Wh{constructor(r,R,la,Ea,Qa,wb){this.ol=null;this.t0h=r;this.Yba=R;this.OXb=la;this.$a=Ea;this.Kmb=Qa;this.HA=wb}start(r){this.ol=r;if("SharePointOnlineConsumer"===this.$a.Ga("FileSource")){const R=A.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(R){R.start(null,r);return}}this.Yba.wie?(n.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.Doi()):(n.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.qml())}qml(){this.t0h.create().Cja()}At(){this.HA().tv(Ng.default)}Doi(){try{n.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let r={["client_id"]:this.$a.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.Kmb||2===this.Kmb)r={["client_id"]:this.$a.appSettings.UploadToSkyDriveClientId};WL.init(r);n.ULS.sendTraceTag(6590562,216,z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb&&
1===z.AFrameworkApplication.Aa.hb.Uk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(m.a)(this,this.onSuccess,"onSuccess"),Object(m.a)(this,this.xz,"onFailure"))}catch(r){n.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",r,r.stack),this.At()}}onSuccess(r){n.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");r&&r.data&&r.data.folders&&
this.OXb.E1(r.data.folders[0].id,r.data.folders[0].urls.viewInBrowser,null,this.ol)}xz(r){if(r&&r.error){if("user_canceled"===r.error.code){n.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}n.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",r.error.code,r.error.message)}else n.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.At()}}Object(h.a)(Wh,"SaveToCloudManager",null,[933]);class Gg{constructor(r,
R,la,Ea){this.$Cc=null;this.e_h=r;this.$a=la;this.ekf=R;this.Ihf=new lg.a;this.Yh=Ea}wAb(){return this.$a.ka("SaveToCloudStorageUIIsEnabled")}hZf(){return u.a.LTe}RIc(){kc.a.Nkd(Object(m.a)(this,this.ynh,"saveToCloudActionDispatcher"));kc.a.s3b([new wf.a(u.a.LTe,E.a.frame,0)],this.ekf.axb())}wb(){const r=this.ekf.axb();r?(r.DS(()=>{this.Ihf.Gg(!0)}),this.RIc()):n.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Gfh(){n.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")}ynh(r,R,la,Ea,Qa){return R.contextId!==E.a.frame||r!==this.hZf()?2:this.wAb()?1===la?B.SessionStatusManager.instance.uka||z.AFrameworkApplication.KQ?8:32:2===la?(this.Gfh(),Qa&&Qa.FileDownloadUrl&&n.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Yh&&(this.$Cc=this.Yh.Ci("DialogShown","SaveToOneDriveReponseTime")),this.Ihf.task.continueWith(()=>{this.$Cc&&(this.$Cc.stop(),this.$Cc=null);this.e_h.start(Qa)}),
32):8:8}}Object(h.a)(Gg,"SaveToCloudStorageActor",null,[932]);var eg=d(224);class Tj extends Oa.StandardDialog{constructor(r,R,la){super();this.Ca=r;this.Yba=R;this.nba=la;this.GV=!1;this.xd=1;this.xya(1);this.Xe(1,CommonUIStrings.l_SignIn);this.Xe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}Cja(){this.Yba.Ttf(Object(m.a)(this,this.b6g,"onSignIn"));this.Gx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(m.a)(this,this.$Fj,"inputHandler"))}$Fj(r){0===
r?(n.ULS.sendTraceTag(6590598,216,z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb&&1===z.AFrameworkApplication.Aa.hb.Uk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.Dhd()}Pqi(){let r="2";if(this.nba)switch(this.nba.Uk){case 3:r="0";break;case 2:r="3";break;case 1:r="1"}return r}hide(){this.Yba.QXk(Object(m.a)(this,this.b6g,"onSignIn"));super.hide()}Dhd(){var r=z.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";r=new eg.QueryStringBuilder(r);
r.yi("prompt","1");r.yi("cbcxt",this.Pqi());z.AFrameworkApplication.yPa(r);Oc.a.vn(r.toString(),"LoginWindow",void 0,"SignInDialog")}b6g(){this.LQ&&this.hide();n.ULS.sendTraceTag(7143885,216,z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb&&1===z.AFrameworkApplication.Aa.hb.Uk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ca.processAction(u.a.LTe,2)}}Object(h.a)(Tj,"SignInDialog",Oa.StandardDialog,[966]);class aj{constructor(r,R,la){this.Ca=r;this.Yba=
R;this.nba=la}create(){return new Tj(this.Ca,this.Yba,this.nba)}}Object(h.a)(aj,"SignInDialogFactory",null,[931]);class pj{constructor(r,R,la,Ea,Qa,wb,Pb){this.GBa=r;this.wK=R;this.Vnb=la;this.zyc=Ea;this.JId=Qa;this.wAa=wb;this.ol=Pb}execute(r,R){if(!z.AFrameworkApplication.Ug&&z.AFrameworkApplication.Ke){var la=this.GBa+this.wAa;la=gb.a.Ki(la,"fo",db.a.Ne(this.zyc));la=gb.a.Ki(la,"fn",db.a.Ne(this.wK));la=gb.a.Ki(la,"qs",db.a.Ne(this.JId));la=gb.a.Ki(la,"n",db.a.Ne((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(la=gb.a.Ki(la,"furl",db.a.Ne(this.ol.FileDownloadUrl)));this.Vnb&&(la=gb.a.Ki(la,"fnn",db.a.Ne(this.Vnb)));z.AFrameworkApplication.Ke.mj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,r,R,null)}}}Object(h.a)(pj,"SkyDriveUploadCaller",null,[965]);class Ji{constructor(r){this.$a=r;this.dra=r.appSettings.SkyDriveUploadWebServiceBase;this.wK=r.appSettings.FileName;this.wAa=r.Ga("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(r,R,la){return new pj(this.dra,
this.wK,R,r,z.AFrameworkApplication.gh,this.wAa,la)}}Object(h.a)(Ji,"SkydriveUploadCallerFactory",null,[930]);class yg{constructor(r,R,la,Ea,Qa){this.bqa=this.Nn=this.JQb=null;this.o2=!1;this.ol=this.BBa=null;this.aNd=r;this.xqa=R;this.HA=la;this.Rh=Ea;this.Yh=Qa}zrc(){this.Rh&&1===this.Rh.state||(this.Nn=this.xqa(),this.Nn.message=CommonUIStrings.l_CommentProgressTooltip,this.Nn.xd=5,this.Nn.Ar=!1,this.Nn.Qoa(CommonUIStrings.l_DefaultDialogTitle,null,null))}Z7a(){this.Nn&&(this.Nn.close(),this.Nn=
null)}QY(){1!==z.AFrameworkApplication.Aa.state&&this.HA().tv(Ng.default)}pib(){n.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Oc.a.vn(this.bqa,Oc.a.hba(3),void 0,"UploadToCloudManager.RedirectToFolder")}oib(r){let R=!1,la=!1;z.AFrameworkApplication.fa&&(R=z.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),la=z.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(6654163,216,z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb&&1===
z.AFrameworkApplication.Aa.hb.Uk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",r,R);if(R&&la){n.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ea={};Ea[Qc.a.PJb]="1";Ea[Qc.a.documentUrl]=r;z.AFrameworkApplication.kT().execute(Qa=>{Qa.sendMessage(id.a.lDa,Ea)})}else Oc.a.vn(r,Oc.a.hba(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}E1(r,R,la=null,Ea=null){n.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.Yh&&(this.BBa=this.Yh.Ci("DialogShown","SaveToOneDriveUploadTime"));this.zrc();this.bqa=R;this.JQb=this.aNd.create(r,la,Ea);this.ol=Ea;this.q3()}q3(){n.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.JQb.execute(Object(m.a)(this,this.fxk,"onSaveToCloudUploadFinished"),Object(m.a)(this,this.exk,"onSaveToCloudUploadFailed"))}fxk(r){this.Z7a();this.o2=!1;if(r&&r.data&&r.data.Sd){var R;if(({rv:R}=oe.d(r.data.Sd)).returnValue)if(r=R,r.StatusCode!==Id.a.Uv&&r.StatusCode!==Id.a.G1b)n.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.QY();else{n.ULS.sendTraceTag(6590603,216,z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb&&1===z.AFrameworkApplication.Aa.hb.Uk?15:50,"UploadToCloudManager upload success.");try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.oib(r.NewDocumentUrl):this.pib()}catch(la){n.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",la.toString())}this.zlc()}else n.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:zf.a.Otc(r.data.Sd)}),this.QY()}else n.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.QY()}exk(r){5!==r.data.status&&12!==r.data.status||this.o2?(n.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.Z7a(),this.QY(),this.zlc()):(n.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.o2=!0,this.q3())}zlc(){this.BBa&&(this.BBa.stop(),this.BBa=null)}}Object(h.a)(yg,
"UploadToCloudManager",null,[929]);class Aa{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){z.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").wb()}dispose(){}Zb(r){this.Da=r;this.Da.register(aj,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").oa(()=>new aj(z.AFrameworkApplication.Ta,Of.a.instance,z.AFrameworkApplication.Aa.hb)).ma();
this.Da.register(Ji,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").oa(()=>new Ji(z.AFrameworkApplication.fa)).ma();this.Da.register(Gg,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").oa(()=>new Gg(r.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),r.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),z.AFrameworkApplication.fa,z.AFrameworkApplication.Aa.gV)).ma();this.Da.register(yg,
"Common.App.SaveToCloudStorage.UploadToCloudManager").oa(()=>new yg(r.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Zg.a).create(),()=>new sh,z.AFrameworkApplication.Aa,z.AFrameworkApplication.Aa.gV)).ma();this.Da.register(Wh,"Common.App.SaveToCloudStorage.SaveToCloudManager").oa(()=>new Wh(r.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Of.a.instance,r.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),z.AFrameworkApplication.fa,z.AFrameworkApplication.TRa,
()=>new sh)).ma()}static main(){e.a.instance.Dc(new Aa)}}Object(h.a)(Aa,"PackageManager",null,[2,3]);class Ma{static get rg(){return kd.a.sC(Ma.so,CommonUIStrings.l_SaveACopyFileName)}}Ma.so="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(h.a)(Ma,"FileNameDialogHtml",null,[]);class cb extends kd.a{constructor(r,R,la,Ea){super();this.zyc=this.bqa=null;this.Ca=r;this.nba=R;this.OXb=la;this.Xe(1,CommonUIStrings.l_SaveButtonLabel);this.rg=Ma.rg;this.hg="FileNameDialog-SaveACopy";this.ol=Ea}Cja(r,R,la){this.zyc=r;this.bqa=la;r={["txtFileName"]:db.a.XG(z.AFrameworkApplication.Eu.Xw),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,R)};this.Zi(CommonUIStrings.l_SaveToOneDrive,Object(m.a)(this,this.DPc,"fileNameDialogHandler"),
r);n.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}DPc(r,R){1!==r?n.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(r=R.txtFileName.trim(),n.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),R=db.a.fT(z.AFrameworkApplication.fileName),r&&""!==r&&""!==R&&(r+=R),this.OXb.E1(this.zyc,this.bqa,r,this.ol))}}Object(h.a)(cb,"FileNameDialog",kd.a,
[967]);class Fb{constructor(r,R,la){this.Ca=r;this.nba=R;this.OXb=la}create(r){return new cb(this.Ca,this.nba,this.OXb,r)}}Object(h.a)(Fb,"FileNameDialogFactory",null,[935]);class dc extends Oa.StandardDialog{constructor(r){super();this.xd=1;this.Xe(1,CommonUIStrings.l_RetryButtonLabel);this.Xe(0,CommonUIStrings.l_DialogClose);this.Ca=r}tv(r){n.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",r);this.Gy(r,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(m.a)(this,
this.MSe,"retryDialogHandler"))}MSe(r){1===r?(n.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(u.a.upc,2)):n.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(h.a)(dc,"RetryDialog",Oa.StandardDialog,[934]);class zc extends Gg{constructor(r,R,la,Ea){super(r,R,la,Ea);this.rXh=R}wAb(){return this.$a.ka("SaveACopyBrsIsEnabled")}hZf(){return u.a.upc}RIc(){kc.a.Nkd(Object(m.a)(this,this.ynh,"saveToCloudActionDispatcher"));kc.a.s3b([new wf.a(u.a.upc,
E.a.frame,0)],this.rXh.axb())}Gfh(){z.AFrameworkApplication.bGa("CreateCopy_cf;CreateCopy_tf");n.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(h.a)(zc,"SaveACopyActor",Gg,[]);class Vc extends Wh{constructor(r,R,la,Ea,Qa,wb,Pb){super(R,la,Ea,Qa,wb,Pb);this.nRh=r}onSuccess(r){r&&r.data&&r.data.folders?(n.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.nRh.create(this.ol).Cja(r.data.folders[0].id,r.data.folders[0].name,
r.data.folders[0].urls.viewInBrowser)):(n.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.At())}xz(r){r&&r.error&&"user_canceled"===r.error.code&&n.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.xz(r)}At(){n.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.At()}}Object(h.a)(Vc,"SaveACopyManager",Wh,[]);class rd extends yg{constructor(r,R,la,Ea,Qa,wb){super(R,la,Ea,Qa,wb);this.Ca=r}yle(){return!!this.ol&&
!!this.ol.SaveEntryPoint&&"VersionHistory"===this.ol.SaveEntryPoint.toString()}QY(){n.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.yle()&&this.Ca.La(u.a.YRe,2,{["FailureReason"]:"Unknown"});super.QY()}pib(){n.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.yle()&&this.Ca.processAction(u.a.Pld,2);super.pib()}oib(r){n.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",r);this.yle()&&this.Ca.processAction(u.a.Pld,
2);super.oib(r)}q3(){this.ol&&"true"===this.ol.SkipSaveToHost?super.q3():32!==this.Ca.processAction(u.a.H_a,1)?(n.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.q3()):this.Ca.La(u.a.H_a,2,[()=>{n.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");yg.prototype.q3.call(this)},()=>{n.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.QY()}])}}
Object(h.a)(rd,"SaveACopyUploadToCloudManager",yg,[]);class Z{constructor(){this.Da=null}get name(){return"Common.App.SaveACopy"}init(){z.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){z.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").wb()}dispose(){}Zb(r){this.Da=r;this.Da.register(rd,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").oa(()=>new rd(z.AFrameworkApplication.Ta,r.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new Zg.a).create(),()=>new dc(z.AFrameworkApplication.Ta),z.AFrameworkApplication.Aa,z.AFrameworkApplication.Aa.gV)).ma();this.Da.register(Fb,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").oa(()=>new Fb(z.AFrameworkApplication.Ta,z.AFrameworkApplication.Aa.hb,r.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(zc,"Common.App.SaveACopy.SaveACopyActor").oa(()=>new zc(r.resolve("Common.App.SaveACopy.SaveACopyManager"),
r.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),z.AFrameworkApplication.fa,z.AFrameworkApplication.Aa.gV)).ma();this.Da.register(Vc,"Common.App.SaveACopy.SaveACopyManager").oa(()=>new Vc(r.resolve("Common.App.SaveACopy.FileNameDialogFactory"),r.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Of.a.instance,r.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),z.AFrameworkApplication.fa,z.AFrameworkApplication.TRa,()=>new dc(z.AFrameworkApplication.Ta))).ma()}static main(){e.a.instance.Dc(new Z)}}
Object(h.a)(Z,"PackageManager",null,[2,3]);var Da=d(373);class Wa{constructor(r){this.DFg=null;n.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.lgc=z.AFrameworkApplication.fa.Ga("PhoneLinkServiceEndpoint");(this.cM=r)||n.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.lgc&&this.lgc.length||n.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}zWi(r){r&&(this.lgc="https://dcg-df.microsoft.com/",n.ULS.sendTraceTag(526697302,
306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.yWi()}yWi(){n.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.DFg)n.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.DFg=new Date;var r=new Date;this.cM.nV("BayBridge",this.lgc).then(R=>{const la=+new Date-+r;R.IsSuccess?(n.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",
la),this.sWi(R.Token,this.m3i())):n.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",la,R.ErrorCode,R.ErrorMessage)}).catch(R=>{n.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",R,+new Date-+r)})}}sWi(r,R){const la={};la.Authorization="Bearer "+r;la["Authorization-Type"]="AAD";la.Accept="application/json";la["DCG-SessionId"]=
z.AFrameworkApplication.userSessionId;z.AFrameworkApplication.Ke.mj(R,1,null,la,!1,2,Object(m.a)(this,this.zkj,"getStatusSucceeded"),Object(m.a)(this,this.xkj,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");$a.a("FetchAccountLinkedStatus")}p4i(){const r=Da.a.instance.getItem("AccountLinkedStatusCache");return r&&r.length?"true"===r.toLowerCase()?!0:!1:!1}m3i(){return this.lgc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}xkj(){n.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}zkj(r){n.ULS.sendTraceTag(527214157,
352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");r=oe.a(r.data.Sd).state+"";Da.a.instance.setItem("AccountLinkedStatusCache",r)}}Object(h.a)(Wa,"PhoneLinkManager",null,[713]);class ib{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}Zb(r){this.Da=r;this.Da.register(713,"Common.App.PhoneLink.IPhoneLinkManager").ma().oa(()=>new Wa(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){z.AFrameworkApplication.fa.gf(()=>{this.PEa()})}PEa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Dc(new ib)}}
Object(h.a)(ib,"PhoneLinkPackage",null,[2,3]);var nb;(function(r){r[r.myFiles=0]="myFiles";r[r.recent=1]="recent";r[r.currentFolder=2]="currentFolder";r[r.yourPhone=3]="yourPhone"})(nb||(nb={}));Object(h.b)("SharedFilePickerLandingLocation",nb);class jc{constructor(r){this.R$a=this.TIb=null;this._initialized=!1;this.Qce=r}z1d(r){this._initialized||(r.wu(id.a.tfh),r.HB(id.a.tfh,Object(m.a)(this,this.Bwk,"onReceivedPickerResponse")),this._initialized=!0)}U6d(r){return this.R$a=new Promise((R,la)=>{const Ea=
{};Ea[Qc.a.xEk]=r;this.TIb=(Qa,wb)=>{""===wb?(n.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),R(Qa)):("Canceled"===wb?n.ULS.sendTraceTag(572548164,306,50,wb):n.ULS.sendTraceTag(556901065,306,10,wb),la(wb))};this.Qce.execute(Qa=>{this.z1d(Qa);Qa.sendMessage(id.a.bAk,Ea)})})}Bwk(r){this.TIb(r.Values[Qc.a.f7k],void 0===r.Values[Qc.a.xKe]||null===r.Values[Qc.a.xKe]?"":r.Values[Qc.a.xKe])}Jle(){return z.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}KXd(r,R,la,Ea,Qa,wb,
Pb,xc,ed=null){const jd={};jd[Qc.a.Q6k]=r;jd[Qc.a.titleText]=R;jd[Qc.a.bdi]=la;jd[Qc.a.cdi]=Ea;jd[Qc.a.ddi]=Qa;jd[Qc.a.lNi]=!0;jd[Qc.a.TWi]=wb;jd[Qc.a.AEk]=Pb;jd[Qc.a.zEk]=nb[xc];Bb.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(jd[Qc.a.BEk]="Dark");ed&&(null!=ed.vrb&&(jd[Qc.a.vrb]=ed.vrb),null!=ed.tyb&&(jd[Qc.a.tyb]=ed.tyb));return jd}}Object(h.a)(jc,"SharedFilePickerManager",null,[746]);class cc{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}Zb(r){this.Da=
r;r.register(jc,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().oa(()=>new jc(r.Ja("Postmessage.IHostPostmessenger")))}init(){z.AFrameworkApplication.fa.gf(()=>{this.PEa()})}PEa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Dc(new cc)}}Object(h.a)(cc,"SharedFilePickerPackage",null,[2,3]);class Ad{constructor(r,R=3E4){this.mwl=9E5;this.qwl=1E4;this.qtg=this.TDb=null;this.fqe=0;
this.a2b=Date.now;this.GUc=r;this.etd=R;this.jRc()}f8f(r=!0){const R=this.a2b();if(R<this.fqe+this.mwl)return R>this.fqe+this.qwl&&this.jRc(),this.qtg;r&&this.jRc();return null}getToken(r=!0){return(r=this.f8f(r))?Promise.resolve(r):this.jRc()}jRc(){return this.TDb=this.TDb||new Promise(r=>{this.GUc().then(R=>{this.TDb=null;""!==R&&R&&(this.qtg=R,this.fqe=this.a2b(),r(R));r(null)}).catch(()=>{this.TDb=null;r(null)});window.setTimeout(()=>{this.TDb=null;r(null)},this.etd)})}}Object(h.a)(Ad,"OAuthCacheManager",
null,[]);var Xd=d(106),xe=d(69);class Ff{static u5d(r){return""!==r&&r?Ff.Cdi[r.toLowerCase()]:""}static Emj(r,R){const la=Date.now();var Ea=Ff.HKc();const Qa=z.AFrameworkApplication.fa.Ga("UserPrincipalName"),wb=Ff.u5d(r);n.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+r);if(""===Qa||!Qa)return n.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===wb||!wb)return n.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+
r),Promise.resolve("");const Pb=Xd.a.create().toString();Ea=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none","https://login.microsoftonline.com",wb,encodeURIComponent(R),encodeURIComponent(Qa),encodeURIComponent(Ea),Pb);const xc=document.createElement("iframe");xc.style.display="none";xc.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");xc.src=
Ea;document.body.appendChild(xc);return new Promise(ed=>{Ff.Dmk(xc.contentWindow).then(jd=>{document.body.removeChild(xc);const bd=new xe.a,Ce=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Bf;for(;Bf=Ce.exec(jd);)3!==Bf.length&&(n.ULS.sendTraceTag(593862983,1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Bf.length),ed("")),bd.$(Bf[1],Bf[2]);bd.Hb("access_token")?(n.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",R,r,Date.now()-
la),ed(bd.ga("access_token"))):(n.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",R,r,(Date.now()-la).toString()),ed(""))}).catch(jd=>{try{document.body.removeChild(xc)}catch(bd){}n.ULS.sendTraceTag(593862980,1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",R,r,JSON.stringify(jd),(Date.now()-la).toString());ed("")})})}static HKc(){const r=window.location.protocol,R=window.location.host;var la=z.AFrameworkApplication.fa.Ga("OAuthManagerHostPathOverride");
if(void 0===la||null===la){la=window.location.pathname;const Ea=la.lastIndexOf("/");la=0<=Ea?la.substring(0,Ea+1):""}return r+"//"+R+la+"WacOAuth.html"}static Dmk(r){return new Promise((R,la)=>{let Ea=0,Qa=0;Qa=window.setInterval(()=>{if(200<Ea++)window.clearInterval(Qa),la("Exceeded 10000ms timeout after 200 polls");else{var wb=null,Pb=null;try{if(!r||r.closed){window.clearInterval(Qa);la("Window or Frame is closed before completion");return}wb=r.location.href;Pb=r.location.hash}catch(xc){}wb&&"about:blank"!==
wb&&Pb&&""!==Pb&&(window.clearInterval(Qa),R(Pb))}},50)})}}Ff.Cdi={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(h.a)(Ff,"OAuthHelper",null,[]);class xg{constructor(r,R){this.token=r;this.source=R}}Object(h.a)(xg,"TokenResult",null,[]);class Eg{constructor(){this.cM=null;this.Yaf={};this.wOb=new Mg.a(gh.a.to())}getToken(r,R,la=!1){if(this.wOb.Hb(R))return this.wOb.ga(R).getToken();const Ea=new Ad(()=>la?this.g8f(r,R):this.GUc(r,R));
this.wOb.$(R,Ea);return Ea.getToken()}Cmj(r,R,la=!1){if(this.wOb.Hb(R))return this.wOb.ga(R).f8f();const Ea=new Ad(()=>la?this.g8f(r,R):this.GUc(r,R));this.wOb.$(R,Ea);return null}GUc(r,R){const la=Date.now();return Ff.Emj(r,R).then(Ea=>new xg(Ea,"SSOStack")).then(Ea=>new Promise(Qa=>{Ea.token&&""!==Ea.token?(n.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",r,Ea.source,Date.now()-la),this.T_a("GetTokenInternal",!0,Date.now()-la,r,"","",R),Qa(Ea.token)):(n.ULS.sendTraceTag(593862978,
1300,50,"{0}: SSO Token provider failed! Latency: {1}",r,Date.now()-la),this.T_a("GetTokenInternal",!1,Date.now()-la,r,"GetTokenSilent Failed","SSO Token provider failed!",R),Qa(""))}))}g8f(r,R){if(!this.cM)try{this.cM=A.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(la){n.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+la)}return this.cM?new Promise(la=>{const Ea=Date.now();this.cM.nV(r,R).then(Qa=>{const wb=Qa.Token;!Qa.IsSuccess||this.cWj(wb)?(this.T_a("GetTokenInternalImplicitJS",
!1,Date.now()-Ea,r,Qa.ErrorCode,Qa.ErrorMessage,R),la(null)):(this.T_a("GetTokenInternalImplicitJS",!0,Date.now()-Ea,r,Qa.ErrorCode,Qa.ErrorMessage,R),la(wb))}).catch(Qa=>{Qa=Qa?oe.c(Qa):"";this.T_a("GetTokenInternalImplicitJS",!1,Date.now()-Ea,r,"Caught Exception",Qa,R);la(null)})}):new Promise(la=>{this.T_a("GetTokenInternalImplicitJS",!1,0,r,"Null OAuthManager","OAuthManager not set");la(null)})}T_a(r,R,la,Ea,Qa="",wb="",Pb=""){var xc="Search"===Ea;const ed=[];r=ij.a.I8(xc?"Event":"EventName",
r,2);Ea=ij.a.I8("AppName",Ea,2);Array.add(ed,r);Array.add(ed,Ea);xc&&(Ea=ij.a.I8("LatencyType","FetchToken",2),Array.add(ed,Ea));Qa&&""!==Qa&&(Qa=ij.a.I8("ErrorCode",Qa,2),Array.add(ed,Qa));wb&&""!==wb&&(wb=ij.a.I8("ErrorMessage",wb,2),Array.add(ed,wb));Pb&&""!==Pb&&(wb=!(Pb in this.Yaf),this.Yaf[Pb]=wb,wb=ij.a.I8("WarmUpCall",wb.toString(),1),Array.add(ed,wb),Pb=ij.a.I8("Service",this.fUc(Pb),2),Array.add(ed,Pb));xc=xc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";
R=Object.assign(new ig.a,{name:xc,samplingPolicy:2,dataFields:ed,succeeded:R,durationMs:la});v.a.sendActivityEvent(R)}fUc(r){return r===z.AFrameworkApplication.Koe?"Loki":r===z.AFrameworkApplication.U_e?"Substrate":z.AFrameworkApplication.fa&&r===z.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}cWj(r){return!r||!r.length}}Object(h.a)(Eg,"SearchOAuthManager",null,[712]);class De{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}Zb(r){this.Da=
r;this.Da.register(712,"Common.App.SearchCommon.ISearchOAuthManager").ma().oa(()=>new Eg)}init(){}dispose(){}static main(){e.a.instance.Dc(new De)}}Object(h.a)(De,"SearchOAuthPackage",null,[2,3]);var zd;(function(r){r[r.generalException=0]="generalException";r[r.invalidArgument=1]="invalidArgument";r[r.notAllowed=2]="notAllowed";r[r.apiNotAvailable=3]="apiNotAvailable";r[r.unresolvedPendingRequest=4]="unresolvedPendingRequest";r[r.timeout=5]="timeout";r[r.adalTimeout=6]="adalTimeout";r[r.userNotSignedIn=
7]="userNotSignedIn";r[r.userAborted=8]="userAborted";r[r.silentSignInFailed=9]="silentSignInFailed";r[r.invalidResourceUrl=10]="invalidResourceUrl";r[r.invalidGrant=11]="invalidGrant";r[r.connectionLost=12]="connectionLost";r[r.clientError=13]="clientError";r[r.serverError=14]="serverError"})(zd||(zd={}));Object(h.b)("ErrorCodes",zd);class Gd{}Object(h.a)(Gd,"HostApplicationType",null,[]);class fd{constructor(r,R){this.requestCallback=this.requestParameters=null;this.requestParameters=r;this.requestCallback=
R}}Object(h.a)(fd,"OutstandingRequest",null,[]);class Mc{}Mc.mok="AADSTS50058";Mc.invalidResourceUrl="AADSTS50001";Mc.gok="AADSTS65001";Mc.zok="AADSTS70011";Mc.userAborted="13002";Mc.nGk="Popup Window is null";Mc.mGk="Popup Window closed";Mc.adalTimeout="Token renewal operation failed due to timeout";Mc.rwl="tokenRevoked";Object(h.a)(Mc,"WopiHostErrorType",null,[]);var uk=d(226),Ki=d(352),bj=d(975);class wi{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=
""}}Object(h.a)(wi,"WopiIdentityInfo",null,[785]);class za{constructor(r,R,la){this.expiration=this.authority=this.accessToken=null;this.accessToken=r;this.authority=R;this.expiration=la}}Object(h.a)(za,"WopiIdentityToken",null,[784]);class sb{constructor(r){this._initialized=!1;this.EHb={};this.urd={};this.Maa=z.AFrameworkApplication.Aa.gV;this.Qce=r}z1d(r){this._initialized||(r.wu(id.a.eah),r.HB(id.a.eah,Object(m.a)(this,this.zwk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(r,
R,la=null){this.B4j(r,R);return new Promise((Ea,Qa)=>{if(this.qie(R))if(R in this.EHb)Qa("unresolvedPendingRequest");else{var wb=window.setTimeout(()=>{n.ULS.sendTraceTag(37856032,344,10,oe.c({["error"]:"Request timeout.",["callerId"]:R}));Qa("timeout")},12E4);this.e5d(r,R,la,(Pb,xc)=>{window.clearTimeout(wb);Pb?Ea(Pb):(n.ULS.sendTraceTag(37856033,369,15,oe.c({["error"]:zd[xc]})),Qa(xc))})}else n.ULS.sendTraceTag(37856034,344,10,oe.c({["error"]:"Caller is not allowed."})),Qa("notAllowed")})}getPrimaryIdentityInfo(r){return new Promise((R,
la)=>{this.qie(r)?this.Tfj((Ea,Qa)=>{Ea?R(Ea):(n.ULS.sendTraceTag(37856064,369,10,oe.c({["error"]:Qa.toString()})),la(Qa))}):(n.ULS.sendTraceTag(37856065,344,10,oe.c({["error"]:"Caller is not allowed."})),la("notAllowed"))})}getAuthContext(r){return new Promise((R,la)=>{const Ea=this.getAuthContextSync(r);Ea?R(Ea):la("notAllowed")})}getAuthContextSync(r){if(this.qie(r)){const R=new bj.a;R.upn=z.AFrameworkApplication.fa.Ga("UserPrincipalName");R.userId=z.AFrameworkApplication.fa.Ga("LoggableUserId");
R.authority=z.AFrameworkApplication.fa.Ga("HostAuthAuthority");R.tenantId=z.AFrameworkApplication.fa.Ga("TenantId");R.isAnonymous=z.AFrameworkApplication.fa.ka("IsAnonymousUser");R.supportsAuthToken=this.Vzj(r);r=z.AFrameworkApplication.fa.Ga("HostAuthType");R.authorityType="aad"===r.toLowerCase()?2:"msa"===r.toLowerCase()?1:0;return R}n.ULS.sendTraceTag(40751647,344,10,oe.c({["error"]:"Caller is not allowed."}));return null}Vzj(r){const R=uk.OAuthManagerSettings.Q$a;return Ae.a.NFa?R&&uk.OAuthManagerSettings.WAh?
Array.contains(uk.OAuthManagerSettings.WAh,r.toLowerCase()):!1:R}e5d(r,R,la,Ea){var Qa=[];Array.add(Qa,Object.assign(new J.a,{name:"CallerId",string:R}));Array.add(Qa,Object.assign(new J.a,{name:Qc.a.YZe,string:r.correlationId}));v.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Qa}));Qa=Ki.a.create().toString();const wb="getAccessToken_"+Qa,Pb=this.Maa.Ci("ComponentAttach",wb);this.urd[wb]=Pb;const xc={};xc[Qc.a.ZZe]=Qa;
xc[Qc.a.Dpl]=r.resource;xc[Qc.a.Epl]=r.scope;xc[Qc.a.Nxh]=z.AFrameworkApplication.fa.Ga("HostAuthType");xc[Qc.a.Hpl]=z.AFrameworkApplication.fa.Ga("UserPrincipalName");xc[Qc.a.Fpl]=r.silentLogin;xc[Qc.a.Apl]=r.options;xc[Qc.a.YZe]=r.correlationId;xc[Qc.a.Bpl]=R;la&&(xc[Qc.a.addinName]=la.AddinName,xc[Qc.a.zpl]=la.AddinTrustId);this.Qce.execute(ed=>{this.z1d(ed);ed.sendMessage(id.a.getAuthToken,xc)});this.EHb[Qa]=new fd(r,Ea)}Tfj(r){const R=z.AFrameworkApplication.fa.Ga("UserName"),la=z.AFrameworkApplication.fa.Ga("UserPrincipalName"),
Ea=z.AFrameworkApplication.fa.Ga("LoggableUserIdSpace"),Qa=new wi;Qa.email=la;Qa.displayName=R;switch(Ea){case "OrgIdPuid":Qa.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Qa.authority="MicrosoftAccount";break;default:Qa.authority=Ea}r(Qa,null)}zwk(r){let R=null;try{let Ea=r.Values[Qc.a.ZZe];const Qa=r.Values[Qc.a.ypl],wb=r.Values[Qc.a.Nxh],Pb=r.Values[Qc.a.Gpl];let xc=null,ed=null;const jd=this.EHb[Ea];if("undefined"!==typeof jd&&jd){var la=[];Array.add(la,Object.assign(new J.a,
{name:Qc.a.YZe,string:jd.requestParameters.correlationId}));v.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:la}));R=jd.requestCallback;delete this.EHb[Ea];"undefined"!==typeof Qa&&Qa&&Qa.length?ed=new za(Qa,wb,Pb):xc=zd[this.Ojk(r)];la="getAccessToken_"+Ea;la in this.urd&&(this.urd[la].stop(),delete this.urd[la]);R(ed,xc)}else n.ULS.sendTraceTag(37856066,344,10,oe.c({["error"]:"No matching outstanding request for request ID.",
["requestId"]:Ea}))}catch(Ea){r=r.Values[Qc.a.ZZe],r in this.EHb&&delete this.EHb[r],this.Y1c(),n.ULS.sendTraceTag(37856067,344,10,oe.c({["error"]:Ea.message,["stack"]:Ea.stack})),R&&R(null,"generalException")}}qie(r){var R=z.AFrameworkApplication.Yoj();r=r.toLowerCase();for(const la of R)if(r===la.toLowerCase())return!0;R=uk.OAuthManagerSettings.wQd;for(let la in R)if(r===R[la].toLowerCase())return!0;return!1}Ojk(r){r=r.Values[Qc.a.Cpl];this.Y1c();n.ULS.sendTraceTag(39068821,344,15,oe.c({["error"]:r}));
return r?-1<r.indexOf(Mc.mok)?9:-1<r.indexOf(Mc.nGk)||-1<r.indexOf(Mc.mGk)?12:-1<r.indexOf(Mc.invalidResourceUrl)?10:-1<r.indexOf(Mc.userAborted)?8:-1<r.indexOf(Mc.zok)||-1<r.indexOf(Mc.gok)||r===Mc.rwl?11:-1<r.indexOf(Mc.adalTimeout)?6:0:13}B4j(r,R){r=this.ISk(r.resource);n.ULS.sendTraceTag(39921882,344,50,oe.c({["callerId"]:R,["resource"]:r}))}Y1c(){n.ULS.sendTraceTag(39068822,344,50,oe.c({["userAgent"]:window.navigator.userAgent}))}ISk(r){return(r?r:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(h.a)(sb,"WopiIdentityManager",null,[745]);class Nb{constructor(){this.Da=null}get name(){return"Common.App.WopiIdentity"}Zb(r){this.Da=r;r.register(sb,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().oa(()=>new sb(r.Ja("Postmessage.IHostPostmessenger")))}init(){z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(r){n.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+r)}}dispose(){}static main(){e.a.instance.Dc(new Nb)}}Object(h.a)(Nb,"WopiIdentityPackage",null,[2,3]);var Ac=d(667);class Jd extends Ac.a{constructor(r,R){super(r,gb.a.sQ(R))}Vxa(r,R){this.isEnabled()&&this.LBa(this.KLa)&&(this.wu(r),this.HB(r,R))}}Object(h.a)(Jd,"InsertMediaCrossDocumentMessenger",Ac.a,[773,469,106]);class ge{getInstance(r,R){return new Jd(r,R)}}Object(h.a)(ge,"InsertMediaCrossDocumentMessengerFactory",null,[734]);
class re{constructor(r,R,la){this.correlationId=null;this.s5=0;this.insertPictureTelemetryEndpoint=null;this.u_d=0;this.ESh=r;this.LXb=[];this.CSh=R;this.npf=la.split(";")}QMb(r,R){Array.clear(this.LXb);r=this.ESh.value;r.qBl(R.fyb);r.LBa(this.CSh);r.wu(R.fyb);r.HB(R.fyb,la=>{this.OHe(la,R)});n.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");r.sendMessage(R.wLf,{["FileExtensionFilterList"]:this.npf})}g8h(r){Array.contains(this.LXb,r)||
Array.add(this.LXb,r)}OHe(r,R){n.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");r=R.h9g(r);const la=[];for(let Ea=0;Ea<r.length;Ea++){const Qa=r[Ea];R.kZc(Qa,this.npf)?Array.add(la,Qa):this.g8h(R.L5f(Qa))}la&&la.length?R.Yta(la):n.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.LXb.length&&(R=this.LXb.join(", "),n.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",
R),this.Qml(R))}Qml(r){const R=new Oa.StandardDialog;R.xd=0;R.fP(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,r),null)}dispose(){}}Object(h.a)(re,"InsertMediaFromHostManager",null,[733,106]);class Xe{constructor(r){this.gTh=r}getInstance(){return this.gTh}}Object(h.a)(Xe,"InsertMediaFromHostManagerFactory",null,[731,732]);class $f{constructor(){this.oSb=document.createElement("iframe");this.oSb.src="about:blank";this.oSb.style.visibility=
"hidden";this.oSb.style.position="absolute";this.oSb.style.zIndex="-100"}get L8a(){return this.oSb}}Object(h.a)($f,"InsertMediaFromHostOneDriveHostFrame",null,[730]);class Tg extends Ac.a{constructor(r,R){super(r,"*"===R?R:gb.a.sQ(R));this.Rrf(id.a.insertImage);this.Rrf(id.a.Eee)}reportDocumentLoadedTime(){}}Object(h.a)(Tg,"InsertMediaFromOneDriveCrossDocumentMessenger",Ac.a,[729,469,106]);var hh=d(270),qj=d(541);class de{mHc(r){switch(r){case 1:r=8;break;case 4:r=3;break;case 2:r=0;break;default:r=
0}return r}vki(r,R){return String.format(R,this.mHc(r))}uki(r,R,la,Ea,Qa,wb,Pb){r=this.mHc(r);const xc=hh.a.xe(z.AFrameworkApplication.lcid).name,ed=z.AFrameworkApplication.buildVersion;z.AFrameworkApplication.bGa("ShIns226;ShIns226cf");return String.format(R,z.AFrameworkApplication.lcid,xc,ed,Qa,r,wb,la,Ea,Pb)}yki(r,R){r=this.mHc(r);const la=z.AFrameworkApplication.buildVersion,Ea=0<la.indexOf(".")?la.substring(0,la.indexOf(".")):"16";return String.format(R,z.AFrameworkApplication.lcid,z.AFrameworkApplication.lcid,
z.AFrameworkApplication.lcid,r,Ea,la,"Video",0,0)}xki(r,R,la,Ea,Qa,wb,Pb){const xc=hh.a.xe(z.AFrameworkApplication.lcid).name;r=String.format(R,z.AFrameworkApplication.lcid,xc,z.AFrameworkApplication.buildVersion,la,this.mHc(r),Ea);Qa&&(r+="&flipgrid=1");wb&&(Qa=new eg.QueryStringBuilder(r),Qa.yi("stream2","1"),r=Qa.toString());"defaultModal"!=Pb&&(Qa=new eg.QueryStringBuilder(r),Qa.yi("modalvariation",Pb),r=Qa.toString());return r}j9g(r){if(!r||!r.Values)return null;r=r.Values;if(!r)return null;
let R="";"sourceProvider"in r&&(R=r.sourceProvider||"");return Object.assign(new qj.a,{Action:r.action||"",Caption:r.caption||"",ContentType:r.contentType||"",Type:r.extension||"",PageUrl:r.pageUrl||"",OriginalUrl:r.sourceUrl||"",ContentProvider:R,ThumbnailUrl:r.thumbnailUrl||"",LicenseUrl:r.licenseUrl||"",LicenseDisplayName:r.licenseDisplayName||"",Height:r.height||0,Width:r.width||0,SvgContent:r.svgContent||"",Description:r.description||"",ProviderName:r.providerName||"",StartInsertTime:r.startInsertTime||
0})}PCk(r){const R=[];if(!r||!r.Values||!r.Values.Items)return R;r=r.Values.Items;for(let Ea=0;Ea<r.length;Ea++){var la=r[Ea];la&&(la=Object.assign(new qj.a,{Type:la.Extension||"",OriginalUrl:la.SourceUrl||"",Caption:la.caption,Description:la.description||"",Height:la.Height||0,Width:la.Width||0}),Array.add(R,la))}return R}kZc(r,R){if(!r)return!1;for(let la=0;la<R.length;la++)if(0<=r.toLowerCase().indexOf(R[la]))return!0;return!1}HIk(r){let R="";if(r)for(let la=0;la<r.length;la++){const Ea=r[la];
Ea&&(R+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Ea.OriginalUrl,Ea.Width,Ea.Height))}return R}Znj(r){return(r=de.o4k.exec(r))&&2<r.length?r[2].trim():""}}de.o4k=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(h.a)(de,"InsertMediaHelper",null,[726]);var Yf=d(34);class vk{constructor(r){this.rTb=Yf.a.insertHyperlink;this.Ca=r}get Zy(){return this.rTb}set Zy(r){this.rTb=r}Yta(r){try{n.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
r.length);for(let R=0;R<r.length;R++)this.Ca.La(this.Zy,2,r[R]);n.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",r.length)}catch(R){n.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",R.toString())}}}Object(h.a)(vk,"InsertOneDriveFileHandler",null,[725]);class Gj extends vk{constructor(r){super(r)}get wLf(){return id.a.Eee}get fyb(){return id.a.mGj}h9g(r){return r&&r.Values&&"Items"in r.Values?
r.Values.Items:null}L5f(){S.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}kZc(){return!0}och(r,R,la){r=la(r);r.length&&(la={},la.Items=r,R.sendMessage(this.fyb,la))}i9g(r){const R=[];for(let la=0;la<r.data.value.length;la++){const Ea=r.data.value[la];if(Ea){const Qa={};Qa.DisplayText=Ea.name;Qa.Url=Ea.urls.download;Qa.sourceUrl=Ea.urls.download;Qa.caption=Ea.name;Array.add(R,Qa)}}return R}}Object(h.a)(Gj,"InsertOneDriveFileHelper",
vk,[724,725]);class Pm extends kd.a{constructor(){super()}OYe(){this.vxc="FilePickerDialog";this.rg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.hg="PickerDialog-Livebooks";this.showDialog("",null)}g9d(){return document.getElementById("OpenFilePickerDiv")}AA(){}naa(){}}Object(h.a)(Pm,"PickerDialog",kd.a,[768]);class ok{constructor(r,R,la){this.jo=this.Pha=null;this.$2a=r;this.qId=la;this.sha=new Od.a(()=>new Cc.a(R.value,Object(m.a)(this,this.iEa,"getMoreInfoEventReceived")))}get zHb(){this.Pha||
(this.sha.value.pda("InsertFromOneDrive",!0),this.jo&&this.jo.AR&&this.jo.AR.length&&(this.Pha=this.N8d(this.jo.AR)));return this.Pha}N8d(r){r=r.toLowerCase();r.endsWith("/")||(r+="/");const R=r.indexOf("/documents/");return-1!==R?r.substring(0,R+1)+"_layouts/15/onedrive.aspx":""}iEa(r){this.jo||3!==r.state||(this.jo=r)}start(r){if(!this.zHb)if(z.AFrameworkApplication.breadcrumbFolderUrl&&z.AFrameworkApplication.breadcrumbFolderUrl.length)this.Pha=z.AFrameworkApplication.breadcrumbFolderUrl;else{n.ULS.sendTraceTag(26071185,
352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.jo);return}const R=new Pm;R.OYe();const la=R.g9d();la?this.$2a.start((Ea,Qa)=>{R.hide();this.PIb(Ea,Qa,r)},()=>{this.NGe(R)},la,this.Pha):n.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}NGe(r){r.hide();n.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}PIb(r,R,la){n.ULS.sendTraceTag(26071188,
352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",r);r&&R&&R.data&&R.data.value&&0<R.data.value.length?(r=this.qId.getInstance(window.frames[0].parent,window.document.URL),la.och(R,r,Object(m.a)(la,la.i9g,"parseOneDriveV7Response"))):n.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(h.a)(ok,"OneDriveFilePickerHelperV7",null,[722,723]);class wk{constructor(r,R,la,Ea){this.ia=R;this.la=
r;this.H4=this.la.aua;this.KL=la;this.Rrg=Ea}get SP(){return this.Rrg?this.Rrg.instance:null}wb(){this.ia.ra(u.a.w1c,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"),4);this.ia.ra(u.a.$5a,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"),4);this.ia.ra(u.a.QPe,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"),4);this.ia.ra(u.a.YIb,mb.a.application,Object(m.a)(this,this.YIb,"queryAddInCommandsLoadStatus"),96);this.ia.ya(u.a.hYe,
mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"));this.ia.ra(u.a.maa,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"),64);this.ia.ra(u.a.HKb,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"),64);this.ia.ya(u.a.wrc,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"));this.ia.ra(u.a.a8b,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"),64);this.ia.ya(u.a.LMb,mb.a.application,
Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"));this.ia.ya(u.a.I3b,mb.a.application,Object(m.a)(this,this.yza,"triggerCommandforAddinCommands"))}Ee(){}yza(r,R,la,Ea,Qa){if(!this.H4)return 16;if(1===la)return R=r===u.a.$5a&&(!this.SP||!this.SP.$pj(Qa)),r=r===u.a.$5a&&!!this.SP&&this.SP.Ygl(Qa),R||r?8:32;if(this.SP)switch(r){case u.a.w1c:this.SP.x1c(Qa);break;case u.a.$5a:this.SP.k7b(Qa);break;case u.a.YIb:this.SP.Wch(Qa);break;case u.a.hYe:this.SP.Xjl();break;case u.a.maa:this.SP.zLk(Qa);
break;case u.a.HKb:this.SP.HKb(Qa);break;case u.a.QPe:this.SP.KSk();break;case u.a.wrc:this.SP.wrc(Qa);break;case u.a.a8b:this.SP.a8b(Qa);break;case u.a.LMb:this.SP.LMb(Qa);break;case u.a.I3b:this.SP.I3b(Qa)}else this.KL.Zia(),this.KL.xPa(r,Qa);return 32}YIb(r,R,la,Ea,Qa){if(!this.H4)return 16;this.SP&&this.SP.Wch(Qa);return 32}}Object(h.a)(wk,"AddinCommandsActor",null,[352]);var Am=d(1001),Fk=d(211),Ih=d(87),yj=d(168),zj=d(43),Zl=d(1024),vn=d(276);class lm{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,
bd,Ce,Bf,Df,Eh,jk,tj,rk,ul,Tn,Un,Yh,Vn,Wn,Gn,jl){this.Ucc=null;this.vsg=!1;this.EWa=null;this.Exg=Db.a("PartialDoc.SkipCutCopyCallout");if(!jl)throw Error.argumentNull("calloutNotificationAdapter");this.ia=r;this.hf=R;this.Ea=la;this.pa=Ea;this.ut=Qa;this.vE=wb;this.rSg=Pb;this.r9j=xc;this.rek=ed;this.K3c=jd;this.Rb=bd;this.T5c=rk.ucg;this.Ou=Ce;this.oc=Tn;this.Y4j=rk.powerPointEditorDownloadACopyUiIsEnabled;this.ddk=Bf;this.q4c=Df;this.Xa=tj;this.KXa=!rk.vg;this.HQg=Un;this.jTg=Vn;this.iFg=Wn;this.yw=
Gn;this.Rvg=!rk.printingEnabled||ul.ka("DisablePrint");this.Svg=Eh;this.gl=jk;this.w7j=ul.Ga("DownloadPdfFromPodsUrl");this.m_printUrl=ul.Ga("PrintPdfFromPodsUrl");this.v7j=ul.Ga("DownloadOdpFromPodsUrl");this.iwg=ul.Ga("DownloadImagesFromPodsUrl");this.Sek=ul.ka("UseToastForDeferredBlobsEnabled");this.Vfk=rk.pptAppendFileNameToQueryUrlForDocumentOperationsActor;r=(z.AFrameworkApplication.fileName||"").toLowerCase();rk.vg&&rk.ULj?(this.vsg=!0,this.Ucc=ul.Ga("DownloadACopyPodsUrl")):!rk.vg&&rk.XSj&&
(r.endsWith(".pptx")||r.endsWith(".ppsx"))?this.Ucc=this.qjk():this.Ucc=z.AFrameworkApplication.xRa;this.Bve=Yh;this.O$j=rk.e_c;this.Gwa=A.a.instance.Ja("Common.ISystemInitiatedFeedback");this.s$j=ul.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.LL=jl}wb(){const r=!!this.Svg&&!this.HQg();N.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.Rvg,r);this.Rvg?r&&this.gl.nll(this.Svg):(this.ia.ya(ab.a.print,mb.a.application,Object(m.a)(this,
this.Fuj,"handlePrint")),this.ia.ya(ab.a.downloadACopy,mb.a.application,Object(m.a)(this,this.downloadACopy,"downloadACopy")),this.ia.ya(ab.a.L2b,mb.a.application,Object(m.a)(this,this.L2b,"downloadACopyAsPdf")),this.ia.ya(ab.a.K2b,mb.a.application,Object(m.a)(this,this.K2b,"downloadACopyAsOdp")),this.ia.ya(ab.a.M2b,mb.a.application,Object(m.a)(this,this.M2b,"downloadAsImages")),this.ia.ya(ab.a.KTe,mb.a.application,Object(m.a)(this,this.KTe,"saveSlidesAsImages")),this.ia.ya(ab.a.hmc,mb.a.application,
Object(m.a)(this,this.aIk,"pptoSaveACopy")),this.ia.ya(ab.a.tLe,mb.a.application,Object(m.a)(this,this.bIk,"pptoSaveAsToHost")),this.ia.ya(ab.a.uLe,mb.a.application,Object(m.a)(this,this.cIk,"pptoSaveToSharePoint")),this.ia.ya(ab.a.iMe,mb.a.application,Object(m.a)(this,this.Huj,"handlePrintNotes")),this.ia.ya(ab.a.gMe,mb.a.application,Object(m.a)(this,this.Guj,"handlePrintHandouts")));this.ia.ya(u.a.H_a,mb.a.application,Object(m.a)(this,this.H_a,"saveFileChange"));this.rSg&&this.ia.ra(ab.a.wjd,mb.a.application,
Object(m.a)(this,this.wjd,"querySaveStatus"),96);this.Bve.execute(Object(m.a)(this,this.Zjc,"onHostPostmessengerCreated"))}Ee(){const r=this.Ea.Fc(Jb.a.Tli);r.bindAction(fb.KeyInputManager.Oa(Ba.a.smb,fb.KeyInputManager.Oe),ab.a.print);r.bindAction(fb.KeyInputManager.Oa(Ba.a.EMa,fb.KeyInputManager.Oe),u.a.ve);r.bindAction(fb.KeyInputManager.Oa(Ba.a.lwd,fb.KeyInputManager.Oe),u.a.ve);r.bindAction(fb.KeyInputManager.Oa(Ba.a.eZ,fb.KeyInputManager.Oe),u.a.ve);r.bindAction(fb.KeyInputManager.Oa(Ba.a.eZ,
fb.KeyInputManager.Oe|4),u.a.ve)}bIk(r,R,la){return this.DTe(la,u.a.TKb,"SaveAsToHost")}aIk(r,R,la){return this.DTe(la,u.a.upc,"SaveACopy")}cIk(r,R,la){return this.DTe(la,u.a.jjb,"SaveToSharePoint")}DTe(r,R,la){if(1===r)return z.AFrameworkApplication.iG||z.AFrameworkApplication.KQ?8:this.ia.processAction(R,1);if(this.yw.hasDeferredContent()&&(N.a.J(512500628,843,15,"{0} is triggered while document has deferred content",la),!this.Sek))return this.yw.lYe(la,null,null),8;this.Sqb(la);return this.Xa.Oda?
(N.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",R),this.ia.La(ab.a.VKb,2,R)):this.ia.processAction(R,2)}downloadACopy(r,R,la,Ea,Qa){if(this.hf.$c(this.ut))return 16;if(1===la)return!this.oc.pj()||z.AFrameworkApplication.KQ?8:lm.pUf()?32:this.ktb();if(this.yw.hasDeferredContent())return N.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),this.Exg&&this.LL.I_d(),this.yw.lYe("DownloadACopy",new Zl.a,()=>{this.K2e(Qa)}),
this.yw.qra("DownloadACopyRequestedTime",zj.a.nf(new Date)),8;this.pa.Qh();this.Ea.Ed();N.a.J(512500625,801,50,"PPT save and download a copy");this.Xa.Oda?this.K2e(Qa):(this.Ou.show(!0,r),this.vE.u3(!1,this.KXa,()=>{this.K2e(Qa)},Object(m.a)(this,this.lya,"saveFailureCallback")));this.Sqb("DownloadACopy");return 32}K2e(r){this.Ou.hide();let R;R=lm.pUf()?z.AFrameworkApplication.xRa:this.vsg?this.Erb(this.Ucc):this.Ucc;r&&r.FileDownloadUrl&&(R=r.FileDownloadUrl.toString());this.V1j();this.iFg&&!this.iFg()&&
this.jTg&&this.jTg("3555692408")?this.EWa.sendMessage(id.a.download,{}):this.Y4j?(this.ddk.Wll(R),this.yw.qra("DownloadModalTime",zj.a.nf(new Date))):this.Rb.QO(!0,R,!0)}V1j(){this.s$j&&this.Gwa&&this.Gwa.execute(r=>{r.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}wjd(r,R,la,Ea,Qa){r="";this.rSg&&(r=this.r9j.WW(this.ut)?String.format(ResourceStrings.L_SavingStatus):this.T5c?String.format(CommonUIStrings.l_SavedToStatus,this.T5c):String.format(ResourceStrings.L_SavedStatus));
Qa[Lg.a.Value]=r;return 32}Fuj(r,R,la){return this.hMe(la,0,r)}Huj(r,R,la){return this.hMe(la,8,r)}Guj(r,R,la){return this.hMe(la,4,r)}hMe(r,R,la){if(this.hf.$c(this.ut))return 16;if(1===r)return!this.oc.pj()||z.AFrameworkApplication.KQ?8:this.ktb();if(this.HQg())return N.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;N.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",R);this.pa.Qh();this.Ea.Ed();this.Xa.Oda?this.mnh(R):(this.Ou.show(!0,la),this.vE.u3(!1,this.KXa,
()=>{this.mnh(R)},Object(m.a)(this,this.lya,"saveFailureCallback")));this.Sqb("Print-"+la);return 32}mnh(r){this.Ou.hide();this.rek.print(this.Xa.presentationId.string,this.Erb(this.m_printUrl),r)}L2b(r,R,la){if(this.hf.$c(this.ut))return 16;if(1===la)return!this.oc.pj()||z.AFrameworkApplication.KQ?8:this.ktb();this.q4c.XPf=new Date;this.pa.Qh();this.Ea.Ed();this.Xa.Oda?this.jnh():(this.Ou.show(!0,r),this.vE.u3(!1,this.KXa,()=>{this.jnh()},Object(m.a)(this,this.lya,"saveFailureCallback")));this.Sqb("DownloadACopyAsPDF");
return 32}jnh(){this.Ou.hide();this.q4c.rnh=new Date;this.K3c.convert(this.Xa.presentationId.string,1,this.Erb(this.w7j))}M2b(r,R,la){if(this.hf.$c(this.ut))return 16;if(1===la)return!this.oc.pj()||z.AFrameworkApplication.KQ?8:this.ktb();this.pa.Qh();this.Ea.Ed();this.Xa.Oda?this.knh():(this.Ou.show(!0,r),this.vE.u3(!1,this.KXa,()=>{this.knh()},Object(m.a)(this,this.lya,"saveFailureCallback")));this.Sqb("DownloadAsImages");return 32}KTe(r,R,la){if(this.hf.$c(this.ut))return 16;if(1===la)return!this.oc.pj()||
z.AFrameworkApplication.KQ?8:this.ktb();this.pa.Qh();this.Ea.Ed();this.Xa.Oda?this.WPf():(this.Ou.show(!0,r),this.vE.u3(!1,this.KXa,()=>{this.WPf()},Object(m.a)(this,this.lya,"saveFailureCallback")));this.Sqb("SaveSlidesAsImages");return 32}knh(){this.Ou.hide();this.K3c.convert(this.Xa.presentationId.string,2,this.Erb(this.iwg))}WPf(){this.Ou.hide();var r=this.Erb(this.iwg),R=this.pa.Qe();0<R.length&&(R=yj.c(R,la=>la.sid.toString()).join(","),r=new eg.QueryStringBuilder(r),r.yi(Ih.a.Enl,R),this.K3c.convert(this.Xa.presentationId.string,
2,r.toString()))}K2b(r,R,la){if(this.hf.$c(this.ut))return 16;if(1===la)return!this.oc.pj()||z.AFrameworkApplication.KQ?8:this.ktb();if(this.yw.hasDeferredContent())return this.Exg&&this.LL.I_d(),N.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.yw.lYe("DownloadACopyAsOdp",new Zl.a,()=>{this.ETe()}),8;this.pa.Qh();this.Ea.Ed();this.Xa.Oda?this.ETe():(this.Ou.show(!0,r),this.vE.u3(!1,this.KXa,()=>{this.ETe()},Object(m.a)(this,this.lya,"saveFailureCallback")));
return 32}lya(){this.Ou.hide();return!1}ETe(){this.Ou.hide();this.K3c.convert(this.Xa.presentationId.string,0,this.Erb(this.v7j))}H_a(r,R,la,Ea,Qa){if(this.hf.$c(this.ut))return 16;if(1===la)return 32;this.pa.Qh();this.Ea.Ed();this.vE.u3(!1,!0,wb=>{if(Qa&&1<=Qa.length)Qa[0](wb)},wb=>Qa&&2<=Qa.length?(Qa[1](wb,wb.ServerError.Code),!0):!1);return 32}qjk(){const r=new eg.QueryStringBuilder(gb.a.eta("DownloadACopyHandler.ashx"));r.yi(Ih.a.Zgd,this.Xa.presentationId.string);r.yi(Ih.a.Lna,this.Xa.sessionInfo);
r.yi("fn",z.AFrameworkApplication.fileName);z.AFrameworkApplication.yPa(r);return r.toString()}Erb(r){if(r){const R=new eg.QueryStringBuilder(r);this.Xa&&this.Xa.podSessionId&&0>r.indexOf(this.Xa.podSessionId)&&(R.TFc(Ih.a.haa+"="+this.Xa.podSessionId),N.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Xa.podSessionId));this.Vfk&&z.AFrameworkApplication.Eu.Xw&&0<z.AFrameworkApplication.Eu.Xw.length&&(R.yi(Ih.a.V8g,z.AFrameworkApplication.Eu.Xw),N.a.J(512500619,801,50,"Appended FileName in url"));
this.O$j&&(R.yi(Ih.a.TBk,"true"),N.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));z.AFrameworkApplication.yPa(R);return R.toString()}return null}Sqb(r){const R=Fk.a.B3(vn.a.AZa,!0);N.a.J(509448414,801,15,"DocOperation={0};SimplifiedRibbonON={1}",r,R)}Zjc(r){this.EWa=r}ktb(){return z.AFrameworkApplication.iG?8:32}static pUf(){const r=z.AFrameworkApplication.iG,R=!db.a.Wa(z.AFrameworkApplication.xRa),la=z.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Ea=z.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");
N.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",r,R,la,Ea);return r&&R&&la&&Ea}}Object(h.a)(lm,"DocumentOperationsActor",null,[352]);class $l{}$l.rg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(h.a)($l,"EmbedDialogHtml",null,[]);class mm{constructor(r,R,la,Ea){this.oJe=
r;this.R3=R;this.R7g=la;this.value=Ea}}Object(h.a)(mm,"OptionInfo",null,[]);class xk{constructor(r,R,la){this.YTe=r;this.oyb=R;this.R3=la}}Object(h.a)(xk,"SectionInfo",null,[]);var cl=d(289);class If extends kd.a{constructor(r,R=!1){super(!1,!1,R);this.Naf=476;this.Vxc=288;this.bQh=798;this.xYh=476;this.vYh=288;this.$gd={};this.N_a=[];this.vP=this.XAa=this.tHd=this.Ixc=this.KBc=this.rpb=null;this.YRb=z.AFrameworkApplication.gyb;this.oCc=r;this.rHd=Object(m.a)(this,this.hAk,"optionClickHandler");this.sHd=
Object(m.a)(this,this.iAk,"optionKeyHandler");this.sxd=Object(m.a)(this,this.Zfi,"arrowClickHandler");this.Omb=Object(m.a)(this,this.$fi,"arrowKeyHandler");this.yEc=Object(m.a)(this,this.tul,"textAreaOnFocusHandler");this.vUh=R;this.rg=$l.rg;this.xd=0;this.hg="EmbedDialog"}get hob(){return this.Vxc}set hob(r){this.Vxc=r}Zvh(r){const R={["id"]:this.hg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:gb.a.Ki(this.oCc,"wdPreview","1"),["initialEmbedUrl"]:this.YRb,["getEmbedCode"]:If.o1f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const la of Object.keys(r))R[la]=r[la];this.xd=1;this.Xe(1,CommonUIStrings.l_CopyAction);this.Xe(0,CommonUIStrings.l_Close);this.Zi(CommonUIStrings.l_Embed,null,R)}pkb(){if(this.vUh)this.Zvh({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.rpb=document.getElementById("embedpreviewpane");
this.KBc=document.getElementById("embedoptionpane");this.rpb.style.width=String.format("{0}px",this.xYh);this.XAa=document.createElement("iframe");this.XAa.className=If.uYh;this.XAa.frameBorder="0";this.XAa.style.height=String.format("{0}px",this.vYh);this.XAa.tabIndex=-1;this.rpb.appendChild(this.SLc(CommonUIStrings.l_Preview,this.XAa,If.ulf,If.wYh,If.ulf,!0));this.vP=document.createElement("textarea");this.vP.className=If.GQh;Sys.UI.DomElement.addCssClass(this.vP,cl.a.YBa);this.vP.id=If.HQh;Ae.a.Ni||
(this.vP.readOnly=!0);this.vP.rows=4;this.vP.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.vP.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.vP.setAttribute(pa.a.P2,String.format("{0} {1}",If.Maf,If.Laf));this.rpb.appendChild(this.SLc(CommonUIStrings.l_EmbedCode,this.vP,If.Maf));nd.a.addHandler(this.vP,"focus",this.yEc);var r=document.createElement("span");r.className=If.GRh;r.innerText=CommonUIStrings.l_CopyText;r.id=If.Laf;this.rpb.appendChild(r);this.Ixc=document.createElement("div");
this.Ixc.className=If.eQh;this.KBc.appendChild(this.SLc(CommonUIStrings.l_Dimensions,this.Ixc));this.tHd=document.createElement("div");this.KBc.appendChild(this.tCi(If.zXh,this.tHd));this.xd=0;this.Xe(1,CommonUIStrings.l_Close);this.wGh();this.rHh();Ae.a.Ni||this.vP.focus()}}dispose(){if(this.$gd){var r=this.$gd;for(let R in r){const la=r[R];this.yn.yb(ha.a.click,la.oJe,this.rHd);this.Rg.yb(ha.a.Yf,la.oJe,this.sHd);this.Rg.yb(ha.a.Il,la.oJe,this.sHd)}this.sHd=this.rHd=this.$gd=null}if(this.N_a){for(r=
0;r<this.N_a.length;++r)this.yn.yb(ha.a.click,this.N_a[r].oyb,this.sxd),this.Rg.yb(ha.a.Yf,this.N_a[r].oyb,this.Omb),this.Rg.yb(ha.a.jy,this.N_a[r].oyb,this.Omb),this.Rg.yb(ha.a.Il,this.N_a[r].oyb,this.Omb);this.Rg=this.sxd=this.N_a=null}this.yEc&&this.vP&&(nd.a.removeHandler(this.vP,"focus",this.yEc),this.yEc=null);this.vP=this.XAa=this.tHd=this.Ixc=this.KBc=this.rpb=null;super.dispose()}naa(){super.naa();this.Gb.style.width=String.format("{0}px",this.bQh);this.nCa()}xGh(r,R){const la=gb.a.Ki(this.YRb,
r,R);return this.YRb!==la?(this.YRb=la,this.oCc=gb.a.Ki(this.oCc,r,R),!0):!1}wGh(){this.vP&&(this.vP.innerText=If.o1f(this.YRb,this.Naf,this.Vxc))}rHh(){this.XAa&&this.XAa.contentWindow.location.replace(gb.a.Ki(this.oCc,"wdPreview","1"))}tDl(r,R){this.xGh(r,R)&&(this.wGh(),this.rHh())}SLc(r,R,la=null,Ea=null,Qa=null,wb=!1){const Pb=document.createElement("div");Pb.className=If.l_h;Ea&&(Pb.id=Ea);Qa&&Pb.setAttribute(pa.a.P2,Qa);wb&&(Pb.tabIndex=0);Ea=document.createElement("span");Ea.className=If.m_h;
Ea.innerText=r;la&&(Ea.id=la);Pb.appendChild(Ea);Pb.appendChild(R);return Pb}tCi(r,R){const la=this.SLc(CommonUIStrings.l_Interaction,R),Ea=this.ii.createElement("div");Ea.className=If.kNh;Ea.id=If.mNh+r;Ea.setAttribute(pa.a.ef,pa.a.yu);Ea.tabIndex=0;la.insertBefore(Ea,R);r=Fa.createClusteredImage(16,16,If.lNh,If.nNh,!0,"");Ea.appendChild(r);r=r.childNodes[0];r.className=Fa.getImageClass(If.oaf);r.title=CommonUIStrings.l_Expand;Ea.title=CommonUIStrings.l_Expand;R.style.visibility="hidden";R=new xk(R,
Ea,r);Array.add(this.N_a,R);this.yn.KU(ha.a.click,Ea,this.sxd,R);this.Rg.KU(ha.a.Yf,Ea,this.Omb,R);this.Rg.KU(ha.a.jy,Ea,this.Omb,R);this.Rg.KU(ha.a.Il,Ea,this.Omb,R);return la}Zfi(r){this.SDf(r);return!0}$fi(r){return this.Z0c(r,Object(m.a)(this,this.SDf,"changeArrowState"))}SDf(r){r=r.rD;"visible"===r.YTe.style.visibility?(r.YTe.style.visibility="hidden",r.R3.className=Fa.getImageClass(If.oaf),r.R3.title=CommonUIStrings.l_Expand,r.oyb.title=CommonUIStrings.l_Expand):(r.YTe.style.visibility="visible",
r.R3.className=Fa.getImageClass(If.L2h),r.R3.title=CommonUIStrings.l_Collapse,r.oyb.title=CommonUIStrings.l_Collapse)}hAk(r){this.Q7g(r);return!0}iAk(r){return this.Z0c(r,Object(m.a)(this,this.Q7g,"optionHandler"))}Q7g(r){const R=this.$gd[r.rD.toString()];R.value?(R.value=0,R.R3.className=Fa.getImageClass(If.w2h),R.R7g.setAttribute(pa.a.Zxf,pa.a.Iia)):(R.value=1,R.R3.className=Fa.getImageClass(If.rOh),R.R7g.setAttribute(pa.a.Zxf,pa.a.gC));this.tDl(r.rD.toString(),R.value.toString())}tul(){this.vP.select()}static o1f(r,
R,la){if(!If.EGd){const Ea=String.format('<a target="_blank" href="{0}">{1}</a>',db.a.h8b("https://office.com"),CommonUIStrings.l_Office),Qa=String.format('<a target="_blank" href="{0}">{1}</a>',db.a.h8b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);If.EGd=String.format(CommonUIStrings.l_NoFrames,Ea,Qa)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',db.a.h8b(r),R,la,If.EGd)}}If.EGd=null;If.rOh="CheckboxChecked_16x16x32";If.w2h="CheckboxUnchecked_16x16x32";
If.L2h="OutlookSearchChevronUp_16x16x32";If.oaf="OutlookSearchChevronDown_16x16x32";If.lNh="UpArrowServer";If.l_h="EmbedSectionHeader";If.m_h="EmbedSectionName UIFontBold";If.GRh="EmbedCodeFooter";If.uYh="EmbedPreviewFrame";If.GQh="EmbedCodeTextArea";If.eQh="EmbedDimensionSection";If.nNh="EmbedArrowIcon";If.kNh="WACGlyph EmbedArrowHolder";If.HQh="EmbedCode";If.Maf="EmbedCodeHeader";If.ulf="Preview";If.wYh="PreviewHeader";If.zXh="Options";If.mNh="Arrow";If.Laf="EmbedCodeFooter";Object(h.a)(If,"EmbedDialog",
kd.a,[]);class Bl extends If{constructor(r,R){super(r,!0);R&&R&&!isNaN(R)||N.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.xGh(Ih.a.KBk,R.toString())}pkb(){const r=[];r.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:Bl.MQk});this.Zvh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.Naf,["defaultHeight"]:this.Vxc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,
["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:r})}static MQk(r,R,la){return"wdEaaCheck"===R?gb.a.Ki(r,R,la?"1":"0"):r}}Object(h.a)(Bl,"ReactEmbedDialog",If,[]);class rj{constructor(r,R,la,Ea,Qa){this.iGa=null;this.Yse=!1;this.EWa=null;this.Rb=r;this.jve=R;this.cdc=la;this.Bve=Ea;this.Xa=Qa}pkb(r,R,la){(r=(r=z.AFrameworkApplication.yM)||this.Xa.Oda)||this.Yse||(r=!this.oDh());return 1===la?r?2:32:this.Gkl()}Gkl(){if(!this.Yse)return 8;if(z.AFrameworkApplication.gyb&&this.cdc)this.mvh();
else{const r=z.AFrameworkApplication.u5e?this.EWa.sendMessage(id.a.JWi,null)?32:8:2;return 32!==r?this.Rb.QO(!0,z.AFrameworkApplication.Z2d):r}return 32}Fkl(r){r.Values.HostEmbeddedViewUrl&&(this.cdc=z.AFrameworkApplication.gyb=r.Values.HostEmbeddedViewUrl.toString(),this.mvh())}oDh(){return!1}r5h(r,R){this.iGa=R;this.Yse=!!this.Rb&&!!this.jve&&!(void 0===this.cdc||null===this.cdc)&&!!r&&!!R}mvh(){(new Bl(this.cdc,this.iGa)).pkb()}}Object(h.a)(rj,"EmbedManager",null,[]);class Bm{constructor(r,R,la){this.iGa=
null;this.E8j={};for(R=0;R<r.length;R++)this.E8j[r[R].Format.toString()]=R;this.iGa=la&&!isNaN(la)&&isFinite(la)?la:0}}Object(h.a)(Bm,"FormatPicker",null,[]);class dn extends rj{constructor(r,R,la,Ea,Qa,wb,Pb,xc){super(r,R,la,wb,Pb,xc);this.ia=Ea;this.Tb=Qa}wb(){this.ia.ya(ab.a.pkb,mb.a.application,Object(m.a)(this,this.pkb,"showEmbedDialog"));this.Bve.execute(Object(m.a)(this,this.Zjc,"onHostPostmessengerCreated"))}Ee(){}oDh(){var r=this.Tb.Gu();if(!this.jve||!r.height)return!1;r=r.width/r.height;
const R=new Bm(this.jve,!1,r);this.r5h(R,r);return!0}Zjc(r){this.EWa=r;z.AFrameworkApplication.isEmbedded||z.AFrameworkApplication.gyb||!this.EWa||(this.EWa.wu(id.a.RCf),this.EWa.HB(id.a.RCf,Object(m.a)(this,this.Fkl,"showEmbedDialogPostMessage")))}}Object(h.a)(dn,"EmbedActor",rj,[352]);var xa=d(41),hi=d(731),Hj=d(684);class ql{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce){this.ia=r;this.seb=R?R.xa:null;this.ua=la;this.fc=Ea;this.ob=Qa;this.Nu=wb;this.Jb=Pb;this.Sk=xc;this.Rd=ed;this.rBb=null;this.Ea=
jd;this.ut=la.presentation;this.Fe=bd;this.Qf=null;this.beb=Ce}wb(){this.ia.ra(ab.a.Lvh,xa.a.application,Object(m.a)(this,this.Ywj,"handleUploadAudioDialog"),4)}Ee(){}Ywj(r,R,la){const Ea=this.ua.Ba;if(!Ea||this.fc.$c(Ea))return 16;if(1===la)return 32;if(this.seb){this.Qf=zj.a.yk("Audio::Insert");try{return Hj.a.fZe("audio/*",hi.e,()=>hi.d(r,Object(m.a)(this,this.eGj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Fe,Ea),"audio",Ea,this.ua.presentation,this.fc,this.Rd,this.Qf,!1,this.beb,
50,10,3),this.Qf&&this.Qf.Va("AudioDialogInitialized","true"),32}catch(Qa){N.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return N.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(r,R){this.Qf&&(this.Qf.finish(),this.Qf=null);this.Rd.cH(r,la=>{la.jC=1;la.ZRa=R;return!1})}eGj(r,R,la,Ea,Qa,wb,Pb){Ea.UN(la)&&N.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+la.gja);Ea.fK(la);Qa&&Qa.Va("AudioUploadToRC","true");Object(Db.a)("FixForInsertMediaSlideNavigationIssue")||(Pb=this.ua.Ba);la=Pb.Ut();var xc=this.ut.slideWidth,ed=this.ut.slideHeight;Ea=Hc.a.rf(32,0);const jd=Hc.a.rf(32,1);xc=xc/2-Hc.a.rf(16,0);ed=ed/2-Hc.a.rf(16,1);if(Pb&&Pb.isConnected){var bd=this.Jb.Ad(15,void 0,void 0,()=>{this.Nu.SF=this.rBb;this.ob.selectShape(this.rBb,!0);this.Ea.Ed()});try{bd.nc(Pb);bd.jd=r;Qa&&Qa.Va("CreatingAudioShape","true");this.rBb=this.Sk.YQa(!1,Pb.Cb.cid,
Pb.Cb.sid,0,10,xc,ed,Ea,jd,la+1);const Ce=wb.files[0].name;this.rBb.AZb=R;this.rBb.yZb=Ce;Pb.dC(this.rBb)}finally{bd&&bd.dispose()}Qa&&(Qa.Va("AudioShapeSuccessfullyCreated","true"),Qa.finish(),Qa=null)}}}Object(h.a)(ql,"InsertAudioActor",null,[352]);class Ug{constructor(){this.tyb=this.vrb=null}}Object(h.a)(Ug,"CreatePickerCustomizationDictionaryOptions",null,[1567]);var dl=d(165),yk=d(29);class el{}el.rg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(h.a)(el,"InsertMediaDialogHtml",null,[]);class Cm{}Cm.rg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(h.a)(Cm,"InsertMediaM365DialogHtml",null,[]);var am=d(393);class kf{static get rg(){return kd.a.sC(kf.so,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}kf.so="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(h.a)(kf,"InsertOnlineVideoDialogHtml",null,[]);class Dm extends kd.a{constructor(r){super();this.jD(1,!0);this.Xe(1,ResourceStrings.L_Insert);this.rg=kf.rg;this.X9=r;this.GV=!1}g6(){this.width=50;this.Zi(ResourceStrings.L_OnlineVideo,Object(m.a)(this,this.zGj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(pa.a.ARd,pa.a.Ofi);const r=document.getElementById("url");this.jD(1,!!r&&0<r.value.length);
nd.a.addHandler(r,ha.a.input,Object(m.a)(this,this.Ifd,"onPatternChanged"));nd.a.addHandler(r,ha.a.change,Object(m.a)(this,this.Ifd,"onPatternChanged"));this.HR(r)}hide(){const r=document.getElementById("url");r&&(nd.a.removeHandler(r,ha.a.input,Object(m.a)(this,this.Ifd,"onPatternChanged")),nd.a.removeHandler(r,ha.a.change,Object(m.a)(this,this.Ifd,"onPatternChanged")));super.hide()}zGj(r,R){if(1===r){if(R){var la=zj.a.yk("InsertOnlineVideo",1);la.Ur=!0;r=R.url.trim();(r=this.X9.NUi(r))?this.X9.Lng(r)&&
this.X9.kXj(r)?(N.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.X9.g1f(r)),this.X9.requestVideoData(r,Ea=>{zj.a.AF(la,()=>{this.TY(Ea)})},Object(m.a)(this,this.QVi,"failCallback"))):(N.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.X9.g1f(r)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(N.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}TY(r){this.hide();
this.X9.gfg(r)}QVi(r){this.fail(r,ResourceStrings.l_CannotInsertOnlineVideo)}fail(r,R){if(document.getElementById("labelmessage")){var la=+new Date-+this.X9.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=R;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();r&&N.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:la,["ResponseCode"]:r.data.oe}))}else N.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}Ifd(){zj.a.ybb();const r=document.getElementById("url");this.jD(1,!!r&&0<r.value.length)}}Object(h.a)(Dm,"InsertOnlineVideoDialog",kd.a,[765]);class rc{static get rg(){return kd.a.sC(rc.so,ResourceStrings.l_InsertCameoExpDialogContent,ResourceStrings.L_LearnMore,"https://aka.ms/pptocameoblog")}}rc.so="<div class='CameoExperimentTextDiv' id='cameoexperimenttextdiv'> <label id='cameoexperimenttext' class='WACDialogLabel' >{0}</label> </div> <div class='cameoexperimentlearnmorediv' id='CameoExperimentLearnMoreDiv'> <a id='cameoexperimentlearnmore' class='CameoExperimentLearnMore' href={2} target='newtab' >{1}</a> </div>";
Object(h.a)(rc,"InsertCameoDialogHtml",null,[]);class Em extends kd.a{constructor(){super();this.jD(1,!0);this.rg=rc.rg;this.xd=0}g6(){this.width=50;this.Zi(ResourceStrings.l_InsertCameoExpDialogTitle);const r=document.getElementById("cameoexperimentlearnmore");r&&(r.onclick=()=>N.a.J(520119896,352,50,"InsertCameoDialog::showAndFocus : Click on learn more of insert cameo"))}}Object(h.a)(Em,"InsertCameoDialog",kd.a,[764]);var Tc=d(1097),df=d(61);class Aj{constructor(r,R,la){this.rTb=Yf.a.Z7;this.vG=
null;this.Ca=r;this.sTb=R;this.wBa=la}get An(){return this.Ca}get W7(){return this.vG||(this.vG=A.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Zy(){return this.rTb}set Zy(r){this.rTb=r}Yta(r){try{n.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",r.length);const R=this.sTb.HIk(r);let la=2;if(R&&0<R.length){const Ea=new Tc.DictionaryPropertySet;Ea.setValue(df.a.FU,R);Ea.setValue(df.a.EZc,!0);if(this.wBa){const Qa=this.wBa.i_e();Qa.tHc("insertOnlineImage");
Ea.setValue(df.a.BQa,Qa)}z.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.W7.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);la=this.Ca.La(this.Zy,2,Ea)}n.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",r.length,32===la,""===R)}catch(R){n.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",R.toString())}}}
Object(h.a)(Aj,"InsertOnlineImageHandler",null,[725]);class ti extends Aj{constructor(r,R,la=null){super(r,R,la)}get wLf(){return id.a.insertImage}get fyb(){return id.a.sGj}h9g(r){return this.sTb.PCk(r)}L5f(r){return r.Type}kZc(r,R){return this.sTb.kZc(r.Type,R)}i9g(r){const R=[];if(r&&r.data&&r.data.value&&0<r.data.value.length)for(let Ea=0;Ea<r.data.value.length;Ea++)if(r.data.value[Ea]&&r.data.value[Ea].urls&&r.data.value[Ea].urls.download){var la=r.data.value[Ea];la=Object.assign(new qj.a,{OriginalUrl:la.urls.download,
Type:la.extension||"",Caption:la.name,ContentType:"",Height:la.driveItem||la.driveItem.image?la.driveItem.image.height:0,Width:la.driveItem||la.driveItem.image?la.driveItem.image.width:0});Array.add(R,la)}R.length||n.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return R}och(r,R,la){la=la(r);if(la.length){r=[];for(let Ea=0;Ea<la.length;Ea++){const Qa=la[Ea],wb={};wb.Extension=Qa.Type;wb.SourceUrl=Qa.OriginalUrl;wb.SourceUrl=
Qa.OriginalUrl;wb.Width=Qa.Width;wb.Height=Qa.Height;Array.add(r,wb)}la={};la.Items=r;R.sendMessage(this.fyb,la)}}}Object(h.a)(ti,"InsertOnlineImageHelperBox4",Aj,[724,725]);class rf extends ti{constructor(r,R,la){super(r,R);this.ZCe=la.insertOnlineVideoUrlPatterns;this.Zy=ab.a.Hee}Yta(r){if(r&&0<r.length){var R=gb.a.YD(r[0].OriginalUrl);R=this.fme(R)?R:"unsupported";N.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",R);this.An.La(this.Zy,2,r[0])}}fme(r){if(!r)return!1;
r=r.trim();for(const R of this.ZCe)if((new RegExp(R)).test(r))return!0;return!1}}Object(h.a)(rf,"InsertOnlineVideoHelper",ti,[]);class Ll{static get rg(){return kd.a.sC(Ll.so,ResourceStrings.l_InsertSocialMediaDialogMsg)}}Ll.so="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(h.a)(Ll,"InsertSocailMediaDialogHtml",null,[]);var ck=
d(86),K=d(248);class Fm extends Sys.EventArgs{constructor(r,R,la,Ea){super();this.slideId=r;this.SY=la;this.shapeId=R;this.JEa=Ea}}Object(h.a)(Fm,"IconChangedEventArgs",Sys.EventArgs,[]);var Ml=d(493),cj=d(261);class xi{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df,Eh,jk,tj,rk,ul,Tn,Un,Yh,Vn,Wn,Gn,jl,Hl,pf,Vl){this.A7c=this.iZc=!1;this.jFb=this.dye=null;this.la=r;this.ia=R;this.fc=la;this.pa=Ea;this.Ea=Qa;this.ua=wb;this.Jb=Pb;this.e6c=xc;this.W9j=ed;this.d6c=jd;this.E4=bd;this.ccb=Ce;this.Gea=
Bf;this.gva=Df;this.Tb=Eh;this.Sk=jk;this.Fa=tj;this.Fb=rk;this.Nu=ul;this.Wj=Tn;this.keb=Un;this.LWa=Gn;this.Fxe=jl;this.Lc=Hl;this.cU=r.DIb;this.Pb=Vl;this.keb&&(this.keb.L8a.removeAttribute("style"),this.keb.L8a.style.display="none");this.eze=Yh;this.X9j=Vn;this.X9=Wn;this.m4=pf;this.ccb.execute(Oq=>{Oq.isFeatureEnabled("MsoPremiumStockImages",!1).catch(vo=>N.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",vo)).then(vo=>
{this.A7c=vo;this.A7c||(this.dye=Oq.rib("MsoPremiumStockImages",()=>{this.A7c=!0;N.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}wb(){this.c6h();this.ia.ra(ab.a.qXc,xa.a.application,Object(m.a)(this,this.GGl,"uploadIcon"),4);Db.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(ab.a.mJc,xa.a.application,Object(m.a)(this,this.Eqi,"changeToIcon"),4):this.ia.ra(ab.a.mJc,xa.a.application,Object(m.a)(this,this.Fqi,"changeToIcon"),4);this.ia.ra(ab.a.kab,
xa.a.application,Object(m.a)(this,this.Zud,"uploadOnlinePicture"),4);Db.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(ab.a.F_b,xa.a.application,Object(m.a)(this,this.pJc,"changeToOnlinePicture"),4):this.ia.ra(ab.a.F_b,xa.a.application,Object(m.a)(this,this.qJc,"changeToOnlinePicture"),4);this.ia.ra(ab.a.tXc,xa.a.application,Object(m.a)(this,this.Zud,"uploadOnlinePicture"),4);Db.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(ab.a.nJc,xa.a.application,Object(m.a)(this,this.pJc,"changeToOnlinePicture"),
4):this.ia.ra(ab.a.nJc,xa.a.application,Object(m.a)(this,this.qJc,"changeToOnlinePicture"),4);this.ia.ra(ab.a.uXc,xa.a.application,Object(m.a)(this,this.Zud,"uploadOnlinePicture"),4);Db.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(ab.a.C_b,xa.a.application,Object(m.a)(this,this.pJc,"changeToOnlinePicture"),4):this.ia.ra(ab.a.C_b,xa.a.application,Object(m.a)(this,this.qJc,"changeToOnlinePicture"),4);this.b6h();this.ia.ra(ab.a.Xeg,xa.a.application,Object(m.a)(this,this.Zud,"uploadOnlinePicture"),
4);Db.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(ab.a.xUd,xa.a.application,Object(m.a)(this,this.pJc,"changeToOnlinePicture"),4):this.ia.ra(ab.a.xUd,xa.a.application,Object(m.a)(this,this.qJc,"changeToOnlinePicture"),4);this.d6h();this.a6h();this.ia.ra(ab.a.Hee,xa.a.application,Object(m.a)(this,this.JGl,"uploadOnlineVideo"),4);this.ia.ra(ab.a.Gee,xa.a.application,Object(m.a)(this,this.IGl,"uploadOnlineHubbleVideo"),4);this.ia.ra(ab.a.Vmc,mb.a.application,Object(m.a)(this,this.vDl,"updateEntryPoints"),
96)}c6h(){this.ia.ra(ab.a.mXc,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),4);this.ia.ra(ab.a.U6a,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),4);this.ia.ra(ab.a.insertOnlinePicture,xa.a.application,Object(m.a)(this,this.DYe,"showInsertPictureDialog"),4);this.ia.ra(ab.a.D_b,xa.a.application,Object(m.a)(this,this.DYe,"showInsertPictureDialog"),4);Db.a("InsertSocialMediaVideoIcon")&&this.ia.ra(ab.a.efg,xa.a.application,Object(m.a)(this,this.tll,
"showInsertSocialMediaDialog"),4);Db.a("InsertDalleIcon")&&(this.ia.ra(ab.a.zee,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),4),this.ia.ra(ab.a.Aee,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),4));this.ia.ra(ab.a.R8b,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),4);this.ia.ra(ab.a.etb,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),4);this.ia.ra(ab.a.sXc,xa.a.application,Object(m.a)(this,
this.mLa,"showInsertMediaDialogFromM365"),4);this.ia.ra(ab.a.Eyb,xa.a.application,Object(m.a)(this,this.EYe,"showInsertPictureFromHostDialog"),4);this.ia.ra(ab.a.E_b,xa.a.application,Object(m.a)(this,this.EYe,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.yib("ppt_insertOnlinePictures",ab.a.insertOnlinePicture,xa.a.application,Object(m.a)(this,this.DYe,"showInsertPictureDialog"),r=>{yk.App.Kb.C1a(r,Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))}),this.ia.yib("ppt_insertOnlinePictures",
ab.a.R8b,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),r=>{yk.App.Kb.C1a(r,Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))}),this.ia.yib("ppt_insertOnlinePictures",ab.a.sXc,xa.a.application,Object(m.a)(this,this.mLa,"showInsertMediaDialogFromM365"),r=>{yk.App.Kb.C1a(r,Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))}),this.ia.yib("ppt_insertOnlinePictures",ab.a.Eyb,xa.a.application,Object(m.a)(this,this.EYe,"showInsertPictureFromHostDialog"),r=>{yk.App.Kb.C1a(r,
Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))}))}b6h(){this.la.yXc&&this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.ra(ab.a.xXc,xa.a.application,Object(m.a)(this,this.Dqd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.ra(ab.a.G_b,xa.a.application,Object(m.a)(this,this.Dqd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.yib("mso_insertMobileDevicePictures",ab.a.xXc,xa.a.application,Object(m.a)(this,
this.Dqd,"showInsertPictureFromMobileDeviceDialog"),r=>{yk.App.Kb.C1a(r,Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))}),this.ia.yib("mso_insertMobileDevicePictures",ab.a.G_b,xa.a.application,Object(m.a)(this,this.Dqd,"showInsertPictureFromMobileDeviceDialog"),r=>{yk.App.Kb.C1a(r,Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))})))}d6h(){this.ia.ra(ab.a.Zta,xa.a.application,Object(m.a)(this,this.RMb,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.yib("ppt_insertOnlineVideos",ab.a.Zta,
xa.a.application,Object(m.a)(this,this.RMb,"showInsertVideoDialog"),r=>{yk.App.Kb.C1a(r,Object(m.a)(this.m4,this.m4.VDa,"getCommandById"))})}a6h(){cj.a(this.Pb.appSettings,"InsertCameoExperimentEnabled",!1)&&this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCameoExperimentEnabled",!1)&&this.ia.ra(ab.a.Weg,xa.a.application,this.rll.bind(this),4)}JIk(){z.AFrameworkApplication.X9b()&&z.AFrameworkApplication.Suh()&&(z.AFrameworkApplication.Aa.get_element().appendChild(this.keb.L8a),
nd.a.addHandler(this.keb.L8a.contentWindow,"message",Object(m.a)(this,this.Uvh,"showOneDriveFilePickerDialog")),this.iZc=!0)}Uvh(r){if(r.rawEvent&&(r=r.rawEvent.data))try{N.a.J(512517961,352,50,"User select images.");const R=Sys.Serialization.JavaScriptSerializer.deserialize(r,!0),la=R.MessageId?R.MessageId.toString():null;R&&la&&(la===id.a.insertImage||la===id.a.Eee)&&this.eze.start(la===id.a.insertImage?this.Gea:this.X9j)}catch(R){N.a.J(512517960,352,10,"malformatted postmessage here.")}}Ee(){}vDl(){return 32}DYe(r,
R,la){if(!this.f6(this.ua.Ba,r,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;N.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Ea=Xd.a.create(),Qa=db.a.qN(this.la.pptEditingUserId).toString(),wb=r===ab.a.insertOnlinePicture&&this.la.pHk?1:0;let Pb=String.format(this.la.insertPictureServiceEndpoint,z.AFrameworkApplication.lcid,hh.a.xe(z.AFrameworkApplication.lcid).name,z.AFrameworkApplication.buildVersion,Ea.toString(),3,Qa,wb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net",
"gi"))&&(Pb=this.E4.vki(yk.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.ccb.execute(xc=>{xc=this.e6c.getInstance(Pb,this.d6c,this.E4,xc,el.rg);xc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;xc.correlationId=Ea;xc.s5=1;switch(r){case ab.a.D_b:this.gva.Zy=ab.a.F_b;break;default:this.Gea.Zy=ab.a.kab}xc.QMb(CommonUIStrings.L_PictureInsertTitle,r===ab.a.insertOnlinePicture?this.Gea:this.gva);
N.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Ea){return N.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",Ea.toString()),xi.At(ck.a.Q4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}tll(r,R,la){if(1===la)return 32;r=new kd.a(void 0,void 0,!1);r.xd=5;r.rg=Ll.rg;r.Zi(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});N.a.J(512517956,
352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}mLa(r,R,la){if(!this.f6(this.ua.Ba,r,this.la.jab))return 8;if(1===la)return 32;let Ea;switch(r){case ab.a.R8b:case ab.a.sXc:R=new eg.QueryStringBuilder(this.la.Zeg);this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?R.yi("dallecore","1"):this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&R.yi("dalle","1");Ea=1;this.Gea.Zy=ab.a.tXc;break;case ab.a.zee:case ab.a.Aee:R=
new eg.QueryStringBuilder(this.la.Zeg);R.Pz("initpivot","dalle");this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?R.yi("dallecore","1"):R.yi("dalle","1");Ea=1;this.Gea.Zy=ab.a.tXc;break;case ab.a.mXc:R=new eg.QueryStringBuilder(this.la.rXc);Ea=1;this.Gea.Zy=ab.a.qXc;break;case ab.a.U6a:Db.a("ChangePictureFromIconsFixEnabled")?(R=new eg.QueryStringBuilder(this.la.rXc),this.gva.Zy=ab.a.nJc):(R=new eg.QueryStringBuilder(this.la.vqi),this.gva.Zy=ab.a.mJc);Ea=0;
break;case ab.a.etb:R=new eg.QueryStringBuilder(this.la.wqi);Ea=0;this.gva.Zy=ab.a.nJc;break;default:return N.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",r.toString()),16}this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(R.yi("gae","1"),z.AFrameworkApplication.obc("0fecb342;2aaje503"));const Qa=R.toString();if(!Qa||!Qa.length)return 16;N.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");
try{const wb=Xd.a.create(),Pb=db.a.qN(this.la.pptEditingUserId).toString();this.ccb.execute(xc=>{var ed=this.la.yGj&&xc.isFreemiumUpsellEnabled();ed=this.A7c?1:ed?0:-1;var jd=this.Pb.ka("InsertOnlineM365ExperimentEnabled")?1:0;jd=this.E4.uki(yk.App.mode,Qa,ed,Ea,wb.toString(),Pb,jd);xc=this.e6c.getInstance(jd,this.d6c,this.E4,xc,Cm.rg);xc.correlationId=wb;xc.s5=2;xc.u_d=ed;xc.QMb(CommonUIStrings.L_PictureInsertTitle,r===ab.a.U6a||r===ab.a.etb?this.gva:this.Gea);N.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});
return 32}catch(wb){return N.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",wb.toString()),xi.At(ck.a.Q4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}EYe(r,R,la){if(!this.f6(this.ua.Ba,r,z.AFrameworkApplication.X9b()&&(xi.ebg?!!this.eze.zHb&&9<this.eze.zHb.length:!0)))return 8;if(1===la)return 32;N.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{R=!0;let Ea=0;if(this.Pb.ka("InsertMediaSharedFilePickerEnabled")){const wb=
A.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(wb.Jle()){R=!1;const Pb=this.la.bfg;la=!1;this.la.yXc&&(la=this.p2i());const xc=Object.assign(new Ug,{vrb:la,tyb:!0}),ed=wb.KXd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Pb,"InsertPicture",0,xc);wb.U6d(ed).then(jd=>{if(jd&&0<jd.length){const bd=[];for(let Ce=0;Ce<jd.length;Ce++){const Bf=jd[Ce][Qc.a.EKe],Df={};Df.Extension=jd[Ce][Qc.a.u$g];Df.OriginalUrl=Qc.a.zKe in jd[Ce]?jd[Ce][Qc.a.zKe]:
Bf;Df.Type=Qc.a.AKe in jd[Ce]?jd[Ce][Qc.a.AKe]:"";Df.Caption=Qc.a.DKe in jd[Ce]?jd[Ce][Qc.a.DKe]:"";Df.Description=Qc.a.yKe in jd[Ce]?jd[Ce][Qc.a.yKe]:"";Df.Width=Qc.a.CKe in jd[Ce]?jd[Ce][Qc.a.CKe]:0;Df.Height=Qc.a.BKe in jd[Ce]?jd[Ce][Qc.a.BKe]:0;Array.add(bd,Df)}this.Eaj(r).Yta(bd);N.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Ea=32}).catch(jd=>{N.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",
jd.toString());xi.At(ck.a.Q4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);Ea=8})}}if(!R)return Ea;xi.ebg=!0;this.iZc||this.JIk();const Qa=this.W9j.getInstance();Qa.s5=4;switch(r){case ab.a.E_b:this.gva.Zy=ab.a.C_b;break;default:this.Gea.Zy=ab.a.uXc}Qa.QMb(CommonUIStrings.L_PictureInsertTitle,r===ab.a.Eyb?this.Gea:this.gva);N.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Ea){return N.a.J(512517919,
352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Ea.toString()),xi.At(ck.a.Q4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}Eaj(r){if(!Db.a("ChangePictureFromOneDriveFixEnabled"))return this.Gea;const R=(r=r===ab.a.Eyb)?this.Gea:this.gva;R.Zy=r?ab.a.uXc:ab.a.C_b;return R}p2i(){return A.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").p4i()}Dqd(r,R,la){if(!this.f6(this.ua.Ba,r,this.la.yXc&&this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)))return 8;if(1===la)return 32;A.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").zWi(this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let Ea=0;const Qa=A.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Qa.Jle()){const wb=r===ab.a.xXc,Pb=this.la.bfg,xc=Object.assign(new Ug,{vrb:!0,tyb:!0}),ed=Qa.KXd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,wb,Pb,"InsertPictureFromMobile",
3,xc);Qa.U6d(ed).then(jd=>{if(jd&&0<jd.length){const bd=[];let Ce=!1;const Bf=this.Pb.Ga("PhoneLinkServiceEndpoint");for(let Df=0;Df<jd.length;Df++){const Eh=jd[Df][Qc.a.EKe],jk=jd[Df],tj={};tj.Extension=jd[Df][Qc.a.u$g];tj.OriginalUrl=this.NJb(jk,Qc.a.zKe,Eh);tj.Type=this.NJb(jk,Qc.a.AKe,"");tj.Caption=this.NJb(jk,Qc.a.DKe,"");tj.Description=this.NJb(jk,Qc.a.yKe,"");tj.Width=this.NJb(jk,Qc.a.CKe,0);tj.Height=this.NJb(jk,Qc.a.BKe,0);Array.add(bd,tj);Ce||(Ce=-1!==tj.OriginalUrl.indexOf(Bf))}jd=wb?
this.Gea:this.gva;jd.Zy=Ce?wb?ab.a.Xeg:ab.a.xUd:wb?ab.a.uXc:ab.a.C_b;jd.Yta(bd);N.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Ea=32}).catch(jd=>{N.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",jd.toString());Ea=8})}return Ea}catch(Ea){return N.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Ea.toString()),8}}NJb(r,
R,la){return R in r?r[R]:la}Zud(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;if(!this.Wj.OF(R,1))return this.Wj.nG(R),16;try{const wb=R.A3(this.pa.Wd());if(wb&&this.fc.$c(wb))return 16;const Pb=this.d$a(R,wb);let xc=null;const ed=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()},()=>{this.pa.selectShape(Pb,!0);xc&&this.pa.selectShape(xc,!1)});try{ed.nc(R);
ed.jd=ab.a.insertOnlinePicture;ed.Vy[K.a.qDa]=K.a.online;la=null;r={["actionId"]:r};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Qa.LicenseUrl&&Qa.LicenseDisplayName){const jd=xi.QLe(Qa);la=dl.c(jd);if(this.la.pptImageAttributionSelectionImprove){const bd=R.Cb;xc=this.Sk.isa(!0,bd.cid,bd.sid,0,0,0,ac.a.dY,ac.a.u5,R.Ut()+1,!1)}}else r["result.LicenseDisplayName"]=Qa.LicenseDisplayName,r["result.LicenseUrl"]=db.a.qN(Qa.LicenseUrl);else r.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;
N.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",r);Pb.WLb(Qa.OriginalUrl,Qa.LicenseUrl?null:Qa.Caption,la,Qa.PageUrl);wb&&R.LU([wb]);R.dC(Pb);xc&&(R.dC(xc),Pb.x6a=xc.id,xc.V$a=!0)}finally{ed&&ed.dispose()}this.Nu.SF=Pb;return 32}catch(wb){return N.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",wb.toString()),8}}qJc(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.OJa))return 8;if(1===
la)return 32;N.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Qa)return 16;try{const wb=this.C9a()||this.ESc();if(!wb||this.fc.$c(wb))return 16;let Pb=null;const xc=this.Jb.Ad(15,void 0,void 0,()=>{this.pa.selectShape(wb,!0);Pb&&this.pa.selectShape(Pb,!1);N.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{xc.nc(R);xc.jd=ab.a.F_b;xc.Vy[K.a.qDa]=K.a.online;r=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&
Qa.LicenseUrl&&Qa.LicenseDisplayName){const ed=xi.QLe(Qa);r=dl.c(ed);if(this.la.pptImageAttributionSelectionImprove){const jd=R.Cb;Pb=this.Sk.isa(!0,jd.cid,jd.sid,0,0,0,ac.a.dY,ac.a.u5,R.Ut()+1,!1);N.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}wb.WLb(Qa.OriginalUrl,Qa.LicenseUrl?null:Qa.Caption,r,Qa.PageUrl);wb.set_isSVGBlipFilled(!1);Pb&&(R.dC(Pb),wb.x6a=Pb.id,Pb.V$a=!0)}finally{xc&&xc.dispose()}this.Nu.SF=wb;return 32}catch(wb){return N.a.J(512517905,
352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",wb.toString()),8}}pJc(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.OJa))return 8;if(1===la)return 32;N.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Qa)return 16;try{var wb=this.pa.Wd();r=[];for(var Pb of wb)Pb.Jf||r.push(Pb);for(const ed of r)if(!ed||this.fc.$c(ed))return 16;wb=null;const xc=this.Jb.Ad(15,void 0,
void 0);try{xc.nc(R);xc.jd=ab.a.F_b;xc.Vy[K.a.qDa]=K.a.online;Pb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Qa.LicenseUrl&&Qa.LicenseDisplayName){const jd=xi.QLe(Qa);Pb=dl.c(jd);if(this.la.pptImageAttributionSelectionImprove){const bd=R.Cb;wb=this.Sk.isa(!0,bd.cid,bd.sid,0,0,0,ac.a.dY,ac.a.u5,R.Ut()+1,!1);N.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const ed=Qa.LicenseUrl?null:Qa.Caption;for(const jd of r)jd.WLb(Qa.OriginalUrl,
ed,Pb,Qa.PageUrl),jd.set_isSVGBlipFilled(!1),wb&&(R.dC(wb),jd.x6a=wb.id,wb.V$a=!0)}finally{xc&&xc.dispose()}this.Nu.SF=r[0];return 32}catch(xc){return N.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",xc.toString()),8}}GGl(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.jab))return 8;if(1===la)return 32;N.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Qa||!Qa.length)return 16;
if(!this.Wj.OF(R,Qa.length))return this.Wj.nG(R),16;try{let wb=null;la=null;if(!({PEk:la,FEk:wb}=this.nfj(Qa,R)).returnValue)return 16;const Pb=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()},()=>{this.pa.P_a(wb,!0)});try{for(Pb.nc(R),Pb.jd=r,Pb.Vy[K.a.qDa]=K.a.icon,la&&R.LU(la),r=0;r<wb.length;r++)R.dC(wb[r])}finally{Pb&&Pb.dispose()}this.Nu.SF=wb[wb.length-1];return 32}catch(wb){return N.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",
Qa.length,wb.toString()),8}}nfj(r,R){let la,Ea;la=Array(r.length);Ea=Array(r.length);var Qa=R.A5d(this.pa.Wd());if(Qa&&0<Qa.length){var wb=0;for(const Pb of Qa)if(Pb&&!this.fc.$c(Pb)&&wb<r.length&&(la[wb]=Pb,wb++,wb===r.length))break}Qa=!0;for(wb=0;wb<la.length;wb++)this.la.svgIconLocalEditingIsEnabled&&r[wb].SvgContent&&0<r[wb].SvgContent.length&&(!la[wb]||la[wb]&&15!==la[wb].Hj)?Ea[wb]=this.lfj(R,la[wb],r[wb],wb):(Ea[wb]=this.t6f(R,la[wb],r[wb],!0,wb),Qa=!1),Qa&&zj.a.nP(!0,!0),Ea[wb].WLb(r[wb].OriginalUrl,
r[wb].Caption,null,null);return{returnValue:!0,PEk:la,FEk:Ea}}lfj(r,R,la,Ea){if(!r)return null;var Qa=r.Cb,wb=r.Ut();let Pb;const xc=Object(D.a)(573,r.sc(this.Fb.Ma));({U2d:Pb,mD:r}=this.LWa.qWd(R,la.Width,la.Height));Ea=R?0:Ea*am.a.LS;Qa=this.Sk.isa(!0,Qa.cid,Qa.sid,0,r.x+Ea,r.y+Ea,Pb.width,Pb.height,wb+1,!1);wb=this.LWa.BSd(this.Fb.Ld,Pb,r,xc.qT);Qa.OU=wb;Qa.isResizable=!0;Qa.d$b=!0;Qa.CL=!0;Qa.VIa=!0;Qa.set_isSVGBlipFilled(!0);la=this.Fxe.Z4k(la.SvgContent);Qa.gea=la?String.format("data:image/svg+xml;charset=utf8,{0}",
encodeURIComponent(la)):"";R&&(Qa.vca=R.id);return Qa}Eqi(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;N.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Qa||!Qa.length)return 16;try{const wb=this.pa.Wd(),Pb=[];for(const jd of wb)jd.Jf||Pb.push(jd);const xc=Qa[0].Caption;for(const jd of Pb){if(!Pb||this.fc.$c(jd))return 16;const bd=this.Fa.yr(jd);
xc&&bd&&this.Lc.Wdh(new Fm(R.Cb,jd.get_shapeId(),jd.get_smartArtModelId(),xc))}const ed=this.Jb.Ad(15,void 0,void 0,()=>{for(const jd of Pb){const bd=this.Fa.yr(jd);bd&&(this.Lc.$jd(),this.pa.selectShape(bd,!0),this.Lc.Zjd())}N.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{ed.nc(Pb[0]);ed.jd=r;ed.Vy[K.a.qDa]=K.a.icon;for(const jd of Pb)jd.set_isSVGBlipFilled(!0),jd.WLb(Qa[0].OriginalUrl,xc,null,null)}finally{ed&&ed.dispose()}for(const jd of Pb)this.fc.Mra(R,jd,this.Fb.Ma,
r);return 32}catch(wb){return N.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Qa.length,wb.toString()),8}}Fqi(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;N.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Qa||!Qa.length)return 16;try{const wb=this.ESc()||this.C9a();if(!wb||this.fc.$c(wb))return 16;
const Pb=Qa[0].Caption,xc=this.Fa.yr(wb);Pb&&xc&&this.Lc.Wdh(new Fm(R.Cb,wb.get_shapeId(),wb.get_smartArtModelId(),Pb));const ed=this.Jb.Ad(15,void 0,void 0,()=>{xc&&(this.Lc.$jd(),this.pa.selectShape(xc,!0),this.Lc.Zjd());N.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{ed.nc(wb),ed.jd=r,ed.Vy[K.a.qDa]=K.a.icon,wb.set_isSVGBlipFilled(!0),wb.WLb(Qa[0].OriginalUrl,Pb,null,null)}finally{ed&&ed.dispose()}(la=xc||wb)&&this.fc.Mra(R,la,this.Fb.Ma,r);return 32}catch(wb){return N.a.J(512517893,
352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Qa.length,wb.toString()),8}}ESc(){let r=null;const R=this.pa.Wd();for(const la of R)if(la&&la.get_isSVGBlipFilled())if(r)break;else r=la;return r}C9a(){if(this.cU){const r=this.pa.Wd();return r&&r.length?this.nRd(r)?r[0]:this.Kwb():null}return this.Kwb()}nRd(r){if(!r||!r.length)return!1;let R=r[0].Fj,la=1===r[0].mediaType;for(const Ea of r)R=R&&Ea.Fj,la=la&&1===Ea.mediaType;return R||la}Kwb(){const r=this.pa.Wd();
for(const R of r)if(R&&R.Fj)return R;return null}Yqg(r,R){const la=this.Pb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==la&&N.a.J(r,352,15,`${R}::Modal:${la}`)}RMb(r,R,la){if(!this.f6(this.ua.Ba,r,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;this.jFb=zj.a.yk("ShowInsertVideoDialog",1);const Ea=this.Pb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){N.a.J(512517890,
352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const wb=Xd.a.create(),Pb=db.a.qN(this.la.pptEditingUserId).toString();this.ccb.execute(xc=>{xc=this.e6c.getInstance(this.E4.xki(yk.App.mode,this.la.UGj,wb.toString(),Pb,this.la.Hab,this.la.oAb,Ea),this.d6c,this.E4,xc,Cm.rg);xc.correlationId=wb;xc.s5=5;const ed=new rf(this.ia,this.E4,this.la);ed.Zy=ab.a.Gee;xc.QMb(CommonUIStrings.L_VideoInsertTitle,ed)})}else this.la.insertVideoOnlineFromUrlEnabled?(N.a.J(512517889,
352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new Dm(this.X9)).g6()):(N.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.ccb.execute(wb=>{this.e6c.getInstance(this.E4.yki(yk.App.mode,this.la.insertVideoServiceEndpoint),this.d6c,this.E4,wb,el.rg).QMb(CommonUIStrings.L_VideoInsertTitle,new rf(this.ia,this.E4,this.la))}));this.Yqg(512557208,"ShowInsertOnlineVideoDialog");null!=this.jFb&&Object(Ml.a)(this.jFb.actionName,(new Date).getTime()-
this.jFb.KD.getTime(),"InsertOnlineVideoDialog",this.jFb.actionId,this.jFb.Nj);const Qa=this.Pb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");Db.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Qa&&N.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Qa);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Pb.hQc){const wb=this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",
!1)?"Visible":"NotVisible";N.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+wb)}N.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Qa){return N.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",Qa.toString()),xi.At(ck.a.Q4b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}rll(r,R,la){if(!this.f6(this.ua.Ba,r,!0))return 8;if(1===la)return 32;try{return N.a.J(512517855,
352,50,"InsertMediaActor::ShowInsertCameoDialog : Insert cameo, creating dialog"),(new Em).g6(),32}catch(Ea){return N.a.J(512517854,352,10,"InsertMediaActor::ShowInsertCameoDialog : Exception = [{0}]",Ea.toString()),8}}JGl(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;if(!this.Wj.OF(R,1))return this.Wj.nG(R),16;try{const wb=R.A3(this.pa.Wd());if(wb&&this.fc.$c(wb))return 16;
const Pb=this.d$a(R,wb),xc=this.E4.Znj(Qa.OriginalUrl);Pb.RVe(xc,Qa.ThumbnailUrl,Qa.Caption,Qa.Description,0<Qa.Width?Qa.Width:0,0<Qa.Height?Qa.Height:0);const ed=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()},()=>{this.pa.selectShape(Pb,!0)});try{ed.nc(R),ed.jd=r,wb&&R.LU([wb]),R.dC(Pb)}finally{ed&&ed.dispose()}N.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.Nu.SF=Pb;return 32}catch(wb){return N.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",
wb.toString()),8}}IGl(r,R,la,Ea,Qa){R=this.ua.Ba;if(!R)return N.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.f6(R,r,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===la)return 32;N.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.Wj.OF(R,1))return this.Wj.nG(R),16;try{const wb=R.A3(this.pa.Wd());if(wb&&this.fc.$c(wb))return 16;const Pb=this.d$a(R,wb),xc=0<Qa.Width?Qa.Width:0,ed=0<Qa.Height?Qa.Height:0;let jd=Qa.PageUrl;this.la.oAb&&
"odspbusiness"===Qa.ProviderName.toLocaleLowerCase()&&(jd=Qa.OriginalUrl);Pb.RVe(jd,Qa.ThumbnailUrl,Qa.Caption,Qa.Description,xc,ed);const bd=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()},()=>{this.pa.selectShape(Pb,!0)});try{bd.nc(R),bd.jd=r,wb&&R.LU([wb]),R.dC(Pb)}finally{bd&&bd.dispose()}this.Yqg(512557200,"InsertOnlineHubbleVideo");N.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Qa.StartInsertTime);this.Nu.SF=
Pb;return 32}catch(wb){return N.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",wb.toString()),8}}f6(r,R,la){r=!!r&&la&&!this.fc.$c(r);switch(R){case ab.a.U6a:return r&&(!!this.C9a()||!!this.ESc());case ab.a.D_b:case ab.a.E_b:case ab.a.G_b:case ab.a.etb:return r&&this.Rri();default:return r}}Rri(){const r=this.C9a()||this.ESc();return r?this.Fa.yr(r)?!1:!0:!1}d$a(r,R){return this.t6f(r,R,null,!1,0)}t6f(r,R,la,Ea,Qa){if(!r)return null;var wb=r.Cb;r=r.Ut();let Pb;
Ea?{width:la,height:Pb}=xi.nlj(R,la):(la=ac.a.dY,Pb=ac.a.u5);let xc;xc=R?R.$wb(la,Pb):this.Tb.Ata(la,Pb);Qa=R?0:Qa*am.a.LS;wb=this.Sk.isa(!0,wb.cid,wb.sid,0,xc.x+Qa,xc.y+Qa,la,Pb,r+1,!0);wb.set_isSVGBlipFilled(Ea);R&&(wb.vca=R.id);return wb}dispose(){this.ccb.instance&&this.dye&&this.ccb.instance.dKb("MsoPremiumStockImages",this.dye);this.iZc&&this.keb.L8a.contentWindow&&(nd.a.removeHandler(this.keb.L8a.contentWindow,"message",Object(m.a)(this,this.Uvh,"showOneDriveFilePickerDialog")),this.iZc=!1)}static ili(){const r=
CommonUIStrings.l_AttributionText.split(/[{}]+/);return yj.e(r,R=>!!R)}static ski(r,R){const la=document.createElement("body");var Ea="";let Qa="",wb=CommonUIStrings.L_CCYYSA;void 0!==R&&null!==R&&(void 0!==R.PageUrl&&null!==R.PageUrl&&(Ea=R.PageUrl),void 0!==R.LicenseDisplayName&&null!==R.LicenseDisplayName&&0<R.LicenseDisplayName.length&&(wb=R.LicenseDisplayName),void 0!==R.LicenseUrl&&null!==R.LicenseUrl&&(Qa=R.LicenseUrl));for(const Pb of r){switch(Pb){case "L_ThePhoto":r=xi.qAf(CommonUIStrings.l_ThePhoto,
Ea);break;case "L_CCYYSA":r=xi.qAf(wb,Qa);break;case "L_PhotoAuthor":r=xi.KAf(CommonUIStrings.l_PhotoAuthor);break;default:r=xi.KAf(Pb)}r&&la.appendChild(r)}Ea=document.createElement("html");Ea.appendChild(la);return Ea}static KAf(r){const R=document.createElement("span");R.innerText=r;return R}static qAf(r,R){const la=document.createElement("A");la.setAttribute("href",R);la.setAttribute("target","_blank");la.setAttribute("rel","noreferrer");R=document.createElement("span");R.innerText=r;la.appendChild(R);
return la}static QLe(r){const R=xi.ili();return xi.ski(R,r)}static At(){}static nlj(r,R){let la;r&&15===r.Hj?(la=Hc.a.Pe(r.i6e,0,!1),r=Hc.a.Pe(r.nce,0,!1)):R&&0<R.Width&&0<R.Height?(la=R.Width,r=R.Height):(la=Hc.a.Pe(2,0,!1),r=Hc.a.Pe(2,0,!1));return{width:la,height:r}}}xi.ebg=!1;Object(h.a)(xi,"InsertMediaActor",null,[352]);var jj=d(540);class kj{}kj.wvl=864E5;kj.Bbi=3;kj.Xpk=144E5;Object(h.a)(kj,"AddinConstantsNum",null,[]);var zh=d(209),Mn=d(539),dk=d(448);class Se{constructor(r,R,la,Ea=null){this.fa=
Ea?Ea:z.AFrameworkApplication.fa;this.LCd=2;this.yyb=r;this.W2h=R;this.Lw=la}get eUa(){return this.LCd}get iHl(){return this.W2h}ISe(r){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.yyb(r,this.eUa,{["ak0"]:(new Date).getTime()});else if(dk.a.nuh(r)){var R=String.format(z.AFrameworkApplication.Aa.hb.lna+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",z.AFrameworkApplication.Aa.hb.Uk,this.iHl,z.AFrameworkApplication.gh);const la=z.AFrameworkApplication.Ke;let Ea=null;
this.Lw&&(Ea=this.Lw.Ci("ComponentAttach",Mn.a[r]+jj.a[this.eUa]));la.mj(R,1,null,null,!0,4,Qa=>{this.jzk(r,Qa.data.Sd);Ea&&Ea.stop()},Qa=>{n.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Qa.data.oe);Ea&&Ea.stop()},null)}else dk.a.Gbe(r)?(R=dk.a.h5d(r),this.yyb(r,this.eUa,{["ak0"]:R})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.yyb(r,this.eUa,null)}jzk(r,R){if(R&&""!==R&&(R=Sys.Net.XMLDOM(R))){dk.a.Jlb(zh.a.QPd,
((new Date).getTime()+kj.Xpk).toString(),r);let la=R.getElementsByTagName("update");la&&la.length||(la=R.getElementsByTagName("o:update"));la&&0<la.length&&(R=Date.parse(la[0].firstChild.nodeValue),(dk.a.h5d(r)<R||dk.a.Gbe(r))&&this.yyb(r,this.eUa,{["ak0"]:R}))}}}Object(h.a)(Se,"AddinCommandsAnonymousAPIInitializer",null,[856]);class Bg{constructor(r,R,la){this.LCd=la;this.yyb=r;this.Yh=R}get eUa(){return this.LCd}ISe(r){let R=null;this.Yh&&(R=this.Yh.Ci("ComponentAttach",Mn.a[r]+jj.a[this.eUa]));
(null==this.QXe(r)?0:this.QXe(r))&&this.yyb(r,this.eUa,{["ak0"]:(new Date).getTime()-kj.Bbi*kj.wvl});R&&R.stop()}}Object(h.a)(Bg,"AddinCommandsInitializerBase",null,[856]);class Ci extends Bg{constructor(r,R){super(r,R,5)}QXe(){return!0}}Object(h.a)(Ci,"AddinCommandsInitializer",Bg,[]);class jf extends Bg{constructor(r,R){super(r,R,1)}QXe(r){try{const R=zh.a.N1f()+r;return Boolean.parse(this.o4i(R)||"false")}catch(R){n.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",R.toString())}return null}o4i(r){const R=
localStorage;return void 0!==R&&null!==R?R.getItem(r):null}}Object(h.a)(jf,"AddinCommandsLocalCacheInitializer",Bg,[]);class yi{constructor(r,R=null){this.Lw=r;this.fa=R?R:z.AFrameworkApplication.fa}get appUILocale(){return hh.a.xe(z.AFrameworkApplication.lcid).name}VDj(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var r={};r[zh.a.uPi]="TeachingCallout";this.tMe(u.a.byl,r)}const R=this.y5d();if(R)if(this.fa.ka("OcpsIsEnabled"))A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(la=>{la.isFeatureEnabled("ConnectedServices",!0).then(Ea=>{for(let Qa of R){if(!Ea&&0===Qa.key)continue;const wb=this.QYf(Qa.value);wb&&wb.ISe(Qa.key)}return null})});else for(let la of R)(r=this.QYf(la.value))&&
r.ISe(la.key)}JSe(r,R,la){la&&la[zh.a.k6a]?(la[zh.a.Q7]=r,la[zh.a.P7]=R,this.tMe(u.a.HKb,la),dk.a.Jlb(zh.a.k6a,la[zh.a.k6a].toString(),r)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===r&&(la={},la[zh.a.Q7]=r,la[zh.a.P7]=R,this.tMe(u.a.maa,la))}QYf(r){let R=null;switch(r){case 1:R=new jf(Object(m.a)(this,this.JSe,"retrieveAddinFlagCompleted"),this.Lw);break;case 2:R=new Se(Object(m.a)(this,this.JSe,"retrieveAddinFlagCompleted"),this.appUILocale,
this.Lw,this.fa);break;case 5:R=new Ci(Object(m.a)(this,this.JSe,"retrieveAddinFlagCompleted"),this.Lw)}return R}}Object(h.a)(yi,"AddinCommandsInitializerHost",null,[]);var Cl=d(1128),Ud=d(158);class ag extends yi{constructor(r,R){super(r.h7f());this.Wn=r;this.Pb=R;Cl.a.d8b=Cl.a.Eah}szl(){this.VDj()}y5d(){const r=new Ud.a;this.Pb.ka("51")&&(r.$(0,2),r.$(16,5));this.Pb.ka("187")&&r.$(1,1);this.Wn.od.aua&&r.$(8,1);this.Pb.ka("305")&&r.$(10,5);return r}tMe(r,R){this.Wn.VG().La(r,2,R)}}Object(h.a)(ag,
"AddinCommandsInitService",yi,[763]);class Jf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Zb(r){this.K=r;A.a.instance.register(ag,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").oa(()=>new ag(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").egg&&this.K.resolve("Common.IAppSettingsManager").gf(()=>
{A.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").szl()})}dispose(){}}Object(h.a)(Jf,"AddInCommandsInitPackage",null,[2,3]);class Gm extends Wd{constructor(r,R=null){super(r,!0,R,!1)}get Zce(){return null}get dna(){return z.AFrameworkApplication.usa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get RAb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get QGc(){return null}}
Object(h.a)(Gm,"DownloadAsPdfDialog",Wd,[]);class Dc extends Gm{constructor(r){super(r)}get dna(){return z.AFrameworkApplication.usa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}kbc(){N.a.J(25544926,801,50,"Images download dialog displayed")}mbc(){N.a.J(25544928,801,50,"Images download dialog link clicked")}Rbb(){N.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(h.a)(Dc,"DownloadACopyAsImagesDialog",Gm,[]);var Dl=d(197);class Nl extends Ye{constructor(r){super(r,
void 0,z.AFrameworkApplication.usa)}get dna(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get RAb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get Vac(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get K1b(){return z.AFrameworkApplication.usa?"UIFontDialogTextLarge":null}kbc(){N.a.J(8958087,801,50,"ODP download dialog displayed")}mbc(){N.a.J(8958089,801,50,"ODP download dialog link clicked")}Rbb(){N.a.J(19505496,801,50,"ODP download dialog button clicked")}C1c(){Dl.Redirect.showHelp("PPTODF");
return!0}get Sac(){return z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("EnableReactDialogs")&&Db.a("ReactDialogsODPDialogFix")?null:"#"}get tVa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get RYg(){return!z.AFrameworkApplication.usa}}Object(h.a)(Nl,"DownloadACopyAsOdpDialog",Ye,[]);class Xh extends Gm{constructor(r){super(r)}get dna(){return z.AFrameworkApplication.usa?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}kbc(){N.a.J(21050910,
801,50,"PDF download dialog displayed")}mbc(){N.a.J(21050912,801,50,"PDF download dialog link clicked")}Rbb(){N.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(h.a)(Xh,"DownloadACopyAsPdfDialog",Gm,[]);var th=d(1155),Li=d(390);class $g extends Li.a{constructor(r,R,la){super();this.TX=null;this.W3c=0;this.Rd=this.wHg=null;this.vek=r;this.M7j=R;this.U4j=la;this.aZa=Object(m.a)(this,this.F5,"onRequestComplete");this.onError=Object(m.a)(this,this.Pwk,"onRequestError")}get Dkc(){return this.wHg}set Dkc(r){this.wHg=
r}get $s(){return this.Rd}set $s(r){this.Rd=r}start(){this.TMb()}TMb(){1!==z.AFrameworkApplication.Aa.state&&(this.TX=new th.a,this.TX.Ar=!1,this.TX.xd=5,this.TX.message=this.vek,this.TX.Qoa(ResourceStrings.l_GenericDialogTitle,null,null),this.W3c=0)}mT(){this.TX&&(this.TX.close(),this.TX=null)}F5(r){this.mT();r.eSa?this.Dkc(r):this.QY()}Pwk(r){r.WUi&&this.W3c<$g.L4k?(this.W3c+=1,r.start()):this.QY()}QY(){this.mT();if(1!==z.AFrameworkApplication.Aa.state){const r=new Oa.StandardDialog;r.xd=0;r.Gy(this.U4j,
ResourceStrings.l_GenericDialogTitle,this.M7j,this.$s)}}}$g.L4k=3;Object(h.a)($g,"UIBlockingTask",Li.a,[]);var L=d(262);class M extends $g{constructor(r){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,ck.a.Jpk);this.oB=r}start(){super.start();L.a.LAi(this.oB,Object(m.a)(this,this.xda,"handleWebserviceResponse"),Object(m.a)(this,this.wda,"handleWebserviceError"))}}Object(h.a)(M,"ConvertToOdpTask",$g,[]);class Ja extends $g{constructor(r){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,ck.a.aEk);this.oB=r}start(){super.start();L.a.NAi(this.oB,Object(m.a)(this,this.xda,"handleWebserviceResponse"),Object(m.a)(this,this.wda,"handleWebserviceError"))}}Object(h.a)(Ja,"ConvertToPdfTask",$g,[]);class pb{constructor(r,R,la){this.q4c=r;this.Ce=R;this.vse=la}get Qub(){return this.q4c.value}convert(r,R,la){let Ea=null;0===R?this.vse?new Nl(la):(Ea=new M(r),Ea.Dkc=Object(m.a)(this,this.dsk,"onConvertOdpRequestSucceeded"),Ea.start()):1===R?this.Ce.od.Wig&&
this.vse?new Xh(la):zj.a.BI(zj.a.Ib,()=>{Ea=new Ja(r);Ea.Dkc=Object(m.a)(this,this.esk,"onConvertPdfRequestSucceeded");Ea.start()}):2===R?this.Ce.od.llg&&this.vse&&new Dc(la):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",R))}dsk(r){r=r.result;1!==z.AFrameworkApplication.Aa.state&&(r=gb.a.eta(r.PrintUrl),new Nl(r))}esk(r){r=r.result;1!==z.AFrameworkApplication.Aa.state&&(r=gb.a.eta(r.PrintUrl),this.Qub.vIf=new Date,new Xh(r),this.Qub.fOf=new Date,N.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.Qub.XPf.toString(),this.Qub.rnh.toString(),this.Qub.vIf.toString(),this.Qub.fOf.toString()))}}Object(h.a)(pb,"Converter",null,[770]);class Tb{constructor(){this.XPf=this.rnh=this.vIf=this.fOf=yk.App.Vm}}Object(h.a)(Tb,"DownloadACopyAsPdfContext",null,[]);class Wc extends $g{constructor(r,R){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
ck.a.uJk);this.oB=r;this.rik=R}start(){super.start();L.a.print(this.oB,this.rik,Object(m.a)(this,this.xda,"handleWebserviceResponse"),Object(m.a)(this,this.wda,"handleWebserviceError"))}}Object(h.a)(Wc,"PrintTask",$g,[]);class sd{constructor(r,R,la){if(!r)throw Error.argumentNull("directPrintManager");this.Pcc=r;this.Ce=R;this.a8j=la}lwk(r){this.Pcc.GJk();r=r.result;1!==z.AFrameworkApplication.Aa.state&&(r=gb.a.eta(r.PrintUrl),this.Pcc.Wvh(r))}print(r,R,la){this.Ce.od.Wig&&this.a8j?(r=new eg.QueryStringBuilder(R),
r.yi(Ih.a.bCk,this.Pcc.Uuh().toString()),r.yi(Ih.a.ZBk,la.toString()),this.Pcc.Wvh(r.toString())):(la=new Wc(r,this.Pcc.Uuh()),la.Dkc=Object(m.a)(this,this.lwk,"onPrintRequestSucceeded"),la.start())}}Object(h.a)(sd,"Printer",null,[762]);class Ed{get name(){return"PowerPointWebEditor.PrintPackage"}Zb(){A.a.instance.register(sd,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().oa(()=>new sd(A.a.instance.ub("Common.App.DirectPrint.IDirectPrintManager"),A.a.instance.ub("PowerPointWebEditor.IApplicationContext"),
A.a.instance.ub("PowerPointWebEditor.IApplicationSettings").vg));A.a.instance.register(pb,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().oa(()=>new pb(A.a.instance.ie("PowerPointWebEditor.DownloadACopyAsPdfContext"),A.a.instance.ub("PowerPointWebEditor.IApplicationContext"),A.a.instance.ub("PowerPointWebEditor.IApplicationSettings").vg));A.a.instance.register(Tb,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().oa(()=>new Tb)}init(){}dispose(){}}Object(h.a)(Ed,"PrintPackage",null,
[2,3]);var ee=d(1042);class kb extends ti{constructor(r,R,la){super(r,R);this.la=la;this.Zy=ab.a.dtb}Yta(r){if(r&&r.length){var R=ab.a.Wz(this.Zy),la=this.nKj(r[0]);try{N.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",R,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(la?this.An.La(ab.a.mJc,2,r):this.An.La(this.Zy,2,r[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",
la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));N.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",R,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Ea){N.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",R,Ea.toString())}}}nKj(r){(r=!!r&&!!r.OriginalUrl&&0<r.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&
0<this.la.powerPointInsertContentSvgPath.length&&0<=r.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&r.OriginalUrl.toLowerCase().indexOf(".svg")===r.OriginalUrl.length-4)||N.a.J(512517842,352,50,"isChangeSvg = false");return r}}Object(h.a)(kb,"ChangeOnlineImageHelper",ti,[]);class cf extends ti{constructor(r,R,la){super(r,R);this.la=la;this.Zy=ab.a.kab}Yta(r){if(r&&r.length){var R=ab.a.Wz(this.Zy),la=new Map;la.set("InsertMediaCommand",R);ob.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",
null,la);try{const Qa=[],wb=[];for(let xc=0;xc<r.length;xc++){const ed=r[xc];this.sjg(ed)?Array.add(Qa,ed):Array.add(wb,ed)}N.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",wb.length,Qa.length,R);let Pb=this.Zy;Pb===ab.a.qXc&&(Pb=ab.a.tXc);for(r=0;r<wb.length;r++){var Ea=this.An.La(Pb,2,wb[r]);if(32!==Ea)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",wb.toString(),R));}if(this.sjg(Qa[0])&&(Ea=this.An.La(ab.a.qXc,
2,Qa),32!==Ea))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",Qa.toString()));N.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",wb.length,Qa.length,R)}catch(Qa){N.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.Zy.toString(),Qa.toString()),la.set("Exception",Qa.toString()),ob.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new hc.a,{extendedProperties:la}))}}}sjg(r){(r=
!!r&&!!r.OriginalUrl&&0<r.OriginalUrl.length&&this.la.jab&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=r.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&r.OriginalUrl.toLowerCase().indexOf(".svg")===r.OriginalUrl.length-4)||N.a.J(512517838,352,50,"isInsertSvg = false");return r}}Object(h.a)(cf,"InsertOnlineImageHelper",ti,[]);var Tf=d(717);class zg{constructor(r,R){this.zdb=!1;this.Udb=new Date(0);this.Tdb=
new Date(0);this.YAe=r;this.zb=R}N9f(){this.zdb=!0}GKa(){this.zdb?N.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.Udb>this.Tdb?N.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Udb+". Last scan at "+this.Tdb+"."):(this.Udb=new Date,this.zb.Db(new Q.a(3,1,0,Object(m.a)(this,this.kTe,"runJob"),90,"112")))}kTe(){this.Tdb=
new Date;this.zdb?N.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.YAe()&&this.GKa()}}Object(h.a)(zg,"PrefetchScheduler",null,[]);class ci{constructor(r,R,la){this.l3c=null;this.Eyg=R;this.Rsg=la;this.kBb=r}c9k(r){this.kBb!==r&&(this.kBb=r,this.l3c=null)}Rjj(){this.l3c||(this.l3c=this.poi());return this.l3c}poi(){const r=[];Array.add(r,this.kBb);for(let R=1;R<=this.Eyg||R<=this.Rsg;R++)R<=this.Eyg&&Array.add(r,this.kBb+
R),R<=this.Rsg&&0<=this.kBb-R&&Array.add(r,this.kBb-R);return r}}Object(h.a)(ci,"SlideWindow",null,[]);class ah{constructor(r,R,la,Ea,Qa,wb,Pb,xc){this.vfb=!1;this.jc=Qa;this.jq=Ea;this.Dwa=xc;this.mBb=new Tf.a;this.oA=new zg(Object(m.a)(this,this.B3e,"tryScan"),wb);this.eXg=new ci(Ea&&Ea.Ba?Ea.Ba.slideIndex:0,Pb?Pb.frl:10,Pb?Pb.erl:5);this.QWe(r,R,la)}start(){this.vfb?N.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(N.a.J(593773075,
813,100,"StreamVideoPrefetchOrchestrator Starting."),this.vfb=!0,this.oA.GKa())}QWe(r,R,la){r&&r.rI(Object(m.a)(this,this.Ked,"onEditSlideChanged"));R&&R.Bia(Object(m.a)(this,this.Gfd,"onPageContentLoaded"));la&&la.GPa(Object(m.a)(this,this.hyk,"onSlideshowSlideChanged"))}Gfd(r,R){this.vfb&&(r=Object(D.a)(116,R.node))&&r.fE&&(this.mBb.remove(r.Cb),this.oA.GKa())}Ked(r,R){R&&R.kna&&this.AB(R.kna.slideIndex)}hyk(r,R){R&&this.AB(R.slideIndex)}AB(r){this.eXg.c9k(r);this.vfb&&this.oA.GKa()}B3e(){const r=
this.n$d();0<r.length&&this.OTe(r[0]);return 1<r.length}n$d(){const r=[];var R=this.jq.presentation;if(!R)throw Error.argumentNull("Presentation is null");R=R.slides||[];for(const la of this.eXg.Rjj()){const Ea=R[la];this.Cil(Ea)&&Array.add(r,Ea)}return r}Cil(r){return!!r&&r.fE&&!r.SN&&!this.mBb.contains(r.Cb)}OTe(r){this.mBb.add(r.Cb);r=this.Ckj(r);0<r.length&&(N.a.J(593773072,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",r.length),this.Dwa?this.Dwa.fIk(r):N.a.J(593773070,
813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}Ckj(r){if(!this.jc)return N.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.oA.N9f(),[];const R=[];if(!r)return R;r=Object(D.a)(116,r);if(!r)return R;for(const la of r.Ek())(r=la.qpa)&&this.Dwa&&this.Dwa.obb(r)&&Array.add(R,r);return R}static mSj(r){return!!r&&r.ymg&&!Ae.a.Ni&&
!Ae.a.nFa&&!Ae.a.RI&&!Ae.a.Kme}}Object(h.a)(ah,"StreamVideoPrefetchOrchestrator",null,[]);class Qe{static addAppPLTEventToLog(r){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(r)}catch(R){}}static setIsPageLoadForFirstTime(r){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(r)}catch(R){}}}Object(h.a)(Qe,"VersionHistoryLogConnector",null,[]);class Di{constructor(r,R,la,Ea){this.bY=null;this.Ikh=this.ResetAppVersionController;this.Aw=r;this.Bi=
R;this.Ha=la;this.oc=Ea;this.jYa={}}OnVersionHistorySelected(r,R){try{N.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const la=document.getElementById("VersionHistoryViewerSpinner");la&&(la.style.display="none");if(this.bY)this.bY.onVersionSelected(r,R,this.jYa)}catch(la){N.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",la)}}ResetAppVersionController(r){try{if(this.bY)Qe.setIsPageLoadForFirstTime(!1),
this.bY.switchParentViewContainer(r);else{Qe.setIsPageLoadForFirstTime(!0);const R=new PowerPointVersionHistory.AppBootSettings;R.RenderServiceBase="";R.IsRtl=!1;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(m.a)(this.Aw,this.Aw.uXd,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(m.a)(this,this.CreateNotesIcon,"CreateNotesIcon");R.IsHighContrast=!1;this.Bi&&(R.IsHighContrast=this.Bi.isInHighContrastMode);R.IsHighContrast&&(R.ClientColorSettings=
this.Bi.highContrastColors.foregroundTextColor+"_"+this.Bi.highContrastColors.backgroundColor+"_"+this.Bi.highContrastColors.linkColor);if(this.oc){const Ea=this.oc.hTa();R.DefaultSlideWidth=Ea.width;R.DefaultSlideHeight=Ea.height}R.UserSessionId=z.AFrameworkApplication.userSessionId;R.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;R.ProgressImageResourceUrl=Ue.a.XK(ac.a.Rna);this.bY=new PowerPointVersionHistory.AppVersionController(R,r,la)}}catch(R){N.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
R)}}CreateNotesIcon(){return Fa.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(h.a)(Di,"PPTVersionHistorySelectionHandler",null,[716]);class pk extends Ye{constructor(r){super(r,void 0,z.AFrameworkApplication.usa)}get dna(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get RAb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Vac(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get K1b(){return z.AFrameworkApplication.usa?
"UIFontDialogTextLarge":null}kbc(){N.a.J(19743688,801,50,"Download a copy dialog displayed")}mbc(){N.a.J(19743690,801,50,"Download a copy dialog clicked")}Rbb(){N.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(h.a)(pk,"PowerPointDownloadACopyDialog",Ye,[]);class ch{Wll(r){new pk(r)}}Object(h.a)(ch,"PowerPointDownloadACopyDialogFactory",null,[694]);var hf;(function(r){r[r.unknown=0]="unknown";r[r.bing=1]="bing";r[r.M365=2]="M365";r[r.icons=3]="icons";r[r.oneDrive=4]="oneDrive";
r[r.hubbleVideos=5]="hubbleVideos"})(hf||(hf={}));Object(h.b)("InsertMediaProviders",hf);var Ij;(function(r){r[r.OK=0]="OK";r[r.cancel=1]="cancel";r[r.error=2]="error";r[r.open=3]="open"})(Ij||(Ij={}));Object(h.b)("HubbleAction",Ij);var Kf=d(529);class ne extends kd.a{constructor(r,R,la,Ea,Qa){super();this.GD=null;this.gyc=!1;this.Vdc=this.pFd=this.FX=null;this.pTd="KeepFocusDiv";this.qTd="KeepFocusStartDiv";this.correlationId=null;this.s5=0;this.insertPictureTelemetryEndpoint=null;this.u_d=0;if(!r)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.eef=r;this.P$e="";this.sTb=la;this.Z1=Ea;this.lBa=[];this.qId=R;this.rg=Qa||el.rg;this.hg="InsertMediaDialog";this.Ibe=!1;this.xd=5}QMb(r,R){this.P$e=r;this.gyc=!1;this.showDialog(this.P$e,null);this.FX=this.hSc(this.Nh("insertmediaframe"));if(!this.FX)throw this.t8a(this.mIc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(r=document.getElementById(this.Nh("WACDialogPanel")))&&r.setAttribute(pa.a.ef,pa.a.yRd);r=document.createElement("div");
r.setAttribute("Id",this.qTd);r.setAttribute("tabindex","0");r.setAttribute("position","absolute");r.setAttribute("width","-1000px");r.setAttribute("top","-1000px");this.FX.parentNode.insertBefore(r,this.FX.parentNode.firstChild);r=document.createElement("div");r.setAttribute("Id",this.pTd);r.setAttribute("tabindex","0");this.FX.parentNode.appendChild(r);r.setAttribute("position","absolute");r.setAttribute("width","-1000px");r.setAttribute("top","10000px");$addHandler(this.t_d,"keydown",Object(m.a)(this,
this.Zz,"keyDownHandler"));this.FX.setAttribute("src",this.eef);this.FX.setAttribute("width","100%");this.FX.setAttribute("height","100%");this.FX.setAttribute("frameborder","0");z.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(Ae.a.eg||Ae.a.L$b)?(this.FX.style.visibility="hidden",this.Vdc=Object(m.a)(this,this.muk,"onInsertMediaIframeLoaded"),nd.a.addHandler(this.FX,"load",this.Vdc)):this.FX.style.visibility="visible";this.hSc(this.Nh("WACDialogTitleText")).style.display=
"none";if(2===this.s5||5===this.s5)this.hSc(this.Nh("WACDialogTitlePanel")).style.display="none",this.hSc(this.Nh("WACDialogBodyPanel")).style.padding="0";ec.FocusManager.instance().yl().scope.bJ=!0;this.GD=this.qId.getInstance(this.FX.contentWindow,this.eef);this.GD.LBa("https://osiziwuspersimmon002.blob.core.windows.net");this.GD.LBa("https://osizewuspersimmon001.blob.core.windows.net");this.GD.LBa("https://osizpscuspersimmon000.blob.core.windows.net");this.GD.LBa("https://cdn.hubblecontent.msit.osi.office.net");
this.GD.LBa("https://cdn.hubblecontent.osi.office.net");this.GD.Vxa(id.a.Osf,la=>{this.gqk(la,Object(m.a)(R,R.Yta,"insertMediaCallback"))});this.GD.Vxa(id.a.insert,la=>{this.OHe(la,Object(m.a)(R,R.Yta,"insertMediaCallback"))});this.GD.Vxa(id.a.E6h,la=>{this.Avk(la)});this.GD.Vxa(id.a.m7i,Object(m.a)(this,this.wtk,"onGetCustomHeaders"));this.GD.Vxa(id.a.Kij,Object(m.a)(this,this.Htk,"onGetSessionId"));this.GD.Vxa(id.a.n4i,Object(m.a)(this,this.ttk,"onGetCID"));this.GD.Vxa(id.a.wpi,Object(m.a)(this,
this.ork,"onCancelDialog"));2===this.s5&&0===this.u_d&&(this.GD.Vxa(id.a.eZj,Object(m.a)(this,this.Iuk,"onLaunchM365Upsell")),this.pFd=this.Z1.rib("MsoPremiumStockImages",la=>{n.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.GD.sendMessage(id.a.EGl,{["LicenseTier"]:la.toString()})}));this.Ppc(3)}muk(){this.FX&&(this.FX.style.visibility="visible",window.setTimeout(()=>{if(this.ii){const r=this.ii.getElementById("insertmediaframe");r&&r.focus()}},0))}Zz(r){r.keyCode===
Sys.UI.Key.tab&&(r.target.id!==this.pTd||r.shiftKey?r.target.id===this.qTd&&r.shiftKey&&(r.preventDefault(),this.ii.getElementById(this.pTd).focus()):(r.preventDefault(),this.ii.getElementById(this.qTd).focus()))}dispose(){this.Z1&&this.pFd&&this.Z1.dKb("MsoPremiumStockImages",this.pFd);this.GD&&(this.GD.dispose(),this.GD=null);this.Vdc&&(nd.a.removeHandler(this.FX,"load",this.Vdc),this.Vdc=null);super.dispose()}gqk(r,R){n.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(r=this.sTb.j9g(r))50<
this.lBa.length?n.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.lBa,r),this.gyc&&(R(this.lBa),this.gyc=!1))}ork(){n.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.t8a(this.mIc);this.Ppc(1)}Ppc(r){var R=RegExp("hubble","gi");if(this.insertPictureTelemetryEndpoint&&0<this.insertPictureTelemetryEndpoint.search(R)&&this.correlationId){R=z.AFrameworkApplication.gd;var la={};la.InsertedFiles=this.lBa.length;la.DialogResult=Ij[r];
la.DialogMode=this.zcj();la.CorrelationId="{"+this.correlationId.toString()+"}";la.Platform="Wac";la.Provider=hf[this.s5]||"Unknown";la.AudienceGroup=R&&"AudienceGroup"in R?R.AudienceGroup.toString():"Unknown";la.Ring=R&&"Ring"in R?R.Ring.toString():"Unknown";la.AppId=yk.App.mode;la.Build=z.AFrameworkApplication.buildVersion;la.Locale=hh.a.xe(z.AFrameworkApplication.lcid).name;this.Jxa().send(JSON.stringify(la))}if(2===this.s5||5===this.s5){const Ea=z.AFrameworkApplication.fa.Ga("InsertMediaDialogAriaTenantNameSpace");
Ea&&""!==Ea&&(R=[],la="InsertUnknownContent",2===this.s5?(Array.add(R,Object.assign(new J.a,{name:"DialogMode",string:"M365Content"})),Array.add(R,Object.assign(new J.a,{name:"Provider",string:"M365Content"})),la="InsertM365Content"):5===this.s5&&(Array.add(R,Object.assign(new J.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(R,Object.assign(new J.a,{name:"Provider",string:"HubbleVideo"})),la="InsertHubbleVideo"),Array.add(R,Object.assign(new J.a,{name:"InsertedFiles",int64:this.lBa.length})),
Array.add(R,Object.assign(new J.a,{name:"DialogResult",string:Ij[r]})),Array.add(R,Object.assign(new J.a,{name:"CorrelationId",string:this.correlationId.toString()})),v.a.sendTelemetryEvent(Object.assign(new G.a,{name:String.format("{0}.{1}",Ea,la),dataFields:R})))}}zcj(){return 3===this.s5?"Icons":"Images"}hSc(r){const R=document.getElementById(r);if(!R)throw Error.invalidOperation(String.format("Couldn't get {0}.",r));return R}Jxa(){const r=new XMLHttpRequest;r.open("POST",this.insertPictureTelemetryEndpoint,
!0);r.setRequestHeader("Content-Type","");return r}OHe(r,R){n.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.t8a(this.mIc);R?this.lBa&&0<this.lBa.length?(R(this.lBa),this.Ppc(0)):(n.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.gyc=!0,R(this.lBa),this.Ppc(2)):this.Ppc(2)}wtk(){this.GD&&(n.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.GD.sendMessage(id.a.s$k,{["CustomHeaders"]:""}))}Htk(){this.GD&&(n.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),
this.GD.sendMessage(id.a.ldl,{["SessionId"]:z.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}ttk(){this.GD&&(n.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.GD.sendMessage(id.a.N9k,{["CID"]:""}))}Avk(r){r&&r.Values&&(r=r.Values,delete r.m_Origin,delete r.m_Source,delete r.m_ReceivedTime,n.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+r.eventName||!1),v.a.sendOtelEvent(Object.assign(new Kf.a,{otelEvent:r})))}Iuk(){this.Z1&&(n.ULS.sendTraceTag(512497693,
352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.Z1.launchUpsellExperience("stockimages"))}}Object(h.a)(ne,"InsertMediaDialog",kd.a,[733,106]);class xf{getInstance(r,R,la,Ea,Qa){return new ne(r,R,la,Ea,Qa)}}Object(h.a)(xf,"PptInsertMediaDialogFactory",null,[714]);var wn=d(113);class Nn{constructor(r){this.ddb=r;this.QWe(this.ddb.Qk,this.ddb.$Hg)}QWe(r,R){r&&r.rI(Object(m.a)(this,this.Ked,"onEditSlideChanged"));R&&R.Bia(Object(m.a)(this,this.Gfd,"onPageContentLoaded"))}cXk(r,
R){r&&r.U5(Object(m.a)(this,this.Ked,"onEditSlideChanged"));R&&R.k_a(Object(m.a)(this,this.Gfd,"onPageContentLoaded"))}Gfd(r,R){(r=Object(D.a)(116,R.node))&&r.fE&&(this.ddb.mBb.remove(r.Cb),this.ddb.oA.GKa())}Ked(r,R){R&&R.kna&&(this.ddb.jWa=R.kna,this.ddb.oA.GKa(),this.ddb.epe=new Date)}}Object(h.a)(Nn,"SlideEventListener",null,[]);class en{constructor(r,R,la){this.WUg="";this.zdb=!1;this.Udb=new Date(0);this.Tdb=new Date(0);this.YAe=r;this.zb=R;la&&(this.WUg=la)}N9f(){this.zdb=!0}GKa(){this.zdb?
N.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.Udb>this.Tdb?N.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Udb+". Last scan at "+this.Tdb+"."):(this.Udb=new Date,this.zb.Db(new Q.a(3,1,0,Object(m.a)(this,this.kTe,"runJob"),90,this.WUg)))}kTe(){this.Tdb=new Date;this.zdb?N.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):
this.YAe()&&this.GKa()}}Object(h.a)(en,"BackgroundJobScheduler",null,[]);class Rf{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd){this.Bad=null;this.epe=new Date;this.jWa=null;this.gyg={};this.EVg={};this.oWg={};this.fxg={};if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ea)throw Error.argumentNull("fontUtilsManager");this.jq=la;this.lz=Ea;this.Qk=r;this.$Hg=R;this.fFb=xc;this.RXa=ed;this.gFb=jd;this.rad=bd;this.mBb=new Tf.a;this.oA=new en(Object(m.a)(this,this.B3e,"tryScan"),Qa,"");0<wb&&
window.setInterval(Object(m.a)(this,this.Eqg,"logMissingFonts"),wb);this.ebk=Pb;r=la.Ba?la.Ba.slideIndex:0;if(R=this.jq.presentation)R=R.slides||[],r<R.length&&(this.jWa=R[r],this.epe=new Date)}dispose(){this.stop();this.Eqg()}start(){this.stop();this.Bad=new Nn(this);this.oA.GKa()}stop(){this.Bad&&this.Bad.cXk(this.Qk,this.$Hg);this.Bad=null}n$d(){const r=[];this.jWa&&r.push(this.jWa);return r}B3e(){const r=this.n$d();0<r.length&&(this.OTe(r[0]),this.mBb.add(r[0].Cb));return 1<r.length}koe(r,R,la,
Ea){const Qa=[];for(const wb of Object.keys(r))r[wb]||this.fxg[wb]||(Qa.push(wb),this.fxg[wb]=!0);r=Qa.length;0<r&&(N.a.J(la,820,15,"{0}",r),R&&N.a.J(Ea,820,15,"{0}",Qa.join(",")))}OTe(r){const R=r.lTa();if(R&&(this.fFb||this.gFb||this.RXa||Db.a("ShouldLogMissingThirdPartyFontCount"))){var la={},Ea={},Qa={};r.CWf.split(",").forEach(jd=>{jd&&(jd=this.lz.eG(jd),la[jd]=!1)});r.JBh.split(",").forEach(jd=>{jd&&(jd=this.lz.eG(jd),Ea[jd]=!1)});r.qFh.split(",").forEach(jd=>{jd&&(jd=this.lz.eG(jd),Qa[jd]=
!1)});r=[];var wb=[],Pb=[];for(let jd=0;jd<R.length;jd++){var xc=R[jd];xc=Array.isArray(xc.$D())?xc.$D():null;for(const bd of xc)for(xc=0;bd.Ra&&xc<bd.Ra.length;){var ed=bd.Ra.ga(xc);ed=ed.formatting?this.lz.eG(wn.Font.cEa(ed.formatting.cache.GN.trim().toLowerCase())):"";db.a.Wa(ed)||(ed in la&&!la[ed]?(r.push(ed),la[ed]=!0):ed in Ea&&!Ea[ed]?(wb.push(ed),Ea[ed]=!0):ed in la||ed in Ea||Qa[ed]||(Pb.push(ed),Qa[ed]=!0));xc++}}this.fFb&&(Rf.jee(this.gyg,r,this.lz),this.koe(la,!0,555886295,555886296));
if(this.RXa||Db.a("ShouldLogMissingThirdPartyFontCount"))Rf.jee(this.EVg,wb,this.lz),this.koe(Ea,this.RXa||this.rad,555886297,555886298);this.gFb&&(Rf.jee(this.oWg,Pb,this.lz),this.koe(Qa,this.rad,555886299,555886300))}}Eqg(){+new Date-+this.epe<this.ebk||(this.fFb&&Rf.uoe(this.gyg,this.lz,591003669,!0,"MissingFirstPartyFonts"),(this.RXa||Db.a("ShouldLogMissingThirdPartyFontCount"))&&Rf.uoe(this.EVg,this.lz,591003667,this.RXa||this.rad,"MissingThirdPartyFonts"),this.gFb&&Rf.uoe(this.oWg,this.lz,587337796,
this.rad,"MissingNonLoggableFonts"))}static jee(r,R,la){R.forEach(Ea=>{Db.a("ShouldNormalizeFontNamesBeforeLogging")&&(Ea=la.eG(Ea));if(void 0===r[Ea]||null===r[Ea])r[Ea]=!1})}static Tcj(r,R){if(!r)throw Error.argumentNull("fonts");const la=[];for(const Ea of Object.keys(r))r[Ea]||(R.h9(Ea)||R.h9('"'+Ea+'"')||la.push(Ea),r[Ea]=!0);return la}static uoe(r,R,la,Ea,Qa){R=Rf.Tcj(r,R);r=R.length;0<r&&(R=R.join(","),Ea&&587337796===la?N.a.J(la,820,15,"{0}",R):N.a.J(la,820,15,"{0}",Ea?R:r.toString()),la=
new Map,Ea&&la.set("Fonts",R),la.set("FontsCount",r.toString()),ob.Health.instance.recordQosError(Qa,["MissingFont"],!1,!1,!0,!1,Object.assign(new hc.a,{extendedProperties:la})))}}Object(h.a)(Rf,"FontLogger",null,[106]);var ko=d(970),dh=d(972);class zk{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf){this.fga=(Df,Eh)=>{var jk;this.Qf&&(this.Qf.Va("MediaFileValidationPassedOnUI","false"),this.Qf.Va("ErrorMessage",null===(jk=Eh.Message)||void 0===jk?void 0:jk.toString()),this.Qf.finish(),this.Qf=null);
Df=Eh.ExtraErrorParam?String.format(Eh.Message,Eh.ExtraErrorParam):Eh.Message;Eh=Object.assign(new dh.a,{title:Eh.Title,message:Df,timeoutInSeconds:120});this.LL.bvh(Eh)};if(!r)throw Error.argumentNull("applicationSettings");if(!R)throw Error.argumentNull("actionManager");if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ea)throw Error.argumentNull("graphActionBlockingManager");if(!Qa)throw Error.argumentNull("pptSelectionManager");if(!wb)throw Error.argumentNull("ribbonChangeManager");
if(!Pb)throw Error.argumentNull("transactionFactory");if(!xc)throw Error.argumentNull("shapeEditor");if(!ed)throw Error.argumentNull("errorHandler");if(!jd)throw Error.argumentNull("focusManager");if(!bd)throw Error.argumentNull("sessionInfo");if(!Ce)throw Error.argumentNull("mediaUploaderFactory");if(!Bf)throw Error.argumentNull("calloutNotificationAdapter");this.Ha=r;this.ia=R;this.ua=la;this.fc=Ea;this.ob=Qa;this.Nu=wb;this.Jb=Pb;this.Sk=xc;this.Rd=ed;this.Ea=jd;this.ut=la.presentation;this.Fe=
bd;this.beb=Ce;this.LL=Bf;ko.a.SHl=this.Ha.dJh;ko.a.NIl=this.Ha.PIl}wb(){this.ia.ra(ab.a.RMb,xa.a.application,this.axj.bind(this),4);Db.a("EnableCalloutNotificationsForVideos")&&hi.b(this.fga)}Ee(){}axj(r,R,la){const Ea=this.ua.Ba;if(!Ea||this.fc.$c(Ea))return 16;if(1===la)return 32;this.Qf=zj.a.yk("Video::Insert");try{return N.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),Hj.a.fZe(this.Ha.dJh.toString(),hi.e,()=>hi.d(r,this.VGj.bind(this),"video",this.Fe,Ea),"video",Ea,this.ua.presentation,
this.fc,this.Rd,this.Qf,!0,this.beb,this.Ha.Uuc,this.Ha.Tuc,this.Ha.Suc),this.Qf&&this.Qf.Va("VideoDialogInitialized","true"),32}catch(Qa){N.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Qa)}hi.a("video")?hi.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}showErrorMessage(r,R){this.Qf&&(this.Qf.finish(),this.Qf=null);this.Rd.cH(r,la=>{la.jC=1;la.ZRa=R;return!1})}VGj(r,R,la,Ea,Qa,
wb,Pb){Ea.UN(la)&&N.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+la.gja);Ea.fK(Pb);la=Pb.Ut();var xc=this.ut.slideHeight;Ea=this.ut.slideWidth/2-Hc.a.rf(ac.a.dY/2,0);xc=xc/2-Hc.a.rf(ac.a.dY/2,1);if(Pb&&Pb.isConnected){var ed=this.Jb.Ad(15,void 0,void 0,()=>{this.Nu.SF=this.RFb;this.ob.selectShape(this.RFb,!0);this.Ea.Ed()});try{ed.nc(Pb);ed.jd=r;Qa&&Qa.Va("CreatingVideoShape","true");this.RFb=this.Sk.YQa(!1,Pb.Cb.cid,
Pb.Cb.sid,0,10,Ea,xc,ac.a.dY,ac.a.u5,la+1);const jd=wb.files[0].name;this.RFb.Ruc=R;this.RFb.Quc=jd;Db.a("SetMediaTypeAsVideoForEmbeddedVideo")&&this.RFb.setValue(Yb.a.mediaType,2);Pb.dC(this.RFb)}finally{ed&&ed.dispose()}Qa&&(Qa.Va("VideoShapeSuccessfullyCreated","true"),Qa.finish(),Qa=null)}}}Object(h.a)(zk,"InsertVideoActor",null,[352]);class dj{constructor(){this.y$=this.nh=this.U4=this.K=null;this.lHg=[];this.Jcc=[new Ed];this.OX=[]}get name(){return"PowerPointWebEditor.Chronos2"}Mka(r){return r.resolve("PowerPointWebEditor.IApplicationSettings").cB||
r.resolve("PowerPointWebEditor.IApplicationSettings").VW}Zb(r){this.K=r;this.U4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.U4.kEa(5,this.name);this.y$=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Qa=0;Qa<this.Jcc.length;++Qa)Array.add(this.OX,Bc.a(this.Jcc[Qa],5));for(const Qa of this.OX)Qa.Zb(r);const R=this.K.resolve("PowerPointWebEditor.IApplicationContext"),la=z.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),
Ea=Lf.a.$u(this.K.Ja("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.Mka(this.K)&&Object(Db.a)("EnhancementOfSDXPaneBootTime")||this.K.register(ee.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new ee.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),
this.Mka(this.K))).ma();this.K.register(Di,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().oa(()=>new Di(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(ok,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().oa(()=>
new ok(r.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new Od.a(()=>Ea.result),r.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(Gj,"Box4.Media.InsertOneDriveFileHelper").ma().oa(()=>new Gj(z.AFrameworkApplication.Ta));this.K.register(de,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().oa(()=>new de);this.K.register(cf,"PowerPointWebEditor.InsertOnlineImageHelper").ma().oa(()=>new cf(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(kb,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().oa(()=>new kb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Xe,"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().oa(()=>new Xe(new re(new Od.a(()=>
{if(z.AFrameworkApplication.Suh()){var Qa=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").L8a;Qa=new Tg(Qa.contentWindow,"*")}else Qa=R.P$i();return Qa}),la?gb.a.sQ(window.document.URL):gb.a.sQ(z.AFrameworkApplication.Nna),z.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(ge,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();this.K.register($f,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().oa(()=>
new $f);this.K.register(xf,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(694,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().oa(()=>new ch);this.K.register(ah,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().oa(()=>new ah(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let r=this.nh.zu("resolvechronos2");const R=this.K.resolve("Common.AFrameworkApplication"),la=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ea=la.od,Qa=R.wq,wb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),
Pb=this.K.resolve("Common.IActionManagerExtended"),xc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var ed=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const jd=this.K.resolve("PowerPointWebEditor.IFocusManager"),bd=Qa.Kd,Ce=this.K.resolve("Common.Transaction.ITransactionFactory"),Bf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Df=this.K.ie("PowerPointWebEditor.IClassFactory"),Eh=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),jk=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
tj=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),rk=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),ul=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Tn=Qa.nhb,Un=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),Yh=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),Vn=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),Wn=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Gn=this.K.resolve("PowerPointWebEditor.IShapeReader"),
jl=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.nh.Fu(r);r=this.nh.zu("regactorschronos2");ed=[...(this.Mka(this.K)&&Object(Db.a)("EnhancementOfSDXPaneBootTime")?[]:[new Am.a(Ea,this.K.resolve("Common.IAppSettingsManager"),ed,Pb,bd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ce,Df,xc,this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),jk,tj,rk)]),new wk(Ea,Pb,xc,this.K.Ja("PowerPointWebEditor.IAddinCommandsManager")),new xi(Ea,Pb,tj,Eh,jd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Ce,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),ul,Bf,Gn,jl,Wn,rk,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new ql(Pb,this.K.resolve("PowerPointWebEditor.ISlidePane"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tj,Eh,Wn,this.K.resolve("Common.Transaction.ITransactionFactory"),Bf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),jd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new zk(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Pb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tj,Eh,Wn,this.K.resolve("Common.Transaction.ITransactionFactory"),
Bf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),jd,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"))];for(const Hl of ed)Hl.wb(),Hl.Ee();xc.Orf=!0;this.nh.Fu(r);z.AFrameworkApplication.fa.gf(()=>{r=this.nh.zu("regfullactorschronos2");const Hl=[new lm(Pb,tj,jd,Eh,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").Ef,Un,la.fTa().ETj,Yh,this.K.resolve("PowerPointWeb.IPrinter"),
this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),Vn,wb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),R.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>z.AFrameworkApplication.yM,la.y7d(),pf=>z.AFrameworkApplication.Aa.hb.vXe(pf),
()=>z.AFrameworkApplication.oac,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new dn(Qa,Ea.I_i,Tn.embedPreviewUrl,Pb,ul,la.y7d(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const pf of Hl)pf.wb(),pf.Ee();this.nh.Fu(r)});N.a.J(512360593,809,50,"Chronos2Package::Init");for(const Hl of this.OX)this.nh.zu(Hl.name),Hl.init(),this.nh.Fu(Hl.name);
r=this.nh.zu("al");this.bEj();this.nh.Fu(r);z.AFrameworkApplication.fa.gf(()=>{if(Ea.powerPointIdeasIsEnabled){r=this.nh.zu("idea");var Hl=this.HEj();this.GEj(Hl);this.nh.Fu(r)}Ea.powerPointSmartLookupIsEnabled&&(r=this.nh.zu("smartLookup"),this.vFj(),this.nh.Fu(r));z.AFrameworkApplication.H0c()&&(r=this.nh.zu("versionhistory"),this.LFj(),this.nh.Fu(r));ah.mSj(Ea)&&Ta.a.get_instance().ek(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const pf=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
if(pf&&(pf.Tth||pf.Sth||pf.Uth)){const Vl=!db.a.Wa(z.AFrameworkApplication.fa.Ga("TenantId"))&&Array.contains(pf.mul,z.AFrameworkApplication.fa.Ga("TenantId"));this.K.register(Rf,"PowerPointWebEditor.Text.FontLogger").ma().oa(()=>new Rf(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),
pf.kmk,pf.jmk,pf.Tth,pf.Sth&&z.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),pf.Uth,pf.DQi&&Vl));Hl=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.lHg.push(Hl);Hl.start()}});z.AFrameworkApplication.wsa||(r=this.nh.zu("appforoffice"),this.ZDj(),this.nh.Fu(r));Ea.Rwh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Xne()}dispose(){for(const r of this.OX)r.dispose();for(const r of this.lHg)try{r&&r.dispose()}catch(R){N.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",
R.message,R.stack)}}bEj(){N.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const r=Ab.a.create("pptedit.augloop",null,()=>d.e(10).then(d.bind(null,1239)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const R=this.K.resolve("Common.ISharedDependencyLoader"),la=z.AFrameworkApplication.Aj("augloop-runtime-shim-ie",2);R.XAb(la).continueWith(()=>{kc.a.ey(r)})}else kc.a.ey(r)}catch(r){N.a.J(512360590,306,
10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",r.message,r.stack)}}HEj(){N.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var r=[this.y$.$tb(z.AFrameworkApplication.Aj("ir-plugin-ski.min.js",5))];r=Ab.a.create("pptedit.infrared",r,()=>d.e(13).then(d.bind(null,1245)));kc.a.ey(r);return r}GEj(r){N.a.J(512360587,809,50,"Start to download ideas.hermes.js file");r=this.y$.oYd(z.AFrameworkApplication.Aj("microsoft.ideas.runtime.js",5),[r],!1);
r=Ab.a.create("pptedit.ideas",[r],()=>d.e(14).then(d.bind(null,1247)));kc.a.ey(r)}vFj(){N.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const r=Ab.a.create("pptedit.smartlookup",null,()=>d.e(12).then(d.bind(null,1242)));kc.a.ey(r)}LFj(){const r=this.y$.$tb(z.AFrameworkApplication.nga+"pptVersionHistory.js");try{kc.a.ey(r)}catch(R){N.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",R.toString())}}ZDj(){const r=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");A.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Fbe()?dj.Qde():r.vg?z.AFrameworkApplication.fa.gf(dj.Tdg):Ta.a.get_instance().ek(8,()=>{dj.Tdg()})}static main(){z.AFrameworkApplication.Ug&&Ae.a.eg?N.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Dc(Bc.a(new dj,5))}static Qde(){A.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Zia();e.a.instance.Dc(new Jf)}static Tdg(){let r=
!1;try{window.self.requestIdleCallback(dj.Qde)}catch(R){r=!0}r&&window.setTimeout(dj.Qde,0)}}Object(h.a)(dj,"Chronos2Package",null,[2,3]);var xn=d(236),Jj;(function(r){r[r.unsupported=0]="unsupported";r[r.designer=1]="designer";r[r.blank=2]="blank"})(Jj||(Jj={}));Object(h.b)("AgendaSlideThemeType",Jj);var Le=d(114);class Do{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(h.a)(Do,"AgendaApplyInfo",null,[]);class El{constructor(){this.DeckSuggestionId=this.CorrelationId=
this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(h.a)(El,"AgendaThemeApplyInfo",null,[]);class Mf{constructor(r,R){this.z2d=!1;this.$Le=[];this.pMf=r;this.gVi=R}}Object(h.a)(Mf,"DeckOptionInformation",null,[]);class Be{constructor(){this.eWg=this.fWg=0;this.Hug=[]}get vtd(){return this.fWg}set vtd(r){this.fWg=r}get utd(){return this.eWg}set utd(r){this.eWg=r}get P7a(){return this.Hug}set P7a(r){this.Hug=r}V$g(r,R,la){const Ea=new da.a;if(r)for(let Qa=0;Qa<la-1&&Qa<r.length;Qa++)Ea.add(new Mf(r[Qa],
!1));db.a.Wa(R)||Ea.add(new Mf(R,!0));this.P7a=Ea.toArray()}}Object(h.a)(Be,"AgendaDeckSessionInformation",null,[]);class lo{constructor(){this.Fbc=this.Gbc=this.$rg=0;this.$Ae=this.N2c=this.$ye=this.Z8c=null}l9k(r){r&&(this.$rg=r.body.slideIndex)}Sbl(r){r.body&&r.body.outlineRequestContent&&(this.Z8c=JSON.stringify(r.body.outlineRequestContent))}h9k(r){r.body&&(this.Fbc=r.body.slideCId)}k9k(r){r.body&&(this.Gbc=r.body.slideSId)}i9k(r){this.N2c=r.id}EIj(r){return r===this.N2c?(this.N2c=this.Z8c=null,
!0):!1}JWj(){return!db.a.Wa(this.Z8c)&&!db.a.Wa(this.N2c)}Ibl(r){r.body&&r.body.outlineRequestContent&&r.body.outlineRequestContent.Slides&&(this.$ye=r.body.outlineRequestContent.Slides.length)}j9k(r){this.$Ae=r.body.score}}Object(h.a)(lo,"AgendaDetection",null,[]);var yn=d(1047);class ek{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce){this.Vua=this.gB=null;this.S2c=0;this.U_=null;this.ZEb="";this.U4c=!1;this.wla=0;this.x9=new da.a;this.aBg=!1;this.vi=r;this.Tb=R;this.ua=la;this.fc=Ea;this.Ha=Qa;this.Iq=
wb;this.Ge=xc;this.ob=ed;this.uw=jd;this.Oeb=bd;this.Pb=Ce;this.uw.Lsk(this.Ha)}NCh(){this.Rrh();this.LBi();this.wvb()?(this.U_=new Be,this.U_.vtd=this.kL(),this.Axl()):1!==this.wla||this.Ha.pOc?2===this.wla&&this.Ha.oOc&&(this.U_=new Be,this.U_.vtd=this.kL(),this.gyl()):this.fyl()}LBi(){this.Vua=Xd.a.create().toString();this.uw.w0k(this.Vua);this.uw.hqk()}G2e(r,R){if(this.gB){if(!this.gB.Gbc||!this.gB.Fbc){var la=this.Tb.XA(this.gB.$rg);this.gB.Gbc=la.Cb.sid;this.gB.Fbc=la.Cb.cid}la=this.Tb.XA(0);
this.vi.generateAgendaSuggestion(la.Cb.cid,la.Cb.sid,this.Vua,this.gB.Z8c,this.w1i(),r,R)}else R(null)}fyl(){this.G2e(Object(m.a)(this,this.Dvk,"onPODSTriggerAgendaConversionSuccessV1"),Object(m.a)(this,this.H4g,"onPODSTriggerAgendaConversionFailureV1"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}gyl(){for(let r of this.x9)r&&r.Fxl();this.G2e(Object(m.a)(this,this.Evk,"onPODSTriggerAgendaConversionSuccessV2"),Object(m.a)(this,this.Cvk,"onPODSTriggerAgendaConversionFailureV2"))}Axl(){this.G2e(Object(m.a)(this,
this.Fvk,"onPODSTriggerAgendaConversionSuccessV3"),Object(m.a)(this,this.I4g,"onPODSTriggerAgendaConversionFailureV3"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}Sgb(r,R){if(R.property===Yb.a.wZa&&this.S2c){r=Object(D.a)(537,R.node);if(r.wZa===ek.zKh)for(let la of this.x9)la&&la.Fqk();else if(r.wZa===ek.AKh){for(let la of this.x9)la&&la.w1g();this.U4c=!0}this.Oeb.Cm(Object(m.a)(this,this.Sgb,"onPresentationPropertyChange"));this.S2c=0}}w1i(){const r={};this.Ha.oOc&&2===this.wla&&
(r.shouldGenerateThemes="true",r.themeCount="3");this.wvb()&&(r.shouldNotConvertToGVMLBytes="true",r.shouldInsertBlankSlides="true");return Le.c(r)}m1i(r){const R={};R.SlideCount=this.pj().toString();R.isBlankThemeRequest=(this.U_.P7a[r].gVi&&!this.wvb()).toString();R.isRequestForDeckDesignerForNonBlankSlides=this.wvb();return Le.c(R)}wvb(){return this.Ha.pOc&&(1===this.wla||0===this.wla)}zxl(){this.ob.Qh();const r=this.ua.presentation;if(r){const R=this.Iq.me(15);try{R.nc(r),R.jd=ab.a.lZb,r.rrb=
Object.assign(new Do,{CorrelationId:this.Vua,AgendaSlideSid:this.gB.Gbc,AgendaSlideCid:this.gB.Fbc})}finally{R&&R.dispose()}this.fc.fw(r,ab.a.lZb);this.fc.fK(r)}else this.eed()}OCh(r){this.ob.Qh();this.uw.afi(this.v6d(r));const R=this.ua.presentation;if(R){const la=this.Iq.me(15);try{la.nc(R),la.jd=ab.a.lZb,R.wZa=ek.yKh,this.S2c=this.kL(),this.Oeb.jk(Object(m.a)(this,this.Sgb,"onPresentationPropertyChange")),R.srb=Object.assign(new El,{DeckSuggestionId:this.v6d(r),AgendaSessionId:this.Vua,CorrelationId:Xd.a.create().toString()})}finally{la&&
la.dispose()}this.fc.fw(R,ab.a.lZb);this.fc.fK(R)}else this.eed()}eed(){for(let r of this.x9)r&&r.Eqk();this.fc.fK(this.ua.presentation)}Dvk(){this.zxl();this.U4c=!0;for(let r of this.x9)r&&r.w1g()}Evk(r){this.U_.utd=this.kL();const R=this.J1f(),la=new da.a;if(r.Images)for(const Ea of r.Images)la.add("data:image/jpg;base64, "+Ea);la.add(R);db.a.Wa(r.BlankSuggestionId)&&(r.BlankSuggestionId=Xd.a.create().toString());this.U_.V$g(r.DeckSuggestionId,r.BlankSuggestionId,ek.F6e);for(let Ea of this.x9)Ea&&
Ea.Hqk(la.toArray());this.J2e(0)}Fvk(){this.U_.utd=this.kL();this.U_.V$g(null,Xd.a.create().toString(),ek.F6e);this.J2e(0)}J2e(r){this.wvb()?this.TCh(r,Object(m.a)(this,this.Hvk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(m.a)(this,this.I4g,"onPODSTriggerAgendaConversionFailureV3")):this.TCh(r,Object(m.a)(this,this.Gvk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(m.a)(this,this.J4g,"onPODSTriggerAgendaDeckSuggestionFailure"))}TCh(r,R,la){if(this.U_.utd<this.U_.vtd)this.NCh();
else if(this.uw.Myk(r),this.ZEb=this.v6d(r),this.HVi(this.U_.P7a[r])){var Ea=Xd.a.create().toString();this.vi.generateAgendaDeckSuggestion(this.gB.Fbc,this.gB.Gbc,Ea,this.Vua,this.ZEb,this.m1i(r),R,la);N.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",Ea,this.ZEb)}else this.f0g(this.U_.P7a[r].$Le,this.ZEb),this.uw.s1g(r,!0)}Gvk(r){if(r.Images&&r.Images.length){var R=new da.a;for(var la of r.Images)R.add("data:image/jpg;base64, "+
la);this.f0g(R.toArray(),r.DeckSuggestionId);if(la=({themeIndex:r}=this.H0f(r.DeckSuggestionId)).returnValue)la.$Le=R.toArray(),la.z2d=!0;this.uw.s1g(r,!1)}else this.J4g(r)}Hvk(r){r.Images&&r.Images.length?this.OCh(0):this.eed()}f0g(r,R){for(let la of this.x9)la&&R===this.ZEb&&la.Aqk(r)}J4g(r){try{let R;const la=({themeIndex:R}=this.H0f(r.DeckSuggestionId)).returnValue;la&&(la.z2d=!1,la.$Le=[]);this.uw.zqk(R);if(this.ZEb!==r.DeckSuggestionId)return!0}catch(R){N.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+
R.message)}for(let R of this.x9)R&&R.v1g();return!0}H4g(){this.eed();return!0}I4g(r){return this.H4g(r)}Cvk(){const r=this.J1f(),R=new da.a;R.add(r);for(let la of this.x9)la&&(la.Gqk(R.toArray()),la.v1g());return!0}J1f(){const r=this.Tb.XA(0);return this.Ge.rL(r.Cb).image.src}s_(r,R){try{this.gB||(this.gB=new lo);let la=!1;R?this.gB.EIj(r.id)&&(this.mqh(!1,this.wla),la=!0):(this.gB.l9k(r),this.gB.Sbl(r),this.gB.h9k(r),this.gB.k9k(r),this.gB.i9k(r),this.gB.j9k(r),this.Rrh(),this.gB.JWj()&&(this.mqh(!0,
this.wla),this.gB.Ibl(r)));if(!(0>=this.x9.count))for(let Ea of this.x9)try{Ea&&(la?window.setTimeout(()=>{Ea.e0g()},100):Ea.e0g())}catch(Qa){N.a.J(512496857,813,10,"Exception message: "+Qa.message)}}catch(la){N.a.J(512496856,813,10,"Exception message: "+la.message)}}mTk(r){r&&this.x9.add(r)}oBl(r){this.x9.remove(r)}mqh(r,R){this.aBg=this.Ha.pOc?r:r&&0!==R}W2f(){return this.aBg&&!this.U4c}WIe(r){this.U4c=!r}pj(){return this.ua.presentation.Qya+this.gB.$ye}Rrh(){this.wla=this.pmj();this.uw.H0k(Jj[this.wla]);
this.q0k()}q0k(){this.wvb()?this.uw.SRe("V3"):1!==this.wla||this.Ha.pOc?2===this.wla&&this.Ha.oOc&&this.uw.SRe("V2"):this.uw.SRe("V1")}pmj(){try{const r=this.Tb.FI();if(r&&0<r.length)for(const R of r)if(R){const la=R.ThemeFamilyId;if(this.Ha.oOc&&la.toLowerCase()===ek.LKh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ha.Mci,la)||Object(Db.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Pb.ka("DisableAgendaToPPTForUnsupportedTheme")&&void 0===yn.a.bza.find(Ea=>Ea.xPc===la))return 1}return 0}catch(r){return N.a.J(512496855,
813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+r.message),0}}v6d(r){return this.U_.P7a[r].pMf}H0f(r){let R;R=0;for(const la of this.U_.P7a){if(la.pMf===r)return{returnValue:la,themeIndex:R};R++}N.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+r);return{returnValue:null,themeIndex:R}}HVi(r){return r?!r.z2d:(N.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),
!1)}dispose(){this.Oeb.Cm(Object(m.a)(this,this.Sgb,"onPresentationPropertyChange"));this.S2c=0}kL(){return(new Date).getTime()}}ek.F6e=4;ek.LKh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";ek.AKh=1;ek.zKh=2;ek.yKh=0;Object(h.a)(ek,"AgendaConverterManager",null,[106]);class Gf{constructor(r,R,la){this.uw=r;this.Lc=R;this.fO=la;this.Vu()}Vu(){this.Lc.EGc(Object(m.a)(this,this.Ina,"onUndoRedo"))}dispose(){this.Lc.uld(Object(m.a)(this,this.Ina,"onUndoRedo"))}A7b(r,R){r===ab.a.lZb&&(this.uw.WIe(R),this.fO.WIe(R))}Ina(r,
R){this.A7b(R.W3e,R.vbb)}}Object(h.a)(Gf,"AgendaConverterUndoRedoController",null,[696]);var nm=d(78);class lh{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(h.a)(lh,"IAgendaSettings",null,[]);class pe{constructor(r,R,la,Ea,Qa){this.zBf="HighConfidenceAgendaDetected";this.gz=null;this.va=new nm.a;this.M2c=null;this.Bbd=0;this.la=la;this.rt=R;this.Ea=Qa;this.gz||(R=new lh,R.isEntryState=!0,R.pptAppFrameDomElement=this.rt.FF(),R.maxTryAgainCount=this.la.Ivf,
this.gz=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(R));this.Arl();this.fO=r;this.la&&this.la.nOc&&this.fO.mTk(this);this.uw=Ea;this.Zbb=!1}e0g(){this.fO&&(this.fO.W2f()?(this.uw.p0k(this.fO.gB.$Ae),this.$uh(this.M2c),1===this.fO.gB.$Ae&&this.va.raiseEvent(this.zBf,null)):this.qce())}Fxl(){this.gz&&(this.uw.Bqk(),this.gz.showAgendaToPptDialog(this.fO.pj()),this.Ea.$Wc(dd.a.Hvf,dd.a.gj,document.getElementById("AgendaToPptDialogHostElement")),this.Ea.Cj(dd.a.Hvf,!0),this.Zbb=
!0)}w1g(){this.qce();this.uw.Dqk();window.setTimeout(()=>{this.Nxl()},8E3)}Hqk(r){this.hwh(r);this.uw.t1g(!0)}Gqk(r){this.hwh(r);this.uw.t1g(!1)}Aqk(r){this.Yll(r)}Eqk(){this.Bbd>=this.la.Ivf?this.gz.showAgendaToPptDismissCard():(this.Bbd+=1,this.gz.showAgendaToPptFailureCard());this.uw.p4g()}v1g(){this.gz&&this.Zbb&&this.gz.showSlidePreviewError()}Fqk(){this.gz.showMergeSlidesError();this.uw.p4g()}$uh(r){this.la.nOc&&(this.RUe(r),this.gz&&this.M2c&&this.fO&&this.fO.W2f()&&(this.gz.showAgendaCard(this.M2c,
this.fO.gB.$ye),this.uw.yqk()))}qce(){N.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.gz&&!this.Zbb&&(this.gz.hideAgendaCard(),this.RUe(null))}hwh(r){this.gz&&this.Zbb&&this.gz.populateThemesInAgendaDialog(r)}Yll(r){this.gz&&this.Zbb&&this.gz.populatePreviewSlidesInAgendaDialog(r)}RUe(r){this.M2c=r}Nxl(){if(this.la.zGk)try{const r=A.a.instance.Ja("Common.ISystemInitiatedFeedback");r&&(N.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),
r.execute(R=>{R.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(r){N.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",r)}}Arl(){this.gz.on(pe.BKh,()=>{this.Hci()});this.gz.on(pe.EKh,()=>{this.Kci()});this.gz.on(pe.CKh,()=>{this.Ici()});this.gz.on(pe.DKh,()=>{this.Jci()});this.gz.on(pe.IKh,r=>{this.Gci(r)});this.gz.on(pe.FKh,r=>{this.Gvf(r,!1)});this.gz.on(pe.GKh,()=>{this.Lci()});this.gz.on(pe.HKh,r=>{this.Gvf(r,!0)})}Hci(){this.fyh()}Kci(){this.uw.Oyk();
this.fyh()}Ici(){this.Fvf();this.uw.a2g()}Jci(){this.Fvf();this.uw.Gsk()}Fvf(){this.cleanup();this.fO.oBl(this)}fyh(){this.fO.NCh()}Gci(r){this.fO.J2e(r)}Gvf(r,R){this.uw.Cqk(r,R);this.Zbb=!1;this.gz.hideAgendaToPptDialog();this.fO.OCh(r)}Lci(){this.Zbb=!1;this.gz.hideAgendaToPptDialog();this.uw.a2g()}cleanup(){this.RUe(null);this.Bbd=0;this.gz.cleanup()}h$h(r){this.va.addHandler(this.zBf,r)}}pe.BKh="AgendaCardAddSlides";pe.EKh="AgendaCardTryAgain";pe.CKh="AgendaCardCancel";pe.DKh="AgendaCardDismiss";
pe.IKh="AgendaToPptDialogThemeSuggestionSelected";pe.FKh="AgendaToPptDialogApply";pe.GKh="AgendaToPptDialogCancel";pe.HKh="AgendaToPptDialogMergeTryAgain";Object(h.a)(pe,"AgendaConverterView",null,[697,711]);var Ol=d(679);class zn{constructor(){this.kgc={}}krd(r){this.kgc[r]=new Ol.a(r,!0)}oNb(r){if(r in this.kgc){var R=this.kgc[r];R.stop();R=R.WNc;delete this.kgc[r];return R}return-1}mJe(r){return r in this.kgc}}Object(h.a)(zn,"AgendaPerfLogger",null,[]);class Pl{constructor(){this.zZc=this.igg=
this.kgg=this.jgg=!1}T3j(){this.zZc&&!this.jgg&&(this.jgg=!0,$a.b(Pl.gmi))}u4j(){this.zZc&&!this.kgg&&(this.kgg=!0,$a.b(Pl.hmi))}S2j(){this.zZc&&!this.igg&&(this.igg=!0,$a.b(Pl.fmi))}static T1j(r){r&&r.HQ&&$a.b(Pl.emi)}}Pl.gmi="WAC_Exp_AgendaToPPTHighConfidenceSeen";Pl.hmi="WAC_Exp_AgendaToPPTHighConfidenceTried";Pl.fmi="WAC_Exp_AgendaToPPTHighConfidenceKept";Pl.emi="WAC_Exp_AgendaToPPTIsCreateNew";Object(h.a)(Pl,"ExperimentationMetrics",null,[]);class Qm{constructor(){this.Rre=this.lre=this.npe=
this.Vua=null;this.gte=!1;this.$wg=this.Zrg=this.ZUg=this.Ha=null;this.oCe="";this.jte=!1;this.mpe=""}reset(){this.ZUg={};this.Zrg=new zn;this.$wg=new Pl;this.oCe="";this.jte=!1;this.mpe="";this.Rre=this.lre=this.npe=this.Vua=null;this.gte=!1}get telemetryData(){return this.ZUg}get fPc(){return this.$wg}get S7(){return this.Zrg}get od(){return this.Ha}set od(r){this.Ha=r}get rsd(){return this.oCe}set rsd(r){this.oCe=r}get cSa(){return this.jte}set cSa(r){this.jte=r}get UP(){return this.mpe}set UP(r){this.mpe=
r}get cW(){return this.Vua}set cW(r){this.Vua=r}get LG(){return this.npe}set LG(r){this.npe=r}get SS(){return this.lre}set SS(r){this.lre=r}get documentOpenType(){return this.Rre}set documentOpenType(r){this.Rre=r}get g9b(){return this.gte}set g9b(r){this.gte=r}}Object(h.a)(Qm,"AgendaMetricsState",null,[]);var Rm=d(770);class Uj{constructor(r,R){if(!r)throw Error.argumentNull("AgendaThemetype is null");if(!R)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.pva=new Rm.a;this.pva.via(Object.assign(new J.a,
{name:"AgendaThemeType",string:r}));this.pva.via(Object.assign(new J.a,{name:"AgendaFlowVersion",string:R}))}a6(r){db.a.Wa(r)||this.pva.via(Object.assign(new J.a,{name:"AgendaSessionId",string:r}));return this}iod(r){this.pva.via(Object.assign(new J.a,{name:"AgendaThemeIndexSelected",int64:r}));return this}xjb(r){db.a.Wa(r)||this.pva.via(Object.assign(new J.a,{name:"AgendaCardState",string:r}));return this}OKa(r){db.a.Wa(r)||this.pva.via(Object.assign(new J.a,{name:"AgendaDialogState",string:r}));
return this}$_a(r){db.a.Wa(r)||this.pva.via(Object.assign(new J.a,{name:"AgendaButtonClickedType",string:r}));return this}bpd(r){db.a.Wa(r)||this.pva.via(Object.assign(new J.a,{name:"AgendaSeenTriedKept",string:r}));return this}s1(r){db.a.Wa(r)||this.pva.via(Object.assign(new J.a,{name:"DocumentOpenType",string:r}));return this}build(){return this.pva.dataFields}}Object(h.a)(Uj,"AgendaToPptActivityDataPointBuilder",null,[]);class di{constructor(){this.Vc=null;this.dYa=new Ol.a("AgendaToPpt",!1);this.RWe()}RWe(){this.Vc=
new Qm;this.Vc.reset();this.Vc.telemetryData.Flights="";z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)&&(this.Vc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Vc.telemetryData.InitialUserThemeType=this.Vc.UP}Lsk(r){r&&(this.Vc.od=r,this.Vc.documentOpenType=di.t8i(r),Pl.T1j(this.Vc.od),this.Vc.telemetryData.IsDocumentOpenTypeCreateNew=this.Vc.od.HQ.toString())}u1g(r,R){if(this.Vc.S7.mJe("AgendaToPptDialogThemeApply")&&
"V2"===this.Vc.LG){var la=this.Vc.S7.oNb("AgendaToPptDialogThemeApply");this.Vc.telemetryData.TotalTimeTakenToMerge=la.toString();$a.a(di.mW,r,la,R)}else this.Vc.S7.mJe("OnAddSlidesClicked")?(la=this.Vc.S7.oNb("OnAddSlidesClicked"),this.Vc.telemetryData.TotalTimeTakenToMerge=la.toString(),$a.a(di.mW,r,la,R)):this.Vc.S7.mJe("OnTryAgainClicked")&&(la=this.Vc.S7.oNb("OnTryAgainClicked"),this.Vc.telemetryData.TotalTimeTakenToMerge=la.toString(),$a.a(di.mW,r,la,R));this.Vc.g9b=!1}yqk(){this.Vc.g9b=!1;
if(!("Seen"in this.Vc.telemetryData)){this.TM("OnAgendaCardShown");this.dYa.start();this.Vc.telemetryData.Seen="true";N.a.J(576746627,813,50,"AgendaCard shown");const r=(new Uj(this.Vc.UP,this.Vc.LG)).xjb("AgendaCardShown").bpd("Seen").s1(this.Vc.documentOpenType).build();$a.a(di.mW,!0,0,r);this.Vc.fPc.T3j()}}hqk(){this.Vc.g9b?this.w4j():this.i1j()}i1j(){this.TM("OnAddSlidesClicked");this.dYa.stop();this.Vc.telemetryData.Tried="true";this.Vc.S7.krd("OnAddSlidesClicked");N.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",
this.dYa.WNc);const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).xjb("AgendaCardShown").$_a("AddSlides").bpd("Tried").s1(this.Vc.documentOpenType).build();$a.a(di.mW,!0,this.dYa.WNc,r);this.Vc.fPc.u4j()}Dqk(){this.TM("OnAgendaToPPTApply");this.Vc.cSa=!0;this.Vc.telemetryData.Kept="true";this.Vc.telemetryData.Event="AgendaCompleted";const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).xjb("AgendaCompleted").s1(this.Vc.documentOpenType).build();this.u1g(!0,r);N.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}Oyk(){this.Vc.g9b=
!0;this.TM("OnTryAgainClicked");this.Vc.telemetryData.Tried="true";this.Vc.telemetryData.Event="AgendaTryAgain";this.Vc.S7.krd("OnTryAgainClicked");N.a.J(556561858,813,50,"AgendaCard retry attempt")}w4j(){const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).xjb("AgendaMergeError").$_a("TryAgain").bpd("Tried").s1(this.Vc.documentOpenType).build();$a.a(di.mW,!0,0,r)}Bqk(){this.TM("OnAgendaDialogShown");this.Vc.SS="Loading";N.a.J(556602440,813,50,"AgendaDialog shown");const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).OKa(this.Vc.SS).s1(this.Vc.documentOpenType).build();
$a.a(di.mW,!0,0,r)}t1g(r){this.TM("OnAgendaThemePaneLoadedSuccess");this.Vc.SS=r?"ThemeSuggestions":"ThemeSuggestionsFailure";r=this.Vc.S7.oNb("OnAddSlidesClicked");this.Vc.telemetryData.ThemePaneLoadingTime=r.toString();const R=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).OKa(this.Vc.SS).s1(this.Vc.documentOpenType).build();$a.a(di.mW,!0,r,R)}afi(r){this.TM("ThemeDeckSuggestionId");this.Vc.telemetryData.SelectedDeckSuggestionId=r}Myk(r){"V2"===this.Vc.LG&&(this.TM("OnTriggerDifferentThemeWorkflow"),
this.Vc.SS="ThemeSuggestions",this.Vc.S7.krd("TriggerDeckLevelDesigner_"+r),r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).OKa(this.Vc.SS).iod(r).$_a("ThemeSelected").s1(this.Vc.documentOpenType).build(),$a.a(di.mW,!0,0,r))}s1g(r,R){this.TM("OnAgendaDeckPreviewLoaded");this.Vc.SS=R?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";R=this.Vc.S7.oNb("TriggerDeckLevelDesigner_"+r);this.Vc.telemetryData["DeckPreviewLoadTime_"+r]=R.toString();r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).OKa(this.Vc.SS).iod(r).s1(this.Vc.documentOpenType).build();
$a.a(di.mW,!0,R,r)}zqk(r){const R=this.Vc.S7.oNb("TriggerDeckLevelDesigner_"+r);this.TM("OnAgendaDeckPreviewError");this.Vc.SS="AgendaDeckPreviewError";let la="";"DeckPreviewFailure"in this.Vc.telemetryData&&(la=this.Vc.telemetryData.DeckPreviewFailure.toString());this.Vc.telemetryData.DeckPreviewFailure=la+r.toString()+";";r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).OKa(this.Vc.SS).iod(r).s1(this.Vc.documentOpenType).build();$a.a(di.mW,!1,R,r)}Cqk(r,R){this.TM("OnAgendaDialogThemeApply");this.Vc.SS=
R?"AgendaDeckMergeError":this.Vc.SS;this.Vc.S7.krd("AgendaToPptDialogThemeApply");r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).iod(r).OKa(this.Vc.SS).$_a(R?"TryAgain":"Apply").s1(this.Vc.documentOpenType).build();$a.a(di.mW,!0,0,r)}a2g(){this.TM("OnCancelClicked");this.Vc.cSa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaCancelled";N.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).$_a("Cancel").s1(this.Vc.documentOpenType);
"V2"===this.Vc.LG?r.OKa(this.Vc.SS):r.xjb("AgendaMergeError");$a.a(di.mW,!0,0,r.build())}Gsk(){this.TM("OnDismissClicked");this.Vc.cSa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaDismissed";N.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).$_a("Dismiss").s1(this.Vc.documentOpenType);"V2"===this.Vc.LG?r.OKa(this.Vc.SS):r.xjb("AgendaMergeError");$a.a(di.mW,!0,0,r.build())}p4g(){this.TM("OnMergingErrorInAgenda");
this.Vc.cSa=!0;this.Vc.telemetryData.Kept="false";this.Vc.telemetryData.Event="AgendaError";const r=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).s1(this.Vc.documentOpenType);"V2"===this.Vc.LG?(this.Vc.SS="AgendaMergeError",r.OKa("AgendaMergeError")):r.xjb("AgendaMergeError");this.u1g(!1,r.build())}WIe(r){let R=!1;this.TM("OnUndoRedoClicked");let la=(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).s1(this.Vc.documentOpenType);if("Kept"in this.Vc.telemetryData){this.Vc.telemetryData.Kept=(!r).toString();
const Ea=r?"UndoClicked":"RedoClicked";this.Vc.telemetryData.Event=Ea;la=la.$_a(Ea)}else R=!0,la.$_a("UndoRedoPostAgendaKept");$a.a(di.mW,!0,0,la.build());N.a.J(576746629,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!r).toString(),R.toString())}w0k(r){this.TM("ReportCorrelationID");this.Vc.telemetryData.CorrelationId=r;this.Vc.cW=r}H0k(r){this.TM("ReportInitialUserThemeType");this.Vc.telemetryData.InitialUserThemeType=r;this.Vc.UP=r}SRe(r){this.TM("ReportAgendaToPptFlowVersion");this.Vc.telemetryData.AgendaToPptFlowVersion=
r;this.Vc.LG=r}p0k(r){this.TM("ReportAgendaScore");this.Vc.telemetryData.AgendaScore=r.toString();1===r&&this.F0k()}F0k(){this.TM("ReportHighConfidenceAgendaDetected");this.Vc.telemetryData.HighConfidenceAgendaDetected="true";this.Vc.fPc.zZc=!0}dispose(){N.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",Le.c(this.Vc.telemetryData))}O0k(){if(!this.Vc.telemetryData||!Cb.a.count(this.Vc.telemetryData))return"";const r=Le.c(this.Vc.telemetryData);if(this.Vc.rsd===r)return"";this.Vc.rsd=r;if("Kept"in this.Vc.telemetryData){const R=
(new Uj(this.Vc.UP,this.Vc.LG)).a6(this.Vc.cW).bpd("Kept").s1(this.Vc.documentOpenType).build(),la=Boolean.parse(this.Vc.telemetryData.Kept.toString());$a.a(di.mW,la,0,R);la&&this.Vc.fPc.S2j()}this.Vc.cSa&&(this.RWe(),this.Vc.cSa=!1);N.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Vc.rsd,this.Vc.cSa.toString());return r}TM(r){this.Vc.telemetryData||(N.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",r),this.RWe())}static t8i(r){return r.HQ?
"NewDocument":r.pVa?"ViewOnlyDocument":"EditDocument"}}di.mW="AgendaToPptEvents";Object(h.a)(di,"AgendaMetrics",null,[695]);class mf{constructor(){this.Ha=this.K=null;this.RQg=!0;this.Yrg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.fO=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Zb(r){this.K=r;this.K.register(695,"PowerPointWebEditor.IAgendaMetrics").ma().oa(()=>new di);this.K.register(ek,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().oa(()=>new ek(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("Common.IAppSettingsManager")));this.K.register(696,"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().oa(()=>new Gf(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");
const R=xn.a(this.K);Db.a("AgendaToPPT.DisableLocalizedStrings")?R("agendaConverter").then(()=>{this.K.register(697,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>new pe(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{}):R("powerpoint-agenda-to-ppt-strings").then(()=>{R("agendaConverter").then(()=>{this.K.register(697,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().oa(()=>new pe(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").gf(Object(m.a)(this,this.lTk,"registerAgendaDetectionEventHandler"))}dispose(){}lTk(){this.Ha=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.fO=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const r=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ha.uQi&&this.RQg&&2===r.mode&&(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(R=>{R.pia(this.Yrg);
R.rgh(this.Yrg,Object(m.a)(this.fO,this.fO.s_,"handleAnnotationEvent"))}),this.RQg=!1)}static main(){e.a.instance.Dc(new mf)}}Object(h.a)(mf,"AgendaConverterPackage",null,[2,3]);var Wi=d(683);class fn{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd){this.Abc=0;this.ia=r;this.Rb=R;this.la=la;this.Ea=Ea;this.qe=Qa;this.pa=wb;this.Mm=Pb;this.vE=xc;this.Ou=ed;this.Wn=jd;this.Hwa=bd}wb(){this.l4h();this.la.VIk&&this.uUf()&&this.Hwa.continueWith(()=>{this.Hwa.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}l4h(){this.ia.ra(ab.a.Mhb,
mb.a.application,Object(m.a)(this,this.Mhb,"presentToTeams"),4);this.ia.ra(ab.a.YLe,mb.a.application,Object(m.a)(this,this.Mhb,"presentToTeams"),4);this.ia.ra(ab.a.XLe,mb.a.application,Object(m.a)(this,this.Mhb,"presentToTeams"),4)}lnh(){this.Ou.hide();this.I3d()}I3d(){let r;zj.a.ztd();r=this.cAk();this.showDialog();return r}cAk(){this.Wn.x$b=!0;const r=Xd.a.create().toString(),R=this.qe.documentUrl;try{const Ea={};Ea.pptSharingUrl=Wi.b(R);const Qa=encodeURIComponent(oe.c(Ea));let wb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}",
"1",r,Qa);if(!db.a.Wa(null)){const Pb=gb.a.YD(null);wb=wb+"&fqdn="+Pb;const xc=encodeURIComponent(oe.c({joinUrl:null}));wb=wb+"&meetingContext="+xc}var la=wb;n.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.Abc,r);window.open(la,"_top")}catch(Ea){return n.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Ea),!1}return!0}showDialog(){const r=new Oa.StandardDialog;r.xd=4;r.Xe(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);r.Xe(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);
r.Gx(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(m.a)(this,this.Imc,"protocolLaunchingDialogResultHandler"))}Imc(r){1===r||0===r?(n.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.y_a()):2===r&&(n.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(ab.a.XLe,2))}y_a(){this.ia.La(ab.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}uUf(){return!!this.qe.documentUrl}Mhb(r,
R,la){if(!this.uUf())return n.ULS.sendTraceTag(523084879,838,10,"PresentToTeamsActor: Document not supported"),8;if(1===la)return 32;this.Abc=r;if(this.Mm.isPaused)return this.Ea.Ed(),this.I3d()?32:8;this.pa.Qh();this.Ea.Ed();if(r===ab.a.XLe||1===this.Rb.mode)return this.I3d()?32:8;this.vE.u3(!0,!0,()=>{this.lnh()},()=>{n.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.lnh();return!0});this.Ou.show(!1,this.Abc);return 32}D5(){}C5(){}}Object(h.a)(fn,"PresentToTeamsActor",
null,[141]);class Eo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Zb(r){this.K=r}init(){z.AFrameworkApplication.fa.gf(()=>{(new fn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),
this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),Lf.a.$u(A.a.instance.Ja("Common.ISystemInitiatedFeedback")))).wb()})}dispose(){}static main(){e.a.instance.Dc(new Eo)}}Object(h.a)(Eo,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var On=d(732),fl=d(24);class fk{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=
0}}Object(h.a)(fk,"DesignerSuggestionApplyInfo",null,[]);var ej=d(337),Mi=d(525),Hm=d(111);class Ql{constructor(){this.xHc=null}}Object(h.a)(Ql,"IdeasSlideSuggestionWrapper",null,[]);var Pn=d(102);class gn{constructor(){this.trigger=null;this.cid=this.sid=0;this.DQ=null;this.timestamp=new Date;this.correlationId=Xd.a.create().toString()}}Object(h.a)(gn,"DesignerRequestData",null,[]);var Fo=d(199);class bm{}Object(h.a)(bm,"SlideSuggestionData",null,[]);class Bd{}Bd.omk="mivTitle";Bd.nmk="mivSubtitle";
Bd.Wcd="mivContainer";Bd.mmk="mivButtonsContainer";Bd.hZg="mivButton";Bd.lmk="mivButtonImage";Bd.eGb="mivOverlayContainer";Bd.jEe="mivIcon";Bd.fGb="mivTerm";Bd.jZg="mivFrame";Bd.pmk="mivView";Bd.kZg="mivIdx";Bd.lEe="mivKeepFocusStart";Bd.kEe="mivKeepFocusEnd";Bd.OQf="Editor";Bd.O0d="EditorContainer";Bd.eQi="EditorTitle";Bd.aQi="EditorSubtitleContainer";Bd.QQf="EditorSubtitle";Bd.PPi="EditorBucketContainer";Bd.k8a="EditorPrev";Bd.c3b="EditorPrevDisabled";Bd.Yub="EditorPrevEnabled";Bd.N0d="EditorBucketCurrent";
Bd.QPi="EditorBucketTotalCount";Bd.FQf="EditorBucketTotal";Bd.Wub="EditorNext";Bd.Xub="EditorNextEnabled";Bd.b3b="EditorNextDisabled";Bd.SPi="EditorDescription";Bd.VPi="EditorIgnoreContainer";Bd.a3b="EditorIgnore";Bd.ZPi="EditorSeeMoreContainer";Bd.e3b="EditorSeeMoreLabel";Bd.GQf="EditorCardContent";Bd.TQf="EditorSuggestionsContainer";Bd.GRa="EditorSuggestionContainer";Bd.dOc="EditorSuggestionArrow";Bd.bQi="EditorSuggestionCheck";Bd.SQf="EditorSuggestionText";Bd.RQf="EditorSuggestionInstances";Bd.WPi=
"EditorNoMoreContainer";Bd.cQi="EditorSvgCheck";Bd.fQi="EditorWhiteCheck";Bd.UPi="EditorGreenFill";Bd.TPi="EditorGreenBorder";Bd.XPi="EditorNoMoreLabel";Object(h.a)(Bd,"IdeasCss",null,[]);class Nh{}Nh.s8b="IdeasPane";Nh.FRa="editorSuggestionIdx";Nh.WK="ClosePane";Nh.IAj="IdeasPaneOpen";Nh.Gic=6;Nh.Kkk=3;Nh.BMf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(h.a)(Nh,"IdeasPaneConstants",null,[]);var Je=d(381),sj=d(169);class Ee{constructor(r,R,la,Ea,Qa,wb,Pb){this.$dc=
null;this.ua=r;this.oc=R;this.la=la;this.Sb=Ea;this.u$c=(r=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.v$c=r?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.zb=Qa;this.qe=wb;this.lBb=Pb}XCk(r){const R=[];try{if(!r||!r.SlideSuggestions)return N.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),R;for(let la=0;la<r.SlideSuggestions.length;la++){if(!r.SlideSuggestions[la])continue;
const Ea=r.SlideSuggestions[la].Base64Img;let Qa=null;try{Qa=Object.assign(new bm,{suggestionIndex:r.SlideSuggestions[la].Index.toString(),suggestionCid:r.SlideSuggestions[la].SlideId.Cid.toString(),suggestionSid:r.SlideSuggestions[la].SlideId.Sid.toString(),imageData:Ea.startsWith("data:image")?Ea:"data:image/png;base64,"+Ea,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)})}catch(wb){N.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),
Qa=null}Qa||(Qa=Object.assign(new bm,{suggestionIndex:r.SlideSuggestions[la].Index.toString(),suggestionSid:r.SlideSuggestions[la].SlideSid.toString(),imageData:Ea.startsWith("data:image")?Ea:"data:image/png;base64,"+Ea,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)}));Array.add(R,Qa)}}catch(la){N.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",la)}return R}W7i(r,R,la){if(!r)throw Error.argumentNull("suggestionsContainer");
return r.querySelector("#"+R+" ."+Ee.mQa+'[correlationId="'+la+'"]')}hae(){return this.la.wLi?this.la.vLi:this.la.uLi}PWc(r){if(!this.la.designerIncrementalRenderEnabled)return!1;let R=!0;switch(r){case Je.a.moreIdeas:R=!1;break;case Je.a.newDocument:R=!1}return R}zRe(r){N.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Sb.correlationId,r.R8a);if(r.Bub&&r.ePc&&r.qga){var R=this.gie(),la=r.qga.parentNode.parentNode.id;if(r.gZe&&this.la.rRa&&r.R8a)switch(r.Bub.DocumentUpsellStatus){case 0:this.C7h(r.qga);
break;case 1:this.Y5h(r.qga);break;case 2:this.H5h(r.qga)}r.R8a&&this.la.nOc&&this.cjh(r.qga);var Ea;if(Ea=r.R8a?this.WCi(r.ePc,r.Jh,r.qga,R,r.dvd):this.W7i(r.qga,la,r.Jh))try{const wb=this.Sb.sQa,Pb=!nf.a.Wa(wb)&&la===Nh.s8b,xc=this.sli(r.Bub,Pb,wb);if(r.R8a){this.Sb.Q1e=new Date;r.dvd&&this.Xpl(r.dUi);for(var Qa=0;Qa<Ea.childNodes.length;Qa++){let ed=Ea.childNodes[Qa];r.dvd&&this.ajl(xc,Qa)?Ee.qll(R,Qa,ed):this.vRe(Pb?wb[Qa].Type:0,r.qga,ed,la,r.ePc,xc[Qa.toString()],Qa,r.gZe,r.Bub.DocumentUpsellStatus)}this.la.zja&&
r.Bub.HasPaginationInfo&&this.Svh(r.qga,r.Jh)}else if(r.dvd){N.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Sb.correlationId,Cb.a.count(xc));for(Qa of Object.keys(xc)){const ed=parseInt(Qa);let jd=r.qga.querySelector("#"+la+" ["+Ee.kCa+'="'+ed+'"]');xc[Qa]&&jd&&Sys.UI.DomElement.containsCssClass(jd.firstChild,"IncSuggestionPlaceholder")&&this.vRe(Pb?wb[ed].Type:0,r.qga,jd,la,r.ePc,xc[Qa],ed,r.gZe,r.Bub.DocumentUpsellStatus)}}}catch(wb){N.a.J(510248773,
829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Sb.correlationId,wb)}}}A_k(r,R,la,Ea){try{if(!(r&&r.SlideSuggestions&&r.SlideSuggestions.length&&R))return!1;this.gWc(R);const Qa=R.querySelector("."+Ee.mQa);if(!Qa)return!1;const wb=Qa.childNodes.length,Pb=Qa.childNodes.length+r.SlideSuggestions.length,xc=this.gie(),ed=R.parentNode.parentNode.id;for(let jd=0;jd<r.SlideSuggestions.length;++jd){const bd=this.IJf(wb+jd,Pb,xc);this.vRe(0,R,bd,ed,Pb,r.SlideSuggestions[jd],
wb+jd,Ea,r.DocumentUpsellStatus);Qa.appendChild(bd)}r.HasPaginationInfo&&this.Svh(R,la);return!0}catch(Qa){return N.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",Qa),!1}}sli(r,R,la){const Ea={};if(R)for(const Qa of la)switch(Qa.Type){case 0:R=Qa;la=null;for(const wb of r.SlideSuggestions)if(wb.Index===R.IndexInDesigner){la=wb;break}Ea[Qa.Index.toString()]=la;break;default:Ea[Qa.Index.toString()]=Qa}else for(const Qa of r.SlideSuggestions)Ea[Qa.Index.toString()]=Qa;
return Ea}ajl(r,R){R=R.toString();return!(R in r)||!r[R]}C7h(r){const R=ic.a.Ie();R.className="DesignerFreeTrialCardContainer";const la=ic.a.Ie();la.className="DesignerFreeTrialCardTitle";la.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Ea=ic.a.Ie();Ea.className="DesignerFreeTrialCardContent";Ea.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.hae());const Qa=ic.a.Ie();Qa.className="DesignerStartFreeTrialButtonsContainer";const wb=ic.a.Ie();
wb.className=Ee.Csb;wb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;wb.tabIndex=0;wb.setAttribute(pa.a.ns,wb.innerText);wb.setAttribute(pa.a.ef,pa.a.yu);const Pb=ic.a.Ie();Pb.className=Ee.zIc;const xc=document.createElement("i");xc.className=Ee.FIc;xc.style.lineHeight="20px";xc.setAttribute("Unselectable","on");const ed=ic.a.Ie();ed.className="DesignerStartTrialGoPremiumButtonText";ed.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ed.setAttribute("Unselectable","on");
Pb.setAttribute(pa.a.ns,ed.innerText);Pb.setAttribute(pa.a.ef,pa.a.yu);Pb.tabIndex=0;Pb.appendChild(xc);Pb.appendChild(ed);Qa.appendChild(wb);Qa.appendChild(Pb);R.appendChild(la);R.appendChild(Ea);R.appendChild(Qa);R.setAttribute(pa.a.ns,String.format("{0}. {1}",la.innerText,Ea.innerText));R.setAttribute(pa.a.ef,pa.a.bCa);r.appendChild(R)}ZJf(){const r=ic.a.Ie();r.className="DesignerInFreeTrialView";const R=document.createElement("i");R.className=z.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":
"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const la=ic.a.Ie();la.className=Ee.j_b;la.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;la.tabIndex=0;const Ea=ic.a.Ie();Ea.className=z.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Ea.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;la.setAttribute(pa.a.ef,pa.a.zRd);la.setAttribute(pa.a.s6a,pa.a.Iia);la.setAttribute(pa.a.ns,la.innerText);r.appendChild(R);r.appendChild(la);r.appendChild(Ea);
r.setAttribute(pa.a.ns,la.innerText+" "+Ea.innerText);r.setAttribute(pa.a.ef,pa.a.bCa);return r}nxl(){const r=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(r)for(let R=0;R<r.length;R++){const la=r[R];if(la.parentNode){const Ea=this.ZJf();la.parentNode.replaceChild(Ea,la)}}this.JFh()}Y5h(r){const R=this.ZJf();r.appendChild(R)}H5h(r){const R=ic.a.Ie();R.className="DesignerFreeTrialCardContainer";const la=ic.a.Ie();la.className="DesignerFreeTrialCardTitle";la.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;
const Ea=ic.a.Ie();Ea.className="DesignerFreeTrialCardContent";Ea.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const Qa=ic.a.Ie();Qa.className=Ee.i_b;const wb=document.createElement("i");wb.className=Ee.FIc;wb.style.lineHeight="20px";const Pb=ic.a.Ie();Pb.className="DesignerTrialExhaustedGoPremiumButtonText";Pb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Qa.setAttribute(pa.a.ns,Pb.innerText);Qa.setAttribute(pa.a.ef,pa.a.yu);Qa.tabIndex=0;Qa.appendChild(wb);Qa.appendChild(Pb);
R.appendChild(la);R.appendChild(Ea);R.appendChild(Qa);R.setAttribute(pa.a.ns,String.format("{0}. {1}",la.innerText,Ea.innerText));R.setAttribute(pa.a.ef,pa.a.bCa);r.appendChild(R)}Svh(r,R){const la=ic.a.Ie();la.className=Ee.tTd;la.setAttribute(Ee.Bsb,R);la.tabIndex=0;R=new wc.a;R.lh(16,16);R.Eya("0,0,2048,2048");const Ea=new sj.a;Ea.r1("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
R.appendChild(Ea);R=R.xa;R.setAttribute("class","DesignerMoreIdeasButtonIcon");la.appendChild(R);R=ic.a.Ie();R.className="DesignerMoreIdeasButtonLabel";R.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;la.appendChild(R);la.setAttribute(pa.a.ns,R.innerText);la.setAttribute(pa.a.ef,pa.a.yu);r.appendChild(la)}Cll(r){if(r){var R=ic.a.RA();R.className="DesignerMoreIdeasLoading";R.src=Ue.a.XK(ac.a.Rna);r.appendChild(R)}}gWc(r){if(r){var R=r.querySelector("."+Ee.tTd);R&&r.removeChild(R);(R=r.querySelector(".DesignerMoreIdeasLoading"))&&
r.removeChild(R)}}WCi(r,R,la,Ea,Qa){const wb=ic.a.Ie();wb.className=Ee.mQa;wb.setAttribute(Ee.Bsb,R);wb.setAttribute(pa.a.ns,ResourceStrings.l_DesignerSuggestions);wb.setAttribute(pa.a.ef,pa.a.uZb);Qa&&(this.Sb.w_b=this.x4i());for(R=0;R<r;++R)wb.appendChild(this.IJf(R,r,Ea));la.appendChild(wb);return wb}IJf(r,R,la){const Ea=ic.a.Ie();Ea.className=la?this.u$c+"4x3":this.u$c;Ea.setAttribute(Ee.kCa,r);Ea.tabIndex=0;Ea.setAttribute(pa.a.ns,String.format(ResourceStrings.l_DesignerSuggestionItem,r+1));
Ea.setAttribute(pa.a.ef,pa.a.WPa);Ea.setAttribute(pa.a.BRd,r+1);Ea.setAttribute(pa.a.CRd,R);return Ea}vRe(r,R,la,Ea,Qa,wb,Pb,xc,ed){let jd=null;this.la.designerIncrementalRenderEnabled&&(R&&(jd=R.querySelector("#"+Ea+' [IncSuggestionPlaceholder="'+Pb+'"]')),jd&&Sys.UI.DomElement.addCssClass(jd,"ShimmerPaused"),this.N2j(Pb,Qa));R=!1;switch(r){case 0:this.Qdl(la,wb,Pb);R=(r=xc&&this.la.rRa)&&1!==ed;Qa=Ea=ed=!1;if(wb&&wb.Categories)for(const bd of wb.Categories)2===bd?ed=xc&&!r:1===bd?Ea=!0:3===bd?Qa=
!0:4===bd&&this.Nde(la,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Pb);(ed||R)&&this.Mel(la);Ea?this.Nde(la,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Pb):Qa&&(this.Nde(la,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Pb),la.setAttribute(Ee.kTd,Ee.kTd),la.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.j5h(la,wb);break;case 1:this.y_k(la,wb);break;case 2:this.p_k(la);break;case 3:case 4:this.L_k(la,wb)}jd&&jd.parentNode.removeChild(jd);wb=ic.a.Ie();wb.className=Ee.JIc;R&&(wb.style.visibility=qb.a.visible,la.removeAttribute("tabindex"),la.setAttribute(pa.a.QK,pa.a.gC));la.appendChild(wb)}y_k(r,R){if(R){r.className=Bd.Wcd;r.setAttribute(pa.a.ns,ResourceStrings.L_MakeItVisualCardTitle);var la=ic.a.Qn();la.className=Bd.omk;la.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Ea=ic.a.Qn();
Ea.className=Bd.nmk;Ea.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Qa=ic.a.Ie();Qa.className=Bd.mmk;Qa.setAttribute(pa.a.ef,pa.a.uZb);var wb=0,Pb=new Tf.a,xc=Math.min(Nh.Gic,R.SearchTerms.length);for(let ed=0;ed<xc;ed++)wb=this.oKf(R.SearchTerms[ed].Term,Qa,Pb,ed,wb);for(R=xc;R<Nh.Gic;R++)for(const ed of Nh.BMf)if(!Pb.contains(ed)){wb=this.oKf(ed,Qa,Pb,R,wb);break}r.appendChild(la);r.appendChild(Ea);r.appendChild(Qa);this.Sb.ncd=!0}}oKf(r,R,la,Ea,Qa){const wb=ic.a.Ie();wb.className=Bd.hZg;
wb.setAttribute(pa.a.ef,pa.a.WPa);const Pb=Bd.fGb+"."+Ea,xc=ic.a.RA();xc.className=Bd.lmk;xc.src=({kyb:Qa}=this.scj(r,la,Qa)).returnValue;xc.setAttribute(pa.a.P2,Pb);la=ic.a.Ie();la.className=Bd.eGb;la.tabIndex=0;la.setAttribute(Bd.kZg,Ea);la.setAttribute(pa.a.ef,pa.a.yu);Ea=document.createElement("i");Ea.className=Bd.jEe;Ea.innerText="\ue721";Ea.setAttribute(pa.a.ef,pa.a.nN);const ed=ic.a.Qn();ed.className=Bd.fGb;ed.innerText=r;ed.id=Pb;wb.appendChild(xc);wb.appendChild(la);la.appendChild(Ea);la.appendChild(ed);
R.appendChild(wb);return Qa}scj(r,R,la){for(const Ea of Nh.BMf)if(Ea.toLowerCase()===r.toLowerCase())return R.add(Ea),{returnValue:this.qe.qk(r+".png"),kyb:la};return{returnValue:this.qe.qk("stock"+la++ +".png"),kyb:la}}Pdl(r,R){if(r){var la=document.createElement("video");la.className="SuggestedVideoBackgroundContainer";la.setAttribute("Src",R);la.setAttributeNode(document.createAttribute("muted"));Fo.a.RSj()||(la.setAttributeNode(document.createAttribute("autoplay")),la.setAttributeNode(document.createAttribute("loop")),
la.addEventListener("canplay",()=>{la.muted="true";la.play()}));r.appendChild(la)}}Nde(r,R,la,Ea){if(r){var Qa=ic.a.RA();Qa.src=this.qe.qk(R);Qa.className="SuggestedMediaIcon";R=ic.a.Qn();R.className="SuggestedMediaContainer";R.appendChild(Qa);r.setAttribute(pa.a.ns,String.format(la,Ea+1));R.setAttribute("aria-hidden",pa.a.gC);R.setAttribute("Unselectable","on");r.appendChild(R)}}j5h(r,R){r&&R&&R.DesignDescription&&0!=R.DesignDescription.length&&r.setAttribute(pa.a.ns,R.DesignDescription)}Mel(r){if(r)if(this.la.rRa)Sys.UI.DomElement.addCssClass(r,
qb.a.Glc);else{r.setAttribute(Ee.CIc,Ee.CIc);var R=r.getAttribute(pa.a.ns);R&&r.setAttribute(pa.a.ns,String.format("{0}. {1}",R.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));pa.a.eP(r,pa.a.s6a,pa.a.Iia);R=ic.a.Ie();R.className=Ee.IIc;var la=document.createElement("i");la.className=Ee.FIc;R.appendChild(la);r.appendChild(R)}}JFh(){const r=document.getElementsByClassName(Ee.m_b);if(r)for(let R=0;R<r.length;R++){Sys.UI.DomElement.removeCssClass(r[R].parentNode,qb.a.Glc);r[R].parentNode.tabIndex=
0;r[R].parentNode.removeAttribute(pa.a.QK);const la=ka.a.gda(r[R].parentNode,Ee.JIc);!la||la.getAttribute(Ee.zTd)&&la.getAttribute(Ee.zTd).toString()===Ee.OBf||(la.style.visibility=qb.a.hidden)}}PBl(){if(this.la.rRa){var r=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(r)for(var R=0;R<r.length;R++)r[R].parentNode.removeChild(r[R]);if(r=document.getElementsByClassName("DesignerInFreeTrialView"))for(R=0;R<r.length;R++)r[R].parentNode.removeChild(r[R]);this.JFh()}else if(r=document.getElementsByClassName(Ee.IIc))for(R=
0;R<r.length;R++){r[R].style.display="none";const Ea=r[R].parentNode;Ea.removeAttribute(Ee.CIc);Ea.removeAttribute(pa.a.s6a);var la=Ea.getAttribute(pa.a.ns);la&&(la=la.toString(),la=la.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Ea.setAttribute(pa.a.ns,la))}}Qdl(r,R,la){if(r&&R)try{let Ea=!1;try{r.setAttribute(Ee.Esb,R.SlideId.Sid),r.setAttribute(Ee.yTd,R.SlideId.Cid),Ea=!0}catch(wb){N.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Ea=!1}Ea||r.setAttribute(Ee.Esb,R.SlideSid);const Qa=ic.a.RA();Qa.className=Ee.m_b;Qa.src=R.Base64Img;this.Sb.ssa.contains(R.Index)||this.Sb.ssa.add(R.Index);this.la.VMc&&!db.a.Wa(R.DesignerMediaURL)&&R.Categories&&nf.a.contains(R.Categories,1)&&this.Pdl(r,R.DesignerMediaURL);r.appendChild(Qa);N.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",la,this.Sb.correlationId)}catch(Ea){r.parentNode.removeChild(r),N.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
la,this.Sb.correlationId,Ea)}}p_k(r){if(nf.a.Wa(this.Sb.AW)||!this.Sb.Oyi())r.style.display=qb.a.none;else{r.className=Bd.O0d;var R=ic.a.Qn();R.className=Bd.eQi;R.innerText=ResourceStrings.L_ConsistencyCardTitle;var la=ic.a.Ie();la.className=Bd.aQi;var Ea=ic.a.Qn();Ea.className=Ea.id=Bd.QQf;Ea.innerText=Ea.title=this.Sb.AW[0].critiques[0].explanationLabel;var Qa=ic.a.Ie();Qa.className=Bd.PPi;var wb=ic.a.Qn();wb.innerText="<";wb.tabIndex=0;Sys.UI.DomElement.addCssClass(wb,Bd.k8a);Sys.UI.DomElement.addCssClass(wb,
Bd.c3b);wb.id=Bd.k8a;var Pb=ic.a.Qn();Pb.innerText="1";Pb.id=Bd.N0d;this.Sb.yN=0;var xc=ic.a.Qn();xc.innerText="/";var ed=ic.a.Qn();ed.className=Bd.QPi;ed.id=Bd.FQf;ed.innerText=this.Sb.AW.length.toString();var jd=ic.a.Qn();jd.innerText=">";jd.tabIndex=0;jd.className=jd.id=Bd.Wub;0<this.Sb.AW.length-1?Sys.UI.DomElement.addCssClass(jd,Bd.Xub):Sys.UI.DomElement.addCssClass(jd,Bd.b3b);Qa.appendChild(wb);Qa.appendChild(Pb);Qa.appendChild(xc);Qa.appendChild(ed);Qa.appendChild(jd);la.appendChild(Ea);la.appendChild(Qa);
Ea=ic.a.Qn();Ea.className=Bd.SPi;Ea.innerText=ResourceStrings.L_ConsistencyCardDescription;Qa=Ee.LJf();this.bag(Qa,0);wb=ic.a.Ie();wb.className=Bd.VPi;Pb=ic.a.Ie();Pb.className=Bd.a3b;Pb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Pb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Pb.tabIndex=0;wb.appendChild(Pb);Pb=ic.a.Ie();Pb.className=Bd.ZPi;xc=ic.a.Qn();xc.className=Bd.e3b;xc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;xc.tabIndex=0;Pb.appendChild(xc);xc=ic.a.Ie();xc.id=Bd.GQf;
xc.appendChild(la);xc.appendChild(Ea);xc.appendChild(Qa);xc.appendChild(wb);r.appendChild(R);r.appendChild(xc);r.appendChild(Pb);this.Sb.cOc=!0}}L_k(r,R){if(R){r.className=Ee.YBf;r.setAttribute(pa.a.ns,R.TitleText);r.setAttribute(Ee.kCa,R.Index);var la=this.Hrl(R.ExecutionActionName);if(la){var Ea=ic.a.RA();Ea.src=this.qe.qk("pegal.png");Ea.className=la;var Qa=ic.a.Qn();Qa.className="cui-img-container cui-img-24by24";Qa.appendChild(Ea);r.appendChild(Qa)}Ea=ic.a.Qn();Ea.className="DesignerSuggestedActionTitle";
Ea.innerText=R.TitleText;Qa=ic.a.Qn();Qa.className="DesignerSuggestedActionSubtitle";Qa.innerText=R.DescriptionText;R=ic.a.Ie();R.className=la?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";R.appendChild(Ea);R.appendChild(Qa);r.appendChild(R)}}cjh(r){try{if(this.lBb&&this.lBb.instance){const R=ic.a.Ie();R.id="AgendaCardContainer";R.className="AgendaCardContainer";r.appendChild(R);this.lBb.instance.$uh(R)}}catch(R){N.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Sb.correlationId,R)}}Hsi(){try{this.lBb&&this.lBb.instance&&this.lBb.instance.qce()}catch(r){N.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Sb.correlationId,r)}}Hrl(r){switch(r){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}bag(r,R){R=this.Sb.AW[R].critiques[0].suggestions;const la=Math.min(Nh.Kkk,R.length);for(let Ea=0;Ea<la;Ea++)this.yvj(r,R[Ea].description,R[Ea].numberOfInstances,
Ea)}yvj(r,R,la,Ea){const Qa=ic.a.Ie();Qa.className=Bd.GRa;Qa.tabIndex=0;Qa.setAttribute(Nh.FRa,Ea);const wb=ic.a.Qn();wb.className=Bd.dOc;wb.innerText="\u2192";wb.setAttribute(Nh.FRa,Ea);const Pb=ic.a.Qn();Pb.className=Bd.SQf;Pb.innerText=R;Pb.setAttribute(Nh.FRa,Ea);R=ic.a.Qn();R.className=Bd.RQf;R.innerText=String.format("[{0}]",la);R.setAttribute(Nh.FRa,Ea);Qa.appendChild(wb);Qa.appendChild(Pb);Qa.appendChild(R);r.appendChild(Qa)}Xpl(r){this.trd();this.$dc=new Q.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.M2j(r)},void 0,"IncrementalRenderTimeoutTask");this.zb.Db(this.$dc)}trd(){this.$dc&&(this.zb.Lg(this.$dc),this.$dc=null)}M2j(r){this.trd();for(let R=0;R<r;R++)this.Sb.ssa.contains(R)||this.Sb.OWc.add(R)}N2j(r,R){if(!this.Sb.rQa.contains(r)&&(this.Sb.rQa.add(r),r=this.Sb.rQa.count,r===R&&(this.Sb.TYb=new Date,this.trd()),!this.Sb.LPb&&r>=this.Sb.w_b)){for(R=0;R<this.Sb.w_b;R++)if(!this.Sb.rQa.contains(R))return;this.Sb.LPb=new Date}}x4i(){const r=document.getElementById("WACDocumentPanel");
if(r){const R=this.la.useWideSuggestionThumbs,la=this.gie();return Math.floor((r.offsetHeight-87)/(R||la?135:101))}return 1}gie(){const r=this.Gu();return.01>=Math.abs(r.width/r.height-1.33)}VEf(r,R){this.l5e(this.jwb(r,R),R,!1)}pph(r,R){this.l5e(r,R,!0)}SAl(r){if(r&&(r=r.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var R=-1!==r.className.indexOf("4x3");this.l5e(r,R,!1)}}l5e(r,
R,la){r&&(la?(r.className=R?this.v$c+"4x3":this.v$c,pa.a.eP(r,pa.a.t6a,pa.a.gC)):(r.className=R?this.u$c+"4x3":this.u$c,pa.a.eP(r,pa.a.t6a,pa.a.Iia)))}Gu(){return this.oc.Gu()}jwb(r,R){return r.querySelector("."+(R?this.v$c+"4x3":this.v$c))}get Ba(){return Object(D.a)(116,this.ua.Ba)}Snh(r,R){if(r){if(r=r.querySelector("["+Ee.kCa+'="'+R+'"]'))R=Oc.a.$h(r),r.contains(Oc.a.KSa(new Sys.UI.Point(R.x,R.y)))&&r.contains(Oc.a.KSa(new Sys.UI.Point(R.x+R.width-1,R.y)))?r.contains(Oc.a.KSa(new Sys.UI.Point(R.x,
R.y+R.height-1)))&&r.contains(Oc.a.KSa(new Sys.UI.Point(R.x+R.width-1,R.y+R.height-1)))||r.scrollIntoView(!1):r.scrollIntoView(!Db.a("Designer.ScrollIntoViewFix"))}else N.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static f_d(r){let R=null;try{R=oe.a(r)}catch(la){N.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return R}static qCk(r){const R=r.CardData;let la=null;try{if(la=oe.a(R),!r.SlideSuggestions&&
la)for(la=yj.e(la,Ea=>0!==Ea.Type),r=0;r<la.length;r++)la[r].Index=r}catch(Ea){N.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Ea)}return la}static qll(r,R,la){la.style.backgroundColor="white";const Ea=ic.a.Ie();Ea.className=r?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Ea.setAttribute("IncSuggestionPlaceholder",R);(Ae.a.Tj||Ae.a.eg)&&Sys.UI.DomElement.addCssClass(Ea,"Shimmer");la.appendChild(Ea)}static LJf(){const r=ic.a.Ie();r.className=
r.id=Bd.TQf;return r}}Ee.mQa="DesignerSuggestionList";Ee.Bsb="correlationId";Ee.kCa="suggestionIndex";Ee.Esb="slideId";Ee.yTd="slideCid";Ee.CIc="isShownAsPremiumContent";Ee.kTd="containsAnimation";Ee.OBf="Refreshing";Ee.zTd="SourceTrigger";Ee.m_b="SuggestionImg";Ee.FIc="ms-Icon ms-Icon--Diamond";Ee.IIc="ShadowedTriangleContainer";Ee.JIc="DesignerSuggestionListDisabled";Ee.tTd="DesignerMoreIdeasButton";Ee.YBf="DesignerSuggestedActionResult";Ee.j_b="DesignerInFreeTrialViewGoPremiumText";Ee.i_b="DesignerFreeTrialCardGoPremiumButton";
Ee.Csb="DesignerStartFreeTrialButton";Ee.zIc="DesignerStartFreeTrialGoPremiumButton";Object(h.a)(Ee,"DesignerViewHelper",null,[685]);class gl{constructor(){this.cid=this.sid=0;this.pWc=this.DQ=this.trigger=null}}Object(h.a)(gl,"PendingRequest",null,[]);class Ni{constructor(){this.EAe=!1;this.xDb=null}get Glg(){return this.EAe}get Log(){return this.xDb}static get inProgress(){const r=new Ni;r.EAe=!0;r.xDb=new Date;return r}static get ready(){const r=new Ni;r.EAe=!1;r.xDb=null;return r}}Object(h.a)(Ni,
"RequestState",null,[]);var mh=d(336),Rl=d(436);class An{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df,Eh,jk,tj,rk,ul,Tn,Un,Yh,Vn,Wn,Gn,jl,Hl,pf,Vl,Oq){this.fM=null;this.JIa=this.Gyg=0;this.lFg=!1;this.IVa=this.Kfb=null;this.Uug=!1;this.Otj=(vo,kt,lt)=>{if(1===lt)return 32;try{this.Op&&this.Op.Wo&&this.Op.Wo.isVisible?oc.UISurfaces.zr().then(Fp=>{Fp.setSelectedTaskPane(dd.a.d_);return null}).catch(Fp=>{N.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Fp.toString())}):this.ia.processAction(ab.a.Evb,
2)}catch(Fp){return N.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Fp.toString()),8}return 32};this.Qo=Pb;this.Op=xc;this.ir=ed;this.jz=jd;this.Sb=bd;this.ia=r;this.QT=R;this.ob=Qa;this.Ea=wb;this.ua=Ce;this.Pg=Bf;this.Lc=Df;this.la=jk;this.fc=la;this.Jb=Ea;this.vi=tj;this.yma=rk;this.Gma=Ni.ready;this.S9=ul;this.Fb=Tn;this.Oc=Un;this.zb=Yh;this.IFb=Vn;this.adc=jl;this.oc=Hl;this.cM=pf;this.uw=Vl;this.Xrg=Oq;this.Fyg=Object(m.a)(this,this.ksj,"handleFirstRunExperienceEvent");
Gn&&Gn.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(vo=>{this.lFg=vo;return null});this.ia.oaa(this)}wb(){this.la.RYc&&(this.ia.ra(ab.a.Avh,mb.a.application,Object(m.a)(this,this.zvh,"showHideIdeas"),4),this.ia.ra(ab.a.xYe,mb.a.application,Object(m.a)(this,this.zvh,"showHideIdeas"),4),Db.a("Designer.QueryNewPane")&&this.ia.ra(ab.a.tnc,mb.a.application,Object(m.a)(this,this.qMk,"queryShowHideDesignerPane"),96),(this.la.cB||this.la.VW)&&this.ia.ra(ab.a.G7g,mb.a.application,this.Otj,4),this.ia.ra(ab.a.Evb,
mb.a.application,Object(m.a)(this,this.wYe,"showHideDesigner"),4),this.ia.ra(ab.a.ZBa,mb.a.application,Object(m.a)(this,this.ZBa,"applyDesignerSuggestion"),4),this.ia.ra(ab.a.Irb,mb.a.application,Object(m.a)(this,this.ZBa,"applyDesignerSuggestion"),4),this.ia.ya(ab.a.PYa,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),this.ia.ya(ab.a.vGb,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),this.ia.ya(ab.a.wGb,mb.a.application,Object(m.a)(this,this.NYa,
"navigateDesignerSuggestion")),this.ia.ya(ab.a.OYa,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),this.ia.ya(ab.a.sGb,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),this.ia.ya(ab.a.tGb,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),this.ia.ya(ab.a.uGb,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),this.ia.ya(ab.a.tgb,mb.a.application,Object(m.a)(this,this.NYa,"navigateDesignerSuggestion")),
this.ia.ra(ab.a.noa,mb.a.application,Object(m.a)(this,this.noa,"reportSuggestionSessionInfo"),64),this.ia.ya(ab.a.LNf,mb.a.application,Object(m.a)(this,this.Sxl,"triggerOnUndoRedo")),this.ia.ya(ab.a.Kee,mb.a.application,Object(m.a)(this,this.v$f,"handleImageUploadForDesigner")),this.ia.ya(ab.a.wXc,mb.a.application,Object(m.a)(this,this.v$f,"handleImageUploadForDesigner")),this.yma.h6a(Object(m.a)(this,this.T0,"onSlidePresenceChanged")),this.Pg.rI(Object(m.a)(this,this.rLi,"designerTargetSlideChangedHandler")),
this.la.designerIncrementalRenderEnabled&&this.Lc.B$h(Object(m.a)(this,this.Nwk,"onRenderSuggestions")),this.la.zja&&this.Lc.Q8h(Object(m.a)(this,this.hvk,"onMoreIdesClicked")),this.la.DNf&&this.Lc.g6a(Object(m.a)(this,this.faa,"onRibbonTabSwitched")),this.la.FC&&this.Pg.hrb(Object(m.a)(this,this.pLi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.S9.LYb(Object(m.a)(this,this.sfa,"onBlockingStateChanged")),this.Pg.Xtf(Object(m.a)(this,this.Ved,"onForceOutboundGraphTransactionDisposed")),
this.IFb.KYb(Object(m.a)(this,this.Ogb,"onMarkedUndo")),this.la.l_d&&this.Oc.JPa(Object(m.a)(this,this.Vgb,"onSessionEnding")),this.Oc.fC(Object(m.a)(this,this.Do,"onSessionRehydrated")),this.adc&&this.adc.execute(r=>{r.muf(Object(m.a)(this,this.qHe,"onEditorCritiques"))}),this.Xrg&&this.Xrg.execute(r=>{r.h$h(Object(m.a)(this,this.$tk,"onHighConfidenceAgendaDetected"))}),this.la.kLi?(this.Gyg=window.setTimeout(Object(m.a)(this,this.K3e,"tryTriggerNewDocDesignerRequest"),this.la.jLi),window.addEventListener("FREDecisionEvent",
this.Fyg,!0)):this.K3e(),!db.a.Wa(this.la.rLe)&&this.sLi(this.la.rLe)&&(this.qrj(),this.Oxl(this.la.rLe)))}ksj(r){window.removeEventListener("FREDecisionEvent",this.Fyg,!0);window.clearTimeout(this.Gyg);(r=r.detail)&&r.show&&r.show||this.K3e()}Ee(){const r=this.Ea.Fc(dd.a.d_);r.bindAction(fb.KeyInputManager.Oa(Ba.a.U1,0),ab.a.PYa);r.bindAction(fb.KeyInputManager.Oa(Ba.a.SB,0),ab.a.PYa);r.bindAction(fb.KeyInputManager.Oa(Ba.a.aF,0),ab.a.vGb);r.bindAction(fb.KeyInputManager.Oa(Ba.a.Sq,4),ab.a.wGb);
r.bindAction(fb.KeyInputManager.Oa(Ba.a.S1,0),ab.a.OYa);r.bindAction(fb.KeyInputManager.Oa(Ba.a.RB,0),ab.a.OYa);r.bindAction(fb.KeyInputManager.Oa(Ba.a.Qw,0),ab.a.sGb);r.bindAction(fb.KeyInputManager.Oa(Ba.a.Sq,0),ab.a.tGb);r.bindAction(fb.KeyInputManager.Oa(Ba.a.VR,0),ab.a.uGb);r.bindAction(fb.KeyInputManager.Oa(Ba.a.oP,0),ab.a.tgb)}wYe(r,R,la,Ea,Qa){return this.FM(this.Op,dd.a.d_,la,r,Qa)}zvh(r,R,la,Ea,Qa){return Qa||!this.Qo.isVisible?this.FM(this.Op,dd.a.U$a,la,r,Qa):0}FM(r,R,la,Ea,Qa){var wb=
this.ua.presentation;wb=!!this.ua.Ba&&!!wb&&!this.fc.$c(wb);if(this.la.FC){const Pb=this.ob.Qe();wb=!!Pb&&1===Pb.length&&wb}if(!wb)return 16;if(!this.jz.isEnabled())return 8;if(1===la)return 32;Qa||this.Ea.Cj(R,r.Wo.isVisible);Ea===ab.a.Evb?this.Sb.correlationId&&!this.Sb.pAb(this.Sb.correlationId)||this.uda(Je.a.yOb):r.Wo.isVisible?r.Wo.xp(!1,mh.a.ANb):(this.uda(Ea===ab.a.xYe?Je.a.yOb:Je.a.Btc),r.Wo.xp(!0,mh.a.none));return 32}qMk(r,R,la,Ea,Qa){if(!Object(fl.a)(Hm.a,Qa)||!this.Op||!this.Op.Wo)return 8;
Qa.Mf(this.Op.Wo.isVisible);return 32}ZBa(r,R,la,Ea,Qa){R=this.ua.presentation;if(!this.ua.Ba||!R||this.fc.$c(R))return 16;Ea=null;let wb=!0;Object(fl.a)(fk,Qa)?Ea=Qa:Object(fl.a)(Ql,Qa)&&(Ea=Qa.xHc,wb=!1);if(!this.jz.isEnabled()||!Ea)return 8;if(this.jz.rBk())return N.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Ea.CorrelationId,r),8;if(1===la)return 32;if(!this.ob.Bs()){if(1===this.ob.Wd().length&&this.ob.Wd()[0].gy)return this.ob.Qh(),
N.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Ea.CorrelationId,r),8;this.ob.Qh()}if(!this.la.zja&&this.Sb.MZ.sid===Ea.SuggestionSid)return N.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Ea.CorrelationId,Ea.SuggestionSid),2;la=this.Jb.me(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.Sb.TPa=
new Date),la.nc(R),la.jd=r,R.dDa=Ea,this.Sb.MZ=O.a.UE(Ea.SuggestionSid,Ea.SuggestionCid),this.Sb.DT=!0,N.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ea.CorrelationId,r,Ea.SuggestionSid)}finally{la&&la.dispose()}this.la.designerBlockApplyUntilDraw?this.fc.Mra(R,this.ua.Ba,this.Fb.Ma,r):this.fc.fw(R,r);this.Qo.isVisible&&this.Ea.tf(dd.a.U$a);wb&&this.Sb.HDe();return 32}NYa(r,R,la){R=this.ua.presentation;if(!this.ua.Ba||!R||this.fc.$c(R))return 16;
if(!this.jz.isEnabled())return 8;if(1===la)return 32;this.jz.ywj(r);return 32}noa(r,R,la,Ea,Qa){if(this.jz.Op.Wo.isVisible)return 0;this.qLb(Qa.k_c,Qa.I1k);return 32}qLb(r,R){const la=this.Sb.correlationId;if(db.a.Wa(la))N.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",R);else if(this.Sb.pAb(la))N.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",la,R);else{var Ea={};
Ea.CachedTrigger=this.Sb.CTd;Ea.SuggestionSlideId=this.Sb.MZ.sid.toString();Ea.SuggestionSlideCreationId=this.Sb.MZ.cid.toString();Ea.AppliedSuggestion=this.Sb.DT;Ea.DisplaySuggestionsTimeoutInMs=this.la.k_d;Ea.SuggestionsTimeout=this.Sb.eVa;Ea.ClientAbort=this.Sb.dzb||this.jz.oBk();Ea.DesignerPaneClosed=r;Ea.ResetReason=R;Ea.HoverPreviewDesignerTriggered=this.Sb.cjg;Ea.DesignerFixPaneOpenHint=this.la.FNf;Ea.DesignerSendTraceRequestOnSessionEnded=this.la.l_d;Ea.UseWin32DesignerIconEnabled=this.la.n_d;
Ea.IsSimplifiedRibbon=this.P$b();this.la.DNf&&(Ea.DesignerDesignTabTriggerEnabled=!0);this.Op.Osa()&&(this.la.rRa?(Ea[K.a.iIh]=this.ir.hae(),Ea[K.a.jIh]=!0,this.Sb.n_e&&(Ea.StartUpsellFreeTrial=!0)):Ea[K.a.$Hf]=!0);r=!!R&&0<=R.indexOf(Je.a.moreIdeas);this.la.zja&&(Ea.TermCorrelationId=An.Q$d(),r||(Ea.TermAction=this.Slj()));var Qa=oe.b(z.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),wb={};wb.ClientOS=Qa.Os;wb.Browser=Qa.Browser||"";wb.BrowserVersion=Qa.BrowserVersion||"";wb.BrowserMajorVersion=
Qa.BrowserMajorVersion||"";wb.BrowserMinorVersion=Qa.BrowserMinorVersion||"";this.Sb.jsc&&this.Sb.rga&&this.Sb.rga>this.Sb.jsc&&(wb.SuggestionsE2ETimeMs=+this.Sb.rga-+this.Sb.jsc);this.la.designerIncrementalRenderEnabled&&(this.ir.trd(),this.s_e(),Ea[K.a.Jdg]=!0,wb.VisibleSuggestionsCount=this.Sb.w_b,0<this.Sb.OWc.count&&(wb.IncrementalRenderTimeoutIndexes=this.Sb.OWc.toArray().join(",")),0<this.Sb.kfa.count&&(wb.MissingDesignerCardIndexes=this.Sb.kfa.toArray().join(",")),0<this.Sb.rQa.count&&(wb.CardIndexes=
this.Sb.rQa.toArray().join(",")),0<this.Sb.ssa.count&&(wb.DesignerCardIndexes=this.Sb.ssa.toArray().join(",")),this.Sb.eQ&&(this.Sb.Uic&&this.Sb.Uic>this.Sb.eQ&&(wb.MissingDesignerCardsReceivedTime=+this.Sb.Uic-+this.Sb.eQ),this.Sb.TYb&&this.Sb.TYb>this.Sb.eQ&&(wb.AllIncRenderReceivedTime=+this.Sb.TYb-+this.Sb.eQ),this.Sb.LPb&&this.Sb.LPb>this.Sb.eQ&&(wb.VisibleIncRenderReceivedTime=+this.Sb.LPb-+this.Sb.eQ)));this.X5h(wb);try{if(this.uw.instance){const Pb=this.uw.instance.O0k();db.a.Wa(Pb)||(Ea.AgendaMetrics=
Pb)}}catch(Pb){N.a.J(512496583,813,10,"exception while populating AgendaMetrics",Pb)}Ea.BrowserData=wb;this.Sb.eQ&&this.Sb.rga&&this.Sb.rga>this.Sb.eQ&&(Ea.TimeToDisplaySuggestionsInMs=+this.Sb.rga-+this.Sb.eQ);this.Sb.Q1e&&this.Sb.qtc&&(Ea.TimeSuggestionsRendered=this.Sb.Q1e.toUTCString());this.Sb.qtc&&(Ea.TimeDesignerPaneClosed=this.Sb.qtc.toUTCString());this.Sb.pZb&&0<this.Sb.pZb.count&&(Ea.AppliedSuggestionHis=this.Sb.pZb.toArray().join(" "));this.vi.noa(la,Le.c(Ea),R===mh.a.cod);this.RDl(la,
R);this.Sb.jsf(la,this.la.zja&&r);N.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",R,la)}}P$b(){return z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.Np?!0:!1}X5h(r){r.IdeasMivShown=this.Sb.ncd;r.IdeasMivDrillIn=this.Sb.yDe;r.IdeasEditorShown=this.Sb.cOc;r.IdeasEditorKept=this.Sb.bOc;r.IdeasEditorDrillIn=this.Sb.HQf;r.AnyCardShown=this.Sb.cOc||this.Sb.ncd||0<this.Sb.rQa.count;
r.AnyCardKept=this.Sb.bOc||this.Sb.DT}RDl(r,R){this.jz.XIa(r,R===mh.a.ANb||R===mh.a.Jrd||R===mh.a.noSuggestion||R===mh.a.POf?ej.a.WIa:ej.a.pending)}Nwk(r,R){R.gzh.addRange(this.Sb.ssa);this.gEf(R.gzh,R.MTf,R.slideId,R.trigger,R.correlationId);R.R8a&&(this.IVa||this.Sb.kfa.count||this.Npl(R.trigger,R.MTf))}hvk(r,R){this.uda(Je.a.moreIdeas,null,R.l1c)}faa(r,R){!R.W$||"PptRibbon.Design"!==R.W$&&"Design"!==R.W$||2!==R.Hu&&3!==R.Hu&&4!==R.Hu||this.jz.Op.Wo.isVisible||32!==this.ia.processAction(ab.a.xqd,
1)||this.uda(Je.a.h_d)}Npl(r,R){this.s_e();const la=this.ua.Ba.Cb,Ea=this.Sb.correlationId;this.IVa=new Q.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Sb.pAb(Ea)||this.gEf(this.Sb.ssa,R,la,r,Ea,R)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.zb.Db(this.IVa)}gEf(r,R,la,Ea,Qa,wb=-1){if(this.Sb.ssa.count===R)this.s_e();else if(r&&r.count&&!(0<this.Sb.kfa.count)){if(-1===wb)for(let Pb of r)Pb>wb&&(wb=Pb);this.jri(r,R,wb)&&this.Pyl(la,Ea,Qa)}}jri(r,R,la){for(let Ea=0;Ea<R&&(r.contains(Ea)||
this.Sb.kfa.contains(Ea)||this.Sb.kfa.add(Ea),Ea!==la||this.Sb.kfa.count);Ea++);return 0<this.Sb.kfa.count}Pyl(r,R,la){const Ea={};Ea.MissingDesignerCardIndexes=this.Sb.kfa.toArray().join(",");this.IVa=new Q.a(0,1,0,()=>{this.vi.Vja(r.cid,r.sid,la,An.Q$d(),R,null,Le.c(Ea),()=>{N.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",Ea.MissingDesignerCardIndexes,la)},Qa=>{N.a.J(512496580,829,
15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Ea.MissingDesignerCardIndexes,Qa.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.zb.Db(this.IVa)}s_e(){this.IVa&&(this.zb.Lg(this.IVa),this.IVa=null)}T0(r,R){(r=this.ua.Ba)&&R.slideId.equals(r.Cb)&&(this.jz.Yqd(R.Uwh,R.sbh),this.jz.Op.Wo.isVisible&&!this.jz.isEnabled()&&(N.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",
R.Uwh,R.sbh,this.Sb.correlationId),this.Qo.xp(!1,mh.a.Jui)),this.Qo.isVisible&&(this.jz.isEnabled()||this.jz.XIa(this.Sb.correlationId,ej.a.WIa)))}rLi(r,R){R.kna?(r=Object.assign(new Mi.a,{slideId:R.kna.Cb}),this.ia.La(ab.a.WZa,2,r),this.jz.Yqd(r.Frc,r.rbh),this.Qo.isVisible&&(N.a.J(512496577,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Sb.correlationId),this.jz.isEnabled()&&!R.kna.SN?this.uda(Je.a.zZe):R.kna.SN&&this.la.designerNewSlideEnabled||
(this.Qo.xp(!1,mh.a.slideNavigation),this.jz.XIa(this.Sb.correlationId,ej.a.WIa)))):N.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Sb.correlationId)}x7b(r){this.la.designerRequestThrottlingEnabled&&(this.Gma=Ni.ready,this.fM&&(this.Qo.isVisible?(N.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.fM.trigger,this.fM.sid),r()):this.fM=null))}Ygb(r,R){this.x7b(R);N.a.J(512496547,
829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",r.HttpStatusCode);return!0}pLi(){if(this.jz.Op.Wo.isVisible){const r=this.ob.Qe();r&&1<r.length&&(N.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.Qo.isVisible&&this.Qo.xp(!1,mh.a.gnk))}}sfa(r,R){r=this.Sb.TPa;const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";
r&&Object(D.a)(String,R.actionName)===la&&(this.Sb.pZb.add(String.format("{0}:{1}:{2}",this.Sb.MZ,+r-+this.Sb.rga,+new Date-+r)),this.Sb.TPa=null)}Vgb(r,R){this.jz.Op.Wo.isVisible&&(N.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Sb.correlationId,Rl.a[R.lG]),1!==R.lG&&3!==R.lG||this.qLb(!0,mh.a.cod))}Do(){N.a.J(512496544,829,50,"DesignerActor::OnSessionRehydrated");const r={};r[K.a.tPc]=!0;this.uda(Je.a.refresh,r)}Ved(r,R){R&&this.Xae(R.actionId,R.transaction.Vy)}Ogb(r,
R){if(R.Bzb&&this.jz.ung(R.actionId)){r={};if(R.revisionId){const la=zj.a.Dta(Pn.a.BY,zj.a.$9a(R.revisionId.toString()).toString());la&&1===la.length&&(r[K.a.KD]=la[0].KD)}this.Xae(R.actionId,r)}}v$f(r,R,la,Ea,Qa){switch(r){case ab.a.Kee:return this.Sb.lkk(Qa),32;case ab.a.wXc:return this.Sb.AXk(Qa),32;default:return 2}}Jjk(r,R,la){if(r!==Je.a.insertPicture&&r!==Je.a.Bxa&&r!==Je.a.iXc)return null;const Ea=la?la[K.a.J7b]:!1,Qa=la?la[K.a.SVc]:!1,wb=la?la[K.a.K7b]:!1,Pb=la?la[K.a.RVc]:!1;let xc=null;
switch(R){case ab.a.vJa:case ab.a.nhd:xc=Ea?K.a.LDk:Qa?K.a.KDk:wb?K.a.MDk:Pb?K.a.JDk:null;break;case ab.a.phd:xc=Ea?K.a.PDk:Qa?K.a.ODk:wb?K.a.QDk:Pb?K.a.NDk:null;break;case ab.a.PPc:xc=K.a.hYf;break;case ab.a.insertOnlinePicture:case ab.a.Zta:xc=K.a.online;break;case ab.a.Teg:xc=K.a.icon}xc||N.a.J(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",r,R,this.Sb.correlationId);delete la[K.a.J7b];delete la[K.a.SVc];
delete la[K.a.K7b];delete la[K.a.RVc];return xc}Kjk(r,R){switch(r){case ab.a.PPc:case ab.a.insertOnlinePicture:case ab.a.Zta:case ab.a.ulc:case ab.a.Teg:case ab.a.Jsf:return Je.a.insertPicture;case ab.a.phd:case ab.a.vJa:case ab.a.nhd:case ab.a.hid:return R&&R[K.a.J7b]||R&&R[K.a.SVc]&&this.la.Exl?Je.a.insertPicture:R&&R[K.a.K7b]?Je.a.Bxa:R&&R[K.a.RVc]&&this.la.SCh?Je.a.iXc:this.la.zza?Je.a.yJa:"";case ab.a.gw:case ab.a.oCa:case ab.a.Orb:return Je.a.Orb;case ab.a.Yia:return Je.a.uZe;case ab.a.lqc:case ab.a.mqc:case ab.a.ipd:case ab.a.jpd:case ab.a.oqc:return R&&
K.a.Qxb in R&&R[K.a.Qxb]?Je.a.AUd:Je.a.refresh;case ab.a.uFf:case ab.a.c7a:return R&&K.a.Qxb in R&&R[K.a.Qxb]?Je.a.zNf:Je.a.refresh;case ab.a.RIa:case ab.a.Sib:case ab.a.Npc:case Yf.a.fUa:case ab.a.bringForward:case ab.a.bringToFront:case ab.a.sendToBack:case ab.a.sendBackward:return Je.a.Yib;case Yf.a.NRd:case Yf.a.QRd:case Yf.a.EZb:case Yf.a.PRd:case Yf.a.RRd:case Yf.a.SRd:case Yf.a.ZPa:case Yf.a.TRd:case Yf.a.URd:case Yf.a.VRd:case Yf.a.WRd:case Yf.a.YRd:case Yf.a.$Rd:case Yf.a.backspace:case Yf.a.gCa:case Yf.a.$K:case Yf.a.oRa:case Yf.a.enter:case Yf.a.zB:case Yf.a.typing:return Je.a.typing;
case ab.a.Bxa:return Je.a.Bxa;case ab.a.kid:return this.la.ka("DesignerUseRefreshTriggerForInsertTable")?Je.a.refresh:Je.a.insertTable;case ab.a.z5:case ab.a.Bdd:case ab.a.CGb:case ab.a.jQ:return Je.a.mna;case ab.a.RPa:return Je.a.UQd;case ab.a.YDf:return Je.a.uUd;case ab.a.dtb:return Je.a.dtb;default:return Je.a.refresh}}Sxl(){const r={};r[K.a.undoRedo]=!0;this.uda(Je.a.refresh,r);return 32}Xae(r,R){if(!this.pIj(r)){var la=wb=>{const Pb={};Pb[K.a.timestamp]=wb.timestamp;Pb[K.a.correlationId]=wb.correlationId;
Pb[K.a.trigger]=wb.trigger;Pb[K.a.sid]=wb.sid;Pb[K.a.cid]=wb.cid;Pb[K.a.DQ]=wb.DQ;wb=this.Jb.Ad(4);try{wb.nc(this.ua.presentation),wb.jd=ab.a.GNf,this.ua.presentation.Aub=Le.c(Pb)}finally{wb&&wb.dispose()}},Ea=this.Kjk(r,R),Qa=this.Jjk(Ea,r,R);db.a.Wa(Qa)||(R||(R={}),R[K.a.qDa]=Qa);this.jz.ung(r)&&this.Qo.isVisible?(this.Kfb&&this.zb.Lg(this.Kfb),this.jz.XIa(this.Sb.correlationId,ej.a.pending),this.Rod(Je.a.typing),this.Kfb=new Q.a(2,1,this.la.designerTypeRefreshThrottleTimeoutMs,()=>{this.Qo.isVisible&&
N.a.J(512496542,829,50,"Potential candidate for typing refresh request for designer pane");this.ojl(this.ua.Ba)||this.ZOc(la,Ea,R)},void 0,"DesignerTypingRefreshTask"),this.zb.Db(this.Kfb)):this.ZOc(la,Ea,R)}}uda(r,R=null,la=null){this.ZOc(Ea=>{if(this.la.designerRequestThrottlingEnabled){if(this.Gma.Glg&&+new Date-+this.Gma.Log<this.la.designerRequestThrottleIntervalMs){this.fM=new gl;this.fM.sid=Ea.sid;this.fM.cid=Ea.cid;this.fM.trigger=Ea.trigger;this.fM.pWc=Ea.DQ;N.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",
r,Ea.sid);return}this.Gma=Ni.inProgress;this.fM=null}const Qa=()=>{this.uda(this.fM.trigger,this.fM.pWc,la)};this.vi.Vja(Ea.cid,Ea.sid,Ea.correlationId,An.Q$d(),Ea.trigger,la,Le.c(Ea.DQ),wb=>{wb&&wb.Status===K.a.Bkh?this.nmd(()=>{this.uda(Ea.trigger,Ea.DQ,la)}):this.JIa=0;this.JIa||this.x7b(Qa)},wb=>this.Ygb(wb,Qa))},r,R)}nmd(r){this.JIa<this.la.designerMaxRetryOnWait?this.zb.Db(new Q.a(2,1,1E3,()=>{N.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Sb.correlationId);
this.Gma=Ni.ready;this.JIa++;r()},void 0,"RetryRequestOnWait")):N.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Sb.correlationId)}M$i(r,R=null){R=R||{};this.la.WMc&&r===Je.a.newDocument&&(R[K.a.yQi]="true");this.la.qLi&&(R[K.a.Nrl]=this.lFg);this.Op.Osa()&&(this.la.rRa?(R[K.a.iIh]=this.ir.hae(),R[K.a.jIh]=!0):R[K.a.$Hf]=!0);this.ir.PWc(r)&&(R[K.a.Jdg]=!0);this.jz.LKj()&&(R[K.a.HVd]=this.jz.HVd());R.NewPaneEnabled=!0;var la=!nf.a.Wa(this.Sb.AW);
(R.RequestForEditorCardsForNewIdeasPane=la)&&(R.NumEditorCritiques=this.yBi());la={};la.SupportsImageToTableSuggestedAction=32===this.ia.processAction(ab.a.kLe,1);R.PPTOEnabledSuggestedActions=Le.c(la);this.la.zza&&r===Je.a.yJa&&(R[K.a.lhb]=this.la.lhb,R[K.a.bKe]=this.la.bKe,R[K.a.aKe]=this.la.aKe);return R}yBi(){let r=0;for(const R of this.Sb.AW)for(const la of R.critiques)r+=la.suggestions.length;return r}pIj(r){if(void 0===r||null===r)return!0;switch(r){case ab.a.ZBa:case ab.a.Irb:case ab.a.OYa:case ab.a.sGb:case ab.a.tGb:case ab.a.PYa:case ab.a.vGb:case ab.a.wGb:case ab.a.uGb:case ab.a.tgb:case ab.a.GNf:return!0;
case ab.a.RIa:case ab.a.Sib:case ab.a.Npc:case Yf.a.fUa:case ab.a.bringForward:case ab.a.bringToFront:case ab.a.sendToBack:case ab.a.sendBackward:return!this.Sb.DT;default:return!1}}dGi(r,R=null){const la=this.ua.Ba;return la?Object.assign(new gn,{trigger:r,sid:la.sid,cid:la.cid,DQ:this.M$i(r,R)}):null}aTj(r){return this.bTj(r)}bTj(r){if(!r||!r.sid||!this.aig(r.trigger)&&!this.Qo.isVisible)return!1;switch(r.trigger){case Je.a.mna:case Je.a.Btc:case Je.a.yOb:case Je.a.insertPicture:case Je.a.Orb:case Je.a.h_d:case Je.a.$Wd:case Je.a.Bxa:case Je.a.zZe:case Je.a.uZe:case Je.a.insertTable:return!0;
case Je.a.iXc:return this.la.SCh;case Je.a.typing:return this.la.KNf&&this.Qo.isVisible;case Je.a.Yib:return this.la.designerRetriggerEnabled&&this.Sb.DT;case Je.a.AUd:case Je.a.zNf:return this.la.designerDesignElementsRemovedEnabled;case Je.a.yJa:return this.la.zza;case Je.a.UQd:case Je.a.uUd:case Je.a.dtb:return this.la.triggerDesignerAfterApplyReplaceObject;case Je.a.refresh:return this.USj(r.DQ);case Je.a.moreIdeas:return this.la.zja;case Je.a.newDocument:return this.la.WMc&&this.la.HQ&&!(Db.a("DesignerInvokeFix")&&
this.la.VW);case Je.a.fQd:return this.la.I2e;default:return N.a.J(512496538,829,15,"invalid trigger: {0}",r.trigger),!1}}USj(r){return K.a.tPc in r&&r[K.a.tPc]||K.a.undoRedo in r&&r[K.a.undoRedo]||this.la.nLi&&this.jz.Op.Wo.isVisible?!0:!1}aig(r){switch(r){case Je.a.Btc:case Je.a.yOb:case Je.a.insertPicture:case Je.a.iXc:case Je.a.uZe:case Je.a.AUd:case Je.a.Orb:case Je.a.Bxa:case Je.a.newDocument:case Je.a.UQd:case Je.a.h_d:case Je.a.$Wd:return!0;case Je.a.fQd:return this.la.I2e;case Je.a.yJa:return this.la.zza;
default:return!1}}oIj(r){if(!(this.la.designerSendActionDuration&&K.a.KD in r.DQ&&r.DQ[K.a.KD]))return!1;switch(r.trigger){case Je.a.Btc:case Je.a.yOb:case Je.a.zZe:case Je.a.newDocument:return!1;case Je.a.refresh:return!(K.a.tPc in r.DQ)||!(K.a.undoRedo in r.DQ);default:return!0}}Rod(r){const R=r===Je.a.typing?4:r===Je.a.moreIdeas?7:1;(this.jz.Op.Wo.isVisible||this.aig(r))&&this.Op.q0a(R)}a2d(r,R,la=null){this.Kfb&&(this.zb.Lg(this.Kfb),this.Kfb=null);const Ea=this.dGi(R,la);this.aTj(Ea)?this.Sb.MUj(this.ua.Ba.sid)?
(this.Rod(Ea.trigger),this.nmd(()=>{this.ZOc(r,R,la)})):(N.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",Ea.trigger,Ea.sid,Ea.correlationId),this.Sb.correlationId&&!this.Sb.pAb(this.Sb.correlationId)&&this.qLb(this.jz.Op.Wo.isVisible,Ea.trigger),this.Sb.jsc=new Date,this.Sb.correlationId=Ea.correlationId,this.Sb.CTd=Ea.trigger,this.Sb.eQ=this.oIj(Ea)?Ea.DQ[K.a.KD]:new Date,r(Ea),this.Rod(Ea.trigger),this.jz.XIa(Ea.correlationId,ej.a.pending)):(N.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",
R),this.Qo.xp(!1,mh.a.POf))}ZOc(r,R,la=null){if(this.la.designerAuthEnabled&&this.cM){this.Rod(R);la||(la={});var Ea=new Date;this.cM.nV(this.la.pptDesignerImplicitAuthAppName,this.la.designerResourceUri).then(Qa=>{const wb=+new Date-+Ea;Qa.IsSuccess?(la[K.a.tWi]=wb,la[K.a.M8k]=Qa.Token):(la[K.a.eVf]=wb,N.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Qa.ErrorCode+": "+Qa.ErrorMessage));this.a2d(r,R,la)}).catch(Qa=>{N.a.J(512496534,
829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Qa);la[K.a.eVf]=+new Date-+Ea;this.a2d(r,R,la)})}else this.a2d(r,R,la)}K3e(){if(this.la.WMc&&this.la.HQ)if(Db.a("DesignerInvokeFix")&&this.la.VW)N.a.J(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.oc){var r=this.ua.presentation;if(!r)throw Error.argumentNull("Presentation is null");var R=this.oc.FI();if(!R||0>=R.length)N.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");
else{var la="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===R[0].ThemeFamilyId.toLowerCase();la&&1!==R.length?N.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.H2e||la?!r.slides||0>=r.slides.length?N.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):la&&1!==r.slides.length?N.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):
(r=null,this.la.p8k&&this.la.YNb&&0<this.la.YNb.length&&(r={},r.TemplateId=this.la.YNb),N.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.uda(Je.a.newDocument,r)):N.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else N.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else N.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",
this.la.WMc,this.la.HQ)}qHe(r,R){this.Sb.rDl(R.d3b)}ojl(r){return!r||!this.Qo.isVisible}Slj(){const r=document.querySelector("."+Ee.mQa);return r&&(this.ir.jwb(r,!1)||this.ir.jwb(r,!0))?"Kept":"NotKept"}R2f(r){const R=new da.a;if(r&&r.children)for(let la=0;la<r.children.length;la++){const Ea=r.children[la].innerText;Ea&&0<Ea.length&&R.add(r.children[la].innerText)}return R.toArray()}gfj(r){if(!r)return null;var R=r.sa(df.a.mhb,null);if(R)return R.replace("\r","\n").replace("\n\n","\n").split("\n");
if(R=r.sa(df.a.FU,null))if(R=this.QT.qZa(R))return this.R2f(R);if(R=r.sa(df.a.dKe,null))if(r=this.QT.qZa(R))return this.R2f(r);return null}D5(){}C5(r){if(this.la.zza&&r.actionId===ab.a.hid&&32===r.response){var R=this.ob.Wd();if(R&&1===R.length&&R[0].id&&(R=this.gfj(Object(D.a)(10,r.rd)))&&!(0>=R.length)){var la={};la[K.a.RDk]=R;this.Xae(r.actionId,la)}}}sLi(r){switch(r){case K.a.VJh:return this.la.wQi;default:return!1}}qrj(){this.Qo.xp(!0,mh.a.none);this.uda(Je.a.$Wd);this.Op.q0a(3)}Oxl(r){switch(r){case K.a.VJh:this.Pxl()}}Pxl(){if(this.la.DGk)try{const r=
A.a.instance.Ja("Common.ISystemInitiatedFeedback");r&&(N.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),r.execute(R=>{R.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(r){N.a.J(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",r)}}$tk(){this.la.I2e&&(this.Qo.isVisible||this.Uug||(this.Qo.xp(!0,mh.a.none),this.uda(Je.a.fQd),this.Op.q0a(3),N.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),
this.Uug=!0)}static Q$d(){const r=document.querySelector("."+Ee.mQa);return r&&r.getAttribute(Ee.Bsb)?r.getAttribute(Ee.Bsb).toString():null}}Object(h.a)(An,"DesignerActor",null,[141]);var xp=d(543),Go=d(700);class Bn{constructor(r){this.bucketId=r;this.critiques=[]}}Object(h.a)(Bn,"BucketedEditorData",null,[]);class Ho{constructor(r){this.CTd=this.correlationId=this.dWa=this.dtg=null;this.dzb=this.eVa=this.DT=!1;this.qtc=this.Q1e=null;this.cjg=!1;this.sQa=this.suggestions=this.LPb=this.TYb=this.eQ=
this.TPa=this.Uic=this.rga=this.jsc=null;this.yN=0;this.n_e=this.yDe=this.ncd=this.HQf=this.bOc=this.cOc=!1;this.xqe=[];this.HBe=[];this.Mcc=r;this.MZ=O.a.empty;this.pZb=new da.a;this.rQa=new da.a;this.ssa=new da.a;this.OWc=new da.a;this.kfa=new da.a;this.w_b=1}bkk(){this.U_a(0,0)}akk(){this.U_a(1,0)}HDe(){this.U_a(2,4)}U_a(r,R){this.Mcc&&this.Mcc.execute(la=>{const Ea=Object.assign(new Go.a,{cardId:xp.a.Swh,actionType:r,actionEngagement:R});la.Sdd(Ea)})}jsf(r,R){this.pAb(r)||(Array.add(this.xqe,
r),N.a.J(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",r,this.xqe.length));this.qSe(!R)}pAb(r){return Array.contains(this.xqe,r)}lkk(r){Array.add(this.HBe,r)}AXk(r){Array.remove(this.HBe,r)}MUj(r){return Array.contains(this.HBe,r)}get tWd(){return this.dWa}Oyi(){if(this.dWa)return!0;try{const r=A.a.instance.ub("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(r)return this.dWa=r,!0}catch(r){N.a.J(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",
r)}return!1}rDl(r){if(r){var R=[],la=new uc.a;for(const Ea of r.critiques){r=Ea.bucketId;let Qa=la.ga(r);Qa||(Qa=new Bn(r),la.$(r,Qa),R.push(Qa));Qa.critiques.push(Ea)}this.dtg=R}}get AW(){return this.dtg}qSe(r){this.correlationId="";this.MZ=O.a.empty;this.CTd="";this.dzb=this.eVa=this.DT=!1;this.qtc=null;this.cjg=!1;this.TPa=this.Uic=this.rga=this.jsc=null;this.pZb.clear();this.LPb=this.TYb=this.eQ=null;this.w_b=1;this.rQa.clear();this.ssa.clear();this.OWc.clear();this.kfa.clear();this.yN=0;this.n_e=
this.cOc=this.bOc=this.ncd=this.yDe=!1;r&&(this.suggestions=this.sQa=null)}}Object(h.a)(Ho,"DesignerContext",null,[688]);class ei{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(h.a)(ei,"DesignerSuggestions",null,[]);var te;(function(r){r[r.init=0]="init";r[r.loading=1]="loading";r[r.noSuggestion=2]="noSuggestion";r[r.showSuggestion=3]="showSuggestion";r[r.refreshing=4]="refreshing";r[r.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";
r[r.makeItVisualDrillIn=6]="makeItVisualDrillIn";r[r.loadingMoreIdeas=7]="loadingMoreIdeas";r[r.moreIdeas=8]="moreIdeas";r[r.noSuggestionRibbon=9]="noSuggestionRibbon"})(te||(te={}));Object(h.b)("DesignerViewState",te);class Oi{constructor(){this.suggestions=[]}}Object(h.a)(Oi,"SlideSuggestionNotificationData",null,[]);var hd=d(258),Kj=d(391);class jg{constructor(r,R,la){this.xob=this.WB=!1;r&&(this.SVa=r,this.SVa.isFeatureEnabled("PowerPointDesigner",!1).then(Ea=>{(this.WB=Ea)?N.a.J(591942685,829,
50,"DesignerStateManager:: Designer is enabled"):(this.xob=this.SVa.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?la?N.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):N.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):N.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.Pek=this.SVa.rib("PowerPointDesigner",Object(m.a)(this,this.Bvb,"featureStateChangeCallback")),
this.mck=R)}Osa(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.SVa&&(this.SVa.dKb("PowerPointDesigner",this.Pek),this.SVa=null)}get isEnabled(){return this.WB}get isFreemiumUpsellEnabled(){return this.xob}launchUpsellExperience(r){this.SVa&&this.SVa.launchUpsellExperience(r)}Bvb(r){r&&"PowerPointDesigner"===r.featureName&&(!this.isEnabled&&r.isEnabled&&this.mck(),this.WB=r.isEnabled)}}Object(h.a)(jg,"DesignerStateManager",null,[]);class bp{constructor(r,R,la){this.Qgk=r;this.uB=
R;this.ngk=la}toString(){return"SuggestionIndex:"+this.Qgk+" SlideId:"+this.uB+" CreationId:"+this.ngk}}Object(h.a)(bp,"LoggableSourceContext",null,[]);var cp=d(1150),Sl=d(958),Im=d(542);class Rh{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df){this.iec=!1;this.fDe=0;this.yo=this.RBb=null;this.va=new nm.a;this.kF=!!z.AFrameworkApplication.Aa&&!!z.AFrameworkApplication.Aa.hb&&z.AFrameworkApplication.Aa.hb.eX;this.wUh=!!z.AFrameworkApplication.Aa&&!!z.AFrameworkApplication.Aa.hb&&z.AFrameworkApplication.Aa.hb.eX&&
z.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesFocusV2IsEnabled");this.Rb=r;this.qe=R;this.Zc=la;this.Lr=Ea;this.ia=Qa;this.Sb=wb;this.oE=Pb;this.Oc=xc;this.pz=ed;this.mc=jd;this.Ea=bd;this.la=Ce;this.Gv=Bf;this.YF=Nh.s8b;this.yck=ResourceStrings.L_Designer;this.zH=Df;this.rb=document.createElement("div");this.rb.className=ac.a.lLi;this.rb.id=Nh.s8b;this.rb.style.position=Jc.a.Xoa;this.rb.setAttribute(pa.a.ef,pa.a.bCa);this.rb.setAttribute(pa.a.P2,ac.a.j_d);this.Eb=!1;this.lWa=ic.a.Ie();this.lWa.className=
"DesignerPaneLayoutRoot";this.rb.appendChild(this.lWa);r=z.AFrameworkApplication.fa.Ga("PPTFabricIconDiamondCssUrl");R=document.createElement("link");R.setAttribute("rel","stylesheet");R.setAttribute("type","text/css");R.setAttribute("href",r);this.rb.appendChild(R);this.Rb.FPa(Object(m.a)(this,this.jY,"onSetOffline"))}dispose(){this.W2();this.rb.removeChild(this.lWa);this.Rb.oKb(Object(m.a)(this,this.jY,"onSetOffline"));N.a.J(22590850,829,50,"DesignerPane::Dispose")}initialize(){this.yo=Rh.KCa(this.qe);
Sys.UI.DomElement.addCssClass(this.yo,"DesignerPaneCloseButton");this.yo.setAttribute(pa.a.ef,pa.a.yu);this.lWa.appendChild(this.yo);this.Zc.pb(ha.a.click,this.yo,Object(m.a)(this,this.xCa,"closePaneButtonClickHandler"));this.Lr.addHandler(this.yo,ha.a.Yf,Object(m.a)(this,this.Xta,"inputKeyPressHandler"));this.RBb=ic.a.Ie();this.RBb.id=ac.a.j_d;this.RBb.className=ac.a.j_d;this.RBb.innerText=this.yck;this.lWa.appendChild(this.RBb);this.oE.X8(this.Q1f(),dd.a.gj,this.rb,r=>{this.wUh&&r===this.Ea.Fc(dd.a.LM)&&
this.yo?this.yA(!0):this.zU(!0)},()=>{this.zU(!1)});this.Oc.O7(Object(m.a)(this,this.Dw,"onUnifiedAppStateChanged"));this.Oc.fC(Object(m.a)(this,this.eaa,"onPodSessionRehydrated"));this.pz.frb(Object(m.a)(this,this.eaa,"onPodSessionRehydrated"));N.a.J(22590852,829,50,"DesignerPane::Initialize")}Q1f(){return dd.a.d_}W2(){this.Zc&&0<this.lWa.childNodes.length&&(this.Zc.yb(ha.a.click,this.yo,Object(m.a)(this,this.xCa,"closePaneButtonClickHandler")),this.Lr.removeHandler(this.yo,ha.a.Yf,Object(m.a)(this,
this.Xta,"inputKeyPressHandler")),this.lWa.removeChild(this.RBb),this.lWa.removeChild(this.yo));this.Oc.Hib(Object(m.a)(this,this.Dw,"onUnifiedAppStateChanged"));this.Oc.Sfa(Object(m.a)(this,this.eaa,"onPodSessionRehydrated"));this.pz.Fib(Object(m.a)(this,this.eaa,"onPodSessionRehydrated"));this.Ea.Ae&&this.Ea.Ae.name===dd.a.d_&&this.Ea.Cj(dd.a.d_,!1)}Dw(r,R){R.Bab&&!this.mc.Gn&&this.isVisible&&(N.a.J(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",
this.Sb.correlationId),this.xp(!1,mh.a.ANb))}jY(r){r&&this.isVisible&&this.xp(!1,mh.a.ANb)}eaa(){N.a.J(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.xp(!1,mh.a.W8k)}layout(r,R){const la=R?r.oD(this.width):r.pD(this.width);this.isVisible&&(R?(Sys.UI.DomElement.addCssClass(this.rb,ac.a.JNf),la.oD(ac.a.i_d)):(Sys.UI.DomElement.addCssClass(this.rb,ac.a.INf),la.pD(ac.a.i_d)));ic.a.t1(this.rb,la);return r}xp(r,R){if(this.Eb!==r){this.Eb=r;var la=this.la.FNf||this.id!==Nh.s8b?
K.a.qBk:Nh.IAj;r?(R={},R[la]=!0,this.Gv.Vrd(Le.c(R)),this.initialize(),this.rb.style.display=Jc.a.$ya,this.Sb.bkk(),N.a.J(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(r={},r[la]=!1,this.Gv.Vrd(Le.c(r)),this.W2(),this.rb.style.display=Jc.a.Gf,this.gnl(R)||(this.Sb.qtc=new Date,1===this.fDe&&(this.Sb.dzb=!0),this.ia.La(ab.a.noa,2,new Im.a(!0,R))),this.Sb.akk(),N.a.J(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.kF?(this.PFc(this.rb),la=ResourceStrings.L_Designer,
this.zH.FM(this,this.Eb,this.id===Nh.s8b?la:ResourceStrings.L_ShowHideDesignerPane,this.Q1f())):this.Rb.Oq()}}PFc(r){z.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(r,ac.a.JNf):Sys.UI.DomElement.addCssClass(r,ac.a.INf)}gnl(r){return r===mh.a.aGf||this.isVisible&&r===mh.a.ANb}zU(r){r?this.va.raiseEvent("OnDesignerPaneFocusOn"):this.va.raiseEvent("OnDesignerPaneFocusBlur")}ouf(r){this.va.addHandler("OnDesignerPaneFocusOn",r)}rih(r){this.va.removeHandler("OnDesignerPaneFocusOn",r)}puf(r){this.va.addHandler("OnDesignerPaneFocusBlur",
r)}sih(r){this.va.removeHandler("OnDesignerPaneFocusBlur",r)}Xta(r){!this.isVisible||r.keyCode!==Ba.a.tq&&r.keyCode!==Ba.a.pP||this.xp(!1,mh.a.typing)}xCa(){this.isVisible&&(N.a.J(22853525,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Sb.correlationId),this.xp(!1,mh.a.ANb));return!0}yA(r){(this.iec=r)&&this.yo.focus()}get fba(){return this.fDe}set fba(r){this.fDe=r}Ljb(r){this.setFocus("#"+this.id+" ."+Bd.hZg+":nth-child("+r+") > ."+
Bd.eGb)}I$k(){this.setFocus("#"+Bd.k8a)}H$k(){this.setFocus("#"+Bd.Wub)}zod(r){this.setFocus("."+Bd.GRa+"["+Nh.FRa+'="'+r+'"')}F$k(){this.setFocus("."+Bd.a3b)}G$k(){this.setFocus("."+Bd.e3b)}setFocus(r){(r=document.querySelector(r))&&ec.FocusManager.Wr(r)}get isVisible(){return this.Eb}get wUa(){return this.iec}get xa(){return this.rb}get order(){return 7}get id(){return this.YF}get width(){let r=0;this.isVisible&&(r=ac.a.mLi,r+=ac.a.i_d+rb.a.HKa);return r}static KCa(r){return Rh.JCa(r,"per","cui-img-16by16",
"cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static JCa(r,R,la,Ea,Qa,wb,Pb){const xc=ic.a.RA();xc.alt=wb;xc.className=Fa.getImageClassWithCluster(R,Qa);xc.src=r.qk(R+".png");xc.setAttribute("Unselectable","on");r=ic.a.Qn();r.className=la+" cui-img-cont-float";r.appendChild(xc);la=ic.a.Qn();la.className=Ea;la.setAttribute("Unselectable","on");la.appendChild(r);Ea=ic.a.Eca();Ea.className="cui-ctl DesignerPaneButton";Ea.title=wb;Ea.setAttribute(pa.a.ef,pa.a.yu);
Ea.tabIndex=0;Ea.appendChild(la);Pb&&(wb=ic.a.Qn(),wb.className="cui-ctl-mediumlabel",wb.setAttribute("Unselectable","on"),wb.innerText=Pb,Ea.appendChild(wb));return Ea}}Object(h.a)(Rh,"DesignerPane",null,[684,718,106]);class Gk{constructor(r,R,la,Ea,Qa,wb){this.ubd=this.ecc=this.PDb=this.xo=null;this.uwe=this.M9b=!1;this.QBe=null;this.la=R;this.ia=r;this.nck=wb;this.Zc=Ea;this.Lr=Qa;this.Rwg=fb.KeyInputManager.Oa(Ba.a.Zlb,0);this.ia.ya(ab.a.hIh,E.a.frame,Object(m.a)(this,this.rui,"closeCallout"));
this.PT=ic.a.Ie();this.PT.className="GoPremiumCalloutContainer";this.qcb=Rh.KCa(la);Sys.UI.DomElement.addCssClass(this.qcb,"GoPremiumCalloutClose");this.qcb.setAttribute(pa.a.ef,pa.a.yu);this.PT.appendChild(this.qcb);r=document.createElement("i");r.className=Ee.FIc;r.setAttribute(pa.a.ef,pa.a.nN);r.setAttribute("Unselectable","on");r.setAttribute(pa.a.QK,pa.a.gC);this.PT.appendChild(r);this.Kwa=ic.a.Ie();this.Kwa.className="GoPremiumTitle";this.PT.appendChild(this.Kwa);this.TT=ic.a.Ie();this.TT.className=
"GoPremiumSubtitle";this.PT.appendChild(this.TT);this.Yla=ic.a.Ie();this.Yla.className="GoPremiumButton";r=ic.a.Qn();r.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;r.setAttribute("Unselectable","on");r.setAttribute(pa.a.QK,pa.a.gC);this.Yla.appendChild(r);this.Yla.tabIndex=0;this.Yla.setAttribute(pa.a.ns,r.innerText);this.Yla.setAttribute(pa.a.ef,pa.a.yu);this.PT.appendChild(this.Yla);this.Vu()}show(r,R,la,Ea,Qa,wb){this.yL&&this.dismiss();this.PDb=Ea;this.ecc=R;this.ubd=Qa;this.QBe=wb;
this.PDb&&Sys.UI.DomElement.addCssClass(this.PDb,this.ubd);la?(this.Kwa.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.TT.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.Kwa.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.TT.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);R.setAttribute(pa.a.s6a,pa.a.gC);this.la.nRf?this.xo=new Sl.a(r,document.body,z.AFrameworkApplication.Aa.TR,null):(this.xo=cp.a.ZXd(r,document.body,document.body,2,Object(m.a)(this,
this.dismiss,"dismiss")),this.xo.R1e=120);this.xo.gba=310;this.PT.setAttribute(pa.a.ns,String.format("{0}. {1}",this.Kwa.innerText,this.TT.innerText));this.PT.setAttribute(pa.a.ef,pa.a.bCa);this.Lr&&this.Lr.addHandler(this.PT,ha.a.Yf,Object(m.a)(this,this.Xta,"inputKeyPressHandler"));this.xo.content=this.PT;this.mra();R=new Sys.UI.Bounds(0,0,ka.a.SUc(),ka.a.RUc());this.xo.RZ=this.N5d(R,r,240,la);this.xo.Ar=!1;this.xo.dgd=()=>{this.PT.parentNode&&Sys.UI.DomElement.addCssClass(this.PT.parentNode,"GoPremiumCalloutContentContainer");
this.xo.IJ&&(Sys.UI.DomElement.addCssClass(this.xo.IJ,"GoPremiumCalloutOuter"),this.xo.IJ.removeAttribute(pa.a.ef),this.la.nRf||(this.xo.IJ.style.zIndex=String(z.AFrameworkApplication.Aa.Qqb)));this.xo.kWe();this.HR(this.Yla);this.M9b=!0};this.xo.show()}mra(){if(ec.FocusManager.SM()){var r=ec.FocusManager.instance(),R=r.Fc("callout/modal");R.parent=dd.a.gj;r.vOd("callout/modal",dd.a.gj,this.PT);r.HU("callout/modal",!1);R.bindAction(this.Rwg,ab.a.hIh);R=new Uf.DOMFocusListing(()=>this.PT);R.wib=!0;
R.Go(2);r=r.Tia(()=>this.PT,r.Fc("callout/modal"),R);r.xib();r.nX=!0;r.KQa=!0}}Bib(){if(ec.FocusManager.SM()&&!z.AFrameworkApplication.Ug){const R=ec.FocusManager.instance();var r=R.Fc("callout/modal");r&&r.zp(this.Rwg);R.X0("callout/modal");(r=R.uQ("callout/modal"))&&r.vj.YE(null);R.iKb("callout/modal")}}HR(r){ec.FocusManager.SM()?ec.FocusManager.instance().uQ("callout/modal").vj.b9a(r):r.focus()}get yL(){return!!this.xo&&this.xo.yL}Bwj(){this.yL&&(this.M9b?this.qcb.focus():this.Yla.focus(),this.M9b=
!this.M9b)}ZOf(){this.dismiss();return!0}rui(){this.dismiss();return 32}dismiss(){if(!this.uwe){this.uwe=!0;try{this.Bib(),this.ecc&&(this.ecc.setAttribute(pa.a.s6a,pa.a.Iia),ec.FocusManager.Wr(this.ecc),this.ecc=null),this.PDb&&(Sys.UI.DomElement.removeCssClass(this.PDb,this.ubd),this.PDb=null),this.QBe=this.ubd=null,this.M9b=!1,this.xo&&(this.xo.dismiss(),this.xo.dispose(),this.xo=null),this.Lr&&this.Lr.removeHandler(this.PT,ha.a.Yf,Object(m.a)(this,this.Xta,"inputKeyPressHandler"))}finally{this.uwe=
!1}}}dispose(){this.dismiss();this.kpa();this.PT=this.qcb=this.Yla=null}Xta(r){if(r.keyCode===Ba.a.tq||r.keyCode===Ba.a.pP){r.preventDefault();r=document.activeElement;try{r?r.click():N.a.J(590967751,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(R){N.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",R)}}}E3g(){this.nck(this.QBe);return!0}Vu(){this.Zc?(this.Zc.pb(ha.a.click,this.qcb,Object(m.a)(this,this.ZOf,"dismissAndReturn")),
this.Zc.pb(ha.a.click,this.Yla,Object(m.a)(this,this.E3g,"onGoPremiumClicked"))):N.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}kpa(){this.Zc&&(this.Zc.yb(ha.a.click,this.qcb,Object(m.a)(this,this.ZOf,"dismissAndReturn")),this.Zc.yb(ha.a.click,this.Yla,Object(m.a)(this,this.E3g,"onGoPremiumClicked")))}N5d(r,R,la,Ea){if(Ea)return 0;Ea=6;R.y-r.y<la&&(Ea=3);return Ea}}Object(h.a)(Gk,"PremiumContentCallout",
null,[]);class Lj{constructor(r,R,la,Ea,Qa,wb,Pb,xc){this.Bub=r;this.dUi=R;this.ePc=la;this.Jh=Ea;this.qga=Qa;this.R8a=wb;this.gZe=Pb;this.dvd=xc}}Object(h.a)(Lj,"RenderSuggestionsArgs",null,[982]);class mo extends Sys.EventArgs{constructor(r){super();this.card=r}}Object(h.a)(mo,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class Jm extends Sys.EventArgs{constructor(r){super();this.l1c=r}}Object(h.a)(Jm,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class om extends Sys.EventArgs{constructor(r,
R){super();this.j7k=r;this.Krl=R}}Object(h.a)(om,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class Km extends hd.a{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df){super(new Kj.a,r,wb);this.Gcb=this.Hcb=this.OL=this.c0=this.Lcc=this.yX=null;this.ezg=this.jzg=0;this.cma=!1;this.hVg=this.vHa=this.pEb=null;this.Qo=la;this.ir=Ea;this.Sb=Qa;this.Ea=Pb;this.Zc=xc;this.qe=R;this.qp=ed;this.Lr=jd;this.ia=bd;this.he=Ce;this.la=Bf;this.yIh=this.la.useWideSuggestionThumbs;this.jR=new Od.a(()=>new Gk(this.ia,
this.la,R,xc,jd,Object(m.a)(this,this.e9f,"goPremiumExperience")));this.yvg=new jg(Df,Object(m.a)(this,this.bqk,"onAccountUpgrade"),Bf.rRa);this.E4=new de;this.Z9j=Object.assign(new cf(bd,this.E4,this.la),{Zy:ab.a.kab})}dispose(){this.cma&&this.WEf();this.pEb&&(this.pEb.dispose(),this.pEb=null);this.jR.P$a&&this.jR.value.dispose();super.dispose();N.a.J(512496477,829,50,"DesignerView::Dispose")}F8b(){this.yX=ic.a.Ie();this.yX.className="DesignerViewContainer";this.container.appendChild(this.yX);this.cma=
!0;N.a.J(512496476,829,50,"DesignerView::InitializeView")}WEf(){this.la.nOc&&this.ir.Hsi();if(this.yX.children&&0<this.yX.children.length)for(const r=0;r<this.yX.children.length;)this.yX.removeChild(this.yX.children[r]);this.Qo.fba=0;this.Qo.rih(Object(m.a)(this,this.onFocus,"onFocus"));this.Qo.sih(Object(m.a)(this,this.v3g,"onFocusBlur"));this.jR.P$a&&this.jR.value.dismiss();N.a.J(512496475,829,50,"DesignerView::CleanUpView")}q0a(r){N.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",
this.Sb.correlationId,te[r]);this.sN();4!==r&&7!==r&&8!==r&&(this.WEf(),this.yX.id=this.Sb.correlationId);this.Qo.fba=r;switch(this.Qo.fba){case 1:this.aDj();this.pel();break;case 7:this.oel();break;case 2:this.hDj();break;case 9:this.gDj();break;case 5:this.sDj();break;case 3:this.xDj();break;case 6:this.bDj();break;case 4:if(r=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let R=0;R<r.length;R++)r[R].style.visibility=qb.a.visible,r[R].setAttribute(Ee.zTd,Ee.OBf)}this.Qo.ouf(Object(m.a)(this,
this.onFocus,"onFocus"));this.Qo.puf(Object(m.a)(this,this.v3g,"onFocusBlur"))}Osa(){return this.la.MNf&&this.yvg.Osa()}e9f(r){this.la.MNf&&(N.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",r?r.toString():""),this.jR.P$a&&this.jR.value.dismiss(),this.yvg.launchUpsellExperience(this.la.rRa?"designertrial":"designer"))}startFreeTrial(){this.jR.P$a&&this.jR.value.dismiss();this.ir.nxl();this.Sb.n_e=!0;this.Iw(0,!0);N.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}bqk(){N.a.J(512496471,
829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.jR.P$a&&this.jR.value.dismiss();this.ir.PBl()}aDj(){this.Lcc=ic.a.Ie();this.Lcc.className="DesignerLoadingView";const r=ic.a.RA();r.className=z.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";r.src=Ue.a.XK(ac.a.Rna);const R=ic.a.Ie();R.className=z.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";R.innerText=ResourceStrings.L_DesignerLoading;this.Lcc.appendChild(r);
N.a.J(512496470,829,50,"DesignerView::spinner shows up");this.Lcc.appendChild(R);this.yX.appendChild(this.Lcc);N.a.J(512496469,829,50,"DesignerView::InitLoadingState")}iDj(){const r=ic.a.Ie();r.className="DesignerNoSuggestionNewButton";r.tabIndex=0;r.innerText=ResourceStrings.L_DesignerLearnMoreShort;r.setAttribute("Unselectable","on");r.setAttribute(pa.a.ns,r.innerText);r.setAttribute(pa.a.ef,pa.a.yu);r.setAttribute("href",ac.a.HNf);this.Zc.pb(ha.a.click,r,Object(m.a)(this,this.KFf,"clickSuggestionLinkHandler"));
this.c0.appendChild(r)}fDj(){const r=ic.a.Eca();r.className="DesignerNoSuggestionView-Link";r.setAttribute("href",ac.a.HNf);r.setAttribute("target","_blank");r.innerText=ResourceStrings.L_DesignerLearnMore;r.tabIndex=0;r.setAttribute(pa.a.ef,pa.a.zRd);this.c0.appendChild(r);this.Zc.pb(ha.a.click,r,Object(m.a)(this,this.KFf,"clickSuggestionLinkHandler"))}hDj(){this.Qo.isVisible&&(this.Sde(!1),this.Hcb.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.Gcb.innerText=ResourceStrings.L_DesignerNoSuggestionContent,
N.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}gDj(){this.Qo.isVisible&&(this.Sde(!0),this.Hcb.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.Gcb.innerText=ResourceStrings.L_DesignerNoIdeas,N.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}sDj(){this.Qo.isVisible&&(this.Sde(!1),this.Hcb.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.Gcb.innerText=ResourceStrings.L_DesignerCoauthorContent,N.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}Sde(r){this.c0=
ic.a.Ie();this.c0.className=z.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.Hcb=ic.a.Ie();this.Gcb=ic.a.Ie();this.ir.cjh(this.yX);if(r){this.Hcb.className="DesignerNoSuggestionNew-Header";this.Gcb.className="DesignerNoSuggestionNew-Content";const R=ic.a.RA();R.src=this.qe.qk("DesignerNoIdeas.svg");R.className="DesignerNoIdeasIllustration";this.c0.appendChild(R)}else this.Hcb.className="DesignerNoSuggestionView-Header",this.Gcb.className="DesignerNoSuggestionView-Content";
this.c0.appendChild(this.Hcb);this.c0.appendChild(this.Gcb);r?this.iDj():this.fDj();this.yX.appendChild(this.c0);this.Lr.addHandler(this.c0,ha.a.Yf,Object(m.a)(this,this.Xta,"inputKeyPressHandler"))}xDj(){this.Qo.isVisible||this.Qo.xp(!0,mh.a.none);this.OL=ic.a.Ie();const r=this.yIh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",R=this.yIh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.OL.className=z.AFrameworkApplication.isRtl?R:r;this.yX.appendChild(this.OL);
this.la.KNf||(this.Ea.Cj(dd.a.d_,!0),this.Ea.Ed());this.Zc.pb(ha.a.click,this.OL,Object(m.a)(this,this.Sti,"clickSuggestionHandler"));this.Lr.addHandler(this.OL,ha.a.Yf,Object(m.a)(this,this.fXc,"inputKeyApplyHandler"));this.qp.pb(ha.a.pointerOver,this.OL,Object(m.a)(this,this.cD,"onPointerOver"));this.qp.pb(ha.a.pointerOut,this.OL,Object(m.a)(this,this.yz,"onPointerOut"));N.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}nij(){return this.C6b(this.OL.querySelector("#"+this.Wo.id+" .DesignerSuggestionResultSelected"))}Q$i(){return this.C6b(this.OL.querySelector("#"+
this.Wo.id+" ["+Ee.Esb+"]:hover"))}C6b(r){let R;return({suggestionIndex:R}=this.r7f(r)).returnValue?parseInt(R):-1}r7f(r){let R,la,Ea;Ea=la=R="";if(r){const Qa=r.getAttribute(Ee.kCa),wb=r.getAttribute(Ee.Esb);if(!Qa||!wb)return N.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Sb.correlationId),{returnValue:!1,suggestionIndex:R,slideId:la,xZe:Ea};R=Qa.toString();la=wb.toString();(r=r.getAttribute(Ee.yTd))?Ea=
r.toString():N.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Sb.correlationId);return{returnValue:!0,suggestionIndex:R,slideId:la,xZe:Ea}}return{returnValue:!1,suggestionIndex:R,slideId:la,xZe:Ea}}D6b(){return this.OL.querySelectorAll("#"+this.Wo.id+" ["+Ee.kCa+"]").length}KFf(r){return this.Qo.isVisible&&r&&r.hC?this.q9f(r.hC.className):!1}mka(){const r=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":
"DesignerShowSuggestionView",R=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(z.AFrameworkApplication.isRtl?R:r))}Rti(r){r=r.getAttribute(Ee.kCa).toString();r=this.Sb.sQa[parseInt(r)];if(!r||3!==r.Type&&4!==r.Type)return!1;this.he.rNk(new mo(r));return!0}QPc(r,R){for(;r&&r.className!==R;)r=r.parentNode;return r}Sti(r){if(!this.Qo.isVisible||r.sA!==Sys.UI.MouseButton.leftButton||!this.ir.Ba||!r.Ec)return!1;var R=
r.Ec;try{if(R.className){if(R.className===Bd.eGb||R.className===Bd.fGb||R.className===Bd.jEe||R.className===Bd.Wcd)return this.Qti(R);if(R.className.startsWith(Bd.OQf))return this.Pti(R)}else N.a.J(512496462,829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(bd){return N.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",R.className,bd.message),!1}if(r=this.QPc(R,Ee.YBf))return this.Rti(r);if(this.Osa()){if(R.className===Ee.Csb)return this.startFreeTrial(),
!0;if(R.className===Ee.j_b)return r=Oc.a.$h(R),this.jR.value.show(r,R,!0,R,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(r=this.QPc(R,Ee.i_b))||(r=this.QPc(R,Ee.zIc));if(r)return this.e9f(null),!0}if(this.la.zja&&(r=this.QPc(R,Ee.tTd))){this.ir.gWc(this.mka());if(!r.getAttribute(Ee.Bsb))return!1;this.ir.Cll(this.mka());r=new Jm(r.getAttribute(Ee.Bsb).toString());this.he.DNk(r);return!0}if(Sys.UI.DomElement.containsCssClass(R,"ms-Icon--Diamond")){if(R=R.parentNode,!R)return!1}else if(!(Sys.UI.DomElement.containsCssClass(R,
Ee.IIc)||Sys.UI.DomElement.containsCssClass(R,Ee.m_b)||Sys.UI.DomElement.containsCssClass(R,Ee.JIc)||(R=R.firstChild,R)))return!1;r=R.parentNode;var la=document.querySelector("#"+this.Wo.id+" ."+Ee.mQa);if(!({suggestionIndex:xc,slideId:ed,xZe:jd}=this.r7f(r)).returnValue)return!1;var Ea=parseInt(xc),Qa=parseInt(ed);const wb=parseInt(jd)||0;let Pb=this.Sb.MZ.sid===Qa;this.la.zja&&(Pb=this.ir.jwb(la,!1)===r||this.ir.jwb(la,!0)===r);if(Pb)return N.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),
this.he.Rdh(new om(Ea,this.D6b())),!1;if(r&&r.getAttribute(Ee.CIc)){R=null;la=r.childNodes;for(Ea=0;Ea<la.length;Ea++)if(Qa=la[Ea],Sys.UI.DomElement.containsCssClass(Qa,Ee.IIc)){R=Qa;break}la=new bp(xc,ed,jd);R=Oc.a.$h(R||r);this.jR.value.show(R,r,!1,null,null,la);return!1}if(Sys.UI.DomElement.containsCssClass(R,Ee.JIc))return!1;var xc=this.Phj(R,Qa,wb);var ed=Object.assign(new fk,{SuggestionCid:wb,SuggestionSid:Qa,CorrelationId:la.getAttribute("correlationId").toString(),ActiveSlideCid:this.ir.Ba.cid,
ActiveSlideSid:this.ir.Ba.sid});var jd=R;jd=.01>=Math.abs(jd.width/jd.height-1.33);this.ir.jwb(la,jd)?(this.ir.VEf(la,jd),xc&&xc.parentNode&&xc.parentNode.parentNode&&this.ir.VEf(xc.parentNode.parentNode,jd),this.ia.La(ab.a.Irb,2,ed),N.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.La(ab.a.ZBa,2,ed),N.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.iLi&&r&&r.getAttribute(Ee.kTd)&&
A.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(bd=>{try{bd.logActivity("DesignerAnimationSuggestion",null)}catch(Ce){N.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",Ce)}});this.ir.pph(R.parentNode,jd);xc&&this.ir.pph(xc.parentNode,jd);this.ir.Snh(this.yX,Ea);this.he.Rdh(new om(Ea,this.D6b()));return!0}Phj(r,R,la){var Ea="["+Ee.Esb+'="'+R+'"] > .'+Ee.m_b;la&&(Ea=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',Ee.Esb,R,Ee.yTd,la,Ee.m_b));R=document.querySelectorAll(Ea);
if(!R)return null;for(la=0;la<R.length;la++)if(Ea=R[la],Ea!==r)return Ea;return null}Xta(r){this.Qo.isVisible&&(r.keyCode!==Ba.a.tq&&r.keyCode!==Ba.a.pP||this.q9f(r.target.className))}fXc(r){!this.Qo.isVisible||r.keyCode!==Ba.a.tq&&r.keyCode!==Ba.a.pP||(r.preventDefault(),(r=document.activeElement)&&r.click())}Iw(r,R){if(!(0>r)){var la=this.OL.querySelector("["+Ee.kCa+'="'+r+'"]');la?R&&(ec.FocusManager.Wr(la),this.ir.Snh(this.yX,r)):N.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",
r)}}w8f(){return this.Osa()?this.OL.querySelector("."+Ee.j_b)?2:this.OL.querySelector("."+Ee.Csb)?1:this.OL.querySelector("."+Ee.i_b)?3:0:0}xmg(){return!!this.OL.querySelector("."+Ee.Csb+":focus")}pqc(r){const R=this.OL.querySelector("."+Ee.Csb);R?r?ec.FocusManager.Wr(R):R.blur():N.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}Bag(){this.Bng()&&this.jR.value.Bwj()}Bng(){return this.jR.P$a&&this.jR.value.yL}DWj(r){return r?!!r&&(r.className===Ee.Csb||
r.className===Ee.zIc||r.className===Ee.j_b||r.className===Ee.i_b):!1}Doa(r,R){let la=null;1===R?la=this.OL.querySelector("."+Ee.zIc):2===R?la=this.OL.querySelector("."+Ee.j_b):3===R&&(la=this.OL.querySelector("."+Ee.i_b));la?r?ec.FocusManager.Wr(la):la.blur():N.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",R)}Rdl(r,R){(R=9===R?this.c0.querySelector(".DesignerNoSuggestionNewButton"):this.c0.querySelector(".DesignerNoSuggestionView-Link"))?
r?R.focus():R.blur():N.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}bVj(r){return!(9===r?!this.c0.querySelector(".DesignerNoSuggestionNewButton:focus"):!this.c0.querySelector(".DesignerNoSuggestionView-Link:focus"))}q9f(r){try{const R=this.c0.querySelector("."+r);if(!R)return!1;const la=R.getAttribute("href").toString();if(!la)return!1;Oc.a.openWindow(4,la);return!0}catch(R){return N.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",R),!1}}v3g(){this.Qo.isVisible&&
this.jR.P$a&&this.jR.value.yL&&this.jR.value.dismiss()}onFocus(){if(this.Qo.isVisible)if(2===this.Qo.fba)ec.FocusManager.Wr(this.c0.lastChild);else if(3===this.Qo.fba){var r=this.w8f();if(1===r)this.pqc(!0);else if(3===r)this.Doa(!0,r);else{r=this.nij();var R=this.Q$i();-1===r?this.Iw(-1===R?0:R,!0):this.Iw(r,!0)}}}cD(r){return this.Qo.isVisible&&r.Ec?this.NQf(r.clientPoint):!1}yz(r){return this.Qo.isVisible&&r.Ec?this.NQf(r.clientPoint):!1}tsj(r){this.sN();this.q0a(2);N.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",
r);this.Qo.isVisible&&(this.Sb.eVa=!0,this.ia.La(ab.a.noa,2,new Im.a(!1,mh.a.Jrd)))}pel(){const r=this.Sb.correlationId;this.jzg=window.setTimeout(()=>{this.tsj(r)},this.la.k_d)}ssj(r){this.sN();this.ir.gWc(this.mka());N.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",r)}oel(){const r=this.Sb.correlationId;this.ezg=window.setTimeout(()=>{this.ssj(r)},this.la.k_d)}sN(){window.clearTimeout(this.jzg);window.clearTimeout(this.ezg)}get Wo(){return this.Qo}bDj(){this.OL.style.display=
qb.a.none;this.Sb.yDe=!0;this.vHa=ic.a.Ie();this.vHa.className=Bd.pmk;const r=this.hKf(Bd.lEe),R=document.createElement("iframe");R.className=R.id=Bd.jZg;const la=this.hKf(Bd.kEe);this.vHa.appendChild(r);this.vHa.appendChild(R);this.vHa.appendChild(la);this.yX.appendChild(this.vHa);const Ea=this.Ea.Fc(dd.a.AWc);Ea.parent=Pa.AFrame.ND;this.Zc.SFc(dd.a.AWc,R);Ea.M7(()=>{R.focus();const Qa=Object.assign(new Uf.DOMFocusListing(()=>this.vHa),{wib:!0});Qa.Go(3);Qa.Go(2);Qa.Go(4);Qa.Go(1);Qa.Go(6);Qa.Go(5);
ec.FocusManager.instance().USd(this.vHa,Ea,Qa);const wb=ec.FocusManager.instance().uQ(dd.a.AWc);wb.xib();wb.nX=!0;wb.KQa=!0;Ea.zp(ec.FocusManager.instance().Rqa);Ea.zp(ec.FocusManager.instance().Sqa);Qa.YE(R)});this.Ea.tf(dd.a.AWc);this.Lr.addHandler(this.vHa,ha.a.Yf,Object(m.a)(this,this.Zz,"keyDownHandler"))}hKf(r){const R=document.createElement("div");R.setAttribute("Id",r);R.setAttribute("tabindex",0);R.setAttribute("position","absolute");R.setAttribute("width","-1000px");R.setAttribute("top",
"-1000px");return R}Zz(r){r.keyCode===Sys.UI.Key.tab&&(r.target.id!==Bd.kEe||r.shiftKey?r.target.id===Bd.lEe&&r.shiftKey&&this.Bqh(r,Bd.kEe):this.Bqh(r,Bd.lEe))}Bqh(r,R){r.preventDefault();r.stopPropagation();(r=document.getElementById(R))&&r.focus()}Qti(r){switch(r.className){case Bd.Wcd:return this.Wo.Ljb(1),!0;case Bd.eGb:r=r.querySelector("."+Bd.fGb).innerText;break;case Bd.fGb:r=r.innerText;break;case Bd.jEe:r=r.parentNode.querySelector("."+Bd.fGb).innerText;break;default:return!1}return this.z_k(r)}z_k(r){this.la.zja&&
(this.hVg=this.mka().querySelector("."+Ee.mQa).getAttribute("correlationId").toString());this.q0a(6);var R=db.a.qN(this.la.pptEditingUserId).toString();R=String.format(this.la.insertPictureServiceEndpoint,z.AFrameworkApplication.lcid,hh.a.xe(z.AFrameworkApplication.lcid).name,z.AFrameworkApplication.buildVersion,Xd.a.create().toString(),3,R,0);R=R.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+r;r=document.getElementById(Bd.jZg);r.setAttribute("src",R);r.style.visibility=qb.a.visible;
this.pEb=(new ge).getInstance(r.contentWindow,R);this.pEb.Vxa(id.a.Osf,la=>{if(la=this.E4.j9g(la)){const Ea=[];Array.add(Ea,la);this.ia.processAction(ab.a.prc,2);this.Wo.xp(!1,mh.a.aGf);this.Z9j.Yta(Ea)}});this.pEb.Vxa(Nh.WK,()=>{this.q0a(3);const la=new Lj(this.Sb.suggestions,this.Sb.suggestions?this.Sb.suggestions.SlideSuggestions.length:0,this.Sb.sQa.length,this.la.zja?this.hVg:this.Sb.correlationId,this.mka(),!0,this.Osa(),this.ir.PWc(Je.a.makeItVisual));this.ir.zRe(la)});return!0}Pti(r){return Sys.UI.DomElement.containsCssClass(r,
Bd.Yub)||Sys.UI.DomElement.containsCssClass(r,Bd.Xub)?this.Yrj(r):Sys.UI.DomElement.containsCssClass(r,Bd.GRa)||Sys.UI.DomElement.containsCssClass(r,Bd.dOc)||Sys.UI.DomElement.containsCssClass(r,Bd.SQf)||Sys.UI.DomElement.containsCssClass(r,Bd.RQf)?this.Zrj(r):Sys.UI.DomElement.containsCssClass(r,Bd.a3b)?this.Dsj():Sys.UI.DomElement.containsCssClass(r,Bd.e3b)?this.Mtj():!1}Mtj(){this.ia.processAction(ab.a.lLe,2);this.Wo.xp(!1,mh.a.Ezk);return this.Sb.HQf=!0}NQf(r){const R=this.Sb.tWd;if(!R||nf.a.Wa(this.Sb.AW))return!1;
r=Oc.a.KSa(r);this.iMj(r)?R.nWc(this.w0f()):R.nWc([]);return!0}iMj(r){for(;r&&r.className!==Bd.O0d;)r=r.parentNode;return!!r&&r.className===Bd.O0d}Dsj(){const r=this.Sb.tWd;if(!r)return!1;r.ignoreCritiques(this.w0f(),4);this.Sb.AW.splice(this.Sb.yN,1);if(this.Sb.yN===this.Sb.AW.length){let R;(R=this.Sb).yN=R.yN-1}this.TSk();return!0}w0f(){const r=[];for(const R of this.Sb.AW[this.Sb.yN].critiques)r.push(R.critiqueId);return r}Yrj(r){if(Sys.UI.DomElement.containsCssClass(r,Bd.Yub)){let R;(R=this.Sb).yN=
R.yN-1;this.Sb.yN||(Sys.UI.DomElement.removeCssClass(r,Bd.Yub),Sys.UI.DomElement.addCssClass(r,Bd.c3b));r=document.getElementById(Bd.Wub);Sys.UI.DomElement.removeCssClass(r,Bd.b3b);Sys.UI.DomElement.addCssClass(r,Bd.Xub)}else{let R;(R=this.Sb).yN=R.yN+1;this.Sb.yN===this.Sb.AW.length-1&&(Sys.UI.DomElement.removeCssClass(r,Bd.Xub),Sys.UI.DomElement.addCssClass(r,Bd.b3b));r=document.getElementById(Bd.k8a);Sys.UI.DomElement.removeCssClass(r,Bd.c3b);Sys.UI.DomElement.addCssClass(r,Bd.Yub)}document.getElementById(Bd.N0d).innerText=
(this.Sb.yN+1).toString();this.tGh(this.Sb.yN);return!0}tGh(r){var R=this.Sb.AW[r].critiques[0].explanationLabel;document.getElementById(Bd.QQf).innerText=R;R=document.getElementById(Bd.TQf);const la=Ee.LJf();R.parentNode.replaceChild(la,R);this.ir.bag(la,r)}Zrj(r){const R=this.Sb.tWd;if(nf.a.Wa(this.Sb.AW)||!R)return!1;r=r.getAttribute(Nh.FRa);var la=document.querySelector("."+Bd.dOc+"["+Nh.FRa+'="'+r+'"]');la&&(la.innerText="\u2713",Sys.UI.DomElement.removeCssClass(la,Bd.dOc),Sys.UI.DomElement.addCssClass(la,
Bd.bQi));la=new uc.a(0);for(const Ea of this.Sb.AW[this.Sb.yN].critiques)la.add(Ea.critiqueId,r);R.JAh(la);return this.Sb.bOc=!0}TSk(){var r=document.getElementById(Bd.FQf);let R=parseInt(r.innerText);R--;if(0>=R)this.Jll(document.getElementById(Bd.GQf));else{r.innerText=R.toString();this.tGh(this.Sb.yN);r=this.Sb.yN===this.Sb.AW.length-1;const la=document.getElementById(Bd.Wub);1<R&&!r?(Sys.UI.DomElement.addCssClass(la,Bd.Xub),Sys.UI.DomElement.removeCssClass(la,Bd.b3b)):(Sys.UI.DomElement.addCssClass(la,
Bd.b3b),Sys.UI.DomElement.removeCssClass(la,Bd.Xub));r&&(document.getElementById(Bd.N0d).innerText=R.toString());r=document.getElementById(Bd.k8a);1<R&&this.Sb.yN?(Sys.UI.DomElement.addCssClass(r,Bd.Yub),Sys.UI.DomElement.removeCssClass(r,Bd.c3b)):(Sys.UI.DomElement.addCssClass(r,Bd.c3b),Sys.UI.DomElement.removeCssClass(r,Bd.Yub))}}Jll(r){const R=ic.a.Ie();R.className=Bd.WPi;const la=new wc.a;la.lh(40,40);la.Eya("0,0,2048,2048");la.ur(Bd.cQi);var Ea=new sj.a;Ea.r1("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Qa=new sj.a;Qa.r1("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Qa.xa.setAttribute("class",Bd.fQi);const wb=
new sj.a;wb.r1("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
wb.xa.setAttribute("class",Bd.UPi);const Pb=new sj.a;Pb.r1("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Pb.xa.setAttribute("class",Bd.TPi);la.appendChild(Ea);la.appendChild(Qa);la.appendChild(wb);la.appendChild(Pb);Ea=ic.a.Qn();Ea.innerText=ResourceStrings.l_ConsistencyCardNoMore;Ea.className=Bd.XPi;R.appendChild(la.xa);R.appendChild(Ea);r.parentNode.replaceChild(R,r)}}Km.RPi=[Bd.k8a,Bd.Wub,Bd.GRa,Bd.a3b,Bd.e3b];Object(h.a)(Km,"DesignerView",hd.a,[683,408,162,106]);var lj=d(189);class Cn extends Sys.EventArgs{constructor(r,R){super();this.slideId=r.slideId;this.gzh=r.hsc;this.MTf=r.Taa;this.R8a=R;this.trigger=
r.trigger;this.correlationId=r.correlationId}}Object(h.a)(Cn,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class Qn{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce){this.nAg=new Tf.a;this.Op=r;this.ir=R;this.Sb=la;this.la=Ea;this.ia=Qa;this.ua=wb;this.Jb=Pb;this.Lc=xc;this.Ea=ed;this.lcc=this.Fqe=0;this.HWa=jd;this.L5j=bd;this.Hwa=Ce;this.Vu()}Vu(){this.Lc.U9h(Object(m.a)(this,this.F6g,"onSuggestionsUpdated"));this.Lc.T9h(Object(m.a)(this,this.m2g,"onCoauthModifiedSameSlide"));this.L5j.execute(r=>
{r.n7h(Object(m.a)(this,this.Uxk,"onShowMoreSuggestions"),()=>{this.ILb(this.Op,3)})});this.la.designerIncrementalRenderEnabled&&this.Lc.U$h(Object(m.a)(this,this.g7g,"onUserBeginUploadPicture"));this.Lc.EGc(Object(m.a)(this,this.Ina,"onUndoRedo"))}dispose(){this.Lc.CYk(Object(m.a)(this,this.F6g,"onSuggestionsUpdated"));this.Lc.BYk(Object(m.a)(this,this.m2g,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Lc.kZk(Object(m.a)(this,this.g7g,"onUserBeginUploadPicture"));this.Lc.uld(Object(m.a)(this,
this.Ina,"onUndoRedo"))}h8k(r){this.ia.La(ab.a.noa,2,new Im.a(!1,r))}ILb(r,R){r?r.q0a(R):N.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Sb.correlationId,R)}ywj(r){const R=this.TLi(r);if(R){var la=R.Wo;N.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",r,te[la.fba]);switch(la.fba){case 3:this.rnk(r,R);break;case 2:case 9:this.qnk(r,R,la.fba)}}}TLi(r){switch(r){case ab.a.OYa:case ab.a.sGb:case ab.a.tGb:case ab.a.PYa:case ab.a.vGb:case ab.a.wGb:case ab.a.uGb:case ab.a.tgb:r=
this.Op;break;default:return null}return r}rnk(r,R){if(R&&R.Wo){var la=document.activeElement;if(la){var Ea=la.getAttribute(Ee.kCa),Qa=R.DWj(la),wb=Sys.UI.DomElement.containsCssClass(la,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(la,"IdeasText"),Pb=this.iZg(la)||this.IQf(la),xc=R.Bng();if(Ea||wb||Pb||Qa||xc)if(Ea=Ea?parseInt(Ea.toString()):-1,Qa=R.D6b()-1,!(1>Qa))switch(wb=R.Wo,Pb=R.w8f(),r){case ab.a.OYa:if(xc||1===Pb||3===Pb)break;wb.yA(!1);Ea<Qa&&(R.Iw(Ea,!1),R.Iw(Ea+1,!0));
break;case ab.a.sGb:if(xc||1===Pb||3===Pb)break;wb.yA(!1);Ea!==Qa&&(R.Iw(Ea,!1),R.Iw(Qa,!0));break;case ab.a.tGb:if(xc){R.Bag();break}this.Etj(R,Ea,Qa,Pb);break;case ab.a.PYa:if(xc||1===Pb||3===Pb)break;wb.yA(!1);0<Ea&&(R.Iw(Ea,!1),R.Iw(Ea-1,!0));break;case ab.a.vGb:if(xc||1===Pb||3===Pb)break;wb.yA(!1);Ea&&(R.Iw(Ea,!1),R.Iw(0,!0));break;case ab.a.wGb:if(xc){R.Bag();break}this.Ftj(R,Ea,Qa,Pb);break;case ab.a.uGb:case ab.a.tgb:xc||1===Pb||3===Pb||(r=r===ab.a.tgb,R=R.Wo,this.iZg(la)?this.Htj(r,R):this.IQf(la)&&
this.Gtj(r,R))}}}}Etj(r,R,la,Ea){const Qa=r.Wo;if(-1===R){switch(Ea){case 1:Qa.wUa?(Qa.yA(!1),r.pqc(!0)):r.xmg()?(r.pqc(!1),r.Doa(!0,Ea)):(r.Doa(!1,Ea),Qa.yA(!0));return;case 2:Qa.wUa?(Qa.yA(!1),r.Iw(0,!0)):(r.Doa(!1,Ea),Qa.yA(!0));return;case 3:R=Qa.wUa;Qa.yA(!R);r.Doa(R,Ea);return}Qa.yA(!1);r.Iw(0,!0)}else R===la?(r.Iw(R,!1),2===Ea?r.Doa(!0,Ea):Qa.yA(!0)):(r.Iw(R,!1),r.Iw(R+1,!0))}Ftj(r,R,la,Ea){const Qa=r.Wo;if(0<R)r.Iw(R,!1),r.Iw(R-1,!0);else if(-1===R){switch(Ea){case 1:Qa.wUa?(Qa.yA(!1),r.Doa(!0,
Ea)):r.xmg()?(r.pqc(!1),Qa.yA(!0)):(r.Doa(!1,Ea),r.pqc(!0));return;case 2:Qa.wUa?(Qa.yA(!1),r.Doa(!0,Ea)):(r.Doa(!1,Ea),r.Iw(la,!0));return;case 3:R=Qa.wUa;Qa.yA(!R);r.Doa(R,Ea);return}Qa.wUa&&(Qa.yA(!1),r.Iw(la,!0))}else r.Iw(0,!1),Qa.yA(!0)}qnk(r,R,la){if(R){var Ea=R.Wo;if(r===ab.a.tGb||r===ab.a.wGb||r===ab.a.PYa||r===ab.a.OYa)r=R.bVj(la),Ea.yA(r),R.Rdl(!r,la)}}iZg(r){return Sys.UI.DomElement.containsCssClass(r,Bd.Wcd)||Sys.UI.DomElement.containsCssClass(r,Bd.eGb)}IQf(r){return r.className.startsWith(Bd.OQf)}Htj(r,
R){var la=document.activeElement;la&&(Sys.UI.DomElement.containsCssClass(la,Bd.eGb)?(la=parseInt(la.getAttribute(Bd.kZg).toString())+1,r?la!==Nh.Gic?R.Ljb(la+1):R.Ljb(1):1!==la?R.Ljb(la-1):R.Ljb(Nh.Gic)):r?R.Ljb(1):R.Ljb(Nh.Gic))}Gtj(r,R){var la=document.activeElement;if(la){for(var Ea=Km.RPi,Qa=0;!Sys.UI.DomElement.containsCssClass(la,Ea[Qa]);)if(Qa++,Qa===Ea.length){Qa=-1;break}var wb=document.querySelectorAll("."+Bd.GRa).length;Ea[Qa]!==Bd.GRa?r?Qa!==Ea.length-1&&-1!==Qa?Ea[Qa+1]!==Bd.GRa?this.Mxb(Ea[Qa+
1],R):R.zod(0):this.Mxb(Ea[0],R):Qa&&-1!==Qa?Ea[Qa-1]!==Bd.GRa?this.Mxb(Ea[Qa-1],R):R.zod(wb-1):this.Mxb(Ea[Ea.length-1],R):(la=parseInt(la.getAttribute(Nh.FRa).toString()),r?la!==wb-1?R.zod(la+1):this.Mxb(Ea[Qa+1],R):la?R.zod(la-1):this.Mxb(Ea[Qa-1],R))}}Mxb(r,R){switch(r){case Bd.k8a:R.I$k();break;case Bd.Wub:R.H$k();break;case Bd.a3b:R.F$k();break;case Bd.e3b:R.G$k()}}A7b(r,R){if(this.la.RYc&&this.Op.Wo.isVisible){if(R&&(r===ab.a.ZBa||r===ab.a.Irb)){this.Sb.MZ=O.a.empty;R=this.ua.presentation;
const la=this.Jb.Ad(7,void 0,void 0,void 0,!0);try{la.nc(R),this.la.tLi&&(la.jd=r),R.removeProperty(Yb.a.dDa)}finally{la&&la.dispose()}}this.ir.SAl(this.Op.mka());this.la.oLi&&r!==ab.a.ZBa&&r!==ab.a.Irb&&this.ia.processAction(ab.a.LNf,2)}}Ina(r,R){this.A7b(R.W3e,R.vbb)}JKj(r){return this.Sb.pAb(r)}ung(r){switch(r){case Yf.a.NRd:case Yf.a.QRd:case Yf.a.EZb:case Yf.a.PRd:case Yf.a.RRd:case Yf.a.SRd:case Yf.a.ZPa:case Yf.a.TRd:case Yf.a.URd:case Yf.a.VRd:case Yf.a.WRd:case Yf.a.YRd:case Yf.a.$Rd:case Yf.a.backspace:case Yf.a.gCa:case Yf.a.$K:case Yf.a.oRa:case Yf.a.enter:case Yf.a.zB:case Yf.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.RYc}LKj(){return 0<this.lcc}HVd(){return this.lcc}m2g(r,R){r=R.slideId;N.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",r.sid);if((R=this.ua.Ba)&&R.Cb.equals(r)){R="unopened";this.Op.Wo.isVisible&&(this.Op.Wo.isVisible&&this.ILb(this.Op,5),R="set to SameSlideCoauthNoSuggestion UI");let la="unopened";this.Op.Wo.isVisible&&(this.XIa(this.Sb.correlationId,ej.a.WIa),la="closed");"unopened"===R&&"unopened"===
la||N.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",R,la,r.sid,r.cid,this.Sb.correlationId,this.Fqe,this.lcc)}}F6g(r,R){N.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.RYc,this.Fqe,
this.lcc,R.correlationId,R.trigger);if(this.isEnabled()){if(r=this.ua.Ba)if(R.slideId.equals(r.Cb))if(this.JKj(R.correlationId))N.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",R.correlationId);else if(this.rHl(R.correlationId))N.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
R.correlationId);else{this.Sb.correlationId!==R.correlationId&&(this.Sb.jsf(R.correlationId,this.la.zja&&R.trigger===Je.a.moreIdeas),N.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Sb.correlationId,R.correlationId));if(this.Sb.correlationId===R.correlationId&&this.Op.Wo.isVisible&&3===this.Op.Wo.fba)if(this.la.designerIncrementalRenderEnabled&&nf.a.any(R.hsc.toArray(),la=>0<=this.Sb.kfa.indexOf(la)))this.Sb.Uic=
new Date,N.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",R.correlationId,R.hsc.toString(),this.Sb.kfa.toString());else if(r=R.yLa,!this.la.designerIncrementalRenderEnabled||this.Sb.ssa.contains(r)){N.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",R.correlationId,r.toString());
return}r=Ee.f_d(R.kDa);this.p5k(r,R);this.Awj(R);this.zwj(this.Op,R,r,R.Taa,nf.a.Wa(this.Sb.sQa)?R.Taa:this.Sb.sQa.length)}else N.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",R.correlationId)}else N.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",R.correlationId)}p5k(r,R){if(r&&R.trigger!==Je.a.moreIdeas){this.Sb.suggestions||(this.Sb.suggestions=
Object.assign(new ei,{CardData:r.CardData,SlideSuggestions:Array(R.Dde?R.Taa:R.T0a)}));if(!nf.a.Wa(r.SlideSuggestions))for(const la of r.SlideSuggestions)this.Sb.suggestions.SlideSuggestions[la.Index]=la;this.Sb.sQa||(this.Sb.sQa=Ee.qCk(r))}}zwj(r,R,la,Ea,Qa){N.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",R.correlationId,R.trigger,R.Taa,Ea);if(R.trigger===Je.a.moreIdeas)this.Sb.rga||(this.Sb.rga=new Date),Ea=r.D6b(),
this.ir.A_k(la,r.mka(),R.correlationId,r.Osa())||(this.ir.gWc(r.mka()),Ea=r.D6b()-1),r.Iw(Ea,!0),this.ILb(r,8);else if(!Ea)!this.la.designerNewNoIdeasUxEnabled||R.trigger!==Je.a.Btc&&R.trigger!==Je.a.yOb?this.ILb(r,2):this.ILb(r,9),this.Op.Wo.isVisible?this.XIa(this.Sb.correlationId,ej.a.WIa):this.h8k(mh.a.noSuggestion);else if(this.Uil(R.trigger,r.Wo)){var wb=!0;if(this.la.designerIncrementalRenderEnabled){wb=null;var Pb=r.mka();Pb&&(wb=Pb.querySelector("#"+r.Wo.id+" ."+Ee.mQa+'[correlationId="'+
R.correlationId+'"]'));wb=!wb;N.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",R.correlationId,R.trigger,wb);Pb=new Cn(R,wb);this.Lc.QOk(Pb)}if(wb){this.ILb(r,3);this.Sb.rga||(this.Sb.rga=new Date);try{this.la.jHk&&this.Hwa.execute(xc=>{xc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(xc){N.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
xc)}}r=new Lj(la,Ea,Qa,R.correlationId,r.mka(),wb,r.Osa(),this.ir.PWc(R.trigger));this.ir.zRe(r)}}Awj(r){r.Dde?(nf.a.Wa(this.Sb.suggestions.SlideSuggestions)||this.Sb.suggestions.SlideSuggestions.length===r.Taa)&&this.XIa(r.correlationId,ej.a.success,this.Sb.suggestions,r.trigger):this.XIa(r.correlationId,ej.a.success,this.Sb.suggestions,r.trigger)}Uil(r,R){return R.isVisible||r!==Je.a.mna&&r!==Je.a.uUd&&r!==Je.a.dtb}Yqd(r,R){this.lcc=r;this.Fqe=R;this.Lc.Dy(new lj.a(1))}g7g(){this.Op.Wo.isVisible&&
3===this.Op.Wo.fba&&(this.nAg.add(this.Sb.correlationId),this.Op.q0a(1))}rHl(r){return this.nAg.contains(r)}XIa(r,R,la=null,Ea=""){N.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",r,R,Ea);this.HWa.execute(Qa=>{const wb=this.JAi(r,la);db.a.Wa(Ea)||(wb.trigger=Ea);Qa.notifySlideSuggestion(R,wb)})}JAi(r,R){const la=new Oi;la.correlationId=r;if(!R)return N.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",
r),la;la.suggestions=this.ir.XCk(R);return la}Uxk(r){r=new Lj(this.Sb.suggestions,r.suggestions.length,r.suggestions.length,r.correlationId,this.Op.mka(),!0,this.Op.Osa(),this.ir.PWc(r.trigger));this.ir.zRe(r);this.Ea.Cj(dd.a.d_,!0)}rBk(){return 4===this.Op.Wo.fba}oBk(){return 1===this.Op.Wo.fba}}Object(h.a)(Qn,"DesignerManager",null,[686,106]);class Tl{constructor(r,R){this.Qeb=this.zo=null;this.wgk=R;this.Le=r;this.rr=!1}get zh(){return this.rr}setup(){this.zh||(this.Qeb=ic.a.Ie(),this.Qeb.setAttribute("Unselectable",
"on"),this.Qeb.style.position=qb.a.absolute,this.Le.addCssClass(this.Qeb,"designerPreviewImageContainer"),this.zo=new Wb.a,this.rr=!0)}dispose(){this.zh&&(this.dismiss(),this.zo&&this.zo.xa.parentNode&&(this.zo.zq(),this.Le.removeCssClass(this.zo.xa,"designerPreviewImageContainer")))}dismiss(){this.zh?(this.doa(),this.zo.setVisibility(!1)):N.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}Eoa(r){if(this.zh){this.Qeb&&(this.Qeb.appendChild(this.zo.xa),this.Le.addCssClass(this.zo.xa,
"designerPreviewImageContainer"),this.zo.setVisibility(!1));var R=this.wgk.Ic;if(r=this.pja(r))this.doa(),R.Erc.appendChild(this.Qeb),this.zo.xa.appendChild(r),this.zo.setVisibility(!0);this.zo.lh(R.JB.clientWidth,R.JB.clientHeight)}else N.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}pja(r){if(!db.a.Wa(r)){const R=ic.a.RA();R.setAttribute("Unselectable","on");R.src=r;R.style.height="100%";R.style.width="100%";return R}return null}doa(){this.zo.xa.firstChild&&this.zo.xa.removeChild(this.zo.xa.firstChild)}}
Object(h.a)(Tl,"DesignerPreviewImageView",null,[687]);var Hk=d(162);class pm{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce){this.fM=null;this.JIa=0;this.ia=r;this.Jb=R;this.ob=la;this.ua=Ea;this.Fb=Qa;this.la=wb;this.vi=Pb;this.qj=xc;this.fc=ed;this.S9=jd;this.zb=bd;this.Rd=Ce;this.Gma=Ni.ready}wb(){this.ia.ra(ab.a.fixIt,mb.a.application,Object(m.a)(this,this.lsj,"handleFixIt"),4);this.ia.ra(ab.a.vNe,mb.a.application,Object(m.a)(this,this.Nuj,"handleQueryFixIt"),96);this.ia.ra(ab.a.Jrb,mb.a.application,
Object(m.a)(this,this.Jrb,"applyFixItSuggestion"),4);this.ia.ra(ab.a.n_a,mb.a.application,Object(m.a)(this,this.n_a,"reportFixItSessionInfo"),64);this.S9.LYb(Object(m.a)(this,this.sfa,"onBlockingStateChanged"))}dispose(){this.S9.old(Object(m.a)(this,this.sfa,"onBlockingStateChanged"))}lsj(r,R,la){R=this.ob.Wd();if(2>R.length)return 8;if(1===la)return 32;la=this.ua.presentation;this.la.designerBlockApplyUntilDraw?this.fc.Mra(la,this.ua.Ba,this.Fb.Ma,r):this.fc.fw(la,r);this.qj.HYc=!0;const Ea=[];R.forEach(Qa=>
{Array.add(Ea,Qa.get_shapeId())});r={};r.SelectedShapeIds=Ea.join(",");this.qj.ekb=Ea;this.bbe(r);this.qj.olb=window.setTimeout(()=>{this.msj(this.qj.correlationId)},this.la.NWf);return 32}msj(r){this.qj.eVa=!0;N.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",r);this.ia.La(ab.a.n_a,2,mh.a.Jrd);this.Rd.ysa(ck.a.Uh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}bbe(r=null,R=null){this.FTi(la=>{if(this.la.designerRequestThrottlingEnabled){if(this.Gma.Glg&&
+new Date-+this.Gma.Log<this.la.designerRequestThrottleIntervalMs){this.fM=new gl;this.fM.sid=la.sid;this.fM.cid=la.cid;this.fM.pWc=la.DQ;return}this.Gma=Ni.inProgress;this.fM=null}const Ea=()=>{this.bbe(this.fM.pWc,R)};this.vi.Vja(la.cid,la.sid,la.correlationId,null,K.a.fixIt,R,Le.c(la.DQ),Qa=>{Qa&&Qa.Status===K.a.Bkh?this.nmd(()=>{this.bbe(la.DQ,R)}):this.JIa=0;this.JIa||this.x7b(Ea)},Qa=>this.Ygb(Qa,Ea))},r)}nmd(r){this.JIa<this.la.designerMaxRetryOnWait?this.zb.Db(new Q.a(2,1,1E3,()=>{N.a.J(578937822,
829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.qj.correlationId);this.Gma=Ni.ready;this.JIa++;r()},void 0,"RetryRequestOnWait")):N.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.qj.correlationId)}Jrb(r,R,la,Ea,Qa){R=this.ua.presentation;if(!this.ua.Ba||!R)return 16;Ea=null;Object(fl.a)(fk,Qa)&&(Ea=Qa);if(!Ea)return 8;if(1===la)return 32;la=this.Jb.me(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.qj.TPa=new Date),la.nc(R),la.jd=r,R.dDa=Ea,this.qj.MZ=O.a.UE(Ea.SuggestionSid,Ea.SuggestionCid),this.qj.DT=!0,N.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ea.CorrelationId,r,Ea.SuggestionSid)}finally{la&&la.dispose()}return 32}FTi(r,R=null){const la=this.ua.Ba;la&&la.sid&&(R=Object.assign(new gn,{sid:la.sid,cid:la.cid,DQ:R||{}}),N.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",R.sid,R.correlationId),this.qj.correlationId&&
this.qLb(mh.a.Yib),this.qj.S0a=new Date,this.qj.correlationId=R.correlationId,this.qj.eQ=new Date,r(R))}x7b(r){this.la.designerRequestThrottlingEnabled&&(this.Gma=Ni.ready,this.fM&&r())}Ygb(r,R){this.x7b(R);N.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",r.HttpStatusCode);return!0}Nuj(r,R,la,Ea,Qa){this.Bxl();if(!Object(fl.a)(Hm.a,Qa))return 8;if(1<this.ob.Knd()){let wb;(wb=this.qj).zsb=wb.zsb+1;return 32}return 8}n_a(r,R,la,Ea,
Qa){if(Qa===mh.a.noSuggestion||Qa===mh.a.Jrd)this.la.designerBlockApplyUntilDraw?this.fc.duc(Hk.e(this.ua.Ba,this.Fb.Ma)):this.fc.fK(this.ua.presentation);this.qLb(Qa);return 32}sfa(r,R){if(this.qj.HYc){r=this.fc.$c(this.ua.presentation);const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";r||Object(D.a)(String,R.actionName)!==la||(window.clearTimeout(this.qj.olb),this.qj.eVa||(this.qj.R0a=new Date),this.qj.TPa=null,this.qj.HYc=!1)}}qLb(r){const R=this.qj.correlationId;
if(db.a.Wa(R))N.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",r);else{var la={};this.qj.MZ&&(la.SuggestionSlideId=this.qj.MZ.sid.toString(),la.SuggestionSlideCreationId=this.qj.MZ.cid.toString());la.AppliedSuggestion=this.qj.DT;la.DisplaySuggestionsTimeoutInMs=this.la.NWf;la.SuggestionsTimeout=this.qj.eVa;la.ClientAbort=this.qj.dzb;la.ResetReason=r;la.DesignerSendTraceRequestOnSessionEnded=this.la.l_d;var Ea=oe.b(z.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
Qa={};Qa.ClientOS=Ea.Os;Qa.Browser=Ea.Browser||"";Qa.BrowserVersion=Ea.BrowserVersion||"";Qa.BrowserMajorVersion=Ea.BrowserMajorVersion||"";Qa.BrowserMinorVersion=Ea.BrowserMinorVersion||"";this.qj.S0a&&this.qj.BNb&&this.qj.BNb>this.qj.S0a&&(Qa.SuggestionsE2ETimeMs=+this.qj.BNb-+this.qj.S0a);this.qj.S0a&&this.qj.R0a&&this.qj.R0a>this.qj.S0a&&(Qa.SuggestionAppliedE2ETimeMs=+this.qj.R0a-+this.qj.S0a);la.BrowserData=Qa;this.qj.eQ&&this.qj.R0a&&this.qj.R0a>this.qj.eQ&&(la.TimeToDisplaySuggestionsInMs=
+this.qj.R0a-+this.qj.eQ);this.qj.P1e&&(la.TimeSuggestionsRendered=this.qj.P1e.toUTCString());this.vi.noa(R,Le.c(la),r===mh.a.cod);this.qj.qSe();N.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",r,R)}}Bxl(){try{const r=A.a.instance.Ja("Common.ISystemInitiatedFeedback");r&&r.execute(R=>{R.logActivity("AutoFixInViewportActivity",null)})}catch(r){N.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",
r)}}D5(){}C5(){}}Object(h.a)(pm,"FixItActor",null,[141]);class qm{constructor(){this.zsb=0;this.correlationId=this.ekb=null;this.olb=0;this.dzb=this.HYc=this.DT=this.eVa=!1;this.suggestion=this.eQ=this.R0a=this.TPa=this.BNb=this.S0a=this.P1e=null;this.MZ=O.a.empty}qSe(){this.zsb=0;this.correlationId=this.ekb=null;this.MZ=O.a.empty;this.olb=0;this.dzb=this.HYc=this.DT=this.eVa=!1;this.eQ=this.R0a=this.TPa=this.BNb=this.S0a=this.P1e=null}}Object(h.a)(qm,"FixItContext",null,[691]);var Vg=d(952),Dn=d(976),
rl=d(851),Fl=d(916);class cm{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd){this.ia=r;this.ua=R;this.Jb=la;this.Lc=Ea;this.qj=Qa;this.Pg=wb;this.IFb=Pb;this.fJ=xc;this.Oc=ed;this.Rd=jd;this.Vu()}Vu(){this.IFb.KYb(Object(m.a)(this,this.CH,"onEvent"));this.Pg.rI(Object(m.a)(this,this.CH,"onEvent"));this.Oc.JPa(Object(m.a)(this,this.CH,"onEvent"));this.Oc.fC(Object(m.a)(this,this.CH,"onEvent"));this.Lc.f$h(Object(m.a)(this,this.E6g,"onSuggestionReceived"));this.Lc.EGc(Object(m.a)(this,this.Ina,"onUndoRedo"))}dispose(){this.Lc.JYk(Object(m.a)(this,
this.E6g,"onSuggestionReceived"));this.Lc.uld(Object(m.a)(this,this.Ina,"onUndoRedo"))}E6g(r,R){if(r=this.ua.Ba)if(R.slideId.equals(r.Cb))if(this.qj.correlationId!==R.correlationId)N.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.qj.correlationId,R.correlationId);else if(r=cm.f_d(R.kDa),r.SlideSuggestion)this.qj.BNb||(this.qj.BNb=new Date),R=Object.assign(new fk,{SuggestionCid:r.SlideSuggestion.SlideId.Cid,
SuggestionSid:r.SlideSuggestion.SlideId.Sid,CorrelationId:R.correlationId,ActiveSlideCid:Object(D.a)(116,this.ua.Ba).cid,ActiveSlideSid:Object(D.a)(116,this.ua.Ba).sid}),this.ia.La(ab.a.Jrb,2,R);else switch(this.ia.La(ab.a.n_a,2,mh.a.noSuggestion),r.ResponseDescription){case "Invalid request":this.Rd.ysa(ck.a.Uh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Rd.ysa(ck.a.Uh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Rd.ysa(ck.a.Uh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else N.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",R.correlationId)}zQ(r){this.qj.correlationId&&r!==ab.a.Jrb&&this.ia.La(ab.a.n_a,2,mh.a.PPb+this.fJ.W5(r))}A7b(r,R,la){if(this.qj.correlationId&&la&&R===ab.a.Jrb){this.qj.MZ=
O.a.empty;la=this.ua.presentation;const Ea=this.Jb.Ad(7,void 0,void 0,void 0,!0);try{Ea.nc(la),Ea.jd=R,la.removeProperty(Yb.a.dDa)}finally{Ea&&Ea.dispose()}this.ia.La(ab.a.n_a,2,mh.a.PPb+this.fJ.W5(r))}}Ina(r,R){this.A7b(R.actionId,R.W3e,R.vbb)}CH(r,R){r=!1;let la="";if(Object(fl.a)(Vg.a,R)){N.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.qj.correlationId,Rl.a[Object(D.a)(Vg.a,R).lG]);if(1===Object(D.a)(Vg.a,R).lG||3===Object(D.a)(Vg.a,R).lG)r=!0;la=mh.a.cod}else Object(fl.a)(Dn.a,
R)?(N.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),r=!0,la=mh.a.MVk):Object(fl.a)(rl.a,R)?(r=!0,la=mh.a.slideNavigation):Object(fl.a)(Fl.a,R)&&Object(D.a)(Fl.a,R).Bzb&&this.zQ(Object(D.a)(Fl.a,R).actionId);r&&this.qj.correlationId&&this.ia.La(ab.a.n_a,2,la);this.S3j()}S3j(){0<this.qj.zsb&&(N.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.qj.zsb),this.qj.zsb=0)}static f_d(r){let R=null;try{R=oe.a(r)}catch(la){N.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return R}}
Object(h.a)(cm,"FixItManager",null,[690,106]);var Io=d(1027),Sk=d(16),nh;(function(r){r[r.seen=0]="seen";r[r.keep=1]="keep";r[r.drillIn=2]="drillIn"})(nh||(nh={}));Object(h.b)("IdeasCardAction",nh);var Ik;(function(r){r[r.designer=0]="designer";r[r.makeItVisual=1]="makeItVisual";r[r.editor=2]="editor";r[r.UNKNOWN=3]="UNKNOWN"})(Ik||(Ik={}));Object(h.b)("IdeasCardType",Ik);class Bj{constructor(r,R){this.dva=null;this.$fc=!1;this.ia=r;this.la=R;this.ia.ya(ab.a.ideasPaneOpened,mb.a.application,Object(m.a)(this,
this.Csj,"handleIdeasPaneOpen"));this.ia.ya(ab.a.ade,mb.a.application,Object(m.a)(this,this.Bsj,"handleIdeasPaneClose"));this.ia.ya(ab.a.Qcg,mb.a.application,Object(m.a)(this,this.t$f,"handleIdeasKeep"));this.ia.ya(ab.a.Rcg,mb.a.application,Object(m.a)(this,this.fbe,"handleIdeasSee"));this.ia.ya(ab.a.Wcg,mb.a.application,Object(m.a)(this,this.fbe,"handleIdeasSee"));this.ia.ya(ab.a.Xcg,mb.a.application,Object(m.a)(this,this.ebe,"handleIdeasDrillIn"));this.ia.ya(ab.a.Ucg,mb.a.application,Object(m.a)(this,
this.t$f,"handleIdeasKeep"));this.ia.ya(ab.a.Vcg,mb.a.application,Object(m.a)(this,this.fbe,"handleIdeasSee"));this.ia.ya(ab.a.Scg,mb.a.application,Object(m.a)(this,this.ebe,"handleIdeasDrillIn"));this.ia.ya(ab.a.Tcg,mb.a.application,Object(m.a)(this,this.ebe,"handleIdeasDrillIn"))}Csj(){if(!this.la.pptIdeasContextEnabled)return 2;this.$fc=!0;this.fLj()||this.cql(Xd.a.create());return 32}Bsj(){if(!this.la.pptIdeasContextEnabled)return 2;this.$fc=!1;return 32}t$f(r){if(!this.la.pptIdeasContextEnabled)return 2;
this.Swl(this.s_d(r));return 32}fbe(r){if(!this.la.pptIdeasContextEnabled)return 2;this.itd(this.s_d(r));return 32}ebe(r){if(!this.la.pptIdeasContextEnabled)return 2;this.Qwl(this.s_d(r));return 32}s_d(r){switch(r){case ab.a.Qcg:case ab.a.Rcg:case ab.a.Scg:r=0;break;case ab.a.Wcg:case ab.a.Xcg:r=1;break;case ab.a.Ucg:case ab.a.Vcg:case ab.a.Tcg:r=2;break;default:r=3}return r}cql(){this.la.pptIdeasContextEnabled&&(this.dva=new Io.a)}itd(r){this.la.pptIdeasContextEnabled&&this.$fc&&3!==r&&this.dva&&
!this.dva.any(R=>R.key===r)&&this.dva.add(new Sk.a(r,0))}Swl(r){this.$fc&&3!==r&&this.dva&&this.dva.add(new Sk.a(r,1))}Qwl(r){this.$fc&&3!==r&&this.dva&&this.dva.add(new Sk.a(r,2))}fLj(){return!!this.dva&&0<this.dva.length}}Object(h.a)(Bj,"IdeasContext",null,[689]);class ef{constructor(){this.yy=this.wy=null;this.HC=this.rx=0}}Object(h.a)(ef,"ImageLocationInfo",null,[]);var hn=d(439);class zi{}Object(h.a)(zi,"ImageToTableRequest",null,[]);class hl{}hl.tdg="ImageToTableTile";hl.rdg="ImageToTable.Request";
hl.sdg="ImageToTable.Response";Object(h.a)(hl,"ImateToTableAugmentationSchemaNames",null,[]);class dp{constructor(){this.z0=this.W_=null}get tG(){return"ImageToTableALWorkflow"}get proto(){return""}get esb(){this.W_||(this.W_=Object.assign(new hn.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:hl.tdg,outputSchema:hl.rdg,func:Object(m.a)(this,this.Dbb,"lambdaBeforeFunc")}));return this.W_}get qrb(){return null}get bKb(){this.z0||(this.z0=Object.assign(new hn.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:hl.rdg,outputSchema:hl.sdg,func:null}));return this.z0}Dbb(r,R,la){r=Object.assign(new zi,{image:r.image});la(r)}}Object(h.a)(dp,"ImageToTableALWorkflow",null,[960]);class Ai{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(h.a)(Ai,"ImageToTableALv2ResponseWrapper",null,[]);class ui{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.fbc=null}}Object(h.a)(ui,"ImageToTableTile",null,[]);class Mj{constructor(r,
R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd){this.ia=r;this.ob=R;this.fc=la;this.Qk=Ea;this.fA=Qa;this.Tb=Pb;this.Sk=xc;this.Kpe=ed;this.ama=jd;this.la=bd}initialize(){this.ia.ya(ab.a.kLe,mb.a.application,Object(m.a)(this,this.Z9f,"handleConvertImageToTable"));this.ia.ya(ab.a.sLe,mb.a.application,Object(m.a)(this,this.cag,"handleReplaceImageWithHtmlTable"));this.Qk.rI(Object(m.a)(this,this.AB,"onActiveSlideChanged"));this.Kpe.execute(r=>{const R=new dp;r.registerSimpleRemoteWorkflow(R.tG,R.esb,R.bKb,R.qrb);r.addEventHandler(hl.sdg,
Object(m.a)(this,this.Fsj,"handleImageToTableALResults"));r.pia("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");r.kKa("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(m.a)(this,this.s_,"handleAnnotationEvent"))})}dispose(){this.ia.PJ(ab.a.kLe,mb.a.application,Object(m.a)(this,this.Z9f,"handleConvertImageToTable"));this.ia.PJ(ab.a.sLe,mb.a.application,Object(m.a)(this,this.cag,"handleReplaceImageWithHtmlTable"));this.Qk.U5(Object(m.a)(this,this.AB,"onActiveSlideChanged"))}AB(){this.ama.close()}Z9f(r,
R,la){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===la)return 32;r=this.ob.Wd();if(1!==r.length)return 8;const Ea=this.ama.Fzk();if(!Ea)return N.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Qa=r[0];this.la.Xah&&(this.ama.o$k(Ea,Qa.slideSid,Qa.get_shapeId(),Mj.YXd(Qa)),this.ama.t2g(Ea));this.Kpe.execute(wb=>{wb.HGl(Qa.slideCid,Qa.slideSid,Qa.get_shapeId(),Pb=>{this.u$f(Ea,Qa,Pb)},()=>{this.u$f(Ea,Qa,null);return!0})});
return 32}s_(r){if(r&&"errorDescription"in r&&"parentPath"in r&&"errorCode"in r){var R=new Ai,la=r.errorDescription.split(";");R.errorDescription=la[0].split(":")[1];R.processId=la[1].split(":")[1];R.errorCode=r.errorCode;N.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",R.processId,R.errorCode,R.errorDescription);la=r.parentPath[1].split("|");R.slideId=Number.parseInvariant(la[0]);R.shapeId=Number.parseInvariant(la[2]);R.html=r.html;
this.ama.m$k(R);this.ama.s2g()}}u$f(r,R,la){if(la&&la.ImgData)if(this.la.Xah)this.ama.n$k(r,la.ImgData),this.ama.s2g();else{const Ea=Mj.YXd(R),Qa=Object.assign(new ui,{sessionId:r,slideSid:R.slideSid,shapeId:R.get_shapeId(),fbc:Ea,image:la.ImgData});this.Kpe.execute(wb=>{wb.submit(hl.tdg,Qa)});this.ama.t2g(r)}else this.ama.guk(r)}Fsj(r,R,la,Ea){N.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Ea.processId,Ea.errorCode,Ea.errorDescription);
this.ama.csk(R,Ea)}cag(r,R,la,Ea,Qa){r=this.Tb.sEa(Qa.slideSid);if(!r)return 8;la=(R=r.iT(Qa.shapeId))?Mj.YXd(R):Qa.fbc;if(!la)return 8;N.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",R.get_shapeId());Qa=this.Sk.hYd(!1,r.cid,r.sid,!1,la.wy,la.yy,la.rx,la.HC,r.Ut()+1,Qa.xAh,"");this.fA.BW([Qa],r,0,null,R);this.fc.fw(r,"ImageToTable");return 32}static YXd(r){return Object.assign(new ef,{wy:r.wy,yy:r.yy,rx:r.rx,HC:r.HC})}}Object(h.a)(Mj,"ImageToTableActor",null,[]);class Tk{constructor(r){this.shapeId=
this.slideId=0;this.mde=null;this.s6e=0;this.jce=!1;this.Pkc=null;this.k_c=!1;this.KWc=this.qde=this.h1g=this.F7g=null;this.sessionId=r}}Object(h.a)(Tk,"ImageToTableConversionContext",null,[]);class Jo{constructor(){this.shapeId=this.slideSid=0;this.xAh=this.fbc=null}}Object(h.a)(Jo,"ReplaceImageWithHtmlTableData",null,[]);class Sm{constructor(r,R,la,Ea){this.ia=r;this.Yc=R;this.Ha=la;this.Hye=Ea;this.V9=null}initialize(){this.Yc.execute(r=>{r.wGc(Object(m.a)(this,this.t3g,"onFirstPartyAddInHidden"))});
this.Hye.kPd(Object(m.a)(this,this.E$f,"handleMessage"))}dispose(){this.Yc.execute(r=>{r.IYk(Object(m.a)(this,this.t3g,"onFirstPartyAddInHidden"))});this.Hye.fih(Object(m.a)(this,this.E$f,"handleMessage"))}Fzk(){this.close();const r=new Tk(Xd.a.create().toString());r.F7g=new Promise(la=>{r.h1g=()=>{la(r.sessionId)}});const R={};R.WE=ResourceStrings.L_DataFromPicturePaneTitle;R.assetId="FA000000050";R.E5=()=>{this.Qgb(r)};R.nonPersistedSettings={["SessionID"]:r.sessionId};R.sourceLocationOverrideResourceId=
this.Ha.pptImageToTableSourceLocationId;return 32===this.ia.La(ab.a.gga,2,R)?(this.V9=r,this.V9.sessionId):this.V9=null}close(){this.DVd(this.V9)}Qgb(r){N.a.J(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",r.sessionId);const R=this.Yc.instance.pQ("FA000000050");if(R&&R.settings&&"SessionID"in R.settings){var la;({rv:la}=oe.d(R.settings.SessionID)).returnValue&&(r.sessionId===la?(r.Pkc=R.instanceId,N.a.J(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
R.instanceId)):N.a.J(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}DVd(r){r&&r.Pkc&&(r.k_c=!0,this.ia.La(ab.a.ttb,2,r.Pkc))}o$k(r,R,la,Ea){if(r=this.xwb(r))r.slideId=R,r.shapeId=la,r.mde=Ea}m$k(r){const R=this.V9;R&&R.slideId===r.slideId&&R.shapeId===r.shapeId&&(this.V9.KWc=r)}n$k(r,R){if(r=this.xwb(r))r.qde=R}t2g(r){const R=this.xwb(r);R&&(R.s6e=window.setTimeout(()=>{this.prj(R)},this.Ha.pptImageToTableALWorkflowTimeoutMs))}csk(r,R){if(r&&R){var la=this.xwb(r.sessionId);if(la&&
!la.jce)if(la.slideId=r.slideSid,la.shapeId=r.shapeId,la.mde=r.fbc,window.clearTimeout(la.s6e),0===R.errorCode){const Ea={};Ea.tableHtml=R.html;Ea.imageData=r.image;this.sendMessage(la.sessionId,Ea)}else this.Snd(r.sessionId,"Failed to convert image to table")}}s2g(){const r=this.V9;if(r&&!r.jce&&r.KWc&&r.qde)if(window.clearTimeout(r.s6e),0===r.KWc.errorCode){const R={};R.tableHtml=r.KWc.html;R.imageData=r.qde;this.sendMessage(r.sessionId,R)}else this.Snd(r.sessionId,"Failed to convert image to table")}guk(r){this.Snd(r,
"Failed to render the image shape")}prj(r){r.jce=!0;this.Snd(r.sessionId,"Failed to convert image to table using AL")}E$f(r,R){R=R.message;(r=this.xwb(R.session_id))&&!r.k_c&&("ACK"===R.cmd_type?(N.a.J(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",R.cmd_type),r.h1g()):"cancel"===R.cmd_type?(N.a.J(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",R.cmd_type),this.DVd(r)):"insert_html"===R.cmd_type?(N.a.J(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
R.cmd_type),R=Object.assign(new Jo,{slideSid:r.slideId,shapeId:r.shapeId,fbc:r.mde,xAh:R.parameters}),this.DVd(r),this.ia.La(ab.a.sLe,2,R)):N.a.J(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",R.cmd_type))}Snd(r,R){this.sendMessage(r,{["errorMessage"]:R})}sendMessage(r,R){const la=this.xwb(r);la&&la.sessionId===r&&la.F7g.then(()=>{this.Hye.sendMessage(la.Pkc,R)})}xwb(r){return r&&this.V9&&this.V9.sessionId===r?this.V9:null}t3g(r,R){R&&this.V9&&
R.instanceId===this.V9.Pkc&&(this.V9=null)}}Object(h.a)(Sm,"ImageToTablePane",null,[693]);class jn extends Sys.EventArgs{constructor(r){super();this.message=r}}Object(h.a)(jn,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class kn{constructor(r){this.va=new nm.a;this.Ha=r}kPd(r){this.va.addHandler("ImageToDocPaneMessageReceived",r)}fih(r){this.va.removeHandler("ImageToDocPaneMessageReceived",r)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(m.a)(this,this.Sic,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(m.a)(this,this.Sic,"messageReceivedHandler")):N.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(r){N.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",r.message,r.stack)}}sendMessage(r,R){const la={["imageToTablePaneWildcard"]:"."};
for(const Ea of Object.keys(R))la[Ea]=R[Ea];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r,"onCustomMessage",la,Ea=>{Ea&&N.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Ea)})}Sic(r){if(r&&this.k$b(r.origin)){var R;({rv:R}=oe.d(r.data)).returnValue&&R&&(r=Object(D.a)(Object,R),"."===r.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new jn(r)))}}k$b(r){return r&&r.length&&"null"!==r?r===this.Ha.pptImageToTableAllowedOrigin:
!1}}Object(h.a)(kn,"ImageToTablePaneMessenger",null,[692]);var no=d(1092);class ze{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(h.a)(ze,"ImageTransformInfo",null,[]);class ln{constructor(r,R,la,Ea){this.ia=r;this.ob=R;this.ua=la;this.Lc=Ea}initialize(){this.Lc.L8h(Object(m.a)(this,this.D6g,"onSuggestedActionClick"))}dispose(){this.Lc.RXk(Object(m.a)(this,this.D6g,"onSuggestedActionClick"))}D6g(r,R){if((r=R.card)&&this.ua.Ba){var la=this.ua.Ba.Ek(),Ea=[];R=
[];for(var Qa of la)for(const wb of r.Selects)if(wb.Id===Qa.get_shapeId()){Array.add(Ea,Qa);Array.add(R,Qa.get_shapeId());break}this.ob.ay();this.ob.Qh();this.ob.P_a(Ea,!0);if(4===r.Type){if(Qa=this.ua.presentation)Qa.pyb=Object.assign(new ze,{Scenario:r.Scenario,SlideSid:this.ua.Ba.sid,SlideCid:this.ua.Ba.cid,ShapeIds:R})}else this.ia.processAction(no.a.OIc(r.ExecutionActionName),2)}}}Object(h.a)(ln,"SuggestedActionsHandler",null,[]);class Ko{constructor(){this.K=null;this.uO=!1;this.kF=!!z.AFrameworkApplication.Aa&&
!!z.AFrameworkApplication.Aa.hb&&z.AFrameworkApplication.Aa.hb.eX}get name(){return"PowerPointWebEditor.Designer"}Zb(r){this.K=r;this.K.register(683,"PowerPointWebEditor.IDesignerView").ma().oa(()=>new Km(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(684,"PowerPointWebEditor.IDesignerPane").ma().oa(()=>new Rh(this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(685,"PowerPointWebEditor.IDesignerViewHelper").ma().oa(()=>new Ee(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.Ja("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(686,"PowerPointWebEditor.IDesignerManager").ma().oa(()=>new Qn(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.Ja("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ja("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ja("Common.ISystemInitiatedFeedback")));this.K.register(687,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().oa(()=>new Tl(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
this.K.register(688,"PowerPointWebEditor.IDesignerContext").ma().oa(()=>new Ho(this.K.Ja("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(689,"PowerPointWebEditor.Infrared.IIdeasContext").ma().oa(()=>new Bj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(690,"PowerPointWebEditor.IFixItManager").ma().oa(()=>new cm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(691,
"PowerPointWebEditor.IFixItContext").ma().oa(()=>new qm);(this.uO=this.K.resolve("PowerPointWebEditor.IApplicationContext").od.vg)&&this.K.register(On.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new On.a(z.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(Mj,"PowerPointWebEditor.Designer.ImageToTableActor").ma().oa(()=>new Mj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(692,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().oa(()=>new kn(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(693,"PowerPointWebEditor.Designer.IImageToTablePane").ma().oa(()=>
new Sm(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(ln,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().oa(()=>new ln(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const r=this.K.resolve("Common.IAppSettingsManager");r.gf(()=>{if(r.ka("248")){this.uO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var R=this.K.resolve("PowerPointWebEditor.IDesignerView");const la=A.a.instance.resolve("PowerPointWebEditor.IDesignerPane").xa;R.hCa(la);R.F8b();this.kF||this.K.resolve("PowerPointWebEditor.IPaneManager").RP(this.K.resolve("PowerPointWebEditor.IDesignerPane"));R=null;if(r.ka("1034")&&(R=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Ea=
new Date;R.nV(r.Ga("1043"),r.Ga("1035")).then(Qa=>{const wb=+new Date-+Ea;Qa.IsSuccess?N.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+wb):(N.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Qa.ErrorCode+": "+Qa.ErrorMessage),N.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+wb))}).catch(Qa=>{N.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+Ea));N.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Qa)})}R=new An(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.Ja("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),R,this.K.Ja("PowerPointWebEditor.IAgendaMetrics"),this.K.Ja("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));R.wb();R.Ee();(new pm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).wb();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else N.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Dc(Bc.a(new Ko,0))}}Object(h.a)(Ko,"PPTWebEditorDesignerPackage",null,[2,3]);class rm{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}Zb(r){this.K=r}init(){const r=this.K.ub("Common.App.PenMinutesManager.IPenMinutesManager");r&&r.dcl()}dispose(){}static main(){e.a.instance.Dc(new rm)}}Object(h.a)(rm,"PPTWebEditorPenMinutesPackage",null,[2,3]);var oo=d(918);class En{}Object(h.a)(En,"TextToSmartArtSuggestionData",null,[]);class ni{constructor(){this.suggestions=[]}}Object(h.a)(ni,"TextToSmartArtSuggestionNotificationData",null,[]);class Og{}Og.YWe="ShapePresence";Og.slideNavigation=
"SlideNavigation";Og.PPb="WebActionId:";Og.RU="SelectionChanged";Og.Lqc="ShapePositionChanged";Og.Yib="Retrigger";Og.xFe="NoSuggestions";Og.S4j="LowSuggestions";Og.zdd="NewSession";Og.Pnl="SlideShowStarted";Og.serverError="ServerError";Og.MFf="ClientSuggestionTimeOut";Object(h.a)(Og,"ReplaceObjectResetReason",null,[]);class Ak{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df,Eh,jk,tj,rk,ul){this.dXa=this.Pve=this.jdb=!1;this.pa=r;this.Ea=R;this.ua=la;this.fc=Ea;this.S9=Qa;this.Pg=wb;this.ia=Pb;
this.rz=xc;this.VHa=ed;this.sz=jd;this.IFb=Ce;this.yma=Bf;this.m$c=Df;this.Lc=Eh;this.fJ=jk;this.zb=tj;this.Rb=rk;this.ku=bd;this.HWa=ul;this.rr=!1}get zh(){return this.rr}setup(){this.zh||(this.Vu(),this.Pve=2===this.Rb.mode,this.rr=!0)}Vu(){this.pa.wF(Object(m.a)(this,this.EH,"onSelectionChanged"));this.IFb.KYb(Object(m.a)(this,this.IDe,"markedUndo"));this.Pg.rI(Object(m.a)(this,this.AB,"onActiveSlideChanged"));this.yma.h6a(Object(m.a)(this,this.T0,"onSlidePresenceChanged"));this.Lc.C$h(Object(m.a)(this,
this.wIe,"onReplaceObjectResponse"));this.VHa.D$h(Object(m.a)(this,this.xIe,"onReplaceObjectViewDragEnd"));this.S9.LYb(Object(m.a)(this,this.rGe,"onApplyReplaceObjectBlockingStateChanged"));this.Pg.pPd(Object(m.a)(this,this.muc,"updateEditState"));this.Rb.PK(Object(m.a)(this,this.Su,"onAppFrameModeSwitched"));this.Lc.fuf(Object(m.a)(this,this.E1g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Lc.euf(Object(m.a)(this,this.D1g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Lc.EGc(Object(m.a)(this,
this.Ina,"onUndoRedo"))}dispose(){this.zh&&(this.pa.aya(Object(m.a)(this,this.EH,"onSelectionChanged")),this.IFb.WQe(Object(m.a)(this,this.IDe,"markedUndo")),this.Pg.U5(Object(m.a)(this,this.AB,"onActiveSlideChanged")),this.yma.nRe(Object(m.a)(this,this.T0,"onSlidePresenceChanged")),this.Lc.ZYk(Object(m.a)(this,this.wIe,"onReplaceObjectResponse")),this.VHa.$Yk(Object(m.a)(this,this.xIe,"onReplaceObjectViewDragEnd")),this.S9.old(Object(m.a)(this,this.rGe,"onApplyReplaceObjectBlockingStateChanged")),
this.Rb.yY(Object(m.a)(this,this.Su,"onAppFrameModeSwitched")),this.Pg.ZQe(Object(m.a)(this,this.muc,"updateEditState")),this.Lc.iih(Object(m.a)(this,this.E1g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Lc.hih(Object(m.a)(this,this.D1g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Lc.uld(Object(m.a)(this,this.Ina,"onUndoRedo")),this.rr=!1)}w0a(r){return this.qje()?this.m$c.Ouc(r):!1}selectShape(r){r&&this.pa.selectShape(r,!1)}DZc(r){switch(r){case ab.a.RPa:case ab.a.QEe:case ab.a.bjc:case ab.a.cjc:case ab.a.djc:case ab.a.ejc:case ab.a.RIa:return!0;
default:return!1}}qje(){return this.jdb&&this.Pve}l9g(r,R){const la=[];if(db.a.Wa(r))return la;r=r.split(";");if(r.length<R)return N.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",R,r.length),la;for(let Ea=0;Ea<R;++Ea){const Qa=r[Ea].split(":");if(3!==Qa.length)throw R=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Ea,r[Ea]),N.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",R),Error.create(R);
const wb=oo.a.kmj(Number.parseInvariant(Qa[1]));Array.add(la,Object.assign(new En,{index:Qa[0],labelText:db.a.Wa(wb)?ResourceStrings.L_SmartArt:wb,imageData:this.TSc(Qa[2])}))}return la}E1g(){this.dXa=!0}D1g(){this.dXa=!1}Ina(r,R){this.zQ(R.actionId)}TSc(r){return db.a.Wa(r)?null:"data:image/png;base64,"+r}Su(r){N.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",r.mode);this.Pve=2===r.mode}muc(){this.jdb||N.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.jdb=!0}NGb(r,R,la,Ea){this.HWa.execute(Qa=>{const wb=Object.assign(new ni,{correlationId:r,shapeId:R,suggestions:la});Qa.notifyTextToSmartArtSuggestion(Ea,wb)})}dag(r,R,la){if(R.hE)if(R.s9&&0!==r.uKa)N.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",r.uKa);else{if(0===r.uKa){if(0>=r.Xda){N.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",r.correlationId);this.closeSession(R,Og.xFe);
return}if(r.Xda<la.replaceObjectMinRequiredSuggestions){N.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",r.correlationId);this.closeSession(R,Og.S4j);return}R.s9=!1;R.suggestions=this.l9g(r.kDa,r.Xda);R.cV=r.Xda;N.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",R.cV,r.correlationId)}else if(1===r.uKa){if(db.a.Wa(r.kDa)){N.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
r.correlationId);return}R.suggestions=this.l9g(r.kDa,r.Xda);R.iOb=new Date;la.powerPointIdeasIsEnabled&&this.NGb(r.correlationId,R.shapeId,R.suggestions,ej.a.success)}else 2===r.uKa&&(R.Hme=!1,R.shapeId=r.shapeId,this.NGb(R.correlationId,r.shapeId,R.suggestions,ej.a.success));la=R.shape;R.slide&&R.slide.isConnected&&la&&la.isConnected&&this.ku.LFa(la)&&this.qje()&&(1===r.uKa?this.sz.ngh(R.correlationId):this.sz.Mqd(la))}else N.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
r.correlationId)}}Object(h.a)(Ak,"BaseReplaceObjectManager",null,[682,709]);class sc{}sc.none="";sc.Lqc="ShapePositionChanged";Object(h.a)(sc,"ReplaceObjectRetriggerReason",null,[]);class Xi{}Xi.selectShape="SelectShape";Xi.Yib="Retrigger";Xi.Qgi="AugLoopRetrigger";Xi.Pgi="AugLoopDefault";Object(h.a)(Xi,"ReplaceObjectTrigger",null,[]);var Gl=d(509);class dm extends Ak{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df,Eh,jk,tj,rk,ul,Tn,Un,Yh,Vn){super(xc,la,Ea,Qa,wb,Pb,ed,jd,bd,Ce,Bf,Eh,jk,tj,rk,
Tn,Un,Yh,Vn);this.OT=r;this.U2c=R;this.$ek=Df;this.la=ul;this.kRg=this.la.replaceObjectGrayFloatieInTyping}Vu(){this.la.replaceObjectUseClientAL?this.U2c.execute(r=>{r.addEventHandler("ShapeTextConvertable",Object(m.a)(this,this.uch,"processShapeTextConvertibleClientAL"))}):this.OT.execute(r=>{r.addEventHandler("ShapeTextConvertable",Object(m.a)(this,this.OMe,"processShapeTextConvertible"))});this.Lc.Wai(Object(m.a)(this,this.hgd,"onSlideShowStarted"));super.Vu()}dispose(){this.zh&&(this.la.replaceObjectUseClientAL?
this.U2c.execute(r=>{r.removeEventHandler("ShapeTextConvertable",Object(m.a)(this,this.uch,"processShapeTextConvertibleClientAL"))}):this.OT.execute(r=>{r.removeEventHandler("ShapeTextConvertable",Object(m.a)(this,this.OMe,"processShapeTextConvertible"))}),this.Lc.QZk(Object(m.a)(this,this.hgd,"onSlideShowStarted")));super.dispose()}OMe(r,R){if(r&&R){try{var la=oe.a(r);var Ea=oe.a(R)}catch(wb){N.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(la&&!isNaN(la.sid)&&!isNaN(la.cid)&&!isNaN(la.shapeId)&&this.ua.Ba&&(r=new Date(la.c),N.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",la.sid,la.cid,la.shapeId,la.t,la.c?(new Date).getTime()-la.c:-1),(R=this.ua.Ba.iT(la.shapeId))&&(nf.a.contains(this.f6f(),R.get_shapeId())||"activeSlideChanged"===la.t)))if(Ea&&!Ea.isTextConvertible)this.sz.goa(R,!0);else{var Qa=this.rz.d6b(R.get_shapeId());if(Qa&&Qa.Zca&&(Qa=new Gl.a(R,Qa.Bga),this.ia.La(ab.a.Whb,
2,Qa),!Qa.nua))return;this.w0a(R)&&this.Vja(this.ua.Ba,R,Ea&&Ea.smartArtInfo?Ea.smartArtInfo.length:0,la.t||Xi.Pgi,sc.none,r)}}}uch(r,R,la,Ea){R&&Ea&&Ea.ContextId&&Ea.Payload&&this.OMe(Ea.ContextId,Ea.Payload)}hgd(){this.zVd(Og.Pnl)}EH(r,R){if(!this.zh)N.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.dXa&&(R.EE.length||!this.Ea.Ae||this.Ea.Ae.name!==dd.a.sg)){r=this.f6f();for(let la of this.rz)la.hE&&!Array.contains(r,la.shapeId)&&
this.closeSession(la,Og.RU);this.kRg&&!Array.contains(r,this.sz.Jxb)&&this.sz.LWk()}}xIe(r,R){this.zh?(r=this.rz.d6b(R.shape.get_shapeId()))&&r.hE&&(R=r.shape,this.closeSession(r,Og.Lqc),this.w0a(R)&&this.Vja(this.ua.Ba,R,0,Xi.Qgi,sc.Lqc)):N.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}IDe(r,R){R.Bzb&&this.zQ(R.actionId)}AB(){this.zVd(Og.slideNavigation)}T0(r,R){if(R.c9&&R.shapes)for(const la of R.shapes)(r=this.rz.d6b(la))&&r.hE&&this.closeSession(r,
Og.YWe)}wIe(r,R){(r=this.rz.Y9a(R.correlationId))?this.dag(R,r,this.la):N.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",R.correlationId)}rGe(){if(this.zh)for(let r of this.rz)r.uab&&0===r.F1&&!this.fc.$c(this.ua.presentation)&&(r.uab=!1,this.sz.goa(r.shape,!0))}w0a(r){const R=this.rz.Jrf;return 1<=R?(N.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
R),!1):super.w0a(r)}Vja(r,R,la,Ea,Qa,wb=null){try{let Pb=this.rz.d6b(R.get_shapeId());Pb&&this.closeSession(Pb,Og.zdd);Pb=this.rz.NLc(r,R.get_shapeId(),Ea,Qa,this.la);Pb.otc=wb;Pb.Zca="richEditTextUnicodeChanged"===Ea;this.sz.kuc(Pb.correlationId);const xc=this.$ek.Ioh(Pb);N.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Pb.correlationId,Pb.slide.sid,Pb.slide.cid,Pb.shapeId,xc);N.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Pb.correlationId,la,Math.min(la,this.la.replaceObjectSuggestionMaxCount),Ea);la&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(la=Math.min(la,this.la.replaceObjectSuggestionMaxCount),Pb.suggestions=this.G1i(la),Pb.cV=la,Pb.s9=!1,this.sz.Mqd(R));0===xc&&this.la.powerPointIdeasIsEnabled&&this.NGb(Pb.correlationId,Pb.shapeId,[],ej.a.pending)}catch(Pb){N.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Pb.message)}}G1i(r){const R=Array(r);for(let la=0;la<r;la++)Array.add(R,Object.assign(new En,
{index:la.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return R}zQ(r){this.zh?this.DZc(r)||this.zVd(Og.PPb+this.fJ.W5(r)):N.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}Hhl(r){if(!this.kRg)return!1;const R=this.pa.Wd();return r.Zca&&Array.contains(R,r.shape)}closeSession(r,R){0===r.F1&&(R===Og.xFe?this.sz.goa(r.shape,!0):r.Zca&&this.sz.goa(r.shape,!0,R!==Og.zdd,this.Hhl(r)),this.rz.XXc(r,R),this.la.powerPointIdeasIsEnabled&&this.NGb(r.correlationId,
r.shapeId,r.suggestions,ej.a.WIa))}zVd(r){for(let R of this.rz)this.closeSession(R,r)}f6f(){const r=this.pa.Wd(),R=[];r&&r.forEach(la=>{Array.add(R,la.get_shapeId())});return R}}Object(h.a)(dm,"AugmentationLoopReplaceObjectManager",Ak,[]);class gk{constructor(r,R){this.disabled=!1;this.EFg=yk.App.Vm;this.la=r;this.zb=R}Nph(r){this.disabled=!0;this.EFg=new Date;const R=new Q.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.EFg>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
r()});this.zb.Db(R)}zal(r){const R=new Q.a(2,1,550,()=>{r()});this.zb.Db(R)}static PGl(r,R){return 7<=r&&8>=r&&1!==R}}Object(h.a)(gk,"FlyoutAnchorTimer",null,[]);var We=d(369);class po{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df,Eh){this.Gs=null;this.dXa=!1;this.Lc=R;this.pa=r;this.rz=la;this.ua=Ea;this.Fa=Qa;this.la=wb;this.sz=Pb;this.vi=xc;this.ku=ed;this.yma=jd;this.S9=bd;this.zWa=Ce;this.eic=Bf;this.fJ=Df;this.mc=Eh}Vu(){this.Lc.j$h(Object(m.a)(this,this.K3g,"onIconSuggestionNotification"));
this.pa.wF(Object(m.a)(this,this.EH,"onSelectionChanged"));this.Lc.fuf(Object(m.a)(this,this.C1g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.euf(Object(m.a)(this,this.B1g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.i$h(Object(m.a)(this,this.J3g,"onIconChanged"));this.yma.h6a(Object(m.a)(this,this.T0,"onSlidePresenceChanged"));this.S9.LYb(Object(m.a)(this,this.sfa,"onBlockingStateChanged"));this.eic.KYb(Object(m.a)(this,this.Ogb,"onMarkedUndo"))}S3e(){this.Lc.LYk(Object(m.a)(this,
this.K3g,"onIconSuggestionNotification"));this.pa.aya(Object(m.a)(this,this.EH,"onSelectionChanged"));this.Lc.iih(Object(m.a)(this,this.C1g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.hih(Object(m.a)(this,this.B1g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.KYk(Object(m.a)(this,this.J3g,"onIconChanged"));this.yma.nRe(Object(m.a)(this,this.T0,"onSlidePresenceChanged"));this.S9.old(Object(m.a)(this,this.sfa,"onBlockingStateChanged"));this.eic.WQe(Object(m.a)(this,
this.Ogb,"onMarkedUndo"))}dispose(){this.S3e()}setup(){this.Vu()}C1g(){this.dXa=!0}B1g(){this.dXa=!1}J3g(r,R){R&&this.Gs&&this.Gs.Apc&&this.Gs.slide.sid===R.slideId.sid&&this.Gs.slide.cid===R.slideId.cid&&this.Gs.shapeId===R.shapeId&&this.Gs.m6===R.SY&&(this.Gs.$Te=R.JEa)}T0(r,R){if(R.c9&&R.shapes&&this.Gs)for(const la of R.shapes)this.Gs.shapeId===la&&this.pW(Og.YWe)}Ogb(r,R){R.Bzb&&!this.DZc(R.actionId)&&this.pW(Og.PPb+this.fJ.W5(R.actionId))}DZc(r){switch(r){case ab.a.RPa:case ab.a.QEe:case ab.a.bjc:case ab.a.cjc:case ab.a.djc:case ab.a.ejc:case ab.a.RIa:return!0;
default:return!1}}sfa(){if(this.Gs){const r=this.Gs.shape,R=this.Fa.yr(r);r&&R&&!this.zWa.$c(R)&&(this.Gs.uab=!1,this.sz.goa(r,!0),this.Gs.mtc=new Date,this.Gs.pW(Og.RU))}}EH(){if(!this.dXa){var r=this.Fa.D9a(this.pa.Wd());if(r){if(this.Gs&&this.Gs.hE){if(We.a.Kqc(r.MY,this.Gs.MY))return;this.pW(Og.RU)}this.w0a(r)&&this.Vja(this.ua.Ba,r,Xi.selectShape)}else this.Gs&&this.Gs.hE&&this.pW(Og.RU)}}Vja(r,R,la){this.Gs=this.rz.UQa(r,R.get_shapeId(),la,"",this.la,R.get_smartArtModelId());this.Gs.s9=!0;this.sz.kuc(this.Gs.correlationId);
N.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Gs.correlationId,this.Gs.slide.sid,this.Gs.slide.cid,this.Gs.shapeId,this.Gs.m6);const Ea=R.get_smartArtModelId()?this.Fa.yr(R):R;Ea?this.vi.D1i(r.cid,r.sid,Ea.get_shapeId(),this.ku.iUc(Ea),this.ku.hUc(Ea),R.get_smartArtModelId(),this.Gs.correlationId,la,Object(m.a)(this,this.duk,"onIconSuggestionResponseSuccess"),Object(m.a)(this,this.Ygb,"onTaskFailure")):
N.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",R.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}duk(r){if(r&&r.SuggestionResult){var R=r.CorrelationId,la=this.rz.Y9a(R);if(la)if(la.hE){R=null;try{R=Sys.Serialization.JavaScriptSerializer.deserialize(r.SuggestionResult)}catch(Ea){N.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Ea)}if(R){la.suggestions=this.JCk(R);la.iOb=new Date;if(la.s9){if(this.Xgg(la)){N.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",la.e0b,this.la.pptIconChunkingSuggestionTimeoutMs);this.pW(Og.MFf);return}N.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");la.cV=la.suggestions?la.suggestions.length:0;la.s9=!1;this.sz.Mqd(la.shape)}this.sz.ngh(la.correlationId)}else this.pW(Og.serverError),N.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else N.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Gs?this.Gs.correlationId:"",R);else N.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",R)}else this.pW(Og.serverError),N.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}Ygb(r){this.pW(Og.serverError);
N.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",r.HttpStatusCode);return!0}w0a(r){return this.mc.Gn?r.get_smartArtModelId()&&r.get_isSVGBlipFilled()?(r=this.Fa.yr(r),!!r&&!r.As):!1:!1}pW(r){this.Gs&&(this.sz.goa(this.Gs.shape,!0),this.rz.XXc(this.Gs,r),this.Gs=null)}TSc(r){return db.a.Wa(r)?null:r.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(r):"data:image/png;base64,"+r}JCk(r){const R=[];if(!r||
!r.length)return R;for(let la=0;la<r.length;++la){const Ea=Object.assign(new En,{index:r[la].Index.toString(),labelText:r[la].Label,imageData:this.TSc(r[la].Render),renderData:this.TSc(r[la].Replace)});Array.add(R,Ea)}return R}ZDi(r,R){const la=[];if(db.a.Wa(r)||!R)return la;for(var Ea=0;Ea<R;++Ea){var Qa=Object.assign(new En,{index:Ea.toString(),labelText:"",imageData:null,renderData:null});Array.add(la,Qa)}r=r.split(";");if(r.length-1!==R)return N.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
la.length,R),la;for(Ea=0;Ea<R;++Ea)Qa=r[Ea].indexOf(":"),0>Qa?N.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):la[Ea].labelText=r[Ea].substr(Qa+1);return la}ICk(r){let R,la,Ea,Qa;R="";Ea=la=0;Qa=null;if(db.a.Wa(r))return N.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:R,Xda:la,HFe:Ea,suggestions:Qa};const wb=r.split("|");if(4!==wb.length)return N.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+r.length),{returnValue:!1,correlationId:R,Xda:la,HFe:Ea,suggestions:Qa};R=wb[0];la=parseInt(wb[1]);Ea=Number.parseInvariant(wb[2]);Qa=this.ZDi(wb[3],la);return{returnValue:!0,correlationId:R,Xda:la,HFe:Ea,suggestions:Qa}}K3g(r,R){let la,Ea;if(({correlationId:r,Xda:R,HFe:la,suggestions:Ea}=this.ICk(R.kDa)).returnValue){var Qa=this.rz.Y9a(r);if(Qa)if(Qa.hE&&Qa.s9){var wb=Qa.shape;0===la&&(0>=
R?(N.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",r),this.pW(Og.xFe)):this.Xgg(Qa)?(N.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Qa.e0b,this.la.pptIconChunkingSuggestionTimeoutMs),this.pW(Og.MFf)):(Qa.s9=!1,Qa.cV=R,Qa.suggestions=Ea,N.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Qa.correlationId,Qa.cV),this.sz.Mqd(wb)))}else N.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Gs?this.Gs.correlationId:"",r,Qa.hE,Qa.s9);else N.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",r)}else N.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Xgg(r){const R=
new Date,la=r.Bga,Ea=this.la.pptIconChunkingSuggestionTimeoutMs;return R&&la&&0<Ea&&+R-+la>Ea?(r.e0b=+R-+la,!0):!1}}Object(h.a)(po,"ReplaceIconManager",null,[]);var Lo=d(701),qo=d(998);class Mo extends Sys.EventArgs{constructor(r){super();this.MY=r}}Object(h.a)(Mo,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class Tm{constructor(){this.shape=null;this.action=0}}Object(h.a)(Tm,"ShowHideReplaceObjectGalleryData",null,[]);class em{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf){this.rr=
this.jdb=!1;this.ia=R;this.Ea=la;this.ua=Qa;this.Pg=Ea;this.fc=wb;this.WHa=Pb;this.sz=bd;this.Fb=Ce;this.Fa=Bf;this.pa=r;this.Lc=xc;this.rz=ed;this.Jb=jd}get zh(){return this.rr}setup(){this.zh||(this.Vu(),this.wb(),this.Ee(),this.rr=!0)}dispose(){this.zh&&(this.S3e(),this.rr=!1)}Vu(){this.Pg.pPd(Object(m.a)(this,this.muc,"updateEditState"))}S3e(){this.Pg.ZQe(Object(m.a)(this,this.muc,"updateEditState"))}wb(){this.ia.ra(ab.a.RPa,mb.a.application,Object(m.a)(this,this.RPa,"applyReplaceObjectSuggestion"),
4);this.ia.ra(ab.a.z0a,mb.a.application,Object(m.a)(this,this.z0a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(ab.a.OMb,mb.a.application,Object(m.a)(this,this.z0a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(ab.a.njc,mb.a.application,Object(m.a)(this,this.i_g,"navigateReplaceObjectSuggestion"),4);this.ia.ra(ab.a.mjc,mb.a.application,Object(m.a)(this,this.i_g,"navigateReplaceObjectSuggestion"),4)}Ee(){const r=this.Ea.Fc(dd.a.lQ),R=this.Ea.Fc(dd.a.sg),la=this.Ea.Fc(dd.a.Jib);
r.bindAction(fb.KeyInputManager.Oa(Ba.a.tq,2),ab.a.OMb);R.bindAction(fb.KeyInputManager.Oa(Ba.a.tq,2),ab.a.OMb);la.bindAction(fb.KeyInputManager.Oa(Ba.a.tq,2),ab.a.OMb);la.bindAction(fb.KeyInputManager.Oa(Ba.a.T1,0),ab.a.OMb);la.bindAction(fb.KeyInputManager.Oa(Ba.a.dba,0),ab.a.njc);la.bindAction(fb.KeyInputManager.Oa(Ba.a.Mga,0),ab.a.mjc)}muc(){this.jdb||N.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.jdb=!0}RPa(r,R,la,Ea,Qa){if(!this.zh)return N.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;R=this.ua.presentation;if(!this.ua.Ba||!R||this.fc.$c(R))return 16;if(1===la)return 32;la=!0;Ea=null;Object(fl.a)(Lo.a,Qa)?Ea=Qa:Object(fl.a)(qo.a,Qa)&&(Ea=Qa.xHc,la=!1);Qa=new We.a(O.a.UE(Ea.ActiveSlideSid,Ea.ActiveSlideCid),Ea.ShapeId,Ea.SmartArtSubNodeId);const wb=new Mo(Qa);this.WHa.pOk(wb);const Pb=this.rz.Z9a(Qa);if(Pb&&Pb.shapeId===Ea.ShapeId){let xc=null;1===Pb.F1&&(xc=this.Fa.yr(Pb.shape));Qa=this.Jb.Ad(15,
void 0,()=>{1===Pb.F1||this.pa.Bs()||(this.Lc.$jd(),this.pa.Qh(),this.Lc.Zjd())},()=>{xc&&(this.Lc.$jd(),this.pa.selectShape(xc,!0),this.Lc.Zjd())});try{Qa.nc(R),Qa.jd=Ea.SmartArtSubNodeId?ab.a.YDf:r,R.tKb=Ea,Pb.uHc=Ea.SuggestionSid,Pb.JQd=Ea.Label,Pb.DT=!0,Pb.ntc=new Date,N.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ea.CorrelationId,r,Ea.SuggestionSid)}finally{Qa&&Qa.dispose()}Pb.Hme=!0;Pb.uab=!0;la&&Pb.HDe();0===
Pb.F1?this.fc.fw(R,r):xc?this.fc.Mra(R,xc,this.Fb.Ma,r):N.a.J(38854750,808,15,"Invalid smartArtShape")}else N.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}z0a(r,R,la,Ea,Qa){if(!this.zh)return N.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;R=this.ua.presentation;if(!this.ua.Ba||!R||this.fc.$c(R))return 16;if(1===la)return 32;la=null;R=0;if(r===ab.a.z0a){r=Object(D.a)(Tm,Qa);if(!r)return 16;la=r.shape;R=r.action}else if(r===
ab.a.OMb){r=this.pa.Wd();if(1!==r.length)return 32;la=r[0]}if(!la)return N.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;r=this.rz.Z9a(la.MY);if(!r||!this.jdb&&r&&0===r.F1)return 2;if(r&&r.hE&&r.shapeId===la.get_shapeId())switch(this.pa.ij(),this.Ea.Ed(),R){case 0:this.sz.ewl(r.correlationId);break;case 1:this.sz.vB.isVisible||this.sz.dZe(r.correlationId);break;case 2:this.sz.Dce(la)}return 32}i_g(r,R,la){if(!this.zh)return N.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;R=this.ua.presentation;return this.ua.Ba&&R&&!this.fc.$c(R)?1===la?32:this.sz.vB.isVisible?r===ab.a.njc?(this.sz.njc(),32):r===ab.a.mjc?(this.sz.mjc(),32):16:16:16}}Object(h.a)(em,"ReplaceObjectActor",null,[]);class Nj{constructor(r,R){this.r$=r;this.V2c=R}initialize(){this.r$.execute(r=>{r.registerSimpleRemoteWorkflow(this.V2c.tG,this.V2c.esb,this.V2c.bKb,this.V2c.qrb)})}}Object(h.a)(Nj,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var Rn=d(1096),mn;(function(r){r[r.textToSmartArt=0]="textToSmartArt";r[r.iconChunking=1]="iconChunking"})(mn||(mn={}));Object(h.b)("ReplaceObjectType",mn);class ro{constructor(r,R){this.$4a=this.uS=this.la=null;this.shapeId=0;this.m6=null;this.F1=0;this.Zca=!1;this.uHc=0;this.JQd=null;this.Qje=this.Fje=this.uab=this.DT=!1;this.mtc=this.ntc=this.O1e=this.iOb=this.rtc=this.VLa=this.otc=this.Bga=null;this.Kvb=this.isc=0;this.wJd=this.B5a=this.Ppa=null;this.s9=!1;this.suggestions=null;this.e0b=
this.cV=0;this.Hme=!1;this.kjb=null;this.Apc=!1;this.$Te=null;this.jEd=!1;this.xEb=[];this.vi=r;this.Mcc=R;this.reset()}UQa(r,R,la,Ea,Qa,wb){this.hE&&this.pW(Og.zdd);if(!r)throw Error.argumentNull("slide");const Pb=r.vxb(new We.a(r?r.Cb:null,R,wb));if(!Pb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",R));this.uS=r;this.$4a=Pb;this.shapeId=R;this.m6=wb;this.Ppa=Xd.a.create().toString();this.jEd=!0;this.B5a=la;this.wJd=Ea;this.la=Qa;this.Bga=new Date;
this.F1=this.ilj();return this.correlationId}NLc(r,R,la,Ea,Qa){return this.UQa(r,R,la,Ea,Qa,null)}ilj(){const r=this.shape;return this.la.iconChunkingEnabled&&r&&this.m6&&r.get_isSVGBlipFilled()?1:0}pW(r){if(this.hE&&!this.tSj(this.correlationId)){const R={};R.SuggestionCount=this.cV;R.ClientSuggestionTimeoutInMs=this.e0b;R.IsApplied=this.DT;R.AppliedSuggestionId=this.DT?this.uHc.toString():"";R.AppliedSuggestionLabel=this.DT?this.JQd:"";R.IsFloatieShown=this.Fje;R.IsGalleryShown=this.Qje;R.Trigger=
this.trigger;R.RetriggerReason=this.j3k;R.ResetReason=r;R.IconId=this.la.replaceObjectIconType;R.SlideCID=this.slide.cid;R.SlideSID=this.slide.sid;R.ShapeID=this.shapeId;R.AnimId=this.la.replaceObjectAnimId;R.AnimEnabled=this.la.sKb;R.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;R.ReplaceSuggestionType=mn[this.F1];R.SeeMoreButtonClicked=this.Apc;R.SeeMoreIconName=this.Apc?this.$Te:"";this.Bga&&(R.SessionLiveTimeInMs=+new Date-+this.Bga);this.m6&&(R.SmartArtSubNodeId=this.m6);this.VLa&&
this.iOb&&this.iOb>this.VLa&&(R.SuggestionsReadyInMs=+this.iOb-+this.VLa);0<this.isc&&(R.SuggestionsDisplayedForMs=this.isc);0<this.Kvb&&(R.FloatieDisplayedForMs=this.Kvb);this.VLa&&this.Bga&&this.VLa>this.Bga&&(R.FloatieReadyInMs=+this.VLa-+this.Bga);this.Bga&&this.otc&&this.Bga>this.otc&&(R.TriggeredByAugLoopInMs=+this.Bga-+this.otc);this.ntc&&this.mtc&&this.mtc>this.ntc&&(R.SuggestionAppliedInMs=+this.mtc-+this.ntc);if(0<this.suggestions.length){r=[];for(let la=0;la<this.suggestions.length;la++)Array.add(r,
this.suggestions[la].labelText);R.SuggestionLabels=Le.c(r)}1!==this.F1||db.a.Wa(this.kjb)||(r=Rn.a.b$a(this.kjb))&&r.hasChildNodes()&&(Rn.a.r3b(),Rn.a.TVk(this.kjb));this.vi.M0k(this.correlationId,Le.c(R),void 0,Object(m.a)(this,this.Vjc,"onFailureCallback"));this.Yjk(this.correlationId)}this.reset()}reset(){this.jEd=!1;this.uS=null;this.Hme=this.Qje=this.Fje=this.uab=this.DT=this.Zca=!1;this.wJd=this.B5a=this.Ppa="";this.suggestions=[];this.uHc=0;this.JQd="";this.s9=!1;this.e0b=this.cV=0;this.mtc=
this.ntc=this.O1e=this.iOb=this.rtc=this.VLa=this.otc=this.Bga=null;this.F1=this.Kvb=this.isc=0;this.kjb="";this.$4a=null;this.Apc=!1;this.$Te=""}tSj(r){return this.xEb?Array.contains(this.xEb,r):!1}Yjk(r){this.xEb&&!Array.contains(this.xEb,r)&&(Array.add(this.xEb,r),N.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",r,this.xEb.length))}Vjc(r){N.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
r.HttpStatusCode);return!0}HDe(){this.MXg(2,4)}ckk(){this.MXg(3,3)}MXg(r,R){this.Mcc&&this.Mcc.execute(la=>{const Ea=Object.assign(new Go.a,{cardId:xp.a.axh,actionType:r,actionEngagement:R});la.Sdd(Ea)})}get slide(){return this.uS}get shape(){return this.$4a}get correlationId(){return this.Ppa}get trigger(){return this.B5a}get j3k(){return this.wJd}get hE(){return this.jEd}get appSettings(){return this.la}get MY(){return new We.a(this.slide?this.slide.Cb:null,this.shapeId,this.m6)}}Object(h.a)(ro,
"ReplaceObjectContext",null,[992]);class Uk{constructor(){this.va=new nm.a}pOk(r){this.va.raiseEvent("ReplaceObjectBSA",r)}K9h(r){this.va.addHandler("ReplaceObjectBSA",r)}vYk(r){this.va.removeHandler("ReplaceObjectBSA",r)}reh(r){this.va.raiseEvent("ReplaceObjectSPOver",r)}tai(r){this.va.addHandler("ReplaceObjectSPOver",r)}xZk(r){this.va.removeHandler("ReplaceObjectSPOver",r)}qeh(r){this.va.raiseEvent("ReplaceObjectSPOut",r)}sai(r){this.va.addHandler("ReplaceObjectSPOut",r)}wZk(r){this.va.removeHandler("ReplaceObjectSPOut",
r)}tOk(r){this.va.raiseEvent("ReplaceObjectViewDE",r)}D$h(r){this.va.addHandler("ReplaceObjectViewDE",r)}$Yk(r){this.va.removeHandler("ReplaceObjectViewDE",r)}}Object(h.a)(Uk,"ReplaceObjectEventSource",null,[989,990,991]);class ep extends Ak{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df,Eh,jk,tj,rk,ul,Tn,Un){super(wb,r,R,la,Ea,Qa,Pb,xc,ed,jd,bd,Bf,Df,Eh,jk,rk,ul,Tn,Un);this.li=xc.I1f();this.vi=Ce;this.la=tj}EH(r,R){if(!this.zh)N.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.dXa&&R.EE.length)if(r=this.pa.Wd(),1!==r.length)this.li.hE&&this.closeSession(this.li,Og.RU);else{r=r[0];if(this.li.hE){if(this.li.shapeId===r.get_shapeId())return;this.closeSession(this.li,Og.RU)}this.w0a(r)&&this.Vja(this.ua.Ba,r,Xi.selectShape,"")}}xIe(r,R){this.zh?this.li.hE&&this.li.shape===R.shape&&(r=this.li.shape,this.closeSession(this.li,Og.Lqc),this.w0a(r)&&this.Vja(this.ua.Ba,r,Xi.Yib,sc.Lqc)):N.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}IDe(r,
R){R.Bzb&&this.zQ(R.actionId)}AB(){this.li.hE&&this.closeSession(this.li,Og.slideNavigation)}T0(r,R){this.li.hE&&R.c9&&R.shapes&&Array.contains(R.shapes,this.li.shapeId)&&this.closeSession(this.li,Og.YWe)}wIe(r,R){R.correlationId!==this.li.correlationId?N.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.li.correlationId,R.correlationId):this.dag(R,this.li,this.la)}rGe(){this.zh&&this.li.uab&&0===this.li.F1&&!this.fc.$c(this.ua.presentation)&&
(this.li.uab=!1,this.sz.goa(this.li.shape,!0))}Vja(r,R,la,Ea=""){try{const Qa=this.li.NLc(r,R.get_shapeId(),la,Ea,this.la);this.li.s9=!0;this.sz.kuc(this.li.correlationId);this.vi.UYf(r.cid,r.sid,R.get_shapeId(),Qa,la,this.ku.iUc(R),this.ku.hUc(R),void 0,Object(m.a)(this,this.Ygb,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.NGb(Qa,this.li.shapeId,this.li.suggestions,ej.a.pending)}catch(Qa){N.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",Qa.message)}}Ygb(r){N.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",r.HttpStatusCode);return!0}zQ(r){this.zh?this.li.hE&&!this.DZc(r)&&this.closeSession(this.li,Og.PPb+this.fJ.W5(r)):N.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(r,R){r.Zca&&this.sz.goa(r.shape,!0);r.pW(R);this.la.powerPointIdeasIsEnabled&&this.NGb(r.correlationId,r.shapeId,r.suggestions,ej.a.WIa)}}Object(h.a)(ep,"ReplaceObjectManager",Ak,[]);var yp=
d(22);class Qk{constructor(r){this.rO=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Cpe=Array.clone(r)}get_current(){if(-1===this.rO||this.rO>=this.Cpe.length)throw Error.invalidOperation();return this.Cpe[this.rO]}moveNext(){this.rO++;return this.rO<this.Cpe.length}reset(){this.rO=-1}}Object(h.a)(Qk,"ArrayEnumerator",null,[138]);class No{constructor(r){this.UHa=[];this.$$ge=this.getEnumerator;this.Xek=r}getEnumerator(){return new Qk(this.UHa)}[Symbol.iterator](){return Object(yp.a)(this.getEnumerator())}XXc(r,
R){r&&(r.pW(R),Array.remove(this.UHa,r))}Y9a(r){for(const R of this.UHa)if(R.correlationId===r)return R;return null}Z9a(r){for(const R of this.UHa)if(We.a.Kqc(r,R.MY))return R;return null}F5f(r,R){for(const la of this.UHa)if(la.shapeId===r&&(!R&&!la.m6||R&&R===la.m6))return la;return null}d6b(r){return this.F5f(r,null)}I1f(){return 0<this.UHa.length?this.UHa[0]:null}UQa(r,R,la,Ea,Qa,wb){let Pb=this.Z9a(new We.a(r.Cb,R,wb));Pb&&this.XXc(Pb,Og.zdd);Pb=this.Xek(r,R,la,Ea,Qa,wb);Array.add(this.UHa,Pb);
return Pb}NLc(r,R,la,Ea,Qa){return this.UQa(r,R,la,Ea,Qa,null)}get Jrf(){let r=0;this.UHa.forEach(R=>{R.hE&&r++});return r}}Object(h.a)(No,"ReplaceObjectMultipleContextManager",null,[681,137]);class t{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd){this.ua=r;this.sRg=R;this.afk=la;this.ku=wb;this.VHa=Qa;this.rz=Ea;this.vB=Pb;this.Ea=xc;this.Te=ed;this.Fa=jd;this.rr=!1;this.Pyc=-1}get zh(){return this.rr}get Jxb(){return this.Pyc}setup(){this.zh||(this.VHa.K9h(Object(m.a)(this,this.Q1g,"onBeforeReplaceObjectSuggestionApply")),
this.VHa.tai(Object(m.a)(this,this.s5g,"onReplaceObjectSuggestionPointerOver")),this.VHa.sai(Object(m.a)(this,this.r5g,"onReplaceObjectSuggestionPointerOut")),this.rr=!0)}dispose(){this.zh&&(this.VHa.vYk(Object(m.a)(this,this.Q1g,"onBeforeReplaceObjectSuggestionApply")),this.VHa.xZk(Object(m.a)(this,this.s5g,"onReplaceObjectSuggestionPointerOver")),this.VHa.wZk(Object(m.a)(this,this.r5g,"onReplaceObjectSuggestionPointerOut")),this.rr=!1)}Q1g(r,R){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");
(r=this.ua.Ba.vxb(R.MY))&&this.goa(r,!1)}s5g(r,R){this.ua.Ba&&(r=new We.a(this.ua.Ba.Cb,R.shapeId,R.SY),(r=this.ua.Ba.vxb(r))&&this.cZe(r,R.qdg))}r5g(r,R){this.ua.Ba&&(r=new We.a(this.ua.Ba.Cb,R.shapeId,R.SY),(r=this.ua.Ba.vxb(r))&&this.$7b(r))}cZe(r,R){let la=r;r.get_smartArtModelId()&&(la=this.Fa.yr(r));if(r=this.s7f(la))this.Gvh(la,!1),r.cZe(R)}$7b(r){let R=r;r.get_smartArtModelId()&&(R=this.Fa.yr(r));if(r=this.s7f(R))this.Gvh(R,!0),r.$7b()}s7f(r){return r&&!r.get_smartArtModelId()&&Object(D.a)(117,
r.sc(this.Te))?this.afk.ZG(r):null}xSi(r){return r&&Object(D.a)(117,r.sc(this.Te))?this.sRg.ZG(r):null}x9d(r){return r&&Object(D.a)(117,r.sc(this.Te))?this.sRg.IF(r):null}Mqd(r){if(!this.zh)N.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(r){var R=this.xSi(r);if(R){const la=this.rz.Z9a(r.MY);!la||la.Zca&&this.Jxb!==la.shapeId||(la.Zca?this.Jxb===la.shapeId&&(R.qOc(),this.Pyc=-1):(this.goa(r,!0,!(this.vB.l_a&&this.vB.isVisible&&We.a.Kqc(r.MY,
this.vB.l_a.MY))),R.display()),la.Zca=!0)}}}LWk(){if(-1!==this.Jxb&&this.ua.Ba){var r=this.ua.Ba.iT(this.Jxb);r&&this.goa(r,!0)}}goa(r,R,la=!0,Ea=!1){this.zh?r&&(R&&this.$7b(r),la&&this.Dce(r),R=this.x9d(r))&&(Ea?(R.oNc(),this.Pyc=r.get_shapeId()):(this.Jxb===r.get_shapeId()&&(this.Pyc=-1),R.visible&&R.dismiss(),(Ea=this.rz.Z9a(r.MY))&&r.get_shapeId()===Ea.shapeId&&(Ea.Zca=!1))):N.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}kuc(r){this.vB.kuc(r)}ewl(r){if(this.zh)if(this.vB.isVisible){const R=
this.rz.Y9a(r);R&&R.hE&&R.correlationId===r&&this.$7b(R.shape);this.Dce(R.shape)}else this.dZe(r);else N.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}Dce(r){this.vB.isVisible&&this.vB.l_a&&We.a.Kqc(this.vB.l_a.MY,r.MY)&&(this.vB.dismiss(),(r=this.x9d(this.vB.l_a.shape))&&r.root&&(r.root.style.zIndex="0"),this.Ea.Cj(dd.a.Jib,!1))}dZe(r){const R=this.rz.Y9a(r);if(R&&R.correlationId===r&&R.hE){var la=this.x9d(R.shape);if(la){var Ea=la.root;Ea?this.vB.isVisible&&
this.vB.l_a&&!We.a.Kqc(this.vB.l_a.MY,R.MY)||(Ea=this.ku.getBounds(Ea),this.vB.show(r,Ea.x,Ea.y),la.root.style.zIndex=String(z.AFrameworkApplication.Aa.Qqb),this.Ea.Cj(dd.a.Jib,!0),R.Qje=!0):N.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else N.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}ngh(r){this.zh?this.vB.isVisible&&this.dZe(r):N.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}njc(){if(this.zh){var r=
this.vB.h7d();r&&(-1===r?this.vB.Iw(0,!0):(this.vB.Iw(r,!1),this.vB.Iw(r-1,!0)))}else N.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}mjc(){if(this.zh){var r=this.vB.h7d();r+1!==this.vB.dlj()&&(-1===r?this.vB.Iw(0,!0):(this.vB.Iw(r,!1),this.vB.Iw(r+1,!0)))}else N.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}Gvh(r,R){r&&(r=Object(D.a)(117,r.sc(this.Te)))&&((r=r.xa)?r.Qd(R):N.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(h.a)(t,"ReplaceObjectPresenter",null,[709]);class ba{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.YHb=null;this.hKe=0}}Object(h.a)(ba,"TaskItem",null,[]);class ua{constructor(r,R,la){this.efb=[];this.vi=r;this.ku=R;this.ttg=la}gYi(r,R,la){for(let Ea=0;Ea<this.efb.length;Ea++)if(this.efb[Ea].slideSid===r&&this.efb[Ea].slideCid===R&&this.efb[Ea].shapeId===la)return this.efb[Ea];return null}Ioh(r){var R=this.gYi(r.slide.sid,
r.slide.cid,r.shapeId);if(R)return R.YHb=r,R.hKe++,1;const la=Object.assign(new ba,{slideSid:r.slide.sid,slideCid:r.slide.cid,shapeId:r.shapeId,hKe:0,YHb:null});Array.add(this.efb,la);r.s9=!0;R=r.correlationId;const Ea=r.slide,Qa=r.shape;this.vi.UYf(Ea.cid,Ea.sid,Qa.get_shapeId(),R,r.trigger,this.ttg?this.ku.iUc(Qa):this.ku.o6b(Qa),this.ttg?this.ku.hUc(Qa):this.ku.n6b(Qa),()=>{this.O6g(la)},wb=>{this.O6g(la);N.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
wb.HttpStatusCode);return!0});return 0}O6g(r){Array.remove(this.efb,r);r.YHb&&r.YHb.hE&&(N.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",r.YHb.correlationId,r.hKe-1),this.Ioh(r.YHb))}}Object(h.a)(ua,"ReplaceObjectRequestManager",null,[680]);class Ra{constructor(r){this.Awe=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Qp=r}get_current(){return this.Qp}moveNext(){return this.Awe?(this.Awe=!1,!0):!1}reset(){this.Awe=
!0}}Object(h.a)(Ra,"SingleEnumerator",null,[138]);class jb{constructor(r){this.$$ge=this.getEnumerator;this.li=r}getEnumerator(){return new Ra(this.li)}[Symbol.iterator](){return Object(yp.a)(this.getEnumerator())}XXc(r,R){r&&r===this.li&&r.pW(R)}Y9a(){return this.li}Z9a(){return this.li}d6b(){return this.li}F5f(){return this.li}I1f(){return this.li}UQa(r,R,la,Ea,Qa,wb){this.li.UQa(r,R,la,Ea,Qa,wb);return this.li}NLc(r,R,la,Ea,Qa){return this.UQa(r,R,la,Ea,Qa,null)}get Jrf(){return this.li.hE?1:0}}
Object(h.a)(jb,"ReplaceObjectSingleContextManager",null,[681,137]);var w=d(132);class T{constructor(r,R,la,Ea,Qa){this.Xea=null;this.hFb=this.Qre=!1;this.Ama=null;this.visible=!1;this.nu=r;this.NT=R;this.K9=la;this.ku=Qa;this.Pgc=Ea;this.rr=!1}get zh(){return this.rr}setup(){this.zh||(this.Ama=new Wb.a,this.Xea=this.Pgc.aGi(this.Ama.xa),this.NT&&!this.NT.Al&&this.NT.SU&&(this.NT.SU.appendChild(this.Ama),this.Qd(!1),this.hFb=!0,this.NT.rra(this,3),this.visible=this.NT.BQ||this.NT.Un),this.rr=!0)}Jm(){N.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}lD(){}Yp(){if(!this.zh)return N.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.Qre||!this.Xea.zh||!this.Xea.KN)return null;const r=ic.a.Fn(this.Xea.KN.xa.style.left),R=ic.a.Fn(this.Xea.KN.xa.style.top),la=ic.a.Fn(this.Xea.KN.xa.style.width),Ea=ic.a.Fn(this.Xea.KN.xa.style.height);return new w.a(new Vb.a(r,R),new Vb.a(r+la,R),new Vb.a(r+la,R+
Ea),new Vb.a(r,R+Ea))}LN(){return!1}Ox(){}Ty(){}setPosition(){}Ij(){this.hFb=!0;this.Xr()}Qq(){this.hFb=!0;this.Xr()}Xu(){this.hFb=!0;this.Xr()}setZIndex(r){this.Ama&&this.Ama.LB(r)}NE(){}cE(){return null}GB(){return[]}draw(){}dispose(){this.K9();this.zh&&(this.Xea.dispose(),this.Ama.xa.parentNode&&this.Ama.zq(),this.Ama=null,this.rr=!1)}cZe(r){this.zh?(this.Ypc(r),this.Xr()):N.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}$7b(){this.zh?this.Ura():
N.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}Ypc(r){this.zh?(this.Xea.Eoa(r),this.Qd(!0)):N.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}Ura(){this.zh?(this.Xea.dismiss(),this.Qd(!1)):N.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}Xr(){if(this.Qre&&this.hFb){var r=this.ku.o6b(this.nu),R=this.ku.n6b(this.nu);this.lh(r,R);this.Ama&&(r=
this.ku.nhj(this.nu),Fo.a.setRotation(this.Ama.xa,r));this.hFb=!1}}Qd(r){this.Qre=r;this.Ama.Qd(r)}lh(r,R){this.Xea&&this.Xea.lh(r,R)}}Object(h.a)(T,"ReplaceObjectSuggestionPreviewView",null,[962,963,430,431,106,709]);var ea=d(267),ra=d(225),wa=d(252),Za=d(997),ub=d(996);class zb extends Sys.EventArgs{constructor(r){super();this.shape=r}}Object(h.a)(zb,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class tc{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd){this.vTg=!1;this.v$=this.wWa=null;this.ia=
Qa;this.Le=wb;this.qd=Pb;this.rz=xc;this.WHa=ed;this.Pgc=Ea;this.K9=la;this.nu=r;this.NT=R;this.iA=!1;this.la=jd;this.zAe=bd;this.rr=this.visible=!1}get zh(){return this.rr}zwb(){return this.rz.Z9a(this.nu.MY)}setup(){if(!this.zh){var r=this.zwb();r=r?r.F1:0;this.vTg=1===r;this.v$=new Wb.a;this.wWa=this.Pgc.tDi(this.v$,tc.BIc,Object(m.a)(this,this.ktk,"onFlyoutAnchorClick"),Object(m.a)(this,this.ltk,"onFlyoutAnchorHover"),r);this.NT&&!this.NT.Al&&this.NT.SU&&(this.Jm(this.NT.SU),this.NT.rra(this,
3));this.rr=!0}}qOc(){this.zh?this.wWa&&this.wWa.qOc():N.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}oNc(){this.zh?this.wWa&&this.wWa.oNc():N.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.zh)N.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.Xr();this.wWa.show();this.visible=!0;this.sPb();var r=this.zwb();if(r){r.Fje=!0;const R=new Date;r.VLa||
(r.VLa=R);r.rtc=R;N.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",r.trigger,r.correlationId)}}}get root(){return this.zh?this.v$.xa:(N.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.zh){this.wWa.dismiss();this.visible=!1;var r=this.zwb();r&&(r.Zca=!1,r.rtc&&(r.Kvb+=+new Date-+r.rtc,N.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
r.Kvb,r.rtc,r.trigger,r.correlationId)))}else N.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Jm(){this.visible=!1;this.Le.addCssClass(this.v$.xa,"replaceObjectBody");document.body.appendChild(this.v$.xa);this.qd.OYb(Object(m.a)(this,this.onResize,"onResize"));this.Xr()}lD(){}Yp(){return null}LN(){return!1}Ox(){}Ty(){}setPosition(){}Ij(){}Qq(){}Xu(){}setZIndex(){}NE(r){if(this.zh){if(r)this.visible=!1,this.sPb();else if(this.iA){const R=new zb(this.nu);this.WHa.tOk(R)}this.iA=
r}else N.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}cE(){return null}GB(){return[]}draw(){this.zh?this.Xr():N.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.K9();this.zh&&(this.qd.Xih(Object(m.a)(this,this.onResize,"onResize")),this.v$&&(this.v$.xa.parentNode&&this.v$.zq(),this.Le.removeCssClass(this.v$.xa,"replaceObjectBody")),this.dismiss(),this.wWa.dispose(),this.v$=null,this.rr=!1)}sPb(){this.v$.xa.style.visibility=
this.visible?qb.a.visible:qb.a.hidden;const r=this.zwb();r&&(r.Zca=this.visible)}Xr(){let r=null;var R=this.NT.SU;R&&(r=this.Le.$h(R.xa));r?(R=r.x-(tc.BIc+10),this.vTg&&this.NT&&this.NT.Md&&(R=this.NT.Md.Ld.Pe(this.nu.rx,0),R=r.x+R+10),Fo.a.Zod(this.v$.xa,1),this.v$.setPosition(1*R,r.y),this.mCl(1*R,r.y)):N.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}mCl(r,R){if(this.zAe.isVisible){var la=this.zwb(),Ea=this.zAe.l_a;Ea&&la&&Ea.correlationId===la.correlationId&&
this.zAe.updatePosition(r,R)}}ktk(r){if(r.sA!==Sys.UI.MouseButton.leftButton)return!1;this.ia.La(ab.a.z0a,2,Object.assign(new Tm,{shape:this.nu,action:0}));return!0}ltk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const r=this.zwb();if(r&&1===r.F1)return!1;this.ia.La(ab.a.z0a,2,Object.assign(new Tm,{shape:this.nu,action:1}));return!0}onResize(r,R){this.visible&&(r=null,R&&R.oG&&(r=R.oG.Fd),r&&r.Cb.equals(this.nu.slideId)&&this.Xr())}}tc.BIc=32;Object(h.a)(tc,"ShapeReplaceObjectView",null,
[707,708,430,431,106,709]);var pc=d(647);class bc{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce){this.BXa=this.Cea=this.DXa=this.j5=this.Bo=null;this.Tad=0;this.gve=-1;this.vq=this.li=null;this.Le=r;this.Zc=la;this.qp=R;this.ua=Ea;this.ia=Qa;this.oE=ed;this.WHa=wb;this.rz=Pb;this.m0=xc;this.Ea=jd;this.la=bd;this.Wfk=!Ce.Tj;this.rr=this.Hob=!1}get zh(){return this.rr}get isVisible(){return this.Hob}get l_a(){return this.li}setup(){this.zh||(this.Bo=ic.a.Ie(),this.Bo.setAttribute("Unselectable","on"),
this.Bo.style.position=qb.a.absolute,this.Le.addCssClass(this.Bo,"replaceObjectContainer"),this.uSe(null),document.body.appendChild(this.Bo),this.Zna(),this.oE.X8(dd.a.Jib,dd.a.gj,this.Bo,()=>{},()=>{},!0),this.rr=!0)}dispose(){this.zh&&(this.dismiss(),this.cuc(),this.Bo&&this.Bo.parentNode&&this.Bo.parentNode.removeChild(this.Bo),this.rr=!1)}dismiss(){this.zh?(z.AFrameworkApplication.Aa.PRa(!0),this.setVisibility(!1),this.gGb.style.display=qb.a.none,this.gGb.style.zIndex="-1",this.BXa=this.Cea=null,
this.uSe(null)):N.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(r,R,la){if(!this.zh)N.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!db.a.Wa(r)){var Ea=this.rz.Y9a(r);Ea&&Ea.correlationId===r&&Ea.hE&&!Ea.s9&&(this.li=Ea,this.eGk(r,this.li.suggestions),this.Tad=this.li.cV,this.Pkh(),z.AFrameworkApplication.Aa.eQa(!0),this.gGb.style.zIndex=String(z.AFrameworkApplication.Aa.jra),this.Bo.style.zIndex=String(z.AFrameworkApplication.Aa.Qqb),
this.gGb.style.visibility=qb.a.hidden,this.gGb.style.display=qb.a.block,this.gGb.style.visibility=qb.a.visible,this.Uka()?this.Le.addCssClass(this.Bo,"replaceIconObjectContainer"):this.Le.removeCssClass(this.Bo,"replaceIconObjectContainer"),this.updatePosition(R,la),this.setVisibility(!0))}}updatePosition(r,R){let la,Ea;this.setPosition(0,0);if(this.Uka()){la=r+tc.BIc+7;Ea=R;const Qa=pc.a(0,0);la+this.Bo.offsetWidth>Qa.width&&(la=r+tc.BIc-this.Bo.offsetWidth,Ea=R-7-this.Bo.offsetHeight)}else la=r,
Ea=R-7-this.Bo.offsetHeight;this.setPosition(la,Ea)}dlj(){return this.zh?this.Tad:(N.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}h7d(){return this.zh?this.isVisible?this.Bo?this.Bo.querySelector(".replaceObjectSuggestionsList")?this.gve:(N.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(N.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(N.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}Iw(r,R){if(!this.zh)N.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>r)&&this.isVisible)if(this.Bo)if(r>=this.Tad)N.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.Tad,r);else{var la=this.Bo.querySelector(".replaceObjectSuggestionsList");
la?(la=la.children)?(la=la[r])?R?(this.gve=r,ec.FocusManager.Wr(la)&&this.Vvh(la.firstChild)):(this.Pkh(),ec.FocusManager.yyl(la)&&this.gcg(la.firstChild)):N.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):N.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):N.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else N.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}kuc(r){this.DXa&&(this.DXa.className="ReplaceObjectCorrelation "+r)}eGk(r,R){this.uSe(r);if(r=this.pHi(r,R))R=this.oHi(),this.Bo.appendChild(R),this.Bo.appendChild(r),this.Uka()&&(r=this.nHi(),this.Bo.appendChild(r))}uSe(r){this.Bo&&(this.j5&&(this.Zc.yb(ha.a.click,this.j5,Object(m.a)(this,this.d4g,"onLinkClick")),this.j5=null),this.Le.Au(this.Bo),this.DXa=ic.a.Ie(),this.DXa.setAttribute("Unselectable",
"on"),this.DXa.className=db.a.Wa(r)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+r,this.DXa.style.position=qb.a.absolute,this.DXa.style.display=qb.a.none,this.Bo.appendChild(this.DXa),this.Bo.style.zIndex="-1")}oHi(){const r=ic.a.Qn();r.setAttribute("Unselectable","on");this.Uka()?(r.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.Le.addCssClass(r,"replaceIconObjectContainerTitle")):(r.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.Le.removeCssClass(r,
"replaceIconObjectContainerTitle"));this.Le.addCssClass(r,"UIFont replaceObjectContainerTitle");return r}pHi(r,R){if(db.a.Wa(r))return N.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!R||!R.length)return N.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const la=ic.a.E1b();la.id=r;la.setAttribute("Unselectable","on");la.setAttribute(pa.a.ef,pa.a.Tfi);
this.Le.addCssClass(la,"replaceObjectSuggestionsList");this.Cea||(this.Cea=new xe.a);this.BXa||(this.BXa=new xe.a);for(var Ea of R)db.a.Wa(Ea.imageData)||this.Cea.$(Ea.index,Ea.imageData),this.Uka()&&!db.a.Wa(Ea.renderData)&&this.BXa.$(Ea.index,Ea.renderData),r=this.bki(Ea.index,Ea.labelText),la.appendChild(r);if(this.Wfk&&0<this.BXa.count&&this.Uka()&&(db.a.Wa(this.li.kjb)&&(this.li.kjb=Ki.a.create().toString()),(Ea=Rn.a.b$a(this.li.kjb))&&!Ea.hasChildNodes())){Ea.style.position=qb.a.absolute;Ea.style.left=
"0px";Ea.style.top="0px";for(let Qa of this.BXa.values)r=ic.a.RA(),r.src=Qa,r.style.display=qb.a.block,r.style.position=qb.a.absolute,Ea.appendChild(r);Rn.a.IZb()}return la}nHi(){this.j5=ic.a.Qn();this.j5.setAttribute("Unselectable","on");this.j5.setAttribute("tabindex","-1");this.j5.setAttribute(pa.a.ef,pa.a.zRd);this.Le.addCssClass(this.j5,"UIFont replaceObjectContainerLink");this.Uka()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.jab&&(this.j5.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.Zc.pb(ha.a.click,this.j5,Object(m.a)(this,this.d4g,"onLinkClick")));const r=ic.a.Ie();r.appendChild(this.j5);return r}Zna(){this.Bo&&(this.Zc.pb(ha.a.click,this.Bo,Object(m.a)(this,this.onClick,"onClick")),this.m0.addHandler(this.Bo,ha.a.Yf,Object(m.a)(this,this.fXc,"inputKeyApplyHandler")),this.qp.pb(ha.a.pointerOver,this.Bo,Object(m.a)(this,this.cD,"onPointerOver")),this.qp.pb(ha.a.pointerOut,this.Bo,Object(m.a)(this,this.yz,"onPointerOut")))}cuc(){this.Bo&&(this.Zc.yb(ha.a.click,this.Bo,Object(m.a)(this,
this.onClick,"onClick")),this.m0.removeHandler(this.Bo,ha.a.Yf,Object(m.a)(this,this.fXc,"inputKeyApplyHandler")),this.qp.yb(ha.a.pointerOver,this.Bo,Object(m.a)(this,this.cD,"onPointerOver")),this.qp.yb(ha.a.pointerOut,this.Bo,Object(m.a)(this,this.yz,"onPointerOut")))}cD(r){r=this.x$d(r.Ec);this.Vvh(r);return!0}yz(r){r=this.x$d(r.Ec);this.gcg(r);return!0}fXc(r){if(this.isVisible&&!r.ctrlKey&&!r.altKey&&(!r.shiftKey||r.keyCode===Ba.a.Sq&&this.Uka()))if(r.keyCode===Ba.a.tq||r.keyCode===Ba.a.pP)r.preventDefault(),
(r=this.Bo.querySelector(":focus"))&&r.firstChild.click();else if(r.keyCode===Ba.a.Sq&&this.Uka()){const R=this.Bo.querySelector(":focus");R&&this.j5&&(R===this.j5?(r.preventDefault(),r.stopPropagation(),this.Iw(0,!0)):R.parentNode&&R.parentNode.className&&0<=R.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(r.preventDefault(),r.stopPropagation(),this.Iw(this.h7d(),!1),ec.FocusManager.Wr(this.j5)))}}onClick(r){if(r.sA!==Sys.UI.MouseButton.leftButton)return!1;var R=this.x$d(r.Ec);if(!this.eme(R)||
!this.aVj(R))return!0;r=this.G6i(R);const la=this.C6b(R);R=this.glj(R);db.a.Wa(r)||db.a.Wa(la)||(r=Object.assign(new Lo.a,{SuggestionSid:parseInt(la),ShapeId:this.li.shapeId,CorrelationId:r,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,Label:R,SmartArtSubNodeId:this.li.m6?this.li.m6:null,ReplaceObjectType:this.li.F1}),this.ia.La(ab.a.RPa,2,r));return!0}d4g(){this.li&&(this.li.Apc=!0);this.Yae();this.ia.processAction(ab.a.U6a,2);return!0}Vvh(r){r&&this.eme(r)&&(r=this.C6b(r),db.a.Wa(r)||
(r=this.Uka()?this.BXa.Hb(r)?this.BXa.ga(r):"":this.Cea.Hb(r)?this.Cea.ga(r):"",db.a.Wa(r)||(r=new ub.a(this.li.shapeId,r,this.li.m6),this.WHa.reh(r))))}gcg(r){r&&this.eme(r)&&(r=new Za.a(this.li.shapeId,this.li.m6),this.WHa.qeh(r))}x$d(r){if(!r)throw Error.argumentNull("sourceElement");return"a"===r.nodeName.toLowerCase()?r:r.parentNode}G6i(r){return r?r.parentNode.parentNode.id:null}C6b(r){if(!r)return null;r=r.id.split("_");return 2!==r.length?null:r[1]}glj(r){return r?r.title:null}eme(r){return!!r&&
!db.a.Wa(r.className)&&-1!==r.className.indexOf("ObjectSuggestionContainer")}aVj(r){return!!r&&!db.a.Wa(r.className)&&-1===r.className.indexOf("ReplaceObjectSuggestionLoading")}bki(r,R){const la=this.Cea.Hb(r);var Ea=la?this.Cea.ga(r):Ue.a.XK(ac.a.Rna);la||N.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Qa=ic.a.RA();Qa.setAttribute("Unselectable","on");Qa.src=Ea;Qa.title=R;Qa.setAttribute(pa.a.ef,pa.a.nN);this.Le.addCssClass(Qa,"replaceObjectSuggestionThumbnail");
Ea=ic.a.Eca();Ea.id="ROS_"+r;Ea.setAttribute("Unselectable","on");Ea.title=R;Ea.setAttribute(pa.a.ef,"none");let wb=this.Uka()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.li.DT&&this.li.uHc.toString()===r&&(wb+="Selected");this.Le.addCssClass(Ea,wb);la||this.Le.addCssClass(Ea,"ReplaceObjectSuggestionLoading");Ea.appendChild(Qa);r=this.Le.iKf();r.setAttribute("Unselectable","on");r.setAttribute("tabindex","-1");r.setAttribute(pa.a.ef,pa.a.nN);r.setAttribute(pa.a.ns,
R);r.appendChild(Ea);return r}setPosition(r,R){this.zh?(0>r&&(r=0),0>R&&(R=0),this.Bo.style.left=this.Le.Pc(r),this.Bo.style.top=this.Le.Pc(R)):N.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(r){if(this.Bo){if(this.li)if(r)this.li.O1e=new Date,this.li.ckk();else{let R;(R=this.li).isc=R.isc+(+new Date-+this.li.O1e)}this.Bo.style.visibility=r?qb.a.visible:qb.a.hidden;this.Hob=r;this.Ea.Cj(dd.a.Jib,r)}}Pkh(){this.gve=-1}Uka(){return!!this.li&&
1===this.li.F1}get gGb(){this.vq&&"undefined"!==typeof this.vq||(this.vq=this.Le.Ie(),this.vq.setAttribute("id","ModalDiv"),this.Le.addCssClass(this.vq,"cui-modalDiv"),this.vq.setAttribute("Unselectable","on"),document.body.appendChild(this.vq),ea.a.instance.pb(ha.a.pointerDown,this.vq,Object(m.a)(this,this.ufd,"onModalPointerDown")),ea.a.instance.pb(ha.a.CR,this.vq,Object(m.a)(this,this.vfd,"onModalPointerUp")),ea.a.instance.pb(ha.a.Hlc,this.vq,Object(m.a)(this,this.fvk,"onModalPointerMove")),ea.a.instance.pb(ha.a.pointerOut,
this.vq,Object(m.a)(this,this.gvk,"onModalPointerOut")),ra.a.instance.pb(ha.a.click,this.vq,Object(m.a)(this,this.evk,"onModalClick")),wa.a.instance.pb(ha.a.kGb,this.vq,Object(m.a)(this,this.cIe,"onModalMouseWheel")));return this.vq}ufd(){return!0}vfd(){return this.Yae()}fvk(){return!0}gvk(){return!0}evk(){return this.Yae()}cIe(){return!0}Yae(){if(!this.li||!this.li.slide)return!0;const r=this.li.shape;if(!r)return!0;this.ia.La(ab.a.z0a,2,Object.assign(new Tm,{action:2,shape:r}));return!0}}Object(h.a)(bc,
"ReplaceObjectSuggestionsGalleryView",null,[678,709]);class yc{constructor(r,R,la,Ea){this.bfk=r;this.ku=R;this.ua=la;this.la=Ea}i3i(r){if(!this.ua.Ba)return!1;r=this.ua.Ba.iT(r);return this.Ouc(r)}Ouc(r){return!(r&&r.get_shapeId()&&r.hasText&&this.ku.LFa(r))||r.get_shapeRotation()||r.As||r.h4||r.px||!this.bfk.validate(r)?!1:!0}fXj(r){return!Array.contains(this.la.replaceObjectDisabledTriggers,r)}}Object(h.a)(yc,"ReplaceObjectValidationHelper",null,[]);class $c{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed){this.Kr=
this.h0=null;this.rr=!1;this.QX=r;this.Zc=R;this.qp=la;this.AO=Ea;this.Rea=Qa;this.qe=Pb;this.la=wb;this.$bb=ed}get zh(){return this.rr}oNc(){this.la.sKb?this.Kr.setAttribute("Src",this.qe.qk("BLUEBOLT_Deactivated.gif")):this.Kr.style.opacity=".3";this.$bb.Nph(Object(m.a)(this,this.dismiss,"dismiss"))}qOc(){this.la.sKb?this.Kr.setAttribute("Src",this.qe.qk("BLUEBOLT_Reactivated.gif")):this.Kr.style.opacity="initial";this.$bb.disabled=!1}show(){this.la.sKb?this.Kr.setAttribute("Src",this.qe.qk("BLUEBOLT_Entrance.gif")):
this.Kr.setAttribute("Src",this.qe.qk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.sKb?(this.Kr.setAttribute("Src",this.qe.qk("BLUEBOLT_Exit.gif")),this.$bb.zal(()=>{this.QX.xa.style.visibility=qb.a.hidden})):(this.Kr.setAttribute("Src",""),this.QX.xa.style.visibility=qb.a.hidden)}setup(){this.zh||(this.QX?(this.h0=new Wb.a,this.h0.xa.style.visibility=qb.a.inherit,this.h0.xa.style.position=qb.a.absolute,this.Kr=ic.a.RA(),this.Kr.setAttribute("Unselectable","on"),this.Kr.setAttribute(pa.a.ef,
pa.a.nN),this.Kr.className="gifFloatie",this.h0.xa.appendChild(this.Kr),this.QX.appendChild(this.h0),this.Zna()):N.a.J(38072903,829,15,"parentElement is null"),this.rr=!0)}I3g(r){let R;switch(this.la.replaceObjectIconType){case 7:R="BLUEBOLT_Hover_on.gif";break;case 8:R="BLUEBOLT_HoverWhite_On.gif";break;default:R="BLUEBOLT_Hover_on.gif"}this.Kr.setAttribute("Src",this.qe.qk(R));return this.Rea(r)}onBlur(){let r;switch(this.la.replaceObjectIconType){case 7:r="BLUEBOLT_Hover_off.gif";break;case 8:r=
"BLUEBOLT_HoverWhite_Off.gif";break;default:r="BLUEBOLT_Hover_off.gif"}this.Kr.setAttribute("Src",this.qe.qk(r));return!0}Zna(){this.AO&&this.Zc.pb(ha.a.click,this.Kr,this.AO);this.Rea&&(this.qp.pb(ha.a.pointerOver,this.Kr,Object(m.a)(this,this.I3g,"onHover")),this.qp.pb(ha.a.pointerOut,this.Kr,Object(m.a)(this,this.onBlur,"onBlur")))}a4e(){this.AO&&this.Zc.yb(ha.a.click,this.Kr,this.AO);this.Rea&&(this.qp.yb(ha.a.pointerOver,this.Kr,Object(m.a)(this,this.I3g,"onHover")),this.qp.yb(ha.a.pointerOut,
this.Kr,Object(m.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.a4e();this.rr=!1}}Object(h.a)($c,"GifFlyoutAnchor",null,[981,709]);class gd{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df){this.Kr=this.Ev=null;this.QX=r;this.bU=R;this.B9j=la;this.H9j=Ea;this.iAg=Ce.replaceObjectIconType;this.jsg=Ce.replaceObjectAnimId;this.ksg=Ce.sKb;this.hIa=wb;this.Pgc=Qa;this.Zc=Pb;this.qp=xc;this.AO=ed;this.Rea=jd;this.Le=bd;this.Rgk=Bf;this.$bb=Df;this.rr=!1}get w2b(){return 1===this.Rgk?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.$bb.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get zh(){return this.rr}setup(){this.zh||(this.Ev=new Wb.a,this.Kr=this.Pgc.$Fi(),this.Ev.xa.style.visibility=qb.a.inherit,this.Sia(),this.rr=!0)}oNc(){this.$bb.Nph(Object(m.a)(this,this.dismiss,"dismiss"));this.Ura();this.Ypc();this.Ev.lzi()||this.Ev.ur("replaceObjectGrayedFlyoutAnchor")}show(){this.zh?this.Ypc(this.ksg):N.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}qOc(){this.$bb.disabled=
!1;this.Ura();this.Ypc();this.Ev.zib("replaceObjectGrayedFlyoutAnchor")}Ypc(r=!1){this.zh?this.Kr.Eoa(this.p$i(r),""):N.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}p$i(r){const R=this.hIa.MXd(this.bU,this.bU,this.B9j,this.H9j,this.w2b,null);this.Le.addCssClass(this.Ev.xa,"replaceObjectFlyoutAnchorBase");this.Le.addCssClass(this.Ev.xa,"replaceObjectFlyoutAnchor"+this.iAg);r&&(this.Le.addCssClass(this.Ev.xa,"replaceObjectFlyoutAnchorAnimBase"),this.Le.addCssClass(this.Ev.xa,
"replaceObjectFlyoutAnchorAnim"+this.jsg));return R}Ura(){this.zh?(this.Kr.clear(),this.Le.removeCssClass(this.Ev.xa,"replaceObjectFlyoutAnchorBase"),this.Le.removeCssClass(this.Ev.xa,"replaceObjectFlyoutAnchor"+this.iAg),this.ksg&&(this.Le.removeCssClass(this.Ev.xa,"replaceObjectFlyoutAnchorAnimBase"),this.Le.removeCssClass(this.Ev.xa,"replaceObjectFlyoutAnchorAnim"+this.jsg))):N.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.zh&&(this.a4e(),this.Ev&&
this.Ev.xa.parentNode&&this.Ev.zq(),this.dismiss(),this.Kr.dispose(),this.Ev=null,this.rr=!1)}dismiss(){this.zh?(this.Ura(),this.QX.xa.style.visibility=qb.a.hidden):N.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}Sia(){this.QX?(this.Ev.xa.style.width=this.Le.Pc(this.bU),this.Ev.xa.style.height=this.Le.Pc(this.bU),this.Ev.xa.setAttribute(pa.a.ef,pa.a.yu),this.QX.appendChild(this.Ev),this.Kr.Sia(this.Ev.xa),this.Zna()):N.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Kgb(){return!0}Zna(){this.AO&&
this.Zc.pb(ha.a.click,this.Ev.xa,this.AO);this.Zc.pb(ha.a.doubleClick,this.Ev.xa,Object(m.a)(this,this.Kgb,"onDoubleClick"));this.Rea&&(this.qp.pb(ha.a.pointerOver,this.Ev.xa,this.Rea),this.qp.pb(ha.a.pointerOver,this.Ev.xa.firstChild,this.Rea),this.qp.pb(ha.a.pointerOver,this.Ev.xa.firstChild.firstChild,this.Rea))}a4e(){this.AO&&this.Zc.yb(ha.a.click,this.Ev.xa,this.AO);this.Zc.yb(ha.a.doubleClick,this.Ev.xa,Object(m.a)(this,this.Kgb,"onDoubleClick"));this.Rea&&(this.qp.yb(ha.a.pointerOver,this.Ev.xa,
this.Rea),this.qp.yb(ha.a.pointerOver,this.Ev.xa.firstChild,this.Rea),this.qp.yb(ha.a.pointerOver,this.Ev.xa.firstChild.firstChild,this.Rea))}}Object(h.a)(gd,"ReplaceObjectFlyoutAnchor",null,[981,709]);class md{constructor(r,R){this.Hz=null;this.hi=r;this.Le=R;this.rr=!1}get zh(){return this.rr}get KN(){return this.Hz}setup(){this.zh||(this.Hz=new Wb.a,this.Sia(),this.rr=!0)}Sia(){this.hi?(this.hi.appendChild(this.KN.xa),this.Le.addCssClass(this.KN.xa,"replaceObjectPreviewContainer"),this.KN.setVisibility(!1)):
N.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}Eoa(r){if(this.zh){if(r=this.pja(r))this.doa(),this.KN.xa.appendChild(r),this.KN.setVisibility(!0)}else N.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}lh(r,R){this.zh?this.KN.lh(r,R):N.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.zh&&(this.dismiss(),this.KN&&this.KN.xa.parentNode&&(this.KN.zq(),this.Le.removeCssClass(this.KN.xa,
"replaceObjectPreviewContainer")),this.Hz=null)}dismiss(){this.zh?(this.doa(),this.KN.setVisibility(!1)):N.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}pja(r){if(!db.a.Wa(r)){const R=ic.a.RA();R.setAttribute("Unselectable","on");R.src=r;R.style.height="100%";R.style.width="100%";return R}return null}doa(){this.KN.xa.firstChild&&this.KN.xa.removeChild(this.KN.xa.firstChild)}}Object(h.a)(md,"ReplaceObjectPreviewImageView",null,[709]);var Sc=d(692);class Zd{constructor(r,
R,la,Ea,Qa,wb,Pb){this.Zc=r;this.qp=R;this.Le=la;this.hIa=Ea;this.la=Qa;this.qe=wb;this.syg=Pb}tDi(r,R,la,Ea,Qa){r=gk.PGl(this.la.replaceObjectIconType,Qa)?new $c(r,this.Zc,this.qp,la,Ea,this.la,this.qe,this.Le,this.syg):new gd(r,R,"per","PowerPointDesigner_32x32x32",this,this.hIa,this.Zc,this.qp,la,Ea,this.Le,this.la,Qa,this.syg);r.setup();return r}aGi(r){r=new md(r,this.Le);r.setup();return r}$Fi(){return new Sc.a(this.Le)}}Object(h.a)(Zd,"ReplaceObjectViewFactory",null,[]);class Pe{constructor(r,
R,la){this.Le=r;this.ua=la;this.VTg=R}iUc(r){if(!r)throw Error.argumentNull("shape");var R=r.OU;r=this.Otb(R.TopLeft);R=this.Otb(R.TopRight);return Vb.a.nm(r,R)}hUc(r){if(!r)throw Error.argumentNull("shape");var R=r.OU;r=this.Otb(R.TopRight);R=this.Otb(R.BottomRight);return Vb.a.nm(r,R)}o6b(r){return this.iUc(r)*this.N8f()}n6b(r){return this.hUc(r)*this.N8f()}nhj(r){if(!r)throw Error.argumentNull("shape");var R=r.OU;r=this.Otb(R.TopLeft);R=this.Otb(R.TopRight);return Gb.a.YO(Vb.a.MG(r,R))}iZf(){return this.getBounds(this.VTg.Ic.JB)}getBounds(r){return this.Le.$h(r)}N8f(){const r=
this.VTg.Ic;return r?r.qT:1}Otb(r){return new Vb.a(r.X,r.Y)}LFa(r){return r?!!this.ua.Ba&&this.ua.Ba.Cb.equals(r.slideId):!1}}Object(h.a)(Pe,"ReplaceObjectViewHelper",null,[]);var qe=d(440);class cg{constructor(r,R,la){this.z0=this.W_=null;this.OT=r;this.Zek=R;this.m$c=la}get tG(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get esb(){this.W_||
(this.W_=Object.assign(new hn.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:qe.a.cXe,outputSchema:qe.a.cXe,func:Object(m.a)(this,this.Dbb,"lambdaBeforeFunc")}));return this.W_}get qrb(){return null}get bKb(){this.z0||(this.z0=Object.assign(new hn.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:qe.a.cXe,outputSchema:"ShapeTextConvertable",func:Object(m.a)(this,this.ane,"lambdaRemoteFunc")}));return this.z0}Dbb(r,R,la){if(r&&this.Zek.qje())if(r){try{var Ea=oe.a(r.ContextId)}catch(Qa){N.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.tG);la(null);return}this.m$c.fXj(Ea.t)?this.m$c.i3i(Ea.shapeId)?la(r):(N.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.tG),la(null)):(N.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.tG),la(null))}else la(null),N.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.tG);else N.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.tG),la(null)}ane(r,R,la){r?
r?this.OT.execute(Ea=>{Ea.Joc(r.Topic,r.Data,r.ContextId,Qa=>{this.yKa(Qa)},Qa=>{this.wKa(Qa)},la)}):la(null):la(null)}yKa(r){if(!z.AFrameworkApplication.Ug&&r&&r.data){var R=r.data.state;if(R){try{var la=oe.a(r.data.Sd)}catch(Ea){R(null);N.a.J(36804442,375,10,"Try parse aug response failed:{0}",Ea.message);return}R(la)}}}wKa(r){!z.AFrameworkApplication.Ug&&r&&r.data&&(r=r.data.state)&&r(null)}}Object(h.a)(cg,"ReplaceObjectWacALWorkflow",null,[960]);class mg{constructor(){this.tFe=null}Ouc(r){return this.validate(r)?
this.tFe?this.tFe.Ouc(r):!0:!1}Fbl(r){this.tFe=r}}Object(h.a)(mg,"ReplaceObjectWall",null,[]);class Zf extends mg{constructor(){super();this.ku=null}p6f(r){const R=this.ku.o6b(r);r=this.ku.n6b(r);var la=R*r;const Ea=this.ku.iZf().width,Qa=this.ku.iZf().height;la=la/(Ea*Qa)*100;N.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",R,r,Ea,Qa,la);return la}}Object(h.a)(Zf,"AreaRatioWall",mg,[]);class Sj extends Zf{constructor(r,
R){super();this.nbk=r;this.ku=R}validate(r){return this.p6f(r)<=this.nbk}}Object(h.a)(Sj,"MaxAreaRatio",Zf,[]);class Rk extends mg{constructor(r,R){super();this.kbk=r;this.ku=R}validate(r){return this.ku.n6b(r)<=this.kbk}}Object(h.a)(Rk,"MaxShapeHeight",mg,[]);class Fj extends mg{constructor(r,R){super();this.pbk=r;this.ku=R}validate(r){return this.ku.o6b(r)<=this.pbk}}Object(h.a)(Fj,"MaxShapeWidth",mg,[]);class Si extends Zf{constructor(r,R){super();this.Dbk=r;this.ku=R}validate(r){return this.p6f(r)>=
this.Dbk}}Object(h.a)(Si,"MinAreaRatio",Zf,[]);var nk=d(40);class Dk extends mg{constructor(r,R){super();this.Cbk=r;this.Fa=R}validate(r){return this.Eej(r,this.Fa)>=this.Cbk}Eej(r,R){if(!r)return 0;let la=0;R.LJ(r,Ea=>{Ea.Sa(nk.a.pq)&&(Ea=Ea.eb(nk.a.pq))&&0<Ea.length&&la++});return la}}Object(h.a)(Dk,"MinParagraphCount",mg,[]);class Zj extends mg{constructor(r,R){super();this.Abk=r;this.ku=R}validate(r){return this.ku.n6b(r)>=this.Abk}}Object(h.a)(Zj,"MinShapeHeight",mg,[]);class Al extends mg{constructor(r,
R){super();this.Gbk=r;this.ku=R}validate(r){return this.ku.o6b(r)>=this.Gbk}}Object(h.a)(Al,"MinShapeWidth",mg,[]);class ak{constructor(r,R,la){this.jfa=null;this.la=r;this.Fa=R;this.SFb=la;this.init(this.la.replaceObjectClientWalls)}validate(r){return this.jfa?this.jfa.Ouc(r):!0}init(r){r=this.ZHi(r);this.Bli(r)}ZHi(r){const R={};if(db.a.Wa(r))return R;r=r.split(";");for(const la of r)db.a.Wa(la)||(r=la.split(":"),2===r.length?R[r[0]]=r[1]:N.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
la));return R}Bli(r){const R=[];"MinParagraphCount"in r&&Array.add(R,new Dk(cj.d(r,"MinParagraphCount",0),this.Fa));"MinShapeHeight"in r&&Array.add(R,new Zj(cj.b(r,"MinShapeHeight",0),this.SFb));"MaxShapeHeight"in r&&Array.add(R,new Rk(cj.b(r,"MaxShapeHeight",Number.MAX_VALUE),this.SFb));"MinShapeWidth"in r&&Array.add(R,new Al(cj.b(r,"MinShapeWidth",0),this.SFb));"MaxShapeWidth"in r&&Array.add(R,new Fj(cj.b(r,"MaxShapeWidth",Number.MAX_VALUE),this.SFb));"MinShapeAreaRatio"in r&&Array.add(R,new Si(cj.b(r,
"MinShapeAreaRatio",0),this.SFb));"MaxShapeAreaRatio"in r&&Array.add(R,new Sj(cj.b(r,"MaxShapeAreaRatio",Number.MAX_VALUE),this.SFb));for(r=0;r<R.length-1;r++)R[r].Fbl(R[r+1]);0<R.length&&(this.jfa=R[0])}}Object(h.a)(ak,"ReplaceObjectWalls",null,[679]);class io{constructor(){this.K=null;this.uO=this.Hwe=this.ixe=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Zb(r){this.K=r;(this.uO=this.K.resolve("PowerPointWebEditor.IApplicationContext").od.vg)&&this.K.register(On.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>
new On.a(z.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));r.register(Uk,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().oa(()=>
new Uk);r.register(Pe,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().oa(()=>new Pe(r.resolve("PowerPoint.IBrowserHelperManager"),r.resolve("PowerPointWebEditor.IActiveSlideViewManager"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));r.register(678,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().oa(()=>new bc(r.resolve("PowerPoint.IBrowserHelperManager"),r.resolve("Common.IPointerInputManager"),r.resolve("Common.IClickInputManager"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
r.resolve("Common.IActionManagerExtended"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),r.resolve("PowerPointWebEditor.IInputHandlerManager"),r.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),r.resolve("PowerPointWebEditor.IFocusManager"),r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("Common.IBrowserUtils")));r.register(679,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().oa(()=>
new ak(r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("PowerPointWebEditor.IShapeReader"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));r.register(yc,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().oa(()=>new yc(r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),r.resolve("PowerPointWebEditor.IApplicationSettings")));
r.register(680,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().oa(()=>new ua(r.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),r.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));r.register(681,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().oa(()=>r.resolve("Common.IAppSettingsManager").ka("473")?new No((R,la,Ea,
Qa,wb,Pb)=>{const xc=new ro(r.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),r.Ja("PowerPointWebEditor.IDesignerServiceProvider"));xc.UQa(R,la,Ea,Qa,wb,Pb);return xc}):new jb(new ro(r.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),r.Ja("PowerPointWebEditor.IDesignerServiceProvider"))));r.register(682,"PowerPointWebEditor.IReplaceObjectManager").ma().oa(()=>r.resolve("Common.IAppSettingsManager").ka("473")?new dm(r.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),
r.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),r.resolve("PowerPointWebEditor.IFocusManager"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),r.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),r.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),r.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),r.resolve("PowerPointWebEditor.IPptSelectionManager"),r.resolve("Common.IActionManagerExtended"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),r.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),r.resolve("PowerpointPresence.IPresenceEventHandlers"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),r.resolve("PowerPointWebEditor.View.IViewEventSource"),
r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("PowerPointWebEditor.IActionNameResolver"),r.resolve("Common.ITaskManager"),r.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),r.Ja("PowerPointWebEditor.IDesignerServiceProvider")):new ep(r.resolve("PowerPointWebEditor.IFocusManager"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),r.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),r.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
r.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),r.resolve("PowerPointWebEditor.IPptSelectionManager"),r.resolve("Common.IActionManagerExtended"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),r.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
r.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),r.resolve("PowerpointPresence.IPresenceEventHandlers"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),r.resolve("PowerPointWebEditor.View.IViewEventSource"),r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("PowerPointWebEditor.IActionNameResolver"),r.resolve("Common.ITaskManager"),r.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),r.Ja("PowerPointWebEditor.IDesignerServiceProvider")));r.register(t,
"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().oa(()=>new t(r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),r.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),r.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),r.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),r.resolve("PowerPointWebEditor.IFocusManager"),r.resolve("Box4.IPageView").Ma,r.resolve("PowerPointWebEditor.IShapeReader")));r.register(gk,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().oa(()=>new gk(r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("Common.ITaskManager")));r.register(Zd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().oa(()=>
new Zd(r.resolve("Common.IClickInputManager"),r.resolve("Common.IPointerInputManager"),r.resolve("PowerPoint.IBrowserHelperManager"),r.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("PowerPoint.IPathManager"),r.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));r.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().oa(()=>new pd.a((R,
la)=>{let Ea=null;const Qa=Object(D.a)(117,R.sc(r.resolve("Box4.IPageView").Ma));Qa&&!Qa.Al&&Qa.SU&&(Ea=new tc(R,Qa,la,r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),r.resolve("Common.IActionManagerExtended"),r.resolve("PowerPoint.IBrowserHelperManager"),r.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),Ea.setup());return Ea}));r.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().oa(()=>new pd.a((R,la)=>{let Ea=null;const Qa=Object(D.a)(117,R.sc(r.resolve("Box4.IPageView").Ma));Qa&&!Qa.Al&&Qa.SU&&(Ea=new T(R,Qa,la,r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
Ea.setup());return Ea}));r.register(cg,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>new cg(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));r.register(Nj,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().oa(()=>
new Nj(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));r.register(em,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().oa(()=>new em(r.resolve("PowerPointWebEditor.IPptSelectionManager"),r.resolve("Common.IActionManagerExtended"),r.resolve("PowerPointWebEditor.IFocusManager"),r.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
r.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),r.resolve("PowerPointWebEditor.View.IViewEventSource"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),r.resolve("Common.Transaction.ITransactionFactory"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),r.resolve("PowerPointWebEditor.View.IPPTPageView"),r.resolve("PowerPointWebEditor.IShapeReader")));
r.register(po,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().oa(()=>new po(r.resolve("PowerPointWebEditor.IPptSelectionManager"),r.resolve("PowerPointWebEditor.View.IViewEventSource"),r.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),r.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),r.resolve("PowerPointWebEditor.IShapeReader"),r.resolve("PowerPointWebEditor.IApplicationSettings"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),
r.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),r.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),r.resolve("PowerpointPresence.IPresenceEventHandlers"),r.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),r.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),r.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),r.resolve("PowerPointWebEditor.IActionNameResolver"),r.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.uO&&
this.K.resolve("PowerPointWebEditor.PodsInfoSender");const r=this.K.resolve("Common.IAppSettingsManager");r.gf(()=>{const R=new Date;r.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?N.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):N.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.ixe=r.ka("463"))r.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.Hwe=r.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();
N.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+R)})}dispose(){this.ixe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.Hwe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Dc(Bc.a(new io,0))}}Object(h.a)(io,"PPTWebEditorReplaceObjectPackage",null,[2,3]);var Xp=d(271),jo=d(398),Ii=d(1076);class ht{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=
null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(h.a)(ht,"AppSettings",null,[]);class hs{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=
null}}Object(h.a)(hs,"ControllerFactoryParameters",null,[]);var pr=d(729),Ap=d(332);class Pi{}Pi.none="None";Pi.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Pi.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Pi.vhFailedToParseVersionList="VHFailedToParseVersionList";Pi.vhFetchFailed="VHFetchFailed";Pi.vhVersioningNotEnabled="VHVersioningNotEnabled";Pi.vhFileNotFound="VHFileNotFound";Pi.vhVersionTooOld="VHVersionTooOld";Pi.JIl="VHFailedToRenderThumbnails";Pi.IIl="VHFailedToRenderSlide";
Pi.HIl="VHFailedToRenderNotes";Pi.FIl="VHFailedToRenderDiff";Pi.KIl="VHFailedToShowAnimaitonIcon";Pi.LIl="VHFailedToShowHiddenEffect";Pi.GIl="VHFailedToRenderInitPresInfo";Object(h.a)(Pi,"ErrorName",null,[]);class Ul{constructor(){this.jIa=new uc.a;this.jIa.add(0,Pi.none);this.jIa.add(100,Pi.vhFailedToLoadVersionList);this.jIa.add(101,Pi.vhFailedToGetDownloadToken);this.jIa.add(102,Pi.vhFailedToParseVersionList);this.jIa.add(103,Pi.vhFetchFailed);this.jIa.add(104,Pi.vhVersioningNotEnabled);this.jIa.add(105,
Pi.vhFileNotFound);this.jIa.add(106,Pi.vhVersionTooOld);this.IIa=new uc.a;this.IIa.add(0,Pi.none);this.IIa.add(100,Pi.JIl);this.IIa.add(101,Pi.IIl);this.IIa.add(102,Pi.HIl);this.IIa.add(103,Pi.FIl);this.IIa.add(104,Pi.KIl);this.IIa.add(105,Pi.LIl);this.IIa.add(106,Pi.GIl)}get tgl(){return this.jIa}get ZIl(){return this.IIa}static F6f(){Ul.ATe||(Ul.ATe=new Ul);return Ul.ATe}}Ul.oBf="ErrorCode";Ul.ATe=null;Object(h.a)(Ul,"VersionHistoryTelmetryHelper",null,[]);class on{constructor(r,R,la,Ea,Qa,wb,Pb,
xc,ed,jd,bd,Ce,Bf,Df,Eh,jk,tj){this.lic=this.uE=this.Kyg=this.l9c=this.tBb=this.s4=this.RCe=this.bY=this.oH=null;this.nva=-1;this.ZBb=null;if(!tj)throw Error.argumentNull("clientRequestManager");this.ia=r;this.Aw=R;this.Bi=la;this.Ha=Ea;this.oc=Qa;this.jYa={};this.Ea=wb;this.Og=Pb;this.aFb={};this.mc=ed;this.Nbd={};this.Ndk=xc;this.Uea=jd;this.Xa=bd;this.jre=[];Ce&&(this.Kyg=Ce,this.Kyg.execute(rk=>{this.uE=rk}));this.jO=Bf;this.Zg=Df;this.bqe=Eh;this.wFb=jk;this.Ds=tj}wb(){this.ia.ya(u.a.yrc,E.a.frame,
Object(m.a)(this,this.Rml,"showVersionHistoryDialogAction"));this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(ab.a.Dah,E.a.frame,Object(m.a)(this,this.ELe,"pptoShowFileVersion"));this.ia.ya(ab.a.bJh,E.a.frame,Object(m.a)(this,this.bxj,"handleVersionHistoryCopySlides"))}Rml(r,R,la){if(1===la)return r=!1,this.Xa.Oda&&(r=!0),r?2:32;2===la&&(z.AFrameworkApplication.JL("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),z.AFrameworkApplication.JL("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),
this.lic=Xd.a.create().toString(),n.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.lic),$a.c(ab.a.O7g,!0),this.jYa.VersionHistoryLaunchSessionId=this.lic,this.aFb.VersionHistoryLaunchSessionId=this.lic,this.jYa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.l9c=[],this.oH||(this.oH=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new hs,{ulsLogger:new jo.a,serviceBase:this.Ha.getSetting("VersionHistoryWebServiceBase"),
latestStreamServiceBase:this.Ha.ka("PPTVHPodsBootEnabled")?this.Ha.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ha.getSetting("PodSID"):"",docId:z.AFrameworkApplication.gh,appSettings:Object.assign(new ht,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ha.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.mc.Gn,wdEnableRestore:this.mc.Gn,userSessionId:z.AFrameworkApplication.userSessionId,wacCluster:this.Ha.Ga("WacCluster"),uiLocale:this.Ha.HJa?this.Ha.HJa:"en-us",isRtl:z.AFrameworkApplication.isRtl,
disabledChangeGates:this.Ha.Ga("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ha.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),wdEnableDeleteVersions:this.Ha.ka("PPTVersionHistoryDeleteVersionsIsEnabled")}),perfTelemetryInfos:this.l9c}))),this.oH&&this.oH.setDisableSaveACopy(z.AFrameworkApplication.iG),this.Sml());return 32}ELe(r,R,la){return 1===la&&this.Xa.Oda?2:this.ia.processAction(u.a.mrc,la)}bxj(r,R,la){if(1===la)return this.luh()?2:32;this.bY.onCopySlides();return 32}Sml(){var r;
if(!document.getElementById("VersionHistoryOverlay")){this.lUk();this.hUk();this.iUk();this.cUk();this.aUk();this.gUk();this.fUk();this.dUk();const R=document.createElement("div");R.id="VersionHistoryOverlay";R.style.width="100%";R.style.zIndex="998";R.style.display="block";R.style.position="absolute";R.style.top="0px";if(this.Ha.ka("RegionComposerIsEnabled")){const la=(null===(r=document.getElementById("HeaderRegion"))||void 0===r?void 0:r.offsetHeight)||0;R.style.top=la+"px";R.style.bottom="0px";
R.style.height=`calc(100vh - ${la}px)`}else R.style.height="calc(100% + "+Pa.AFrame.qrd+"px)";document.getElementById("WACInnerFrame").appendChild(R);this.RCe=this.oH.createVersionHistoryDialog(R);this.bkb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.oH.getTipVersion&&this.Ha.ka("PPTVHPodsBootEnabled")&&this.oH.getTipVersion();this.oH.getVersions("");this.g4h()}g4h(){try{this.ZBb=this.Ndk.a7i();for(let r=0;r<this.ZBb.length;r++)this.Og.Ko(this.ZBb[r]);this.Og.pI(dd.a.GPb)}catch(r){n.ULS.sendTraceTag(512508633,
822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",r)}}jJi(){try{if(this.ZBb)for(let r=0;r<this.ZBb.length;r++)this.Og.pI(this.ZBb[r]);else n.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.Og.Ko(dd.a.GPb)}catch(r){n.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",r)}}lUk(){this.oH.getFullAppErrorEvent().addListener(r=>{try{const R=Ul.F6f().tgl.ga(r);this.aFb[Ul.oBf]=
R;n.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",R,this.lic)}catch(R){n.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",R)}})}hUk(){this.oH.getVersionsReadyEvent().addListener(r=>{this.Ikh(r.containerDiv);this.m8h(r.versions);this.Ea.HU("VersionHistoryOverlay",!0);try{this.s4&&this.s4.DownloadUrl.length&&this.bY&&(this.aKh(),this.ceg(),this.bY.onVersionSelected(this.s4,this.tBb,this.jYa),this.tFf())}catch(R){n.ULS.sendTraceTag(512508628,
822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",R)}})}m8h(r){const R=this.bY.getAppDataStore();for(const la of r)R.AddVersionInfoToStore(la)}iUk(){this.oH.getVersionSelectedEvent().addListener(r=>{this.s4=r.currentVersion;this.tBb=r.baseVersion;if(this.bY&&this.s4.DownloadUrl.length)try{this.aKh(),this.ceg(),this.bY.onVersionSelected(r.currentVersion,r.baseVersion,this.jYa),this.CVk(),this.tFf()}catch(R){n.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",
R)}})}CVk(){const r=this.T6b(2);r&&(nd.a.addHandler(r,ha.a.Yf,Object(m.a)(this,this.Zz,"keyDownHandler")),cl.a.instance.pb(r,Object(m.a)(this,this.lC,"contextMenuHandler")))}JBl(){const r=this.T6b(2);r&&(nd.a.removeHandler(r,ha.a.Yf,Object(m.a)(this,this.Zz,"keyDownHandler")),cl.a.instance.yb(r,Object(m.a)(this,this.lC,"contextMenuHandler")))}Zz(r){try{if(r.shiftKey&&r.keyCode===Ba.a.xpa||r.keyCode===Ba.a.tMa){const R=Ii.a.create(ha.a.contextMenu,r,1);this.lC(R)}}catch(R){n.ULS.sendTraceTag(512508626,
822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",R)}}lC(r){if(1===r.Xf){const R=this.T6b(2);R&&(r.clientPoint.x=Oc.a.tRc(R)+ac.a.csa,r.clientPoint.y=Oc.a.uRc(R)+ac.a.csa)}return 32===this.ia.La(ab.a.kIf,2,r)}cUk(){this.oH.getDownloadTokenReadyEvent().addListener(r=>{try{if(n.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.tBb)if(r&&r.updatedVersions&&2<=r.updatedVersions.length){let R=null,la=null;const Ea=on.e6b(this.s4),Qa=
on.e6b(this.tBb);for(const wb of r.updatedVersions){const Pb=on.e6b(wb);Ea===Pb?R=wb:Qa===Pb&&(la=wb);if(R&&la)break}R&&la?(this.s4=R,this.tBb=la,this.bY.diff(this.s4,this.tBb)):n.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ea,Qa)}else n.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else n.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(R){n.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",R)}})}gUk(){this.oH.getSaveACopySelectedEvent().addListener(r=>{n.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",r);this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&on.spk();let R=
z.AFrameworkApplication.kAb;this.Ha.ka("VHSaveACopyForOdcOnSpoEnabled")&&(R=32===this.ia.processAction(ab.a.hmc,1));r=R?this.ia.La(ab.a.hmc,2,{["FileDownloadUrl"]:r}):this.ia.La(u.a.jjb,2,{["FileDownloadUrl"]:r});32!==r?($a.c(ab.a.oVd,!1),n.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",r)):$a.c(ab.a.oVd,!0)})}dDh(r,R){try{(new Promise((la,Ea)=>{this.oH.setRestoreInProgress();this.Uea.YJc(this.Xa.Kk,this.Xa.podSessionId,this.Xa.presentationId.string,this.Ha.getSetting("361"),
this.Xa.iaa,!1,!0,()=>{la(!0)},Qa=>{Ea("ClosePopWacSessionSync:: "+Qa.error.message)})})).then(()=>{(new Promise((la,Ea)=>{this.Uea.fmd(this.Xa.presentationId.string,r,()=>{la(!0)},Qa=>{Ea("RestoreFileVersion:: "+Qa.error.message)})})).then(()=>{const la=Date.now()-R;n.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",la);this.aFb.RestoreSucceededTime=la;this.ia.La(ab.a.refresh,2,{["IsSourceVH"]:!0});$a.c(ab.a.c0b,!0)}).catch(la=>
{const Ea=Date.now()-R;this.oH.setRestoreFailedAtServer(()=>{this.ia.La(ab.a.refresh,2,{["IsSourceVH"]:!0})});n.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",la,Ea);this.aFb.RestoreFailedTime=Ea;$a.c(ab.a.c0b,!1)})})}catch(la){n.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",la.message),$a.c(ab.a.c0b,!1)}}fUk(){this.oH.getRestoreVersionSelectedEvent().addListener(r=>{n.ULS.sendTraceTag(512508615,
832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",r);const R=Date.now();this.uE?(this.jre=this.uE.U4b(),0<this.jre.length?(n.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.jre.length),$a.c(ab.a.c0b,!1),this.oH.setCoauthRestoreError(),this.Ha.ka("PPTVersionHistoryRestoreSurveyEnabled")&&on.mZj()):this.dDh(r,R)):(n.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.dDh(r,
R))})}dUk(){this.oH.getDownloadVersionSelectedEvent().addListener(r=>{n.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");r=new eg.QueryStringBuilder(r);r.yi(Ih.a.V8g,z.AFrameworkApplication.fileName);r=this.ia.La(u.a.downloadACopy,2,{["FileDownloadUrl"]:r.toString()});32!==r?($a.c(ab.a.nVd,!1),n.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",r)):$a.c(ab.a.nVd,!0)})}aKh(){for(const r of this.l9c){const R=r.TelemetryEventKey?
r.TelemetryEventKey:r.telemetryEventKey?r.telemetryEventKey:"",la=r.TelemetryEventData?r.TelemetryEventData:r.telemetryEventData?r.telemetryEventData:"";db.a.Wa(R)||db.a.Wa(la)||(this.jYa[R]=la)}}tFf(){this.l9c=[];this.jYa={}}aUk(){this.oH.getCloseSelectedEvent().addListener(()=>{this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&on.lZj();this.eGf()})}eGf(){this.jJi();this.Ea.X0("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ha.bzf&&(this.s4=
null);n.ULS.sendTraceTag(512508610,822,50,oe.c(this.aFb))}Ikh(r){try{if(this.bY)Qe.setIsPageLoadForFirstTime(!1),this.bY.switchParentViewContainer(r);else{Qe.setIsPageLoadForFirstTime(!0);const R=new PowerPointVersionHistory.AppBootSettings;R.RenderServiceBase="";R.IsRtl=z.AFrameworkApplication.isRtl;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(m.a)(this.Aw,this.Aw.uXd,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(m.a)(this,this.$Ei,
"createNotesIcon");la.addToF6LoopCallback=Object(m.a)(this,this.V7h,"addToF6Loop");la.copySlideCallback=Object(m.a)(this,this.copySlideCallback,"copySlideCallback");la.reportViewerErrorCallback=Ea=>{this.aFb[Ul.oBf]=Ul.F6f().ZIl.ga(Ea);106!==Ea&&103!==Ea||this.oH.setViewerError(!0);n.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Ea);0!==Ea&&(z.AFrameworkApplication.vp(ck.a.Uh(406)),ob.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};
R.IsHighContrast=!1;this.Bi&&(R.IsHighContrast=this.Bi.isInHighContrastMode);R.IsHighContrast&&(R.ClientColorSettings=this.Bi.highContrastColors.foregroundTextColor+"_"+this.Bi.highContrastColors.backgroundColor+"_"+this.Bi.highContrastColors.linkColor);if(this.oc){const Ea=this.oc.hTa();R.DefaultSlideWidth=Ea.width;R.DefaultSlideHeight=Ea.height}R.UserSessionId=z.AFrameworkApplication.userSessionId;R.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;R.ProgressImageResourceUrl=Ue.a.XK(ac.a.Rna);
R.ThumbnailShareOptimizationEnabled=this.Ha.pptvhThumbnailShareOptimizationEnabled;R.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ha.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ha.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ha.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ha.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ha.getSetting("PPTVHSlidePrefetchDelay")});
R.FileExtension=void 0!==this.Ha.GJa&&null!==this.Ha.GJa?db.a.fT(this.Ha.GJa).toLowerCase():"";R.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;R.NotesButtonLabel=ResourceStrings.L_Notes;R.SynchronizerTimeout=this.Ha.getSetting("PptVersionHistorySynchronizerTimeout");R.IsRtl=z.AFrameworkApplication.isRtl;R.IsCopySlidesEnabled=!0;R.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;R.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;R.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
R.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;R.Lcid=z.AFrameworkApplication.lcid;R.EnableOverflowXOnSlideAndNotePane=this.Ha.ka("PodVHEnableOverflowXOnSlideAndNotePane");R.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;R.IsModernCatchUpUxEnable=!0;R.IsRevisionTrackingFlyoutEnabled=Db.a("EnableRevisionTrackingFlyoutForVH");R.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.bY=new PowerPointVersionHistory.AppVersionController(R,r,la)}}catch(R){this.oH.setViewerError(!0),
n.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",R)}}$Ei(){return Fa.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}bkb(){const r=this.Ea.Fc("VersionHistoryOverlay");r.parent=Pa.AFrame.gj;r.bJ=!0;r.BSe=!0;r.kca(R=>{R&&"dialog/modal"===R.name?this.oH.setSaveACopyCanceled():R&&R.name===Pa.AFrame.ZO||(this.nva=-1,this.$Dh(!0))});this.Og.K2("VersionHistoryOverlay");this.Og.bqc(dd.a.GPb,
R=>{this.$Dh(R)});this.Og.VLb(dd.a.GPb,()=>{2===this.nva&&Sys.UI.DomElement.addCssClass(this.T6b(2),"PPTVHViewerElementSelected");3===this.nva&&Sys.UI.DomElement.addCssClass(this.T6b(3),"PPTVHViewerElementSelected")})}$Dh(r){try{const R=this.QUc();(this.nva=this.Edj(r))?1===this.nva?this.RCe.then(la=>{la.enterHeaderFocusTrapZone();return null}):R&&ec.FocusManager.Wr(document.getElementById(R[this.nva])):this.RCe.then(la=>{la.enterFocusTrapZone();return null})}catch(R){n.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",R)}}Edj(r){const R=this.QUc();let la=this.nva;do if(r?R&&(la=(la+1)%R.length):R&&(la=0<la?la-1:R.length-1),!la||1===la||R&&"none"!==document.getElementById(R[la]).style.display)return la;while(la!==this.nva);return 0}ceg(){const r=on.e6b(this.s4);this.Nbd[r]||(this.Nbd[r]=["VersionListPane","vhHeader"],this.nva=-1)}QUc(){if(!this.s4)return this.Ha.bzf?["VersionListPane","vhHeader"]:null;const r=on.e6b(this.s4);return this.Nbd[r]?
this.Nbd[r]:null}T6b(r){const R=this.QUc();return R&&R.length>r?document.getElementById(R[r]):null}V7h(r){try{const R=this.QUc();R&&R.push(r)}catch(R){n.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",R)}return!0}copySlideCallback(r){if(this.luh())return!1;const R=Xd.a.create().toString();n.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",R);const la=this.jO.qLc(1,r.SlideIds.length),Ea={};Ea.WacSessionId=z.AFrameworkApplication.userSessionId;
Ea.CallerCorrelationId=R;var Qa={};Qa.Source=r.Source;Qa.SlideIds=r.SlideIds;Qa.CcpId=la.Gp;Qa.PackageAccessKey=la.zy;r=JSON.stringify(Qa);Qa=String.format("{0}{1}",this.Ha.podsWebServiceBase,"vhcopyslide.ashx");const wb=Date.now();try{if(this.Ds.mj(Qa,2,r,Ea,!1,0,Pb=>{on.EIl(Pb,wb,R)},Pb=>{on.DIl(Pb,wb,R)},null,null),this.Zg.contentWindow&&this.Zg.contentWindow.document&&this.Zg.contentWindow.document.body){ic.a.JJc(this.Zg);const Pb=ic.a.Eca();Pb.innerText=ic.a.N_g;Pb.setAttribute(Ap.a.Gp,la.Gp);
Pb.setAttribute(Ap.a.tD,la.tD);Pb.setAttribute(Ap.a.count,la.objectCount.toString());const xc=pr.a(la.dataType);Pb.setAttribute(Ap.a.type,xc);Pb.setAttribute(Ap.a.location,la.location);Pb.setAttribute(Ap.a.zy,la.zy);this.Zg.contentWindow.document.body.appendChild(Pb);this.bqe.O_a(this.Zg);this.wFb.copy(this.Zg)}else n.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Pb){n.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Pb)}return!0}luh(){return(z.AFrameworkApplication.yM||z.AFrameworkApplication.iG)&&!z.AFrameworkApplication.MRa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.eGf();this.JBl()}static e6b(r){return r.RevisionID?r.RevisionID:r.revisionID?r.revisionID:""}static EIl(r,R,la){const Ea=Date.now();try{JSON.parse(r.data.Sd).IsCopied?n.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",
Ea-R,la):n.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Ea-R,la)}catch(Qa){n.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Qa,la)}}static DIl(r,R,la){const Ea=Date.now();n.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",Ea-R,r.data?r.data.oe:-1,la)}static lZj(){const r=A.a.instance.ub("Common.ISystemInitiatedFeedback");
r?(r.logActivity("VersionHistoryExited",null),r.logActivity("VersionHistoryCheckExited",null)):n.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static spk(){const r=A.a.instance.ub("Common.ISystemInitiatedFeedback");r?r.logActivity("VersionHistoryExited",null):n.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static mZj(){const r=A.a.instance.ub("Common.ISystemInitiatedFeedback");r?r.logActivity("VersionHistoryRestoreCoauthFailed",null):n.ULS.sendTraceTag(512508568,
822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(h.a)(on,"VersionHistoryPaneActor",null,[737,106]);class is{constructor(){this.VBc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}Zb(r){this.Da=r}init(){z.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){z.AFrameworkApplication.H0c()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").e_c?n.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):
(n.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Ta.a.get_instance().ek(7,()=>{xn.a(this.Da)("versionHistory").catch(r=>n.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",r)).then(()=>this.gzk()).catch(r=>n.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",r))})):n.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}gzk(){this.k1b();
return null}k1b(){this.Da.register(on,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").oa(()=>new on(z.AFrameworkApplication.Ta,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),ec.FocusManager.instance(),Xp.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Da.resolve("PowerPointWebEditor.IPopWebService"),this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.Ja("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").uCa,this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),z.AFrameworkApplication.Ke)).ma();this.VBc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.VBc.wb()}dispose(){this.VBc&&this.VBc.dispose()}}Object(h.a)(is,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var it=d(457),js=d(727),ii;(function(r){r[r.anyone=0]="anyone";r[r.organization=1]="organization"})(ii||(ii={}));Object(h.b)("AccessControlEnum",ii);var Yp=d(382);class to{constructor(){this.token=this.timeStamp=null}}Object(h.a)(to,"CachedAccessToken",null,[]);class uo{constructor(r){this.eqe={};this.P7j=r}Lni(r,R){if(!db.a.Wa(r)&&!db.a.Wa(R)){const la=new to;la.token=R;la.timeStamp=
new Date;this.eqe[r]=la}}i_f(r){return r in this.eqe&&(r=Object(D.a)(to,this.eqe[r]),+new Date-+r.timeStamp<6E4*this.P7j)?r.token:null}}Object(h.a)(uo,"AccessTokenCache",null,[]);class hp{constructor(){this.reject=this.resolve=this.frame=this.Jfa=this.H5e=this.resource=this.appId=this.authority=this.id=null;this.olb=0;this.$Re=null;this.Llc=0;this.hEh=!1}}Object(h.a)(hp,"DirectAuthRequest",null,[]);class qr{constructor(r){this.igc={};this.la=r;this.GFb=new uo(this.la.KGk);window.addEventListener("message",
Object(m.a)(this,this.X0k,"requestCompletionMessageHandler"),!1)}p2f(r){const R={},la=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ea;for(;Ea=la.exec(r);)R[Object(D.a)(String,Ea[1])]=Object(D.a)(String,Ea[2]);return R}X0k(r){if("data"in r){var R;({rv:R}=oe.d(r.data)).returnValue&&R&&"DirectAuthRequestID"in R&&this.Kxb(R)}}Kxb(r){try{const Ea=r.DirectAuthRequestID;if(Ea in this.igc){var R=null,la=Object(D.a)(hp,this.igc[Ea]);if(la&&la.id===Ea){N.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
Ea,"Timeouted"in r,"FromPolling"in r);window.clearTimeout(la.olb);delete this.igc[Ea];window.clearTimeout(la.Llc);const Qa=new Yp.a;Qa.IsSuccess=!1;Qa.ErrorCode="";Qa.ErrorMessage="";Qa.Token="";"Timeouted"in r?(N.a.J(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Qa.ErrorCode="Timeout",Qa.ErrorMessage="No response received in time for the authentcation request",la.resolve(Qa)):"PopupWindowClosed"in r&&la.Jfa?(Qa.ErrorCode="User_aborted",Qa.ErrorMessage="User aborted log in by closing the popup window",
la.resolve(Qa)):(la.frame?R=this.p2f(la.frame.contentWindow.location.hash):la.Jfa&&!la.Jfa.closed&&(R=this.p2f(la.Jfa.location.hash)),"access_token"in R?(Qa.IsSuccess=!0,Qa.Token=Object(D.a)(String,R.access_token),this.GFb&&this.GFb.Lni(la.$Re,Qa.Token),la.resolve(Qa)):(Qa.ErrorCode="error"in R?Object(D.a)(String,R.error):"unknown",0<=Array.indexOf(this.la.MGk,Qa.ErrorCode)&&la.hEh&&la.frame&&!la.Jfa?this.kGk(la.authority,la.appId,la.resource,la.H5e,this.la.NGk).then(wb=>{la.resolve(wb)}).catch(wb=>
{la.reject(wb)}):(Qa.ErrorMessage="error_description"in R?Object(D.a)(String,R.error_description):"unknown",la.resolve(Qa))));la.frame?document.body.removeChild(la.frame):la.Jfa&&!la.Jfa.closed&&la.Jfa.close()}else N.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Ea)}else N.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(r))}catch(Ea){N.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
Ea.message)}}HKc(r){const R=window.location.protocol,la=window.location.host;N.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",R,la,"ffc-powerpoint.officeapps.live.com"===la||"ppc-powerpoint.officeapps.live.com"===la);if(void 0===r||null===r){r=window.location.pathname;const Ea=r.lastIndexOf("/");r=0<=Ea?r.substring(0,Ea+1):""}return R+"//"+la+r+"WacDirectAuth.html"}$yl(r,R,la,Ea,Qa,wb=!1){return this.anl(r,R,la,Ea,Qa,wb)}kGk(r,R,la,Ea,Qa){if(db.a.Wa(r))throw Error.argumentNull("authority");
if(db.a.Wa(R))throw Error.argumentNull("appId");if(db.a.Wa(la))throw Error.argumentNull("resource");if(db.a.Wa(Ea))throw Error.argumentNull("userUPN");const wb=!db.a.Wa(Ea)&&Ea.indexOf("@")<Ea.indexOf("."),Pb=this.HKc("/p/"),xc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",r,R,encodeURIComponent(la),encodeURIComponent(Pb));if(this.GFb){const bd=this.GFb.i_f(xc);if(!db.a.Wa(bd))return N.a.J(593782154,
833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Ce=>{const Bf=new Yp.a;Bf.IsSuccess=!0;Bf.ErrorCode="";Bf.ErrorMessage="";Bf.Token=bd;Ce(Bf)})}const ed=Xd.a.create().toString(),jd=String.format("{0}&state={1}",xc,ed);return new Promise((bd,Ce)=>{const Bf=new hp;Bf.authority=r;Bf.appId=R;Bf.resource=la;Bf.H5e=Ea;Bf.resolve=bd;Bf.reject=Ce;Bf.id=ed;Bf.$Re=xc;Bf.Jfa=window.open("",ed,"width=400, height=600");Bf.Jfa?(this.igc[ed]=Bf,Bf.Jfa.location.replace(jd),N.a.J(593782152,833,
50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",ed,wb),this.Uxh(Bf,1E3*Qa).then(()=>{const Df={};Df.DirectAuthRequestID=ed;Df.FromPolling=!0;this.Kxb(Df)}).catch(Df=>{"WindowClosed"===Object(D.a)(String,Df)&&(Df={},Df.DirectAuthRequestID=ed,Df.PopupWindowClosed=!0,N.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+ed),this.Kxb(Df))}),Bf.olb=window.setTimeout(()=>{const Df={};Df.DirectAuthRequestID=ed;Df.Timeouted=!0;N.a.J(593782148,833,
10,"DirectAuth: Popup request timedout with ID of: "+ed);this.Kxb(Df)},1E3*Qa)):(N.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",ed),Ce=new Yp.a,Ce.IsSuccess=!1,Ce.ErrorCode="fail_to_open_popup",Ce.ErrorMessage="Failed to create popup window!",Ce.Token="",bd(Ce))})}anl(r,R,la,Ea,Qa,wb){if(db.a.Wa(r))throw Error.argumentNull("authority");if(db.a.Wa(R))throw Error.argumentNull("appId");if(db.a.Wa(la))throw Error.argumentNull("resource");if(db.a.Wa(Ea))throw Error.argumentNull("userUPN");
const Pb=!db.a.Wa(Ea)&&Ea.indexOf("@")<Ea.indexOf(".");var xc=this.HKc("/p/");const ed=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",r,R,encodeURIComponent(la),encodeURIComponent(xc));if(this.GFb){const Ce=this.GFb.i_f(ed);if(!db.a.Wa(Ce))return N.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Bf=>{const Df=new Yp.a;Df.IsSuccess=!0;Df.ErrorCode="";
Df.ErrorMessage="";Df.Token=Ce;Bf(Df)})}const jd=Xd.a.create().toString();xc=Pb?String.format("{0}&login_hint={1}&state={2}",ed,encodeURIComponent(Ea),jd):String.format("{0}&state={1}",ed,jd);const bd=document.createElement("iframe");bd.style.display="none";bd.src=xc;return new Promise((Ce,Bf)=>{const Df=new hp;Df.authority=r;Df.appId=R;Df.resource=la;Df.H5e=Ea;Df.frame=bd;Df.resolve=Ce;Df.reject=Bf;Df.id=jd;Df.$Re=ed;Df.hEh=wb;document.body.appendChild(bd);N.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",
jd,Pb);this.Uxh(Df,1E3*Qa).then(()=>{const Eh={};Eh.DirectAuthRequestID=jd;Eh.FromPolling=!0;this.Kxb(Eh)});Df.olb=window.setTimeout(()=>{const Eh={};Eh.DirectAuthRequestID=jd;Eh.Timeouted=!0;N.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+jd);this.Kxb(Eh)},1E3*Qa);this.igc[jd]=Df})}Uxh(r,R){return new Promise((la,Ea)=>{const Qa=R/50;let wb=0;r.Llc=window.setInterval(()=>{try{wb++>Qa&&(window.clearInterval(r.Llc),N.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",
R,Qa),Ea(""));const Pb=r.frame?r.frame.contentWindow:r.Jfa;if(!Pb||Pb.closed)window.clearInterval(r.Llc),N.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),Ea("WindowClosed");let xc=null,ed=null;try{xc=Pb.location.href,ed=Pb.location.hash}catch(jd){}xc&&"about:blank"!==xc?db.a.Wa(ed)||(window.clearInterval(r.Llc),la(ed)):N.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===xc)}catch(Pb){N.a.J(594068384,
833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Pb.message)}},50)})}}Object(h.a)(qr,"DirectAuthHelper",null,[]);class rr{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=
this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(h.a)(rr,"ILiveActorSettings",null,[]);class Jk{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(h.a)(Jk,"ILiveReaction",null,[]);class sr{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(h.a)(sr,"ILiveSessionState",
null,[]);class Gq{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(h.a)(Gq,"ILiveSessionURL",null,[]);class Bp{constructor(){this.rKg=this.qKg=null}}Object(h.a)(Bp,"PollObjectInfo",null,[]);var Cp;(function(r){r[r.none=0]="none";r[r.singleLineRibbon=1]="singleLineRibbon";r[r.multipleLineRibbon=2]="multipleLineRibbon";r[r.slideShowToolbar=3]="slideShowToolbar";r[r.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";r[r.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Cp||(Cp=
{}));Object(h.b)("LiveEntryPoint",Cp);var Zp;(function(r){r[r.none=0]="none";r[r.callout=1]="callout";r[r.businessBar=2]="businessBar";r[r.pausedSessionTimeout=3]="pausedSessionTimeout";r[r.slideshowContextMenu=4]="slideshowContextMenu";r[r.accessControlChange=5]="accessControlChange";r[r.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Zp||(Zp={}));Object(h.b)("LiveExitPoint",Zp);var bg=d(674);class tr{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df){this.va=new nm.a;this.LGa=this.lCb=this.W4c=
this.lue=this.Axg=!1;this.udc=this.Wte=this.Z4c=!0;this.Dgc=this.pFb=!1;this.Rp=this.rj=this.kea=this.Xn=null;this.OVa=0;this.CDb=-1;this.IEb=30;this.ofc=-1;this.Gd=this.Dma=this.Y_=null;this.RSg=this.cXg=this.fad=this.bad=0;this.Pbc=this.Sua=this.JVa=null;this.Vxe=this.Bcb=0;this.Akb=null;this.qCe=new Set;this.pCe=new Map;this.L7c=null;this.Efc=1;this.nfc=this.m4c=this.FO=this.$ma=this.PFb=this.Nre=null;this.qe=Ea;this.la=r;this.Kxg=!1;this.kb=la;this.oc=wb;this.jq=Pb;this.Oc=xc;this.pz=ed;this.Xa=
jd;this.Hc=bd;this.Ll=Ce;this.uXa=Bf;this.Ea=Df;if(this.rt=R)this.kea=R.FF();this.cM=Qa;this.OVa=this.vUf?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.Nre=new qr(this.la));this.Oc.fC(Object(m.a)(this,this.eaa,"onPodSessionRehydrated"));this.pz.zPd(Object(m.a)(this,this.lHb,"onPodSessionUnavailable"));this.aSa()&&this.Ll.execute(Eh=>{Eh.show(ResourceStrings.L_LivePresentations_Disconnected,bg.a.MGb);Eh.hide()});N.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get vr(){return this.la.powerPointLiveBroadcastEnabled&&
this.Z4c}get F8a(){return this.lue}set F8a(r){(this.lue=r)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get dr(){return!!this.Rp}get $ca(){return this.Kxg}set $ca(r){this.Kxg=r}get ADa(){return this.Axg}set ADa(r){this.Axg=r}get dSa(){return!!this.Rp&&this.Rp.isPaused}get hVi(){return this.W4c}get BDa(){return this.udc}set BDa(r){this.udc=r}get TUi(){return this.F8a&&this.vr&&!!this.Xn}get accessControl(){return this.OVa}set accessControl(r){this.OVa=r}get vUf(){return"true"===
this.w5f("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get qUf(){return this.vr&&this.dr&&this.rj?this.rj.isWelcomeScreenVisible():!1}xvb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&this.la.xid&&this.Hc.O3b?this.Hc.zvb?this.Dgc=!0:this.Hc.HUf||this.Dgc:!0}hgd(r,R,la,Ea,Qa,wb,Pb,xc,ed){if(this.vr){this.kb.sPd(Object(m.a)(this,this.j6g,"onSlideShowEnterEndOfShow"));this.kb.uPd(Object(m.a)(this,this.k6g,"onSlideShowLeaveEndOfShow"));this.kb.xGc(Object(m.a)(this,this.exa,"onGetCurrentSlideDimensionsHandler"));
this.lCb=!1;this.LGa=!0;try{this.la.lid&&this.a2i();const jd=this.f8d(Qa,Ea);if(this.Xn)(this.ADa||this.dSa)&&this.Xn.FetchDocumentDownloadURL(jd);else{N.a.J(512496259,833,50,"Creating Broadcast monitor ...");const bd=new PowerPointLive.PPTBroadcastMonitorSettings;bd.isBlueChicken=this.la.isBlueChicken;bd.fileDownloadUrl=jd;bd.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;bd.broadcastSubtitlesFromSpeechFrontDoor=!0;bd.pragueInitTimeoutInMS=this.la.PGk;bd.preferredSubtitleLanguage=
this.Hc.PUc();bd.useStateService=this.la.YGk;bd.numMaxAttempts=this.la.SGk;bd.delayInSecsToCloseBroadcasterOnPause=this.la.JGk;bd.batchedRequestsEnabled=this.la.GGk;bd.sharedSessionSettings={};bd.websocketAliveTimeAfterLoseFocusInMs=this.la.ZGk;bd.pingTimeoutInMs=this.la.QGk;bd.pongTimeoutInMs=this.la.RGk;bd.enableTransientSessionHandling=this.la.tHk;bd.maxStateServiceRoundtripRaw=z.AFrameworkApplication.fa.Bc("PPTLiveMaxStateServiceRoundtripRaw",300);bd.sharedSessionSettings.MaxStateServiceRoundtripRaw=
bd.maxStateServiceRoundtripRaw;bd.documentSnapshotRequestUrlGenerator=this.la.qHk?()=>this.f8d(this.Xa.podSessionId,this.Xa.pk):null;this.la.yah&&(bd.sharedSessionSettings.IsAutomation=!0);this.Xn=new PowerPointLive.PPTBroadcastMonitor(bd);this.Xn.RegisterParticipantsCountChangeEventListener(Ce=>{this.Gd.telemetryData.maxParticipantCount=Math.max(this.Gd.telemetryData.maxParticipantCount,Ce);this.rj&&this.rj.setParticipantCount(Ce);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});
this.Xn.RegisterNewReactionEventListener(Object(m.a)(this,this.Snk,"newReactionHandler"));this.Xn.RegisterConnectionStateEventListener(Object(m.a)(this,this.Nyi,"connectionStateHandler"))}this.Xn.SetCurrentPosition(r,R-1,null);this.Bcb=r;this.ADa&&!this.Rp&&ed?(this.Trc(z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.Np?1:2,Pb,la,Qa,xc),this.jvi(r),this.Sua=new Set):this.Y_&&this.byb();this.Sua&&this.Sua.add(r)}catch(jd){N.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
jd.toString())}}}$xl(){window.setTimeout(()=>{const r=this.Bcb===this.Vxe;this.vr&&this.dr&&r&&this.Rp&&!this.Rp.isPaused&&(N.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.Ttd(0),this.IOb(0))},6E4*this.la.UGk)}ayk(){this.vr&&(this.kb.aRe(Object(m.a)(this,this.j6g,"onSlideShowEnterEndOfShow")),this.kb.cRe(Object(m.a)(this,this.k6g,"onSlideShowLeaveEndOfShow")),this.kb.pld(Object(m.a)(this,this.exa,"onGetCurrentSlideDimensionsHandler")),this.LGa=
this.lCb=!1,this.dr&&this.rj&&(this.rj.hideAll(),this.Ile()||(this.WDk(),this.zll()),this.aSa()&&this.Ll.instance.hide()))}Zpl(r,R,la,Ea,Qa,wb){try{const Pb=new PowerPointLive.RendezvousSessionConfig;Pb.userSessionId=r;Pb.webServiceBase=R;Pb.podSessionId=la;Pb.docId=Ea;Pb.sessionId=Qa;Pb.accessControl=1===this.OVa?"organization":"anyone";Pb.authTokenFunc=wb;Pb.locale=z.AFrameworkApplication.uiCulture;Pb.presentationName=db.a.XG(z.AFrameworkApplication.fileName);Pb.slideHeight=this.oc.Gu().height;
Pb.slideWidth=this.oc.Gu().width;Pb.correlationId=this.Gd.telemetryData.correlationId;Pb.showQRCodeAfterFetchingDocDownloadUrl=this.la.AHk;Pb.presenterTenantId=!this.la.isBlueChicken&&this.la.Kah?z.AFrameworkApplication.fa.Ga("TenantId"):null;Pb.fileSource=z.AFrameworkApplication.fa.Ga("FileHost");this.la.WGk||(Pb.fileName=z.AFrameworkApplication.fileName,Pb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const xc=this.Xn.StartLiveBroadcasting(Pb,this.Gd,!this.la.BLe);this.NEj();if(xc){this.Rp=
new sr;this.Rp.isPrivate=1===this.OVa;this.Rp.isPaused=!1;this.Rp.participantsCount=0;this.Rp.sessionCurrentState=0;const ed=xc.then(jd=>{const bd=new Gq;bd.participantUrl=jd.sessionInfo.shortParticipantUrl;bd.sessionQRCode=jd.sessionInfo.sessionQRCode;this.Rp.sessionCurrentState=1;return bd});this.Rp.sessionURLPromise=ed;this.la.yid?this.nfc.then(()=>{this.rj.actOnSessionRequested(this.Rp)}):this.rj.actOnSessionRequested(this.Rp);this.kb.BGc(Object(m.a)(this,this.l6g,"onSlideShowReady"));this.kb.Cuf(Object(m.a)(this,
this.onTranscriberStarted,"onTranscriberStarted"));this.kb.vPd(Object(m.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));xc.then(jd=>{this.Gd.telemetryData.pragueDocId=jd.sessionInfo.pragueDocId;this.Gd.telemetryData.sessionCreationWebServiceCallTimeInMS=this.kL()-this.fad;this.Gd.telemetryData.startAttemptCount=jd.numAttempt;N.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Gd.telemetryData.sessionId,this.Gd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());
this.la.BLe?(this.Wpc(),this.Xn.InitializeStateService().then(()=>{this.vsh(jd);this.S_("StartLiveBroadcasting")}).catch(bd=>{this.Gd.telemetryData.sessionEndedBeforePragueInitialized||this.Gd.telemetryData.sessionId!==Qa||(N.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Gd.telemetryData.sessionId,bd?bd.toString():""),this.Gd.telemetryData.SetErrorCode(2,bd?bd.toString():""),this.S_("StartLiveBroadcasting"),this.Nqd())})):this.vsh(jd);
this.la.sHk&&$addHandler(window,"visibilitychange",Object(m.a)(this,this.Nvk,"onPageVisibilityChangedHandler"));this.S_("StartLiveBroadcasting")}).catch(jd=>{N.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,jd.toString());this.Gd.telemetryData.SetErrorCode(4,jd.toString());this.S_("StartLiveBroadcasting");this.Nqd()})}else this.Nqd(),this.Gd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),N.a.J(512496225,
833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Pb){this.Nqd(),this.Gd.telemetryData.SetErrorCode(4,Pb.toString()),N.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Gd.telemetryData.sessionId,Pb.toString())}finally{this.S_("StartLiveBroadcasting")}}vsh(r){const R=this.Hc.h5i(this.Hc.Toa);R?this.Xn.SetDefaultSubtitlesLanguage(R):N.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",
this.Gd.telemetryData.sessionId);this.kb.vOb(!0,this.Xn.GetPragueSessionInfoJSONString());this.kb.GPa(Object(m.a)(this,this.Bkc,"onSlideShowPositionChanged"));this.kb.Auf(Object(m.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.BLe&&!this.rj.isWelcomeScreenVisible()||this.Wpc();this.va.raiseEvent("OnLiveSessionStarted",r.sessionInfo);this.xvb()||!this.Hc.O3b||this.Hc.HUf||this.Dgc||!this.aSa()||(this.pFb=!0,this.Ll.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
hh.a.xe(z.AFrameworkApplication.uiCulture).displayName),bg.a.MGb));this.Pbc=this.Xn.CreateSurvey(r.authToken,null,null,null);this.Pbc.then(la=>{if(la){const Ea={};Ea.surveyeeName=z.AFrameworkApplication.userName;Ea.surveyId=la.surveyId;Ea.surveyResponseUrl=la.surveyResponseUrl;this.Xn.SetAudienceFeedbackInfo(JSON.stringify(Ea))}});this.la.lid&&(this.pCe.clear(),this.qCe.forEach(la=>{try{const Ea=la.qKg;this.Xn.CreateSurvey(r.authToken,null,Ea,la.rKg).then(Qa=>{Qa?this.pCe.set(Ea,Qa.surveyId):N.a.J(512496222,
833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Gd.telemetryData.sessionId)}).catch(Qa=>{N.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,Qa.toString());this.Gd.telemetryData.SetErrorCode(13,r.toString())})}catch(Ea){N.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Gd.telemetryData.sessionId,Ea.toString())}}));
this.uXa.init()?this.uXa.lPd(Object(m.a)(this,this.jkc,"onNetworkConnectivityChanged")):N.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Gd.telemetryData.sessionId)}w5f(r){r=new RegExp(String.format("[\\?&]{0}=([^&#]*)",r));return(r=window.location.search.match(r))&&2===r.length?r[1]:""}Trc(r,R,la,Ea,Qa){this.PFb=R;this.$ma=la;this.FO=Ea;this.m4c=Qa;this.fad=this.kL();this.bad=this.kL();var wb=this.w5f("wdSetLiveSessionId");wb="rdvSession_"+(wb.length?
wb:Xd.a.create().toString());this.Gd=new PowerPointLive.LiveSessionTelemetry;this.Gd.telemetryData.sessionId=wb;this.Gd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Gd.telemetryData.accessControl=ii[this.OVa];this.Gd.telemetryData.sessionEntryPoint=Cp[r];this.Gd.telemetryData.isSubtitleStartedByLive=this.$ca;this.Gd.telemetryData.isAutomation=this.la.yah;this.Gd.telemetryData.correlationId=Xd.a.create().toString();this.S_("StartLiveBroadcasting");try{this.vr&&
this.Xn&&this.w3b()&&!this.Rp?(this.h0j(),this.kb.MYb(Object(m.a)(this,this.A3g,"onGetCurrentSlideShowPosition")),this.kb.getCurrentPosition(),this.x2d()&&this.rj&&this.nfc&&this.nfc.then(()=>{this.rj.showOnboardingScreen();this.g6e=!0}),this.Zpl(R,la,Ea,Qa,wb,()=>this.Z4b("StartLiveBroadcasting",this.Gd.telemetryData.sessionId))):(this.Gd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),N.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),
this.Gd.telemetryData.isMordernSlideShow=!!this.kb&&this.kb instanceof js.SlideShowCoreFrame}catch(Pb){this.Gd.telemetryData.SetErrorCode(4,Pb.toString()),N.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Gd.telemetryData.sessionId,Pb.toString())}finally{this.S_("StartLiveBroadcasting")}}WDk(){if(this.vr&&this.dr&&this.Xn&&this.w3b()&&!this.Rp.isPaused){this.Ttd(2);this.IOb(2);try{this.Gd.telemetryData.sessionPauseCount+=1,this.Gd.telemetryData.sessionActiveDurationInMS+=
this.kL()-this.bad,N.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Gd.telemetryData.sessionId),this.rj.actOnSessionPaused(),this.Rp.isPaused=!0,this.RSg=this.kL(),this.Xn.PauseLiveBroadcasting(()=>this.Z4b("PauseLiveBroadcasting",this.Gd.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.fql(),this.kb.vOb(!1)}catch(r){this.Gd.telemetryData.SetErrorCode(5,r.toString()),N.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",
this.Gd.telemetryData.sessionId,r.toString())}finally{this.S_("PauseLiveBroadcasting")}}}tlh(){if(this.vr&&this.dr&&this.Xn&&this.w3b()&&this.Rp.isPaused)try{this.bad=this.kL(),this.Gd.telemetryData.sessionResumeCount+=1,N.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Gd.telemetryData.sessionId),this.Xkh(),this.rj.actOnSessionResumed(),this.Xn.ResumeLiveBroadcasting(()=>this.Z4b("ResumeLiveBroadcasting",this.Gd.telemetryData.sessionId)),this.Rp.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",
Sys.EventArgs.Empty),this.t_e(),this.kb.vOb(!0,this.Xn.GetPragueSessionInfoJSONString())}catch(r){this.Gd.telemetryData.SetErrorCode(6,r.toString()),N.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Gd.telemetryData.sessionId,r.toString())}finally{this.S_("ResumeLiveBroadcasting")}}p3b(r){if(this.vr&&this.dr&&this.Xn&&this.w3b()){this.IOb(3);try{this.Jxl(r,()=>{this.Gd.telemetryData.sessionExitPoint=Zp[r];this.Rp.isPaused||(this.Gd.telemetryData.sessionActiveDurationInMS+=
this.kL()-this.bad);this.Y_&&this.byb();this.t_e();this.aSa()&&this.Ll.instance.hide();N.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Gd.telemetryData.sessionId);this.rj.actOnSessionEnded();this.kb.rld(Object(m.a)(this,this.l6g,"onSlideShowReady"));this.kb.Dib(Object(m.a)(this,this.Bkc,"onSlideShowPositionChanged"));this.kb.Cih(Object(m.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.kb.Dih(Object(m.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));
this.uXa.gih(Object(m.a)(this,this.jkc,"onNetworkConnectivityChanged"));this.kb.dRe(Object(m.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.LGa&&this.kb.vOb(!1);this.Pbc=this.Rp=null;this.va.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);this.la.xid&&this.Hc.O3b&&(this.Dgc=this.pFb=!1);if(3!==r){const R=this.Xn.EndLiveBroadcasting(()=>this.Z4b("EndLiveBroadcasting",this.Gd.telemetryData.sessionId));R?R.then(()=>{this.S_("EndLiveBroadcasting");N.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",
this.Gd.telemetryData.sessionId)}).catch(la=>{this.Gd.telemetryData.SetErrorCode(7,la.toString());this.S_("EndLiveBroadcasting");N.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,la.toString())}):(this.Gd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),N.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Xn.CleanUpBroadcastBeforeEnd(),
N.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.S_("EndLiveBroadcasting")})}catch(R){this.Gd.telemetryData.SetErrorCode(7),N.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Gd.telemetryData.sessionId,R.toString())}finally{3!==r&&this.Blb(),this.S_("EndLiveBroadcasting")}}}xqh(){this.vr&&this.Xn&&this.Xn.SetPresenterState("muted")}yqh(){this.vr&&this.Xn&&this.Xn.SetPresenterState("unmuted")}showCallout(r){this.vr&&
this.rj&&(this.W4c=!0,this.rj.showCallout(r))}showWelcomeScreen(){this.vr&&this.rj&&(this.rj.showWelcomeScreen(),this.JVe())}showEndSessionDialog(r,R){this.vr&&this.dr&&this.rj&&this.rj.showEndSessionDialogWithCallbacks(r,R)}Nqd(){this.rj.isWelcomeScreenVisible()||this.Rp.isPaused||this.showWelcomeScreen();this.Rp=null;this.rj.onSessionRequestError()}w3b(){if(this.vr&&!this.rj&&this.kea){const r=new rr;r.hostElement=this.kea;r.baseZIndex=50005;r.welcomeScreenBackgroundImageUrl=this.qe.qk("LiveWelcomeScreenBackground.png");
r.welcomeScreenErrorImageUrl=this.qe.qk("LiveWelcomeScreenError.png");r.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";r.calloutContainerId="LiveCalloutContainer";r.urlBarLayerHostId="LiveURLBarLayerHost";r.dialogLayerHostId="LiveDialogLayerHost";r.reactionsBarLayerHostId="LiveReactionBarLayerHost";r.showTryAgainButton=!0;r.isPowerpointLiveReactionEnabled=!Db.a("PPTLive.ReactionToggleInLiveCallout");r.onboardingScreenHostId="LiveOnboardingScreenLayerHost";r.resourceCDNPath=this.la.Ehb;r.enablePrefetchLiveResource=
this.la.yid;r.enableNewLiveWelcomeScreen=this.la.yid;r.userSessionId=this.PFb;r.podsUrl=this.$ma;this.rj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(r);this.rj.on("OnWelcomeScreenOpenedAction",()=>{this.SKa("LiveWelcomeScreenLayerHost");this.JVe();this.cXg=Date.now();this.Gd.telemetryData.welcomeShownCount+=1});this.rj.on("OnWelcomeScreenClosedAction",()=>{this.lCb&&this.rj.hideURLBar();this.oFf();this.kb.restoreFocus();this.Gd.telemetryData.welcomeScreenDurations.push(Date.now()-this.cXg);this.Gd.telemetryData.welcomeScreenFirstTimeDuration=
this.Gd.telemetryData.welcomeScreenDurations[0];this.S_("OnWelcomeScreenClosedAction");this.Xn.SetWelcomeScreenState(!1);this.la.lid&&this.aDh();this.pFb&&this.aSa()&&window.setTimeout(()=>{this.Ll.instance.hide();this.pFb=!1},5E3)});this.rj.on("ResumeSessionAction",()=>{this.tlh();this.lCb||this.rj.showURLBar()});this.rj.on("EndSessionAction",()=>{this.p3b(this.LGa?1:2);this.kb.restoreFocus()});this.rj.on("OnCalloutOpenedAction",()=>{this.W4c=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);
this.Gd.telemetryData.calloutShownCount+=1});this.rj.on("OnCalloutClosedAction",()=>{this.W4c=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.kb.restoreFocus()});this.rj.on("OnEndSessionDialogOpenedAction",()=>{this.gal()});this.rj.on("OnEndSessionDialogClosedAction",()=>{this.O2k()});this.rj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.rj.on("OnTryAgainAction",()=>{N.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",
this.Gd.telemetryData.sessionId);this.Trc(5,this.PFb,this.$ma,this.FO,this.m4c)});this.rj.on("PresenterDisabledReactions",()=>{this.Wte=!1});this.rj.on("PresenterEnabledReactions",()=>{this.Wte=!0});this.rj.on("OnOnboardingScreenOpenedAction",()=>{this.SKa("LiveOnboardingScreenLayerHost");this.JVe()});this.rj.on("OnOnboardingScreenClosedAction",()=>{this.Wpc()})}return!!this.rj}Wpc(){this.rj&&(this.x2d()&&this.rj.isOnboardingScreenVisible()?this.SKa("LiveOnboardingScreenLayerHost"):this.rj.isWelcomeScreenVisible()?
this.SKa("LiveWelcomeScreenLayerHost"):(-1!==this.ofc&&this.oFf(),this.kb.restoreFocus()))}mNj(){const r=document.getElementById("LiveWelcomeScreenLayerHost"),R=document.getElementById("LiveOnboardingScreenLayerHost");let la=!1;r&&(la=r.contains(document.activeElement));return document.activeElement===R||document.activeElement===r||la}JVe(){this.rj&&-1===this.ofc&&(this.ofc=window.setInterval(()=>{this.mNj()||this.Wpc()},500))}oFf(){window.clearInterval(this.ofc);this.ofc=-1}SKa(r){this.kea&&this.rj&&
window.setTimeout(()=>{ec.FocusManager.Wr(this.kea.ownerDocument.getElementById(r))},50)}gal(){this.LGa?this.SKa("LiveDialogLayerHost"):(this.Ea.$Wc(dd.a.ALe,dd.a.gj,document.getElementById("LiveDialogLayerHost")),this.Ea.Cj(dd.a.ALe,!0))}O2k(){this.LGa?this.kb.restoreFocus():this.Ea.Cj(dd.a.ALe,!1)}F$f(){this.la.xid&&this.Hc.O3b&&(this.aSa()&&this.pFb&&(this.Ll.instance.hide(),this.pFb=!1),this.Dgc=!0)}h0j(){try{this.nfc||!this.x2d()&&!this.la.yid||(this.nfc=xn.a(A.a.instance)("liveActorLazy"))}catch(r){N.a.J(512496205,
833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Gd.telemetryData.sessionId,r.toString())}}l6g(){this.vr&&this.Xn&&(this.dSa?(window.setTimeout(()=>{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.tlh()):this.Rp&&this.rj&&this.rj.isWelcomeScreenVisible()&&this.Wpc())}Bkc(r,R){this.vr&&this.Xn&&(this.Xn.SetCurrentPosition(R.slideId,R.slideIndex,R.stc),this.Bcb!==R.slideId&&this.Xkh(),this.Bcb=R.slideId,this.Sua&&(this.JVa&&10>
this.Efc&&10*this.Sua.size>=this.Efc*this.JVa.size&&(this.IOb(4),this.Efc+=1),this.Sua.add(R.slideId)),this.la.lid&&this.aDh(),r=!!this.JVa&&this.JVa.size>=this.la.TGk,this.Bcb===this.Vxe&&r&&this.$xl())}j6g(){this.lCb=!0;this.vr&&this.dr&&this.rj&&(this.rj.hideURLBar(),this.Ttd(1),this.IOb(1))}k6g(){this.lCb=!1;this.vr&&this.dr&&this.rj&&this.rj.showURLBar()}onSubtitleUpdated(r,R){this.vr&&this.dr&&this.Xn&&(R.isFinal?this.Xn.UpdateFinalSubtitles(R.FCh):this.Xn.UpdatePartialSubtitles(R.FCh))}onTranscriberStarted(r,
R){this.Gd.telemetryData.transcriberSessionIds+=R.ECh+",";this.vr&&this.dr&&this.kb.vOb(!0,this.Xn.GetPragueSessionInfoJSONString())}fql(){N.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",this.Gd.telemetryData.sessionId);-1!==this.CDb&&window.clearInterval(this.CDb);this.IEb=30;this.CDb=window.setInterval(Object(m.a)(this,this.$Dk,"pausedSessionAutoExpireTimerCallBack"),6E4)}t_e(){-1!==this.CDb&&(N.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",
this.Gd.telemetryData.sessionId),window.clearInterval(this.CDb),this.CDb=-1)}$Dk(){--this.IEb;0>=this.IEb?(N.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Gd.telemetryData.sessionId),this.byb(),this.p3b(3)):this.Y_&&(this.Y_.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.IEb.toString()))}zll(){if(!this.Y_&&this.rt&&!z.AFrameworkApplication.Ug&&0!==this.Rp.sessionCurrentState){var r=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,
this.IEb.toString());r=new it.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,r,null);r.closeable=!0;r.Z2=Object(m.a)(this,this.jrk,"onBusinessBarClosed");r.image=3;r.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,Object(m.a)(this,this.lrk,"onBusinessBarResumeSessionButtonClicked"),"");r.NOd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(m.a)(this,this.krk,"onBusinessBarEndSessionButtonClicked"));this.rt.businessBar.Zh(r,!1);this.rt.Oq();this.Y_=r}}Ile(){var r=6E4*
this.la.xHk;r=0<r?this.kL()-this.fad>=r:!1;N.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",r);return r}byb(){try{this.rt&&this.Y_?(this.t_e(),this.rt.businessBar.removeEntry(this.Y_),this.rt.Oq(),N.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!this.Y_.businessBar),this.Y_=null):N.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.rt,!!this.Y_)}catch(r){N.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",
r.toString())}}jrk(r){r===this.Y_&&(this.Y_=null)}lrk(r){r===this.Y_&&this.rj&&(this.byb(),this.Ile()||z.AFrameworkApplication.Ta.processAction(ab.a.Vya,2))}krk(r){r===this.Y_&&this.rj&&(this.Ile()?this.byb():this.rj.showEndSessionDialog())}Nvk(){const r=this.kL(),R=window.document.hidden;N.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",R?"hidden":"visible",r);R||this.dSa&&18E5<=r-this.RSg&&this.byb()}v5d(r,R,la){return!this.la.powerPointLiveBroadcastEnabled||
0===this.OVa&&this.la.isBlueChicken?new Promise(Ea=>{Ea(null)}):!la&&!this.cM||la&&!this.Nre?(N.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",r,R,la),new Promise((Ea,Qa)=>{Qa("AuthHelperNotSet")})):new Promise((Ea,Qa)=>{let wb=this.la.hostAuthType,Pb="";if("aad"===wb||this.la.isBlueChicken)Pb=this.la.pptLiveResourceUri;else if("msa"===wb)Pb=this.la.wHk;else{N.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",
r,R);Qa("HostAuthTypeInvalid");return}const xc="true"===z.AFrameworkApplication.fa.Ga("IsAnonymousUser").toLowerCase();let ed=z.AFrameworkApplication.fa.Ga(z.AFrameworkApplication.eK);db.a.Wa(ed)&&(ed="Unset");const jd=new Date;let bd=null;bd=la?this.Nre.$yl(this.la.IGk,this.la.HGk,Pb,z.AFrameworkApplication.fa.Ga("UserPrincipalName"),this.la.VGk,this.la.LGk&&"StartLiveBroadcasting"===r&&!this.la.Kah):this.cM.nV(this.la.pptLiveImplicitAuthAppName,Pb);bd.then(Ce=>{this.sqg(R,r,wb,la,xc,ed,Ce.IsSuccess,
+new Date-+jd,Ce.ErrorCode,Ce.ErrorMessage);Ce.IsSuccess?Ea(Ce.Token):Qa(Ce.ErrorCode)}).catch(Ce=>{this.sqg(R,r,wb,la,xc,ed,!1,+new Date-+jd,"exception",Ce.toString());Qa("exception")})})}Z4b(r,R){if(!this.la.powerPointLiveBroadcastEnabled||0===this.OVa&&this.la.isBlueChicken)return new Promise(Ea=>{Ea(null)});if("msa"===this.la.hostAuthType)return this.v5d(r,R,!1);const la=this;return new Promise((Ea,Qa)=>{la.v5d(r,R,!0).then(wb=>{Ea(wb)}).catch(()=>{la.v5d(r,R,!1).then(wb=>{N.a.J(512496194,833,
50,"LivePresenter::GetToken - WebAuth retry succeeded.");Ea(wb)}).catch(wb=>{Qa(wb)})})})}kL(){return(new Date).getTime()}sqg(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd){const bd={};bd.SessionId=r;bd.Action=R;bd.HostAuthType=la;bd.UseDirectAuth=Ea;bd.IsAnonymousUser=Qa;bd.UiHost=wb;bd.IsSuccess=Pb;bd.Latency=xc;bd.ErrorCode=ed;bd.ErrorMessage=jd;N.a.J(51197915,833,50,JSON.stringify(bd))}S_(r){this.Gd.telemetryData.action=r;this.Gd.telemetryData.sessionDurationInMS=this.kL()-this.fad;this.Gd.telemetryData.hostAuthType=
this.la.hostAuthType;this.Gd.SetStateServiceMetrics();this.Gd.telemetryData.errorCode.length&&(!this.Gd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.OGk,this.Gd.telemetryData.errorMessage))&&(this.Gd.telemetryData.hasUnexpectedError=!0);r=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==r.indexOf("pptservicescast.officeapps.live.com")?this.Gd.telemetryData.rendezvousServiceEnvironment="prod":-1!==r.indexOf("pptservicescast.edog.officeapps.live.com")?this.Gd.telemetryData.rendezvousServiceEnvironment=
"edog":-1!==r.indexOf("pptservicescast.officeapps.live-int.com")?this.Gd.telemetryData.rendezvousServiceEnvironment="int":this.Gd.telemetryData.rendezvousServiceEnvironment="dev";N.a.J(50706442,833,this.Gd.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Gd.telemetryData))}jvi(r){if(this.oc)try{var R=this.jq.presentation;if(!R)throw Error.argumentNull("Presentation is null");const la=R.slides||[];this.Vxe=la[la.length-1].sid;let Ea=R=!1;this.JVa=new Set;for(const Qa of la)R||Qa.sid!==r||
(R=!0,Ea=Qa.en),!R||Qa.en&&!Ea||this.JVa.add(Qa.sid),Ea&&!Qa.en&&(Ea=!1)}catch(la){this.Gd.telemetryData.SetErrorCode(16,la.toString()),N.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Gd.telemetryData.sessionId,la.toString())}}Ttd(r){return new Promise(R=>{if(this.vr&&this.Xn&&this.Rp&&this.Pbc)try{this.Pbc.then(la=>{let Ea=!1;switch(r){case 2:if(!this.Sua||!this.JVa||10*this.Sua.size<8*this.JVa.size){R(!0);
return}break;case 3:Ea=!0}const Qa={triggeredSurveyType:"Survey.AudienceFeedback"};Qa.isMandatory=Ea;Qa.triggerEventId=Xd.a.create().toString();Qa.surveyeeName=z.AFrameworkApplication.userName;la?(Qa.surveyId=la.surveyId,Qa.surveyResponseUrl=la.surveyResponseUrl):N.a.J(512496192,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Gd.telemetryData.sessionId);this.Xn.TriggerSurvey(JSON.stringify(Qa));N.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",
this.Gd.telemetryData.sessionId,r);R(!0)}).catch(la=>{N.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Gd.telemetryData.sessionId,la.toString());this.Gd.telemetryData.SetErrorCode(13,la.toString());R(!1)})}catch(la){this.Gd.telemetryData.SetErrorCode(17,la.toString()),N.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
this.Gd.telemetryData.sessionId,la.toString()),R(!1)}else R(!0)})}A3g(r,R){this.kb&&this.Xn&&R&&(this.kb.Cib(Object(m.a)(this,this.A3g,"onGetCurrentSlideShowPosition")),this.Xn.SetCurrentPosition(R.slideId,R.slideIndex,R.stc))}exa(r,R){this.rj&&this.rj.actOnCurrentSlideDimensionChange(R.slideHeight,R.Gwh,R.slideWidth,R.Jwh)}getCalloutMenuDefinition(){return this.w3b()?this.rj.getCalloutMenuDefinition():null}NEj(){const r=String.format("{0}{1}",this.la.Ehb,"reactions/heart/default/240_anim_f/heart.png"),
R=String.format("{0}{1}",this.la.Ehb,"reactions/yes/default/240_anim_f/yes.png"),la=String.format("{0}{1}",this.la.Ehb,"reactions/clap/default/240_anim_f/clap.png"),Ea=String.format("{0}{1}",this.la.Ehb,"reactions/laugh/default/240_anim_f/laugh.png"),Qa=String.format("{0}{1}",this.la.Ehb,"reactions/surprised/default/240_anim_f/surprised.png"),wb=String.format("{0}{1}",this.la.Ehb,"reactions/wonder/default/240_anim_f/wonder.png");this.Dma=[Object.assign(new Jk,{react:"yes",reactionCount:0,reactionImagePath:R,
numberOfAnimationFrames:40}),Object.assign(new Jk,{react:"heart",reactionCount:0,reactionImagePath:r,numberOfAnimationFrames:16}),Object.assign(new Jk,{react:"clap",reactionCount:0,reactionImagePath:la,numberOfAnimationFrames:40}),Object.assign(new Jk,{react:"laugh",reactionCount:0,reactionImagePath:Ea,numberOfAnimationFrames:77}),Object.assign(new Jk,{react:"surprised",reactionCount:0,reactionImagePath:Qa,numberOfAnimationFrames:68}),Object.assign(new Jk,{react:"wonder",reactionCount:0,reactionImagePath:wb,
numberOfAnimationFrames:70})];this.Akb=new Map;this.Efc=1;this.L7c=null}Xkh(){if(this.Dma){for(const r of this.Dma)r.reactionCount=0;this.rj&&this.rj.resetReactions()}}Snk(r){if(this.Akb){var R=this.Akb.has(r.slideId)?this.Akb.get(r.slideId)+1:1;this.Akb.set(r.slideId,R)}if(this.Dma&&!this.dSa&&this.Wte){for(const la of this.Dma)if(la.react===r.react){la.reactionCount+=1;break}if(this.rj){r=Array(this.Dma.length);for(R=0;R<this.Dma.length;R++)r[R]=Object.assign(new Jk,{react:this.Dma[R].react,reactionCount:this.Dma[R].reactionCount,
reactionImagePath:this.Dma[R].reactionImagePath,numberOfAnimationFrames:this.Dma[R].numberOfAnimationFrames});this.rj.setReactions(r)}}}IOb(r){return new Promise(R=>{if(this.vr&&this.Xn&&this.Rp)try{if(1>this.Akb.size)N.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Gd.telemetryData.sessionId,r),R(!0);else if(2===r&&(!this.Sua||1>this.Sua.size))N.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",
this.Gd.telemetryData.sessionId,r),R(!0);else{var la=null,Ea=0;this.Akb.forEach((wb,Pb)=>{wb>Ea&&(la=Pb.toString(),Ea=wb)});if(this.L7c&&la===this.L7c)N.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Gd.telemetryData.sessionId,r),R(!0);else{var Qa=this.Xn.TriggerSaveThumbnails(()=>this.Z4b("SaveThumbnails",this.Gd.telemetryData.sessionId),la);Qa?Qa.then(()=>{this.L7c=la;N.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",
this.Gd.telemetryData.sessionId,r);R(!0)}).catch(wb=>{N.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Gd.telemetryData.sessionId,wb.toString(),r);R(!1)}):(this.Gd.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),N.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),R(!1))}}}catch(wb){this.Gd.telemetryData.SetErrorCode(15,
wb.toString()),N.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Gd.telemetryData.sessionId,wb.toString()),R(!1)}else R(!0)})}aSa(){return this.la.pptEditorVoiceUXEnabled&&this.Ll&&this.Ll.instance?!0:!1}Nyi(r){if(this.aSa())switch(r){case 0:this.LGa&&this.Ll.instance.show(ResourceStrings.L_LivePresentations_Disconnected,bg.a.RYa);this.Gd.telemetryData.SetErrorCode(3);this.S_("DisconnectdToPrague");break;case 1:this.Ll.instance.hide();break;
case 2:this.LGa&&this.Ll.instance.show(ResourceStrings.L_LivePresentations_Connecting,bg.a.MGb);break;default:N.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Gd.telemetryData.sessionId)}else N.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Gd.telemetryData.sessionId)}jkc(r,R){this.aSa()?R.isConnected?this.Ll.instance.hide():this.LGa&&this.Ll.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,
bg.a.MGb):N.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Gd.telemetryData.sessionId)}f8d(r,R){r=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,r,R);this.la.XGk&&(r+="&shareable=true");return r}Jxl(r,R){try{const la=new da.a;if(1===r||2===r||4===r)la.add(this.Ttd(3)),la.add(this.IOb(3));la.count?Promise.all(la.toArray()).then(()=>R()).catch(()=>R()):R()}catch(la){N.a.J(512496150,
833,10,"failed to create end session task promises, error : {0}",la),R()}}get g6e(){const r=Fk.a.get("PPTLivePresentationOnboarded");return r?"true"===r.toLowerCase():!1}set g6e(r){Fk.a.$J("PPTLivePresentationOnboarded",r.toString(),Fk.a.DJ)||N.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",r.toString())}x2d(){return this.la.yHk&&!this.g6e}eaa(){try{if(N.a.J(512496148,833,15,"Pods session rehydrated!"),this.Z4c=!0,this.vr&&this.dr&&this.Xn){N.a.J(512496147,833,
15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Gd.telemetryData.sessionId,this.Xa.pk);const r=this.f8d(this.Xa.podSessionId,this.Xa.pk);this.Xn.OnPodSessionUpdated(r)}}catch(r){N.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",r.toString())}}lHb(){this.Z4c=!1}onPodSessionExpired(){this.Z4c=!1}Blb(){if(this.la.zHk)try{const r=A.a.instance.Ja("Common.ISystemInitiatedFeedback");r&&(N.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),
r.execute(R=>{R.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(r){N.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",r)}}$4f(r){const R=document.createElement("a");R.setAttribute("href",r);return(r=R.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===r.length?r[1]:""}a2i(){var r=this.oc.V6f();let R=1;this.qCe.clear();for(const la of r){r=la.Ek();for(const Ea of r)if(!db.a.Wa(Ea.Cgb)){r=
this.$4f(Ea.Cgb);const Qa=new Bp;Qa.qKg=r;Qa.rKg=R.toString();this.qCe.add(Qa);R+=1}}}aDh(){var r=this.oc.sEa(this.Bcb).Ek();for(const R of r)db.a.Wa(R.Cgb)||(r=this.$4f(R.Cgb),r=this.pCe.get(r),db.a.Wa(r)||this.Xn.SetCurrentPollInfoState(r,this.Bcb))}E$h(r){this.va.addHandler("OnLiveResourcesLoaded",r)}aZk(r){this.va.removeHandler("OnLiveResourcesLoaded",r)}yuf(r){this.va.addHandler("OnLiveSessionStarted",r)}Aih(r){this.va.removeHandler("OnLiveSessionStarted",r)}wuf(r){this.va.addHandler("OnLiveSessionEnded",
r)}zih(r){this.va.removeHandler("OnLiveSessionEnded",r)}M9h(r){this.va.addHandler("OnCalloutDismissed",r)}wYk(r){this.va.removeHandler("OnCalloutDismissed",r)}uuf(r){this.va.addHandler("OnRelaunchPausedSession",r)}xih(r){this.va.removeHandler("OnRelaunchPausedSession",r)}N9h(r){this.va.addHandler("CalloutMenuDefinitionChanged",r)}xYk(r){this.va.removeHandler("CalloutMenuDefinitionChanged",r)}}Object(h.a)(tr,"LivePresenter",null,[677]);class Oj{constructor(){this.K=null;this.ZHg=0}get name(){return"PowerPointWebEditor.Live"}Zb(r){this.K=
r;const R=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(677,"PowerPointLive.ILivePresenter").ma().oa(()=>new tr(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),R,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),A.a.instance.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),this.K.resolve("PowerPointWebEditor.IFocusManager")))}i0j(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.ZHg=Date.now(),N.a.J(509441559,
833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Ta.a.get_instance().ek(7,()=>{const r=this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw,R=xn.a(this.K),la=new da.a;la.add(r.loadScript("PPTLiveBroadcast"));la.add(r.loadScript("BroadcastMonitor"));la.add(R("liveActor"));z.AFrameworkApplication.Aa.hb.Np||la.add(R("uiFabricLazy"));Promise.all(la.toArray()).then(()=>this.Luk()).catch(Ea=>N.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Ea))})):
N.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(r){N.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",r)}}Pm(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").rHk){const r=db.a.fT((z.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===r||".pps"===r){N.a.J(509441556,
833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==r&&N.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+r)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").uHk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?N.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").vHk&&
(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?N.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jah&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?N.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>
{r.isFeatureEnabled("PowerPointLivePresentations",!1).then(R=>{R?this.i0j():(N.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else N.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(r){N.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",r)}}Luk(){N.a.J(509441549,833,
50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.ZHg);this.K.resolve("PowerPointLive.ILivePresenter").F8a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jah||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){z.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Dc(new Oj)}}
Object(h.a)(Oj,"PPTWebEditorLivePackage",null,[2,3]);var ks=d(722);class pn{}Object(h.a)(pn,"LokiTokenResult",null,[]);class Hq{constructor(r){this.tBc=r}hcj(){const r=this.gcj();return r?Hq.Dke?new Promise((R,la)=>{this.tBc.continueWith(()=>{this.tBc.Tn||this.tBc.tm?la(Error.create("Error downloading auth library")):this.tBc.result.nV("Loki",r).then(Ea=>{Ea=z.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.kcj():Ea.IsSuccess&&Ea.Token?Object.assign(new pn,{isSuccess:!0,
token:Ea.Token,errorMessage:null}):Object.assign(new pn,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Ea)});R(Ea);return Ea})})}):Promise.resolve(Object.assign(new pn,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new pn,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",ks.a.JZf())}))}kcj(){const r=z.AFrameworkApplication.fa.Ga("LokiUserDataSignature")||
"";return Object.assign(new pn,{isSuccess:!0,token:r,errorMessage:null})}gcj(){let r=null;const R=ks.a.qRc();2===R?r=z.AFrameworkApplication.fa.Ga("LokiAADAppId"):1===R&&(r=z.AFrameworkApplication.fa.Ga("LokiMSAAppId"));return r}static get Dke(){return z.AFrameworkApplication.fa.ka("IsO365CommercialHost")||z.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(h.a)(Hq,"LokiTokenManager",null,[738]);class $p{get name(){return"Common.App.LivePersonaUtils"}init(){A.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Zb(r){r.register(Hq,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().oa(()=>new Hq(Lf.a.$u(r.Ja("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Dc(new $p)}}Object(h.a)($p,"LivePersonaUtilsPackage",null,[2,3]);var Iq=d(260);class aq{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(h.a)(aq,"RehearsalCritique",null,[]);class Ke{static PDj(){Ke.wY[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Ke.wY[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
Ke.wY[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Ke.wY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;Ke.VNf=ResourceStrings.L_SubtitleDetection_MicReady;Ke.WNf=ResourceStrings.L_SubtitleDetection_SoundReminder;Ke.QSf=ResourceStrings.L_SubtitleDetection_NoMicrophone;Ke.WSf=ResourceStrings.l_NoCamera;Ke.eZf=ResourceStrings.L_SpeechGenericRetryErrorMessage}}Ke.IBf=20;Ke.Lgh=50002;Ke.wY=Array(Ke.IBf);Ke.VNf=null;Ke.WNf=null;Ke.QSf=null;Ke.WSf=null;Ke.eZf=null;Ke.k3d="fillerWords";
Ke.qAk="originality";Ke.FKl="wordsPerMinute";Ke.y8k="sensitivePhrases";Ke.tBi="correctedSensitivePhrases";Ke.pGk="positivity";Ke.Lae="grammar";Ke.oEe="monotone";Ke.dNe="pronunciation";Ke.PYd="crutchWords";Ke.pJh="visionFace";Ke.gJl="visionGaze";Ke.fJl="visionGazeGood";Ke.iJl="visionOcclusion";Ke.hJl="visionOcclusionGood";Ke.cJl="visionDistanceGood";Ke.dJl="visionDistanceTooClose";Ke.eJl="visionDistanceTooFar";Ke.c7f="GetStartedButton";Ke.y_j="ListeningButtonPlayPauseButton";Ke.z_j="ListeningElement";
Ke.hzi="ContainerElement";Ke.ZDk="PausedElement";Ke.Uok="NotificationButtonElement";Ke.NJl="WelcomeCheckboxElement";Ke.Ngh="RehearsalFeedbackSettingPane";Ke.yLe="PPTCoachRehearsalFREShown";Object(h.a)(Ke,"RehearsalResourceString",null,[]);const Fn=(r,R)=>db.a.Wa(R)?(n.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):r?R.toLowerCase()in r:!0,ur=(r,R)=>{let la=null;try{if(!r||db.a.Wa(R))return n.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Qa=db.a.Wa(r.Ukd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(r.Ukd,!0);la={};for(let wb in Qa){r=wb;var Ea=Qa[wb];if(Ea){const Pb=Cb.a.VZb(Ea.split(","));Pb&&R.toLowerCase()in Pb&&(la[r.toLowerCase()]=!0)}}}catch(Qa){N.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Qa.toString()),la=null}return la},vr=(r,R)=>{if(db.a.Wa(R)||db.a.Wa(r.H$g))return null;try{var la=Sys.Serialization.JavaScriptSerializer.deserialize(r.H$g,
!0);if(db.a.Wa(R)){n.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Ea=null}else Ea=R.split("-")[0].toLowerCase();return la[Ea]}catch(Qa){return N.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Qa.toString()),null}},Jq=r=>{if(r&&3<r.length){let R="";"ws"===r.substring(0,2)?R="http"+r.substring(2,r.length):"wss"===r.substring(0,3)&&(R="https"+r.substring(3,
r.length));return R}return r},wr=r=>{if(db.a.Wa(r))return n.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",r),"en-US";switch(r.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return r}};class Kq{constructor(){this.userCritiques=null}}Object(h.a)(Kq,"RehearseRoamingSettings",null,[]);class Dp{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(h.a)(Dp,"UserCritiqueSettings",null,[]);class xr{constructor(r,R,la,Ea){this.va=new nm.a;this.rJ=this.xcc=this.mU=null;this.QL=!1;this.Dtg=null;this.hwa=this.iwa=0;this.Ds=r;this.la=R;this.kHa=la;this.ia=Ea}RFj(){try{this.A5f(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(r){N.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",r.toString())}}I_c(){return 2===this.iwa&&2===this.hwa}J3e(){try{0!==
this.iwa&&3!==this.iwa||this.A5f(Object(m.a)(this,this.ePe,"raiseRehearsalGetCritiquesEvent")),0!==this.hwa&&3!==this.hwa||this.W8i()}catch(r){N.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",r.toString())}}R6i(){if(!this.xcc)return N.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.rJ)for(let r of this.xcc)this.rJ.contains(r.critique.toLowerCase())?r.optOut=!0:r.optOut=!1}catch(r){N.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
r.toString())}return this.xcc.toArray()}DEl(r,R){this.iHh(r,R);"vision"===r.toLowerCase()&&(this.QL=!R,r={},r.triggerPoint=Ke.Ngh,this.ia.La(ab.a.pOb,2,r))}t4f(r=!1){let R="";if(this.rJ&&0<this.rJ.count)if(Db.a("RehearsalFilterOptOutCritiqueEnabled")&&r){a:{var la=this.la;r=this.la.Txa;var Ea=null;try{if(!la||db.a.Wa(r)){n.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Qa=null;break a}var wb=
db.a.Wa(la.Ukd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(la.Ukd,!0);Ea={};for(let xc in wb){Qa=xc;var Pb=wb[xc];if(Pb){const ed=Cb.a.VZb(Pb.split(","));Ea[Qa.toLowerCase()]=ed&&r.toLowerCase()in ed?!0:!1}}}catch(xc){N.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",xc.toString()),Ea=null}Qa=Ea}if(Pb=Qa)for(let xc of this.rJ)if(wb="vision"===xc?Ke.pJh.toLowerCase():xc.toLowerCase(),wb in Pb?Pb[wb]:1)R=db.a.Wa(R)?
xc.toLowerCase():R+","+xc.toLowerCase()}else for(Ea of this.rJ)R=db.a.Wa(R)?Ea.toLowerCase():R+","+Ea.toLowerCase();return R}Zmd(){if(2!==this.iwa)N.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.FTj()){N.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var r=new Kq;r.userCritiques=Object.assign(new Dp,{critiquesDisabled:this.t4f(),critiquesDisabledByDefault:this.mU.userCritiques.critiquesDisabledByDefault});
var R=oe.c(r),la=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",z.AFrameworkApplication.gh),Ea={};Ea["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.mj(la,2,R,Ea,!1,2,Qa=>{this.jxk(Qa,r)},Object(m.a)(this,this.ixk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,Iq.a("17"))}else N.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get J2d(){return this.QL}set J2d(r){this.QL=
r;this.iHh("vision",!this.QL);this.I_c()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}x$h(r){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",r)}WYk(r){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",r)}w$h(r){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",r)}VYk(r){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",r)}v$h(r){this.va.addHandler("OnRehearsalGetCritiquesFailed",r)}UYk(r){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
r)}y$h(r){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",r)}XYk(r){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",r)}iHh(r,R){this.rJ&&(r=r.toLowerCase(),R&&!this.rJ.contains(r)?this.rJ.add(r):!R&&this.rJ.contains(r)&&this.rJ.remove(r),Db.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.Zmd())}FTj(){let r=!1;try{var R=db.a.Wa(this.mU.userCritiques.critiquesDisabled);if(!this.rJ||!this.rJ.count&&R)return!1;if(R&&0<this.rJ.count||!R&&!this.rJ.count)return!0;const la=new Set(this.mU.userCritiques.critiquesDisabled.split(","));
if(this.rJ.count!==la.size)return!0;for(R=0;R<this.rJ.count;R++)if(!la.has(this.rJ.ga(R).toLowerCase())){r=!0;break}}catch(la){N.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",la.toString())}return r}jxk(r,R){this.mU=R;N.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+r.data.pv-+r.data.yI,+r.data.Xt-+r.data.yI)}ixk(r){const R=this.kHa.cka(r);N.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
R,r.data.state)}A5f(r){const R=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",z.AFrameworkApplication.gh),la={};la["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.mj(R,1,null,la,!1,2,Ea=>{this.Otk(Ea,r)},Ea=>{this.Ntk(Ea,r)},null,void 0,void 0,void 0,void 0,Iq.a("16"));this.iwa=1}Otk(r,R){let la=0;try{r.data.Sd&&0<r.data.Sd.trim().length&&(la=r.data.Sd.length,
this.mU=JSON.parse(r.data.Sd));this.mU&&this.mU.userCritiques||(this.mU=new Kq,this.mU.userCritiques=new Dp);db.a.Wa(this.mU.userCritiques.critiquesDisabledByDefault)&&(this.mU.userCritiques.critiquesDisabledByDefault="vision",db.a.Wa(this.mU.userCritiques.critiquesDisabled)?this.mU.userCritiques.critiquesDisabled="vision":this.mU.userCritiques.critiquesDisabled+=",vision");this.rJ=new da.a;if(!db.a.Wa(this.mU.userCritiques.critiquesDisabled)){const Ea=this.mU.userCritiques.critiquesDisabled.split(",");
for(const Qa of Ea)this.rJ.add(Qa.toLowerCase())}this.QL=!this.rJ.contains("vision");this.iwa=2}catch(Ea){this.iwa=3,N.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Ea.toString())}R&&R();r=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",la,JSON.stringify(r.data.yI),JSON.stringify(r.data.Xt),JSON.stringify(r.data.pv));N.a.J(559548295,822,50,r)}Ntk(r,R){this.iwa=3;R&&R();r=this.kHa.cka(r);N.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",r)}W8i(){try{const R=this.fWi();if(db.a.Wa(R))N.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var r=new XMLHttpRequest;r.open("GET",R,!0);r.onreadystatechange=()=>{if(4===r.readyState){if(200===r.status){N.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const la=oe.b(r.responseText);if(la){this.xcc=new da.a;for(const Ea of la.critiquesData)this.xcc.add(Object.assign(new aq,
{category:Ea.category,displayName:Ea.displayName,optOut:!1,critique:Ea.critique.toLowerCase()}));this.Dtg=la.categoriesData;this.hwa=2}else this.hwa=3}else this.hwa=3;this.ePe()}};r.send("");this.hwa=1}}catch(R){this.hwa=3,this.ePe(),N.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",R.toString())}}fWi(){const r=oe.b(z.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",R=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return R&&R.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",R,r,wr(this.la.Txa)):null}ePe(){0!==this.iwa&&1!==this.iwa&&0!==this.hwa&&1!==this.hwa&&(this.I_c()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(h.a)(xr,"RehearsalFeedbackSettings",null,[664]);class Lq{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(h.a)(Lq,"RehearsalCritiqueWithGroupProps",null,[]);class sl{constructor(r,R,la,Ea,Qa){this.cHa=this.Eb=!1;r.loadScript("powerpoint-presenter-coach-strings").then(()=>{this.cHa=!0;N.a.J(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(wb=>{N.a.J(559548253,822,10,"Failed to load powerpoint-presenter-coach-strings "+
wb.toString())});this.ia=R;this.la=Qa;this.oE=la;this.oy=Ea;this.ia.oaa(this)}wb(){this.ia.ya(ab.a.Jqd,mb.a.application,Object(m.a)(this,this.Jqd,"showRehearsalFeedbackSettingsPane"));this.ia.ya(ab.a.zqd,mb.a.application,Object(m.a)(this,this.zqd,"showHideRehearsalFeedbackSettingsPane"));this.ia.ra(ab.a.Njd,mb.a.application,Object(m.a)(this,this.Njd,"queryShowHideRehearsalFeedbackSettingsPane"),96)}Ee(){}D5(){}C5(){}Jqd(r,R,la){if(R.contextId!==mb.a.application||!this.cHa)return 2;if(1===la)return 32;
this.Eb?oc.UISurfaces.zr().then(Ea=>{Ea.setSelectedTaskPane(dd.a.uib);this.yA(!0);return null}).catch(Ea=>{N.a.J(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Ea.toString())}):(this.Eb=!0,this.Igh(),(r=!this.oy.I_c())&&this.oy.J3e(),r=this.vC(r,!1),this.lrc(r),N.a.J(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}zqd(r,R,la){if(R.contextId!==mb.a.application||!this.cHa)return 2;if(1===la)return 32;
(this.Eb=!this.Eb)?(this.Igh(),(r=!this.oy.I_c())&&this.oy.J3e(),r=this.vC(r,!1),this.lrc(r),N.a.J(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.zui(),N.a.J(559548255,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}Njd(r,R,la,Ea,Qa){if(!Object(fl.a)(Hm.a,Qa))return 8;Qa.Mf(this.Eb);return 32}lrc(r,R=!1){const la=Object.assign(new Eb.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,
width:320,location:2,contentProps:r,onOpen:()=>{},onClose:()=>{this.Eb=!1;this.SKi();this.oy.Zmd()},onHide:()=>{this.oy.Zmd()},isModernPane:!0});r=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.oE.X8(dd.a.uib,dd.a.gj,r,()=>{this.yA(!0)},()=>{this.yA(!1)});oc.UISurfaces.zr().then(Ea=>{R?this.Eb&&Ea.updateTaskPane(dd.a.uib,la):Ea.showTaskPane(dd.a.uib,la);return null}).catch(Ea=>{N.a.J(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
Ea.toString())})}zui(){oc.UISurfaces.zr().then(r=>{r.hideTaskPane(dd.a.uib,2);return null}).catch(r=>{N.a.J(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",r.toString())})}vC(r,R){return Object.assign(new Lq,{groupItems:r||R?null:this.oy.R6i(),categoriesData:this.oy.Dtg,locale:this.la.Txa,updateCritiqueState:(la,Ea)=>{this.oy.DEl(la,Ea)},retryToFetchCritiqueSettings:()=>{this.oy.J3e()},showLoadingMessage:r,showErrorMessage:R})}yA(r){const R=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
r&&R&&R.focus()}Igh(){this.oy.w$h(Object(m.a)(this,this.l5g,"onRehearsalGetCritiquesSucceeded"));this.oy.v$h(Object(m.a)(this,this.k5g,"onRehearsalGetCritiquesFailed"));this.oy.y$h(Object(m.a)(this,this.n5g,"onRehearsalSettingsUpdatedExternally"))}SKi(){this.oy.VYk(Object(m.a)(this,this.l5g,"onRehearsalGetCritiquesSucceeded"));this.oy.UYk(Object(m.a)(this,this.k5g,"onRehearsalGetCritiquesFailed"));this.oy.XYk(Object(m.a)(this,this.n5g,"onRehearsalSettingsUpdatedExternally"))}l5g(){const r=this.vC(!1,
!1);this.lrc(r,!0)}k5g(){const r=this.vC(!1,!0);this.lrc(r,!0)}n5g(){const r=this.vC(!1,!1);r.isExternalUpdated=!0;this.lrc(r,!0)}}Object(h.a)(sl,"RehearsalFeedbackSettingsPane",null,[141]);var Vm;(function(r){r[r.none=0]="none";r[r.ribbon=1]="ribbon";r[r.slideShowToolbar=2]="slideShowToolbar";r[r.summaryPage=3]="summaryPage";r[r.ribbonTopBar=4]="ribbonTopBar";r[r.deepLink=5]="deepLink"})(Vm||(Vm={}));Object(h.b)("RehearsalEntryPoint",Vm);class fm{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(h.a)(fm,"ICoachActorConfig",null,[]);class yr{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(h.a)(yr,"ICoachFREActorConfig",null,[]);class Oo{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(h.a)(Oo,"ICoachSessionConfig",null,[]);class Mq{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(h.a)(Mq,"IDocumentDownloadConfig",null,[]);class Kk{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(h.a)(Kk,"ISlideState",null,[]);class zr{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(h.a)(zr,"IWebcamConfig",null,[]);var ip=d(675);class Po{constructor(r,R,la,Ea,Qa,wb,Pb,xc,ed,jd,bd,Ce,Bf,Df){this.tWa=!1;this.xw=this.Eqe=this.uX=this.kea=null;this.Ngc=0;this.wQg=-1;this.Xhc=0;this.acd=this.Qbd=null;this.Zte=this.Pte=!1;this.qAe=this.Ema=0;this.QL=!1;this.va=new nm.a;this.eYa=null;this.Oxg=this.dDe=this.Jpe=!1;this.sAe=null;this.Qbc=this.Ytg=0;this.sTg=this.gxg=!1;this.nxg=z.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.A7j=
la;R&&(this.kea=R.FF());this.kb=Ea;this.ia=r;this.oc=Qa;this.ua=wb;this.Xa=Pb;this.la=xc;this.Ll=ed;this.yea=jd;this.Mgc=bd;this.oy=Ce;this.iO=Bf;this.pB=Df;this.R3b()&&this.oy.x$h(Object(m.a)(this,this.m5g,"onRehearsalOptOutSettingsRequestFinished"))}wb(){this.ia.ya(ab.a.Wrc,mb.a.application,Object(m.a)(this,this.Wrc,"startRehearsalManager"));this.ia.ya(ab.a.pOb,mb.a.application,Object(m.a)(this,this.pOb,"toggleRehearsalVisionEnabled"));this.ia.ya(ab.a.aoc,mb.a.application,Object(m.a)(this,this.aoc,
"rehearsePresentationDropDown"));this.ia.ra(ab.a.uJb,mb.a.application,Object(m.a)(this,this.uJb,"queryRehearsalVisionEnabled"),96)}uJb(r,R,la,Ea,Qa){if(!Qa||!Object(fl.a)(Hm.a,Qa))return N.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Qa.Mf(this.QL);return 32}aoc(r,R,la){switch(la){case 1:if(this.tWa&&this.wme())return this.ia.processAction(ab.a.Pfa,1);break;default:N.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}pOb(r,
R,la,Ea,Qa){switch(la){case 2:return this.QL=!this.QL,z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.hb.Np&&yk.App.Kb.sG({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.R3b()&&Qa&&Qa.triggerPoint!==Ke.Ngh&&(this.oy.J2d=this.QL),32;case 1:if(this.tWa&&this.wme())return 32;break;default:N.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}Wrc(r,R,la,Ea,Qa){switch(la){case 2:return this.jql(Qa),32;case 1:if(this.tWa&&this.wme())return 32;break;default:N.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}dbc(){try{this.Ytg=Date.now();const r=this.A7j.Sw;r.loadScript("powerpoint-presenter-coach-strings").then(()=>{const R=new da.a;R.add(r.loadScript("CoachActorPackage"));R.add(r.loadScript("CoachPackage"));Promise.all(R.toArray()).then(()=>{this.Jrk();return null}).catch(la=>{N.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",la);return null})})}catch(r){N.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
r)}}O9h(r){this.va.addHandler("OnCoachResourcesLoaded",r)}yYk(r){this.va.removeHandler("OnCoachResourcesLoaded",r)}Jrk(){const r=z.AFrameworkApplication.fa.Ga("CoachPackageCssUrl"),R=document.createElement("link");R.setAttribute("rel","stylesheet");R.setAttribute("type","text/css");R.setAttribute("href",r);$addHandler(R,"load",()=>{this.tWa=!0;Db.a("PollToRefreshCoachEntryPointOnRibbon")&&this.pB&&this.pB.HH();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);N.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.Ytg)});document.body.appendChild(R)}qVk(){this.kb.BGc(Object(m.a)(this,this.r6g,"onSlideshowReady"));this.kb.GPa(Object(m.a)(this,this.Bkc,"onSlideShowPositionChanged"));this.kb.Aia(Object(m.a)(this,this.yfa,"onSlideshowExitHandler"));this.kb.CGc(Object(m.a)(this,this.oxa,"onSpecialKeyHandler"))}TKi(){this.kb.rld(Object(m.a)(this,this.r6g,"onSlideshowReady"));this.kb.Dib(Object(m.a)(this,this.Bkc,"onSlideShowPositionChanged"));this.kb.Rfa(Object(m.a)(this,this.yfa,"onSlideshowExitHandler"));
this.kb.tld(Object(m.a)(this,this.oxa,"onSpecialKeyHandler"))}oxa(r,R){R.key===Ba.a.YPb&&this.qVe()}qVe(){if(0===this.Ema){var r=this.xw.getCoachElement(Ke.c7f);r&&this.SKa(r)}else 2===this.Ema?(r=this.xw.getCoachElement(Ke.ZDk))&&this.SKa(r):1===this.Ema&&(r=this.xw.getCoachElement(Ke.z_j))&&this.SKa(r)}SKa(r){this.kea&&this.xw&&window.setTimeout(()=>{ec.FocusManager.Wr(r)},50)}Zz(r){try{const Qa=this.xw.getCoachElement(Ke.c7f),wb=this.xw.getCoachElement(Ke.y_j),Pb=this.xw.getCoachElement(Ke.NJl),
xc=this.xw.getCoachElement(Ke.Uok);if(r.keyCode===Ba.a.Sq){if(!Db.a("PresenterCoachTabFix")){var R=!Pb&&!!Qa&&r.target===Qa||!!Pb&&r.target===Pb,la=!!Qa&&!!wb&&wb.contains(r.target),Ea=!!xc&&r.target===xc;(R||la||Ea)&&this.kb.restoreFocus()}}else r.keyCode===Ba.a.VR||r.keyCode===Ba.a.U1?(this.kb.prev(),this.qVe()):r.keyCode===Ba.a.oP||r.keyCode===Ba.a.S1?(this.kb.next(),this.qVe()):r.keyCode===Ba.a.tq||r.keyCode===Ba.a.DPb||r.shiftKey||this.kb.restoreFocus()}catch(Qa){N.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Qa)}}BUk(){const r=this.xw.getCoachElement(Ke.hzi);if(Db.a("PresenterCoachTabFix")){var R=document.getElementById("HiddenFocusTrapAnchor");this.kea.insertBefore(r,R)}else R=document.getElementById("slideshowEndFocusTrap"),this.kea.insertBefore(r,R);r&&nd.a.addHandler(r,ha.a.Yf,Object(m.a)(this,this.Zz,"keyDownHandler"))}jql(r){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");Ke.PDj();this.qVk();this.R3b()&&(this.oy.Zmd(),this.oy.WYk(Object(m.a)(this,this.m5g,"onRehearsalOptOutSettingsRequestFinished")));
const R=new Kk;this.eYa=ur(this.la,this.la.Txa);this.QL&&!this.la.pptRehearsalVisionEnabled&&N.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.QL=this.QL&&this.la.pptRehearsalVisionEnabled;var la=new jo.a,Ea=Object(D.a)(115,this.oc.sEa(this.ua.Ba.Cb.sid));R.currentSlideIndex=Ea?Ea.le:0;R.totalSlideCount=this.oc.pj();Ea=this.l5i(R);this.xw=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Ea,la);this.QL&&(this.Qbd=this.xw.getRehearsalVideoElement(),
this.acd=this.xw.getRehearsalVideoCanvas());this.qAe=r;r=this.X5d(R,this.Qbd,this.acd);this.uX=(new CoachPackage.CoachSessionFactory).createCoachManager(r);r=this.m5i();this.Eqe=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(r,la);Db.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.iO.enumerateDevices(Object(m.a)(this,this.Ujc,"onEnumerateDevicesSuccess"),Object(m.a)(this,this.$Ya,"onDevicesFailure"),Object(m.a)(this,this.kZa,"onUnsupported"));this.uTk();this.vTk();
this.Ngc=0;this.Zte=!1;this.BUk();2===this.qAe&&(la=localStorage.getItem(Ke.yLe),this.nxg&&!la?this.Xxh():this.c_e())}c_e(){this.Ema=0;this.yea.execute(r=>{r.jD(ip.a.SubtitlesButton,!1);r.jD(ip.a.LiveButton,!1);r.jD(ip.a.CoachButton,!1);r.jD(ip.a.MicButton,!1)});this.uX.startSession(!0)}Xxh(){this.Eqe.showCoachFREUI(r=>{localStorage.setItem(Ke.yLe,"true");this.sTg=r;this.c_e()})}Ujc(r){this.Qbc=0;if(r.length)for(var R of r)"audioinput"===R.kind&&(this.Qbc+=1);else this.Qbc=0;this.gxg=!0;r=new Kk;
R=Object(D.a)(115,this.oc.sEa(this.ua.Ba.Cb.sid));r.currentSlideIndex=R?R.le:0;r.totalSlideCount=this.oc.pj();r=this.X5d(r,this.Qbd,this.acd);this.uX.updateSessionConfiguration(r)}$Ya(r){N.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",r.toString())}kZa(){N.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",Ae.a.Sy)}r6g(){const r=localStorage.getItem(Ke.yLe);this.nxg&&!r?this.Xxh():this.c_e()}Bkc(r,
R){r=new Kk;r.currentSlideIndex=R.slideIndex;r.totalSlideCount=this.oc.pj();R=this.X5d(r,this.Qbd,this.acd);this.uX.updateSessionConfiguration(R);this.xw.updateCoachSlideComponent(r)}getTraceRequestMetadata(r,R){const la={};if(r)for(let Ea in r)la[Ea]=r[Ea];if(R)for(let Ea in R)la[Ea]=R[Ea];r=oe.b(z.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());la.AudienceGroup=r.Ring||"Unknown";la.BuildVersion=z.AFrameworkApplication.buildVersion||"Unknown";la.ClientType="web";la.IdentityProvider=
this.la.hostAuthType||z.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown";la.Locale=this.la.HJa||"Unknown";la.SpeechMode="rehearsal";la.TenantId=z.AFrameworkApplication.fa.Ga("TenantId");la.UserId=this.getUserId();la.WacDatacenter=r.WACDatacenter||"Unknown";la.WacHost=r.Host||"Unknown";la.SourceLanguage=this.la.kGf||wr(this.la.Txa);return la}getUserId(){let r=z.AFrameworkApplication.fa.Ga("PptEditingUserId");db.a.Wa(r)&&(r=z.AFrameworkApplication.fa.Ga("LoggableUserId"),n.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",db.a.Wa(r)));return r}X7k(){if(this.la.WEk){var r=this.uX.getTraceRequestMetadata(),R=this.xw.getTraceRequestMetadata(),la=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(la&&la.length){var Ea=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",la);la=new XMLHttpRequest;la.open("POST",Ea,!0);Ea=Xd.a.create().toString();la.setRequestHeader("X-Correlation",Ea);try{n.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Ea);const Qa=this.getTraceRequestMetadata(r,R);la.send(oe.c(Qa))}catch(Qa){n.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Ea)}}else n.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}yfa(){this.TKi();this.Ema=3;this.uX.stopSession();this.Eqe.hideCoachFREAndWelcomeUI();this.xw.hideCoachUI();this.dDe=this.Jpe=!1;try{this.uX.getSessionSummary(r=>
{r.timeSpentInSeconds=this.Ngc;this.ia.processAction(ab.a.tOc,2);this.ia.processAction(ab.a.sOc,2);window.clearInterval(this.wQg);this.Zte&&this.Mgc.instance.oLa(r,this.QL,this.eYa,this.sAe,()=>{this.X7k()})})}catch(r){n.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",r)}}Xgj(){let r=",visionFace";this.la.IHk&&(r+=","+Ke.gJl+","+Ke.fJl);this.la.JHk&&(r+=","+Ke.iJl+","+Ke.hJl);this.la.HHk&&(r+=","+Ke.cJl+","+Ke.dJl+","+Ke.eJl);return Ke.FKl+(Fn(this.eYa,
Ke.k3d)?","+Ke.k3d:"")+","+Ke.y8k+","+Ke.tBi+","+Ke.qAk+","+Ke.pGk+(this.la.zLe&&Fn(this.eYa,Ke.Lae)?","+Ke.Lae:"")+(this.la.NKe&&Fn(this.eYa,Ke.oEe)?","+Ke.oEe:"")+(this.la.pptRehearsalVisionEnabled&&Fn(this.eYa,Ke.pJh)?r:"")+(this.la.pptRehearsalPronunciationEnabled&&Fn(this.eYa,Ke.dNe)?","+Ke.dNe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&Fn(this.eYa,Ke.PYd)?","+Ke.PYd:"")}X5d(r,R,la){const Ea=new Oo;Ea.disabledCoachRealtimeFeatures="";Ea.userSessionId=z.AFrameworkApplication.userSessionId;var Qa=
new Mq;Qa.docId=z.AFrameworkApplication.gh;Qa.podsSessionId=this.Xa.podSessionId;Qa.userDataCenterClusterId=this.Xa.pk;Qa.webServiceBase=this.la.podsWebServiceBase;Ea.documentDownloadConfig=Qa;Qa=new jo.a;Ea.logger=Qa;Qa={};Qa.currentSlideIndex=r.currentSlideIndex.toString();Ea.customSettings=Qa;Ea.fEnableServiceSideAggregationForCoach=this.la.Aid;Ea.httpTimeoutForCoachSummaryData=this.la.UHk;Ea.fSendClientMetaDataOnSessionStart=this.la.MQi;Ea.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Ea.requestedCoachFeatures=
this.Xgj();this.R3b()&&(this.sAe=this.oy.t4f(!0),Ea.requestedRehearsalOptOutFeatures=this.sAe);Db.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Ea.enableTimeStampedCritiqueTelemetry=!0);Ea.entryPoint=Vm[this.qAe];Ea.fEnableVision=this.QL;Ea.fEnableVision&&R&&la&&(Ea.webcamConfig=Object.assign(new zr,{videoView:R,workingCanvas:la,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.LHk}));Ea.supportedRehearsalTemplates=this.xw.getSupportedRehearsalTemplates();
Db.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.gxg&&(Ea.audioInputDeviceCount=this.Qbc);r=oe.b(z.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Ea.userId=this.getUserId();Ea.tenantId=z.AFrameworkApplication.fa.Ga("TenantId");Ea.identityProvider=this.la.hostAuthType||z.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown";Ea.audienceChannel="";Ea.audienceGroup=r.Ring||"Unknown";Ea.buildVersion=z.AFrameworkApplication.buildVersion||"Unknown";Ea.locale=this.la.HJa||
"Unknown";Ea.wacHost=r.Host||"Unknown";Ea.wacDatacenter=r.WACDatacenter||"Unknown";Ea.sourceLanguage=this.la.kGf||wr(this.la.Txa);N.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.HJa,this.la.Txa);return Ea}m5i(){const r=new yr;r.rootContainer=this.kea;r.zIndex=Ke.Lgh;r.imagesBaseFilePath=z.AFrameworkApplication.fa.Ga("CoachImagesBaseFilePath");return r}l5i(r){const R=new fm;R.rootContainer=this.kea;R.slideState=r;R.imagesBaseFilePath=
z.AFrameworkApplication.fa.Ga("CoachImagesBaseFilePath");R.zIndex=Ke.Lgh;R.fEnableVision=this.QL;R.fShowRealtimeFeedbackEnabledCheckbox=this.la.VEk;R.fUseNewRealtimePanel=this.la.Tkd;R.fUseCountdownWelcomeScreen=z.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");R.speechFDBase=Jq(this.la.pptEditorSpeechHandlerBaseUri);R.fDontShowTooltips=Ae.a.eg;R.fUseNewRealtimeCheckbox=Db.a("UseNewRealtimeCheckbox");return R}UEl(){2!==this.Ema&&(this.Ngc+=1,this.xw&&this.xw.updateTimer(this.Ngc))}uTk(){this.xw.on("CoachSessionStarted",
()=>{this.Ema=1;this.wQg=window.setInterval(Object(m.a)(this,this.UEl,"updatePresentationTimer"),1E3);this.uX.enableVoiceStreaming();this.vml();this.Zte=!0});this.xw.on("CoachSessionPaused",()=>{this.Ema=2;this.uX.pauseSession();this.Kja()&&this.Ll.instance.hide()});this.xw.on("CoachSessionResumed",()=>{this.Ema=1;this.uX.resumeSession()})}vTk(){this.uX.on("SpeechRecognitionStarted",()=>{this.Pte&&this.Kja()&&(this.Ll.instance.hide(),this.Pte=!1)});this.uX.on("PPTCoachRealtimeNotification",r=>{this.jrj(r)});
this.uX.on("QualityStatusChanged",r=>{this.Juj(r)});this.uX.on("MediaStatusChanged",r=>{this.mtj(r)});this.uX.on("Error",r=>{this.handleError(r)});this.uX.on("ConnectionRetry",()=>{this.rsj()})}rsj(){this.Pte=!0;this.Kja()&&this.Ll.instance.show(Ke.eZf,bg.a.RYa)}jrj(r){this.xw.updateCoachRealtimeNotification(r)}handleError(r){r=Object(D.a)(String,r);this.Ema=4;r?r.startsWith("ErrorAudio")?(this.xw&&this.xw.showCoachDisabledUI(0),this.Kja()&&this.Ll.instance.show(Ke.QSf,bg.a.RYa)):r.startsWith("ErrorVideo")?
(this.xw&&this.xw.showCoachDisabledUI(1),this.Kja()&&this.Ll.instance.show(Ke.WSf,bg.a.RYa)):N.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):N.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}Rxh(){this.xw&&(this.QL&&this.xw.enableCoachVideoUI(),this.xw.showCoachRealtimeUI(this.sTg));this.Kja()&&this.Ll.instance.show(Ke.VNf,bg.a.Rdd)}mtj(r){"AudioDeviceConnected"===r.mediaStatus?(this.Jpe=!0,this.QL&&!this.dDe||this.Rxh()):"VideoSetupCompleted"===r.mediaStatus&&
(this.dDe=!0,this.Jpe&&(this.xw&&this.xw.enableCoachVideoUI(),this.Rxh()))}Juj(r){if(this.la.pptEditorVoiceUXEnabled){var R=r.severity,la=r.shortCode;if(0<la&&la<Ke.IBf&&Ke.wY[la])switch(R){case 0:this.Kja()&&this.Ll.instance.hide();break;case 1:(r=0<la?Ke.wY[la]:r.shortString)&&this.Kja()&&this.Ll.instance.show(r,bg.a.MGb);break;case 2:(r=0<la?Ke.wY[la]:r.shortString)&&this.Kja()&&this.Ll.instance.show(r,bg.a.RYa)}else N.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}Kja(){return this.la.pptEditorVoiceUXEnabled&&
this.Ll&&this.Ll.instance&&2!==this.Ema?!0:!1}vml(){this.Kja()&&(this.Ll.instance.show(Ke.WNf,bg.a.Rdd),this.Xhc=window.setTimeout(Object(m.a)(this,this.Cce,"hideSoundReminderNotification"),3E3))}Cce(){this.Kja()&&(window.clearTimeout(this.Xhc),this.Ll.instance.hide())}R3b(){return this.la.EIb&&!!this.oy}wme(){return this.R3b()?this.Oxg:!0}m5g(){this.Oxg=!0;this.QL=this.oy.J2d;Db.a("PollToRefreshCoachEntryPointOnRibbon")&&this.pB&&this.pB.HH()}}Object(h.a)(Po,"RehearsalManager",null,[665]);class jt{constructor(r,
R,la){this.Co=r;this.ia=R;this.la=la}oLa(r,R,la,Ea,Qa){try{const xc=document.createElement("div");xc.id="SummaryPageOverlay";xc.style.width="100%";xc.style.height="100%";xc.style.zIndex="999";xc.style.display="flex";xc.style.flexDirection="column";xc.style.justifyContent="center";xc.style.position="absolute";var wb=document.getElementById("SummaryPageOverlay");wb&&document.body.removeChild(wb);document.body.insertBefore(xc,document.body.firstChild);const ed=xc.parentNode;nd.a.addHandler(ed,ha.a.Yf,
Object(m.a)(this,this.Q4g,"onParentNodeKeyDownHandler"));var Pb=r.thumbIndices;if(Pb){wb={};let Bf=0;const Df=this.Ujj(Pb);for(let Eh=0;Eh<Pb.length;Eh++)wb[Pb[Eh].toString()]=Df[Eh],Df[Eh]||Bf++;N.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Pb.length,Bf);r.slideImageSrcs=wb}else r.slideImageSrcs={},N.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const jd=z.AFrameworkApplication.TE;jd||N.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");la||(la=ur(this.la,this.la.Txa));Pb={};const bd=oe.b(z.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Pb.fFeedbackCardEnabled=this.la.XEk&&jd;Pb.fShowFeedbackButton=jd;Pb.fMonotoneEnabled=this.la.NKe&&Fn(la,Ke.oEe);Pb.fGrammarEnabled=this.la.zLe&&Fn(la,Ke.Lae);Pb.fFillersCardEnabled=Fn(la,Ke.k3d);Pb.locale=this.la.Txa;Pb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&Fn(la,Ke.dNe);Pb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&Fn(la,Ke.PYd);Pb.fVisionEnabled=R&&this.la.KHk&&this.la.pptRehearsalVisionEnabled;const Ce=vr(this.la,this.la.Txa);db.a.Wa(Ce)||(Pb.fPacingGaugeRange=Ce);db.a.Wa(bd)||(Pb.clientSessionId=bd);this.la.EIb&&(Pb.rehearsalOptOutFeatures=Ea);(new rehearsalSummaryPage.RehearsalSummaryPageController(xc,r,()=>{N.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Qa&&Qa();this.ia&&(xc.parentNode.removeChild(xc),this.ia.La(ab.a.Pfa,2,{entryPoint:3}))},()=>{Qa&&Qa();nd.a.removeHandler(ed,ha.a.Yf,Object(m.a)(this,this.Q4g,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.Lhd),()=>{this.Pkl()},Pb,Jq(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.mkl()})).renderSummaryPage()}catch(xc){N.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",xc.toString())}}Q4g(r){"MainApp"===
r.target.id&&(r.preventDefault(),r.stopPropagation())}mkl(){N.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.EIb&&this.ia.La(ab.a.Jqd,2,null)}Pkl(){N.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.aHk?this.ia.La(ab.a.Qgh,2,null):this.ia.La(u.a.giveFeedback,2,!1))}Ujj(r){const R=Array(r.length);if(!this.Co)return R;const la=this.Co.pL(),Ea=this.Co.oTa();
for(let Qa=0;Qa<r.length;Qa++){const wb=Ea[la[r[Qa]].sid.toString()];wb&&wb.thumbnailImage.length&&(R[Qa]=wb.thumbnailImage)}return R}}Object(h.a)(jt,"RehearsalSummaryPageHelper",null,[]);class jp{constructor(r,R,la,Ea,Qa){this.tWa=!1;this.va=new nm.a;this.ia=r;this.P5c=new jt(R,this.ia,Ea);this.kye=la;this.vad=Qa}wb(){this.ia.ya(ab.a.oLa,mb.a.application,Object(m.a)(this,this.zml,"showSummaryPage"));this.ia.ya(ab.a.Qgh,mb.a.application,Object(m.a)(this,this.Xkl,"showFloodgateSurvey"))}oLa(r,R,la,
Ea,Qa){this.P5c.oLa(r,R,la,Ea,Qa)}zml(r,R,la,Ea,Qa){switch(la){case 2:return this.P5c.oLa(Qa,!1,null,null,null),32;case 1:if(this.tWa)return 32;break;default:N.a.J(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}Xkl(r,R,la){switch(la){case 2:return this.vad.execute(Ea=>{Ea.YMb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.tWa)return 32;break;default:N.a.J(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}dbc(){const r=
Date.now();this.kye("rehearsalSummaryPage").then(()=>{const R=z.AFrameworkApplication.fa.Ga("RehearsalSummaryPageCssUrl"),la=document.createElement("link");la.setAttribute("rel","stylesheet");la.setAttribute("type","text/css");la.setAttribute("href",R);$addHandler(la,"load",()=>{this.tWa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);N.a.J(555798673,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-r)});document.body.appendChild(la);return null})}z$h(r){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
r)}YYk(r){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",r)}}Object(h.a)(jp,"RehearsalSummaryPageActor",null,[663]);class bq{constructor(r,R,la,Ea,Qa){this.Clg=this.$gg=!1;this.ia=r;this.Ha=R;this.rAe=la;this.Mgc=Ea;this.Hwa=Qa;this.rAe.execute(wb=>{wb.O9h(Object(m.a)(this,this.l2g,"onCoachResourcesLoaded"))});this.Mgc.execute(wb=>{wb.z$h(Object(m.a)(this,this.o5g,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.rAe.instance&&this.rAe.instance.yYk(Object(m.a)(this,this.l2g,"onCoachResourcesLoaded"));
this.Mgc.instance&&this.Mgc.instance.YYk(Object(m.a)(this,this.o5g,"onRehearsalSummaryResourcesLoaded"))}l2g(){this.$gg=!0;this.bDh()}o5g(){this.Clg=!0;this.bDh()}bDh(){this.$gg&&this.Clg&&Ta.a.get_instance().ek(10,null).continueWith(()=>{if(this.Ha.Euh&&this.Ha.GHk){const r=document.getElementById("rehearsal-loading-dialog-modal");r?(r.style.display="none",N.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):N.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(ab.a.Pfa,1))if(this.Ha.Euh)this.ia.La(ab.a.Pfa,2,{entryPoint:5});else if(!this.Ha.HQ&&this.Ha.Oah&&this.Ha.hHk)try{this.Hwa.continueWith(()=>{this.Hwa.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),N.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(r){N.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",r)}})}}Object(h.a)(bq,
"RehearsalTrigger",null,[666]);class ik{constructor(){this.K=this.oy=null}get name(){return"PowerPointWebEditor.Rehearsal"}iyi(){this.K.register(663,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().oa(()=>new jp(z.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),xn.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ja("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").wb()}Zb(r){this.K=
r;this.K.Ja("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.iyi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(664,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().oa(()=>new xr(z.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.oy=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const R=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(665,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().oa(()=>new Po(z.AFrameworkApplication.Ta,R,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
A.a.instance.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),A.a.instance.Ja("PowerPointWebEditor.ISlideshowToolbar"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.oy,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").wb();this.K.register(666,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().oa(()=>new bq(z.AFrameworkApplication.Ta,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalManager"),A.a.instance.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Lf.a.$u(A.a.instance.Ja("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){z.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").kac&&Ta.a.get_instance().ek(7,
()=>{this.K.Ja("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").dbc();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").dbc();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").EIb){const r=new sl(this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw,
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.oy,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));r.wb();r.Ee();this.oy.RFj()}}dispose(){}static main(){e.a.instance.Dc(new ik)}}Object(h.a)(ik,"PPTWebEditorRehearsalPackage",null,[2,3]);class kp{constructor(){this.message=null;this.zv=0}}Object(h.a)(kp,"HttpRequstToPromiseRejectData",null,[]);class cq{constructor(r){this.Uba=r}FVa(r,R,la,Ea,Qa,wb){v.a.sendTelemetryEvent(Object.assign(new G.a,
{name:"Office.Online."+r,dataFields:[Object.assign(new J.a,{name:"EventMessage",string:R}),Object.assign(new J.a,{name:"FormFactor",string:this.Uba.formFactor}),Object.assign(new J.a,{name:"CorrelationId",string:this.Uba.correlationId}),Object.assign(new J.a,{name:"AccountType",string:this.Uba.accountType}),Object.assign(new J.a,{name:"OSVersion",string:this.Uba.osVersion}),Object.assign(new J.a,{name:"AppId",string:this.Uba.appId}),Object.assign(new J.a,{name:"ConsentSurface",string:"AppStart"}),
Object.assign(new J.a,{name:"ConsentLanguage",string:this.Uba.consentLanguage}),Object.assign(new J.a,{name:"EventCode",string:la}),Object.assign(new J.a,{name:"Region",string:this.Uba.region}),Object.assign(new J.a,{name:"ModelType",string:Ea}),Object.assign(new J.a,{name:"ModelId",string:Qa}),Object.assign(new J.a,{name:"Platform",string:this.Uba.os}),Object.assign(new J.a,{name:"ReConsentReason",string:""}),Object.assign(new J.a,{name:"ConsentType",string:wb})]}))}}Object(h.a)(cq,"TelemetryLogger",
null,[]);class dq{constructor(r,R,la){this.XOh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.$a=r;this.Xh=R;this.bca=new cq(la)}q1b(r,R,la,Ea=null,Qa=null){return new Promise((wb,Pb)=>{const xc=null!=Ea?Ea:this.$a.Bc("ApplicationFeatureHelperRequestQueueTimeout",1E3),ed=null!=Qa?Qa:this.$a.Bc("ApplicationFeatureHelperRequestSentTimeout",2E3);let jd=this.$a.Ga("UCNoticeCheckinStateUrl");jd&&jd.length||(jd=this.XOh);this.Xh.ZV(jd,1,null,this.v7d(r),null,0,bd=>{try{if(void 0===
bd||null===bd||void 0===bd.data||null===bd.data||void 0===bd.data.Sd||null===bd.data.Sd){this.bca.FVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : invalid response","511",null,null,null);let Bf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Pb(this.hka(Bf,bd))}else if(bd.data.oe!==Id.a.Uv){this.bca.FVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed",
bd.data.oe.toString(),null,null,null);let Bf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",bd.data.oe,"UnifiedConsent.ConsentGetFailed");Pb(this.hka(Bf,bd))}else{var Ce=la(bd.data.Sd);if(Ce)wb(Ce);else{this.bca.FVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Consent Values are empty","512",null,null,null);let Bf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Pb(this.hka(Bf,bd))}}}catch(Bf){this.bca.FVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Unexpected Failure","601",null,null,null),Ce=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Bf,"UnifiedConsent.ConsentGetFailed"),Pb(this.hka(Ce,bd))}},bd=>{let Ce;this.bca.FVa("UnifiedConsent.ConsentGetFailed","ConsentGetFailed : Error in service call","513",null,null,null);db.a.$Tc(bd.data.Sd||"No Data");Ce=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
bd.data.oe,"UnifiedConsent.ConsentGetFailed");Pb(this.hka(Ce,bd))},null,void 0,void 0,xc,ed)})}hka(r,R){const la=new kp;la.message=r;la.zv=R&&R.data?R.data.oe:-1;return la}v7d(r){const R={};R["Accept-Language"]=this.$a.Ga("UICulture")||"en-US";R.consentsurface="AppStart";R.platform="Web";R.formfactor=this.$a.ka("IsMobileMode")?"Mobile":"Desktop";R["x-Cid"]=Xd.a.create();R.Authorization="Bearer "+r;return R}}Object(h.a)(dq,"HttpRequestToPromiseUtility",null,[]);class Ep{constructor(){this.accountType=
"MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(h.a)(Ep,"WebSdkAdapterProps",null,[]);class il{constructor(r,R,la,Ea){this.zdf=this.Qwc=this.bpb=this.c4a=null;this.Kmb=Ea;this.$a=r;this.yNh=la;this.Xh=R;this.sFc=this.kSc();this.bca=new cq(this.sFc)}pkl(){"MSA"===
(this.$a.Ga("HostAuthType")||"").toUpperCase()&&this.yNh.execute(r=>{r.nV("Consent",il.t1h).then(R=>{R.IsSuccess?this.X5i(R.Token).then(la=>{this.Zcj(la);this.c4a&&""!==this.c4a&&r.nV("Consent",il.v1h).then(Ea=>{Ea.IsSuccess?this.Lll(Ea,this.c4a):this.bca.FVa(il.IEd,"ConsentGetFailed : Web token generation error",Ea.ErrorCode,this.c4a,this.bpb,this.Qwc);return{}});return{}}):this.bca.FVa(il.IEd,"ConsentGetFailed : Checkin token generation error",R.ErrorCode,this.c4a,this.bpb,this.Qwc);return{}})})}X5i(r){this.zdf=
new dq(this.$a,this.Xh,this.sFc);return this.zdf.q1b(r,this.sFc,Object(m.a)(this,this.xCk,"parseConsentCheckinState")).then(R=>Promise.resolve(R),R=>Promise.reject("Error while getting result"+R))}xCk(r){({rv:r}=oe.d(r));return r}Zcj(r){for(const R of r.consentValues)if(R.needConsent&&!R.maxPromptsReached){this.bpb=R.id;this.Qwc=R.consentType;this.c4a=R.modelType;break}}Lll(r,R){if(Bb.a("showConsentNotice")){const la=document.createElement("div");document.body.appendChild(la);appChrome.api.showConsentNotice(this.g8i(r.Token,
R),la)}else this.bca.FVa(il.IEd,"ConsentGetFailed : appChrome API does not exist","604",this.c4a,this.bpb,this.Qwc)}g8i(r,R){const la=this.sFc;la.token=r;la.modelType=R;return la}kSc(){const r=this.Yde(this.$a.Ga("SessionStartInfoJson"));return Object.assign(new Ep,{emailId:this.$a.Ga("UserPrincipalName"),userId:this.$a.Ga("LoggableUserId"),accountType:"AAD"===(this.$a.Ga("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.$a.Ga("OfficeApplicationId"),appVersion:this.$a.Ga("appVersion"),appName:"Application"in
r?r.Application:"",appEnv:this.Kmb,consentLanguage:this.$a.Ga("UICulture")||"en-US",formFactor:Ae.a.VZc?"Mobile":"Desktop",os:"Os"in r?r.Os:"",osVersion:"OsVersion"in r?r.OsVersion:"",region:this.$a.Ga("region"),correlationId:Xd.a.create().toString(),isDarkMode:this.$a.ka("DarkModeIsOn"),useCache:!0})}Yde(r){let R={};try{R=oe.b(r)}catch(la){}return R}}il.v1h="https://consentservice.microsoft.com/web";il.t1h="https://consentservice.microsoft.com/checkin";il.IEd="UnifiedConsent.ConsentGetFailed";Object(h.a)(il,
"ConsentNoticeManager",null,[719]);class Nq{constructor(){this.Da=null}get name(){return"Common.App.ConsentNoticeDialog"}Zb(r){this.Da=r;r.register(il,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().oa(()=>new il(z.AFrameworkApplication.fa,z.AFrameworkApplication.Ke,r.Ja("Common.App.OAuth.IOAuthManager"),z.AFrameworkApplication.TRa))}init(){this.Da.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){e.a.instance.Dc(new Nq)}}
Object(h.a)(Nq,"ConsentNoticeDialogPackage",null,[2,3]);var tl=d(12);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");
Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");
Type.registerNamespace("PowerPointWebEditor.VersionHistory");Object(tl.c)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");gc.main();tb.main();Ge.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Nc.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Dc(new of);Type.registerNamespace("Common.App.DisplayEnvironmentName");tf.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");
Yg.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Dc(new ke);Type.registerNamespace("Common.App.OneDriveFilePickerApi");bi.main();Type.registerNamespace("Common.App.PenMinutesManager");fh.main();Type.registerNamespace("Common.App.SaveAsToHost");Ek.main();Type.registerNamespace("Common.App.SaveToSharePoint");mi.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Aa.main();Type.registerNamespace("Common.App.SaveACopy");Z.main();Type.registerNamespace("Common.App.PhoneLink");
ib.main();Type.registerNamespace("Common.App.SharedFilePicker");cc.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");De.main();Type.registerNamespace("Common.App.WopiIdentity");Nb.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Nq.main();dj.main();mf.main();Eo.main();Ko.main();rm.main();io.main();e.a.instance.Dc(Bc.a(new is,0));
Oj.main();Type.registerNamespace("Common.App.LivePersonaUtils");$p.main();ik.main();Object(tl.b)("Chronos2")},336:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.none=null;h.Jui="CoAuth";h.ade="IdeasPaneClosed";h.gnk="MultiSlidesSelected";h.Yib="Retrigger";h.cod="SessionEnded";h.W8k="SessionRehydrated";h.slideNavigation="SlideNavigation";h.ANb="SuggestionPaneClosed";h.Jrd="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";h.PPb="WebActionId:";h.MVk="Rehydrated";
h.POf="DisallowedRequest";h.aGf="CloseSecondPane";h.Ezk="OpenEditorPane";Object(I.a)(h,"DesignerResetReason",null,[])},337:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.WIa="NoResult";Object(I.a)(h,"ProviderResultStatus",null,[])},392:function(I,Y,d){I=d(0);class h{static Ddj(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(I.a)(h,"EventReceiverIdCounter",null,[]);d.d(Y,"a",function(){return e});
class e{constructor(n,m){this.VQh=n;this._id=h.Ddj();this.LZh=m}get id(){return this._id}notify(n,m){this.LZh(n,m)}pda(n,m){return this.VQh.RLk(n,m?this:null)}}Object(I.a)(e,"EventReceiver",null,[804])},448:function(I,Y,d){d.d(Y,"a",function(){return n});I=d(0);var h=d(387),e=d(209);class n{static nuh(m){return parseInt(n.Flb(e.a.QPd,m)||"-1")<=(new Date).getTime()}static h5d(m){return parseInt(n.Flb(e.a.k6a,m)||"-1")}static Gbe(m){return Boolean.parse(n.Flb(e.a.nrb,m)||"false")}static Flb(m,z){let B=
null;try{const v=n.R9a();if(void 0!==v&&v){const y=e.a.dRc(m)+z;B=v.getItem(y)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",m,z)}return B}static Jlb(m,z,B){try{const v=n.R9a();if(void 0!==v&&v){const y=e.a.dRc(m)+B;v.setItem(y,z)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",m,B)}}static R9a(){if(!n.VTa)return null;let m=null;try{m=localStorage}catch(z){n.VTa=!1,m=null}return m}}n.VTa=!0;Object(I.a)(n,"AddinUtil",null,[])},539:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]="spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=
6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(I.b)("AddinProviderType",h)},540:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";
e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(I.b)("AddinCommandsLaunchOperationType",h)},541:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}Object(I.a)(h,"OnlineMediaSearchResult",null,[])},542:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.xck=e;this.hfk=n}get k_c(){return this.xck}get I1k(){return this.hfk}}
Object(I.a)(h,"ReportSuggestionSessionActionData",null,[])},543:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.PQf="Provider.UCI.Editor";h.JQf="EntityGroup.UCI.Editor";h.Twh="Provider.Designer.Slide";h.Swh="EntityGroup.Designer.Slide.Suggestion";h.bxh="Provider.Designer.TextToSmartArt";h.axh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(I.a)(h,"InfraredConstant",null,[])},692:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(68);class e{constructor(n){this.R9=
this.Xla=null;this.Le=n}dispose(){this.clear();this.Xla.parentNode.removeChild(this.Xla)}Sia(n){this.Xla=this.l1b(n,"prContainerHr");this.R9=this.l1b(this.Xla,"prGlyph")}clear(){this.doa()}Eoa(n,m){n&&(this.doa(),this.R9.appendChild(n),this.R9.style.backgroundColor=m,this.Xla.style.visibility=h.a.visible)}l1b(n,m){const z=this.Le.Ie();this.Le.addCssClass(z,m);n.appendChild(z);return z}doa(){this.R9.firstChild&&this.R9.removeChild(this.R9.firstChild)}}Object(I.a)(e,"ShapePawnGlyph",null,[])},700:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}Object(I.a)(h,"ProviderActionInfo",null,[])},701:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(I.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])},975:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.authority=this.userId=
this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static IZf(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(I.a)(h,"WopiAuthContext",null,[791])},996:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n,m=null){super();this.shapeId=
e;this.qdg=n;this.SY=m}}Object(I.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},997:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n=null){super();this.shapeId=e;this.SY=n}}Object(I.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,[])},998:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.xHc=null}}Object(I.a)(h,"IdeasSmartArtSuggestionWrapper",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.chronos2.js.map