'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1010:function(I,Y,d){I=d(0);var h=d(144),e=d(671),n=d(383),m=d(263);class z{constructor(da,qa,F,sa,ia,Na){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=da;this.url=qa;this.spWebUrl=F;this.uniqueId=sa;this.size=ia;this.lastModified=Na}}Object(I.a)(z,"FileInfo",null,[]);var B=d(451);class v{constructor(da,qa){this.DimensionValue=this.DimensionName=null;this.DimensionName=
da;this.DimensionValue=qa}}Object(I.a)(v,"Dimension",null,[]);class y{constructor(da,qa,F,sa,ia){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=da;this.Query=qa;this.From=F;this.Size=sa;ia&&(this.Filter=ia)}}Object(I.a)(y,"EntityRequest",null,[]);class A{constructor(da){this.QueryString=null;this.QueryString=da}}Object(I.a)(A,"Query",null,[]);var E=d(156);class u{constructor(da,qa){this.Dimensions=this.Name=null;this.Name=da;this.Dimensions=qa}}Object(I.a)(u,
"Scenario",null,[]);var J=d(171),G=d(170);class S{constructor(da,qa,F,sa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=da;this.TimeZone=qa;this.Cvid=F;this.Scenario=sa}}Object(I.a)(S,"SubstrateBody",null,[]);var P=d(450),Q=d(117),D=d(103),O=d(27),X=d(935),N=d(934),aa=d(305),V=d(36),ca=d(47),fa=d(106);d.d(Y,"a",function(){return ma});class ma{constructor(da){this.hVb=this.VOa=this.lBc=this.tSb=this.GVb=0;this.tjf=this.$kf=this.hI=null;this.gFd=0;this.cS=-1;this.iXb=
"";this.sBd=!1;this.Xh=O.AFrameworkApplication.Ke;this.qb=da;this.cEc=this.z$d();this.R4a=new e.a;this.sif=this.qb.T2e?3:2;this.ZLd=this.qb.T2e&&this.qb.Rvh?5:3;this.HNd=this.qb.dqd?2:3;this.krf=1;this.OAc=this.qb.l4f;this.Lof=this.qb.QUj;this.iWb=da.N6f;O.AFrameworkApplication.fa&&(this.$kf=O.AFrameworkApplication.fa.Ga("AppCatalogUrl")+O.AFrameworkApplication.fa.Ga("SearchPersonaPhotoBaseUrl"),this.sBd=this.qb.n3||this.qb.rOc);this.qb.n3&&(this.HNd=this.ZLd=5)}aE(){return"Substrate"}nL(){return 0===
this.qb.Aq?0:1===this.qb.Aq?1:3}fB(da,qa,F,sa=h.a.tellMe,ia=null){const Na=new G.a(da);if(!ia||Array.contains(ia,14)||Array.contains(ia,15)||Array.contains(ia,20))if(!this.gFd||window.performance.now()-this.gFd>=D.a.etd)if(F=this.R4a.p7f())this.gFd=window.performance.now(),F.then(Ca=>{Ca&&""!==Ca?(this.iXb=Ca,""!==this.hI&&this.o7f(da,sa,this.iXb,qa,ia)):(Q.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),qa.resultsUpdated(Na))},Ca=>{Q.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+Ca);qa.resultsUpdated(Na)});else{if(Q.TellMeActor.instance.Hd)Q.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");qa.resultsUpdated(Na)}else this.iXb&&""!==this.iXb?this.o7f(da,sa,this.iXb,qa,ia):(qa.resultsUpdated(Na),Q.TellMeActor.instance.Hd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else qa.resultsUpdated(Na)}j1(){this.VOa=this.hVb=this.lBc=this.tSb=this.GVb=0}o7f(da,qa,F,sa,ia){this.j1();
const Na=new G.a(da),Ca=this.hI=fa.a.create().toString();this.bja();this.cS=window.setTimeout(()=>{if(Ca===this.hI){this.hI="";this.cS=-1;sa.resultsUpdated(Na);const va={};va[n.a.provider]=this.aE();va[n.a.Uhb]=da.PZa;Q.TellMeActor.instance.Hd.CH(m.a.timedOut,this.iWb,va)}},this.iWb);const ha={"Content-Type":"application/json",Accept:"application/json"};ha.Authorization="Bearer "+F;ha["X-Office-Version"]=O.AFrameworkApplication.buildVersion;ha["X-Office-Application"]=O.AFrameworkApplication.fa.Ga("Application");
ha["X-Office-Platform"]="WAC";ha["X-TellMe-SessionId"]=Q.TellMeActor.instance.AUc();ha["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;ha["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;ha["Client-Request-Id"]=Ca;const Ba=window.performance.now();this.Xh.mj(this.Xkj(),2,this.Ykj(da.zf,this.qb.application,Q.TellMeActor.instance.AUc(),D.a.MF(da)),ha,!1,0,va=>{this.Xgb(va,da,sa,Ca,Ba,qa,ia)},va=>{this.Lgb(va,da,sa,Ca,Ba)},null,null,!1,4E3,6E3)}bja(){-1!==this.cS&&(window.clearTimeout(this.cS),
this.cS=-1)}Xgb(da,qa,F,sa,ia,Na,Ca){Q.TellMeActor.instance.Hd.F5(qa.zf.length,this.cEc.join(","),da.data.oe.toString(),Math.round(window.performance.now()-ia),P.a.substrate,!0,B.a.Qta);const ha=D.a.MF(qa),Ba=new G.a(qa);if(sa===this.hI){this.bja();da=V.b(da.data.Sd);if(da.Groups){da=da.Groups;for(const va of da)"People"===va.Type&&this.qb.Psc&&(Ca?Array.contains(Ca,14):1)?(da=this.P4f(va.Suggestions,ha,Na),0<da.results.length&&Ba.Uq(da)):"File"===va.Type&&this.qb.Osc&&(Ca?Array.contains(Ca,15):1)?
(da=this.W6d(va.Suggestions,ha,Na),0<da.results.length&&(this.wZc()&&(sa=new E.a("GenerateSlidesFromTellMe",29,"",null,1),da.ls(sa)),Ba.Uq(da))):"Notes"===va.Type&&this.qb.iVa&&Na!==h.a.contextMenu&&(Ca?Array.contains(Ca,20):1)&&(da=this.i4f(va.Suggestions,ha,qa),0<da.results.length&&Ba.Uq(da))}F.resultsUpdated(Ba);Q.TellMeActor.instance.Hd.F5(qa.zf.length,this.cEc.join(","),"",Math.round(window.performance.now()-ia),"",!0,B.a.provider)}else F.resultsUpdated(Ba)}i4f(da,qa,F){const sa=new J.a(20);
sa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ia of da)this.ZWj(ia)&&(da=ia.NotesType,da=ca.a.qg(da),da=this.Ydj(da,ia.LastModifiedTime,ia.BodyPreview,ia.Subject,qa,F,ia))&&(da.groupType=20,sa.ls(da));return sa}P4f(da,qa,F){const sa=new J.a(14);sa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Na of da)if(this.$Wj(Na)){var ia=Na.Id.split("@")[0];da=Na.EmailAddresses[0];let Ca=Na.Type;if(void 0===Ca||null===Ca)Ca="User";if(ia=this.ifj(Ca,Na.DisplayName,Na.JobTitle,
da,ia,F,qa))ia.description=da,da=Na.JobTitle,"Department"in Na&&"CompanyName"in Na&&(da+="@"+Na.Department+"@"+Na.CompanyName),ia.XPd=da,sa.ls(ia)}return sa}W6d(da,qa,F){const sa=new J.a(15);sa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const va of da)if(this.QWj(va)){var ia=va.FileName;da=va.FileExtension;var Na=ia;ia.length>da.length&&Na.endsWith(da)&&(Na=ia.substr(0,ia.length-da.length-1));var Ca=void 0,ha=0;"DateCreated"in va&&va.DateCreated?(ha=D.a.Z$d(va.DateCreated),Ca=D.a.b8f(va.DateCreated),
Ca=String.format(CommonUIStrings.l_CreatedTimeFormatString,va.Author,Ca)):Ca=va.Author;var Ba=va.AccessUrl+"?web=1";const ta=ca.a.h8b(Ba);ia=String.format('<a href="{0}">{1}</a>',ta,ca.a.$Ta(ia));if(F!==h.a.contextMenu||ca.a.j9(Ba))if(Na=this.z9i(Na,F===h.a.contextMenu?ia:Ba,Ca,va.FileExtension,va.Text,qa))Na.description=va.Author,Na.YGc=ha,sa.ls(Na),this.sBd&&(ha=va.AccessUrl,ia=D.a.zSc(da),Ca=va.DateModified?va.DateModified:va.DateCreated,Ba=va.Size?va.Size:va.FileSize,this.gil()&&(ha=ha.replace(RegExp("%20",
"g")," "),ia=D.a.bkj(da)),da=new z(ia,ha,va.SPWebUrl,va.Id,Ba,Ca),Q.TellMeActor.instance.G4e(!1,Na.value,da))}return sa}Lgb(da,qa,F,sa,ia){sa===this.hI&&(this.bja(),Q.TellMeActor.instance.Hd.F5(qa.zf.length,this.cEc.join(","),da.data.oe.toString(),Math.round(window.performance.now()-ia),P.a.substrate,!1,B.a.Qta));da=new G.a(qa);F.resultsUpdated(da)}ifj(da,qa,F,sa,ia,Na,Ca){Ca=Ca?this.krf:this.sif;if(!window.LPC&&!D.a.hje()||this.GVb===Ca)return null;this.GVb+=1;Ca="PeopleSuggestion"+this.GVb.toString();
var ha=this.$kf+"?size=1&accountName="+sa;da=Object.assign(new X.a,{PersonaType:da,Smtp:sa,ProfilePictureUrl:ha,AadObjectId:ia});const Ba=Object.assign(new N.a,{identifiers:da,displayName:qa});da=Na===h.a.contextMenu;this.qb.tda?(Q.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ca,Ba,qa,F)),Na===h.a.contextMenu&&(F=D.a.WKf(qa,sa,ia),Q.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ca,F))),Q.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ca,
da))):(ha=[],ha.push(appChrome.actions.setPersonaButtonCoauthor(Ca,Ba,qa,F)),Na===h.a.contextMenu&&(F=D.a.WKf(qa,sa,ia),ha.push(appChrome.actions.setButtonCommandValueId(Ca,F))),ha.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ca,da)),appChrome.api.dispatch(ha));return new E.a(Ca,11,qa,sa,0)}Ydj(da,qa,F,sa,ia,Na,Ca){if(ia&&!this.qb.dng||this.lBc===this.OAc||this.hVb===this.OAc||this.VOa===this.OAc)return null;var ha=null;this.lBc+=1;ia="";const Ba=[],va={};Ca.type="Notes";this.tjf=
Object.assign(new aa.a,{landingTab:"Notes",data:Ca});Na=D.a.PCa(Na.zf,33,this.tjf);if("onenotepagepreviews"===da){if(!("ClickthroughUrl"in Ca&&Ca.ClickthroughUrl)||""===Ca.ClickthroughUrl)return null;this.hVb+=1;ia="OnenoteNotesSuggestion"+this.hVb.toString();va["default"]="SaveAsonetoc2_20";ha=Ca.ClickthroughUrl;Ba.push(appChrome.actions.setControlIconSet(ia,va));Ba.push(appChrome.actions.setCompoundButtonCommandValueId(ia,ha));ha=new E.a(ia,19,null,null,0)}else if("stickynote"===da){if(!this.Lof)return null;
this.VOa+=1;ia="NotesSuggestion"+this.VOa.toString();va["default"]="ShowAllNotes_20";Ba.push(appChrome.actions.setControlIconSet(ia,va));Ba.push(appChrome.actions.setCompoundButtonCommandValueId(ia,Na));ha=new E.a(ia,21,null,null,0)}else if("samsung"===da){if(!this.Lof)return null;this.VOa+=1;ia="NotesSuggestion"+this.VOa.toString();va["default"]="CategoryCollapsed_20";Ba.push(appChrome.actions.setControlIconSet(ia,va));Ba.push(appChrome.actions.setCompoundButtonCommandValueId(ia,Na));ha=new E.a(ia,
20,null,null,0)}""!==ia&&(da=D.a.b8f(qa),da=String.format(CommonUIStrings.l_LastModifiedString,da),ha.label=sa,ha.YGc=D.a.Z$d(qa),Ba.push(appChrome.actions.setControlLabel(ia,sa)),Ba.push(appChrome.actions.updateCompoundButtonDescription(ia,da)),Ba.push(appChrome.actions.setControlCustomTooltip(ia,F)),appChrome.api.dispatch(Ba));return ha}z9i(da,qa,F,sa,ia,Na){if(this.tSb===(Na?this.HNd:this.ZLd)||this.sBd&&"Word"!==D.a.zSc(sa))return null;this.tSb+=1;Na="FileSuggestion"+this.tSb.toString();const Ca=
[],ha={};ha["default"]=D.a.Z$i(sa);this.qb.tda?(Q.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Na,da)),Q.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Na,ha)),Q.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Na,F)),Q.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Na,qa)),Q.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Na,ia))):(Ca.push(appChrome.actions.setControlLabel(Na,
da)),Ca.push(appChrome.actions.setControlIconSet(Na,ha)),Ca.push(appChrome.actions.updateCompoundButtonDescription(Na,F)),Ca.push(appChrome.actions.setCompoundButtonCommandValueId(Na,qa)),Ca.push(appChrome.actions.setControlCustomTooltip(Na,ia)),appChrome.api.dispatch(Ca));return new E.a(Na,6,da,F,0)}z$d(){const da=[];this.qb.Psc&&Array.add(da,"People");this.qb.Osc&&Array.add(da,"File");this.qb.iVa&&Array.add(da,"Notes");return da}Ykj(da,qa,F,sa){var ia=new A(da);da=new y("File",ia,0,sa?this.HNd:
this.ZLd,null);sa=new y("People",ia,0,sa?this.krf:this.sif,D.a.eEk);ia=new y("Notes",ia,0,this.OAc,null);this.qb.rOc&&"powerpoint"===qa.toLowerCase()&&(qa="word");qa=new v("app",qa.toLowerCase());var Na=[];Array.add(Na,qa);qa=new u("tellmesearch",Na);Na=[];this.qb.Osc&&Array.add(Na,da);this.qb.Psc&&Array.add(Na,sa);this.qb.iVa&&Array.add(Na,ia);F=new S(Na,"UTC",F,qa);return V.c(F)}Xkj(){let da=this.qb.Crl;this.qb.iVa&&(da+="?&setflight=NotesFrom3S");""!==this.qb.q7f&&(da=da+"&"+this.qb.q7f);return da}$Wj(da){return"DisplayName"in
da&&"Id"in da&&"EmailAddresses"in da&&!!da.Id&&!!da.EmailAddresses}QWj(da){return"FileExtension"in da&&!!da.FileExtension&&"FileName"in da&&!!da.FileName&&""!==da.FileName&&"AccessUrl"in da&&!!da.AccessUrl&&""!==da.AccessUrl}ZWj(da){return"Id"in da&&!!da.Id&&"NotesType"in da&&!!da.NotesType&&"Subject"in da&&!!da.Subject&&""!==da.Subject}wZc(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}gil(){return!!O.AFrameworkApplication.fa&&
O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(I.a)(ma,"SubstrateResultsProvider",null,[654])},103:function(I,Y,d){I=d(0);var h=d(16);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(I.a)(e,"InsertMentionParameters",null,[]);class n{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(I.a)(n,"InsightsParameters",null,[]);var m=d(978),z=d(979),B=d(980),v=d(981),y=d(27),
A=d(334),E=d(446),u=d(36),J=d(55),G=d(47),S=d(125);d.d(Y,"a",function(){return P});class P{static get ZGj(){return"Insights_16x16x32"}static get LXi(){return"Find_16x16x32"}static get c9g(){return"-Parameterized"}static get pZe(){return"Parameterized"}static get Ntd(){return"bTryQuery"}static get w3e(){return"TellMeSuggestion_"}static get jEh(){return"bTryQueryAlternate"}static get c1e(){return"MenuTellMe"}static get eEk(){const Q={},D=[];Array.add(D,{Term:{PeopleType:"Person"}});Q.And=D;return Q}static dIi(Q){return Q+
P.c9g}static getParameter(Q){let D="",O="";if(Q)for(let X=0;X<Q.iVf;++X)"Type"===Q.Q6d(X)?D=Q.eb(X):"Value"===Q.Q6d(X)&&(O=Q.eb(X));return new h.a(D,O)}static rYd(Q){Q=Object.assign(new n,{neighborhood:Q,mentionStart:0,mentionLength:Q.length});return u.c(Q)}static WKf(Q,D,O){Q=Object.assign(new e,{displayName:Q,email:D,userId:O});return u.c(Q)}static PCa(Q,D,O=null){return u.c(P.R6f(Q,D,O,null))}static R6f(Q,D,O=null,X=null){Q=Object.assign(new E.a,{neighborhood:Q,mentionStart:0,mentionLength:Q?Q.length:
0});return Object.assign(new A.a,{selection:Q,userIntent:X,entryPoint:D,launchData:O})}static a3k(Q,D){return P.PCa(Q,P.slh(D))}static slh(Q){switch(Q){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static Yig(){return!!y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static nbb(){const Q=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"):
null;return!!Q&&0<Q.length}static isEnterpriseUser(){const Q=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ga("HostAuthType"):null;return!!Q&&"aad"===Q.toLowerCase()||"external"===Q&&P.hje()}static DXe(Q){return Q.dul&&!P.nbb()}static Ylg(){const Q=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ga("UiHostIntegrationType"):"";return!!y.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===Q&&y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static CXe(Q){return Q.pza&&Q.FWi&&(Q.Psc||Q.Osc||Q.iVa)&&!P.Ylg()&&P.isEnterpriseUser()&&!P.nbb()}static d4(){return y.AFrameworkApplication.fa?y.AFrameworkApplication.Tya||y.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):y.AFrameworkApplication.Tya}static MF(Q){return!Q||P.zmg(Q.zf)}static zmg(Q){return!Q||!Q.trim().length}static wtd(Q){if(!Q)return 0;const D=Math.pow(10,5);return Math.round(Q*D)/D}static Tvl(){var Q=new Date;return Q?new Date(Q.getUTCFullYear(),Q.getUTCMonth(),
Q.getUTCDate(),Q.getUTCHours(),Q.getUTCMinutes(),Q.getUTCSeconds(),Q.getUTCMilliseconds()):null}static Z$d(Q){return(P.Tvl().getTime()-(new Date(Q)).getTime())/1E3}static Ymg(Q){const {InsightsMenuItemFactory:D}=d(977);switch(Q){case m.a.oce:case z.a.EWf:case D.hfg:case B.a.M_g:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return Q.startsWith(P.Ntd)||
Q.startsWith(P.w3e)||Q.startsWith(P.jEh)||Q.startsWith("PeopleSuggestion")||Q.startsWith("FileSuggestion")||Q.startsWith("FindInDocumentSuggestion")||Q.startsWith("NotesSuggestion")||Q.startsWith("OnenoteNotesSuggestion")||Q.startsWith("SmartLookupFromTellMe")||Q.startsWith("GetHelpFromTellMe")||Q.startsWith("GetHelpWithDescriptionFromTellMe")||Q.startsWith("AddinSuggestion")||Q.startsWith("OfficeScripts")?!0:!1}static m7d(Q,D){const O=[];Array.add(O,new v.a(400,Q));Array.add(O,new v.a(200,D));Q=
{};Q.parts=O;return JSON.stringify(Q)}static BSa(Q){const D=Q.indexOf("<b0>"),O=Q.lastIndexOf("</b0>"),X=[];Array.add(X,new v.a(400,Q.substring(0,D)));Array.add(X,new v.a(600,Q.substring(D+4,O)));Array.add(X,new v.a(400,Q.substring(O+5,Q.length)));Q={};Q.parts=X;return JSON.stringify(Q)}static b8f(Q){const D=P.Z$d(Q);return 60>D?CommonUIStrings.l_TimeSince_SecsAgo:3600>D?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(D/60).toString()):86400>D?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(D/3600).toString()):172800>D?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(Q)).localeFormat("MMMM dd, yyyy"))}static G5i(Q){const D=Array(Q.length);for(let O=0;O<Q.length;O++)D[O]=Q[O].commandId;return D}static hje(){if("Dev Box"===y.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse"))return!0;let Q=y.AFrameworkApplication.fa.Ga("UserPrincipalName");Q=S.b(Q)?"":G.a.qg(Q);const D=y.AFrameworkApplication.fa.Cu("TellMeIntEnabledForFeatureCrew")?
y.AFrameworkApplication.fa.WA("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(D,Q)&&"inner"===y.AFrameworkApplication.fa.Ga("Microsoft365Ring")}static Z$i(Q){switch(P.zSc(Q)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static bkj(Q){Q=P.zSc(Q);switch(Q){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return Q}}static zSc(Q){switch(Q.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static mx(){return J.a.yT&&!J.a.Tj}}P.etd=9E5;Object(I.a)(P,"TellMeUtils",null,[])},1045:function(I,Y,d){I=d(0);var h=d(18),e=d(144),n=d(671),m=d(383),z=d(263),B=d(451),v=d(156),y=d(171),A=d(170),E=d(117),u=d(103);class J{constructor(fa){this.qb=fa;this.cEc=this.z$d()}aE(){return"Add-ins"}nL(){return 0===this.qb.Aq?
0:1===this.qb.Aq?1:3}fB(fa,ma){fa=new A.a(fa);ma.resultsUpdated(fa)}ATa(fa,ma,da){let qa;qa=this.qb.OH?new y.a(28):new y.a(26);qa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;da&&this.yml(fa.zf,ma,qa)}yml(fa,ma,da){const qa=[];let F;F=this.qb.AIj?this.qb.OH&&this.qb.VPa?u.a.BSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,fa):this.qb.BIj?this.qb.OH&&this.qb.VPa?u.a.BSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,
fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,fa):this.qb.OH&&this.qb.VPa?u.a.BSa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,fa)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,fa);this.qb.tda?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",F)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",fa))):(qa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
F)),qa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",fa)),appChrome.api.dispatch(qa));da.ls(new v.a("LaunchAddinDialogFromTellMe",28));ma.Uq(da)}z$d(){const fa=[];this.qb.nYc&&Array.add(fa,"Addin");return fa}}Object(I.a)(J,"AddinStoreResultsProvider",null,[654]);var G=d(982),S=d(335),P=d(384),Q=d(983),D=d(1010),O=d(984),X=d(450),N=d(27),aa=d(36),V=d(106);d.d(Y,"a",function(){return ca});class ca{constructor(fa,ma,da){this.bPa=this.QWb=this.RWb=this.LDc=!1;this.hI=null;
this.cS=-1;this.pBa=this.pXb=this.oPa=this.l5a=null;this.khf=this.mhf=0;this.qb=fa;const qa=u.a.d4();this.rNa=ma||[];this.Xh=N.AFrameworkApplication.Ke;this.tof=fa.eJe;this.SWb=fa.dJe;this.JDc=qa&&this.kkb();this.KDc=qa&&this.lkb();this.vof=qa&&this.mkb();this.NDc=this.KMb();this.NKd=this.JMb();if((ma=fa.V_e&&u.a.CXe(fa))||fa.n3)this.l5a=new D.a(fa),this.LDc=fa.Osc;ma&&(this.RWb=fa.Psc,this.QWb=fa.iVa,this.bPa=this.LDc&&this.$t("File")||this.RWb&&this.$t("People")||this.QWb&&this.$t("Notes"));this.IDc=
this.Ril();this.TWb=fa.Mkc;this.MDc=this.ejl();this.MKd=this.Qil();this.Wza=this.Qlj();this.W7e=new G.a(fa);this.TSh=new Q.a(fa);this.K1h=new O.a(fa);this.MMh=new J(fa);this.iWb=da;this.R4a=new n.a;this.TWb&&(this.W7e=new G.a(fa));fa.n3&&(this.MKd=this.MDc=this.TWb=this.bPa=this.QWb=this.RWb=this.NKd=this.NDc=this.vof=this.KDc=this.JDc=this.SWb=!1,N.AFrameworkApplication.fa&&this.$t("File")&&this.Muh()&&(fa=this.R4a.cae("Search",N.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch"),
!0),this.V3b(fa,"TellMeService",!0),fa=this.R4a.cae("SmartLookup",N.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint"),!1),this.V3b(fa,"Shredder",!1)));N.AFrameworkApplication.fa&&this.bPa&&this.$t("File")&&this.Muh()&&(fa=this.R4a.cae("Search",N.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch"),!0),this.V3b(fa,"TellMeService",!0))}$t(fa){return Array.contains(this.rNa,fa)?!0:!1}aE(){return"TellMeService"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:this.$t("Command")||
this.$t("Recommended")?2:3}Nlj(fa){let ma="";if(!fa&&this.$t("Command")&&this.qb.zke){ma+="CommandSearch_DLIS,";var da=this.qb.hBh;0<da.length&&(ma+=da+",")}fa&&this.$t("Recommended")&&this.SWb&&(da=this.woj(),0<da.length&&(ma+=da+","));!fa&&this.$t("Help")&&(fa=this.qb.gBh,0<fa.length&&(ma+=fa+","));this.qb.n3&&this.pBa&&0<this.pBa.length&&(ma+="IsRecallEnabled_true,");(this.qb.rOc||this.qb.n3)&&this.bPa&&(ma+="IsGenerateSlidesEnabled_true,");0<ma.length&&(ma=ma.substr(0,ma.length-1));return ma}V3b(fa,
ma,da){const qa=da?this.mhf:this.khf;if(!qa||window.performance.now()-qa>=u.a.etd)if(fa)da?this.mhf=window.performance.now():this.khf=window.performance.now(),fa.then(F=>{da?this.pXb=F:(this.pBa=F,E.TellMeActor.instance.jZe=F)},F=>{E.TellMeActor.instance.Hd.onError("TellMeServiceProvider:FetchTokenForService_"+ma,"tellMeServiceToken promise rejected: "+F)});else if(E.TellMeActor.instance.Hd)E.TellMeActor.instance.Hd.onError("TellMeServiceProvider:FetchTokenForService_"+ma,"undefined token promise")}fB(fa,
ma,da,qa=e.a.tellMe,F=null){const sa=new A.a(fa);da=u.a.MF(fa);this.$t("File")&&(this.bPa||this.qb.n3)&&this.V3b(this.R4a.Rlj(),"TellMeService",!0);this.$t("File")&&this.qb.n3&&this.V3b(this.R4a.xjj(),"Shredder",!1);var ia=this.bPa&&!!this.pXb;const Na=this.qb.n3&&!!this.pBa;var Ca=ia||Na||da&&this.$t("Recommended")&&this.SWb;ia=ia||Na||!da&&(this.tof&&this.$t("Command")||this.JDc&&this.$t("Answer")||this.KDc&&this.$t("Definition")||this.NKd&&this.$t("Image")||this.TWb&&this.$t("Help")||this.NDc&&
this.$t("WolframAnswer")||this.MDc&&this.$t("Template")||this.MKd&&this.$t("Addin"));if(Ca||ia)if(this.oPa=qa,qa={"Content-Type":"application/json",Accept:"application/json"},qa["X-Office-Version"]=N.AFrameworkApplication.buildVersion,qa["X-Office-Application"]=N.AFrameworkApplication.fa.Ga("Application"),qa["X-Office-Platform"]="WAC",qa["X-TellMe-SqmUserId"]=N.AFrameworkApplication.fa.Ga("LoggableUserId")||"",qa["X-TellMe-SessionId"]=E.TellMeActor.instance.AUc(),this.pXb&&(qa.Authorization="Bearer "+
this.pXb),this.pBa&&0<this.pBa.length&&(qa["X-TellMe-ShredderToken"]="Bearer "+this.pBa),Ca=this.Nlj(da),0<Ca.length&&(qa["X-TellMe-Flights"]=Ca),Ca=[],!da&&this.$t("Answer")&&this.JDc&&(F?Array.contains(F,9):1)&&Array.add(Ca,"Answer"),!da&&this.$t("Command")&&this.tof&&!S.CommandResultsUtility.Pie(fa.zf)&&(F?Array.contains(F,17):1)&&Array.add(Ca,"Command"),!da&&this.$t("Definition")&&this.KDc&&(F?Array.contains(F,10):1)&&Array.add(Ca,"Definition"),!da&&this.$t("Help")&&this.TWb&&(F?Array.contains(F,
8):1)&&Array.add(Ca,"Help"),!da&&this.$t("WolframAnswer")&&this.NDc&&(F?Array.contains(F,12):1)&&Array.add(Ca,"WolframAnswer"),da&&this.$t("Recommended")&&this.SWb&&!E.TellMeActor.instance.Fuc&&(F?Array.contains(F,18):1)&&Array.add(Ca,"Recommended"),!da&&this.$t("Image")&&this.NKd&&(F?Array.contains(F,19):1)&&Array.add(Ca,"Image"),this.pXb&&this.bPa&&(F?Array.contains(F,14)||Array.contains(F,15)||Array.contains(F,20):1)&&(this.l5a.j1(),this.LDc&&this.$t("File")&&Array.add(Ca,"File"),this.RWb&&this.$t("People")&&
Array.add(Ca,"People"),this.QWb&&this.$t("Notes")&&Array.add(Ca,"Notes")),this.pBa&&0<this.pBa.length&&this.qb.n3&&(F?Array.contains(F,15):1)&&(this.l5a.j1(),this.$t("File")&&Array.add(Ca,"File")),!da&&this.$t("Template")&&this.MDc&&(F?Array.contains(F,23):1)&&Array.add(Ca,"Template"),!da&&this.$t("Addin")&&this.MKd&&(F?Array.contains(F,26):1)&&Array.add(Ca,"Addin"),Ca.length){qa["X-TellMe-SuggestionTypes"]=Ca.join(",");qa["X-TellMe-Culture"]=N.AFrameworkApplication.uiCulture;qa["X-TellMe-ProcessSessionId"]=
N.AFrameworkApplication.userSessionId;var ha=this.hI=V.a.create().toString();qa["Client-Request-Id"]=ha;var Ba=window.performance.now();this.bja();this.cS=window.setTimeout(()=>{if(ha===this.hI){this.hI="";this.cS=-1;ma.resultsUpdated(sa);const va={};va[m.a.provider]=this.aE();va[m.a.Uhb]=fa.PZa;E.TellMeActor.instance.Hd.CH(z.a.timedOut,this.iWb,va)}},this.iWb);this.Xh.mj(this.Wza,2,this.Plj(fa.zf),qa,!1,0,va=>{this.Xgb(va,fa,ma,ha,Ba,F)},va=>{this.Lgb(va,fa,ma,ha,Ba)},null,null,!1,4E3,6E3)}else E.TellMeActor.instance.Hd.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),ma.resultsUpdated(sa);else ma.resultsUpdated(sa)}bja(){-1!==this.cS&&(window.clearTimeout(this.cS),this.cS=-1)}Xgb(fa,ma,da,qa,F,sa){const ia=new A.a(ma);if(qa===this.hI){this.bja();E.TellMeActor.instance.Hd.F5(ma.zf.length,this.rNa.join(","),fa.data.oe.toString(),Math.round(window.performance.now()-F),X.a.tellMe,!0,B.a.Qta);qa=fa.data.Sd;fa=null;try{fa=aa.b(qa)}catch(ta){E.TellMeActor.instance.Hd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
ta);return}qa=u.a.MF(ma);if("Groups"in fa&&fa.Groups){var Na=fa.Groups;for(var Ca of Na)if("GroupType"in Ca&&"Suggestions"in Ca&&Ca.Suggestions)if("Commands"===Ca.GroupType&&(sa?Array.contains(sa,17):1)||"Recommended"===Ca.GroupType&&(sa?Array.contains(sa,18):1)){var ha=(Na="Recommended"===Ca.GroupType)?"DLIS":"NaiveBayes";"Source"in Ca&&Ca.Source&&(ha=Ca.Source);var Ba=Ca.Suggestions;new h.a;var va=[];for(const ta of Ba)this.NWj(ta)&&(Ba=ta.Type,("Command"===Ba||Na&&"Recommended"===Ba)&&va.push(new P.a(ta.CommandId,
ta.Score)));S.CommandResultsUtility.Z1c(va,!ma.zf.trim().length,Ca.GroupType,ha);ha=E.TellMeActor.instance.oS;Ba=[];for(const ta of va)Na&&ha&&ha.AWd(ta.commandId)||Ba.push(ta);va=S.CommandResultsUtility.TTc(ma,Ba,this.qb,null,null,null,Na?18:17,0);0<va.results.length&&(this.oPa!==e.a.contextMenu&&(va.displayName=Na?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ia.Uq(va))}else if("Answer"===Ca.GroupType){Ba=Ca.Suggestions;Na=null;va=2147483647;ha="";for(const ta of Ba)if(this.KWj(ta))if(ha=
ta.Type,Ba=this.kxb(ha),"Answer"===ha&&this.JDc){Na=this.QKf(ha,ta,ma.zf);break}else Ba&&Ba<va&&(va=Ba,Na=this.QKf(ha,ta,ma.zf));va=u.a.a3k(ma.zf,ha);Na&&(sa?Array.contains(sa,Na.type):1)&&(ha=[],this.IDc?this.qb.tda?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Na.value,Na.KJ)),E.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Na.value,Na.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Na.value,
va))):(ha.push(appChrome.actions.setControlLabel(Na.value,Na.KJ)),ha.push(appChrome.actions.updateCompoundButtonDescription(Na.value,Na.description)),ha.push(appChrome.actions.setCompoundButtonCommandValueId(Na.value,va)),appChrome.api.dispatch(ha)):this.qb.tda?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Na.value,Na.KJ+" - "+Na.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Na.value,va))):(ha.push(appChrome.actions.setControlLabel(Na.value,
Na.KJ+" - "+Na.description)),ha.push(appChrome.actions.setButtonCommandValueId(Na.value,va)),appChrome.api.dispatch(ha)),va=this.MGi(Na.type),va.ls(Na),ia.Uq(va))}else"Help"===Ca.GroupType&&Ca.Suggestions.length&&(sa?Array.contains(sa,8):1)?this.TWb&&(Na=this.W7e.ATa(ma,Ca.Suggestions))&&0<Na.results.length&&ia.Uq(Na):"Template"===Ca.GroupType&&(sa?Array.contains(sa,23):1)?(Na=Ca.Suggestions)&&0<Na.length&&this.K1h.ATa(ma,ia,Na):"Addin"===Ca.GroupType&&(sa?Array.contains(sa,26):1)?(Na=Ca.Suggestions)&&
0<Na.length&&this.MMh.ATa(ma,ia,Na):"Substrate"===Ca.GroupType&&this.bPa&&"Type"in Ca?"File"===Ca.Type&&this.LDc&&(sa?Array.contains(sa,15):1)?(Na=this.l5a.W6d(Ca.Suggestions,qa,this.oPa))&&0<Na.results.length&&(this.wZc()&&(va=new v.a("GenerateSlidesFromTellMe",29,"",null,1),Na.ls(va)),ia.Uq(Na)):"People"===Ca.Type&&this.RWb&&(sa?Array.contains(sa,14):1)?(Na=this.l5a.P4f(Ca.Suggestions,qa,this.oPa))&&0<Na.results.length&&ia.Uq(Na):"Notes"===Ca.Type&&this.QWb&&(sa?Array.contains(sa,14):1)&&(Na=this.l5a.i4f(Ca.Suggestions,
qa,ma))&&0<Na.results.length&&ia.Uq(Na):"Recall"===Ca.GroupType&&this.qb.n3&&"Type"in Ca&&"IntentService"===Ca.Type&&(sa?Array.contains(sa,15):1)&&(Na=this.l5a.W6d(Ca.Suggestions,qa,this.oPa))&&0<Na.results.length&&(this.wZc()&&(va=new v.a("GenerateSlidesFromTellMe",29,"",null,1),Na.ls(va)),ia.Uq(Na));else E.TellMeActor.instance.Hd.onError("OnSuccessCallBack","GroupType"in Ca?"Invalid group suggestions found for "+Ca.GroupType:"Invalid group found")}if(fa.Intents){Ca=fa.Intents;for(const ta of Ca)this.yme(ta)&&
("Image"===ta.GroupType&&ta.ConfidenceScore>ta.ConfidenceThreshold&&(sa?Array.contains(sa,19):1)?this.TSh.ATa(ma,ia,0,ta):"Commands"===ta.GroupType&&ta.ConfidenceScore<ta.ConfidenceThreshold&&(sa?Array.contains(sa,17):1)&&(Ca=new y.a(17),ia.Uq(Ca)))}da.resultsUpdated(ia);E.TellMeActor.instance.Hd.F5(ma.zf.length,this.rNa.join(","),"",Math.round(window.performance.now()-F),"",!0,B.a.provider)}}Lgb(fa,ma,da,qa,F){const sa=new A.a(ma);qa===this.hI&&(this.bja(),E.TellMeActor.instance.Hd.F5(ma.zf.length,
this.rNa.join(","),fa.data.oe.toString(),Math.round(window.performance.now()-F),X.a.tellMe,!1,B.a.Qta));da.resultsUpdated(sa)}kxb(fa){switch(fa){case "Entity":return this.vof?3:0;case "Definition":return this.KDc?5:0;case "WolframAnswer":return this.NDc?2:0;default:return 0}}QKf(fa,ma,da){switch(fa){case "Answer":return new v.a(this.IDc?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ma.Title?da:ma.Title,ma.Description,0);case "Entity":return new v.a(this.IDc?"AnswerForSearch":"AnswerForSearchSingleLine",
2,""===ma.Title?da:ma.Title,ma.Description,0);case "Definition":return new v.a(this.IDc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ma.Title?da:ma.Title,ma.Description,0);case "WolframAnswer":return new v.a("WolframForSearch",3,""===ma.Title?da:ma.Title,ma.Description,0);default:return null}}MGi(fa){switch(fa){case 0:return new y.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new y.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new y.a(10,CommonUIStrings.l_TellMeDefinitionTitle);
case 3:return new y.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new y.a(19,this.qb.FMb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}KWj(fa){return"Type"in fa&&!!fa.Type&&""!==fa.Type&&"Description"in fa&&!!fa.Description&&""!==fa.Description}NWj(fa){return"Type"in fa&&!!fa.Type&&""!==fa.Type&&"CommandId"in fa&&!!fa.CommandId&&""!==fa.CommandId&&"Score"in fa&&!!fa.Score}yme(fa){if("GroupType"in fa&&fa.GroupType&&"ConfidenceScore"in fa&&
"ConfidenceThreshold"in fa)return!0;E.TellMeActor.instance.Hd.onError("IsValidIntentGroup","Invalid intents found");return!1}Plj(fa){const ma=u.a.zmg(fa),da={};da.Query=fa;ma&&this.SWb&&(this.jQj()?da.UserActionEvents=E.TellMeActor.instance.yqf:(da.CommandClickedEvents=E.TellMeActor.instance.Oyd,da.CommandActionEvents=E.TellMeActor.instance.B9e),da.TellMeCommandClickMruEvents=E.TellMeActor.instance.Uif,da.ContentType=E.TellMeActor.instance.lMc);this.MDc&&(fa={},fa.Application=this.qb.application,
da.TemplateInfo=fa);return aa.c(da)}kkb(){return!!this.qb&&this.qb.kkb||!!N.AFrameworkApplication.Aa&&N.AFrameworkApplication.Aa.hb.kkb}lkb(){return!!this.qb&&this.qb.lkb||!!N.AFrameworkApplication.Aa&&N.AFrameworkApplication.Aa.hb.lkb}mkb(){return!!this.qb&&this.qb.mkb||!!N.AFrameworkApplication.Aa&&N.AFrameworkApplication.Aa.hb.mkb}KMb(){return!!this.qb&&this.qb.KMb||!!N.AFrameworkApplication.Aa&&N.AFrameworkApplication.Aa.hb.KMb}JMb(){return!!this.qb&&(this.qb.JMb||this.qb.OH)}Ril(){return!!this.qb&&
!this.qb.hVa}ejl(){return!!this.qb&&this.qb.hac}Qil(){return!!this.qb&&this.qb.CIj&&this.qb.zIj}bng(){return!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}cng(){return!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}jQj(){return!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",
!1)}wZc(){return!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Muh(){return!!N.AFrameworkApplication.fa&&N.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}woj(){return N.AFrameworkApplication.fa?N.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}Qlj(){if(!N.AFrameworkApplication.fa)return"";
if(this.cng())return N.AFrameworkApplication.fa.Ga("TellMeServiceProdEndpointForSearch");if(this.bng())return N.AFrameworkApplication.fa.Ga("TellMeServiceEdogEndpointForSearch");if(u.a.hje())return N.AFrameworkApplication.fa.Ga("TellMeServiceIntEndpointForSearch");let fa=N.AFrameworkApplication.fa.Ga("TellMeServiceSearchEndpoint");fa&&""!==fa||(fa=N.AFrameworkApplication.fBh);return fa}static mLf(fa,ma){if(ma)return new ca(fa,["Command","Recommended"],fa.v9i);ma=u.a.d4()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):
"Help WolframAnswer File People Notes Template Addin".split(" ");return new ca(fa,ma,fa.N6f)}}Object(I.a)(ca,"TellMeServiceProvider",null,[654])},1133:function(I,Y,d){d.r(Y);d.d(Y,"SurfaceStringTokenStringGenerator",function(){return e});I=d(0);var h=d(546);class e extends h.a{constructor(n){super(n);this.Ia=n}apply(n,m,z,B,v,y,A){null==y&&(y=n.h8f(v,m));A=h.a.Jtf(n,y,this.Ia.score,z,B,A);return{Atc:y,e_b:A}}}e.f_b=0;Object(I.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1134:function(I,Y,d){d.r(Y);
d.d(Y,"QueryTokenStringGenerator",function(){return n});I=d(0);var h=d(546),e=d(79);class n extends h.a{constructor(m){super(m);this.Ia=m}apply(m,z,B,v,y,A,E){z=this.Ia.query.load(z,null);y=0;let u=null;this.Ia.query.NU===e.Annotations.Fga?z&&(u=this.Ia.name):((u=this.Ia.name)&&(u+="_"),u+=this.Ia.annotations.V1(this.Ia.query.NU,z));null!=u&&(y=h.a.Jtf(m,u,this.Ia.score,B,v,y));return{Atc:A,e_b:E+y}}}n.f_b=1;Object(I.a)(n,"QueryTokenStringGenerator",h.a,[])},1135:function(I,Y,d){d.r(Y);d.d(Y,"FuzzyMatchTokenStringGenerator",
function(){return e});I=d(0);var h=d(546);class e extends h.a{constructor(n){super(n);this.Ia=n}apply(n,m,z,B,v,y,A){null==y&&(y=n.h8f(v,m));n=this.Ia.VSf.P4j(y);if(this.Ia.q7g)for(var E of n)if(!E.SG&&E.fQc)return{Atc:y,e_b:A};E=0;for(const u of n)if(u.SG&&!({dTd:E}=this.Lxf(u,!0,z,B,E)).returnValue)return{Atc:y,e_b:A};if(this.Ia.Fdg)for(const u of n)if(!({dTd:E}=this.Lxf(u,!1,z,B,E)).returnValue)break;return{Atc:y,e_b:A}}Lxf(n,m,z,B,v){let y;m?(m=0,y=n.fQc?1:0):(m=n.fQc?1:0,y=n.count-m);for(let A=
0;A<y;++A)if(h.a.Ktf(n.lSa+m+A,this.Ia.score,z,B),++v,0<this.Ia.RDe&&v>=this.Ia.RDe)return{returnValue:!1,dTd:v};return{returnValue:!0,dTd:v}}}e.f_b=2;Object(I.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1142:function(I,Y,d){d.r(Y);I=d(0);var h=d(306),e=d(18),n=d(16),m=d(1200),z=d(171);class B{constructor(P,Q,D,O=0){this.M9f=P;this.groupType=Q;this.Sae=O;this.Woc=D}}Object(I.a)(B,"SortingGroup",null,[]);class v{constructor(P,Q,D,O){this.order=P;this.y$a=Q;this.Spj=D;this.groupType=O}}Object(I.a)(v,
"SortingProp",null,[]);var y=d(117),A=d(144),E=d(103),u=d(125);class J{constructor(P,Q){this.JRg={};this.IRg={};this.IQg=this.pXg=1;this.IAf(P,Q)}Fol(P,Q,D){var O=E.a.MF(D)?this.JRg:this.IRg;D=new e.a;for(var X of Q)Q=Object(m.a)(v,O[h.a[X.groupType].toLowerCase()]),u.b(Q)||D.add(new n.a(Q,X));D.Sc((aa,V)=>aa.key.order<V.key.order?-1:1);Array.clear(P);X=y.TellMeActor.instance.OP;for(Q=0;Q<D.count;){O=D.ga(Q).key.y$a;var N=D.ga(Q).value;const aa=new z.a(D.ga(Q).key.groupType);u.b(X)||X.Location===
A.a.contextMenu||(aa.displayName=D.ga(Q).key.Spj);for(const V of N.results)aa.ls(V);for(N=++Q;N<D.count&&D.ga(N).key.y$a===O;)this.JOd(aa,D.ga(N).value),N=++Q;P.push(aa)}}IFl(P,Q){this.IQg=this.pXg=1;this.IAf(P,Q)}IAf(P,Q){this.qxh(P);for(var D=0;D<P.length;D++){let O=P[D];for(const X of O.Woc)this.P5h(X,D,O.M9f,O.groupType)}this.qxh(Q);for(P=0;P<Q.length;P++){D=Q[P];for(const O of D.Woc)this.O5h(O,P,D.M9f,D.groupType)}}qxh(P){P.sort((Q,D)=>Object(m.a)(B,Q).Sae>Object(m.a)(B,D).Sae?-1:1)}P5h(P,Q,
D,O){this.JRg[h.a[P].toLowerCase()]=new v(this.pXg++,Q,D,O)}O5h(P,Q,D,O){this.IRg[h.a[P].toLowerCase()]=new v(this.IQg++,Q,D,O)}JOd(P,Q){for(let D=0;D<Q.results.length;D++)P.ls(Q.results[D])}}Object(I.a)(J,"BaseGroupingSorter",null,[]);class G{constructor(){this.ccd=[new B("",25,[25]),new B("",24,[24]),new B(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new B(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new B(CommonUIStrings.l_TellMeSuggestionsProviderTitle,32,[15,14,19,3]),new B("",
13,[13]),new B("",22,[22])];this.Y9c=[new B(CommonUIStrings.l_TellMeCommandProviderTitle,30,[17,0,1,8,27]),new B(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,31,[2,19,23,28]),new B(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,32,[15,14,20,9,12,10,11,26]),new B("",13,[13,24]),new B("",22,[22])];this.vzg=new J(this.ccd,this.Y9c)}Lrc(P,Q,D,O=null,X=null){let N=!1;if(O){for(const aa of E.a.MF(D)?this.ccd:this.Y9c)this.bQk(aa,O);N=!0}if(X){for(const aa of E.a.MF(D)?this.ccd:this.Y9c)this.JFl(Q,
aa,X);N=!0}N&&this.vzg.IFl(this.ccd,this.Y9c);this.vzg.Fol(P,Q,D)}bQk(P,Q){const D=new e.a;for(var O of P.Woc){const X=Q[h.a[O].toLowerCase()];D.add(new n.a(u.b(X)?Number.MAX_VALUE:X,O))}if(D.count){D.Sc((X,N)=>X.key<N.key?-1:1);Q=Array(D.count);for(O=0;O<D.count;O++)Q[O]=D.ga(O).value;P.Woc=Q}}JFl(P,Q,D){let O=0;for(const X of Q.Woc)if(h.a[X].toLowerCase()in D&&D[h.a[X].toLowerCase()])for(const N of P)if(N.groupType===X){O+=D[h.a[X].toLowerCase()];break}Q.Sae=O}}Object(I.a)(G,"SimplifiedGroupingSorter",
null,[]);d.d(Y,"GroupsPlacementInfo",function(){return S});class S{constructor(P){this.HRg={};this.FRg={};this.GRg={};this.KRg={};this.XAe={};this.hSg=this.bik=this.fgk=this.Dgk=1;this.yTg=null;this.Fq=P;this.pli();this.VFk();this.lli();this.nki();P.OH&&(this.yTg=new G)}Oz(P){this.HRg[h.a[P].toLowerCase()]=this.Dgk++}cC(P,Q){this.FRg[h.a[P].toLowerCase()]=Q}ora(P){this.GRg[h.a[P].toLowerCase()]=this.fgk++}BS(P){this.KRg[h.a[P].toLowerCase()]=this.bik++}Wx(P){this.XAe[h.a[P].toLowerCase()]=this.hSg++}pli(){const P=
!!this.Fq&&this.Fq.hVa,Q=!!this.Fq&&this.Fq.Mkc,D=!!this.Fq&&this.Fq.iVa,O=!!this.Fq&&this.Fq.ome&&!E.a.nbb(),X=!!this.Fq&&this.Fq.hac,N=!!this.Fq&&this.Fq.nYc,aa=!!this.Fq&&this.Fq.Fke,V=!!this.Fq&&this.Fq.lYc;this.Fq&&(this.Fq.n3||this.Fq.rOc)&&this.Oz(25);V&&this.Oz(24);this.Oz(4);this.Oz(18);this.Oz(16);this.Oz(7);this.Oz(17);this.Oz(0);this.Oz(1);aa&&this.Oz(27);X&&this.Oz(23);P||this.Oz(2);P&&!Q||this.Oz(8);this.Oz(15);D&&this.Oz(20);this.Oz(14);this.Oz(9);this.Oz(12);this.Oz(10);this.Oz(11);
P&&this.Oz(2);P&&!Q&&this.Oz(8);this.Oz(19);N&&this.Oz(26);this.Oz(21);this.Oz(13);O&&this.Oz(22)}VFk(){this.cC(21,1);this.cC(4,3);this.cC(18,3);this.cC(16,3);this.cC(7,3);this.cC(17,5);this.cC(0,5);this.cC(1,1);this.cC(27,2);this.cC(2,1);this.cC(8,2);this.cC(15,3);this.cC(14,2);this.cC(26,3);this.cC(9,1);this.cC(12,1);this.cC(10,1);this.cC(11,1);this.cC(19,1);this.cC(23,1);this.cC(13,1);this.cC(24,1);this.cC(20,2);this.cC(22,1);this.cC(25,1)}lli(){this.ora(4);this.ora(0);this.ora(17);this.ora(7);
this.ora(16);this.ora(18);this.ora(15);this.ora(20);this.ora(8);this.ora(14)}nki(){this.BS(14);this.BS(10);this.BS(12);this.BS(9);this.BS(11);this.BS(20);this.BS(15);this.BS(8);this.BS(2);this.BS(1);this.BS(26);this.BS(7);this.BS(18);this.BS(16);this.BS(17);this.BS(0);this.BS(4)}N1k(){this.XAe={};this.hSg=1}Ghj(P,Q,D){this.N1k();const O=!!this.Fq&&this.Fq.hVa,X=!!this.Fq&&this.Fq.Mkc,N=!!this.Fq&&this.Fq.iVa,aa=!!this.Fq&&this.Fq.ome&&!E.a.nbb(),V=!!this.Fq&&this.Fq.hac,ca=!!this.Fq&&this.Fq.nYc,
fa=!!this.Fq&&this.Fq.Fke,ma=!!this.Fq&&this.Fq.lYc;P=P&&X;this.Wx(4);this.Wx(18);this.Wx(16);this.Wx(7);this.Wx(17);this.Wx(0);this.Wx(1);fa&&this.Wx(27);V&&this.Wx(23);O&&!X||!P||this.Wx(8);Q&&this.Wx(15);O||this.Wx(2);ca&&this.Wx(26);D&&this.Wx(14);O&&!X||P||this.Wx(8);Q||this.Wx(15);N&&this.Wx(20);D||this.Wx(14);this.Wx(9);this.Wx(12);this.Wx(10);this.Wx(11);O&&this.Wx(2);O&&!X&&this.Wx(8);this.Wx(19);this.Wx(21);this.Wx(13);ma&&this.Wx(24);aa&&this.Wx(22);return this.XAe}WG(){return this.Fq}}
Object(I.a)(S,"GroupsPlacementInfo",null,[])},1145:function(I,Y,d){d.r(Y);I=d(0);var h=d(710),e=d(451),n=d(306),m=d(1045),z=d(450);class B{constructor(S="",P="",Q="",D=-99999,O=-1,X=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=S?S:"";this.Description=P?P:"";this.Type=Q?Q:"";this.Score=D;this.Age=O;this.Count=X}}Object(I.a)(B,"Suggestion",null,[]);class v{constructor(S,P){this.GroupType=this.Suggestions=null;this.Suggestions=S;this.GroupType=P}}Object(I.a)(v,
"SuggestionGroup",null,[]);class y{}y.help="help";y.answer="answer";y.commands="commands";y.L8k="servicecommands";y.iBh="template";Object(I.a)(y,"SuggestionGroupType",null,[]);var A=d(117),E=d(103),u=d(27),J=d(36);d.d(Y,"InteractionLogger",function(){return G});class G{constructor(S,P,Q){this.kAd=0;this.XLd=this.qUb=null;this.Bj=S;this.YKd=this.bzd=this.ICd=!1;this.pPh=P;this.Xh=u.AFrameworkApplication.Ke;this.qb=Q;this.pxc=this.NHd=0}get Wna(){return this.Bj.Wna}$od(S){this.Bj.$od(S)}Mqg(){if(this.qUb){var S=
0;for(const P of this.qUb)this.Bj.M3j(P,S++);this.qUb=null}}beginQuery(S,P,Q){this.Bj.B3j(S,P,Q)}T3g(S,P){this.Bj.Ghi(S,P);this.ICd=!0;this.YKd=!1}S3g(){this.ICd=!1;this.bzd||(this.Mqg(),this.Bj.ERf(this.kAd))}D3j(S,P){this.Bj.E3j(S,P)}Qrk(S,P,Q,D,O){for(const X of this.pPh)if(S.startsWith(X)){this.YKd=!0;break}this.Bj.G1j(S,P,Q,D,O)}bsk(S){this.bzd=!1;this.kAd=S;this.ICd||this.YKd||(this.Mqg(),this.Bj.ERf(this.kAd,!1))}ask(S,P){this.Bj.K1j(S,P);this.bzd=!0}V4d(S,P){if(!S.count)return"";let Q="";
const D=Date.now();for(let O of S)S=(D-O.timeStamp)/1E3,S=E.a.wtd(S),0<Q.length&&(Q+=";"),Q+=P?O.commandId:O.controlId,Q+=":",Q+=S.toString();return Q}bkc(){var S=this.V4d(h.a.instance.kRb,!1);0<S.length&&this.Bj.E1j(S);S=this.V4d(h.a.instance.v2a,!0);0<S.length&&this.Bj.d1j(S);S=this.V4d(h.a.instance.qyc,!0);0<S.length&&this.Bj.n2j(S);S=A.TellMeActor.instance.Vif;0<S.length&&this.Bj.A3j(J.c(S))}X3j(S){this.Bj.s1j(S)}F5(S,P,Q,D,O,X,N,aa=null){this.Bj.X2j(S,P,Q,D,O,X,N,aa)}woe(S,P,Q,D){this.Bj.woe(S,
P,Q,D)}CH(S,P,Q=null){this.Bj.aGa(S,P,Q)}onError(S,P,Q=null){this.Bj.nbc(S,P,Q)}fbl(S){this.qUb=S}elj(S){const P=[];if(!S)return P;for(let Q=0;Q<S.length;Q++){const D=n.a[S[Q].groupType].toLowerCase(),O=[],X=S[Q].results;if(X){for(let N=0;N<X.length;N++)"findindocument"===D?Array.add(O,new B("","",D,X[N].score,X[N].YGc,X[N].count)):Array.add(O,new B(X[N].label,X[N].description,D,X[N].score,X[N].YGc,X[N].count));"answer"===D||"definition"===D||"wolframanswer"===D||"entity"===D?Array.add(P,new v(O,
y.answer)):"classifier"===D||"appsforoffice"===D?Array.add(P,new v(O,y.commands)):"serviceclassifier"===D?Array.add(P,new v(O,y.L8k)):"assistance"===D?Array.add(P,new v(O,y.help)):("document"===D||"people"===D||"findindocument"===D||"notes"===D||"image"===D||"template"===D)&&Array.add(P,new v(O,D))}}return P}y$d(S,P){const Q={};Q.Query=P;Q.SuggestionGroups=J.c(this.elj(S));return J.c(Q)}L7f(S){const P={"Content-Type":"application/json",Accept:"application/json"};P["X-Office-Version"]=u.AFrameworkApplication.buildVersion;
P["X-Office-Application"]=u.AFrameworkApplication.fa.Ga("Application");P["X-Office-Platform"]="WAC";P["X-TellMe-SqmUserId"]=u.AFrameworkApplication.fa.Ga("LoggableUserId")||"";P["X-TellMe-SessionId"]=this.Bj.Wna.a9;P["X-TellMe-SuggestionTypes"]="Ranker";P["X-TellMe-Culture"]=u.AFrameworkApplication.uiCulture;P["X-TellMe-ProcessSessionId"]=u.AFrameworkApplication.userSessionId;P["X-TellMe-Flights"]=S;P["X-TellMe-PartialQueryIndex"]=this.NHd;return P}Xgb(S,P,Q){this.F5(P.length,"RankerLogging",S.data.oe.toString(),
Math.round(window.performance.now()-Q),z.a.eBh,!0,e.a.Qta)}Lgb(S,P,Q){this.F5(P.length,"RankerLogging",S.data.oe.toString(),Math.round(window.performance.now()-Q),z.a.eBh,!1,e.a.Qta)}M7f(){this.XLd||(this.XLd=new m.a(this.qb,null,6E3));return this.XLd.Wza}zoe(S){const P=this.y$d(this.qUb,S),Q=this.L7f("RankerLogging"),D=window.performance.now();this.Xh.mj(this.M7f(),2,P,Q,!1,0,O=>{this.Xgb(O,S,D)},O=>{this.Lgb(O,S,D)},null,null,!1,4E3,6E3);this.NHd++}F1k(){this.NHd=0}fVe(S){this.pxc=S}}Object(I.a)(G,
"InteractionLogger",null,[])},117:function(I,Y,d){d.r(Y);I=d(0);var h=d(1201),e=d(1202),n=d(14),m=d(24),z=d(1200),B=d(710),v=d(265);class y{constructor(xb,Rb,wc,ud,uc,db){this.groupType=xb;this.resultType=Rb;this.S_e=wc;this.y$a=ud;this.T_d=uc;this.resultIndex=db}}Object(I.a)(y,"ClickLoggingInfo",null,[]);const A=xb=>{const Rb=[];for(;xb;)Array.add(Rb,"{ContextId:"+xb.contextId+", IsGraphNodeContext:"+xb.al+"}"),xb=xb.CE;Rb.reverse();return"{"+Rb.join(", ")+"}"};class E{constructor(){this.a9=this.sessionId=
null}}Object(I.a)(E,"CorrelationRecord",null,[1E3]);var u=d(263);class J{constructor(xb,Rb){this.provider=xb;this.Ztd=Rb}}Object(I.a)(J,"ExternalResultProvider",null,[]);class G{constructor(xb,Rb){this.Id=null;this.TimeStamp=0;this.Id=xb;this.TimeStamp=Rb}}Object(I.a)(G,"MRUControl",null,[]);var S=d(697),P=d(693),Q=d(103),D=d(27),O=d(373);class X{constructor(xb,Rb){this.iWh=10;this.JV=[];this.Kha=[];this.nff=this.mff=!1;this.WUb=this.VUb="";this.QAc=Rb;this.qb=xb;this.Uff=xb.Oo}r5b(){!this.mff&&this.Uff&&
this.qb&&P.a.Ujg()&&(this.VUb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.qb.application,this.JV=this.h_f(),this.mff=!0);return this.JV}igj(){!this.nff&&this.Uff&&this.qb&&P.a.Ujg()&&(this.WUb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.qb.application,this.Kha=this.h_f(!0),this.nff=!0);return this.Kha}OVj(xb){return xb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===xb||"TryOfficeUpsell"===xb}Yie(xb){return this.aJj(xb)||this.OVj(xb)||Q.a.Ymg(xb)?!1:!0}e5h(xb){xb=xb.ControlId;this.Yie(xb)&&(xb=
this.SQe(xb),this.jXk(xb),this.zjk(),Array.insert(this.JV,0,new G(xb,Date.now())),this.VUb.length&&(xb=JSON.stringify(this.JV),O.a.instance.setItem(this.VUb,xb)))}Qy(xb){this.yjk();Array.insert(this.Kha,0,new G(S.a[xb],Date.now()));this.WUb.length&&(xb=JSON.stringify(this.Kha),O.a.instance.setItem(this.WUb,xb))}h_f(xb=!1){if(!this.JV.length){var Rb=xb?O.a.instance.getItem(this.WUb):O.a.instance.getItem(this.VUb);if(!Rb||""===Rb)return xb?this.Kha:this.JV;let wc=null;try{wc=JSON.parse(Rb)}catch(ud){this.$si(xb),
wc=null}if(!wc||!wc.length||10<wc.length)return xb?this.Kha:this.JV;Rb=0;for(const ud of wc)if(xb||this.qb.C0c(ud.Id)&&this.Yie(ud.Id))if(xb?Array.insert(this.Kha,Rb++,ud):Array.insert(this.JV,Rb++,ud),Rb===this.QAc)break}return xb?this.Kha:this.JV}AWd(xb){xb=this.SQe(xb);for(const Rb of this.JV)if(Rb.Id===xb)return!0;return!1}$si(xb=!1){O.a.instance.setItem(xb?this.WUb:this.VUb,"")}nLj(xb){xb=this.SQe(xb.ControlId);return this.Yie(xb)?this.AWd(xb):!1}jXk(xb){if(0<this.JV.length){let Rb=0;for(const wc of this.JV){if(wc.Id===
xb){Array.removeAt(this.JV,Rb);break}Rb++}}}SQe(xb){return"Excel"===this.qb.application&&xb.startsWith("m_excelWebRenderer_ewaCtl_")?xb.substr(26,xb.length):xb}zjk(){this.JV.length===this.QAc&&Array.removeAt(this.JV,this.JV.length-1)}yjk(){this.Kha.length===this.iWh&&Array.removeAt(this.Kha,this.Kha.length-1)}aJj(xb){xb=xb.split("|");let Rb="";if(6<=xb.length)Rb=xb[0];else if(3<=xb.length){if("3"===xb[0])return!0;Rb=xb[1]}return Rb.startsWith("WA")}static createInstance(xb){let Rb=3;D.AFrameworkApplication.fa&&
(Rb=D.AFrameworkApplication.fa.Bc("TellMeMaxRecommendedResultsToReturn",3));return new X(xb,Rb)}}Object(I.a)(X,"MruControlsManager",null,[999]);class N{constructor(xb){this.u4a=xb}ZK(xb,Rb){let wc;return xb.KJ&&(wc=this.u4a[xb.value])?wc.ZK(xb,Rb):(wc=this.V_f(xb.value))?wc.ZK(wc.Fmk,Rb):null}Rej(xb,Rb){if(xb=this.u4a[xb])for(const wc of Rb)if(Rb=Q.a.getParameter(wc),Rb.key===xb.gCk)return Rb.value;return null}Yok(xb){(xb=this.V_f(xb))&&xb.Wok()}V_f(xb){const Rb=xb.indexOf(Q.a.c9g);return 0<Rb?this.u4a[xb.substring(0,
Rb)]:null}}Object(I.a)(N,"ParameterizedCommandManager",null,[998]);var aa=d(306);class V{constructor(xb,Rb){this.zf=xb;this.PZa=Rb}}Object(I.a)(V,"TellMeQuery",null,[]);var ca=d(694);class fa{constructor(xb,Rb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=xb;this.TimeElapsedSinceClick=Rb}}Object(I.a)(fa,"CommandClickedEvent",null,[]);var ma=d(125);class da{constructor(xb,Rb){this.pXh=xb;this.Vba=Rb}resultsUpdated(xb){this.pXh(ma.b(xb.query)?"":xb.query.zf,xb.Lk,xb.attributes,this.Vba,xb.Qzb)}}
Object(I.a)(da,"ResultsUpdatedCallback",null,[959]);class qa{constructor(xb,Rb,wc,ud,uc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=xb;this.TimeElapsedSinceClick=wc;this.CommandSurface=ud;this.CommandId=Rb;this.TerminalParentControlId=uc}}Object(I.a)(qa,"UserActionEvent",null,[]);var F=d(18);class sa{constructor(xb,Rb){this.menuModel=xb;this.resultCount=Rb}}Object(I.a)(sa,"GeneratedMenuModel",null,[]);class ia{constructor(){this.ariaLabel=
this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(I.a)(ia,"MenuModel",null,[]);class Na{constructor(xb,Rb,wc){this.qb=xb;this.u4a=Rb;this.G5a=wc}Z1i(xb,Rb,wc){const {TellMeActor:ud}=d(117);let uc=0;const db=new ia,Yb=[];let Zc="";db.sections=[];let Kb=new F.a;const Yc=!!this.qb&&this.qb.hVa;var ec=!!this.qb&&this.qb.EMb||D.AFrameworkApplication.Aa.hb.EMb;for(const ac of xb){xb=0;Yc||(Kb=new F.a);const Jc=new F.a;let Db=ac.displayName;for(const dd of ac.results){if(0<=
dd.value.indexOf(Q.a.pZe)){if(dd.KJ){var rb=this.u4a[dd.value];if(rb&&dd.value.endsWith(Q.a.pZe)){if("FindParameterized"!==dd.value&&!ec){const Cd=[];Cd.push(appChrome.actions.setControlLabel(dd.value,rb.gbj(dd)));Cd.push(appChrome.actions.setButtonCommandValueId(dd.value,rb.K5i(dd)));appChrome.api.dispatch(Cd)}rb=dd.value.replace(Q.a.pZe,"");Kb.remove(rb)?xb--:Jc.add(rb);Kb.add(dd.value);xb++}}}else switch(dd.type){case 5:Jc.contains(dd.value)||(Kb.add(dd.value),xb++);break;case 7:Kb.add(dd.KJ);
xb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 6:case 19:case 20:case 21:case 26:case 28:case 27:case 29:case 30:Kb.add(dd.value),xb++}13===ac.groupType&&(Db=Q.a.d4()?0<Rb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Rb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Rb));21===ac.groupType&&(Db=CommonUIStrings.l_LearningUILiveText)}uc+=xb;""!==
Db&&0<xb&&(Zc+=" , "+xb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Db+" , ");0<Kb.count&&!Yc&&(xb=appChrome.api.menuSection(Kb.toArray(),ac.displayName,null,aa.a[ac.groupType]),Yb.push(xb))}ec=null;0<uc&&(ec=0<Rb.length?1!==uc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,uc,Rb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Rb):1!==uc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,uc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,
Yc?(Rb=appChrome.api.menuSection(Kb.toArray(),"",null,null),Yb.push(Rb)):ec+=Zc);wc&&(this.qb.tda?ud.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(ec)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(ec)));db.sections=Yb;return new sa(db,uc,[])}static get T0d(){return Na.Paf||(Na.Paf=new sa(Object.assign(new ia,{sections:[]}),0,[]))}}Na.Paf=null;Object(I.a)(Na,"TellMeMenuDefintionGenerator",null,[]);var Ca;(function(xb){xb[xb.TellMeControlActivated=
0]="TellMeControlActivated";xb[xb.TellMeQueryExecuted=1]="TellMeQueryExecuted";xb[xb.TellMeResultsRendered=2]="TellMeResultsRendered";xb[xb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Ca||(Ca={}));Object(I.b)("PerformanceMarker",Ca);var ha;(function(xb){xb[xb.TellMeTimeToRender=0]="TellMeTimeToRender";xb[xb.TellMeSessionLength=1]="TellMeSessionLength";xb[xb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(ha||(ha={}));Object(I.b)("PerformanceMeasure",ha);class Ba{mark(xb){window.performance.mark(Ca[xb])}measure(xb,
Rb,wc){const {TellMeActor:ud}=d(117);try{window.performance.measure(ha[xb],Ca[Rb],Ca[wc])}catch(uc){ud.instance.Hd.onError("TellMePerformance:Measure","error measuring "+ha[xb])}}poe(xb,Rb,wc){const {TellMeActor:ud}=d(117);ud.instance.Hd.woe(Rb,wc,xb,this.xcj(xb))}zQa(xb){for(const Rb of xb)window.performance.clearMarks(Ca[Rb])}clearMeasures(xb){for(const Rb of xb)window.performance.clearMeasures(ha[Rb])}xcj(xb){let Rb=0;(xb=this.S2i(xb))&&0<xb.length&&(Rb=xb[xb.length-1].duration);return Rb}S2i(xb){return window.performance.getEntriesByName(ha[xb],
"measure")}}Object(I.a)(Ba,"TellMePerformance",null,[]);var va=d(451),ta=d(450),Fa=d(36);class pa{constructor(xb){this.I1h=xb}MIe(xb,Rb,wc){const {TellMeActor:ud}=d(117);ud.instance.Hd.F5(Rb,ta.a.cJb,xb.data.oe.toString(),Math.round(window.performance.now()-wc),ta.a.cJb,!0,va.a.Qta);xb=Fa.b(xb.data.Sd);Rb=-1;xb.Index&&(Rb=xb.Index);ud.instance.Hd.D3j(Rb,this.I1h)}Vjc(xb,Rb,wc){const {TellMeActor:ud}=d(117);ud.instance.Hd.F5(Rb,ta.a.cJb,xb.data.oe.toString(),Math.round(window.performance.now()-wc),
ta.a.cJb,!1,va.a.Qta)}lgj(xb){if(xb&&""!==xb.trim()){const wc=window.performance.now(),ud=D.AFrameworkApplication.cBh;var Rb={};Rb.Text=xb;Rb.IsFileHash="false";Rb=Fa.c(Rb);D.AFrameworkApplication.Ke.mj(ud,2,Rb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,uc=>{this.MIe(uc,xb.length,wc)},uc=>{this.Vjc(uc,xb.length,wc)},null,null,!1,4E3,6E3)}}}Object(I.a)(pa,"TellMeQueryIndexCallback",null,[]);var ka=d(144);class Ha{constructor(xb,Rb,wc){this.xml=xb;this.resultCount=Rb;this.xNi=
wc}}Object(I.a)(Ha,"GeneratedMenuXml",null,[]);var Ya=d(978),Ka=d(47);class Pa{constructor(xb,Rb){this.Zwc=xb||{};this.RAa=Rb}get Vib(){return 5}ZK(xb,Rb=null){return this.RAa.ZK(xb,Rb)||this.Nji(xb.value)}Nji(xb){return Pa.Mji(xb,this.Zwc[xb]||null)}static Mji(xb,Rb=null){xb=String.format('<ClonedControl Id="{0}" ',xb);for(let uc in Rb){var wc=uc,ud=Rb[uc];ud=ud?Ka.a.ue(ud.toString()):"";xb+=String.format('{0}="{1}" ',wc,ud)}return xb+"/>"}}Object(I.a)(Pa,"CommandMenuItemFactory",null,[704]);var Oa=
d(135);class oa{constructor(){this.tRh=CommonUIStrings.l_FindInDocumentText}get Vib(){return 8}ZK(xb){var Rb=xb.KJ;xb=Ka.a.ue(xb.value);const wc=Ka.a.ue(Rb);Rb=Ka.a.ue(String.format(this.tRh,Rb));return this.p1i(xb,wc,Rb)}p1i(xb,Rb,wc){return Oa.a(xb,"1540292897",wc,Q.a.LXi,null,Rb,wc,null,null)}}Object(I.a)(oa,"FindInDocumentMenuItemFactory",null,[704]);var Xa=d(979),Hb=d(977),Ob=d(980);class eb{get Vib(){return 7}ZK(xb){const Rb=Object(z.a)(ca.a,xb);return this.e2i(Ka.a.ue(xb.value),Rb.id)}e2i(xb,
Rb){return Oa.a(Rb,"1404166600",xb,null,null,xb,xb,null,null)}}Object(I.a)(eb,"TryQueryMenuItemFactory",null,[704]);class Eb{constructor(xb){this.Zpa=[];this.qb=xb}t9i(xb){for(const Rb of this.Zpa)if(Rb.Vib===xb)return Rb;return null}h_a(xb){this.Zpa.push(xb)}HTk(xb){this.h_a(new Pa(this.qb.bAi,xb));this.h_a(new Ob.a(this.qb.iok));this.h_a(new Ya.a(this.qb.x6k,this.qb.w6k,this.qb.pul,this.qb.Yyj,this.qb.Lhl));this.h_a(new Hb.InsightsMenuItemFactory);this.h_a(new oa);this.h_a(new Xa.a);this.h_a(new eb)}}
Object(I.a)(Eb,"MenuItemFactoryRegistry",null,[]);var oc=d(156);class Sb{constructor(xb,Rb){this.qb=xb;this.zif=new Eb(this.qb);this.zif.HTk(Rb)}$1i(xb,Rb){let wc=0;const ud=[],uc=[];for(const Yb of xb){xb=Q.a.c1e;var db=[];for(const Zc of Yb.results){const Kb=this.zif.t9i(Zc.type).ZK(Zc,Rb);xb=Q.a.c1e;db.push(Kb);if(13===Zc.type||14===Zc.type)xb="Menu32";17===Zc.type&&(xb="MenuTellMeExtended");Zc.groupType=Yb.groupType;uc.push(Object(z.a)(oc.a,Zc))}wc=wc?wc:db.length;db=Oa.c("TellMeDropdownControls",
db);xb=Oa.e("TellMeDropdownMenuSection",db,xb,Yb.displayName);ud.push(xb)}Rb=Oa.f(ud,"LookupDropdownMenu");return new Ha(Rb,wc,uc)}static get lOc(){return Sb.Qaf||(Sb.Qaf=new Ha(Oa.f([],"LookupDropdownMenu"),0,[]))}}Sb.Qaf=null;Object(I.a)(Sb,"TellMeXmlGenerator",null,[]);class qc{}qc.bnk="MRU";qc.test="Test";Object(I.a)(qc,"ActionType",null,[]);var $a=d(383),ab=d(987),Ib=d(105);class gc{constructor(xb,Rb,wc,ud,uc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=
null;this.CommandId=xb;this.IsEnabled=Rb;this.ResultType=S.a[wc];this.SubResultType=ab.a[ud];this.OptionalData=uc?Ib.a.toJSON(uc):null}}Object(I.a)(gc,"ResultInfo",null,[]);var Ta=d(172),Ab=d(142),kc=d(181);class fb{constructor(xb,Rb=null){this.hef="TellMeWAC.";this.UXh=xb;this.l2h=Rb}zoa(xb,Rb,wc){Rb=Ta.a.pC(Rb);xb=Ta.a.GYd(xb,this.UXh,this.l2h,wc,Rb);Ab.a.zoa(xb,this.hef)}MKa(xb,Rb,wc=0){Rb=Ta.a.pC(Rb);Ab.a.MKa(Object.assign(new kc.a,{name:xb,dataFields:Rb,durationMs:wc}),this.hef)}}Object(I.a)(fb,
"TellMeOtelLogger",null,[736]);var Qb=d(106);class mb{constructor(xb,Rb,wc,ud,uc,db,Yb){this.KV=this.BZ=this.F9e=null;this.Epa=xb;this.ezd=Rb;this.Cqa=wc;this.SNa=ud;this.DAa=uc;this.MUh=db;this.KV=Yb?Yb:new fb(this.SNa?v.CuiHelper.oZe:v.CuiHelper.l1e)}get Oo(){return this.SNa}get Wna(){return this.Cqa}$od(xb){this.F9e=xb;switch(xb){case ka.a.contextMenu:this.BZ=ka.a.contextMenu;break;default:this.BZ=ka.a.tellMe}}Ghi(xb,Rb){this.Cqa.a9||(this.Cqa.a9=Qb.a.create().toString(),this.hqg(xb,!0,Rb))}ERf(xb,
Rb=!0){this.Cqa.a9&&this.a2j(xb,Rb);this.SNa&&appChrome.api.updateTellMeCorrelationId("");this.Cqa.a9=null}hqg(xb,Rb,wc){const {TellMeActor:ud}=d(117),uc=this.tW(u.a.Lyb);uc[$a.a.culture]=this.ezd;uc[$a.a.appName]=this.Epa;uc[$a.a.context]=xb;uc[$a.a.O_c]=this.DAa;uc[$a.a.KVj]=this.MUh;uc[$a.a.pUj]=wc;uc[$a.a.IOj]=Rb;uc[$a.a.contentType]=ud.instance.lMc;this.KV.zoa(u.a.Lyb,uc,this.F9e);this.SNa&&appChrome.api.updateTellMeCorrelationId(this.Cqa.a9)}a2j(xb,Rb){const wc=this.tW(u.a.nfg);wc[$a.a.rPi]=
xb;wc[$a.a.HOj]=Rb;this.KV.MKa(u.a.nfg,wc)}B3j(xb,Rb,wc){let ud=0;!wc&&0<xb.length&&(ud=xb.trim().split(" ").length);const uc=this.tW(u.a.query);uc[$a.a.query]="!";uc[$a.a.Uhb]=Rb;uc[$a.a.hdh]=xb.length;uc[$a.a.Sng]=wc;uc[$a.a.EKl]=ud;this.KV.zoa(u.a.query,uc,this.BZ)}X2j(xb,Rb,wc,ud,uc,db,Yb,Zc=null){const Kb=this.tW(u.a.latency);Kb[$a.a.culture]=this.ezd;Kb[$a.a.hdh]=xb;Kb[$a.a.SEh]=Rb;Kb[$a.a.statusCode]=wc;Kb[$a.a.K8k]=uc;Kb[$a.a.isSuccess]=db;Kb[$a.a.PYj]=Yb;Zc&&(Kb[$a.a.lwl]=Zc);this.KV.MKa(u.a.latency,
Kb,ud)}woe(xb,Rb,wc,ud){const uc=this.tW(u.a.performance);uc[$a.a.culture]=this.ezd;uc[$a.a.Jhi]=Ca[xb];uc[$a.a.$Qi]=Ca[Rb];uc[$a.a.nEk]=ha[wc];this.KV.MKa(u.a.performance,uc,ud)}M3j(xb,Rb){var {TellMeActor:wc}=d(117);const {CommandResultsUtility:ud}=d(335);if(xb.results.length){var uc=this.tW(u.a.yjh);uc[$a.a.y$a]=Rb.toString();uc[$a.a.groupType]=aa.a[xb.groupType];16===xb.groupType&&(uc[$a.a.TTj]=wc.instance.Fuc);Rb=[];wc=[];var db=[];for(const Yb of xb.results)uc[$a.a.resultType]||(uc[$a.a.resultType]=
S.a[Yb.type]),xb={},26===Yb.type&&(xb.AssetId=Yb.XPd),wc.push(ud.s9b(Yb.value)),Rb.push(Yb.value),db.push(new gc(Yb.value,ud.s9b(Yb.value),Yb.type,Yb.subType,xb));0<Rb.length&&(uc[$a.a.c3k]="{"+Rb.join(", ")+"}",uc[$a.a.CQi]="{"+wc.join(", ")+"}",uc[$a.a.Z2k]=Fa.c(db));this.KV.zoa(u.a.yjh,uc,this.BZ)}}t2i(xb,Rb){if(4===xb)return qc.bnk;switch(Rb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return S.a[Rb]}G1j(xb,
Rb,wc,ud,uc){const db=this.tW(u.a.click);db[$a.a.SEh]=xb;db[$a.a.iCk]=Rb;db[$a.a.commandId]=wc;db[$a.a.i7a]=ud;db[$a.a.actionType]=this.t2i(uc.groupType,uc.resultType);db[$a.a.resultType]=S.a[uc.resultType];db[$a.a.S_e]=ab.a[uc.S_e];db[$a.a.groupType]=aa.a[uc.groupType];db[$a.a.y$a]=uc.y$a.toString();db[$a.a.T_d]=uc.T_d.toString();db[$a.a.resultIndex]=uc.resultIndex.toString();this.KV.zoa(u.a.click,db,this.BZ)}K1j(xb,Rb){this.Cqa.a9||(this.Cqa.a9=Qb.a.create().toString(),this.hqg("",!1,Rb));Rb=this.tW(u.a.nIf);
Rb[$a.a.Uhb]=xb;this.KV.MKa(u.a.nIf,Rb)}qqg(xb,Rb,wc){if(xb){if(wc)for(let ud in wc)xb[ud]=wc[ud];this.KV.MKa(u.a.events,xb,Rb)}}aGa(xb,Rb,wc=null){const ud=this.tW(u.a.events);ud[$a.a.event]=xb;this.qqg(ud,Math.round(Rb),wc)}nbc(xb,Rb,wc=null){const ud=this.tW(u.a.events);ud[$a.a.event]=u.a.error;ud[$a.a.module]=xb;ud[$a.a.errorMessage]=Rb;ud[$a.a.message]=Rb;this.qqg(ud,Math.round(window.performance.now()),wc)}E1j(xb){const Rb=this.tW(u.a.DGf);Rb[$a.a.value]=xb;Rb[$a.a.xkd]=this.SNa;this.KV.zoa(u.a.DGf,
Rb,this.BZ)}d1j(xb){const Rb=this.tW(u.a.zrf);Rb[$a.a.value]=xb;Rb[$a.a.xkd]=this.SNa;this.KV.zoa(u.a.zrf,Rb,this.BZ)}n2j(xb){const Rb=this.tW(u.a.vVf);Rb[$a.a.value]=xb;Rb[$a.a.xkd]=this.SNa;this.KV.zoa(u.a.vVf,Rb,this.BZ)}A3j(xb){const Rb=this.tW(u.a.Pch);Rb[$a.a.value]=xb;Rb[$a.a.xkd]=this.SNa;this.KV.zoa(u.a.Pch,Rb,this.BZ)}s1j(xb){const Rb=this.tW(u.a.cph);Rb[$a.a.value]=xb;this.KV.zoa(u.a.cph,Rb,this.BZ)}E3j(xb,Rb){const wc=this.tW(u.a.fdh);wc[$a.a.cJb]=xb;Rb&&(wc[$a.a.a9]=Rb);this.KV.MKa(u.a.fdh,
wc)}tW(xb){return{["SessionID"]:this.Cqa.sessionId,["CorrelationID"]:this.Cqa.a9,["Time"]:(new Date).getTime(),["Event"]:xb,["Scenario"]:this.BZ}}}Object(I.a)(mb,"UsageLogger",null,[706]);var Jb=d(95);class Ub{}Ub.Callback="action";Object(I.a)(Ub,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var tb=d(533),Bc=d(305),Gb=d(81),Hc=d(134),$b=d(486),lc=d(239),Vb=d(55),ic=d(270),qb=d(73),Wb=d(37);d.d(Y,"TellMeActor",function(){return Xc});class Xc{constructor(){this.RAa=this.oS=this.Nd=this.$a=this.M6=
this.uG=this.Zd=this.Ca=this.Hd=this.FD=this.YFd=this.jrf=this.z7=this.qb=null;this.Job=!1;this.Oyd=[];this.B9e=[];this.yqf=[];this.Uif=[];this.Vif=[];this.Rff=!1;this.inb=this.G5a=null;this.LTb=this.DAa=!1;this.bBc=!0;this.OP=this.hzc=this.Hcf=this.iGd=this.Oif=null;this.Y1=[];this.hNa=this.Anb=this.iha=this.BCc=this.Aof=null;this.qob=!1;this.cGd=0;this.anb=null;this.Vba=-1;this.Aif=0;this.UTb=!1;this.rNa=null;this.wqf=!1;this.bnb=this.vS=null}get lMc(){return this.M6?this.M6.contentType:Xc.unknown}get actions(){return this.Y1}set actions(xb){this.Y1=
xb}AUc(){return this.Hd?this.Hd.Wna.a9:null}WG(){return this.qb}get umk(){return this.bBc}get xJl(){return this.Oif}performance(){return this.FD}get jZe(){return this.Aof}set jZe(xb){this.Aof=xb}get Fuc(){return this.wqf}set Fuc(xb){this.wqf=xb}sG(xb){const Rb=window.performance.now();this.G5a&&!ma.b(xb)&&(this.G5a(xb),this.Hd.CH(u.a.sG,window.performance.now()-Rb))}initialize(xb,Rb=null,wc=null,ud=null,uc=null,db=null,Yb=null,Zc=null,Kb=null,Yc=null,ec=null){const {InteractionLogger:rb}=d(1145),
{GroupsPlacementInfo:ac}=d(1142),{AggregatorResultsProvider:Jc}=d(999);this.qb=xb;this.DAa=!!D.AFrameworkApplication.Aa&&D.AFrameworkApplication.Aa.hb.hAb;this.Hd=ud;if(!ud){ud=new E;ud.sessionId=D.AFrameworkApplication.userSessionId;const Db=ic.a.xe(D.AFrameworkApplication.lcid)||ic.a.c9b;this.Hd=new rb(new mb(this.qb.application,Db.name,ud,this.qb.Oo,this.DAa,xb.pza,null),this.qb.cAi,this.qb)}this.RAa=new N(this.qb.parameterData);this.jrf=wc||new Sb(this.qb,this.RAa);this.G5a=Yb;this.YFd=this.YFd||
new Na(this.qb,this.qb.parameterData,Yb);this.Nd=Jb.FocusManager.instance();this.oS=X.createInstance(this.qb);this.Hcf=new ac(xb);this.Ca=uc||D.AFrameworkApplication.Ta;this.Zd=db||D.AFrameworkApplication.ye;this.uG=Kb;this.z7=Rb;this.vS=ec;this.FD=new Ba;this.bnb=new h.a(e.a.to());this.BCc=[];Kb?Kb.execute(Db=>{Db.isFeatureEnabled(Xc.cul,!0).then(dd=>{const {AggregatorResultsProvider:Cd}=d(999);this.UTb=dd;this.z7=this.z7||Cd.createInstance(this.oS,this.qb,this.RAa,this.UTb);for(const pd of this.BCc)this.z7.Qy(pd.provider,
pd.Ztd);this.BCc=[];return null})}):(this.UTb=!0,this.z7=this.z7||Jc.createInstance(this.oS,this.qb,this.RAa,this.UTb));this.$a=Zc;this.iha=Sb.lOc;this.Oif=new Promise(Db=>{this.iGd=Db});Yc&&Yc.execute(Db=>{this.M6=Db});this.qb.Oo&&Q.a.Ylg()&&(xb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.qb.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(xb,xb)))}wb(){this.P7h()}P7h(){this.Ca.ra(Wb.a.tellMe,qb.a.frame,Object(n.a)(this,this.tellMe,"tellMe"),96);
this.Ca.ra(Wb.a.b1e,qb.a.frame,Object(n.a)(this,this.$Bf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.ra(Wb.a.f1e,qb.a.frame,Object(n.a)(this,this.Cqg,"logItemExecuted"),96);this.Ca.ra(Wb.a.i1e,qb.a.frame,Object(n.a)(this,this.mqg,"logControlDeactivation"),96);this.Ca.ra(Wb.a.h1e,qb.a.frame,Object(n.a)(this,this.yqg,"logInputFocus"),96);this.Ca.ra(Wb.a.e1e,qb.a.frame,Object(n.a)(this,this.Lyb,"interactionBegin"),96);this.Ca.ra(Wb.a.k1e,qb.a.frame,Object(n.a)(this,this.Lyb,"interactionBegin"),96);
this.Ca.ra(Wb.a.g1e,qb.a.frame,Object(n.a)(this,this.xqg,"logInputBlur"),96);this.Ca.ra(Wb.a.j1e,qb.a.frame,Object(n.a)(this,this.lqg,"logControlActivated"),96);this.Ca.ra(Wb.a.ssd,qb.a.frame,Object(n.a)(this,this.qXf,"focusSearchBox"),96);this.Ca.ra(Wb.a.a1e,qb.a.frame,Object(n.a)(this,this.HHf,"constructLiveNotificationForMenu"),96);this.Ca.ra(Wb.a.m1e,qb.a.frame,Object(n.a)(this,this.Fhe,"insertTryQuery"),96);this.Ca.ra(Wb.a.Bne,qb.a.frame,Object(n.a)(this,this.Fhe,"insertTryQuery"),96);this.Ca.ra(Wb.a.c3d,
qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.d3d,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.e3d,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.f3d,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.g3d,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.aJe,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.bJe,qb.a.frame,Object(n.a)(this,
this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.cJe,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);this.Ca.ra(Wb.a.iKe,qb.a.frame,Object(n.a)(this,this.P8b,"insertMention"),96);this.Ca.ra(Wb.a.jKe,qb.a.frame,Object(n.a)(this,this.P8b,"insertMention"),96);this.Ca.ra(Wb.a.kKe,qb.a.frame,Object(n.a)(this,this.P8b,"insertMention"),96);this.Ca.ra(Wb.a.d1e,qb.a.frame,Object(n.a)(this,this.w7g,"openFeedback"),96);this.Ca.ra(Wb.a.n1e,qb.a.frame,Object(n.a)(this,this.rxa,"openOrInsertUrl"),96);
this.Ca.ra(Wb.a.TPd,qb.a.frame,Object(n.a)(this,this.MAb,"launchAddin"),96);this.Ca.ra(Wb.a.UPd,qb.a.frame,Object(n.a)(this,this.MAb,"launchAddin"),96);this.Ca.ra(Wb.a.VPd,qb.a.frame,Object(n.a)(this,this.MAb,"launchAddin"),96);this.Ca.ra(Wb.a.ukb,qb.a.frame,Object(n.a)(this,this.ukb,"showTellMeCoachmark"),96);this.Ca.ra(Wb.a.tne,qb.a.frame,Object(n.a)(this,this.Sog,"launchAddinStore"),96);this.Ca.ra(Wb.a.ROe,qb.a.frame,Object(n.a)(this,this.Hdh,"quickActionOnFileHandler"),96);this.Ca.ra(Wb.a.Z4d,
qb.a.frame,Object(n.a)(this,this.YYf,"generateSlidesFromFiles"),96)}hTk(xb){this.bBc=!1;const Rb=window.performance.now();xb.XFa.isCompleted?(this.bBc=!0,this.iGd(!0)):xb.DS(()=>{this.bBc=!0;this.iGd(!0);this.Hd.CH(u.a.RKi,window.performance.now()-Rb)});this.MTk(xb)}MTk(xb){lc.a.Nkd(Object(n.a)(this,this.kNi,"dispatcher"));lc.a.s3b([new $b.a(Wb.a.tellMe,qb.a.frame,96),new $b.a(Wb.a.b1e,qb.a.frame,96),new $b.a(Wb.a.f1e,qb.a.frame,96),new $b.a(Wb.a.i1e,qb.a.frame,96),new $b.a(Wb.a.h1e,qb.a.frame,96),
new $b.a(Wb.a.e1e,qb.a.frame,96),new $b.a(Wb.a.k1e,qb.a.frame,96),new $b.a(Wb.a.g1e,qb.a.frame,96),new $b.a(Wb.a.j1e,qb.a.frame,96),new $b.a(Wb.a.ssd,qb.a.frame,96),new $b.a(Wb.a.a1e,qb.a.frame,96),new $b.a(Wb.a.m1e,qb.a.frame,96),new $b.a(Wb.a.Bne,qb.a.frame,96),new $b.a(Wb.a.c3d,qb.a.frame,96),new $b.a(Wb.a.d3d,qb.a.frame,96),new $b.a(Wb.a.e3d,qb.a.frame,96),new $b.a(Wb.a.f3d,qb.a.frame,96),new $b.a(Wb.a.g3d,qb.a.frame,96),new $b.a(Wb.a.aJe,qb.a.frame,96),new $b.a(Wb.a.bJe,qb.a.frame,96),new $b.a(Wb.a.cJe,
qb.a.frame,96),new $b.a(Wb.a.iKe,qb.a.frame,96),new $b.a(Wb.a.jKe,qb.a.frame,96),new $b.a(Wb.a.kKe,qb.a.frame,96),new $b.a(Wb.a.d1e,qb.a.frame,96),new $b.a(Wb.a.n1e,qb.a.frame,96),new $b.a(Wb.a.TPd,qb.a.frame,96),new $b.a(Wb.a.UPd,qb.a.frame,96),new $b.a(Wb.a.VPd,qb.a.frame,96),new $b.a(Wb.a.ukb,qb.a.frame,96),new $b.a(Wb.a.tne,qb.a.frame,96),new $b.a(Wb.a.ROe,qb.a.frame,96),new $b.a(Wb.a.Z4d,qb.a.frame,96)],xb)}kNi(xb,Rb,wc,ud,uc){if(Rb.contextId===qb.a.frame)switch(xb){case Wb.a.tellMe:return this.tellMe(xb,
Rb,wc,ud,uc);case Wb.a.b1e:return this.$Bf(xb,Rb,wc,ud,uc);case Wb.a.f1e:return this.Cqg(xb,Rb,wc,ud,uc);case Wb.a.i1e:return this.mqg(xb,Rb,wc,ud,uc);case Wb.a.h1e:return this.yqg(xb,Rb,wc,ud,uc);case Wb.a.e1e:return this.Lyb(xb,Rb,wc,ud,uc);case Wb.a.k1e:return this.restoreFocus(xb,Rb,wc,ud,uc);case Wb.a.g1e:return this.xqg(xb,Rb,wc,ud,uc);case Wb.a.j1e:return this.lqg(xb,Rb,wc,ud,uc);case Wb.a.ssd:return this.qXf(xb,Rb,wc,ud,uc);case Wb.a.a1e:return this.HHf(xb,Rb,wc,ud,uc);case Wb.a.m1e:case Wb.a.Bne:return this.Fhe(xb,
Rb,wc,ud,uc);case Wb.a.c3d:case Wb.a.d3d:case Wb.a.e3d:case Wb.a.f3d:case Wb.a.g3d:case Wb.a.aJe:case Wb.a.bJe:case Wb.a.cJe:case Wb.a.n1e:return this.rxa(xb,Rb,wc,ud,uc);case Wb.a.iKe:case Wb.a.jKe:case Wb.a.kKe:return this.P8b(xb,Rb,wc,ud,uc);case Wb.a.d1e:return this.w7g(xb,Rb,wc,ud,uc);case Wb.a.TPd:case Wb.a.UPd:case Wb.a.VPd:return this.MAb(xb,Rb,wc,ud,uc);case Wb.a.ukb:return this.ukb(xb,Rb,wc,ud,uc);case Wb.a.tne:return this.Sog(xb,Rb,wc,ud,uc);case Wb.a.ROe:return this.Hdh(xb,Rb,wc,ud,uc);
case Wb.a.Z4d:return this.YYf(xb,Rb,wc,ud,uc)}return 2}qXf(xb,Rb,wc){if(1===wc)return 32;this.Hrh();xb=!1;(this.qb.pza||this.DAa)&&(Rb=document.getElementById("SearchButton"))&&Rb.click();if(!this.qb.pza&&this.DAa)for(Rb=document.getElementsByClassName("ms-suiteux-search-box"),wc=0;wc<Rb.length;wc++){const ud=Rb[wc].querySelector("input[type=search]");ud&&(xb=Jb.FocusManager.Wr(ud))}else xb=Jb.FocusManager.Wr($get(this.qb.Oo?v.CuiHelper.oZe:v.CuiHelper.l1e));this.LTb=!0;return xb?32:8}Fhe(xb,Rb,wc,
ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Hrh();xb=uc.CommandValueId;Rb=this.qb.Oo?v.CuiHelper.oZe:v.CuiHelper.l1e;this.qb.Oo&&!ma.b(uc[tb.a.Haa])&&(uc[tb.a.Haa]=!1);if(xb){if(this.qb.Oo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(xb)),this.rNa=[19],32;if(uc=$get(Rb))uc.value=xb}return Jb.FocusManager.Wr($get(Rb))?32:8}Hrh(){this.Nd.HU(this.qb.pza||this.DAa?this.qb.ZVc:this.qb.EKa,!1)}o2i(xb,
Rb){switch(xb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Rb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Rb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Rb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Rb)}return Rb}HHf(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:ConstructLiveNotificationForMenu",
"actiondata comes null"),16;xb=this.iha?this.iha.resultCount:0;uc.Value=1!==xb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,xb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.iha)for(const db of this.iha.xNi)uc=Object(m.a)(ca.a,db)?db.id:Ka.a.replaceAll(db.value,'"',""),(uc=$get(uc+"-"+Q.a.c1e))&&Hc.a.eP(uc,Hc.a.ns,Ka.a.ue(this.o2i(db.groupType,uc.innerText)));return 32}$Bf(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:CacheAsyncMenuRefreshFunction",
"actiondata comes null"),16;this.anb=new Gb.a(2,1,0,()=>{uc[Ub.Callback]()},97);this.iha&&this.Zd.Db(this.anb);return 32}Cqg(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;uc.CloseAllMenus&&(xb=void 0===uc.ParentControlId||null===uc.ParentControlId?"<NA>":uc.ParentControlId,Rb=this.inb?this.inb[uc.ControlId]:null,!Rb&&this.inb&&"<NA>"!==xb&&(Rb=this.inb[xb]),Rb||(Rb=this.Job&&this.oS.nLj(uc),Rb=this.MLi(Rb,uc.ControlId),
Rb=new y(Rb,31,4,-1,-1,-1),this.Hd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+uc.ControlId+" determined group:"+aa.a[Rb.groupType])),this.Hd.Qrk(uc.ControlId,xb,uc.CommandId,uc.CloseAllMenus,Rb),this.RAa.Yok(uc.ControlId),uc.Location!==ka.a.contextMenu&&(this.oS.e5h(uc),this.oS.Qy(Rb.resultType),this.qb.dqd&&this.z7.n6h(uc.CommandId)));return 32}mqg(xb,Rb,wc,ud,uc){if(1===wc)return 32;P.a.LVj()&&(new pa(this.AUc())).lgj(this.Anb);xb=this.Anb;Rb=this.Vba;wc=this.Hd.pxc;if(ma.b(uc))return this.Hd.onError("TellMeActor:LogControlDeactivation",
"actiondata comes null"),16;uc=uc.UILocation;xb&&0<xb.length&&this.UTb&&Q.a.DXe(this.qb)&&this.qb.n0c&&19!==uc&&Rb>wc&&!this.qb.OH&&(this.Hd.zoe(xb),this.Hd.fVe(Rb));this.Hd.F1k();this.qb.fvd&&19!==uc&&(this.FD.mark(3),this.FD.measure(1,0,3),this.FD.measure(2,2,3),this.FD.poe(0,1,2),this.FD.poe(2,2,3),this.FD.poe(1,0,3),this.FD.zQa([0,1,2,3]),this.FD.clearMeasures([0,2,1]));this.Hd.bsk(window.performance.now()-this.cGd);this.qb.Oo&&(this.hNa=null,this.Hd.S3g());this.LTb=this.qob=!1;this.Anb="";return 32}yqg(xb,
Rb,wc){if(1===wc)return 32;this.Hd.T3g(A(Rb),this.LTb);return 32}xqg(xb,Rb,wc){if(1===wc)return 32;this.Hd.S3g();this.qob=!1;return 32}lqg(xb,Rb,wc,ud,uc){if(1===wc)return 32;this.OP=null;uc&&(this.OP=uc);this.qb.fvd&&(ma.b(this.OP)||this.OP.Location!==ka.a.contextMenu)&&this.FD.mark(0);this.Hd.$od(ma.b(this.OP)||ma.b(this.OP.Location)?ka.a.unknown:this.OP.Location);this.Hd.ask(this.Aif,this.LTb);this.qob||this.bkc();return 32}PJf(xb,Rb){const wc=[],ud=Date.now();for(let uc of xb)xb=(ud-uc.timeStamp)/
1E3,xb=Q.a.wtd(xb),Array.add(wc,new fa(Rb?uc.commandId:uc.controlId,xb));return wc}cIi(xb){const Rb=[],wc=Date.now();for(let ud of xb)if(ud.controlId||"keyboardShortcut"===ud.commandSurface)xb=(wc-ud.timeStamp)/1E3,xb=Q.a.wtd(xb),Array.add(Rb,new qa(ud.controlId,ud.commandId,xb,ud.commandSurface,ud.usd));return Rb}nKf(xb=!1){var Rb=xb?this.oS.igj():this.oS.r5b();xb=[];const wc=Date.now();for(const ud of Rb)Rb=(wc-ud.TimeStamp)/1E3,Rb=Q.a.wtd(Rb),Array.add(xb,new fa(ud.Id,Rb));return xb}bkc(){if(!this.qob){this.Job=
this.qob=!0;""!==this.qb.Ynh&&D.AFrameworkApplication.hk(this.qb.Ynh);if(!this.Rff){this.Rff=!0;const xb={};xb.IsMLREnabled=this.qb.YPj;xb.IsReactRibbonEnabled=this.qb.Oo;xb.IsSharedHeaderEnabled=!!D.AFrameworkApplication.Aa&&D.AFrameworkApplication.Aa.hb.$N;xb.IsSearchUxEnabled=this.DAa;xb.IsTellMeInHeaderEnabled=this.qb.pza;xb.IsGoLocalEnv=Q.a.Yig();xb.IsSovereignEnvironment=Q.a.nbb();xb.IsTellMeServiceResultsEnabled=Q.a.DXe(this.qb);xb.IsSubstrateProviderEnabled=Q.a.CXe(this.qb);xb.ShouldFetchTokens=
!!D.AFrameworkApplication.Aa&&D.AFrameworkApplication.Aa.hb.DMb;xb.IsSerpletEnabled=Q.a.d4();xb.FirstOnClickTimeInMS=Math.round(window.performance.now());xb.IsHeaderHidden=D.AFrameworkApplication.hideHeader||D.AFrameworkApplication.CQ;xb.IsSearchInHeaderHidden=D.AFrameworkApplication.iWc;void 0!==window.performance.timing&&null!==window.performance.timing&&(xb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));xb.IsFindWithMatchesEnabled=this.qb.KVf;xb.HelpShowsTopSearchResult=
this.qb.Vqc;xb.HelpShowsNumberOfMatches=this.qb.Uqc;D.AFrameworkApplication.fa&&(xb.UiHost=D.AFrameworkApplication.fa.Ga("UiHostIntegrationType"));this.Hd.X3j(JSON.stringify(xb))}this.Oyd=this.PJf(B.a.instance.kRb,!1);this.B9e=this.PJf(B.a.instance.v2a,!0);this.yqf=this.cIi(B.a.instance.v2a);this.Uif=this.nKf();this.Vif=this.nKf(!0);this.Hd.bkc()}}Lyb(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Vb.a.$W)return 32;
this.cGd=window.performance.now();this.bkc();xb=new da(Object(n.a)(this,this.xfa,"onRequestCompleted"),0);this.Vba++;this.Hd.beginQuery("",this.Vba,this.Job);this.G4e(!0,null);this.iha=Sb.lOc;this.hNa=Na.T0d;if(this.z7)Xc.instance.actions=[],this.z7.fB(new V("",this.Vba),xb,this.qb.Oo);else this.Hd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.anb&&this.Zd.Db(this.anb);return 32}restoreFocus(xb,Rb,wc){if(1===wc)return 32;this.Nd.X0(this.qb.pza||this.DAa?this.qb.ZVc:
this.qb.EKa,!1);return 32}tellMe(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.OP=uc;this.Hd.$od(ma.b(this.OP.Location)?ka.a.unknown:this.OP.Location);xb=this.OP.Value;this.qb.Oo||xb&&""!==xb.trim()?(!this.hNa&&this.qb.Oo&&(this.Hd.T3g(A(Rb),this.LTb),this.bkc()),this.UTi(xb,this.OP.Location),this.OP.PopulationXML=this.iha.xml):this.Job?this.OP.PopulationXML=this.iha.xml:(this.OP.PopulationXML=Sb.lOc.xml,this.hNa=Na.T0d,
this.Anb="");return 32}UTi(xb,Rb){this.cGd=window.performance.now();this.qb.fvd&&Rb!==ka.a.contextMenu&&this.FD.mark(1);this.qb.Oo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(xb));xb&&0<xb.trim().length&&(this.Job=!1);this.qb.LSi();Rb=ma.b(Rb)?ka.a.tellMe:Rb;if(xb!==this.Anb||this.qb.Oo){this.Vba++;this.Hd.beginQuery(xb,this.Vba,this.Job);this.G4e(!0,null);const wc=new V(xb,this.Vba),ud=new da(Object(n.a)(this,this.xfa,"onRequestCompleted"),this.Vba);this.iha=Sb.lOc;this.hNa=
Na.T0d;if(this.z7)Xc.instance.actions=[],this.z7.fB(wc,ud,this.qb.Oo,Rb,this.rNa),this.rNa=null;else this.Hd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Aif=this.Vba;this.Anb=xb}}cEl(xb){if(this.qb.Oo){var Rb=appChrome.selectors.getActiveControlStates();if(Rb=Object(z.a)(Object,Rb[xb.value])){xb.label=Rb.label;let wc=null;"description"in Rb&&(wc=Rb.description);wc&&Object.getType(wc)===String?xb.description=wc:"secondaryText"in Rb?xb.description=Rb.secondaryText:
"fullDescriptionLabel"in Rb&&(xb.description=Rb.fullDescriptionLabel)}}}xFk(xb){this.inb={};let Rb=0,wc=0;for(const ud of xb){xb=0;for(const uc of ud.results)this.inb[uc.value]=new y(uc.groupType,uc.type,uc.subType,Rb,xb,wc),xb++,wc++,uc.label||5!==uc.type||this.cEl(uc);0<xb&&Rb++}}CHb(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(xb=uc.CommandValueId)&&window.open(xb,"_blank");return 32}bpg(xb){const Rb={};Rb.token=
this.jZe;Rb.files=Fa.c(xb);Rb.type="MultiFilesDeckGeneration";xb=Q.a.R6f("",Q.a.slh("GenerateDeckFromFile"),Object.assign(new Bc.a,{landingTab:"All",data:Rb}));xb=this.Ca.La(Wb.a.eYc,2,xb);return 32!==xb?(this.Hd.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+xb+"."),!1):!0}Hdh(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Nd.lXf();if(xb=uc.TerminalParentControlId){xb=
this.bnb.ga(xb);if(!xb)return 16;Rb=[];Array.add(Rb,xb);if(!this.bpg(Rb))return 8}return 32}YYf(){if(!this.bnb.count)return 16;const xb=[];for(let Rb of this.bnb.values)Array.add(xb,Rb);return this.bpg(xb)?32:8}P8b(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:InsertMention","actiondata comes null"),16;xb=uc.UILocation;let db;uc=uc.CommandValueId;try{db=Fa.a(uc)}catch(Yb){return this.Hd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return ma.b(db)?(this.Hd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):ma.b(this.hzc)?(this.Hd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==xb?(this.Hd.onError("TellMeActor:InsertMention","location "+xb+" is unexpected"),16):this.hzc.P8b(db.displayName,db.email,db.userId)?32:(this.Hd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}rxa(xb,Rb,wc,ud,uc){return 1===wc?32:ma.b(uc)?(this.Hd.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===uc.UILocation?this.TGj(wc,uc):this.CHb(xb,Rb,wc,ud,uc)}w7g(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.vS&&window.setTimeout(()=>{this.vS.execute(db=>{db.YMb("TellMeSurvey",null)})},Xc.hWi);return 32}TGj(xb,Rb){if(1===xb)return 32;if(ma.b(Rb))return this.Hd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(ma.b(this.hzc))return this.Hd.onError("TellMeActor:InsertUrl",
"_iInsertContentHandler comes null"),16;xb=Rb.CommandValueId;return ma.b(xb)?(this.Hd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.hzc.insertHtmlText(xb)?32:(this.Hd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}xfa(xb,Rb,wc,ud,uc){wc=window.performance.now();this.xFk(Rb);this.Hd.fbl(Rb);this.qb.Oo?(this.hNa=this.YFd.Z1i(Rb,xb,uc),this.qb.tda?(this.Y1.push(appChrome.actions.updateTellMeSearchResults(this.hNa.menuModel,xb,uc)),appChrome.api.dispatch(this.Y1)):
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.hNa.menuModel,xb,uc)),this.qb.fvd&&this.qob&&(ma.b(this.OP)||this.OP.Location!==ka.a.contextMenu)&&(this.FD.mark(2),this.FD.measure(0,1,2))):this.iha=this.jrf.$1i(Rb,this.Hd.Wna);this.anb&&this.Zd.Db(this.anb);uc={};uc.GroupsCount=Rb.length;uc.QueryID=ud;uc.QueryLength=xb.length;this.Hd.CH(u.a.fGi,window.performance.now()-wc,uc)}MLi(xb,Rb){return Rb.startsWith(this.qb.Oo?Q.a.w3e:Q.a.Ntd)?5:xb?4:"bSearchHelp"===Rb||Rb.startsWith("GetHelpFromTellMe")?
8:"bInsights"===Rb||Rb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Rb?24:Rb===this.qb.JVf?2:0}Qy(xb,Rb){this.z7?this.z7.Qy(xb,Rb):Array.add(this.BCc,new J(xb,Rb))}Sog(xb,Rb,wc,ud,uc){if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){xb={};xb.SourceControlId=uc.SourceControlId;xb.Query=uc.CommandValueId;uc=this.Ca.La(Wb.a.une,
2,xb);if(32!==uc)this.Hd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+uc+".");return uc}return this.Ca.La(Wb.a.une,2,uc)}MAb(xb,Rb,wc,ud,uc){({AddinResultsProvider:xb}=d(707));if(1===wc)return 32;if(ma.b(uc))return this.Hd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;wc=uc.CommandValueId;if(ma.a(wc))return this.Hd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!xb.l6a[wc])return this.Hd.onError("TellMeActor:LaunchAddin",
"Add-in with assetId "+wc+" doesn't not exist in entitlements"),16;uc=d(707).AddinResultsProvider.l6a[wc];xb={};xb.solutionId=uc.id;xb.version=uc.appVersion;xb.storeType=uc.storeType;xb.storeId=uc.storeId;xb.assetId=uc.assetId;xb.assetStoreId=uc.assetStoreId;xb.displayName=uc.displayName;xb.targetType=uc.targetType;xb.height=uc.height;xb.width=uc.width;uc=this.Ca.La(Wb.a.Yeg,2,xb);if(32!==uc)this.Hd.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+uc+". AssetId: "+
wc);return uc}ukb(){if(!ma.b(this.vS))for(let xb of B.a.instance.v2a){if("ShowContextMenuWithFloatie"===xb.commandId)return this.vS.execute(Rb=>{Rb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(xb.commandId&&-1===xb.commandId.indexOf("Tab"))break}return 8}G4e(xb,Rb="",wc=null){xb?this.bnb=new h.a(e.a.to()):Rb&&wc&&this.bnb.add(Rb,wc)}static get instance(){return Xc.Ka||(Xc.Ka=new Xc)}}Xc.Ka=null;Xc.cul="mso_tellMeService";Xc.unknown="Unknown";Xc.hWi=500;Object(I.a)(Xc,"TellMeActor",
null,[])},1241:function(I,Y,d){d.r(Y);var h=d(0),e=d(27),n=d(70),m=d(387),z=d(931),B=d(95),v=d(57),y=d(1199),A=d(14),E=d(1234),u=d(93),J=d(67),G=d(173),S=d(957),P=d(82);class Q{static get rg(){return P.a.sC(Q.so,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Q.so="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(h.a)(Q,"InsertSymbolsDialogHtml",null,[]);var D=d(34),O=d(217);class X extends E.a{constructor(Ia,lb,Lb){super();this.Sgf=this.Qqa=this.hPa=null;this.PCd=0;this.Ca=Ia;this.Nd=lb;this.tBa=Lb;this.Xe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Xe(0,CommonUIStrings.l_DialogClose);this.GV=!1;this.rg=Q.rg;this.hg="InsertSymbolsDialog"}dispose(){0<X.CMd&&m.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.PCd,X.CMd);X.G$e++;
m.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",X.G$e);this.Ca=this.tBa=null;super.dispose()}g6(){this.Zi(Box4Intl.Box4Strings.L_SymbolSingle,Object(A.a)(this,this.QGj,"insertSymbolsDialogHandler"),null);this.PCd=0;X.L$e++;m.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",X.L$e);const Ia=this.D$d("symbol_d_"+X.nUb);Ia&&Ia.focus()}hide(){var Ia=document.getElementById("symbolsContainer");if(Ia&&(Ia=Ia.getElementsByTagName("a")))for(let lb=0;lb<
Ia.length;lb++)u.a.removeHandler(Ia[lb],J.a.focus,Object(A.a)(this,this.Lzh,"symbolFocusHandler"));super.hide()}QGj(Ia){1===Ia?(this.QHe("symbol_d_"+X.nUb),this.Nd.HU(this.gL,!0),this.Nd.yl().vj.YE(this.wD),this.wD.focus()):this.hide()}get KAb(){return X.nhf}set KAb(Ia){X.nhf=Ia}get GAb(){return X.$gf}set GAb(Ia){X.$gf=Ia}fxa(){super.fxa();var Ia=document.getElementById("symbolsContainer");if(Ia&&(S.a.Kod(Ia,this.tBa.lki(),"InsertSymbolsDialog"),Ia=Ia.getElementsByTagName("a")))for(let lb=0;lb<Ia.length;lb++)u.a.addHandler(Ia[lb],
J.a.focus,Object(A.a)(this,this.Lzh,"symbolFocusHandler"))}X7(){const Ia=document.getElementById("symbolsContainer");Ia&&(this.hPa||(this.hPa=Object(A.a)(this,this.osl,"symbolClickHandler"),this.yn.pb(J.a.click,Ia,this.hPa),this.yn.pb(J.a.doubleClick,Ia,this.hPa)),this.Qqa||(this.Qqa=Object(A.a)(this,this.qsl,"symbolKeyHandler"),this.Rg.pb(J.a.Yf,Ia,this.Qqa),this.Rg.pb(J.a.jy,Ia,this.Qqa),this.Rg.pb(J.a.Il,Ia,this.Qqa)));super.X7()}tsa(){const Ia=document.getElementById("symbolsContainer");Ia&&(this.hPa&&
(this.yn.yb(J.a.click,Ia,this.hPa),this.yn.yb(J.a.doubleClick,Ia,this.hPa),this.hPa=null),this.Qqa&&(this.Rg.yb(J.a.Yf,Ia,this.Qqa),this.Rg.yb(J.a.jy,Ia,this.Qqa),this.Rg.yb(J.a.Il,Ia,this.Qqa),this.Qqa=null));super.tsa()}pxk(Ia){this.Irh("symbol_d_"+X.nUb,!1);X.nUb=parseInt(Ia.substr(Ia.lastIndexOf("_")+1));this.Irh(Ia,!0);if(Ia=document.getElementById("SymbolNameValueLabel")){const lb=this.uUc(X.nUb);Ia.innerText=lb.altText}}uUc(Ia){const lb=this.tBa.rsc.Trd.value,Lb=O.a(lb);return lb[Lb[Ia]]}Lzh(Ia){if(Ia.target!==
this.Sgf){const lb=this.Nd.yl();lb&&lb.vj&&(lb.vj.YE(Ia.target),this.Sgf=Ia.target)}this.pxk(Ia.target.id)}osl(Ia){const lb=Ia.Ec;if("a"!==lb.tagName.toLowerCase())return!1;Ia.eventName===J.a.doubleClick&&this.QHe(lb.id);this.Nd.HU(this.gL,!0);this.Nd.yl().vj.YE(lb);lb.focus();return!0}qsl(Ia){var lb=Ia.Ec;if("a"!==lb.tagName.toLowerCase())return!1;const Lb=parseInt(lb.id.substr(lb.id.lastIndexOf("_")+1));if(Ia.qc.ctrlKey||Ia.qc.altKey||Ia.qc.keyCode>=G.a.qmb&&Ia.qc.keyCode<=G.a.Pza)return!1;if(Ia.eventName===
J.a.Yf){Ia=Ia.qc.keyCode;let hc=-1;Ia===Sys.UI.Key.enter?(this.QHe(lb.id),this.Nd.HU(this.gL,!0),this.Nd.yl().vj.YE(lb),lb.focus()):Ia===Sys.UI.Key.up?hc=Lb-15:Ia===Sys.UI.Key.down?hc=Lb+15:Ia===Sys.UI.Key.left?hc=e.AFrameworkApplication.isRtl?Lb+1:Lb-1:Ia===Sys.UI.Key.right&&(hc=e.AFrameworkApplication.isRtl?Lb-1:Lb+1);0<=hc&&(lb=this.D$d("symbol_d_"+hc))&&lb.focus()}return!0}QHe(Ia){this.PCd++;X.CMd++;Ia=parseInt(Ia.substr(Ia.lastIndexOf("_")+1));const lb=this.uUc(Ia),Lb={};Lb.SourceControlId="symbol_"+
Ia+"_"+lb.Srd;this.Ca.La(D.a.mUa,2,Lb);m.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Ia)}D$d(Ia){const lb=document.getElementById("symbolsContainer");return lb?lb.querySelector("#"+Ia):null}Irh(Ia,lb){(Ia=this.D$d(Ia))&&(lb?Ia.setAttribute("selected","true"):Ia.removeAttribute("selected"))}}X.nUb=0;X.nhf=null;X.$gf=null;X.L$e=0;X.G$e=0;X.CMd=0;Object(h.a)(X,"InsertSymbolsDialog",E.a,[]);var N=d(44),aa=d(53),V=d(41),ca=d(183),fa=d(109);class ma{constructor(Ia,lb,
Lb,hc,Pc,Td,ie,Sd){this.Ca=Ia;this.yK=lb;this.c1h=new y.a(Object(A.a)(this,this.olj,"getSymbolsDropDownMenuProps"));this.d1h=new y.a(Object(A.a)(this,this.E$d,"getSymbolsDropDownXml"));this.ILd=hc.rsc.Trd;this.Ak=Lb;this.tBa=hc;this.DD=Pc;this.rP=Td;this.Tc=ie;this.Hm=Sd}olj(){return this.tBa.ali()}E$d(){return this.tBa.build()}wb(){this.Ca.ra(D.a.fjd,V.a.application,Object(A.a)(this,this.fjd,"queryInsertSymbols"),96);this.Ca.ya(D.a.whb,V.a.view,Object(A.a)(this,this.whb,"populateSymbolsDropDown"));
this.Ca.ya(D.a.Urd,V.a.view,Object(A.a)(this,this.Mzh,"symbolsDropDownOpenHandler"));this.Ca.ya(D.a.kOe,V.a.view,Object(A.a)(this,this.Ddh,"querySymbolPositionHandler"));this.Ca.ya(D.a.mUa,V.a.view,Object(A.a)(this,this.ZEa,"insertSymbolViewHandler"));this.Ca.ya(D.a.whb,V.a.Pf,Object(A.a)(this,this.whb,"populateSymbolsDropDown"));this.Ca.ya(D.a.Urd,V.a.Pf,Object(A.a)(this,this.Mzh,"symbolsDropDownOpenHandler"));this.Ca.ya(D.a.kOe,V.a.Pf,Object(A.a)(this,this.Ddh,"querySymbolPositionHandler"));this.Ca.ya(D.a.mUa,
V.a.Pf,Object(A.a)(this,this.PGj,"insertSymbolHandler"));this.Ca.je(D.a.whb,1124);this.Ca.je(D.a.Urd,1036);this.Ca.je(D.a.kOe,1124);this.Ca.je(D.a.mUa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.ya(D.a.pXc,V.a.view,Object(A.a)(this,this.Mvh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ya(D.a.pXc,V.a.Pf,Object(A.a)(this,this.Mvh,"showInsertMoreSymbolsDialogHandler")),this.Ca.je(D.a.pXc,1124))}Ddh(Ia,lb,Lb,hc,Pc){if(1===Lb)return 32;Ia=this.tBa.m9g(Pc);
Ia=String.format(this.tBa.psl,Ia.character);Pc[z.a.InnerHTML]=Ia;Pc[z.a.On]=!1;return 32}ZEa(Ia,lb,Lb,hc,Pc){if(({If:Ia,selected:Lb,ZEa:Sd}=this.tMf(lb,Lb)).returnValue)return Sd;var Td=N.SelectionEditor.Tg(Lb);let ie=!0;Lb=8;var Sd=this.Ak.me(15);Sd.kd(Ia.xg);Td||(Lb=this.Ca.mi(lb,D.a.$Ca,2,!0,hc,null),lb=32===Lb,m.ULS.shipAssertTag(6407387,348,lb,"DeleteForReplace did not succeed. Response is {0}",Lb),ie=lb);ie&&(lb=Ia.Lb.Pj,Td=N.SelectionEditor.Tg(lb),m.ULS.shipAssertTag(6407388,348,Td,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
lb.contextId),Lb=8,Td&&(Lb=this.Ca.mi(lb,D.a.mUa,2,!1,hc,Pc),m.ULS.shipAssertTag(6407389,348,32===Lb,"Insertion at IP context did not succeed. Response is {0}",Lb),32===Lb&&B.FocusManager.instance().tf(Ia.DI)));Sd.dispose();return Lb}tMf(Ia,lb){let Lb,hc;Lb=null;Ia.view.Mh&&(Lb=Ia.view);hc=null;return Lb&&Lb.Lb?(hc=Lb.Lb.Pj)?this.rP.ga(14)&&this.DD.v7a(hc)?{returnValue:!0,If:Lb,selected:hc,ZEa:8}:Lb.Lb.Na.jH||this.Hm&&this.Hm.instance&&this.Hm.instance.XW(hc)||N.SelectionEditor.vYc(Ia.CE)?{returnValue:!0,
If:Lb,selected:hc,ZEa:2}:1===lb?{returnValue:!0,If:Lb,selected:hc,ZEa:32}:{returnValue:!1,If:Lb,selected:hc,ZEa:32}:{returnValue:!0,If:Lb,selected:hc,ZEa:2}:(fa.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Ia.toString()),{returnValue:!0,If:Lb,selected:hc,ZEa:8})}PGj(Ia,lb,Lb,hc,Pc){if(1===Lb)return 32;if(N.SelectionEditor.vYc(lb))return 2;Ia=this.tBa.m9g(Pc);hc.hQ=Ia.index;hc=this.yK.Nc(lb.node);Lb=hc.rc(11);
m.ULS.shipAssertTag(6379466,324,Lb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",ca.a[lb.node.type]);Lb=this.Ak.me(15);Lb.Fy(hc);ma.characterPropertiesEditor.replaceTextRange(lb,Ia.character,!0,!1);lb=aa.SelectionFactory.Sg(hc.currentNode,lb.Qa+1);this.Tc.setSelection(lb);Lb.dispose();return 32}whb(Ia,lb,Lb,hc,Pc){if(1===Lb)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Np?Pc.MenuItems=this.c1h.value:Pc.PopulationXML=this.d1h.value;return 32}Mzh(Ia,
lb,Lb){({ZEa:Ia}=this.tMf(lb,Lb));return Ia}Mvh(Ia,lb,Lb){2===Lb&&(new X(this.Ca,B.FocusManager.instance(),v.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).g6();return 32}fjd(){return 32}static get characterPropertiesEditor(){return ma.fh||(ma.fh=v.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Ia){ma.fh=Ia}}ma.fh=null;Object(h.a)(ma,"SymbolsActor",null,[594]);class da{constructor(Ia,lb){this.Srd=Ia;this.altText=lb}}Object(h.a)(da,"Symbol",null,
[]);class qa{constructor(){this.HLd=null;this.ILd=new y.a(qa.yYd)}get Trd(){return this.ILd}Yaj(Ia){this.HLd||(this.HLd=O.a(this.ILd.value));return Array.indexOf(this.HLd,Ia)}static yYd(){const Ia={};Ia["\u2022"]=new da("\u2022",Box4Intl.Box4Strings.L_Bullet);Ia["\u20ac"]=new da("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Ia["\u00a3"]=new da("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Ia["\u00a5"]=new da("\u00a5",Box4Intl.Box4Strings.L_YenSign);Ia["\u00a9"]=new da("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);
Ia["\u00ae"]=new da("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Ia["\u2122"]=new da("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Ia["\u00b1"]=new da("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Ia["\u2260"]=new da("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Ia["\u2264"]=new da("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Ia["\u2265"]=new da("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Ia["\u00f7"]=new da("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Ia["\u00d7"]=new da("\u00d7",
Box4Intl.Box4Strings.L_MultiplicationSign);Ia["\u221e"]=new da("\u221e",Box4Intl.Box4Strings.L_Infinity);Ia["\u00b5"]=new da("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Ia["\u03b1"]=new da("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Ia["\u03b2"]=new da("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Ia["\u03c0"]=new da("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Ia["\u03a9"]=new da("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Ia["\u03a3"]=new da("\u03a3",Box4Intl.Box4Strings.L_NArySummation);
Ia["\u00b0"]=new da("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Ia["\u0394"]=new da("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Ia["\u263a"]=new da("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Ia["\u2665"]=new da("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Ia["\u20b9"]=new da("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Ia["\u00bf"]=new da("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Ia["\u00a1"]=new da("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Ia["\u2014"]=
new da("\u2014",Box4Intl.Box4Strings.L_EmDash);Ia["\u2026"]=new da("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Ia["\u00c0"]=new da("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Ia["\u00c1"]=new da("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Ia["\u00c2"]=new da("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Ia["\u00c3"]=new da("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Ia["\u00c4"]=new da("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);
Ia["\u00c5"]=new da("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Ia["\u00c6"]=new da("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Ia["\u00c7"]=new da("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Ia["\u00c8"]=new da("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Ia["\u00c9"]=new da("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Ia["\u00ca"]=new da("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Ia["\u00cb"]=
new da("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Ia["\u00cc"]=new da("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Ia["\u00cd"]=new da("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Ia["\u00ce"]=new da("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Ia["\u00cf"]=new da("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Ia["\u00d1"]=new da("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Ia["\u00d2"]=
new da("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Ia["\u00d3"]=new da("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Ia["\u00d4"]=new da("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Ia["\u00d5"]=new da("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Ia["\u00d6"]=new da("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Ia["\u00d9"]=new da("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Ia["\u00da"]=
new da("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Ia["\u00db"]=new da("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Ia["\u00dc"]=new da("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Ia["\u00df"]=new da("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Ia["\u00e0"]=new da("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Ia["\u00e1"]=new da("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Ia["\u00e2"]=new da("\u00e2",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Ia["\u00e3"]=new da("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Ia["\u00e4"]=new da("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Ia["\u00e5"]=new da("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Ia["\u00e6"]=new da("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Ia["\u00e7"]=new da("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Ia["\u00e8"]=new da("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);
Ia["\u00e9"]=new da("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Ia["\u00ea"]=new da("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Ia["\u00eb"]=new da("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Ia["\u00ec"]=new da("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Ia["\u00ed"]=new da("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Ia["\u00ee"]=new da("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Ia["\u00ef"]=
new da("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Ia["\u00f1"]=new da("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Ia["\u00f2"]=new da("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Ia["\u00f3"]=new da("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Ia["\u00f4"]=new da("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Ia["\u00f5"]=new da("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Ia["\u00f6"]=new da("\u00f6",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Ia["\u00f9"]=new da("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Ia["\u00fa"]=new da("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Ia["\u00fb"]=new da("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Ia["\u00fc"]=new da("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Ia["\u00ff"]=new da("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Ia["\u011e"]=new da("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);
Ia["\u011f"]=new da("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Ia["\u0130"]=new da("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Ia["\u0131"]=new da("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Ia["\u0152"]=new da("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Ia["\u0153"]=new da("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Ia["\u015e"]=new da("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Ia["\u015f"]=new da("\u015f",
Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Ia["\u0178"]=new da("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Ia}}Object(h.a)(qa,"SymbolsLoader",null,[592]);var F=d(47),sa=d(315),ia=d(273),Na=d(216),Ca=d(585),ha=d(1230),Ba=d(135),va=d(75);class ta{constructor(Ia){this.e1h=Ia}get rsc(){return this.e1h}get psl(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}m9g(Ia){Ia=Ia.SourceControlId.split("_");const lb={};2===Ia.length?
(lb.character=Ia[1],lb.index=this.rsc.Yaj(lb.character)):(lb.character=Ia[2],lb.index=parseInt(Ia[1]));return lb}ali(){return this.v7f()}build(){return this.E$d()}lki(){const Ia=new Sys.StringBuilder;Ia.append('<table class="moreSymbolsTable">');const lb=this.rsc.Trd.value,Lb=O.a(lb);let hc=0;for(;hc<Lb.length;){hc%15||Ia.append('<tr role="presentation">');const Pc=lb[Lb[hc]];Ia.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+hc,F.a.$Ta(Pc.Srd),F.a.$Ta(Pc.altText)));hc++;hc%15&&hc!==Lb.length||Ia.append("</tr>")}Ia.append("</table>");return Ia.toString()}E$d(){const Ia=this.v7f();return Ba.l(Ia)}v7f(){const Ia=Object.assign(new sa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(Ia.MenuSectionList,this.I7h());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(Ia.MenuSectionList,this.s6h());return Ia}s6h(){const Ia=Object.assign(new ia.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),lb=Object.assign(new Na.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:F.a.ue(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:F.a.ue(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.rm,Image16by16Class:va.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(Ia.ControlList,lb);return Ia}I7h(){const Ia=Object.assign(new ia.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),lb=Object.assign(new Ca.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Lb=this.rsc.Trd.value,hc=O.a(Lb),Pc=Math.min(25,hc.length);for(let ie=0;ie<Pc;ie++){var Td=Lb[hc[ie]];Td=Object.assign(new ha.a,{Id:String.format("{0}{1}_{2}","symbol_",ie,Td.Srd),Character:Td.Srd,Command:"3966968829",QueryCommand:"816646517",Alt:F.a.ue(Td.altText)});lb.GalleryItems.push(Td)}Array.add(Ia.ControlList,
lb);return Ia}}Object(h.a)(ta,"SymbolsUiBuilder",null,[591]);var Fa=d(64),pa=d(122),ka=d(38),Ha=d(511),Ya=d(295);class Ka{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").wb()}dispose(){}Zb(Ia){this.Da=Ia;this.Da.register(qa,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(ta,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().oa(()=>
new ta(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));this.Da.register(ma,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().oa(()=>new ma(e.AFrameworkApplication.Ta,new Ha.a,new Ya.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),pa.a.instance,ka.a.instance,Fa.a.instance,this.Da.Ja("Box4.IExternalSelectionManager")))}static main(){n.a.instance.Dc(new Ka)}}Object(h.a)(Ka,"Box4SymbolsPackage",null,[2,3]);var Pa=d(1062),Oa=d(36),oa=d(80),Xa=d(449);class Hb{constructor(Ia,lb){this.DKd=
this.CKd=null;this.Zpb=new Pa.a;this.Xh=Ia;this.GBa=lb.appSettings[Hb.FJl]||""}get xgl(){return this.Zpb.task}get yca(){return this.Xh.value}d1k(){const Ia={};Ia[Hb.oxj]=e.AFrameworkApplication.gh;Ia["Content-Type"]="application/json; charset=utf-8";m.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const lb=oa.a.Ki(this.GBa+Hb.ygl,Hb.Npk,e.AFrameworkApplication.Aa.hb.Uk.toString());this.yca.mj(lb,1,"",Ia,!0,2,Object(A.a)(this,this.MIe,"onSuccessCallback"),
Object(A.a)(this,this.Vjc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}k3j(Ia){try{const lb={};lb.FlightName=Ia.FlightName;lb.SessionID=Ia.SessionID;m.ULS.sendTraceTag(594883776,215,50,Oa.c(lb))}catch(lb){m.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}MIe(Ia){if((Ia=Ia.data.Sd)&&Ia.length)try{const lb=Oa.a(Ia);this.CKd=lb.NavBarDataJson;m.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.CKd?({rv:this.DKd}=Oa.d(lb.NavBarDataJson)).returnValue?
(this.k3j(this.DKd),this.Zpb.Gg(this.DKd)):(m.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Xa.a.Otc(this.CKd)}),this.Zpb.p1()):(m.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Zpb.p1())}catch(lb){m.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Zpb.p1()}else m.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}Vjc(){this.Zpb.p1();m.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Hb.Ka||
(Hb.Ka=Hb.m9a())}static m9a(){return new Hb(new y.a(()=>e.AFrameworkApplication.Ke),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.hb.Uk)}}Hb.oxj="X-qs";Hb.Npk="at";Hb.ygl="O365ShellServiceProxy.ashx";Hb.Ka=null;Hb.FJl="ShellWebServiceBase";Object(h.a)(Hb,"O365ShellActor",null,[637]);class Ob{constructor(){this.Da=null}get name(){return"Common.App.O365Shell"}Zb(Ia){this.Da=Ia;this.Da.register(Hb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().oa(()=>new Hb(new y.a(()=>
e.AFrameworkApplication.Ke),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.hb.Uk))}init(){e.AFrameworkApplication.fa.gf(Object(A.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){e.AFrameworkApplication.evd&&e.AFrameworkApplication.Aa.hb.$N&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").d1k()}dispose(){}static main(){n.a.instance.Dc(new Ob)}}Object(h.a)(Ob,"PackageManager",null,[2,3]);var eb=d(78),Eb=d(285);class oc{constructor(Ia){this.Pa=new eb.a;this.WH=Ia}DGc(Ia){this.Pa.addHandler(oc.tza,
Ia)}gRe(Ia){this.Pa.removeHandler(oc.tza,Ia)}nYe(){this.Pa.raiseEvent(oc.vLb)}mYe(){this.Pa.raiseEvent(oc.wLb)}}oc.vLb="SE";oc.wLb="SEP";oc.tza="SER";oc.m2e="TRP";Object(h.a)(oc,"NullSessionExpirationManager",null,[624,625]);var Sb=d(166);class qc{constructor(){this.JWb=this.$Oa=!1;const Ia=e.AFrameworkApplication.im;0>=Ia||(this.im=Ia,m.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.im,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.sca}),
Eb.a.instance.FPd(Object(A.a)(this,this.qHb,"onSessionExpiredDetected")),Eb.a.instance.DPd(Object(A.a)(this,this.tkc,"onSessionExpiringDetected")))}qHb(){Eb.a.instance.Rih(Object(A.a)(this,this.qHb,"onSessionExpiredDetected"));m.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.wbe()}tkc(){Eb.a.instance.BZk(Object(A.a)(this,this.tkc,"onSessionExpiringDetected"));this.JWb||this.$Oa||(m.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.JWb=!0,
this.UYe())}wbe(){this.$Oa||(e.AFrameworkApplication.vp(Sb.a.sessionAccessTokenExpired),this.$Oa=!0,this.Lqd())}}Object(h.a)(qc,"ASessionExpirationManager",null,[]);var $a=d(290),ab=d(37);class Ib{constructor(Ia,lb,Lb,hc){this.E1e="";this.Avc=Ia;this.bof=Lb;this.Znf=hc;this.Ref=lb;Ia=(new Date(this.Avc)).format(e.AFrameworkApplication.qth);this.E1e=this.Ref?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,Ia)}tLb(Ia){1===Ia?this.bof&&this.bof(this.Ref):
0===Ia&&e.AFrameworkApplication.Ta.La(ab.a.close,2,$a.g)}dispose(){this.Znf&&this.Znf()}}Ib.id="SessionExpirationDialog";Object(h.a)(Ib,"SessionExpirationDialogSharedProperties",null,[]);class gc{}gc.rg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(gc,"SessionExpirationDialogHtml",null,[]);class Ta extends P.a{constructor(Ia,lb,Lb,hc){super(lb);const Pc={};this.nBa=new Ib(Ia,lb,Lb,
hc);this.hg=Ib.id;e.AFrameworkApplication.SCf?(this.xd=1,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.xd=0,this.Ar=!1);lb||1===e.AFrameworkApplication.Aa.mode?this.Xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.rg=gc.rg;Pc.WACSessionExpirationText=this.nBa.E1e;this.Zi(CommonUIStrings.l_DefaultDialogTitle,Object(A.a)(this,this.tLb,"sessionExpirationDialogHandler"),Pc);this.c6(this.Nh("WACSessionExpirationText"))}tLb(Ia){this.nBa.tLb(Ia)}TYc(){return this.LQ}X7b(){this.hide()}dispose(){super.dispose();
this.nBa&&this.nBa.dispose()}}Object(h.a)(Ta,"LegacySessionExpirationDialog",P.a,[710]);var Ab=d(108);class kc extends Ab.StandardDialog{constructor(Ia,lb,Lb,hc){super(lb);this.nBa=new Ib(Ia,lb,Lb,hc);this.hg=Ib.id;e.AFrameworkApplication.SCf?(this.xd=1,this.Xe(0,CommonUIStrings.l_DialogClose)):(this.xd=0,this.Ar=!1);lb||1===e.AFrameworkApplication.Aa.mode?this.Xe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Xe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Gx(CommonUIStrings.l_DefaultDialogTitle,
this.nBa.E1e,0,Object(A.a)(this,this.tLb,"sessionExpirationDialogHandler"))}tLb(Ia){this.nBa.tLb(Ia)}TYc(){return this.LQ}X7b(){this.hide()}dispose(){super.dispose();this.nBa&&this.nBa.dispose()}}Object(h.a)(kc,"SessionExpirationDialog",Ab.StandardDialog,[710]);const fb=(Ia,lb,Lb,hc)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.GC&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new kc(Ia,lb,Lb,hc):new Ta(Ia,lb,Lb,hc);var Qb=d(220);class mb extends qc{constructor(Ia){super();
this.aqb=this.bqb=!0;this.MP=null;this.Pa=new eb.a;this.WH=Ia}DGc(Ia){this.Pa.addHandler(mb.tza,Ia)}gRe(Ia){this.Pa.removeHandler(mb.tza,Ia)}nYe(Ia){this.bqb=Ia}mYe(Ia){this.aqb=Ia}UYe(){if(!this.MP&&!Qb.a.$w){if(this.aqb){const Ia=Object(A.a)(this,this.Iub,"disposeCallback");this.MP=fb(this.im,!1,Object(A.a)(this,this.uLb,"sessionExpirationHandler"),Ia)}this.Pa.raiseEvent(mb.wLb)}}Lqd(){this.MP&&(this.MP.TYc()&&this.MP.X7b(),this.MP=null);if(this.bqb){const Ia=Object(A.a)(this,this.Iub,"disposeCallback");
this.MP=fb(this.im,!0,Object(A.a)(this,this.uLb,"sessionExpirationHandler"),Ia)}this.Pa.raiseEvent(mb.vLb)}Iub(){this.MP=null}uLb(){this.WH.refreshDocument(null)}}mb.vLb="SE";mb.wLb="SEP";mb.tza="SER";mb.m2e="TRP";Object(h.a)(mb,"SessionExpirationManager",qc,[624,625]);var Jb=d(18);class Ub{}Ub.G3h="Aborting";Ub.LFc="ActivityDuration";Ub.error="Error";Ub.P1d="Errors";Ub.failed="Failed";Ub.aQc="FirstActivity";Ub.initialized="Initialized";Ub.vYj="KickedOut";Ub.DYj="LastActivity";Ub.zlh="RetryOverride";
Ub.Rld="RequestGroups";Ub.s_a="Requests";Ub.emd="Responses";Ub.bod="SessionDuration";Ub.status="Status";Ub.success="Success";Ub.Erl="Successful";Ub.tokens="Tokens";Ub.RKe="PollingDuration";Object(h.a)(Ub,"SessionExpirationStrings",null,[]);var tb=d(81);class Bc{constructor(Ia){this.My={};this.N6={};this.JOa={};this.Aqg=15;this.$ff=!1;this.z_h=new Date;this.lAc=new Date;this.Zd=Ia;this.F7=new tb.a(2,2,6E4*this.Aqg,Object(A.a)(this,this.$Jh,"writeMeasures"),135,"SL",!1);this.Zd.Db(this.F7);this.OEj()}$Jh(){m.ULS.sendTraceTag(41964821,
217,50,m.ULS.Rme({["Aggregate"]:this.N6,["Current"]:this.My}))}OEj(){this.N6[Ub.Rld]=0;this.N6[Ub.s_a]=0;this.N6[Ub.emd]=0;this.N6[Ub.status]=Ub.initialized;this.N6[Ub.aQc]=new Date;this.N6[Ub.bod]=0;this.N6[Ub.LFc]=0;this.N6[Ub.bod]=0;this.My[Ub.bod]=0;this.N6[Ub.LFc]=0;this.My[Ub.LFc]=0}get mFk(){this.JOa[Ub.RKe]=+new Date-+this.JOa[Ub.aQc];return this.JOa}Cde(Ia,lb){var Lb=Ia[lb];Lb=Lb?Lb:0;Lb++;Ia[lb]=Lb;this.DVe(Ia)}DVe(Ia){const lb=new Date;Ia[Ub.LFc]=+lb-+this.lAc;this.lAc=lb;Ia[Ub.bod]=+this.lAc-
+this.z_h;Ia[Ub.DYj]=this.lAc}HY(Ia,lb){this.My[Ia]=lb;this.DVe(this.My)}eVe(Ia,lb){this.My[Ia]=lb;this.DVe(this.My)}vyb(Ia){this.Cde(this.My,Ia);this.Cde(this.N6,Ia);this.Cde(this.JOa,Ia)}flush(){this.$ff||(this.N6[Ub.status]=this.My[Ub.status],this.$Jh(this.F7),this.Zd.V5(this.F7,6E4*this.Aqg))}B1k(){const Ia=this.My[Ub.status];Ia&&(this.N6[Ub.status]=Ia);this.My={}}H1k(){this.JOa={};this.JOa[Ub.RKe]=0;this.JOa[Ub.aQc]=new Date}stop(){m.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.$ff=!0;this.Zd.Lg(this.F7)}}Object(h.a)(Bc,"SessionLogger",null,[620]);class Gb{constructor(Ia,lb){this.LEc=Ia;this.oha=lb}get tokens(){return this.LEc}get errors(){return this.oha}}Object(h.a)(Gb,"TokenRefreshArgs",null,[635]);var Hc=d(96),$b=d(198),lc=d(133);class Vb extends Sys.EventArgs{constructor(Ia,lb,Lb,hc,Pc,Td,ie){super();this.JOa=Ia;this.Rld=hc;this.failed=Pc;this.s_a=Td;this.emd=ie}}Object(h.a)(Vb,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var ic=d(89);class qb{constructor(Ia,
lb=null,Lb=null){this.JWb=this.$Oa=!1;this.aqb=this.bqb=!0;this.Pa=new eb.a;this.LWb=this.fUb=this.NCc=!1;this.lId=null;this.hlf=10;this.Tzc=!1;this.wMd=Ia;this.vEd=e.AFrameworkApplication.yXj;this.Zd=lc.a.instance;m.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.im,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.sca});this.Bj=lb||new Bc(lc.a.instance);this.gia=Lb;Eb.a.instance.FPd(Object(A.a)(this,
this.B3h,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Eb.a.instance.DPd(Object(A.a)(this,this.INd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));$b.SessionStatusManager.instance.wPd(Object(A.a)(this,this.INd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));$b.SessionStatusManager.instance.gai(Object(A.a)(this,this.mIk,"preemptiveTokenRefresh"));this.Zgf=new Date;e.AFrameworkApplication.xXj&&(Eb.a.instance.iUd=Object(A.a)(this,this.JSk,"refreshAccessTokenWhenSessionExpired"));
Ia=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.hlf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),Ia=e.AFrameworkApplication.fa.ka("WopiTokenRefreshWhenNetworkResumed"));Ia?$b.SessionStatusManager.instance.wPd(Object(A.a)(this,
this.C3h,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):$b.SessionStatusManager.instance.wPd(Object(A.a)(this,this.INd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}DGc(Ia){this.Pa.addHandler(qb.tza,Ia)}gRe(Ia){this.Pa.removeHandler(qb.tza,Ia)}JSk(){this.y7b(!1);return!Eb.a.instance.JFa(e.AFrameworkApplication.im)}B3h(Ia,lb){Eb.a.instance.$_c?this.qHb(Ia,lb):this.vEd?(this.fUb=!1,this.y7b(!1)):(this.$Oa||m.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.qHb(Ia,lb))}C3h(Ia,lb){Eb.a.instance.Y_c?this.tkc(Ia,lb):(fa.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.fUb=!1,this.y7b(!0))}INd(Ia,lb){Eb.a.instance.Y_c?this.tkc(Ia,lb):this.y7b(!0)}y7b(Ia){if(!this.NCc&&!this.fUb)if(this.gia&&this.gia.Xab)this.LWb=!0,this.Bj.HY(Ub.status,Ub.vYj),this.Bj.flush(),this.Bj.stop();else if(m.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",Ia,this.LWb),this.LWb)this.Lqd();
else{this.Bj.flush();this.Bj.B1k();this.Bj.vyb(Ub.Rld);this.NCc=!0;this.Tzc||(this.Bj.H1k(),this.Tzc=!0,this.KBi());const lb=this.wMd.cTk(Ia);lb.continueWith(()=>{if(this.wMd.NKk(lb))this.Bj.vyb(Ub.Erl),this.Bj.HY(Ub.status,Ub.success),this.aqb=!1,this.vEd&&(this.bqb=!1),this.fUb=!1,this.Zgf=new Date,this.Nql(),this.Pa.raiseEvent(qb.tza,new Gb(lb.result.tokens,null));else{const Lb=lb.result.errors;this.Bj.vyb(Ub.failed);this.Bj.HY(Ub.status,Ub.failed);Ia||(this.LWb=this.wMd.t$b(Lb));this.LWb&&(this.Bj.HY(Ub.G3h,
JSON.stringify(Lb)),m.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.fUb=!0;this.Pa.raiseEvent(qb.tza,new Gb(null,Lb))}this.Bj.flush();this.NCc=!1})}}qHb(){this.vEd||Eb.a.instance.Rih(Object(A.a)(this,this.qHb,"onSessionExpiredDetected"));m.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.wbe(Eb.a.instance.$_c)}tkc(){this.JWb||this.$Oa||(m.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.JWb=!0,this.UYe(Eb.a.instance.Y_c))}wbe(Ia){if(!this.$Oa){var lb=
Ia?Sb.a.P8k:Sb.a.sessionAccessTokenExpired;const Lb=Object.assign(new ic.a,{extendedProperties:new Map});Lb.extendedProperties.set("ErrorCode",String.format("{0}",lb));e.AFrameworkApplication.vp(lb,void 0,["SessionExpired"],Lb);Ia||(Ia=new Date,lb=new Date(e.AFrameworkApplication.sca),m.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",lb,Ia,+Ia-+lb),864E5>+Ia-+lb&&Hc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],
!0,!0,!1,!0,Lb),2592E5>+Ia-+lb&&Hc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Lb));this.$Oa=!0;this.Lqd()}}Nql(){this.Tzc&&(this.Zd.Lg(this.lId),this.Tzc=!1)}KBi(){this.lId=new tb.a(2,2,1E3*this.hlf,Object(A.a)(this,this.nwl,"tokenRefreshPolling"),135);this.Zd.Db(this.lId)}nwl(){const Ia=this.Bj.mFk;m.ULS.sendTraceTag(555255521,217,50,"{0}",Oa.c(Ia));this.Pa.raiseEvent(qb.m2e,new Vb(Ia,Ia[Ub.RKe],Ia[Ub.aQc],Ia[Ub.Rld],Ia[Ub.failed],
Ia[Ub.s_a],Ia[Ub.emd]))}mIk(){3E5<+new Date-+this.Zgf?(m.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.y7b(!1)):m.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}qb.vLb="SE";qb.wLb="SEP";qb.tza="SER";qb.m2e="TRP";Object(h.a)(qb,"ASessionExpirationManagerWithRefresh",null,[]);class Wb extends qb{constructor(Ia,lb,Lb=null,hc=null){super(lb,Lb,hc);this.MP=null;this.WH=Ia}nYe(Ia){this.bqb=Ia}mYe(Ia){this.aqb=
Ia}UYe(Ia){if(!this.MP&&!Qb.a.$w){if(Ia){var lb=Object(A.a)(this,this.Iub,"disposeCallback");this.MP=fb(e.AFrameworkApplication.XKb,!1,Object(A.a)(this,this.uLb,"sessionExpirationHandler"),lb)}else if(this.aqb){if(this.NCc)return;lb=Object(A.a)(this,this.Iub,"disposeCallback");this.MP=fb(e.AFrameworkApplication.im,!1,Object(A.a)(this,this.uLb,"sessionExpirationHandler"),lb)}m.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",qb.wLb,Ia);this.Pa.raiseEvent(qb.wLb)}}Lqd(){this.MP&&
(this.MP.TYc()&&this.MP.X7b(),this.MP=null);if(this.bqb){this.Bj.stop();if(this.gia&&this.gia.Xab)return;const Ia=Object(A.a)(this,this.Iub,"disposeCallback");this.MP=fb(e.AFrameworkApplication.im,!0,Object(A.a)(this,this.uLb,"sessionExpirationHandler"),Ia)}m.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",qb.vLb);this.Pa.raiseEvent(qb.vLb)}Iub(){this.MP=null}uLb(){this.WH.refreshDocument(null)}}Object(h.a)(Wb,"SessionExpirationManagerWithRefresh",qb,[624,625]);class Xc{constructor(Ia,lb,Lb=
null,hc=null){this.sqf=!1;this.Ka=null;this.ANa=Ia;this.jOa=lb;this.Bj=Lb||new Bc(lc.a.instance);this.gia=hc}create(){this.sqf=e.AFrameworkApplication.Yz;if(!this.sqf)return new mb(this.ANa);e.AFrameworkApplication.hk("WOPITokenRefreshIsEnabled");m.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ka)switch(e.AFrameworkApplication.SJl){case 1:m.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.Ka=new oc(this.ANa);break;
case 2:m.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ka=new Wb(this.ANa,this.jOa,this.Bj,this.gia);break;default:m.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.Ka=new mb(this.ANa)}m.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ka).getName());return this.Ka}}Object(h.a)(Xc,"SessionExpirationManagerFactory",null,[623]);var xb=d(1200),Rb=d(24);class wc{}
Object(h.a)(wc,"Error",null,[]);class ud{}Object(h.a)(ud,"NamedResult",null,[]);class uc extends ud{}Object(h.a)(uc,"ErrorInfo",ud,[]);var db=d(106),Yb=d(175),Zc=d(126),Kb=d(709);class Yc{constructor(Ia,lb,Lb,hc=null,Pc=!1,Td=null,ie=!1,Sd=!1){this.eBa=0;this.Tqa=this.Um=null;this.LEc=new Jb.a;this.oha=new Jb.a;this.$v=null;this.WTb=!1;this.zXb=this.AXb=null;this.Zd=Ia;this.nlf=lb;this.nlf.execute(wf=>{wf.HB(Zc.a.Rce,Object(A.a)(this,this.auk,"onHostResponseReceived"))});this.sS=Lb;this.Rpf=new Kb.a("WebServiceCall",
"TokenRefresh");this.Bj=hc||new Bc(Ia);this.t_h=Pc;this.Mqa=Td?Td:$b.SessionStatusManager.instance;this.Saf=ie;this.Zxc=Sd}auk(Ia){if(Ia.MessageId!==Zc.a.Rce)fa.c(39408099,306,15,"Unexpected message.");else{var lb=new Jb.a,Lb=new Jb.a;this.Bj.vyb(Ub.emd);var hc=Ia.Values[Yb.a.fph];if(!hc||0>=hc.length)fa.c(40122317,306,15,"Found no tokens in the dictionary"),hc=Ia.Values;fa.c(40122318,306,100,"The Tokens array contains {0} tokens",hc.length);this.Bj.HY("Correlation",Ia.CorrelationId);var Pc="";for(let Sd=
0;Sd<hc.length;Sd++){this.Bj.eVe(Ub.tokens,hc.length);var Td=hc[Sd],ie=Td;if(!ie||!ie.Name)continue;this.Bj.vyb(ie.Name);const wf=Td;if(wf&&wf.Value)fa.c(39408128,306,100,"Received token with name: {0}",wf.Name),lb.add(wf),this.LEc.add(wf),this.Zxc||this.Bj.HY(Ub.status,Ub.success),this.Saf&&this.Mqa&&this.Mqa.U1k();else if(Td=this.Xhj(Td),fa.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ie.Name,JSON.stringify(Td),this.Tqa),Lb.add(Td),this.Zxc||(this.oha.add(Td),
Pc=JSON.stringify(Td),this.Bj.HY(Ub.error,JSON.stringify(Td)),this.Bj.HY(Ub.status,Ub.failed)),this.Saf)for(const Pf of Td.Errors)ie=this.i9i(Pf),this.Mqa&&this.Mqa.c8h(ie)}this.Zxc?(0<Lb.count?this.zXb?this.zXb(new Gb(lb,Lb)):fa.c(512267295,306,15,"Received errors but the promise has completed"):this.AXb?this.AXb(new Gb(lb,Lb)):fa.c(512267294,306,15,"Received valid tokens but the promise has completed"),fa.c(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
lb.count,Lb.count,Ia.CorrelationId,this.Tqa)):(0<Lb.count&&""!==Pc?(hc=Object.assign(new ic.a,{extendedProperties:new Map}),hc.extendedProperties.set("Errors",Pc),hc.extendedProperties.set("RetryCount",this.eBa.toString()),hc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),hc.extendedProperties.set("IsTokenExpiring",this.WTb.toString()),Hc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,hc)):Hc.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),fa.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",lb.count,Lb.count,Ia.CorrelationId,this.Tqa),0<Lb.count&&!this.t$b(Lb)?(Ia=this.sS.N5f(Lb),Ia!==this.sS.KKb&&(this.Bj.eVe(Ub.zlh,Ia),this.Zd.V5(this.Um,Ia))):(this.Bj.flush(),this.Um&&(fa.c(39408131,306,100,"Deleting task {0} from task manager",this.Um.name),this.Zd.Lg(this.Um)),this.$v&&!this.$v.task.isCompleted?this.$v.Gg(new Gb(lb,Lb)):fa.c(512267293,306,15,"Received results but the task has completed")))}}Xhj(Ia){if(!Ia)return null;
const lb=Object.assign(new uc,{Name:Ia.Name,Errors:[]});for(const Lb of Ia.Errors)Ia=new wc,Ia.Id=Lb.Id,Ia.Details=F.a.$Tc(Lb.Details,500),lb.Errors.push(Ia);return lb}requestTokensOnce(){this.zkh()}zkh(){e.AFrameworkApplication.bGa("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.eBa>=this.sS.oYg?(fa.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Tqa),this.iDi(this.$v)):(Hc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),
this.Doh())}Doh(){const Ia={};Ia[Yb.a.fph]=this.sS.tokens;const lb=db.a.create().toString();fa.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.sS.tokens),this.eBa+1,lb,this.Tqa);this.nlf.execute(Lb=>{Lb.sendMessage(Zc.a.AQd,Ia,lb)});this.eBa++;this.Bj.vyb(Ub.s_a)}iDi(Ia){const lb=new Jb.a;for(let Lb=0;Lb<this.sS.tokens.length;Lb++){const hc=Object.assign(new uc,{Name:this.sS.tokens[Lb],Errors:[Object.assign(new wc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
lb.add(hc);this.oha.add(hc)}this.Zd.Lg(this.Um);this.Bj.HY(Ub.P1d,JSON.stringify(this.oha));this.Bj.HY(Ub.status,Ub.failed);Ia&&!Ia.task.isCompleted&&Ia.Gg(new Gb(new Jb.a,this.oha))}cTk(Ia){this.Rpf.start();this.WTb=Ia;this.Tqa=db.a.create().toString();fa.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Tqa,this.WTb);this.eBa=0;this.oha.clear();this.LEc.clear();this.$v=new Pa.a;this.Zxc?this.Akh(this.sS.oYg).then(lb=>{this.$v&&!this.$v.task.isCompleted&&this.$v.Gg(lb);
this.zXb=this.AXb=null;this.Bj.HY(Ub.P1d,JSON.stringify(this.oha));this.Bj.HY(Ub.status,Ub.success);this.Bj.flush()}).catch(lb=>{this.$v&&!this.$v.task.isCompleted&&this.$v.Gg(Object(xb.a)(635,lb));this.zXb=this.AXb=null;this.Bj.HY(Ub.P1d,JSON.stringify(this.oha));this.Bj.HY(Ub.status,Ub.failed);this.Bj.flush()}):(this.Um=new tb.a(this.sS.priority,2,this.sS.KKb,Object(A.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Zc.a.AQd,!0),this.t_h&&this.zkh(),this.Zd.Db(this.Um));return this.$v.task}Akh(Ia){const lb=
this,Lb=new Promise((Sd,wf)=>{lb.AXb=Sd;lb.zXb=wf;Hc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);lb.Doh()}),hc=this,Pc=new Promise((Sd,wf)=>{window.setTimeout(()=>{wf(hc.SJf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},hc.sS.KKb)});let Td=Ia;const ie=this;return new Promise((Sd,wf)=>{Td--;Promise.race([Lb,Pc]).then(Pf=>{Hc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Sd(Pf)}).catch(Pf=>{var og=ie.sS.KKb;if(Object(Rb.a)(635,
Pf)&&(Pf=Object(xb.a)(635,Pf),0<Pf.errors.count)){ie.d2j(Pf.errors);ie.qsf(Pf.errors);if(ie.t$b(Pf.errors)){wf(Pf);return}const Dh=ie.sS.N5f(Pf.errors);Dh!==ie.sS.KKb?(ie.Bj.eVe(Ub.zlh,Dh),og=Dh):ie.XVj(Pf.errors)&&(og=0)}Td?window.setTimeout(()=>{ie.Akh(Td).then(Sd).catch(wf)},og):(og=ie.SJf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ie.qsf(og.errors),wf(og),fa.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ie.Tqa))})})}qsf(Ia){for(let lb of Ia)this.oha.add(lb)}XVj(Ia){if(!Ia.count)return!1;Ia=Ia.ga(Ia.count-1);return Ia.Errors.length?"TIMEOUT"==Ia.Errors[0].Id:!1}SJf(Ia,lb){const Lb=new Jb.a;for(let hc=0;hc<this.sS.tokens.length;hc++){const Pc=this.jDi(this.sS.tokens[hc],Ia,lb);Lb.add(Pc)}return new Gb(new Jb.a,Lb)}jDi(Ia,lb,Lb){return Object.assign(new uc,{Name:Ia,Errors:[Object.assign(new wc,{Id:lb,Details:Lb})]})}d2j(Ia){if(Ia.count){Ia=Ia.ga(Ia.count-1);Ia=JSON.stringify(Ia);var lb=Object.assign(new ic.a,
{extendedProperties:new Map});lb.extendedProperties.set("Errors",Ia);lb.extendedProperties.set("RetryCount",this.eBa.toString());lb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());lb.extendedProperties.set("IsTokenExpiring",this.WTb.toString());Hc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,lb);this.Bj.HY(Ub.error,Ia);this.Bj.HY(Ub.status,Ub.failed)}}NKk(Ia){this.Rpf.stop();const lb=this.Ixj(Ia.result.errors);m.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!lb,this.Tqa,this.WTb,this.eBa,this.oha.count,0<Ia.result.errors.count?Ia.result.errors.ga(0).Name:"",0<Ia.result.errors.count&&0<Ia.result.errors.ga(0).Errors.length?Ia.result.errors.ga(0).Errors[0].Id:"",0<Ia.result.errors.count&&0<Ia.result.errors.ga(0).Errors.length?Ia.result.errors.ga(0).Errors[0].Details:"");return lb?
!1:this.MKk(Ia.result.tokens)}t$b(Ia){return this.sS.t$b(Ia)}MKk(Ia){for(let lb=0;lb<Ia.count;lb++){const Lb=Ia.ga(lb);if(Lb.Name===Yb.a.accessToken){const hc=(new Date).getTime();Lb.Expiry>e.AFrameworkApplication.im?(m.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Lb.Expiry,["NowGetTime"]:hc,["BootTime"]:e.AFrameworkApplication.sca},"PreviousAccessTokenTtl",e.AFrameworkApplication.im),e.AFrameworkApplication.accessToken=Lb.Value,e.AFrameworkApplication.im=Math.floor(Lb.Expiry),
e.AFrameworkApplication.l6e=hc,e.AFrameworkApplication.H7=Math.floor(Lb.Expiry)):m.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Lb.Expiry,["NowGetTime"]:hc,["BootTime"]:e.AFrameworkApplication.sca},"PreviousAccessTokenTtl",e.AFrameworkApplication.im)}}return!0}Ixj(Ia){let lb=!1;for(let Lb=0;Lb<Ia.count;Lb++){lb=!0;const hc=Ia.ga(Lb);m.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
hc.Name,JSON.stringify(hc.Errors),this.Tqa)}return lb}i9i(Ia){let lb=Sb.a.sessionAccessTokenExpired;Ia=parseInt(Ia.Id);if(isNaN(Ia))lb=Sb.a.WJl;else{switch(Ia){case 401:lb=Sb.a.ZJl;break;case 403:lb=Sb.a.UJl;break;case 500:lb=Sb.a.VJl;break;case 503:lb=Sb.a.YJl}lb===Sb.a.sessionAccessTokenExpired&&(lb=500<Ia?Sb.a.XJl:Sb.a.TJl)}return lb}}Object(h.a)(Yc,"TokenRefreshManager",null,[622]);class ec{constructor(){this.KKb=e.AFrameworkApplication.bKl;this.oYg=e.AFrameworkApplication.$Jl;this.tokens=e.AFrameworkApplication.$oj();
this.priority=e.AFrameworkApplication.cKl;this.Kmf=this.Mcl();this.wNd=e.AFrameworkApplication.Zoj()}t$b(Ia){Ia=JSON.stringify(Ia);if(this.wNd&&0<this.wNd.length)for(const lb of this.wNd)if(0<lb.length&&0<=Ia.indexOf(lb))return!0;return!1}N5f(Ia){try{if(Ia)for(let lb of Ia)if(lb.Errors)for(const Lb of lb.Errors)if(Lb.Id in this.Kmf)return Number.parseInvariant(this.Kmf[Lb.Id].toString())}catch(lb){m.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",lb.toString())}return this.KKb}Mcl(){const Ia=
{};try{if(!e.AFrameworkApplication.YUc()||0>=e.AFrameworkApplication.YUc().length||""===e.AFrameworkApplication.YUc()[0])return Ia;for(const lb of e.AFrameworkApplication.YUc())0<lb.length&&(Ia[lb]=e.AFrameworkApplication.aKl)}catch(lb){m.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",lb.toString())}return Ia}}Object(h.a)(ec,"TokenRefreshPolicy",null,[621]);class rb{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.gf(()=>
{this.PEa()})}PEa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Zb(Ia){this.Da=Ia;Ia.register(620,"Common.App.SessionExpiration.ISessionLogger").ma().oa(()=>new Bc(lc.a.instance));Ia.register(621,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().oa(()=>new ec);Ia.register(622,"Common.App.SessionExpiration.ITokenRefreshManager").ma().oa(()=>new Yc(lc.a.instance,
e.AFrameworkApplication.kT(),Ia.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),Ia.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),Ia.ub("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSyncMessageWithTimeout")));Ia.register(623,"Common.ISessionExpirationManagerFactory").ma().oa(()=>
new Xc(e.AFrameworkApplication.Aa,Ia.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Ia.resolve("Common.App.SessionExpiration.ISessionLogger"),Ia.ub("Common.ISessionStatus")));Ia.register(624,"Common.ISessionExpirationManagerWithDialog").ma().oa(()=>Ia.resolve("Common.ISessionExpirationManagerFactory").create());Ia.register(625,"Common.ISessionExpirationManager").ma().oa(()=>Ia.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){n.a.instance.Dc(new rb)}}Object(h.a)(rb,
"SessionExpirationPackage",null,[2,3]);var ac=d(55),Jc=d(441),Db=d(39),dd=d(155),Cd=d(121),pd=d(134),Ge=d(60),kd=d(28),Xf=d(35),Kd=d(30);class lg extends Qb.a{constructor(Ia,lb){super();this.hfa=null;this.Q5j=!1;this.R6j="";this.zHg=this.AHg=this.btg=this.ctg=null;this.xd=3;this.Xe(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Xe(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=Ia;this.rIg=lb.qk(Ge.a.cEk)}dispose(){this.hfa=null;super.dispose()}showDialog(Ia){this.Zi(Ia);this.ctg=document.getElementById("btnMaximize");
this.AHg=Object(A.a)(this,this.lxk,"onScaleUpButton");u.a.addHandler(this.ctg,"click",this.AHg);this.btg=document.getElementById("btnEnsure");this.zHg=Object(A.a)(this,this.kxk,"onScaleDownButton");u.a.addHandler(this.btg,"click",this.zHg)}Zi(Ia){this.nqa=Object(A.a)(this,this.ydl,"setSlideOrientationRatio");this.yya(Ia);this.fm.style.width="420px";this.show()}hide(){this.Gb&&(e.AFrameworkApplication.Aa.Mw.Ko(Cd.AFrame.v5),super.hide())}lxk(Ia){this.ia.processAction(Kd.a.mqc,2);Ia.preventDefault();
this.GV&&this.hide()}kxk(Ia){this.ia.processAction(Kd.a.lqc,2);Ia.preventDefault();this.GV&&this.hide()}ydl(Ia){1===Ia?this.ia.processAction(Kd.a.mqc,2):2===Ia?this.ia.processAction(Kd.a.lqc,2):kd.a.J(25277209,822,50,"Cancle the slide orientation change.");this.GV&&this.hide()}yya(){this.pu();this.AA()}pu(){super.pu();Sys.UI.DomElement.addCssClass(this.Gb,this.R6j);var Ia=$get("WACDialogTitleText");Ia.innerText=ResourceStrings.l_SetSlideScaleTitle;Ia.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);
Ia=document.createElement("div");Ia.id=this.Nh("WACDialogHtmlPanel");Ia.className="WACDialogHtmlPanel";this.fm.appendChild(Ia);this.hfa=document.createElement("div");this.hfa.id=this.Nh("WACDialogText");Ia.appendChild(this.hfa);Ia=document.createElement("div");Ia.id=this.Nh("Scalediv");Ia.className="WACDialogRow";this.hfa.appendChild(Ia);var lb=document.createElement("label");lb.id=this.Nh("Scalelabel");lb.innerText=ResourceStrings.L_SetSlideOrientationInformation;Ia.appendChild(lb);Ia=document.createElement("div");
Ia.id=this.Nh("ScaleMode");Ia.setAttribute("style","margin-left: 20px;");Ia.className="WACDialogRow";this.hfa.appendChild(Ia);lb=lg.YJf(Ge.a.Y9g+"_MaximizeFit_170x130x32",this.rIg,ResourceStrings.L_SetSlideOrientationMaximize);lb.id=this.Nh("btnMaximize");var Lb=document.createElement("td");Lb.className=String.format("clip{0}x{1}","170","130");Lb.setAttribute("style","border: #ccc 1px solid");Lb.appendChild(lb);lb=lg.YJf(Ge.a.Y9g+"_Ensurefit_170x130x32",this.rIg,ResourceStrings.L_SetSlideOrientationEnsure);
lb.id=this.Nh("btnEnsure");var hc=document.createElement("td");hc.className=String.format("clip{0}x{1}","170","130");hc.setAttribute("style","border: #ccc 1px solid");hc.appendChild(lb);var Pc=document.createElement("td");Pc.setAttribute("style","width: 30px;");lb=document.createElement("tr");lb.appendChild(Lb);lb.appendChild(Pc);lb.appendChild(hc);Lb=document.createElement("td");Lb.setAttribute("align","center");hc=document.createElement("label");hc.id=this.Nh("Maxlabel");hc.className="UIFontBold";
hc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Lb.appendChild(hc);hc=document.createElement("td");hc.setAttribute("align","center");Pc=document.createElement("label");Pc.id=this.Nh("Ensurelabel");Pc.className="UIFontBold";Pc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;hc.appendChild(Pc);const Td=document.createElement("td");Td.setAttribute("style","width: 30px;");Pc=document.createElement("tr");Pc.appendChild(Lb);Pc.appendChild(Td);Pc.appendChild(hc);Lb=document.createElement("table");
Lb.appendChild(lb);Lb.appendChild(Pc);Ia.appendChild(Lb)}AA(){this.Tqd(Qb.a.Wlc+(Qb.a.DU-lg.qmi)/2-12,Qb.a.Vlc+(Qb.a.zR-lg.vmi)/2-12)}Tqd(Ia,lb){this.Gb.style.top=(0>Ia?0:Ia)+"px";Xf.a("DeprecateIE.SetSlideOrientation")?this.Gb.style.left=(0>lb?0:lb)+"px":ac.a.Uab&&e.AFrameworkApplication.isRtl?this.Gb.style.right=(0>lb?0:lb)+"px":this.Gb.style.left=(0>lb?0:lb)+"px";this.Q5j||(this.Gb.style.width=String.format("{0}em",this.width));this.Gb.style.display="Block"}static YJf(Ia,lb,Lb){const hc=document.createElement("img");
hc.className=Ia;hc.setAttribute("Unselectable","on");hc.setAttribute(pd.a.ef,pd.a.nN);hc.src=lb;Lb&&(hc.alt=Lb,hc.title=Lb);return hc}}lg.vmi=350;lg.qmi=200;Object(h.a)(lg,"SetSlideOrientationDialog",Qb.a,[]);var ve=d(52),Ua=d(111),Bb=d(248),mc=d(71);class Nc extends P.a{constructor(Ia,lb){super(!1,!1,!0);this.qIf=this.j3=null;if(!Ia)throw Error.argumentNull("actionManager");if(!lb)throw Error.argumentNull("presentationReader");this.ia=Ia;this.oc=lb}QEa(){this.j3=Object(A.a)(this,this.zdl,"setSlideSizeAndLayoutDialogResultHandler");
this.qIf=this.j1i(this.getCurrentSlideDimensions());this.Zi(ResourceStrings.L_SetSlideSize,this.j3,this.qIf)}zdl(Ia,lb){1===Ia&&this.ia.La(Kd.a.Arh,2,lb);this.dispose()}getCurrentSlideDimensions(){const Ia=this.oc.Gu(),lb={};lb.height=Ia.height;lb.width=Ia.width;lb.slideType=this.oc.Vjj();return lb}j1i(Ia){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:Ia,["numberFormatInfo"]:mc.e().numberFormatInfo}}}Object(h.a)(Nc,"SlideSizeAndLayoutDialog",P.a,[]);class nd{constructor(Ia,lb,Lb,hc,Pc,
Td,ie,Sd,wf){this.oIa=this.Nma=this.qU=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");this.Iwh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.Vwh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=Ia;this.Ea=lb;this.hf=Lb;this.Jb=
hc;this.Vb=Pc;this.ua=Td;this.pa=Sd;this.oc=ie;this.qe=wf}wb(){this.ia.ra(Kd.a.Qjd,ve.a.application,Object(A.a)(this,this.eOe,"querySlideSize"),96);this.ia.ra(Kd.a.Pjd,ve.a.application,Object(A.a)(this,this.eOe,"querySlideSize"),96);this.ia.ra(Kd.a.fOe,ve.a.application,Object(A.a)(this,this.eOe,"querySlideSize"),96);this.ia.ya(Kd.a.Bdl,ve.a.application,Jc.a.dH);this.ia.ra(Kd.a.sMk,ve.a.application,Jc.a.d1,96);this.ia.ra(Kd.a.oqc,ve.a.application,Object(A.a)(this,this.ewj,"handleSetSlideSize"),4);
this.ia.ra(Kd.a.jpd,ve.a.application,Object(A.a)(this,this.gwj,"handleSetSlideSize4x3"),4);this.ia.ra(Kd.a.ipd,ve.a.application,Object(A.a)(this,this.fwj,"handleSetSlideSize16x9"),4);this.ia.ra(Kd.a.jJe,ve.a.application,Object(A.a)(this,this.jZj,"launchSlideSizeAndLayoutDialogHandler"),4);this.ia.ra(Kd.a.$zk,ve.a.application,Object(A.a)(this,this.apg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra(Kd.a.aAk,ve.a.application,Object(A.a)(this,this.apg,"launchSetSlideOrientationScaleTypeDialogHandler"),
4);this.ia.ra(Kd.a.mqc,ve.a.application,Object(A.a)(this,this.zrh,"setSlideOrientationHandler"),4);this.ia.ra(Kd.a.lqc,ve.a.application,Object(A.a)(this,this.zrh,"setSlideOrientationHandler"),4);this.ia.ra(Kd.a.Arh,ve.a.application,Object(A.a)(this,this.Adl,"setSlideSizeAndLayoutHandler"),4);this.ia.ya(Kd.a.Cdl,ve.a.application,Jc.a.dH);this.ia.ya(Kd.a.setSlideHeight,ve.a.application,Jc.a.dH);this.ia.ra(Kd.a.uMk,ve.a.application,Jc.a.d1,96);this.ia.ra(Kd.a.tMk,ve.a.application,Jc.a.d1,96);this.ia.ya(Kd.a.fpl,
ve.a.application,Jc.a.dH);this.ia.ya(Kd.a.epl,ve.a.application,Jc.a.dH)}Ee(){}eOe(Ia,lb,Lb,hc,Pc){kd.a.J(34936782,822,50,"Click slide size drop down.");if(lb.contextId!==ve.a.application)return 2;if(lb=Object(xb.a)(Ua.a,Pc))Ia=nd.zLj(this.oc.Gu(),Ia),lb.Mf(Ia);return 32}jZj(Ia,lb,Lb){lb=this.ua.Ba;return!lb||this.hf.$c(lb)||!Xf.a("DeprecateIE.CustomizeSlideSizeActor")&&ac.a.mx?8:1===Lb?32:dd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",Ia,()=>{(new Nc(this.ia,this.oc)).QEa();
kd.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}apg(Ia,lb,Lb,hc,Pc){Ia=this.ua.Ba;if(!Ia||this.hf.$c(Ia))return 16;if(1===Lb)return 32;if("slideType"in Pc&&"slideWidth"in Pc&&"slideHeight"in Pc)if(this.oIa=6,"o_custom"===Pc.slideType.toString().toLowerCase())this.qU=6*Math.round(Pc.slideWidth),this.Nma=6*Math.round(Pc.slideHeight);else{Lb=0;for(const Td of this.slideSizeType){if(Pc.slideType.toString().toLowerCase()===Td.toLowerCase()){this.oIa=Lb;break}Lb++}"landscape"===
Pc.orientation.toString()?(this.Nma=this.Iwh[Lb],this.qU=this.Vwh[Lb]):(this.qU=this.Iwh[Lb],this.Nma=this.Vwh[Lb])}(new lg(this.ia,this.qe)).showDialog(ResourceStrings.l_SetSlideScaleTitle);kd.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}ewj(Ia,lb,Lb){Ia=this.ua.Ba;return!Ia||this.hf.$c(Ia)?8:this.ia.processAction(Kd.a.b8a,Lb)}gwj(Ia,lb,Lb){kd.a.J(34936788,822,50,"click set slide size 4:3.");lb=this.ua.Ba;if(!lb||this.hf.$c(lb))return 16;if(1===Lb||960===this.oc.Gu().width)return 32;
this.qU=5760;this.Nma=4320;this.oIa=0;return this.dMb(this.qU,this.Nma,Ia,this.oIa,"EnsureFit")}fwj(Ia,lb,Lb){kd.a.J(34936792,822,50,"click set slide size 16:9.");lb=this.ua.Ba;if(!lb||this.hf.$c(lb))return 16;if(1===Lb)return 32;Lb=this.oc.Gu();if(1280===Lb.width)return 32;this.qU=7680;this.Nma=4320;this.oIa=16;return 960===Lb.width&&720===Lb.height?this.dMb(this.qU,this.Nma,Ia,this.oIa,""):this.dMb(this.qU,this.Nma,Ia,this.oIa,"EnsureFit")}Adl(Ia,lb,Lb,hc,Pc){lb=this.ua.Ba;return!lb||this.hf.$c(lb)?
8:1===Lb?32:this.dMb(Pc.width,Pc.height,Ia,Pc.slideType,Pc.slideScaleType)}zrh(Ia,lb,Lb){lb=this.ua.Ba;return!lb||this.hf.$c(lb)?16:1===Lb?32:this.Nma&&this.qU?Ia===Kd.a.mqc?this.dMb(this.qU,this.Nma,Ia,this.oIa,"Maximize"):Ia===Kd.a.lqc?this.dMb(this.qU,this.Nma,Ia,this.oIa,"EnsureFit"):32:(kd.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}dMb(Ia,lb,Lb,hc,Pc){const Td=this.ua.Ba;let ie=!1;if(Td){var Sd=Td.Ek();if(Sd&&0<Sd.length)for(const wf of Sd)if(wf.gFa){ie=
!0;break}}Sd=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()});try{Sd.kd(Td),Sd.jd=Lb,Sd.Vy[Bb.a.Qxb]=ie,Td.setValue(Db.a.slideWidth,Ia),Td.setValue(Db.a.slideHeight,lb),Td.setValue(Db.a.slideScaleType,Pc),Td.setValue(Db.a.slideSizeType,hc)}finally{Sd&&Sd.dispose()}kd.a.J(34936798,822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",Ia,lb,Pc);this.hf.NZb(this.Vb.Ef,Td,Lb);return 32}static zLj(Ia,lb){Ia=Ia.width/Ia.height;switch(lb){case Kd.a.Qjd:return.01>Math.abs(Ia-1.33);case Kd.a.Pjd:return.01>
Math.abs(Ia-1.77);default:return!1}}}Object(h.a)(nd,"CustomizeSlideSizeActor",null,[352]);class Dd{}Dd.Ukh=0;Dd.G1k=22711;Object(h.a)(Dd,"ImageConstants",null,[]);var La=d(232),gb=d(325),vc=d(445),td=d(43),Nd=d(102),Od=d(246),Oc=d(110);class Af extends Oc.a{constructor(){super();this.ImageToken=null;this.ErrorCode=0}Zk(){return 78}}Object(h.a)(Af,"NotifyImageUploadFailureRequest",Oc.a,[]);class Ae{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf,Pf,og,Dh,Bi,Vi,kh,mi,sh,Ng,Wh,Gg,eg,Tj,aj){this.mIa=this.$Va=
this.tJ=null;this.MFb=!1;this.Zvk=(pj,Ji)=>{(pj=v.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&Ji&&Ji.IRj&&pj.execute(yg=>{yg.logActivity("InsertPicture",null)})};this.ia=Ia;this.ob=Lb;this.fc=lb;this.ua=Pc;this.Jb=Td;this.Ea=hc;this.nB=ie;this.iR=Sd;this.Sk=wf;this.eye=Pf;this.Nu=og;this.Rd=Dh;this.Fb=Bi;this.sgc=Vi;this.Eec=kh;this.LWa=mi;this.vi=sh;this.Wj=Ng;this.Ha=Wh;this.gl=Gg;this.Lc=eg;this.cU=Wh.DIb;this.Fa=Tj;this.H$j=null===aj||void 0===aj?void 0:aj.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",
!1);this.Vu()}Vu(){this.H$j&&this.Lc.t$h(this.Zvk)}wb(){this.ia.ra(Kd.a.insertPicture,V.a.application,Object(A.a)(this,this.A$f,"handleInsertPicture"),4);this.ia.ra(Kd.a.PPc,V.a.view,Object(A.a)(this,this.Zwj,"handleUploadPictureAll"),4);this.ia.ra(Kd.a.oJc,V.a.application,Object(A.a)(this,this.Yqj,"handleChangePicture"),4);this.ia.ra(Kd.a.Xld,V.a.application,Object(A.a)(this,this.Dvj,"handleResetPicture"),4);this.ia.ra(Kd.a.Skh,V.a.application,Object(A.a)(this,this.Evj,"handleResetPictureAndSize"),
4);this.ia.ra(Kd.a.Tkh,V.a.application,Object(A.a)(this,this.Fvj,"handleResetPictureSplitButton"),4);this.ia.ra(Kd.a.Pra,V.a.application,Object(A.a)(this,this.Zqj,"handleChangePictureStyle"),4);this.ia.ra(Kd.a.r0d,V.a.application,Object(A.a)(this,this.A$f,"handleInsertPicture"),4);this.ia.ra(Kd.a.YPf,V.a.application,Object(A.a)(this,this.Orj,"handleDragAndInsertImage"),4)}Ee(){}A$f(Ia,lb,Lb){this.Ha.Qhg&&!Xf.a("DummyChangeGateForTest")&&kd.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");
lb=this.ua.Ba;lb=this.Ha.w_c&&!!lb&&!this.fc.$c(lb);lb=(this.Eec=this.sgc.aKj()&&this.Eec)?lb&&!!this.nB&&this.nB.$ud:this.iR.wig&&lb;if(!lb)return 16;if(1===Lb)return 32;this.MFb=!0;this.mIa=this.ua.Ba;this.Oqd(Ia!==Kd.a.r0d,!0);return 32}Zwj(Ia,lb,Lb,hc,Pc){var Td=this.ua?this.ua.Ba:null;if(!Td||!Td.isConnected)return 16;if(!this.Wj.OF(Td,1))return this.Wj.nG(Td),16;kd.a.J(512500497,822,50,"Start picture upload");lb=Ae.pVj(Pc);(hc=td.a.Ib)&&hc.Va(Nd.a.WGj,lb?"1":"0");this.Lc.VPk();let ie=!1;if(this.MFb&&
this.Eec&&!this.nB.hkb&&this.zPj(lb)){if(Td=Td.A3(this.ob.Wd())){if(15!==Td.Hj){const Sd=Td.OU;Sd.BottomLeft.X!==Sd.TopLeft.X&&(ie=!0)}hc&&hc.Va(Nd.a.M3k,ie?"1":"0")}Td&&(15===Td.Hj||ie)?(hc&&hc.Va(Nd.a.N2d,ie?"PlaceHolder Rotated":"Picture Type PlaceHolder"),Ia=this.Gag(Ia,Lb,Pc)):Ia=this.$wj(Ia,Lb,Pc)}else this.nB.hkb=!1,Ia=this.Gag(Ia,Lb,Pc);lb&&32===Ia&&kd.a.J(512500496,822,50,"Upload a svg file successfully.");return Ia}zPj(Ia){return Ia?this.Ha.powerPointInsertSVGFileLocalRenderingEnabled:!0}Orj(Ia,
lb,Lb,hc,Pc){if(!this.nB.IEk)return kd.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Pc)return 16;Ia=[];lb=0;Lb=!1;for(const Td of Pc)if(lb++,"string"===typeof Td.type)if(Pc=F.a.qg(Td.type),kd.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",lb,Td.size,Pc),0<=Pc.indexOf("image")&&0===this.nB.qvd(Td.name))if(Ia.length<this.Ha.powerPointDragInsertMultipleImageQuantityLimit)Array.add(Ia,
Td);else{this.gl.bL(19);break}else Lb||(this.gl.bL(18),Lb=!0);if(1>Ia.length)return kd.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.nB.ZOi(Ia);return 32}Gag(Ia,lb,Lb){if(!(this.ua&&this.ua.Ba&&this.nB))return 16;if(1===lb)return 32;this.iR.rhb=new Date;this.MFb&&this.ob.ij();this.Ea.Ed();this.fc.blockContent(this.ua.presentation,Ia);const hc=td.a.Ib;this.nB.m_e(Lb,Pc=>{td.a.BI(hc,()=>{kd.a.J(512500492,822,50,"Picture upload successful");this.muj(Lb,
Pc,Ia);this.MXf()})},Pc=>{kd.a.J(512500491,822,10,"Upload picture failed");this.B7b(Pc.error);this.MXf()});return 32}$wj(Ia,lb,Lb){if(!(this.ua&&this.ua.Ba&&this.nB))return 16;if(1===lb)return 32;const hc=String.format("{0}{1}","client",db.a.create().toString());kd.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",hc,Lb.uL);this.iR.Rhi(hc);const Pc=td.a.Ib;Pc&&(lb="InsertPicture",this.MFb||(lb="ChangePicture"),Pc.actionName=lb,Pc.Nj=!0);const Td=new Date;td.a.zk("PictureUploadStart",
td.a.nf(Td));td.a.zk("ImageSize",Lb.uL.toString());td.a.zk("ImageToken",hc);const ie=this.ua.Ba.sid;this.ia.La(Kd.a.Kee,2,ie);this.nB.m_e(Lb,Sd=>{td.a.BI(Pc,()=>{kd.a.J(512500489,822,50,"Upload picture completed");td.a.zk("PictureUploadDurationMS",(+new Date-+Td).toString());this.HEk(hc,Sd);this.ia.La(Kd.a.wXc,2,ie)})},Sd=>{this.iR.ORf(hc);var wf=Object.assign(new Af,{ImageToken:hc,ErrorCode:Sd.error.Code});Pc&&Pc.Va("UploadPictureErrorCode",La.a[wf.ErrorCode]);wf=new Od.a(wf,null,()=>Ae.uvk());this.vi.Db(wf);
kd.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",hc,La.a[Sd.error.Code],Sd.error.Message);this.ia.La(Kd.a.wXc,2,ie)},hc);this.insertPicture(hc,Ia,Lb);return 32}Yqj(Ia,lb,Lb){Ia=this.cU?this.C9a():this.Kwb();if(!(this.cU?this.u$b(Ia):this.Wkg(Ia)&&this.Ha.w_c&&this.iR.wig&&!this.fc.$c(Ia)))return 16;if(1===Lb)return 32;this.MFb=!1;this.Oqd(!0,!1);return 32}Dvj(Ia,lb,Lb){return this.Pra(lb,Lb,Dd.Ukh,Ia)}Evj(Ia,lb,Lb){return this.Pra(lb,Lb,Dd.G1k,Ia)}Fvj(Ia,
lb,Lb,hc,Pc){return this.Pra(lb,1,Pc,Ia)}Zqj(Ia,lb,Lb,hc,Pc){return this.Pra(lb,Lb,Pc,Ia)}Pra(Ia,lb,Lb,hc){const Pc=this.ob.Wd();if(!(Pc&&0<Pc.length))return 8;Ia=[];if(Xf.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.fij(Pc,Ia);else for(const ie of Pc){if(this.jkg(ie)||this.fc.$c(ie))return 8;(this.cU?this.u$b(ie):this.Wkg(ie))&&Ia.push(ie)}if(0>=Ia.length)return 8;if(1===lb)return 32;kd.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Lb);lb=td.a.Ib?td.a.Ib.actionName:
null;for(var Td of Ia)this.SRa(Td);Td=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{Td.nc(Ia[0]);Td.jd=hc;for(const ie of Ia)ie.qhb=Lb}finally{Td&&Td.dispose()}if(hc=td.a.Ib)lb&&(hc.actionName=lb),hc.Va("PictureStyleId",Lb.toString()),td.a.Ofa(hc);return 32}fij(Ia,lb){let Lb=!1;for(const hc of Ia){if(!hc||this.jkg(hc)||this.fc.$c(hc))return;hc.Ng&&(Lb=!0)}if(Lb)for(const hc of Ia)hc.Ng&&this.u$b(hc)&&lb.push(hc);else for(const hc of Ia)if(this.u$b(hc))lb.push(hc);else if(hc.Jf){Ia=this.Fa.ex(hc);
for(const Pc of Ia)this.u$b(Pc)&&lb.push(Pc)}}muj(Ia,lb,Lb){this.iR.vZa=new Date;const hc=lb.result;if(Ia){if(this.MFb?(lb="InsertPicture",this.EGj(hc,Ia,Lb)):(lb="ChangePicture",Xf.a("ChangePictureOnMultiSelectFixEnabled")?this.xqi(hc,Ia,Lb):this.yqi(hc,Ia,Lb)),Ia=td.a.Ib)Ia.actionName=lb,Ia.Va("PictureUploadStart",td.a.nf(this.iR.rhb)),Ia.Va("PictureUploadDurationMS",(+this.iR.vZa-+this.iR.rhb).toString())}else Ia=Object.assign(new gb.a,{Code:94}),this.B7b(Ia)}HEk(Ia,lb){this.iR.ORf(Ia);lb.result||
kd.a.J(512500486,822,50,"Upload picture completed with null response")}EGj(Ia,lb,Lb){const hc=this.ua.Ba;if(hc&&hc.isConnected){this.$Va=hc.A3(this.ob.Wd());var Pc=this.Jb.Ad(15,void 0,void 0,()=>{this.ob.selectShape(this.tJ,!0);this.Ea.Ed()});try{Pc.nc(hc),Pc.jd=Lb,Pc.Vy[Bb.a.qDa]=Bb.a.hYf,this.tJ=this.Sk.hDi(hc.Cb),this.$Va&&(this.tJ.vca=this.$Va.id),this.tJ.SLb(Ia.ItemId,this.Ha.EUa?null:lb.fileName,lb.fileName),hc.dC(this.tJ)}finally{Pc&&Pc.dispose()}this.fc.Mra(this.ua.Ba,this.tJ,this.Fb.Ma,
"InsertPictureAfterUpload");this.Nu.SF=this.tJ}}xqi(Ia,lb,Lb){var hc=this.ob.Wd();if(hc){var Pc=[];for(const Td of hc)Td.Jf||Pc.push(Td);for(const Td of Pc)this.SRa(Td);hc=this.Jb.Ad(15);try{hc.jd=Lb;hc.nc(Pc[0]);for(const Td of Pc)Td.vca=Td.id,this.Ha.EUa?(Td.SLb(Ia.ItemId,null,lb.fileName),Td.set_alt("")):Td.SLb(Ia.ItemId,lb.fileName,lb.fileName)}finally{hc&&hc.dispose()}for(const Td of Pc)this.fc.Mra(this.ua.Ba,Td,this.Fb.Ma,"ChangePictureAfterUpload")}}yqi(Ia,lb,Lb){const hc=this.cU?this.C9a():
this.Kwb();if(hc){this.SRa(hc);var Pc=this.Jb.Ad(15);try{Pc.jd=Lb,Pc.nc(hc),hc.vca=hc.id,this.Ha.EUa?(hc.SLb(Ia.ItemId,null,lb.fileName),hc.set_alt("")):hc.SLb(Ia.ItemId,lb.fileName,lb.fileName)}finally{Pc&&Pc.dispose()}this.fc.Mra(this.ua.Ba,hc,this.Fb.Ma,"changePictureAfterUploadSingleImage")}}B7b(Ia){this.iR.vZa=new Date;kd.a.J(512500484,822,50,"Upload picture failed");this.Rd.cH(Ia.Code,lb=>{lb.jC=1;lb.ZRa=Ia.ExtraErrorParam;return!1})}MXf(){this.fc.fK(this.ua.presentation)}Oqd(Ia,lb){this.eye?
vc.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.nB&&(this.nB.T1c=this.Eec,this.nB.vPb=0,Ia&&this.nB.Ech(lb))}Kwb(){const Ia=this.ob.Wd();for(const lb of Ia)if(lb&&lb.Fj)return lb;return null}C9a(){const Ia=this.ob.Wd();return Ia&&Ia.length?this.nRd(Ia)?Ia[0]:this.Kwb():null}nRd(Ia){if(!Ia||!Ia.length)return!1;let lb=Ia[0].Fj,Lb=1===Ia[0].mediaType;for(const hc of Ia)lb=lb&&hc.Fj,Lb=Lb&&1===hc.mediaType;return lb||Lb}$k(Ia){return Ia?Object(xb.a)(117,Ia.sc(this.Fb.Ma)):
null}SRa(Ia){Ia&&Ia.gy&&(Ia=this.$k(Ia))&&Ia.q1(!1)}Wkg(Ia){return this.ua&&this.ua.Ba&&Ia&&Ia.Fj?!0:!1}u$b(Ia){return this.ua&&this.ua.Ba&&Ia&&(Ia.Fj||1===Ia.mediaType)?!0:!1}jkg(Ia){return this.ua&&this.ua.Ba&&Ia&&Ia.Mp?!0:!1}insertPicture(Ia,lb,Lb){var hc=this.ua.Ba;const Pc=Object(xb.a)(573,hc.sc(this.Fb.Ma)),Td=this.mIa.Cb;if(hc&&hc.isConnected&&Pc&&this.mIa&&this.mIa.isConnected){hc=this.mIa.Ut();this.$Va=this.mIa.A3(this.ob.Wd());var ie,Sd;({U2d:Sd,mD:ie}=this.LWa.qWd(this.$Va,Lb.imageWidth,
Lb.imageHeight));var wf=this.Jb.Ad(15,void 0,()=>{this.ob.ay();this.ob.Qh();this.Ea.Ed()},()=>{this.Nu.SF=this.tJ;this.ob.selectShape(this.tJ,!0)});try{wf.nc(this.mIa);wf.jd=lb;this.tJ=this.Sk.isa(!0,Td.cid,Td.sid,0,ie.x,ie.y,Sd.width,Sd.height,hc+1,!1);const Pf=this.LWa.BSd(this.Fb.Ld,Sd,ie,Pc.qT);this.tJ.OU=Pf;this.$Va&&(this.tJ.vca=this.$Va.id,this.mIa.LU([this.$Va]));this.tJ.SLb(Ia,this.Ha.EUa?null:Lb.fileName,Lb.fileName);this.tJ.isResizable=!0;this.tJ.d$b=!0;this.tJ.CL=!0;this.tJ.VIa=!0;this.tJ.Fj=
!0;this.tJ.vvb=!!Lb.QGb;this.tJ.gea=Lb.QGb||Lb.FWc;this.mIa.dC(this.tJ)}finally{wf&&wf.dispose()}td.a.E3e()}}static pVj(Ia){return!!Ia&&!!Ia.fileName&&Ia.fileName.toLowerCase().indexOf(".svg")===Ia.fileName.length-4}static uvk(){kd.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(Ae,"PictureActor",null,[352]);var Ye=d(114),Wd=d(210),je=d(719),dg=d(906),nf=d(86);class Cb extends Sys.EventArgs{constructor(Ia,lb){super();this.SRj=Ia;this.t0c=lb}}Object(h.a)(Cb,"TokenRefreshEventArgs",
Sys.EventArgs,[]);class Cf{constructor(Ia,lb,Lb,hc,Pc,Td,ie){this.HFb=0;this.Oc=Ia;this.eBe=lb;this.ju=Lb;this.ia=hc;this.So=Pc;this.zb=Td;this.Ha=ie;this.eBe&&this.eBe.DGc(Object(A.a)(this,this.Z6g,"onTokenRefreshed"))}FUd(Ia){!this.Ha.podTokenRefreshImprovementEnabled&&this.zb.Mta&&this.zb.x_a();const lb=Eb.a.instance.JFa(e.AFrameworkApplication.im),Lb=Eb.a.instance.X_c(e.AFrameworkApplication.im,e.AFrameworkApplication.oia);kd.a.J(41562886,801,lb||Lb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",
lb,Lb,Ia,this.Ha.podTokenRefreshImprovementEnabled,this.HFb);Eb.a.instance.X6a();this.Ha.podTokenRefreshImprovementEnabled&&this.zb.Mta&&this.zb.x_a()}Z6g(Ia,lb){kd.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Lb=Object(xb.a)(Gb,lb)||new Gb(null,null),hc=Lb.tokens,Pc=Lb.errors;Ia="";if(void 0===Pc||null===Pc||0>=Pc.count)for(lb=0;lb<hc.count;lb++)if(hc.ga(lb).Name===Yb.a.T8k){const ie=hc.ga(lb)?hc.ga(lb):null;Ia=ie&&ie.Value&&0<ie.Value.length?ie.Value:"";break}const Td=
Eb.a.instance.JFa(e.AFrameworkApplication.im);kd.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Td,this.Ha.HLe,this.HFb,this.Ha.Zah);if(0<Ia.length&&Td&&this.Ha.HLe&&this.HFb<this.Ha.Zah)kd.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,e.AFrameworkApplication.im,new Date(e.AFrameworkApplication.im),this.Ha.HLe,this.HFb),this.HFb++,this.FUd(2);else if(0<Ia.length&&!Td){kd.a.J(41562890,809,Td?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.im,new Date(e.AFrameworkApplication.im));Wd.App.X6d=e.AFrameworkApplication.Eub=F.a.Ne(Ia);const ie=this.ju.zmc.presentationId.z_e+
"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.im.toString());this.ju.zmc=new dg.a(new je.a(ie));this.Oc.Yeh(new Cb(this.So?this.So.k_:!1,!0))}else{if(Xf.a("CleanPIIFromC49mm")&&Pc)for(let ie of Pc)if(ie.Errors)for(const Sd of ie.Errors)"403"===Sd.Id&&Sd.Details&&Sd.Details.startsWith("<")&&(Sd.Details=null);kd.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
Pc?Ye.c(Pc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.HFb);Pc&&0<=Ye.c(Pc).indexOf("The caller is not authenticated")?(e.AFrameworkApplication.vp(nf.a.Uh(383)),Hc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.vp(nf.a.Uh(380)),Hc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.av&&e.AFrameworkApplication.av.y8();this.Oc.Yeh(new Cb(this.So?
this.So.k_:!1,!1));this.ia.La(Kd.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Lb){kd.a.J(41562894,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Ye.c(Lb))}}dispose(){this.eBe.gRe(Object(A.a)(this,this.Z6g,"onTokenRefreshed"))}}Object(h.a)(Cf,"PPTTokenRefreshManager",null,[599]);var of=d(87),Lg=d(651);class vd{constructor(Ia,lb,Lb,hc,Pc,Td){this.gY=this.zJl=this.PRe=null;this.S3b=this.h3d=!1;this.tbd=
0;this.wmb=td.a.yk("SeamlessFailover");1!==lb&&2!==lb||td.a.ybb();this.Kj=new Date;td.a.LAb=this.startTime;this.CXh=Lb;this.VQa=0;this.qZh=lb;this.fRh=hc;this.mYh=Pc;this.Kxl=Td;this.IVi=!1;this.resultCode=0;this.qbf=!0;if(Ia=e.AFrameworkApplication.gd)this.Uc.Va("Host",Object(xb.a)(String,Ia.Host)),this.Uc.Va("Ring",Object(xb.a)(String,Ia.Ring))}Srh(Ia,lb){this.tbd=window.setTimeout(Ia,lb)}Pql(){this.qbf=!1}dispose(){td.a.Oac=new Date;0<=this.tbd&&(window.clearTimeout(this.tbd),this.tbd=-1)}get FVi(){return this.qbf}get Uc(){return this.wmb}get startTime(){return this.Kj}get oAk(){return this.CXh}get Wxa(){return this.qZh}get VUi(){return this.fRh}get podsCleaningRequestPattern(){return this.mYh}}
Object(h.a)(vd,"SeamlessFailoverState",null,[106]);const Lh=Ia=>{Ia=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ga("361"),Ia);e.AFrameworkApplication.Ke.ZV(Ia,1,null,null,null,0,()=>{kd.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{kd.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var tf;(function(Ia){Ia[Ia.unknown=0]="unknown";Ia[Ia.mouse=
1]="mouse";Ia[Ia.keyboard=2]="keyboard";Ia[Ia.podsPopsUnavailable=4]="podsPopsUnavailable"})(tf||(tf={}));Object(h.b)("RehydrationTrigger",tf);var Ue=d(662),ff=d(976);class Ef{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf,Pf,og,Dh,Bi,Vi,kh,mi,sh,Ng,Wh,Gg,eg,Tj,aj){this.Je=this.Qqe=null;this.pDe=this.$bd=-1;this.zSg=0;this.Heb=Ia;this.la=lb;this.Vb=Lb;this.ia=hc;this.zb=Pc;this.qE=Td;this.Fe=ie;this.Ze=wf;this.pz=Pf;this.Rd=og;this.Mm=Dh;this.ai=Bi;this.mc=Vi;this.GO=kh;this.Ds=Ng;this.fBe=new Date;this.Gv=
mi;this.sH=sh;this.ua=Wh;this.Pb=Gg;this.Jfc=eg;aj.execute(pj=>{this.Qqe=pj});this.f5c=[];this.Efk=this.Pb.Bc("SeamlessFailoverMaxRetryAttempts",0);this.Dfk=this.Pb.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.Ffk=this.Pb.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");kd.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get k_(){return!!this.Je&&this.Je.FVi}get SUf(){return this.zSg}JNd(Ia){if(this.k_){e.AFrameworkApplication.Yz&&(this.ai.voc(Object(A.a)(this,
this.zfa,"onWopiTokenRefreshed")),this.U_b());var lb=0;if(this.la.vzb)this.Je.Uc.PB("Result","abortedOnIrmProtectedFile"),lb=365;else if(this.Je.Uc.PB("Result",Ia),"abortedOnExitApp"!==Ia||this.Ffk)lb=4===this.Je.Wxa?356:357;this.njb(!1,lb,!this.Je.S3b&&"abortedOnRefreshDoc"!==Ia)}}L2e(Ia,lb,Lb){if(this.k_)kd.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.av||(e.AFrameworkApplication.av=kd.a.p1b());this.Rd.disabled=!1;this.Rd.xka=!1;this.Je=
new vd(Ia,lb,this.Fe.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Lb);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Je.Srh(Object(A.a)(this,this.d3g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Je.Uc.Va("PopsAvailable",this.Ze.wA.toString());this.Je.Uc.Va("OrderlyShutdown",Ia.toString());this.Je.Uc.Va("Trigger",tf[lb]);this.Je.Uc.Va("TriggerErrorCode",La.a[Lb]);this.Je.Uc.Va("OldPodsId",this.Je.oAk);this.Je.Uc.Va("OldPopsId",
this.Fe.Kk);kd.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Je.Uc.actionId,this.Je.Uc.kOb());if(1===lb||2===lb)e.AFrameworkApplication.Ug=!1,this.ua.presentation&&this.ua.presentation.tSe();this.ai.LGc(Object(A.a)(this,this.zfa,"onWopiTokenRefreshed"));e.AFrameworkApplication.Yz&&Eb.a.instance.X6a()?(kd.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.im,new Date(e.AFrameworkApplication.im)),this.U_b(),this.$bd=window.setTimeout(Object(A.a)(this,this.ozk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.F$g&&this.Jfc.KXf(!1)):(this.ai.voc(Object(A.a)(this,this.zfa,"onWopiTokenRefreshed")),this.VCh(lb))}}LVi(Ia){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,nf.a.Uh(Ia).toString())){if(!this.f5c.length)return!0;const lb=new Date;let Lb=0;for(let hc=this.f5c.length-
1;0<=hc;hc--){const Pc=this.f5c[hc];if(+lb-+Pc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Pc.Kxl===Ia&&Lb++}if(Lb<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;kd.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",Ia,Lb,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}VCh(Ia){e.AFrameworkApplication.Yz&&(this.ai.voc(Object(A.a)(this,
this.zfa,"onWopiTokenRefreshed")),this.U_b());if(++this.zSg>this.Efk)this.Zae("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Je.Srh(Object(A.a)(this,this.d3g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.fBe>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.Zae("RecoveryStreamExpired",358);else{if(this.Je.h3d&&(this.Je.Uc.PB("Trigger",tf[Ia]+"_GetFileUrlExpired"),this.EJj())){this.Zae("GetFileUrlExpired_NoAzureBackup",
364);return}this.Je.VUi&&this.Dsi();this.ai.qkd(new Ue.a(4===Ia?5:2));this.ai.bPk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===Ia&&(kd.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Fe.Kk),this.GO.Lsb(()=>{},()=>{}));this.Mm.isPaused||this.Mm.pause();this.Je.Uc.Xm("CreatePodsWithRetryST",new Date);this.Je.Uc.Xm("SessionStartTime",this.fBe);this.Sgh()}}Zae(Ia,lb){this.zb.Mta&&this.zb.x_a();this.Je.Uc.PB("Result",Ia);this.njb(!1,lb)}ozk(){this.ai.voc(Object(A.a)(this,
this.zfa,"onWopiTokenRefreshed"));this.U_b();kd.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Je.Uc.Va("WopiTokenRefreshed","TO");e.AFrameworkApplication.vp(nf.a.Uh(382));Hc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.av&&e.AFrameworkApplication.av.y8();this.Je.S3b=!0;this.ia.La(Kd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}zfa(Ia,lb){Ia=
lb.t0c;this.ai.voc(Object(A.a)(this,this.zfa,"onWopiTokenRefreshed"));this.U_b();this.la.F$g&&this.Jfc.KXf(!0);lb=0<e.AFrameworkApplication.im&&(new Date).getTime()>=e.AFrameworkApplication.im-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;kd.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",Ia,(new Date).getTime(),new Date,e.AFrameworkApplication.im,new Date(e.AFrameworkApplication.im));
this.Je.Uc.Va("WopiTokenRefreshed","True");this.Je.Uc.Va("WopiTokenRefreshedSuccessfully",Ia.toString());this.Je.h3d=lb;Ia?this.VCh(this.Je.Wxa):this.Je.S3b=!0}U_b(){-1!==this.pDe&&(window.clearTimeout(this.pDe),this.pDe=-1);-1!==this.$bd&&(window.clearTimeout(this.$bd),this.$bd=-1)}EJj(){const Ia=F.a.qg(this.Pb.Ga("152")||""),lb=!e.AFrameworkApplication.Xg.IsRealEdit&&1!==this.Je.Wxa&&2!==this.Je.Wxa;return".pptx"!==Ia&&".ppsx"!==Ia||lb}Dsi(){try{let Ia=0,lb=0;const Lb={},hc={};this.Ds.F3h(Pc=>{if(-1<
Pc.request.get_url().search(new RegExp(this.Je.podsCleaningRequestPattern,"i")))return this.ACh(Lb,this.I5f(Pc.request.get_url())),Ia++,!0;this.ACh(hc,this.I5f(Pc.request.get_url()));lb++;return!1});kd.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",Ia,Lb,lb,hc)}catch(Ia){kd.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",Ia)}}I5f(Ia){let lb=Ia;const Lb=Ia.indexOf("?");0<
Lb&&(lb=Ia.substr(0,Lb));Ia=lb.lastIndexOf("/");0<Ia&&(lb=lb.substr(Ia+1));return lb}ACh(Ia,lb){Ia[lb]=lb in Ia?Ia[lb]+1:1}d3g(){this.k_&&(this.Je.Uc.PB("Result","Timeout"),this.Je.Uc.Va("TimeoutDuration",(+new Date-+this.Je.startTime).toString()),this.njb(!1,4===this.Je.Wxa?354:355))}njb(Ia,lb=0,Lb=!0){if(this.k_){this.pz.Fib(Object(A.a)(this,this.vfa,"onPodSessionRefreshed"));this.Vb.xi.contentReplicator.roc(Object(A.a)(this,this.p1g,"onAfterReplication"));var hc=+new Date-+this.fBe>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.Yz&&(hc=0<e.AFrameworkApplication.im&&(new Date).getTime()>=e.AFrameworkApplication.im-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&kd.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.im,new Date(e.AFrameworkApplication.im));Ia&&hc&&this.Je.Uc.Va("SkipPopsReason","FileUrlExpired");this.mc.Vqg();var Pc=this.Je.Wxa;this.Je.Uc.Va("IsInEditingMode",
this.mc.Gn.toString());this.Je.Uc.Va("IsPreviousModeEditing",this.mc.z$b.toString());this.Je.Uc.Va("IsLastKnownModeEditing",this.mc.lke.toString());this.Je.Uc.Va("PopSessionEverInitialized",this.Ze.Mlc.toString());this.Je.Uc.Va("ResultErrorCode",La.a[lb]);this.Je.Uc.Va("RefreshPage",Lb.toString());this.Je.Uc.Va("FRehydrationInitiatedPageRefresh",this.Je.S3b.toString());this.Je.IVi=Ia;this.Je.resultCode=lb;this.Je.Pql();this.f5c.push(this.Je);this.Dfk||this.mQc();Ia?(this.ai.xeh(new ff.a(Pc)),this.cDh(hc,
Pc)):(this.mQc(),0!==lb&&(Ia=nf.a.Uh(lb),e.AFrameworkApplication.vp(Ia),Hc.Health.instance.recordQosError(nf.a.lja(Ia),["UnexpectedAppRefresh"],399===lb,!1,!0,Lb,null)),Lb?(e.AFrameworkApplication.av&&e.AFrameworkApplication.av.y8(),this.ia.La(Kd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.ai.xeh(new ff.a(Pc)),this.cDh(hc,Pc)))}}T3b(){return this.Je&&this.Je.Uc?!0:!1}mQc(){this.T3b()&&(kd.a.J(512497874,801,15,"Action Telemetry: {0}",this.Je.Uc.kOb()),this.Je.Uc.finish(!0),
this.Je.dispose(),this.Je=null)}cDh(Ia,lb){!this.mc.zL||Ia||2!==lb&&1!==lb&&4!==lb?(this.T3b()&&this.Je.Uc.Va("PopsRehydrationAttempted","false"),kd.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",Ia,lb),this.IKf(null)):(this.T3b()&&this.Je.Uc.Va("PopsRehydrationAttempted","true"),this.GO.Qfa(4===lb?6:7,Object(A.a)(this,this.IFi,"createPopSessionSucceededCallback"),Object(A.a)(this,this.IKf,"createPopSessionFailedCallback")))}IFi(){this.T3b()&&
(this.LWf(),this.Je.Uc.Va("POPSessionCreated","true"),this.mQc())}IKf(){if(!this.T3b())return!1;this.LWf();this.Je.Uc.Va("POPSessionCreated","false");this.mQc();return!1}LWf(){this.Je.Uc.PB("IsInEditingMode",this.mc.Gn.toString());this.Je.Uc.PB("IsPreviousModeEditing",this.mc.z$b.toString());this.Je.Uc.PB("PopSessionEverInitialized",this.Ze.Mlc.toString())}Mxl(Ia){kd.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.Pb.ka("UserHasValidLicenseForEnterpriseFonts"),this.Pb.ka("PPTOEnterpriseFontsEnabled"));this.Pb.ka("UserHasValidLicenseForEnterpriseFonts")&&this.Pb.ka("PPTOEnterpriseFontsEnabled")&&Lh(Ia)}Sgh(){this.Je.gY=Lg.a();this.zb.Mta||this.zb.stop();let Ia=this.la.restoreRCInCreatePodSessionRequest&&this.ua.ak?this.ua.ak.toString():"";Ia=F.a.replaceAll(Ia,"#","%23");this.Heb.createPodSession(this.Je.gY,"SeamlessFailover_"+this.Je.Wxa,this.Je.VQa,+new Date-+this.Je.startTime,Object(A.a)(this,this.HFi,
"createPodSessionSucceededCallback"),Object(A.a)(this,this.GFi,"createPodSessionFailedCallback"),this.qE,this.Fe.podSessionId,Ia);this.Heb.PEl(this.Je.gY,Object(A.a)(this,this.Mxl,"triggerFontsInstallationCallback"));this.zb.x_a()}HFi(Ia){if(this.k_){td.a.Nsd=[];this.Je.Uc.Va("NewPodsId",this.Je.gY);this.Fe.podSessionId=this.Je.gY;this.Je.Uc.Va("CreatePodsWithRetryResult","true");this.Je.Uc.Va("CreatePodsRetryCount",this.Je.VQa.toString());this.Je.Uc.Va("CreatePodsDuration",(+new Date-+this.Je.startTime).toString());
this.Mm.isPaused&&this.Mm.Mlb();try{this.Mm.lDf()}catch(lb){kd.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",lb)}if(this.la.restoreRCInCreatePodSessionRequest&&Ia&&of.a.plc in Ia&&!F.a.Wa(Ia[of.a.plc])){const lb=Boolean.parse(Ia[of.a.plc]);this.Je.Uc.Va("RCRestoredWhenCreatePodSession",Ia[of.a.plc]);lb?(this.Je.Uc.PB("Result","Success"),this.njb(!0)):(this.Qqe&&this.Qqe.Tsi(),this.Je.Uc.Va("DocRefreshTriggered","true"),Ia={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},Ia.podSessionId=this.Fe.podSessionId,this.Je.S3b=!0,this.ia.La(Kd.a.UJb,2,Ia))}else this.YCh()}}YCh(){this.Vb.xi.contentReplicator.uGc(Object(A.a)(this,this.p1g,"onAfterReplication"));this.Qxl()}Qxl(){const Ia=()=>{this.Je.PRe=new Date;this.Je.Uc.Xm("InboundStartTime",this.Je.PRe);this.Vb.xi.contentReplicator.DF(null,null,null)};kd.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ua.Ba?
this.ua.Ba.sid:0,this.Je.gY);4===this.Je.Wxa&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ua.Ba?(this.sH.GWc&&this.sH.GWc.Lfg(this.ua.Ba.Cb),this.Je.Uc.Xm("ForceInboundSlideStartTime",new Date),this.Gv.w4d(this.ua.Ba,(lb,Lb)=>{kd.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",lb,Lb);this.k_&&(this.Je.Uc.Xm("ForceInboundSlideEndTime",new Date),Ia())},!0,!1)):Ia()}GFi(Ia){if(!this.k_)return!0;const lb=+new Date-
+this.Je.startTime;if(399===Ia)return kd.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,lb),this.Rd.cH(Ia,null),this.njb(!1,Ia,!1),!0;if(this.Je.h3d&&230===Ia)return kd.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,lb),this.MRf("CreatePodSessionFailed_GetFileUrlFailed",
Ia),!0;if(this.Je.VQa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&lb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Lb;(Lb=this.Je).VQa=Lb.VQa+1;kd.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Fe.podSessionId,this.Je.VQa,lb,Ia);this.Sgh();return!0}kd.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Fe.podSessionId,this.Je.VQa,lb,Ia);this.MRf("CreatePodSessionFailed",Ia);return!0}MRf(Ia,lb){this.Je.Uc.Va("CreatePodsWithRetryResult","false");this.Je.Uc.Va("CreatePodsRetryCount",this.Je.VQa.toString());this.Je.Uc.Xm("CreatePodsWithRetryET",new Date);this.Je.Uc.PB("Result",Ia);this.Je.Uc.Va("CreatePodsDuration",(+new Date-+this.Je.startTime).toString());this.njb(!1,lb)}p1g(Ia,lb){this.k_&&(lb.wkg?kd.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
lb.Fgd):(this.Je.Uc.PB("InboundDuration",(+new Date-+this.Je.PRe).toString()),this.Je.Uc.PB("Result","Success"),this.njb(!0)))}vfa(Ia,lb){this.k_&&(this.Je.Uc.Va("WaitPodsRefreshedDuration",(+new Date-+this.Je.zJl).toString()),this.Je.Uc.Va("NewPodsId",lb.gY),this.pz.Fib(Object(A.a)(this,this.vfa,"onPodSessionRefreshed")),this.Mm.isPaused&&this.Mm.Mlb(),this.YCh())}}Object(h.a)(Ef,"PodSeamlessFailoverManager",null,[598]);class wh{constructor(Ia,lb,Lb){this.fva=Ia;this.Xa=Lb}JZ(){}xYb(){}V5a(Ia){Ia&&
(Array.add(Ia,of.a.PJe),Array.add(Ia,of.a.haa),Array.add(Ia,of.a.THb),Array.add(Ia,of.a.WBk),Array.add(Ia,of.a.plc))}vda(Ia,lb){lb?((lb=Ia[of.a.THb])&&lb.toLowerCase()!==(this.Xa.iaa?this.Xa.iaa.toLowerCase():"")&&(kd.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",lb),this.Xa.iaa=lb),this.fva?(Ia=Ia[of.a.PJe])?(this.fva.ccpInfo=Ia,kd.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",Ia.length)):kd.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
kd.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):kd.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(wh,"RehydrationHeaderHandler",null,[630]);class xh{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf,Pf){this.DO=null;this.c5c=!1;this.x$f=og=>{if(og.keyCode===G.a.jvd||og.keyCode===G.a.sMa||og.keyCode===G.a.$lb||og.keyCode>=G.a.qmb&&og.keyCode<=G.a.Pza)return!1;this.rQe(2);return!0};this.mf=Ia;this.Oc=
lb;this.Yec=Lb;this.Lr=hc;this.Zc=Pc;this.Le=Td;this.TSg=wf;this.Ha=ie;this.So=Sd;this.vbd=Pf}init(){this.Oc&&(this.Oc.EPd(Object(A.a)(this,this.sessionExpired,"sessionExpired")),this.Oc.KPa(Object(A.a)(this,this.Gwk,"onRehydrateSession")))}sessionExpired(){this.Fvh(!0);m.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Hc.Health.instance.stopAllHealthTimers()}rQe(Ia){this.Fvh(!1);const lb=e.AFrameworkApplication.Yz||!Xf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");m.ULS.sendTraceTag(544789148,
821,100,"Should refresh token: {0}",lb);lb&&this.vbd&&this.vbd.FUd(0);this.Ha.podsSeamlessFailoverEnabled&&this.So.L2e(!1,Ia,223)}Gwk(){m.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");Hc.Health.instance.resumeAllHealthTimers()}Fvh(Ia){this.c5c!==Ia&&this.mf&&(Ia?(this.DO||(this.DO=this.Le.Ie(),this.DO.id="sessiontimeoutoverlay",this.DO.className="SessionTimeoutOverlay",this.DO.tabIndex=-1,this.ygi(this.DO),this.mf.appendChild(this.DO)),this.c5c=!0,this.TSg(this.DO)):(this.RNf(this.DO),
this.DO&&this.DO.parentNode&&this.DO.parentNode.removeChild(this.DO),this.DO=null,this.c5c=!1))}ygi(Ia){Ia&&(this.Zc.pb(J.a.click,Ia,Object(A.a)(this,this.z$a,"handleClickEvent")),this.Zc.pb(J.a.doubleClick,Ia,Object(A.a)(this,this.z$a,"handleClickEvent")),Xf.a("FixRehydrationOnKeyPress")?this.Lr.addHandler(Ia,J.a.Yf,this.x$f):this.Yec.pb(J.a.Yf,Ia,Object(A.a)(this,this.C$f,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(A.a)(this,this.onVisibilityChange,"onVisibilityChange")))}RNf(Ia){Ia&&
(this.Zc.yb(J.a.click,Ia,Object(A.a)(this,this.z$a,"handleClickEvent")),this.Zc.yb(J.a.doubleClick,Ia,Object(A.a)(this,this.z$a,"handleClickEvent")),Xf.a("FixRehydrationOnKeyPress")?this.Lr.removeHandler(Ia,J.a.Yf,this.x$f):this.Yec.yb(J.a.Yf,Ia,Object(A.a)(this,this.C$f,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(A.a)(this,this.onVisibilityChange,"onVisibilityChange")))}z$a(){this.rQe(1);return!0}C$f(Ia){if(Ia.qc.ctrlKey||Ia.qc.altKey||Ia.qc.shiftKey||Ia.qc.keyCode>=G.a.qmb&&
Ia.qc.keyCode<=G.a.Pza)return!1;this.rQe(2);return!0}onVisibilityChange(){e.AFrameworkApplication.Yz&&!window.document.hidden&&this.vbd&&this.vbd.FUd(1)}dispose(){this.Oc.Qih(Object(A.a)(this,this.sessionExpired,"sessionExpired"));this.DO&&(this.RNf(this.DO),this.DO.parentNode&&this.DO.parentNode.removeChild(this.DO));this.Lr=this.Yec=this.Zc=null;this.c5c=!1;this.TSg=null}}Object(h.a)(xh,"SessionRehydrationController",null,[]);class qd{constructor(){this.Da=null}Zb(Ia){this.Da=Ia||v.a.instance}dispose(){}}
Object(h.a)(qd,"TellMePackage",null,[2,3]);var Hf=d(117),Ag=d(144),He=d(29),af=d(16),yd=d(103),me=d(936);class Ic{constructor(Ia=null,lb=null,Lb=null,hc,Pc=null){this.Uwd=null;this.w7e=!1;this.Ibf=this.Nmb=null;this.o0h=this.nof=this.fNh=this.Jbf=!1;this.Zwc=null;this.pNh=null==lb?e.AFrameworkApplication.Vrb:lb;this.iTh=null==Lb?e.AFrameworkApplication.$Ea:Lb;this.J0h=null==Pc?e.AFrameworkApplication.Tya:Pc;this.xSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");
this.N1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.tfl(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.E1h=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.gac;this.F1h=!yd.a.mx()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.D1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.lRh=!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.DMb;this.G1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.a0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.vXh=this.Vqc||this.Uqc;this.tXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.uXh=this.zke;this.GUh=!!e.AFrameworkApplication.fa&&this.pza&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");
this.URh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.bSh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.RRh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.DUh=
!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.qTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&yd.a.d4();this.Z0h=
e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.eSh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.b0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",
!1);this.x0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.k0h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.OH;this.OUh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",
!1));this.kUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.AUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.LUh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1));this.$Uh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.hNh=this.pza&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.sSh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.C0h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1)||"Word"!==e.AFrameworkApplication.fa.Ga("Application"));this.PNh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.S2h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled"));this.sTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.wTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.BUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.j_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.JMh=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.aSh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.NUh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.$mg;this.uTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.vTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.tTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.IQh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);
this.JQh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.H1h=this.MVj&&(this.dJe||this.eJe||this.Mkc||this.pza&&yd.a.d4()&&!!e.AFrameworkApplication.fa&&(this.JMb||this.kkb||this.lkb||this.mkb||this.KMb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));
this.KMh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.Hia;this.LMh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.gEj(Ia||{});this.fKd="2918242107";this.eKd="1454393937";this.u4a={};this.nPa=[];this.cAi=[yd.a.Ntd]}get application(){return this.Nmb}get Vrb(){return this.pNh}get x6k(){return this.fKd}get w6k(){return this.eKd}get JVf(){return this.Ibf}get MXi(){return this.Jbf}get $Ea(){return this.iTh}get Tya(){return this.J0h}get r6a(){return this.fNh}get Yyj(){return this.xSh}get pul(){return this.N1h}get MVj(){return!0}get dul(){return this.H1h}get Lhl(){return this.nof}tfl(Ia){this.nof=
Ia}get pza(){return this.E1h}get Psc(){return this.F1h}get Osc(){return this.D1h}get FWi(){return this.lRh}get bul(){return this.G1h}get T2e(){return!1}get Mkc(){return this.vXh}get dJe(){return this.tXh}get eJe(){return this.uXh}get hVa(){return!1}get n0c(){return!1}get bme(){return this.GUh}get cYe(){return this.o0h}get JMb(){return!1}get Zil(){return!1}get HZj(){return""}get w8d(){return 2}get mgj(){return 4}get ngj(){return 5}get Hij(){return""}get v9i(){return this.URh}get N6f(){return this.bSh}get Jij(){return 1E3}get Iij(){return 1E-6}get Crl(){return this.Z0h}get V_e(){return!1}get Brl(){return!1}get sTj(){return this.AUh}get W_c(){return!1}get Hle(){return!1}get TPj(){return!1}get SPj(){return!1}get $mg(){return!1}get dng(){return!1}get KVf(){return!1}get EMb(){return!1}get kkb(){return!1}get lkb(){return!1}get mkb(){return!1}get KMb(){return!1}get Vqc(){return this.a0h}get FMb(){return this.b0h}get Uqc(){return!1}get i6d(){return null}get Cle(){return!1}get dqd(){return this.k0h}get l4f(){return 0}get W4i(){return this.RRh}get q7f(){return this.eSh}get QUj(){return this.DUh}get lYc(){return this.qTh}get V3f(){return-3.9}get OH(){return this.x0h}get hac(){return this.OUh}get Fke(){return this.kUh}get ome(){return this.LUh}get VPa(){return this.hNh}get JXj(){return this.$Uh}get tda(){return this.sSh}get Bwh(){return this.C0h}get Xii(){return this.PNh}get fvd(){return this.S2h}get nYc(){return this.sTh}get CIj(){return this.wTh}get KTj(){return this.BUh}get Vnh(){return this.j_h}get Hbi(){return this.JMh}get Aq(){return this.aSh}get iVa(){return this.NUh}get AIj(){return this.uTh}get BIj(){return this.vTh}get zIj(){return this.tTh}get dvf(){return this.KMh}get evf(){return this.LMh}get n3(){return this.IQh}get rOc(){return this.JQh}get Np(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.hb.Oo}get Oo(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Oo}get YPj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Ooa}get iok(){return va.getImageClass("OfficeAssistant_32x32x32")}F9i(){return Promise.reject("GetFindMatchCount method is not overridden")}C0c(Ia){return Array.contains(appChrome.selectors.getVisibleControlIds(),Ia)}Xie(){return!1}get wke(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get gBh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ga("TellMeServiceHelpClassifierModelName"):""}get zke(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get ZVc(){return"NoOpHeaderUi"}get bAi(){return this.Zwc}get parameterData(){return this.u4a}get Rzl(){return this.nPa}LSi(){if(this.Uwd&&!this.w7e&&(this.w7e=!0,this.tpd(this.Uwd),this.Oo)){var Ia=v.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Ia=(new me.a(Ia)).f5d(this.Uwd.Uaa);appChrome.api.dispatch(Ia)}}get Ynh(){return""}tpd(){}RLi(Ia){const lb=
[];for(let Lb=0;Lb<Ia.length;++Lb)Ia[Lb].Hjl?lb.push(new af.a(Ia[Lb].alternate,yd.a.jEh+Lb.toString())):lb.push(new af.a(Ia[Lb].standard,yd.a.Ntd+Lb.toString()));return lb}gEj(Ia){const lb={};for(let Lb in Ia){const hc=Lb,Pc=Ia[Lb];for(let Td in Pc){const ie=Td,Sd=Pc[Td];(lb[ie]||(lb[ie]={}))[hc]=Sd}}this.Zwc=lb}get hBh(){return""}get Rvh(){return!1}}Object(h.a)(Ic,"TellMeApplicationData",null,[674]);class Fe{constructor(Ia,lb=null,Lb=!1){this.standard=Ia;this.alternate=lb;this.Hjl=Lb}}Object(h.a)(Fe,
"TryQuerySet",null,[]);class Uc{constructor(){this.Rif=this.Sif=null}get Fmk(){return this.Rif}ZK(Ia){this.Sif=Ia;return this.HEi(Ia)}Wok(){this.Rif=this.Sif}gbj(Ia){return 8===Ia.type?String.format(CommonUIStrings.l_FindInDocumentText,Ia.KJ):Ia.KJ}K5i(Ia){return Ia.KJ}}Object(h.a)(Uc,"ParameterizedCommand",null,[]);class Uf extends Uc{constructor(Ia){super();this.wUj=Ia}get commandId(){return this.wUj?"FindParameterized":"EditingFind"}get gCk(){return"Find"}HEi(Ia){if(!Ia)return null;const lb=F.a.ue(String.format(ResourceStrings.l_ParamFindInDocTitle,
Ia.KJ));return Ba.a(yd.a.dIi(Ia.value),"1540292897",lb,"Find_16x16x32",null,F.a.ue(Ia.KJ),lb,null,null)}}Object(h.a)(Uf,"FindParameterizedCommand",Uc,[]);var vg=d(124);class Yg extends Ic{constructor(){super(window.TellMeControlMetadataOverrides);this.Nmb="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var Ia=[new Fe(ResourceStrings.l_TellMeTryQuery01,"",!1),new Fe(ResourceStrings.l_TellMeTryQuery02,"",!1),new Fe(ResourceStrings.l_TellMeTryQuery03,"",!1),new Fe(ResourceStrings.l_TellMeTryQuery04,
"",!1),new Fe(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.nPa=this.RLi(Ia)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(Ia=new Uf(Yg.vUj()),this.parameterData[Ia.commandId]=Ia,this.Jbf=!0,this.Ibf=Ia.commandId)}get EKa(){return vg.a.kBf}tpd(Ia){if(Ia){Ia=Ia.Uaa;var lb=e.AFrameworkApplication.fa;Ia["PptTellMe.Animation"]=!lb.ka("TellMeAnimationsTransitionsIsEnabled")||lb.ka("241");Ia["PptTellMe.Transition"]=!lb.ka("TellMeAnimationsTransitionsIsEnabled");Ia["PptTellMe.SelectAll"]=
!lb.ka("TellMeSelectAllResultIsEnabled");Ia["PptTellMe.AnimationNew"]=!lb.ka("241")||!lb.ka("TellMeAnimationsTransitionsIsEnabled");Ia["PptTellMe.Designer"]=!lb.ka("248");lb=lb.ka("TellMeDesktopUpSellIsEnabled");var Lb=e.AFrameworkApplication.NVj;Ia["PptTellMe.WordArtUpSellButton"]=!lb||Lb;Ia["PptTellMe.SpellCheckDictUpSellButton"]=!lb||Lb;Ia["PptTellMe.InsertAudioUpSellButton"]=!lb||Lb;Ia["PptTellMe.InsertChartUpSellButton"]=!lb||Lb;Ia["PptTellMe.WordArtUpSellButtonEnterprise"]=!lb||!Lb;Ia["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=
!lb||!Lb;Ia["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!lb||!Lb;Ia["PptTellMe.InsertChartUpSellButtonEnterprise"]=!lb||!Lb}}get $mg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get dng(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get l4f(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",
2)}get hBh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get V_e(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",!1)}get gBh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get JMb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",
!1)}get zke(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get w8d(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",0)}get Rvh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get n0c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",
!1)}get cVj(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1)}get i6d(){const Ia={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?Ia.FontName="FontPicker":Ia.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(Ia.NewSlide="NewSlideSplit",Ia.ChangeLayout="ChangeLayoutFlyout"):(Ia.NewSlideSplit="NewSlide",Ia.ChangeLayoutFlyout="ChangeLayout");return Ia}get V3f(){var Ia=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold",
"-3.9");Ia=parseFloat(Ia);return isNaN(Ia)?-3.9:Ia}get W_c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get dvf(){return e.AFrameworkApplication.fa.ka("51")}get evf(){return e.AFrameworkApplication.fa.ka("305")}static vUj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.Np}}Object(h.a)(Yg,"PowerPointTellMeApplicationData",Ic,[]);var Cc;(function(Ia){Ia[Ia.none=0]="none";Ia[Ia.waitAll=1]="waitAll";
Ia[Ia.synchronizeFast=2]="synchronizeFast";Ia[Ia.synchronizeSlow=3]="synchronizeSlow"})(Cc||(Cc={}));Object(h.b)("ProviderSynchronizationType",Cc);var Rc;(function(Ia){Ia[Ia.immediate=0]="immediate";Ia[Ia.waitAll=1]="waitAll";Ia[Ia.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Ia[Ia.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Rc||(Rc={}));Object(h.b)("MenuUpdatePolicy",Rc);var Ve=d(170),ob=d(306),Mb=d(156),nc=d(697),Qc=d(171),id=d(987);class ld{constructor(Ia,lb,Lb){this.Fq=
Ia;this.ob=lb;this.ua=Lb}aE(){return"SummarizeSlidesProvider"}nL(){return this.Fq.w8d?this.Fq.w8d===Rc.waitAll?Cc.waitAll:Cc.synchronizeSlow:Cc.none}fB(Ia,lb,Lb,hc,Pc=null){const Td=new Ve.a(Ia);if(this.MF(Ia))if(null!=Pc&&0>Pc.indexOf(ob.a.ActionAI))lb.resultsUpdated(Td);else{this.dCe="SummarizeDeckFromTellMe";if(this.ob&&this.ob.Qe()&&1<this.ob.Qe().length)this.dCe="SummarizeSlidesFromTellMe";else if(this.ua&&2>this.ua.presentation.Qya){lb.resultsUpdated(Td);return}appChrome&&appChrome.selectors.isControlDisabled(this.dCe)?
lb.resultsUpdated(Td):(Ia=new Mb.a(this.dCe,nc.a.SummarizeDeck,"","",id.a.Local),Lb=new Qc.a(ob.a.SummarizeDeck),Lb.ls(Ia),Td.Uq(Lb),window.requestAnimationFrame(()=>{lb.resultsUpdated(Td)}))}else lb.resultsUpdated(Td)}MF(Ia){return!Ia||!Ia.zf||!Ia.zf.trim().length}}Object(h.a)(ld,"SummarizeSlidesProvider",null,[654]);class xd extends qd{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.bBh){var Ia=He.App.Kb.hb.g$d(ab.a.tellMe);Ia.YYc?
xd.Q$g():Ia.DS(Object(A.a)(this,this.j6k,"scriptResource_LoadFinished"));var lb=new Yg;Hf.TellMeActor.instance.initialize(lb,null,null,null,null,null,Object(A.a)(He.App.Kb,He.App.Kb.NXf,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,this.Da.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.Ja("Common.IActionContextProvider"),this.Da.Ja("Common.ISystemInitiatedFeedback"));Hf.TellMeActor.instance.hTk(Ia);Ia=e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("822");
lb.cVj&&Ia&&Hf.TellMeActor.instance.Qy(new ld(lb,this.Da.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),Ag.a.tellMe)}}j6k(){xd.Q$g()}static Q$g(){He.App.Kb.updateCommandUI()}}Object(h.a)(xd,"PowerPointTellMePackage",qd,[]);var ue=d(212);class Rd{constructor(){this.nh=this.U4=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Zb(Ia){this.K=Ia;this.U4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=
this.U4.kEa(4,this.name);this.K.register(wh,"PowerPointWebEditor.RehydrationHeaderHandler").ma().oa(()=>new wh(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(xh,"PowerPointWebEditor.SessionRehydrationController").ma().oa(()=>new xh(this.K.resolve("Box4.IAppFrame").FF(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),lb=>{B.FocusManager.Wr(lb)},e.AFrameworkApplication.Yz?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(598,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().oa(()=>
new Ef(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),
this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ja("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.Yz&&this.K.register(599,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().oa(()=>new Cf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),
this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let Ia=this.nh.zu("resolvechronos1");const lb=this.K.resolve("Common.AFrameworkApplication"),Lb=this.K.resolve("PowerPointWebEditor.IApplicationContext").od;var hc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Pc=this.K.resolve("Common.IActionManagerExtended"),Td=this.K.resolve("PowerPointWebEditor.IFocusManager"),
ie=this.K.resolve("Common.Transaction.ITransactionFactory"),Sd=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),wf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Pf=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),og=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Dh=this.K.resolve("PowerPointWebEditor.PictureContext"),Bi=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Vi=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),
kh=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.nh.Fu(Ia);Ia=this.nh.zu("regactorschronos1");hc=[new Ae(Pc,Pf,Sd,Td,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ie,kh,Dh,wf,e.AFrameworkApplication.PQ,Vi,this.K.resolve("PowerPointWebEditor.IErrorHandler"),hc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Lb.bOj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),Bi,og,Lb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Common.IAppSettingsManager"))];for(var mi of hc)mi.wb(),mi.Ee();this.SDj();this.nh.Fu(Ia);Ia=this.nh.zu("tellme");mi=new xd;mi.Zb(this.K);mi.load(lb);this.nh.Fu(Ia);Lb.pptEditorTimeoutDialogRemovalIsEnabled&&Lb.vg&&(Ia=this.nh.zu("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.nh.Fu(Ia));Lb.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");
e.AFrameworkApplication.Yz&&(Ia=this.nh.zu("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.nh.Fu(Ia));this.H_j()}SDj(){const Ia=this.K.resolve("Common.IActionManagerExtended"),lb=this.K.resolve("PowerPointWebEditor.IFocusManager"),Lb=this.K.resolve("Common.AFrameworkApplication").wq.Kd,hc=this.K.resolve("Common.Transaction.ITransactionFactory"),Pc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Td=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
ie=this.K.resolve("PowerPoint.IPathManager"),Sd=this.K.resolve("PowerPointWebEditor.IPresentationReader"),wf=this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw;wf.loadScript("powerpoint-editor-intl").then(()=>{kd.a.J(512497373,801,50,"Editor script is loaded successfully");wf.loadScript("powerpoint-ribbon-intl").then(()=>{kd.a.J(512497372,801,50,"Ribbon script is loaded successfully");const Pf=[];Pf.push(new nd(Ia,lb,Td,hc,Lb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Sd,Pc,ie));for(const og of Pf)og.wb(),og.Ee()}).catch(()=>{kd.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{kd.a.J(512497370,801,10,"Failed to load Editor script")})}H_j(){kd.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.chronos2",()=>{const Ia=this.K.resolve("PowerPointWebEditor.ISessionState");Ia&&Ia.R5("Chronos2DownloadFinished")},()=>d.e(8).then(d.bind(null,1236)))}dispose(){const Ia=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");Ia.pptEditorTimeoutDialogRemovalIsEnabled&&Ia.vg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.Yz&&Ia.vg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Ug&&ac.a.eg?kd.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):n.a.instance.Dc(ue.a(new Rd,4))}}Object(h.a)(Rd,"Chronos1Package",null,
[2,3]);var ce=d(648),Ne=d(141),oe=d(582),Yd=d(58),Id=d(48);class zf{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf){this.type="FormatPictureTaskPaneProps";this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.disabled=!1;this.onChange=null;this.emptyValueFields=0;const Pf=Object(xb.a)(Object,mc.e().numberFormatInfo);if(!Pf)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=Pf;this.width=Ia;this.height=lb;this.top=hc;this.left=
Lb;this.brightness=Pc;this.contrast=Td;this.saturation=ie;this.disabled=Sd;this.emptyValueFields=wf}}Object(h.a)(zf,"FormatPictureTaskPaneProps",null,[]);class od{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf,Pf,og,Dh){this.Ncb=!0;this.rug=this.Zsg=this.OVg=this.gGg=this.l0=this.L0=0;this.pSg=100;this.LXa=this.Eb=this.Xwg=!1;Dh.loadScript("powerpoint-editor-intl").then(()=>{this.LXa=!0}).catch(Bi=>{kd.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+Bi.toString())});this.ob=Ia;this.Rb=lb;this.ia=
Lb;this.Ea=hc;this.Pg=Pc;this.ua=Td;this.Fb=ie;this.Pi=Sd;this.E9=wf;this.fc=Pf;this.Lc=og;this.Pg.SBa(Object(A.a)(this,this.ued,"onChangeRenderFormatPicturePane"));this.Rb.PK(Object(A.a)(this,this.Su,"onAppFrameModeSwitched"));this.Lc.HPa(Object(A.a)(this,this.ued,"onChangeRenderFormatPicturePane"))}dispose(){this.Pg.j_a(Object(A.a)(this,this.ued,"onChangeRenderFormatPicturePane"));this.Rb.yY(Object(A.a)(this,this.Su,"onAppFrameModeSwitched"));this.Lc.Eib(Object(A.a)(this,this.ued,"onChangeRenderFormatPicturePane"))}Ee(){}wb(){this.ia.ra(Kd.a.AJb,
ve.a.application,Object(A.a)(this,this.AJb,"queryShowHideReactPictureCropPane"),96);this.ia.ra(Kd.a.rrc,ve.a.application,Object(A.a)(this,this.rrc,"showHideReactPictureCropPane"),4);this.ia.ra(Kd.a.lPb,ve.a.application,Object(A.a)(this,this.lPb,"updatePictureCropPane"),4)}AJb(Ia,lb,Lb,hc,Pc){(Ia=Object(xb.a)(Ua.a,Pc))&&Ia.Mf(this.Eb);return 32}rrc(Ia,lb,Lb){if(!this.LXa)return 8;if(1===Lb)return 32;lb=this.ua.presentation;return this.ua.Ba&&lb&&!this.fc.$c(lb)?dd.b("ShowHideReactPictureCropPane:",
this.Eb.toString(),Ia,()=>{if(this.Eb=!this.Eb){if(this.Ql(),Xf.a("CropControlEnableOnDisplayingFormatPicturePane")){const hc=this.ob.Jp();(null===hc||void 0===hc?0:hc.gy)||this.ia.processAction(Kd.a.OYd,2)}}else this.Cr();return 32}):16}lPb(Ia,lb,Lb){if(!this.Eb)return 8;2===Lb&&this.Ql(!0);return 32}Ql(Ia=!1){var lb=this.aUc();lb=this.vC(lb);const Lb=Object.assign(new ce.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:lb,onOpen:()=>{},onClose:()=>{this.Eb=
!1},isModernPane:!0});Ne.UISurfaces.zr().then(hc=>{Ia?hc.updateTaskPane(Id.a.EJa,Lb):hc.showTaskPane(Id.a.EJa,Lb);return null}).catch(hc=>{kd.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+hc.toString())})}Cr(){Ne.UISurfaces.zr().then(Ia=>{Ia.hideTaskPane(Id.a.EJa,2);return null}).catch(Ia=>{kd.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+Ia.toString())})}vC(Ia){if(Ia){const lb=Ia.l6d(),Lb=this.Fb.Ld;this.l0=oe.a.Ov(Lb.rf(this.Pi.DM(Yd.a.nm(lb.ga(0),lb.ga(3)),
Ia.zoom),1));this.L0=oe.a.Ov(Lb.rf(this.Pi.DM(Yd.a.nm(lb.ga(0),lb.ga(1)),Ia.zoom),0));this.gGg=oe.a.Ov(Lb.rf(this.Pi.DM(lb.ga(0).x,Ia.zoom),0));this.OVg=oe.a.Ov(Lb.rf(this.Pi.DM(lb.ga(0).y,Ia.zoom),1));this.Ncb=!1;this.Xwg=!0}else this.Ncb=!0;Ia=new zf(this.L0,this.l0,this.gGg,this.OVg,this.Zsg,this.rug,this.pSg,this.Ncb,this.Xwg?0:15);Ia.onChange=Object(A.a)(this,this.kxa,"onPropertyChange");return Ia}aUc(){const Ia=this.ob.Jp();return Ia&&Ia.gy&&Ia.isConnected?this.E9.IF(Ia):null}kxa(Ia,lb){const Lb=
{};Lb.Number=Ia;switch(lb){case 0:this.ia.La(Kd.a.Mud,2,Lb);break;case 1:this.ia.La(Kd.a.Jud,2,Lb);break;case 2:this.ia.La(Kd.a.Kud,2,Lb);break;case 3:this.ia.La(Kd.a.Lud,2,Lb);break;case 4:this.ia.La(Kd.a.$Fh,2,Lb);this.Zsg=Ia;break;case 5:this.ia.La(Kd.a.lGh,2,Lb);this.rug=Ia;break;case 6:this.ia.La(Kd.a.DHh,2,Lb),this.pSg=Ia}this.Ql(!0)}ued(){this.Eb&&this.Ql(!0)}Su(Ia){1===Ia.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Ea.Cj(Id.a.EJa,this.Eb))}}Object(h.a)(od,"FormatPicturePaneActor",null,[]);var gf=
d(855);class Lf{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf,Pf,og,Dh,Bi,Vi,kh,mi,sh,Ng){this.KCb=!1;if(!kh)throw Error.argumentNull("shapeReader");if(mi&&!sh)throw Error.argumentNull("shapeSVGDependencyLoader");if(!Ng)throw Error.argumentNull("businessBarController");this.ia=Ia;this.pa=lb;this.Jb=Lb;this.vi=hc;this.fc=Pc;this.$we=Td;this.uBg=ie;this.Po=Sd;this.Fb=wf;this.ua=Pf;this.Pi=og;this.E9=Dh;this.UL=Bi;this.o0=Vi;this.Fa=kh;this.vma=mi;this.PXa=sh;this.gl=Ng}wb(){this.ia.ra(Kd.a.OYd,V.a.application,
Object(A.a)(this,this.r7b,"handlePictureCropEvent"),4);this.uBg?(this.ia.ra(Kd.a.MYd,V.a.application,Object(A.a)(this,this.$9f,"handleCropSplitButton"),4),this.ia.ra(Kd.a.NYd,V.a.application,Object(A.a)(this,this.$9f,"handleCropSplitButton"),4)):(this.ia.ra(Kd.a.MYd,V.a.application,Object(A.a)(this,this.r7b,"handlePictureCropEvent"),4),this.ia.ra(Kd.a.NYd,V.a.application,Object(A.a)(this,this.r7b,"handlePictureCropEvent"),4));this.ia.ra(Kd.a.TNe,V.a.application,Object(A.a)(this,this.XLk,"queryIsActive"),
101);this.ia.ra(Kd.a.Npc,V.a.application,Object(A.a)(this,this.awj,"handleSendCropInfo"),4);this.ia.ra(Kd.a.x$g,V.a.application,Object(A.a)(this,this.pbe,"handlePictureCropToShapeEvent"),4);this.ia.ra(Kd.a.w$g,V.a.application,Object(A.a)(this,this.pbe,"handlePictureCropToShapeEvent"),4);this.ia.ra(Kd.a.fJb,V.a.application,Object(A.a)(this,this.pjd,"queryPictureCropBounding"),100);this.ia.ra(Kd.a.hJb,V.a.application,Object(A.a)(this,this.pjd,"queryPictureCropBounding"),100);this.ia.ra(Kd.a.gJb,V.a.application,
Object(A.a)(this,this.pjd,"queryPictureCropBounding"),100);this.ia.ra(Kd.a.bnc,V.a.application,Object(A.a)(this,this.pjd,"queryPictureCropBounding"),100);this.ia.ra(Kd.a.Jud,V.a.application,Object(A.a)(this,this.Iud,"updatePictureCropBounding"),4);this.ia.ra(Kd.a.Mud,V.a.application,Object(A.a)(this,this.Iud,"updatePictureCropBounding"),4);this.ia.ra(Kd.a.Kud,V.a.application,Object(A.a)(this,this.Iud,"updatePictureCropBounding"),4);this.ia.ra(Kd.a.Lud,V.a.application,Object(A.a)(this,this.Iud,"updatePictureCropBounding"),
4)}$9f(Ia,lb,Lb,hc,Pc){return 1===Lb?32===this.pbe(Ia,lb,Lb,hc,Pc)||32===this.r7b(Ia,lb,Lb,hc,Pc)?32:8:this.r7b(Ia,lb,Lb,hc,Pc)}awj(Ia,lb,Lb,hc,Pc){if(!Pc)return kd.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;lb=Pc.pictCropperInfo;Pc=Pc.shapeNode;if(!Pc||!Pc.pictureCropInfo)return kd.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Lb)return 32;if(Lb=td.a.Ib)Lb.actionName="EndCropPicture",Lb.Nj=!1,Lb.Ur=!0;Lb=this.Jb.Ad(15);try{Lb.nc(Pc),Lb.jd=
Ia,Pc.Blc=lb}finally{Lb&&Lb.dispose()}return 32}pbe(Ia,lb,Lb,hc,Pc){if(!this.uBg||this.fc.$c(this.pa.tk()))return 8;lb=this.pa.tg();if(!lb||!lb.length)return 8;const Td=[];for(var ie of lb)ie&&Td.push(ie);if(!Td.length)return 8;for(const Pf of Td)if(Pf.isLocal||this.UL.WW(Pf)||!this.GRj(Pf))return 8;if(1===Lb)return 32;kd.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Sd=Pc?Pc.SourceControlId:"";ie=0;Lb=Sd.split("_");if(3===Lb.length)ie=Number.parseInvariant(Lb[2]);
else return kd.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",Sd),16;Lb=window.performance.now();Pc=new gf.a;Pc.TargetShapeTypeAsInt=ie;ie=this.Jb.Ad(15,void 0,()=>{for(const Pf of Td)if(Pf.gy){const og=this.$k(Pf);og&&og.q1(!1)}kd.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Sd)});try{ie.nc(Td[0]);ie.jd=Ia;for(var wf of Td)wf.Clc=Pc}finally{ie&&ie.dispose()}Ia=window.performance.now();
if(wf=td.a.Ib)wf.actionName="PictureCropToShape",wf.Va("PictureCropShapeType",Pc.TargetShapeTypeAsInt.toString()),wf.Va("PictureCropToShapeDuration",(Ia-Lb).toString()),td.a.Ofa(wf);kd.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Pc.TargetShapeTypeAsInt);return 32}r7b(Ia,lb,Lb){if(!this.$we||this.fc.$c(this.pa.tk()))return 16;if(this.vma&&!this.PXa.Cjg)return kd.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),
8;lb=this.pa.Wd();const hc=this.pa.e7d(lb);if(1!==lb.length)return Xf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Lb&&this.ePf(),8;if(!hc)return 8;if(this.Fa.ex(hc).length)return Xf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Lb&&this.ePf(),8;if(!this.Wke(hc))return 8;if(1===Lb)return 32;if(hc.isLocal||this.UL.WW(hc))return 16;if(hc.gy){Ia=this.$k(hc);if(!Ia)return 8;Ia.q1(!1);hc.pictureCropInfo=null;He.App.Kb.updateCommandUI();this.ia.processAction(Kd.a.lPb,2);return 32}this.pa.ij();
const Pc=this.ua.Ba;this.fc.blockContent(Pc,Ia);const Td=td.a.Ib;Td&&(Td.actionName="BeginCropPicture",Td.Nj=!1,Td.Ur=!0);this.vi.S4f(hc.get_sid(),hc.get_cid(),hc.get_shapeId(),ie=>{td.a.AF(Td,()=>{this.Ftk(hc,Pc,ie)})},()=>this.Etk(hc,Pc),!0);return 32}XLk(Ia,lb,Lb,hc,Pc){if(!Object(Rb.a)(Ua.a,Pc))return 8;Ia=this.pa.Jp();Pc.Mf(Ia?Ia.gy:!1);return 32}aUc(){const Ia=this.pa.Jp();return Ia&&Ia.gy&&Ia.isConnected?this.E9.IF(Ia):null}$k(Ia){return Ia?Object(xb.a)(117,Ia.sc(this.Fb.Ma)):null}ePf(){this.gl.bL(26)}pjd(Ia,
lb,Lb,hc,Pc){if(!this.$we||!Pc)return 16;lb=this.aUc();if(!lb)return 16;Lb=lb.l6d();hc=this.Fb.Ld;Ia=Ia===Kd.a.fJb?hc.rf(this.Pi.DM(Yd.a.nm(Lb.ga(0),Lb.ga(3)),lb.zoom),1):Ia===Kd.a.hJb?hc.rf(this.Pi.DM(Yd.a.nm(Lb.ga(0),Lb.ga(1)),lb.zoom),0):Ia===Kd.a.gJb?hc.rf(this.Pi.DM(Lb.ga(0).x,lb.zoom),0):hc.rf(this.Pi.DM(Lb.ga(0).y,lb.zoom),1);Pc=Pc.queryResult;null!==Pc&&(Pc.Kaa=parseFloat(oe.a.Ov(Ia).toFixed(2)).toString());return 32}Iud(Ia,lb,Lb,hc,Pc){if(!this.$we||this.vma&&!this.PXa.Cjg)return 16;lb=this.aUc();
if(1===Lb)return lb?32:16;if(!lb||!Pc)return 16;if(2===Lb){Lb=!1;hc=lb.l6d().copy();Pc=oe.a.OW(Pc.Number);const Td=Yd.a.nm(hc.ga(0),hc.ga(1)),ie=Yd.a.nm(hc.ga(0),hc.ga(3)),Sd=this.Fb.Ld;Ia===Kd.a.Jud?(Pc=this.Pi.GM(Sd.Pe(Pc,1),lb.zoom),Ia=Pc-ie,hc.ga(2).nM(0,Ia),hc.ga(3).nM(0,Ia)):Ia===Kd.a.Mud?(Pc=this.Pi.GM(Sd.Pe(Pc,0),lb.zoom),Ia=Pc-Td,hc.ga(1).nM(Ia,0),hc.ga(2).nM(Ia,0)):Ia===Kd.a.Kud?(Lb=!0,Pc=this.Pi.GM(Sd.Pe(Pc,0),lb.zoom),Ia=Pc-hc.ga(0).x,hc.move(Ia,0)):Ia===Kd.a.Lud&&(Lb=!0,Pc=this.Pi.GM(Sd.Pe(Pc,
1),lb.zoom),Ia=Pc-hc.ga(0).y,hc.move(0,Ia));lb.ZCl(hc,Lb)}return 32}GRj(Ia){let lb=[];Ia.Jf?lb=this.Fa.ex(Ia):Ia.Ng&&(lb=this.Fa.ex(Ia.ys()));if(lb.length){for(const Lb of lb)if(!this.Wke(Lb))return!1;return!0}return this.Wke(Ia)}Wke(Ia){const lb=this.Po.e0e&&!Ia.isGif&&(Ia.Fj||1===Ia.mediaType)&&!Ia.get_isSVGBlipFilled();return this.o0?lb&&!Ia.GGb:lb}Etk(Ia,lb){this.fc.fK(lb);if(!this.isActive||!Ia.isConnected)return!0;this.isActive=!1;Ia.pictureCropInfo=null;kd.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");
return!1}Ftk(Ia,lb,Lb){this.fc.fK(lb);if(Ia.isConnected)if(lb=td.a.Ib,td.a.AF(lb,()=>{this.ia.processAction(Kd.a.o7a,2)}),this.UL.WW(Ia))kd.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var hc=Ia.mg(this.Fb.Ma);if(hc){var Pc=new Date;Ia.pictureCropInfo=JSON.parse(Lb.PictureCropInfoStr);this.E9.ZG(Ia).Qpl();Ia=new Date;lb&&(lb.Xm("ParseCropInfoStart",Pc),lb.Xm("ParseCropInfoEnd",Ia),td.a.Ofa(lb));hc.FA();this.ia.processAction(Kd.a.lPb,2)}}}get isActive(){return this.KCb}set isActive(Ia){this.KCb=
Ia}}Object(h.a)(Lf,"PictureCropActor",null,[]);var ke=d(1208),vf=d(195),ng=d(187),wg=d(218),bf=d(132),Pd=d(167),Md=d(330),Mh=d(854),Bh=d(626),Vh=d(49),Jg=d(68),Of=d(723),bi=d(116),ij=d(208),ig=d(169),oj=d(887),fh=d(329),Qd=d(207),$e=d(188),yh=d(189),Ti=d(286);class fe{constructor(Ia,lb,Lb,hc,Pc,Td,ie,Sd,wf,Pf,og,Dh,Bi,Vi){this.Eb=!0;this.Hk=!1;this.Hn=[];this.C4=this.iB=this.tX=this.AH=this.pJ=this.xb=null;this.WC=Array(8);this.zva=this.tn=this.Iv=null;this.rU=this.vd=1;this.ABe=new Yd.a(0,0);this.In=
new vf.a;this.D0=new ng.a;this.Fhc=new Yd.a(0,0);this.wfb=0;this.mu=new ng.a;this.Ova=new Yd.a(0,0);this.oma=new Yd.a(0,0);this.Zhc=this.VWa=!1;this.bfc=new Yd.a(0,0);this.J$=this.j$=null;this.lwg=new eb.a;this.nu=null;if(!hc)throw Error.argumentNull("clickInputManager");if(!Ia)throw Error.argumentNull("shapeNode");if(og&&!Dh)throw Error.argumentNull("transformFactory");if(og&&!Bi)throw Error.argumentNull("presReader");this.ta=Ia;this.Fa=lb;this.jc=Lb;this.Zc=hc;this.ia=Pc;this.YC=Td;this.he=ie;this.K9=
Sd;this.Jfk=wf;this.$va=Pf;this.vma=og;this.xk=Dh;this.t8j=Vi}Jm(Ia){this.xb=new $e.a;this.xb.Yj(1);this.xb.Qd(!1);this.xb.Aoa(Jg.a.nrl);Ia.appendChild(this.xb.viewport);this.pJ=new Of.a(!1,this.vma);this.xb.appendChild(this.pJ);this.AH=new Of.a(!1,this.vma);this.xb.appendChild(this.AH);this.AH.Yj(1);this.tX=new ig.a;this.tX.Yu(Ge.a.A1);this.tX.mr(Ge.a.RE);this.tX.OE(bi.a.none);this.tX.Yj(1);this.xb.appendChild(this.tX);this.C4=new ig.a;this.C4.Yj(1);this.C4.nl(Jg.a.Zya);this.C4.Aoa("ShapeMoveHandle");
this.C4.OE(bi.a.none);this.xb.appendChild(this.C4);this.iB=new ij.a;this.y1b(this.iB);this.xb.appendChild(this.iB);this.xb.viewport.xa.setAttribute("class",Jg.a.Glc);this.xb.Qd(!1);this.Zc.pb(J.a.click,this.C4.xa,Object(A.a)(this,this.Idd,"noOpHandler"));this.Zc.pb(J.a.click,this.tX.xa,Object(A.a)(this,this.Idd,"noOpHandler"))}y1b(Ia){for(let hc=0;8>hc;++hc){var lb="cropHandle"+hc;const Pc=new ij.a;Pc.xa.id=lb;if(ac.a.BLa){var Lb=new fh.a;Lb.xa.id=lb;Lb.setVisibility(!1);Lb.setPosition(-10,-10);Lb.lh(20,
20);Pc.appendChild(Lb)}Lb=new Pd.a(hc);lb=Lb.t9b()?this.HCi(Lb,lb):this.JGi(Lb,lb);Pc.appendChild(lb);Pc.Yj(1);this.WC[hc]=Pc;Ia.appendChild(Pc)}}bde(Ia){for(let lb=0;8>lb;++lb)if(this.WC[lb].xa.id===Ia.id)return new Pd.a(lb);return null}dTj(Ia){return Ia.id.startsWith("cropHandle")}dispose(){this.K9();this.Hk=!0;this.Eb=!1;this.xb&&this.xb.zq();this.xb=null;this.C4&&this.Zc.yb(J.a.click,this.C4.xa,Object(A.a)(this,this.Idd,"noOpHandler"));this.C4=null;this.tX&&this.Zc.yb(J.a.click,this.tX.xa,Object(A.a)(this,
this.Idd,"noOpHandler"));this.iB=this.tX=null;this.WC&&Array.clear(this.WC);this.j$=this.J$=this.WC=null;this.bfc=new Yd.a(0,0)}Tpd(Ia,lb,Lb,hc){const Pc=this.d$d(),Td=Ia-Pc.x+this.oma.x+Lb,ie=lb-Pc.y+this.oma.y+hc;return isNaN(Td)||isNaN(ie)?(kd.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",Ia,Pc.x,this.oma.x,Lb,lb,Pc.y,this.oma.y,
hc,this.vd),new Yd.a(0,0)):new Yd.a(Td,ie)}setPosition(Ia,lb){this.VWa&&this.ta.pictureCropInfo&&(this.Ova=Ia=new Yd.a(Ia/this.vd,lb/this.vd),this.$va?(this.j$&&this.pJ&&(lb=this.Tpd(this.j$.Position.X,this.j$.Position.Y,Ia.x,Ia.y),this.pJ.setPosition(lb.x,lb.y)),this.J$&&this.AH&&this.AH.image&&(Ia=this.Tpd(this.J$.Position.X,this.J$.Position.Y,Ia.x,Ia.y),this.AH.image.setPosition(Ia.x,Ia.y))):((lb=this.ta.pictureCropInfo.MaskViewElem)&&this.pJ&&(lb=this.Tpd(lb.Position.X,lb.Position.Y,Ia.x,Ia.y),
this.pJ.setPosition(lb.x,lb.y)),(lb=this.ta.pictureCropInfo.TextureViewElem)&&this.AH&&this.AH.image&&(Ia=this.Tpd(lb.Position.X,lb.Position.Y,Ia.x,Ia.y),this.AH.image.setPosition(Ia.x,Ia.y))),this.xb.Rl())}zol(Ia,lb){const Lb=new Yd.a(this.Fa.YA(this.ta,this.YC).x/this.vd,this.Fa.YA(this.ta,this.YC).y/this.vd),hc=new Yd.a(this.oma.x+this.Ova.x,this.oma.y+this.Ova.y);if(this.$va)this.j$&&this.pJ&&this.pJ.setPosition(this.j$.Position.X-Lb.x+hc.x+Ia/this.vd,this.j$.Position.Y-Lb.y+hc.y+lb/this.vd),
this.J$&&this.AH&&this.AH.image.setPosition(this.J$.Position.X-Lb.x+hc.x+Ia/this.vd,this.J$.Position.Y-Lb.y+hc.y+lb/this.vd);else{var Pc=this.ta.pictureCropInfo.MaskViewElem;Pc&&this.pJ.setPosition(Pc.Position.X-Lb.x+hc.x+Ia/this.vd,Pc.Position.Y-Lb.y+hc.y+lb/this.vd);(Pc=this.ta.pictureCropInfo.TextureViewElem)&&this.AH.image.setPosition(Pc.Position.X-Lb.x+hc.x+Ia/this.vd,Pc.Position.Y-Lb.y+hc.y+lb/this.vd)}this.xb.Rl()}Aol(Ia,lb){lb.Ij(1/this.rU);this.gsh(Ia,vf.a.add(this.SYa,lb))}resize(Ia,lb){lb.Ij(1/
this.rU);this.gsh(Ia,lb)}gsh(Ia,lb){Ia=this.VSd(Ia,lb);this.Qq(Ia);this.setOffsets(lb)}d$d(){const Ia=this.Fa.YA(this.ta,this.YC);return new Yd.a(Ia.x/this.vd,Ia.y/this.vd)}PHh(){this.ta.gy&&(this.rU=this.jc.kg(this.ta).oq/this.ABe.x)}Qpl(){const Ia=this.jc.kg(this.ta);this.ABe.update(Ia.oq,Ia.Vk)}Ij(Ia){this.vd=Ia;this.xb.Ij(this.vd);Ia=new ng.a;Ia.lca(1/this.vd,1/this.vd);this.iB.PE(Ia,Qd.a.tca);this.t8j?this.uY(!1):this.uY(!0)}get zoom(){return this.vd/this.rU}l6d(){this.PHh();this.Iv||(this.Iv=
this.ta.fp);var Ia=Yd.a.nm(this.Iv.ga(0),this.Iv.ga(1));const lb=Yd.a.nm(this.Iv.ga(0),this.Iv.ga(3)),Lb=this.Iv.Wf(),hc=new bf.a(new Yd.a(0,0),new Yd.a(Ia,0),new Yd.a(Ia,lb),new Yd.a(0,lb));hc.move(Lb.x-Ia/2,Lb.y-lb/2);Ia=this.d$d();hc.move(Ia.x,Ia.y);hc.scale(this.rU,this.rU);return hc}ZCl(Ia,lb){Ia=Ia.copy();Ia.scale(1/this.rU,1/this.rU);var Lb=this.d$d();Ia.move(-1*Lb.x,-1*Lb.y);Lb=Ia.Wf();const hc=new ng.a;lb?hc.L7(this.ta.get_shapeRotation(),Lb):hc.L7(this.ta.get_shapeRotation(),this.Iv.ga(0));
hc.El(Ia);lb||Ia.move(this.Iv.ga(0).x-Ia.ga(0).x,this.Iv.ga(0).y-Ia.ga(0).y);this.Iv=Ia;this.tX.zt(this.Iv.points);lb=this.AH.clipPath;Xf.a("SVGCreationOnChangesFromFormatPane")&&this.vma&&lb?(lb.f0b=this.RLc(Ia),this.oGc(Ia.ga(0))):lb&&lb.e7a&&lb.e7a.Z4e(this.Iv.points);this.Zhc=!0;this.uY(!0);this.xb.Rl()}setZIndex(Ia){this.xb.LB(Ia+2*Md.a.jba)}setOffsets(Ia){this.Iv||(this.Iv=this.ta.fp);this.jci(Ia);this.In=Ia;var lb=this.iB.BBb;Ia=new Yd.a(lb[0].x/this.vd,lb[0].y/this.vd);var Lb=new Yd.a(lb[2].x/
this.vd,lb[2].y/this.vd);const hc=new Yd.a(lb[4].x/this.vd,lb[4].y/this.vd);lb=new Yd.a(lb[6].x/this.vd,lb[6].y/this.vd);Ia=new bf.a(Ia,Lb,hc,lb);this.tX.zt(this.Iv.points);Lb=this.AH.clipPath;this.vma&&Lb?(this.oGc(Yd.a.bV(Ia.points[this.wfb],this.Fhc)),Lb.f0b=this.RLc(Ia)):Lb&&Lb.e7a&&Lb.e7a.Z4e(Ia.points);this.xb.Rl()}jci(Ia){var lb=this.Iv,Lb=Yd.a.nm(lb.ga(0),lb.ga(1));lb=Yd.a.nm(lb.ga(0),lb.ga(3));Ia.bottom-Ia.top<-1*lb&&(lb+=Ia.bottom-Ia.top,Ia.top+=lb,Ia.bottom-=lb);Ia.right-Ia.left<-1*Lb&&
(Lb+=Ia.right-Ia.left,Ia.left+=Lb,Ia.right-=Lb)}Qq(Ia){this.D0=Ia;this.tX.PE(Ia,Qd.a.tca);this.uY(!0)}Xu(Ia){this.mu=Ia;this.xb.PE(Ia,Qd.a.Fsb);this.xb.Rl()}Ty(){Array.clear(this.Hn)}cE(Ia){return this.dTj(Ia)?this.bde(Ia):null}GB(Ia){const lb=[];var Lb=this.ta.pictureCropInfo;if(this.ta.gy){const hc=this.jc.kg(this.ta);if(Lb.MaskViewElem){let Pc=Ti.a.PLc(6,hc.oq,hc.Vk);Array.add(lb,Pc)}Lb.TextureViewElem&&(Lb=Ti.a.PLc(7,hc.oq,hc.Vk),Array.add(lb,Lb));Array.add(this.Hn,Ia)}else this.Eb=!1,this.xb.Qd(!1);
return lb}lD(){}tGl(){this.bfc.x!==this.pJ.x&&this.bfc.y!==this.pJ.y&&(kd.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.j$.Position.X=this.pJ.x+this.Fa.YA(this.ta,this.YC).x/this.vd,this.j$.Position.Y=this.pJ.y+this.Fa.YA(this.ta,this.YC).y/this.vd,this.J$.Position.X=this.AH.image.x+this.Fa.YA(this.ta,this.YC).x/this.vd,this.J$.Position.Y=this.AH.image.y+this.Fa.YA(this.ta,this.YC).y/this.vd,this.oma.update(0,
0))}YZb(Ia,lb){const Lb=this.xk.YLc();this.ta.get_isVerticallyFlipped()&&(Lb.lca(1,-1),Lb.eC(0,2*lb._y));this.ta.get_isHorizontallyFlipped()&&(Lb.lca(-1,1),Lb.eC(2*lb._x,0));Lb.L7(Ia,lb);return Lb}d7f(){return this.ta.get_isVerticallyFlipped()&&this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}oGc(Ia){const lb=new ng.a;lb.eC(Ia._x,Ia._y);this.AH.clipPath.PE(lb,Qd.a.tca)}RLc(Ia){kd.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");
var lb=this.ta.get_shapeRotation();this.xk.Ica(-lb,Ia.Wf()).El(Ia);this.nu||(this.nu=svgShape.FactoryGlobal.createShape());this.nu.setSVGRoot(this.xb.xa,!1);this.ta.RK?this.nu.setShapeType(this.ta.RK):(this.nu.setShapeType(4),kd.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.nu.setOffsets(this.ta.get_xPersisted()+ke.a.tY(Ia.ga(0).x/this.rU,0),this.ta.get_yPersisted()+ke.a.tY(Ia.ga(0).y/this.rU,1));this.nu.setExtents(ke.a.tY(Ia.ga(1).x-Ia.ga(0).x,0),ke.a.tY(Ia.ga(2).y-Ia.ga(1).y,1));
var Lb=svgShape.FactoryGlobal.getConvertor().getPath(this.nu,!1,this.rU,this.rU);if(!Lb||!Lb.length)throw kd.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");Ia=Array(Lb.length);lb=0;for(const hc of Lb)Lb=new ig.a,Lb.r1(hc),Lb.xa.setAttribute(bi.a.DOb,this.mu.rlb()),Ia[lb++]=Lb;kd.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return Ia}draw(Ia,lb){if(Array.contains(this.Hn,
Ia)){Array.remove(this.Hn,Ia);if(this.ta.pictureCropInfo&&!this.VWa){if(this.ta.pictureCropInfo.MaskViewElem){Ia=this.ta.pictureCropInfo.MaskViewElem;var Lb=Ia.Clip,hc=this.jc.kg(this.ta);hc=Ti.a.PLc(6,hc.oq,hc.Vk);if(hc=lb[hc.toString()])this.pJ.Hal(hc.Base64Data,Ia.Id.toString(),Lb.Bounds.Left,Lb.Bounds.Top,Lb.TotalWidth,Lb.TotalHeight,Lb.Bounds.Right-Lb.Bounds.Left,Lb.Bounds.Bottom-Lb.Bounds.Top),this.pJ.Qd(!0),this.pJ.setPosition(Ia.Position.X-this.Fa.YA(this.ta,this.YC).x/this.vd,Ia.Position.Y-
this.Fa.YA(this.ta,this.YC).y/this.vd);this.j$=Ia;this.bfc=new Yd.a(this.pJ.x,this.pJ.y)}this.ta.pictureCropInfo.TextureViewElem?(Ia=this.jc.kg(this.ta),hc=Ti.a.PLc(7,Ia.oq,Ia.Vk),Ia=this.ta.pictureCropInfo.TextureViewElem,Lb=Ia.Clip,(lb=lb[hc.toString()])?this.vma?(this.wfb=this.d7f(),this.Fhc=this.tn.points[this.wfb].copy(),this.oGc(Yd.a.bV(this.ta.fp.points[this.wfb],this.Fhc)),this.mu=this.YZb(this.ta.get_shapeRotation(),this.ta.fp.Wf()),this.AH.Ial(lb.Base64Data,Ia.Id.toString(),Ia.Position.X-
this.Fa.YA(this.ta,this.YC).x/this.vd,Ia.Position.Y-this.Fa.YA(this.ta,this.YC).y/this.vd,Lb.TotalWidth,Lb.TotalHeight,this.tn.copy().points,this.RLc(this.tn.copy()))):this.AH.Gal(lb.Base64Data,Ia.Id.toString(),Ia.Position.X-this.Fa.YA(this.ta,this.YC).x/this.vd,Ia.Position.Y-this.Fa.YA(this.ta,this.YC).y/this.vd,Lb.TotalWidth,Lb.TotalHeight,this.ta.fp.points):kd.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.J$=Ia):kd.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");
this.Iv&&Yd.a.nm(this.Iv.ga(0),this.Iv.ga(2))||(this.Iv=this.ta.fp);this.zva=this.ta.nZa;this.C4.zt(this.zva.points);this.tX.zt(this.Iv.points);this.VWa=!0;this.uY(!0);this.visible=this.Eb}else this.$va&&this.j$&&this.J$&&(this.tGl(),this.pJ.setPosition(this.j$.Position.X-this.Fa.YA(this.ta,this.YC).x/this.vd,this.j$.Position.Y-this.Fa.YA(this.ta,this.YC).y/this.vd),this.AH.image.setPosition(this.J$.Position.X-this.Fa.YA(this.ta,this.YC).x/this.vd,this.J$.Position.Y-this.Fa.YA(this.ta,this.YC).y/
this.vd),this.vma?(this.wfb=this.d7f(),this.Fhc=this.tn.points[this.wfb].copy(),this.oGc(Yd.a.bV(this.ta.fp.points[this.wfb],this.Fhc)),this.mu=this.YZb(this.ta.get_shapeRotation(),this.ta.fp.Wf()),this.AH.clipPath.f0b=this.RLc(this.ta.fp)):this.AH.clipPath.e7a=new oj.a(this.ta.fp.points,0),this.bfc=new Yd.a(this.pJ.x,this.pJ.y),this.Iv=this.ta.fp,this.zva=this.ta.nZa,this.C4.zt(this.zva.points),this.tX.zt(this.Iv.points),this.uY(!0),kd.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));
this.xb.Rl();this.xb.Qd(this.Eb)}}FCl(){if(this.Iv){var Ia=this.iB.BBb;const lb=new Yd.a(Ia[0].x/this.vd,Ia[0].y/this.vd),Lb=new Yd.a(Ia[2].x/this.vd,Ia[2].y/this.vd),hc=new Yd.a(Ia[4].x/this.vd,Ia[4].y/this.vd);Ia=new Yd.a(Ia[6].x/this.vd,Ia[6].y/this.vd);this.Iv=new bf.a(lb,Lb,hc,Ia)}else this.Iv=this.ta.fp;this.tn=this.Iv.copy();this.zva||(this.zva=this.ta.nZa);this.zva.move(this.Ova.x,this.Ova.y);this.C4.zt(this.zva.points);this.oma.nM(this.Ova.x,this.Ova.y);this.Ova.update(0,0);this.he.Dy(new yh.a(1))}f5i(){var Ia=
this.iB.BBb;const lb=new Yd.a(Ia[0].x,Ia[0].y),Lb=new Yd.a(Ia[2].x,Ia[2].y),hc=new Yd.a(Ia[4].x,Ia[4].y);Ia=new Yd.a(Ia[6].x,Ia[6].y);return new bf.a(lb,Lb,hc,Ia)}e7i(){var Ia=this.ta.nZa.copy().points,lb=new Yd.a(Ia[0].x*this.vd,Ia[0].y*this.vd);const Lb=new Yd.a(Ia[1].x*this.vd,Ia[1].y*this.vd),hc=new Yd.a(Ia[2].x*this.vd,Ia[2].y*this.vd);Ia=new Yd.a(Ia[3].x*this.vd,Ia[3].y*this.vd);lb=new bf.a(lb,Lb,hc,Ia);lb.scale(1/this.rU,1/this.rU);lb.move((this.oma.x+this.Ova.x)*this.vd,(this.oma.y+this.Ova.y)*
this.vd);return lb}NE(Ia){this.VWa&&(this.iB.Qd(!Ia),Ia?(this.PHh(),this.Zhc=!0):(this.FCl(),this.ia.processAction(Kd.a.lPb,2),this.$va&&(Ia={["pictCropperInfo"]:this.jAf(),["shapeNode"]:this.ta},this.ia.La(Kd.a.Npc,2,Ia))))}Yp(){return this.xb.Yp()}uY(Ia){if(this.VWa){var lb=this.Iv.copy();Ia&&this.D0.El(lb);Ia=new ng.a;Ia.Zqb(this.ta.get_shapeRotation());var Lb=2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let hc=0;8>hc;++hc){const Pc=this.WC[hc];Pc.nl(Vh.a.fQ(wg.a.box4Image(fe.qpc[Lb]),
Jg.a.DA));this.VKa(Pc,lb.rk(new Pd.a(hc)));Pc.PE(Ia,Qd.a.Fsb);Lb=(Lb+1)%8}}}VKa(Ia,lb){Ia.x===lb.x*this.vd&&Ia.y===lb.y*this.vd||Ia.setPosition(lb.x*this.vd,lb.y*this.vd)}get visible(){return this.Eb}set visible(Ia){this.Eb=Ia;!Ia&&this.VWa&&(this.WTi(),this.VWa=!1);this.xb.Qd(this.Eb)}WTi(){if(this.VWa){if(this.Zhc){const Ia={["pictCropperInfo"]:this.jAf(),["shapeNode"]:this.ta};this.ia.La(Kd.a.Npc,2,Ia)}this.W2()}}jAf(){let Ia,lb,Lb,hc;const Pc=this.Vni();({left:Ia,top:lb,right:Lb,bottom:hc}=this.Iwi());
return Object.assign(new Mh.a,{Left:Ia,Top:lb,Right:Lb,Bottom:hc,X:Pc.x,Y:Pc.y})}Iwi(){let Ia,lb,Lb,hc;({left:Ia,top:lb,right:Lb,bottom:hc}=this.ILi());({left:Ia,top:lb,right:Lb,bottom:hc}=this.sAi(Ia,lb,Lb,hc));({left:Ia,top:lb,right:Lb,bottom:hc}=fe.bIl(Ia,lb,Lb,hc));return{left:Ia,top:lb,right:Lb,bottom:hc}}ILi(){let Ia,lb,Lb;var hc=this.zva.points;const Pc=this.Iv.points;Ia=Bh.a(hc[3],hc[0],Pc[3],Pc[0]);lb=Bh.a(hc[0],hc[1],Pc[0],Pc[1]);Lb=Bh.a(hc[1],hc[2],Pc[1],Pc[2]);hc=Bh.a(hc[2],hc[3],Pc[2],
Pc[3]);return{left:Ia,top:lb,right:Lb,bottom:hc}}sAi(Ia,lb,Lb,hc){var Pc=this.zva.points;const Td=Yd.a.nm(Pc[0],Pc[1]);Pc=Yd.a.nm(Pc[1],Pc[2]);Ia=Math.floor(Ia/Td*1E6)/1E6;lb=Math.floor(lb/Pc*1E6)/1E6;Lb=Math.floor(Lb/Td*1E6)/1E6;hc=Math.floor(hc/Pc*1E6)/1E6;return{left:Ia,top:lb,right:Lb,bottom:hc}}Vni(){var Ia=this.Iv.copy(),lb=new ng.a,Lb=Ia.Wf();lb.L7(-1*this.ta.get_shapeRotation(),Lb);lb.El(Ia);Lb=this.Fa.YA(this.ta,this.YC);this.Jfk?(lb=this.YC.rf(Ia.hc*this.vd+Lb.x,0),Ia=this.YC.rf(Ia.kc*this.vd+
Lb.y,1),Ia=new Yd.a(lb,Ia)):Ia=new Yd.a(Ia.hc+Lb.x/this.vd,Ia.kc+Lb.y/this.vd);return Yd.a.scale(Ia,this.rU,this.rU)}Idd(){return!0}W2(){this.tX.PE(new ng.a,Qd.a.tca);this.C4.setPosition(0,0);this.In=new vf.a;this.tn=this.Iv=this.D0=this.ta.pictureCropInfo=null;this.oma.update(0,0);this.Zhc=!1;this.ABe.update(0,0);this.rU=1}VSd(Ia,lb){const Lb=new ng.a;this.tn||(this.tn=Ia);Ia=this.tn.Wf();const hc=Yd.a.nm(this.tn.ga(0),this.tn.ga(1)),Pc=Yd.a.nm(this.tn.ga(0),this.tn.ga(3)),Td=hc?1+(lb.right-lb.left)/
hc:1,ie=Pc?1+(lb.bottom-lb.top)/Pc:1,Sd=Ia.copy();Sd.nM(-1*hc/2,-1*Pc/2);Lb.L7(-1*this.ta.get_shapeRotation(),Ia);Lb.eC(-1*Sd.x,-1*Sd.y);Lb.lca(Td,ie);Lb.eC(lb.left+Sd.x,lb.top+Sd.y);Lb.L7(this.ta.get_shapeRotation(),Ia);return Lb}HCi(Ia,lb){var Lb=[new Yd.a(0,0),new Yd.a(20,0),new Yd.a(20,5),new Yd.a(5,5),new Yd.a(5,20),new Yd.a(0,20)];Lb=new oj.a(Lb,0);Lb.xa.id=lb;Lb.OE("black");Lb.Yu("white");Lb.mr(1);Ia.equals(Pd.a.DE)?Lb.$Ka(90):Ia.equals(Pd.a.Qu)?Lb.$Ka(0):Ia.equals(Pd.a.VE)?Lb.$Ka(180):Ia.equals(Pd.a.PH)&&
Lb.$Ka(-90);return Lb}JGi(Ia,lb){const Lb=new fh.a;Lb.xa.id=lb;Lb.OE("black");Lb.Yu("white");Lb.mr(1);Lb.lh(20,5);Ia.equals(Pd.a.north)?Lb.setPosition(-10,0):Ia.equals(Pd.a.south)?Lb.setPosition(-10,-5):Ia.equals(Pd.a.east)?(Lb.setPosition(-5,-10),Lb.lh(5,20)):Ia.equals(Pd.a.west)&&(Lb.setPosition(0,-10),Lb.lh(5,20));return Lb}get SYa(){return this.In}get te(){return this.xb.viewport}z9d(Ia){return!this.ta.gy&&8>Ia.index?this.WC[Ia.index].xa:null}LN(){return!1}Ox(Ia){Ia&&(this.Zhc=!1)}setSelection(){}static bIl(Ia,
lb,Lb,hc){.999999<Ia+Lb&&(kd.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",Ia,Lb),Lb=(999999-1E6*Ia)/1E6);.999999<lb+hc&&(kd.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",lb,hc),hc=(999999-1E6*lb)/1E6);return{left:Ia,top:lb,right:Lb,bottom:hc}}}fe.qpc=[Jg.a.Tyh,Jg.a.Ryh,Jg.a.Syh,Jg.a.Qyh,Jg.a.Vyh,Jg.a.Uyh,Jg.a.Wyh,Jg.a.Xyh];Object(h.a)(fe,"PictureCropShapeView",null,[604,430,431,106]);var gi=d(661);class vi{constructor(Ia,lb,Lb){this.Fa=
Ia;this.YC=lb;this.E9=Lb}setPosition(Ia,lb,Lb){this.E9.IF(Ia.shapeNode).zol(lb,Lb)}setOffsets(Ia,lb){this.E9.IF(Ia.shapeNode).Aol(Ia.i4e.copy(),lb)}GI(Ia,lb){const Lb=new ng.a,hc=this.E9.IF(Ia.shapeNode);lb=lb?hc.f5i().copy():hc.e7i().copy();Ia=this.Fa.YA(Ia.shapeNode,this.YC);Lb.eC(Ia.x,Ia.y);Lb.El(lb);return new gi.a(lb)}mG(Ia){return Ia.shapeNode.gy}}Object(h.a)(vi,"ShapeCropMoveResizeHandler",null,[603]);class bk{constructor(Ia,lb,Lb){this.E9=Ia;this.$va=lb;this.m9c=Lb}q1(Ia,lb,Lb){if((Ia=this.E9.IF(Ia))&&
Ia.visible!==Lb){for(const hc of lb)this.m9c&&(lb=Object(xb.a)(600,hc))&&lb.setSelected(!Lb),hc!==Ia&&(hc.visible=!Lb);Ia.visible=Lb}}kqd(){return!1}oud(Ia,lb,Lb){this.E9.IF(Ia).resize(Lb,lb)}lqd(){return!1}pud(Ia,lb,Lb,hc){hc&&this.E9.IF(Ia).setPosition(lb,Lb)}I0c(){return!this.$va}u9a(Ia,lb){return this.$va?lb:[this.E9.IF(Ia)]}mG(Ia){return Ia.gy}}Object(h.a)(bk,"ShapeViewCropUpdateStrategyHandler",null,[601,602]);var Zg=d(280);class Ek{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}Zb(Ia){this.K=
Ia;this.K.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().oa(()=>new Zg.a((lb,Lb)=>{let hc=null;const Pc=Object(xb.a)(117,lb.sc(this.K.resolve("Box4.IPageView").Ma));Pc&&!Pc.Al&&(hc=new fe(lb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Ld,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
Lb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").GKe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ehd,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").V3d),hc.Jm(Pc.xa),hc.setZIndex(3),hc.visible=!1,Pc.MM(hc.te.xa,!0),Pc.rra(hc,3));return hc}));this.K.register(Lf,
"PowerPointWebEditor.PictureCropActor").ma().oa(()=>new Lf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").HRj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").FKe,this.K.resolve("Common.IBrowserUtils"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ska,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ehd,
this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(od,"PowerPointWebEditor.FormatPicturePaneActor").ma().oa(()=>new od(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new bk(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").GKe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Fhd));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new vi(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView").Ld,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").wb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").wb();
this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").Ee()}dispose(){}static main(){n.a.instance.Dc(ue.a(new Ek,0))}}Object(h.a)(Ek,"PPTWebEditorPictureCropPackage",null,[2,3]);var Ch=d(40),Ui=d(247);class pg{constructor(Ia,lb,Lb,hc,Pc){this.$z=[Ch.a.Ri,Ch.a.font,Db.a.autonumberBulletType];this.Qb=Ia;this.Ml=lb;this.Hh=Lb;this.ugc=hc;this.nJ=Pc}format(Ia){if(Ia&&Ia.tAb){Ia=this.Qb.Nc(Ia);for(var lb=this.Ml.c3(Ia,Ia.currentNode);lb.moveNext();){var Lb=lb.currentNode;if(Lb&&this.Hh.$d(Lb)){const hc=
this.nJ.qQ(Ia,this.Hh.hhb(Lb));(Lb=this.ugc.gTc(Lb))&&Ui.d(hc,Lb,this.$z)}}}}}Object(h.a)(pg,"BeautifyListFormatter",null,[585]);class Mg{constructor(Ia,lb,Lb,hc,Pc){this.ia=Ia;this.ua=Lb;this.Jb=lb;this.Fa=hc;this.W5j=Pc}initialize(){this.wb()}wb(){this.ia.ra(Kd.a.gRd,V.a.application,Object(A.a)(this,this.gRd,"applyTextFormatterSuggestion"),4)}gRd(Ia,lb,Lb){if(1===Lb)return 32;Ia=this.ua.Ba;if(!Ia)return 16;lb=Ia.Ek();if(!lb||!lb.length)return 16;lb=this.Fa.p_(lb);if(!lb.length)return 16;Lb=this.Jb.Ad(15);
Lb.nc(Ia);for(const hc of lb)this.W5j.format(hc);Lb.dispose();return 32}}Object(h.a)(Mg,"TextFormatterActor",null,[]);class gh{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Zb(Ia){this.K=Ia;Ia.register(585,"PowerPointWebEditor.IBeautifyListFormatter").ma().oa(()=>new pg(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor")));Ia.register(Mg,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().oa(()=>new Mg(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const Ia=this.K.resolve("Common.IAppSettingsManager");Ia.gf(()=>
{Ia.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){n.a.instance.Dc(ue.a(new gh,0))}}Object(h.a)(gh,"PPTWebEditorTextFormatterPackage",null,[2,3]);var Ie=d(12);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(Ie.c)("Chronos1");
Ka.main();Type.registerNamespace("Common.App.O365Shell");Ob.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");rb.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Rd.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",
Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",
attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",
Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},
children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",
attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",
Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",
Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",
attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",
Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},
{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},
{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",
ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",
QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",
Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",
Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",
DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};Ek.main();gh.main();Type.registerNamespace("NLRT");Object(Ie.b)("Chronos1")},139:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(223);class e{constructor(n,m){this.TNa=!1;const {Annotations:z}=d(79);if(!n)throw Error.argumentNull("annotations");
if(!n.Cme(m))throw Error.argument("memberTypeID","Invalid type ID");if(z.QB(m))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Gr=n;this.qWh=m;this.XB=[]}get Arb(){return this.Gr}get isReadOnly(){return this.TNa}get yU(){return this.qWh}get items(){return this.XB}V1(){const {Annotations:n}=d(79);let m="[";for(let z=0,B=this.items.length;z<B;++z){0<z&&(m+=", ");const v=this.Gr.V1(this.yU,this.items[z]);this.yU===n.aZ?(m+='"',m+=h.a.R1d(v),m+='"'):m+=v}return m+"]"}isEqual(n){const {Annotations:m}=
d(79);if(this===n)return!0;if(!n||n.Arb!==this.Gr||n.yU!==this.yU||n.items.length!==this.items.length)return!1;for(let z=0;z<this.items.length;++z)if(!m.P1a(this.yU,this.items[z],n.items[z]))return!1;return!0}clone(){const n=new e(this.Gr,this.yU);Array.addRange(n.items,this.items);return n}VK(){return this.isReadOnly?this.clone():this}coe(){const {Annotations:n}=d(79);if(!this.isReadOnly){this.TNa=!0;for(const m of this.items)n.Pbb(m)}}toString(){return this.V1()}}Object(I.a)(e,"ListValue",null,
[1024,1023])},144:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.tellMe="TellMe";h.contextMenu="ContextMenu";h.unknown="Unknown";Object(I.a)(h,"TellMeScenario",null,[])},156:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n,m=null,z=null,B=4,v=-99999,y=0){this.XPd="";this.YGc=-1;this.value=e;this.type=n;this.subType=B;this.label=this.KJ=m;this.groupType=29;this.description=z;this.score=v;this.count=y}}Object(I.a)(h,"ResultBinding",null,[])},170:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.Lk=[]}Uq(e){this.Lk.push(e)}Khh(e){const n=[];for(const m of this.Lk)m.groupType!==e&&n.push(m);this.Lk.length!==n.length&&(this.Lk=n)}get Qzb(){return!1}}Object(I.a)(h,"SimpleResultsUpdatedEventArgs",null,[675])},171:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e=29,n=""){this.PZh=[];this.groupType=e;this.displayName=n}get results(){return this.PZh}ls(e){e.groupType=
this.groupType;Array.add(this.results,e)}LQe(e=1){if(this.results.length>=e)for(let n=0;n<e;n++)Array.removeAt(this.results,this.results.length-1)}}Object(I.a)(h,"SimpleResultGroup",null,[676])},223:function(I,Y,d){I=d(0);class h{constructor(n,m){this.XPa=n;this.value=m}}Object(I.a)(h,"AttrValuePair",null,[]);d.d(Y,"a",function(){return e});class e{constructor(n){this.TNa=!1;if(!n)throw Error.argumentNull("annotations");this.Gr=n;this.hO=[]}get Arb(){return this.Gr}get isReadOnly(){return this.TNa}get Hbe(){return 0<
this.hO.length}Rm(n){if(!this.Gr.xAb(n))throw Error.argument("attributeID","Invalid attribute ID");for(const m of this.hO)if(n===m.XPa)return n=m.value,{returnValue:!0,value:n};return{returnValue:!1,value:null}}ru(n,m){var {Annotations:z}=d(79);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Gr.xAb(n))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Gr.xzb(this.Gr.getAttributeType(n),m))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");z.Pbb(m);for(z=0;z<this.hO.length;++z){const B=this.hO[z];if(n===B.XPa){B.value=m;return}}Array.add(this.hO,new h(n,m))}$kd(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Gr.xAb(n))throw Error.argument("attributeID","Invalid attribute ID");for(let m=0;m<this.hO.length;++m)if(n===this.hO[m].XPa){Array.removeAt(this.hO,m);break}}vQc(n){if(!n)throw Error.argumentNull("action");
for(const m of this.hO)n(m.XPa,m.value)}clone(){const n=new e(this.Gr);n.ECa(this);return n}ECa(n){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!n)throw Error.argumentNull("other");if(n.Arb!==this.Gr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.hO);n.vQc((m,z)=>{this.ru(m,z)})}V1(){const {Annotations:n}=d(79);let m="[",z=!0;for(const B of this.hO){z?z=!1:m+=", ";m+=this.Gr.FZf(B.XPa);m+="=";const v=this.Gr.getAttributeType(B.XPa),
y=this.Gr.V1(v,B.value);v===n.aZ?(m+='"',m+=e.R1d(y),m+='"'):m+=y}return m+"]"}isEqual(n){const {Annotations:m}=d(79);if(!n)throw Error.argumentNull("other");if(this===n)return!0;if(!n||this.Gr!==n.Arb||this.Hbe!==n.Hbe)return!1;let z=0,B=null,v=!1;n.vQc((y,A)=>{++z;if(!v){var E=-1;for(let u=0,J=this.hO.length;u<J;++u)if(this.hO[u].XPa===y){E=u;break}0>E?v=!0:(B||(B=Array(this.hO.length)),B[E]=A)}});if(this.hO.length!==z||v)return!1;for(let y=0,A=this.hO.length;y<A;++y)if(!m.P1a(this.Gr.getAttributeType(this.hO[y].XPa),
this.hO[y].value,B[y]))return!1;return!0}VK(){return this.isReadOnly?this.clone():this}coe(){const {Annotations:n}=d(79);if(!this.isReadOnly){this.TNa=!0;for(const m of this.hO)n.Pbb(m.value)}}toString(){return this.V1()}static R1d(n){return n.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(I.a)(e,"FeatureBundle",null,[1022,1023])},263:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.click="Click";h.Lyb="InteractionBegin";h.nfg="InteractionEnd";
h.nIf="ControlActivated";h.query="Query";h.fdh="QueryIndexRecorded";h.DGf="Clicks";h.zrf="ActionEvents";h.vVf="FilteredActionEvents";h.cph="SessionContext";h.latency="Latency";h.performance="Performance";h.yjh="RenderedResults";h.events="Events";h.fGi="CreateResultsMenu";h.sG="UpdateRibbonControls";h.b3k="ResultsAggregation";h.fB="IssueQuery";h.Dvi="CommandSuggestions";h.error="Error";h.Vne="LoadModelData";h.RKi="DepsResolveTime";h.vmk="ModelDataWaitTime";h.timedOut="TimedOut";h.Gbi="AddinQueryCommandReady";
h.H2i="GetAddinEntitlements";h.Pch="ProviderMRUEvents";h.tQi="EnableAddinSearchCommands";Object(I.a)(h,"EventNames",null,[])},281:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.oAe=null;this.oz=this.TBe=0}PQc(e,n,m){if(!e)throw Error.argumentNull("referenceList");if(0>n||n>e.length)throw Error.argumentOutOfRange("startIndex");if(0>m||m>e.length)throw Error.argumentOutOfRange("length");if(n+m>e.length)throw Error.argument("Invalid start-length range");this.oAe=e;
this.TBe=n;this.oz=m}tSa(e,n,m){this.PQc(e.oAe,e.TBe+n,m)}ga(e){if(0>e||e>=this.oz)throw Error.argumentOutOfRange("index");return this.oAe[this.TBe+e]}get count(){return this.oz}static mYd(e){const n=new h;n.PQc(e,0,e.length);return n}}Object(I.a)(h,"ReadOnlyList",null,[1052])},306:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.SummarizeDeck=25]="SummarizeDeck";e[e.Addin=26]="Addin";e[e.OfficeScript=27]="OfficeScript";e[e.AddinStoreEntry=28]="AddinStoreEntry";e[e.None=29]="None";e[e.MergedActions=30]="MergedActions";e[e.MergedScopedSearches=31]="MergedScopedSearches";e[e.MergedSuggestedSearches=32]="MergedSuggestedSearches"})(h||(h={}));Object(I.b)("ResultGroupType",h)},335:function(I,Y,d){d.r(Y);
d.d(Y,"CommandResultsUtility",function(){return A});I=d(0);var h=d(383),e=d(263),n=d(384),m=d(156),z=d(171),B=d(117),v=d(103),y=d(27);class A{static cPb(E,u){if(u&&u.Oo){const J={};for(const G of E)u.C0c(G)&&(J[G]=appChrome.selectors.getModelType(G));B.TellMeActor.instance.sG(J)}}static rul(E){return E.startsWith("btnTellMeOfficeAddIn")}static s9b(E){const u=B.TellMeActor.instance.WG();return!!u&&u.Oo&&!appChrome.selectors.isControlDisabled(E)}static Z1c(E,u,J,G){if(B.TellMeActor.instance.Hd&&E){const S=
[];for(const P of E)S.push(String.format('{{"Id":"{0}","Score":{1}}}',P.commandId,P.score));E={};E[h.a.suggestions]="[{"+S.join(",")+"}]";E[h.a.Sng]=u;E[h.a.groupType]=J;E[h.a.provider]=G;B.TellMeActor.instance.Hd.CH(e.a.Dvi,window.performance.now(),E)}}static C6i(E,u){const J=[],G=[];for(const S of u){u=S.commandId;let P=S;S.commandId in E&&(u=E[S.commandId],P=new n.a(u,S.score));Array.contains(G,u)||(J.push(P),G.push(u))}return J}static TTc(E,u,J,G,S,P,Q,D){J.i6d&&(u=A.C6i(J.i6d,u));var O=v.a.G5i(u);
A.cPb(O,J);var X=[],N=[];O=[];const aa=new z.a(Q);Q=16===Q||18===Q||7===Q||4===Q?y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Bc("TellMeMaxRecommendedResultsToReturn",3):3:0===Q||17===Q?5:0;for(const V of u)if(!A.lLj(V.commandId)){u=A.rul(V.commandId);if(J.C0c(V.commandId)&&!u){if(v.a.Ymg(V.commandId))continue;u=null;S&&P&&(u=S.Rej(V.commandId,P));A.s9b(V.commandId)?Array.add(X,new m.a(V.commandId,5,u,null,D,V.score)):Array.add(N,new m.a(V.commandId,5,u,null,D,V.score))}else J.r6a&&u&&G&&
Array.add(O,V.commandId.substr(21));if(X.length+O.length>=Q)break}J=0;for(S=0;S<X.length&&J<Q;S++,J++)aa.ls(X[S]);for(X=0;X<N.length&&J<Q;X++,J++)aa.ls(N[X]);for(N=0;N<O.length&&J<Q;N++,J++)G.BOl(E,O[N],aa);return aa}static lLj(E){A.Azf||(y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.Cu("TellMeControlPredictionBlockList")&&y.AFrameworkApplication.fa.WA("TellMeControlPredictionBlockList").forEach(u=>{Array.add(A.zzf,u.toLowerCase())}),A.Azf=!0);return Array.contains(A.zzf,E.toLowerCase())}static Pie(E){return 2<
E.length&&";"===E.charAt(0)&&";"===E.charAt(E.length-1)&&!!y.AFrameworkApplication.fa&&(y.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static X_f(E){const u=new z.a(0);var J=E.split(";");E=B.TellMeActor.instance.WG();for(const G of J)if(0<G.length){J=G.split(":");const S=2===J.length?J[0]:G;if(!E.C0c(S))break;if(1===J.length)J=new m.a(S,5,null,null,1),u.ls(J);else if(2===
J.length)J=new m.a(S,5,J[1],null,1),u.ls(J);else break}return u}static S5h(E,u,J){if(!(u&&u.results&&E&&E.results&&E.results.length))return{returnValue:!1,wOd:E,VOd:u};const G=[];for(var S of u.results)Array.add(G,S.value);S=0;const P=0<u.results.length?u.results[0].score:0;for(const Q of E.results)if(Q.score>J&&!Array.contains(G,Q.value)&&A.s9b(Q.value)&&(0<P&&(Q.score=P),Array.insert(u.results,S,Q),S++),2===S)break;return 0<S?(J=u.results.length-5,0<J&&u.LQe(J),{returnValue:!0,wOd:E,VOd:u}):{returnValue:!1,
wOd:E,VOd:u}}}A.Azf=!1;A.zzf=[];Object(I.a)(A,"CommandResultsUtility",null,[])},383:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.appName="AppName";h.i7a="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message="Message";h.errorMessage="ErrorMessage";h.event="Event";h.a9="CorrelationID";h.iCk="ParentUiElement";h.query="Input";h.Uhb="QueryID";h.hdh="QueryLength";h.cJb="QueryIndex";h.c3k="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";
h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.SEh="UiElement";h.xkd="ReactUx";h.value="Val";h.statusCode="StatusCode";h.K8k="Service";h.isSuccess="IsSuccess";h.lwl="TokenAcquired";h.PYj="LatencyType";h.groupName="GroupName";h.y$a="GroupIndex";h.groupType="GroupType";h.Z2k="ResultInfoList";h.resultType="ResultType";h.S_e="SubResultType";h.HOj="IsInputBlur";h.IOj="IsInputFocus";h.pUj="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.rPi="DwellTime";h.Sng="IsZeroTerm";h.EKl=
"WordsCount";h.O_c="IsSearchUxEnabled";h.KVj="IsTellMeInHeaderEnabled";h.module="Module";h.resultIndex="ResultIndex";h.T_d="DisplayIndex";h.CQi="EnableList";h.provider="Provider";h.contentType="ContentType";h.TTj="IsSelectionBased";h.Jhi="BeginPerformanceMarker";h.$Qi="EndPerformanceMarker";h.nEk="PerformanceMeasure";Object(I.a)(h,"Columns",null,[])},384:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.commandId=e;this.score=n}}Object(I.a)(h,"CommandSuggestion",
null,[])},449:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{static Otc(e){if(!e)return"{NULL}";const n=e.length;return 600>=n?e:e.substring(0,400)+"[...]"+e.substring(n-195,n)}}Object(I.a)(h,"LogUtils",null,[])},450:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.cJb="QueryIndex";h.dBh="TellMeRanker";h.eBh="TellMeRankerLogging";Object(I.a)(h,"Services",null,[])},451:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{}h.Qta="HttpRequest";h.provider="Provider";Object(I.a)(h,"LatencyTypes",null,[])},546:function(I,Y,d){I=d(0);class h{constructor(){this.ztc=this.H8b=null;this.RDe=this.score=this.Eic=0}RJe(J,G,S){this.score=J.ga(G);++G;this.H8b=J.ga(G)?S.J8(J.ga(G)):null;++G;this.ztc=J.ga(G)?S.J8(J.ga(G)):null;++G;this.Eic=J.ga(G);++G;this.RDe=J.ga(G);++G;return G}}Object(I.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(J,G,S,P,Q){this.lSa=J;this.count=G;this.fQc=S;this.SG=P;this.depth=
Q}}Object(I.a)(e,"ErrorTolerantTrieMatch",null,[]);var n=d(705),m=d(986);class z{constructor(J=null,G=0,S=0,P=0){this.j2h=J||new m.a;this.bda=G;this.SG=S;this.depth=P}get mV(){return this.j2h}getKey(){return this.mV.gt.toString()+":"+this.bda.toString()}}Object(I.a)(z,"TrieBookmark",null,[]);class B{constructor(J,G){this.Lwa=J;this.xye=G}P4j(J){if(null==J)throw Error.argumentNull("prefix");let G={};var S=G[""]=new z;this.zWc(S,G);for(S=0;S<J.length;++S){const P=J.charCodeAt(S),Q={};for(let D in G)this.Aci(P,
G[D],Q);G=Q}return this.sxl(G)}zWc(J,G){if(!(J.SG>=this.xye)&&(J=new z(n.a.xVd(J.mV),J.bda,J.SG+1,J.depth),J.mV.Fz&n.a.CMa&&(J.bda+=1),this.Lwa.zlb(J.mV))){J.depth+=1;let S=!0;for(;S;)B.Hud(J,G),this.zWc(J,G),J.bda+=this.Lwa.ywb(J.mV,!0)+(J.mV.Fz&n.a.CMa?1:0),S=this.Lwa.Itc(J.mV)}}Aci(J,G,S){G.SG+1<=this.xye&&(G.SG+=1,B.Hud(G,S),--G.SG);G.mV.Fz&n.a.CMa&&(G.bda+=1);if(this.Lwa.zlb(G.mV)){G.depth+=1;let P=!0;for(;P;)G.mV.emb===J?(B.Hud(G,S),this.zWc(G,S)):G.SG+1<=this.xye&&(G.SG+=1,B.Hud(G,S),this.zWc(G,
S),--G.SG),G.bda+=this.Lwa.ywb(G.mV,!0)+(G.mV.Fz&n.a.CMa?1:0),P=this.Lwa.Itc(G.mV)}}sxl(J){const G=[];for(var S in J){const P=J[S];if(!P.mV.gt)continue;const Q=!!(P.mV.Fz&n.a.CMa),D=this.Lwa.ywb(P.mV,!1)+(Q?1:0);Array.add(G,new e(P.bda,D,Q,P.SG,P.depth))}G.sort((P,Q)=>{let D=P.lSa-Q.lSa;return D||(D=-(P.count-Q.count))?D:D=P.depth-Q.depth});if(2>G.length)return G;J=[];for(S=0;S<G.length;)S+=B.LCh(S,G,J);return J}static Hud(J,G){const S=J.getKey();S in G?(G=G[S],G.SG=Math.min(G.SG,J.SG)):G[S]=new z(n.a.xVd(J.mV),
J.bda,J.SG,J.depth)}static LCh(J,G,S){const P=G[J];let Q=P.lSa;const D=Q+P.count;let O=1,X=P.fQc;for(;J+O<G.length&&G[J+O].lSa<D;){const N=G[J+O];N.lSa>Q&&(Array.add(S,new e(Q,N.lSa-Q,X,P.SG,P.depth)),X=!1);O+=B.LCh(J+O,G,S);Q=N.lSa+N.count}Q<D&&Array.add(S,new e(Q,D-Q,X,P.SG,P.depth));return O}}Object(I.a)(B,"ErrorTolerantTrieLookupEngine",null,[1129]);class v extends h{constructor(J,G,S){super();this.Fdg=this.q7g=!1;this.VSf=null;if(J){var P=0;try{P=this.RJe(J,P,G);this.q7g=1===J.ga(P);++P;this.Fdg=
1===J.ga(P);++P;const Q=J.ga(P);this.VSf=this.yCk(S,Q)}catch(Q){throw Error.argument("initData");}}}yCk(J,G){return new B(J,G)}}Object(I.a)(v,"FuzzyMatchTokenStringGeneratorInit",h,[]);class y extends h{constructor(J,G){super();this.query=this.name=null;if(J){this.annotations=G.annotations;var S=0;try{S=this.RJe(J,S,G),this.name=G.yC(J.ga(S)),++S,this.query=G.VD(J.ga(S))}catch(P){throw Error.argument("initData");}}}}Object(I.a)(y,"QueryTokenStringGeneratorInit",h,[]);class A extends h{constructor(J,
G){super();if(J)try{this.RJe(J,0,G)}catch(S){throw Error.argument("initData");}}}Object(I.a)(A,"SurfaceStringTokenStringGeneratorInit",h,[]);var E=d(281);d.d(Y,"a",function(){return u});class u{constructor(J){this.Qpe=J}get H8b(){return this.Qpe.H8b}get ztc(){return this.Qpe.ztc}get Eic(){return this.Qpe.Eic}static create(J,G,S){const {SurfaceStringTokenStringGenerator:P}=d(1133),{QueryTokenStringGenerator:Q}=d(1134),{FuzzyMatchTokenStringGenerator:D}=d(1135);let O=0;try{if(J.ga(O)!==u.J6a)throw Error.argument("initData",
"Input does not represent a token string generator");++O;const X=J.ga(O);++O;const N=new E.a;N.tSa(J,O,J.count-O);switch(X){case P.f_b:return new P(new A(N,G));case Q.f_b:return new Q(new y(N,G));case D.f_b:return new D(new v(N,G,S));default:throw Error.argument("initData");}}catch(X){throw Error.argument("initData");}}static Jtf(J,G,S,P,Q,D){J=J.swl.getId(G,null);if(0>J)return++D,D;u.Ktf(J,S,P,Q);return D}static Ktf(J,G,S,P){Array.add(P.y_e,J);Array.add(P.Iyh,G);++P.xOb[S]}}u.J6a=1099767983;Object(I.a)(u,
"TokenStringGenerator",null,[1078])},693:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(103);d=d(27);class e{static LVj(){return!h.a.Yig()&&!h.a.nbb()&&e.isFeatureEnabled(0)}static umg(){return e.isFeatureEnabled(1)}static Ujg(){return e.isFeatureEnabled(2)}static isFeatureEnabled(n){return!!(e.jRh&1<<n)}}e.jRh=d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.Bc("TellMeFeatureConfigValue",0):0;Object(I.a)(e,"TellMeFeatureAvailability",null,[])},694:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);d=d(156);class h extends d.a{constructor(e,n,m,z,B=null){super(e,n,B,null,m);this.id=z}}Object(I.a)(h,"TryQueryResultBinding",d.a,[])},695:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.Ia=e}get YIa(){return this.Ia.YIa}get Trl(){return 4!==this.Ia.style}get Xrl(){return!0}get trie(){return this.Ia.trie}getId(e,n){if(!this.Trl)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ia.style){case 0:return this.$$i(e,n);default:throw Error.notImplemented();
}}yC(e){if(!this.Xrl)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.YIa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ia.style){case 0:return this.Ekj(e);case 4:return this.Dkj(e);default:throw Error.notImplemented();}}$$i(e,n){e=this.Ia.trie.krg(e,0,e.length,n);if(!e.succeeded)return-1;if(0>e.GOb||e.GOb>=this.Ia.YIa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ia.Jtc?this.Ia.Knc.qu(this.Ia.Jtc+
4*e.GOb,4):e.GOb}Ekj(e){if(this.Ia.Jtc){let n=0;for(;n<this.Ia.YIa&&this.Ia.Knc.qu(this.Ia.Jtc+4*n,4)!==e;++n);if(n>=this.Ia.YIa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ia.trie.i7f(n)}return this.Ia.trie.i7f(e)}Dkj(e){const n=this.Ia.Knc.qu(this.Ia.Gyh+4*e,4);e=this.Ia.Knc.qu(this.Ia.Hyh+4*e,4);if(0>e||0>n)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const m=Array(n);for(let z=0;z<n;++z)m[z]=({pAj:e}=this.OQk(e)).returnValue;
return String.fromCharCode.apply(null,m)}OQk(e){let n=0;for(let m=0;3>m;++m){const z=this.Ia.Knc.ga(this.Ia.bEf+e)^182;++e;n|=(z&127)<<7*m;if(!(z&128))break}return{returnValue:n,pAj:e}}}Object(I.a)(h,"StringTable",null,[1054])},696:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(705);class e{constructor(n){this.trie=null;this.bEf=this.Gyh=this.Hyh=this.Jtc=0;if(n){this.Knc=n;var m=0;if(n.qu(m,4)!==e.J6a)throw Error.argument("bytes","Input does not represent a string table");m+=4;this.YIa=
n.qu(m,4);m+=4;this.style=n.qu(m,4);m+=4;switch(this.style){case 0:const z=1===n.qu(m,4);m+=4;z||(this.Jtc=m,m+=4*this.YIa);n.qu(m,4);this.trie=this.bDk(n,m+4);break;case 4:this.Hyh=m;this.Gyh=m+=4*this.YIa;m+=4*this.YIa;n.qu(m,4);this.bEf=m+4;break;default:throw Error.argument("bytes");}}}bDk(n,m){return new h.a(n,m)}}e.J6a=1025118440;Object(I.a)(e,"StringTableInit",null,[])},697:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";
e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=
17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.Addin=26]="Addin";e[e.OfficeScript=27]="OfficeScript";e[e.AddinStoreEntry=28]="AddinStoreEntry";e[e.GenerateSlides=29]="GenerateSlides";e[e.SummarizeDeck=30]="SummarizeDeck";e[e.Unknown=31]=
"Unknown"})(h||(h={}));Object(I.b)("ResultType",h)},705:function(I,Y,d){I=d(0);class h{constructor(v){this.F_g=v;this.succeeded=!1;this.GOb=v?v.GOb:0;this.HVj=!1;this.length=this.Etl=0}}Object(I.a)(h,"TrieResult",null,[]);class e{constructor(v,y,A){this.Ao=new h(null);this.fbk=v;this.Tdc=y;this.Iwg=y+A-1}get result(){return this.Ao}Z3f(){let v;return this.Tdc<=this.Iwg?(v=this.fbk.charAt(this.Tdc),++this.Tdc,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}pQe(v,y,A){v&&(this.Ao.HVj=!0,this.Ao.Etl=
y);this.Ao.length=this.Tdc;this.Ao.succeeded=!0;this.Ao.GOb=A;this.Tdc!==this.Iwg+1&&(this.Ao=new h(this.Ao))}}Object(I.a)(e,"LookUpStringVisitor",null,[1076]);var n=d(986);class m{constructor(){this.KDf=this.eBf=this.gBf=this.dBf=this.fBf=this.cTd=this.bTd=this.eTd=this.aTd=0}}Object(I.a)(m,"TRIESTATS",null,[]);class z{constructor(){this.symbol=this.zjc=0}}Object(I.a)(z,"TrieSymbol",null,[]);d.d(Y,"a",function(){return B});class B{constructor(v,y){this.sU=null;this.V5c=this.cAg=this.aAg=this.eAg=
this.Xzg=this.dAg=this.bAg=this.fAg=this.Yzg=0;this.IC=v;if(v.qu(y,4)!==B.J6a)throw Error.argument("Input does not represent a trie");y+=4;this.mxg=1===v.qu(y,4);y+=4;this.V7j=1===v.qu(y,4);y+=4;this.G7j=v.qu(y,4);y+=4;if(v.qu(y,4)){v=y+4;this.sU=this.QQk(v);this.Yzg=y=v+B.lmi;this.fAg=y+=B.xIc*(this.sU.aTd+(this.sU.aTd%2?1:0));this.bAg=y+=B.xIc*(this.sU.eTd+(this.sU.eTd%2?1:0));this.dAg=y+=B.xIc*(this.sU.bTd+(this.sU.bTd%2?1:0));this.Xzg=y+=B.xIc*(this.sU.cTd+(this.sU.cTd%2?1:0));this.eAg=y+=B.iTd*
this.sU.dBf;this.aAg=y+=B.jTd*this.sU.gBf;this.cAg=y+=B.jTd*this.sU.eBf;y+=B.jTd*this.sU.fBf;if(y!==v+this.sU.KDf)throw Error.argument("Corrupted trie binary");this.V5c=y}else this.sU=null}krg(v,y,A,E){v=new e(v,y,A);this.qJh(v,E);return v.result}i7f(v){if(this.mxg)if(v)--v;else return"";if(!this.sU)throw Error.argument("Invalid trieID");const y=new n.a;y.Fz=0;this.zlb(y);const A=[];for(;;){if(y.Fz&B.CMa)if(v)--v;else return Array.add(A,y.emb),String.fromCharCode.apply(null,A);const E=!!(y.Fz&B.ewd),
u=this.ywb(y,!0);if(E||v<u){if(Array.add(A,y.emb),!this.zlb(y))throw Error.argument("Invalid trieID");}else if(v-=u,!this.Itc(y))throw Error.argument("Invalid trieID");}}qJh(v,y){let A=0;this.mxg&&(v.pQe(this.V7j,this.G7j,0),++A);if(this.sU){var E=new n.a;E.Fz=0;if(this.zlb(E))for(;;){var u=void 0;if(!({ch:u}=v.Z3f()).returnValue)break;y&&(u=y(u));u=u.toString().charCodeAt(0);let J=!1;for(;!J;){const G=!!(E.Fz&B.CMa);if(E.emb===u){if(J=!0,G&&v.pQe(!!(E.Fz&B.P6e),E.jsd,A),!this.zlb(E))return}else if(A+=
this.ywb(E,!0),!this.Itc(E))return;G&&++A}}}}zlb(v){if(!v.Fz)return this.E2e(v),!0;if(!(v.Fz&B.dwd))return!1;v.Sta=0;v.gt=v.aUa;this.E2e(v);return!0}Itc(v){if(v.Fz&B.ewd)return!1;this.E2e(v);return!0}ywb(v,y){return v.Fz&B.O6e?v.uIc:v.Fz&B.dwd?!y&&v.Fz&B.ewd?this.I6i(v):1:0}I6i(v){v=B.xVd(v);if(!this.zlb(v))return 0;let y=0;do v.Fz&B.CMa&&++y,y+=this.ywb(v,!1);while(this.Itc(v));return y}E2e(v){v.Fz||(v.Sta=0,v.gt=this.V5c);var y=this.yMc(this.Yzg,v.gt),A=y.symbol;v.gt+=y.zjc;y=this.IC.qu(this.Xzg+
B.iTd*A,B.iTd);v.emb=y&65535;v.Fz=y>>16;v.Fz&B.O6e&&(v.uIc=this.qJi(v));v.Fz&B.P6e&&(y=this.yMc(this.fAg,v.gt),A=y.symbol,v.gt+=y.zjc,v.jsd=this.IC.qu(this.eAg+4*A,4));v.Fz&B.JLh?(v.aUa=this.V5c+((this.IC.ga(v.gt)<<8|this.IC.ga(v.gt+1))<<8|this.IC.ga(v.gt+2)),v.gt+=3):v.Fz&B.KLh?(v.aUa=v.gt,v.Sta=v.aUa):v.Fz&B.LLh?(y=this.yMc(this.bAg,v.gt),A=y.symbol,v.gt+=y.zjc,v.aUa=this.V5c+this.IC.qu(this.aAg+4*A,4)):v.Fz&B.dwd&&(y=this.yMc(this.dAg,v.gt),A=y.symbol,v.gt+=y.zjc,v.Sta||(v.Sta=v.gt),v.Sta+=this.IC.qu(this.cAg+
4*A,4),v.aUa=v.Sta)}yMc(v,y){const A=new z;let E=0;for(;;){E+=this.IC.ga(y);++y;++A.zjc;const u=this.IC.qu(v,2);if(E<u)break;A.symbol+=u;E-=u;v+=2;E<<=8}A.symbol+=E;return A}qJi(v){let y=this.IC.ga(v.gt);192<=y?(y=(y&63)<<15|(this.IC.ga(v.gt+1)&127)<<8,y|=this.IC.ga(v.gt+2),v.gt+=3):128<=y?(y=(y&127)<<8|this.IC.ga(v.gt+1),v.gt+=2):v.gt+=1;return y}QQk(v){const y=new m;y.aTd=this.IC.qu(v+12,2);y.eTd=this.IC.qu(v+14,2);y.bTd=this.IC.qu(v+16,2);y.cTd=this.IC.qu(v+18,2);y.fBf=this.IC.qu(v+24,4);y.dBf=
this.IC.qu(v+28,4);y.gBf=this.IC.qu(v+32,4);y.eBf=this.IC.qu(v+36,4);y.KDf=this.IC.qu(v+40,4);return y}static xVd(v){const y=new n.a;y.emb=v.emb;y.Fz=v.Fz;y.uIc=v.uIc;y.gt=v.gt;y.aUa=v.aUa;y.Sta=v.Sta;y.jsd=v.jsd;return y}}B.J6a=1654263084;B.lmi=48;B.xIc=2;B.jTd=4;B.iTd=4;B.CMa=1;B.ewd=2;B.O6e=4;B.P6e=8;B.dwd=16;B.KLh=64;B.LLh=128;B.JLh=256;Object(I.a)(B,"Trie",null,[1077])},707:function(I,Y,d){d.r(Y);I=d(0);d(144);var h=d(263);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(I.a)(e,
"AppsForOfficeStoreType",null,[]);var n=d(117),m=d(27),z=d(81),B=d(37);class v{constructor(){this.lLd=0}sNe(P,Q){this.lLd=window.performance.now();this.Q1a(()=>{const D=window.performance.now(),O={},X=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);Q.dvf&&(O.callback=N=>{P(N,e.marketPlace,D)},X&&(O.storeType=e.marketPlace),m.AFrameworkApplication.Ta.La(B.a.OZa,2,O));Q.evf&&(O.callback=N=>{P(N,e.privateCatalog,D)},X?O.storeType=
e.privateCatalog:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?O.storeType=10:O.storeType=e.privateCatalog,m.AFrameworkApplication.Ta.La(B.a.OZa,2,O))},0,()=>{if(n.TellMeActor.instance.Hd)n.TellMeActor.instance.Hd.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.lLd)+" ms")})}Q1a(P,Q=0,D=null){2!==m.AFrameworkApplication.Ta.processAction(B.a.OZa,1)?(n.TellMeActor.instance.Hd&&
n.TellMeActor.instance.Hd.CH(h.a.Gbi,window.performance.now()-this.lLd),P()):Q<v.dlk?m.AFrameworkApplication.ye.Db(new z.a(2,1,v.yJl,()=>{this.Q1a(P,Q+1,D)})):D&&D()}static get instance(){v.Ka||(v.Ka=new v);return v.Ka}}v.Ka=null;v.dlk=20;v.yJl=500;Object(I.a)(v,"AddinEntitlementsQuery",null,[]);class y{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Yme=this.storeType=this.storeId=this.qLk=
this.iconUrl=null}}Object(I.a)(y,"AddinInfo",null,[]);var A=d(156),E=d(171),u=d(170),J=d(103),G=d(71);d.d(Y,"AddinResultsProvider",function(){return S});class S{constructor(P){this.eJd=[];this.qb=P;this.Btk=(Q,D,O)=>{if(Q){const X=Q.errorCode;if(n.TellMeActor.instance.Hd){const N={};N.StoreType=D;N.ErrorCode=X;N.AddinCount=Q.value?Q.value.length:0;n.TellMeActor.instance.Hd.CH(h.a.H2i,window.performance.now()-O,N)}if(0===X&&Q.value){S.l6a=S.l6a||{};Q=Q.value;for(const N of Q)Q=new y,Q.displayName=
N[0],Q.id=N[1],Q.description=N[2],Q.targetType=N[3],Q.appVersion=4<N.length?N[4]:"",Q.assetId=5<N.length?N[5]:"",Q.assetStoreId=6<N.length?N[6]:"",Q.width=7<N.length?N[7]:0,Q.height=8<N.length?N[8]:0,Q.iconUrl=9<N.length?N[9]:"",Q.qLk=10<N.length?N[10]:"",Q.storeId=11<N.length?N[11]:"",Q.storeType=12<N.length?N[12]:"",this.qb.Vnh&&(Q.Yme=this.$aj(Q)),S.l6a[Q.id]=Q,0<Q.iconUrl.length&&(D="AddinIcon_"+Q.id,m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)?this.Agh(D,Q.iconUrl):appChrome.addInApi.registerAddinIcon(D,Q.iconUrl))}}};v.instance.sNe(this.Btk,this.qb)}aE(){return"Add-ins"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(P,Q,D,O,X=null){D=new u.a(P);X&&!Array.contains(X,26)||J.a.MF(P)||(X=new E.a(26),X.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.Iaj(P.zf,X),D.Uq(X));Q.resultsUpdated(D)}Iaj(P,Q){if((P=this.u6k(P))&&0<P.length){let D=0;P.forEach(O=>{if(!(3<++D)){var X="AddinSuggestion"+D,N={};if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)){var aa="AddinIcon_"+O.id;0>Array.indexOf(this.eJd,aa)&&0<O.iconUrl.length&&this.Agh(aa,O.iconUrl);N["default"]=0<=Array.indexOf(this.eJd,aa)?aa:"AppForOfficeLogo_20"}else N["default"]=0<O.iconUrl.length?"AddinIcon_"+O.id:"AppForOfficeLogo_20";aa=[];aa.push(appChrome.actions.setControlLabel(X,O.displayName));aa.push(appChrome.actions.setControlIconSet(X,N));aa.push(appChrome.actions.setCompoundButtonCommandValueId(X,O.id));aa.push(appChrome.actions.updateCompoundButtonDescription(X,O.description));
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(N=window.performance.now(),aa.push(appChrome.actions.updateControlEnabledDisabledState(X,!1)),n.TellMeActor.instance.Hd&&n.TellMeActor.instance.Hd.CH(h.a.tQi,window.performance.now()-N));appChrome.api.dispatch(aa);X=new A.a(X,26,void 0,void 0,1);X.XPd=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.id,O.storeType,O.assetId,null,null,O.storeId);Q.ls(X)}})}}Agh(P,Q){G.c()&&appChrome.addInApi.registerAddinIcon&&
(appChrome.addInApi.registerAddinIcon(P,Q),Array.add(this.eJd,P))}u6k(P){if(!S.l6a)return null;const Q=[],D=S.l6a;for(let X in D){var O=D[X];O&&(this.qb.Vnh?S.wkk(P,O)&&Array.add(Q,O):0<=O.displayName.toLowerCase().indexOf(P.toLowerCase())?Array.add(Q,O):this.qb.KTj&&0<=O.description.toLowerCase().indexOf(P.toLowerCase())&&Array.add(Q,O))}return Q}$aj(P){const Q=S.Kxh(P.displayName);this.qb.Hbi&&Array.addRange(Q,S.Kxh(P.description));return Q}static wkk(P,Q){if(!Q.Yme)return!1;for(const D of P.split(" ")){P=
!1;for(const O of Q.Yme)if(O.toLowerCase().startsWith(D.toLowerCase())){P=!0;break}if(!P)return!1}return!0}static Kxh(P){const Q=[];for(const D of P.split(" ")){P=0;for(let O=0;O<D.length;O++){const X=D.charAt(O);X.toString().toUpperCase()===X.toString()&&O>P&&(Array.add(Q,D.substring(P,O)),P=O)}Array.add(Q,D.substring(P,D.length));P&&Array.add(Q,D.substring(0,D.length))}return Q}}S.l6a=null;Object(I.a)(S,"AddinResultsProvider",null,[654])},79:function(I,Y,d){d.r(Y);I=d(0);var h=d(24),e=d(223),n=
d(139),m=d(695),z=d(696);class B{constructor(y,A){this.TNa=!1;this.v4=null;if(!y)throw Error.argumentNull("annotations");if(!y.yAb(A))throw Error.argument("structTypeID","Invalid struct type ID");this.Gr=y;this.yBb=this.Gr.j4f(A);this.X0h=A}get Arb(){return this.Gr}get isReadOnly(){return this.TNa}get Yya(){return this.X0h}PSa(y){if(0>y||y>=this.yBb)throw Error.argument("iField","Invalid field index");return this.v4&&null!=this.v4[y]?this.v4[y]:this.Gr.j7f(this.Yya,y)}mVe(y,A){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");
if(0>y||y>=this.yBb)throw Error.argument("iField","Invalid field index");if(!this.Gr.xzb(this.Gr.g$a(this.Yya,y),A))throw Error.argument("value","Value is not of the correct type for the specified field");(this.v4||(this.v4=Array(this.yBb)))[y]=A}V1(){const {Annotations:y}=d(79);let A="[";if(this.v4){let E=!0;for(let u=0;u<this.yBb;++u){if(null==this.v4[u])continue;const J=this.Gr.g$a(this.Yya,u);if(y.P1a(J,this.v4[u],this.Gr.j7f(this.Yya,u)))continue;E?E=!1:A+=", ";A+=this.Gr.k7f(this.Yya,u);A+=
"=";const G=this.Gr.V1(J,this.v4[u]);J===y.aZ?(A+='"',A+=e.a.R1d(G),A+='"'):A+=G}}return A+"]"}isEqual(y){const {Annotations:A}=d(79);if(this===y)return!0;if(!y||this.Gr!==y.Arb||this.Yya!==y.Yya)return!1;for(let E=0;E<this.yBb;++E)if(!A.P1a(this.Gr.g$a(this.Yya,E),this.PSa(E),y.PSa(E)))return!1;return!0}clone(){const y=new B(this.Gr,this.Yya);this.v4&&(y.v4=Array.clone(this.v4));return y}VK(){return this.isReadOnly?this.clone():this}coe(){const {Annotations:y}=d(79);if(!this.isReadOnly&&(this.TNa=
!0,this.v4))for(let A=0;A<this.yBb;++A){const E=this.v4[A];null!=E&&y.Pbb(E)}}toString(){return this.V1()}}Object(I.a)(B,"StructValue",null,[1025,1023]);d.d(Y,"Annotations",function(){return v});class v{constructor(y,A){if(!y)throw Error.argumentNull("initData");if(!A)throw Error.argumentNull("objectFetcher");this.u7j=A.IOi;let E=0;var u=A.DSa(y.ga(E));++E;this.ZBe=new m.a(new z.a(u));this.RQh=y.ga(E);++E;this.Owg=Array(this.POc);this.edc=Array(this.POc);this.pWa=Array(this.POc);for(u=0;u<this.POc;++u){this.Owg[u]=
A.yC(y.ga(E));++E;this.edc[u]=y.ga(E);++E;var J=y.ga(E);++E;this.pWa[u]=Array(J);for(var G=0;G<J;++G)this.pWa[u][G]=A.yC(y.ga(E)),++E}this.W0h=y.ga(E);++E;this.sUg=Array(this.Yrc);this.Qad=Array(this.Yrc);this.Rad=Array(this.Yrc);this.Pad=Array(this.Yrc);for(u=0;u<this.Yrc;++u)for(this.sUg[u]=A.yC(y.ga(E)),++E,J=y.ga(E),++E,this.Qad[u]=Array(J),this.Rad[u]=Array(J),this.Pad[u]=Array(J),G=0;G<J;++G)this.Qad[u][G]=A.yC(y.ga(E)),++E,this.Rad[u][G]=y.ga(E),++E,this.Pad[u][G]=({Q3:E}=this.qsa(this.Rad[u][G],
y,E,null,null,null)).returnValue,v.Pbb(this.Pad[u][G]);this.sNh=y.ga(E);++E;this.Gpe=Array(this.Zrb);this.Hpe=Array(this.Zrb);this.Fpe=Array(this.Zrb);for(u=0;u<this.Zrb;++u)this.Gpe[u]=A.yC(y.ga(E)),++E,this.Hpe[u]=y.ga(E),++E,this.Fpe[u]=({Q3:E}=this.qsa(this.Hpe[u],y,E,null,null,null)).returnValue,v.Pbb(this.Fpe[u])}Y4b(y){for(let A=0;A<this.Zrb;++A)if(this.Gpe[A]===y)return A;return-1}FZf(y){if(!this.xAb(y))throw Error.argument("attrID","Invalid attribute ID");return this.Gpe[y]}getAttributeType(y){if(!this.xAb(y))throw Error.argument("attrID",
"Invalid attribute ID");return this.Hpe[y]}g$a(y,A){if(!this.yAb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.Rad[v.Zrc(y)];if(0>A||A>=y.length)throw Error.argument("iField","Invalid field index");return y[A]}V1(y,A){if(!this.Cme(y))throw Error.argument("typeID","Invalid type ID");if(!this.xzb(y,A))throw Error.argument("value","Value is not of the correct type");switch(y){case v.aZ:return A;case v.Fga:return A?"True":"False";case v.ipa:case v.Waa:return A.toString();case v.QM:return A.V1();
default:if(!v.QB(y)&&v.Ztc(y)){y=v.L1d(y);const J=this.pWa[y].length;switch(this.edc[y]){case 0:return this.pWa[y][A];case 1:if(A){var E="";for(var u=1;u<J;++u)A&1<<u-1&&(0<E.length&&(E+=" & "),E+=this.pWa[y][u]);return E}return this.pWa[y][0];case 2:E="";for(u=0;u<J;++u)A&1<<u&&(0<E.length&&(E+=" & "),E+=this.pWa[y][u]);return E;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.edc[y]);}}else return A.V1()}}Cme(y){switch(y){case v.aZ:case v.Fga:case v.ipa:case v.Waa:case v.QM:return!0;
default:return v.QB(y)?this.Cme(v.fEa(y)):v.Ztc(y)?this.PWj(y):this.yAb(y)}}PWj(y){y=v.L1d(y);return 0<=y&&y<this.Owg.length}yAb(y){y=v.Zrc(y);return 0<=y&&y<this.sUg.length}xAb(y){return 0<=y&&y<this.Zrb}xzb(y,A){if(null==A)return!1;switch(y){case v.aZ:return"string"===typeof A;case v.Fga:return"boolean"===typeof A;case v.ipa:return"number"===typeof A;case v.Waa:return"number"===typeof A;case v.QM:return Object(h.a)(1022,A);default:if(v.QB(y))return Object(h.a)(1024,A)&&A.yU===v.fEa(y);if(v.Ztc(y)){if("number"!==
typeof A)return!1;y=v.L1d(y);const E=this.pWa[y].length;switch(this.edc[y]){case 0:return 0<=A&&A<E;case 1:return!(A&-1<<E-1);case 2:return!!A&&!(A&-1<<E);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.edc[y]);}}else return Object(h.a)(1025,A)&&A.Yya===y}}get Zrb(){return this.sNh}get POc(){return this.RQh}get Yrc(){return this.W0h}y3i(y){if(!this.xAb(y))throw Error.argument("attrID","Invalid attribute ID");return this.Fpe[y]}j4f(y){if(!this.yAb(y))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.Qad[v.Zrc(y)].length}k7f(y,A){if(!this.yAb(y))throw Error.argument("structTypeID","Invalid struct type ID");return this.Qad[v.Zrc(y)][A]}j7f(y,A){if(!this.yAb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.Pad[v.Zrc(y)];if(0>A||A>=y.length)throw Error.argument("iField","Invalid field index");return y[A]}qsa(y,A,E,u,J,G){if(!A)throw Error.argumentNull("initData");if(v.QB(y)){var S=A.ga(E);++E;y=v.fEa(y);var P=new n.a(this,y);for(var Q=
0;Q<S;++Q)Array.add(P.items,({Q3:E}=this.qsa(y,A,E,u,J,G)).returnValue);return{returnValue:P,Q3:E}}switch(y){case v.aZ:return{returnValue:(u||this.ZBe).yC(A.ga(E++)),Q3:E};case v.Fga:return{returnValue:1===A.ga(E++),Q3:E};case v.ipa:return{returnValue:A.ga(E++),Q3:E};case v.Waa:return{returnValue:(J||this.u7j)[A.ga(E++)],Q3:E};case v.QM:y=A.ga(E++);S=new e.a(this);for(P=0;P<y;++P)Q=A.ga(E),++E,G&&(Q=G[Q]),S.ru(Q,({Q3:E}=this.qsa(this.getAttributeType(Q),A,E,u,J,G)).returnValue);return{returnValue:S,
Q3:E};default:if(v.Ztc(y))return{returnValue:A.ga(E++),Q3:E};if(v.OEh(y)){S=A.ga(E++);P=new B(this,y);for(Q=0;Q<S;++Q){const D=A.ga(E);++E;P.mVe(D,({Q3:E}=this.qsa(this.g$a(y,D),A,E,u,J,G)).returnValue)}return{returnValue:P,Q3:E}}throw Error.argument("typeID","Invalid type ID");}}static Ztc(y){return 16<=(y&16383)&&16384!==(y&16384)&&32768!==(y&32768)}static OEh(y){return 16<=(y&16383)&&16384===(y&16384)&&32768!==(y&32768)}static QB(y){return 32768===(y&32768)}static Ybj(y){if(v.QB(y))throw Error.argument("nonListTypeID",
"Non-list type ID required");return y|32768}static fEa(y){if(!v.QB(y))throw Error.argument("listTypeID","List type ID required");return y&-32769}static P1a(y,A,E){switch(y){case v.aZ:case v.Fga:case v.ipa:case v.Waa:return A===E;case v.QM:return A.isEqual(E);default:return v.QB(y)?A.isEqual(E):v.Ztc(y)?A===E:A.isEqual(E)}}static Pbb(y){Object(h.a)(1023,y)&&y.coe()}static VK(y){return Object(h.a)(1023,y)?y.VK():y}static L1d(y){return y-16}static Zrc(y){return(y&-16385)-16}}v.aZ=1;v.Fga=2;v.ipa=3;v.Waa=
5;v.QM=9;Object(I.a)(v,"Annotations",null,[1026])},976:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.Wxa=e}}Object(I.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},977:function(I,Y,d){d.r(Y);d.d(Y,"InsightsMenuItemFactory",function(){return m});I=d(0);var h=d(103),e=d(135),n=d(47);class m{constructor(z=null){this.hTh=z||CommonUIStrings.l_InsightsButtonText}get Vib(){return 10}ZK(z){var B=z.KJ;z=h.a.d4()?h.a.PCa(B,1):h.a.rYd(B);
B=String.format(this.hTh,B);return this.F1i(z,B)}F1i(z,B){return e.a(m.hfg,h.a.d4()?"1914896509":"3317204163",n.a.ue(B),h.a.ZGj,null,n.a.ue(z),n.a.ue(B),null,null)}}m.hfg="bInsights";Object(I.a)(m,"InsightsMenuItemFactory",null,[704])},978:function(I,Y,d){d.d(Y,"a",function(){return n});I=d(0);var h=d(135),e=d(47);class n{constructor(m,z,B,v,y){this.fKd=m;this.eKd=z;this.M1h=B;this.wSh=v;this.Kdf=y}get Vib(){return 4}ZK(m,z=null){z=z.sessionId+"|"+z.a9+"|"+m.KJ;if(this.Kdf||this.wSh){let B=this.Kdf||
e.a.OB(CommonUIStrings.l_HelpTooltip)===e.a.OB(m.KJ.trim());if(this.M1h&&2<m.KJ.length){const v=m.KJ;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===n.oce&&(B=!0)}m=B?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.KJ);return this.VYf(z,e.a.ue(m),B)}return this.VYf(z,e.a.ue(String.format(CommonUIStrings.l_TextWithQuotation,m.KJ)),!1)}VYf(m,z,B){return h.a(n.oce,B?this.eKd:this.fKd,z,"OfficeAssistant_16x16x32","A0",e.a.ue(m),
z,null,null)}}n.oce="bSearchHelp";Object(I.a)(n,"AssistanceMenuItemFactory",null,[704])},979:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(27),e=d(135),n=d(75),m=d(47);class z{get Vib(){return 13}ZK(){return z.eki()}static eki(){return e.b(z.EWf,"798637440",m.a.ue(CommonUIStrings.l_LookupFirstRunExperienceTitle),h.AFrameworkApplication.rm,n.getImageClass("Info_32x32x32"),null,null,m.a.ue(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,m.a.ue(CommonUIStrings.l_LookupFirstRunExperienceDescription),
null,null)}}z.EWf="bTellMeFirstRun";Object(I.a)(z,"FirstRunMenuItemFactory",null,[704])},980:function(I,Y,d){d.d(Y,"a",function(){return m});I=d(0);var h=d(27),e=d(135),n=d(47);class m{constructor(z=null,B=null){this.rjf=z;this.TWh=B||CommonUIStrings.l_LookupNoResultsDescription}get Vib(){return 14}ZK(z){z=String.format(this.TWh,z.KJ);return this.Oki(z)}Oki(z){return e.b(m.M_g,"798637440",n.a.ue(CommonUIStrings.l_LookupNoResultsTitle),this.rjf?h.AFrameworkApplication.rm:null,this.rjf,null,null,n.a.ue(CommonUIStrings.l_LookupNoResultsTitle),
"Menu32",null,null,n.a.ue(z),null,null)}}m.M_g="lookupNoResults";Object(I.a)(m,"NoCommandsFoundMenuItemFactory",null,[704])},981:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=n}}Object(I.a)(h,"LabelFormatted",null,[])},982:function(I,Y,d){d.d(Y,"a",function(){return B});I=d(0);d(144);var h=d(156),e=d(171),n=d(170),m=d(103),z=d(47);class B{constructor(v){this.qb=v}aE(){return"Assistance"}nL(){return 0===
this.qb.Aq?0:1===this.qb.Aq?1:this.qb.Mkc?3:2}fB(v,y,A=!1,E,u=null){E=new n.a(v);if((!u||Array.contains(u,8))&&!m.a.MF(v)){u=new e.a(8);if(A){A=z.a.OB(CommonUIStrings.l_HelpTooltip)===z.a.OB(v.zf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.zf);const J=[];this.qb.hVa&&(this.qb.cYe||J.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),A=this.d4f(v.zf));const G="||"+v.zf;J.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",
A));J.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",G));appChrome.api.dispatch(J);v=new h.a("GetHelpFromTellMe",4,v.zf,null,1)}else v=new h.a("bSearchHelp",4,v.zf,null,1);u.ls(v);u.displayName=CommonUIStrings.l_HelpButtonTitle;E.Uq(u)}y.resultsUpdated(E)}ATa(v,y=null){const A=new e.a(8),E=z.a.OB(CommonUIStrings.l_HelpTooltip)===z.a.OB(v.zf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.zf);for(let J=0;J<y.length&&2>J;J++){var u=
void 0;u=[];let G="GetHelpWithDescriptionFromTellMe"+(J+1).toString(),S=4;if(this.qb.Uqc)u.push(appChrome.actions.setControlLabel(G,E)),u.push(appChrome.actions.setCompoundButtonCommandValueId(G,v.zf)),u.push(appChrome.actions.updateCompoundButtonDescription(G,this.Omj(y.length)));else if(this.qb.Vqc){let P=this.k8f(y[J]);G="GetHelpFromTellMe"+(J+1).toString();this.qb.hVa&&(P=this.d4f(P));S=9;u.push(appChrome.actions.setControlLabel(G,P));u.push(appChrome.actions.setButtonCommandValueId(G,this.Mmj(y[J])))}appChrome.api.dispatch(u);
u=new h.a(G,S,null,null,0);u.label=this.k8f(y[J]);u.description=this.Lmj(y[J]);A.ls(u);if(this.qb.Vqc)break}A.displayName=CommonUIStrings.l_HelpButtonTitle;return A}Omj(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,v)}d4f(v){return this.qb.bme?m.a.m7d(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}k8f(v){return v.name?v.name:""}Lmj(v){return v.description?v.description:""}Mmj(v){return v.id?
"AssetID="+v.id:""}}Object(I.a)(B,"AssistanceResultsProvider",null,[654])},983:function(I,Y,d){d.d(Y,"a",function(){return v});I=d(0);d(144);var h=d(156),e=d(171),n=d(170),m=d(117),z=d(103),B=d(305);class v{constructor(y){this.qb=y}aE(){return"Image"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:3===this.qb.Aq?3:2}fB(y,A,E,u,J=null){E=new n.a(y);(!J||Array.contains(J,19))&&z.a.MF(y)&&this.qb.OH&&this.ATa(y,E,1);A.resultsUpdated(E)}ATa(y,A,E,u=null){var J=[];let G;m.TellMeActor.instance.WG()&&m.TellMeActor.instance.WG().hVa?
(G=this.qb.bme?z.a.m7d(y.zf,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):y.zf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.qb.cYe||J.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):G=this.qb.OH?z.a.MF(y)?this.qb.VPa?z.a.BSa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.qb.VPa?z.a.BSa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
y.zf)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,y.zf):this.qb.FMb?CommonUIStrings.l_TellMeImageSuggestionButtonText:y.zf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.qb.tda?(m.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",G)),J=z.a.PCa(y.zf,9,Object.assign(new B.a,{landingTab:"Image"})),m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",J))):(J.push(appChrome.actions.setControlLabel("ImageForSearch",
G)),y=z.a.PCa(y.zf,9,Object.assign(new B.a,{landingTab:"Image"})),J.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",y)),appChrome.api.dispatch(J));E=new h.a("ImageForSearch",12,null,null,E);u&&(E.score=u.ConfidenceScore);u=new e.a(19,this.qb.FMb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);u.ls(E);A.Uq(u)}}Object(I.a)(v,"ImageResultsProvider",null,[654])},984:function(I,Y,d){d.d(Y,"a",function(){return B});I=d(0);d(144);var h=d(156),e=d(171),n=d(170),m=
d(103),z=d(27);class B{constructor(v){this.qb=v}aE(){return"Template"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:3}fB(v,y){v=new n.a(v);y.resultsUpdated(v)}ATa(v,y,A){var E=[];let u;u=this.qb.OH?this.qb.VPa?m.a.BSa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,v.zf)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,v.zf):String.format(CommonUIStrings.l_TellMeTemplateButtonText,v.zf);E.push(appChrome.actions.setControlLabel("TemplateForSearch",u));E.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(z.AFrameworkApplication.fa.Ga("TellMeTemplateProviderURL"),z.AFrameworkApplication.uiCulture,v.zf)));appChrome.api.dispatch(E);v=new e.a(23);v.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;E=new h.a("TemplateForSearch",24,null,null,0);E.label=A[0].Title?A[0].Title:"";E.description=A[0].Description?A[0].Description:"";v.ls(E);y.Uq(v)}}Object(I.a)(B,"TemplateResultsProvider",null,[654])},985:function(I,Y,d){d.d(Y,"a",function(){return A});I=d(0);d(144);var h=d(335),e=d(156),
n=d(171),m=d(170),z=d(694),B=d(117),v=d(103),y=d(47);class A{constructor(E,u,J,G){this.oS=E;this.nPa=u;this.aqf=G;this.yRh=J;this.qb=B.TellMeActor.instance.WG()}aE(){return"EmptyQuery"}nL(){return 1===this.qb.Aq?1:0}fB(E,u,J=!1,G,S=null){G=new m.a(E);if((!S||Array.contains(S,5)||Array.contains(S,6)||Array.contains(S,4))&&v.a.MF(E)){this.oS.r5b().length||!this.yRh||this.aqf||(E=new n.a(6),S=new e.a(null,13,void 0,void 0,1),E.ls(S),G.Uq(E));E=new n.a(4);if(0<this.oS.r5b().length){E.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;
S=this.oS.r5b();var P=[];for(var Q of S)P.push(Q.Id);h.CommandResultsUtility.cPb(P,this.qb);for(var D of S)h.CommandResultsUtility.s9b(D.Id)&&E.ls(new e.a(D.Id,5,null,null,2));G.Uq(E)}if(this.aqf&&0<this.nPa.length&&this.oS.r5b().length<A.nYg){Q=new n.a(5);Q.displayName=CommonUIStrings.l_TellMeTryQueryTitle;D=A.nYg-E.results.length;E=[];for(S=0;S<this.nPa.length&&S<D;++S){if(J){P=v.a.w3e+(S+1);const O=this.nPa[S].key,X=y.a.replaceAll(O,'"',"");E.push(appChrome.actions.setControlLabel(P,O));E.push(appChrome.actions.setButtonCommandValueId(P,
X));P=new z.a(O,7,0,X,P)}else P=new z.a(this.nPa[S].key,7,0,this.nPa[S].value);Q.ls(P)}0<E.length&&appChrome.api.dispatch(E);G.Uq(Q)}}u.resultsUpdated(G)}}A.nYg=5;Object(I.a)(A,"EmptyQueryResultsProvider",null,[654])},986:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.jsd=this.Sta=this.aUa=this.gt=this.uIc=this.Fz=this.emb=0}}Object(I.a)(h,"TRIESCAN",null,[])},987:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.Service=0]="Service";
e[e.Local=1]="Local";e[e.MRU=2]="MRU";e[e.TestResult=3]="TestResult";e[e.Unknown=4]="Unknown"})(h||(h={}));Object(I.b)("SubResultType",h)},999:function(I,Y,d){d.r(Y);var h=d(0),e=d(144),n=d(383),m=d(263),z=d(156),B=d(171),v=d(170),y=d(117),A=d(103),E=d(305);class u{constructor(Aa){this.qb=Aa}aE(){return"ActionAI"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb=!1,Fb,dc=null){Fb=new v.a(Aa);if(!dc||Array.contains(dc,24))if(this.Oil()||!A.a.MF(Aa)){dc=new B.a(24);var zc=A.a.MF(Aa);cb&&(cb=
null,A.a.d4()&&(cb=A.a.PCa(zc?"":Aa.zf,1,Object.assign(new E.a,{landingTab:"ActionAI"}))),this.qb.tda?cb&&y.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",cb)):(Aa=[],cb&&Aa.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",cb)),appChrome.api.dispatch(Aa)));dc.ls(new z.a("ActionAIFromTellMe",25,null,null,1));Fb.Uq(dc)}Ma.resultsUpdated(Fb)}Oil(){return A.a.d4()&&this.qb.lYc}}Object(h.a)(u,"ActionAIResultsProvider",null,[654]);var J=
d(707);class G{constructor(Aa,Ma){this.$wd=Aa;this.Sh=Ma}resultsUpdated(Aa){this.$wd.Kcl(this.Sh,Aa)}}Object(h.a)(G,"AggregatorResultsProviderCallback",null,[959]);class S{constructor(Aa){this.lba=null;this.qb=Aa;this.qb.r6a&&(this.lba=null)}aE(){return"AppsForOffice"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb,Fb,dc=null){cb=new v.a(Aa);if(!dc||Array.contains(dc,1))dc=new B.a(1),this.lba.$Ll(dc,Aa.zf),cb.Uq(dc);Ma.resultsUpdated(cb)}}Object(h.a)(S,"AppsForOfficeRecommendationResultsProvider",
null,[654]);var P=d(982),Q=d(79),D=d(223),O=d(24);class X{constructor(Aa,Ma){this.Ia=Aa;this.R7j=Ma}isMatch(Aa,Ma){if(!Object(O.a)(1022,Aa))throw Error.argument("objToTest","Expected feature bundle");let cb;return({value:cb}=Aa.Rm(this.Ia.pca)).returnValue?this.Ia.Q5e.isMatch(cb,Ma):this.R7j}}Object(h.a)(X,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1055]);class N{constructor(Aa,Ma){this.Ia=Aa;this.yte=Ma}isMatch(Aa){if(!Object(O.a)(1022,Aa))throw Error.argument("objToTest","Expected feature bundle");
return!!(this.yte^Aa.Rm(this.Ia.pca).returnValue)}}Object(h.a)(N,"AnnotatedWithAnnotationFilter",null,[1055]);class aa{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){if(!Object(O.a)(1025,Aa))throw Error.argument("objToTest","Expected struct value");return this.Ia.Q5e.isMatch(Aa.PSa(this.Ia.Ssa),Ma)}}Object(h.a)(aa,"FieldValueMatchesStructFilter",null,[1055]);class V{constructor(Aa,Ma){Aa&&(this.Ssa=Aa.ga(0),this.Q5e=Ma.J8(Aa.ga(1)))}}Object(h.a)(V,"FieldValueMatchesStructFilterInit",null,[]);class ca{constructor(Aa){this.yte=
Aa}isMatch(Aa){if(!Object(O.a)(1022,Aa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.yte^Aa.Hbe)}}Object(h.a)(ca,"HasAnnotationsAnnotationFilter",null,[1055]);class fa{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa,Ma){if(!Object(O.a)(1024,Aa))throw Error.argument("objToTest","Expected list value");switch(this.Lq){case 0:for(const cb of Aa.items)if(this.Ia.filter.isMatch(cb,Ma))return!0;return!1;case 1:for(const cb of Aa.items)if(!this.Ia.filter.isMatch(cb,Ma))return!1;
return!0;default:throw Error.notImplemented();}}}Object(h.a)(fa,"ItemTestListFilter",null,[1055]);class ma{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){if(!Object(O.a)(1024,Aa))throw Error.argument("objToTest","Expected list value");return this.Ia.filter.isMatch(Aa.items.length,Ma)}}Object(h.a)(ma,"LengthMatchesListFilter",null,[1055]);class da{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa,Ma,cb=null){let Fb=0===this.Lq;for(const dc of this.Ia.GEf)if((Fb=dc.isMatch(Aa,Ma,cb))?1===this.Lq:0===this.Lq)return Fb;
2===this.Lq&&(Fb=!Fb);return Fb}}Object(h.a)(da,"NonterminalFilter",null,[1055]);class qa{constructor(Aa,Ma){if(Aa){var cb=Aa.ga(0);this.GEf=Array(cb);for(let Fb=0;Fb<cb;++Fb)this.GEf[Fb]=Ma.J8(Aa.ga(1+Fb))}}}Object(h.a)(qa,"NonterminalFilterInit",null,[]);class F{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa,Ma){if("number"!==typeof Aa)throw Error.argument("objToTest","Expected number value");let cb=this.Ia.number;if(this.Ia.query){Ma=this.Ia.query.np(null,Ma);if("number"!==typeof Ma)throw Error.invalidOperation("Query did not return number");
cb+=Ma}switch(this.Lq){case 0:return Aa===cb;case 1:return Aa<cb;case 2:return Aa<=cb;case 3:return Aa>cb;case 4:return Aa>=cb;default:throw Error.notImplemented();}}}Object(h.a)(F,"NumberFilter",null,[1055]);class sa{constructor(Aa,Ma){Aa&&(this.number=Aa.ga(0),this.query=Aa.ga(1)?Ma.VD(Aa.ga(1)):null)}}Object(h.a)(sa,"NumberFilterInit",null,[]);class ia{constructor(Aa,Ma,cb){this.ySc=this.w9i;this.CHa=Aa;this.Xxg=Ma;this.Vxg=cb}sUd(Aa){this.Xxg=Aa}w9i(Aa){if(!Aa)throw Error.argument("name","Invalid named feature bundle reference");
const Ma=Aa.substr(1);return 1===Aa.charCodeAt(0)&&Ma===this.CHa?this.Xxg:this.Vxg?this.Vxg.ySc(Aa):null}}Object(h.a)(ia,"SimpleNamedFeatureBundleResolver",null,[1133]);class Na{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){if(!Object(O.a)(1022,Aa))throw Error.argument("objToTest","Expected feature bundle");Aa=this.Ia.query.np(null,new ia(this.Ia.tvd,Aa,Ma));if("boolean"!==typeof Aa)throw Error.invalidOperation("Query did not return bool");return Aa}}Object(h.a)(Na,"PredicateAnnotationFilter",null,[1055]);
class Ca{constructor(Aa,Ma){Aa&&(this.tvd=Ma.yC(Aa.ga(0)),this.query=Ma.VD(Aa.ga(1)))}}Object(h.a)(Ca,"PredicateAnnotationFilterInit",null,[]);class ha{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){if("boolean"!==typeof Aa)throw Error.argument("objToTest","Expected bool value");Ma=this.Ia.query.np(null,Ma);if("boolean"!==typeof Ma)throw Error.invalidOperation("Query did not return bool");return Aa===Ma}}Object(h.a)(ha,"QueryBooleanFilter",null,[1055]);class Ba{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa,
Ma){if("number"!==typeof Aa)throw Error.argument("objToTest","Expected integer");Ma=this.Ia.query.np(null,Ma);if("number"!==typeof Ma)throw Error.invalidOperation("Query did not return an enum value");switch(this.Lq){case 0:return Aa===Ma;case 1:return 0!==(Aa&Ma);case 2:return Aa===(Aa&Ma);case 3:return Ma===(Aa&Ma);default:throw Error.notImplemented();}}}Object(h.a)(Ba,"QueryEnumFilter",null,[1055]);class va{constructor(Aa,Ma){Aa&&(this.XZc=1===Aa.ga(0),this.query=Ma.VD(Aa.ga(1)))}}Object(h.a)(va,
"QueryEnumFilterInit",null,[]);class ta{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa,Ma){if(!Object(O.a)(1024,Aa))throw Error.argument("objToTest","Expected list value");Ma=this.Ia.query.np(null,Ma);if(!Object(O.a)(1024,Ma))throw Error.invalidOperation("Query did not return list value");if(Aa.yU!==Ma.yU)return!1;switch(this.Lq){case 0:return Q.Annotations.P1a(Q.Annotations.Ybj(Aa.yU),Aa,Ma);case 1:for(const cb of Aa.items)for(const Fb of Ma.items)if(Q.Annotations.P1a(Aa.yU,cb,Fb))return!0;
return!1;case 2:for(const cb of Aa.items)for(const Fb of Ma.items)if(!Q.Annotations.P1a(Aa.yU,cb,Fb))return!1;return!0;case 3:for(const cb of Ma.items)for(const Fb of Aa.items)if(!Q.Annotations.P1a(Aa.yU,cb,Fb))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(ta,"QueryListFilter",null,[1055]);class Fa{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa,Ma){if("string"!==typeof Aa)throw Error.argument("objToTest","Expected string");Ma=this.Ia.query.np(null,Ma);if("string"!==typeof Ma)throw Error.invalidOperation("Query did not return string");
this.Ia.Iie&&(Aa=Aa.toUpperCase(),Ma=Ma.toUpperCase());switch(this.Lq){case 0:return Aa===Ma;case 1:return 0<=Aa.indexOf(Ma);case 2:return Aa.startsWith(Ma);case 3:return Aa.endsWith(Ma);case 4:return 0<=Ma.indexOf(Aa);case 5:return Ma.startsWith(Aa);case 6:return Ma.endsWith(Aa);default:throw Error.notImplemented();}}}Object(h.a)(Fa,"QueryStringFilter",null,[1055]);class pa{constructor(Aa,Ma){Aa&&(this.query=Ma.VD(Aa.ga(0)),this.Iie=1===Aa.ga(1))}}Object(h.a)(pa,"QueryStringFilterInit",null,[]);
class ka{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){if(!Object(O.a)(1025,Aa))throw Error.argument("objToTest","Expected struct value");Ma=this.Ia.query.np(null,Ma);if(!Object(O.a)(1025,Ma))throw Error.invalidOperation("Query did not return struct value");return Aa.isEqual(Aa)}}Object(h.a)(ka,"QueryStructFilter",null,[1055]);class Ha{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){Aa=this.Ia.query.np(null,Ma);if("boolean"!==typeof Aa)throw Error.invalidOperation("Query did not return bool");return Aa}}Object(h.a)(Ha,
"QueryWhereConstraintFilter",null,[1055]);class Ya{constructor(Aa){this.Ia=Aa}isMatch(Aa){if("string"!==typeof Aa)throw Error.argument("objToTest","Expected string");return this.Ia.regex.test(Aa)}}Object(h.a)(Ya,"RegexStringFilter",null,[1055]);class Ka{constructor(Aa,Ma){Aa&&(this.regex=Ma.y5f(Aa.ga(0)))}}Object(h.a)(Ka,"RegexStringFilterInit",null,[]);class Pa{constructor(Aa,Ma){Aa&&(this.filter=Ma.J8(Aa.ga(0)))}}Object(h.a)(Pa,"SingleFilterFilterInit",null,[]);class Oa{constructor(Aa,Ma){Aa&&(this.query=
Ma.VD(Aa.ga(0)))}}Object(h.a)(Oa,"SingleQueryFilterInit",null,[]);class oa{constructor(Aa){this.Ia=Aa}isMatch(Aa){if("boolean"!==typeof Aa)throw Error.argument("objToTest","Expected bool value");return Aa===this.Ia.value}}Object(h.a)(oa,"StoredValueBooleanFilter",null,[1055]);class Xa{constructor(Aa){Aa&&(this.value=1===Aa.ga(0))}}Object(h.a)(Xa,"StoredValueBooleanFilterInit",null,[]);class Hb{constructor(Aa,Ma){this.Ia=Aa;this.Lq=Ma}isMatch(Aa){if("number"!==typeof Aa)throw Error.argument("objToTest",
"Expected integer");switch(this.Lq){case 0:return this.Ia.XZc?this.Ia.value?!!(Aa&this.Ia.value):!Aa:Aa===this.Ia.value;case 1:return this.Ia.XZc?(Aa&this.Ia.value)===this.Ia.value:32>Aa&&(1<<Aa&this.Ia.value)===this.Ia.value;case 2:return this.Ia.XZc?!!(Aa&this.Ia.value):32>Aa&&!!(1<<Aa&this.Ia.value);default:throw Error.notImplemented();}}}Object(h.a)(Hb,"StoredValueEnumFilter",null,[1055]);class Ob{constructor(Aa){Aa&&(this.XZc=1===Aa.ga(0),this.value=Aa.ga(1))}}Object(h.a)(Ob,"StoredValueEnumFilterInit",
null,[]);class eb{constructor(){this.hCk=null;this.fTd=this.T$a=0}}Object(h.a)(eb,"WHEREConstraintData",null,[]);class Eb{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma){if(!Object(O.a)(eb,Aa))throw Error.argument("objToTest","Expected WHERE constraint data");let cb=-1,Fb=-1;const dc=Aa.hCk;switch(this.Ia.lUd){case 4:cb=dc.q4b;Fb=dc.QZe;break;case 5:cb=Aa.T$a;Fb=dc.q4b-Aa.T$a;break;case 6:cb=dc.q4b+dc.QZe;Fb=Aa.T$a+Aa.fTd-cb;break;case 1:case 2:case 3:let zc=!1;for(let Vc=dc.nMl;Vc;Vc=Vc.next)if(this.Ia.kHl===
Vc.name){zc=!0;1===this.Ia.lUd?(cb=Vc.q4b,Fb=Vc.QZe):2===this.Ia.lUd?(cb=Aa.T$a,Fb=Vc.q4b-Aa.T$a):(cb=Vc.q4b+Vc.QZe,Fb=Aa.T$a+Aa.fTd-cb);break}if(!zc)return!1;break;case 7:cb=Aa.T$a;Fb=Aa.fTd;break;default:throw Error.notImplemented();}return null!==this.Ia.wpl.LMl(dc.pOl,cb,Fb,cb,!0,2,Ma)}}Object(h.a)(Eb,"SubSreWhereConstraintFilter",null,[1055]);class oc{constructor(Aa,Ma){if(Aa){var cb=Ma.yC(Aa.ga(0));this.lUd=cb.charCodeAt(0);this.kHl=cb.substr(1);this.wpl=Ma.Ihj(Aa.ga(1))}}}Object(h.a)(oc,"SubSreWhereConstraintFilterInit",
null,[]);class Sb{constructor(Aa){this.Ia=Aa}isMatch(Aa,Ma,cb=null){if(!Object(O.a)(1022,Aa))throw Error.argument("objToTest","Expected feature bundle");if(null==cb)throw Error.argumentNull("parentTextForSpan");if(this.Ia.bwf&&!this.Ia.bwf.isMatch(Aa,Ma))return!1;if(this.Ia.q1e){let Fb;if(({value:Fb}=Aa.Rm(this.Ia.Rol)).returnValue){if(!this.Ia.q1e.isMatch(Fb,Ma))return!1}else{let dc,zc;if(!({value:dc}=Aa.Rm(this.Ia.xxh)).returnValue||!({value:zc}=Aa.Rm(this.Ia.wxh)).returnValue||0>dc||0>zc||dc+zc>
cb.length||!this.Ia.q1e.isMatch(cb.substr(dc,zc),Ma))return!1}}if(this.Ia.$xh){let Fb;if(!({value:Fb}=Aa.Rm(this.Ia.xxh)).returnValue||!this.Ia.$xh.isMatch(Fb,Ma))return!1}if(this.Ia.jpg){let Fb;if(!({value:Fb}=Aa.Rm(this.Ia.wxh)).returnValue||!this.Ia.jpg.isMatch(Fb,Ma))return!1}return!0}}Object(h.a)(Sb,"TextSpanFilter",null,[1055]);class qc{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.xxh=Aa.ga(0),this.wxh=Aa.ga(1),this.Rol=Aa.ga(2),this.q1e=Aa.ga(3)?Ma.J8(Aa.ga(3)):null,this.bwf=
Aa.ga(4)?Ma.J8(Aa.ga(4)):null,this.$xh=Aa.ga(5)?Ma.J8(Aa.ga(5)):null,this.jpg=Aa.ga(6)?Ma.J8(Aa.ga(6)):null)}}Object(h.a)(qc,"TextSpanFilterInit",null,[]);class $a{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.pca=Aa.ga(0),this.Q5e=Aa.ga(1)?Ma.J8(Aa.ga(1)):null)}}Object(h.a)($a,"ValueFilterAnnotationFilterInit",null,[]);var ab=d(281);class Ib{J8(Aa,Ma){const cb=Aa.ga(0),Fb=new ab.a;Fb.tSa(Aa,1,Aa.count-1);switch(cb){case 1:return new da(new qa(Fb,Ma),0);case 2:return new da(new qa(Fb,
Ma),1);case 3:return new da(new qa(Fb,Ma),2);case 101:return new Ya(new Ka(Fb,Ma));case 103:return new Fa(new pa(Fb,Ma),0);case 104:return new Fa(new pa(Fb,Ma),1);case 105:return new Fa(new pa(Fb,Ma),2);case 106:return new Fa(new pa(Fb,Ma),3);case 107:return new Fa(new pa(Fb,Ma),4);case 108:return new Fa(new pa(Fb,Ma),5);case 109:return new Fa(new pa(Fb,Ma),6);case 201:return new oa(new Xa(Fb));case 202:return new ha(new Oa(Fb,Ma));case 301:return new F(new sa(Fb,Ma),0);case 302:return new F(new sa(Fb,
Ma),1);case 303:return new F(new sa(Fb,Ma),2);case 304:return new F(new sa(Fb,Ma),3);case 305:return new F(new sa(Fb,Ma),4);case 401:return new Hb(new Ob(Fb),0);case 402:return new Hb(new Ob(Fb),1);case 403:return new Hb(new Ob(Fb),2);case 404:return new Ba(new va(Fb,Ma),0);case 405:return new Ba(new va(Fb,Ma),1);case 406:return new Ba(new va(Fb,Ma),2);case 407:return new Ba(new va(Fb,Ma),3);case 501:return new aa(new V(Fb,Ma));case 502:return new ka(new Oa(Fb,Ma));case 601:return new fa(new Pa(Fb,
Ma),0);case 602:return new fa(new Pa(Fb,Ma),1);case 603:return new ma(new Pa(Fb,Ma));case 604:return new ta(new Oa(Fb,Ma),0);case 605:return new ta(new Oa(Fb,Ma),1);case 606:return new ta(new Oa(Fb,Ma),2);case 607:return new ta(new Oa(Fb,Ma),3);case 701:return new ca(!1);case 702:return new ca(!0);case 703:return new N(new $a(Fb,Ma),!1);case 704:return new N(new $a(Fb,Ma),!0);case 705:return new X(new $a(Fb,Ma),!1);case 706:return new X(new $a(Fb,Ma),!0);case 707:return new Na(new Ca(Fb,Ma));case 901:return new Sb(new qc(Fb,
Ma));case 1002:return new Ha(new Oa(Fb,Ma));case 1001:return new Eb(new oc(Fb,Ma));default:throw Error.argument("initData");}}}Object(h.a)(Ib,"FilterFactory",null,[1021]);var gc=d(139);class Ta{constructor(Aa){this.Ia=Aa}get fy(){return this.Ia.fy}get NU(){return this.Ia.NU}get Lrd(){return this.Ia.Lrd}get IYc(){return this.Ia.IYc}load(Aa,Ma){return this.np(Aa,Aa?new ia("root",Aa,Ma):Ma)}store(Aa,Ma,cb){this.qNb(Aa,Ma,Aa?new ia("root",Aa,cb):cb,null)}np(Aa,Ma){if(!this.IYc&&!this.Ia.annotations.xzb(this.fy,
Aa))throw Error.argument("input","Input value not of expected type");let cb=this.Ia.IWf;for(;cb;)Aa=cb.load(Aa,Ma),cb=cb.next;return Aa}qNb(Aa,Ma,cb,Fb){if(!this.Lrd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.IYc&&!this.Ia.annotations.xzb(this.fy,Aa))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ia.annotations.xzb(this.NU,Ma))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ia.IWf.store(Aa,Ma,cb,Fb)}static rGf(Aa,
Ma,cb,Fb){if(cb===Fb)return Ma;if(Q.Annotations.QB(cb)&&Q.Annotations.QB(Fb)){cb=Q.Annotations.fEa(cb);Fb=Q.Annotations.fEa(Fb);const dc=new gc.a(Aa,Fb);for(const zc of Ma.items)Array.add(dc.items,Ta.rGf(Aa,zc,cb,Fb));return dc}if(cb===Q.Annotations.ipa){if(Fb===Q.Annotations.Waa)return Ma;if(Fb===Q.Annotations.aZ)return Ma.toString()}else if(cb===Q.Annotations.Waa){if(Fb===Q.Annotations.ipa)return Math.floor(Ma);if(Fb===Q.Annotations.aZ)return Ma.toString()}else if(cb===Q.Annotations.aZ){if(Fb===
Q.Annotations.ipa)return parseInt(Ma);if(Fb===Q.Annotations.Waa)return parseFloat(Ma)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(h.a)(Ta,"AnnotationQuery",null,[1104]);class Ab{constructor(){this.NU=this.fy=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}jEa(Aa){if(this.next)return{returnValue:this.next,Voa:Aa};if(Aa){const Ma=Aa.lIf;Aa=Aa.Bbh;return{returnValue:Ma,Voa:Aa}}return{returnValue:null,Voa:Aa}}}Object(h.a)(Ab,"AnnotationQueryStep",
null,[1203]);class kc extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Ma=this.Ia.query.np(Aa,Ma);if(Q.Annotations.QB(this.fy)){var cb=Q.Annotations.fEa(this.fy);let dc=new gc.a(this.Ia.annotations,cb);if(Q.Annotations.QB(this.Ia.query.NU)){if(Aa.items.length!==Ma.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let zc=0,Vc=Aa.items.length;zc<Vc;++zc)Array.add(dc.items,this.QIc(Aa.items[zc],Ma.items[zc],cb===Q.Annotations.Waa))}else for(var Fb of Aa.items)Array.add(dc.items,
this.QIc(Fb,Ma,cb===Q.Annotations.Waa));return dc}if(Q.Annotations.QB(this.Ia.query.NU)){Fb=new gc.a(this.Ia.annotations,this.fy);for(cb of Ma.items)Array.add(Fb.items,this.QIc(Aa,cb,this.fy===Q.Annotations.Waa));return Fb}return this.QIc(Aa,Ma,this.fy===Q.Annotations.Waa)}QIc(Aa,Ma,cb){Aa=this.Isb(Aa,Ma);return cb?Aa:Math.floor(Aa)}}Object(h.a)(kc,"NumericAnnotationQueryStep",Ab,[]);class fb extends kc{constructor(Aa){super(Aa)}Isb(Aa,Ma){return Aa+Ma}}Object(h.a)(fb,"AddAnnotationQueryStep",kc,
[]);class Qb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){if(this.fy===Q.Annotations.Fga&&this.Ia.query.NU===Q.Annotations.Fga){let dc;if(({result:dc}=this.eDf(Aa)).returnValue)return dc}if(Q.Annotations.QB(this.fy)){var cb=new gc.a(this.Ia.annotations,Q.Annotations.Fga);Ma=this.Ia.query.np(Aa,Ma);if(Q.Annotations.QB(this.Ia.query.NU)){if(Aa.items.length!==Ma.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let dc=0,zc=Aa.items.length;dc<
zc;++dc)Array.add(cb.items,this.G0b(Ma.items[dc],Aa.items[dc]))}else for(var Fb of Aa.items)Array.add(cb.items,this.G0b(Ma,Fb));return cb}Fb=this.Ia.query.np(Aa,Ma);if(Q.Annotations.QB(this.Ia.query.NU)){Ma=new gc.a(this.Ia.annotations,Q.Annotations.Fga);for(cb of Fb.items)Array.add(Ma.items,this.G0b(cb,Aa));return Ma}return this.G0b(Fb,Aa)}}Object(h.a)(Qb,"BinaryBooleanAnnotationQueryStep",Ab,[]);class mb extends Qb{constructor(Aa){super(Aa)}eDf(Aa){return{returnValue:!Aa,result:!1}}G0b(Aa,Ma){return Aa&&
Ma}}Object(h.a)(mb,"AndAnnotationQueryStep",Qb,[]);class Jb{constructor(Aa){Aa&&(this.annotations=Aa)}}Object(h.a)(Jb,"AnnotationsOnlyQueryStepInit",null,[]);class Ub extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Ma=this.Ia.query.np(Aa,Ma);Aa=Aa.clone();Q.Annotations.QB(this.Ia.query.NU)?Array.addRange(Aa.items,Ma.items):Array.add(Aa.items,Ma);return Aa}}Object(h.a)(Ub,"AppendAnnotationQueryStep",Ab,[]);class tb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){if(this.fy===Q.Annotations.QM)return this.J3b(Aa,
Ma);const cb=new gc.a(this.Ia.annotations,Q.Annotations.QM);for(const Fb of Aa.items)Array.add(cb.items,this.J3b(Fb,Ma));return cb}J3b(Aa,Ma){const cb=new D.a(this.Ia.annotations);cb.ECa(Aa);Aa=new D.a(this.Ia.annotations);this.Ia.script.v8(null,new ia("Input",cb,new ia("Output",Aa,Ma)));return Aa}}Object(h.a)(tb,"ApplyAnnotationQueryStep",Ab,[]);class Bc extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){if(this.fy===Q.Annotations.QM)return Ma=this.J3b(Aa,Ma),Ma.Rm(this.Ia.awf).returnValue||
new gc.a(this.Ia.annotations,Q.Annotations.QM),Ma;const cb=new gc.a(this.Ia.annotations,Q.Annotations.QM);for(const Fb of Aa.items)if(Aa=this.J3b(Fb,Ma),({value:Aa}=Aa.Rm(this.Ia.awf)).returnValue)for(const dc of Aa.items)Array.add(cb.items,dc);return cb}J3b(Aa,Ma){const cb=new D.a(this.Ia.annotations);cb.ECa(Aa);Aa=new D.a(this.Ia.annotations);this.Ia.script.v8(null,new ia("Input",cb,new ia("Output",Aa,Ma)));return Aa}}Object(h.a)(Bc,"ApplyExpandAnnotationQueryStep",Ab,[]);class Gb{constructor(Aa,
Ma){Aa&&(this.annotations=Ma.annotations,this.script=Ma.n9a(Aa.ga(0)),this.awf=Aa.ga(1))}}Object(h.a)(Gb,"ApplyExpandQueryStepInit",null,[]);class Hc{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.script=Ma.n9a(Aa.ga(0)))}}Object(h.a)(Hc,"ApplyQueryStepInit",null,[]);class $b extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){if(this.fy===Q.Annotations.QM)return this.R1c(Aa);const Ma=new gc.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.pca));for(const cb of Aa.items)Array.add(Ma.items,
this.R1c(cb));return Ma}store(Aa,Ma,cb,Fb){if(this.fy===Q.Annotations.QM){var dc=Ma,zc=({Voa:Fb}=this.jEa(Fb)).returnValue;zc&&(dc=zc.store(Q.Annotations.VK(this.R1c(Aa)),Ma,cb,Fb));Aa.ru(this.Ia.pca,dc)}else{var Vc=Ma;if(dc=({Voa:Fb}=this.jEa(Fb)).returnValue){Vc=new gc.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.pca));for(zc of Aa.items)Array.add(Vc.items,this.R1c(zc));Vc=dc.store(Vc,Ma,cb,Fb)}Ma=Vc;if(Ma.items.length!==Aa.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let rd=0,Z=Aa.items.length;rd<Z;++rd)cb=Aa.items[rd],cb.isReadOnly&&(cb=cb.clone(),Aa.items[rd]=cb),cb.ru(this.Ia.pca,Ma.items[rd])}return Aa}R1c(Aa){({value:Aa}=Aa.Rm(this.Ia.pca)).returnValue||(Aa=this.Ia.annotations.y3i(this.Ia.pca));return Aa}}Object(h.a)($b,"AttrAnnotationQueryStep",Ab,[]);class lc{constructor(Aa,Ma){Aa&&(this.annotations=Ma,this.pca=Aa.ga(0))}}Object(h.a)(lc,"AttrQueryStepInit",null,[]);class Vb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){const Ma=new D.a(this.Ia.annotations);
Ma.ECa(Aa);return this.Ia.module.execute(Ma)}}Object(h.a)(Vb,"CallModuleAnnotationQueryStep",Ab,[]);class ic{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.module=Ma.A8d(Aa.ga(0)))}}Object(h.a)(ic,"CallModuleQueryStepInit",null,[]);class qb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){if(Q.Annotations.QB(this.fy)){var cb=this.Ia.query.np(Aa,Ma);Ma=new gc.a(this.Ia.annotations,Q.Annotations.aZ);let zc="string"===typeof cb;for(var Fb of Aa.items)if(zc)Array.add(Ma.items,Fb+
cb);else for(var dc of cb.items)Array.add(Ma.items,Fb+dc);return Ma}Fb=this.Ia.query.np(Aa,Ma);if("string"===typeof Fb)return Aa+Fb;dc=new gc.a(this.Ia.annotations,Q.Annotations.aZ);for(cb of Fb.items)Array.add(dc.items,Aa+cb);return dc}}Object(h.a)(qb,"ConcatAnnotationQueryStep",Ab,[]);class Wb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){return Ta.rGf(this.Ia.annotations,Aa,this.fy,this.NU)}}Object(h.a)(Wb,"ConvertAnnotationQueryStep",Ab,[]);class Xc extends Ab{constructor(){super()}load(Aa){return Aa.items.length}}
Object(h.a)(Xc,"CountAnnotationQueryStep",Ab,[]);class xb extends kc{constructor(Aa){super(Aa)}Isb(Aa,Ma){return Aa/Ma}}Object(h.a)(xb,"DivideAnnotationQueryStep",kc,[]);class Rb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Ma=new ia(this.Ia.tvd,null,Ma);for(const cb of Aa.items)if(Ma.sUd(cb),this.Ia.query.np(cb,Ma))return!0;return!1}}Object(h.a)(Rb,"ExistsAnnotationQueryStep",Ab,[]);class wc extends kc{constructor(Aa){super(Aa)}Isb(Aa,Ma){return Math.pow(Aa,Ma)}}Object(h.a)(wc,"ExpAnnotationQueryStep",
kc,[]);class ud{constructor(Aa,Ma){Aa&&(this.Rsa=Ma.yC(Aa.ga(0)))}}Object(h.a)(ud,"FeatureBundleNameQueryStepInit",null,[]);class uc extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){if(Q.Annotations.QB(this.fy)){const Ma=new gc.a(this.Ia.annotations,this.Ia.annotations.g$a(Q.Annotations.fEa(this.fy),this.Ia.Ssa));for(const cb of Aa.items)Array.add(Ma.items,cb.PSa(this.Ia.Ssa));return Ma}return Aa.PSa(this.Ia.Ssa)}store(Aa,Ma,cb,Fb){if(Q.Annotations.QB(this.fy)){var dc=Ma,zc=({Voa:Fb}=this.jEa(Fb)).returnValue;
if(zc){dc=new gc.a(this.Ia.annotations,this.Ia.annotations.g$a(Q.Annotations.fEa(this.fy),this.Ia.Ssa));for(var Vc of Aa.items)Array.add(dc.items,Vc.PSa(this.Ia.Ssa));dc=zc.store(dc,Ma,cb,Fb)}Ma=dc;if(Ma.items.length!==Aa.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let rd=0,Z=Aa.items.length;rd<Z;++rd)cb=Aa.items[rd],cb.isReadOnly&&(cb=cb.clone(),Aa.items[rd]=cb),cb.mVe(this.Ia.Ssa,Ma.items[rd])}else zc=Ma,(Vc=({Voa:Fb}=this.jEa(Fb)).returnValue)&&
(zc=Vc.store(Q.Annotations.VK(Aa.PSa(this.Ia.Ssa)),Ma,cb,Fb)),Aa.mVe(this.Ia.Ssa,zc);return Aa}}Object(h.a)(uc,"FieldAnnotationQueryStep",Ab,[]);class db{constructor(Aa,Ma){Aa&&(this.annotations=Ma,this.Ssa=Aa.ga(0))}}Object(h.a)(db,"FieldQueryStepInit",null,[]);class Yb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){for(const cb of Aa.items)if(this.Ia.filter.isMatch(cb,Ma))return cb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Aa,Ma,cb,Fb){let dc=
Ma,zc=-1;for(let rd=0,Z=Aa.items.length;rd<Z;rd++)if(this.Ia.filter.isMatch(Aa.items[rd],cb)){zc=rd;break}if(0>zc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Vc=({Voa:Fb}=this.jEa(Fb)).returnValue;Vc&&(dc=Vc.store(Q.Annotations.VK(Aa.items[zc]),Ma,cb,Fb));Aa.items[zc]=dc;return Aa}}Object(h.a)(Yb,"FirstItemMatchingAnnotationQueryStep",Ab,[]);class Zc extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Ma=new ia(this.Ia.tvd,null,Ma);for(const cb of Aa.items)if(Ma.sUd(cb),
!this.Ia.query.np(cb,Ma))return!1;return!0}}Object(h.a)(Zc,"ForAllAnnotationQueryStep",Ab,[]);class Kb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Aa=Ma?Ma.ySc(this.Ia.Rsa):null;if(!Aa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Rsa+'"');return Aa}store(Aa,Ma,cb,Fb){Aa=cb?cb.ySc(this.Ia.Rsa):null;if(!Aa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Rsa+'"');let dc=Ma;const zc=({Voa:Fb}=this.jEa(Fb)).returnValue;zc&&(dc=zc.store(Aa,
Ma,cb,Fb));Aa!==dc&&Aa.ECa(dc);return Aa}}Object(h.a)(Kb,"GetAnnotationQueryStep",Ab,[]);class Yc{constructor(Aa,Ma){this.jPh=Aa;this.yYh=Ma}get lIf(){return this.jPh}get Bbh(){return this.yYh}}Object(h.a)(Yc,"AnnotationQueryStoreContinuation",null,[1245]);class ec extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){return this.Ia.vsd.np(Aa,Ma)?this.Ia.mDh.np(Aa,Ma):this.Ia.wPc?this.Ia.wPc.np(Aa,Ma):Aa}store(Aa,Ma,cb,Fb){var dc=this.Ia.vsd.np(Aa,cb);this.next&&(Fb=new Yc(this.next,Fb));if(dc)return this.Ia.mDh.qNb(Aa,
Ma,cb,Fb);if(this.Ia.wPc)return this.Ia.wPc.qNb(Aa,Ma,cb,Fb);dc=Ma;let zc=null;Fb&&(zc=Fb.lIf,Fb=Fb.Bbh);zc&&(dc=zc.store(Q.Annotations.VK(Aa),Ma,cb,Fb));return dc}}Object(h.a)(ec,"IfAnnotationQueryStep",Ab,[]);class rb{constructor(Aa,Ma){Aa&&(this.vsd=Ma.VD(Aa.ga(0)),this.mDh=Ma.VD(Aa.ga(1)),this.wPc=Aa.ga(2)?Ma.VD(Aa.ga(2)):null)}}Object(h.a)(rb,"IfQueryStepInit",null,[]);class ac{constructor(Aa,Ma){Aa&&(this.sCj=Ma.VD(Aa.ga(0)),this.Ung=Ma.VD(Aa.ga(1)))}}Object(h.a)(ac,"IndexAndItemQueryStepInit",
null,[]);class Jc extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){const cb=this.Ia.sCj.np(Aa,Ma);Ma=this.Ia.Ung.np(Aa,Ma);Aa=Aa.clone();if(0>cb||cb>Aa.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(Q.Annotations.QB(this.Ia.Ung.NU))for(let Fb=0;Fb<Ma.items.length;++Fb)Array.insert(Aa.items,cb+Fb,Ma.items[Fb]);else Array.insert(Aa.items,cb,Ma);return Aa}}Object(h.a)(Jc,"InsertAtAnnotationQueryStep",Ab,[]);class Db extends Ab{constructor(Aa){super();
this.Ia=Aa}load(Aa,Ma){return!(!Ma||!Ma.ySc(this.Ia.Rsa))}}Object(h.a)(Db,"IsDefinedAnnotationQueryStep",Ab,[]);class dd extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Ma=this.Swb(Aa,Ma);return Aa.items[Ma]}store(Aa,Ma,cb,Fb){const dc=this.Swb(Aa,cb);let zc=Ma;const Vc=({Voa:Fb}=this.jEa(Fb)).returnValue;Vc&&(zc=Vc.store(Q.Annotations.VK(Aa.items[dc]),Ma,cb,Fb));Aa.items[dc]=zc;return Aa}Swb(Aa,Ma){Ma=this.Ia.query.np(Aa,Ma);if(0>Ma||Ma>=Aa.items.length)throw Error.invalidOperation("Index out of range in Item store step");
return Ma}}Object(h.a)(dd,"ItemAnnotationQueryStep",Ab,[]);class Cd extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){const cb=new gc.a(this.Ia.annotations,Q.Annotations.fEa(this.fy));for(const Fb of Aa.items)this.Ia.filter.isMatch(Fb,Ma)&&Array.add(cb.items,Fb);return cb}}Object(h.a)(Cd,"ItemsMatchingAnnotationQueryStep",Ab,[]);class pd extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){Ma=this.Swb(Aa,Ma);return Aa.items[Aa.items.length-Ma-1]}store(Aa,Ma,cb,Fb){const dc=this.Swb(Aa,
cb);let zc=Ma;const Vc=({Voa:Fb}=this.jEa(Fb)).returnValue;Vc&&(zc=Vc.store(Q.Annotations.VK(Aa.items[Aa.items.length-dc-1]),Ma,cb,Fb));Aa.items[Aa.items.length-dc-1]=zc;return Aa}Swb(Aa,Ma){Ma=this.Ia.query?this.Ia.query.np(Aa,Ma):0;if(0>Ma||Ma>=Aa.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ma}}Object(h.a)(pd,"LastItemAnnotationQueryStep",Ab,[]);class Ge extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){if(Q.Annotations.QB(this.fy)){const Ma=
new gc.a(this.Ia.annotations,Q.Annotations.ipa);for(const cb of Aa.items)Array.add(Ma.items,cb.length);return Ma}return Aa.length}}Object(h.a)(Ge,"LengthAnnotationQueryStep",Ab,[]);class kd extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){if(Q.Annotations.QB(this.fy)){const cb=new gc.a(this.Ia.annotations,Q.Annotations.Fga);for(const Fb of Aa.items)Array.add(cb.items,this.Ia.filter.isMatch(Fb,Ma));return cb}return this.Ia.filter.isMatch(Aa,Ma)}}Object(h.a)(kd,"MatchesAnnotationQueryStep",
Ab,[]);class Xf extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){return this.Ia.filter.isMatch(Aa,Ma)}}Object(h.a)(Xf,"MatchesAsListAnnotationQueryStep",Ab,[]);class Kd extends kc{constructor(Aa){super(Aa)}Isb(Aa,Ma){return Aa%Ma}}Object(h.a)(Kd,"ModuloAnnotationQueryStep",kc,[]);class lg extends kc{constructor(Aa){super(Aa)}Isb(Aa,Ma){return Aa*Ma}}Object(h.a)(lg,"MultiplyAnnotationQueryStep",kc,[]);class ve extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){if(Q.Annotations.QB(this.fy)){const Ma=
new gc.a(this.Ia.annotations,Q.Annotations.Fga);for(const cb of Aa.items)Array.add(Ma.items,!cb);return Ma}return!Aa}}Object(h.a)(ve,"NotAnnotationQueryStep",Ab,[]);class Ua extends Qb{constructor(Aa){super(Aa)}eDf(Aa){return{returnValue:Aa,result:!0}}G0b(Aa,Ma){return Aa||Ma}}Object(h.a)(Ua,"OrAnnotationQueryStep",Qb,[]);class Bb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){const cb=this.Ia.j_e.np(Aa,Ma);Aa=this.Ia.f1b.np(Aa,Ma);Ma=new gc.a(this.Ia.annotations,Q.Annotations.ipa);for(let Fb=
0;Fb<Aa;++Fb)Array.add(Ma.items,cb+Fb);return Ma}}Object(h.a)(Bb,"RangeAnnotationQueryStep",Ab,[]);class mc{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.filter=Ma.J8(Aa.ga(0)))}}Object(h.a)(mc,"SingleFilterQueryStepInit",null,[]);class Nc{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.query=Aa.ga(0)?Ma.VD(Aa.ga(0)):null)}}Object(h.a)(Nc,"SingleOptionalQueryQueryStepInit",null,[]);class nd{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.query=Ma.VD(Aa.ga(0)))}}
Object(h.a)(nd,"SingleQueryQueryStepInit",null,[]);class Dd{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.j_e=Ma.VD(Aa.ga(0)),this.f1b=Aa.ga(1)?Ma.VD(Aa.ga(1)):null)}}Object(h.a)(Dd,"StartAndCountOrLengthQueryStepInit",null,[]);class La extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){let cb;({yLa:Ma,length:cb}=this.rUc(Aa,Ma));const Fb=new gc.a(this.Ia.annotations,Aa.yU);for(let dc=0;dc<cb;++dc)Array.add(Fb.items,Aa.items[Ma+dc]);return Fb}store(Aa,Ma,cb,Fb){let dc,zc;({yLa:dc,
length:zc}=this.rUc(Aa,cb));var Vc=Ma;const rd=({Voa:Fb}=this.jEa(Fb)).returnValue;if(rd){Vc=new gc.a(this.Ia.annotations,Aa.yU);for(let Z=0;Z<zc;++Z)Array.add(Vc.items,Aa.items[dc+Z]);Vc=rd.store(Vc,Ma,cb,Fb)}Ma=Vc;for(cb=0;cb<zc;++cb)Array.removeAt(Aa.items,dc);for(let Z=0,Da=Ma.items.length;Z<Da;++Z)Array.insert(Aa.items,dc+Z,Ma.items[Z]);return Aa}rUc(Aa,Ma){let cb;cb=this.Ia.j_e.np(Aa,Ma);if(0>cb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ma=this.Ia.f1b?this.Ia.f1b.np(Aa,
Ma):Aa.items.length-cb;if(0>Ma||cb+Ma>Aa.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{yLa:cb,length:Ma}}}Object(h.a)(La,"SublistAnnotationQueryStep",Ab,[]);class gb extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa,Ma){if(Q.Annotations.QB(this.fy)){const cb=new gc.a(this.Ia.annotations,Q.Annotations.aZ);for(let Fb=0,dc=Aa.items.length;Fb<dc;++Fb)Array.add(cb.items,this.getSubstring(Aa.items[Fb],Ma));return cb}return this.getSubstring(Aa,
Ma)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(Aa,Ma){let cb;({yLa:Ma,length:cb}=this.rUc(Aa,Ma));return Aa.substr(Ma,cb)}rUc(Aa,Ma){let cb;cb=this.Ia.j_e.np(Aa,Ma);if(0>cb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ma=this.Ia.f1b?this.Ia.f1b.np(Aa,Ma):Aa.length-cb;if(0>Ma||cb+Ma>Aa.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{yLa:cb,length:Ma}}}
Object(h.a)(gb,"SubstringAnnotationQueryStep",Ab,[]);class vc extends kc{constructor(Aa){super(Aa)}Isb(Aa,Ma){return Aa-Ma}}Object(h.a)(vc,"SubtractAnnotationQueryStep",kc,[]);class td extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){const Ma=new gc.a(this.Ia.annotations,Q.Annotations.aZ);for(let cb=0;cb<Aa.length;++cb)Array.add(Ma.items,Aa.charAt(cb).toString());return Ma}}Object(h.a)(td,"ToCharListAnnotationQueryStep",Ab,[]);class Nd extends Ab{constructor(Aa){super();this.Ia=Aa}load(Aa){const Ma=
new gc.a(this.Ia.annotations,this.fy);Array.add(Ma.items,Aa);return Ma}}Object(h.a)(Nd,"ToListAnnotationQueryStep",Ab,[]);class Od extends Ab{constructor(Aa){super();this.Ia=Aa}load(){return this.Ia.value}}Object(h.a)(Od,"ValueAnnotationQueryStep",Ab,[]);class Oc{constructor(Aa,Ma){if(Aa){var cb=Aa.ga(0),Fb=1;this.value=({Q3:Fb}=Ma.qsa(cb,Aa,Fb,null,null,null)).returnValue;Q.Annotations.Pbb(this.value)}}}Object(h.a)(Oc,"ValueQueryStepInit",null,[]);class Af{constructor(Aa,Ma){Aa&&(this.tvd=Ma.yC(Aa.ga(0)),
this.query=Ma.VD(Aa.ga(1)))}}Object(h.a)(Af,"VarNameAndQueryQueryStepInit",null,[]);class Ae{constructor(Aa,Ma){this.Sbf=null;if(Aa){this.annotations=Ma.annotations;var cb=0;this.fy=Aa.ga(cb);++cb;this.NU=Aa.ga(cb);++cb;this.Lrd=1===Aa.ga(cb);++cb;this.IYc=1===Aa.ga(cb);++cb;var Fb=Aa.ga(cb);++cb;if(Fb){var dc=cb,zc=cb+Fb,Vc=cb+2*Fb;cb+=3*Fb;var rd=Aa.count-cb,Z=null;for(let Wa=0;Wa<Fb;++Wa){var Da=cb+Aa.ga(Vc+Wa);const ib=(Wa===Fb-1?rd:Aa.ga(Vc+Wa+1))-Aa.ga(Vc+Wa),nb=new ab.a;nb.tSa(Aa,Da,ib);Da=
Ae.Bdj(Aa.ga(zc+Wa),nb,Ma);Da.fy=Aa.ga(dc+Wa);Da.NU=Wa===Fb-1?this.NU:Aa.ga(dc+Wa+1);Z?Z.next=Da:this.Sbf=Da;Z=Da}}}}get IWf(){return this.Sbf}static Bdj(Aa,Ma,cb){switch(Aa){case 1:return new Kb(new ud(Ma,cb));case 2:return new Db(new ud(Ma,cb));case 3:return new $b(new lc(Ma,cb.annotations));case 4:return new uc(new db(Ma,cb.annotations));case 5:return new ec(new rb(Ma,cb));case 6:return new kd(new mc(Ma,cb));case 43:return new Xf(new mc(Ma,cb));case 45:return new tb(new Hc(Ma,cb));case 49:return new Bc(new Gb(Ma,
cb));case 46:return new Od(new Oc(Ma,cb.annotations));case 51:return new Vb(new ic(Ma,cb));case 52:return new Bb(new Dd(Ma,cb));case 53:return new Wb(new Jb(cb.annotations));case 13:return new dd(new nd(Ma,cb));case 14:return new pd(new Nc(Ma,cb));case 15:return new Xc;case 18:return new Yb(new mc(Ma,cb));case 16:return new Zc(new Af(Ma,cb));case 17:return new Rb(new Af(Ma,cb));case 22:return new Jc(new ac(Ma,cb));case 24:return new Ub(new nd(Ma,cb));case 26:return new La(new Dd(Ma,cb));case 27:return new Cd(new mc(Ma,
cb));case 30:return new Nd(new Jb(cb.annotations));case 31:return new gb(new Dd(Ma,cb));case 32:return new qb(new nd(Ma,cb));case 47:return new Ge(new Jb(cb.annotations));case 48:return new td(new Jb(cb.annotations));case 34:return new fb(new nd(Ma,cb));case 35:return new vc(new nd(Ma,cb));case 36:return new lg(new nd(Ma,cb));case 37:return new xb(new nd(Ma,cb));case 38:return new Kd(new nd(Ma,cb));case 39:return new wc(new nd(Ma,cb));case 40:return new mb(new nd(Ma,cb));case 41:return new Ua(new nd(Ma,
cb));case 42:return new ve(new Jb(cb.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(Ae,"AnnotationQueryInit",null,[]);class Ye{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){this.v8(Aa,Aa?new ia("root",Aa,Ma):Ma)}v8(Aa,Ma){for(const cb of this.Ia.commands)Ma=cb.execute(Aa,Ma)}}Object(h.a)(Ye,"AnnotationScript",null,[1094]);class Wd{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){const cb=this.Ia.aGj.np(Aa,Ma),Fb=this.Ia.QAk.np(Aa,Ma);this.Ia.script.v8(Aa,new ia("Input",cb,new ia("Output",
Fb,Ma)));return Ma}}Object(h.a)(Wd,"ApplyAnnotationScriptCommand",null,[1186]);class je{constructor(Aa,Ma){Aa&&(this.aGj=Ma.VD(Aa.ga(0)),this.QAk=Ma.VD(Aa.ga(1)),this.script=Ma.n9a(Aa.ga(2)))}}Object(h.a)(je,"ApplyScriptCommandInit",null,[]);class dg{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){const cb=this.Ia.pTe.np(Aa,Ma);this.Ia.l2c.qNb(Aa,cb,Ma,null);return Ma}}Object(h.a)(dg,"AssignAnnotationScriptCommand",null,[1186]);class nf{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){const cb=this.Ia.l2c.np(Aa,
Ma);Aa=this.Ia.pTe.np(Aa,Ma);cb!==Aa&&cb.ECa(Aa);return Ma}}Object(h.a)(nf,"CopyAnnotationScriptCommand",null,[1186]);class Cb{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){let cb=this.Ia.Qne.np(Aa,Ma);if(this.Ia.Qne.Lrd){cb=Q.Annotations.VK(cb);var Fb=new ia(this.Ia.Rsa,null,Ma);for(let zc=0,Vc=cb.items.length;zc<Vc;++zc){var dc=this.lTf(Aa,cb.items[zc],Fb);if(0>this.Ia.gmd)cb.items[zc]=dc;else if(({value:dc}=dc.Rm(this.Ia.gmd)).returnValue)cb.items[zc]=dc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Ia.Qne.qNb(Aa,cb,Ma,null)}else{Fb=new ia(this.Ia.Rsa,null,Ma);for(let zc=0,Vc=cb.items.length;zc<Vc;++zc)this.lTf(Aa,cb.items[zc],Fb)}return Ma}lTf(Aa,Ma,cb){let Fb;0>this.Ia.gmd?Fb=Q.Annotations.VK(Ma):(Fb=new D.a(this.Ia.annotations),Fb.ru(this.Ia.gmd,Ma));cb.sUd(Fb);this.Ia.xii.v8(Aa,cb);return Fb}}Object(h.a)(Cb,"EnumerateAnnotationScriptCommand",null,[1186]);class Cf{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.Rsa=Ma.yC(Aa.ga(0)),this.Qne=Ma.VD(Aa.ga(1)),this.xii=Ma.n9a(Aa.ga(2)),
this.gmd=Aa.ga(3))}}Object(h.a)(Cf,"EnumerateScriptCommandInit",null,[]);class of{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){this.Ia.vsd.np(Aa,Ma)?this.Ia.ryl.v8(Aa,Ma):this.Ia.WUf&&this.Ia.WUf.v8(Aa,Ma);return Ma}}Object(h.a)(of,"IfAnnotationScriptCommand",null,[1186]);class Lg{constructor(Aa,Ma){Aa&&(this.vsd=Ma.VD(Aa.ga(0)),this.ryl=Ma.n9a(Aa.ga(1)),this.WUf=Aa.ga(2)?Ma.n9a(Aa.ga(2)):null)}}Object(h.a)(Lg,"IfScriptCommandInit",null,[]);class vd{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,
this.l2c=Ma.VD(Aa.ga(0)),this.pTe=Ma.VD(Aa.ga(1)))}}Object(h.a)(vd,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Lh{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){const cb=this.Ia.pTe.np(this.Ia.l2c.np(Aa,Ma),Ma);this.Ia.l2c.qNb(Aa,cb,Ma,null);return Ma}}Object(h.a)(Lh,"ModifyAnnotationScriptCommand",null,[1186]);class tf{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){const cb=new D.a(this.Ia.annotations);this.Ia.query&&cb.ECa(this.Ia.query.np(Aa,Ma));return Ma=new ia(this.Ia.Rsa,cb,Ma)}}Object(h.a)(tf,
"NewAnnotationScriptCommand",null,[1186]);class Ue{constructor(Aa,Ma){Aa&&(this.annotations=Ma.annotations,this.Rsa=Ma.yC(Aa.ga(0)),this.query=Aa.ga(1)?Ma.VD(Aa.ga(1)):null)}}Object(h.a)(Ue,"NewScriptCommandInit",null,[]);class ff{constructor(Aa){this.Ia=Aa}execute(Aa,Ma){Aa=this.Ia.query.np(Aa,Ma);if(this.Ia.query.NU===Q.Annotations.QM)Aa.$kd(this.Ia.pca);else for(const cb of Aa.items)cb.$kd(this.Ia.pca);return Ma}}Object(h.a)(ff,"RemoveAnnotationScriptCommand",null,[1186]);class Ef{constructor(Aa,
Ma){Aa&&(this.annotations=Ma.annotations,this.query=Ma.VD(Aa.ga(0)),this.pca=Aa.ga(1))}}Object(h.a)(Ef,"RemoveScriptCommandInit",null,[]);class wh{constructor(Aa,Ma){if(Aa){var cb=0,Fb=Aa.ga(cb);++cb;if(Fb){var dc=cb,zc=cb+Fb;cb+=2*Fb;var Vc=Aa.count-cb;this.commands=Array(Fb);for(let rd=0;rd<Fb;++rd){const Z=cb+Aa.ga(zc+rd),Da=(rd===Fb-1?Vc:Aa.ga(zc+rd+1))-Aa.ga(zc+rd),Wa=new ab.a;Wa.tSa(Aa,Z,Da);this.commands[rd]=wh.xdj(Aa.ga(dc+rd),Wa,Ma)}}}}static xdj(Aa,Ma,cb){switch(Aa){case 1:return new dg(new vd(Ma,
cb));case 2:return new Lh(new vd(Ma,cb));case 3:return new ff(new Ef(Ma,cb));case 6:return new tf(new Ue(Ma,cb));case 7:return new Cb(new Cf(Ma,cb));case 8:return new of(new Lg(Ma,cb));case 9:return new nf(new vd(Ma,cb));case 10:return new Wd(new je(Ma,cb));default:throw Error.argument("initData");}}}Object(h.a)(wh,"AnnotationScriptInit",null,[]);var xh=d(705);class qd{constructor(Aa){this.XH=Aa;this.cN=0}xY(){const Aa=this.XH.qu(this.cN,4);this.cN+=4;return Aa}get vZb(){return this.XH}get offset(){return this.cN}set offset(Aa){this.cN=
Aa}}Object(h.a)(qd,"ByteArrayReader",null,[]);class Hf{constructor(){this.IC=null;this.Zzg=this.oz=0}ga(Aa){if(0>Aa||Aa>=this.oz)throw Error.argumentOutOfRange("index");return this.IC.qu(this.Zzg+4*Aa,4)}get count(){return this.oz}static CDi(Aa,Ma,cb){const Fb=new Hf;Fb.IC=Aa;Fb.Zzg=Ma;Fb.oz=cb;return Fb}}Object(h.a)(Hf,"ReadOnlyListOverByteArray",null,[1052]);class Ag{constructor(Aa,Ma){this.Mxg=this.txg=!1;this.Gr=this.Lwa=this.ppe=this.Yxg=null;try{this.Gr=Ma.annotations;const cb=Ma.DSa(Aa.ga(0)),
Fb=new qd(cb);if(-914743053!==Fb.xY())throw Error.argument("Input does not represent a flat lexicon");this.txg=1===Fb.xY();this.Mxg=1===Fb.xY();const dc=Fb.xY();Fb.offset+=dc;const zc=Fb.xY();this.ppe=Ag.mCk(Fb,zc,this.Gr);const Vc=Fb.xY();this.Yxg=Ag.zCk(Fb,Vc);const rd=Fb.xY();this.Lwa=new xh.a(Fb.vZb,Fb.offset);Fb.offset+=rd}catch(cb){throw Error.argument("initData");}}get trie(){return this.Lwa}y4i(Aa){return"i"===Aa&&this.Mxg?"\u0130":Aa.toUpperCase()}Iie(){return this.txg}e3i(Aa){let Ma;Ma=
new gc.a(this.Gr,Q.Annotations.QM);if(1!==Aa)if(0===Aa)Aa=new D.a(this.Gr),Array.add(Ma.items,Aa);else if(Aa&1073741824){Aa=this.Yxg[Aa&-1073741825];for(let Fb=0;Fb<Aa.length;++Fb){var cb=Aa[Fb];cb=0===cb?new D.a(this.Gr):this.ppe[cb-2];Array.add(Ma.items,cb)}}else Array.add(Ma.items,this.ppe[Aa-2]);return{returnValue:!0,TZj:Ma}}static mCk(Aa,Ma,cb){if(Ma%4)throw Error.argument("reader");const Fb=Hf.CDi(Aa.vZb,Aa.offset,Ma/4);Aa.offset+=Ma;Aa=[];for(Ma=0;Ma<Fb.count;){const dc=({Q3:Ma}=cb.qsa(Q.Annotations.QM,
Fb,Ma,null,null,null)).returnValue;Array.add(Aa,dc)}return Aa}static zCk(Aa,Ma){Ma=Aa.offset+Ma;const cb=[];for(;Aa.offset<Ma;){const Fb=Aa.xY(),dc=Array(Fb);for(let zc=0;zc<Fb;++zc){const Vc=Aa.xY();dc[zc]=Vc}Array.add(cb,dc)}return cb}}Object(h.a)(Ag,"RawFlatLexicon",null,[1093]);var He=d(695),af=d(696);class yd{constructor(Aa){if(null==Aa)throw Error.argumentNull("base64String");const Ma=Aa.length;if(Ma%4)throw Error.argument("base64String's length must be a multiple of 4");this.oz=.75*Ma;this.ova=
Array(Math.ceil(this.oz/4));Aa.endsWith("==")?this.oz-=2:Aa.endsWith("=")&&--this.oz;let cb=0;for(let Fb=0;Fb<Ma;Fb+=4){const dc=yd.Tmd[Aa.charCodeAt(Fb)-43]<<18|yd.Tmd[Aa.charCodeAt(Fb+1)-43]<<12|yd.Tmd[Aa.charCodeAt(Fb+2)-43]<<6|yd.Tmd[Aa.charCodeAt(Fb+3)-43];let zc=dc>>16&255;this.ova[Math.floor(cb/4)]|=zc<<cb%4*8;++cb;zc=dc>>8&255;this.ova[Math.floor(cb/4)]|=zc<<cb%4*8;++cb;zc=dc&255;this.ova[Math.floor(cb/4)]|=zc<<cb%4*8;++cb}}get length(){return this.oz}ga(Aa){if(0>Aa||Aa>=this.oz)throw Error.argumentOutOfRange("i");
return this.c_f(Aa)}qu(Aa,Ma){if(0>Aa||0>Ma||Aa+Ma>this.oz)throw Error.argument("Bad range");let cb=0;for(let Fb=0;Fb<Ma;++Fb)cb|=this.c_f(Aa+Fb)<<8*Fb;return cb}SQk(Aa,Ma){let cb=0,Fb=0,dc=Math.floor(Aa/8);for(Aa%=8;Fb<Ma;){const zc=8-Aa>Ma-Fb?Ma-Fb:8-Aa,Vc=this.ga(dc);cb|=(Vc>>Aa&~(255<<zc))<<Fb;Fb+=zc;++dc;Aa=0}return cb}c_f(Aa){return this.ova[Math.floor(Aa/4)]>>Aa%4*8&255}}yd.Tmd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(yd,"ByteArray",null,[]);class me{constructor(Aa,Ma,cb){this.py=Aa;this.o8j=Ma;this.Jbk=cb;this.GAg=Array(Aa.b?Aa.b.length:0);this.ZBe=new He.a(new af.a(this.DSa(this.py.s)));this.EX=Array(Aa.t.length);this.YMh=new Q.Annotations(this.ASa(0),this)}get annotations(){return this.YMh}get IOi(){return this.py.d}cdj(){if(!(""in this.py.m))throw Error.argument("name","Unrecognized module");return this.A8d(this.py.m[""])}DSa(Aa){if(0>
Aa||!this.py.b||Aa>=this.py.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.GAg[Aa]||(this.GAg[Aa]=new yd(this.py.b[Aa]))}yC(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not a string");if(null==this.EX[Aa]){const Ma=this.ASa(Aa).ga(0);this.EX[Aa]=this.ZBe.yC(Ma)}return this.EX[Aa]}y5f(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.py.t[Aa])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.EX[Aa]){var Ma=this.ASa(Aa);const cb=this.yC(Ma.ga(0));Ma=1===Ma.ga(1);this.EX[Aa]=new RegExp(cb,Ma?"i":"")}return this.EX[Aa]}Ihj(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}A8d(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not an NL module");
return this.EX[Aa]||(this.EX[Aa]=this.Jbk.sdj(this.ASa(Aa),this))}VD(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not an annotation query");return this.EX[Aa]||(this.EX[Aa]=new Ta(new Ae(this.ASa(Aa),this)))}n9a(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not an annotation script");return this.EX[Aa]||
(this.EX[Aa]=new Ye(new wh(this.ASa(Aa),this)))}J8(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not a filter");return this.EX[Aa]||(this.EX[Aa]=this.o8j.J8(this.ASa(Aa),this))}sgj(Aa){if(1>Aa||Aa>=this.py.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.py.t[Aa])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.EX[Aa]||(this.EX[Aa]=new Ag(this.ASa(Aa),
this))}ASa(Aa){const Ma=this.py.n[Aa];Aa=(Aa<this.py.t.length-1?this.py.n[Aa+1]:this.py.n.length)-Ma;if(0>Ma||0>Aa||Ma+Aa>this.py.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ma+","+Aa+")");const cb=new ab.a;cb.PQc(this.py.n,Ma,Aa);return cb}}Object(h.a)(me,"ObjectFetcher",null,[1020]);class Ic{constructor(Aa,Ma,cb){if(!Aa)throw Error.argumentNull("prediction");if(!Ma)throw Error.argumentNull("fieldNames");if(!cb)throw Error.argumentNull("values");if(Ma.length!==
cb.length)throw Error.argument("values","fieldNames and values do not have same length");this.oYh=Aa;this.$cb=Ma;this.Qfb=cb}get prediction(){return this.oYh}get iVf(){return this.$cb.length}Q6d(Aa){return 0<=Aa&&Aa<this.$cb.length?this.$cb[Aa]:null}eb(Aa){return 0<=Aa&&Aa<this.Qfb.length?this.Qfb[Aa]:null}}Object(h.a)(Ic,"PredictionData",null,[]);class Fe{constructor(Aa,Ma){if(!Aa)throw Error.argumentNull("predictions");if(!Ma)throw Error.argumentNull("tokenAttributes");this.iek=Aa;this.Uhk=Ma}m9d(){return this.iek}pZf(){return this.Uhk}}
Object(h.a)(Fe,"PredictionDataWithTokenAttributes",null,[]);class Uc{constructor(Aa,Ma){this.prediction=null;this.score=0;this.prediction=Aa;this.score=Ma}}Object(h.a)(Uc,"PredictionWithScore",null,[]);class Uf{constructor(Aa,Ma){if(!Aa)throw Error.argumentNull("predictions");if(!Ma)throw Error.argumentNull("attributes");this.pYh=Aa;this.uNh=Ma}m9d(){return this.pYh}pZf(){return this.uNh}}Object(h.a)(Uf,"PredictionsWithTokenAttributes",null,[]);class vg{constructor(Aa,Ma,cb){if(!Aa)throw Error.argumentNull("attributeName");
if(!Ma)throw Error.argumentNull("fieldNames");if(!cb)throw Error.argumentNull("values");if(Ma.length!==cb.length)throw Error.argument("values","fieldNames and values do not have same length");this.tNh=Aa;this.$cb=Ma;this.Qfb=cb}get attributeName(){return this.tNh}get iVf(){return this.$cb.length}Q6d(Aa){return 0<=Aa&&Aa<this.$cb.length?this.$cb[Aa]:null}eb(Aa){return 0<=Aa&&Aa<this.Qfb.length?this.Qfb[Aa]:null}}Object(h.a)(vg,"TokenAttributes",null,[]);var Yg=d(14),Cc=d(22);class Rc{constructor(Aa,
Ma,cb,Fb,dc){this.mvc=0;this.y6e=null;this.nvc=this.UPb=0;this.$vd=this.jmb=this.iba=this.VPb=null;this.z6e=0;this.h4a=this.My=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.hK=Aa;this.pKh=this.uKh=Ma;this.oKh=this.rKh=cb;this.ivc=this.qKh=Fb;this.jvc=this.sKh=dc}Xvd(){this.nvc=0;return this.TPb}TPb(){if(!(this.nvc<this.ivc))return this.lvc;this.VPb=this.pKh.items[this.nvc+this.oKh];this.iba=new D.a(this.hK.Ia.annotations);
1!==this.ivc&&this.hK.Ia.q9b||this.iba.ECa(this.VPb);if(0<=this.hK.Ia.rdd){({value:this.jmb}=this.iba.Rm(this.hK.Ia.rdd)).returnValue?this.jmb=this.jmb.VK():this.jmb=new gc.a(this.hK.Ia.annotations,Q.Annotations.QM);this.$vd=this.jvc.items;this.z6e=this.$vd.length;for(this.mvc=0;this.mvc<this.z6e;++this.mvc)this.y6e=this.$vd[this.mvc],Array.add(this.jmb.items,this.y6e);this.iba.ru(this.hK.Ia.rdd,this.jmb)}else 0<=this.hK.Ia.qZe?this.iba.ru(this.hK.Ia.qZe,this.jvc.items[0]):0<=this.hK.Ia.zSd?this.iba.ru(this.hK.Ia.zSd,
!0):this.hK.Ia.Ekg?this.jvc.items[0].vQc((Aa,Ma)=>this.iba.ru(Aa,Ma)):(this.iba.ECa(this.jvc.items[0]),1!==this.ivc&&this.hK.Ia.q9b||(({value:this.UPb}=this.VPb.Rm(this.hK.Ia.GS)).returnValue&&this.iba.ru(this.hK.Ia.GS,this.UPb),({value:this.UPb}=this.VPb.Rm(this.hK.Ia.gW)).returnValue&&this.iba.ru(this.hK.Ia.gW,this.UPb),this.VPb.Rm(this.hK.Ia.YPa).returnValue&&this.iba.ru(this.hK.Ia.YPa,this.UPb)));this.My=this.iba;this._state=2;return this.Zvd}lvc(){this._state=3}Yvd(){this.nvc++;return this.TPb}Zvd(){return 1<
this.ivc&&this.hK.Ia.q9b?this.lvc:this.Yvd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Rc(this.hK,this.uKh,this.rKh,this.qKh,this.sKh)).getEnumerator()}[Symbol.iterator](){return Object(Cc.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.h4a=this.Xvd());for(;1===this._state;)this.h4a=this.h4a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.My}}
Object(h.a)(Rc,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[106,137,138]);class Ve{constructor(Aa,Ma,cb){this.Udc=this.$zg=0;this.KBb=null;this.jCe=this.dqe=this.xBb=this.O3c=this.hre=0;this.O4c=!1;this.Kye=Aa;this.BCe=Ma;this.Eck=cb}Z3f(){null===this.KBb&&({wBh:this.KBb,Ocg:this.hre,length:this.O3c,bVi:Aa}=this.Kye.i8f(this.BCe.items[this.Udc],this.Eck),this.O4c=Aa||this.O4c);if(this.xBb<this.O3c){var Aa=this.KBb.charAt(this.hre+
this.xBb);++this.xBb;return{returnValue:!0,ch:Aa}}if(this.Udc===this.BCe.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Udc;this.xBb=0;this.KBb=null;return{returnValue:!0,ch:" "}}pQe(Aa,Ma){this.xBb===this.O3c&&this.KBb&&(this.jCe=Ma,this.dqe=this.Udc-this.$zg+1)}R1k(Aa){if(0>Aa||Aa>=this.BCe.items.length)throw Error.argumentOutOfRange("iToken");this.Udc=this.$zg=Aa;this.KBb=null;this.dqe=this.xBb=this.O3c=this.hre=0;this.jCe=-1;this.O4c=!1}ncj(){return{Rli:this.dqe,mYj:this.jCe,PUi:this.O4c}}}
Object(h.a)(Ve,"TriePrefixVisitor",null,[1076]);class ob{constructor(Aa){this.Ia=Aa}execute(Aa){if(!({value:cb}=Aa.Rm(this.Ia.Ira)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ma;({value:Ma}=Aa.Rm(this.Ia.cCa)).returnValue||(Ma=null);var cb=this.N2i(cb,Ma);Aa=Q.Annotations.VK(Aa);Aa.ru(this.Ia.Ira,cb);return Aa}N2i(Aa,Ma){let cb=null;const Fb=this.Ia.flatLexicon.trie,dc=new Ve(this,Aa,Ma);let zc=null;this.Ia.flatLexicon.Iie()&&(zc=Object(Yg.a)(this.Ia.flatLexicon,
this.Ia.flatLexicon.y4i,"getCaseInsensitiveForm"));let Vc=0,rd;var Z;let Da;for(;Vc<Aa.items.length;){const Wa=Aa.items[Vc];dc.R1k(Vc);Fb.qJh(dc,zc);({Rli:rd,mYj:Z,PUi:Da}=dc.ncj());if(0<rd){({TZj:Z}=this.Ia.flatLexicon.e3i(Z));for(let ib of this.XEi(Aa,Vc,rd,Z)){1<rd&&this.Ia.q9b&&this.CFi(Aa,Ma,Vc,Wa,rd,Da,ib);if(!cb)for(cb=new gc.a(this.Ia.annotations,Q.Annotations.QM),Z=0;Z<Vc;++Z)Array.add(cb.items,Aa.items[Z]);Array.add(cb.items,ib)}Vc+=rd}else cb&&Array.add(cb.items,Wa),++Vc}return cb||Aa}CFi(Aa,
Ma,cb,Fb,dc,zc,Vc){if(zc)zc=!0;else if(this.Ia.lkg){zc=!1;var rd=-1;for(var Z=0;Z<dc;Z++){var Da=Aa.items[cb+Z];let jc;var Wa=void 0;if(!({value:jc}=Da.Rm(this.Ia.GS)).returnValue||!({value:Wa}=Da.Rm(this.Ia.gW)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<Z){if(jc>rd+1){zc=!0;break}if(0>rd||null===Ma||rd>=Ma.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Ma.charAt(rd)){zc=!0;break}}rd=jc+Wa}}else zc=!1;if(zc){Wa=new Sys.StringBuilder;for(zc=0;zc<dc;++zc)({wBh:rd,Ocg:Z,length:Da}=this.i8f(Aa.items[cb+zc],Ma)),0<zc&&Wa.append(" "),Wa.append(rd.substr(Z,Da));Vc.ru(this.Ia.YPa,Wa.toString())}Aa=Aa.items[cb+dc-1];let ib,nb;({value:Fb}=Fb.Rm(this.Ia.GS)).returnValue&&({value:ib}=Aa.Rm(this.Ia.GS)).returnValue&&({value:nb}=Aa.Rm(this.Ia.gW)).returnValue?(Vc.ru(this.Ia.GS,Fb),Vc.ru(this.Ia.gW,ib+nb-Fb)):(Vc.$kd(this.Ia.GS),Vc.$kd(this.Ia.gW))}XEi(Aa,
Ma,cb,Fb){return new Rc(this,Aa,Ma,cb,Fb)}i8f(Aa,Ma){let cb,Fb;if(({value:cb}=Aa.Rm(this.Ia.YPa)).returnValue)Fb=!0,Ma=0,Aa=cb.length;else{Fb=!1;if(null===Ma)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");cb=Ma;if(!({value:Ma}=Aa.Rm(this.Ia.GS)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:Aa}=Aa.Rm(this.Ia.gW)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>Ma||0>Aa||Ma+Aa>cb.length)throw Error.argument("Token start/length values out of range","token");}return{wBh:cb,Ocg:Ma,length:Aa,bVi:Fb}}}Object(h.a)(ob,"FlatLexiconNLModule",null,[1051]);class Mb{constructor(Aa,Ma){this.zSd=this.rdd=this.qZe=this.YPa=this.gW=this.GS=this.cCa=this.Ira=0;this.Ekg=this.lkg=this.q9b=!1;this.flatLexicon=null;this.annotations=Ma.annotations;let cb=0;try{this.Ira=Aa.ga(cb),++cb,this.cCa=Aa.ga(cb),++cb,this.GS=Aa.ga(cb),++cb,this.gW=Aa.ga(cb),++cb,this.YPa=Aa.ga(cb),
++cb,this.qZe=Aa.ga(cb),++cb,this.rdd=Aa.ga(cb),++cb,this.zSd=Aa.ga(cb),++cb,this.q9b=1===Aa.ga(cb),++cb,this.lkg=1===Aa.ga(cb),++cb,this.Ekg=1===Aa.ga(cb),++cb,this.flatLexicon=Ma.sgj(Aa.ga(cb))}catch(Fb){throw Error.argument("initData");}}}Object(h.a)(Mb,"FlatLexiconNLModuleInit",null,[]);class nc{constructor(){this.p8b=0;this.l3d=null;this.ypc=0}}Object(h.a)(nc,"FeatureGenStackRec",null,[]);class Qc{constructor(Aa){this.j2e=Array(Aa);this.xOb=Array(Aa);this.y_e=[];this.Iyh=[]}}Object(h.a)(Qc,"TokenStringLattice",
null,[]);const id=(Aa,Ma,cb)=>{for(let Fb=0;Fb<Aa.length;Fb++)cb=Ma(cb,Aa[Fb]);return cb},ld=(Aa,Ma)=>{const cb=Array(Aa.length);for(let Fb=0;Fb<Aa.length;Fb++)cb[Fb]=Ma(Aa[Fb]);return cb},xd=(Aa,Ma)=>{Ma=Array(Math.min(Ma,Aa.length));for(let cb=0;cb<Ma.length;cb++)Ma[cb]=Aa[cb];return Ma},ue=(Aa,Ma)=>{const cb=[];for(const Fb of Aa)Ma(Fb)&&Array.add(cb,Fb);return cb};class Rd{constructor(Aa,Ma){this.key=Aa;this.value=Ma}}Object(h.a)(Rd,"KeyValuePair",null,[]);const ce=(Aa,Ma)=>({returnValue:Ma in
Aa,value:Aa[Ma]}),Ne=Aa=>{const Ma=[];for(let cb in Aa){const Fb=new Rd(cb,Aa[cb]);Array.add(Ma,Fb)}return Ma};class oe{constructor(Aa){this.h8f=this.Fmj;this.Ia=Aa;this.r8c=this.zye=this.Aye=0;for(const Ma of this.Ia.zPc)this.Aye=Math.max(this.Aye,Ma.KLe),this.zye=Math.max(this.zye,Ma.gLe),this.r8c=Math.max(this.r8c,Ma.dNb.length)}get oXi(){return this.Ia.ftd.trie}execute(Aa){if(!Aa)throw Error.argumentNull("input");let Ma,cb;({tokens:Ma,QYj:cb}=this.Gmj(Aa));let Fb=null,dc=null,zc={};if(this.Ia.J9b){Ma=
Q.Annotations.VK(Ma);for(var Vc=0;Vc<Ma.items.length;++Vc)Ma.items[Vc]=Q.Annotations.VK(Ma.items[Vc])}else({aVf:dc,returnValue:Fb}=this.x4f(Aa,zc));Vc=Array(this.r8c);const rd=Array(this.r8c);for(var Z=0;Z<rd.length;++Z)rd[Z]=new nc;for(Z=-this.Aye;Z<Ma.items.length+this.zye;++Z){let Da=null;this.Ia.J9b&&(Da=Ma.items[Z],zc={},{aVf:dc,returnValue:Fb}=this.x4f(Da,zc));for(const Wa of this.Ia.zPc){if(0>Z&&-Z>Wa.KLe||Z>=Ma.items.length&&Z-Ma.items.length+1>Wa.gLe)continue;let ib=!0;for(let nb=0;nb<Wa.dNb.length;++nb){const jc=
Z+Wa.dNb[nb];Vc[nb]=jc;if(0>jc?0>this.Ia.LLe:jc>=Ma.items.length?0>this.Ia.hLe:!cb.xOb[jc]){ib=!1;break}}ib&&({DIi:Fb,EIi:dc}=this.dHj(Wa,cb,Fb,dc,zc,rd,Vc))}this.Ia.J9b&&(Da.ru(this.Ia.lFa?this.Ia.Yrb:this.Ia.Wrb,Fb),this.Ia.lFa&&Da.ru(this.Ia.Xrb,dc))}Aa=Q.Annotations.VK(Aa);this.Ia.J9b?Aa.ru(this.Ia.Ira,Ma):(Aa.ru(this.Ia.lFa?this.Ia.Yrb:this.Ia.Wrb,Fb),this.Ia.lFa&&Aa.ru(this.Ia.Xrb,dc));return Aa}Gmj(Aa){let Ma,cb;if(!Aa||!({value:Ma}=Aa.Rm(this.Ia.Ira)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Fb;({value:Fb}=Aa.Rm(this.Ia.cCa)).returnValue||(Fb="");cb=new Qc(Ma.items.length);const dc=ue(this.Ia.n2e,zc=>!zc.H8b||zc.H8b.isMatch(Aa,null));for(let zc=0;zc<Ma.items.length;++zc){const Vc=Ma.items[zc];let rd=null;cb.j2e[zc]=cb.y_e.length;let Z=cb.xOb[zc]=0;for(const Da of dc)0<Da.Eic&&cb.xOb[zc]+Z>=Da.Eic||Da.ztc&&!Da.ztc.isMatch(Vc,null)||({Atc:rd,e_b:Z}=Da.apply(this,Vc,zc,cb,Fb,rd,Z))}return{tokens:Ma,QYj:cb}}dHj(Aa,Ma,cb,Fb,dc,zc,Vc){let rd=0;zc[0].p8b=-1;for(zc[0].l3d=Aa.Ulh;;){var Z=
Vc[rd],Da=0>Z||Z>=Ma.xOb.length?1:Ma.xOb[Z];let nb=!1;for(;zc[rd].p8b<Da-1;){++zc[rd].p8b;var Wa=void 0,ib=void 0;0>Z?(Wa=this.Ia.LLe,ib=1):Z>=Ma.j2e.length?(Wa=this.Ia.hLe,ib=1):(ib=Ma.j2e[Z]+zc[rd].p8b,Wa=Ma.y_e[ib],ib=Ma.Iyh[ib]);zc[rd].ypc=ib*(rd?zc[rd-1].ypc:Aa.score);if(({value:Wa}=ce(zc[rd].l3d,Wa.toString())).returnValue){rd===Aa.dNb.length-1?(Z=Wa,zc[rd].ypc&&(({value:Da}=ce(dc,Z.toString())).returnValue||(Da=-1),0>Da&&(cb=Q.Annotations.VK(cb),Array.add(cb.items,Z)),this.Ia.lFa&&(Fb=Q.Annotations.VK(Fb),
0>Da?Array.add(Fb.items,zc[rd].ypc):Fb.items[Da]+=zc[rd].ypc),0>Da&&(this.Ia.yng||this.Ia.lFa)&&(dc[Z.toString()]=cb.items.length-1))):(++rd,zc[rd].p8b=-1,zc[rd].l3d=Wa);nb=!0;break}}if(!nb&&(--rd,0>rd))break}return{DIi:cb,EIi:Fb}}x4f(Aa,Ma){let cb;if(({value:cb}=Aa.Rm(this.Ia.lFa?this.Ia.Yrb:this.Ia.Wrb)).returnValue)for(let Fb=0;Fb<cb.items.length;++Fb)Ma[cb.items[Fb].toString()]=Fb;else cb=new gc.a(this.Ia.annotations,Q.Annotations.ipa);if(this.Ia.lFa){if(({value:Ma}=Aa.Rm(this.Ia.Xrb)).returnValue||
(Ma=new gc.a(this.Ia.annotations,Q.Annotations.Waa)),Ma.items.length!==cb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ia.annotations.V1(Q.Annotations.QM,Aa));}else Ma=null;return{returnValue:cb,aVf:Ma}}get swl(){return this.Ia.ftd}Fmj(Aa,Ma){var cb;if(({value:cb}=Ma.Rm(this.Ia.YPa)).returnValue)Aa=cb;else{if(!({value:cb}=Ma.Rm(this.Ia.GS)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Ma}=Ma.Rm(this.Ia.gW)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>cb||0>Ma||cb+Ma>Aa.length)throw Error.argument("Token indices are out of range");Aa=Aa.substr(cb,Ma)}return Aa}}Object(h.a)(oe,"NGramNLModule",null,[1051,1053]);class Yd{constructor(Aa){this.dNb=null;this.score=this.gLe=this.KLe=0;this.Ulh=null;if(Aa){var Ma=0;try{if(Aa.ga(Ma)!==Yd.J6a)throw Error.argument("initData","Input does not represent a feature template");++Ma;const cb=Aa.ga(Ma);++Ma;this.dNb=
Array(cb);for(let Fb=0;Fb<cb;++Fb)this.dNb[Fb]=Aa.ga(Ma),++Ma;this.KLe=Aa.ga(Ma);++Ma;this.gLe=Aa.ga(Ma);++Ma;this.score=Aa.ga(Ma);++Ma;this.Ulh=({Lcg:Ma}=Yd.ifh(Aa,Ma)).returnValue}catch(cb){throw Error.argument("initData");}}}static ifh(Aa,Ma){const cb=Aa.ga(Ma);++Ma;const Fb={};for(let dc=0;dc<cb;++dc){const zc=Aa.ga(Ma);++Ma;Aa.ga(Ma)?Fb[zc.toString()]=({Lcg:Ma}=Yd.ifh(Aa,Ma)).returnValue:(++Ma,Fb[zc.toString()]=Aa.ga(Ma),++Ma)}return{returnValue:Fb,Lcg:Ma}}}Yd.J6a=240803228;Object(h.a)(Yd,"FeatureTemplate",
null,[1079]);var Id=d(546);class zf{constructor(Aa,Ma){this.lFa=this.yng=this.J9b=!1;this.YPa=this.gW=this.GS=this.Ira=this.cCa=this.Xrb=this.Yrb=this.Wrb=0;this.ftd=null;this.hLe=this.LLe=0;this.zPc=this.n2e=null;if(Aa){this.annotations=Ma.annotations;var cb=0;try{this.J9b=1===Aa.ga(cb);++cb;this.yng=1===Aa.ga(cb);++cb;this.lFa=1===Aa.ga(cb);++cb;this.Wrb=Aa.ga(cb);++cb;this.Yrb=Aa.ga(cb);++cb;this.Xrb=Aa.ga(cb);++cb;this.cCa=Aa.ga(cb);++cb;this.Ira=Aa.ga(cb);++cb;this.GS=Aa.ga(cb);++cb;this.gW=
Aa.ga(cb);++cb;this.YPa=Aa.ga(cb);++cb;this.ftd=this.WCk(Ma.DSa(Aa.ga(cb)));++cb;this.LLe=Aa.ga(cb);++cb;this.hLe=Aa.ga(cb);++cb;const Fb=Aa.ga(cb);++cb;this.n2e=Array(Fb);for(let zc=0;zc<Fb;++zc){const Vc=Aa.ga(cb);++cb;const rd=this.ftd.trie,Z=new ab.a;Z.tSa(Aa,cb,Vc);this.n2e[zc]=this.aDk(Z,Ma,rd);cb+=Vc}const dc=Aa.ga(cb);++cb;this.zPc=Array(dc);for(Ma=0;Ma<dc;++Ma){const zc=Aa.ga(cb);++cb;const Vc=new ab.a;Vc.tSa(Aa,cb,zc);this.zPc[Ma]=this.ACk(Vc);cb+=zc}}catch(Fb){throw Error.argument("initData");
}}}WCk(Aa){return new He.a(new af.a(Aa))}aDk(Aa,Ma,cb){return Id.a.create(Aa,Ma,cb)}ACk(Aa){return new Yd(Aa)}}Object(h.a)(zf,"NGramNLModuleInit",null,[]);class od{constructor(Aa){this.Ia=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");Aa=Aa.clone();this.Ia.script.execute(Aa,null);return Aa}}Object(h.a)(od,"ScriptNLModule",null,[1051]);class gf{constructor(Aa,Ma){Aa&&(this.script=Ma.n9a(Aa.ga(0)))}}Object(h.a)(gf,"ScriptNLModuleInit",null,[]);const Lf=Aa=>{Aa=ld(Aa,Ma=>Ma*Ma);return Math.sqrt(id(Aa,
(Ma,cb)=>Ma+cb,0))},ke=Aa=>id(Aa,(Ma,cb)=>Ma>cb?Ma:cb,Aa[0]);class vf{constructor(Aa){this.Ia=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");var Ma=[],cb=[];this.kvi(Aa,Ma,cb);this.Nbi(Ma,cb);const Fb={};for(let zc=0;zc<Ma.length;++zc){var dc=Ma[zc];const Vc=this.Ia.sfg.ga(dc);dc=this.Ia.tfg.ga(dc);for(let rd=0;rd<dc;++rd){const Z=this.Ia.ysi.ga(this.Ia.PEf.ga(Vc+rd)),Da=this.Ia.QEf.ga(Vc+rd);let Wa;({value:Wa}=ce(Fb,Z)).returnValue||(Wa=0);Fb[Z]=Wa+cb[zc]*Da}}cb=Ne(Fb);cb.sort((zc,Vc)=>
{var rd=zc.value,Z=Vc.value;(rd=-(rd>Z?1:rd<Z?-1:0))||(rd=zc.key.localeCompare(Vc.key));return rd});Ma=new gc.a(this.Ia.annotations,Q.Annotations.QM);for(const zc of xd(cb,this.Ia.Gkk))cb=new D.a(this.Ia.annotations),cb.ru(this.Ia.Dgi,zc.key),cb.ru(this.Ia.Fgi,zc.value),Array.add(Ma.items,cb);Aa.ru(this.Ia.Egi,Ma);return Aa}kvi(Aa,Ma,cb){if(({value:Aa}=Aa.Rm(this.Ia.Cgi)).returnValue){let Fb;if(({value:Fb}=Aa.Rm(this.Ia.Yrb)).returnValue){let dc;if(!({value:dc}=Aa.Rm(this.Ia.Xrb)).returnValue||Fb.items.length!==
dc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.hKc(Fb,dc,Ma,cb)}if(({value:Fb}=Aa.Rm(this.Ia.Hgi)).returnValue){let dc;if(!({value:dc}=Aa.Rm(this.Ia.Igi)).returnValue||Fb.items.length!==dc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.hKc(Fb,dc,Ma,cb)}({value:Fb}=Aa.Rm(this.Ia.Wrb)).returnValue&&this.hKc(Fb,null,Ma,cb);({value:Fb}=Aa.Rm(this.Ia.Ggi)).returnValue&&
this.hKc(Fb,null,Ma,cb)}}hKc(Aa,Ma,cb,Fb){for(let zc=0;zc<Aa.items.length;++zc){var dc=void 0;Aa.yU===Q.Annotations.aZ?({value:dc}=ce(this.Ia.oQf,Aa.items[zc])).returnValue||(dc=-1):(dc=Aa.items[zc],dc=dc>=this.Ia.hEe&&dc<=this.Ia.Zkk?this.Ia.zFe?this.Ia.zFe.ga(dc-this.Ia.hEe)-1:dc-this.Ia.hEe:-1);if(0<=dc){let Vc;Vc=Ma?Ma.items[zc]:1;0<Vc&&(Array.add(cb,dc),Array.add(Fb,Vc))}}}Nbi(Aa,Ma){if(Aa.length){switch(this.Ia.PLk){case 0:break;case 1:for(var cb=0;cb<Ma.length;++cb)Ma[cb]=1+Math.log(Ma[cb]);
break;case 2:cb=ke(Ma);for(let Fb=0;Fb<Ma.length;++Fb)Ma[Fb]=.5+Ma[Fb]/cb*.5;break;case 3:for(cb=0;cb<Ma.length;++cb)Ma[cb]=1;break;default:throw Error.notImplemented();}if(this.Ia.TXc)for(cb=0;cb<Ma.length;++cb)Ma[cb]*=this.Ia.TXc.ga(Aa[cb]);Aa=Lf(Ma);for(cb=0;cb<Ma.length;++cb)Ma[cb]/=Aa}}}Object(h.a)(vf,"TfIdfRankerNLModule",null,[1051]);class ng{constructor(Aa,Ma=0){if(!Aa)throw Error.argumentNull("byteArray");this.qJ=Ma;if(604662927!==Aa.qu(this.qJ+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");
this.Xk=Aa.qu(this.qJ+4,4);this.Vsg=Aa.qu(this.qJ+8,4);this.c6j=Aa}ga(Aa){if(0>Aa||Aa>=this.count)throw Error.argumentOutOfRange("index");return this.c6j.SQk(8*this.qJ+96+Aa*this.Vsg,this.Vsg)}get count(){return this.Xk}}Object(h.a)(ng,"CompactIntArray",null,[1052]);const wg=(Aa,Ma)=>{Ma=Array(Ma);for(let zc=0;zc<Ma.length;zc++){var cb=zc,Fb=Aa.xY(),dc=1===(Fb>>31&1)?-1:1;const Vc=Fb&8388607;Fb=Fb>>23&255;256===Fb+1?dc=Vc?Number.NaN:1===dc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Fb?(Fb-=
127,dc=dc*bf(Vc,1)*Math.pow(2,Fb)):dc=dc*bf(Vc,0)*Math.pow(2,-126);Ma[cb]=dc}return Ma},bf=(Aa,Ma)=>{let cb=0;for(let Fb=0;23>Fb;Fb++)cb+=(Aa>>22-Fb&1)/Math.pow(2,Fb+1);return Ma+cb};class Pd{constructor(Aa,Ma){this.zFe=null;this.v0g=0;this.tfg=this.sfg=this.TXc=null;this.u0g=0;this.QEf=this.PEf=null;this.annotations=Ma.annotations;let cb=0;this.Ggi=Aa.ga(cb);++cb;this.Wrb=Aa.ga(cb);++cb;this.Hgi=Aa.ga(cb);++cb;this.Igi=Aa.ga(cb);++cb;this.Yrb=Aa.ga(cb);++cb;this.Xrb=Aa.ga(cb);++cb;this.Cgi=Aa.ga(cb);
++cb;this.Egi=Aa.ga(cb);++cb;this.Dgi=Aa.ga(cb);++cb;this.Fgi=Aa.ga(cb);++cb;var Fb=Aa.ga(cb);++cb;var dc=Array(Fb);for(var zc=0;zc<Fb;++zc)dc[zc]=Ma.yC(Aa.ga(cb)),++cb;this.ysi=ab.a.mYd(dc);this.Gkk=Aa.ga(cb);++cb;this.PLk=Aa.ga(cb);++cb;Fb=Aa.ga(cb);++cb;this.oQf={};for(dc=0;dc<Fb;++dc){zc=Ma.yC(Aa.ga(cb));++cb;const Vc=Aa.ga(cb);++cb;this.oQf[zc]=Vc}this.hEe=Aa.ga(cb);++cb;this.Zkk=Aa.ga(cb);++cb;Fb=Aa.ga(cb);++cb;0<Fb&&(Fb=Ma.DSa(Aa.ga(cb)),++cb,this.zFe=this.dhd(new qd(Fb)));++cb;Aa=Ma.DSa(Aa.ga(cb));
this.LCk(Aa)}dhd(Aa){return new ng(Aa.vZb,Aa.offset)}LCk(Aa){try{const Ma=new qd(Aa);this.v0g=Ma.xY();1===Ma.xY()?this.TXc=ab.a.mYd(wg(Ma,this.v0g)):this.TXc=null;const cb=Ma.xY();this.sfg=this.dhd(Ma);Ma.offset+=cb;const Fb=Ma.xY();this.tfg=this.dhd(Ma);Ma.offset+=Fb;this.u0g=Ma.xY();const dc=Ma.xY();this.PEf=this.dhd(Ma);Ma.offset+=dc;this.QEf=ab.a.mYd(wg(Ma,this.u0g))}catch(Ma){throw Error.argument("byteReader");}}}Object(h.a)(Pd,"TfIdfRankerNLModuleInit",null,[]);class Md{constructor(Aa,Ma,cb,
Fb){this.QJe=Aa;this.uWf=cb;this.tokens=Fb;this.k8=Ma;this.rLb=-1;this.Ynd=0}}Object(h.a)(Md,"TokenizerData",null,[]);class Mh{constructor(Aa){this.Ia=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");if(!({value:Fb}=Aa.Rm(this.Ia.cCa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ma;({value:Ma}=Aa.Rm(this.Ia.GS)).returnValue||(Ma=0);let cb;({value:cb}=Aa.Rm(this.Ia.gW)).returnValue||(cb=Fb.length-Ma);if(0>Ma||Ma>Fb.length)throw Error.argument("input",
"Start index out of range");if(0>cb||cb>Fb.length)throw Error.argument("input","Length out of range");if(Ma+cb>Fb.length)throw Error.argument("input","Bad start-length range");var Fb=new Md(Fb,Ma,Ma+cb,new gc.a(this.Ia.annotations,Q.Annotations.QM));this.twl(Fb);Aa=Aa.isReadOnly?Aa.clone():Aa;Aa.ru(this.Ia.Ira,Fb.tokens);return Aa}twl(Aa){for(;Aa.k8<Aa.uWf;){if(this.Ia.Rae){var Ma=this.Ia.Rae.krg(Aa.QJe,Aa.k8,Aa.uWf-Aa.k8,null);!Ma.succeeded&&Ma.F_g&&(Ma=Ma.F_g);if(Ma.succeeded){this.x4g(Aa,Ma.length,
this.Ia.K9f);Aa.k8+=Ma.length;continue}}Ma=Aa.QJe.substr(Aa.k8);let cb=-1,Fb=-1,dc=-1;for(let zc=0;zc<this.Ia.Lmd.length;++zc){const Vc=this.Ia.Lmd[zc].exec(Ma);Vc&&0<Vc[1].length&&(0>cb||Vc[0].length>Fb)&&(cb=zc,Fb=Vc[0].length,dc=Vc[1].length)}0<=cb?(this.x4g(Aa,dc,this.Ia.gTe[cb]),Aa.k8+=dc):Aa.k8+=1}}x4g(Aa,Ma,cb){if(this.Ia.dmg)cb!==Mh.zni&&(0>Aa.rLb&&(Aa.rLb=Aa.k8),Aa.Ynd=Aa.k8+Ma-Aa.rLb,cb===Mh.yni&&(0<=Aa.rLb&&0<Aa.Ynd&&(Ma=new D.a(this.Ia.annotations),Ma.ru(this.Ia.GS,Aa.rLb),Ma.ru(this.Ia.gW,
Aa.Ynd),Ma.ru(this.Ia.LRd,Mh.Ani),Ma.ru(this.Ia.cCa,Aa.QJe),Array.add(Aa.tokens.items,Ma)),Aa.rLb=-1,Aa.Ynd=0));else{let Fb=new D.a(this.Ia.annotations);Fb.ru(this.Ia.GS,Aa.k8);Fb.ru(this.Ia.gW,Ma);Fb.ru(this.Ia.LRd,cb);Array.add(Aa.tokens.items,Fb)}}}Mh.zni="GAP";Mh.yni="EOS_CHUNK";Mh.Ani="SENTENCE";Object(h.a)(Mh,"TokenizerNLModule",null,[1051]);class Bh{constructor(Aa,Ma){this.gW=this.GS=this.LRd=this.Ira=this.cCa=0;this.dmg=!1;this.gTe=this.Lmd=this.K9f=this.Rae=null;if(Aa){this.annotations=Ma.annotations;
var cb=0;try{this.cCa=Aa.ga(cb);++cb;this.Ira=Aa.ga(cb);++cb;this.LRd=Aa.ga(cb);++cb;this.GS=Aa.ga(cb);++cb;this.gW=Aa.ga(cb);++cb;this.dmg=1===Aa.ga(cb);++cb;var Fb=Aa.ga(cb);++cb;0<Fb&&(this.Rae=Ma.A8d(Fb).oXi);this.K9f=Aa.ga(cb)?Ma.yC(Aa.ga(cb)):"";++cb;const dc=Aa.ga(cb);++cb;this.Lmd=Array(dc);this.gTe=Array(dc);for(Fb=0;Fb<dc;++Fb)this.Lmd[Fb]=new RegExp(Ma.yC(Aa.ga(cb))),++cb,this.gTe[Fb]=Ma.yC(Aa.ga(cb)),++cb}catch(dc){throw Error.argument("initData");}}}}Object(h.a)(Bh,"TokenizerNLModuleInit",
null,[]);class Vh{constructor(Aa){this.Ia=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");let Ma;if(!({value:Ma}=Aa.Rm(this.Ia.Cyf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const cb of this.Ia.a_e)Ma=cb.apply(Ma);Aa=Q.Annotations.VK(Aa);Aa.ru(this.Ia.Dyf,Ma);return Aa}static jRd(Aa,Ma){const cb=new Sys.StringBuilder;for(let Fb=0;Fb<Aa.length;++Fb)cb.append(Ma(Aa.substr(Fb,1)));return cb.toString()}}Object(h.a)(Vh,"TransliteratorNLModule",
null,[1051]);class Jg{constructor(Aa){Aa&&(this.style=Aa.ga(0))}apply(Aa){return Vh.jRd(Aa,Ma=>Jg.pqi(Ma,this.style))}static pqi(Aa,Ma){switch(Ma){case 0:return Aa.toLowerCase();case 1:return"I"===Aa?"\u0131":Aa.toLowerCase();case 2:return Aa.toUpperCase();case 3:return"i"===Aa?"\u0130":Aa.toUpperCase();default:throw Error.invalidOperation();}}}Jg.L6a=0;Object(h.a)(Jg,"ChangeCaseTransliterationStage",null,[1075]);class Of{apply(Aa){return Vh.jRd(Aa,Of.ixl)}static ixl(Aa){const Ma=Aa.charCodeAt(0);
return 65281<=Ma&&65374>=Ma?String.fromCharCode(Ma-65248):Aa}}Of.L6a=4;Object(h.a)(Of,"LatinFullWidthToHalfWidthTransliterationStage",null,[1075]);class bi{constructor(Aa,Ma){Aa&&(this.regex=Ma.y5f(Aa.ga(0)),this.g0k=Ma.yC(Aa.ga(1)))}apply(Aa){return Aa.replace(this.regex,this.g0k)}}bi.L6a=1;Object(h.a)(bi,"RegexReplaceTransliterationStage",null,[1075]);class ij{constructor(Aa,Ma){if(Aa){var cb=Aa.ga(0),Fb=Ma.yC(Aa.ga(1)),dc=new ng(Ma.DSa(Aa.ga(2)));Aa=0>Aa.ga(3)?null:new ng(Ma.DSa(Aa.ga(3)));this.T_e=
{};for(Ma=0;Ma<cb;++Ma)this.T_e[Fb.charAt(Ma).toString()]=Fb.substr(dc.ga(Ma),Aa?Aa.ga(Ma):1)}}apply(Aa){return Vh.jRd(Aa,Ma=>Ma in this.T_e?this.T_e[Ma]:Ma)}}ij.L6a=2;Object(h.a)(ij,"SingleCharSubstitutionsTransliterationStage",null,[1075]);class ig{constructor(Aa,Ma){this.Dyf=this.Cyf=0;this.a_e=null;if(Aa){this.annotations=Ma.annotations;var cb=0;try{this.Cyf=Aa.ga(cb);++cb;this.Dyf=Aa.ga(cb);++cb;const Fb=Aa.ga(cb);++cb;this.a_e=Array(Fb);for(let dc=0;dc<Fb;++dc){const zc=Aa.ga(cb);++cb;const Vc=
Aa.ga(cb);++cb;const rd=new ab.a;rd.tSa(Aa,cb,Vc);cb+=Vc;this.a_e[dc]=this.VCk(zc,rd,Ma)}}catch(Fb){throw Error.argument("initData");}}}VCk(Aa,Ma,cb){switch(Aa){case Jg.L6a:return new Jg(Ma);case bi.L6a:return new bi(Ma,cb);case ij.L6a:return new ij(Ma,cb);case Of.L6a:return new Of;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)(ig,"TransliteratorNLModuleInit",null,[]);class oj{sdj(Aa,Ma){const cb=Aa.ga(0),Fb=new ab.a;Fb.tSa(Aa,1,Aa.count-
1);switch(cb){case 0:return new od(new gf(Fb,Ma));case 2:return new Mh(new Bh(Fb,Ma));case 3:return new oe(new zf(Fb,Ma));case 5:return new ob(new Mb(Fb,Ma));case 9:return new Vh(new ig(Fb,Ma));case 10:return new vf(new Pd(Fb,Ma));default:throw Error.notImplemented();}}}Object(h.a)(oj,"NLModuleFactory",null,[1027]);class fh{constructor(Aa){this.tni=";";if(!Aa)throw Error.argumentNull("resource");this.P4=new me(Aa,new Ib,new oj);this.Kye=this.P4.cdj();this.Gsg=this.P4.annotations.Y4b("Text.Text");
this.Esg=this.P4.annotations.Y4b("Classification.Predictions");this.Ipe=this.P4.annotations.Y4b("Classification.PredictionString");this.Fsg=this.P4.annotations.Y4b("Classification.Probability");this.M5j=this.P4.annotations.Y4b("NLMod.Tokens");if(0>this.Gsg||0>this.Esg||0>this.Ipe||0>this.Fsg)throw Error.argument("resourceObj","Resource does not represent a ranker");}Q3i(){const Aa=[];this.$1d(void 0,this.TZf(Aa),null);return Aa}S3i(Aa,Ma){const cb=[],Fb=[];this.$1d(Aa,this.TZf(cb),(dc,zc)=>{const Vc=
this.P4.annotations.FZf(dc),rd=[],Z=[];Ma&&Ma.length&&-1===Array.indexOf(Ma,Vc)||(dc=this.P4.annotations.getAttributeType(dc),this.dah(dc,zc,rd,Z),zc=new vg(Vc,rd,Z),Array.add(Fb,zc))});return new Uf(cb,Fb)}R3i(Aa){const Ma=[];this.$1d(Aa,cb=>{let Fb;if(({value:Fb}=cb.Rm(this.Ipe)).returnValue){let dc;({value:dc}=cb.Rm(this.Fsg)).returnValue&&Array.add(Ma,new Uc(Fb,dc))}},null);return Ma}$1d(Aa,Ma,cb){var Fb=new D.a(this.P4.annotations);Fb.ru(this.Gsg,Aa);Aa=this.Kye.execute(Fb);if(({value:Fb}=Aa.Rm(this.Esg)).returnValue)for(const dc of Fb.items)Ma(dc);
if(cb&&({value:Ma}=Aa.Rm(this.M5j)).returnValue)for(const dc of Ma.items)dc.vQc(cb)}dah(Aa,Ma,cb,Fb){if(Q.Annotations.QB(Aa))for(var dc of Ma.items)this.dah(Ma.yU,dc,cb,Fb);else if(Q.Annotations.OEh(Aa)){dc=this.P4.annotations.j4f(Aa);for(let zc=0;zc<dc;zc++)Array.add(cb,this.P4.annotations.k7f(Aa,zc)),Array.add(Fb,this.P4.annotations.V1(this.P4.annotations.g$a(Aa,zc),Ma.PSa(zc)))}else Array.add(cb,"VALUE"),Array.add(Fb,this.P4.annotations.V1(Aa,Ma))}TZf(Aa){return Ma=>{let cb;({value:cb}=Ma.Rm(this.Ipe)).returnValue&&
Array.add(Aa,this.Hfj(cb))}}Hfj(Aa){const Ma=Aa.indexOf(this.tni);return 0>Ma?Aa:Aa.substring(0,Ma)}}Object(h.a)(fh,"Ranker",null,[]);var Qd=d(335),$e=d(384),yh=d(27);class Ti{constructor(Aa,Ma){this.fhf="";this.OId=null;this.PId=!1;this.lba=null;this.wNh=["TellMe.TellMeParamCollection"];this.qb=Aa;this.RAa=Ma;this.qb.r6a&&(this.lba=null)}get tjd(){if(!this.OId&&!this.PId){let Aa=null;try{Aa=window.TellMeModel}catch(Ma){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("QueryRanker",
"TellMeModel not found. Exception: "+Ma)}if(Aa){try{this.OId=new fh(Aa)}catch(Ma){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ma)}this.PId=!0}else if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("QueryRanker","Classifier model not found")}return this.OId}aE(){return"Command"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb=!1,Fb=e.a.tellMe,dc=null){const zc=new v.a(Aa);if((!dc||Array.contains(dc,
0))&&!A.a.MF(Aa)){if(!this.tjd&&this.PId){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.qb.r6a&&this.lba&&this.lba.initialize();if(Qd.CommandResultsUtility.Pie(Aa.zf)&&(dc=Qd.CommandResultsUtility.X_f(Aa.zf),0<dc.results.length)){dc.displayName="Classifier Debug";zc.Uq(dc);Ma.resultsUpdated(zc);return}dc=Aa?this.fhf=Aa.zf:this.fhf;if(yh.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){dc=
this.Jfj(dc);var Vc=this.NRc(dc.m9d());dc=dc.pZf()}else dc=this.Ifj(dc),Vc=this.J5i(dc),dc=[];Qd.CommandResultsUtility.Z1c(Vc,!1,"Classifier","TFIDF");Vc=Qd.CommandResultsUtility.TTc(Aa,Vc,this.qb,this.lba,this.RAa,dc,0,1);0<Vc.results.length&&Fb!==e.a.contextMenu&&(Vc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);cb||Vc.results.length||this.qb.$Ea||this.qb.Tya||(Aa=new z.a("lookupNoResults",14,Aa.zf,null,1),Vc.ls(Aa));0<Vc.results.length&&zc.Uq(Vc);zc.attributes=dc}Ma.resultsUpdated(zc)}m9d(){let Aa=
[];try{Aa=this.tjd.Q3i()}catch(Ma){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("GetPredictions","Exception: "+Ma)}return Aa}Ifj(Aa){let Ma=[];try{Ma=this.tjd.R3i(Aa)}catch(cb){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("GetPredictionsWithScore","Exception: "+cb)}return Ma}Jfj(Aa){try{return this.tjd.S3i(Aa,this.wNh)}catch(Ma){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("GetPredictionsWithTokenAttributes","Exception: "+Ma)}return new Uf([],
[])}NRc(Aa){const Ma=[];if(Aa)for(const cb of Aa)Ma.push(new $e.a(cb,-99999));return Ma}J5i(Aa){const Ma=[];if(Aa)for(const cb of Aa)Ma.push(new $e.a(cb.prediction,cb.score));return Ma}}Object(h.a)(Ti,"CommandResultsProvider",null,[654]);var fe=d(985);class gi{constructor(Aa){this.qb=Aa}aE(){return"Feedback"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb,Fb,dc=null){Aa=new v.a(Aa);if(!dc||Array.contains(dc,21))dc=[],dc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),
appChrome.api.dispatch(dc),dc=new B.a(22),dc.displayName="",dc.ls(new z.a("TellMeFeedback",23,null,null,1)),Aa.Uq(dc);Ma.resultsUpdated(Aa)}}Object(h.a)(gi,"FeedbackResultsProvider",null,[654]);class vi{constructor(Aa,Ma,cb,Fb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Aa;this.CommandId=Ma;this.CommandValueId=cb;this.InputText=Fb}}Object(h.a)(vi,"FindInDocumentProp",null,[]);var bk=d(47);class Zg{constructor(Aa){this.RFd=2;this.e4a=[];this.qOa=[];this.qb=Aa;Zg.Oja=
Aa.JVf;Zg.OVf="FindInDocumentSuggestion";Zg.m$g="FindInDocumentSuggestion3";this.iVh=Object.assign(new E.a,{landingTab:"Indoc",data:null});this.I_h=this.qb.EMb||!!yh.AFrameworkApplication.Aa&&yh.AFrameworkApplication.Aa.hb.EMb}aE(){return"FindInDocument"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:3===this.qb.Aq?this.qb.Bwh?2:3:2}fB(Aa,Ma,cb=!1,Fb,dc=null){const zc=new v.a(Aa);if(dc&&!Array.contains(dc,2))Ma.resultsUpdated(zc);else if(Array.clear(this.e4a),A.a.MF(Aa)){if(cb&&this.uuh()){cb=new B.a(2);
cb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;dc=1;Fb="";if(0<this.qOa.length&&!this.qb.FMb)for(var Vc of this.qOa)if(""!==Vc.Label.toLowerCase()){if(dc>=this.RFd)break;this.vHh(cb,Vc.Label,Vc.CommandValueId,Zg.OVf+dc,Vc.InputText);dc++}Vc="";this.qb.OH?(zc.Uq(cb),cb=new B.a(3),Vc=this.qb.VPa?A.a.BSa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):Vc=CommonUIStrings.l_TellMeOpenFindPaneText;Fb=this.W_f("");this.vHh(cb,Vc,Fb,Zg.m$g,"");
zc.Uq(cb)}Ma.resultsUpdated(zc)}else Vc="",cb&&(cb=this.W_f(Aa.zf),Fb=[],this.qb.hVa?(this.qb.cYe&&Fb.push(appChrome.actions.setControlIconSet(Zg.Oja,{"default":"FindInDocument_20"})),Vc=this.qb.bme?A.a.m7d(Aa.zf,CommonUIStrings.l_FindInDocumentScopedButtonText):Aa.zf+CommonUIStrings.l_FindInDocumentScopedButtonText):this.qb.OH?(Vc=this.qb.VPa?A.a.BSa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,Aa.zf)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Aa.zf),
Fb.push(appChrome.actions.setControlIconSet(Zg.Oja,{"default":"FindInDocument_20"}))):Vc=this.qb.FMb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Aa.zf),this.qb.tda?(y.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Zg.Oja,Vc)),y.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Zg.Oja,cb))):(Fb.push(appChrome.actions.setControlLabel(Zg.Oja,Vc)),Fb.push(appChrome.actions.setButtonCommandValueId(Zg.Oja,cb)),
appChrome.api.dispatch(Fb)),this.Aqh(Vc,Zg.Oja,cb,Aa.zf)),this.qb.Bwh?(Vc=new z.a(Zg.Oja,8,Aa.zf),cb=new B.a(2),cb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,cb.ls(Vc),zc.Uq(cb),Ma.resultsUpdated(zc)):this.qb.F9i().then(rd=>{const Z=new z.a(Zg.Oja,8,Aa.zf,null,1);Z.count=rd;rd=new B.a(2);rd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;rd.ls(Z);zc.Uq(rd);Ma.resultsUpdated(zc)},rd=>{y.TellMeActor.instance.Hd.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+
rd);rd=new z.a(Zg.Oja,8,Aa.zf,null,1);const Z=new B.a(2);Z.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Z.ls(rd);zc.Uq(Z);Ma.resultsUpdated(zc)})}uuh(){return!!this.qb&&this.qb.dqd}vHh(Aa,Ma,cb,Fb,dc=null){const zc=[];Ma&&zc.push(appChrome.actions.setControlLabel(Fb,Ma));this.qb.OH&&zc.push(appChrome.actions.setControlIconSet(Fb,{"default":"FindInDocument_20"}));zc.push(appChrome.actions.setButtonCommandValueId(Fb,cb));appChrome.api.dispatch(zc);this.Aqh(Ma,Fb,cb,"");Aa.ls(new z.a(Fb,
8,dc,null,1,-99999))}W_f(Aa){return this.I_h?A.a.PCa(Aa,15,this.iVh):bk.a.ue(Aa)}Aqh(Aa,Ma,cb,Fb){this.uuh()&&this.e4a.length<this.RFd&&(Aa=new vi(Aa,Ma,cb,Fb),Array.add(this.e4a,Aa))}sbl(Aa){for(let Ma=0;Ma<this.e4a.length;Ma++)if(this.e4a[Ma].CommandId===Aa){const cb=this.e4a[Ma].Label;let Fb=!1;if(0<this.qOa.length){let dc=0;for(const zc of this.qOa){if(zc.Label===cb){Array.removeAt(this.qOa,dc);Fb=!0;break}dc++}}!Fb&&this.qOa.length>=this.RFd-1&&Array.removeAt(this.qOa,1);Array.insert(this.qOa,
0,this.e4a[Ma])}}}Zg.Oja=null;Zg.OVf=null;Zg.m$g=null;Object(h.a)(Zg,"FindInDocumentResultsProvider",null,[654]);var Ek=d(983);class Ch{constructor(Aa){this.qb=Aa}aE(){return"Insights"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb=!1,Fb,dc=null){Fb=new v.a(Aa);if(!dc||Array.contains(dc,13))if(this.Yil()||!A.a.MF(Aa)){dc=new B.a(13);var zc=""===Aa.zf.trim(),Vc=zc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",rd=new z.a(Vc,10,Aa.zf,null,1);cb&&(cb=null,A.a.d4()?zc?zc=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:
(zc=this.qb.FMb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Aa.zf),cb=A.a.PCa(Aa.zf,1)):(zc=String.format(CommonUIStrings.l_InsightsButtonText,Aa.zf),cb=A.a.rYd(Aa.zf)),this.qb.tda?(y.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Vc,zc)),cb&&y.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",cb))):(Aa=[],Aa.push(appChrome.actions.setControlLabel(Vc,zc)),
cb&&Aa.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",cb)),appChrome.api.dispatch(Aa)),rd.label=zc);dc.ls(rd);Fb.Uq(dc)}Ma.resultsUpdated(Fb)}Yil(){return A.a.d4()&&this.qb.bul&&!this.qb.n3}}Object(h.a)(Ch,"InsightsResultsProvider",null,[654]);var Ui=d(981);class pg{constructor(Aa){this.qb=Aa}aE(){return"Learning"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb,Fb,dc=null){cb=new v.a(Aa);dc&&!Array.contains(dc,21)||!A.a.MF(Aa)||(dc=[],Fb=this.qb.HZj,dc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",
Fb)),Fb=pg.e$i(Fb),dc.push(appChrome.actions.setControlLabel("LearningForSearch",Fb)),appChrome.api.dispatch(dc),Aa=new z.a("LearningForSearch",22,Aa.zf,null,1),dc=new B.a(21),dc.ls(Aa),cb.Uq(dc));Ma.resultsUpdated(cb)}static e$i(Aa){const Ma=[];Array.add(Ma,new Ui.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ma,new Ui.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Ma,new Ui.a(600,Aa));Array.add(Ma,new Ui.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Aa=
{};Aa.parts=Ma;return JSON.stringify(Aa)}}Object(h.a)(pg,"LearningProvider",null,[654]);var Mg=d(1063);class gh{constructor(Aa,Ma){this.Kob=this.Kqb=this.KOa=this.aBc=null;this.Zv=!1;this.apb=Aa;this.HPh=Ma;Aa&&this.cUf(Aa)}Htd(){this.apb.Htd()&&this.cUf(this.apb)}jlj(Aa){let Ma=[];var cb=[];Aa=gh.uok(Aa);var Fb="";Array.clear(cb);for(let dc=0;dc<Aa.length;dc++){const zc=Aa.charAt(dc);-1!==" ".indexOf(zc)?(Fb.length&&Array.add(cb,Fb),Fb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(zc)?(Fb.length&&
Array.add(cb,Fb),Fb=zc,Array.add(cb,Fb),Fb=""):Fb+=zc}Fb.length&&Array.add(cb,Fb);for(Aa=0;Aa<cb.length;Aa++)Fb=this.I5i(cb[Aa]),Fb=this.zAi(Fb),Ma=gh.xlk(Ma,Fb);return Ma=this.U6h(Ma)}xke(){this.Zv||this.Htd();return this.Zv}xMc(Aa){return this.aBc[Aa.toString()]}U6h(Aa){for(let Ma=0;Ma<Aa.length;Ma++){const cb=this.KOa[Ma];if(Aa[Ma].commandId!==this.xMc(cb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Fb;(Fb=Aa[Ma]).score=Fb.score+cb[1]}return Aa}zAi(Aa){const Ma=[];for(var cb=
0;cb<this.KOa.length;cb++)Ma.push(new $e.a(this.xMc(this.KOa[cb][0]),-5));cb=new Mg.a;for(var Fb=0;Fb<Aa.length;Fb++)cb.add(this.xMc(Aa[Fb][0]));for(Fb=0;Fb<Ma.length;Fb++){const zc=Ma[Fb];for(let Vc=0;Vc<Aa.length;Vc++){var dc=Aa[Vc];const rd=this.xMc(dc[0]);dc=dc[1];if(rd===zc.commandId){zc.score=dc;cb.remove(rd);break}}if(!cb.count)break}return Ma}I5i(Aa){const Ma=1>Aa.length;for(let Vc=0;2>=Vc;Vc++){const rd=this.Kob;for(let Z in rd){var cb=rd[Z],Fb=Aa,dc=Z;const Da=dc.length+1,Wa=Array((Fb.length+
1)*Da);for(var zc=0;zc<=Fb.length;zc++)Wa[zc*Da]=zc;for(zc=0;zc<=dc.length;zc++)Wa[zc]=zc;for(zc=0;zc<dc.length;zc++)for(let ib=0;ib<Fb.length;ib++)Wa[(ib+1)*Da+(zc+1)]=Fb.charAt(ib)===dc.charAt(zc)?Wa[ib*Da+zc]:Math.min(Math.min(Wa[ib*Da+(zc+1)]+1,Wa[(ib+1)*Da+zc]+1),Wa[ib*Da+zc]+1);Fb=Wa[Fb.length*Da+dc.length];if((!Fb||!Ma)&&Fb<=Vc)return cb}}return this.Kqb}cUf(Aa){this.aBc=Aa.z8d();this.KOa=Aa.Vfj();this.Kqb=Aa.hnj();this.Kob=Aa.cbj();if(this.Zv=!!this.aBc&&!!this.KOa&&!!this.Kob&&!!this.Kqb)this.Zv=
0<this.KOa.length&&gh.vie(this.KOa);this.Zv&&(this.Zv=0<this.Kqb.length&&gh.vie(this.Kqb));this.Zv&&(this.Kob=gh.Knj(this.Kob));this.Zv||(this.Kob=this.Kqb=this.KOa=this.aBc=null)}Nmj(Aa){Aa=this.jlj(Aa);return this.aXi(Aa,this.HPh)}aXi(Aa,Ma){let cb=[];for(let Fb=0;Fb<Aa.length;Fb++)Aa[Fb].score>=Ma&&cb.push(Aa[Fb]);cb.sort((Fb,dc)=>Fb.score<dc.score?1:Fb.score>dc.score?-1:0);0<cb.length-10&&(cb=cb.slice(0,10));return cb}static xlk(Aa,Ma){if(!Aa.length)return Ma;if(Aa.length!==Ma.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let cb=0;cb<Aa.length;cb++){if(Aa[cb].commandId!==Ma[cb].commandId)throw Error.create("Incorrect CommandId");let Fb;(Fb=Aa[cb]).score=Fb.score+Ma[cb].score}return Aa}static uok(Aa){return bk.a.qg(Aa)}static vie(Aa){for(let Ma=0;Ma<Aa.length;Ma++)if(2!==Aa[Ma].length)return!1;return!0}static Knj(Aa){const Ma={};for(let dc in Aa){var cb=dc,Fb=Aa[dc];const zc=Fb;zc.length&&gh.vie(zc)&&(Ma[cb]=Fb)}return Ma}}Object(h.a)(gh,"NaiveBayesClassifierModel",null,[]);class Ie{constructor(Aa,Ma){this.lba=
null;this.qb=Aa;this.UUb=new gh(Ma,Aa.V3f);this.qb.r6a&&(this.lba=null)}aE(){return"NBCommand"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb=!1,Fb=e.a.tellMe,dc=null){const zc=new v.a(Aa);if((!dc||Array.contains(dc,0))&&!A.a.MF(Aa)){if(Qd.CommandResultsUtility.Pie(Aa.zf)&&(dc=Qd.CommandResultsUtility.X_f(Aa.zf),0<dc.results.length)){dc.displayName="Classifier Debug";zc.Uq(dc);Ma.resultsUpdated(zc);return}if(!this.UUb.xke()){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("CRASH",
"NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.qb.r6a&&this.lba&&this.lba.initialize();dc=this.UUb.Nmj(Aa.zf);Qd.CommandResultsUtility.Z1c(dc,!1,"Classifier","NaiveBayesian");dc=Qd.CommandResultsUtility.TTc(Aa,dc,this.qb,this.lba,null,null,0,1);0<dc.results.length&&Fb!==e.a.contextMenu&&(dc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);cb||dc.results.length||this.qb.$Ea||this.qb.Tya||(Aa=new z.a("lookupNoResults",
14,Aa.zf,null,1),dc.ls(Aa));0<dc.results.length&&zc.Uq(dc)}Ma.resultsUpdated(zc)}}Object(h.a)(Ie,"NaiveBayesCommandProvider",null,[654]);class Ia{constructor(){this.b4a=null;this.Zv=!1;this.Htd()}Htd(){this.Zv||(this.b4a=window.NBCRM)&&4===this.b4a.length&&(this.Zv=!0);return this.Zv}Vfj(){return this.Zv?this.b4a[1]:null}hnj(){return this.Zv?this.b4a[2]:null}cbj(){return this.Zv?this.b4a[3][0]:null}z8d(){return this.Zv?this.b4a[0][0]:null}}Object(h.a)(Ia,"NaiveBayesModelAdapter",null,[956]);var lb=
d(193);class Lb{constructor(Aa){this.qb=Aa}aE(){return"OfficeScript"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma){const cb=new v.a(Aa);if(!A.a.MF(Aa)){Aa=lb.d(Aa.zf);var Fb=new B.a(27);Fb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Fb=this.ktf(Aa,Lb.dBl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Fb);Fb=this.ktf(Aa,Lb.i0i,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Fb);cb.Uq(Fb)}Ma.resultsUpdated(cb)}ktf(Aa,
Ma,cb,Fb,dc,zc){const Vc=[];for(const rd of Ma)if(lb.a(Aa,rd)){this.qb.tda?(y.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(cb,dc)),y.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(cb,Fb))):(Vc.push(appChrome.actions.setControlLabel(cb,dc)),Vc.push(appChrome.actions.setButtonCommandValueId(cb,Fb)),appChrome.api.dispatch(Vc));zc.ls(new z.a(cb,27,null,null,1));break}return zc}}Lb.dBl="unhide row rows col cols column columns".split(" ");Lb.i0i=["freeze",
"selection","pane","panes"];Object(h.a)(Lb,"OfficeScriptsSamplesProvider",null,[654]);var hc=d(18),Pc=d(16),Td=d(451),ie=d(306),Sd=d(450),wf=d(36),Pf=d(106),og=d(125);class Dh{constructor(Aa){this.hI=null;this.cS=-1;this.SDe=14;this.TDe=12;this.attributes=this.TMd=this.query=null;this.Qzb=!1;this.Lpb=[];this.Xh=yh.AFrameworkApplication.Ke;yh.AFrameworkApplication.fa&&(this.SDe=yh.AFrameworkApplication.fa.Bc("TellMeMaxTermedResults",this.SDe),this.TDe=yh.AFrameworkApplication.fa.Bc("TellMeMaxZeroTermResults",
this.TDe));this.XL=Aa}get Lk(){return this.Lpb}get hud(){return this.TMd}Uq(Aa){let Ma=!1;for(let cb=0;cb<this.Lk.length;cb++)if(29!==this.Lk[cb].groupType&&this.Lk[cb].groupType===Aa.groupType){this.JOd(this.Lk[cb],Aa);Ma=!0;break}Ma||this.Lk.push(Aa)}JOd(Aa,Ma){for(let cb=0;cb<Ma.results.length;cb++)Aa.ls(Ma.results[cb])}Khh(Aa){const Ma=[];for(const cb of this.Lk)cb.groupType!==Aa&&Ma.push(cb);this.Lk.length!==Ma.length&&(this.Lpb=Ma)}eXk(Aa){let Ma=null,cb=null,Fb=null;for(let dc=0;dc<Aa.length;dc++){const zc=
Aa[dc];if(zc&&zc.Lk&&zc.Lk.length)for(const Vc of zc.Lk)if(17===Vc.groupType||18===Vc.groupType)Ma=Vc;else if(0===Vc.groupType||16===Vc.groupType)cb=Vc,Fb=zc}Ma&&cb&&0<cb.results.length&&(17===Ma.groupType&&({wOd:cb,VOd:Ma}=Qd.CommandResultsUtility.S5h(cb,Ma,this.XL.WG()?this.XL.WG().W4i:-.6)),Fb.Khh(cb.groupType))}Bol(){new hc.a;this.Lrc(this.XL.HRg)}$$b(Aa,Ma){return this.query.zf.length>this.XL.WG().mgj&&this.pSj(Aa,Ma)||this.query.zf.length>this.XL.WG().ngj&&this.$Uj(Aa,Ma)?!0:!1}$Uj(Aa,Ma){return Aa&&
Aa.length&&Ma&&Ma.length?-1===Ma.toLowerCase().indexOf(Aa.toLowerCase())?!1:!0:!1}pSj(Aa,Ma){return Aa&&Aa.length&&Ma&&Ma.length?Ma.toLowerCase().startsWith(Aa.toLowerCase()):!1}nXi(Aa){const Ma=[];for(const cb of this.XL.WG().OH?this.hud:this.Lk)Aa.contains(cb.groupType)||Ma.push(cb);this.XL.WG().OH?this.TMd=Ma:this.Lpb=Ma}gFl(Aa,Ma){const cb=[];for(const Fb of this.Lk){const dc=Fb;if(13!==dc.groupType||24!==dc.groupType){const zc=Aa[ie.a[dc.groupType].toLowerCase()];let Vc="False";zc<Ma&&(Vc="True");
dc.displayName=dc.displayName+" ("+Vc+": "+zc+")"}cb.push(dc)}this.Lpb=cb}Lrc(Aa,Ma=!1,cb=null){if(this.XL.WG().OH){if(!Ma)for(this.TMd=Array(this.Lk.length),Ma=0;Ma<this.Lk.length;Ma++)this.hud[Ma]=this.Lk[Ma];this.XL.yTg.Lrc(this.Lk,this.hud,this.query,Aa,cb)}else{for(cb=new hc.a;this.Lk.length;){Ma=this.Lk.pop();const Fb=ie.a[Ma.groupType].toLowerCase(),dc=Aa[Fb];if(og.b(dc))throw Error.create("GroupId "+Fb+" missed from group SortingOrder");cb.add(new Pc.a(dc,Ma))}cb.Sc((Fb,dc)=>Fb.key<dc.key?
-1:1);for(Aa=0;Aa<cb.count;Aa++)Ma=cb.ga(Aa).value,this.Lk.push(Ma)}}Dol(){var Aa=!1;let Ma=!1,cb=!1;for(let dc=0;dc<this.Lk.length;dc++){var Fb=this.Lk[dc];const zc=Fb.groupType;if(8===zc||15===zc||14===zc){Fb=Fb.results;for(let Vc=0;Vc<Fb.length;Vc++){if(8===zc&&this.$$b(this.query.zf,Fb[Vc].label)){Aa=!0;break}if(15===zc&&this.$$b(this.query.zf,Fb[Vc].label)){Ma=!0;break}if(14===zc){if(this.$$b(this.query.zf,Fb[Vc].label)||this.$$b(this.query.zf,Fb[Vc].description)){cb=!0;break}const rd=Fb[Vc].label.split(" ");
for(const Z of rd)if(this.$$b(this.query.zf,Z)){cb=!0;break}}}}}Aa=this.XL.Ghj(Aa,Ma,cb);this.Lrc(Aa)}Xgb(Aa,Ma,cb,Fb,dc,zc){if(dc===this.hI){var Vc=Aa.data.Sd;dc=null;try{dc=wf.b(Vc)}catch(Ad){y.TellMeActor.instance.Hd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Ad);return}if("RankerResults"in dc&&dc.RankerResults){this.bja();var rd=dc.RankerResults,Z=new hc.a,Da=new hc.a;Vc=0;for(var Wa of rd){rd=Wa.ProviderId;var ib=Wa.Score;Vc+=ib;Z.add(new Pc.a(rd,
ib))}Z.Sc((Xd,xe)=>Xd.value>xe.value?-1:1);ib=zc?zc.Iij:1E-6;Wa={};rd={};let Ad=0;for(var nb=0;nb<Z.count;nb++){let Xd=parseInt(Z.ga(nb).key),xe=Z.ga(nb).value/Vc;1===Xd&&(rd.answer=Ad++,rd.entity=Ad++,rd.definition=Ad++,rd.wolframanswer=Ad++,xe<ib&&(Da.add(9),Da.add(11),Da.add(10),Da.add(12)),Wa.answer=xe,Wa.entity=xe,Wa.definition=xe,Wa.wolframanswer=xe);2===Xd&&(rd.assistance=Ad++,xe<ib&&Da.add(8),Wa.assistance=xe);3===Xd&&(rd.classifier=Ad++,rd.serviceclassifier=Ad++,xe<ib&&(Da.add(0),Da.add(17)),
Wa.classifier=xe,Wa.serviceclassifier=xe);4===Xd&&(rd.people=Ad++,xe<ib&&Da.add(14),Wa.people=xe);5===Xd&&(rd.document=Ad++,xe<ib&&Da.add(15),Wa.document=xe);6===Xd&&(rd.findindocument=Ad++,xe<ib&&Da.add(2),Wa.findindocument=xe);7===Xd&&(rd.notes=Ad++,xe<ib&&Da.add(20),Wa.notes=xe);8===Xd&&(rd.image=Ad++,xe<ib&&Da.add(19),Wa.image=xe)}Z=new hc.a;Z.add("classifier");Z.add("serviceclassifier");Z.add("appsforoffice");Z.add("addin");Z.add("findindocument");Z.add("assistance");Z.add("document");Z.add("people");
Z.add("answer");Z.add("wolframanswer");Z.add("definition");Z.add("entity");Z.add("image");Z.add("template");Z.add("officescript");for(nb=0;nb<Z.count;nb++)Z.ga(nb)in rd||(rd[Z.ga(nb)]=Ad++);rd.learning=Ad++;rd.insights=Ad++;rd.actionai=Ad++;rd.feedback=Ad++;zc&&zc.SPj&&this.gFl(Wa,ib);zc&&zc.TPj&&this.nXi(Da);Da={};for(var jc in Wa)Da[jc]=Wa[jc]*Vc;this.Lrc(rd,!0,Da)}if(zc.W_c&&"Intents"in dc&&dc.Intents){jc=dc.Intents;for(var cc of jc)if(this.yme(cc)&&"Serplet"===cc.GroupType&&cc.ConfidenceScore>
cc.ConfidenceThreshold){jc=!1;dc=0;if(zc.Hle){Vc=new z.a("",31);for(Da=0;Da<this.Lk.length;Da++)if((Z=this.Lk[Da].results)&&0<Z.length){dc=Da;Vc=Z[0];break}2===Vc.groupType&&(jc=!0)}Vc=new B.a(13);jc&&zc.Hle&&(Vc=new B.a(13,CommonUIStrings.l_TellMeWebTitle));Da=new z.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.zf,null,0);Z=[];Wa=null;Wa=A.a.d4()?A.a.PCa(this.query.zf,1):A.a.rYd(this.query.zf);Z.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Wa));Wa=
String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.zf);Z.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Wa));appChrome.api.dispatch(Z);Vc.ls(Da);Da=[];if(jc&&zc.Hle)for(Da.push(this.Lk[dc]),Da.push(Vc),jc=dc+1;jc<this.Lk.length;jc++)(dc=this.Lk[jc].results)&&0<dc.length&&Da.push(this.Lk[jc]);else for(Da.push(Vc),jc=0;jc<this.Lk.length;jc++)(dc=this.Lk[jc].results)&&0<dc.length&&Da.push(this.Lk[jc]);this.Lpb=Da}}if(zc.hac&&!zc.OH){cc=jc=-1;for(dc=
0;dc<this.Lk.length;dc++)switch(this.Lk[dc].groupType){case 23:jc=dc;break;case 0:case 17:case 2:-1===cc&&(cc=dc)}if(-1!==jc){cc=-1===cc?0:jc>cc?cc+1:cc;jc=this.Lk[jc];dc=Array(this.Lk.length);Vc=0;for(Da=0;Da<dc.length;Da++)Da===cc?dc[Da]=jc:(23===this.Lk[Vc].groupType&&Vc++,dc[Da]=this.Lk[Vc],Vc++);this.Lpb=dc}}Fb.resultsUpdated(this);Fb=y.TellMeActor.instance.Hd;Fb.F5(Ma.length,"RankerInference",Aa.data.oe.toString(),Math.round(window.performance.now()-cb),Sd.a.dBh,!0,Td.a.Qta);this.Qzb&&Fb&&(Aa=
this.query.PZa,Ma=Fb.pxc,zc.n0c&&Aa>Ma&&!zc.OH&&(Fb.zoe(this.query.zf),Fb.fVe(Aa)))}}yme(Aa){if("GroupType"in Aa&&Aa.GroupType&&"ConfidenceScore"in Aa&&"ConfidenceThreshold"in Aa)return!0;y.TellMeActor.instance.Hd.onError("IsValidIntentGroup","Invalid intents found");return!1}Lgb(Aa,Ma,cb,Fb,dc){Fb===this.hI&&(this.bja(),y.TellMeActor.instance.Hd.F5(Ma.length,"RankerInference",Aa.data.oe.toString(),Math.round(window.performance.now()-cb),Sd.a.dBh,!1,Td.a.Qta));dc.resultsUpdated(this)}bja(){-1!==this.cS&&
(window.clearTimeout(this.cS),this.cS=-1)}Eol(Aa){let Ma;Ma=this.XL.WG().OH?y.TellMeActor.instance.Hd.y$d(this.hud,this.query.zf):y.TellMeActor.instance.Hd.y$d(this.Lk,this.query.zf);var cb=this.XL.WG().Hij;""!==cb&&(cb="_"+cb);let Fb="";this.XL.WG().wke&&(Fb="RankerInference"+cb+",");this.XL.WG().W_c&&(Fb+="SerpletClassifier");","===Fb.charAt(Fb.length-1)&&(Fb=Fb.substring(0,Fb.length-1));cb=y.TellMeActor.instance.Hd.L7f(Fb);const dc=this.hI=Pf.a.create().toString();cb["Client-Request-Id"]=dc;const zc=
window.performance.now(),Vc=this.XL.WG()?this.XL.WG().Jij:600;this.bja();this.cS=window.setTimeout(()=>{if(dc===this.hI){this.hI="";this.cS=-1;Aa.resultsUpdated(this);const rd={};rd[n.a.provider]="Ranker";rd[n.a.Uhb]=this.query.PZa;y.TellMeActor.instance.Hd.CH(m.a.timedOut,Vc,rd)}},Vc);this.Xh.mj(y.TellMeActor.instance.Hd.M7f(),2,Ma,cb,!1,0,rd=>{this.Xgb(rd,this.query.zf,zc,Aa,dc,this.XL.WG())},rd=>{this.Lgb(rd,this.query.zf,zc,dc,Aa)},null,null,!1,4E3,6E3)}hyl(){var Aa=0,Ma=new hc.a,cb=this.XL.FRg,
Fb=this.XL.GRg;for(var dc=0;dc<this.Lk.length;dc++){var zc=this.Lk[dc],Vc=ie.a[zc.groupType].toLowerCase(),rd=cb[Vc];Aa+=zc.results.length;zc.results.length>rd&&(Vc=Fb[Vc],og.b(Vc)||Ma.add(new Pc.a(Vc,zc)))}Fb=!this.query||""===this.query.zf.trim();dc=Aa-(Fb?this.TDe:this.SDe);if(!(0>=dc)){Fb=window.performance.now();Aa=Aa.toString()+" total,"+dc.toString()+" to remove.";if(0<Ma.count)for(Ma.Sc((Z,Da)=>Z.key>Da.key?-1:1),zc=0;zc<Ma.count&&0<dc;zc++){Vc=Ma.ga(zc).value;rd=ie.a[Vc.groupType].toLowerCase();
let Z=Vc.results.length-cb[rd];Z>dc&&(Z=dc);0<Z&&(Vc.LQe(Z),Aa+=rd+": "+Z.toString()+" results removed.",dc-=Z)}if(0<dc){Aa+=dc.toString()+" results left after trimming.";Ma=new hc.a;cb=this.XL.KRg;for(zc=0;zc<this.Lk.length;zc++)Vc=this.Lk[zc],rd=cb[ie.a[Vc.groupType].toLowerCase()],og.b(rd)||Ma.add(new Pc.a(rd,Vc));Ma.Sc((Z,Da)=>Z.key<Da.key?-1:1);for(cb=0;0<dc;)zc=Ma.ga(cb++).value,dc>=zc.results.length?(Array.remove(this.Lk,zc),Aa+=ie.a[zc.groupType]+": "+zc.results.length.toString()+" results force removed.",
dc-=zc.results.length):(zc.LQe(dc),Aa+=ie.a[zc.groupType]+": "+dc.toString()+" results force removed.",dc=0)}y.TellMeActor.instance.Hd&&(Ma={},Ma[n.a.message]=Aa,y.TellMeActor.instance.Hd.CH("ShowOptimal",window.performance.now()-Fb,Ma))}}}Object(h.a)(Dh,"CombineResultsUpdatedEventArgs",null,[675]);var Bi=d(693);class Vi{constructor(Aa,Ma,cb,Fb=!1,dc=""){this.YHd=this.sJd=!1;this.xD=Aa;this.L4a=[];this.Mlf=Ma.length;this.qb=y.TellMeActor.instance.WG();this.dAc=Fb;this.oPa=dc;this.sqb={};for(Aa=0;Aa<
Ma.length;++Aa)this.sqb[Aa.toString()]=cb?0:Ma[Aa].nL()}Kcl(Aa,Ma){Ma&&Ma.query&&Ma.query.PZa<y.TellMeActor.instance.Vba||(this.L4a[Aa]=Ma,this.YHd?this.sJd=!0:(!this.qb||3!==this.qb.Aq||3!==this.sqb[Aa.toString()]||this.yOf())&&this.$Xc())}VDk(){this.YHd=!0}mBl(){this.YHd=!1;this.sJd&&(this.sJd=!1,this.$Xc())}yOf(){if(this.L4a.length<this.Mlf)return!1;for(let Aa=0;Aa<this.Mlf;++Aa)if(!this.L4a[Aa])return!1;return!0}$Xc(){var Aa=this.yOf();const Ma=window.performance.now(),cb=new Dh(y.TellMeActor.instance.Hcf);
cb.eXk(this.L4a);for(var Fb=0;Fb<this.L4a.length;++Fb){var dc=this.L4a[Fb];if(dc&&dc.Lk&&dc.Lk.length&&(cb.query=dc.query,dc.attributes&&0<dc.attributes.length&&(cb.attributes=dc.attributes),dc&&dc.Lk&&(Aa||this.Zri(Fb,this.L4a))))for(const zc of dc.Lk)cb.Uq(zc)}cb.Lk&&cb.Lk.length&&(cb.Qzb=Aa,this.qb&&this.qb.T2e&&cb.hyl(),Bi.a.umg()&&(this.qb&&this.qb.sTj&&cb.query.zf&&0<cb.query.zf.length?cb.Dol():cb.Bol()),Bi.a.umg()&&this.qb&&(this.qb.wke||this.qb.W_c)&&this.dAc&&cb.query.zf&&0<cb.query.zf.length&&
cb.Qzb&&this.oPa!==e.a.contextMenu?(3===this.qb.Aq&&Aa||this.xD.resultsUpdated(cb),cb.Eol(this.xD)):this.xD.resultsUpdated(cb),Aa=y.TellMeActor.instance.Hd,cb.Qzb&&Aa&&(Fb=cb.query.PZa,dc=Aa.pxc,cb.query.zf&&0<cb.query.zf.length&&this.dAc&&this.qb.n0c&&this.oPa!==e.a.contextMenu&&Fb>dc&&!this.qb.wke&&!this.qb.OH&&(Aa.zoe(cb.query.zf),Aa.fVe(Fb)),Aa.CH(m.a.b3k,window.performance.now()-Ma)))}Zri(Aa,Ma){if(!(this.sqb&&Aa.toString()in this.sqb)||Ma.length<=Aa||!Ma[Aa])return!1;if(!Ma[Aa].Lk.length)return!0;
const cb=this.sqb[Aa.toString()];if(0===cb)return!0;const Fb=this.sqb;for(let zc in Fb){var dc=Fb[zc];const Vc=Number.parseInvariant(zc);if(Vc!==Aa&&dc===cb&&!(Ma.length>Vc&&Ma[Vc]))return!1}return!0}}Object(h.a)(Vi,"ResultsAggregator",null,[]);var kh=d(1010);class mi{constructor(){this.gOb=this.hOb=this.fOb=this.logCount=this.logRank=this.invertedRank=0}x5h(Aa,Ma){switch(Aa){case 1:this.invertedRank=Ma;break;case 3:this.logRank=Ma;break;case 2:this.logCount=Ma;break;case 5:this.fOb=Ma;break;case 4:this.hOb=
Ma;break;case 6:this.gOb=Ma}}}Object(h.a)(mi,"CommandFeatures",null,[]);class sh{constructor(Aa){this.xbf=0;this.bpb=Aa;this.KOh={}}get modelId(){return this.bpb}get featureIntercept(){return this.xbf}get m0b(){return this.KOh}D4h(Aa,Ma,cb){0===Ma?this.xbf=cb:(this.m0b[Aa]||(this.m0b[Aa]=new mi),this.m0b[Aa].x5h(Ma,cb))}}Object(h.a)(sh,"CoefficientsModel",null,[]);const Ng=(Aa,Ma)=>Math.pow(10,-Ma/(60*Math.LN10/Math.LN2*Aa));class Wh{constructor(Aa,Ma){this.Xk=1;this.lyc=new mi;this.features.logCount=
1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Aa?1/Aa:0;this.features.logRank=2/Math.pow(2,Aa);this.features.fOb=Ng(10,Ma);this.features.hOb=Ng(2,Ma);this.features.gOb=Ng(1,Ma)}get count(){return this.Xk}get features(){return this.lyc}jCj(){this.Xk=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}$El(Aa){const Ma=2/Math.pow(2,Aa);this.features.invertedRank=Math.max(this.features.invertedRank,Aa?1/Aa:0);this.features.logRank=Math.max(this.features.logRank,Ma)}jGl(Aa){const Ma=
Ng(10,Aa),cb=Ng(2,Aa);Aa=Ng(1,Aa);this.features.fOb=Math.max(this.features.fOb,Ma);this.features.hOb=Math.max(this.features.hOb,cb);this.features.gOb=Math.max(this.features.gOb,Aa)}}Object(h.a)(Wh,"CommandModel",null,[]);class Gg{constructor(Aa){this.WQb=null;if(!Aa&&y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("PredictionEngine","IModelAdapter can't be null");this.apb=Aa;this.$Ac=this.Vne()}Vne(){const Aa=this.apb.Xcj(),Ma=this.apb.z8d();if(void 0===Aa||null===Aa||void 0===Ma||null===
Ma)return!1;try{window.performance.now();this.WQb={};for(let cb=0;cb<Aa.length;cb++){const Fb=Aa[cb],dc=Ma[Fb[0].toString()].trim(),zc=Fb[1],Vc=0!==zc?Ma[Fb[2].toString()].trim():"",rd=Fb[3];dc in this.WQb||(this.WQb[dc]=new sh(dc));this.WQb[dc].D4h(Vc,zc,rd)}}catch(cb){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("LoadModelData","Error Loading Suggestions Model: "+cb);return!1}return!0}E1i(){const Aa=this.apb.Baj(),Ma={};if(!Aa)return Ma;let cb=1;for(let Fb=0;Fb<Aa.length;Fb++){const dc=
Aa[Fb];dc.Id in Ma?(Ma[dc.Id].jCj(),Ma[dc.Id].$El(cb),Ma[dc.Id].jGl(dc.TimeElapsedSinceClick)):Ma[dc.Id]=new Wh(cb,dc.TimeElapsedSinceClick);cb++}return Ma}xke(){this.$Ac||(this.$Ac=this.Vne());return this.$Ac}Ffj(){let Aa=[];if(!this.$Ac){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("GetPredictedCommands","IModelAdapter returned no data");return Aa}const Ma=this.E1i(),cb=this.WQb;for(let dc in cb){const zc=cb[dc],Vc=zc.modelId;let rd=0;for(let Z in Ma){var Fb=Z;const Da=Ma[Z].features;
(Fb=Fb in zc.m0b?zc.m0b[Fb]:null)&&(rd+=Da.invertedRank*Fb.invertedRank+Da.logRank*Fb.logRank+Da.logCount*Fb.logCount+Da.fOb*Fb.fOb+Da.hOb*Fb.hOb+Da.gOb*Fb.gOb)}rd+=zc.featureIntercept;Aa.push(new $e.a(Vc,rd))}Aa.sort((dc,zc)=>dc.score<zc.score?1:dc.score>zc.score?-1:0);0<Aa.length-10&&(Aa=Aa.slice(0,10));return Aa}}Object(h.a)(Gg,"PredictionEngine",null,[]);class eg{constructor(){this.Qnf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}NRc(Aa,Ma){return Ma&&"word"===Ma.application.toLowerCase()&&
Aa in this.Qnf?this.Qnf[Aa]:[]}}Object(h.a)(eg,"SuggestionResultsUtility",null,[]);class Tj{constructor(Aa,Ma,cb){this.qb=Ma;this.UUb=new Gg(Aa);this.oS=cb;this.lpf=new eg}aE(){return"Suggestion"}nL(){return 0===this.qb.Aq?0:1===this.qb.Aq?1:2}fB(Aa,Ma,cb,Fb=e.a.tellMe,dc=null){cb=new v.a(Aa);y.TellMeActor.instance.Fuc=!1;if((!dc||Array.contains(dc,16))&&A.a.MF(Aa)){if(!this.UUb.xke()){if(y.TellMeActor.instance.Hd)y.TellMeActor.instance.Hd.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.Cle()&&0<this.lpf.NRc(y.TellMeActor.instance.lMc,this.qb).length){const Vc=this.lpf.NRc(y.TellMeActor.instance.lMc,this.qb);dc=[];for(var zc of Vc)this.qb.dqd&&"Find"===zc||dc.push(new $e.a(zc,0));y.TellMeActor.instance.Fuc=!0}else dc=this.UUb.Ffj();Qd.CommandResultsUtility.Z1c(dc,!0,"Recommended","LRE");zc=[];for(const Vc of dc)this.oS&&this.oS.AWd(Vc.commandId)||zc.push(Vc);Aa=Qd.CommandResultsUtility.TTc(Aa,
zc,this.qb,null,null,null,16,1);0<Aa.results.length&&Fb!==e.a.contextMenu&&(Aa.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Aa.results.length&&cb.Uq(Aa)}Ma.resultsUpdated(cb)}Cle(){return!!this.qb&&(this.qb.Cle||this.qb.JXj)}}Object(h.a)(Tj,"SuggestionResultsProvider",null,[654]);class aj{Baj(){return y.TellMeActor.instance.Oyd}Xcj(){return window.TellMeSuggestionModel}z8d(){return window.CoefficientModelIdMap}}Object(h.a)(aj,"SuggestionsModelAdapter",null,[735]);var pj=d(1045),Ji=d(984);
d.d(Y,"AggregatorResultsProvider",function(){return yg});class yg{constructor(Aa=!1){this.ypb={};this.ypb[e.a.tellMe]=[];this.ypb[e.a.contextMenu]=[];this.dAc=Aa}Tng(Aa,Ma,cb,Fb,dc=null){let zc;var Vc=!1;switch(Fb){case e.a.contextMenu:zc=this.ypb[e.a.contextMenu];Vc=!0;break;default:zc=this.ypb[e.a.tellMe]}Ma=new Vi(Ma,zc,Vc,this.dAc,Fb);Ma.VDk();for(let rd=0;rd<zc.length;++rd){const Z=window.performance.now(),Da=new G(Ma,rd);(Vc=y.TellMeActor.instance.WG())&&Vc.Xii?window.setTimeout(()=>{zc[rd].fB(Aa,
Da,cb,Fb,dc);if(y.TellMeActor.instance.Hd){const Wa={};Wa[n.a.provider]=zc[rd].aE();Wa[n.a.Uhb]=Aa.PZa;y.TellMeActor.instance.Hd.CH(m.a.fB,window.performance.now()-Z,Wa)}},0):(zc[rd].fB(Aa,Da,cb,Fb,dc),y.TellMeActor.instance.Hd&&(Vc={},Vc[n.a.provider]=zc[rd].aE(),Vc[n.a.Uhb]=Aa.PZa,y.TellMeActor.instance.Hd.CH(m.a.fB,window.performance.now()-Z,Vc)))}Ma.mBl()}aE(){return"Aggregator"}nL(){return 0}fB(Aa,Ma,cb=!1,Fb=e.a.tellMe,dc=null){if(y.TellMeActor.instance.umk)this.Tng(Aa,Ma,cb,Fb,dc);else{const zc=
window.performance.now();y.TellMeActor.instance.xJl.then(()=>{y.TellMeActor.instance.Hd&&y.TellMeActor.instance.Hd.CH(m.a.vmk,window.performance.now()-zc);this.Tng(Aa,Ma,cb,Fb,dc);return!0})}}Qy(Aa,Ma){this.ypb[Ma].push(Aa)}n6h(Aa){switch(Aa){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ma=this.ypb[e.a.tellMe];for(const cb of Ma)if("FindInDocument"===cb.aE()){cb.sbl(Aa);break}}}static createInstance(Aa,Ma,cb,Fb){const dc=Ma.n3;var zc=Fb&&A.a.DXe(Ma),
Vc=zc&&Ma.dJe&&!dc;const rd=Ma.ome&&!A.a.nbb()&&!dc,Z=Ma.Fke&&!dc,Da=new yg(zc);if(Ma.Zil&&!dc){var Wa=new pg(Ma);Da.Qy(Wa,e.a.tellMe)}Wa=Ma.Oo?yh.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):yh.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const ib=!Wa&&yh.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");Da.Qy(new fe.a(Aa,Ma.Rzl,ib,!1),e.a.tellMe);Wa&&!dc&&Da.Qy(new Tj(new aj,Ma,Aa),e.a.tellMe);Aa=yh.AFrameworkApplication.Aa.hb.Zmg?new Ie(Ma,
new Ia):new Ti(Ma,cb);Da.Qy(Aa,e.a.contextMenu);(zc&&Ma.eJe||Vc)&&Da.Qy(pj.a.mLf(Ma,!0),e.a.tellMe);Da.Qy(Aa,e.a.tellMe);!Ma.MXi||dc||"Word"===Ma.application&&Ma.KVf||Da.Qy(new Zg(Ma),e.a.tellMe);Ma.r6a&&!dc&&(Vc=new S(Ma),Da.Qy(Vc,e.a.tellMe),Da.Qy(Vc,e.a.contextMenu));!Ma.Vrb||Ma.Vqc||Ma.Uqc||dc||Da.Qy(new P.a(Ma),e.a.tellMe);Fb&&(Ma.$Ea||A.a.d4())&&(Vc=new Ch(Ma),Da.Qy(Vc,e.a.tellMe),Da.Qy(Vc,e.a.contextMenu));zc&&Da.Qy(pj.a.mLf(Ma,!1),e.a.tellMe);Fb&&!Ma.V_e&&A.a.CXe(Ma)&&!dc&&(Da.Qy(new kh.a(Ma),
e.a.tellMe),Ma.Brl&&Da.Qy(new kh.a(Ma),e.a.contextMenu));rd&&Da.Qy(new gi(Ma),e.a.tellMe);!Ma.JMb&&!Ma.OH||dc||Da.Qy(new Ek.a(Ma),e.a.tellMe);Ma.hac&&!dc&&Da.Qy(new Ji.a(Ma),e.a.tellMe);Ma.lYc&&(zc=new u(Ma),Da.Qy(zc,e.a.tellMe),Da.Qy(zc,e.a.contextMenu));Fb&&Ma.nYc&&!dc&&Da.Qy(new J.AddinResultsProvider(Ma),e.a.tellMe);Z&&"Excel"===Ma.application&&!dc&&Da.Qy(new Lb(Ma),e.a.tellMe);return Da}}Object(h.a)(yg,"AggregatorResultsProvider",null,[654])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.chronos1.js.map