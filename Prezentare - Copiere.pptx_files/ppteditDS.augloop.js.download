'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1239:function(I,Y,d){d.r(Y);var h=d(0),e=d(387),n=d(27),m=d(55),z=d(70),B=d(18),v=d(14);class y{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(h.a)(y,"AugmentationServiceRequest",null,[]);var A=d(36),E=d(69);class u{constructor(za,sb,Nb){this.Fqb=this.dra=null;this.cNh=Nb;this.$a=sb;this.Xh=za}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");
const za=this.$a.Ga("AugmentationLoopWebServiceBase"),sb=this.$a.Ga("WebServiceBase");this.dra=(void 0===za?sb:za)+"proofing.ashx?"+n.AFrameworkApplication.gh+"&apitype=AL";this.Fqb=new E.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(za,sb){if(za&&""!==za)if(sb){if(!({value:Nb}=this.Fqb.Uf(za)).returnValue){var Nb=new B.a;this.Fqb.add(za,Nb)}Nb.contains(sb)||Nb.add(sb)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,
306,15,"topic is empty or null")}removeEventHandler(za,sb){za&&""!==za?sb?this.Fqb.Hb(za)?({value:za}=this.Fqb.Uf(za),za&&za.contains(sb)&&za.remove(sb)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",za):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}sUe(za,sb,Nb){this.Joc(za,sb,Nb,Object(v.a)(this,this.yKa,"requestSucceeded"),Object(v.a)(this,this.wKa,"requestFailed"))}Joc(za,sb,Nb,Ac,Jd,
ge=null){za=Object.assign(new y,{Topic:za,Payload:sb,AppId:this.cNh,SessionId:this.Xh.userSessionId,ContextId:Nb});this.Xh.mj(this.dra,2,A.c(za),{"Content-Type":"application/json; charset=utf-8"},!1,3,Ac,Jd,ge?ge:za,void 0,void 0,void 0,void 0,"18")}yKa(za){!n.AFrameworkApplication.Ug&&za&&za.data&&this.Sqk(za.data.Sd)}wKa(za){!n.AFrameworkApplication.Ug&&za&&za.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",za.data.Sd)}Sqk(za){if(za){try{var sb=A.a(za)}catch(Nb){e.ULS.sendTraceTag(36284437,306,10,
"Try parse aug response failed:{0}",Nb.message);return}if(({value:za}=this.Fqb.Uf(sb.Topic)).returnValue)for(let Nb of za)Nb(sb.ContextId,sb.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",sb.Topic)}}}Object(h.a)(u,"AugmentationManager",null,[790]);var J=d(1200);class G{}Object(h.a)(G,"HostMetadata",null,[]);class S{}Object(h.a)(S,"Lambda",null,[]);class P extends S{constructor(){super()}}Object(h.a)(P,"WrapperLambda",S,[]);var Q=d(398),D=d(142);class O{constructor(){this.handler=
this.schemaName=null}}Object(h.a)(O,"AddEventHandlerParameters",null,[]);var X=d(659);class N{constructor(){this.lambda=this.name=null}}Object(h.a)(N,"RegisterSimpleLocalWorkflowParameters",null,[]);class aa{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(aa,"RegisterSimpleRemoteWorkflowParameters",null,[]);var V=d(973);class ca{constructor(){this.requestAuthTokenCallback=null}}Object(h.a)(ca,"SetRequestAuthTokenCallbackParameters",null,[]);class fa{constructor(){this.sendOTelEvent=
null}}Object(h.a)(fa,"SetSendOTelEventCallbackParameters",null,[]);class ma{constructor(){this.ulsLogger=null}}Object(h.a)(ma,"SetULSLoggerParameters",null,[]);var da=d(915);class qa{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(h.a)(qa,"SubmitParameters",null,[]);var F=d(529);class sa{constructor(za,sb=null){this.hZ=null;new E.a;new G;this.C_h=za;this.wOa=sb}initialize(za){this.hZ?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(za||(za=new X.a),
this.hZ=new Promise(sb=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const Nb=n.AFrameworkApplication.Aj("al",2);this.C_h.XAb(Nb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const Ac=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();Ac.setRequestAuthTokenCallback(Object.assign(new ca,{requestAuthTokenCallback:Object(v.a)(this,this.W0k,"requestAuthToken")}));Ac.setULSLogger(Object.assign(new ma,{ulsLogger:new Q.a}));
Ac.setSendOTelEventCallback(Object.assign(new fa,{sendOTelEvent:Object(v.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let Jd=n.AFrameworkApplication.fa.Ga("OfficeApplicationName")||"";Jd=Jd.replace("Web","");za.appName=za.appName||Jd;za.serviceUrl=za.serviceUrl||n.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl");za.appVersion=za.appVersion||n.AFrameworkApplication.fa.Ga("BuildVersion")||"";za.releaseAudienceGroup=za.releaseAudienceGroup||(n.AFrameworkApplication.gd?Object(J.a)(String,n.AFrameworkApplication.gd.AudienceGroup)||
"":"");za.sessionId=za.sessionId||n.AFrameworkApplication.fa.Ga("SessionId")||"";za.uiLanguage=za.uiLanguage||n.AFrameworkApplication.uiCulture;za.flights=za.flights||this.k2i();za.initSession=za.initSession||!0;za.downloadBaseUrl=za.downloadBaseUrl||n.AFrameworkApplication.fa.Ga("AugLoopDownloadBaseUrl");Ac.initialize(za);sb({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.hZ}registerSimpleLocalWorkflow(za,sb){return this.hZ.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",za);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new N,{name:za,lambda:this.qtd(sb)}))})}registerSimpleRemoteWorkflow(za,sb,Nb,Ac){return this.hZ.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",za);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new aa,{name:za,lambdaBefore:this.qtd(sb),lambdaRemote:this.qtd(Nb),
lambdaAfter:this.qtd(Ac)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.hZ}submit(za,sb){this.hZ.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",za);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new qa,{inputSchema:za,input:sb}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(za){this.hZ.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",za);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new da.a,{operation:za}))})}setSessionDataCallback(za){this.hZ.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(za)})}setInitSessionCallback(za){this.hZ.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(za)})}setSessionInitOverrideCallback(za){this.hZ.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(za)})}setAnnotationResultCallback(za){this.hZ.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new V.a,{handler:za}))})}activateAnnotation(za){return this.hZ.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
za.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(za)})}releaseAnnotation(za){return this.hZ.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",za.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(za)})}addEventHandler(za,sb){za&&""!==za?sb?this.hZ.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new O,
{schemaName:za,handler:Nb=>{Nb&&sb(Nb.inputSchema,Nb.input,Nb.outputSchema,Nb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}W0k(){const za=n.AFrameworkApplication.fa.Ga("AugLoopOAuthResourceUriV2");if(this.wOa)return new Promise(sb=>{this.wOa.execute(Nb=>{Nb.nV("AugLoop",za).then(Ac=>{Ac.IsSuccess?sb(Ac.Token):(e.ULS.sendTraceTag(51499467,
306,15,Ac.ErrorMessage),sb(n.AFrameworkApplication.fa.Ga("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(za){D.a.sendOtelEvent(Object.assign(new F.a,{otelEvent:za}))}qtd(za){if(za){let sb=null;za.func&&(sb=(Nb,Ac,Jd,ge)=>{za.func(Nb,Ac,ge)});return Object.assign(new P,{name:za.name,inputSchema:za.inputSchema,outputSchema:za.outputSchema,func:sb})}return null}k2i(){var za=n.AFrameworkApplication.fa.Ga("FlightId");
const sb=n.AFrameworkApplication.fa.WA("AugLoopFlightKeywordList"),Nb=[];if(za&&""!==za&&sb&&0<sb.length){za=za.split(";");for(let Ac=0;Ac<za.length;Ac++)for(let Jd=0;Jd<sb.length;Jd++)-1<za[Ac].toLowerCase().indexOf(sb[Jd].toLowerCase())&&Array.add(Nb,za[Ac])}return 0<Nb.length?Nb.join(";"):""}}Object(h.a)(sa,"NewAugLoopRuntimeManager",null,[789]);var ia=d(57),Na=d(1231),Ca=d(47);class ha{}Object(h.a)(ha,"Lambda",null,[844]);var Ba=d(913);class va{constructor(){this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null}}Object(h.a)(va,"PowerPointParameters",null,[]);class ta{constructor(){this.initSessionCallback=null}}Object(h.a)(ta,"SetInitSessionCallbackParameters",null,[]);class Fa{constructor(){this.sessionDataCallback=this.handler=null}}Object(h.a)(Fa,"SetSessionDataCallbackParameters",null,[]);class pa{constructor(){this.handler=null}}Object(h.a)(pa,"SetSessionInitOverrideCallbackParameters",null,[]);var ka=d(348),Ha=d(518),Ya=d(143);class Ka extends Ha.a{constructor(){super();this.H_=
Object.assign(new Ya.a,{T_:Ka.getTypeName(),B_:Ka.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(h.a)(Ka,"DeleteOperation",Ha.a,[]);var Pa=d(691),Oa=d(320);class oa extends Oa.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new Ya.a,{T_:oa.getTypeName(),B_:oa.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}
Object(h.a)(oa,"Message",Oa.a,[]);class Xa extends oa{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new Ya.a,{T_:Xa.getTypeName(),B_:Xa.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}
Object(h.a)(Xa,"SessionInitMessage",oa,[]);class Hb extends Xa{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new Ya.a,{T_:Hb.getTypeName(),B_:Hb.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(Hb,"PowerPointSessionInitMessage",Xa,[]);var Ob=d(35);class eb{constructor(){this.authToken=
this.origin=this.hph=null}}Object(h.a)(eb,"SessionData",null,[]);var Eb=d(535);class oc{constructor(za,sb,Nb){this.qpe=new E.a;this.P2c=new E.a;this.Roe=new E.a;this.bFb=this.cad=this.cCb=this.$Q=null;this.hz=za;this.Ha=sb;this.vi=Nb;const Ac=new X.a;Ac.powerpoint=new va;if(Ob.a("AL.SendSlideTile"))if(Ob.a("AL.EnableRehydration"))this.hz.initialize(new X.a),this.hz.setInitSessionCallback(Object.assign(new ta,{initSessionCallback:Object(v.a)(this,this.xxk,"onSessionInit")})),this.hz.setSessionInitOverrideCallback(Object.assign(new pa,
{handler:Object(v.a)(this,this.yxk,"onSessionInitOverride")})),this.bFb=this.dXc(),this.hz.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.M9=Promise.resolve(null);else{za=ia.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;sb=ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;za=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",sb,za);sb=ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").O9a?
ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$Sc:ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Jd=String.format("{0}getitems.ashx",sb);sb=new Na.a(n.AFrameworkApplication.Ke);this.M9=Eb.b(sb.DUe(za));this.M9.then(ge=>{try{const re=JSON.parse(ge),Xe=re.downloadUrl;Ca.a.Wa(Xe)?e.ULS.sendTraceTag(51422528,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",re):(Ac.powerpoint.downloadUrl=Xe,Ac.powerpoint.getItemsEndPoint=
Jd,this.Ha.m3b&&(Ac.powerpoint.documentOpenType=this.s4f()))}catch(re){e.ULS.sendTraceTag(51422529,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",re)}this.hz.initialize(Ac);this.bFb=this.dXc();this.hz.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(ge=>{e.ULS.sendTraceTag(51422530,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ge);this.hz.initialize(Ac);this.bFb=this.dXc();
this.hz.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.M9=new Promise(ge=>{this.hz.initialize(Ac);this.bFb=this.dXc();this.hz.setAnnotationResultCallback(Object(v.a)(this,this.onAnnotationResult,"onAnnotationResult"));ge("")})}pia(za){this.M9.then(sb=>{this.hz.activateAnnotation(Object.assign(new Ba.a,{annotationType:za}));return sb})}kKa(za,sb){if(za)if(sb){if(!({value:Nb}=this.qpe.Uf(za)).returnValue){var Nb=new B.a;this.qpe.add(za,Nb)}Nb.contains(sb)||
Nb.add(sb)}else e.ULS.sendTraceTag(51388803,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(51388802,306,15,"Annotation Type is null or empty")}rgh(za,sb){if(za)if(sb){if(!({value:Nb}=this.P2c.Uf(za)).returnValue){var Nb=new B.a;this.P2c.add(za,Nb)}Nb.contains(sb)||Nb.add(sb)}else e.ULS.sendTraceTag(575931363,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(575931362,306,15,"Annotation Type is null or empty")}addEventHandler(za,sb){this.M9.then(()=>{this.hz.addEventHandler(za,
sb);return null})}removeEventHandler(za,sb){this.M9.then(()=>{this.hz.removeEventHandler(za,sb);return null})}registerSimpleLocalWorkflow(za,sb){return this.M9.then(()=>this.hz.registerSimpleLocalWorkflow(za,this.rtd(sb)))}registerSimpleRemoteWorkflow(za,sb,Nb,Ac){return this.M9.then(()=>this.hz.registerSimpleRemoteWorkflow(za,this.rtd(sb),this.rtd(Nb),this.rtd(Ac)))}submit(za,sb){this.M9.then(()=>{this.hz.submit(za,sb);return null})}submitOperation(za){this.M9.then(()=>{this.hz.submitOperation(za);
return null})}HGl(za,sb,Nb,Ac,Jd){this.bFb&&this.bFb.then(()=>{this.vi.augmentImage(za,sb,Nb,!0,this.cad.hph,this.cad.origin,this.cad.authToken,Ac,Jd);return null})}yxk(za){e.ULS.sendTraceTag(594609494,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const sb=Object.assign(new Hb,{protocolVersion:za.protocolVersion,clientMetadata:za.clientMetadata,sessionKey:za.sessionKey,origin:za.origin,authToken:za.authToken,messageId:za.messageId,cv:za.cv});try{this.Ha.m3b&&(sb.documentOpenType=this.s4f())}catch(Nb){e.ULS.sendTraceTag(578155528,
306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",Nb)}this.cal(za);if(Ca.a.Wa(this.$Q)||Ca.a.Wa(this.cCb))return e.ULS.sendTraceTag(594609493,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),za;sb.downloadUrl=this.$Q;sb.getItemsEndPoint=this.cCb;this.cCb=this.$Q=null;return sb}xxk(){e.ULS.sendTraceTag(594609492,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var za=ia.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;
const sb=ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Nb=ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").O9a?ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$Sc:ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;za=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",sb,za);const Ac=String.format("{0}getitems.ashx",Nb);Nb=new Na.a(n.AFrameworkApplication.Ke);return Eb.b(Nb.DUe(za)).then(Jd=>
{try{const ge=JSON.parse(Jd),re=ge.downloadUrl;Ca.a.Wa(re)?e.ULS.sendTraceTag(594609491,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",ge):(this.$Q=re,this.cCb=Ac)}catch(ge){e.ULS.sendTraceTag(594609490,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ge)}return null}).catch(Jd=>{e.ULS.sendTraceTag(594609489,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Jd)})}dXc(){return new Promise(za=>{this.hz.setSessionDataCallback(Object.assign(new Fa,
{sessionDataCallback:(sb,Nb,Ac)=>{this.cad=Object.assign(new eb,{hph:sb,origin:Nb,authToken:Ac});za(null)}}))})}onAnnotationResult(za){if(za&&za.items)if(Oa.a.rTa(za)!==ka.a.getTypeName()&&Oa.a.rTa(za)!==Pa.a.getTypeName())this.Ha.fRf&&Oa.a.rTa(za)===Ka.getTypeName()&&this.msk(za);else for(const Nb of za.items){if(!Nb||!Nb.body)continue;const Ac=Oa.a.rTa(Nb.body);if(!Ac)continue;var sb=Nb.body||{};za.parentPath&&(sb.parentPath=za.parentPath);let Jd=null;if(!({value:Jd}=this.qpe.Uf(Ac)).returnValue)e.ULS.sendTraceTag(51388804,
306,50,"Cannot find handlers for annotation:{0};",Ac);else if(Jd)for(let ge of Jd)ge(sb);if(this.Ha.fRf){sb=null;if(({value:sb}=this.P2c.Uf(Ac)).returnValue)for(let ge of sb)ge(Nb,!1);Ca.a.Wa(Nb.id)||this.Roe.$(Nb.id,Ac)}}}msk(za){for(const sb of za.items){if(!sb||!sb.id)continue;if(!({value:za}=this.Roe.Uf(sb.id)).returnValue)continue;let Nb=null;if(({value:Nb}=this.P2c.Uf(za)).returnValue)for(let Ac of Nb)Ac(sb,!0);this.Roe.remove(sb.id)}}rtd(za){return za?Object.assign(new ha,{name:za.name,inputSchema:za.inputSchema,
outputSchema:za.outputSchema,func:za.func}):null}s4f(){try{return this.Ha.HQ?0:this.Ha.pVa?2:1}catch(za){return e.ULS.sendTraceTag(578697036,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",za),2}}cal(za){try{Ca.a.Wa(za.clientMetadata.flights)?za.clientMetadata.flights=";":za.clientMetadata.flights+=";",this.Ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?za.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":
za.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(sb){e.ULS.sendTraceTag(559445142,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",sb)}}}Object(h.a)(oc,"PPTAugLoopRuntimeManager",null,[787]);class Sb{constructor(za){this.OT=za;this.OT.initialize()}addEventHandler(za,sb){this.OT.addEventHandler(za,sb)}removeEventHandler(za,sb){this.OT.removeEventHandler(za,sb)}sUe(za,sb,Nb){this.OT.sUe(za,sb,Nb)}Joc(za,sb,Nb,Ac,Jd,ge=
null){this.OT.Joc(za,sb,Nb,Ac,Jd,ge)}}Object(h.a)(Sb,"PPTAugmentationManager",null,[786]);var qc=d(352),$a=d(106);class ab{constructor(za){ab.assign(ab,this,za)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static rTa(za){return za&&za.H_?za.H_.T_:void 0}static rRc(za){return za&&za.H_&&za.H_.B_?za.H_.B_:[]}static qZf(za){const sb=ab.rTa(za);return sb?[sb,...ab.rRc(za)]:[]}static r5(za,sb){if(!Array.isArray(sb)||0===sb.length)return!0;const Nb=ab.rTa(za);za=
ab.rRc(za);for(const Ac of sb)if(Ac===Nb||0<=za.indexOf(Ac))return!0;return!1}static assign(za,sb,Nb){if(Nb)for(const Ac of Object.keys(Nb))sb[Ac]=Nb[Ac];sb.H_=za.H_;return sb}}ab.H_={T_:ab.getTypeName(),B_:ab.getBaseTypes()};class Ib{constructor(za){ab.assign(Ib,this,za)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(za){return ab.r5(za,[Ib.getTypeName()])}}Ib.H_={T_:Ib.getTypeName(),B_:Ib.getBaseTypes()};class gc{constructor(za){ab.assign(gc,
this,za)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(za){return ab.r5(za,[gc.getTypeName()])}}gc.H_={T_:gc.getTypeName(),B_:gc.getBaseTypes()};class Ta{constructor(za){ab.assign(Ta,this,za)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(za){return ab.r5(za,[Ta.getTypeName()])}}Ta.H_={T_:Ta.getTypeName(),B_:Ta.getBaseTypes()};class Ab{constructor(za){ab.assign(Ab,this,
za)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(za){return ab.r5(za,[Ab.getTypeName()])}}Ab.H_={T_:Ab.getTypeName(),B_:Ab.getBaseTypes()};class kc{constructor(za){ab.assign(kc,this,za)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(za){return ab.r5(za,[kc.getTypeName()])}}kc.H_={T_:kc.getTypeName(),B_:kc.getBaseTypes()};var fb=d(28);class Qb{constructor(za){this.wH=
za;za.body&&(za=za.body,this.ID=za.id,this.Status=za.status,this.Text=za.text,this.cwd=this.Aij())}Aij(){return this.wH.parentPath&&0<this.wH.parentPath.length?this.wH.parentPath[this.wH.parentPath.length-1]:""}}Object(h.a)(Qb,"ALChatHelperResponse",null,[849]);class mb{constructor(za,sb){this.Sbk=0;this.DRg=new Map;this.hz=sb;const Nb=["session","chats"],Ac=(new qc.a($a.a.create(),1)).toString(),Jd=[...Nb,Ac];this.xbk=[...Jd,"messages"];this.hz.execute(ge=>{ge.submitOperation(mb.vWd(Nb,Ac,za.chat));
ge.submitOperation(mb.vWd(Jd,"messages",new Ta));ge.pia(za.responseType);ge.rgh(za.responseType,this.s_.bind(this))})}s_(za){za=new Qb(za);if(za.cwd){const sb=this.DRg.get(za.cwd);if(sb){sb(za);this.DRg.delete(za.cwd);return}}this.$6j?this.$6j(za):fb.a.J(509366417,822,15,"No handler found")}send(za){const sb=`${this.Sbk++}`;this.hz.execute(Nb=>{Nb.submitOperation(mb.vWd(this.xbk,sb,za))})}static vWd(za,sb,Nb){return Object.assign(new ka.a,{parentPath:za,items:[{id:sb,body:Nb}]})}}Object(h.a)(mb,"ALChatHelper",
null,[827]);class Jb{constructor(za){this.U2c=za}create(za){return new mb(za,this.U2c)}}Object(h.a)(Jb,"ALChatHelperFactory",null,[792]);class Ub{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Zb(za){this.K=za;this.K.register(Sb,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().oa(()=>new Sb(new u(n.AFrameworkApplication.Ke,za.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));
this.K.register(oc,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().oa(()=>{const sb=m.a.sXj();e.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",sb);n.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=sb.toString();return new oc(new sa(za.resolve("Common.ISharedDependencyLoader"),za.Ja("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))});
Object(Ob.a)("EnableALChatHelper")&&this.K.register(Jb,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").ma().oa(()=>new Jb(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&(this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
Object(Ob.a)("EnableALChatHelper")&&this.K.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){z.a.instance.Dc(new Ub)}}Object(h.a)(Ub,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var tb=d(1199),Bc=d(914),Gb=d(912),Hc=d(549),$b=d(64),lc=d(33);class Vb{constructor(za){if(!za)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");this.K0=za}s7b(za){this.B2e(za)}B2e(za){if(za){try{const Jd=
za.parentPath;if(!Jd||4>Jd.length){fb.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const ge=Jd[3];var sb=Jd[2];if(!ge){fb.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var Nb=this.K0.Daj(ge);this.K0.TWk(ge);const re=za.predictions;if(!re||!re.length){fb.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const Xe=re[0];if(!Xe)return;var Ac=Xe.text;if(!Ac||!Ac.length){fb.a.J(590181641,820,50,"Text Predictions Null or Empty.");return}}catch(Jd){fb.a.J(590710030,
820,10,"Unable to parse output because of modified output type from Augloop");return}Ac&&Vb.tNi(Ac,Nb,sb)}else fb.a.J(590181649,820,50,"Annotations returned from service is null.")}static tNi(za,sb,Nb){za&&za.length&&(sb=Vb.Gfj(za,sb),-1!==sb&&(sb=za.substring(sb,za.length),Nb=Object.assign(new Gb.a,{text:za,Q8:sb,Hx:Nb}),Hc.a.QD.O5=Nb,Hc.a.TQd(za,sb)))}static Gfj(za,sb){var Nb=$b.a.instance.Na.mb.Ye.node;if(!Nb||!sb)return-1;Nb=lc.ParagraphReader.text(Nb);if(!Nb)return-1;if(Nb!==sb)if(Nb.length>
sb.length&&Nb.substring(0,sb.length)===sb){if(!za.startsWith(Nb.substring(sb.length,Nb.length-sb.length)))return-1;fb.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===Nb.substring(Nb.length-1,1)?0:Vb.e3f(Nb)}static e3f(za){return za?za.length-1-za.lastIndexOf(" "):-1}}Object(h.a)(Vb,"TextPredictionAugLoopResponseManager",null,[]);var ic=d(379);class qb extends Ha.a{constructor(){super();this.H_=Object.assign(new Ya.a,{T_:qb.getTypeName(),B_:qb.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(h.a)(qb,"SignalOperation",Ha.a,[]);var Wb=d(1046);class Xc{constructor(){this.MLe=!1}}Object(h.a)(Xc,"PredictionSettings",null,[]);class xb{constructor(za,sb){this.had=null;this.Gve={};this.hz=za;this.Rb=sb;this.Rb.AGc(Object(v.a)(this,this.eag,"handleResize"))}Daj(za){return this.Gve[za]}Ual(za,sb){this.Gve[za]=sb}TWk(za){za&&delete this.Gve[za]}get settings(){this.had||(this.had=Object.assign(new Xc,{MLe:!1}));return this.had}set settings(za){this.had=za}Zyl(za){if(this.settings.MLe&&za){var sb=
za.id.toString(),Nb=Hc.a.QD.O5,Ac=$b.a.instance.Na.mb;if(Ac&&1===Ac.length&&Ac.Ye){Ac=Ac.Ye;var Jd=Ac.node;if(lc.ParagraphReader.textLength(Jd)===Ac.Qa){if(Nb&&Jd&&sb===Nb.Hx&&sb===Jd.id.toString()&&(Ac=this.r7d(Nb,Jd))){Nb.Q8=Ac;Hc.a.TQd(Nb.text,Ac);return}Hc.a.QD.O5=null;Nb=$a.a.create().toString();Ac=lc.ParagraphReader.text(za);this.Ual(Nb,Ac);za=["Signal",Wb.a.getTypeName(),sb,Nb];Nb=xb.Adj(Ac);sb=[Object.assign(new ic.a,{id:sb,body:Nb})];var ge=Object.assign(new qb,{parentPath:za,items:sb});
this.hz.execute(re=>{re.submitOperation(ge);fb.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}gKb(){Hc.a.QD.O5=null;Hc.a.ZTa()}t7b(za){!za||1<za.length?this.gKb():1>za.length||((za=za[0])&&za.context?(za=za.context,za.Qa===za.Mb&&lc.ParagraphReader.textLength(za.node)===za.Qa||this.gKb()):this.gKb())}r7d(za,sb){var Nb=null;if(za&&sb){sb=lc.ParagraphReader.text(sb);za=za.text;if(!sb||!za)return Nb;sb=sb.replace(RegExp("\\u00a0","g")," ");za=za.replace(RegExp("\\u00a0","g"),
" ");if(sb){if(sb.endsWith(za))return this.gKb(),Nb;Nb=xb.zej(sb,za);Nb=za.substring(Nb,za.length)}}return Nb}eag(){Hc.a.ZTa()}dispose(){this.Rb.qld(Object(v.a)(this,this.eag,"handleResize"))}static Adj(za){return Object.assign(new Wb.a,{languageId:"en-US",startOfSentence:!0,text:za})}static zej(za,sb){for(let Nb=sb.length;0<Nb;Nb--){const Ac=sb.substring(0,Nb);if(za.endsWith(Ac.trimStart()))return Ac.length}return 0}}xb.UUa=!1;Object(h.a)(xb,"TextPredictionHandler",null,[951]);var Rb=d(52),wc=d(30);
class ud{constructor(za,sb){this.ia=za;this.oc=sb}wb(){this.ia.ya(wc.a.hIk,Rb.a.application,Object(v.a)(this,this.kIk,"predictionHandler"))}kIk(za,sb,Nb){return n.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===Nb?this.oc.pj()?32:2:8:8}}Object(h.a)(ud,"TextPredictorActor",null,[]);class uc{constructor(){this.vCe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Zb(za){this.K=za;za.register(ud,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().oa(()=>new ud(za.resolve("Common.IActionManagerExtended"),
za.resolve("PowerPointWebEditor.IPresentationReader")));za.register(951,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().oa(()=>new xb(za.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),za.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").wb();this.vCe=new tb.a(()=>new Vb(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(za=>
{za.pia(Bc.a.getTypeName());za.kKa(Bc.a.getTypeName(),Object(v.a)(this.vCe.value,this.vCe.value.s7b,"handleResponse"))})}dispose(){}static main(){z.a.instance.Dc(new uc)}}Object(h.a)(uc,"TextPredictionPackage",null,[2,3]);var db=d(270),Yb=d(29);class Zc{}Object(h.a)(Zc,"AugContextId",null,[]);class Kb{}Object(h.a)(Kb,"AugParagraph",null,[]);class Yc{}Object(h.a)(Yc,"AugShape",null,[]);class ec{}Object(h.a)(ec,"ShapeTextTile",null,[]);class rb{constructor(za,sb,Nb,Ac){this.Fa=Nb;this.Hh=Ac;this.Qb=
za;this.Ml=sb}D1b(za,sb){return za&&za.isConnected&&this.Fa.KFa(za)?(za=Object(J.a)(4,za))?Object.assign(new ec,{Topic:"ShapeText",ContextId:A.c(rb.Qyi(za,sb)),Data:A.c(this.Ryi(za))}):null:null}d1b(za){return za&&za.get_shapeId()&&za.hasText&&!za.$p?za.Wie:!1}Ryi(za){const sb=[];za=this.Qb.Nc(za);for(za=this.Ml.c3(za,za.currentNode);za.moveNext();){var Nb=za.currentNode;const Ac=Nb;this.Hh.$d(Ac)&&(Nb=Object.assign(new Kb,{t:this.Hh.text(Ac),l:this.Hh.hhb(Nb)}),Array.add(sb,Nb))}return Object.assign(new Yc,
{p:sb,c:db.a.xe(n.AFrameworkApplication.lcid).Svb})}static Qyi(za,sb){return Object.assign(new Zc,{gid:za.id,sid:za.slideSid,cid:za.slideCid,shapeId:za.get_shapeId(),rid:(za.m1c||za.RFa||Yb.App.Vm).toString(),t:sb,c:(new Date).getTime()})}}Object(h.a)(rb,"ShapeTextTileManager",null,[936,987]);var ac=d(105),Jc=d(1221),Db=d(201),dd=d(81),Cd;(function(za){za[za.none=0]="none";za[za.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";za[za.onSelectionFinished=2]="onSelectionFinished";za[za.onActiveSlideDomReady=
4]="onActiveSlideDomReady";za[za.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";za[za.onParagraphDisconnect=16]="onParagraphDisconnect";za[za.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";za[za.onNumberListDisconnect=64]="onNumberListDisconnect";za[za.onSlideConnected=128]="onSlideConnected";za[za.onSlideDisconnected=256]="onSlideDisconnected"})(Cd||(Cd={}));Object(h.b)("EventNames",Cd);class pd{constructor(){this.k1a=this.graphNode=null;this.sVa=0;this.M1e=null}}Object(h.a)(pd,
"TileGraphNode",null,[]);class Ge{constructor(){this.Hnh=this.NTe=this.Mae=this.A9f=0}}Object(h.a)(Ge,"TileTelemetry",null,[]);var kd;(function(za){za[za.unknown=0]="unknown";za[za.activeSlideChanged=1]="activeSlideChanged";za[za.shapeSelected=2]="shapeSelected";za[za.listLevelChanged=3]="listLevelChanged";za[za.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";za[za.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";za[za.paragraphDeleted=6]="paragraphDeleted";za[za.numberListDeleted=
7]="numberListDeleted";za[za.numberListPropertyChanged=8]="numberListPropertyChanged";za[za.slideAdded=9]="slideAdded";za[za.slideDeleted=10]="slideDeleted"})(kd||(kd={}));Object(h.b)("TriggerName",kd);var Xf=d(432);class Kd{constructor(za,sb,Nb,Ac){this.zb=sb;this.p8j=Nb;this.Phk=za;this.xCe={};this.Ncc={};this.Rb=Ac}initialize(){this.Vu()}dispose(){this.kpa()}onParagraphPropertyChanged(za,sb){this.Xsa(sb,1)}nHb(za,sb){this.Xsa(sb,2)}onActiveSlideDomReady(za,sb){this.Xsa(sb,4)}onShapeChildTopologyChanged(za,
sb){this.Xsa(sb,8)}eJa(za,sb){this.Xsa(sb,16)}Y6g(za,sb){za=new Xf.a(!1,null,sb.Ba);this.Xsa(za,4)}get Jy(){return this.Phk}get e_(){return this.xCe}get Aja(){return this.Ncc}Xsa(za,sb){try{if(2===this.Rb.mode&&Object(Jc.a)(Cd,sb)in this.xCe){var Nb=Date.now();Object(J.a)(983,this.xCe[Object(Jc.a)(Cd,sb)]).F3(za,(Ac,Jd)=>{this.psk(Ac,Jd,Nb)})}}catch(Ac){fb.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+Ac)}}psk(za,sb,Nb){if(!Db.a.Wa(za))try{for(const Ac of za){if(!ac.a.count(this.Ncc)){const re=
new dd.a(3,1,this.p8j,Object(v.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.zb.Db(re)}let Jd;if(Ac.id.toString()in this.Ncc)Jd=Object(J.a)(pd,this.Ncc[Ac.id.toString()]),Jd.sVa=sb;else{const re=new Ge;Jd=Object.assign(new pd,{graphNode:Ac,sVa:sb,k1a:{},M1e:re});this.Ncc[Ac.id.toString()]=Jd;this.pqk(re,Nb)}const ge=kd[sb];Jd.k1a[ge]=(ge in Jd.k1a?Jd.k1a[ge]:0)+1}}catch(Ac){fb.a.J(36495882,306,10,"Exception thrown at FireTiles: "+Ac)}}pqk(za,sb){za&&(za.A9f=sb,za.Mae=Date.now())}q1g(za,
sb){za&&(za.NTe=sb,za.Hnh=Date.now())}SYf(za){return za?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",za.Mae-za.A9f,za.NTe-za.Mae,za.Hnh-za.NTe):""}}Object(h.a)(Kd,"TileTriggerControllerBase",null,[1045,106]);class lg extends Kd{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg,hh,qj,de){super(re&31,Xe,Tg,qj);this.hU=za.yd(12);this.iM=za.yd(10);this.pa=sb;this.qd=Nb;this.OT=Ac;this.r$=Jd;this.pU=ge;this.ua=$f;this.vU=hh;this.pik=de}Vu(){1===(this.Jy&1)&&(this.hU.jk(Object(v.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.e_[Object(Jc.a)(Cd,1)]=this.vU.GGi());2===(this.Jy&2)&&(this.pa.wF(Object(v.a)(this,this.nHb,"onProcessSetSelectionFinished")),this.e_[Object(Jc.a)(Cd,2)]=this.vU.HGi());4===(this.Jy&4)&&(this.qd.aW(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.e_[Object(Jc.a)(Cd,4)]=this.vU.EGi());8===(this.Jy&8)&&(this.iM.vF(Object(v.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.e_[Object(Jc.a)(Cd,
8)]=this.vU.IGi());16===(this.Jy&16)&&(this.hU.TBa(Object(v.a)(this,this.eJa,"onBeforeParagraphDisconnect")),this.e_[Object(Jc.a)(Cd,16)]=this.vU.FGi())}kpa(){this.hU.Cm(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.pa.aya(Object(v.a)(this,this.nHb,"onProcessSetSelectionFinished"));this.qd.ioa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.iM.bP(Object(v.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.hU.rKa(Object(v.a)(this,
this.eJa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ua&&this.ua.Ba){var za=this.ua.Ba.Ek();for(const sb of za){const Nb=sb.id.toString();Nb in this.Aja&&(this.k4b(Object(J.a)(pd,this.Aja[Nb])),delete this.Aja[Nb])}ac.a.forEach(this.Aja,sb=>{delete this.Aja[sb]},null)}}catch(sb){fb.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+sb)}}k4b(za){if(za){var sb=Date.now(),Nb=this.pU.D1b(za.graphNode,kd[za.sVa]);if(Nb){this.pik?this.r$.execute(Jd=>{Jd.submit("ShapeTextTile",Nb)}):
this.OT.execute(Jd=>{Jd.sUe(Nb.Topic,Nb.Data,Nb.ContextId)});const Ac=za.M1e;this.q1g(Ac,sb);fb.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",kd[za.sVa],za.k1a,this.SYf(Ac))}}}}Object(h.a)(lg,"ShapeTextTileTriggerController",Kd,[]);var ve=d(24),Ua=d(76),Bb=d(40),mc=d(92),Nc=d(84),nd=d(161),Dd=d(39);class La{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(h.a)(La,"TextSpan",null,[]);class gb{}Object(h.a)(gb,"AugCharFormat",null,[]);class vc{}Object(h.a)(vc,
"AugCharFormatRun",null,[]);class td{}Object(h.a)(td,"AugDrawingElement",null,[]);class Nd{}Object(h.a)(Nd,"AugDrawingElementMoniker",null,[]);class Od{}Object(h.a)(Od,"AugPara",null,[]);class Oc{}Object(h.a)(Oc,"AugParaFormat",null,[]);class Af{}Object(h.a)(Af,"AugParaFormatRun",null,[]);class Ae{}Object(h.a)(Ae,"AugSlide",null,[]);class Ye{}Object(h.a)(Ye,"AugSlideMoniker",null,[]);class Wd{}Object(h.a)(Wd,"AugText",null,[]);class je{}Object(h.a)(je,"AugTextTile",null,[]);class dg{constructor(za,
sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg,hh,qj){this.Hh=za;this.Yl=sb;this.jAe=Nb;this.Qb=Ac;this.ZX=Jd;this.yc=ge;this.Ml=re;this.xXa=hh;this.h8c=Xe;this.ugc=$f;this.lA=Tg;this.z9c=qj}D1b(za){if(!za||!za.isConnected)return null;var sb=Object(J.a)(116,za);if(!sb)return null;let Nb=za=0;sb=({Tgd:za,mNc:Nb}=this.$Gi(sb)).returnValue;if(!sb)return null;sb=Object.assign(new je,{Id:$a.a.create().toString(),Content:A.c(sb)});fb.a.J(37091038,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",sb.Id,za,Nb);return sb}$Gi(za){let sb=
0,Nb=0;const Ac=[];var Jd=za?za.Ek():[];for(ge of Jd)if(!this.Yl.wFa(ge)||this.xXa)if(ge.ud){if(Jd=this.yc.JN(ge))Jd=this.Qb.Nc(Jd),this.ZX.wQc(Jd,re=>{(re=Object(J.a)(123,re.currentNode))&&!re.isGhostCell&&({Tgd:sb,mNc:Nb}=this.JYf(re,sb,Nb,Ac));return!0})}else({Tgd:sb,mNc:Nb}=this.JYf(ge,sb,Nb,Ac));var ge=sb;Jd=Nb;return{returnValue:Object.assign(new Ae,{id:za.id.toString(),mk:Object.assign(new Ye,{sId:za.sid,cId:za.cid}),drawingElems:Ac,isSlideCritiqueReady:za.isSlideCritiqueReady}),Tgd:ge,mNc:Jd}}JYf(za,
sb,Nb,Ac){const Jd=[];let ge=0;var re=this.Qb.Nc(za);for(re=this.Ml.c3(re,re.currentNode);re.moveNext();){var Xe=re.currentNode;Xe&&this.Hh.$d(Xe)&&Xe.Sa(Bb.a.pq)&&(Xe=this.g1i(Xe))&&(Xe.pfRuns&&0<Xe.pfRuns.length&&Xe.pfRuns[0].pf.proofingDirty&&ge++,Array.add(Jd,Xe))}0<Jd.length&&(sb+=Jd.length,Nb+=ge,za=Object.assign(new td,{id:za.id.toString(),mk:this.e1i(za),text:Object.assign(new Wd,{paragraphs:Jd})}),Array.add(Ac,za));return{Tgd:sb,mNc:Nb}}e1i(za){if(!za)return null;var sb="";let Nb=0,Ac=0;
if(Object(ve.a)(123,za))sb=Object(J.a)(123,za),Ac=3,sb=sb.cellId.toString();else if(Object(ve.a)(4,za))if(za=Object(J.a)(4,za),sb=za.get_shapeId().toString(),Nb=za.get_cid(),za.h4)Ac=1;else if(za.Rf)Ac=2;else if(za.px||za.fl)Ac=4;return Object.assign(new Nd,{id:sb,cId:Nb,type:Ac})}g1i(za){if(!za)return null;za=Object(J.a)(Ua.AParagraphNode,za);if(!za)return null;var sb=za.sa(Dd.a.zT,!1);sb=Object.assign(new Od,{id:za.id.toString(),chars:sb?"":this.Hh.text(za)});const Nb=this.f1i(za);Nb&&0<Nb.length&&
(sb.pfRuns=Nb);(za=this.d1i(za))&&0<za.length&&(sb.cfRuns=za);return sb}f1i(za){const sb=[],Nb=Object(J.a)(Nc.a,this.ugc.gTc(za));let Ac=16,Jd="",ge=0,re=0;if(Nb&&this.z9c){const Xe=this.lA.Q9a(Nb);if(Xe)if(Ac=Xe.listType,1===Ac)Jd=this.h8c.UAb(Nb);else if(0===Ac){ge=Nb.sa(Dd.a.autonumberBulletType,8);const $f=Object(J.a)(988,this.h8c);$f&&(re=$f.Ibj(Xe,Nb))}}za=Object.assign(new Af,{pf:Object.assign(new Oc,{lvl:this.Hh.hhb(za),proofingDirty:!za.sa(nd.a.Tda,!1),revisionId:za.sa(nd.a.s1c,0).toString(),
listType:Ac,listTag:Jd,listNumeration:ge,listElementIndex:re})});Array.add(sb,za);return sb}d1i(za){const sb=[];let Nb=this.lbj(za);if(0<Nb.count){Nb=this.Wii(this.jAe.lSc(za),Nb);for(let Ac of Nb)za=Ac.end-Ac.start,Array.add(sb,Object.assign(new vc,{len:za,cf:Object.assign(new gb,{lang:Ac.lcid,noProof:Ac.noProof})}))}return sb}lbj(za){const sb=new B.a,Nb=za.characterData;let Ac=-1,Jd=-1,ge=0;for(let re=0;re<za.Ra.length;re++){const Xe=za.Ra.ga(re).formatting;Xe&&(Jd=mc.a.language(Xe),-1!==Ac&&Ac!==
Jd&&(sb.add(Object.assign(new La,{start:ge,end:za.Ra.ga(re).cp,lcid:Ac,noProof:!1})),ge=za.Ra.ga(re).cp),Ac=Jd)}sb.add(Object.assign(new La,{start:ge,end:Nb.length,lcid:Jd,noProof:!1}));return sb}Wii(za,sb){if(!za)return sb;for(const Nb of za){za=!1;for(let Ac=0;Ac<sb.count;Ac++){if(!za)if(sb.ga(Ac).start===Nb.begin)za=!0,sb.ga(Ac).noProof=!0;else if(Nb.begin>sb.ga(Ac).start&&Nb.begin<sb.ga(Ac).end){sb.insert(Ac+1,Object.assign(new La,{start:Nb.begin,end:sb.ga(Ac).end,lcid:sb.ga(Ac).lcid,noProof:!0}));
za=!0;sb.ga(Ac).end=Nb.begin;continue}if(za)if(Nb.end>sb.ga(Ac).end)sb.ga(Ac).noProof=!0;else{if(Nb.end===sb.ga(Ac).end){sb.ga(Ac).noProof=!0;break}if(Nb.end<sb.ga(Ac).end){sb.insert(Ac+1,Object.assign(new La,{start:Nb.end,end:sb.ga(Ac).end,lcid:sb.ga(Ac).lcid,noProof:!1}));sb.ga(Ac).end=Nb.end;sb.ga(Ac).noProof=!0;break}}}}return sb}}Object(h.a)(dg,"SlideTextTileManager",null,[937,987]);var nf=d(440);class Cb extends Kd{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg,hh){super(sb&125,Nb,Ac,hh);this.qd=
za;this.vU=Jd;this.tgk=ge;this.hU=re.yd(12);this.iM=re.yd(10);this.r$=Xe;this.ua=$f;this.LVg=Tg;this.O8c=re.yd(22)}Vu(){4===(this.Jy&4)&&(this.qd.aW(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.LVg.kbi(Object(v.a)(this,this.Y6g,"onTilingModuleLoaded")),this.e_[Object(Jc.a)(Cd,4)]=this.vU.UGi());16===(this.Jy&16)&&(this.hU.TBa(Object(v.a)(this,this.eJa,"onBeforeParagraphDisconnect")),this.e_[Object(Jc.a)(Cd,16)]=this.vU.XGi());1===(this.Jy&1)&&(this.hU.jk(Object(v.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.e_[Object(Jc.a)(Cd,1)]=this.vU.YGi());8===(this.Jy&8)&&(this.iM.vF(Object(v.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.e_[Object(Jc.a)(Cd,8)]=this.vU.ZGi());64===(this.Jy&64)&&(this.O8c.TBa(Object(v.a)(this,this.N1g,"onBeforeNumberListDicsonnect")),this.e_[Object(Jc.a)(Cd,64)]=this.vU.VGi());32===(this.Jy&32)&&(this.O8c.jk(Object(v.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),
this.e_[Object(Jc.a)(Cd,32)]=this.vU.WGi())}kpa(){this.qd.ioa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.hU.Cm(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.hU.rKa(Object(v.a)(this,this.eJa,"onBeforeParagraphDisconnect"));this.LVg.a_k(Object(v.a)(this,this.Y6g,"onTilingModuleLoaded"));this.O8c.rKa(Object(v.a)(this,this.N1g,"onBeforeNumberListDicsonnect"));this.O8c.Cm(Object(v.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}N1g(za,
sb){this.Xsa(sb,64)}onNumberListPropertyChanged(za,sb){this.Xsa(sb,32)}fireTileEvents(){try{ac.a.forEach(this.Aja,za=>{this.k4b(Object(J.a)(pd,this.Aja[za]));delete this.Aja[za]},null)}catch(za){fb.a.J(36525513,306,10,"Exception thrown at FireTileEvents: "+za)}}k4b(za){if(za&&this.ua.Ba&&za.graphNode&&this.ua.Ba.id===za.graphNode.id){var sb=Date.now(),Nb=this.tgk.D1b(za.graphNode,kd[za.sVa]);if(Nb){this.r$.execute(Jd=>{Jd.submit(nf.a.Grc,Nb)});const Ac=za.M1e;this.q1g(Ac,sb);fb.a.J(36525515,306,50,
"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",kd[za.sVa],za.k1a,A.c(Nb).length,Nb.Id,this.SYf(Ac))}}}}Object(h.a)(Cb,"SlideTextTileTriggerController",Kd,[]);class Cf{constructor(za){ab.assign(Cf,this,za)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(za){return ab.r5(za,[Cf.getTypeName()])}}Cf.H_={T_:Cf.getTypeName(),B_:Cf.getBaseTypes()};class of{constructor(za){ab.assign(of,this,za)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(za){return ab.r5(za,
[of.getTypeName()])}}of.H_={T_:of.getTypeName(),B_:of.getBaseTypes()};class Lg{constructor(za){ab.assign(Lg,this,za)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(za){return ab.r5(za,[Lg.getTypeName()])}}Lg.H_={T_:Lg.getTypeName(),B_:Lg.getBaseTypes()};class vd{constructor(za){ab.assign(vd,this,za)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile",
"AugLoop_Text_TextTile"]}static typeGuard(za){return ab.r5(za,[vd.getTypeName()])}}vd.H_={T_:vd.getTypeName(),B_:vd.getBaseTypes()};class Lh{constructor(za){ab.assign(Lh,this,za)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(za){return ab.r5(za,[Lh.getTypeName()])}}Lh.H_={T_:Lh.getTypeName(),B_:Lh.getBaseTypes()};class tf{constructor(za){ab.assign(tf,this,za)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(za){return ab.r5(za,
[tf.getTypeName()])}}tf.H_={T_:tf.getTypeName(),B_:tf.getBaseTypes()};class Ue{constructor(za){ab.assign(Ue,this,za)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static getBaseTypes(){return[]}static typeGuard(za){return ab.r5(za,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};class ff{constructor(za){ab.assign(ff,this,za)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static getBaseTypes(){return[]}static typeGuard(za){return ab.r5(za,[ff.getTypeName()])}}
ff.H_={T_:ff.getTypeName(),B_:ff.getBaseTypes()};var Ef;(function(za){za[za.Title=0]="Title";za[za.Subtitle=1]="Subtitle";za[za.Content=2]="Content";za[za.Note=3]="Note";za[za.SmartArt=4]="SmartArt";za[za.Image=5]="Image";za[za.TextBox=6]="TextBox";za[za.Table=7]="Table";za[za.Chart=8]="Chart";za[za.Other=9]="Other"})(Ef||(Ef={}));class wh{constructor(za,sb,Nb,Ac,Jd,ge){this.Qb=za;this.Ml=sb;this.Hh=Ac;this.Ha=Nb;this.Fhk=Jd;this.oc=ge}D1b(za){if(!za||!za.isConnected)return null;za=Object(J.a)(116,
za);if(!za)return null;var sb=null;const Nb=new B.a;var Ac=za.Ek();for(var Jd of Ac)(Ac=this.TYf(Jd,!1))&&Nb.add(Ac);(Jd=za.$Sa())&&Jd.isConnected&&(Jd=this.TYf(Jd,!0))&&Nb.add(Jd);if(0<Nb.count){let ge,re;if(this.Ha.m3b){sb=za.en;Jd=this.nTa(za);try{ge=za.cid.toString(),re=za.sid.toString()}catch(Xe){fb.a.J(509203980,822,50,"Exception message: "+Xe.message)}sb=new ff({shapes:Nb.toArray(),isSlideHidden:sb,themeId:Jd,cid:ge,sid:re})}}return sb}TYf(za,sb){if(!za)return null;var Nb=this.Qb.Nc(za),Ac=
this.Ml.c3(Nb,Nb.currentNode);Nb=null;const Jd=new B.a;for(;Ac.moveNext();){var ge=Ac.currentNode;if(ge&&this.Hh.$d(ge)){ge=Object(J.a)(Ua.AParagraphNode,ge);const Xe=this.Hh.text(ge);let $f={};this.Ha.m3b&&($f=this.Fhk.JFk(ge));Xe&&(ge=new of({content:Xe,listType:$f.listType,indentation:$f.indentation,outlineLevel:$f.outlineLevel}),Jd.add(ge))}}let re;this.Ha.m3b&&(re=this.CWi(za,sb));Ac=null;this.Ha.kIj&&(Ac=sb?"notesNode":za.get_shapeId().toString());0<Jd.count&&(Nb=new Ue({textTiles:Jd.toArray(),
shapeType:re,shapeId:Ac}));return Nb}CWi(za,sb){if(sb)return Ef.Note;if(!za)return Ef.Other;switch(za.Hj){case 0:case 2:return Ef.Title;case 3:return Ef.Subtitle;case 10:return Ef.Table;case 15:return Ef.Image;case 9:case 12:return Ef.Chart;case 8:return this.ljj(za)}return Ef.Other}ljj(za){return za?0<za.o$d().length?Ef.SmartArt:za.Sda?Ef.Other:za.px?Ef.TextBox:Ef.Content:Ef.Other}nTa(za){if(!za)return"";za=za.hj;let sb=null;const Nb=this.oc.FI();if(Nb&&0<Nb.length&&za)for(const Ac of Nb)if(Ac.Id===
za){sb=Ac;break}return sb&&sb.ThemeFamilyId?sb.ThemeFamilyId:""}}Object(h.a)(wh,"SlideTileManager",null,[987]);class xh extends Kd{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe){super(sb&401,Nb,Ac,Xe);this.Cad=za.yd(8);this.hU=za.yd(12);this.vU=Jd;this.ugk=ge;this.r$=re}Vu(){16===(this.Jy&16)&&(this.hU.TBa(Object(v.a)(this,this.eJa,"onBeforeParagraphDisconnect")),this.e_[Object(Jc.a)(Cd,16)]=this.vU.SGi());1===(this.Jy&1)&&(this.hU.jk(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),
this.e_[Object(Jc.a)(Cd,1)]=this.vU.TGi());128===(this.Jy&128)&&(this.Cad.zia(Object(v.a)(this,this.onSlideConnected,"onSlideConnected")),this.e_[Object(Jc.a)(Cd,128)]=this.vU.QGi());256===(this.Jy&256)&&(this.Cad.N7(Object(v.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.e_[Object(Jc.a)(Cd,256)]=this.vU.RGi())}kpa(){this.hU.Cm(Object(v.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.hU.rKa(Object(v.a)(this,this.eJa,"onBeforeParagraphDisconnect"));this.Cad.joa(Object(v.a)(this,
this.onSlideConnected,"onSlideConnected"));this.Cad.sKa(Object(v.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(za,sb){this.Xsa(sb,128)}onSlideDisconnected(za,sb){this.Xsa(sb,256)}fireTileEvents(){try{ac.a.forEach(this.Aja,za=>{this.k4b(Object(J.a)(pd,this.Aja[za]));delete this.Aja[za]},null)}catch(za){fb.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+za)}}k4b(za){if(za&&za.graphNode){var sb=this.ugk.D1b(za.graphNode,kd[za.sVa]),Nb=null,Ac=Object(J.a)(116,za.graphNode);
if(Ac&&!Ac.SN&&!Ac.lAb){var Jd=Ob.a("AL.SlideTileIdOriginalFormat")?Ac.sid.toString()+Ac.cid.toString():Ac.sid.toString()+"#"+Ac.cid.toString();Ac=["session","doc"];sb=[Object.assign(new ic.a,{id:Jd,body:sb})];10===za.sVa?"slideAdded"in za.k1a||(Nb=Object.assign(new Ka,{parentPath:Ac,items:sb})):Nb="slideAdded"in za.k1a?Object.assign(new ka.a,{parentPath:Ac,items:sb}):Object.assign(new Pa.a,{parentPath:Ac,items:sb});Nb&&this.r$.execute(ge=>{ge.submitOperation(Nb)})}}}}Object(h.a)(xh,"SlideTileTriggerController",
Kd,[]);var qd=d(1208),Hf=d(32),Ag;(function(za){za[za.Unspecified=0]="Unspecified";za[za.Inline=1]="Inline";za[za.Floating=2]="Floating"})(Ag||(Ag={}));var He;(function(za){za[za.Undefined=0]="Undefined";za[za.Bullet=1]="Bullet";za[za.Numbered=2]="Numbered";za[za.Lim=3]="Lim";za[za.Nil=4]="Nil";za[za.Any=5]="Any";za[za.NoList=6]="NoList";za[za.Invalid=7]="Invalid"})(He||(He={}));var af;(function(za){za[za.DontCare=1]="DontCare";za[za.Thin=2]="Thin";za[za.ExtraLight=3]="ExtraLight";za[za.Light=4]=
"Light";za[za.Normal=5]="Normal";za[za.Medium=6]="Medium";za[za.SemiBold=7]="SemiBold";za[za.Bold=8]="Bold";za[za.ExtraBold=9]="ExtraBold";za[za.Heavy=10]="Heavy"})(af||(af={}));var yd;(function(za){za[za.NoCaps=0]="NoCaps";za[za.SmallCaps=1]="SmallCaps";za[za.AllCaps=2]="AllCaps";za[za.AllPetiteCaps=3]="AllPetiteCaps";za[za.PetiteCaps=4]="PetiteCaps";za[za.Unicase=5]="Unicase";za[za.Titling=6]="Titling";za[za.Other=7]="Other"})(yd||(yd={}));var me;(function(za){za[za.None=0]="None";za[za.Words=1]=
"Words";za[za.SingleLine=2]="SingleLine";za[za.DoubleLine=3]="DoubleLine";za[za.HeavyLine=4]="HeavyLine";za[za.DottedLine=5]="DottedLine";za[za.DottedHeavyLine=6]="DottedHeavyLine";za[za.DashLine=7]="DashLine";za[za.DashHeavyLine=8]="DashHeavyLine";za[za.DashLongLine=9]="DashLongLine";za[za.DashLongHeavyLine=10]="DashLongHeavyLine";za[za.DotDashLine=11]="DotDashLine";za[za.DotDashHeavyLine=12]="DotDashHeavyLine";za[za.DotDotDashLine=13]="DotDotDashLine";za[za.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";
za[za.WavyLine=15]="WavyLine";za[za.WavyHeavyLine=16]="WavyHeavyLine";za[za.WavyDoubleLine=17]="WavyDoubleLine"})(me||(me={}));var Ic;(function(za){za[za.Left=0]="Left";za[za.Right=1]="Right";za[za.Center=2]="Center";za[za.Justified=3]="Justified";za[za.Other=4]="Other";za[za.None=5]="None";za[za.JustifyLow=6]="JustifyLow";za[za.Distributed=7]="Distributed";za[za.ThaiDistributed=8]="ThaiDistributed"})(Ic||(Ic={}));var Fe;(function(za){za[za.Image=0]="Image";za[za.TextBox=1]="TextBox";za[za.Chart=
2]="Chart";za[za.SmartArt=3]="SmartArt";za[za.Drawing=4]="Drawing";za[za.EquationObject=5]="EquationObject";za[za.Ink=6]="Ink";za[za.InkSpace=7]="InkSpace";za[za.InkEndOfLine=8]="InkEndOfLine";za[za.LineBreak=9]="LineBreak";za[za.PageBreak=10]="PageBreak";za[za.PageNumbers=11]="PageNumbers";za[za.FootnoteEndnote=12]="FootnoteEndnote";za[za.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";za[za.Tab=14]="Tab";za[za.UnsupportedObject=15]="UnsupportedObject";za[za.Other=16]="Other"})(Fe||
(Fe={}));var Uc;(function(za){za[za.Initial=0]="Initial";za[za.FirstLine=1]="FirstLine";za[za.Hanging=2]="Hanging"})(Uc||(Uc={}));class Uf{constructor(za,sb){this.lA=za;this.m$=sb}JFk(za){const sb={};try{sb.listType=this.Wwb(za),sb.outlineLevel=lc.ParagraphReader.ATc(za),sb.indentation=Uf.wbj(this.m$.K8(za))}catch(Nb){fb.a.J(509203979,822,50,"Exception message: "+Nb.message)}return sb}Wwb(za){const sb=new Hf.GraphIterator;sb.set(za);sb.rc(11);sb.Jg(11);return(za=this.lA.jw(sb))?Uf.FAi(za.listType):
He.NoList}static FAi(za){switch(za){case 15:return He.Any;case 1:return He.Bullet;case 42:return He.Invalid;case 13:return He.Lim;case 14:return He.Nil;case 16:return He.NoList;case 0:return He.Numbered;default:return He.Invalid}}static wbj(za){return 2===za.unit?Math.floor(qd.a.cEf(za.value)/20):Math.floor(za.value/20)}}Object(h.a)(Uf,"TextTileFormatter",null,[938]);var vg=d(78);class Yg{constructor(){this.N1e="TML";this.va=new vg.a}kbi(za){this.va.addHandler(this.N1e,za)}a_k(za){this.va.removeHandler(this.N1e,
za)}MPk(za){this.va.raiseEvent(this.N1e,za)}}Object(h.a)(Yg,"TilingEventSource",null,[975,976,977]);class Cc{}Cc.Xfl="ShapeTextOnActiveSlideDomReady";Cc.$fl="ShapeTextOnSelectionFinished";Cc.Zfl="ShapeTextOnParagraphPropertyChanged";Cc.agl="ShapeTextOnShapeChildTopologyChanged";Cc.Yfl="ShapeTextOnParagraphDisconnect";Cc.Qnl="SlideTextOnActiveSlideDomReady";Cc.Unl="SlideTextOnParagraphPropertyChanged";Cc.Tnl="SlideTextOnParagraphDisconnect";Cc.Vnl="SlideTextOnShapeChildTopologyChanged";Cc.Snl="SlideTextOnNumberListPropertyChanged";
Cc.Rnl="SlideTextOnNumberListDisconnect";Cc.Nnl="SlideOnParagraphPropertyChanged";Cc.Mnl="SlideOnParagraphDisconnect";Cc.Knl="SlideOnConnect";Cc.Lnl="SlideOnDisconnect";Object(h.a)(Cc,"DetectStrategyName",null,[]);class Rc{constructor(za){this.pU=za}get Jy(){return 4}F3(za,sb){const Nb=[];if((za=Object(J.a)(Xf.a,za))&&za.Ba&&(za=Object(J.a)(116,za.Ba))){za=za.Ek();for(const Ac of za)this.pU.d1b(Ac)&&Array.add(Nb,Ac);0<Nb.length&&sb(Nb,1)}}}Object(h.a)(Rc,"ShapeTextOnActiveSlideDomReadyDetectStrategy",
null,[983]);var Ve=d(254);class ob{constructor(za,sb,Nb){this.Fa=za;this.pU=sb;this.pa=Nb}get Jy(){return 16}F3(za,sb){if((za=Object(J.a)(Ve.a,za))&&za.node&&12===za.node.type&&(za=this.Fa.$m(za.node))&&this.pU.d1b(za)){var Nb=this.pa.o_();Nb&&Nb.id===za.id&&(Nb=[],Array.add(Nb,za),sb(Nb,6))}}}Object(h.a)(ob,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[983]);var Mb=d(42),nc=d(358);class Qc{constructor(za,sb,Nb){this.Fa=za;this.pU=sb;this.pa=Nb}get Jy(){return 1}F3(za,sb){if((za=Object(J.a)(nc.a,
za))&&za.node&&12===za.node.type){const Ac=this.Fa.$m(za.node);if(Ac&&this.pU.d1b(Ac)){var Nb=this.pa.o_();Nb&&Nb.id===Ac.id&&(za.property===Mb.a.listLevel?this.Cub(3,Ac,sb):za.property===Bb.a.pq&&this.Cub(4,Ac,sb))}}}Cub(za,sb,Nb){if(sb){var Ac=[];Array.add(Ac,sb);Nb(Ac,za)}}}Object(h.a)(Qc,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[983]);var id=d(843);class ld{constructor(za,sb,Nb,Ac){this.pa=za;this.pU=sb;this.K0=Nb;this.Phc=Ac}get Jy(){return 2}F3(za,sb){const Nb=[];if(za=Object(J.a)(id.a,
za))if(this.Phc&&this.K0&&this.K0.t7b(za.kG),!this.pa.V3())this.Phc&&this.K0&&this.K0.gKb();else if(za.EE&&za.EE.length){this.Phc&&this.K0&&this.K0.gKb();za=this.pa.Wd();for(const Ac of za)this.pU.d1b(Ac)&&Array.add(Nb,Ac);0<Nb.length&&sb(Nb,2)}}}Object(h.a)(ld,"ShapeTextOnSelectionFinishedDetectStrategy",null,[983]);var xd=d(587);class ue{constructor(za,sb){this.pa=za;this.pU=sb}get Jy(){return 8}F3(za,sb){const Nb=[];if((za=Object(J.a)(xd.a,za))&&za.node&&10===za.node.type&&1===za.TZ&&(za=Object(J.a)(4,
za.node))&&this.pU.d1b(za)){var Ac=this.pa.o_();Ac&&Ac.get_shapeId()===za.get_shapeId()&&(Array.add(Nb,za),sb(Nb,5))}}}Object(h.a)(ue,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[983]);class Rd{constructor(za){this.Drg=za}get Jy(){return 1===this.Drg?128:256}F3(za,sb){if((za=Object(J.a)(Ve.a,za))&&za.node&&8===za.node.type){const Nb=[];Array.add(Nb,za.node);1===this.Drg?sb(Nb,9):sb(Nb,10)}}}Object(h.a)(Rd,"SlideOnConnectOrDisconnectDetectStrategy",null,[983]);class ce{constructor(za){this.jc=
za}get Jy(){return 16}F3(za,sb){if((za=Object(J.a)(Ve.a,za))&&za.node&&12===za.node.type){const Nb=this.jc.kg(za.node);Nb&&(za=[],Array.add(za,Nb),sb(za,6))}}}Object(h.a)(ce,"SlideOnParagraphDisconnectDetectStrategy",null,[983]);class Ne{constructor(za){this.jc=za}get Jy(){return 1}F3(za,sb){var Nb=Object(J.a)(nc.a,za);if(Nb&&Nb.node&&12===Nb.node.type){const Ac=this.jc.kg(Nb.node);Ac&&Object(J.a)(Ua.AParagraphNode,Nb.node)&&(za=0,Nb.property===Mb.a.listLevel?za=3:Nb.property===Bb.a.pq&&(za=4),Nb=
[],Array.add(Nb,Ac),sb(Nb,za))}}}Object(h.a)(Ne,"SlideOnParagraphPropertyChangedDetectStrategy",null,[983]);class oe{get Jy(){return 4}F3(za,sb){if((za=Object(J.a)(Xf.a,za))&&za.Ba&&(za=Object(J.a)(116,za.Ba))){var Nb=za.Ek();for(var Ac of Nb)if(Ac.hasText){Ac=[];Array.add(Ac,za);sb(Ac,1);break}}}}Object(h.a)(oe,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[983]);class Yd{constructor(za,sb){this.jc=za;this.ua=sb}get Jy(){return 64}F3(za,sb){if((za=Object(J.a)(Ve.a,za))&&this.ua.Ba&&za.node&&
22===za.node.type&&(za=this.jc.kg(za.node))&&za.id===this.ua.Ba.id){const Nb=[];Array.add(Nb,za);sb(Nb,7)}}}Object(h.a)(Yd,"SlideTextOnNumberListDisconnectDetectStrategy",null,[983]);class Id{constructor(za,sb){this.jc=za;this.ua=sb}get Jy(){return 32}F3(za,sb){var Nb=Object(J.a)(nc.a,za);Nb&&Nb.node&&22===Nb.node.type&&(za=this.jc.kg(Nb.node))&&this.ua.Ba&&za.id===this.ua.Ba.id&&Nb.property===Bb.a.Ri&&(Nb=[],Array.add(Nb,za),sb(Nb,8))}}Object(h.a)(Id,"SlideTextOnNumberListPropertyChangedDetectStrategy",
null,[983]);class zf{constructor(za,sb,Nb,Ac){this.ua=za;this.Yl=sb;this.jc=Nb;this.xXa=Ac}get Jy(){return 16}F3(za,sb){if((za=Object(J.a)(Ve.a,za))&&za.node&&this.ua.Ba&&12===za.node.type){const Nb=this.jc.kg(za.node);!Nb||Nb.id!==this.ua.Ba.id||this.Yl.Nka(za.node)&&!this.xXa||(za=[],Array.add(za,this.ua.Ba),sb(za,6))}}}Object(h.a)(zf,"SlideTextOnParagraphDisconnectDetectStrategy",null,[983]);class od{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe){this.ua=za;this.Yl=sb;this.jc=Nb;this.Fa=Ac;this.xXa=Jd;this.K0=
re;this.Phc=Xe}get Jy(){return 1}F3(za,sb){if((za=Object(J.a)(nc.a,za))&&za.node&&this.ua.Ba&&12===za.node.type){var Nb=this.jc.kg(za.node);if(Nb&&Nb.id===this.ua.Ba.id&&(Nb=Object(J.a)(Ua.AParagraphNode,za.node))&&(!this.Yl.Nka(Nb)||this.xXa)){var Ac=this.Fa.$m(Nb);Ac.zua||Ac.px||Ac.Rf||Ac.ud||!Ac.fl||!this.Phc||(this.K0.settings.MLe=!0,this.K0.Zyl(Nb));za.property===Mb.a.listLevel?this.Cub(3,this.ua.Ba,sb):za.property===Bb.a.pq?this.Cub(4,this.ua.Ba,sb):za.property===nd.a.Tda&&(Nb.sa(nd.a.Tda,!1)||
this.Cub(4,this.ua.Ba,sb))}}}Cub(za,sb,Nb){if(sb){var Ac=[];Array.add(Ac,sb);Nb(Ac,za)}}}Object(h.a)(od,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[983]);class gf{constructor(za,sb){this.ua=za;this.jc=sb}get Jy(){return 8}F3(za,sb){za=Object(J.a)(xd.a,za);this.ua.Ba&&za&&za.node&&10===za.node.type&&1===za.TZ&&(za=Object(J.a)(4,za.node))&&(za=this.jc.kg(za))&&za.id===this.ua.Ba.id&&(za=[],Array.add(za,this.ua.Ba),sb(za,5))}}Object(h.a)(gf,"SlideTextOnShapeChildTopologyChangedDetectStrategy",
null,[983]);class Lf{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f){this.jc=za;this.Fa=sb;this.ob=Nb;this.pU=Ac;this.ua=Jd;this.Yl=ge;this.Ha=re;this.hz=Xe;this.K0=$f}Y8i(za){if(Db.a.Wa(za))return 0;let sb=0;for(const Nb of za)sb|=this.s2k(Nb);return sb}$8i(za){if(Db.a.Wa(za))return 0;let sb=0;for(const Nb of za)sb|=this.u2k(Nb);return sb}Z8i(za){if(Db.a.Wa(za))return 0;let sb=0;for(const Nb of za)sb|=this.t2k(Nb);return sb}GGi(){return new Qc(this.Fa,this.pU,this.ob)}HGi(){return new ld(this.ob,this.pU,
this.K0,this.Ha.rmc)}EGi(){return new Rc(this.pU)}IGi(){return new ue(this.ob,this.pU)}FGi(){return new ob(this.Fa,this.pU,this.ob)}UGi(){return new oe}XGi(){return new zf(this.ua,this.Yl,this.jc,this.Ha.pptNotesInSlideTextTileIsEnabled)}YGi(){return new od(this.ua,this.Yl,this.jc,this.Fa,this.Ha.pptNotesInSlideTextTileIsEnabled,this.hz,this.K0,this.Ha.rmc)}ZGi(){return new gf(this.ua,this.jc)}WGi(){return new Id(this.jc,this.ua)}VGi(){return new Yd(this.jc,this.ua)}SGi(){return new ce(this.jc)}TGi(){return new Ne(this.jc)}RGi(){return new Rd(2)}QGi(){return new Rd(1)}s2k(za){return za===
Cc.Zfl?1:za===Cc.$fl?2:za===Cc.Xfl?4:za===Cc.agl?8:za===Cc.Yfl?16:0}u2k(za){return za===Cc.Qnl?4:za===Cc.Tnl?16:za===Cc.Unl?1:za===Cc.Vnl?8:za===Cc.Snl?32:za===Cc.Rnl?64:0}t2k(za){return za===Cc.Mnl?16:za===Cc.Nnl?1:za===Cc.Knl?128:za===Cc.Lnl?256:0}}Object(h.a)(Lf,"TilingFactory",null,[939]);class ke extends Sys.EventArgs{constructor(za){super();this.Ba=za}}Object(h.a)(ke,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class vf{constructor(){this.K=null;this.EBe=this.Lpe=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Zb(za){this.K=
za;za.register(Yg,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().oa(()=>new Yg);za.register(936,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().oa(()=>new rb(za.resolve("Box4.Graph.IGraphIteratorFactory"),za.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
za.resolve("PowerPointWebEditor.IShapeReader"),za.resolve("Box4.IParagraphReader")));za.register(937,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().oa(()=>new dg(za.resolve("Box4.IParagraphReader"),za.resolve("PowerPointWebEditor.Graph.INotesReader"),za.resolve("Box4.Proofing.IProofingTextUtility"),za.resolve("Box4.Graph.IGraphIteratorFactory"),za.resolve("Box4.ITableNavigator"),za.resolve("PowerPointWebEditor.Graph.ITableReader"),za.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
za.resolve("Box4.IListMarkerUtility"),za.resolve("PowerPointWebEditor.IPPTParagraphReader"),za.resolve("Box4.List.IListReader"),za.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));za.register(938,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().oa(()=>new Uf(za.resolve("Box4.List.IListReader"),za.resolve("Box4.IParagraphIndentationReader")));
za.register(wh,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().oa(()=>new wh(za.resolve("Box4.Graph.IGraphIteratorFactory"),za.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),za.resolve("PowerPointWebEditor.IApplicationSettings"),za.resolve("Box4.IParagraphReader"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),za.resolve("PowerPointWebEditor.IPresentationReader")));za.register(939,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().oa(()=>
new Lf(za.resolve("PowerPointWebEditor.ISlideReader"),za.resolve("PowerPointWebEditor.IShapeReader"),za.resolve("PowerPointWebEditor.IPptSelectionManager"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),za.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),za.resolve("PowerPointWebEditor.Graph.INotesReader"),za.resolve("PowerPointWebEditor.IApplicationSettings"),za.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),za.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));
za.register(lg,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().oa(()=>new lg(za.resolve("Box4.Graph.IGraphInstance"),za.resolve("PowerPointWebEditor.IPptSelectionManager"),za.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),za.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),za.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Y8i(za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
za.resolve("Common.ITaskManager"),za.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),za.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),za.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));za.register(Cb,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().oa(()=>
new Cb(za.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").$8i(za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),za.resolve("Common.ITaskManager"),za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),
za.resolve("Box4.Graph.IGraphInstance"),za.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),za.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),za.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));za.register(xh,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().oa(()=>new xh(za.resolve("Box4.Graph.IGraphInstance"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Z8i(za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),
za.resolve("Common.ITaskManager"),za.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,za.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),za.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),za.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),za.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),za.resolve("PowerPointWebEditor.IApplicationSettings")))}wUf(){return Ob.a("AL.SendSlideTile")}init(){const za=
this.K.resolve("Common.IAppSettingsManager");za.gf(()=>{this.Lpe=za.ka("497");this.EBe=za.ka("810")||za.ka("809");this.Lpe&&(za.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.EBe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.wUf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());
this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").MPk(new ke(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba))})}dispose(){this.Lpe&&(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.EBe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),
this.wUf()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize())}static main(){z.a.instance.Dc(new vf)}}Object(h.a)(vf,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var ng=d(1019),wg=d(648),bf=d(141),Pd=d(155),Md=d(524),Mh=d(111),Bh=d(48);class Vh{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=
this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=za;this.critiqueCountGrammar=sb;this.critiqueCountFormality=Nb;this.critiqueCountPunctuationConvention=Ac;this.critiqueCountVocabulary=Jd;this.critiqueCountConciseness=ge;this.critiqueCountClarity=re;this.critiqueCountInclusiveness=Xe}}Object(h.a)(Vh,"EditorPaneProps",null,[]);class Jg{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg,hh,qj,de,Yf,vk){this.Eb=!1;this.Ami=320;this.LXa=!1;this.Saa=
{};if(!za)throw Error.argumentNull("pptSelectionManager");if(!sb)throw Error.argumentNull("appFrame");if(!Nb)throw Error.argumentNull("actionManager");if(!Ac)throw Error.argumentNull("focusManager");if(!Jd)throw Error.argumentNull("editorPane");if(!re)throw Error.argumentNull("graphOperationEventHandler");if(!Xe)throw Error.argumentNull("viewElementEventHandlers");if(!$f)throw Error.argumentNull("viewEventSource");if(!Tg)throw Error.argumentNull("pageView");if(!qj)throw Error.argumentNull("workspace");
if(!de)throw Error.argumentNull("dynamicScriptLoader");if(!vk)throw Error.argumentNull("graphTopologyManager");de.loadScript("powerpoint-editor-intl").then(()=>{this.LXa=!0}).catch(Gj=>{fb.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+Gj.toString())});this.Rb=sb;this.ia=Nb;this.yqe=Yf;this.Ea=Ac;this.Pg=re;this.qd=Xe;this.Lc=$f;this.r$=hh;this.ua=vk;this.Pg.rI(this.gJa.bind(this));this.Pg.SBa(this.gJa.bind(this));this.Lc.HPa(this.gJa.bind(this));this.qd.VBa(this.gJa.bind(this));this.Rb.PK(this.Su.bind(this));
this.initialize()}initialize(){this.r$.execute(za=>{za.addEventHandler(Md.a.GVd,this.Xrj.bind(this))})}dispose(){this.Pg.U5(this.gJa.bind(this));this.Pg.j_a(this.gJa.bind(this));this.Lc.Eib(this.gJa.bind(this));this.qd.Gib(this.gJa.bind(this));this.Rb.yY(this.gJa.bind(this))}wb(){this.ia.ra(wc.a.vqd,Rb.a.application,this.vqd.bind(this),4);this.ia.ra(wc.a.ajd,Rb.a.application,this.ajd.bind(this),96)}Ee(){}gJa(){this.Eb&&this.Ql(!0)}Su(za){1===za.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Ea.Cj(Bh.a.r8,
this.Eb))}ajd(za,sb,Nb,Ac,Jd){(za=Object(J.a)(Mh.a,Jd))&&za.Mf(this.Eb);return 32}vqd(za,sb,Nb){return this.LXa?1===Nb?32:2===Nb?(this.Eb=!this.Eb,Pd.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Eb.toString(),za,()=>{this.Eb?this.Ql():this.Cr();return 32})):8:8}Ql(za=!1){const sb=this.vC(),Nb=Object.assign(new wg.a,{title:"Editor Pane",hideHeader:!1,width:this.Ami,location:2,contentProps:sb,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0});bf.UISurfaces.zr().then(Ac=>{za?Ac.updateTaskPane(Bh.a.r8,
Nb):Ac.showTaskPane(Bh.a.r8,Nb);return null}).catch(Ac=>{fb.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+Ac.toString())})}Cr(){bf.UISurfaces.zr().then(za=>{za.hideTaskPane(Bh.a.r8,2);return null}).catch(za=>{fb.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+za.toString())})}vC(){let za=0,sb=0,Nb=0,Ac=0,Jd=0,ge=0,re=0,Xe=0;const $f=this.ua.Ba?this.ua.Ba.cid:void 0;$f&&this.Saa[$f]&&Object.keys(this.Saa[$f]).forEach(Tg=>
{this.Saa[$f][Tg].forEach(hh=>{switch(hh.CategoryTitle){case "Spelling":za+=1;break;case "Grammar":sb+=1;break;case "Conciseness":ge+=1;break;case "Formality":Nb+=1;break;case "PunctuationConventions":Ac+=1;break;case "Clarity":re+=1;break;case "Inclusiveness":Xe+=1;break;case "Vocabulary":Jd+=1;break;default:fb.a.J(509727769,822,50,"Unknown Critique Type: "+hh.CategoryTitle)}})});return new Vh(za,sb,Nb,Ac,Jd,ge,re,Xe)}YCl(za,sb){const Nb={};Object.keys(za).forEach(Ac=>{this.Saa[sb]?(Object.keys(this.Saa[sb]).includes(Ac),
this.Saa[sb][Ac]=za[Ac]):(Nb[Ac]=za[Ac],this.Saa[sb]=Nb)})}Xrj(za,sb,Nb,Ac){sb&&Ac&&(za=JSON.parse(sb.Content),Ac=this.yqe.uIf(Ac.critiques),sb=this.ua.Ba.cid,null!=Ac&&0<Ac.length?this.YCl(this.z4i(Ac),sb):0==Ac.length&&this.Saa[sb]&&this.zPi(za.drawingElems,sb),this.Saa[sb]&&this.BXk(za.drawingElems,sb),this.Ql(!0))}BXk(za,sb){const Nb=Object.keys(this.Saa[sb]),Ac=this.Pmj(za);Nb.forEach(Jd=>{Ac.includes(Jd)||delete this.Saa[sb][Jd]})}Pmj(za){const sb=[];za.forEach(Nb=>{0<Nb.text.paragraphs.length&&
Nb.text.paragraphs.forEach(Ac=>{sb.push(Ac.id)})});return sb}zPi(za,sb){za.forEach(Nb=>{0<Nb.text.paragraphs.length&&this.Nri(Nb.text.paragraphs,sb)})}Nri(za,sb){za.forEach(Nb=>{this.Saa[sb][Nb.id]&&(Nb.pfRuns[0].pf.proofingDirty||""==Nb.chars)&&delete this.Saa[sb][Nb.id]})}z4i(za){const sb={};if(za)for(const Nb of za)Nb.TileId in sb?Array.add(sb[Nb.TileId],Nb):sb[Nb.TileId]=[Nb];return sb}}Object(h.a)(Jg,"DexLitePaneActor",null,[106,352]);class Of{constructor(){this.va=new vg.a}XOe(za){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",
za)}muf(za){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",za)}}Object(h.a)(Of,"EditorRuntimeEventSource",null,[978,979,980]);var bi=d(16),ij=d(51),ig=d(688),oj=d(34);class fh{constructor(za,sb){this.paragraph=za;this.critiqueId=sb}}Object(h.a)(fh,"CritiqueToHighlight",null,[]);class Qd{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg){this.Aea=za;this.P6j=sb;this.ua=Nb;this.NC=Ac;this.Jb=Jd;this.jJ=ge;this.pa=re;this.$qe=Xe;this.Ea=$f;this.z8j=Tg;this.Aea.fQe(this.P6j)}nWc(za){za.length?
(za=this.Fej(za),za.length&&(za=Object.assign(new ig.a,{action:0,type:2,Ada:za,Ohb:this.Aea.Fbb?this.Aea.Fbb.Ada:null}),this.Aea.xod(za))):this.lKi()}lKi(){var za=this.Aea.Fbb?this.Aea.Fbb.Ada:null;za=Object.assign(new ig.a,{action:1,type:2,Ada:za,Ohb:za});this.Aea.xod(za)}Fej(za){const sb=[];if(!this.$qe.isEnabled(2))return sb;var Nb=this.ua.Ba;if(Nb&&Nb.isSlideCritiqueReady){var Ac=Nb.qLa;if(!Ac.count)return this.voe(2),sb;Nb=0;for(let ge of Ac)if(Ac=Object(J.a)(Ua.AParagraphNode,ge)){var Jd=this.G7d(Ac);
for(const re of Jd)Jd=Object(J.a)(615,re.Gh),Jd.xN&&Array.contains(za,Jd.xN.TraceId)&&(Nb++,Jd=new fh(Ac,Jd.xN.TraceId),Array.add(sb,Jd))}Nb!==za.length&&this.Hoe(2,Nb,za.length)}else this.Doe(2,Nb);return sb}JAh(za){if(!this.$qe.isEnabled(3))return!1;var sb=this.ua.Ba;if(sb&&sb.isSlideCritiqueReady){sb=sb.qLa;if(!sb.count)return this.voe(3),!1;let Nb=0;const Ac=this.Jb.Ad(15,void 0,()=>{this.$ah()});try{let Jd=!1;Ac.nc(sb.ga(0));Ac.jd=oj.a.ksd;for(let ge of sb){const re=Object(J.a)(Ua.AParagraphNode,
ge);if(re){const Xe=new B.a,$f=this.G7d(re);for(const Tg of $f){const hh=Object(J.a)(615,Tg.Gh);if(hh.xN&&za.Hb(hh.xN.TraceId)){const qj=za.ga(hh.xN.TraceId);let de;try{de=hh.xN.Suggestions[qj].Text;const Yf=new bi.a(Tg,de);Xe.add(Yf);Jd||(hh.aMa(this.Ljk(qj)),Jd=!0);Nb++}catch(Yf){fb.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",Yf)}}}Xe.count&&(Xe.Sc((Tg,hh)=>hh.key.begin-Tg.key.begin),this.b0k(re,Xe))}}Nb!==za.count&&this.Hoe(3,Nb,za.count)}finally{Ac&&Ac.dispose()}}else return this.Doe(3,
sb),!1;return!0}Ljk(za){switch(za){case 0:return oj.a.kza;case 1:return oj.a.lza;case 2:return oj.a.mza;case 3:return oj.a.ILa;case 4:return oj.a.JLa;default:return 0}}b0k(za,sb){for(let Nb of sb)this.jJ.replaceTextRange(ij.a.createTextRange(za,0<Nb.key.begin?Nb.key.begin:0,Nb.key.end),Nb.value,!0,!1)}ignoreCritiques(za,sb){if(!this.$qe.isEnabled(sb))return!1;var Nb=this.ua.Ba;if(Nb&&Nb.isSlideCritiqueReady){var Ac=Nb.qLa;if(!Ac.count)return this.voe(sb),!1;this.$ah();Nb=!1;let Jd=0;for(let ge of Ac)if(Ac=
Object(J.a)(Ua.AParagraphNode,ge)){Ac=this.G7d(Ac);for(const re of Ac)Ac=Object(J.a)(615,re.Gh),Ac.xN&&Array.contains(za,Ac.xN.TraceId)&&(Ac.KEa=!0,Nb||(Ac.aMa(oj.a.cde),Nb=!0),Jd++)}Jd!==za.length&&this.Hoe(sb,Jd,za.length)}else return this.Doe(sb,Nb),!1;return!0}G7d(za){return this.NC.GF(za,sb=>{sb=Object(J.a)(615,sb.Gh);return!!sb&&5===sb.proofingType&&!sb.KEa})}voe(za){fb.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",za)}Hoe(za,sb,Nb){fb.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",
za,sb,Nb)}Doe(za,sb){fb.a.J(38843404,375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",za,!!sb)}$ah(){this.pa.ay();this.pa.ij();this.z8j&&this.Ea.tf(Bh.a.sg,!0)}}Object(h.a)(Qd,"ConsistencyCheckActor",null,[940]);var $e=d(314),yh=d(97),Ti=d(907),fe=d(685),gi=d(50),vi=d(686),bk=d(687);class Zg extends fe.a{constructor(za,sb){super();this.E4c=[Ti.a.uFe,Ti.a.E1c,Ti.a.zmd,Ti.a.fIc];this.ua=za;this.V$j=sb;this.Ave=[new vi.a("InconsistentCritiquesHighlight",null),
new vi.a("InconsistentCritiquesLeftSidebar",null),new vi.a("InconsistentCritiquesRightSidebar",null)]}get dyb(){return this.V$j}get Hce(){return this.Ave}$8b(za,sb){za=Object(ve.a)(Array,za)?Array.isArray(za)?za:null:null;if(!za||0<za.length&&!Object(J.a)(fh,za[0]))return sb;const Nb=new gi.GraphTransaction(3);try{Nb.kd(this.ua.presentation);for(const Ac of za)bk.b(Ac.paragraph),sb.add(Ac.paragraph)}finally{Nb&&Nb.dispose()}return sb}nkc(za,sb){if(this.dyb&&this.u_&&this.u_.qja&&this.u_.qja.Ada&&
2===this.u_.qja.type){var Nb=[],Ac=[];this.U$g(this.u_.qja.Ada,Nb,Ac);var Jd=[];this.U$g(this.u_.qja.Ohb,null,Jd);sb=sb.querySelectorAll("*");for(let ge=0;ge<sb.length;ge++){let re="",Xe="";const $f=sb[ge];for(let Tg=0;Tg<this.E4c.length;Tg++)$e.a.Be($f,this.E4c[Tg])&&(Xe=this.E4c[Tg],re=$e.a.Be($f,this.E4c[Tg]));re.length&&2===this.u_.qja.type&&(0===this.u_.qja.action?Array.contains(Ac,za)&&Array.contains(Nb,re)?this.yzj($f,Xe):this.Zkd($f):1===this.u_.qja.action&&Array.contains(Jd,za)&&this.Zkd($f))}}}yzj(za,
sb){yh.a.zI(za,"InconsistentCritiquesHighlight");switch(sb){case Ti.a.E1c:yh.a.zI(za,"InconsistentCritiquesLeftSidebar");break;case Ti.a.zmd:yh.a.zI(za,"InconsistentCritiquesRightSidebar");break;case Ti.a.fIc:yh.a.zI(za,"InconsistentCritiquesLeftSidebar"),yh.a.zI(za,"InconsistentCritiquesRightSidebar")}}U$g(za,sb,Nb){if(za)for(const Ac of za)Array.add(Nb,Ac.paragraph),sb&&Array.add(sb,Ac.critiqueId)}}Object(h.a)(Zg,"CritiquesHighlightActor",fe.a,[]);class Ek{}Object(h.a)(Ek,"Critique",null,[]);class Ch{}
Object(h.a)(Ch,"Suggestion",null,[]);class Ui{sIf(za,sb){if(!za)return[];const Nb=Array(za.length);for(let Ac=0;Ac<za.length;Ac++)Nb[Ac]=sb(za[Ac]);return Nb}hAi(za){return Object.assign(new Ek,{critiqueId:za.TraceId,typeId:za.TypeId,tag:za.Tag,bucketId:za.BucketId,paragraphId:za.TileId,start:za.Start,length:za.Length,categoryTitle:za.CategoryTitle,explanationTitle:za.ExplanationTitle,explanationLabel:za.ExplanationLabel,explanation:za.Explanation,suggestions:this.sIf(za.Suggestions,Object(v.a)(this,
this.iAi,"convertBox4Suggestion"))})}iAi(za){return Object.assign(new Ch,{text:za.Text,description:za.Description,bucketId:za.BucketId,numberOfInstances:za.NumberOfInstances})}}Object(h.a)(Ui,"DataContractMapper",null,[943]);class pg extends Sys.EventArgs{constructor(za){super();this.instanceId=za}}Object(h.a)(pg,"PaneClosedEventArgs",Sys.EventArgs,[]);var Mg=d(189);class gh{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe){this.ia=za;this.Yc=sb;this.Lc=Nb;this.dse=Ac;this.aEb=Jd;this.CCb=ge;this.Jve=re;this.sik=
Xe;this.Je=0;this.Yc.execute($f=>{$f.wGc(Object(v.a)(this,this.mJa,"onPaneClosed"))})}get state(){return this.Je}Apd(za){this.Je!==za&&(this.Je=za,this.Lc.Dy(new Mg.a(1)))}H7g(za){0===this.state&&(fb.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",za,(new Date).getTime()),this.Apd(1),za={},za.WE=ResourceStrings.L_EditorPaneTitle,za.assetId=this.aEb.getAssetId(),za.E5=Object(v.a)(this,this.Qgb,"onPaneRendered"),za.nonPersistedSettings={},za.nonPersistedSettings.IdeasEnabled=
this.Jve.toString(),za.vIh=this.sik,32!==this.ia.La(wc.a.gga,2,za)&&(fb.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),this.Apd(0)))}WK(za){if(2===this.state){var sb=this.aEb.USa();sb&&(fb.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",za),32!==this.ia.La(wc.a.ttb,2,sb)&&fb.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}mJa(za,sb){2===this.state&&sb&&(za=sb.instanceId)&&za.length&&(sb=this.aEb.USa(),sb!==za&&sb||(fb.a.J(37626588,375,50,
"[EditorPane] Pane closed"),this.dse.BOk(new pg(za)),this.Apd(0),this.CCb.sessionEnd()))}Qgb(){const za=this.aEb.USa();1!==this.state?fb.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",za):(fb.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",za),this.Apd(2),this.CCb.X8k())}}Object(h.a)(gh,"EditorPane",null,[945]);class Ie{constructor(za,sb){this.type=0;this.id=null;this.type=za;this.id=sb}static Elb(za){return za.id&&
za.id.toString().length&&Object(ve.a)(Number,za.type)?new Ie(za.type,za.id.toString()):null}}Object(h.a)(Ie,"Message",null,[]);var Ia=d(2);class lb{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f,Tg,hh,qj,de,Yf,vk,Gj){this.W1d=new ng.a;this.ia=za;this.e0=sb;this.$Bb=Nb;this.qwg=Ac;this.f0=Jd;this.gIg=ge;this.PL=re;this.dse=Xe;this.ua=$f;this.yma=Tg;this.Aad=hh;this.Qk=qj;this.D7j=de;this.Lc=Yf;this.K8j=vk;this.oc=Gj;this.VOc=new ng.a(0);this.VOc.add(0,2001);this.VOc.add(1,2002);this.VOc.add(2,2003)}wb(){this.ia.ra(wc.a.mLe,
Rb.a.application,Object(v.a)(this,this.LQf,"editorPaneButtonClicked"),4);this.ia.ra(wc.a.UNe,Rb.a.application,Object(v.a)(this,this.cdh,"queryEditorPaneButton"),96);this.ia.ra(wc.a.EGk,Rb.a.application,Object(v.a)(this,this.LQf,"editorPaneButtonClicked"),4);this.ia.ra(wc.a.VNe,Rb.a.application,Object(v.a)(this,this.cdh,"queryEditorPaneButton"),96);this.ia.ra(wc.a.lLe,Rb.a.application,Object(v.a)(this,this.MQf,"editorPaneExtenal"),4);this.ia.ra(wc.a.vah,Rb.a.application,Object(v.a)(this,this.MQf,"editorPaneExtenal"),
4);this.qwg.kPd(Object(v.a)(this,this.Ssk,"onEditorPaneMessageReceived"));this.yma.h6a(Object(v.a)(this,this.T0,"onSlidePresenceChanged"));this.Aad.jk(Object(v.a)(this,this.Hna,"onSlidePropertyChanged"));this.Qk.rI(Object(v.a)(this,this.AB,"onActiveSlideChanged"));this.dse.Z$h(Object(v.a)(this,this.mJa,"onPaneClosed"))}Ee(){}MQf(za,sb,Nb){if(1===Nb)return 32;switch(za){case wc.a.lLe:this.e0.H7g(2);break;case wc.a.vah:this.e0.WK(2);break;default:return fb.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",
za),16}return 32}LQf(za,sb,Nb){if(1===Nb)return this.oc.pj()?32:16;switch(this.e0.state){case 0:return this.e0.H7g(1),32;case 2:return this.e0.WK(1),32;case 1:return fb.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Lc.Dy(new Mg.a(1)),32;default:return fb.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}cdh(za,sb,Nb,Ac,Jd){if(!Jd||!Object(ve.a)(Mh.a,Jd))return 8;Jd.Mf(2===this.e0.state||1===this.e0.state);return 32}Ssk(za,
sb){this.Tsk(sb)}Tsk(za){const sb=this.f0.fLi(za.message);if(sb){var Nb;({value:Nb}=this.gIg.Uf(sb.type)).returnValue||(Nb=this.gIg.ga(0));var Ac=Nb.process(za,sb);Ac.continueWith(()=>{const Jd=Ac.result,ge=this.f0.vRf(Jd);this.sendMessage(za.instanceId,ge);this.K2j(za,sb,Jd)})}else fb.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Ia.Task.Rt(!1)}YOe(za){this.W1d.Hb(za)||this.W1d.$(za,this.K8j.LXd(200,()=>{const sb=this.$Bb.Wkj(za);if(sb.length){var Nb=
new Ie(this.VOc.ga(za),qc.a.create().toString());Nb=this.f0.vRf(Nb);this.V7k(sb,Nb)}this.D7j.XOe(za)}));this.W1d.ga(za).perform()}V7k(za,sb){for(const Nb of za)this.sendMessage(Nb,sb)}sendMessage(za,sb){this.qwg.sendMessage(za,sb)}K2j(za,sb,Nb){const Ac=new Date,Jd=+Ac-+za.ufh;2E3<=Jd&&fb.a.J(39331167,375,1E4<=Jd?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",
za.instanceId,za.Mje,za.ufh.toUTCString(),Ac.getTime(),Jd.toString(),sb.id,sb.type,Nb.id,Nb.type)}Hna(za,sb){sb.property===nd.a.isSlideCritiqueReady&&this.YOe(1)}AB(){this.YOe(0)}T0(za,sb){(za=this.ua.Ba)&&sb.slideId.equals(za.Cb)&&this.YOe(2)}mJa(za,sb){this.$Bb.QBl(sb.instanceId);this.PL.visualizeCritiques([])}}Object(h.a)(lb,"EditorPaneActor",null,[]);class Lb{constructor(){this.va=new vg.a}Z$h(za){this.va.addHandler("PaneClosed",za)}BOk(za){this.va.raiseEvent("PaneClosed",za)}}Object(h.a)(Lb,
"EditorPaneEventSource",null,[946,972,973]);var hc=d(4);class Pc{}Object(h.a)(Pc,"Paragraph",null,[]);var Td=d(214);class ie{constructor(za,sb,Nb,Ac,Jd,ge,re,Xe,$f){this.ua=za;this.NC=sb;this.dWa=Nb;this.ia=Ac;this.Fa=Jd;this.Aek=ge;this.sre=re;this.Hh=Xe;this.$$j=$f}checkProofingDirty(za){const sb=za.includedTags;if(2===za.critiqueSelection&&1===sb)return za=(za=this.ua.Ba)&&za.isConnected?!za.isSlideCritiqueReady:!0,this.Pua(0,!0),za;this.crg("CheckProofingDirty");return!0}getCritiques(za){var sb=
za.includedTags;if(2===za.critiqueSelection&&1===sb){za=this.ua.Ba;if(!za||!za.isConnected||!za.isSlideCritiqueReady)return null;sb=za.qLa;za=[];for(let Nb of sb)if((sb=Nb)&&sb.isConnected){sb=this.NC.GF(sb,Ac=>{Ac=Object(J.a)(615,Ac.Gh);return!!Ac&&5===Ac.proofingType&&!Ac.KEa});for(const Ac of sb)(sb=Object(J.a)(615,Ac.Gh))&&za.push(sb.xN)}this.Pua(1,!0);return this.sre.sIf(za,Object(v.a)(this.sre,this.sre.hAi,"convertBox4Critique"))}this.crg("GetCritiques");return null}M4f(za){var sb=this.ua.Ba;
if(!sb||!sb.isConnected)return null;const Nb=[];za=ie.Bnk(za);sb=sb.Wia;for(const Ac of za)(za=Object(J.a)(Nc.a,sb.Be(qc.a.Hf(Ac))))&&za.isConnected&&Nb.push(Object.assign(new Pc,{paragraphId:Ac,text:this.Hh.IRe(za,"\n")}));return Nb}getSupportedLanguages(za){return this.Aek.Q6i(za.includedTags).CWR(sb=>{const Nb=[];if(sb=Object(J.a)(hc.a,sb)){sb=sb.result;for(let Ac of sb)(sb=db.a.xe(Ac))&&Array.add(Nb,sb.name)}this.Pua(6,!0);return Nb})}getLanguagesOnCurrentSlide(){const za=[],sb=[],Nb=this.ua.Ba;
let Ac=[];Nb&&(Ac=Nb.Ek());for(const Jd of Ac)this.Fa.LJ(Jd,ge=>{if(ge&&Object(ve.a)(Ua.AParagraphNode,ge)){ge=Object(J.a)(Ua.AParagraphNode,ge);var re=ge.characterData;if(re&&re.length){var Xe=-1,$f;for(re=0;re<ge.Ra.length;re++)if($f=ge.Ra.ga(re).formatting)$f=mc.a.language($f),Xe===$f||Array.contains(za,$f)||(Array.add(za,$f),(Xe=db.a.xe($f))&&Array.add(sb,Xe.name)),Xe=$f}}});this.Pua(7,!0);return sb}visualizeCritiques(za){if(!za)return this.Pua(2,!1),1;const sb=Array(za.length);if(!za.length)return this.dWa.nWc(sb),
this.Pua(2,!0),0;for(let Nb=0;Nb<za.length;Nb++)sb[Nb]=za[Nb].critiqueId;this.dWa.nWc(sb);this.Pua(2,!0);return 0}resolveCritiques(za){if(!za||!za.length)return 1;const sb=new ng.a(0);for(const Nb of za)sb.add(Nb.critiqueId,Nb.suggestionIndex);za=this.dWa.JAh(sb);this.Pua(3,za);return za?0:1}ignoreCritiques(za){if(!za||!za.length)return 1;const sb=[];for(const Nb of za)Array.add(sb,Nb.critiqueId);za=this.dWa.ignoreCritiques(sb,4);this.Pua(4,za);return za?0:1}openProofingSettingsDialog(){if(this.$$j){const za=
this.ia.processAction(oj.a.AHb,2);this.Pua(5,32===za)}}Pua(za,sb){fb.a.J(37266337,375,50,"{0}: {1}",za,sb?0:1)}crg(za){fb.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",za)}static Bnk(za){const sb=new Td.a;for(var Nb of za)sb.contains(Nb.paragraphId)||sb.add(Nb.paragraphId);za=Array(sb.count);Nb=0;for(let Ac of sb)za[Nb++]=Ac;return za}}Object(h.a)(ie,"EditorPaneHost",null,[942]);class Sd{}Object(h.a)(Sd,"EditorRuntimeNotificationData",null,[]);class wf extends Sys.EventArgs{constructor(){super();
this.d3b=this.Dka=null}}Object(h.a)(wf,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class Pf{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(Pf,"InfraredResultBase",null,[]);var og=d(337),Dh=d(525);class Bi{constructor(za,sb){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=za;this.includedTags=sb}static RH(za){return Object(ve.a)(Number,za.critiqueSelection)&&Object(ve.a)(Number,za.includedTags)?
new Bi(za.critiqueSelection,za.includedTags):null}}Object(h.a)(Bi,"CritiqueFilter",null,[]);class Vi{constructor(za,sb,Nb,Ac){this.ia=za;this.PL=sb;this.ua=Nb;this.rwg=Ac}XOe(za){if(this.rwg){var sb=new Bi(2,1),Nb=this.PL.checkProofingDirty(sb),Ac=Nb?[]:this.PL.getCritiques(sb),Jd=Nb?[]:this.PL.M4f(Ac);sb=this.UFe();za=Object.assign(new Sd,{isProofingDirty:Nb,critiques:Ac,paragraphs:Jd,numberOfCoAuthors:sb,contextChanged:0===za});Jd=(Ac=!!Ac&&0<Ac.length)?1:0;let ge=og.a.success;0<sb?ge=og.a.WIa:
Nb?ge=og.a.pending:Ac||(ge=og.a.WIa);Nb=Object.assign(new wf,{Dka:Object.assign(new Pf,{notificationConfidence:Jd,shouldRaiseNotification:!1,confidence:1,resultStatus:ge}),d3b:za});this.rwg.XOe(Nb)}}UFe(){var za=this.ua.Ba;if(!za||!za.isConnected)return 0;za=Object.assign(new Dh.a,{slideId:za.Cb});this.ia.La(wc.a.WZa,2,za);return za.Frc}}Object(h.a)(Vi,"EditorRuntimeEventRaiser",null,[941]);var kh=d(543),mi=d(700);class sh{constructor(za){this.P9j=za}X8k(){this.U_a(0,0)}sessionEnd(){this.U_a(1,0)}Irl(){this.U_a(2,
4)}Jrl(){this.U_a(2,3)}U_a(za,sb){this.P9j.execute(Nb=>{const Ac=Object.assign(new mi.a,{cardId:kh.a.JQf,actionType:za,actionEngagement:sb});Nb.Sdd(Ac)})}}Object(h.a)(sh,"InfraredTelemetryLogger",null,[944]);class Ng extends Ie{constructor(za,sb,Nb){super(za,sb);this.payload=null;this.payload=Nb}}Object(h.a)(Ng,"MessageWithPayload",Ie,[]);class Wh extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}}Object(h.a)(Wh,"CheckProofingDirtyAndGetCritiquesResponse",Ng,[]);class Gg extends Ng{constructor(za,
sb,Nb){super(za,sb,Nb)}}Object(h.a)(Gg,"ResponseMessage",Ng,[]);class eg{constructor(za){this.statusCode=0;this.logErrorMessage=null;this.statusCode=za;this.logErrorMessage="";0!==za&&(this.logErrorMessage=za.toString())}}Object(h.a)(eg,"Response",null,[]);class Tj extends eg{constructor(za,sb,Nb,Ac){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=za;this.critiques=sb;this.paragraphs=Nb;this.languagesOnTheCurrentSlide=Ac}}Object(h.a)(Tj,
"ProofingDirtyAndCritiques",eg,[]);class aj{constructor(za,sb,Nb){this.ua=za;this.PL=sb;this.f0=Nb}process(za,sb){var Nb=this.f0.pJi(za.message);if(!Nb)return fb.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),za=new eg(1),Ia.Task.Rt(new Gg(1003,sb.id,za));za=this.ua.Ba;if(!za||!za.isConnected)return fb.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),za=new Tj(!1,[],[],[]),sb=new Wh(1003,sb.id,
za),Ia.Task.Rt(sb);Nb=(za=this.PL.checkProofingDirty(Nb.payload))?[]:this.PL.getCritiques(Nb.payload);if(!Nb)return fb.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),za=new eg(2),Ia.Task.Rt(new Gg(1003,sb.id,za));const Ac=za?[]:this.PL.M4f(Nb),Jd=za?[]:this.PL.getLanguagesOnCurrentSlide();if(!Jd)return fb.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),za=new eg(7),Ia.Task.Rt(new Gg(1003,
sb.id,za));za=new Tj(za,Nb,Ac,Jd);sb=new Wh(1003,sb.id,za);return Ia.Task.Rt(sb)}}Object(h.a)(aj,"CheckProofingDirtyAndGetCritiquesProcessor",null,[968]);class pj{constructor(za,sb,Nb){this.PL=za;this.f0=sb;this.CCb=Nb}process(za,sb){var Nb=this.f0.rJi(za.message);if(!Nb)return fb.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),za=new eg(1),Ia.Task.Rt(new Gg(1006,sb.id,za));Nb=this.PL.ignoreCritiques(Nb.payload);0===Nb&&za.Mje&&this.CCb.Jrl();za=0===Nb?new eg(0):new eg(6);return Ia.Task.Rt(new Gg(1006,
sb.id,za))}}Object(h.a)(pj,"IgnoreProcessor",null,[968]);class Ji extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}}Object(h.a)(Ji,"NumberOfCoAuthorsResponse",Ng,[]);class yg extends eg{constructor(za){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=za}}Object(h.a)(yg,"NumberOfCoAuthorsModel",eg,[]);class Aa{constructor(za,sb){this.ia=za;this.ua=sb}process(za,sb){za=this.UFe();za=new yg(za);return Ia.Task.Rt(new Ji(1009,sb.id,za))}UFe(){var za=this.ua.Ba;if(!za||!za.isConnected)return 0;
za=Object.assign(new Dh.a,{slideId:za.Cb});this.ia.La(wc.a.WZa,2,za);return za.Frc}}Object(h.a)(Aa,"NumberOfCoAuthorsProcessor",null,[968]);class Ma{constructor(za,sb,Nb){this.ia=za;this.e0=sb;this.Jve=Nb}process(za,sb){if(!this.Jve)return fb.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),za=new eg(10),Ia.Task.Rt(new Gg(1011,sb.id,za));this.e0.WK(3);za=this.ia.processAction(wc.a.AYe,2);32!==za&&fb.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");
za=new eg(32!==za?9:0);return Ia.Task.Rt(new Gg(1011,sb.id,za))}}Object(h.a)(Ma,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[968]);class cb{constructor(za){this.PL=za}process(za,sb){this.PL.openProofingSettingsDialog();za=new eg(0);return Ia.Task.Rt(new Gg(1007,sb.id,za))}}Object(h.a)(cb,"OpenProofingSettingsProcessor",null,[968]);class Fb{constructor(za,sb,Nb){this.PL=za;this.f0=sb;this.CCb=Nb}process(za,sb){var Nb=this.f0.sJi(za.message);if(!Nb)return fb.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),
za=new eg(1),Ia.Task.Rt(new Gg(1005,sb.id,za));Nb=this.PL.resolveCritiques(Nb.payload);0===Nb&&za.Mje&&this.CCb.Irl();za=0===Nb?new eg(0):new eg(5);return Ia.Task.Rt(new Gg(1005,sb.id,za))}}Object(h.a)(Fb,"ResolveProcessor",null,[968]);class dc extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}}Object(h.a)(dc,"SubscriptionResponse",Ng,[]);class zc extends eg{constructor(za){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=za}}Object(h.a)(zc,"SubscriptionModel",eg,[]);class Vc{constructor(za,
sb){this.$Bb=za;this.f0=sb}process(za,sb){const Nb=this.f0.tJi(za.message);if(!Nb)return fb.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),za=new eg(1),Ia.Task.Rt(new Gg(1001,sb.id,za));fb.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",Nb.payload.telemetryCorrelationId);this.$Bb.subscribe(za.instanceId,0);this.$Bb.subscribe(za.instanceId,1);this.$Bb.subscribe(za.instanceId,2);za=new zc("not available");return Ia.Task.Rt(new dc(1001,sb.id,za))}}Object(h.a)(Vc,"SubscribeProcessor",
null,[968]);class rd extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}}Object(h.a)(rd,"SupportedLanguagesResponse",Ng,[]);class Z extends eg{constructor(za){super(0);this.supportedLanguages=null;this.supportedLanguages=za}}Object(h.a)(Z,"SupportedLanguagesModel",eg,[]);class Da{constructor(za,sb){this.PL=za;this.f0=sb}process(za,sb){za=this.f0.uJi(za.message);if(!za)return fb.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),za=new eg(1),Ia.Task.Rt(new Gg(1010,sb.id,za));
const Nb=this.PL.getSupportedLanguages(za.payload);return Nb.CWR(()=>{var Ac=Nb.result;if(!Ac)return fb.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),Ac=new eg(8),new Gg(1010,sb.id,Ac);Ac=new Z(Ac);return new rd(1010,sb.id,Ac)})}}Object(h.a)(Da,"SupportedLanguagesProcessor",null,[968]);class Wa{process(za,sb){fb.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",sb.type);za=new eg(3);return Ia.Task.Rt(new Gg(sb.type,sb.id,za))}}
Object(h.a)(Wa,"UnsupportedMessageProcessor",null,[968]);class ib{constructor(za,sb){this.PL=za;this.f0=sb}process(za,sb){za=this.f0.vJi(za.message);if(!za)return fb.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),za=new eg(1),Ia.Task.Rt(new Gg(1004,sb.id,za));za=0===this.PL.visualizeCritiques(za.payload)?new eg(0):new eg(4);return Ia.Task.Rt(new Gg(1004,sb.id,za))}}Object(h.a)(ib,"VisualizeProcessor",null,[968]);class nb extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}static RH(za){const sb=
Ie.Elb(za);return sb&&za.payload?(za=Bi.RH(za.payload))?new nb(sb.type,sb.id,za):null:null}}Object(h.a)(nb,"CheckProofingDirtyAndGetCritiquesMessage",Ng,[]);class jc{constructor(za){this.nRb=za}get critiqueId(){return this.nRb}static RH(za){return za.critiqueId&&Object(J.a)(String,za.critiqueId)?new jc(za.critiqueId.toString()):null}}Object(h.a)(jc,"CritiqueIgnore",null,[]);class cc extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}static RH(za){const sb=Ie.Elb(za);if(!sb||!za.payload||!Object(ve.a)(Array,
za.payload))return null;za=za.payload;const Nb=Array(za.length);for(let Ac=0;Ac<za.length;Ac++){const Jd=jc.RH(za[Ac]);if(!Nb)return null;Nb[Ac]=Jd}return new cc(sb.type,sb.id,Nb)}}Object(h.a)(cc,"IgnoreCritiquesMessage",Ng,[]);class Ad{constructor(za,sb){this.nRb=za;this.$0h=sb}get critiqueId(){return this.nRb}get suggestionIndex(){return this.$0h}static RH(za){return za.critiqueId&&Object(J.a)(String,za.critiqueId)&&Object(ve.a)(Number,za.suggestionIndex)?new Ad(za.critiqueId.toString(),za.suggestionIndex):
null}}Object(h.a)(Ad,"CritiqueResolution",null,[]);class Xd extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}static RH(za){const sb=Ie.Elb(za);if(!sb||!za.payload||!Object(ve.a)(Array,za.payload))return null;za=za.payload;const Nb=Array(za.length);for(let Ac=0;Ac<za.length;Ac++){const Jd=Ad.RH(za[Ac]);if(!Nb)return null;Nb[Ac]=Jd}return new Xd(sb.type,sb.id,Nb)}}Object(h.a)(Xd,"ResolveCritiquesMessage",Ng,[]);class xe{constructor(za){this.telemetryCorrelationId=null;this.telemetryCorrelationId=za}static RH(za){let sb=
"unavailable";za.telemetryCorrelationId&&Object(J.a)(String,za.telemetryCorrelationId)&&za.telemetryCorrelationId.toString().length&&50>=za.telemetryCorrelationId.toString().length&&(sb=za.telemetryCorrelationId.toString());return new xe(sb)}}Object(h.a)(xe,"Subscription",null,[]);class Ff extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}static RH(za){const sb=Ie.Elb(za);if(!sb)return null;za.payload||(za.payload={});return(za=xe.RH(za.payload))?new Ff(sb.type,sb.id,za):null}}Object(h.a)(Ff,"SubscribeMessage",
Ng,[]);class xg extends Ng{constructor(za,sb,Nb){super(za,sb,Nb)}static RH(za){const sb=Ie.Elb(za);return sb&&za.payload?(za=Bi.RH(za.payload))?new xg(sb.type,sb.id,za):null:null}}Object(h.a)(xg,"SupportedLanguagesMessage",Ng,[]);class Eg{constructor(za){this.nRb=za}get critiqueId(){return this.nRb}static RH(za){return za.critiqueId&&Object(J.a)(String,za.critiqueId)&&za.critiqueId.toString().length?new Eg(za.critiqueId.toString()):null}}Object(h.a)(Eg,"CritiqueToVisualize",null,[]);class De extends Ng{constructor(za,
sb,Nb){super(za,sb,Nb)}static RH(za){const sb=Ie.Elb(za);if(!sb||!za.payload||!Object(ve.a)(Array,za.payload))return null;za=za.payload;const Nb=Array(za.length);for(let Ac=0;Ac<za.length;Ac++){const Jd=Eg.RH(za[Ac]);if(!Nb)return null;Nb[Ac]=Jd}return new De(sb.type,sb.id,Nb)}}Object(h.a)(De,"VisualizeCritiquesMessage",Ng,[]);class zd{fLi(za){return this.Dlb(za,Ie.Elb)}tJi(za){return this.Dlb(za,Ff.RH)}pJi(za){return this.Dlb(za,nb.RH)}vJi(za){return this.Dlb(za,De.RH)}sJi(za){return this.Dlb(za,
Xd.RH)}rJi(za){return this.Dlb(za,cc.RH)}uJi(za){return this.Dlb(za,xg.RH)}Dlb(za,sb){try{let Nb;return({rv:Nb}=A.d(za)).returnValue?sb(Nb):null}catch(Nb){return null}}vRf(za){return A.c(za)}}Object(h.a)(zd,"MessageEncoder",null,[950]);var Gd=d(80);class fd extends Sys.EventArgs{constructor(za,sb,Nb){super();this.instanceId=za;this.message=sb;this.Mje=Nb;this.ufh=new Date}}Object(h.a)(fd,"MessageReceivedEventArgs",Sys.EventArgs,[]);class Mc{constructor(za,sb,Nb){this.va=new vg.a;this.aEb=za;this.esg=
sb;this.A9j=new RegExp(Nb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(v.a)(this,this.Sic,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(v.a)(this,this.Sic,"messageReceivedHandler")),!0;fb.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(za){fb.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
za.message,za.stack)}return!1}kPd(za){this.va.addHandler("MessageReceived",za)}fih(za){this.va.removeHandler("MessageReceived",za)}sendMessage(za,sb){if(za&&sb){var Nb={};Nb.message=sb;Nb.editorPaneWildCard=".";this.S7k(za,Nb)}}S7k(za,sb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(za,"onCustomMessage",sb,Nb=>{Nb&&fb.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",Nb)})}Sic(za){const sb=za.origin;if(this.k$b(sb)){var Nb;({rv:Nb}=A.d(za.data)).returnValue&&
Nb&&"."===Nb.editorPaneWildCard&&Nb.message&&this.va.raiseEvent("MessageReceived",new fd(this.aEb.USa(),Nb.message,sb===this.esg))}}k$b(za){const sb=Gd.a.sQ(window.location.href);return!!za&&0<za.length&&"null"!==za&&(za===this.esg||za===sb||this.A9j.test(za))}}Object(h.a)(Mc,"Messenger",null,[949]);class uk{constructor(za,sb){this.Yc=za;this.assetId=sb.Gah}USa(){if(!this.Yc.instance)return fb.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const za=this.Yc.instance.pQ(this.assetId);
return za?za.instanceId?za.instanceId:(fb.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(fb.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(uk,"PaneIdsProvider",null,[947]);class Ki{constructor(){this.Js=new ng.a}subscribe(za,sb){za&&(this.Js.Hb(sb)||this.Js.add(sb,[]),Array.contains(this.Js.ga(sb),za)||this.Js.ga(sb).push(za))}unsubscribe(za,sb){za&&this.Js.Hb(sb)&&(za=Array.indexOf(this.Js.ga(sb),
za),-1!==za&&Array.removeAt(this.Js.ga(sb),za))}QBl(za){za&&(this.unsubscribe(za,0),this.unsubscribe(za,1),this.unsubscribe(za,2))}Wkj(za){return this.Js.Hb(za)?this.Js.ga(za):[]}}Object(h.a)(Ki,"EditorPaneSubscriptionsManager",null,[948]);class bj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Zb(za){za&&(this.K=za,this.K.register(Zg,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().oa(()=>new Zg(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(940,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().oa(()=>new Qd(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(lb,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().oa(()=>new lb(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.OEi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),bj.KLj&&this.K.register(Jg,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().oa(()=>new Jg(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw,this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(941,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().oa(()=>new Vi(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(Of,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().oa(()=>new Of),this.K.register(942,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().oa(()=>new ie(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(943,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().oa(()=>
new Ui),this.K.register(944,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().oa(()=>new sh(this.K.Ja("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(945,"PowerPointWebEditor.EditorPane.IEditorPane").ma().oa(()=>new gh(this.K.resolve("Common.IActionManagerExtended"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(946,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().oa(()=>new Lb),this.K.register(947,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().oa(()=>new uk(this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(948,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().oa(()=>
new Ki),this.K.register(949,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().oa(()=>new Mc(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").kHk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(950,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().oa(()=>new zd),this.K.register(Wa,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().oa(()=>
new Wa),this.K.register(Vc,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().oa(()=>new Vc(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Fb,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().oa(()=>new Fb(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(pj,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().oa(()=>new pj(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(cb,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().oa(()=>
new cb(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(aj,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().oa(()=>new aj(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(ib,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().oa(()=>
new ib(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Aa,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().oa(()=>new Aa(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Da,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().oa(()=>new Da(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Ma,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().oa(()=>new Ma(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").gf(()=>{var za=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
bj.Vhl(za)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(za=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),za.wb(),za.Ee(),za=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),za.wb(),za.Ee())})}dispose(){}OEi(){const za=new ng.a;za.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));za.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
za.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));za.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));za.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));za.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));za.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));za.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));za.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));za.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return za}static main(){z.a.instance.Dc(new bj)}static Vhl(za){return za.pptEditorConsistencyCheckIsEnabled&&bj.nJj(za.Gah)}static KLj(za){return za.cOf}static nJj(za){return!!za&&0<za.length}}
Object(h.a)(bj,"PptWebEditorEditorPanePackage",null,[2,3]);var wi=d(12);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");
Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Object(wi.c)("AugLoop");Ub.main();uc.main();vf.main();bj.main();Object(wi.b)("AugLoop")},685:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(18),e=d(97),n=d(29),m=d(50);d(98);class z{constructor(){this.u_=null}get dyb(){return!1}XCh(B,v){let y=new h.a;const A=new m.GraphTransaction(3);try{A.kd(n.App.Kb.Kd.Dn.xg),
this.wac(v)&&(y=this.$8b(v,y)),v!==B&&this.wac(B)&&(y=this.$8b(B,y))}finally{A&&A.dispose()}return y.toArray()}wac(B){return!!B}Zkd(B){let v=!1;for(const y of this.Hce)v||!Sys.UI.DomElement.containsCssClass(B,y.className)&&!Sys.UI.DomElement.containsCssClass(B,y.h7b)||(v=!0),e.a.pKa(B,y.className),e.a.pKa(B,y.h7b)}}Object(I.a)(z,"AHighlightActor",null,[985])},686:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.className=e;this.h7b=n}}Object(I.a)(h,"HighlightCssClassPair",
null,[])},687:function(I,Y,d){d.d(Y,"b",function(){return m});d.d(Y,"a",function(){return z});var h=d(97);d(29);var e=d(50);d(33);d(94);var n=d(98);const m=B=>{const v=new e.GraphTransaction(3);try{v.kd(B),B.Bv(32,!0)}finally{v&&v.dispose()}},z=B=>{if(B){B=h.a.Yja(B);if(-1===B.indexOf(n.a.h8)&&-1!==B.indexOf(n.a.pN)&&-1===B.indexOf(n.a.M1b))return 2;if(-1===B.indexOf(n.a.h8)&&(-1!==B.indexOf(n.a.L1b)||-1!==B.indexOf(n.a.CN)||-1!==B.indexOf(n.a.M1b)||-1!==B.indexOf(n.a.tKc)||-1!==B.indexOf(n.a.gMc)||
-1!==B.indexOf(n.a.eMc)||-1!==B.indexOf(n.a.dMc)||-1!==B.indexOf(n.a.WYd)||-1!==B.indexOf(n.a.RYd)||-1!==B.indexOf(n.a.TYd)||-1!==B.indexOf(n.a.fMc)||-1!==B.indexOf(n.a.QYd)))return 1;if(-1!==B.indexOf("WACImageContainer"))return 3}return 0}},688:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.type=this.action=0;this.Ohb=this.Ada=null}}Object(I.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.augloop.js.map