'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1244:function(I,Y,d){d.r(Y);I=d(0);var h=d(14);class e{constructor(qb,Wb){this.MOa=null;this.FVb=qb;this.kYh=Wb}init(){this.FVb.continueWith(()=>{this.MOa=this.FVb.result;this.MOa.jrb(Object(h.a)(this,this.V0,"onUsersUpdated"))})}V0(){e.Wxf(this.MOa.l9a())&&(this.MOa.qRe(Object(h.a)(this,this.V0,"onUsersUpdated")),this.kYh.IsRealCoauthSession=!0)}static Wxf(qb){let Wb=null;for(const Xc of qb)if(Xc)if(qb=Xc.isAnonymous||
!Xc.email?Xc.clientId:Xc.email.toUpperCase(),!Wb)Wb=qb;else if(Wb!==qb)return!0;return!1}}Object(I.a)(e,"CoauthTelemetry",null,[1092]);var n=d(387),m=d(1062),z=d(1200),B=d(27),v;(function(qb){qb[qb.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";qb[qb.notImplemented=1]="notImplemented";qb[qb.renderHandled=2]="renderHandled";qb[qb.renderHandledWithVeto=3]="renderHandledWithVeto"})(v||(v={}));Object(I.b)("CoauthorGalleryTelemetryEndResult",v);var y=d(96),A=d(105),E=d(2);class u{constructor(qb,
Wb,Xc,xb,Rb,wc,ud,uc,db){this.Wkf=this.z9e=this.DK=null;this.zpa=qb;this.XDc=new m.a;this.$a=Xc;this.Lyd=Wb;this.Tga=xb;this.oi=Rb;this.fId=wc;this.HOa=ud;this.iNh=uc;this.$cf=this.Xcf=!1;this.HEc=0;this.w9e=1;this.o2a=db;this.SXb=this.$a.ka("PeoplesWellExtraButtonInfoIsEnabled");this.Jmb=Object(z.a)(String,B.AFrameworkApplication.gd.Application)||""}get qyh(){return this.XDc.task}init(){E.Task.WAA.call(null,this.HOa,this.Lyd,this.fId).continueWith(()=>{this.DK=this.HOa.result;this.z9e=this.Lyd.result;
this.Wkf=this.fId.result;E.Task.WAA.call(null,this.Lyd.result.yCa,this.fId.result.Qsd).continueWith(()=>{this.w9e=this.z9e.yCa.result;this.HEc=this.Wkf.Qsd.result;this.DK.jrb(Object(h.a)(this,this.Agd,"onUsersUpdatedEventListener"));this.DK.l9a().length&&this.V0()})})}Agd(){this.V0()}V0(){this.iNh(this.DK.l9a())?(this.DK.qRe(Object(h.a)(this,this.Agd,"onUsersUpdatedEventListener")),this.htk(this.Xcf)):this.XDc.PM(1);this.Xcf=!0}htk(qb){this.$cf?this.qyh.continueWith(()=>{n.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",v[this.qyh.result])}):(this.$cf=!0,this.LKk(0===this.w9e&&!qb))}LKk(qb){qb?this.Tga.ek(4,Object(h.a)(this,this.SHe,"onInteractiveReady")):this.XDc.PM(1)}SHe(){const qb=this.oi.hh("AppInitStatus_interactivityReady");n.ULS.shipAssertTag(42259235,325,!!this.HEc);const Wb=this.HEc-qb,Xc={};Xc.InteractiveTime=qb;Xc.ReactRenderComplete=this.HEc;Xc.HadTabSwitch=this.o2a();Xc.IsModernGallery=this.SXb;n.ULS.sendTraceTag(594883104,325,50,
A.a.toJSON(Xc));this.SXb?(n.ULS.sendTraceTag(42062997,325,15,Wb.toString()),this.XDc.PM(this.CIl(Wb)?3:2)):n.ULS.sendTraceTag(594883103,325,15,Wb.toString())}CIl(qb){const Wb=qb>this.$a.Bc("CoauthorGalleryTimeToRenderDurationMs",1E4),Xc="Word"===this.Jmb;if(this.o2a())return n.ULS.sendTraceTag(50455714,325,50,Wb.toString()),!1;Xc&&y.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Wb&&(Xc&&y.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),n.ULS.sendTraceTag(42062998,325,15,qb.toString()));return Wb}}Object(I.a)(u,"CoauthorGalleryTelemetry",null,[1091]);class J{constructor(qb){this.DK=null;this.Fwc={};this.fCc={};this.oTb=null;this.HOa=qb}MTc(qb){const Wb=new m.a;this.init().continueWith(()=>{qb in this.Fwc?Wb.PM(this.Fwc[qb]):this.fCc[qb]=Wb});return Wb.task}init(){if(this.oTb)return this.oTb.task;this.oTb=new m.a;this.HOa.continueWith(()=>{this.DK=this.HOa.result;this.DK.jrb(Object(h.a)(this,
this.V0,"onUsersUpdated"));this.pHh();this.oTb.Gg(null)});return this.oTb.task}pHh(){const qb=this.DK.l9a();qb.sort(Object(h.a)(this,this.fwi,"comparePresenceUsers"));this.Fwc={};for(let Wb=0;Wb<qb.length&&qb[Wb]&&qb[Wb].OFa;Wb++)this.R6h(this.Fwc,qb[Wb].clientId,Wb)}R6h(qb,Wb,Xc){qb[Wb]=Xc;Wb in this.fCc&&(this.fCc[Wb].PM(Xc),delete this.fCc[Wb])}V0(){this.pHh()}fwi(qb,Wb){return qb.OFa>Wb.OFa?1:qb.OFa<Wb.OFa?-1:0}}Object(I.a)(J,"CoauthorPositionFinder",null,[1090]);var G=d(1203),S=d(1202),P=d(1201),
Q=d(18),D=d(106);class O{constructor(){this.kia=null;this.EQb=Array(32)}xor(qb){if(!qb)throw Error.argumentNull("Guid argument cannot be null");const Wb=new O,Xc=new Sys.StringBuilder;for(let xb=0;xb<qb.EQb.length;xb++){const Rb=this.EQb[xb]^qb.EQb[xb];Wb.EQb[xb]=Rb;Xc.append(Rb.toString(16));7!==xb&&11!==xb&&15!==xb&&19!==xb||Xc.append("-")}Wb.kia=D.a.Hf(Xc.toString());return Wb}toString(){return this.kia.toString()}equals(qb){if(!qb)throw Error.argumentNull("Guid argument cannot be null");return this.kia.equals(qb.kia)}static SQc(qb){if(!qb)throw Error.argumentNull("String input cannot be null");
const Wb=new O;Wb.kia=D.a.Hf(qb);const Xc=Wb.kia.toString();let xb=0;for(let wc=0;wc<Xc.length;wc++){var Rb=qb.charAt(wc);if(O.dOj(Rb))Rb=O.$yj(Rb,qb.charCodeAt(wc)),Wb.EQb[xb++]=Rb;else if(!O.yNj(Rb))throw Error.argument("String contains characters not valid in Guids");}return Wb}static dOj(qb){return"0"<=qb&&"9">=qb||"A"<=qb&&"F">=qb||"a"<=qb&&"f">=qb}static yNj(qb){return"{"===qb||"}"===qb||"-"===qb}static $yj(qb,Wb){if("0"<=qb&&"9">=qb)return Wb-48;if("A"<=qb&&"F">=qb)return Wb-65+10;if("a"<=
qb&&"f">=qb)return Wb-97+10;throw Error.argument("Char is not valid hex digit");}}Object(I.a)(O,"Guid",null,[]);class X{constructor(qb,Wb,Xc,xb){this.MOa=null;this.p$e=this.$if=!1;this.ohf=0;this.FVb=qb;this.JLd=Wb;this.$a=Xc;this.tGd=xb;this.RMh=B.AFrameworkApplication.Ylb||B.AFrameworkApplication.PQ;this.Xhf=new G.a(S.a.to())}get kZd(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.FVb.continueWith(()=>{this.MOa=this.FVb.result;
this.MOa.jrb(Object(h.a)(this,this.V0,"onUsersUpdated"))})}V0(){this.ivi(this.MOa.l9a())}ivi(qb){var Wb=0;const Xc=new P.a(S.a.to());for(const xb of qb)if(xb&&xb.isAnonymous){B.AFrameworkApplication.bGa("70eb6120;2gfeb930");if(Xc.Hb(xb.userName))Xc.ga(xb.userName).add(xb.clientId);else{let Rb;Xc.add(xb.userName,(Rb=new Q.a,Rb.add(xb.clientId),Rb))}xb.clientId!==this.tGd?(Wb++,2<=Wb&&!this.$if&&this.j3j()):!this.p$e&&this.kZd&&"Guest"===xb.userName&&(n.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.p$e=!0)}if(this.kZd&&this.ohf!==Wb){n.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",Wb+(this.RMh?1:0));this.ohf=Wb;for(let xb of Xc.keys)2<=Xc.ga(xb).count&&(qb=this.A8i(Xc.ga(xb)),this.Xhf.contains(qb)||(Wb={},Wb.guestsWithSameName=Xc.ga(xb).count,Wb.identifier=qb,n.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",Wb),this.Xhf.add(qb)))}}j3j(){n.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.$if=!0;this.kZd&&
this.JLd&&this.JLd.continueWith(()=>{window.setTimeout(()=>{this.JLd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}A8i(qb){if(!qb||1>=qb.count)return"";let Wb=O.SQc(qb.ga(0));for(let Xc=1;Xc<qb.count;Xc++)Wb=Wb.xor(O.SQc(qb.ga(Xc)));return Wb.toString()}}Object(I.a)(X,"GuestCoauthTelemetry",null,[]);var N=d(1199);class aa{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(I.a)(aa,"PL",null,[]);var V=d(36);class ca{constructor(){this.ct=
this.vt=this.d=0}static Yoh(qb,Wb,Xc){const xb=new ca;xb.d=qb;xb.vt=Wb;xb.ct=Xc;return V.c(xb)}}Object(I.a)(ca,"VD",null,[]);var fa=d(89);class ma{constructor(qb,Wb,Xc,xb,Rb,wc,ud,uc,db){this.cof=!1;this._id=qb;this.Kj=Wb;this.Gt=Xc;this.uGd=xb;this.kMd=Rb;this.M5a=wc;this.K2a=ud;this.yOh=uc;this.o2a=db;this.Jmb=Object(z.a)(String,B.AFrameworkApplication.gd.Application)||""}xvd(qb){E.Task.WAA(this.uGd,this.kMd).continueWith(()=>{if(this.uGd.result<=this.kMd.result)qb.PM(!1);else{var Wb=this.Gt-this.Kj,
Xc=new aa;Xc.id=this._id;Xc.et=this.Gt;Xc.st=this.Kj;Xc.d=this.Gt-this.Kj;Xc.mp=this.uGd.result;Xc.tp=this.kMd.result;Xc.ct=this.Z4i(this.yOh);Xc.vc=this.o2a();var xb=V.c(Xc),Rb="Word"===this.Jmb;n.ULS.sendTraceTag(42078597,302,15,xb);if(Rb){const wc=new Map;wc.set("data",xb);y.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",wc)}Wb>this.M5a.value&&!this.cof&&!Xc.vc&&(this.cof=!0,qb.PM(!0),Xc=Object.assign(new fa.a,{inStaging:!0,extendedProperties:new Map}),Xc.extendedProperties.set("data",
xb),Rb&&y.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Xc),Wb<this.K2a.value&&n.ULS.sendTraceTag(42078598,302,15,ca.Yoh(Wb,this.M5a.value,this.K2a.value)));qb.task.isCompleted||qb.PM(!1)}})}Z4i(qb){switch(qb){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(I.a)(ma,"PresenceLatencyActivityLogger",null,[]);class da{constructor(qb,Wb,Xc){this.V8e=this.v9e=this.twc=this.Ewc=this.Emb=0;this._id=qb;
this.M5a=Wb;this.K2a=Xc;this.Jmb=Object(z.a)(String,B.AFrameworkApplication.gd.Application)||""}get Cvf(){return this.Emb}set Cvf(qb){this.Emb=qb;this.GUd()}get lGf(){return this.Ewc}set lGf(qb){this.Ewc=qb;this.GUd()}get ADf(){return this.twc}set ADf(qb){this.twc=qb;this.GUd()}get mGf(){return 0!==this.v9e}get BDf(){return 0!==this.V8e}GUd(){!this.mGf&&this.Emb&&this.Ewc&&(this.v9e=this.xvd(this.Ewc,"CoauthGalleryLightupDurationTooLong"));!this.BDf&&this.Emb&&this.twc&&(this.V8e=this.xvd(this.twc,
"CanvasPresenceLightupDurationTooLong"))}xvd(qb,Wb){const Xc=qb-this.Emb;var xb=new aa;xb.id=this._id;xb.et=qb;xb.st=this.Emb;xb.d=Xc;var Rb=V.c(xb);qb="Word"===this.Jmb;xb="CanvasPresenceLightupDurationTooLong"===Wb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Wb?n.ULS.sendTraceTag(572289499,302,15,Rb):n.ULS.sendTraceTag(571524118,302,15,Rb);if(qb){var wc=new Map;wc.set("data",Rb);y.Health.instance.recordKpiUsage(xb,0,"wordcollabrel",wc)}return Xc>
this.M5a.value?(wc=Object.assign(new fa.a,{inStaging:!0,extendedProperties:new Map}),wc.extendedProperties.set("data",Rb),Rb=Xc<this.K2a.value,wc.extendedProperties.set("cash",Rb?"true":"false"),qb&&y.Health.instance.recordKpiFailure(xb,Wb,!1,!0,wc),n.ULS.sendTraceTag(572289500,302,15,ca.Yoh(Xc,this.M5a.value,this.K2a.value)),Rb?2:1):3}}Object(I.a)(da,"PresenceLightupLatencyLogger",null,[]);var qa=d(288),F=d(282);class sa{constructor(qb,Wb,Xc,xb,Rb,wc,ud=null,uc=null,db=null){this.Elf={};this.Kyd=
{};this.qgf=new Q.a;this.pTb=this.DK=this.nDc=null;this.Vof=this.Uof=0;this.M5a=new N.a(()=>ud.rQ("PresenceBootLatencyThreshold",1E4));this.K2a=new N.a(()=>ud.rQ("PresenceBootLatencyCutoffThreshold",6E4));this.g3h=new N.a(()=>ud.rQ("PresenceLightupLatencyThreshold",2E3));this.GPh=new N.a(()=>ud.rQ("PresenceLightupLatencyCutoffThreshold",1E4));this.nYh=xb;this.x9e=qb;this.hnf=Wb;this.HOa=Xc;this.oi=Rb;this.tGd=uc;this.o2a=wc;this.bdf=db;this.o8e=!1;this.init()}gRi(qb,Wb=0){var Xc=new Date;const xb=
new m.a;this.init().continueWith(()=>{this.gwk(qb);this.hRi(xb,qb,Xc,Wb)})}get f_g(){return this.tGd||"{"+B.AFrameworkApplication.userSessionId+"}"}init(){if(this.pTb)return this.pTb.task;this.pTb=new m.a;this.o2a()&&n.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.x9e.continueWith(()=>{const qb=this.x9e.result,Wb=qb.yCa,Xc=qb.bdd;Xc.continueWith(()=>{Wb.continueWith(()=>{this.bdf&&this.bdf.addQosPillar("RealTimeCoauth");this.rql(Wb.result,Xc.result);this.pTb.Gg(null)})})});this.hnf.continueWith(()=>
{this.nDc=this.hnf.result;this.nDc.f6a(Object(h.a)(this,this.$wk,"onRtcConnection"));this.nDc.WBa(Object(h.a)(this,this.Lrk,"onCoauthorBootReceived"))});this.HOa.continueWith(()=>{this.DK=this.HOa.result;this.DK.jrb(Object(h.a)(this,this.Agd,"onUsersUpdatedEventListener"));0<this.DK.l9a().length&&this.V0()});return this.pTb.task}H_f(){return this.oi.Io(qa.a.Xlb)?this.oi.hh(qa.a.Xlb):F.a.jCa?window.performance.timing.fetchStart:-1}$wk(qb,Wb){this.o8e||2!==Wb.newState||(qb=this.H_f(),qb=Date.now()-
qb,Wb={},Wb.clientId=this.f_g,Wb.bootTime=qb,this.o8e=!0,this.nDc.Zfa(15,Wb))}Lrk(qb,Wb){if(15===Wb.type){qb=Date.now();Wb=Wb.Eza;var Xc=Wb.bootTime;this.T7d(Wb.clientId).Cvf=qb-Xc}}Agd(){this.V0()}V0(){const qb=Date.now();var Wb=this.DK.l9a();const Xc=new Q.a;for(const xb of Wb)this.qgf.contains(xb.clientId)||(this.qgf.add(xb.clientId),Xc.add(xb.clientId));if(0<Xc.count)for(let xb of Xc)Wb=this.T7d(xb),Wb.mGf||(Wb.lGf=qb)}gwk(qb){qb=this.T7d(qb);qb.BDf||(qb.ADf=Date.now())}T7d(qb){return qb in this.Kyd?
this.Kyd[qb]:this.Kyd[qb]=new da(qb,this.g3h,this.GPh)}rql(qb,Wb=0){this.Uof=qb;this.Vof=Wb?Wb:(new Date).getTime()}hRi(qb,Wb,Xc,xb){Xc=Xc?Xc.getTime():(new Date).getTime();Wb in this.Elf?qb.L1():(xb=new ma(Wb,this.tkj(),Xc,this.MTc(this.f_g),this.MTc(Wb),this.M5a,this.K2a,xb,this.o2a),this.Elf[Wb]=xb,xb.xvd(qb))}tkj(){return 1===this.Uof?this.Vof:this.H_f()}MTc(qb){return this.nYh.MTc(qb)}}Object(I.a)(sa,"PresenceBootTelemetry",null,[1089]);var ia=d(179),Na=d(70),Ca=d(346),ha=d(57),Ba=d(291);class va{get name(){return"Common.App.CoauthTelemetry"}Zb(qb){qb.register(e,
"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().oa(()=>new e(Ba.a.$u(qb.Ja("Common.IPeopleInfoProvider")),B.AFrameworkApplication.Xg));qb.register(u,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().oa(()=>new u(B.AFrameworkApplication.Ta,Ba.a.$u(qb.Ja("Common.ICoauthoringTelemeryInfoProvider")),B.AFrameworkApplication.fa,ia.a.get_instance(),Ca.a.instance,Ba.a.$u(qb.Ja("Common.IPeoplesWell")),Ba.a.$u(qb.Ja("Common.IPeopleInfoProvider")),
e.Wxf,()=>this.eAf()));qb.register(sa,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().oa(()=>new sa(Ba.a.$u(qb.Ja("Common.ICoauthoringTelemeryInfoProvider")),Ba.a.$u(qb.Ja("Common.IRealtimeChannelBasic")),Ba.a.$u(qb.Ja("Common.IPeopleInfoProvider")),qb.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Ca.a.instance,()=>this.eAf(),B.AFrameworkApplication.fa,null,y.Health.instance));qb.register(J,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().oa(()=>
new J(Ba.a.$u(qb.Ja("Common.IPeopleInfoProvider"))));qb.register(X,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().oa(()=>new X(Ba.a.$u(qb.Ja("Common.IPeopleInfoProvider")),Ba.a.$u(qb.Ja("Common.ISystemInitiatedFeedback")),B.AFrameworkApplication.fa,"{"+B.AFrameworkApplication.userSessionId+"}"))}init(){B.AFrameworkApplication.fa.gf(()=>{ha.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();ha.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();
B.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&ha.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();B.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&(ha.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),ha.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}eAf(){return F.a.jCa&&Ca.a.instance.Io(qa.a.Huc)?0<Ca.a.instance.hh(qa.a.Huc)[qa.a.Bvd]:!1}static main(){Na.a.instance.Dc(new va)}}Object(I.a)(va,
"CoauthTelemetryPackage",null,[2,3]);var ta=d(265),Fa=d(1205),pa=d(239),ka=d(470);class Ha{constructor(qb,Wb,Xc,xb,Rb){this.Jc=qb;this._clientId=Wb;this.hQh=Rb;this.hSh=Xc||(()=>null);this.iSh=xb||(()=>null)}get id(){return this.Jc.id}get zFc(){return this.Jc.zFc}get DFc(){return this.Jc.DFc}get CFc(){return this.Jc.CFc}get BFc(){return this.Jc.BFc}get AFc(){return this.Jc.AFc}get FFc(){return this.Jc.FFc}get RNd(){return this.Jc.RNd}get aNb(){return this.Jc.aNb}get Sqd(){return this.Jc.Sqd}get sdd(){return this.Jc.sdd}get clientId(){return this._clientId}get Hta(){return this.hSh}get N3(){return this.iSh}get rNi(){return this.hQh}static createInstance(qb,
Wb,Xc,xb,Rb=!1){return new Ha(qb,Wb,Xc,xb,Rb)}}Object(I.a)(Ha,"PeoplesWellSettings",null,[]);var Ya=d(28);class Ka{constructor(qb){this.wj=qb}get yCa(){return this.wj.yCa}get bdd(){return this.wj.bdd}}Object(I.a)(Ka,"CoauthoringTelemetryInfoProvider",null,[465]);var Pa=d(919),Oa=d(78),oa=d(118),Xa=d(779),Hb=d(577);class Ob{constructor(qb,Wb,Xc,xb,Rb){this.QFb=new Oa.a;this.uz=null;this.wj=qb;this.Meb=Xc;this.kJ=xb;this.kJ.gPd(Object(h.a)(this,this.Led,"onEditorTableUpdate"));this.Y7j=B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.dAe=Rb;Wb&&Wb.execute(wc=>{this.uz=wc})}dispose(){this.QFb&&(oa.a.Xmd([this.QFb]),this.QFb=null);this.kJ.bih(Object(h.a)(this,this.Led,"onEditorTableUpdate"))}jrb(qb){this.QFb.addHandler("UsersUpdatedEvent",qb)}qRe(qb){this.QFb.removeHandler("UsersUpdatedEvent",qb)}l9a(){return this.rZf(!1)}Y2i(){return this.rZf(!0)}rZf(qb){const Wb=[];this.wj.Hlb(this.wj.bD).returnValue||Ya.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.wj.bD);var Xc=
null;this.uz&&(Xc=this.uz.gRc());const xb=this.dAe.n1f();let Rb=!1;for(const wc of this.wj.g_)qb&&Ob.GHc(xb,wc.EmailAddress)?Rb=!0:Array.add(Wb,this.OFi(wc,Xc));Xc={};Xc.fExcludeCurrent=qb;Xc.fCurrentExcluded=Rb;Xc.CurrentID=this.wj.bD;Xc.EditorCount=this.wj.g_.length;Xc.IsRtcNull=!this.uz;Xc.UserCount=Wb.length;Ya.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",V.c(Xc));return Wb}OFi(qb,Wb){const Xc=this.Meb.Gta(new Pa.a(qb.EmailAddress,void 0,qb.Name),qb.ColorIndex,qb.ID,1),xb=new Xa.a;
xb.c0a(0);let Rb=0,wc=!1,ud=!1;if(Wb&&qb.ID in Wb){xb.c0a(1);if(this.Y7j){const uc=Wb[qb.ID];uc&&uc.capabilities&4&&xb.c0a(4);wc=!0;uc&&(Rb=uc.capabilities,ud=uc.isAnonymous)}delete Wb[qb.ID]}Ya.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",qb.ID,Xc,xb.yda(1),xb.yda(4),this.wj.bD,
!qb.EmailAddress,Rb,wc,ud);return new Hb.a(qb.ID,qb.Name,Xc,xb,null,qb.EmailAddress,void 0,void 0,ud,void 0,void 0,qb.JoinCoauthTime)}Led(){Ya.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.QFb.raiseEvent("UsersUpdatedEvent",this)}static GHc(qb,Wb){return!!qb&&!!Wb&&qb.toLowerCase()===Wb.toLowerCase()}}Object(I.a)(Ob,"PeopleInfoProvider",null,[1086]);var eb=d(81),Eb=d(216),oc=d(135),Sb=d(315),qc=d(273);class $a extends Eb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(I.a)($a,"PeopleButtonProps",Eb.a,[]);var ab=d(764),Ib=d(47),gc=d(69);class Ta{constructor(qb){this.Kuc=new gc.a;this.iZd=null;this.clientId=qb}Pel(qb){this.gWk();this.p$k(qb);for(const Wb of qb)Wb.clientId!==this.clientId&&this.Ntf(Wb)}get gvd(){const qb=[];for(let Wb of this.Kuc.values){const Xc=this.ooh(Wb);Array.add(qb,Xc)}return qb}get axa(){return this.Kuc.count}$Od(qb,Wb){qb=qb.toUpperCase();
let Xc;({value:Xc}=this.Kuc.Uf(qb)).returnValue||(Xc=[],this.Kuc.$(qb,Xc));Array.add(Xc,Wb)}gWk(){this.Kuc=new gc.a}p$k(qb){for(const Wb of qb)if(Wb.clientId===this.clientId){this.iZd=Wb;break}}}Object(I.a)(Ta,"UserTracker",null,[1688]);class Ab extends Ta{constructor(qb,Wb){super(qb);this.jSh=Wb}Ntf(qb){qb.isAnonymous||!qb.email?this.$Od(qb.clientId,qb):this.iZd&&S.a.to().equals(this.iZd.email,qb.email)||this.$Od(qb.email,qb)}ooh(qb){let Wb=new Date(0),Xc=0<qb.length?qb[0]:null;for(const xb of qb)(qb=
this.jSh(xb.clientId))&&Wb.getTime()<qb.JAb.getTime()&&(Wb=qb.JAb,Xc=xb);return Xc}}Object(I.a)(Ab,"UniqueUserTracker",Ta,[]);class kc extends Ta{constructor(qb){super(qb)}Ntf(qb){this.$Od(qb.clientId,qb)}ooh(qb){return qb[0]}}Object(I.a)(kc,"UserInstanceTracker",Ta,[]);const fb=(qb,Wb,Xc)=>Xc?new Ab(qb,Wb):new kc(qb);var Qb=d(73),mb=d(669),Jb=d(37);class Ub{constructor(qb,Wb=null,Xc=null){this.DK=null;this.oMd=new m.a;this.Jc=qb;this.zhd=Wb;Xc&&Xc.continueWith(()=>{this.DK=Xc.result;this.DK.jrb(Object(h.a)(this,
this.V0,"onUsersUpdated"));this.Jkd()});new Hb.a(this.settings.clientId,"Anonymous user","#cccccc",new Xa.a(7));this.rZc=this.sEd=!0;this.WBd=this.eId=!1;this.R1=fb(this.settings.clientId,this.settings.N3,qb.rNi)}get settings(){return this.Jc}get OKj(){return B.AFrameworkApplication.fa?B.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get ahg(){return B.AFrameworkApplication.fa?B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):!1}s6i(){let qb;let Wb,Xc,xb,Rb;var wc=
this.t6i();this.R1.axa?1===this.R1.axa?(Wb=!0,Xc=this.settings.aNb.cluster,xb=this.settings.aNb.cMc,Rb=this.R1.gvd[0].color):(Wb=!0,Xc=this.settings.sdd.cluster,xb=this.settings.sdd.cMc,Rb=""):(Wb=!1,Rb=xb=Xc="");qb=wc[0];wc=wc.slice(1);return{yAk:qb,zAk:wc,uAk:Wb,tNl:Xc,wAk:xb,vAk:Rb}}t6i(){if(2<=this.R1.axa)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.R1.axa)];if(1===this.R1.axa){const qb=this.R1.gvd[0],Wb=this.settings.N3(qb.clientId);return Wb&&2===
Wb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,qb.userName]:[qb.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,qb.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}Enj(qb){return this.Fnj(qb)}VCf(qb,Wb,Xc){return Wb?this.jpi(Wb)?(qb=this.settings.N3(qb))&&2===qb.status?!1:!0:(Xc&&n.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(Xc&&n.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}ykj(qb){return qb.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}Fnj(qb){if(!qb.capabilities.yda(1))return this.ykj(qb);const Wb=qb.isReadOnly,Xc=this.settings.N3(qb.clientId);qb=this.settings.Hta(qb.clientId);if(!Xc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(Xc.status){case 1:return qb?Wb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.RAi(qb)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}oaj(qb){if(this.zhd.B0c)return this.zhd.eub(qb.email,"O365",B.AFrameworkApplication.gh,0)}tnj(qb){qb=this.settings.N3(qb.clientId);return!qb||qb&&1===qb.status?!0:!1}unj(qb){var Wb=String.format("buttonPeoplesWellUser-{0}",qb.clientId),Xc=qb.clientId,xb=this.Enj(qb);
const Rb=qb.userName,wc=qb.color;var ud=Object,uc=ud.assign,db=new $a,Yb=this.settings.FFc.toString(),Zc=this.settings.Sqd.cluster,Kb=this.settings.Sqd.cMc,Yc=this.$0f(),ec=qb.isAnonymous,rb;if(rb=[Rb],rb.length){var ac=new Sys.StringBuilder("STRARRY@");for(const Jc of rb)ac.append(Jc?Jc.length:0),ac.append(","),ac.append(Jc),ac.append(",");rb=ac.toString().slice(0,-1)}else rb=null;Wb=uc.call(ud,db,{Id:Wb,Command:Yb,LabelText:"{0}",Image32by32:Zc,Image32by32Class:Kb,MenuItemId:Xc,CommandValueId:Xc,
Alt:Rb,DisplayMode:Yc,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:xb,ImageBackColor:wc,IsAnonymous:ec,LabelTextUserGeneratedPlaceholderReplacements:rb,Upn:qb.email});B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.zhd&&(Xc=this.oaj(qb),xb=this.tnj(qb),Wb.ImageUrl=Xc,Wb.ActiveStatus=xb,Wb.JoinTimeInMS=qb.OFa,qb=this.VCf(qb.clientId,this.settings.Hta(qb.clientId),!1),Wb.CanJump=qb,""===Xc&&n.ULS.sendTraceTag(40969413,
302,50,"ImageURL collection failed"));return Wb}y$i(){return Object.assign(new Eb.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}$0f(){return this.OKj?"Initials":"Menu32"}vnj(qb){const Wb=[];for(const Xc of qb)qb=this.unj(Xc),Array.add(Wb,qb);return Wb}Xie(){return 0<this.R1.axa}RMk(qb){if(!this.sEd)return!0;this.rZc||(qb[mb.a.Visible]=!0);let Wb,Xc,xb,Rb,wc;({yAk:Wb,
zAk:Xc,uAk:xb,wAk:Rb,vAk:wc}=this.s6i());qb[mb.a.LabelText]=Wb;Xc&&Xc.length&&(qb[mb.a.LabelTextUserGeneratedPlaceholderReplacements]=Xc);qb[mb.a.ImageIsVisible]=xb;qb[mb.a.Image16by16Class]=Rb;qb[mb.a.ImageBackColor]=wc;this.sEd=!1;return!0}GFk(qb){if(0>=this.R1.axa)return!1;var Wb=this.Hol(this.R1.gvd),Xc=this.vnj(Wb);Wb=Object.assign(new Sb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});Xc=Object.assign(new qc.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.$0f(),
ControlList:Xc});B.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.zhd&&(Xc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,Xc.TitleId="menuCoauthorsTitle",Xc.Theme="Light");Array.add(Wb.MenuSectionList,Xc);B.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.Oo&&(Xc=[],Array.add(Xc,this.y$i()),Xc=Object.assign(new qc.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",
ControlList:Xc}),Array.add(Wb.MenuSectionList,Xc));B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.Oo?qb.MenuItems=Wb:qb.PopulationXML=oc.l(Wb);return!0}eHl(qb){n.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");qb=qb.MenuItemId;if(!qb)return!1;const Wb=this.settings.Hta(qb);if(!this.VCf(qb,Wb,!0))return!1;this.XXj(qb,Wb);return!0}PSk(){const qb=this.a3i();this.R1.Pel(qb);this.rZc&&1<=this.R1.axa&&(n.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),
this.rZc=!1);this.sEd=!0}V0(){this.WBd||(window.setTimeout(()=>{this.Jkd();this.WBd=!1},3E3),this.WBd=!0)}a3i(){let qb;qb=this.Z2i()||[];for(const Wb of qb)this.b5k(Wb);return qb}b5k(qb){qb.clientId||(qb.clientId=D.a.create().toString());qb.userName||(qb.userName="Anonymous user");qb.capabilities||(qb.capabilities=new Xa.a);qb.color||(qb.color="#cccccc");qb.OFa||(qb.OFa=0)}Hol(qb){const Wb=[];Array.addRange(Wb,qb);Wb.sort(Ub.jAk);return Wb}VUk(){B.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&
!this.eId&&(B.AFrameworkApplication.Ta.dT(Jb.a.pGf)&&ab.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||B.AFrameworkApplication.Ta.ra(Jb.a.pGf,Qb.a.frame,Object(h.a)(this,this.Mrk,"onCoauthorGalleryFirstRender"),96));this.WUk();this.eId=!0;this.Jkd()}Mrk(qb,Wb,Xc,xb,Rb){this.oMd.PM(Rb.RenderTime);return 32}get Qsd(){return this.oMd.task}Jkd(){if(!this.eId&&(this.oMd.PM((new Date).getTime()),n.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),
this.ahg))return;this.PSk();this.ahg&&this.rZc?B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||ka.a.aaa("ribbon","coauthorGallery"):(B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(ka.a.baa("ribbon","coauthorGallery"),ka.a.Z$("ribbon","coauthorGallery")),this.QSk())}dispose(){this.DK&&(this.DK.qRe(Object(h.a)(this,
this.V0,"onUsersUpdated")),this.DK=null)}static jAk(qb,Wb){return qb.capabilities.yda(1)&&Wb.capabilities.yda(1)||!qb.capabilities.yda(1)&&!Wb.capabilities.yda(1)?Ib.a.localeCompare(qb.userName,Wb.userName):qb.capabilities.yda(1)?-1:1}}Object(I.a)(Ub,"APeoplesWell",null,[1576,106]);var tb=d(41);class Bc extends Ub{constructor(qb,Wb,Xc=null,xb=null){super(qb,Xc,xb);this.oAa=()=>!0;this.Ca=Wb}TMk(qb){return this.RMk(qb)}IFk(qb){return this.GFk(qb)}gHl(qb){return this.eHl(qb)}zQ(qb,Wb,Xc,xb,Rb,wc){qb=
!1;switch(Xc){case 1:qb=Rb(xb);break;case 2:qb=wc(xb)}return Bc.Aii(qb)}mLj(qb,Wb,Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,()=>this.Xie(),this.oAa)}SMk(qb,Wb,Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,Object(h.a)(this,this.TMk,"queryUsersProxy"),this.oAa)}HFk(qb,Wb,Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,this.oAa,Object(h.a)(this,this.IFk,"populateFlyoutContentsProxy"))}Cvi(qb,Wb,Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,this.oAa,this.oAa)}Bvi(qb,Wb,Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,this.oAa,this.oAa)}fHl(qb,Wb,
Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,this.oAa,Object(h.a)(this,this.gHl,"userButtonClickProxy"))}fEk(qb,Wb,Xc,xb,Rb){return this.zQ(qb,Wb,Xc,Rb,this.oAa,()=>{this.Jkd();return!0})}WUk(){this.Ca.ya(this.settings.zFc,tb.a.application,Object(h.a)(this,this.mLj,"isControlEnabledHandler"));this.Ca.ra(this.settings.DFc,tb.a.application,Object(h.a)(this,this.SMk,"queryUsersHandler"),96);this.Ca.ra(this.settings.BFc,tb.a.application,Object(h.a)(this,this.Cvi,"commandMenuOpenHandler"),96);this.Ca.ra(this.settings.AFc,
tb.a.application,Object(h.a)(this,this.Bvi,"commandMenuCloseHandler"),96);this.Ca.ra(this.settings.CFc,tb.a.application,Object(h.a)(this,this.HFk,"populateFlyoutContentsHandler"),96);this.Ca.ya(this.settings.FFc,tb.a.application,Object(h.a)(this,this.fHl,"userButtonClickHandler"));this.Ca.ra(this.settings.RNd,tb.a.application,Object(h.a)(this,this.fEk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static Aii(qb){return qb?32:8}}Object(I.a)(Bc,"ABox4PeoplesWell",Ub,[]);var Gb=d(733);
class Hc extends Sys.EventArgs{constructor(qb){super();this.controlId=qb}}Object(I.a)(Hc,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class $b extends Bc{constructor(qb,Wb,Xc,xb,Rb,wc,ud,uc,db,Yb,Zc,Kb,Yc,ec,rb,ac,Jc,Db){super(qb,Wb,ac,Db?E.Task.Rt(Db):null);this.uz=null;this.tve=!1;if(!Rb)throw Error.argumentNull("coauthStateGetter");if(!wc)throw Error.argumentNull("appFrame");if(!ud)throw Error.argumentNull("taskManager");this.wj=Rb;this.Rb=wc;this.zb=ud;xb&&xb.execute(dd=>{this.uz=dd});
Xc&&Xc.execute(dd=>{dd.hai(Object(h.a)(this,this.SIk,"presenceChanged"))});this.oc=uc;this.Ge=db;this.he=Yb;this.oec=Yc;this.Y5j=Zc;this.Meb=Kb;this.aCb=ec;this.kU=rb;this.dAe=Jc;this.vIg=Db;this.Qsd.continueWith(()=>{this.kU.dSi(this.Qsd.result)})}XXj(qb,Wb){let Xc=null;({data:Xc}=this.i3e(Wb)).returnValue&&Xc&&Xc.ak&&(Ya.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",qb,Xc.ak,this.wj.bD),(qb=this.oc.kka(Xc.ak))?(this.Ge.Dod(),this.Ge.GJ(qb.le)):
Ya.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",Xc.ak))}i3e(qb){let Wb;Wb=null;if(!qb)throw Ya.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.wj.bD),Error.argumentNull("presence");return qb?(Wb=Gb.a.ALc(qb.data))?{returnValue:!0,data:Wb}:{returnValue:!1,data:Wb}:{returnValue:!1,data:Wb}}jpi(qb){let Wb=null;return({data:Wb}=this.i3e(qb)).returnValue&&Wb&&Wb.ak?!0:!1}Z2i(){if(this.vIg)return this.vIg.Y2i();
Ya.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const qb=this.$2i();0<qb.length&&Ya.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",qb.length);return qb}$2i(){const qb=[],Wb=this.dAe.n1f();this.wj.Hlb(this.wj.bD).returnValue||Ya.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.wj.bD);let Xc=null;this.uz&&(Xc=this.uz.gRc());var xb=B.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var Rb of this.wj.g_){var wc=this.Meb.Gta(new Pa.a(Rb.EmailAddress,void 0,Rb.Name),Rb.ColorIndex,Rb.ID,1),ud=new Xa.a;ud.c0a(0);let uc=0,db=!1;if($b.GWj(Rb.ID,Xc)){ud.c0a(1);if(xb){let Yb=Xc[Rb.ID];Yb&&(uc=Yb.capabilities);db=!0;Yb&&Yb.capabilities&4&&ud.c0a(4)}delete Xc[Rb.ID]}$b.GHc(Wb,Rb.EmailAddress)||(Array.add(qb,new Hb.a(Rb.ID,Rb.Name,wc,ud,null,Rb.EmailAddress)),Ya.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
Rb.ID,wc,ud.yda(1),ud.yda(4),this.wj.bD,!Rb.EmailAddress,uc,db))}if(!xb&&this.oec&&Xc)for(let uc in Xc)xb=Xc[uc],!$b.GHc(Wb,xb.email)&&xb&&xb.userName&&(Rb=new Xa.a,Rb.c0a(1),xb.capabilities&4&&Rb.c0a(4),wc=this.aCb.D6d(xb.email)||xb.email,ud=this.Meb.Gta(new Pa.a(wc,void 0,xb.userName),null,xb.clientId,1),Array.add(qb,new Hb.a(xb.clientId,xb.userName,ud,Rb,null,wc)),Ya.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
xb.clientId,ud,Rb.yda(1),Rb.yda(4),this.uz.clientId,!xb.email,xb.capabilities));return qb}RAi(qb){let Wb=null,Xc=" ";({data:Wb}=this.i3e(qb)).returnValue&&Wb&&Wb.ak&&(qb=this.oc.kka(Wb.ak))&&(Xc=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,qb.le+1));return Xc}SIk(){this.Rb.Qt.oFa?this.tve||(this.zb.Db(new eb.a(2,1,0,Object(h.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.tve=!0):this.Ca.processAction(Jb.a.k7a,2)}QSk(){this.he.UOk(new Hc(this.settings.id,
!0));const qb=1<this.R1.axa||1===this.R1.axa&&this.R1.gvd[0].clientId!==this.settings.clientId;this.Y5j.execute(Wb=>{qb&&this.kU&&this.kU.w3j();Wb.kPb()});qb&&this.kU.Zh(14,Date.now())}handlePendingRefresh(){this.tve=!1;this.Ca.processAction(Jb.a.k7a,2)}dispose(){super.dispose()}static GWj(qb,Wb){return Wb&&qb in Wb?!0:!1}static GHc(qb,Wb){return!!qb&&!!Wb&&qb.toLowerCase()===Wb.toLowerCase()}}Object(I.a)($b,"PowerPointPeoplesWell",Bc,[]);class lc{constructor(qb){this.zgc=null;qb.execute(Wb=>{this.zgc=
Wb})}Hta(qb){return this.zgc?this.zgc.Hta(qb):null}N3(qb){return this.zgc?this.zgc.N3(qb):null}}Object(I.a)(lc,"PresenceUserInfoGetterProxy",null,[1074]);var Vb=d(35);class ic{constructor(){this.U4=this.kJ=this.nh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}Zb(qb){ic.rcc=Date.now();this.K=qb;this.U4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.U4.kEa(6,this.name);this.K.register(1074,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().oa(()=>new lc(this.K.Ja("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(465,"Common.ICoauthoringTelemeryInfoProvider").ma().oa(()=>new Ka(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Ob,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().oa(()=>new Ob(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Ja("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(Vb.a("PeoplesBaseUlrConfiguredForPods")&&(qb=this.K.resolve("Common.App.People.IExternalPeopleAPI"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").vg)){const Wb=this.K.resolve("Common.IAppSettingsManager").Ga("368");qb.f8g(Wb+"p")}Ya.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.presence1",
null,()=>d.e(4).then(d.bind(null,1243)));else{const qb=Fa.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1243)));pa.a.ey(qb)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");B.AFrameworkApplication.PA.RDa?(this.kJ=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),ka.a.aaa("ribbon","coauthorGallery"),this.kJ.fPd(Object(h.a)(this,this.peg,"initializePeoplesWellHandler"))):this.oeg()}peg(){try{B.AFrameworkApplication.PA.RDa||
(this.oeg(),this.kJ.UQe(Object(h.a)(this,this.peg,"initializePeoplesWellHandler")))}catch(qb){Ya.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",qb)}}oeg(){const qb=this.nh.zu("peoplewell");this.ZEj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);
this.nh.Fu(qb)}ZEj(qb,Wb,Xc,xb,Rb,wc){var ud=this.K.resolve("PowerpointPresence.IPresencePerfLogger");ud.Zh(10,ic.rcc);ud.Zh(9,ic.Lgc);ud.Zh(11,(new Date).getTime());ud=Date.now();const uc=ta.CuiHelper.jfj(B.AFrameworkApplication.rm,B.AFrameworkApplication.rm,B.AFrameworkApplication.rm);qb=Ha.createInstance(uc,wc,Object(h.a)(qb,qb.Hta,"getUserPresence"),Object(h.a)(qb,qb.N3,"getUserStatusInfo"),!0);(wc=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||Ya.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
Ya.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const db=new $b(qb,Wb,this.K.Ja("PowerpointPresence.IPresenceManager"),this.K.Ja("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),Xc,xb,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ja("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),
Rb.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),wc);db.VUk();this.K.register($b,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().oa(()=>db);this.K.resolve("Common.IPeoplesWell");this.K.Ja("Box4.IBox4BridgeCommandUi").execute(Yb=>{Yb.kPb()});Ya.a.J(8958615,
814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-ud);this.K.resolve("PowerpointPresence.IPresencePerfLogger").iSi()}dispose(){}static main(){ic.Lgc=Date.now();if(B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const qb=new ic;qb.Zb(ha.a.instance);qb.init()}else Na.a.instance.Dc(new ic)}}ic.Lgc=0;ic.rcc=0;Object(I.a)(ic,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");va.main();Type.registerNamespace("RealtimePresenceUI");ic.main()},733:function(I,Y,d){I=d(0);var h=d(63);class e{constructor(m,z,B){this.slideId=m;this.shapes=z;this.sn=B}}Object(I.a)(e,"SerializablePresenceData",null,[]);d.d(Y,"a",function(){return n});class n{constructor(m,
z,B=0){if(!n.isValid(m))throw Error.create("Invalid Presence Data");this.uB=m;this.nad=z;this.LSg=B?B:++n.NIi}get ak(){return this.uB}get QU(){return this.nad}toString(){return this.uB.toString()+" : "+(this.QU&&this.QU.length?this.QU[0].toString():"")+" : "+this.LSg}Q9d(){return new e(this.uB.cvc,this.nad,this.LSg)}static isValid(m){return!!m}static ALc(m){return new n(new h.a(m.slideId),m.shapes,m.sn)}}n.NIi=0;Object(I.a)(n,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.presence.js.map