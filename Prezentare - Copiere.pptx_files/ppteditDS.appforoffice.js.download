'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1238:function(I,Y,d){d.r(Y);var h=d(0),e=d(18),n=d(387),m=d(273);class z{constructor(){this.eOh=new e.a}get LIc(){return this.eOh}jej(L){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",L);const M=new e.a;for(let Ja of this.LIc)for(let pb of Ja.Ejc)pb.id===L&&M.add(pb);return M}Uji(){var L=this.jej("ContextMenuText");if(L&&0<L.count){const M=Object.assign(new m.a,{ControlList:[]});for(let Ja of L)L=
Ja.ttc(),0<L.length&&Array.addRange(M.ControlList,L);return M}return null}isf(L){this.LIc.add(L)}uWk(L){for(let M of this.LIc)if(M.Dvf===L.Dvf){this.LIc.remove(M);break}}static HMi(L,M,Ja=null){L=z.j6i(L);0<L.length&&(z.Bod(L,!1),Ja&&Ja(M,L))}static j6i(L){const M=[];if(L&&L.Ejc&&0<L.Ejc.count)for(let Ja of L.Ejc)if(Ja.controls&&0<Ja.controls.count)for(let pb of Ja.controls)if(pb.menuItems&&0<pb.menuItems.count)for(let Tb of pb.menuItems)Array.add(M,Tb.id);return M}static Bod(L,M){if(L.length){var Ja=
[];for(const pb of L)Ja.push(appChrome.actions.updateControlEnabledDisabledState(pb,M));appChrome.api.dispatch(Ja)}}}Object(h.a)(z,"ContextMenuExtensibilityCache",null,[873,874]);var B=d(27),v=d(373),y=d(108),A=d(70),E=d(14);class u{constructor(L,M,Ja){this._id=L;this.GMh=M;this.MOh=Ja;this.Ufg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get PPd(){return this.GMh}get zvi(){return this.MOh}execute(L,M,Ja){Ja=Ja||{};Ja.commandMode=this.Ufg;M.invokeAppCommand(this.PPd,this.zvi,Ja,(pb,
Tb)=>{L.v4g(this.id,this.PPd,pb,Tb)})}}Object(h.a)(u,"AddinNativeActionBase",null,[769]);class J extends u{constructor(L,M){super(1,L,M);this.Ufg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(J,"AddinTakeSnapshotAction",u,[]);class G{fJf(L,M){let Ja=null;switch(L){case 1:Ja=new J(M,this.i5d().getNativeActionName(L));break;case 2:Ja=new u(2,M,this.i5d().getNativeActionName(L));break;case 3:Ja=new u(3,M,this.i5d().getNativeActionName(L))}return Ja}i5d(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(G,"AddinNativeActionManager",null,[728]);class S{invokeAppCommand(L,M,Ja,pb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(L,M,Ja,pb)}static getInstance(){S.Ka||(S.Ka=new S);return S.Ka}}S.Ka=null;Object(h.a)(S,"OSFAddinCommandsRuntimeManager",null,[727]);var P=d(78);class Q{constructor(){this.qQf=this.displayName=this.Q0b=this.VJ=this.sM=null;this.isUpgraded=!1}Qlg(L,M){return this.sM.getStoreType().toLowerCase()===L.toLowerCase()&&this.sM.getSolutionId().toLowerCase()===M.toLowerCase()}}
Object(h.a)(Q,"AddinCommandsResourceItem",null,[]);class D{constructor(){this.Swd=null;this.QBd=0;this.oDd=!1;this.Pa=new P.a;this.jTh=new e.a}w8h(L){this.Pa.addHandler("AddinCommandsLoadingMessageChanged",L)}get QYb(){return this.Swd}oMb(L){L!==this.Swd&&(this.Swd=L,this.Pa.raiseEvent("AddinCommandsLoadingMessageChanged"))}E9k(){this.QBd++;this.QYb||this.oMb(CommonUIStrings.l_LoadingAddInsTitle)}lVe(){this.QBd--;this.S1c()&&(this.oDd?this.QYb!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.oMb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.oMb(null))}W$k(){this.oDd=!0;this.oMb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}REf(){this.oDd=!1;this.S1c()?this.oMb(null):this.oMb(CommonUIStrings.l_LoadingAddInsTitle)}S1c(){return 0>=this.QBd}get Jyb(){return this.jTh}P8a(L,M,Ja=0){for(let pb of this.Jyb)if(pb.Qlg(L,M)&&(!pb.VJ||pb.VJ.f2i===Ja))return pb;return null}Vsf(L,M,Ja,pb){const Tb=new Q;Tb.sM=L;Tb.VJ=M;Tb.Q0b=Ja;Tb.displayName=pb;this.Jyb.add(Tb)}v6h(L,M,Ja,pb){const Tb=new Q;Tb.sM=L;Tb.VJ=M;Tb.Q0b=null;Tb.qQf=Ja;Tb.displayName=
pb;this.Jyb.add(Tb)}cWk(L,M){let Ja=0;for(let pb of this.Jyb)pb.sM.getStoreType()===L&&pb.sM.getSolutionId()===M?this.Jyb.removeAt(Ja):Ja++}static getInstance(){D.Ka||(D.Ka=new D);return D.Ka}}D.Ka=null;Object(h.a)(D,"AddinCommandsResourceManager",null,[]);var O=d(209),X=d(448),N=d(172),aa=d(142);class V extends Sys.EventArgs{constructor(){super();this.VJ=this.Iu=null}}Object(h.a)(V,"InsertionParamEventArgs",Sys.EventArgs,[]);class ca{constructor(L,M,Ja,pb,Tb,Wc){this.qx=L;this.Iu=M;this.vaa=Ja;this.displayName=
Tb;this.zog=Wc}}Object(h.a)(ca,"PostLaunchAddinCommandsParameters",null,[]);var fa=d(36),ma=d(47),da=d(1200);class qa{constructor(L,M,Ja,pb=null){this.epc=B.AFrameworkApplication.fa.Ga("RoamingServiceHandlerWebServiceBase");this.appName=L;this.RSb=M;this.OSb=Ja;this.LVb=pb}$Oc(L){this.GTi(L,Object(E.a)(this,this.mEa,"getRequestSuccessCallback"),Object(E.a)(this,this.ika,"getRequestFailureCallback"))}GTi(L,M,Ja){const pb=new Sys.StringBuilder(this.epc);pb.append("RoamingServiceHandler.ashx?action=");
pb.append("getAddinTeachingCalloutSettings");pb.append("&");pb.append(this.o9d(L));pb.append("&");pb.append(B.AFrameworkApplication.gh);B.AFrameworkApplication.Ke.mj(pb.toString(),1,null,null,!0,2,M,Ja,null)}nvb(L){this.NTi(L)}NTi(L){var M=new Sys.StringBuilder(this.epc);M.append("RoamingServiceHandler.ashx?action=");M.append("saveAddinTeachingCalloutSettings");M.append("&");M.append(B.AFrameworkApplication.gh);M=M.toString();L=fa.c(L);B.AFrameworkApplication.Ke.mj(M,2,L,null,!0,4,null,Object(E.a)(this,
this.jaa,"postRequestFailureCallback"),null)}mEa(L){let M=!1,Ja=null;try{if(0<L.data.Sd.length){const pb=Object(da.a)(Object,fa.a(L.data.Sd)),Tb=pb?pb[this.appName]:null;Tb&&(Ja=Object(da.a)(Object,fa.a(Tb.toString())))}M=!0}catch(pb){this.ika(null)}M&&this.RSb&&this.RSb(Ja)}ika(L){this.OSb&&this.OSb(L?L.data:null)}jaa(L){this.LVb&&this.LVb(L?L.data:null)}o9d(L){const M=new Sys.StringBuilder("requestedsettings=");for(let Ja=0;Ja<L.count;Ja++)M.append(L.ga(Ja)),Ja<L.count-1&&M.append(";");return M.toString()}}
Object(h.a)(qa,"AddinTeachingUIRoamingRequestHandler",null,[]);var F=d(182);class sa{constructor(L,M,Ja){this.dpc=!1;this.mba=null;this.Pa=L;this.tTb=M;this.lQb=Ja}sOd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(E.a)(this,this.XHe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(E.a)(this,this.lHe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(E.a)(this,this.XGe,"onCloseButtonClickedEventHandler"),
!0),window.addEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.Mjc,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}XHe(){const L={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:sa.tQ(this.tTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.lQb&&this.lQb.tabs&&!this.lQb.tabs[0].isOfficeTab&&(L["SDX.FeatureFlags"]="NonOfficeTab");aa.a.sendTelemetryEvent(Object.assign(new F.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(L)}));this.OIa();this.lQb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.lQb,()=>{const M=new V;M.Iu=this.tTb;this.Pa.raiseEvent(O.a.sne,M)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}XGe(){const L={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:sa.tQ(this.tTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(L)}));this.OIa()}lHe(){const L={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:sa.tQ(this.tTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(L)}));this.OIa()}Mjc(L){if(L&&(L=L.detail)&&L.id&&this.Hie(L.id)){const Ja=
(L.action||"").toLowerCase();if(L.success&&"opened"===Ja){var M={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:sa.tQ(this.tTb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(M)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.OIa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(E.a)(this,this.Mjc,"onCampaignLaunchedHandler"),!0)}else try{M=JSON.stringify(L),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+M)}catch(pb){M="id : "+L.id+" telemetryEventName: "+L.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+M+" Error: "+(pb?pb.toString():""))}}}Hie(L){L=ma.a.qg(L);return-1!==L.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==L.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==L.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==L.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==L.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==L.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}G_a(L){const M=B.AFrameworkApplication.fa.Ga("WebAppShortName");if(M){const Ja={},pb={};pb.LastTeachingUIShowTime=(new Date).toUTCString();pb.AddinHasShown=L;Ja[M]=fa.c(pb);this.mba=new qa(M,null,null,Object(E.a)(this,this.jaa,"postRequestFailureCallback")),this.mba.nvb(Ja),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}OIa(){if(!this.dpc){const L=window.g_roamingAddinList;L&&(this.G_a(L),this.dpc=!0)}}jaa(L){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",L?L.oe:-1)}static tQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}}Object(h.a)(sa,"PrivateCatalogTeachingCalloutHandler",null,[]);var ia=d(15),Na=d(16),Ca=d(966);class ha{constructor(){this.addinId=
null;this.targetType=0;this.solutionId=null}}Object(h.a)(ha,"AddinAbstract",null,[]);class Ba extends Sys.EventArgs{constructor(L){super();this.solutionId=L.solutionId;this.assetId=L.assetId;this.storeType=L.storeType;this.storeId=L.storeId;this.assetStoreId=L.assetStoreId;this.targetType=L.targetType;this.width=L.width;this.height=L.height;this.displayName=L.displayName;this.version=L.version}}Object(h.a)(Ba,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var va=d(125);class ta{constructor(L){this.orb=
this.Iu=null;this.dpc=!1;this.cNa=this.Jvc=this.eKa=this.vl=this.mba=this.n1=null;this.Ip=L}get appName(){return B.AFrameworkApplication.fa.Ga("WebAppShortName")}get fvf(){this.mba||(this.mba=new qa(this.appName,Object(E.a)(this,this.mEa,"getRequestSuccessCallback"),Object(E.a)(this,this.ika,"getRequestFailureCallback"),Object(E.a)(this,this.jaa,"postRequestFailureCallback")));return this.mba}get LPa(){this.Jvc||(this.Jvc=new e.a);return this.Jvc}set LPa(L){this.Jvc=L}get t7a(){this.cNa||(this.cNa=
new e.a);return this.cNa}set t7a(L){this.cNa=L}sOd(L,M){window.addEventListener?(this.Iu=L,this.orb=M,window.addEventListener("LaunchAddinTaskpane",Object(E.a)(this,this.XHe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(E.a)(this,this.lHe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(E.a)(this,this.XGe,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.Mjc,"onCampaignLaunchedHandler"),
!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}ayl(L,M,Ja,pb){this.vl=L;this.LPa=M;this.t7a=Ja;this.eKa=pb;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",M?M.count.toString():"null",Ja?Ja.count.toString():"null");0<this.LPa.count||0<this.t7a.count?(L=new e.a,L.add(this.appName),this.fvf.$Oc(L)):this.eKa(new e.a,null)}XHe(){const L=new ia.ScriptSharpLegacyMap;this.orb&&
this.orb.tabs&&!this.orb.tabs[0].isOfficeTab&&L.$("SDX.FeatureFlags","NonOfficeTab");this.$Fa(ta.tQ(this.Iu),"ClickOnLaunch",L);this.OIa();this.orb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.orb,()=>{const M=new V;M.Iu=this.Iu;this.Ip.raiseEvent(O.a.sne,M)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}XGe(){this.$Fa(ta.tQ(this.Iu),"ClickOnClose");this.OIa()}lHe(){this.$Fa(ta.tQ(this.Iu),"ClickOnDismiss");this.OIa()}Mjc(L){if(L&&
(L=L.detail)&&L.id&&this.Hie(L.id)){const M=(L.action||"").toLowerCase();if(L.success&&"opened"===M)this.$Fa(ta.tQ(this.Iu),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.OIa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(E.a)(this,this.Mjc,"onCampaignLaunchedHandler"),!0);else{let Ja;try{Ja=JSON.stringify(L),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ja)}catch(pb){Ja=
"id : "+L.id+" telemetryEventName: "+L.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ja+" Error: "+(pb?pb.toString():""))}}}}Hie(L){L=ma.a.qg(L);return-1!==L.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==L.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==L.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==L.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==L.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==L.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}G_a(L){if(this.appName){const M=
{},Ja={};Ja.LastTeachingUIShowTime=(new Date).toUTCString();Ja.AddinHasShown=L;M[this.appName]=fa.c(Ja);this.fvf.nvb(M);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}OIa(){if(!this.dpc){const L=window.g_roamingAddinList;L&&(this.G_a(L),this.dpc=!0)}}mEa(L){L?this.WXe(L)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),
this.n1="AddinHasShown"in L&&L.AddinHasShown?L.AddinHasShown.toString():null,this.D0b()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.eKa(this.LPa,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.n1=null,this.D0b())}ika(L){n.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",L?L.oe:-1);this.eKa(this.LPa,null)}jaa(L){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",
L?L.oe:-1)}D0b(){const L=this.r_d();0===L.targetType?(L.solutionId?this.rNe(L):this.$Fa(null,"NoSolutionId"),this.yHh(L),this.eKa(this.LPa,null)):this.eKa(this.LPa,L);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",L.addinId)}rNe(L){const M=new Ca.a;M.callbackFunc=Ja=>{if(Ja.errorCode){this.$Fa(L.solutionId,"FailToGetAppDetails");var pb=window.g_roamingAddinList;pb&&this.G_a(pb)}else if(Ja.value)for(pb of Ja.value)if(Ja=pb[1],Ja===L.solutionId){const Tb={};Tb.solutionId=Ja;Tb.assetId=
pb[5];Tb.storeType=pb[12];Tb.storeId=pb[11];Tb.assetStoreId=pb[6];Tb.targetType=pb[3];Tb.width=pb[7];Tb.height=pb[8];Tb.displayName=pb[0];Tb.version=pb[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",L.solutionId);pb=new Ba(Tb);this.Ip.raiseEvent(O.a.jYe,pb);break}};M.storeType=OSF.StoreTypeEnum.PrivateCatalog;M.fromInsertDialog=!1;M.refresh=!1;this.vl.queryEntitlementDetails(M)}WXe(L){if("LastTeachingUIShowTime"in L){if(L=+new Date-+new Date(L.LastTeachingUIShowTime.toString()),
L<B.AFrameworkApplication.fa.rQ("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",L),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}r_d(){let L=new Na.a(new ha,0),M=new Na.a(new ha,0),Ja=0,pb=0,Tb=0;var Wc=new e.a;for(var sd of this.LPa)Wc.add(sd);for(let Ed of this.t7a)Wc.add(Ed);for(let Ed of Wc)if(!("excatalog"!==Ed.storeType||va.b(Ed.installTimeInMS)||!Ed.installTimeInMS||
Ed.installTimeInMS<=B.AFrameworkApplication.fa.rQ("DateTimeInMSForNewAddin",16409952E5))){Wc=ta.T4b(Ed);if(this.n1&&(sd=this.n1.split(","),0<sd.length&&Array.contains(sd,Wc))){Tb++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Wc.startsWith("private_")?(L=ta.i3f(Ed,L),pb++):(M=ta.i3f(Ed,M),Ja++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",pb,Ja,Tb);return 0<M.value?M.key:
0<L.value?L.key:Object.assign(new ha,{addinId:null,targetType:-1,solutionId:null})}$Fa(L,M,Ja=null){L={["AppTeachingUICalloutAction"]:M,["SDX.Id"]:L,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ja)for(let pb of Ja.keys)L[pb]=Ja.ga(pb);aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(L)}))}yHh(L){L&&(window.g_roamingAddinList=this.n1?this.n1+","+L.addinId:L.addinId)}static tQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.storeType,L.assetId,null,null,L.storeId)}static i3f(L,M){return M.value<L.installTimeInMS?new Na.a(Object.assign(new ha,{addinId:ta.T4b(L),targetType:L.targetType,solutionId:L.solutionId}),L.installTimeInMS):M}static T4b(L){return Telemetry.PrivacyRules.IsPrivateAddin(L.storeType,L.assetId,null,null,L.storeId)?"private_"+L.installTimeInMS:L.solutionId}}Object(h.a)(ta,"PrivateCatalogTeachingCalloutHandler2",null,[]);class Fa{constructor(L){this.Hgf=null;this.bef=L}get qVa(){return this.Hgf}Xqb(L,
M=null){this.bef.Xqb(L,M);this.Hgf=L}NQe(L){this.bef.NQe(L)}}Object(h.a)(Fa,"RibbonExtensibilityManagerWithChangeDetection",null,[900]);var pa=d(80);const ka=()=>{const L=pa.a.fxb(window.location.href.toLowerCase(),"wdomexsrctype");return!!L&&"4"===L},Ha=()=>pa.a.fxb(window.location.href.toLowerCase(),"wdtpl"),Ya=()=>{const L=pa.a.fxb(window.location.href.toLowerCase(),"wdomexsrctype");return!!L&&"1"===L},Ka=L=>{let M=null;switch(L){case 0:M="omex";break;case 1:M="spcatalog";break;case 2:M="spapp";
break;case 3:M="filesystem";break;case 4:M="exchange";break;case 6:M="registry";break;case 7:M="inmemory";break;case 8:M="uploadfiledevcatalog";break;case 9:M="hardcodedpreinstall";break;case 10:M="excatalog";break;case 16:M="wopicatalog"}return M},Pa=L=>{let M=-1;switch(L.toLowerCase()){case "omex":M=0;break;case "spcatalog":M=1;break;case "spapp":M=2;break;case "filesystem":M=3;break;case "exchange":M=4;break;case "registry":M=6;break;case "inmemory":M=7;break;case "uploadfiledevcatalog":M=8;break;
case "hardcodedpreinstall":M=9;break;case "excatalog":M=10;break;case "wopicatalog":M=16}return M};class Oa{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Oa,"AddInDataTransferObject",null,[]);class oa{constructor(L,M,Ja){this.Hvc=L;this.CMh=M;this.DMh=Ja}get uF(){return this.Hvc}get Z5h(){return this.CMh}get $5h(){return this.DMh}static bwb(L){return(L=L.gaa)?Object.assign(new Oa,{tabs:L.uF.toArray(),id:L.Z5h,title:L.$5h}):null}}Object(h.a)(oa,"OneLineRibbonExtensibility",null,[]);
class Xa{Xqb(L,M=null){if(L=oa.bwb(L)){appChrome.addInApi.dispatchActionsToInstallAddIn(L,M);for(const Ja of L.tabs)if(Ja.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(L,()=>{});break}}}NQe(L){(L=oa.bwb(L))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(L)}static NMi(L,M,Ja=null){L=Xa.ehj(L);0<L.length&&(Xa.Bod(L,!1),Ja&&Ja(M,L))}static ehj(L){const M=[];if(L&&(L=L.gaa,L.uF&&0<L.uF.count))for(let Ja of L.uF)if(Ja.groups&&0<Ja.groups.length)for(const pb of Ja.groups)if(pb.controls&&
0<pb.controls.length)for(const Tb of pb.controls)Array.add(M,Tb.id);return M}static Bod(L){if(L.length){var M=[];for(const Ja of L)M.push(appChrome.actions.updateControlEnabledDisabledState(Ja,!0));appChrome.api.dispatch(M)}}}Object(h.a)(Xa,"OneLineRibbonExtensibilityManager",null,[900]);class Hb{constructor(){this.Ver=1}}Object(h.a)(Hb,"CacheItem",null,[]);class Ob{constructor(){}}Object(h.a)(Ob,"AppsDataCacheManager",null,[895]);class eb{constructor(){new Ob(v.a.instance)}nph(L,M){L=O.a.N1f()+L;
v.a.instance.setItem(L,M.toString())}i5f(){var L=O.a.l5f();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",L);L=v.a.instance.getItem(L);return fa.a(L)}Tqh(L){const M=O.a.l5f();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",M);v.a.instance.setItem(M,fa.c(L))}Ojg(){return!!v.a.instance.localStorage}static get instance(){eb.Ka||(eb.Ka=new eb);return eb.Ka}}eb.Ka=null;Object(h.a)(eb,"AddInCommandsCacheManager",null,[865]);var Eb=d(540),oc=d(69);class Sb{static v2f(L){const M=new e.a;
if(Sb.iHf)for(var Ja of Sb.iHf)M.add(Ja);Ja=null;switch(L){case "Workbook":Ja=Sb.GKl;break;case "Document":Ja=Sb.tOi;break;case "Presentation":Ja=Sb.WIk}if(Ja)for(const pb of Ja)M.add(pb);return M}}Sb.iHf=["PrimaryCommandSurface","ContextMenu"];Sb.GKl=null;Sb.tOi=null;Sb.WIk=null;Object(h.a)(Sb,"ExtensionPointType",null,[]);class qc{constructor(L){this.Ojf=null;if(va.b(L))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.OMh=L}get Ejc(){return this.Ojf||(this.Ojf=new e.a)}get Dvf(){return this.OMh}}Object(h.a)(qc,"ContextMenuExtensibility",null,[872]);class $a{constructor(L,M=null,Ja=0){if(va.b(L))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.sXh=L;this.Q0h=M;this.QRh=Ja}get gaa(){return this.sXh}get startedNode(){return this.Q0h}get f2i(){return this.QRh}}Object(h.a)($a,
"RibbonExtensibility",null,[955]);class ab{constructor(L){this.QQh=L.entitlement}get entitlement(){return this.QQh}createActionContext(L,M){L={};L.ownerAddinInfo=this.entitlement;L.action=M;return L}}Object(h.a)(ab,"AddInCommandsContextProvider",null,[]);class Ib{constructor(L,M,Ja){this.v7e=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=L;this.eventBuilder=M;this.contextMenuBuilder=Ja}get addinInfo(){return this.v7e}FCi(L){return new ab(L)}createActionBuilder(L,
M){return OfficeExt.DefaultControlActionBinder.createActionBuilder(L,M.entitlement,M.manifest)}startApplyAddin(L){this.v7e=L;const M=this.FCi(L);this.actionBuilder=this.createActionBuilder(M,L)}endApplyAddin(){}X4d(L,M,Ja=0){return this.ribbonBuilder.uF&&0<this.ribbonBuilder.uF.count?new $a(this.O1i(L,M),this.addinInfo.startedNode,Ja):null}LYf(){var L=null;if(this.contextMenuBuilder.Hcd&&0<this.contextMenuBuilder.Hcd.count){L||(L=this.addinInfo.entitlement.solutionId);L=new qc(L);for(let M of this.contextMenuBuilder.Hcd)L.Ejc.add(M);
return L}return null}O1i(L,M){return this.ribbonBuilder.uF&&0<this.ribbonBuilder.uF.count?new oa(this.ribbonBuilder.uF,L,M):null}}Object(h.a)(Ib,"AddinCommandsBuilder",null,[]);class gc{constructor(L,M,Ja,pb,Tb,Wc,sd){this.Kkb=new oc.a;this.qx=L;this.vl=M;this.ES=Ja;this.apc=pb;this.OWd=Tb;this.BKa=Wc;this.lrb=sd;this.Maa=B.AFrameworkApplication.Aa.gV}x1c(L,M,Ja,pb,Tb,Wc,sd){const Ed=(ee,kb,cf,Tf)=>{Tb(ee,kb,cf,Tf);ee=Eb.a[this.qx]+kb.assetId;({value:kb}=this.Kkb.Uf(ee)).returnValue&&(kb.stop(),this.Kkb.remove(ee))};
if(0!==this.qx&&L){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",L.count);4===this.qx&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",pb)),this.Usi(L,pb),Wc());for(let ee of L)if(L=ee,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId))),this.aJh(L))if(sd&&L.requireConsent)sd(L,kb=>{try{if(this.Maa){const Tf=
Eb.a[this.qx]+kb.solutionId,zg=this.Maa.Ci("ComponentAttach",Tf);this.Kkb.$(Tf,zg)}const cf=this.BKa.P8a(kb.storeType,kb.solutionId);6!==this.qx&&(cf&&(this.GJc(cf),cf.sM.purge(!1)),this.vl.insertOsfControl(this.wmc(kb,M,Ja,Ed)),cf&&this.vl.ownerAddinControlRecreated(kb.solutionId,kb.storeType))}catch(cf){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(kb.solutionId,
kb.ownerAddinStoreType||kb.storeType,kb.assetId,null,null,kb.storeId),kb.version,kb.storeType,kb.storeId,cf.message)),Ed(!1,kb,null,null)}});else try{if(this.Maa){const cf=Eb.a[this.qx]+L.solutionId,Tf=this.Maa.Ci("ComponentAttach",cf);this.Kkb.$(cf,Tf)}const kb=this.BKa.P8a(L.storeType,L.solutionId);6!==this.qx&&(kb&&(this.GJc(kb),kb.sM.purge(!1)),this.vl.insertOsfControl(this.wmc(L,M,Ja,Ed)),kb&&this.vl.ownerAddinControlRecreated(L.solutionId,L.storeType))}catch(kb){n.ULS.sendTraceTag(17388185,
220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,kb.message)),Ed(!1,L,null,null)}else Ed(!1,L,null,null)}}XYj(L,M,Ja,pb,Tb,Wc){const sd=(Ed,ee,kb,cf)=>{Wc(Ed,ee,kb,cf);Ed=Eb.a[this.qx]+ee.solutionId;({value:ee}=this.Kkb.Uf(Ed)).returnValue&&(ee.stop(),
this.Kkb.remove(Ed))};if(6===this.qx&&L)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId))),this.aJh(L))try{if(this.Maa){const ee=Eb.a[this.qx]+L.solutionId,kb=this.Maa.Ci("ComponentAttach",ee);this.Kkb.$(ee,kb)}const Ed=this.BKa.P8a(L.storeType,L.solutionId);Ed||sd(!1,L,null,null);B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.XMf?
this.cZf(L,M,pb,Tb,Ja,ee=>{sd(ee,L,Ja,Ed.displayName)}):(this.cZf(L,M,pb,Tb,Ja),sd(!0,L,Ja,Ed.displayName))}catch(Ed){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,Ed.message)),sd(!1,L,null,null)}else sd(!1,
L,null,null)}iqk(L,M,Ja,pb,Tb,Wc){if(Wc)if(Wc._isAddinCommandsManifest(this.ES.nT))try{B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.XMf?this.bZf(L,M,Ja,Tb,Wc,sd=>{pb(sd,L,Wc,Wc.getDefaultDisplayName())}):(this.bZf(L,M,Ja,Tb,Wc),pb(!0,L,Wc,Wc.getDefaultDisplayName()))}catch(sd){n.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId,sd.message)),pb(!1,L,Wc,Wc.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId)),pb(!1,
L,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.ES.nT,Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.ownerAddinStoreType||L.storeType,L.assetId,null,null,L.storeId),L.version,L.storeType,L.storeId)),pb(!1,L,null,null)}wmc(L,M,Ja,pb){const Tb={},Wc=document.createElement("div");Wc.setAttribute("visible","false");Tb.div=Wc;Tb.id=L.solutionId;Tb.solutionId=L.solutionId;
Tb.version=L.version;Tb.storeType=L.storeType;Tb.storeId=L.storeId;Tb.assetId=L.assetId;Tb.assetStoreId=L.assetStoreId;Tb.isvirtualOsfControl=!0;Tb.virtualOsfControlActivationCallback=(sd,Ed)=>{const ee=this.BKa.P8a(L.storeType,L.solutionId);ee&&(ee.isUpgraded&&(L.isUpgraded=!0),this.GJc(ee));this.iqk(L,M,Ja,pb,sd,Ed)};Tb.reason=3===this.qx?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Tb}bZf(L,M,Ja,pb,Tb,Wc=null){const sd=
{};sd.solutionId=pb.getSolutionId();sd.version=pb.getVersion();sd.storeType=pb.getStoreType();sd.storeId=pb.getStoreId();sd.assetId=pb.getAssetId();sd.assetStoreId=pb.getAssetStoreId();sd.targetType=pb.getOsfControlType();let Ed=null,ee=null;if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ES.nT,this.ES.formFactor)).parseExtensions(sd,Tb,this.lrb),ee=Sb.v2f(this.ES.nT);
else try{Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ES.nT,this.ES.formFactor)).parseExtensions(sd,Tb,this.lrb),ee=Sb.v2f(this.ES.nT)}catch(cf){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+cf.message),cf;}if(ee&&0<ee.count){if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var kb=M(L);M=Ja(L);Ja=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");
kb=new Ib(kb,null,M);for(let cf of ee)kb.commandSurface=cf,Ed.apply(kb,this.lrb,Ja)}else try{let cf=M(L),Tf=Ja(L),zg=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");kb=new Ib(cf,null,Tf);for(let ci of ee)kb.commandSurface=ci,Ed.apply(kb,this.lrb,zg)}catch(cf){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+cf.message),cf;}if(OSF.OUtil.checkFlight(14))try{let cf=kb.X4d(L.solutionId,Tb.getDefaultDisplayName()),
Tf=kb.LYf();cf&&this.apc.Xqb(cf,Wc);Tf&&this.OWd.isf(Tf);this.BKa.Vsf(pb,cf,Tf,Tb.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Tb.getDefaultDisplayName())}catch(cf){throw OfficeExt.DevConsole.log(cf),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+cf.message),cf;}else try{let cf=kb.X4d(L.solutionId,Tb.getDefaultDisplayName()),Tf=kb.LYf();cf&&this.apc.Xqb(cf);Tf&&this.OWd.isf(Tf);this.BKa.Vsf(pb,cf,Tf,Tb.getDefaultDisplayName());
n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Tb.getDefaultDisplayName())}catch(cf){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+cf.message),cf;}}}cZf(L,M,Ja,pb,Tb,Wc=null){const sd={};sd.solutionId=L.solutionId;sd.version=L.version;sd.storeType=L.storeType;sd.storeId=L.storeId;sd.assetId=L.assetId;sd.assetStoreId=L.assetStoreId;sd.targetType=L.targetType;const Ed=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.ES.nT,this.ES.formFactor);
try{const ee=M.getManifest(),kb=Ed.parse(sd,ee,Tb,this.lrb,M.getSharedRuntimeId(),M),cf=Ja(L),Tf=pb(L),zg=new Ib(cf,null,Tf);zg.commandSurface="PrimaryCommandSurface";kb.apply(zg,this.lrb,!0);if(zg.ribbonBuilder.uF&&0<zg.ribbonBuilder.uF.count){const ci=zg.X4d(L.solutionId,M.getManifest().getDefaultDisplayName(),1);B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.apc.Xqb(ci,Wc):ci&&this.apc.Xqb(ci,Wc);this.BKa.v6h(M,ci,
Tb,M.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",M.getManifest().getDefaultDisplayName())}}catch(ee){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",M.getManifest().getDefaultDisplayName(),ee.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(ee)}}GJc(L){L.VJ&&this.apc.NQe(L.VJ);L.Q0b&&this.OWd.uWk(L.Q0b);this.BKa.cWk(L.sM.getStoreType(),L.sM.getSolutionId())}Usi(L,M){M=
Ka(M);for(let Ja of this.BKa.Jyb){if(Ja.sM.getStoreType()!==M)continue;let pb=!0;for(let Tb of L){const Wc=Tb;if(Wc&&Ja.Qlg(Wc.storeType,Wc.solutionId)){pb=!1;break}}pb&&(this.GJc(Ja),Ja.sM.purge(!1))}}aJh(L){return!!L&&!!L.solutionId&&!!L.version&&!!L.storeType&&!!L.storeId}}Object(h.a)(gc,"AddInCommandsIntegration",null,[]);var Ta=d(1150),Ab=d(166),kc=d(928),fb=d(578),Qb=d(351),mb=d(929),Jb=d(141),Ub=d(97),tb=d(65),Bc=d(57);class Gb{static get W7(){return Gb.vG||(Gb.vG=Bc.a.instance.ub("Common.Utils.IAriaNotifier"))}static kJf(L,
M,Ja,pb){Gb.IV&&Gb.IV.yL&&Gb.IV.dismiss();Gb.IV=Ta.a.ZXd(M,L,L,3);Gb.IV.content=Ja;va.a(pb)||(Gb.IV.title=pb,Gb.IV.Q7b=!0);L=new Sys.UI.Bounds(0,0,Ub.a.SUc(),Ub.a.RUc());Gb.IV.RZ=Gb.N5d(L,M,Gb.IV.gba,1);Gb.IV.show();Gb.W7&&Gb.W7.sendNotification(Ja.innerText,!0)}static sXd(L,M,Ja,pb=null){Jb.UISurfaces.mL().then(Tb=>{let Wc=null;Gb.TVb&&(Tb.removeNotification(Gb.TVb),Gb.TVb=null);const sd=Tb.callout(Object.assign(new kc.a,{target:L,title:M,content:Ja,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,
calloutProps:Object.assign(new mb.a,{onDismiss:()=>{Tb.removeNotification(Wc)},directionalHint:null!=pb?pb:null})})),Ed=Object.assign(new Qb.a,{expirationOptions:Object.assign(new fb.a,{displayTimeoutSeconds:7,onExpire:()=>{Tb.removeNotification(Gb.TVb)}})});Wc=Gb.TVb=Tb.addNotification(sd,Ed);return null},Tb=>{n.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Tb);return null})}static gYe(L){Gb.IV&&Gb.IV.yL&&Gb.IV.dismiss();const M=new y.StandardDialog;M.B0a=!1;M.xd=0;
M.Gy(Ab.a.RYj,CommonUIStrings.l_DialogError,va.a(L)?Gb.V0f():L,null)}static Vjl(L){Gb.IV&&Gb.IV.yL&&Gb.IV.dismiss();n.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",L.errorCode));const M=va.a(L.description)?Gb.V0f():L.description,Ja=new y.StandardDialog;let pb=null;L.d_b?(Ja.xd=1,Ja.Xe(1,L.buttonText),Ja.xya(1)):Ja.xd=0;pb=Tb=>{1===Tb?L.d_b():L.t2b&&L.t2b()};Ja.B0a=!1;0===L.Pde?Ja.Gy(L.errorCode,L.title?L.title:CommonUIStrings.l_DialogError,M,pb):1===
L.Pde?Ja.fP(L.title?L.title:CommonUIStrings.l_DialogWarning,M,pb):Ja.tkb(L.title?L.title:CommonUIStrings.l_DialogInfo,M,pb)}static N5d(L,M,Ja,pb){let Tb=0===pb?0:4;const Wc=L.x+L.width-M.x-M.width;M.x-L.x+M.width/2<=Ja/2?Tb=0===pb?2:5:Wc+M.width/2<=Ja/2&&(Tb=0===pb?3:6);return Tb}static fkl(L,M,Ja,pb=!1){(M=oa.bwb(M))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(M,Tb=>{Tb&&(pb||Gb.sXd(Tb,Ja,L,5))})}static gkl(L,M,Ja=!1){Gb.fkl(M.startedNode?
M.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,L),M,M.startedNode?M.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,L),Ja)}static ekl(L,M,Ja,pb){if(Gb.tIh)L=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ja,pb,CommonUIStrings.l_InsertionDialogRefresh)),Gb.sXd(M,L,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{M=tb.a.$h(M);var Tb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),
Wc=document.createElement("span");Wc.innerText=Tb[0];var sd=document.createElement("span");sd.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ja,pb,CommonUIStrings.l_InsertionDialogRefresh);sd.className="UIFontBold";Ja=document.createElement("span");Ja.innerText=Tb[1];pb=document.createElement("div");Sys.UI.DomElement.addCssClass(pb,"ModalCalloutControl");pb.appendChild(Wc);pb.appendChild(sd);pb.appendChild(Ja);Gb.kJf(L,M,pb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static Ell(L,
M){var Ja=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,pb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Gb.tIh?Gb.sXd(M,Ja,pb):(M=tb.a.$h(M),Gb.kJf(L,M,Gb.xli(pb),Ja))}static xli(L){const M=document.createElement("div");Sys.UI.DomElement.addCssClass(M,"ModalCalloutControl");M.innerText=L;return M}static V0f(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get tIh(){return B.AFrameworkApplication.Aa.hb.Oo&&B.AFrameworkApplication.Aa.hb.WUa}}
Gb.IV=null;Gb.TVb=null;Gb.vG=null;Object(h.a)(Gb,"AddInCommandsNotificationFactory",null,[]);class Hc{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed=null){this.Pa=new P.a;this.Twd=L;this.hPh=M;this.aN=Ja;this.eqf=pb;this.Jpb=Tb;this.EMh=Wc;this.Kvc=sd;this.iXh=Ed;this.MTh=B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}v8h(L){this.Pa.addHandler(O.a.Zuf,L)}r9h(L){this.Pa.addHandler(O.a.sne,L)}Nai(L){this.Pa.addHandler(O.a.cvh,L)}I8h(L){this.Pa.addHandler(O.a.aSd,
L)}hZj(L,M,Ja){const pb=Ja[O.a.NGc],Tb=void 0===Ja[O.a.P7]?0:Ja[O.a.P7];if(pb&&0!==Tb)if(0>=pb.count&&4!==Tb)this.lah(new ca(Tb,null,null,M,null,!0));else{var Wc=pb.count,sd=new Fa(new Xa),Ed=void 0===Ja[O.a.Q7]?-1:Ja[O.a.Q7],ee=new gc(Tb,this.aN,this.Twd,sd,this.hPh,this.Jpb,this.Kvc),kb=ah=>this.eqf.Ski(ah.solutionId,this.Kvc,this.Twd,L),cf=ah=>this.eqf.Tji(ah.solutionId),Tf=(ah,Qe,Di)=>{Wc--;Di=new ca(Tb,Qe,sd,M,Di,0>=Wc);if(ah&&Qe)this.lah(Di);else{if(3===Tb||Qe&&Qe.isUpgraded)ah="",Qe&&(ah=Telemetry.PrivacyRules.GetPrivacyCompliantId(Qe.solutionId,
Qe.ownerAddinStoreType||Qe.storeType,Qe.assetId,null,null,Qe.storeId)),Qe={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:ah},aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.pC(Qe)}));this.kah(Di)}Wc||B.AFrameworkApplication.Aa.updateCommandUI()},zg=(ah,Qe,Di,pk)=>{Tf(ah,Qe,pk)},ci=()=>{this.MFe();0>=pb.count&&4===Tb&&this.Jpb.lVe()};6===Tb?(Ed=Ja[O.a.sPi],Ja=Ja[O.a.tPi],ee.XYj(pb.ga(0),Ed,
Ja,kb,cf,(ah,Qe,Di,pk)=>{Tf(ah,Qe,pk)})):ee.x1c(pb,kb,cf,Ed,zg,ci,this.iXh)}else aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.pC({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.Twd.nT)),this.kah(new ca(Tb,null,null,M,null,!0))}kah(L){this.MFe(L);this.Tvh(!1,
L)}lah(L){const M=L.Iu;let Ja=null;null!==M&&(Ja=M.storeType,Ja=Ja.toLowerCase());if(L&&"omex"===Ja&&(3===L.qx||M.isUpgraded)){var pb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId)};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.pC(pb)}))}this.MFe(L);pb=Ya()&&"omex"===Ja&&!!L.vaa&&!!M.solutionId&&
2===L.qx&&M.solutionId.toLowerCase()===Ha().toLowerCase();var Tb="excatalog"===Ja&&3===L.qx;if("omex"===Ja&&L.vaa&&(3===L.qx&&"hardcodedpreinstall"!==Ja||M.isUpgraded)||pb||Tb)pb=new V,pb.Iu=M,pb.VJ=L.vaa.qVa,this.Pa.raiseEvent(O.a.aSd,pb);this.MTh&&(pb=ka(),Tb=Ha(),pb&&M&&"excatalog"===M.storeType&&L.vaa&&5===L.qx&&Tb&&(M.storeId&&M.storeId.toLowerCase()===Tb.toLowerCase()||M.assetId&&M.assetId.toLowerCase()===Tb.toLowerCase())&&(pb=new V,pb.Iu=M,pb.VJ=L.vaa.qVa,this.Pa.raiseEvent(O.a.aSd,pb),n.ULS.sendTraceTag(525362254,
220,50,"Email alert triggers AutoLaunchAddin event.")));M&&(eb.instance.nph(Pa(Ja),!0),"uploadfiledevcatalog"===Ja&&(pb=this.EMh.createAddinDataProvider(Ja,this.aN))&&pb.localCacheAddinCommands(this.aN.sxa,M.solutionId,M.version,M.storeId),X.a.Jlb(O.a.nrb,"true",Pa(Ja)));this.Tvh(!0,L)}Tvh(L,M){L?B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&M.vaa&&5===M.qx&&M.vaa.qVa&&void 0!==M.Iu.showCallout&&null!==M.Iu.showCallout&&M.Iu.showCallout?
(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new ta(this.Pa)).sOd(M.Iu,oa.bwb(M.vaa.qVa)):(new sa(this.Pa,M.Iu,oa.bwb(M.vaa.qVa))).sOd(),L=new V,L.VJ=M.vaa.qVa,L.Iu=M.Iu,this.Pa.raiseEvent(O.a.cvh,L)):3!==M.qx?M.zog&&this.Jpb.lVe():M.vaa&&M.vaa.qVa&&"hardcodedpreinstall"!==M.Iu.storeType&&Gb.gkl(M.displayName,M.vaa.qVa,M.Iu.isAutoLaunched):3===M.qx?M.Iu&&"uploadfiledevcatalog"===M.Iu.storeType.toLowerCase()?(M=this.Kvc.j9i(M.Iu.solutionId),
Gb.gYe(M?M:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.Jpb.W$k():M.zog&&this.Jpb.lVe()}MFe(L=null){var M=L?L.Iu:null;const Ja=new V;if(Ja.Iu=M){var pb=this.Jpb.P8a(M.storeType,M.solutionId,6===L.qx?1:0);if(pb&&pb.VJ){Ja.VJ=pb.VJ;var Tb=Ha();Tb=Ya()&&!!M.solutionId&&!!Tb&&M.solutionId.toLowerCase()===Tb.toLowerCase()&&2===L.qx;if(3===L.qx&&"hardcodedpreinstall"!==M.storeType||Tb)L="",pb.VJ.gaa&&pb.VJ.gaa.uF&&(pb=pb.VJ.gaa.uF.ga(0))&&(L=pb.id),M={["SDX_CommandPlacement"]:L,
["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId)},aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:N.a.pC(M)}))}}this.Pa.raiseEvent(O.a.Zuf,Ja)}}Object(h.a)(Hc,"LaunchAddinCommandsHandler",null,[871]);class $b{constructor(L){this.DXh=L}get sxa(){return this.DXh}insertOsfControl(L){return this.sxa.insertOsfControl(L)}getManifestInvaildErrorString(){return this.sxa.getManifestInvaildErrorString()}isAddinCommandsAsync(L,
M){this.sxa.isAddinCommandsAsync(L,M)}isAddinCommandsExAsync(L,M){this.sxa.isAddinCommandsExAsync(L,M)}ownerAddinControlRecreated(L,M){this.sxa.ownerAddinControlRecreated(L,M)}queryEntitlementDetails(L){this.sxa.queryEntitlementDetails(L)}}Object(h.a)($b,"ContextActivationMgrWrapper",null,[875]);class lc{}lc.kmb="Alt";lc.lmb="Command";lc.id="Id";lc.R1a="Image16by16";lc.mmb="LabelText";lc.button="Button";lc.b4d="FlyoutAnchor";Object(h.a)(lc,"AddinDataNodeConstants",null,[]);var Vb=d(216),ic=d(408),
qb=d(315),Wb=d(71);class Xc{constructor(L,M){this.VAc=this.T9e=null;if(va.b(L)||va.b(M))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.czd=M;this._id=L;this.uN[lc.id]=this._id}get id(){return this._id||""}get uN(){return this.T9e||(this.T9e={})}get controlType(){return this.czd||""}get menuItems(){return this.VAc||(this.VAc=new e.a)}ttc(){let L=null;this.czd===
lc.b4d?L=Object.assign(new ic.a,{Menu:this.nlk()}):this.czd===lc.button&&(L=Object.assign(new Vb.a,{}));L&&(this.uN[lc.id]&&(L.ExternalId=this.uN[lc.id]),this.uN[lc.lmb]&&(L.Command=this.uN[lc.lmb].toString()),this.uN[lc.mmb]&&(L.LabelText=this.uN[lc.mmb]),this.uN[lc.kmb]&&(L.Alt=this.uN[lc.kmb]),this.uN[lc.R1a]&&(Wb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.uN[lc.R1a]),L.ExternalImageId=this._id));return L}nlk(){const L=Object.assign(new qb.a,{UpdateDynamically:!0,
MenuSectionList:[]});if(this.VAc){const M=Object.assign(new m.a,{ControlList:[]});for(let Ja of this.VAc)Array.add(M.ControlList,Ja.ttc());Array.add(L.MenuSectionList,M)}return L}}Object(h.a)(Xc,"ControlDefinition",null,[870]);class xb{constructor(L){this.Lba=null;if(va.b(L))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=L;this.Lic[lc.id]=this._id}get Lic(){return this.Lba||
(this.Lba={})}get id(){return this._id||""}ttc(){const L=Object.assign(new Vb.a,{});this.Lba[lc.id]&&(L.ExternalId=this.Lba[lc.id]);this.Lba[lc.lmb]&&(L.Command=this.Lba[lc.lmb].toString());this.Lba[lc.mmb]&&(L.LabelText=this.Lba[lc.mmb]);this.Lba[lc.kmb]&&(L.Alt=this.Lba[lc.kmb]);this.Lba[lc.R1a]&&(Wb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Lba[lc.R1a]),L.ExternalImageId=this._id);return L}}Object(h.a)(xb,"MenuItemDefinition",null,[914]);class Rb{constructor(L){this.cxc=
null;if(va.b(L))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=L}get id(){return this._id}get controls(){return this.cxc||(this.cxc=new e.a)}ttc(){const L=[];if(this.cxc)for(let M of this.cxc){const Ja=M.ttc();Ja&&L.push(Ja)}return L}}Object(h.a)(Rb,"OfficeMenuDefinition",null,[867]);var wc=d(37);class ud{constructor(L,M,Ja){this.xV=this.xnb=null;this.wGd=L;this.hnb=
M;this.vmb=Ja;this.sWh=new e.a}get tdd(){return this.wGd}get r0b(){return this.hnb}get ONd(){return this.vmb}addButton(L){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",L.actionType);this.xV=new Xc(this.kQa(L.id),lc.button);this.xV.uN[lc.mmb]=L.label;this.xV.uN[lc.kmb]=L.label;this.xV.uN[lc.R1a]=L.icon["16"];this.KZb(this.xV.uN[lc.id],L.action);this.X5a(this.xV.uN);this.xnb.controls.add(this.xV);this.xV=null}startBuildMenu(L){if(va.b(this.xnb))this.xnb=new Rb(L.id);else{const M=
this.kQa(L.id);this.xV=new Xc(M,lc.b4d);this.tsb(this.xV.uN,L);this.xV.uN[lc.R1a]=L.icon["16"];this.xV.uN[lc.lmb]=wc.a.T7}}addMenuItem(L){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",L.actionType);const M=new xb(this.kQa(L.id));this.tsb(M.Lic,L);L.icon&&(M.Lic[lc.R1a]=L.icon["16"]);this.KZb(M.Lic[lc.id],L.action);this.X5a(M.Lic);this.xV.menuItems.add(M)}endBuildMenu(){va.b(this.xV)?(this.Hcd.add(this.xnb),this.xnb=null):(this.xnb.controls.add(this.xV),this.xV=null)}get Hcd(){return this.sWh}KZb(L,
M){this.ONd.bindAction(L,M)}X5a(L){this.r0b.X5a(L)}kQa(L){return this.tdd.YDa(L)}tsb(L,M){L[lc.mmb]=M.label;L[lc.kmb]=M.label}}Object(h.a)(ud,"ContextMenuExtensibilityCreator",null,[901,897]);class uc{constructor(L){this.XUb=L}get ljc(){return this.XUb}YDa(L){return this.ljc+L}}Object(h.a)(uc,"DefaultContextMenuNamingProvider",null,[902]);class db{constructor(L,M,Ja,pb){this.XUb=L;B.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&Ja.Hcj();this.Mof=M;this.d0h=pb}get ljc(){return this.XUb}get solutionId(){return this.Mof}get LXe(){return this.d0h}YDa(L){L=
this.ljc+this.solutionId+L;return this.LXe?(L in db.OGc||(db.OGc[L]="AddinControl"+db.Dbi++),db.OGc[L]):L}gMf(L){if(this.LXe){const Ja=db.OGc;for(let pb in Ja){var M=pb;if(L===Ja[pb])return M.substr(this.ljc.length+this.solutionId.length)}}return L}qlj(L){L=this.ljc+this.solutionId+L;return this.LXe?(L in db.WPd||(db.WPd[L]="AddinTab"+db.Ibi++),db.WPd[L]):L}}db.OGc={};db.WPd={};db.Ibi=0;db.Dbi=0;Object(h.a)(db,"DefaultRibbonNamingProvider",null,[869]);class Yb{bindAction(L,M){OfficeExt.DefaultControlActionBinder.bindAction(L,
M)}}Object(h.a)(Yb,"DefaultUIControlActionBinder",null,[899]);class Zc{constructor(L){this.LOh=L}get command(){return this.LOh}X5a(L){L[lc.lmb]=this.command}}Object(h.a)(Zc,"DefaultUIControlCommandBinder",null,[898]);var Kb=d(531);class Yc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(h.a)(Yc,"AddInControl",null,[]);class ec{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(h.a)(ec,"AddInGroup",null,[]);class rb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(rb,"AddInMenuItem",null,[]);class ac{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(h.a)(ac,"AddInTab",null,[]);class Jc{constructor(L,M,Ja,pb,Tb,Wc){this.Hvc=new e.a;this.rRb=this.gAa=this.ynb=null;this.wGd=L;this.vmb=
M;this.hnb=Ja;this.Mof=pb;this.Kvc=Tb;this.mbf=Wc}get tdd(){return this.wGd}get uF(){return this.Hvc}get ONd(){return this.vmb}get r0b(){return this.hnb}startBuildTab(L){const M=L.isOfficeTab?L.id:this.tdd.qlj(L.id),Ja=L.isOfficeTab?null:L.label;this.ynb=Object.assign(new ac,{id:M,title:Ja,isOfficeTab:L.isOfficeTab,visible:L.visible,groups:[],tabType:L.tabType,insertBefore:L.insertBefore,insertAfter:L.insertAfter,autoFocus:L.autoFocus})}startBuildGroup(L){const M=this.kQa(L.id);this.gAa=Object.assign(new ec,
{id:M,mlrId:L.mlrId,title:L.label,controls:[],groupType:0})}addNativeGroup(L){this.gAa=Object.assign(new ec,{id:L.id,mlrId:L.mlrId,title:L.label,controls:[],groupType:1});this.ynb.groups.push(this.gAa)}addButton(L){const M=this.kQa(L.id);M&&(this.KZb(M,L.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",L.actionType),L=Object.assign(new Yc,{id:M,title:L.label,iconLocation:this.B7d(L),enabled:L.enabled,controlType:0,attributes:this.tsb()}),this.mbf.Prf(new Kb.a(M,
this.r0b.command.toString())),this.gAa.controls.push(L))}addNativeControl(L){L.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",L.actionType),L=Object.assign(new Yc,{id:L.id,title:"",iconLocation:"",enabled:L.enabled,controlType:2,attributes:this.tsb()}),this.gAa.controls.push(L))}startBuildMenu(L){const M=this.kQa(L.id);M&&(this.rRb=Object.assign(new Yc,{id:M,title:L.label,iconLocation:this.B7d(L),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(L){const M=
this.kQa(L.id);M&&(this.KZb(M,L.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",L.actionType),L=Object.assign(new rb,{id:M,title:L.label,iconLocation:this.B7d(L),enabled:L.enabled,attributes:this.tsb()}),this.mbf.Prf(new Kb.a(M,this.r0b.command.toString())),this.rRb.menuItems.push(L))}endBuildMenu(){va.b(this.rRb.id)||this.gAa.controls.push(this.rRb);this.rRb=null}endBuildGroup(){va.b(this.gAa.id)||this.ynb.groups.push(this.gAa);this.gAa=null}endBuildTab(){va.b(this.ynb.id)||
this.Hvc.add(this.ynb);this.ynb=null}tsb(){const L={};this.X5a(L);return L}B7d(L){return L.icon["80"]?L.icon["80"]:L.icon["32"]}X5a(L){this.r0b.X5a(L)}kQa(L){return this.tdd.YDa(L)}KZb(L,M){this.ONd.bindAction(L,M)}}Object(h.a)(Jc,"OneLineRibbonExtensibilityCreator",null,[896,897]);class Db{constructor(L,M){this.XUb=L;this.vmb=new Yb;this.hnb=new Zc(M)}Tji(L){L=new uc(L);return new ud(L,this.hnb,this.vmb)}Ski(L,M,Ja,pb){Ja=new db(this.XUb,L,Ja,!0);return new Jc(Ja,this.vmb,this.hnb,L,M,pb)}}Object(h.a)(Db,
"UIExtensibilityFactory",null,[866]);class dd{createAddinDataProvider(L,M){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(L,M.sxa)}static get instance(){dd.Ka||(dd.Ka=new dd);return dd.Ka}}dd.Ka=null;Object(h.a)(dd,"OSFAddinDataProviderFactory",null,[868]);class Cd{constructor(){this.mrb=null}setErrorMessageForAddin(L,M){this.mrb||(this.mrb={});this.mrb[L]=M}j9i(L){return this.mrb&&L in this.mrb?this.mrb[L]:null}}Object(h.a)(Cd,"AddinCommandsErrorManager",null,[]);class pd{constructor(){this.Pde=
0;this.d_b=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.mcg=!1;this.XAj=this.t2b=null}}Object(h.a)(pd,"AddInCommandsNotificationParameters",null,[]);class Ge{constructor(){this.f8e=this.zwd=null}get PNd(){return this.zwd||(this.zwd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set PNd(L){this.zwd=L}get ehi(){return this.f8e||(this.f8e=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(L,
M){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(L,M)}k7b(L,M,Ja,pb,Tb){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",L);if((L=M.P8a(Tb.ownerAddinInfo.storeType,Tb.ownerAddinInfo.solutionId))&&L.sM&&!L.sM.getIsUpgrading())if(M=null,0<L.sM.getNotificationParams().length&&(M=this.wAf(L.sM.getNotificationParams()[0]))&&2147758681===M.errorCode&&(L.isUpgraded=!0),2!==L.sM.getStatus()&&(1!==L.sM.getStatus()||M&&2147758681===M.errorCode))M&&this.Zuh(L,M,
null);else try{Ja.setOwnerAddinEToken(L.sM.getEToken()),Tb.action(Ja,pb.sxa)}catch(Wc){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",B.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Wc.stack:Wc.message)),Gb.gYe(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}Zuh(L,M,Ja=null){const pb=L.sM;if(1===pb.getNotificationParams().length||M.mcg){const Tb=M.d_b,Wc=M.t2b;M.d_b=
()=>{pb.removeFirstNotification();if(0<pb.getNotificationParams().length){const sd=this.wAf(pb.getNotificationParams()[0]);this.Zuh(L,sd)}2147758681===M.errorCode&&(Xa.NMi(L.VJ,pb,Object(E.a)(this,this.beg,"initUpgradeStateDetectTask")),z.HMi(L.Q0b,pb,Object(E.a)(this,this.beg,"initUpgradeStateDetectTask")));Tb&&Tb()};M.t2b=()=>{Wc&&Wc();Ja&&Ja()};Gb.Vjl(M)}}beg(L,M){let Ja=null;Ja=()=>{L.getIsUpgrading()?window.setTimeout(Ja,1E3):L.getUpgradingFailed()?Xa.Bod(M,!0):B.AFrameworkApplication.Aa.updateCommandUI()};
window.setTimeout(Ja,1E3)}wAf(L){const M=new pd;M.Pde=L.infoType;M.id=L.id;M.title=L.title;M.description=L.description;M.buttonText=L.buttonTxt;M.d_b=L.buttonCallback;M.mcg=L.highPriority;M.t2b=L.dismissCallback;M.errorCode=L.errorCode;M.XAj=L.iframeNotificationUrl;return M}}Object(h.a)(Ge,"AddinCommandsActionHandler",null,[877]);class kd{constructor(){this.labelText=null;this.visible=!1}}Object(h.a)(kd,"AddinStatusCommandValues",null,[]);class Xf{static $Lk(L){const M=new kd;M.labelText=L.QYb;M.visible=
M.labelText?!0:!1;return M}static HYe(){const L=document.getElementById(void 0);L?Xf.Ovh(void 0,void 0,L,void 0,void 0):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static Ovh(L,M,Ja,pb,Tb){Ja?L.QYb===CommonUIStrings.l_ErrorLoadingAddInsTitle?Gb.ekl(M,Ja,pb,Tb):L.QYb===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Gb.Ell(M,Ja):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(h.a)(Xf,
"AddinCommandsStatusHandler",null,[]);class Kd{constructor(){this.qx=this.b1=0;this.MPd=null;this.Lid=this.gtd=0;this.cNa=this.mBd=this.Rwd=this.OKc=this.ODa=this.vra=null}get LPd(){this.Rwd||(this.Rwd=new e.a);return this.Rwd}get P4d(){this.mBd||(this.mBd=new e.a);return this.mBd}get t7a(){this.cNa||(this.cNa=new e.a);return this.cNa}}Object(h.a)(Kd,"AddinCommandsListLoaderContext",null,[]);const lg=L=>{const M={};M.solutionId=L.solutionId;M.version=L.version;M.storeType=L.storeType;M.storeId=L.storeId;
M.assetId=L.assetId;M.assetStoreId=L.assetStoreId;M.targetType=L.targetType;M.requireConsent=L.requireConsent||!1;M.isAddinCommands=!0;M.addinCommandsActionType=0;return M};class ve{constructor(L,M){this.entitlement=L;this.metadata=M}ZBh(){const L=lg(this.entitlement);L.targetType=this.targetType;return L}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(h.a)(ve,"AddinEntitlementEx",null,[]);var Ua=d(22);class Bb{constructor(L){this.Cg=null;this.zba=L}get_current(){if(!this.Cg)throw Error.argumentOutOfRange();return this.Cg.data}moveNext(){if(!this.Cg)return this.Cg=this.zba,!!this.zba;if(!this.Cg.next)return!1;
this.Cg=this.Cg.next;return!0}reset(){this.Cg=this.zba}}Object(h.a)(Bb,"ListEnumerator",null,[0]);class mc{constructor(L,M,Ja){this.next=Ja;this.previous=M;this.data=L}}Object(h.a)(mc,"ListNode",null,[]);class Nc{constructor(){this.o5a=this.uha=null;this.Xk=0}add(L){this.uha?this.o5a=this.o5a.next=new mc(L,this.o5a,null):this.uha=this.o5a=new mc(L,null,null);this.Xk=this.count+1}insert(L,M){if(L>this.count||0>L)throw Error.argumentOutOfRange("pos");if(L===this.count)this.add(M);else{for(var Ja=this.uha;0!==
L--;)Ja=Ja.next;L=new mc(M,Ja.previous,Ja);L.previous?L.previous.next=L:this.uha=L;L.next?L.next.previous=L:this.o5a=L;this.Xk=this.count+1}}remove(L){let M=this.uha;for(;M&&M.data!==L;)M=M.next;if(!M)return!1;M.previous?M.previous.next=M.next:this.uha=M.next;M.next?M.next.previous=M.previous:this.o5a=M.previous;this.Xk=this.count-1;return!0}clear(){let L=this.uha,M;for(this.o5a=this.uha=null;L;)M=L.next,L.previous=null,L.next=null,L=M;this.Xk=0}indexOf(L){let M=this.uha,Ja=0;for(;M&&M.data!==L;)M=
M.next,Ja++;return M?Ja:-1}ga(L){return this.at(L).data}get count(){return this.Xk}getEnumerator(){return new Bb(this.uha)}[Symbol.iterator](){return Object(Ua.a)(this.getEnumerator())}toArray(){const L=Array(this.count);let M=0;for(let Ja of this)L[M]=Ja,M++;return L}at(L){let M=this.uha,Ja=0;for(;Ja!==L;){if(!M)throw Error.argumentOutOfRange("pos");M=M.next;Ja++}return M}}Object(h.a)(Nc,"List",null,[1]);class nd extends Sys.EventArgs{constructor(L){super();this.properties=L}}Object(h.a)(nd,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class Dd{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(Dd,"MiniAddinInfo",null,[]);class La{constructor(L,M,Ja){this.Ip=new P.a;this.context=new Kd;this.VLd=this.IZe=this.i6a=this.n1=this.mba=null;this.contextActivationMgr=L;this.Ebi=M;this.j6a=Ja;this.appName=B.AFrameworkApplication.fa.Ga("WebAppShortName")}get VAh(){this.VLd||(this.VLd=new ta(this.Ip));return this.VLd}u8h(L){this.Ip.addHandler(O.a.PYb,L)}Pai(L){this.Ip.addHandler(O.a.jYe,L)}Wzl(L){null!==
L&&(this.context.b1=L[O.a.Q7],this.context.qx=L[O.a.P7],this.context.gtd=this.context.Lid=0,L=O.a.k6a in L?L[O.a.k6a]:0,-1!==this.context.b1&&0!==this.context.qx&&(this.context.vra=new Nc,this.context.ODa=new Nc,this.context.OKc=new Nc,this.context.MPd=this.Ebi.createAddinDataProvider(Ka(this.context.b1),this.contextActivationMgr),this.context.MPd?this.context.MPd.getEntitlementsAsync(this.contextActivationMgr.sxa,!0,L,M=>{this.Nuk(M)}):n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",
this.context.b1)))}Nuk(L){if(L&&0<L.length){this.context.gtd=L.length;const Ja=B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Ha():null;for(let pb=0;pb<L.length;pb++){const Tb=L[pb];if(B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Ya()&&Tb&&Tb.storeType&&"omex"===Tb.storeType.toLowerCase()&&Tb.assetId&&Ja&&Tb.assetId.toLowerCase()===Ja.toLowerCase()){var M={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:La.tQ(Tb)};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.pC(M)}))}!Tb||1!==Tb.targetType&&-1!==Tb.targetType?this.ded():(M={},B.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(M.solutionId=Tb.solutionId,M.version=Tb.version):(M.marketplaceId=Tb.solutionId,M.marketplaceVersion=Tb.version),M.storeType=Tb.storeType,M.storeId=Tb.storeId,M.targetData=
Tb,La.Msc?this.contextActivationMgr.isAddinCommandsExAsync(M,Object(E.a)(this,this.vuk,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(M,(Wc,sd,Ed)=>{Wc?(sd&&this.context.vra.add(Ed.targetData),10===this.context.b1&&(Wc=Ed.targetData,sd=Wc.targetType,va.b(Ed.targetTypeForExp)||(sd=Ed.targetTypeForExp,Wc.targetType=sd),this.context.ODa.add(Wc),0===sd&&this.context.OKc.add(Wc))):(Ed=Ed.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.solutionId,Ed.storeType,Ed.assetId,null,null,Ed.storeId),Ed.storeType));this.ded()}))}}else this.ded()}ded(){var L;(L=this.context).Lid=L.Lid+1;this.context.Lid>=this.context.gtd&&(this.j6a.nph(this.context.b1,!1),0<this.context.gtd&&10===this.context.b1&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(L=!1,B.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&ka()&&(L=this.Z1j()),
this.p1j(),B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!L?La.Msc?this.VAh.ayl(this.contextActivationMgr,this.context.LPd,this.context.t7a,(M,Ja)=>{const pb=new e.a;for(let Tb of M)M=Tb.ZBh(),Ja&&Ja.solutionId===Tb.solutionId&&(M.showCallout=!0,this.VAh.yHh(Ja)),pb.add(M);this.eKa(pb)}):this.J2i(this.context.vra):this.WFc(this.context.vra)):this.WFc(this.context.vra))}WFc(L){if(La.Msc)this.eKa(this.vwi(this.context.LPd));
else{var M=new e.a;if(L)for(let Ja of this.context.vra)M.add(lg(Ja));this.context.vra&&1>this.context.vra.count&&X.a.Jlb(O.a.nrb,"false",this.context.b1);L={["ack2"]:M};L[O.a.Q7]=this.context.b1;L[O.a.P7]=this.context.qx;this.Ip.raiseEvent(O.a.PYb,new nd(L),this)}}vwi(L){const M=new e.a;if(L)for(let Ja of L)M.add(Ja.ZBh());return M}eKa(L){L&&L.count||X.a.Jlb(O.a.nrb,"false",this.context.b1);L={["ack2"]:L};L[O.a.Q7]=this.context.b1;L[O.a.P7]=this.context.qx;this.Ip.raiseEvent(O.a.PYb,new nd(L),this)}G_a(L){if(this.appName){const M=
{},Ja={};Ja.LastTeachingUIShowTime=(new Date).toUTCString();Ja.AddinHasShown=L;M[this.appName]=fa.c(Ja);this.mba&&(this.mba.nvb(M),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}J2i(L){(this.i6a=L)?(L=new e.a,L.add(this.appName),this.mba=new qa(this.appName,Object(E.a)(this,this.mEa,"getRequestSuccessCallback"),
Object(E.a)(this,this.ika,"getRequestFailureCallback"),Object(E.a)(this,this.jaa,"postRequestFailureCallback")),this.mba.$Oc(L)):(L={["ack2"]:new e.a},L[O.a.Q7]=this.context.b1,L[O.a.P7]=this.context.qx,this.Ip.raiseEvent(O.a.PYb,new nd(L),this))}mEa(L){L?this.WXe(L)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.n1="AddinHasShown"in L&&L.AddinHasShown?L.AddinHasShown.toString():null,this.D0b()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.WFc(this.i6a)):
(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.n1=null,this.D0b())}ika(L){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",L?L.oe:-1);this.WFc(this.i6a)}jaa(L){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",L?L.oe:-1)}D0b(){const L=this.r_d();0===L.targetType?(L.solutionId?(this.IZe=L.solutionId,this.rNe()):this.$Fa("NoSolutionId"),L.addinId&&(window.g_roamingAddinList=
this.n1?this.n1+","+L.addinId:L.addinId),this.Msf(null)):this.Msf(L.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",L.addinId)}rNe(){const L=new Ca.a;L.callbackFunc=M=>{if(M.errorCode){this.$Fa("FailToGetAppDetails");var Ja=window.g_roamingAddinList;Ja&&this.G_a(Ja)}else if(M.value)for(Ja of M.value)if(M=Ja[1],M===this.IZe){const pb={};pb.solutionId=M;pb.assetId=Ja[5];pb.storeType=Ja[12];pb.storeId=Ja[11];pb.assetStoreId=Ja[6];pb.targetType=Ja[3];pb.width=Ja[7];pb.height=
Ja[8];pb.displayName=Ja[0];pb.version=Ja[4];Ja=new Ba(pb);this.Ip.raiseEvent(O.a.jYe,Ja);break}};L.storeType=OSF.StoreTypeEnum.PrivateCatalog;L.fromInsertDialog=!1;L.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(L)}WXe(L){if("LastTeachingUIShowTime"in L){if(L=+new Date-+new Date(L.LastTeachingUIShowTime.toString()),L<B.AFrameworkApplication.fa.rQ("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
L),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}r_d(){let L=new Na.a(new Dd,0),M=new Na.a(new Dd,0),Ja=0,pb=0,Tb=0;var Wc=new Nc;if(0<this.context.vra.count)for(var sd of this.context.vra)Wc.add(sd);if(0<this.context.OKc.count)for(let Ed of this.context.OKc)Wc.add(Ed);for(let Ed of Wc)if(!("excatalog"!==Ed.storeType||va.b(Ed.installTimeInMS)||!Ed.installTimeInMS||Ed.installTimeInMS<=B.AFrameworkApplication.fa.rQ("DateTimeInMSForNewAddin",16409952E5))){Wc=La.T4b(Ed);
if(this.n1&&(sd=this.n1.split(","),0<sd.length&&Array.contains(sd,Wc))){Tb++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Wc.startsWith("private_")?(L.value<Ed.installTimeInMS&&(L=new Na.a(Object.assign(new Dd,{addinId:Wc,targetType:Ed.targetType,solutionId:Ed.solutionId}),Ed.installTimeInMS)),pb++):(M.value<Ed.installTimeInMS&&(M=new Na.a(Object.assign(new Dd,{addinId:Wc,targetType:Ed.targetType,solutionId:Ed.solutionId}),Ed.installTimeInMS)),Ja++)}n.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",pb,Ja,Tb);return 0<M.value?M.key:0<L.value?L.key:Object.assign(new Dd,{addinId:null,targetType:-1,solutionId:null})}Msf(L){const M=new e.a;for(let Ja of this.i6a){const pb=lg(Ja);if(L){const Tb=La.T4b(Ja);L===Tb&&(pb.showCallout=!0,window.g_roamingAddinList=this.n1?this.n1+","+L:L)}M.add(pb)}this.i6a&&1>this.i6a.count&&X.a.Jlb(O.a.nrb,"false",this.context.b1);L={["ack2"]:M};L[O.a.Q7]=this.context.b1;
L[O.a.P7]=this.context.qx;this.Ip.raiseEvent(O.a.PYb,new nd(L),this)}Z1j(){if(La.Msc)return this.$1j(this.context.P4d);var L=!1;if(this.context.ODa&&1>this.context.ODa.count)return L;const M=Ha();if(!M)return L;for(let Ja of this.context.ODa)if(Ja.storeId&&Ja.storeId.toLowerCase()===M.toLowerCase()||Ja.assetId&&Ja.assetId.toLowerCase()===M.toLowerCase())L={["SDX_Id"]:La.tQ(Ja),["SDX_TargetType"]:va.b(Ja.targetType)?"":Ja.targetType.toString()},aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:N.a.pC(L)})),L=!0;return L}p1j(){if(La.Msc)this.q1j(this.context.P4d);else if(!(this.context.ODa&&1>this.context.ODa.count))if(this.j6a.Ojg()){var L=this.j6a.i5f();L?(L=this.u0f(this.context.ODa,L),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(L=this.u0f(this.context.ODa,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.j6a.Tqh(L)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}u0f(L,M){const Ja={};let pb=!1;for(let Tb of L)if(L=
La.tQ(Tb))!M||L in M||(this.hea(Tb,L),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===L.toLowerCase()?pb||(pb=!0,Ja[L]=null):Ja[L]=null;return Ja}hea(L,M){var Ja=L.installTimeInMS?(new Date(L.installTimeInMS)).toISOString():"";Ja={["SDX.Id"]:M,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:va.b(L.targetType)?"":L.targetType.toString(),["SDX.AdminDeploymentTime"]:Ja};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:N.a.pC(Ja)}));1===L.targetType&&(L={["SDX.Id"]:M,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:N.a.pC(L)})))}$1j(L){let M=!1;if(L&&1>L.count)return M;const Ja=Ha();if(!Ja)return M;for(let pb of L)if(pb.storeId&&pb.storeId.toLowerCase()===Ja.toLowerCase()||pb.assetId&&pb.assetId.toLowerCase()===Ja.toLowerCase())L={["SDX_Id"]:La.k5f(pb),["SDX_TargetType"]:va.b(pb.targetType)?
"":pb.targetType.toString()},aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:N.a.pC(L)})),M=!0;return M}q1j(L){if(!(L&&1>L.count))if(this.j6a.Ojg()){var M=this.j6a.i5f();M?(L=this.v0f(L,M),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(L=this.v0f(L,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.j6a.Tqh(L)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}v0f(L,
M){const Ja={};let pb=!1;for(let Tb of L)if(L=La.k5f(Tb))!M||L in M||(this.h4j(Tb,L),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===L.toLowerCase()?pb||(pb=!0,Ja[L]=null):Ja[L]=null;return Ja}h4j(L,M){var Ja=L.installTimeInMS?(new Date(L.installTimeInMS)).toISOString():"";Ja={["SDX.Id"]:M,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:va.b(L.targetType)?"":L.targetType.toString(),["SDX.AdminDeploymentTime"]:Ja};aa.a.sendTelemetryEvent(Object.assign(new F.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.pC(Ja)}));1===L.targetType&&(L={["SDX.Id"]:M,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:N.a.pC(L)})))}vuk(L,M,Ja,pb){L?(-1===pb.targetType&&(pb.targetType=Ja.targetTypeForExp),L=new ve(Ja.targetData,pb),M&&this.context.LPd.add(L),10===this.context.b1&&(this.context.P4d.add(L),0===L.targetType&&this.context.t7a.add(L))):
(M=Ja.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId),M.storeType));this.ded()}$Fa(L){L={["AppTeachingUICalloutAction"]:L,["SDX.Id"]:this.IZe,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(L)}))}static get Msc(){return B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static tQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}static k5f(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}static T4b(L){return Telemetry.PrivacyRules.IsPrivateAddin(L.storeType,L.assetId,null,null,L.storeId)?"private_"+L.installTimeInMS:L.solutionId}}Object(h.a)(La,"AddInCommandsListLoader",null,[]);var gb=d(1128),vc=d(179),td=d(1232),Nd=d(29),Od=d(60);class Oc{constructor(L,
M,Ja){this.Ybb=this.gGa=this.Iea=this.bfb=null;this.uAe=this.g$c=-1;this.nH=null;this.$Rg=!1;this.Qrg=L;this.Pb=M;this.Wrg=this.Pb.Bc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.s5j=this.Pb.Bc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.R2c=this.Pb.Ga("WebAppShortName");this.Lc=Ja;ma.a.Wa(this.R2c)&&(this.R2c="PowerPoint")}tQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}sVk(L){this.nH=L;this.Lc.g6a(Object(E.a)(this,
this.U3g,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(E.a)(this,this.Pyk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(E.a)(this,this.Fsk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(E.a)(this,this.Erk,"onCloseButtonClicked_ContentAddin"),!0)}Guk(){this.Iea&&this.Ybb&&(this.Qrg.k7b({["SourceControlId"]:this.Ybb}),n.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}jkl(L,
M){M?(this.Iea=M.Iu,(this.bfb=M.VJ)&&this.bfb.gaa&&this.bfb.gaa.uF&&(this.gGa=this.bfb.gaa.uF.ga(0)),this.gGa?this.gGa.isOfficeTab?(L=this.Iea.solutionId,M=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),L in M?this.Ybb=M[L]:(n.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.tQ(this.Iea)),this.Ybb=this.F2i(this.bfb)),this.Ybb?0<this.gGa.id.indexOf(Od.a.dfh)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(oa.bwb(this.bfb),
()=>{this.ewh(this.PTc(this.Ybb))}):this.Lc.g6a(Object(E.a)(this,this.H6g,"onTabSwitched")):(this.GVa("NoEnabledButtonFound",this.Iea),n.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.NIa())):this.gwh(this.PTc(this.gGa.id),0):(this.GVa("NoTabFound",this.Iea),n.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.NIa())):this.NIa()}H6g(L,M){!this.gGa||void 0===this.gGa.id||null===this.gGa.id||
0>ma.a.qg(this.gGa.id).indexOf(ma.a.qg(M.W$))||(this.Lc.pKb(Object(E.a)(this,this.H6g,"onTabSwitched")),this.PUd(M.X0g,M.W$,this.Wrg,!1))}U3g(L,M){"Insert"===M.W$&&(this.Lc.pKb(Object(E.a)(this,this.U3g,"onInsertTabSwitched_ContentAddin")),this.PUd(M.X0g,M.W$,this.Wrg,!0))}PUd(L,M,Ja,pb){if(0>Ja)this.GVa("TabSwitchTimeOut",this.Iea);else{var Tb=document.querySelector("button"+this.PTc(M));Tb.hasAttribute("aria-selected")&&"false"!==Tb.getAttribute("aria-selected")?(0<this.uAe&&window.clearTimeout(this.uAe),
pb?this.Eml():this.ewh(this.PTc(this.Ybb))):this.uAe=window.setTimeout(()=>{this.PUd(L,M,Ja-1,pb)},1E3)}}PTc(L){return"[id="+L+"]"}Eml(){let L=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var M=L?window.getComputedStyle(L,null):null;if(!L||M&&"none"===M.display)if(L=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))n.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.bBb("NoAnchor",this.nH);n.ULS.sendTraceTag(512499850,
220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else n.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(M=Bc.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&L?(M.execute(Ja=>{Ja.logActivity("ShowTeachingUIForContentAddin",null)}),this.bBb("Show",this.nH),n.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.bBb("NoSifFutureObject",this.nH),n.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}Pyk(){this.bBb("ClickOnLaunch",
this.nH);this.NIa();const L={};L.solutionId=this.nH.solutionId;L.assetId=this.nH.assetId;L.assetStoreId=this.nH.assetStoreId;L.height=this.nH.height?this.nH.height:600;L.storeId=this.nH.storeId;L.targetType=this.nH.targetType;L.width=this.nH.width?this.nH.width:600;L.displayName=this.nH.displayName;L.version=this.nH.version;L.storeType=this.nH.storeType;L.isAddinCommands=!1;this.Qrg.Jd.MAb("0",3,L)}Erk(){this.bBb("ClickOnClose",this.nH);this.NIa()}Fsk(){this.bBb("ClickOnDismiss",this.nH);this.NIa()}gwh(L,
M){if(M>this.s5j)window.clearTimeout(this.g$c),this.fwh("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Ja=document.querySelector("button"+L);!Ja||Ja.hasAttribute("tabIndex")&&"-1"===Ja.getAttribute("tabIndex")?this.g$c=window.setTimeout(()=>{this.gwh(L,M+1)},1E3):(0<this.g$c&&window.clearTimeout(this.g$c),this.fwh(L))}}ewh(L){let M=document.querySelector("button[data-unique-id='RightPaddle']");
if(M)this.GVa("RightPaddlePresent",this.Iea);else if(L=(M=document.querySelector("button"+L))?window.getComputedStyle(M,null):null,!M||L&&"none"===L.display)if(M=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!M){this.GVa("NoAnchor",this.Iea);n.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.NIa();return}this.ZCh(M,"ShowTeachingUIForAddinButton")}fwh(L){let M=document.querySelector("button"+L);if(!M&&("[data-unique-id='pivotOverflowButton']"!==
L&&(M=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!M)){this.GVa("NoAnchor",this.Iea);n.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.NIa();return}this.ZCh(M,"ShowTeachingUIForAddinTab")}ZCh(L,M){L.setAttribute("lpp-id","latestAddin");const Ja=Bc.a.instance.Ja("Common.ISystemInitiatedFeedback");Ja&&L?(this.GVa("Show",this.Iea),Ja.execute(pb=>{pb.logActivity(M,null)}),n.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):
(this.GVa("NoSifFutureObject",this.Iea),n.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.NIa())}F2i(L){if(!L||!L.gaa||!L.gaa.uF)return null;for(let M of L.gaa.uF)if(M)for(const Ja of M.groups)if(Ja)for(const pb of Ja.controls){if(pb&&pb.attributes&&0===pb.controlType&&pb.enabled)return pb.id;if(pb.menuItems)for(const Tb of pb.menuItems)if(Tb.attributes&&Tb.enabled)return pb.id}return null}GVa(L,M){Oc.hea(L,this.tQ(M))}bBb(L,M){M=Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.storeType,M.assetId,null,null,M.storeId);Oc.hea(L,M)}G_a(L){const M={};M[this.R2c]=fa.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:L});(new qa(this.R2c,null,null,Object(E.a)(this,this.jaa,"postRequestFailureCallback"))).nvb(M);n.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}jaa(L){n.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",
L?L.oe:-1)}NIa(){if(!this.$Rg){const L=window.g_roamingAddinList;L&&(this.G_a(L),this.$Rg=!0)}}static hea(L,M){L={["AppTeachingUICalloutAction"]:L,["SDX.Id"]:M,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};aa.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.pC(L)}))}}Object(h.a)(Oc,"AddinTeachingCalloutHandler",null,[]);class Af{}Object(h.a)(Af,"AddinCommandsHost",null,[]);var Ae=d(82),Ye=
d(134);class Wd extends Ae.a{constructor(){super(void 0,void 0,void 0,!0);this.FRb="AddinCommandsUILessDialog";this.uMd="WACDialogTitleText";this.rba="0";this.eS=380;this.lha=190;this.hg=this.FRb;this.xd=5;this.aPh=String.format("{0}px",this.eS);this.qba=String.format("{0}px",this.lha);this.Ibe=this.Ar=!1;this.pu()}pu(){super.pu();this.fm.style.width=this.aPh;this.fm.style.height=this.qba;this.fm.style.padding=this.rba}yya(L){this.AA();document.getElementById(this.Nh(this.uMd)).innerText=L}AA(){super.AA();
this.Gb.style.width=String.format("{0}px",this.eS);this.Gb.style.height=String.format("{0}px",this.lha);this.Gb.removeAttribute(Ye.a.ef);this.Gb.removeAttribute(Ye.a.P2)}hide(){this.yce()}get Bja(){return this.fm}initializeAndShowWithTitle(){this.Zi(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Wd,"AddinCommandsUILessDialog",Ae.a,[876]);var je=d(42),dg=d(161),nf=d(39),Cb=d(333);class Cf extends Af{constructor(L,M,Ja,pb){super();this.kF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&
B.AFrameworkApplication.Aa.hb.eX;this.l$=L;this.Yc=M;this.o6c=Ja;this.Lfb=pb}setOwnerAddinEToken(L){this.l$.eToken=L}showTaskpane(L,M,Ja){n.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.Meg(L,M,Ja,!0)||n.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(L,M,Ja){n.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.Meg(L,M,Ja,!1,this.o6c)||n.ULS.sendTraceTag(509699667,
806,10,String.format("UILess : instance id is null."))}disposeHost(){}Meg(L,M,Ja,pb,Tb=!1){var Wc=this.Yc.pQ(L.solutionId);Wc||(Wc=this.Yc.lYi(L,M,this.l$.solutionId,Tb));if(Wc&&this.Yc.oua(Wc.instanceId))return this.Yc.Iib(Wc.instanceId),Ja(Wc.instanceId,0),Tb||this.Yc.yLb(Wc.instanceId,pb),!0;let sd=null;if(!Wc)if(Wc=this.Yc.Fji(L,M,pb,this.l$.solutionId,Tb),Wc.setValue(nf.a.ownerAddinStoreType,this.l$.storeType),sd=Wc.sa(dg.a.sharedRuntimeId,null),this.Sqg(!!sd,!0),Tb&&(Tb=Tb&&!sd),M=Tb?new Wd:
null,Tb?this.Yc.okb(Wc,M.Bja):(Wc.setValue(je.a.fZb,pb||!!sd),this.Yc.djh(Wc)),Wc=this.Yc.pQ(L.solutionId))if(Tb&&this.Lfb.$(Wc.instanceId,M),L=this.Yc.HDa(this.l$.solutionId)){if(L=new Cb.a(L),this.Yc.UFh(L.id,Wc.instanceId),sd&&!this.Yc.h4b(L.Sxa)&&(L=this.Yc.t5d(L.Sxa)))L.ew||L.t4h(sd),this.Yc.cGc(this.l$.solutionId,L)}else{L=this.Yc.Eji(this.l$,sd);if(!L)return Ja(null,5001),!1;this.Yc.cGc(this.l$.solutionId,L);this.j1j(!!sd)}else return Ja(null,5001),!1;Ja(Wc.instanceId,0);this.kF&&(Ja=this.Yc.oua(Wc.instanceId),
this.Yc.yLb(Wc.instanceId,Ja?pb:!0));this.Sqg(!!sd,!1);return!0}Sqg(L,M){L&&window.performance&&window.performance.memory&&n.ULS.sendTraceTag(509699666,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",M,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}j1j(L){n.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(this.l$.solutionId,this.l$.storeType,this.l$.assetId,null,null,this.l$.storeId),this.l$.storeType,L)}}Object(h.a)(Cf,"WACPowerPointAddInCommandsHost",Af,[]);var of=d(189);class Lg{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed,ee,kb,cf){this.nH=this.YUg=null;if(!L)throw Error.argumentNull("app");this.ula=new D;this.oug=Ja;this.Rb=L.wq;this.he=sd;this.Yc=M;this.vla=Wc;this.Yc.m$h(Object(E.a)(this,this.tti,"clearLoadingAddinMessage"));this.ula.w8h(Object(E.a)(this,this.bqj,
"handleAddinCommandsLoadingMessageChanged"));this.Ha=pb;this.Pb=Tb;gb.a.d8b=gb.a.Eah;this.Lfb=new oc.a;this.qWa=ee;this.gl=kb;this.a7j=new e.a;this.SBb=new e.a;this.Lc=cf}get Jd(){return this.Yc}x1c(L){n.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",L[O.a.P7]);if(this.Ha.o$b||!this.Ha.Hia){var M=L[O.a.NGc];if(M&&0<M.count){const pb=M.count;for(let Tb=pb-1;0<=Tb;Tb--){const Wc=M.ga(Tb);OSF.OsfControl.isFirstPartyStoreString(Wc.storeType)||M.remove(M.ga(Tb))}M.count<pb&&(this.Ha.o$b&&
!this.gl.Lda(22)&&this.gl.iDa(22),this.Ha.Hia||this.gl.Lda(36)||this.gl.iDa(36));if(!M.count)return}}let Ja=null;Ja=B.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Hc(this.vla,this.oug,new $b(this.Yc.vl),new Db("",wc.a.$5a),this.ula,dd.instance,new Cd,(pb,Tb)=>{const Wc={};Wc.solutionId=pb.solutionId;Wc.version=pb.version;Wc.storeType=pb.storeType;Wc.storeId=pb.storeId;Wc.assetId=pb.assetId;Wc.assetStoreId=pb.assetStoreId;this.Yc.Mml(Wc,()=>{Tb(pb)})}):new Hc(this.vla,this.oug,new $b(this.Yc.vl),
new Db("",wc.a.$5a),this.ula,dd.instance,new Cd);Ja.I8h(Object(E.a)(this,this.Tqk,"onAutoLaunchAddin"));Ja.v8h(Object(E.a)(this,this.Huk,"onLaunchAddinCommandsCompleted"));this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(M=new Oc(this,this.Pb,this.Lc),Ja.r9h(Object(E.a)(M,M.Guk,"onLaunchAddinButtonClicked")),Ja.Nai(Object(E.a)(M,M.jkl,"showCalloutOnAddin")));try{vc.a.get_instance().ek(5,null).continueWith(()=>{Ja.hZj(this.qWa,Nd.App.Kb.FF(),L)},
11)}catch(pb){n.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",pb.message))}}$pj(L){L=L[this.vla.LQa];L=(new Ge).PNd(L);return B.AFrameworkApplication.Hia||OSF.OsfControl.isFirstPartyStoreString(L.ownerAddinInfo.storeType)}k7b(L){const M=new Ge;this.Uae(M,L[this.vla.LQa])}Uae(L,M){const Ja=L.PNd(M),pb=new Cf(Ja.ownerAddinInfo,this.Yc,this.Ha.Jka,this.Lfb);L.k7b(M,this.ula,pb,new $b(this.Yc.vl),Ja)}Wch(L){const M=Xf.$Lk(this.ula);L[td.a.LabelText]=M.labelText;
L[td.a.Visible]=M.visible}Xjl(){this.HYe()}LMb(L){L&&O.a.OPd in L&&L[O.a.OPd]&&Gb.gYe(L[O.a.OPd].toString())}KSk(){if(this.ula.S1c()){this.ula.REf();const L=this.y5d();if(L&&0<L.count)for(let M of L)this.HKb({["ack1"]:M,["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(n.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.ula.S1c()),this.maa(10,
!0),this.maa(0,!0))}bqj(){this.he.Dy(new of.a(2));this.HYe()}zLk(L){L&&O.a.Q7 in L?this.maa(L[O.a.Q7],!0):n.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}maa(L,M=!1){this.Yc?(n.ULS.sendTraceTag(509669716,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",L,M),this.Yc.maa(L,M)):n.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}HKb(L){n.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
L[O.a.P7],L[O.a.Q7]);this.ula.E9k();window.setTimeout(()=>{const M=new La(new $b(this.Yc.vl),dd.instance,eb.instance);M.u8h((Ja,pb)=>{this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.maa(L[O.a.Q7]);this.x1c(pb.properties)});M.Pai((Ja,pb)=>{this.nH=pb;this.YUg=new Oc(this,this.Pb,this.Lc);this.YUg.sVk(this.nH)});M.Wzl(L)},0)}tti(){this.ula.REf()}$gi(L){var M=this.Yc.pQ(L);if(M&&M.ew&&M.ew.kya&&!(0>=M.ew.state)){var Ja=new Ge,pb=Ja.getTaskPaneControlIdFromSolutionIdRuntimeId(L,
M.ew.kya);pb&&(this.Yc.cGc(L,M),this.Uae(Ja,pb),this.Yc.WFf(L),(M=this.Yc.pQ(L+pb))?this.Yc.setInitialDisplayMode(M.instanceId,1):n.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+L))}}dhi(L){if(L&&L.solutionId){var M=new Ge,Ja=M.ehi;if(Ja=L.solutionId in Ja?Ja[L.solutionId]:null){let pb=this.Yc.pQ(L.solutionId);if(!pb){pb=this.Yc.t5d(L.solutionId);if(!pb){n.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,
L.storeType,L.assetId,null,null,L.storeId)));return}this.Yc.cGc(L.solutionId,pb)}L=pb.settings;(L=O.a.Yuf in L?L[O.a.Yuf]:null)&&"true"===L.toLowerCase()&&this.Uae(M,Ja)}}else n.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}Ygl(L){if(void 0===L||null===L||void 0===L[this.vla.LQa]||null===L[this.vla.LQa])return!1;L=L[this.vla.LQa];return ma.a.Wa(L)?!1:this.SBb.contains(L)}Ncl(L){L=L.gaa;if(!L)n.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");
else if(L.uF)for(let M of L.uF)if(M.groups)for(const Ja of M.groups)if(Ja.controls)for(const pb of Ja.controls)if(this.s0e(pb.id,pb.enabled),1===pb.controlType&&pb.menuItems)for(const Tb of pb.menuItems)this.s0e(Tb.id,Tb.enabled)}s0e(L,M){if(L&&L.length){var Ja=this.SBb.contains(L);Ja&&M&&this.SBb.remove(L);Ja||M||this.SBb.add(L)}}WCl(L){let M=null,Ja=null,pb=!0;void 0!==L[O.a.F0d]&&null!==L[O.a.F0d]&&void 0!==L[this.vla.LQa]&&null!==L[this.vla.LQa]&&void 0!==L[O.a.D0d]&&null!==L[O.a.D0d]&&(M=L[O.a.F0d],
Ja=L[this.vla.LQa],pb=L[O.a.D0d]);ma.a.Wa(M)||ma.a.Wa(Ja)||(L=(new db("",M,this.vla,!0)).YDa(Ja),this.s0e(L,pb),this.Rb.updateCommandUI())}I3b(L){if(void 0!==L&&null!==L&&void 0!==L[O.a.E0d]&&null!==L[O.a.E0d])switch(L[O.a.E0d]){case 1:this.WCl(L);break;case 4:this.SBb.clear(),this.SBb.addRange(this.a7j)}}Tqk(L,M){if(M)if(M)if(L=M.Iu,M=M.VJ,!Ya()&&!ka()||this.Yc.t5d(L.solutionId)){var Ja=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(M=L.solutionId in Ja?Ja[L.solutionId]:
this.r6i(M))?(this.k7b({["SourceControlId"]:M}),L.isAutoLaunched=!0):n.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else n.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)));else n.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else n.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}r6i(L){if(!L)return n.ULS.sendTraceTag(512499859,
220,10,"Failed to get button id for addin"),null;L=L.gaa;if(!L||!L.uF||!L.uF.count)return n.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;L=L.uF.ga(0);if(!L.groups||1!==L.groups.length)return n.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;L=L.groups[0];if(!L.controls||1!==L.controls.length)return n.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;L=L.controls[0];return L.attributes&&0===L.controlType&&L.enabled?L.id:null}Huk(L,M){let Ja=
null;M&&(Ja=M);Ja&&Ja.VJ&&this.Ncl(Ja.VJ);Ja?(Ja.Iu&&this.$gi(Ja.Iu.solutionId),this.Ha.xIj&&window.setTimeout(()=>{Ja.Iu&&this.dhi(Ja.Iu)},0)):n.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}y5d(){const L=new e.a;this.Ha.aua&&(this.Ha.oie&&L.add(0),this.Pb.ka("187")&&L.add(1),this.Pb.ka("305")&&L.add(10),L.add(8));return L}HYe(){const L=this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",
!1),M=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");Xf.Ovh(this.ula,this.Rb.FF(),M,L?ResourceStrings.L_TabHome:ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}wrc(L){L&&this.Lfb.Hb(L)&&this.Lfb.ga(L).initializeAndShowWithTitle()}a8b(L){L&&this.Lfb.Hb(L)&&this.Lfb.ga(L).hide()}}Object(h.a)(Lg,"AddinCommandsManager",null,[843]);class vd{constructor(){this.DUg={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",
["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.SGg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};
this.w8c=null}get LQa(){return"SourceControlId"}get nT(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}Hcj(){if(!this.w8c){this.w8c={};for(const L of Object.keys(this.DUg))this.w8c[L]=this.DUg[L];for(const L of Object.keys(this.SGg))this.w8c[L]=this.SGg[L][0]}}}Object(h.a)(vd,"AddinCommandsStringProvider",null,[842]);class Lh{constructor(L){this.Szi=L}o1i(){return this.Szi.Uji()}}Object(h.a)(Lh,"ContextMenuExtensibilityHandler",null,[841]);var tf=d(81),Ue=d(35);class ff{constructor(L,
M,Ja,pb){this.Txe=null;this.Yc=L;this.VUg=M;this.pa=Ja;this.Pg=pb}get Lac(){return this.Txe}set Lac(L){this.Txe=L}register(){this.pa.wF(Object(E.a)(this,this.Nnd,"selectionChangeEventHandler"));Ue.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Pg.hrb(Object(E.a)(this,this.Nnd,"selectionChangeEventHandler"))}dispose(){this.pa.aya(Object(E.a)(this,this.Nnd,"selectionChangeEventHandler"));Ue.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Pg.xld(Object(E.a)(this,this.Nnd,"selectionChangeEventHandler"))}Nnd(){try{this.Lac&&
this.VUg.Lg(this.Lac),this.Txe=new tf.a(4,1,0,()=>{this.Lac=null;this.Hxl()},90,"50"),this.VUg.Db(this.Lac)}catch(L){n.ULS.sendTraceTag(18442309,802,10,L.toString())}}Hxl(){try{this.Yc.Sdh(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const M=this.pa.tk();if(M){var L=M.Ek();if(L)for(const Ja of L)if(Ja.Dq){const pb=new Cb.a(Ja);this.Yc.ZZa(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),pb.id,null)}}}catch(M){n.ULS.sendTraceTag(18442310,802,10,M.toString())}}}
Object(h.a)(ff,"AppForOfficeApiSelectionChangeEventListener",null,[830,106]);var Ef=d(548),wh=d(974),xh=d(722);class qd{}qd.generalException="generalException";qd.invalidArgument="invalidArgument";qd.notAllowed="notAllowed";qd.apiNotAvailable="apiNotAvailable";qd.unresolvedPendingRequest="unresolvedPendingRequest";qd.timeout="timeout";qd.adalTimeout="adalTimeout";qd.userNotSignedIn="userNotSignedIn";qd.userAborted="userAborted";qd.silentSignInFailed="silentSignInFailed";qd.invalidResourceUrl="invalidResourceUrl";
qd.invalidGrant="invalidGrant";qd.connectionLost="connectionLost";qd.clientError="clientError";qd.serverError="serverError";Object(h.a)(qd,"WopiHostErrorCodes",null,[]);var Hf=d(226);class Ag{}Object(h.a)(Ag,"OAuthCallerMetadata",null,[]);var He=d(55);class af{constructor(L){this.cM=L;this.KQh=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}R3h(L,M,Ja,pb,Tb,Wc){if(!this.cM)return pb=new wh.a,pb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(pb);const sd=new Ag;sd.AddinName=Tb;sd.AddinTrustId=Wc;let Ed=-1;Wc=null;if(pb&&this.wjg())Wc=this.cM.NDh(O.a.Jsd,L,pb,af.n5f(Tb),sd);else{const ee=Date.now();Wc=this.cM.nV(O.a.Jsd,L,sd).then(kb=>{Ed=Date.now()-ee;const cf=(M||Ja)&&"login_required"===kb.ErrorCode;return(M&&("interaction_required"===kb.ErrorCode||"consent_required"===kb.ErrorCode||"invalid_grant"===kb.ErrorCode)||cf)&&this.wjg()?this.cM.NDh(O.a.Jsd,L,null,af.n5f(Tb),sd):Promise.resolve(kb)})}return Wc.then(ee=>{const kb=
new wh.a;ee.IsSuccess?(kb.token=ee.Token,ee.Telemetry&&(kb.tlb=ee.Telemetry.fromCache,kb.expiresOn=ee.Telemetry.expiresOn)):(kb.errorCode=this.Njk(ee),kb.X0e=this.kCk(ee));return kb}).catch(()=>{const ee=new wh.a;ee.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(ee)}).then(ee=>{ee.eCa="OauthManager";0<=Ed&&(ee.P6b=Ed);return ee})}yMj(L){const M=(B.AFrameworkApplication.fa.Ga(B.AFrameworkApplication.eK)||"").toLowerCase();return(He.a.NFa||"teams"===M&&Hf.OAuthManagerSettings.Q$a)&&
!af.TLj(L)||!this.cM||!this.cM.rJj()?!1:!0}wjg(){return this.KQh||1!==xh.a.qRc()}Njk(L){switch(L.ErrorCode){case "UserCancelled":case "interaction_required":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":L=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:L=L.ErrorCode===qd.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:L.ErrorCode===qd.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:L.ErrorCode===qd.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:L.ErrorCode===qd.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:L.ErrorCode===qd.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return L}kCk(L){let M="";(L=RegExp("AADSTS(\\d+)").exec(L.ErrorMessage))&&1<L.length&&(M=L[1]);return M}static n5f(L){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,L)}static TLj(L){if(!L)return!1;L=L.toLowerCase();for(const M of Ef.AppsForOfficeSingleSignOnManager.dQc)if(M===
L)return!0;return!1}}Object(h.a)(af,"AppsforOfficeTokenFromOauthManager",null,[952]);class yd{constructor(L){this.Vhk=L}static n3e(){if(B.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var L=null;try{L=Bc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(M){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+M)}L=new af(L);yd.Ka=new yd(L)}}static getInstance(){yd.Wdf||(yd.n3e(),yd.Wdf=!0);return yd.Ka}}yd.Ka=null;yd.Wdf=!1;Object(h.a)(yd,"AppsForOfficeOauthManagerFactory",
null,[911]);class me{constructor(L){const M=yd.getInstance();this.Fof=new Ef.AppsForOfficeSingleSignOnManager(L,M)}getAccessTokenAsync(L,M){return new Promise(Ja=>{const pb=B.AFrameworkApplication.fa.ka("342");this.Fof.getAccessToken(L,pb,M,(Tb,Wc)=>{const sd={};sd.errorCode=Tb;sd.accessToken=Wc?Wc.accessToken:"";Ja(sd)})})}removeCallbackForAddin(L){this.Fof.removeCallbackForAddin(L)}}Object(h.a)(me,"AppForOfficeAuthProvider",null,[860]);class Ic{cCi(L){return new me(L)}}Object(h.a)(Ic,"AppForOfficeAuthFactory",
null,[796]);var Fe=d(234),Uc=d(63),Uf=d(49),vg=d(627);class Yg{constructor(L,M,Ja,pb,Tb,Wc,sd){this.GBe=this.FBe=this.oze=this.nze=0;this.WHg=.5;this.rDb=null;this.lve=0;this.I5j={};this.Xfc=document.createElement("div");this.Xfc.className="OsfAddinOverlay";M.appendChild(this.Xfc);Ja.Fal(this.Xfc);this.cjk=L;this.BJ=sd;this.BJ.qGc(Object(E.a)(this,this.xHb,"onZoomed"));this.ua=pb;this.Kc=Tb;this.Nq=Wc;this.Nq.aW(Object(E.a)(this,this.mQe,"registerSlideViewElementEvents"))}dispose(){this.BJ.lld(Object(E.a)(this,
this.xHb,"onZoomed"));this.Nq.ioa(Object(E.a)(this,this.mQe,"registerSlideViewElementEvents"))}initialize(){if(this.ua.Ba){this.mQe(null,null);const L=this.Kc.Ic;L&&(this.nze=parseFloat(L.CU.style.left),this.oze=parseFloat(L.CU.style.top),this.FBe=parseFloat(L.te.xa.style.left),this.GBe=parseFloat(L.te.xa.style.top))}this.V4e();this.xHb(null,new vg.a(this.cjk.zoom))}mQe(L,M){(L=this.Kc.Ic)&&L!==this.rDb&&(L.Xai(Object(E.a)(this,this.gHh,"updateOffsetFromSlideView")),L.W$h(Object(E.a)(this,this.fHh,
"updateOffsetFromPageContentContainer")),this.rDb&&(this.rDb.RZk(Object(E.a)(this,this.gHh,"updateOffsetFromSlideView")),this.rDb.nZk(Object(E.a)(this,this.fHh,"updateOffsetFromPageContentContainer")),this.r0e(this.rDb,!1)),M&&M.c0c&&1!==this.lve&&this.r0e(L,!0),this.rDb=L)}r0e(L,M){if(L&&(L=L.Fd)&&L.isConnected){var Ja=L.Ek();if(Ja&&Ja.length)for(const Tb of Ja)if(Tb.Dq){Ja=Tb.sa(nf.a.KZ,null);var pb=Uc.a.UE(L.eb(nf.a.sid),L.eb(nf.a.cid)).toString();const Wc=Tb.get_shapeId().toString();Ja=Ja+Wc+
pb;Ue.a("Microsoft.Office.SharedOnline.FixBug6808089")?(pb=Tb.mg(0),(null===pb||void 0===pb?0:pb.xa)?this.QKa(Ja,M,pb.xa.pe):this.QKa(Ja,M,null)):this.QKa(Ja,M,null)}}}r6(L){this.lve=L;const M=this.Kc.Ic;M?(n.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",M.Fd.sid,M.Fd.cid),this.r0e(M,2===L)):n.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}fHh(L,
M){this.nze=M.x;this.oze=M.y;this.V4e()}gHh(L,M){this.FBe=M.x;this.GBe=M.y;this.V4e()}V4e(){this.Xfc.style.left=Uf.a.Pc(this.nze+this.FBe+Fe.a.l6-this.WHg);this.Xfc.style.top=Uf.a.Pc(this.oze+this.GBe+Fe.a.l6-this.WHg)}bJj(L){return L in this.Bra}d5k(L,M){this.Bra[L]=M}QKa(L,M,Ja){1===this.lve&&M||L in this.Bra&&this.Bra[L].QKa(M,Ja)}ehh(L){L in this.Bra&&(this.Bra[L].dispose(),delete this.Bra[L])}WUe(L,M){L in this.Bra&&this.Bra[L].WUe(M)}xHb(){}get Bra(){return this.I5j}}Object(h.a)(Yg,"AppForOfficeContentAppsContainer",
null,[839,106]);var Cc=d(402);class Rc extends y.StandardDialog{constructor(L,M){super();this.qOh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.bRh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.cRh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.ZPh=L;this.ERb=M}showDialog(L,M){const Ja=new Ae.a(void 0,void 0,!1);Ja.xd=0;Ja.hg=Cc.a.wkd(Number.MAX_VALUE).toString();Ja.rg=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
M,this.cRh,this.bRh,this.qOh);Ja.Zi(L,Object(E.a)(this,this.zrk,"onCheckboxExecute$4"),{optInCheckbox:!1})}zrk(L,M){1===L&&M.optInCheckbox&&(v.a.instance.getItem("optedIntoAddinDeveloperMode")?v.a.instance.removeItem("optedIntoAddinDeveloperMode"):(v.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Arc()))}Arc(){const L=new y.StandardDialog;L.xd=4;const M=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.ZPh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;L.fP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,M,this.ERb)}}Object(h.a)(Rc,"AppForOfficeDeveloperModeOptInDialog",y.StandardDialog,[]);const Ve=L=>{const M=[];if(!L)return M;M[OSF.DDA.Marshaling.ThemingKeys.Accent1]=ob(L.Accent1);M[OSF.DDA.Marshaling.ThemingKeys.Accent2]=ob(L.Accent2);M[OSF.DDA.Marshaling.ThemingKeys.Accent3]=ob(L.Accent3);M[OSF.DDA.Marshaling.ThemingKeys.Accent4]=ob(L.Accent4);M[OSF.DDA.Marshaling.ThemingKeys.Accent5]=
ob(L.Accent5);M[OSF.DDA.Marshaling.ThemingKeys.Accent6]=ob(L.Accent6);M[OSF.DDA.Marshaling.ThemingKeys.Background1]=ob(L.OsfColorScheme?L.OsfColorScheme.Background1:null);M[OSF.DDA.Marshaling.ThemingKeys.Background2]=ob(L.OsfColorScheme?L.OsfColorScheme.Background2:null);M[OSF.DDA.Marshaling.ThemingKeys.Text1]=ob(L.OsfColorScheme?L.OsfColorScheme.Text1:null);M[OSF.DDA.Marshaling.ThemingKeys.Text2]=ob(L.OsfColorScheme?L.OsfColorScheme.Text2:null);M[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=ob(L.Hyperlink);
M[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=ob(L.FollowedHyperlink);const Ja=L.OsfFontScheme;Ja&&(M[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Ja.HdEaFt,M[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Ja.HdLtnFt,M[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Ja.HdLclFt,M[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Ja.HdSptFt,M[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Ja.BdEaFt,M[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Ja.BdLtnFt,M[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Ja.BdLclFt,M[OSF.DDA.Marshaling.ThemingKeys.BdScript]=
Ja.BdSptFt);M[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=ob(L.Background);return M},ob=L=>{if(!L)return null;let M;M=L.b;M+=L.g<<8;return M+=L.r<<16};class Mb{constructor(L,M,Ja){this.aIg=L;this.UQ=M;this.e8j=Ja}register(){this.aIg.jk(Object(E.a)(this,this.DBh,"themeChangedCallback"))}dispose(){this.aIg.Cm(Object(E.a)(this,this.DBh,"themeChangedCallback"))}DBh(L,M){if(M.node.Sa(nf.a.ke)&&(M.property===nf.a.ke||M.property===nf.a.eba)){L=M.node;try{var Ja=Ve(L?L.ke:null)}catch(pb){return}if(L){L=
L.Ek();for(const pb of L)pb.Dq&&(L=this.e8j.b3(pb),this.UQ.ZZa(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),L.id,Ja))}this.UQ.Sdh(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Ja)}}}Object(h.a)(Mb,"AppForOfficeDocumentThemeListener",null,[830,106]);var nc=d(220);class Qc extends Ae.a{constructor(L,M,Ja){super();this.Zqa=null;this.uMd="WACDialogTitleText";this.rba="0";this.Npa="15px";this.$Oh="0px";this.qba="calc(100% - 30px)";this.ZOh="100%";this.hmf=0;this.Pa=new P.a;
this.IMh=new G;this.xd=5;this.hg=this.FRb=Ja;this.Rzd=L;this.H$e=M;this.sAd=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}V9h(L){this.Pa.addHandler("OnDialogClosedEventKey",L)}ubl(){this.nqa=null}pu(){super.pu();this.fm.style.width="100%";this.fm.style.height=this.R7b?this.qba:this.ZOh;this.fm.style.marginTop=this.R7b?this.Npa:this.$Oh;this.fm.style.padding=this.rba}AA(){super.AA();this.Gb.style.width=String.format("{0}px",this.Rzd*window.innerWidth/
100);this.Gb.style.height=String.format("{0}px",this.H$e*window.innerHeight/100);this.Gb.style.minWidth="0px";this.sAd&&B.AFrameworkApplication.isRtl&&100===this.Rzd&&(this.Gb.style.right="0px",this.Gb.style.marginRight="0px");this.Zqa=document.getElementById(this.Nh(this.uMd));this.Zqa.style.position="absolute";this.Zqa.style.whiteSpace="nowrap";this.Zqa.style.textOverflow="ellipsis";B.AFrameworkApplication.isRtl?(this.Zqa.style.right="14px",this.Zqa.style.left="44px"):(this.Zqa.style.right="44px",
this.Zqa.style.left="14px")}yya(L){super.yya(L);this.Zqa&&this.Zqa.setAttribute("title",L)}get Bja(){return this.fm}kSe(){this.Gb.style.width=String.format("{0}px",this.Rzd*window.innerWidth/100);this.Gb.style.height=String.format("{0}px",this.H$e*window.innerHeight/100);this.Gb.style.overflowY="hidden";this.Gb.style.overflowX="hidden";this.Gb.style.marginTop="";this.Gb.style.top="";He.a.Uab&&B.AFrameworkApplication.isRtl?(this.Gb.style.right="",this.Gb.style.marginRight=""):(this.Gb.style.left="",
this.Gb.style.marginLeft="")}hide(){this.IMh.fJf(3,this.FRb).execute(this,S.getInstance(),{});this.hmf=window.setTimeout(()=>{this.Pa.raiseEvent("OnDialogClosedEventKey",this.FRb);nc.a.prototype.hide.call(this)},500)}v4g(L){3===L&&(window.clearTimeout(this.hmf),this.Pa.raiseEvent("OnDialogClosedEventKey",this.FRb),super.hide())}}Object(h.a)(Qc,"AppsForOfficeDialog",Ae.a,[700,701]);class id{constructor(){this.dialog=this.hg=null}}Object(h.a)(id,"DialogInfo",null,[]);class ld{}ld.url="url";ld.height=
"height";ld.width="width";ld.S_d="displayInIframe";ld.lWc="hideTitle";Object(h.a)(ld,"DialogSettings",null,[]);class xd{constructor(){this.height=this.width=0;this.hg=this.controlId=this.pageUrl=null;this.lWc=this.S_d=!1}}Object(h.a)(xd,"DisplayDialogParams",null,[]);class ue extends Sys.EventArgs{constructor(L,M,Ja=null,pb="",Tb=""){super();this.controlId=L;this.messageType=M;this.messageContent=Ja;this.dEe=pb;this.KLa=Tb}}Object(h.a)(ue,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class Rd extends Sys.EventArgs{constructor(L,
M,Ja=null,pb="",Tb=""){super();this.controlId=L;this.messageType=M;this.messageContent=Ja;this.dEe=pb;this.KLa=Tb}}Object(h.a)(Rd,"OnMessageParentEventArgs",Sys.EventArgs,[]);var ce=d(106);class Ne{constructor(L){this.Pa=new P.a;this.aN=L}r$h(L){this.Pa.addHandler("OnMessageParentEventKey",L)}wih(L){this.Pa.removeHandler("OnMessageParentEventKey",L)}q$h(L){this.Pa.addHandler("OnMessageDialogEventKey",L)}SYk(L){this.Pa.removeHandler("OnMessageDialogEventKey",L)}showDialog(L,M,Ja,pb){if(Ne.Cpa.Hb(M))n.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const cf=fa.b(L),Tf=cf[ld.url];if(this.aN.getOsfControl(M).checkAppDomains(Tf)){var Tb=new xd;Tb.width=cf[ld.width];Tb.height=cf[ld.height];Tb.pageUrl=Tf;Tb.S_d=cf[ld.S_d];Tb.lWc=cf[ld.lWc];Tb.controlId=M;Tb.hg=ce.a.create().toString();var Wc=new id;Wc.hg=Tb.hg;var sd=this.aN.getOsfControl(Tb.controlId).getManifest().getDefaultDisplayName(),Ed=this.aN.getOsfControl(Tb.controlId).getStoreType().toLowerCase();
L=null;L=(4===B.AFrameworkApplication.Aa.hb.Uk&&"hardcodedpreinstall"===Ed||"sdxcatalog"===Ed)&&Tb.lWc?this.createAndShowAppsForOfficeDialog(Tb.width,Tb.height,Tb.hg,!0,sd):this.createAndShowAppsForOfficeDialog(Tb.width,Tb.height,Tb.hg,!1,sd);var ee=this.aN.getOsfControl(Tb.controlId),kb=ee.getManifest();M={};M.id=Tb.hg;M.solutionId=ee.getSolutionId();M.version=ee.getVersion();M.storeType=Ed;M.storeId=ee.getStoreId();M.assetId=ee.getAssetId();M.assetStoreId=ee.getAssetStoreId();M.ownerAddinSolutionId=
ee.getOwnerAddinSolutionId();M.ownerAddinStoreType=ee.getOwnerAddinStoreType();M.appDomains=kb.getAppDomains();M.dialogUrl=Tf;M.osfControlType=1;M.agaveName=sd;M.div=L.Bja;n.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),ma.a.qN(Tb.pageUrl));this.aN.insertDialogControl(M);L.V9h(Object(E.a)(this,this.rsk,"onDialogClosed"));Wc.dialog=L;Ne.Cpa.$(Tb.controlId,
Wc);pb&&pb(M);Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else n.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(cf){n.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",cf.message),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Wlk(L,M,Ja,pb){B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===pb&&(pb=Ja);try{const Tb=this.YDa(L);Tb&&this.Pa.raiseEvent("OnMessageParentEventKey",new Rd(Tb,OSF.DialogMessageType.DialogMessageReceived,M,Ja,pb))}catch(Tb){return n.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Tb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}vui(L,M){if(Ne.Cpa.Hb(L))try{const Ja=Ne.Cpa.ga(L);Ja.dialog&&Ja.dialog.hide();this.aN.purgeDialogControl(Ja.hg);
Ne.Cpa.remove(L);M(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ja){n.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ja.message),M(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else n.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),M(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}T7k(L,M,Ja,pb){B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===pb&&(pb=Ja);if(Ne.Cpa.Hb(L)&&(L=Ne.Cpa.ga(L),L.dialog))try{this.Pa.raiseEvent("OnMessageDialogEventKey",new ue(L.hg,OSF.DialogMessageType.DialogParentMessageReceived,M,Ja,pb))}catch(Tb){n.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Tb.message)}}YDa(L){let M=null;for(let Ja of Ne.Cpa)if(Ja.value.hg===L){M=Ja.key;break}return M}rsk(L,M){if(L=this.YDa(M))this.aN.purgeDialogControl(M),Ne.Cpa.remove(L),this.Pa.raiseEvent("OnMessageParentEventKey",
new Rd(L,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(L,M,Ja,pb,Tb){L=new Qc(L,M,Ja);Tb=pb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Tb);pb&&(L.R7b=!1,L.Ar=!1);L.Zi(Tb,null,null);L.ubl();return L}static R8f(){return Ne.Cpa}static getInstance(L){Ne.Ka||(Ne.Ka=new Ne(L));return Ne.Ka}}Ne.Ka=null;Ne.Cpa=new oc.a;Object(h.a)(Ne,"AppsForOfficeDialogManager",null,[667]);var oe=d(717),Yd=d(67),Id=d(121),zf=d(95),od=d(173),gf=d(124);class Lf extends Sys.EventArgs{constructor(L){super();
this.nca=L}}Object(h.a)(Lf,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var ke=d(48);class vf{constructor(L,M,Ja,pb,Tb,Wc){this.TQ=[];this.iDe=new oe.a;this.kF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.eX;this.QX=L;this.V9j=this.QX.firstChild;this.Ea=M;this.Lr=Ja;this.ob=pb;this.Yc=Tb;this.he=Wc}get M2(){return this.TQ}get Jd(){return this.Yc.value}Fbe(){return 0<this.Ajc}RP(L){if(L){this.M2.push(L);var M=L.xa;M&&!this.kF&&this.QX.insertBefore(M,
this.V9j);1===this.Ajc&&this.Ea.Cj(gf.a.gTd,!0);L.isVisible&&this.Lr.addHandler(L.xa,Yd.a.Yf,Object(E.a)(this,this.qag,"handleShortCutsOnAddinPane"))}}Ehh(L){L&&(Array.remove(this.TQ,L),L=L.xa,this.Lr.removeHandler(L,Yd.a.Yf,Object(E.a)(this,this.qag,"handleShortCutsOnAddinPane")),L&&!this.kF&&this.QX.removeChild(L),this.Ajc||this.Ea.Cj(gf.a.gTd,!1))}r6(L){if(1===L||2===L){if(1===L){this.iDe=new oe.a;for(const M of this.M2)M.isVisible&&this.iDe.add(M.id.toLowerCase())}L=2===L;for(const M of this.M2)this.iDe.contains(M.id.toLowerCase())&&
(M.xp(L),(L&&1===this.Ajc||!L&&!this.Ajc)&&this.Ea.Cj(gf.a.gTd,L))}}gtj(L,M){for(const Ja of this.TQ)L=Ja.layout(L,M)}zU(L,M){if(L){L=null;if(M===ke.a.sg)for(M=this.TQ.length-1;0<=M;M--){if(this.TQ[M].isVisible){L=this.TQ[M];break}}else if(M===gf.a.hBf||M===gf.a.Wli||M===Id.AFrame.VV||M===Id.AFrame.s4b||M===gf.a.T2||M===gf.a.ami||M===ke.a.ME||M===ke.a.QI||M===ke.a.FW)for(M=0;M<this.TQ.length;M++)if(this.TQ[M].isVisible){L=this.TQ[M];break}this.i4d(L)}}i4d(L){if(L){var M=this.Jd.WPc(L.id);M&&this.he.kNk(new Lf(M.nca));
this.Jd.notifyAgave(L.id,11)}else n.ULS.sendTraceTag(19014042,806,10,"Focus could not be put on the null addin pane!")}a_i(L,M){var Ja;for(Ja=0;Ja<this.TQ.length&&this.TQ[Ja].id!==L;Ja++);if(Ja===this.TQ.length)n.ULS.sendTraceTag(19014043,806,10,String.format("Failed to find the taskpane with instance id: {0}",L)),this.O2e(M);else{L=null;if(5===M)for(--Ja;0<=Ja;Ja--){if(this.TQ[Ja].isVisible){L=this.TQ[Ja];break}}else if(6===M)for(Ja+=1;Ja<this.TQ.length;Ja++)if(this.TQ[Ja].isVisible){L=this.TQ[Ja];
break}L?this.i4d(L):this.O2e(M)}}nXf(L){for(const M of this.TQ)if(M.id===L){zf.FocusManager.Wr(M.Cui);return}n.ULS.sendTraceTag(19014044,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",L))}qzl(L){for(let M of Ne.R8f())if(M.value.hg.toLowerCase()===L.toLowerCase())return M.value.dialog.hide(),M.key;return null}O2e(L){5===L?this.Ea.wTa(!1):6===L&&this.Ea.wTa(!0)}HTf(){const L=this.ob.Wd();L&&1===L.length&&(this.ob.selectShape(L[0],!0),this.Ea.Ed())}get Ajc(){let L=
0;for(const M of this.M2)M.isVisible&&L++;return L}qag(L){if(L.keyCode===od.a.eZ&&L.ctrlKey)for(var M=0;M<this.M2.length;M++){var Ja=this.M2[M];if(Ja.isVisible&&Ja.xa.contains(L.target)){Ja=null;if(L.shiftKey)for(M+=1;M<this.M2.length;M++){if(this.M2[M].isVisible){Ja=this.M2[M];break}}else for(--M;0<=M;M--)if(this.M2[M].isVisible){Ja=this.M2[M];break}Ja&&(this.i4d(Ja),L.preventDefault(),L.stopPropagation());break}}}tf(L){this.Ea.tf(L)}}Object(h.a)(vf,"AppForOfficeFocusManager",null,[838]);var ng=
d(949);class wg{CCi(L,M,Ja){L=ng.a.g7f(L.nhb);L.appName=OSF.AppName.PowerpointWebApp;L.clientMode=1;L.formFactor="DefaultSettings";L.hostControl=M;M=Bc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");L.allowExternalMarketplace=L.allowExternalMarketplace&&M.R0b;Ja.register(L);Ja=new OSF.ContextActivationManager(L);Ja.setWSA(B.AFrameworkApplication.jj);return Ja}}Object(h.a)(wg,"AppForOfficeImportedClassFactory",null,[837]);class bf{constructor(L){this.psg=L}aQe(){for(const L of this.psg)L.register()}dispose(){for(const L of this.psg)L.dispose()}}
Object(h.a)(bf,"AppForOfficeListenerManager",null,[836,106]);var Pd=d(1201),Md=d(1202),Mh=d(158),Bh=d(965);class Vh{constructor(){this.AUP=this.priority=0}}Object(h.a)(Vh,"AddinDetailInfo",null,[]);class Jg{constructor(){this.fNb=null;this.errorCode=0;this.failure=null}}Object(h.a)(Jg,"AddinCollection",null,[]);class Of extends Sys.EventArgs{constructor(L,M){super();this.krb=L;this.R7=M}}Object(h.a)(Of,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class bi{constructor(L){this.errorCode=L;this.R7=
[];this.failure=null}}Object(h.a)(bi,"GetAddinDetailsResult",null,[]);var ij=d(539);class ig{}Object(h.a)(ig,"GetEntitlementDetailsParameters",null,[]);var oj=d(193),fh=d(213),Qd=d(6);class $e{constructor(L,M,Ja=null){this.Pa=new P.a;this.Bpa=new Pd.a(Md.a.to());this.VH=new Mh.a;this.nId=null;this.DCd="https://store-images.s-microsoft.com";this.tLd=new fh.a;this.tLd.add(OSF.StoreTypeEnum.MarketPlace,0);this.tLd.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.$a=L;this.aN=M;this.z2a=Ja;if(this.UKi||this.bMf)this.DCd=
$e.laj(L,this.DCd);this.Rtf(Object(E.a)(this,this.hGe,"onAddinDetailsRefreshed"))}get UKi(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)}get bMf(){return!!this.$a&&this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled")}get jXf(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get G9b(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get vl(){return this.aN.value}S4b(L){if(!this.mie(L))return L=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Bh.a[L]}),Object.assign(new bi(1),{failure:L});if(this.VH.ga(L).failure)return Object.assign(new bi(this.VH.ga(L).errorCode),{failure:this.VH.ga(L).failure});n.ULS.shipAssertTag(509870082,220,!!this.VH.ga(L).fNb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",L);const M=new bi(0);for(let Ja of this.VH.ga(L).fNb)this.Bpa.Hb(Ja)&&
Array.add(M.R7,this.Bpa.ga(Ja));return M}G2i(L){return this.Bpa.Hb(L)?this.Bpa.ga(L):null}HUk(L){if(L){this.Rtf(L);for(let Ja of this.VH.keys)if(this.mie(Ja)&&!this.VH.ga(Ja).failure){n.ULS.shipAssertTag(509870081,220,!!this.VH.ga(Ja).fNb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ja);var M=[];for(let pb of this.VH.ga(Ja).fNb)Array.add(M,this.Bpa.ga(pb));M=new Of(Ja,M);L(null,M)}}}maa(L,M=!1){0!==L&&10!==L?n.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
ij.a[L]):this.yLk(L,Object(E.a)(this,this.qwk,"onQueryAddinDetailsCompleted"),M)}Rtf(L){this.Pa.addHandler(O.a.avf,L)}qwk(L,M,Ja){if(Ja)if($e.C3j(L,Ja,window.performance.now()-M),0===Ja.errorCode){let Tb;if(Ja.value){let Wc=0;Tb=Array(Ja.value.length);Ja.value.forEach(sd=>{Tb[Wc++]=sd})}else Tb=[];this.d0g(L,Tb)}else if(-1===Ja.errorCode||10===Ja.errorCode)this.d0g(L,[]);else{var pb={};pb.collectionType=Bh.a[L];pb.invokeResultCode=Ja.errorCode;pb["queryResult.Value"]=Ja.value?String.format("Length: {0}",
Ja.value.length):"null";pb.queryStart=M;pb.queryDuration=window.performance.now()-M;this.VH.$(L,Object.assign(new Jg(L),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",pb)}));n.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Bh.a[L],this.VH.ga(L).failure.toString(),JSON.stringify(this.VH.ga(L).failure))}else pb={},pb.collectionType=Bh.a[L],pb.queryResult=Ja?"not null":
"null",pb.queryStart=M,pb.queryDuration=window.performance.now()-M,this.VH.$(L,Object.assign(new Jg(L),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",pb)})),n.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Bh.a[L],this.VH.ga(L).failure.toString(),JSON.stringify(this.VH.ga(L).failure))}xbe(L){const M={};M.collectionType=Bh.a[L];this.VH.$(L,Object.assign(new Jg(L),
{errorCode:2,failure:Error.create("The store is disabled.",M)}));n.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Bh.a[L],this.VH.ga(L).failure.toString(),JSON.stringify(this.VH.ga(L).failure))}mil(){return this.mie(2)?this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.VH.ga(2).failure:!1:!0}yLk(L,M,Ja=!1){n.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",
L);L!==OSF.StoreTypeEnum.MarketPlace&&L!==OSF.StoreTypeEnum.PrivateCatalog?n.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",L):(this.mil()&&this.queryStoreDisabled(0,(pb,Tb)=>{Tb?this.xbe(2):(pb=window.performance.now(),M(2,pb,this.xfj()))}),this.queryStoreDisabled(L,(pb,Tb)=>{if(pb===OSF.StoreTypeEnum.MarketPlace&&Tb)this.xbe(0);else if(pb===OSF.StoreTypeEnum.PrivateCatalog&&Tb)this.xbe(1);else{var Wc=window.performance.now();this.vl.getEntitlementDetails(Object.assign(new ig,{storeType:pb,
refresh:Ja}),sd=>{M(this.tLd.ga(pb),Wc,sd)})}}))}d0g(L,M){L=new Of(L,M);this.Pa.raiseEvent(O.a.avf,L)}hGe(L,M){L=Object.assign(new Jg(M.krb),{fNb:new e.a});var Ja=M.R7;for(const pb of Ja)Ja=pb.solutionId,this.Bpa.Hb(Ja)?this.Bpa.$(Ja,this.olk(this.Bpa.ga(Ja),M.krb,pb)):this.Bpa.add(Ja,pb),L.fNb.add(Ja);this.VH.$(M.krb,L)}mie(L){return this.VH.Hb(L)?!!this.Bpa:!1}get Ifi(){return this.z2a?!this.z2a.AreThirdPartyAddInsAllowed||this.z2a.AppsForOfficeThirdPartyIsDisabled:!this.$a.ka("AreThirdPartyAddInsAllowed")||
this.$a.ka("AppsForOfficeThirdPartyIsDisabled")}get LPj(){return this.z2a?!this.z2a.AppsForOfficeAllowExternalMarketplace:!this.$a.ka("AppsForOfficeAllowExternalMarketplace")}get Whd(){return this.z2a?this.z2a.PopularAddinDetailsJsonString:this.$a.Ga("PopularAddinDetailsJsonString")}queryStoreDisabled(L,M){if(this.Ifi)M(L,!0);else if(L===OSF.StoreTypeEnum.MarketPlace&&this.LPj)M(L,!0);else{const Ja=$e.Svl(L);if(Ja){const pb=window.performance.now();this.vl.queryStoreDisabled(Ja,Tb=>{n.ULS.sendTraceTag(509679070,
220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",L,Tb,pb,window.performance.now()-pb);M(L,Tb)})}else M(L,!1)}}olk(L,M,Ja){if(!L)return Ja;if(!Ja)return L;if(this.jXf)return 2===M?$e.FYg(Ja,L):$e.FYg(L,Ja);if(2===M)return L.addinInfo=Ja.addinInfo,L;Ja.addinInfo=L.addinInfo;return Ja}xfj(){if(this.bMf){if(!this.nId){var L=JSON.parse(this.Whd);this.hZi(L);this.nId=L}return $e.zAf(this.nId)}L=JSON.parse(this.Whd);this.RWf(L);return $e.zAf(L)}hZi(L){this.jXf&&
$e.lei(L);this.Hei(L);this.RWf(L)}Hei(L){const M=this.Vki();for(var Ja=0;Ja<L.length&&0<M.count;Ja++){const pb=L[Ja];if(M.Hb(pb.solutionId)){let Tb=String.format("Found an override, solutionId: {0}",pb.solutionId);const Wc=M.ga(pb.solutionId);Wc&&(isNaN(Wc.addinInfo.priority)||(Tb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Tb,pb.addinInfo.priority,Wc.addinInfo.priority),pb.addinInfo.priority=Wc.addinInfo.priority),isNaN(Wc.addinInfo.AUP)||(Tb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Tb,pb.addinInfo.AUP,Wc.addinInfo.AUP),pb.addinInfo.AUP=Wc.addinInfo.AUP),Wc.displayName&&(Tb=String.format("{0}; DisplayName: update {1} to {2}",Tb,pb.displayName,Wc.displayName),pb.displayName=Wc.displayName),Wc.iconUrl&&(Tb=String.format("{0}; IconUrl: update {1} to {2}",Tb,pb.iconUrl,Wc.iconUrl),pb.iconUrl=Wc.iconUrl),Wc.description&&(Tb=String.format("{0}; Description: update {1} to {2}",Tb,pb.description,Wc.description),pb.description=Wc.description));M.remove(pb.solutionId);this.G9b&&n.ULS.sendTraceTag(509379136,
220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Tb)}}for(let pb of M.keys)Ja=M.ga(pb),Ja.displayName&&Ja.iconUrl&&Ja.addinInfo&&(L.push(Ja),this.G9b&&n.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ja)))}Vki(){const L=new Pd.a(Md.a.to());let M=this.$a.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!M)return L;M=M.trim();if(12>=M.length)return 0<M.length&&n.ULS.sendTraceTag(509379106,
220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",M),L;this.G9b&&n.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",M);try{const Ja=[],pb=M.split("|");for(let Tb=pb.length-1;0<=Tb;Tb--){const Wc=pb[Tb],sd=Wc.split("\\");if(2>sd.length){Ja.push(Wc);continue}const Ed=$e.OCk(sd);Ed?L.Hb(Ed.solutionId)||L.add(Ed.solutionId,Ed):Ja.push(Wc)}this.G9b&&0<Ja.length&&n.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
Ja.join("|"));this.G9b&&0<L.count&&n.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",L.count,JSON.stringify(Qd.toArray(L.values)));return L}catch(Ja){n.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",M,Ja.toString())}return L}RWf(L){for(let M=0;M<L.length;M++)oj.c(L[M].iconUrl.toLowerCase(),"http",0)||(L[M].iconUrl=String.format("{0}/image/apps.{1}",this.DCd,L[M].iconUrl))}static C3j(L,
M,Ja){const pb={};pb.AddinCollectionType=Bh.a[L];pb.ErrorCode=M.errorCode;pb.AddinCount=M.value?M.value.length:0;n.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Ja,JSON.stringify(pb))}static zAf(L){const M={errorCode:0};M.value=L;return M}static Svl(L){return L===OSF.StoreTypeEnum.MarketPlace?"omex":L===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static FYg(L,M){M.solutionId=M.solutionId||L.solutionId;M.version=M.version||
L.version;M.storeType=M.storeType||L.storeType;M.storeId=M.storeId||L.storeId;M.assetId=M.assetId||L.assetId;M.assetStoreId=M.assetStoreId||L.assetStoreId;M.displayName=M.displayName||L.displayName;M.provider=M.provider||L.provider;M.description=M.description||L.description;M.iconUrl=M.iconUrl||L.iconUrl;M.webApplicationId=M.webApplicationId||L.webApplicationId;M.highResolutionIconUrl=M.highResolutionIconUrl||L.highResolutionIconUrl;M.licenseUrl=M.licenseUrl||L.licenseUrl;M.privacyUrl=M.privacyUrl||
L.privacyUrl;M.addinInfo=M.addinInfo||L.addinInfo;isNaN(M.targetType)&&(M.targetType=L.targetType);isNaN(M.height)&&(M.height=L.height);isNaN(M.width)&&(M.width=L.width);return M}static lei(L){for(const M of L)isNaN(M.targetType)&&(M.targetType=1),M.assetId=M.assetId||M.solutionId,M.storeId=M.storeId||"en-US",M.storeType=M.storeType||"omex",M.assetStoreId=M.assetStoreId||"omex",isNaN(M.width)&&(M.width=0),isNaN(M.height)&&(M.height=0)}static OCk(L){const M={};let Ja=0;Ja<L.length&&0<L[Ja].trim().length&&
L[Ja].trim().toLowerCase().startsWith("wa")&&(M.solutionId=L[Ja].trim(),M.addinInfo=Object.assign(new Vh,{priority:Number.NaN,AUP:Number.NaN}),++Ja<L.length&&0<L[Ja].trim().length&&(M.addinInfo.priority=parseInt(L[Ja].trim())),++Ja<L.length&&0<L[Ja].trim().length&&(M.addinInfo.AUP=parseInt(L[Ja].trim())),++Ja<L.length&&0<L[Ja].trim().length&&(M.displayName=L[Ja].trim()),++Ja<L.length&&0<L[Ja].trim().length&&(M.iconUrl=L[Ja].trim()),++Ja<L.length&&0<L[Ja].trim().length&&(M.description=L[Ja].trim()));
return M.solutionId?M:null}static laj(L,M){L=L.Ga("AddinImageStoreServiceUrl");if(!L)return M;L=L.toLowerCase();return L.startsWith("http://")||L.startsWith("https://")?L:M}}Object(h.a)($e,"AddinDetailsManager",null,[660]);var yh=d(201),Ti=d(352),fe=d(576),gi=d(1199);class vi extends Ae.a{constructor(){super();this.qba="calc(100% - 46px)";this.Npa="15px";this.rba="0";this.IRb="WACDialogPanel";this.eS=695;this.JRb=462;this.lha="80%";this.xQb=350;this.TMa="100%";this.xd=5;this.hg="AppsForOfficeInsertionDialog";
this.sAd=!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}pu(){super.pu();this.fm.style.width=this.TMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Npa;this.fm.style.padding=this.rba}naa(){this.fm.style.width=this.TMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Npa;this.fm.style.padding=this.rba;this.eS>nc.a.zR?(this.Gb.style.width=String.format("{0}px",nc.a.zR),this.Gb.style.overflowX="scroll",B.AFrameworkApplication.isRtl?
this.Gb.style.right="0":this.Gb.style.left="0"):(this.Gb.style.width=String.format("{0}px",this.eS),this.Gb.style.overflowX="hidden");this.Gb.offsetHeight>nc.a.DU||this.JRb+50>nc.a.DU?(this.Gb.style.height=String.format("{0}px",nc.a.DU),this.Gb.style.overflowY="scroll",this.Gb.style.top="0",B.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0",this.sAd||(this.Gb.style.marginTop="-48px"),this.fm.style.minHeight=String.format("{0}px",this.xQb)):(this.Gb.style.overflowY="hidden",
this.Gb.style.top="10%",this.Gb.style.height=this.lha);this.nCa()}nCa(){if(this.Gb){var L=this.Gb.style.zIndex;this.Gb.style.zIndex="-9999";if(this.eS>nc.a.zR)B.AFrameworkApplication.isRtl?this.Gb.style.marginRight="0":this.Gb.style.marginLeft="0";else{const M=String.format("{0}px",Math.floor(-this.Gb.offsetWidth/2));B.AFrameworkApplication.isRtl?this.Gb.style.marginRight=M:this.Gb.style.marginLeft=M;B.AFrameworkApplication.isRtl?this.Gb.style.right="50%":this.Gb.style.left="50%"}this.Gb.style.zIndex=
String(L)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}AA(){super.AA();const L=document.getElementById(this.Nh(this.IRb));L.style.width=String.format("{0}px",this.eS);L.style.height=this.lha}get Bja(){return this.fm}}Object(h.a)(vi,"AppsForOfficeInsertionDialog",Ae.a,[649]);class bk extends Ae.a{constructor(L=!0,M=!0){super();this.qba="calc(100% - 46px)";this.Npa="15px";this.rba="0";this.IRb="WACDialogPanel";this.eS=695;this.JRb=462;this.lha="80%";this.xQb=350;
this.TMa="100%";this.gaf="auto";this.haf="5px";this.iaf="auto";this.eaf="40px";this.faf="100px";this.jaf="200px";this.xd=5;this.hg="SDXDialog";this.Qzc=L;this.R7b=M}pu(){super.pu();this.fm.style.width=this.TMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Npa;this.fm.style.padding=this.rba}naa(){this.fm.style.width=this.TMa;this.fm.style.height=this.Qzc?this.qba:"100%";this.fm.style.marginTop=this.Qzc?this.Npa:"0px";this.fm.style.padding=this.rba;this.Qzc?(this.eS>nc.a.zR?(this.Gb.style.width=
String.format("{0}px",nc.a.zR),this.Gb.style.overflowX="scroll",B.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0"):(this.Gb.style.width=String.format("{0}px",this.eS),this.Gb.style.overflowX="hidden"),this.Gb.offsetHeight>nc.a.DU||this.JRb+50>nc.a.DU?(this.Gb.style.height=String.format("{0}px",nc.a.DU),this.Gb.style.overflowY="scroll",this.Gb.style.top="0",B.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0",this.fm.style.minHeight=String.format("{0}px",
this.xQb)):(this.Gb.style.overflowY="hidden",this.Gb.style.top="10%",this.Gb.style.height=this.lha),this.nCa()):(this.Gb.style.left=this.gaf,this.Gb.style.right=this.haf,this.Gb.style.top=this.iaf,this.Gb.style.bottom=this.eaf,this.Gb.style.width=this.jaf,this.Gb.style.height=this.faf,this.Gb.style.overflowX="hidden",this.Gb.style.overflowY="hidden")}nCa(){if(this.Gb){var L=this.Gb.style.zIndex;this.Gb.style.zIndex="-9999";if(this.eS>nc.a.zR)B.AFrameworkApplication.isRtl?this.Gb.style.marginRight=
"0":this.Gb.style.marginLeft="0";else{const M=String.format("{0}px",Math.floor(-this.Gb.offsetWidth/2));B.AFrameworkApplication.isRtl?this.Gb.style.marginRight=M:this.Gb.style.marginLeft=M;B.AFrameworkApplication.isRtl?this.Gb.style.right="50%":this.Gb.style.left="50%"}this.Gb.style.zIndex=String(L)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}AA(){super.AA();const L=document.getElementById(this.Nh(this.IRb));L.style.width=String.format("{0}px",this.eS);L.style.height=
this.lha}get Dzb(){return this.Qzc}get Bja(){return this.fm}x$k(L,M,Ja,pb){this.gaf=L;this.haf=M;this.iaf=Ja;this.eaf=pb}y$k(L,M){this.faf=L;this.jaf=M}}Object(h.a)(bk,"SDXDialog",Ae.a,[]);class Zg extends Ae.a{constructor(L,M,Ja,pb){super();this.qba="calc(100% - 46px)";this.Npa="15px";this.rba="0";this.IRb="WACDialogPanel";this.eS=695;this.JRb=462;this.lha="80%";this.xQb=350;this.TMa="100%";this.ANa=null;this.xd=5;this.hg="AddinInstallDialog";this.oNh=L;this.Dba=M;this.u2h=Ja;this.oXh=pb}pu(){super.pu();
this.fm.style.width=this.TMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Npa;this.fm.style.padding=this.rba;document.getElementById(this.Nh("WACDialogButtonPanel")).style.display="none";this.CQa.setAttribute("tabindex","0");$addHandler(this.CQa,"keyup",Object(E.a)(this,this.Duk,"onKeyUp"));const L=document.createElement("iframe");L.setAttribute("id","InstallAddinDialog");L.setAttribute("src","about:blank");L.setAttribute("width","100%");L.setAttribute("height","100%");L.setAttribute("marginHeight",
"0");L.setAttribute("marginWidth","0");L.setAttribute("frameBorder","0");L.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const M=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.oNh,this.Dba,this.u2h);L.setAttribute("src",M);this.ANa=L;$addHandler(L,"load",Object(E.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(E.a)(this,this.onMessage,"onMessage"));this.fm.appendChild(L);
this.fm.appendChild(this.wDi())}wDi(){const L=document.createElement("div");L.setAttribute("tabindex","0");$addHandler(L,"focus",Object(E.a)(this,this.Suk,"onLoopPivotFocus"));return L}Duk(L){13!==L.keyCode&&32!==L.keyCode||this.hide()}Suk(){this.CQa.focus()}onLoad(){this.ANa.focus()}onMessage(L){L=L.rawEvent;if(L.source===this.ANa.contentWindow&&(L=(L=L.data)?L.split("|"):null)&&0<L.length&&("REFRESH_REQUIRED"===L[0]||"PRELOAD_MANIFEST"===L[0])){v.a.instance.setItem("refreshRequired","true");const M=
{};M.solutionId=L[1];M.version=Zg.qok(L[3]);M.storeType=L[4];M.storeId=L[5];M.assetId=L[6];M.targetType=Zg.YCk(L[2]);M.assetStoreId=L[7];M.width=parseInt(L[8]);M.height=parseInt(L[9]);this.oXh(M)}}naa(){this.fm.style.width=this.TMa;this.fm.style.height=this.qba;this.fm.style.marginTop=this.Npa;this.fm.style.padding=this.rba;this.eS>nc.a.zR?(this.Gb.style.width=String.format("{0}px",nc.a.zR),this.Gb.style.overflowX="scroll",B.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0"):
(this.Gb.style.width=String.format("{0}px",this.eS),this.Gb.style.overflowX="hidden");this.Gb.offsetHeight>nc.a.DU||this.JRb+50>nc.a.DU?(this.Gb.style.height=String.format("{0}px",nc.a.DU),this.Gb.style.overflowY="scroll",this.Gb.style.top="0",B.AFrameworkApplication.isRtl?this.Gb.style.right="0":this.Gb.style.left="0",this.fm.style.minHeight=String.format("{0}px",this.xQb)):(this.Gb.style.overflowY="hidden",this.Gb.style.top="10%",this.Gb.style.height=this.lha);this.nCa()}nCa(){if(this.Gb){var L=
this.Gb.style.zIndex;this.Gb.style.zIndex="-9999";if(this.eS>nc.a.zR)B.AFrameworkApplication.isRtl?this.Gb.style.marginRight="0":this.Gb.style.marginLeft="0";else{const M=String.format("{0}px",Math.floor(-this.Gb.offsetWidth/2));B.AFrameworkApplication.isRtl?this.Gb.style.marginRight=M:this.Gb.style.marginLeft=M;B.AFrameworkApplication.isRtl?this.Gb.style.right="50%":this.Gb.style.left="50%"}this.Gb.style.zIndex=String(L)}else n.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}AA(){super.AA();
const L=document.getElementById(this.Nh(this.IRb));L.style.width=String.format("{0}px",this.eS);L.style.height=this.lha}get Bja(){return this.fm}dispose(){super.dispose();$removeHandler(window,"message",Object(E.a)(this,this.onMessage,"onMessage"))}static YCk(L){switch(L){case "1":return 0;case "2":return 1;default:return 0}}static qok(L){const M=L.split(".");for(let Ja=0;Ja<4-M.length;Ja++)L+=".0";return L}}Object(h.a)(Zg,"AddinInstallDialog",Ae.a,[]);var Ek=d(176);class Ch{constructor(L,M,Ja){this.lyb=
L;this.onSuccess=M;this.onError=Ja;$addHandler(window,"message",Object(E.a)(this,this.s7b,"handleResponse"))}s7b(L){try{if(L&&L.rawEvent&&L.rawEvent.origin&&this.lyb&&this.lyb.id){var M=this.g9g(L.rawEvent.origin);const Ja=this.g9g(document.domain);if(Md.a.to().equals(Ja,M))if(L.rawEvent.source&&L.rawEvent.source.frameElement&&L.rawEvent.source.frameElement.id&&Md.a.to().equals(L.rawEvent.source.frameElement.id,this.lyb.id)){M=null;try{M=JSON.parse(L.rawEvent.data)}catch(pb){n.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",pb.message)}M?(M.statusCode!==Ek.a.Uv||void 0!==M.error&&M.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",M.statusCode,M.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(M.authorizationCode?M.authorizationCode:
M.signInUrl)),$removeHandler(window,"message",Object(E.a)(this,this.s7b,"handleResponse")),this.lyb?document.body.contains(this.lyb)?document.body.removeChild(this.lyb):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ja){n.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ja.message)}}g9g(L){let M="";try{L&&(M=-1<L.indexOf("//")?L.split("/")[2]:L.split("/")[0])&&(M=M.split(":")[0],M=M.split("?")[0])}catch(Ja){n.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Ja.message)}return M}static Zx(L,M,Ja){new Ch(L,M,Ja)}}Object(h.a)(Ch,"ResponseHandler",null,[]);var Ui=d(224);class pg{constructor(L){this.dra=L}tryAuthenticate(L,M){this.Chd(pg.PSh,()=>{L()},M)}tryAuthorize(L,M){this.Chd(pg.xNh,L,M)}getSignInUrl(L,M){this.Chd(pg.Dof,L,M)}signOut(L,M){this.Chd(pg.u0h,L,M)}Chd(L,M,Ja){var pb=new Ui.QueryStringBuilder("AuthenticationProxyHandler.aspx");pb.yi("responseType",L);B.AFrameworkApplication.yPa(pb);pb=String.format("{0}{1}&{2}",
this.dra,pb.toString(),B.AFrameworkApplication.gh);const Tb=document.createElement("iframe");Tb.setAttribute("id","privateCatalogIframe");Tb.setAttribute("name","privateCatalogIframe");Tb.setAttribute("style","display: none");Md.a.to().equals(L,pg.Dof)||Tb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Ch.Zx(Tb,M,Ja);Tb.setAttribute("src",pb);document.body.appendChild(Tb)}}pg.xNh="authcode";pg.PSh="identitytoken";pg.Dof="signinurl";pg.u0h="signout";
Object(h.a)(pg,"AuthenticationProxy",null,[]);class Mg{}Mg.getUserId="getUserId";Mg.getLastStoreUpdate="laststoreupdate";Mg.getEntitlement="getEntitlements";Mg.getEToken="getEToken";Mg.getManifest="getManifest";Mg.getAppState="getAppState";Mg.getKilledApps="getRemovedAddins";Mg.getAppDetails="getAppDetails";Mg.removeApps="removeAddin";Mg.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Mg.getPrivateCatalogAddIns="getAddIns";Mg.getPrivateCatalogManifests="getAppManifests";Mg.isStoreDisabled=
"isStoreDisabled";Object(h.a)(Mg,"S2SWebRequestActions",null,[]);var gh=d(523);class Ie{getUserId(L,M){const Ja=new e.a;Ja.add(new Na.a("corr",L));this.Lx(Mg.getUserId,Ja,1,M)}getLastStoreUpdate(L,M,Ja){const pb=new e.a;pb.add(new Na.a("lc",L));pb.add(new Na.a("corr",M));this.Lx(Mg.getLastStoreUpdate,pb,1,Ja)}getEntitlement(L,M,Ja,pb){L=new e.a;L.add(new Na.a("av",M));L.add(new Na.a("corr",Ja));this.Lx(Mg.getEntitlement,L,1,pb)}getEToken(L,M,Ja,pb,Tb,Wc){const sd=new e.a;sd.add(new Na.a("cmu",L));
sd.add(new Na.a("cmf",M));sd.add(new Na.a("assetid",Ja));sd.add(new Na.a("expver",pb));sd.add(new Na.a("corr",Tb));this.Lx(Mg.getEToken,sd,1,Wc)}getManifest(L,M,Ja,pb){const Tb=new e.a;Tb.add(new Na.a("cmu",L));Tb.add(new Na.a("assetid",M));Tb.add(new Na.a("corr",Ja));this.Lx(Mg.getManifest,Tb,1,pb)}getAppState(L,M,Ja){const pb=new e.a;pb.add(new Na.a("ma",L));pb.add(new Na.a("corr",M));this.Lx(Mg.getAppState,pb,1,Ja)}getKilledApps(L,M){const Ja=new e.a;Ja.add(new Na.a("corr",L));this.Lx(Mg.getKilledApps,
Ja,1,M)}getAppDetails(L,M,Ja,pb){const Tb=new e.a;Tb.add(new Na.a("cmo",L));Tb.add(new Na.a("corr",Ja));this.sendWithBody(Mg.getAppDetails,Tb,M,2,pb,!1)}removeApps(L,M,Ja){const pb=new e.a;pb.add(new Na.a("corr",M));this.sendWithBody(Mg.removeApps,pb,L,2,Ja,!1)}getLastPrivateCatalogUpdate(L,M,Ja,pb,Tb,Wc){const sd=new e.a;sd.add(new Na.a("catalog","privatecatalog"));sd.add(new Na.a("clientCode",L));sd.add(new Na.a("clientVersion",M));sd.add(new Na.a("corr",Tb));L=String.format("authorizationCode={0}&refreshToken={1}",
Ja?ma.a.Ne(Ja):"",pb?ma.a.Ne(pb):"");this.sendWithBody(Mg.getLastPrivateCatalogUpdate,sd,L,2,Wc,!0)}getPrivateCatalogAddIns(L,M,Ja,pb,Tb,Wc){const sd=new e.a;sd.add(new Na.a("catalog","privatecatalog"));sd.add(new Na.a("clientCode",L));sd.add(new Na.a("clientVersion",M));sd.add(new Na.a("corr",Tb));L=String.format("authorizationCode={0}&refreshToken={1}",Ja?ma.a.Ne(Ja):"",pb?ma.a.Ne(pb):"");this.sendWithBody(Mg.getPrivateCatalogAddIns,sd,L,2,Wc,!0)}getPrivateCatalogManifests(L,M,Ja,pb,Tb){const Wc=
new e.a;Wc.add(new Na.a("catalog","privatecatalog"));Wc.add(new Na.a("corr",pb));L=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",ma.a.Ne(L),M?ma.a.Ne(M):"",Ja?ma.a.Ne(Ja):"");this.sendWithBody(Mg.getPrivateCatalogManifests,Wc,L,2,Tb,!0)}isStoreDisabled(L,M){const Ja=new e.a;Ja.add(new Na.a("corr",L));this.Lx(Mg.isStoreDisabled,Ja,2,M)}Lx(L,M,Ja,pb){this.sendWithBody(L,M,null,Ja,pb,!1)}sendWithBody(L,M,Ja,pb,Tb,Wc){const sd=new Ui.QueryStringBuilder("AddinServiceHandler.ashx");
sd.yi("action",L);sd.yi("app",gh.a[B.AFrameworkApplication.Aa.hb.Uk]);for(let Ed of M)sd.yi(Ed.key,Ed.value);M=String.format("{0}{1}&{2}",B.AFrameworkApplication.Aa.hb.lna,sd.toString(),B.AFrameworkApplication.gh);B.AFrameworkApplication.Ke.mj(M,pb,Ja,null,!1,2,Ed=>{let ee=null,kb=null;Ed&&Ed.data&&(Ed.data.sj["X-BlockedForMinor"]&&"1"===Ed.data.sj["X-BlockedForMinor"].toString()&&(Ed.data.oe=451),ee=Ed.data.Sd,kb=Ed.data.sj);Tb(Ed.data.oe,ee,kb)},Ed=>{var ee=null;let kb=null;Wc&&Ed&&Ed.data&&Ed.data.Sd&&
(ee=Ed.data.Sd,kb=Ed.data.sj);Tb(Ed.data.oe,ee,kb);if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){ee={message:"AddinServiceHandler request failed"};ee.code=Ed.data.oe;ee.action=L;if(Ed.data.request||Ed.data.request.get_headers())ee["X-UserSessionId"]=Ed.data.request.get_headers()["X-UserSessionId"];408===Ed.data.oe||503===Ed.data.oe?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(ee)):n.ULS.sendTraceTag(18392345,220,50,
JSON.stringify(ee))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Ed.data.oe)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+L,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(Ie,"S2SWebRequestManager",null,[]);var Ia=d(32),lb=d(84);class Lb{constructor(L,M){this.state=L;this.kya=M}}Object(h.a)(Lb,"BackgroundAppData",null,[861]);class hc{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed){this.nca=null;this.G5j=L;this.phk=pb;this.jB=M;this.nu=Ja;this.chc=Tb;this.settings=Wc;
this.J5j=sd;this.ew=Ed}get Ho(){return this.G5j}get taskpane(){return this.phk}get instanceId(){return this.jB}get shape(){return this.nu}get Ww(){return this.J5j}t4h(L){this.ew=new Lb(0,L)}}Object(h.a)(hc,"AppForOffice",null,[834]);var Pc=d(31);class Td{}Td.c_Error="Error";Object(h.a)(Td,"ApiResponseKeyStrings",null,[]);class ie{constructor(L,M,Ja,pb,Tb){this.EventDispId=L;this.ControlId=M;this.TargetId=Ja;this.Handler=pb;this.Callback=Tb}}Object(h.a)(ie,"EventRegistrationParams",null,[]);var Sd=
d(28);class wf{constructor(L,M){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.zb=B.AFrameworkApplication.ye;this.Iye=L;this.Vwg=M}InvokeDdaMethod(L,M,Ja){const pb=L.DdaMethod.DispatchId,Tb=this.Iye.l3i(pb);Tb?(Tb.parameters=L,Tb.callback=M,Tb.Mbi=Ja,Tb.controlId=L.DdaMethod.ControlId,this.zb.Db(new tf.a(2,1,0,Object(E.a)(Tb,Tb.go,"go"),90,"51"))):(L="API Call for method ID "+pb+" does not exist:"+Pc.Debug.St(),Sd.a.J(8958091,802,10,L),this.OTd(M))}RegisterDdaEventAsync(L,
M,Ja,pb,Tb){const Wc=new tf.a(2,1,0,Object(E.a)(this,this.TTk,"registerEventTaskProcess"),90,"52");Wc.customData=new ie(L,M,Ja,pb,Tb);this.zb.Db(Wc)}UnregisterDdaEventAsync(L,M,Ja,pb,Tb){const Wc=new tf.a(2,1,0,Object(E.a)(this,this.vBl,"unregisterEventTaskProcess"),90,"53");Wc.customData=new ie(L,M,Ja,pb,Tb);this.zb.Db(Wc)}TTk(L){L=L.customData;var M=this.Vwg.q5d(L.EventDispId);M?M.addHandler(L.ControlId,L.Handler,L.Callback,L.TargetId):(M="Event for dispatch ID "+L.EventDispId+" does not exist:"+
Pc.Debug.St(),Sd.a.J(8958093,802,10,M),this.OTd(L.Callback))}vBl(L){L=L.customData;var M=this.Vwg.q5d(L.EventDispId);M?M.removeHandler(L.ControlId,L.Handler,L.Callback,L.TargetId):(M="Event for dispatch ID "+L.EventDispId+" does not exist:"+Pc.Debug.St(),Sd.a.J(8958095,802,10,M),this.OTd(L.Callback))}OTd(L){if(L){var M={};M[Td.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;L(M)}}}Object(h.a)(wf,"AppForOfficeApiAdapter",null,[880]);class Pf{constructor(L,M,Ja,pb){this.menuItemId=L;this.XU=
M;this.drl=Ja;this.SWi=pb}}Object(h.a)(Pf,"NewDocumentParameters",null,[]);var og=d(582),Dh=d(129),Bi=d(140),Vi=d(44),kh=d(53),mi=d(76),sh=d(33),Ng=d(40),Wh=d(51),Gg=d(41),eg=d(34),Tj=d(58);class aj{constructor(L,M,Ja){this.ifb=[];this.S4c=this.jCb=!1;this.ta=L;this.UF=M;this.oz=Ja}build(){const L=this.ta.$D();if(!L)return this.ifb;for(const M of L)if(this.qKk(M),this.S4c)break;return this.ifb}qKk(L){const M=sh.ParagraphReader.textLength(L);this.rKk(L,M);this.S4c||this.XJk(L)}rKk(L,M){this.jCb||(this.UF>=
M?this.UF-=M:(this.jCb=!0,this.oz||this.ifb.push(Wh.a.Lj(Object(da.a)(lb.a,L),this.UF))));this.jCb&&(this.oz>M-this.UF?0<M&&(this.ifb.push(Wh.a.createTextRange(Object(da.a)(lb.a,L),this.UF,M)),this.oz-=M-this.UF,this.UF=0):0<this.oz&&(this.ifb.push(Wh.a.createTextRange(Object(da.a)(lb.a,L),this.UF,this.UF+this.oz)),this.oz=0));0>=this.oz&&(this.S4c=!0)}XJk(L){this.jCb||(0<this.UF?--this.UF:(this.jCb=!0,this.oz||this.ifb.push(Wh.a.SQa(Object(da.a)(lb.a,L)))));this.jCb&&0<this.oz&&(this.ifb.push(Wh.a.Fca(Object(da.a)(lb.a,
L))),--this.oz);0>=this.oz&&(this.S4c=!0)}}Object(h.a)(aj,"TextSelectionBuilder",null,[]);var pj=d(967),Ji=d(30);class yg{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed,ee,kb,cf,Tf,zg,ci,ah,Qe,Di,pk,ch,hf,Ij,Kf,ne){this.Ha=L;this.Pb=M;this.lJ=Ja;this.Vfc=pb;this.pa=Tb;this.jJ=Wc;this.c8c=sd;this.Jb=Ed;this.ia=ee;this.ua=cf;this.Vb=kb;this.Tb=Tf;this.jc=zg;this.D5j=ci;this.ob=ah;this.Fb=Qe;this.Sk=Di;this.Fa=pk;this.Qb=ch;this.peb=hf;this.Hh=Ij;this.Nu=Kf;this.Qbk=ne}pij(){let L;L="";if(this.ob.gH()){if(1<this.ob.Knd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Epc:L};const M=this.ob.Jp();if(this.jVj(M)){const Ja=[];this.Fa.LJ(M,pb=>{pb&&Ja.push(pb.characterData)});L=Ja.join(yg.XBf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Epc:L}}}else if(this.ob.Xz())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Epc:L}}lij(){let L;L="";return{returnValue:({yZe:L}=this.getSelectedSlides()).returnValue,i7k:L}}Bwb(){return this.lJ.nhb.documentUrl}qpj(L){if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
var M=this.Tb.pj();if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const Ja=this.ua.Ba.le;switch(L){case "previous":L=Ja-1;break;case "next":L=Ja+1;break;case "first":L=0;break;case "last":L=M-1;break;default:if(L=parseInt(L),isNaN(L))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>L||L>M-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;M=this.Tb.XA(L);if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Vb.Ba=M;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}rpj(L){if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
L=parseInt(L);if(isNaN(L))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;L=this.i$d(L);if(!L)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Vb.Ba=L;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}fdl(L){var M=this.ob.Wd();if(!M.length){if(M=Object(da.a)(116,this.ob.tk()||this.ua.Ba)){var Ja=M.Cb;L=this.Sk.iYd(Ja.cid,Ja.sid,M.Ut()+1,L,"");Ja=this.Jb.Ad(7);Ja.nc(M);M.dC(L);this.ob.selectShape(L,!0);Ja.dispose();this.Nu.SF=L;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===
M.length){if(this.ob.gH())return this.hel(L);if(this.ob.Xz())return this.iel(L)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}adl(L,M,Ja,pb,Tb,Wc,sd){if(this.lPc(Tb,0,yg.omb)||this.lPc(Wc,0,yg.omb)||this.lPc(Ja,-yg.omb,yg.omb)||this.lPc(pb,-yg.omb,yg.omb)||0!==sd&&1!==sd)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(L.length>this.Ha.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var Ed=this.ob.Wd().length;
if(M||Tb||Wc||!Ed){Ed=this.ua.Ba;if(!Ed)throw Error.argumentNull("ActiveSlide is null");const ee=Ed.Cb,kb=Ed.Ut();let cf=!0,Tf=new Tj.a(0,0);M?Tf=new Tj.a(Ja,pb):!this.Ha.FGk||Tb&&Wc?Tf=this.Tb.Ata(Tb,Wc):cf=!1;M=this.Sk.isa(!1,ee.cid,ee.sid,0,og.a.GH(Tf.x),og.a.GH(Tf.y),og.a.GH(Tb),og.a.GH(Wc),kb+1,!0);cf||(M.fo(Ng.a.wy),M.fo(Ng.a.yy));M.Fj=!0;M.Hqd=!0;M.Yy=sd;M.Aka=0===sd?this.DJf(L):L;M.Xyb=!0;L=this.Jb.Ad(7);try{this.Ha.cB&&(L.jd=Ji.a.Jsf),L.nc(Ed),Ed.dC(M),this.ob.selectShape(M,!0)}finally{L&&
L.dispose()}this.Nu.SF=M;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===Ed&&(Ed=this.ob.Jp())&&Ed.YIc){M=this.ua.Ba;if(!M)throw Error.argumentNull("ActiveSlide is null");Ja=this.d$a(M,Ed);Ja.Fj=!0;Ja.Yy=sd;Ja.Aka=0===sd?this.DJf(L):L;Ja.Xyb=!0;L=this.Jb.Ad(7);try{L.nc(M),M.LU([Ed]),M.dC(Ja),this.ob.selectShape(Ja,!0)}finally{L&&L.dispose()}this.Nu.SF=Ja;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Sd.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Jka(){return this.Ha.Jka}fJj(){return this.Pb.ka("342")}u8i(L){if(!L)return null;
L=this.D5j.b3(L);L=0===L.Ww?L.node:this.ua.Ba;if(!L)return null;L=Object(da.a)(115,this.jc.kg(L));return Ve(L.ke)}JTe(L,M){if(L&&M)if(Ue.a("UseUndoTransactionForSaveSettingToApp")){var Ja=this.Jb.Ad(15,void 0,void 0,void 0,!0);try{Ja.nc(L),Ja.jd=Ji.a.Byb,pj.a.TFh(this.c8c.value,L,M)}finally{Ja&&Ja.dispose()}}else{Ja=this.Jb.Ad(4);try{Ja.nc(L),pj.a.TFh(this.c8c.value,L,M),this.Vb.xi.Xfa()}finally{Ja&&Ja.dispose()}}}E7a(L,M,Ja){const pb=new y.StandardDialog;pb.xd=4;pb.Gx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_NewFileAPIConsentMessage,1,Tb=>{2===Tb||0===Tb?Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Tb=new Pf("blank","agave",L?yg.Lnk:yg.Mnk,L),this.Qbk.create(M,Ja,Tb).E7a())})}Qe(){return this.ob.Qe()}Wd(){return this.ob.Wd()}tij(){var L=this.ob.Wd();if(!(L.length&&this.ob.Xz()&&this.pa.value&&this.pa.value.Na.length))return[];const M=this.pa.value.Na.ga(0);return(L=yg.rgj(L[0],M))&&2===L.length?L:[]}$zl(L){if(!L)return!1;this.ob.zub();if(!L.length)return!0;L[0]!==this.ua.Ba&&
(this.Vb.Ba=L[0]);for(const M of L)M&&this.ob.e6a(M);return!0}Zzl(L){if(!L)return!1;if(!L.length)return this.ob.Qh(),!0;this.ob.P_a(L,!0);return!0}aAl(L,M,Ja){if(!yg.Hmg(L))return!1;if(0>M)return!0;L=(new aj(L,M,Ja)).build();L=[new Dh.Selection(L,!0)];L=new Bi.SelectionCollection(L,0);this.ob.QE(L);return!0}getSelectedSlides(){let L;L="";var M=null;if(!M||!M.length){var Ja=this.ob.tk()||this.ua.Ba;M||(M=[]);Ja&&M.push(Ja)}if(!M.length)return Sd.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,yZe:L};Ja=[];for(const pb of M){M=pb.le+1;if(!M)return Sd.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,yZe:L};Array.add(Ja,[pb.sid.toString(),pb.title||"",M.toString()])}L=fa.c(Ja);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,yZe:L}}getSelectedTextRange(){var L=[];for(let M=0;M<this.pa.value.Na.length;M++){const Ja=this.pa.value.Na.ga(M);
Array.add(L,this.cUc(Ja))}L=L.join(yg.XBf);if(L===mi.AParagraphNode.h_)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Epc:L};L=mi.AParagraphNode.gld(L);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Epc:L}}jVj(L){if(!L)return!1;let M=L.zua||L.px||L.Rf||L.ud;if(!M&&L.fl)switch(L.Hj){case 0:case 2:case 1:case 3:case 10:case 8:M=!0}return M}kVj(L){if(!L)return!1;let M=L.zua||L.px;if(!M&&L.fl)switch(L.Hj){case 0:case 2:case 1:case 3:case 8:M=
!0}return M}cUc(L){let M="";if(L)for(let Ja=0;Ja<L.length;Ja++){const pb=L.ga(Ja),Tb=pb.Qa,Wc=pb.Mb-Tb;let sd="";sh.ParagraphReader.$d(pb.node)&&(sd=pb.node.characterData);switch(pb.contextId){case Gg.a.paragraph:M+=sd+"\r";break;case Gg.a.textRange:0<Wc&&(M+=sd.substr(Tb,Wc));break;case Gg.a.endOfParagraph:M+="\r"}}return M}i$d(L){var M=this.ua.presentation;if(!M)throw Error.argumentNull("Presentation is null");M=M.slides||[];for(let Ja=0;Ja<M.length;Ja++)if(M[Ja].Cb.sid===L)return Object(da.a)(116,
M[Ja]);return null}iel(L){if(!this.pa.value||!this.jJ.value||!this.Vfc.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.pa.value.Na.length){if(!Vi.SelectionEditor.lx(this.pa.value.Na.mb)&&32!==this.ia.processAction(eg.a.$Ca,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var M=this.pa.value.Na.mb.Ua;const Ja=M.node,pb=M.Qa;M=M.Mb;const Tb=this.Jb.Ad(7);try{Tb.nc(Ja);let Wc=null;Wc=pb===M?Wh.a.Lj(Ja,pb):Wh.a.createTextRange(Ja,pb,M);this.jJ.value.replaceTextRange(Wc,
L)}finally{Tb.dispose()}M=pb+L.length;this.pa.value.setSelection(kh.SelectionFactory.f3(Ja,pb,M));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Sd.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}hel(L){if(!this.pa.value||!this.jJ.value||!this.Vfc.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const M=this.ob.Jp();if(!M)return L="Fail to get shape while setting selected shape's text: shape returned as null: "+
Pc.Debug.St(),Sd.a.J(512263106,802,10,L),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.kVj(M)){const Ja=this.Qb.Nc(M),pb=this.Jb.Ad(7);try{pb.nc(Ja);M.deleteParagraph();this.Vfc.value.LZ(Ja,!0);this.peb.wi(Ja);const Tb=Ja.currentNode,Wc=this.Hh.textLength(Tb),sd=Wh.a.createTextRange(Tb,0,Wc);this.jJ.value.replaceTextRange(sd,L)}finally{pb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Sd.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}lPc(L,
M,Ja){return L<M||Ja<L}DJf(L){return"data:image/png;base64,"+L}d$a(L,M){if(!L)return null;var Ja=L.Cb;L=L.Ut();let pb;const Tb=Od.a.dY,Wc=Od.a.u5;pb=M?M.$wb(Od.a.dY,Od.a.u5):this.Tb.Ata(Od.a.dY,Od.a.u5);Ja=this.Sk.isa(!0,Ja.cid,Ja.sid,0,pb.x,pb.y,Tb,Wc,L+1,!0);M&&(Ja.vca=M.id);return Ja}static Hmg(L){if(!L)return!1;let M=L.zua||L.px;if(!M&&L.fl)switch(L.Hj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:M=!0}return M}static gmj(L,M){L=L.$D();if(!L||!M)return 0;let Ja=0;for(const pb of L){if(pb===
M)break;Ja+=sh.ParagraphReader.textLength(Object(da.a)(lb.a,pb))+1}return Ja}static rgj(L,M){if(!yg.Hmg(L)||!M)return[];var Ja=-1;let pb=0;for(let Tb of M){M=sh.ParagraphReader.$d(Tb.node)?sh.ParagraphReader.textLength(Tb.node):0;if(-1===Ja)switch(Ja=sh.ParagraphReader.$d(Tb.node)?yg.gmj(L,Object(da.a)(5,Tb.node)):0,Tb.contextId){case Gg.a.paragraph:break;case Gg.a.textRange:case Gg.a.Pf:Ja+=Tb.Qa;break;case Gg.a.endOfParagraph:Ja+=M;break;default:return[]}switch(Tb.contextId){case Gg.a.paragraph:pb+=
M+1;break;case Gg.a.textRange:pb+=Math.max(0,Tb.Mb-Tb.Qa);break;case Gg.a.endOfParagraph:pb+=1}}return[Ja,pb]}}yg.XBf=" ";yg.omb=169056;yg.Mnk="streamEmpty";yg.Lnk="streamBase64";Object(h.a)(yg,"AppForOfficeApiFacadeEditorImpl",null,[879]);class Aa{U$f(L,M,Ja){if(Ja.HDa(L))n.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(L=Ja.h4b(L)){const pb={};pb.solutionId=L.Ho.id;pb.version=L.Ho.version;pb.storeType=L.Ho.storeType;
pb.storeId=L.Ho.store;pb.assetId=null;pb.assetStoreId=null;pb.targetType=1;pb.isAddinCommands=!0;pb.addinCommandsActionType=1;pb.sharedRuntimeId=L.ew?L.ew.kya:null;pb.backgroundState=L.ew?L.ew.state:-1;L.settings=M;Ja.GQd.VG().La(Ji.a.gXc,2,pb);return!0}return!1}cJj(L,M){if(!L&&!M)return!0;if(!L||!M||Object.keys(L).length!==Object.keys(M).length)return!1;for(let Tb in L){var Ja=Tb,pb=L[Tb];if(!(Ja in M)||M[Ja]!==pb)return!1}return!0}}Object(h.a)(Aa,"AppForOfficeAppSettingProxy",null,[]);class Ma{constructor(L,
M,Ja,pb){this._id=L;this.L5a=M;this.D7=Ja;this.epf=pb}get id(){return this._id}get version(){return this.L5a}get store(){return this.D7}get storeType(){return this.epf}}Object(h.a)(Ma,"AppForOfficeReference",null,[864]);class cb{constructor(L,M){this._id=L;this.G0h=M}get id(){return this._id}get slideId(){return this.G0h}}Object(h.a)(cb,"AppForOfficeShape",null,[863]);class Fb{constructor(L,M,Ja,pb,Tb,Wc=null,sd=!1){this.jQh=L;this.l3h=M;this.O5a=Ja;this.b_h=pb;this.FHd=Tb;this.isForUILessAction=
sd;this.JXh=Wc}get GPf(){return this.jQh}get visibility(){return this.l3h}get width(){return this.O5a}get row(){return this.b_h}get ownerAddinSolutionId(){return this.FHd}get ownerAddinStoreType(){return this.JXh}}Object(h.a)(Fb,"AppForOfficeTaskpane",null,[862]);class dc{constructor(L,M,Ja,pb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=L;this.controlId=M;this.ddaBinding=Ja;this.ArrayData=pb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(dc,"DdaEventArgs",null,[]);class zc{constructor(L,M){this.eCb=null;this.Yc=L;this.ia=M}q5d(L){this.eCb||this.DFk();if(!L||!this.eCb[L])return null;L=this.eCb[L];L.Jd=this.Yc;L.An=this.ia;return L}lFf(L){const M=this.eCb;for(let Ja in M)M[Ja].removeHandler(L)}set(L,M){this.eCb[L]=M}}Object(h.a)(zc,"ApiEventStore",null,[]);class Vc{constructor(){this.Ao=this.ia=this.Yc=null;this.Bl={}}get handlers(){return this.Bl}get An(){return this.ia}set An(L){this.ia=L}get Jd(){return this.Yc}set Jd(L){this.Yc=
L}raiseEvent(L,M=null){L=this.Bta(L);if(M){var Ja=this.Bl[M];Ja&&Ja(L)}else for(Ja in M=this.Bl,M){const pb=M[Ja];pb&&pb(L)}}addHandler(L,M,Ja=null){this.Bl[L]=M;this.Q6a(Ja)}removeHandler(L,M,Ja=null){delete this.Bl[L];this.Q6a(Ja)}get result(){return this.Ao}Q6a(L){this.NA(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}NA(L,M){L&&(this.Ao={},this.Ao[Td.c_Error]=M,L(this.Ao))}}Object(h.a)(Vc,"ApiEvent",null,[912]);class rd extends Vc{constructor(){super()}Bta(L){return L}static get instance(){rd.Qp||
(rd.Qp=new rd);return rd.Qp}}rd.Qp=null;Object(h.a)(rd,"ActivationStatusChangedEvent",Vc,[]);class Z extends Vc{constructor(){super()}Bta(){return"view"}static get instance(){Z.Qp||(Z.Qp=new Z);return Z.Qp}}Z.Qp=null;Object(h.a)(Z,"ActiveViewChangedEvent",Vc,[]);var Da=d(105);class Wa extends Vc{constructor(){super();this.Bpe=null}Bta(){return null}get vsa(){!this.Bpe&&this.Jd&&(this.Bpe=Ne.getInstance(this.Jd.vl));return this.Bpe}addHandler(L,M,Ja=null,pb=null){this.Jd?this.Jd.xu.Jka()?L in this.handlers?
this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(n.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(L,pb,Tb=>{Tb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Da.a.count(this.handlers)||this.vsa.r$h(Object(E.a)(this,this.aIe,"onMessageParentEvent")),this.handlers[L]=M,this.Jd.vl?({value:Tb}=Ne.R8f().Uf(L),Tb?(this.Jd.vl.setActivationCompletedStatus(Tb.hg,!0),this.Jd.ZZa(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),Tb.hg,!0)):n.ULS.sendTraceTag(24463263,
806,15,"Show dialog successed but get dialogInfo failed")):n.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.Q6a(Ja)):(n.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",Tb.toString()),this.NA(Ja,Tb))})):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,M,Ja=null){this.Jd?this.Jd.xu.Jka()?L in this.handlers?(n.ULS.sendTraceTag(20247128,
802,50,"RemoveHandler was called."),this.vsa.vui(L,pb=>{delete this.handlers[L];Da.a.count(this.handlers)||this.vsa.wih(Object(E.a)(this,this.aIe,"onMessageParentEvent"));pb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&n.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",pb.toString());this.NA(Ja,pb)})):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(L,
M,Ja){try{this.vsa.showDialog(M,L,Ja,null)}catch(pb){n.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",pb.message),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}aIe(L,M){if(M.controlId in this.Bl){L={};L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=M.messageType;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=M.messageContent;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=
M.dEe;L[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=M.KLa;const Ja=this.Bl[M.controlId];Ja&&Ja(L);M.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.Bl[M.controlId],Da.a.count(this.Bl)||this.vsa.wih(Object(E.a)(this,this.aIe,"onMessageParentEvent")))}}static get instance(){Wa.Qp||(Wa.Qp=new Wa);return Wa.Qp}}Wa.Qp=null;Object(h.a)(Wa,"DialogMessageReceivedEvent",Vc,[]);class ib extends Vc{constructor(){super()}Bta(){return null}addHandler(L,M,Ja=null){this.Jd?
this.Jd.xu.Jka()?(M=this.Jd.iwb(L))&&M.taskpane&&M.taskpane.isForUILessAction?(this.An.La(wc.a.wrc,2,L),this.Q6a(Ja)):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,M,Ja=null){this.Jd?this.Jd.xu.Jka()?(M=this.Jd.iwb(L))&&M.taskpane?M.taskpane.isForUILessAction?(this.An.La(wc.a.a8b,2,L),this.Q6a(Ja)):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):
this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(ib,"DialogNotificationShownInAddinEvent",Vc,[]);class nb extends Vc{constructor(){super();this.vl=this.kRd=null}Bta(){return null}get vsa(){this.kRd||(this.kRd=Ne.getInstance(this.contextActivationMgr));return this.kRd}get contextActivationMgr(){!this.vl&&this.Jd&&(this.vl=this.Jd.vl);
return this.vl}addHandler(L,M,Ja=null){this.Jd&&!this.Jd.xu.Jka()?this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):L in this.Bl?this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(Da.a.count(this.Bl)||this.vsa.q$h(Object(E.a)(this,this.q4g,"onMessageDialogEvent")),this.Bl[L]=M,this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(L,M,Ja=null){this.Jd&&!this.Jd.xu.Jka()?this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
L in this.Bl?(delete this.Bl[L],Da.a.count(this.Bl)||this.vsa.SYk(Object(E.a)(this,this.q4g,"onMessageDialogEvent")),this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}q4g(L,M){M.controlId in this.Bl&&(L={},L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=M.messageType,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=M.messageContent,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=
M.dEe,L[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=M.KLa,(M=this.Bl[M.controlId])&&M(L))}static get instance(){nb.Qp||(nb.Qp=new nb);return nb.Qp}}nb.Qp=null;Object(h.a)(nb,"DialogParentMessageReceivedEvent",Vc,[]);class jc extends Vc{constructor(){super()}Bta(){return{}}static get instance(){jc.Qp||(jc.Qp=new jc);return jc.Qp}}jc.Qp=null;Object(h.a)(jc,"DocumentSelectionChangedEvent",Vc,[]);class cc extends Vc{constructor(){super()}Bta(){return null}raiseEvent(L,
M){try{const Ja=this.Bl[M];Ja&&(M={},M[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=L,Ja(M))}catch(Ja){Sd.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Ja.message)}}static get instance(){cc.Qp||(cc.Qp=new cc);return cc.Qp}}cc.Qp=null;Object(h.a)(cc,"DocumentThemeChangedEvent",Vc,[]);class Ad extends Vc{constructor(){super()}Bta(){return null}addHandler(L,M,Ja=null){this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(L,M,Ja=null){this.NA(Ja,
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){Ad.Qp||(Ad.Qp=new Ad);return Ad.Qp}}Ad.Qp=null;Object(h.a)(Ad,"OfficeThemeChangedEvent",Vc,[]);class Xd{constructor(){}}Object(h.a)(Xd,"RichApiEventManagerHost",null,[913]);class xe extends Vc{constructor(){super();this.CJd=null}Bta(L){return L}addHandler(L,M,Ja=null,pb=null){this.Jd&&va.a(pb)?(this.CJd||(this.CJd=new Xd(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.CJd)),this.Bl[L]=M,this.Q6a(Ja)):
this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(L,M,Ja=null,pb=null){this.Jd&&va.a(pb)&&L in this.Bl?(delete this.Bl[L],this.Q6a(Ja)):this.NA(Ja,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){return xe.Ka||(xe.Ka=new xe)}}xe.Ka=null;Object(h.a)(xe,"RichApiMessageEvent",Vc,[]);class Ff extends Vc{constructor(){super()}Bta(L){return L}static get instance(){Ff.Qp||(Ff.Qp=new Ff);return Ff.Qp}}Ff.Qp=null;Object(h.a)(Ff,"SettingsChangedEvent",
Vc,[]);class xg extends zc{constructor(L,M){super(L,M)}DFk(){this.eCb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Ff.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Z.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,rd.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,cc.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,Ad.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,jc.instance);
this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Wa.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,nb.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new ib);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,xe.instance)}}Object(h.a)(xg,"EditorEventStore",zc,[]);class Eg{constructor(L){this.xfc=null;this.Yc=L}l3i(L){this.xfc||this.SFk();if(!L||!this.xfc[L])return null;if(L=this.xfc[L]())L.Jd=this.Yc;return L}set(L,M){this.xfc[L]=
M}}Object(h.a)(Eg,"ApiMethodFactory",null,[]);class De{constructor(L,M,Ja,pb){this.instanceId=L.toLowerCase();this.fileSize=M;this.$2d=pb;this.Xwh=Ja}}Object(h.a)(De,"DocumentCopy",null,[]);var zd=d(390),Gd=d(262);class fd extends zd.a{constructor(L,M,Ja,pb,Tb,Wc,sd){super();this.oB=L.string;this.jB=M;this.Wla=Ja;this.cfa=Tb;this.kgk=pb;this.xbc=Wc;this.KVa=sd;this.aZa=Object(E.a)(this,this.ytk,"onGetDocumentCopyChunkFinished");this.onError=Object(E.a)(this,this.xtk,"onGetDocumentCopyChunkError")}start(){this.bqd=
!1;Gd.a.c1f(this.oB,this.jB,this.Wla,this.kgk,this.cfa,Object(E.a)(this,this.xda,"handleWebserviceResponse"),Object(E.a)(this,this.wda,"handleWebserviceError"))}ytk(L){if(L.eSa){const M={};L=L.result;M.value=L.FileData;M.errorCode=L.ErrorCode;this.xbc(this.jB,M)}else this.handleError(L)}xtk(L){this.handleError(L)}handleError(L){this.KVa&&(L=L.error,this.KVa(this.jB,!!L&&2===L.type))}}Object(h.a)(fd,"GetDocumentCopyChunkTask",zd.a,[]);class Mc extends zd.a{constructor(L,M,Ja,pb,Tb,Wc){super();this.oB=
L.string;this.jB=M;this.Wla=Ja;this.cfa=pb;this.xbc=Tb;this.KVa=Wc;this.aZa=Object(E.a)(this,this.Atk,"onGetDocumentCopyFinished");this.onError=Object(E.a)(this,this.ztk,"onGetDocumentCopyError")}start(){this.bqd=!1;Gd.a.r8i(this.oB,this.jB,this.Wla,Object(E.a)(this,this.xda,"handleWebserviceResponse"),Object(E.a)(this,this.wda,"handleWebserviceError"))}Atk(L){if(L.eSa){const M={};L=L.result;M.fileSize=L.FileSize;M.errorCode=L.ErrorCode;M.format=this.Wla;M.sliceSize=this.cfa;this.xbc(this.jB,M)}else this.handleError(L)}ztk(L){this.handleError(L)}handleError(L){this.KVa&&
(L=L.error,this.KVa(this.jB,!!L&&2===L.type))}}Object(h.a)(Mc,"GetDocumentCopyTask",zd.a,[]);class uk extends zd.a{constructor(L,M,Ja,pb,Tb,Wc,sd){super();this.oB=L.string;this.jB=M;this.Wla=Ja;this.eak=pb;this.dak=Tb;this.xbc=Wc;this.KVa=sd;this.aZa=Object(E.a)(this,this.Iwk,"onReleaseDocumentCopyFinished");this.onError=Object(E.a)(this,this.Hwk,"onReleaseDocumentCopyError")}start(){this.bqd=!1;Gd.a.foc(this.oB,this.jB,this.Wla,this.eak,this.dak,Object(E.a)(this,this.xda,"handleWebserviceResponse"),
Object(E.a)(this,this.wda,"handleWebserviceError"))}Iwk(L){if(L.eSa){const M={};M.errorCode=L.result.ErrorCode;this.xbc(this.jB,M)}else this.handleError(L)}Hwk(L){this.handleError(L)}handleError(L){this.KVa&&(L=L.error,this.KVa(this.jB,!!L&&2===L.type))}}Object(h.a)(uk,"ReleaseGetDocumentCopyTask",zd.a,[]);class Ki{constructor(){this.gbd=null}start(){this.gbd.start()}static GDi(L,M,Ja,pb,Tb,Wc){const sd=new Ki;sd.gbd=new Mc(L,M,Ja,pb,Tb,Wc);return sd}static FDi(L,M,Ja,pb,Tb,Wc,sd){const Ed=new Ki;
Ed.gbd=new fd(L,M,Ja,pb,Tb,Wc,sd);return Ed}static MKf(L,M,Ja,pb,Tb,Wc,sd){const Ed=new Ki;Ed.gbd=new uk(L,M,Ja,pb,Tb,Wc,sd);return Ed}}Object(h.a)(Ki,"AppForOfficeTask",null,[]);class bj{constructor(){this.mre=1;this.Abf=new oc.a}get FDa(){return this.Abf}Ini(L,M,Ja,pb){const Tb=this.$3f();L=new De(L,M,Ja,pb);this.FDa.$(Tb.toString(),L);return Tb}Mhg(L,M){for(let Ja of this.FDa){const pb=Ja.value;if(pb.instanceId===L.toLowerCase()&&pb.$2d===M)return!0}return!1}f_f(L){return this.FDa.ga(L.toString())}lWk(L){this.FDa.remove(L.toString())}foc(L,
M,Ja,pb){(pb&&this.mWk(M)||Ja&&this.eWk())&&Ki.MKf(L,M,4,Ja,pb,()=>{},()=>{}).start()}eWk(){let L=!1;0<this.FDa.count&&(this.Abf=new oc.a,L=!0);return L}mWk(L){if(!L)return!1;const M=[];for(let Ja of this.FDa)Ja.value.instanceId===L.toLowerCase()&&M.push(Ja.key);for(L=0;L<M.length;L++)this.FDa.remove(M[L]);return 0<M.length}$3f(){return this.mre++}}Object(h.a)(bj,"GetDocumentCopyHelper",null,[828]);class wi{constructor(L,M){this.dyg=M.length;this.cfa=L;this.jgk=Math.ceil(this.dyg/L);this.IAi(M)}IAi(L){for(let M=
0;M<this.jgk;M++){const Ja=M*this.cfa;L.slice(Ja,Math.min(Ja+this.cfa,this.dyg))}}}Object(h.a)(wi,"DocumentCopyCache",null,[]);class za{constructor(){this.Aze=this.Xze=null;this.Bze=this.Yze=0}add(L,M,Ja,pb){4===M?(this.Yze=L,this.Xze=new wi(Ja,pb)):3===M&&(this.Bze=L,this.Aze=new wi(Ja,pb))}remove(L){this.Yze===L?(this.Yze=0,this.Xze=null):this.Bze===L&&(this.Bze=0,this.Aze=null)}contains(L){return 4===L&&!!this.Xze||3===L&&!!this.Aze}}Object(h.a)(za,"PerAppCache",null,[]);class sb{get cache(){return sb.ji}get a3d(){return sb.i8j}Mhg(L,
M){return L in this.cache&&this.cache[L].contains(M)}c1f(){}foc(L){if(L.toString()in this.a3d){const M=this.a3d[L.toString()];delete this.a3d[L.toString()];this.cache[M].remove(L)}}$3f(){return sb.mre++}}sb.ji={};sb.i8j={};sb.mre=1;Object(h.a)(sb,"GetFileApiProxy",null,[954]);class Nb{constructor(L,M,Ja){this.uh=0;this.controlId=this.zAa=this.vE=this.oBb=this.Yc=this.Ao=null;this.parameters=L;this.callback=M;this.Mbi=Ja;new sb;this.dcb=new Aa;this.yWa=new bj}get iHc(){this.dcb||(this.dcb=new Aa);
return this.dcb}get jda(){return this.yWa}get c5k(){this.vE||(this.vE=Bc.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.vE}get Rzj(){return this.zAa||(this.zAa=Bc.a.instance.Ja("Postmessage.IHostPostmessenger"))}get errorCode(){return this.uh}set errorCode(L){this.uh=L}get result(){return this.Ao}set result(L){this.Ao=L}get xu(){return this.oBb}get Jd(){return this.Yc}set Jd(L){(this.Yc=L)?(this.oBb=this.Yc.xu,this.yWa=this.Yc.jda):this.yWa=this.oBb=null}go(){this.Ao=
{};try{this.$q()}catch(L){this.o1j(L)}this.LH()}o1j(L){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;Sd.a.J(18396573,802,10,"Error when executing API: {0}",L.toString())}LH(){this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&Sd.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",this.uh);this.Ao[Td.c_Error]=this.uh;this.callback(this.Ao)}s5d(){return this.controlId?this.Jd?this.Jd.x_.HW(this.controlId):null:null}r3i(){if(!this.controlId)return null;let L=null;
this.Jd&&(L=this.Jd.x_.HW(this.controlId));return L?0===L.Ww?this.Jd.DVf(L.shape.slideId,L.shape.id):1===L.Ww?this.Jd.HDa(L.Ho.id):null:null}P$d(L){return L?this.Jd?this.Jd.P$d(L):null:null}}Object(h.a)(Nb,"ApiMethod",null,[]);class Ac extends Nb{constructor(){super()}$q(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[O.a.Abi][O.a.zbi],this.parameters);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}
Object(h.a)(Ac,"AppCommandInvocationCompletedMethod",Nb,[]);class Jd extends Nb{constructor(){super()}go(){this.Ao={};this.$q()}$q(){if(this.xu)try{const L=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();L&&L.length>this.Jd.GQd.od.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(n.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",L.length),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.LH()):this.xu.E7a(L,Object(E.a)(this,this.cDi,
"createDocumentSuccessCallback"),Object(E.a)(this,this.bDi,"createDocumentFailCallback"))}catch(L){Sd.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+L.toString()),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.LH()}else this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.LH()}cDi(L){const M=new y.StandardDialog;M.xd=4;M.Gx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Ja=>{1===Ja&&window.open(L);this.uh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.LH()})}bDi(L){this.uh=L?L:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}get description(){return"Create a new ppt document in the user's default folder."}}Object(h.a)(Jd,"CreateDocumentMethod",Nb,[]);var ge=d(96),re=d(89);class Xe{static kRk(L){const M=new Map;M.set("ApiId",L.toString());ge.Health.instance.recordKpiUsage(Xe.Smh,1,Xe.Omh,M)}static jRk(L,M,Ja){const pb=new Map;pb.set("ApiId",L.toString());L=Object.assign(new re.a,
{extendedProperties:pb,durationMs:Xe.i1f(M,Ja)});ge.Health.instance.recordKpiSuccess(Xe.Smh,L)}static Lfh(L){const M=new Map;M.set("fWacPartition",L.toString());ge.Health.instance.recordKpiUsage(Xe.Tmh,1,Xe.Omh,M)}static NPe(L,M){L=Object.assign(new re.a,{durationMs:Xe.i1f(L,M)});ge.Health.instance.recordKpiSuccess(Xe.Tmh,L)}static i1f(L,M){let Ja=null;L&&M&&(Ja=M-L);return Ja}}Xe.Smh="PptApiCall";Xe.Tmh="PptApiRequest";Xe.Omh="pptom";Object(h.a)(Xe,"PptWacApiTelemetry",null,[]);class $f{constructor(){this.ver=
0;this.exec=this.sel=null}}Object(h.a)($f,"ApiRequest",null,[]);class Tg{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(Tg,"SelectionData",null,[]);const hh=(L,M)=>{var Ja=Object,pb=Ja.assign,Tb=new $f,Wc=Object,sd=Wc.assign,Ed=new Tg,ee=L.xu.Qe();const kb=[];if(ee){kb.length=ee.length;for(var cf=0;cf<ee.length;cf++)kb[cf]=ee[cf].Cb.toString()}ee=L.xu.Wd();cf=[];if(ee){cf.length=ee.length;for(let Tf=0;Tf<ee.length;Tf++)cf[Tf]=ee[Tf].get_shapeId().toString()}L=pb.call(Ja,Tb,{ver:1,
exec:M,sel:sd.call(Wc,Ed,{sldLst:kb,shpLst:cf,txRn:L.xu.tij()})});return Sys.Serialization.JavaScriptSerializer.serialize(L)},qj=L=>{let M,Ja;M=L.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Ja=M.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Ja.addParameter("address","String",1,null,0);Ja.addParameter("displayName","String",1,null,0);Ja=M.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",
1,0,"InsertSlideFromContent",4);Ja.addParameter("slideContent","String",1,null,0);M=L.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);M.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);M.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);M.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);M.addProperty("Title",1,"String",1,!0,null,0);M.addMethod("GetSelectedShapes",
5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);M.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);M.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);M.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRangeOrNullObject",0);Ja=M.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",
0);Ja.addParameter("base64File","String",1,null,0);Ja.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Ja=M.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Ja.addParameter("slideIds","String[]",1,null,0);Ja=M.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Ja.addParameter("referenceId","String",1,null,0);Ja.addParameter("eventType","Int32",1,null,0);Ja=M.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);Ja.addParameter("referenceId",
"String",1,null,0);Ja.addParameter("eventType","Int32",1,null,0);M=L.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);M.addProperty("LayoutId",1,"String",1,!1,null,0);M.addProperty("SlideMasterId",2,"String",1,!1,null,0);M=L.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}","",3,0);M.addProperty("Visible",2,"Boolean",1,!1,null,0);M.addMethod("_OnAccess",1,"Void",0,
1,"_OnAccess",0);M=L.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");M.addEnumField("Straight",0);M.addEnumField("Elbow",1);M.addEnumField("Curve",2);M=L.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");M.addEnumField("LineInverse",0);M.addEnumField("Triangle",1);M.addEnumField("RightTriangle",2);M.addEnumField("Rectangle",3);M.addEnumField("Diamond",4);M.addEnumField("Parallelogram",5);M.addEnumField("Trapezoid",6);M.addEnumField("NonIsoscelesTrapezoid",7);M.addEnumField("Pentagon",
8);M.addEnumField("Hexagon",9);M.addEnumField("Heptagon",10);M.addEnumField("Octagon",11);M.addEnumField("Decagon",12);M.addEnumField("Dodecagon",13);M.addEnumField("Star4",14);M.addEnumField("Star5",15);M.addEnumField("Star6",16);M.addEnumField("Star7",17);M.addEnumField("Star8",18);M.addEnumField("Star10",19);M.addEnumField("Star12",20);M.addEnumField("Star16",21);M.addEnumField("Star24",22);M.addEnumField("Star32",23);M.addEnumField("RoundRectangle",24);M.addEnumField("Round1Rectangle",25);M.addEnumField("Round2SameRectangle",
26);M.addEnumField("Round2DiagonalRectangle",27);M.addEnumField("SnipRoundRectangle",28);M.addEnumField("Snip1Rectangle",29);M.addEnumField("Snip2SameRectangle",30);M.addEnumField("Snip2DiagonalRectangle",31);M.addEnumField("Plaque",32);M.addEnumField("Ellipse",33);M.addEnumField("Teardrop",34);M.addEnumField("HomePlate",35);M.addEnumField("Chevron",36);M.addEnumField("PieWedge",37);M.addEnumField("Pie",38);M.addEnumField("BlockArc",39);M.addEnumField("Donut",40);M.addEnumField("NoSmoking",41);M.addEnumField("RightArrow",
42);M.addEnumField("LeftArrow",43);M.addEnumField("UpArrow",44);M.addEnumField("DownArrow",45);M.addEnumField("StripedRightArrow",46);M.addEnumField("NotchedRightArrow",47);M.addEnumField("BentUpArrow",48);M.addEnumField("LeftRightArrow",49);M.addEnumField("UpDownArrow",50);M.addEnumField("LeftUpArrow",51);M.addEnumField("LeftRightUpArrow",52);M.addEnumField("QuadArrow",53);M.addEnumField("LeftArrowCallout",54);M.addEnumField("RightArrowCallout",55);M.addEnumField("UpArrowCallout",56);M.addEnumField("DownArrowCallout",
57);M.addEnumField("LeftRightArrowCallout",58);M.addEnumField("UpDownArrowCallout",59);M.addEnumField("QuadArrowCallout",60);M.addEnumField("BentArrow",61);M.addEnumField("UturnArrow",62);M.addEnumField("CircularArrow",63);M.addEnumField("LeftCircularArrow",64);M.addEnumField("LeftRightCircularArrow",65);M.addEnumField("CurvedRightArrow",66);M.addEnumField("CurvedLeftArrow",67);M.addEnumField("CurvedUpArrow",68);M.addEnumField("CurvedDownArrow",69);M.addEnumField("SwooshArrow",70);M.addEnumField("Cube",
71);M.addEnumField("Can",72);M.addEnumField("LightningBolt",73);M.addEnumField("Heart",74);M.addEnumField("Sun",75);M.addEnumField("Moon",76);M.addEnumField("SmileyFace",77);M.addEnumField("IrregularSeal1",78);M.addEnumField("IrregularSeal2",79);M.addEnumField("FoldedCorner",80);M.addEnumField("Bevel",81);M.addEnumField("Frame",82);M.addEnumField("HalfFrame",83);M.addEnumField("Corner",84);M.addEnumField("DiagonalStripe",85);M.addEnumField("Chord",86);M.addEnumField("Arc",87);M.addEnumField("LeftBracket",
88);M.addEnumField("RightBracket",89);M.addEnumField("LeftBrace",90);M.addEnumField("RightBrace",91);M.addEnumField("BracketPair",92);M.addEnumField("BracePair",93);M.addEnumField("Callout1",94);M.addEnumField("Callout2",95);M.addEnumField("Callout3",96);M.addEnumField("AccentCallout1",97);M.addEnumField("AccentCallout2",98);M.addEnumField("AccentCallout3",99);M.addEnumField("BorderCallout1",100);M.addEnumField("BorderCallout2",101);M.addEnumField("BorderCallout3",102);M.addEnumField("AccentBorderCallout1",
103);M.addEnumField("AccentBorderCallout2",104);M.addEnumField("AccentBorderCallout3",105);M.addEnumField("WedgeRectCallout",106);M.addEnumField("WedgeRRectCallout",107);M.addEnumField("WedgeEllipseCallout",108);M.addEnumField("CloudCallout",109);M.addEnumField("Cloud",110);M.addEnumField("Ribbon",111);M.addEnumField("Ribbon2",112);M.addEnumField("EllipseRibbon",113);M.addEnumField("EllipseRibbon2",114);M.addEnumField("LeftRightRibbon",115);M.addEnumField("VerticalScroll",116);M.addEnumField("HorizontalScroll",
117);M.addEnumField("Wave",118);M.addEnumField("DoubleWave",119);M.addEnumField("Plus",120);M.addEnumField("FlowChartProcess",121);M.addEnumField("FlowChartDecision",122);M.addEnumField("FlowChartInputOutput",123);M.addEnumField("FlowChartPredefinedProcess",124);M.addEnumField("FlowChartInternalStorage",125);M.addEnumField("FlowChartDocument",126);M.addEnumField("FlowChartMultidocument",127);M.addEnumField("FlowChartTerminator",128);M.addEnumField("FlowChartPreparation",129);M.addEnumField("FlowChartManualInput",
130);M.addEnumField("FlowChartManualOperation",131);M.addEnumField("FlowChartConnector",132);M.addEnumField("FlowChartPunchedCard",133);M.addEnumField("FlowChartPunchedTape",134);M.addEnumField("FlowChartSummingJunction",135);M.addEnumField("FlowChartOr",136);M.addEnumField("FlowChartCollate",137);M.addEnumField("FlowChartSort",138);M.addEnumField("FlowChartExtract",139);M.addEnumField("FlowChartMerge",140);M.addEnumField("FlowChartOfflineStorage",141);M.addEnumField("FlowChartOnlineStorage",142);
M.addEnumField("FlowChartMagneticTape",143);M.addEnumField("FlowChartMagneticDisk",144);M.addEnumField("FlowChartMagneticDrum",145);M.addEnumField("FlowChartDisplay",146);M.addEnumField("FlowChartDelay",147);M.addEnumField("FlowChartAlternateProcess",148);M.addEnumField("FlowChartOffpageConnector",149);M.addEnumField("ActionButtonBlank",150);M.addEnumField("ActionButtonHome",151);M.addEnumField("ActionButtonHelp",152);M.addEnumField("ActionButtonInformation",153);M.addEnumField("ActionButtonForwardNext",
154);M.addEnumField("ActionButtonBackPrevious",155);M.addEnumField("ActionButtonEnd",156);M.addEnumField("ActionButtonBeginning",157);M.addEnumField("ActionButtonReturn",158);M.addEnumField("ActionButtonDocument",159);M.addEnumField("ActionButtonSound",160);M.addEnumField("ActionButtonMovie",161);M.addEnumField("Gear6",162);M.addEnumField("Gear9",163);M.addEnumField("Funnel",164);M.addEnumField("MathPlus",165);M.addEnumField("MathMinus",166);M.addEnumField("MathMultiply",167);M.addEnumField("MathDivide",
168);M.addEnumField("MathEqual",169);M.addEnumField("MathNotEqual",170);M.addEnumField("CornerTabs",171);M.addEnumField("SquareTabs",172);M.addEnumField("PlaqueTabs",173);M.addEnumField("ChartX",174);M.addEnumField("ChartStar",175);M.addEnumField("ChartPlus",176);M=L.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");M.addEnumField("KeepSourceFormatting",0);M.addEnumField("UseDestinationTheme",1);M=L.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}",
"{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);M.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);M.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);M.addProperty("TargetSlideId",5,"String",1,!1,null,0);M=L.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");M.addEnumField("Left",0);M.addEnumField("Center",1);M.addEnumField("Right",2);M.addEnumField("Justify",3);M.addEnumField("JustifyLow",4);M.addEnumField("Distributed",5);M.addEnumField("ThaiDistributed",
6);M=L.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);M.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);M.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);M.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,
0);M.addProperty("Height",1,"Double",1,!1,null,0);M.addProperty("Left",2,"Double",1,!1,null,0);M.addProperty("Top",3,"Double",1,!1,null,0);M.addProperty("Width",4,"Double",1,!1,null,0);M=L.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Ja=M.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Ja.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Ja.addParameter("options",
"Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ja=M.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Ja.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Ja.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ja=M.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Ja.addParameter("text","String",1,null,0);Ja.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",
2,null,0);M.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ja.addParameter("index","Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ja.addParameter("id","String",1,null,0);M.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",
!0);M=L.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);M.addProperty("Id",1,"String",1,!0,null,0);M.addProperty("Name",3,"String",1,!0,null,0);M.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);M.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);M.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.SlideLayout",3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Ja.addParameter("index","Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);Ja.addParameter("id","String",1,null,0);M.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);M=L.addType("Microsoft.Office.PowerPoint.SlideMaster",
"{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);M.addProperty("Id",1,"String",1,!0,null,0);M.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);M.addProperty("Name",4,"String",1,!0,null,0);M.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);M.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);M.addProperty("Key",2,"String",1,!0,null,0);
M.addProperty("Value",3,"String",1,!1,null,0);M.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Ja=M.addMethod("Add",1,"Void",0,0,"Add",0);Ja.addParameter("key","String",1,null,0);Ja.addParameter("value","String",1,null,0);Ja=M.addMethod("Delete",2,"Void",0,0,"Delete",0);Ja.addParameter("key","String",1,null,0);M.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",
3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Ja.addParameter("index","Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Ja.addParameter("key","String",1,null,0);M.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);M=L.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}",
"",3,0);M.addProperty("Id",1,"String",1,!0,null,0);M.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);M.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);M.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);M.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);M.addMethod("Delete",3,"Void",0,0,"Delete",0);Ja=M.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Ja.addParameter("shapeIds",
"String[]",1,null,0);M.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);M=L.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");M.addEnumField("NoFill",0);M.addEnumField("Solid",1);M.addEnumField("Gradient",2);M.addEnumField("Pattern",3);M.addEnumField("PictureAndTexture",4);M.addEnumField("SlideBackground",5);M=L.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);M.addProperty("ForegroundColor",2,"String",1,!1,null,0);M.addProperty("Transparency",
5,"Double",1,!1,null,0);M.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);M.addMethod("Clear",1,"Void",0,0,"Clear",0);Ja=M.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);Ja.addParameter("color","String",1,null,0);M.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);M=L.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");M.addEnumField("Single",0);M.addEnumField("ThickBetweenThin",1);M.addEnumField("ThickThin",2);M.addEnumField("ThinThick",3);M.addEnumField("ThinThin",
4);M=L.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");M.addEnumField("Dash",0);M.addEnumField("DashDot",1);M.addEnumField("DashDotDot",2);M.addEnumField("LongDash",3);M.addEnumField("LongDashDot",4);M.addEnumField("RoundDot",5);M.addEnumField("Solid",6);M.addEnumField("SquareDot",7);M.addEnumField("LongDashDotDot",8);M.addEnumField("SystemDash",9);M.addEnumField("SystemDot",10);M.addEnumField("SystemDashDot",11);M=L.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}",
"",3,0);M.addProperty("Color",1,"String",1,!1,null,0);M.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);M.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);M.addProperty("Transparency",5,"Double",1,!1,null,0);M.addProperty("Visible",6,"Boolean",1,!1,null,0);M.addProperty("Weight",7,"Double",1,!1,null,0);M.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);M=L.addEnumType("Microsoft.Office.PowerPoint.ShapeType");M.addEnumField("Unsupported",
0);M.addEnumField("Image",1);M.addEnumField("GeometricShape",2);M.addEnumField("Group",3);M.addEnumField("Line",4);M=L.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");M.addEnumField("AutoSizeNone",0);M.addEnumField("AutoSizeTextToFitShape",1);M.addEnumField("AutoSizeShapeToFitText",2);M.addEnumField("AutoSizeMixed",3);M=L.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");M.addEnumField("Top",0);M.addEnumField("Middle",1);M.addEnumField("Bottom",2);M.addEnumField("TopCentered",
3);M.addEnumField("MiddleCentered",4);M.addEnumField("BottomCentered",5);M=L.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");M.addEnumField("None",0);M.addEnumField("Single",1);M.addEnumField("Double",2);M.addEnumField("Heavy",3);M.addEnumField("Dotted",4);M.addEnumField("DottedHeavy",5);M.addEnumField("Dash",6);M.addEnumField("DashHeavy",7);M.addEnumField("DashLong",8);M.addEnumField("DashLongHeavy",9);M.addEnumField("DotDash",10);M.addEnumField("DotDashHeavy",11);M.addEnumField("DotDotDash",
12);M.addEnumField("DotDotDashHeavy",13);M.addEnumField("Wavy",14);M.addEnumField("WavyHeavy",15);M.addEnumField("WavyDouble",16);M=L.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);M.addProperty("Bold",1,"Boolean",1,!1,null,0);M.addProperty("Color",2,"String",1,!1,null,0);M.addProperty("Italic",3,"Boolean",1,!1,null,0);M.addProperty("Name",5,"String",1,!1,null,0);M.addProperty("Size",6,"Double",1,!1,null,0);M.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",
1,!1,null,0);M.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);M.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);M.addProperty("Length",7,"Int32",1,!1,null,0);M.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);M.addProperty("Start",9,"Int32",1,!1,null,0);M.addProperty("Text",5,"String",1,!1,null,0);M.addMethod("GetParentTextFrame",
10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Ja=M.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Ja.addParameter("start","Int32",1,null,0);Ja.addParameter("length","Int32",1,null,0);M.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);M.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);M.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",
1,!1,null,0);M.addProperty("BottomMargin",2,"Double",1,!1,null,0);M.addProperty("HasText",4,"Boolean",1,!0,null,0);M.addProperty("LeftMargin",6,"Double",1,!1,null,0);M.addProperty("RightMargin",7,"Double",1,!1,null,0);M.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);M.addProperty("TopMargin",9,"Double",1,!1,null,0);M.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);M.addProperty("WordWrap",11,"Boolean",1,!1,null,0);
M.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);M.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);M.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);M.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);M.addProperty("Height",5,"Double",1,!1,null,0);M.addProperty("Id",1,"String",1,!0,null,0);M.addProperty("Left",6,"Double",1,!1,null,
0);M.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);M.addProperty("Name",7,"String",1,!1,null,0);M.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);M.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);M.addProperty("Top",8,"Double",1,!1,null,0);M.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);M.addProperty("Width",10,"Double",1,!1,null,0);M.addMethod("Delete",4,"Void",0,0,"Delete",
0);M.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);M.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);M.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);M.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);M.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",
3,0,"ParentSlideMasterOrNullObject",0);M.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);M.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);M.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",
3,1,"ItemAt",0);Ja.addParameter("index","Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ja.addParameter("id","String",1,null,0);M.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);M=L.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Ja=M.addMethod("Add",6,"Void",0,0,"Add",0);Ja.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",
2,null,0);M.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ja.addParameter("index","Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ja.addParameter("id","String",1,null,0);M.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",
!0);M=L.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);M.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ja.addParameter("index","Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ja.addParameter("id",
"String",1,null,0);M.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);M=L.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);M.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);Ja.addParameter("key","String",1,null,0);Ja=M.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Ja.addParameter("index",
"Int32",1,null,0);Ja=M.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);Ja.addParameter("id","String",1,null,0);M.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);M=L.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);M.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,
"AppRuntimeState",0);Ja=M.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ja.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);M=L.addEnumType("Microsoft.AppRuntime.AppRuntimeState");M.addEnumField("Inactive",0);M.addEnumField("Background",1);M.addEnumField("Visible",2);M=L.addEnumType("Microsoft.AppRuntime.Visibility");M.addEnumField("Hidden",1);M.addEnumField("Visible",2);M=L.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}",
"{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);M.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Ja=M.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Ja.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);M=L.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");M.addEnumField("Unknown",0);M.addEnumField("Basic",1);M.addEnumField("Premium",2);M=L.addType("Microsoft.Office.Licensing.License",
"{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ja=M.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ja.addParameter("feature","String",1,null,0);Ja.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ja=M.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ja.addParameter("feature","String",1,null,0);Ja=M.addMethod("GetMsaDeviceTicket",
7,"String",1,1,"MsaDeviceTicket",4);Ja.addParameter("resource","String",1,null,0);Ja.addParameter("policy","String",1,null,0);Ja.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Ja=M.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ja.addParameter("feature","String",1,null,0);Ja.addParameter("fallbackValue","Boolean",1,null,0);M.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ja=M.addMethod("LaunchUpsellExperience",
4,"Void",0,1,"LaunchUpsellExperience",0);Ja.addParameter("experienceId","String",1,null,0);Ja=M.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ja.addParameter("feature","String",1,null,0);M=L.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);M.addProperty("Id",5,"String",1,!0,null,0);M.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);M.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",
0);M=L.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);M.addProperty("Scopes",1,"String",1,!1,null,0);M=L.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);M.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ja=M.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",
0);Ja.addParameter("jsonCreate","String",1,null,0);Ja=M.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ja.addParameter("jsonUpdate","String",1,null,0);Ja=M.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ja.addParameter("id","String",1,null,0);Ja=M.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ja.addParameter("id","String",1,null,0);M.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.DynamicRibbon.RibbonTab",
"{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);M.addProperty("Id",2,"String",1,!0,null,0);Ja=M.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ja.addParameter("visibility","Boolean",1,null,0);M.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);M.addProperty("Enabled",3,"Boolean",1,!1,null,0);M.addProperty("Id",2,"String",1,!0,null,0);M.addProperty("Label",4,"String",1,!0,null,0);Ja=M.addMethod("SetEnabled",
5,"Void",0,0,"SetEnabled",0);Ja.addParameter("enabled","Boolean",1,null,0);M.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);M=L.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);M.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ja=M.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ja.addParameter("key","String",1,null,0);M.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);M.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",
!0)};var de=d(43);class Yf{constructor(L,M){this.Zgc=L;this.Bgc=M}QJf(L){return[200,null,L]}RTi(L,M,Ja,pb,Tb,Wc){const sd=de.a.$Y(),Ed=this.Zgc.create(M,Ja,pb);pb.Irf=Ed;const ee=this.Bgc.create(Wc);ee.context.appId=M;ee.context.controlId=Ja;const kb=()=>{Xe.Lfh(!0);Ed.cMe=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ed,qj,ee,L).then(Tf=>{if(!Tf)return n.ULS.sendTraceTag(587745500,802,10,"ExecuteRichApiRequest failed."),Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),
null;Xe.NPe(sd,de.a.$Y());Tb(Tf,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},Tf=>{n.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",M,Tf);Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},cf=()=>{Xe.Lfh(!1);let Tf=L[4];Ue.a("ExtensibilityUseSerializedPayloads")&&(Tf=hh(pb,Tf));OfficeExtension.WacRuntime.Utility.createPromise(zg=>{const ci={};ci.promiseToResolve=zg;ci.requestBody=Tf;B.AFrameworkApplication.Ta.La(Ji.a.Z1d,
2,ci)}).then(zg=>{Ue.a("ExtensibilityResetResponse")&&B.AFrameworkApplication.Ta.La(Ji.a.Z1d,2,{promiseToResolve:null,requestBody:""});if(Ue.a("ExtensibilityUseSerializedPayloads")){a:if((zg=Sys.Serialization.JavaScriptSerializer.deserialize(zg.toString()))&&zg.sel&&zg.sel.sldLst){var ci=Wc.presentation,ah=zg.sel.sldLst,Qe=[];if(ah)for(Di of ah)({slideId:ah}=Uc.a.LDh(Di)).returnValue&&(ah=Object(da.a)(116,ci.xC(ah)))&&Qe.push(ah);var Di=Qe;if(Di.length&&!pb.xu.$zl(Di))zg=null;else{Di=1===Di.length?
Di[0]:null;ci=null;if(Di&&zg.sel.shpLst){Qe=zg.sel.shpLst;ci=[];if(Qe)for(pk of Qe)(Qe=Di.iT(parseInt(pk)))&&ci.push(Qe);var pk=ci;if(pk.length&&!pb.xu.Zzl(pk)){zg=null;break a}ci=1===pk.length?pk[0]:null}zg=ci&&zg.sel.txRn&&(zg.sel.txRn.length&&2!==zg.sel.txRn.length||2===zg.sel.txRn.length&&0<=zg.sel.txRn[0]&&!pb.xu.aAl(ci,zg.sel.txRn[0],zg.sel.txRn[1]))?null:zg.rst}}else zg=null;zg?(Xe.NPe(sd,de.a.$Y()),Tb(this.QJf(zg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Xe.NPe(sd,
de.a.$Y()),Tb(this.QJf(zg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Tb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};L?(Ed.cMe=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ed,qj,ee,L).then(Tf=>{Tf&&Ed.pxg?kb():cf();return null},()=>{cf();return null})):kb()}}Object(h.a)(Yf,"RichApiRequest",null,[]);class vk extends Nb{constructor(L,M,Ja){super();this.Zgc=L;this.Bgc=M;this.ua=Ja}go(){this.Ao={};this.$q()}$q(){const L=this.parameters.ArrayData;
if(L){var M=null,Ja=this.s5d();Ue.a("SetOwnerAddinAssetIdForSharedRuntimeAPIsInPptWac")?Ja&&Ja.taskpane&&(M=Ja.taskpane.ownerAddinSolutionId):Ja&&(M=Ja.Ho.id);try{(new Yf(this.Zgc,this.Bgc)).RTi(L,M,this.controlId,this.Jd,Object(E.a)(this,this.STi,"executeRichApiRequestCallback"),this.ua)}catch(pb){Sd.a.J(36804577,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+pb.toString()),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.LH()}}else this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
this.LH()}STi(L,M){this.errorCode=M;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.Ao.Data=L);this.LH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(h.a)(vk,"ExecuteRichApiRequestMethod",Nb,[]);class Gj extends Nb{constructor(){super()}go(){this.Ao={};this.$q()}$q(){const L=this.oBb.fJj();n.ULS.sendTraceTag(587747344,802,50,"GetAccessToken was called!");const M=(Ja,pb)=>{Ja===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(pb=pb.accessToken,this.Ao[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
pb):(pb=this.Jd.x_.HW(this.controlId),n.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Ja.toString(),["appId"]:pb.Ho.id,["storeType"]:pb.Ho.storeType}));this.uh=Ja;this.LH()};this.Rzj.execute(Ja=>{const pb=this.Jd.vl,Tb=yd.getInstance();Ef.AppsForOfficeSingleSignOnManager.getInstance(pb,Ja,Tb).getAccessToken(this.controlId,L,this.parameters,M)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(Gj,"GetAccessTokenMethod",Nb,[]);class Pm extends Nb{constructor(){super()}$q(){let L=
null;this.xu&&(L=Microsoft.Office.WebExtension.ActiveView.Edit);L?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=L,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}Object(h.a)(Pm,"GetActiveViewMethod",Nb,[]);var ok=d(975);class wk extends Nb{constructor(){super()}go(){this.Ao={};this.$q()}$q(){var L=this.Yc.vl.getOsfControl(this.controlId);if(!B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",
!1)||L.isFirstParty()){L=L.getManifest();var M=L.getMarketplaceID(),Ja=L.getWebApplicationId(),pb=L.getWebApplicationMsaId();Bc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(M).then(Tb=>{this.errorCode=0;const Wc={};Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Tb.upn;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Tb.userId;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ja;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=
pb?pb:Ja;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Tb.authority;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=ok.a.IZf(Tb.authorityType);Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Tb.isAnonymous;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Tb.tenantId;Wc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Tb.supportsAuthToken;this.Ao[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Wc;this.LH()},Tb=>{this.uh=1;this.Ao[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Tb;this.LH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)(wk,"GetAuthContextMethod",Nb,[]);class Am extends Nb{constructor(){super()}go(){this.Ao={};this.$q();this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.LH()}$q(){var L=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const M=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];
L=this.jda.f_f(L);!L||M*L.Xwh>=L.fileSize?this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(Ki.FDi(this.Jd.presentationId,this.controlId,L.$2d,M,L.Xwh,Object(E.a)(this,this.Z1b,"customizedOnFinished"),Object(E.a)(this,this.Y1b,"customizedOnError")).start(),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}Z1b(L,M){L?0===M.errorCode?(L=M.value,this.Ao[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=L,this.Ao[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=
L.length,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}Y1b(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}get description(){return"Returns the specified slice."}}Object(h.a)(Am,"GetDocumentCopyChunkMethod",Nb,[]);class Fk extends Nb{constructor(){super();this.cfa=this.Wla=0}go(){this.Ao={};this.$q();this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
this.LH()}$q(){try{const L=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.cfa=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.cfa||4194304<this.cfa)Sd.a.J(17310339,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.cfa),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(L){case 1:this.Wla=4;break;case 2:this.Wla=3;break;default:Sd.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+
L);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.jda.Mhg(this.controlId,this.Wla)?this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.jda.FDa.count>=this.Jd.GQd.od.pptEditorAppForOfficeMaxDocumentReaders?this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.c5k.u3(!1,!0,()=>{this.n5k()},Object(E.a)(this,this.lya,"saveFailureCallback")),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(L){Sd.a.J(17310343,802,10,
"Exception thrown at GetDocumentCopyMethod: "+L.toString()),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}n5k(){Ki.GDi(this.Jd.presentationId,this.controlId,this.Wla,this.cfa,Object(E.a)(this,this.Z1b,"customizedOnFinished"),Object(E.a)(this,this.Y1b,"customizedOnError")).start()}lya(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH();return!1}Z1b(L,M){if(L&&L.length){L=M.format;var Ja=M.sliceSize,pb=M.errorCode;0===pb?(M=M.fileSize,this.Ao[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=
M,M=this.jda.Ini(this.controlId,M,Ja,L),this.Ao[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=M,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=174===pb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===pb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}Y1b(L,M){this.uh=M?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}get description(){return"Returns the entire document file in slices."}}Object(h.a)(Fk,"GetDocumentCopyMethod",Nb,[]);class Ih extends Nb{constructor(){super()}$q(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const L=this.r3i(),M=this.xu.u8i(L);M&&(this.Ao[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=M,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(L){Sd.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+
L)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(Ih,"GetDocumentThemeMethod",Nb,[]);class yj extends Nb{constructor(){super()}$q(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let L=null;if(this.xu&&void 0!==(L=this.xu.Bwb())&&null!==(L=this.xu.Bwb())){var M={};M[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=L;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=M;this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}
Object(h.a)(yj,"GetFilePropertiesMethod",Nb,[]);class zj extends Nb{constructor(){super()}$q(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(zj,"GetOfficeThemeMethod",Nb,[]);class Zl extends Nb{constructor(){super()}$q(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.xu)try{var L=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();L===Microsoft.Office.WebExtension.CoercionType.SlideRange?
(L=null,this.uh=({i7k:L}=this.xu.lij()).returnValue,this.Ao[OSF.DDA.WAC.UniqueArguments.Data]=L):L===Microsoft.Office.WebExtension.CoercionType.Text?(L=null,this.uh=({Epc:L}=this.xu.pij()).returnValue,this.Ao[OSF.DDA.WAC.UniqueArguments.Data]=L):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(M){Sd.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+M.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(h.a)(Zl,
"GetSelectedDataMethod",Nb,[]);class vn extends Nb{constructor(){super()}$q(){var L=this.s5d();if(L){const M={};M.Settings=this.G4d(L.settings);this.Ao[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=M;this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else L="AppForOffice instance could not be found for ID "+this.controlId+Pc.Debug.St(),Sd.a.J(8958160,802,10,L),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}G4d(L){const M=
{};let Ja=0;for(let pb in L)M[Ja.toString()]=[pb,L[pb]],Ja++;return M}}Object(h.a)(vn,"LoadSettingsMethod",Nb,[]);class lm extends Nb{constructor(){super()}$q(){n.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.oBb.Jka()?(this.uh=Wa.instance.vsa.Wlk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[O.a.RPd],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
n.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.uh.toString())):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(lm,"MessageParentMethod",Nb,[]);class $l extends Nb{constructor(){super()}$q(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.xu)try{const L=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],M=L[OSF.DDA.Marshaling.NavigationKeys.GoToType],
Ja=L[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.uh=M===OSF.DDA.Marshaling.GoToType.Index?this.xu.qpj(Ja):M===OSF.DDA.Marshaling.GoToType.Slide?this.xu.rpj(Ja):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(L){Sd.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+L.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)($l,"NavigateToMethod",Nb,[]);class mm extends Nb{constructor(){super();this.Que=0}go(){this.Ao={};this.$q();
this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.LH()}$q(){this.Que=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const L=this.jda.f_f(this.Que);L?(Ki.MKf(this.Jd.presentationId,this.controlId,L.$2d,!1,!1,Object(E.a)(this,this.Z1b,"customizedOnFinished"),Object(E.a)(this,this.Y1b,"customizedOnError")).start(),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}Z1b(L,M){L?0===M.errorCode?
(this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.jda.lWk(this.Que)):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}Y1b(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.LH()}get description(){return"Closes the document file."}}Object(h.a)(mm,"ReleaseDocumentCopyMethod",Nb,[]);class xk extends Nb{constructor(){super();this.gIa=null}$q(){var L=this.s5d();if(L){var M=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];
this.gIa=this.G4d(Array.isArray(M[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?M[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);M=null;L.taskpane&&(M=L.taskpane.ownerAddinSolutionId);var Ja;if(L.taskpane&&M)if(Ja=this.Jd.HDa(M)){this.xu.JTe(Ja,this.gIa);if(Ja=this.Jd.x_.r5d(M))Ja.settings=this.gIa;L.settings=this.gIa;this.Jd.j5e(M,this.gIa);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.iHc.U$f(M,this.gIa,this.Yc)?(L.settings=this.gIa,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(Ja=0===L.Ww?this.Jd.DVf(L.shape.slideId,L.shape.id):this.Jd.HDa(L.Ho.id))?(this.xu.JTe(Ja,this.gIa),L.settings=this.gIa,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else L="AppForOffice instance could not be found for ID "+this.controlId+Pc.Debug.St(),Sd.a.J(9052994,802,10,L),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}G4d(L){const M=
{};if(L)for(let Ja=0;Ja<L.length;Ja++){const pb=Array.isArray(L[Ja])?L[Ja]:null;pb&&1<pb.length&&(M[pb[0]]=pb[1])}return M}}Object(h.a)(xk,"SaveSettingsMethod",Nb,[]);class cl extends Nb{constructor(){super()}$q(){this.oBb.Jka()?(Wa.instance.vsa.T7k(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[O.a.RPd],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(cl,"SendMessageMethod",Nb,[]);class If extends Nb{constructor(){super()}$q(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.xu)try{const M=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var L=M.CoerceType.toString();const Ja=M[OSF.DDA.WAC.UniqueArguments.Data];if(L===Microsoft.Office.WebExtension.CoercionType.Text)this.uh=this.xu.fdl(Ja);else{let pb;if(L===Microsoft.Office.WebExtension.CoercionType.Image)pb=0;else if(L===Microsoft.Office.WebExtension.CoercionType.XmlSvg)pb=
1;else{this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}L=!1;let Tb=0,Wc=0,sd=0,Ed=0;({lyj:L,x:Tb,y:Wc,width:sd,height:Ed}=this.JUi(M,L,Tb,Wc,sd,Ed));this.uh=this.xu.adl(Ja,L,Tb,Wc,sd,Ed,pb)}}catch(M){Sd.a.J(17310337,802,10,"Exception thrown at SetSelectedDataMethod: "+M)}}JUi(L,M,Ja,pb,Tb,Wc){const sd=L[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],Ed=L[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==sd&&null!==sd&&"number"===typeof sd&&void 0!==Ed&&null!==Ed&&"number"===
typeof Ed&&(M=!0,Ja=sd,pb=Ed);L[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Tb=L[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);L[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Wc=L[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{lyj:M,x:Ja,y:pb,width:Tb,height:Wc}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(If,"SetSelectedDataMethod",Nb,[]);class Bl extends Eg{constructor(L){super(L)}SFk(){this.xfc={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new vn);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new xk);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Pm);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new $l);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new Zl);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new yj);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Ih);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new zj);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new If);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Fk);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new Am);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new mm);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new Ac);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new lm);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new cl);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new Gj);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new wk);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new Jd);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new vk(this.Yc.B3k,this.Yc.XIk,this.Yc.q_))}}Object(h.a)(Bl,"EditorMethodFactory",Eg,[]);class rj extends Sys.EventArgs{constructor(L){super();this.kTh=L}get instanceId(){return this.kTh}}Object(h.a)(rj,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class Bm{constructor(){this.PWa=
{};this.Zve={};this.b$c={};this.h6c={}}Trf(L,M){M&&L&&(this.PWa[L]=M,this.h6c[L]=!1)}c5h(L,M){L&&M&&(this.b$c[L]=M)}hWk(L){if(L){var M=this.PWa[L];M&&(delete this.b$c[M.Ho.id],delete this.PWa[L],delete this.Zve[L],delete this.h6c[L])}}HW(L){return L?this.PWa[L]:null}Oaj(L){return L?this.h6c[L]:!1}dkj(L){return L?this.Zve[L]:null}OGh(L,M){L&&(this.h6c[L]=M)}HFl(L,M){L&&(this.Zve[L]=M)}r5d(L){if(!L)return null;const M=this.PWa;for(let Ja in M){const pb=M[Ja];if(pb&&pb.Ho.id.toLowerCase()===L.toLowerCase())return pb}return null}n3i(L,
M,Ja){if(!L||!M||!Ja)return null;const pb=this.PWa;for(let Tb in pb){const Wc=pb[Tb];if(Wc&&Wc.taskpane&&Wc.taskpane.ownerAddinSolutionId&&Wc.taskpane.ownerAddinSolutionId.toLowerCase()===L.toLowerCase()){const sd=Ja.getOsfControl(Wc.instanceId);if(sd&&sd.getSharedRuntimeId()===M)return Wc}}return null}s4d(L){Da.a.forEach(this.PWa,(M,Ja)=>{M=Object(da.a)(834,Ja);1===M.Ww&&L(M)},null)}cXi(L){const M=this.PWa;for(let Ja in M){const pb=Object(da.a)(834,M[Ja]);if(pb&&L(pb))return pb}return null}CVf(L){return L in
this.b$c?this.b$c[L]:null}}Object(h.a)(Bm,"OsfAppInstacneCache",null,[]);class dn{constructor(){}}Object(h.a)(dn,"AppForOfficeSDXDialog",null,[859]);class xa{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed,ee,kb,cf,Tf,zg,ci,ah,Qe,Di,pk,ch,hf,Ij,Kf,ne,xf,wn){this.eDb=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.eX;this.R0b=!1;this.bcb=this.Fea=this.spe=this.Irf=null;this.va=new P.a;this.ABg=!1;this.Wn=L;this.lJ=M;this.Iye=new Bl(this);this.Q2c=new xg(this,hf);this.yWa=
Ij;this.eWa=pb;this.mtg={};this.ZF=new Bm;this.E5j=Ja;this.CBb=Tb.value;this.bA=sd;this.Qb=Wc;this.RX=Ed;this.Rb=ee;this.t5j=Di;this.Yua=kb;this.Pb=cf;this.vi=Tf;this.ua=zg;this.Fa=ci;this.jc=ah;this.oc=Qe;this.Kbc=ch;this.dcb=new Aa;this.q5j=pk;this.gl=Kf;this.Zgc=ne;this.Bgc=xf;this.$bk=wn}initialize(){this.r6(this.Rb.mode);this.Rb.PK(Object(E.a)(this,this.H$f,"handleModeSwitch"))}dispose(){this.Rb.yY(Object(E.a)(this,this.H$f,"handleModeSwitch"))}get iHc(){this.dcb||(this.dcb=new Aa);return this.dcb}get vl(){if(!xa.Wua){this.Wn&&
(this.Wn.od.eJj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ie),this.Pb.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ie,new pg(this.Wn.od.vg?B.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:B.AFrameworkApplication.fa.appSettings.WebServiceBase),this.Pb.ka("306")),OfficeExt.MosRequestHandler.init(new Ie),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ie));const L=new wf(this.Iye,
this.Q2c);this.bcb=this.xF.SBi(this.ZF);xa.Wua=this.E5j.CCi(this.lJ,L,this.bcb);xa.Wua.setOAuthManager(this.$bk);xa.Wua&&"undefined"!==typeof xa.Wua.hostCheckReadyHandler&&B.AFrameworkApplication.n9h(Object(E.a)(xa.Wua,xa.Wua.hostCheckReadyHandler,"hostCheckReadyHandler"))}return xa.Wua}r4e(L){(L=this.vl.getOsfControl(L))&&this.bcb&&this.bcb.r2g(L)}$jc(L,M){this.bcb.$jc(L,M)}MAb(L,M,Ja){this.bcb?this.bcb.TYj(L,M,Ja):n.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}okb(L,M,Ja=null){const pb=
this.xF.b3(L);if(this.Pb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Ntb(pb.storeType)))this.gl.Lda(22)||this.gl.iDa(22);else if(0===pb.Ww)this.eWa.bJj(pb.id)?(Ja=this.eWa.Bra[pb.id],Ue.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.eWa.QKa(pb.id,this.AXe(L),M):(Ja.VUe(M),this.eWa.QKa(pb.id,this.AXe(L),null))):(L=this.nqd(L,M),L.VUe(M),this.eWa.d5k(pb.id,L));else if(1===pb.Ww){const Tb=pb.node.sa(nf.a.KZ,null);this.oua(pb.id)?pb.hgg||this.yLb(Tb,!0):this.nqd(L,M,Ja);this.Wn.od.aua&&
!pb.ownerAddinSolutionId&&(M=this.P$d(pb.Sxa),this.j5e(pb.Sxa,M.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.Fea=new vi;this.Fea.Zi("",null,null);this.vl.launchInsertDialog(this.Fea.Bja)}SYj(L){const M=this.PGc.G2i(L);this.Wn.VG().La(wc.a.Fee,2,{version:M.version,storeType:M.storeType,storeId:M.storeId,assetId:M.assetId,assetStoreId:M.assetStoreId,targetType:M.targetType,displayName:M.displayName,solutionId:L,width:M.width,height:M.height})}y1c(L){const M=this.vl.getAppUILocale()||
"en-US";this.Vrg=new Zg(L,"wac_powerpoint",M,Ja=>{this.Wn.VG().La(wc.a.Fee,2,Ja);this.Vrg.hide()});this.Vrg.Zi("",null,null);return!0}bZj(L){this.va.raiseEvent("OnInsertionDialogOpened");this.Fea=new vi;this.Fea.Zi("",null,null);if(L){const M={navigationMode:0};M.assetId=L;this.vl.launchInsertDialog(this.Fea.Bja,"{98143890-AC66-440E-A448-ED8771A02D52}",M)}else this.vl.launchInsertDialog(this.Fea.Bja)}Yog(L){this.va.raiseEvent("OnInsertionDialogOpened");this.Fea=new vi;this.Fea.Zi("",null,null);this.vl.launchInsertDialog(this.Fea.Bja,
L,{navigationMode:0,assetId:null,category:null})}acg(){this.Fea&&this.Fea.hide()}Iib(L){const M=this.dWf(L);M?this.djh(M):n.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",L))}djh(L){const M=this.xF.b3(L);if(this.Pb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Ntb(M.storeType)))this.gl.Lda(22)||this.gl.iDa(22);else{var Ja=(pb,Tb)=>{const Wc=this.xF.b3(pb),sd=this.xF.jLc(B.AFrameworkApplication.isRtl,Wc.id,Wc.width,Wc.visibility);Tb.RP(sd);
this.eDb||sd.xp(Wc.visibility);let Ed=Tb=null;this.Wn.od.aua&&this.Wn.od.JVj&&(Ed=this.ykd(L),Tb=()=>{this.WK(sd,!0,!1);this.HOb(Ed)});this.okb(pb,sd.hHc,Tb);this.eDb&&(Ed&&(pb=this.pQ(Ed.Ho.id).nca,sd.tel(pb)),sd.xp(Wc.visibility))};if(this.Wn.od.aua){const pb=this.xF.b3(L),Tb={};Tb.solutionId=pb.Sxa;Tb.version=pb.version;Tb.storeType=this.Ntb(pb.storeType);Tb.storeId=pb.store;Tb.targetData=L;this.vl.isAddinCommandsAsync(Tb,(Wc,sd)=>{const Ed=this.ykd(L);var ee=L.sa(dg.a.isForUILessAction,!1);const kb=
L.sa(dg.a.sharedRuntimeId,null),cf=pb.ownerAddinSolutionId,Tf=!!Ed.ew&&0<Ed.ew.state&&!!Ed.ew.kya;if(!sd&&pb.visibility||sd&&cf&&!Tf||ee&&!ma.a.Wa(kb))Ja(L,this.bA),this.x_.OGh(pb.id,sd);else if(sd){if(ee=this.h4b(pb.Sxa))Ed.settings=ee.settings,this.xu.JTe(L,Ed.settings);this.x_.Trf(Ed.instanceId,Ed);this.x_.OGh(Ed.instanceId,sd);this.j5e(Ed.Ho.id,Ed.settings);if(pb.visibility&&this.Yua.installVisibleAddinCommandsEnabled||Tf){if("omex"!==Tb.storeType.toLowerCase()&&!Tf)return;let zg=!1;this.sNe(ci=>
{if(!ci[O.a.Fbi]){if(ci[O.a.bvf])for(const ah of ci[O.a.bvf])if(zg=oj.e(ah[1])===oj.e(pb.Sxa))break;zg||this.HFc(Ed)}})}}Wc||Sd.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",pb.Sxa,this.Ntb(pb.storeType))})}else Ja(L,this.bA)}}dwb(L){return L&&L.assetId?L.sourceLocationOverrideResourceId?String.format("{0}.{1}",L.assetId,L.sourceLocationOverrideResourceId):L.assetId:null}H_k(L){L.C0b=-1;const M=this.kAf(L);this.chc=void 0!=L.dNc&&void 0!=L.hNc?new bk(L.dNc,L.hNc):new bk;void 0!=
L.dialogLeft&&void 0!=L.gNc&&void 0!=L.dialogTop&&void 0!=L.bNc&&this.chc.x$k(L.dialogLeft,L.gNc,L.dialogTop,L.bNc);void 0!=L.dialogHeight&&void 0!=L.dialogWidth&&this.chc.y$k(L.dialogHeight,L.dialogWidth);this.chc.Zi("",null,null);this.nqd(M,this.chc.Bja,null,L)}s_k(L){Ue.a("EnableSDXDialog2")&&(L.C0b=1);const M=this.kAf(L),Ja=this.xF.b3(M);if(B.AFrameworkApplication.zle(Ja.Sxa)){const pb=this.xF.jLc(B.AFrameworkApplication.isRtl,Ja.id,Ja.width,Ja.visibility,L);this.bA.RP(pb);pb.xp(Ja.visibility);
this.nqd(M,pb.hHc,null,L)}}sNe(L){const M={};M.callback=L;B.AFrameworkApplication.Ta.La(wc.a.OZa,2,M)}HFc(L){const M=this.xF.jLc(B.AFrameworkApplication.isRtl,L.instanceId,L.taskpane.width,L.taskpane.visibility);this.bA.RP(M);M.xp(L.taskpane.visibility);const Ja=M.hHc;Object(da.a)(833,this.xF.wXd(this.Wn.od,L,Ja,B.AFrameworkApplication.isRtl,this)).HFc(this.vl,Ja,()=>{this.HOb(L);this.WK(M,!1,!!L.ew&&!!L.ew.kya);v.a.instance.setItem(O.a.NPd,"true")})}WK(L,M,Ja){L.xp(!1);Ja||(xa.Wua.purgeOsfControl(L.id,
!1),M?this.Wn.VG().La(Ji.a.dWc,2,L.id):this.Q2c.lFf(L.id),L.dispose())}HOb(L){var M={};M.solutionId=L.Ho.id;M.version=L.Ho.version;M.storeType=L.Ho.storeType;M.storeId=L.Ho.store;M.assetId=null;M.assetStoreId=null;M.sharedRuntimeId=L.ew?L.ew.kya:null;M.backgroundState=L.ew?L.ew.state:-1;L=new e.a;L.add(M);M={};M[O.a.NGc]=L;M[O.a.P7]=3;this.Wn.VG().La(wc.a.w1c,2,M)}nRc(){const L=this.RX.Ef;var M=null;L&&(M=new Ia.GraphIterator,M.set(L),M=M.Bb(18));return M}pQ(L){return L?(L=this.ZF.r5d(L))&&L.taskpane?
L:null:null}lYi(L,M,Ja,pb){if(!L||!M||!Ja)return null;L=this.getSharedRuntimeId(M,pb,L.solutionId,Ja);return(Ja=this.ZF.n3i(Ja,L,this.vl))&&Ja.taskpane?Ja:null}WPc(L){return L?(L=this.ZF.HW(L))&&L.taskpane?L:null:null}HDa(L){if(!L)return null;var M=this.nRc();if(M&&(M=this.Qb.Nc(M))&&M.Bb(19)){do{const Ja=M.currentNode;if(this.sZb(Ja.sa(je.a.Crb,null),L))return Ja}while(M.Dj(19))}return null}dWf(L){if(!L)return null;var M=this.nRc();if(M&&(M=this.Qb.Nc(M))&&M.Bb(19)){do{const Ja=M.currentNode;if(this.sZb(Ja.sa(nf.a.KZ,
null),L))return Ja}while(M.Dj(19))}return null}DVf(L,M){return(L=this.oc.zl(L))?L.iT(M):null}yIj(L){return L?this.ZF.Oaj(L):!1}Fji(L,M,Ja,pb,Tb){if(!L||!L)return null;let Wc;if(!(L.solutionId&&L.version&&L.storeId&&L.storeType))return n.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Wc=Object(da.a)(lb.a,this.CBb.createInstance(1074135137));Wc.setValue(je.a.Crb,L.solutionId);Wc.setValue(je.a.qHc,L.version);Wc.setValue(je.a.pHc,L.storeId);Wc.setValue(nf.a.cZb,this.WKc(L.storeType));Wc.setValue(je.a.lHc,
!1);Wc.setValue(nf.a.KZ,ce.a.create().toString());Wc.setValue(je.a.CQd,"right");Wc.setValue(je.a.fZb,Ja);Tb&&Wc.setValue(dg.a.isForUILessAction,Tb);pb&&(Wc.setValue(nf.a.j8g,pb),(L=this.getSharedRuntimeId(M,Tb,L.solutionId,pb))&&Wc.setValue(dg.a.sharedRuntimeId,L));return Wc}t5d(L){L=this.HDa(L);return this.ykd(L)}Eji(L,M){if(!(L&&L&&L.solutionId&&L.version&&L.storeId&&L.storeType))return null;L=new Ma(L.solutionId,L.version,L.storeId,L.storeType);M=M?new Lb(0,M):null;return new hc(L,null,null,null,
null,{},1,M)}BNc(L){Ef.AppsForOfficeSingleSignOnManager.Nqi(L);const M=this.ZF.HW(L);M&&(xa.Wua.purgeOsfControl(M.instanceId,!1),this.Q2c.lFf(M.instanceId),this.ZF.hWk(M.instanceId),this.eWa.ehh(M.instanceId),this.yWa.foc(this.presentationId,L,!1,!0))}notifyAgave(L,M){this.vl.notifyAgave(L,M)}nTk(L){!this.ABg&&L.Sj&&(L=L.Sj,L.yd(47).N7(Object(E.a)(this,this.ewf,"appDisposeHandler")),L.yd(10).N7(Object(E.a)(this,this.ewf,"appDisposeHandler")),this.ABg=!0)}ewf(L,M){L=M.node;M=1074135137===L.Ue;if(L.sa(nf.a.Dq,
!1)||M)L=this.xF.b3(L),this.BNc(L.id)}kAf(L){var M;const Ja=Object(da.a)(9,this.CBb.createInstance(1074135137));Ja.setValue(je.a.qHc,"1.0.0.0");Ja.setValue(je.a.pHc,"en-US");Ja.setValue(nf.a.KZ,ce.a.create().toString());Ja.setValue(je.a.fZb,!0);Ja.setValue(nf.a.vQd,null);Ja.setValue(nf.a.cwf,null);Ja.setValue(je.a.Crb,this.dwb(L));(null!==(M=L.vIh)&&void 0!==M?M:1)?(Ja.setValue(je.a.dZb,"sdxcatalog"),Ja.setValue(nf.a.cZb,this.WKc("sdxcatalog"))):(Ja.setValue(je.a.dZb,"firstparty"),Ja.setValue(nf.a.cZb,
this.WKc("firstparty")));Ja.setValue(nf.a.isAddinCommands,!1);Ja.setValue(je.a.lHc,!1);Ja.setValue(je.a.CQd,"right");return Ja}ykd(L,M=null){if(!L)return null;L=this.xF.b3(L);var Ja=this.Ntb(L.storeType);const pb=new Ma(L.Sxa,L.version,L.store,Ja);let Tb=null,Wc=null,sd;if(Ue.a("EnableSDXDialog2")&&-1==(null===M||void 0===M?void 0:M.C0b))sd=new dn;else if(0===L.Ww)Tb=new cb(L.shapeId,L.slideId);else if(1===L.Ww)Wc=new Fb(L.GPf,L.visibility,L.width,L.row,L.ownerAddinSolutionId,L.ownerAddinStoreType,
L.hgg);else return null;let Ed={};M&&OSF.OsfControl.isFirstPartyStoreString(Ja)?Ed=OSF.OUtil.serializeSettings(M.nonPersistedSettings):L.ownerAddinSolutionId||(Ed=L.settings);Ja=L.z6a?new Lb(L.asb,L.z6a):null;return Ue.a("EnableSDXDialog2")?new hc(pb,L.id,Tb,Wc,sd,Ed,sd&&M?M.C0b:L.Ww,Ja):new hc(pb,L.id,Tb,Wc,null,Ed,L.Ww,Ja)}dgh(L,M=null){if(this.Pb.ka("883")){var Ja=this.vl.getOsfControl(L);if(Ja&&M){if(M.nonPersistedSettings){var pb=OSF.OUtil.serializeSettings(M.nonPersistedSettings);Ja.setSettings(pb);
Ja.setHostSettings(pb)}M.WE&&(pb=Object(da.a)(834,this.WPc(L)))&&(pb.nca=M.WE,this.eDb&&this.yLb(L,!0));Ja.refresh();this.r4e(L)}}}nqd(L,M,Ja=null,pb=null){const Tb=this.ykd(L,pb);if(!Tb||OSF.OsfControl.isFirstPartyStoreString(Tb.Ho.storeType)&&!B.AFrameworkApplication.zle(Tb.Ho.id))return null;var Wc=this.xF.b3(L);if(this.Pb.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Ntb(Wc.storeType)))return this.gl.Lda(22)||this.gl.iDa(22),null;pb&&pb.WE&&(Tb.nca=pb.WE);Wc=Object(da.a)(833,this.xF.wXd(this.Wn.od,
Tb,M,B.AFrameworkApplication.isRtl,this));this.ZF.Trf(Tb.instanceId,Tb);this.ZF.c5h(Tb.Ho.id,M);pb&&pb.E5&&pb.E5();this.Wn.od.aua&&Tb.taskpane&&Tb.taskpane.ownerAddinSolutionId&&(M=this.ZF.r5d(Tb.taskpane.ownerAddinSolutionId))&&this.UFh(M.instanceId,Tb.instanceId);Wc.$jl(this.vl,this.AXe(L),Ja,pb,this.Yua.powerPointDragInsertImageIsEnabled);Tb.taskpane&&Tb.taskpane.ownerAddinSolutionId||this.nTk(L);return Wc}HAh(L){if(this.Yua.AWj){const Ja=this.x_.HW(L);if(Ja&&0===Ja.Ww&&Ja.shape){var M=this.x_.dkj(L);
const pb=new Date;!M||pb.getTime()-M.getTime()>=this.Yua.pptEditorAppForOfficeSnapshotIntervalTime?(n.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",Ja.Ho.id,L),(M=this.t5j.fJf(1,L))?(this.x_.HFl(L,pb),M.execute(this,this.q5j,null)):n.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Ja?Ja.Ho.id:"AppNotExist",L)):n.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",Ja?Ja.Ho.id:
"AppNotExist",L)}}}v4g(L,M,Ja,pb){1===L&&this.yyk(M,Ja,pb)}yyk(L,M,Ja){let pb=null;Ja&&Ja.result&&(Ja=Ja.result,pb=Ja.substr(Ja.indexOf("base64,")+7));const Tb=this.x_.HW(L);M===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pb&&0<pb.length&&Tb?0===Tb.Ww&&Tb.shape&&Tb.Ho&&this.vi.kGh(Tb.shape.slideId.toString(),Tb.shape.id,pb,()=>{n.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Tb.Ho.id,L,pb.length)},()=>{n.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",
Tb.Ho.id,L);return!1}):n.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",Tb?Tb.Ho.id:"AppNotExist",L,pb?pb.length:0)}h4b(L){return L?this.mtg[L]:null}cGc(L,M){L&&M&&(this.mtg[L]=M)}get xu(){this.spe||(this.spe=new yg(this.Wn.od,Bc.a.instance.resolve("Common.IAppSettingsManager"),this.lJ,Bc.a.instance.ie("Box4.IOutlineEditor"),Bc.a.instance.ie("Box4.ISelectionManager"),Bc.a.instance.ie("Box4.ICharacterPropertiesEditor"),Bc.a.instance.ie("PowerPointWebEditor.IClassFactory"),
Bc.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Wn.VG(),Bc.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),Bc.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Bc.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Bc.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Bc.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),Bc.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Bc.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),
Bc.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Bc.a.instance.resolve("PowerPointWebEditor.IShapeReader"),Bc.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Bc.a.instance.resolve("Box4.IOutlineElementNavigator"),Bc.a.instance.resolve("Box4.IParagraphReader"),Bc.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),Bc.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.spe}get jda(){return this.yWa}ZZa(L,M,Ja){this.Q2c.q5d(L).raiseEvent(Ja,
M)}Sdh(L,M){this.ZF.s4d(Ja=>{this.ZZa(L,Ja.instanceId,M)})}UFh(L,M){if(L&&M){L=this.x_.HW(L);var Ja=this.x_.HW(M);L&&Ja&&(Ja.settings=L.settings,this.A4g(M,L.settings))}}j5e(L,M){L&&M&&this.x_.s4d(Ja=>{this.sZb(Ja.taskpane.ownerAddinSolutionId,L)&&!this.iHc.cJj(Ja.settings,M)&&(Ja.settings=M,this.A4g(Ja.instanceId,M))})}H$f(L){this.r6(L.mode)}r6(L){if(1!==L&&2!==L)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",L));n.ULS.sendTraceTag(512508167,806,50,
"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===L?"Show":"Edit");this.eWa.r6(L);this.bA.r6(L)}A4g(L,M){const Ja=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.ZZa(Ja,L,M)}Ntb(L){switch(L){case 0:L="spcatalog";break;case 1:L="filesystem";break;case 2:L="omex";break;case 3:L="spapp";break;case 4:L="registry";break;case 5:L="inmemory";break;case 6:L="uploadfiledevcatalog";break;case 7:L="excatalog";break;case 8:L="firstparty";break;case 9:L=
"sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",L));}return L}WKc(L){if(!L)throw Error.create("Store Type should not be null.");xa.Z5||xa.CDj();if(L in xa.Z5)return xa.Z5[L];throw Error.create(String.format("[{0}] is not the valid store type.",L));}P$d(L){return L?this.ZF.cXi(M=>this.sZb(M.Ho.id,L)):null}get GQd(){return this.Wn}m$h(L){this.va.addHandler("OnInsertionDialogOpened",L)}wGc(L){this.va.addHandler("OnFirstPartyAddInHidden",L)}IYk(L){this.va.removeHandler("OnFirstPartyAddInHidden",
L)}QNk(L){this.va.raiseEvent("OnFirstPartyAddInHidden",new rj(L))}yVd(L){const M=yh.a.upa(this.bA.M2,Ja=>Ja.id===L);if(1!==M.length)return!1;this.WK(M[0],!0,this.oua(L));return!0}yLb(L,M){const Ja=yh.a.upa(this.bA.M2,pb=>pb.id===L);1!==Ja.length?Sd.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Ja.length):Ja[0].xp(M)}B2i(L){const M=yh.a.upa(this.bA.M2,Ja=>Ja.id===L);return 1!==M.length?(Sd.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",M.length),!1):M[0].isVisible}eAl(L,
M){const Ja=this.h4b(L);Ja&&Ja.ew&&Ja.ew.kya&&(Ja.ew.state=M?1:0,(this.HDa(L)||this.iHc.U$f(L,Ja.settings,this))&&this.Wn.VG().La(Ji.a.XFh,2,Ja))}C2i(L){return(L=this.h4b(L))&&L.ew?1===L.ew.state:!1}WFf(L){this.x_.s4d(M=>{this.sZb(M.taskpane.ownerAddinSolutionId,L)&&this.yVd(M.instanceId)})}iwb(L){return this.ZF.HW(L)}oua(L){if(!L||4===this.vl.getOsfControlStatus(L))return!1;L=this.vl.getOsfControl(L);return!!L&&!!L.getSharedRuntimeId()}setInitialDisplayMode(L,M){(L=this.vl.getOsfControl(L))&&L.setInitialDisplayMode(M)}getSharedRuntimeId(L,
M,Ja,pb){if(!L)return null;const Tb=new vd;if(!Tb)return null;if(M)return L.getSharedRuntimeId(Tb.nT,M,null);Ja=(new db("",pb,Tb,!0)).gMf(Ja.substr(pb.length));return L.getSharedRuntimeId(Tb.nT,M,Ja)}HYi(L,M){const Ja={};Ja.visibility=M?"Visible":"Hidden";M=JSON.stringify(Ja);this.sWf(L,65539,"",M)}JYi(L,M,Ja){this.sWf(L,1,M,Ja)}Mml(L,M){L=new Ma(L.solutionId,L.version,L.storeId,L.storeType);var Ja=new Fb("right",!0,350,0,null,null,!1);L=new hc(L,Ti.a.create().toString(),null,Ja,null,{},1,null);const pb=
this.xF.jLc(B.AFrameworkApplication.isRtl,L.instanceId,L.taskpane.width,L.taskpane.visibility);this.bA.RP(pb);pb.xp(L.taskpane.visibility);Ja=pb.hHc;Object(da.a)(833,this.xF.wXd(this.Wn.od,L,Ja,B.AFrameworkApplication.isRtl,this)).HFc(this.vl,Ja,()=>{this.WK(pb,!1,!1);M()})}sWf(L,M,Ja,pb){var Tb=Array(6);Tb[0]=65536;Tb[1]=M;Tb[2]=Ja;Tb[3]=pb;Tb[4]=-1;Tb[5]=!1;M=Array(1);M[0]=Tb;Tb=new dc(OSF.DDA.EventDispId.dispidRichApiMessageEvent,L,null,M);this.ZZa(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),
L,Tb)}sZb(L,M){return L&&M?L.toLowerCase()===M.toLowerCase():!1}AXe(L){return!this.Rb||1!==this.Rb.mode||L&&"FA000000012"===L.sa(nf.a.vQd,null)?1===this.xF.b3(L).Ww?!0:this.Fa.KFa(L)?this.ua.Ba===this.jc.kg(L):!1:!1}get presentationId(){return this.Wn.fTa().presentationId}get YHf(){return this.eWa}get x_(){return this.ZF}get xF(){return this.Kbc.value}get B3k(){return this.Zgc}get XIk(){return this.Bgc}get q_(){return this.ua}static CDj(){xa.Z5={};xa.Z5.inmemory=5;xa.Z5.uploadfiledevcatalog=6;xa.Z5.spcatalog=
0;xa.Z5.omex=2;xa.Z5.registry=4;xa.Z5.spapp=3;xa.Z5.filesystem=1;xa.Z5.excatalog=7;xa.Z5.firstparty=8;xa.Z5.sdxcatalog=9}get $uf(){return this.PGc}get PGc(){this.UGc&&!this.Trg&&(this.Trg=new $e(new fe.a({["AppsForOfficeAllowExternalMarketplace"]:this.Yua.oie.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.Yua.o$b.toString(),["AreThirdPartyAddInsAllowed"]:this.Yua.Hia.toString(),["PopularAddinDetailsJsonString"]:xa.Whd}),new gi.a(()=>this.vl)));return this.Trg}get UGc(){return this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}maa(L,M){this.PGc&&this.PGc.maa(L,M)}static get Whd(){return'[{"displayName":"QR4Office","solutionId":"wa104051163","iconUrl":"https://store-images.s-microsoft.com/image/apps.53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","addinInfo":{"priority":1,"AUP":1}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","iconUrl":"https://store-images.s-microsoft.com/image/apps.52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","addinInfo":{"priority":1,"AUP":1720}},{"displayName":"Poll Everywhere Presenter","solutionId":"wa104218073","iconUrl":"https://store-images.s-microsoft.com/image/apps.27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","addinInfo":{"priority":1,"AUP":1542}},{"displayName":"Web Video Player","solutionId":"wa104221182","iconUrl":"https://store-images.s-microsoft.com/image/apps.21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","addinInfo":{"priority":1,"AUP":967}},{"displayName":"Web Viewer","solutionId":"wa104295828","iconUrl":"https://store-images.s-microsoft.com/image/apps.53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","addinInfo":{"priority":1,"AUP":2132}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"wa104379261","iconUrl":"https://store-images.s-microsoft.com/image/apps.51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","addinInfo":{"priority":1,"AUP":747}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","iconUrl":"https://store-images.s-microsoft.com/image/apps.42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","addinInfo":{"priority":1,"AUP":437}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","iconUrl":"https://store-images.s-microsoft.com/image/apps.21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","addinInfo":{"priority":1,"AUP":785}},{"displayName":"PP Timer","solutionId":"wa104380667","iconUrl":"https://store-images.s-microsoft.com/image/apps.34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","addinInfo":{"priority":1,"AUP":7}},{"displayName":"Pixton Comic Characters","solutionId":"wa104380907","iconUrl":"https://store-images.s-microsoft.com/image/apps.29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","iconUrl":"https://store-images.s-microsoft.com/image/apps.43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","addinInfo":{"priority":1,"AUP":287}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","iconUrl":"https://store-images.s-microsoft.com/image/apps.31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","addinInfo":{"priority":1,"AUP":4672}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","iconUrl":"https://store-images.s-microsoft.com/image/apps.36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","addinInfo":{"priority":1,"AUP":382}},{"displayName":"Forms","solutionId":"wa104381526","iconUrl":"https://store-images.s-microsoft.com/image/apps.3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","addinInfo":{"priority":1,"AUP":6443}},{"displayName":"Wooclap","solutionId":"wa104381682","iconUrl":"https://store-images.s-microsoft.com/image/apps.13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","addinInfo":{"priority":1,"AUP":781}},{"displayName":"MathType","solutionId":"wa104381909","iconUrl":"https://store-images.s-microsoft.com/image/apps.44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","addinInfo":{"priority":1,"AUP":1659}},{"displayName":"EasyTimer","solutionId":"wa104382064","iconUrl":"https://store-images.s-microsoft.com/image/apps.17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","addinInfo":{"priority":1,"AUP":1294}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","iconUrl":"https://store-images.s-microsoft.com/image/apps.59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","addinInfo":{"priority":1,"AUP":8399}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","iconUrl":"https://store-images.s-microsoft.com/image/apps.14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","addinInfo":{"priority":1,"AUP":711}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","iconUrl":"https://store-images.s-microsoft.com/image/apps.18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","addinInfo":{"priority":1,"AUP":676}},{"displayName":"Premast Plus","solutionId":"wa200001396","iconUrl":"https://store-images.s-microsoft.com/image/apps.62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","addinInfo":{"priority":1,"AUP":211}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"wa200001409","iconUrl":"https://store-images.s-microsoft.com/image/apps.10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","addinInfo":{"priority":1,"AUP":114}},{"displayName":"SlideHub","solutionId":"wa200001625","iconUrl":"https://store-images.s-microsoft.com/image/apps.28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","addinInfo":{"priority":1,"AUP":515}},{"displayName":"Breaktime","solutionId":"wa200001661","iconUrl":"https://store-images.s-microsoft.com/image/apps.53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","addinInfo":{"priority":1,"AUP":3243}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","iconUrl":"https://store-images.s-microsoft.com/image/apps.24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","addinInfo":{"priority":1,"AUP":1439}},{"displayName":"RRSlide Library","solutionId":"wa200003157","iconUrl":"https://store-images.s-microsoft.com/image/apps.27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","addinInfo":{"priority":1,"AUP":130}},{"displayName":"Microsoft Power BI","solutionId":"wa200003233","iconUrl":"https://store-images.s-microsoft.com/image/apps.44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","addinInfo":{"priority":1,"AUP":32046}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","iconUrl":"https://store-images.s-microsoft.com/image/apps.7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","addinInfo":{"priority":1,"AUP":135}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","iconUrl":"https://store-images.s-microsoft.com/image/apps.36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","addinInfo":{"priority":1,"AUP":4629}}]'}$$k(L,
M=null){if(this.vl.getOsfControl(L)&&M){if(M.WE){const Ja=Object(da.a)(834,this.WPc(L));Ja&&(Ja.nca=M.WE)}this.r4e(L)}}}xa.Z5=null;xa.Wua=null;Object(h.a)(xa,"AppForOfficeManager",null,[835,106,701]);class hi{constructor(L,M,Ja){this.UQ=L;this.pzg=M;this.Qb=Ja}register(){this.pzg.jk(Object(E.a)(this,this.nwf,"appSettingChangedEventHandler"))}dispose(){this.pzg.Cm(Object(E.a)(this,this.nwf,"appSettingChangedEventHandler"))}nwf(L,M){L=M.node;M=M.property;try{if(1074135139===L.Ue&&M===je.a.oHc){M=null;
var Ja=this.Qb.Nc(L);Ja.rc(47)||Ja.rc(10);Ja.zc();this.Vie(Ja.currentNode)&&(M=new Cb.a(Ja.currentNode));var pb=M.settings;Ue.a("RefreshAppSettingsValue")&&(this.UQ.iwb(M.id).settings=pb);this.UQ.ZZa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),M.id,pb)}}catch(Tb){n.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Tb)}}Vie(L){if(!L)return!1;const M=Object(da.a)(4,L);return 1074135137===L.Ue||!!M&&M.Dq}}Object(h.a)(hi,"AppForOfficeSettingChangedEventListener",
null,[830,106]);class Hj{constructor(L,M,Ja){this.UQ=L;this.ssg=M;this.Qb=Ja}register(){for(const L of this.ssg)L.vF(Object(E.a)(this,this.owf,"appSettingCreatedEventHandler"))}dispose(){for(const L of this.ssg)L.bP(Object(E.a)(this,this.owf,"appSettingCreatedEventHandler"))}owf(L,M){L=M.node;try{if(this.Vie(L)&&21===M.TZ){this.Qb.Nc(L).a7b()||n.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const Ja=new Cb.a(L),pb=Ja.settings;this.UQ.ZZa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),
Ja.id,pb)}}catch(Ja){n.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Ja)}}Vie(L){if(!L)return!1;const M=Object(da.a)(4,L);return 1074135137===L.Ue||!!M&&M.Dq}}Object(h.a)(Hj,"AppForOfficeSettingCreatedEventListener",null,[830,106]);class ql{constructor(L,M){this.ia=L;this.eu=M}register(){this.eu.jk(Object(E.a)(this,this.TAh,"taskpaneAppCreatedEventHandler"))}dispose(){this.eu.Cm(Object(E.a)(this,this.TAh,"taskpaneAppCreatedEventHandler"))}TAh(L,M){if(L=M.node)L=
new Cb.a(L),M.property.id===nf.a.KZ.id&&1===L.Ww&&(M=M.node.sa(nf.a.KZ,null))&&this.ia.La(Ji.a.Iib,2,M)}}Object(h.a)(ql,"AppForOfficeTaskpaneAppCreatedEventListener",null,[830,106]);var Ug=d(648),dl=d(529),yk=d(894);class el{constructor(L,M,Ja,pb,Tb){this.eDb=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.eX;this.UQ=L;this.Wn=M;this.Rb=Ja;this.ZF=pb;this.bA=Tb}register(L){L.controlStatusChanged=Object(E.a)(this,this.r2g,"onControlStatusChanged");L.notifyHost=
Object(E.a)(this,this.B4g,"onOsfNotifyHost")}r2g(L){let M=this.ZF.CVf(L.getSolutionId());const Ja=this.ZF.HW(L.getID());Ja&&Ja.Ho&&L.isFirstParty()&&(M=this.ZF.CVf(Ja.Ho.id));if(M&&Ja&&M.previousSibling){var pb=L.getSolutionId(),Tb=L.getVersion(),Wc=null,sd=null;sd=L.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(pb,""):OSF.OsfManifestManager.getCachedManifest(pb,Tb);L.isFirstParty()&&Ja.nca?Wc=Ja.nca:sd&&(Wc=sd.getDefaultDisplayName(),Ja.nca=Wc);if(!(0===Ja.Ww||Ue.a("EnableSDXDialog2")&&
-1===Ja.Ww)){if(this.eDb){Tb=null;sd&&(Tb=sd.getDefaultIconUrl());sd=null;Ue.a("UpdateTaskpaneWithInstanceId")&&(sd=Object.assign(new yk.a,{getContent:()=>M,type:"LegacyTaskPaneProps"}));const Ed=Object.assign(new Ug.a,{title:Wc,hideHeader:Ue.a("UpdateTaskpaneWithInstanceId"),iconUrl:Tb,width:320,location:2,contentProps:sd,onOpen:()=>{},onClose:()=>{},isModernPane:!0});Jb.UISurfaces.zr().then(ee=>{if(Ue.a("UpdateTaskpaneWithInstanceId")){const kb=L.getID();ee.updateTaskPane(kb,Ed)}else ee.updateTaskPane(pb,
Ed);return null}).catch(()=>{Sd.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",pb)})}M.previousSibling&&(M.previousSibling.innerText===Wc||!L.isFirstParty()&&""!==M.previousSibling.innerText)||!Wc||!Ja.taskpane||Ja.taskpane.isForUILessAction||(M.previousSibling.innerText=Wc,this.Rb.yTa())}}}TYj(L,M,Ja){this.B4g(L,M,Ja)}get UGc(){return this.Wn.od.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}Bfi(L,M){return Md.a.to().equals(L.solutionId,
M.solutionId)&&Md.a.to().equals(L.storeType,M.storeType)}B4g(L,M,Ja){3===M?(this.UQ.acg(),this.bA.tf(ke.a.XE),Ja?(this.$jc("InsertAgave",Ja),this.Wn.VG().La(Ji.a.gXc,2,Ja)):n.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===M?this.$jc("ClickTrust",Ja):40===M?this.UGc&&this.Nxe&&Ja&&this.Bfi(this.Nxe,Ja)&&Ja.storeType&&(n.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",el.tQ(Ja)),this.Nxe=
void 0,this.UQ.maa(Pa(Ja.storeType))):36===M?Ja?this.Wn.VG().La(Ji.a.gXc,2,Ja):n.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===M?Ja&&(L=Object(da.a)(Object,Ja),L={["ak1"]:this.UQ.vl.getDevManifestInvalidUrlErrorString(L.manifestUrl)},this.Wn.VG().La(wc.a.LMb,2,L)):2===M?this.UQ.acg():9===M?this.Wn.od.aua&&this.Wn.od.egg&&this.Wn.VG().La(wc.a.QPe,2,Ja):5===M||6===M?(Ja=this.ZF.HW(L))?0===Ja.Ww?this.bA.O2e(M):this.bA.a_i(L,M):n.ULS.sendTraceTag(512360738,
806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):13===M||14===M?(Ja=this.ZF.HW(L))?0===Ja.Ww||Ja.taskpane&&Ja.taskpane.isForUILessAction?this.UQ.notifyAgave(L,13===M?11:12):(He.a.eg&&document.activeElement.blur(),this.eDb&&13===M?zf.FocusManager.instance().dWe(ke.a.LM):this.bA.nXf(L)):n.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):16===M?(M=this.ZF.HW(L))?0===M.Ww&&this.bA.HTf():n.ULS.sendTraceTag(512360736,
806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):17===M||18===M?(M=this.ZF.HW(L))?0===M.Ww?this.bA.HTf():(He.a.eg&&document.activeElement.blur(),this.bA.nXf(L)):n.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):1===M||10===M?(M=this.ZF.HW(L))?0===M.Ww&&this.UQ.HAh(L):n.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",L)):8===M?(L={["ak1"]:this.UQ.vl.getManifestInvaildErrorString()},
this.Wn.VG().La(wc.a.LMb,2,L)):15===M?(L=this.bA.qzl(L))&&(M=this.UQ.iwb(L))&&M.taskpane&&!M.taskpane.isForUILessAction&&this.UQ.notifyAgave(L,11):23===M?aa.a.sendOtelEvent(Object.assign(new dl.a,{otelEvent:Ja})):38===M?aa.a.sendOtelCustomerContent(Object.assign(new dl.a,{otelEvent:Ja})):32===M?(L=Object(da.a)(Object,Ja).solutionId,this.UQ.WFf(L)):34===M&&(L=Object(da.a)(Object,Ja),M=L.controlId,Ja=new db("",L.ownerAddinSolutionId,new vd,!0),L.originalControlId=Ja?Ja.gMf(M):M)}$jc(L,M){this.UGc&&
M&&(this.Nxe=M)}static tQ(L){return Telemetry.PrivacyRules.GetPrivacyCompliantId(L.solutionId,L.storeType,L.assetId,null,null,L.storeId)}}Object(h.a)(el,"AppForOfficeAppEventHandler",null,[881]);var Cm=d(252),am=d(1218);class kf{static O6h(L){var M=L.getAttribute("style");M=M?M.toString():"";0>M.indexOf("pointer-events: auto")&&L.className!==kf.SKb&&(Ue.a("Microsoft.Office.SharedOnline.FixBug6808089")?L.style.pointerEvents="auto":L.setAttribute("style",M+" pointer-events: auto"))}static dtf(L){var M=
L.getAttribute("style");M=M?M.toString():"";0>M.indexOf("pointer-events: none")&&L.className===kf.SKb&&(Ue.a("Microsoft.Office.SharedOnline.FixBug6808089")?L.style.pointerEvents="none":L.setAttribute("style",M+" pointer-events: none"))}static pXk(L){var M=L.getAttribute("style");M=M?M.toString():"";0<=M.indexOf("pointer-events: none")&&L.className===kf.SKb&&(Ue.a("Microsoft.Office.SharedOnline.FixBug6808089")?L.style.pointerEvents="":(M=M.replace("pointer-events: none",""),L.setAttribute("style",
M)))}}kf.k4k="AppForOfficeContainer EditAppForOfficeContainer";kf.SKb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";kf.rTe="";Object(h.a)(kf,"AppForOfficeViewHelper",null,[]);var Dm=d(964),rc=d(138);class Em{constructor(L,M,Ja,pb,Tb){this.cA=this.Srg=null;this.RHa=!1;this.aA=M;this.hi=Ja;M&&M.taskpane&&M.taskpane.isForUILessAction?(this.cA=null,this.Srg=Ja):(this.cA=new rc.a,this.cA.pe.className=kf.SKb,this.cA.pe.id="AppForOffice_"+this.aA.instanceId,this.cA.pe.style.width=
"100%",this.cA.pe.style.height="100%",this.cA.pe.style.position="relative",this.cA.pe.style.left="0",this.cA.pe.style.top="0",Ja.appendChild(this.cA.pe));this.Yc=Tb}dispose(){this.iWk();this.aA=null}iWk(){this.cA&&this.cA.zq()}VUe(L){L&&this.cA&&L!==this.hi&&(this.hi=L,L.appendChild(this.cA.pe),this.RHa&&this.Eda())}rCa(L){L&&(L.pe.innerHTML="")}$jl(L,M,Ja=null,pb=null,Tb=!1){this.a4h(L,M,Ja,pb,Tb)}HFc(L,M,Ja){M=this.wmc(M);L.insertBlankControlWithErrorUX(M,()=>{Ja()})}a4h(L,M,Ja=null,pb=null,Tb=
!1){this.RHa=Tb;this.rCa(this.cA);this.aA&&L&&(this.QKa(M,null),M=this.wmc(this.cA?this.cA.pe:this.Srg,pb,L),M.virtualOsfControlActivationCallback=Ja,L.insertOsfControl(M),L.setActivationCompletedStatus(this.aA.instanceId,!0),Tb&&this.Eda())}Eda(){if(this.cA){var L=this.cA.xa;if(L){var M=L.parentNode;M&&"OsfAddinOverlay"!==M.className&&(Cm.a.instance.pb(Yd.a.gna,M,Object(E.a)(this,this.Hhh,"removePointerEventsStyleHandler")),am.a.instance.pb(Yd.a.drop,M,Object(E.a)(this,this.Hhh,"removePointerEventsStyleHandler")),
Cm.a.instance.pb(Yd.a.hna,M,Object(E.a)(this,this.P6h,"addPointerEventsStyleHandler")),kf.dtf(L))}}}Hhh(L){L=L.qc.target;for(let M=0;M<L.childNodes.length;++M)kf.pXk(L.childNodes[M]);return!0}P6h(L){L=L.qc.target;for(let M=0;M<L.childNodes.length;++M)kf.dtf(L.childNodes[M]);return!0}QKa(L,M){this.cA&&(L?(null!=M&&this.VUe(M),this.cA.pe.className=""===kf.rTe?kf.k4k:kf.rTe,kf.O6h(this.cA.xa)):(this.cA.pe.className!==kf.SKb&&(kf.rTe=this.cA.pe.className),this.cA.pe.className=kf.SKb))}WUe(L){this.cA&&
(this.cA.pe.style.zIndex=String(L))}wmc(L,M=null,Ja=null){const pb={};pb.div=L;pb.id=this.aA.instanceId;L=this.aA.Ho.id;const Tb=this.aA.taskpane?this.aA.taskpane.ownerAddinSolutionId:null;if(Ja&&Tb){const Wc=this.aA.taskpane.isForUILessAction;this.aA.ew?pb.sharedRuntimeId=this.aA.ew.kya:(Ja=Ja.getOsfControl(Tb).getManifest(),pb.sharedRuntimeId=this.Yc.getSharedRuntimeId(Ja,Wc,L,Tb));pb.initialDisplayMode=Wc?1:2}pb.hostInfoFlags=0;pb.sharedRuntimeId?(pb.hostInfoFlags|=1,pb.solutionId=Tb):M?(pb.solutionId=
M.assetId,pb.sourceLocationOverrideResourceId=M.sourceLocationOverrideResourceId,pb.featureGates=B.AFrameworkApplication.fa.X9i(M.assetId)):pb.solutionId=L;pb.version=this.aA.Ho.version;pb.storeId=this.aA.Ho.store;pb.storeType=this.aA.Ho.storeType;pb.assetId=null;pb.assetStoreId=null;pb.settings=this.aA.settings;M&&OSF.OsfControl.isFirstPartyStoreString(this.aA.Ho.storeType)&&(pb.hostSettings=OSF.OUtil.serializeSettings(M.nonPersistedSettings));pb.reason=Dm.a.contains(this.aA.Ho.id,this.aA.Ww,this.aA.Ho.store,
this.aA.Ho.storeType,this.aA.Ho.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.aA.Ww?pb.osfControlType=0:1===this.aA.Ww&&(pb.osfControlType=1);B.AFrameworkApplication.Hia||OSF.OsfControl.isFirstPartyStoreString(pb.storeType)||(n.ULS.sendTraceTag(512369924,802,50,(0===this.aA.Ww?"Content":"Taskpane")+" web add-in disabled by doc IRM"),pb.hostInfoFlags|=4);this.aA.taskpane?(pb.isForUILessAction=this.aA.taskpane.isForUILessAction,
pb.ownerAddinSolutionId=Tb,pb.ownerAddinStoreType=this.aA.taskpane.ownerAddinStoreType):pb.isForUILessAction=!1;return pb}}Object(h.a)(Em,"AppForOfficeView",null,[833]);var Tc=d(279),df=d(75);class Aj{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed,ee,kb,cf,Tf,zg,ci,ah){new Tc.a(0,0,0,0);this.Mbc=this.ecb=this.gO=this.yo=null;this.DCe=ResourceStrings.l_AddinPane;this.kF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.eX;this.rb=Uf.a.Ie();this.Rb=Wc;this.Zc=Ed;this.bA=
sd;this.qe=ee;this.gu=L;this.jB=M;this.Wn=Ja;this.u5j=pb;this.Eb=Tb;this.Lr=kb;this.Yc=cf;this.Oc=Tf;this.mc=zg;this.zH=ci;this.kz=ah;this.initialize()}dispose(){this.Zc&&this.yo&&(this.Zc.yb(Yd.a.click,this.yo,Object(E.a)(this,this.xCa,"closePaneButtonClickHandler")),this.Lr.removeHandler(this.yo,Yd.a.Yf,Object(E.a)(this,this.sag,"handleShortCutsOnCloseButton")),this.yo=null);this.Oc.Hib(Object(E.a)(this,this.Dw,"onUnifiedAppStateChanged"));this.Rb.oKb(Object(E.a)(this,this.jY,"onSetOffline"));this.bA.Ehh(this)}initialize(){const L=
"label_"+this.jB,M="icon_"+this.jB;this.rb.className=this.gu?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(Ue.a)("AddClassOnSDXPaneContainer")&&this.kz){const Ja=this.kz.PAh;Ja&&(this.rb.className+=" "+Ja)}this.rb.style.position="absolute";this.rb.style.display="none";this.rb.setAttribute(Ye.a.ef,Ye.a.bCa);this.rb.setAttribute(Ye.a.P2,L);this.yo=this.KCa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.yo,"AddinPaneCloseButton");this.Zc.pb(Yd.a.click,this.yo,Object(E.a)(this,
this.xCa,"closePaneButtonClickHandler"));this.Lr.addHandler(this.yo,Yd.a.Yf,Object(E.a)(this,this.sag,"handleShortCutsOnCloseButton"));this.rb.appendChild(this.yo);Object(Ue.a)("TempHeaderIconForActionAI")&&(this.Wn.od.VW||this.Wn.od.cB)&&this.kz&&"ActionAITaskPane"===this.kz.PAh&&(this.Mbc=Uf.a.RA(),this.Mbc.className="PaneIcon",this.Mbc.id=M,this.Mbc.src="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Orange.svg",this.rb.appendChild(this.Mbc));
this.ecb=Uf.a.Ie();this.ecb.className="PaneLabel";this.ecb.id=L;this.ecb.setAttribute(Ye.a.ef,Ye.a.$xf);this.ecb.setAttribute(Ye.a.tZb,"1");this.rb.appendChild(this.ecb);this.gO=Uf.a.Ie();this.gO.className="AddinPanePanelResize";this.rb.appendChild(this.gO);this.Oc.O7(Object(E.a)(this,this.Dw,"onUnifiedAppStateChanged"));this.Rb.FPa(Object(E.a)(this,this.jY,"onSetOffline"))}Dw(L,M){M.Bab&&!this.mc.Gn&&this.isVisible&&this.Qbg()}jY(L){L&&this.isVisible&&(Object(Ue.a)("FixAddInPaneVisibilityInOfflineMode")&&
this.Yc.BNc(this.jB),this.Qbg())}Qbg(){this.xp(!1);this.Wn.VG().La(Ji.a.dWc,2,this.jB);this.Tme()||this.dispose()}layout(L,M){const Ja=M?L.oD(this.width):L.pD(this.width);this.isVisible&&(M?Ja.oD(1):Ja.pD(1),this.gO.style.height=(L.height-this.yo.clientHeight-this.ecb.clientHeight).toString()+"px",this.gO.style.width="100%");Uf.a.t1(this.rb,Ja);return L}tel(L){this.DCe=L}xp(L){const M=this.Eb!==L;if(this.Eb=L)this.rb.style.display="block";const Ja=this.Tme();this.zH.Yal(this.jB,Ja);if(this.kF){let pb=
this.DCe;Object(Ue.a)("TaskPaneToolTip")&&this.Wn.od.cB?this.kz&&this.kz.RAh?pb=this.kz.RAh:this.kz&&(pb=this.kz.WE):pb=this.kz?this.kz.WE:this.DCe;this.zH.FM(this,this.Eb,pb,this.jB)}else this.Rb.yTa();Ja&&(this.yo.style.visibility=L?"visible":"hidden",M&&this.Yc.HYi(this.jB,L))}Tme(){return this.Yc.oua(this.jB)}xCa(){this.xp(!1);this.Wn.VG().La(Ji.a.dWc,2,this.jB);this.Tme()||this.dispose();return!0}JCa(L,M,Ja,pb,Tb,Wc){const sd=Uf.a.RA();sd.alt=Tb;sd.className=df.getImageClassWithCluster(L,pb);
sd.src=this.qe.qk(L+".png");sd.setAttribute("Unselectable","on");L=Uf.a.Qn();L.className=M+" cui-img-cont-float";L.appendChild(sd);M=Uf.a.Qn();M.className=Ja;M.setAttribute("Unselectable","on");M.appendChild(L);Ja=Uf.a.Eca();Ja.className="CommentPaneNoBorderButton cui-ctl";Ja.title=Tb;Ja.setAttribute(Ye.a.ef,Ye.a.yu);Ja.tabIndex=0;Ja.appendChild(M);Wc&&(Tb=Uf.a.Qn(),Tb.className="cui-ctl-mediumlabel",Tb.setAttribute("Unselectable","on"),Tb.innerText=Wc,Ja.appendChild(Tb));return Ja}KCa(L,M){return this.JCa(L,
"cui-img-16by16","cui-ctl-iconContainer",M,CommonUIStrings.l_DialogClose,null)}sag(L){L.keyCode===od.a.tq||L.keyCode===od.a.pP?(this.xCa(null),L.preventDefault(),L.stopPropagation()):L.keyCode===od.a.Sq&&(L.shiftKey?this.Yc.notifyAgave(this.jB,12):this.Yc.notifyAgave(this.jB,11),L.preventDefault(),L.stopPropagation())}get isVisible(){return this.Eb}get xa(){return this.rb}get order(){return 6}get width(){return this.isVisible?this.u5j:0}get hHc(){return this.gO}get Cui(){return this.yo}get id(){return this.jB}}
Object(h.a)(Aj,"AddInPane",null,[851,718,106]);class ti{constructor(L,M,Ja,pb,Tb,Wc,sd,Ed,ee,kb){this.Wn=L;this.Rb=M;this.bA=Ja;this.Zc=pb;this.qe=Tb;this.m0=Wc;this.Yc=sd;this.Oc=Ed;this.mc=ee;this.zH=kb}jLc(L,M,Ja,pb,Tb){return new Aj(L,M,this.Wn,Ja,pb,this.Rb,this.bA,this.Zc,this.qe,this.m0,this.Yc,this.Oc,this.mc,this.zH,Tb)}b3(L){return new Cb.a(L)}SBi(L){return new el(this.Yc,this.Wn,this.Rb,L,this.bA)}wXd(L,M,Ja,pb,Tb){return new Em(L,M,Ja,pb,Tb)}}Object(h.a)(ti,"AppforOfficeClassFactory",
null,[829]);class rf{constructor(L){this.Lxg=this.cR=!1;this.Om=de.a.$Y();this.msg=L;Xe.kRk(this.msg)}Rv(){this.Lxg=!0}dispose(){if(this.Lxg&&!this.cR){var L=de.a.$Y();Xe.jRk(this.msg,this.Om,L);this.cR=!0}}}Object(h.a)(rf,"ApiCallLogger",null,[106]);class Ll{get formatting(){return 0}set formatting(L){}get sourceSlideIds(){return null}set sourceSlideIds(L){}get targetSlideId(){return null}set targetSlideId(L){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(L){switch(L){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,M){switch(L){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");return;
case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}
Object(h.a)(Ll,"InsertSlideOptions",null,[]);class ck{constructor(){this.controlId=this.appId=null}}Object(h.a)(ck,"RequestContext",null,[]);class K{constructor(){this.Kof=this.shf=null}get layoutId(){return this.shf}set layoutId(L){this.shf=L}get slideMasterId(){return this.Kof}set slideMasterId(L){this.Kof=L}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(L){switch(L){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,M){switch(L){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(h.a)(K,"AddSlideOptions",null,[]);class Fm{constructor(L,M,Ja){this.Nbc=L;this.D9=M;this.Yc=Ja}getAppRuntimeStartState(){if(!this.Yc.oua(this.D9))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Yc.C2i(this.Nbc)?1:0}setAppRuntimeStartState(L){if(!this.Yc.oua(this.D9)||0!==L&&1!==L)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Yc.eAl(this.Nbc,1===L)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,
M){switch(L){case 2:return this.t3i();case 1:return this.s9k(M)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}t3i(){return this.getAppRuntimeStartState()}s9k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");this.setAppRuntimeStartState(L);return null}}Object(h.a)(Fm,"AppRuntimePersistenceService",null,[]);class Ml{constructor(L,M){this.D9=
L;this.Yc=M}getAppRuntimeState(){if(!this.Yc.oua(this.D9))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Yc.B2i(this.D9)?2:1}setAppRuntimeState(L){if(!this.Yc.oua(this.D9)||2!==L&&1!==L)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Yc.yLb(this.D9,2===L)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 2:return this.u3i();case 1:return this.t9k(M)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}u3i(){return this.getAppRuntimeState()}t9k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");this.setAppRuntimeState(L);return null}}Object(h.a)(Ml,"AppRuntimeService",null,[]);class cj{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 1001:return this.pGj(M);case 1002:return this.LGj(M)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}pGj(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"string");this.insertHyperLink(M,L);return null}LGj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.insertSlideFromContent(L)}}Object(h.a)(cj,"Application",null,[]);class xi{constructor(L,M){this.zG=
!1;this._id=L;this.FHd=M}get enabled(){return this.zG}set enabled(L){this.zG=L;B.AFrameworkApplication.Ta.La(wc.a.I3b,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.FHd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(L){switch(L){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,M){switch(L){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 5:return this.N$k(M);
case 1:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}N$k(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"boolean");this.setEnabled(L);return null}UH(){this._OnAccess();return null}}Object(h.a)(xi,"RibbonButton",null,[]);class jj{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(L){switch(L){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 3:return this.Vel(M);case 1:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}Vel(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"boolean");this.setVisibility(L);return null}UH(){this._OnAccess();return null}}Object(h.a)(jj,"RibbonTab",null,[]);class kj{constructor(L,M){this.MMa=this.aN=this.NBc=null;this.Wwc=L;this.f2a=M;ma.a.Wa(this.Wwc)||(this.MMa=M.iwb(L),this.NBc=(this.aN=this.f2a?this.f2a.vl:null)?this.aN.getOsfControl(this.Wwc):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(L){let M=
null;if(!this.Rhg())return this.oJf();if(!ma.a.Wa(L)&&this.MMa&&this.MMa.taskpane){if(!this.yEf(L))return this.BJf(L);M=new xi(L,this.MMa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}getTab(L){let M=null;if(!this.Rhg())return this.oJf();if(!ma.a.Wa(L)&&this.MMa&&this.MMa.taskpane){if(!this.yEf(L))return this.BJf(L);M=new jj(L)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(L){switch(L){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 1:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){switch(L){case 7:return this.PTi(M);
case 6:return this.QTi(M);case 3:return this.m4i(M);case 5:return this.rlj(M)}L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}PTi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.executeRequestCreate(L)}QTi(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.executeRequestUpdate(L)}m4i(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getButton(L)}rlj(L){L=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getTab(L)}UH(){this._OnAccess();return null}BJf(L){return this.OJf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+L)}oJf(){return this.OJf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Rhg(){const L=!ma.a.Wa(this.NBc.getSharedRuntimeId());Sd.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",L));return L}yEf(L){if(this.NBc){var M=
this.NBc.getManifest();if(M&&(M=M.getRibbonExtensionControlMap()))return L in M||this.Yqi(L)}return!1}Yqi(L){var M=this.cYi();if(M){M=M.qQf;for(const Ja of M.tabs){if(Ja.id===L)return!0;for(const pb of Ja.groups)for(const Tb of pb.controls){if(Tb.id===L)return!0;if("Menu"===Tb.type){M=Tb;for(const Wc of M.items)if(Wc.id===L)return!0}}}}return!1}cYi(){return D.getInstance().P8a(this.MMa.taskpane.ownerAddinStoreType,this.MMa.taskpane.ownerAddinSolutionId,1)}OJf(L,M){return OfficeExtension.WacRuntime.Utility.createPromise((Ja,
pb)=>{pb(OfficeExtension.WacRuntime.Utility.createRichApiException(L,M))})}}Object(h.a)(kj,"DynamicRibbon",null,[]);class zh{constructor(L,M,Ja,pb){this.H8e="";this.kyc=0;this.uG=L;this._id=M;this.oVb=Ja;this.f2a=pb}get id(){return this._id}_RegisterStateChange(){this.kyc||this.uG.execute(L=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.oVb,this._id,1);this.H8e=L.rib(this._id,M=>{this.f2a.JYi(this.oVb,this._id,JSON.stringify(M))})});this.kyc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.kyc--;
this.kyc||this.uG.execute(L=>{L.dKb(this._id,this.H8e)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(L){switch(L){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){switch(L){case 6:return this.hMh();case 7:return this.lMh()}L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}hMh(){return this._RegisterStateChange()}lMh(){return this._UnregisterStateChange()}}Object(h.a)(zh,"LicenseFeature",
null,[]);class Mn{get scopes(){return null}set scopes(L){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(L){switch(L){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,M){switch(L){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(h.a)(Mn,"MsaDeviceTicketOptions",null,[]);class dk{constructor(L,M){this.uG=Bc.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
this.oVb=L;this.f2a=M}getFeatureTier(L,M){return OfficeExtension.WacRuntime.Utility.createPromise(Ja=>{const pb=1===M?1:2===M?2:0;this.uG.execute(Tb=>{Tb.getFeatureTier(L,pb).then(Wc=>{Ja(this.Bbj(Wc))},()=>{Ja(M)})})})}getLicenseFeature(L){L=new zh(this.uG,L,this.oVb,this.f2a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}getMsaDeviceTicket(){return null}isFeatureEnabled(L,M){return OfficeExtension.WacRuntime.Utility.createPromise(Ja=>{this.uG.execute(pb=>{pb.isFeatureEnabled(L,
M).then(Tb=>{Ja(Tb)},()=>{Ja(M)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(L=>{this.uG.execute(M=>{M=M.isFreemiumUpsellEnabled();L(M)})})}launchUpsellExperience(L){if(this.f2a.vl.getOsfControl(this.oVb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.uG.execute(M=>{M.launchUpsellExperience(L)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied","");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 7:return this.pdj(M);case 6:return this.jMh(M)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,
M){switch(L){case 2:return this.x9i(M);case 5:return this.Abj(M);case 1:return this.NMj(M);case 3:return this.ANj();case 4:return this.kZj(M)}L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}x9i(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");return this.getFeatureTier(M,L)}Abj(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");
return this.getLicenseFeature(L)}pdj(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string"),Ja=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,2,Mn);return this.getMsaDeviceTicket(M,Ja,L)}NMj(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"boolean");return this.isFeatureEnabled(M,L)}ANj(){return this.isFreemiumUpsellEnabled()}kZj(L){L=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.launchUpsellExperience(L)}jMh(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");this._TestFireStateChangedEvent(L);return null}Bbj(L){switch(L){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(dk,"License",null,[]);class Se{get height(){return 0}set height(L){}get left(){return 0}set left(L){}get top(){return 0}set top(L){}get width(){return 0}set width(L){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(L){switch(L){case 1:return this.height;
case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,M){switch(L){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return;case 3:this.top=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,
M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}}Object(h.a)(Se,"ShapeAddOptions",null,[]);class Bg{constructor(L,M,Ja){this.cMe=!1;this.pxg=!0;this.Nbc=L;this.D9=M;this.Yc=Ja}hostName(){return"PowerPointOnline"}appId(){return this.Nbc}controlId(){return this.D9}createInstance(L){switch(L){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new K;case "Microsoft.Office.PowerPoint.Application":return new cj;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new Ll;
case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Se;case "Microsoft.AppRuntime.AppRuntimeService":return new Ml(this.D9,this.Yc);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Fm(this.Nbc,this.D9,this.Yc);case "Microsoft.Office.Licensing.License":return new dk(this.D9,this.Yc);case "Microsoft.DynamicRibbon.DynamicRibbon":return new kj(this.D9,this.Yc)}n.ULS.sendTraceTag(588375570,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",
L);return null}static ar(L){const M=Bc.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").Irf;L||(M.pxg=!1);return!M.cMe}}Object(h.a)(Bg,"RichApiHost",null,[855]);class Ci{constructor(L,M,Ja){this.vwd=this.Sh=-1;this.XB=Ja;0<=L&&(this.Sh+=L,this.vwd=0<M?L+M<this.XB.getCount()?L+M:this.XB.getCount():this.XB.getCount())}get_current(){return-1<this.Sh&&this.Sh<this.vwd?this.XB.getItemAt(this.Sh):null}moveNext(){const L=this.Ezl();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}Ezl(){return this.Sh+
1<this.vwd?(this.Sh++,!0):!1}}Object(h.a)(Ci,"ElementEnumerator",null,[910]);class jf{constructor(L,M){this.$4a=L;this.uS=M}get fill(){Bg.ar(!1);return null}get height(){Bg.ar(!1);return 0}set height(L){Bg.ar(!1)}get id(){const L=new rf(28);try{Sd.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.$4a)return Sd.a.J(577525073,802,10,"Shape is null."),"";const M=this.$4a.get_shapeId().toString();L.Rv();return M}finally{L&&L.dispose()}}get left(){Bg.ar(!1);return 0}set left(L){Bg.ar(!1)}get lineFormat(){Bg.ar(!1);
return null}get name(){Bg.ar(!1);return null}set name(L){Bg.ar(!1)}get tags(){Bg.ar(!1);return null}get textFrame(){Bg.ar(!1);return null}get top(){Bg.ar(!1);return 0}set top(L){Bg.ar(!1)}get type(){Bg.ar(!1);return 0}get width(){Bg.ar(!1);return 0}set width(L){Bg.ar(!1)}deleteObject(){if(Bg.ar(!0)){var L=new rf(45);try{Sd.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const M=Object(da.a)(116,this.uS);M&&(M.KKi(Object(da.a)(4,this.$4a)),L.Rv())}finally{L&&L.dispose()}}}getParentSlide(){Bg.ar(!1);
return null}getParentSlideLayout(){Bg.ar(!1);return null}getParentSlideLayoutOrNullObject(){Bg.ar(!1);return null}getParentSlideMaster(){Bg.ar(!1);return null}getParentSlideMasterOrNullObject(){Bg.ar(!1);return null}getParentSlideOrNullObject(){Bg.ar(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(L){switch(L){case 11:return this.fill;case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;
case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L,M){switch(L){case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 4:return this.YZd();
case 15:return this.Tej();case 16:return this.Uej();case 18:return this.Vej();case 17:return this.Wej();case 19:return this.Xej();case 20:return this.Yej();case 2:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}YZd(){this.deleteObject();return null}Tej(){return this.getParentSlide()}Uej(){return this.getParentSlideLayout()}Vej(){return this.getParentSlideLayoutOrNullObject()}Wej(){return this.getParentSlideMaster()}Xej(){return this.getParentSlideMasterOrNullObject()}Yej(){return this.getParentSlideOrNullObject()}UH(){this._OnAccess();
return null}}Object(h.a)(jf,"Shape",null,[]);class yi{constructor(L){this.gTb=this.Xpb=null;this.uS=L;if(L=Object(da.a)(116,this.uS))this.Xpb=L.lTa();this.MFk()}MFk(){this.gTb=new ia.ScriptSharpLegacyMap;if(this.Xpb)for(const L of this.Xpb){const M=new jf(L,this.uS);this.gTb.add(M.id,M)}}addGeometricShape(){Bg.ar(!1);return null}addLine(){Bg.ar(!1);return null}addTextBox(){Bg.ar(!1);return null}getCount(){const L=new rf(29);try{Sd.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.Xpb)return Sd.a.J(577525071,
802,50,"In Shape.GetCount(), _shapes is null"),0;L.Rv();return this.Xpb.length}finally{L&&L.dispose()}}getItem(L){const M=new rf(31);try{Sd.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");try{const Ja=this.gTb.ga(L);M.Rv();return Ja}catch(Ja){throw Sd.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{M&&M.dispose()}}getItemAt(L){const M=new rf(30);try{Sd.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Ja=this.Xpb[L].get_shapeId().toString(),pb=this.gTb.ga(Ja);M.Rv();return pb}catch(Ja){throw Sd.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{M&&
M.dispose()}}getItemOrNullObject(L){const M=new rf(32);try{Sd.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let Ja;({value:Ja}=this.gTb.Uf(L));M.Rv();return Ja}finally{M&&M.dispose()}}_OnAccess(){}getAsyncEnumerator(L,M){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ci(L,M,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=
this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 6:return this.J5h(M);case 7:return this.h6h(M);case 8:return this.Q7h(M);case 1:return this.x9a();case 2:return this.M9a(M);case 5:return this.L9a(M);case 3:return this.N9a(M);
case 4:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}J5h(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Se);return this.addGeometricShape(M,L)}h6h(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
1,Se);return this.addLine(M,L)}Q7h(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Se);return this.addTextBox(M,L)}x9a(){return this.getCount()}M9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}L9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}N9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"string");return this.getItemOrNullObject(L)}UH(){this._OnAccess();return null}}Object(h.a)(yi,"ShapeCollection",null,[892]);class Cl{constructor(L){this.TDc=L}get id(){const L=new rf(15);try{Sd.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.TDc)return Sd.a.J(576581654,802,10,"SlideLayout is null."),"";const M=this.TDc.Id.toString();L.Rv();return M}finally{L&&L.dispose()}}get name(){const L=new rf(16);try{Sd.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.TDc)return Sd.a.J(576581655,
802,10,"SlideLayout is null."),"";const M=this.TDc.Name;L.Rv();return M}finally{L&&L.dispose()}}get shapes(){Bg.ar(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(L){switch(L){case 1:return this.id;case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 2:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}UH(){this._OnAccess();return null}}Object(h.a)(Cl,"SlideLayout",null,[]);class Ud{constructor(L){this.hTb=null;this.ZWb=L;this.NFk()}NFk(){this.hTb=
new ia.ScriptSharpLegacyMap;if(this.ZWb)for(const L of this.ZWb){const M=new Cl(L);this.hTb.add(M.id,M)}}getCount(){const L=new rf(17);try{Sd.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.ZWb)return Sd.a.J(576581651,802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;L.Rv();return this.ZWb.length}finally{L&&L.dispose()}}getItem(L){const M=new rf(19);try{Sd.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Ja=this.hTb.ga(L);M.Rv();
return Ja}catch(Ja){throw Sd.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{M&&M.dispose()}}getItemAt(L){const M=new rf(18);try{Sd.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Ja=this.hTb.ga(this.ZWb[L].Id.toString());M.Rv();return Ja}catch(Ja){throw Sd.a.J(576581653,
802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{M&&M.dispose()}}getItemOrNullObject(L){const M=new rf(20);try{Sd.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let Ja;({value:Ja}=this.hTb.Uf(L));M.Rv();return Ja}finally{M&&M.dispose()}}_OnAccess(){}getAsyncEnumerator(L,
M){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ci(L,M,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,
M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 1:return this.x9a();case 2:return this.M9a(M);case 3:return this.L9a(M);case 4:return this.N9a(M);case 5:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}x9a(){return this.getCount()}M9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"string");return this.getItem(L)}L9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}N9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}UH(){this._OnAccess();return null}}Object(h.a)(Ud,"SlideLayoutCollection",null,[892]);class ag{constructor(L){this.gqb=L}get id(){const L=new rf(21);try{Sd.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.gqb)return Sd.a.J(576581648,
802,10,"SlideMaster is null."),"";const M=this.gqb.Id.toString();L.Rv();return M}finally{L&&L.dispose()}}get layouts(){const L=new rf(23);try{Sd.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.gqb)return Sd.a.J(576581649,802,10,"SlideMaster is null."),null;const M=new Ud(this.gqb.ContentMasters);L.Rv();return M}finally{L&&L.dispose()}}get name(){const L=new rf(22);try{Sd.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.gqb)return Sd.a.J(576581650,802,10,"SlideMaster is null."),
"";const M=this.gqb.Name;L.Rv();return M}finally{L&&L.dispose()}}get shapes(){Bg.ar(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(L){switch(L){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L){switch(L){case 2:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}UH(){this._OnAccess();return null}}Object(h.a)(ag,"SlideMaster",null,[]);class Jf{constructor(L,M){this.uS=L;this.WAa=M}get id(){const L=
new rf(5);try{Sd.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.uS)return Sd.a.J(587747398,802,10,"Slide is null."),"";const M=this.uS.Cb.toString();L.Rv();return M}finally{L&&L.dispose()}}get layout(){const L=new rf(9);try{Sd.a.J(572643284,802,50,"PptApi Call - Slide.GetLayout");const M=this.WAa.M0;for(let Ja=0;Ja<M.length;Ja++){const pb=M[Ja].ContentMasters;for(let Tb=0;Tb<pb.length;Tb++)if(this.uS.Cn===pb[Tb].Id){const Wc=new Cl(pb[Tb]);L.Rv();return Wc}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a Layout.");}finally{L&&L.dispose()}}get shapes(){const L=new rf(6);try{Sd.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");const M=new yi(this.uS);L.Rv();return M}finally{L&&L.dispose()}}get slideMaster(){const L=new rf(8);try{Sd.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const M=this.WAa.M0;for(let Ja=0;Ja<M.length;Ja++)if(this.uS.hj===M[Ja].Id){const pb=new ag(M[Ja]);L.Rv();return pb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a SlideMaster.");}finally{L&&L.dispose()}}get tags(){Bg.ar(!1);return null}deleteObject(){if(Bg.ar(!0)){var L=new rf(7);try{Sd.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.WAa.xI(this.uS),L.Rv()}finally{L&&L.dispose()}}}setSelectedShapes(){Bg.ar(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(L){switch(L){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 3:return this.YZd();case 8:return this.ddl(M);case 2:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}YZd(){this.deleteObject();return null}ddl(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"Array<string>");this.setSelectedShapes(L);return null}UH(){this._OnAccess();return null}}Object(h.a)(Jf,"Slide",null,[]);class Gm{constructor(L){this.iTb=null;this.WAa=L;this.hqb=this.WAa.slides;this.OFk()}OFk(){this.iTb=new ia.ScriptSharpLegacyMap;if(this.hqb)for(const L of this.hqb){const M=
new Jf(L,this.WAa);this.iTb.add(M.id,M)}}F7i(){return 0<this.getCount()?this.hqb[this.getCount()-1]:null}A6d(L){return L?L.hj:this.WAa.M0[0].Id}y6d(L){const M=this.WAa.M0;for(let Ja=0;Ja<M.length;Ja++)if(L===M[Ja].Id)return M[Ja].ContentMasters[0].Id;return 0}add(L){if(Bg.ar(!0)){var M=new rf(10);try{Sd.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const Ja=this.F7i();let pb=0;pb=L&&L.slideMasterId?parseInt(L.slideMasterId):this.A6d(Ja);let Tb=0;Tb=L&&L.layoutId?parseInt(L.layoutId):this.y6d(pb);
this.WAa.AYb(Ja,null,pb,Tb);M.Rv()}finally{M&&M.dispose()}}}getCount(){const L=new rf(11);try{Sd.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.hqb)return Sd.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;L.Rv();return this.hqb.length}finally{L&&L.dispose()}}getItem(L){const M=new rf(13);try{Sd.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const Ja=this.iTb.ga(L);M.Rv();return Ja}catch(Ja){throw Sd.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{M&&M.dispose()}}getItemAt(L){const M=new rf(12);try{Sd.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Ja=this.iTb.ga(this.hqb[L].Cb.toString());M.Rv();return Ja}catch(Ja){throw Sd.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{M&&M.dispose()}}getItemOrNullObject(L){const M=new rf(14);try{Sd.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let Ja;({value:Ja}=this.iTb.Uf(L));M.Rv();return Ja}finally{M&&M.dispose()}}_OnAccess(){}getAsyncEnumerator(L,M){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ci(L,M,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 6:return this.f6h(M);case 1:return this.x9a();case 5:return this.M9a(M);case 2:return this.L9a(M);case 3:return this.N9a(M);
case 4:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}f6h(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,K);this.add(L);return null}x9a(){return this.getCount()}M9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}L9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,
0,"int");return this.getItemAt(L)}N9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}UH(){this._OnAccess();return null}}Object(h.a)(Gm,"SlideCollection",null,[892]);class Dc{constructor(L){this.jTb=null;this.$Wb=L;this.PFk()}PFk(){this.jTb=new ia.ScriptSharpLegacyMap;if(this.$Wb)for(const L of this.$Wb){const M=new ag(L);this.jTb.add(M.id,M)}}getCount(){const L=new rf(24);try{Sd.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.$Wb)return Sd.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;L.Rv();return this.$Wb.length}finally{L&&L.dispose()}}getItem(L){const M=new rf(26);try{Sd.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Ja=this.jTb.ga(L);M.Rv();return Ja}catch(Ja){throw Sd.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{M&&M.dispose()}}getItemAt(L){const M=new rf(25);try{Sd.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Ja=this.jTb.ga(this.$Wb[L].Id.toString());M.Rv();return Ja}catch(Ja){throw Sd.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Ja.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{M&&M.dispose()}}getItemOrNullObject(L){const M=new rf(27);try{Sd.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let Ja;({value:Ja}=this.jTb.Uf(L));M.Rv();return Ja}finally{M&&M.dispose()}}_OnAccess(){}getAsyncEnumerator(L,M){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ci(L,M,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 1:return this.x9a();case 2:return this.M9a(M);case 3:return this.L9a(M);case 4:return this.N9a(M);case 5:return this.UH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}x9a(){return this.getCount()}M9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItem(L)}L9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"int");return this.getItemAt(L)}N9a(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");return this.getItemOrNullObject(L)}UH(){this._OnAccess();return null}}
Object(h.a)(Dc,"SlideMasterCollection",null,[892]);class Dl{constructor(L){this.nE=new ck;this.T4=L.presentation}get context(){return this.nE}get slideMasters(){const L=new rf(2);try{Sd.a.J(572643293,802,50,"PptApi Call - Presentation.GetSlideMasters");const M=new Dc(this.T4.M0);L.Rv();return M}finally{L&&L.dispose()}}get slides(){const L=new rf(3);try{Sd.a.J(572643294,802,50,"PptApi Call - Presentation.GetSlides");const M=new Gm(this.T4);L.Rv();return M}finally{L&&L.dispose()}}get tags(){Bg.ar(!1);
return null}get title(){const L=new rf(4);try{return Sd.a.J(572643295,802,50,"PptApi Call - Presentation.GetTitle"),L.Rv(),"This is the title property"}finally{L&&L.dispose()}}getSelectedShapes(){Bg.ar(!1);return null}getSelectedSlides(){Bg.ar(!1);return null}getSelectedTextRange(){Bg.ar(!1);return null}getSelectedTextRangeOrNullObject(){Bg.ar(!1);return null}insertSlidesFromBase64(){Bg.ar(!1)}setSelectedSlides(){Bg.ar(!1)}_RegisterEvent(L,M){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
L,M)}_UnregisterEvent(L,M){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,L,M)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(L){switch(L){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokePropertyGetAsync(L){L=this.invokePropertyGet(L);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}invokePropertySet(L){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);
}invokePropertySetAsync(L,M){this.invokePropertySet(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(L,M){switch(L){case 5:return this.kij();case 6:return this.mij();case 7:return this.rij();case 9:return this.sij();case 1003:return this.MGj(M);case 8:return this.edl(M);case 1001:return this.gMh(M);case 1002:return this.kMh(M)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(L);}invokeMethodAsync(L,M){L=this.invokeMethod(L,M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(L)}kij(){return this.getSelectedShapes()}mij(){return this.getSelectedSlides()}rij(){return this.getSelectedTextRange()}sij(){return this.getSelectedTextRangeOrNullObject()}MGj(L){const M=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,Ll);this.insertSlidesFromBase64(M,L);return null}edl(L){L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"Array<string>");this.setSelectedSlides(L);return null}gMh(L){const M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");this._RegisterEvent(M,L);return null}kMh(L){const M=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,0,"string");L=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(L,1,"int");this._UnregisterEvent(M,L);return null}}Object(h.a)(Dl,"Presentation",null,[]);class Nl{create(L){return new Dl(L)}}Object(h.a)(Nl,"PresentationFactory",null,[831]);class Xh{create(L,M,Ja){return new Bg(L,M,Ja)}}Object(h.a)(Xh,"RichApiHostFactory",null,[832]);class th{constructor(L){this.rb=document.createElement("div");this.rb.className="AddinPaneFrame";this.bA=
L}dispose(){}layout(L,M){this.bA.value.gtj(L,M);return L}get isVisible(){return!1}get xa(){return this.rb}get order(){return 13}}Object(h.a)(th,"AddinPaneFrame",null,[795,718,106]);class Li{constructor(){this.Jcb=this.g4c=this.K=this.Yc=this.lH=null;this.kF=!!B.AFrameworkApplication.Aa&&!!B.AFrameworkApplication.Aa.hb&&B.AFrameworkApplication.Aa.hb.eX}get name(){return"PowerPointWebEditor.AppForOffice"}Mka(L){return L.resolve("PowerPointWebEditor.IApplicationSettings").cB||L.resolve("PowerPointWebEditor.IApplicationSettings").VW}Zb(L){this.lH=
L.resolve("Common.AFrameworkApplication");this.K=L;this.K.register(bj,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").oa(()=>new bj).ma();this.K.register(vf,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").oa(()=>new vf(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").xa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.ie("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(Yg,"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").oa(()=>new Yg(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();Object(Ue.a)("RegisterPackageBeforeResolve")&&this.Mka(this.K)&&(this.K.register(Xh,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>new Xh).ma(),this.K.register(Nl,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>
new Nl).ma());this.K.register(xa,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").oa(()=>new xa(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new wg,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.ie("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new G,S.getInstance(),this.K.ie("PowerPointWebEditor.IAppforOfficeClassFactory"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const M=new z;this.K.register(Lg,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").oa(()=>
new Lg(this.lH,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),M,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new vd,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register(Lh,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").oa(()=>
new Lh(M)).ma();this.K.register(bf,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").oa(()=>new bf(this.n1i())).ma();this.K.register(ti,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").oa(()=>new ti(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();Object(Ue.a)("RegisterPackageBeforeResolve")&&this.Mka(this.K)||(this.K.register(Xh,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>
new Xh).ma(),this.K.register(Nl,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new Nl).ma());this.K.register(795,"PowerPointWebEditor.IAddinPaneFrame").ma().oa(()=>new th(this.K.ie("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(796,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().oa(()=>new Ic)}init(){B.AFrameworkApplication.wsa||this.K.resolve("Common.IAppSettingsManager").gf(Object(E.a)(this,
this.Pm,"onFullAppSettingsReady"))}Pm(){this.Yc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Yc.R0b=!0;B.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(L=>{L.isFeatureEnabled(Li.cck,!0).then(M=>{this.Yc.R0b=M;this.xyb();return null})}):this.xyb()}xyb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").aQe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const L=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");L.Wxl();L.Xxl();L.krj();this.Uzl();this.UDj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}UDj(){const L=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame");
this.kF||this.K.resolve("PowerPointWebEditor.IPaneManager").RP(L);const M=this.K.resolve("PowerPointWebEditor.IFocusManager"),Ja=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");M.X8(ke.a.wra,ke.a.gj,L,!Ja.Fbe());this.lH.wq.Oq()}n1i(){const L=[];var M=[];M.push(this.K.resolve("Box4.Graph.IGraphInstance").yd(47));M.push(this.K.resolve("Box4.Graph.IGraphInstance").yd(10));M=new Hj(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),M,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));
L.push(M);M=new hi(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));L.push(M);M=new ff(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));L.push(M);M=new ql(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphInstance").yd(47));
L.push(M);M=new Mb(this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));L.push(M);return L}Uzl(){this.Jcb=B.AFrameworkApplication.fa.Ga("DevAddinManifestFileUrl");this.g4c=B.AFrameworkApplication.fa.Ga("DevAddinManifestGuid");var L=B.AFrameworkApplication.fa.Ga("IsDevAddinTest");if(this.Jcb&&this.g4c&&L)if(L="true"===L,v.a.instance.getItem("optedIntoAddinDeveloperMode")||L&&B.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(v.a.instance.getItem(this.g4c)||
L&&B.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Yc.vl.validateAndCacheNewDevAddinManifest(this.Jcb);else{L=new y.StandardDialog;L.xd=4;const M=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Jcb)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;L.fP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,M,Object(E.a)(this,this.vgh,"registerDevAddinManifestHandler"))}else L=
Object(E.a)(this,this.vgh,"registerDevAddinManifestHandler"),L=new Rc(this.Jcb,L),L.xd=0,L.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}vgh(L){1===L&&this.Jcb&&this.KTk()}KTk(){this.Yc&&(this.Yc.vl.validateAndCacheNewDevAddinManifest(this.Jcb),v.a.instance.setItem(this.g4c,"true"))}static main(){A.a.instance.Dc(new Li)}}Li.cck="mso_officeStore";Object(h.a)(Li,"AppForOfficePackage",null,[2,3]);var $g=
d(12);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Object($g.c)("AppForOffice");Type.registerNamespace("CommandUI.AddInCommands");Li.main();Object($g.b)("AppForOffice")},448:function(I,Y,d){d.d(Y,"a",function(){return n});I=d(0);var h=d(387),e=d(209);class n{static nuh(m){return parseInt(n.Flb(e.a.QPd,m)||"-1")<=(new Date).getTime()}static h5d(m){return parseInt(n.Flb(e.a.k6a,
m)||"-1")}static Gbe(m){return Boolean.parse(n.Flb(e.a.nrb,m)||"false")}static Flb(m,z){let B=null;try{const v=n.R9a();if(void 0!==v&&v){const y=e.a.dRc(m)+z;B=v.getItem(y)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",m,z)}return B}static Jlb(m,z,B){try{const v=n.R9a();if(void 0!==v&&v){const y=e.a.dRc(m)+B;v.setItem(y,z)}else h.ULS.sendTraceTag(42074647,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(v){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",m,B)}}static R9a(){if(!n.VTa)return null;let m=null;try{m=localStorage}catch(z){n.VTa=!1,m=null}return m}}n.VTa=!0;Object(I.a)(n,"AddinUtil",null,[])},539:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=
2]="spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(I.b)("AddinProviderType",h)},540:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=
1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(I.b)("AddinCommandsLaunchOperationType",h)},548:function(I,Y,d){d.r(Y);I=d(0);var h=d(18),e=d(387),n=d(69);class m{constructor(){this.startTime=0;this.callback=null}}Object(I.a)(m,
"SSOCallbackInfo",null,[]);class z{constructor(){this.accessToken=null}}Object(I.a)(z,"AccessTokenInformation",null,[953]);var B=d(974);class v{constructor(){this.token=null;this.expiresOn=0;this.eCa=this.hW=null}}Object(I.a)(v,"CachedTokenInfo",null,[]);class y{constructor(){this.pwc=new h.a;this.zra=this.yra=!1;this.$La=this.hW=null;this.startTime=this.retryCount=0;this.gvf=null}get PTd(){return this.pwc}}Object(I.a)(y,"SSORequestInfo",null,[]);class A extends y{constructor(){super();this.errorCode=
0}}Object(I.a)(A,"SSOFailedRequestInfo",y,[]);var E=d(27);class u{constructor(aa,V,ca,fa){this.y7=new h.a;this.hS=new h.a;this.XMa=null;this.XVb=new h.a;this.ghf=Promise.resolve(null);this.Bof=!1;this.HZh=V;this.Wwc=aa;this.epf=ca;this.HMh=fa}yil(aa){if(this.XMa&&this.XMa.hW===aa.hW){if(Date.now()/1E3+u.Lkk>this.XMa.expiresOn)return this.XMa=null,!1;aa=new B.a;aa.token=this.XMa.token;aa.expiresOn=this.XMa.expiresOn;aa.eCa=this.XMa.eCa;aa.tlb=!0;aa.P6b=0;this.z7b(aa);return!0}return!1}Vgl(aa){for(let V=
0;V<this.hS.count;V++)if(this.hS.ga(V).hW===aa.hW&&this.hS.ga(V).$La===aa.$La){let ca;(ca=this.hS.ga(V)).retryCount=ca.retryCount+1;aa.retryCount=this.hS.ga(V).retryCount;if(this.hS.ga(V).retryCount<u.BYa||!this.hS.ga(V).yra&&aa.yra||!this.hS.ga(V).zra&&aa.zra){if(!this.hS.ga(V).yra&&aa.yra||!this.hS.ga(V).zra&&aa.zra)aa.retryCount=0;this.hS.removeAt(V);break}aa=new B.a;aa.errorCode=this.hS.ga(V).errorCode;this.z7b(aa);return!0}return!1}W7h(aa,V){for(let ca=0;ca<this.hS.count;ca++)if(this.hS.ga(ca).$La===
aa.$La&&this.hS.ga(ca).hW===aa.hW)return;this.hS.add(Object.assign(new A,{yra:aa.yra,zra:aa.zra,hW:aa.hW,$La:aa.$La,errorCode:V,retryCount:aa.retryCount}))}get resource(){return this.HZh}d5d(aa,V,ca,fa,ma,da){const {AppsForOfficeSingleSignOnManager:qa}=d(548);""===ca&&(ca=null);if(this.Bof)qa.sla(da,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var F=null;for(let sa of this.y7)if(sa.yra===aa&&sa.zra===V&&sa.hW===ca&&sa.$La===ma){F=sa;break}F||(F=Object.assign(new y,{yra:aa,
zra:V,hW:ca,gvf:fa,$La:ma,retryCount:0,startTime:qa.EF()}),this.y7.add(F));F.retryCount=0;F.PTd.add(da);this.ghf=this.ghf.then(()=>{var {AppsForOfficeSingleSignOnManager:sa}=d(548);if(0<this.y7.count){var ia=this.y7.ga(0);if(this.yil(ia)||this.Vgl(ia))return null;for(let Ca=0;Ca<this.XVb.count;)this.XVb.ga(Ca)+u.avl<sa.EF()?this.XVb.removeAt(Ca):Ca++;if(this.XVb.count>=u.$kk||this.y7.count>=u.Ikk)return ia=new B.a,ia.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.z7b(ia),null;
let Na=null;E.AFrameworkApplication.Aa&&(sa=E.AFrameworkApplication.Aa.gV)&&(Na=sa.Ci("ComponentAttach",this.Wwc+u.V0h));return ia.$La.R3h(this.resource,ia.yra,ia.zra,ia.hW,this.HMh,ia.gvf).then(Ca=>{Na&&Na.stop();this.z7b(Ca)},()=>{Na&&Na.stop();const Ca=new B.a;Ca.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.z7b(Ca)})}return null})}}z7b(aa){const {AppsForOfficeSingleSignOnManager:V}=d(548);try{if(this.y7.count){var ca=this.y7.ga(0);this.y7.removeAt(0);var fa=null;aa.errorCode||
(fa=new z,fa.accessToken=aa.token);aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&aa.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.W7h(ca,aa.errorCode);var ma={};null!=aa.P6b&&(ma.getTokenSilentTime=aa.P6b.toString());null!=aa.bae&&(ma.getTokenPopupTime=aa.bae.toString());null!=aa.A7d&&(ma.getIDTokenTime=
aa.A7d.toString());null!=aa.tlb&&(ma.tokenCached=aa.tlb.toString());aa.X0e&&(ma.detailedError=aa.X0e);aa.eCa&&(ma.authLibrary=aa.eCa);ca.retryCount&&(ma.retryCount=ca.retryCount);for(var da of ca.PTd)V.sla(da,aa.errorCode,fa,ma);null!=aa.tlb&&aa.tlb||this.XVb.add(ca.startTime);if(!aa.errorCode)for(null!=aa.expiresOn&&(this.XMa=Object.assign(new v,{token:aa.token,expiresOn:aa.expiresOn,hW:ca.hW,eCa:aa.eCa})),this.hS.clear(),da=0;da<this.y7.count;)if(this.y7.ga(da).hW===ca.hW){for(let qa of this.y7.ga(da).PTd)V.sla(qa,
aa.errorCode,fa,ma);this.y7.removeAt(da)}else da++}}catch(qa){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",qa.message)}}shutdown(){this.Bof=!0;this.y7.clear()}}u.avl=6E4;u.$kk=6;u.Ikk=6;u.BYa=3;u.Lkk=300;u.V0h="GetAccessToken";Object(I.a)(u,"SSOCallbackManager",null,[]);var J=d(209),G=d(226),S=d(172),P=d(80),Q=d(55),D=d(47),O=d(142),X=d(182);d.d(Y,"AppsForOfficeSingleSignOnManager",function(){return N});class N{constructor(aa,V,ca=null){this.Cmb=new n.a;
const fa=new h.a;V&&fa.add(V.Vhk);ca&&fa.addRange(ca);this.aN=aa;this.d2h=fa}removeCallbackForAddin(aa){this.Cmb.Hb(aa)&&(this.Cmb.ga(aa).shutdown(),this.Cmb.remove(aa))}e5d(aa,V,ca,fa,ma,da,qa,F,sa,ia){ia=Object.assign(new m,{startTime:N.EF(),callback:ia});try{const ha=!!ca&&""!==ca;var Na=ia.startTime;const Ba=this.getOsfControl(aa);let va=Ba.getStoreType()||"",ta=Ba.getOwnerAddinStoreType()||"",Fa=Ba.getSolutionId()||"";const pa=Ba.getVersion()||"";va=va.toLowerCase();ta=ta.toLowerCase();Fa=Fa.toLowerCase();
var Ca=P.a.NSc(V)||"";const ka=P.a.NSc(Ba.getIframeUrl())||"",Ha=Ca.toLowerCase()===ka.toLowerCase();Ca=va;"inmemory"===va&&(Ca=ta);const Ya=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa,Ca,Ba.getAssetId(),null,null,Ba.getStoreId()),Ka={["callInstanceId"]:Na.toString(),["controlSolutionId"]:Ya,["controlVersion"]:pa,["storeType"]:va,["ownerStoreType"]:ta,["allowConsentPrompt"]:fa.toString(),["forMSGraphAccess"]:ma.toString(),["allowSignInPrompt"]:da.toString(),["hasAddinAuthChallenge"]:ha.toString(),
["securityOriginEqualsSourceLocation"]:Ha.toString(),["singleSignOnEnabled"]:qa.toString(),["accountTypeFilter"]:F||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Ka);O.a.sendTelemetryEvent(Object.assign(new X.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:S.a.pC(Ka)}));Na=!0;const Pa=E.AFrameworkApplication.fa.Ga("HostAuthType");switch(F){case "aad":Na="aad"===Pa;break;case "msa":Na="msa"===Pa;break;default:Na=!F||"noFilter"===F}if(Na){F=null;if(qa)for(let Oa of this.d2h)if(Oa.yMj(Fa)){F=
Oa;break}F?this.isSSOAddin(aa)?(qa=!0,"omex"===Ca&&(qa=!1),"spapp"===Ca||"spcatalog"===Ca?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),N.sla(ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ma&&!qa?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),N.sla(ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ma&&"exchange"===Ca&&(fa=!1),
this.d5d(aa,V,ca,Ca,fa,da,sa,F,ia))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),N.sla(ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):N.sla(ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else N.sla(ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ha){this.Y1c(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",ha.message),N.sla(ia,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(aa,V,ca,fa){this.e5d(aa,ca[J.a.RPd]||null,ca[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ca[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,ca[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ca[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,V,ca[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,ca[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,fa)}d5d(aa,V,ca,fa,ma,da,qa,F,sa){this.Cmb.Hb(aa)?fa=this.Cmb.ga(aa):(fa=new u(aa,this.getWebApplicationResource(aa).split(",")[0],fa,this.getDefaultDisplayName(aa)),this.Cmb.add(aa,fa));const ia=fa.resource;aa=N.Zgj(ia,this.getWebApplicationId(aa));const Na=OfficeExt.WACUtils.getHostSecure(V);aa&&Na?aa.toLowerCase()===Na.toLowerCase()?fa.d5d(ma,da,ca,qa,F,sa):(N.Ubb('SSO Resource "'+ia+'" cannot be used from "'+V+'" origin due to domain mismatch.'),
e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),N.sla(sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(aa||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Na||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),N.sla(sa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Y1c(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(aa){return this.aN.getOsfControl(aa)}isSSOAddin(aa){return this.getOsfControl(aa).getManifest().isSSOAddin()}getWebApplicationId(aa){return this.getOsfControl(aa).getManifest().getWebApplicationId()}getWebApplicationResource(aa){return this.getOsfControl(aa).getManifest().getWebApplicationResource()}getDefaultDisplayName(aa){return this.getOsfControl(aa).getManifest().getDefaultDisplayName()}static E6f(){try{const aa=
{};Q.a.NFa&&G.OAuthManagerSettings.Q$a&&(aa.UiHostSupportsAuthTokenAddinList=N.dQc);aa.UiHostSupportsAuthToken=G.OAuthManagerSettings.Q$a;return aa}catch(aa){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",aa.message)}return null}static getInstance(aa,V,ca=null){N.Ka||(N.Ka=new N(aa,ca));return N.Ka}static Nqi(aa){N.Ka&&N.Ka.removeCallbackForAddin(aa)}static Ubb(aa){window.console.warn&&window.console.warn(aa)}static Zgj(aa,V){if(!aa)return"";V||(V="");
let ca=aa.toLowerCase();var fa=V.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(fa)||(N.Ubb('SSO App Id "'+V+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ca.endsWith(fa)||(N.Ubb('SSO Resource "'+aa+'" does not end with App Id "'+V+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ca.startsWith("https://")&&
!ca.startsWith("api://"))return N.Ubb('SSO Resource "'+aa+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(V=0;V<aa.length;V++){fa=aa.charAt(V);const ma=D.a.charCodeAt(aa,V);if(33>ma||126<ma||"&"===fa||"?"===fa||"#"===fa||"%"===fa||"\\"===fa)return N.Ubb('SSO Resource "'+aa+'" contains an invalid character "'+fa+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+fa+"' in resource URI."),""}if(0<=aa.indexOf("::"))return N.Ubb('SSO Resource "'+
aa+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<aa.length)return N.Ubb('SSO Resource "'+aa+'" is '+aa.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+aa.length+"."),"";ca.startsWith("api://")&&(ca="https://"+ca.substring(6,ca.length));return 8===ca.length?"":OfficeExt.WACUtils.getHostSecure(ca)||""}static sla(aa,V,ca,fa){var ma=aa.startTime;let da=0;0<ma&&(da=
N.EF()-ma);ma={["callInstanceId"]:ma.toString(),["callDuration"]:da.toString(),["errorCode"]:V.toString()};if(fa)for(let qa in fa)ma[qa]=fa[qa];e.ULS.sendTraceTag(51401116,344,50,"{0}",ma);O.a.sendTelemetryEvent(Object.assign(new X.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:S.a.pC(ma)}));aa.callback(V,ca)}static EF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(aa){}return Date.now()}}N.dQc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
N.Ka=null;Object(I.a)(N,"AppsForOfficeSingleSignOnManager",null,[894])},974:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.eCa=this.tlb=this.A7d=this.bae=this.P6b=this.X0e=null}}Object(I.a)(h,"AppsForOfficeOauthResult",null,[])},975:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=
!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static IZf(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(I.a)(h,"WopiAuthContext",null,[791])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.appforoffice.js.map