var video=function(e){var t={};function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=6)}([function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";(function(e,i){/*! @vimeo/player v2.18.0 | (c) 2022 Vimeo | MIT License | https://github.com/vimeo/player.js */
function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=void 0!==e&&"[object global]"==={}.toString.call(e);function s(e,t){return 0===e.indexOf(t.toLowerCase())?e:"".concat(t.toLowerCase()).concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}function o(e){return Boolean(e&&1===e.nodeType&&"nodeName"in e&&e.ownerDocument&&e.ownerDocument.defaultView)}function l(e){return!isNaN(parseFloat(e))&&isFinite(e)&&Math.floor(e)==e}function d(e){return/^(https?:)?\/\/((player|www)\.)?vimeo\.com(?=$|\/)/.test(e)}function u(e){return/^https:\/\/player\.vimeo\.com\/video\/\d+/.test(e)}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,i=e.url,r=t||i;if(!r)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(l(r))return"https://vimeo.com/".concat(r);if(d(r))return r.replace("http:","https:");if(t)throw new TypeError("“".concat(t,"” is not a valid video id."));throw new TypeError("“".concat(r,"” is not a vimeo.com url."))}var c=void 0!==Array.prototype.indexOf,m="undefined"!=typeof window&&void 0!==window.postMessage;if(!(n||c&&m))throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};
/*!
 * weakmap-polyfill v2.0.4 - ECMAScript6 WeakMap polyfill
 * https://github.com/polygonplanet/weakmap-polyfill
 * Copyright (c) 2015-2021 polygonplanet <polygon.planet.aqua@gmail.com>
 * @license MIT
 */
!function(e){if(!e.WeakMap){var t=Object.prototype.hasOwnProperty,i=Object.defineProperty&&function(){try{return 1===Object.defineProperty({},"x",{value:1}).x}catch(e){}}(),r=function(e,t,r){i?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:r}):e[t]=r};e.WeakMap=function(){function e(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(r(this,"_id",n("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}function i(e,i){if(!a(e)||!t.call(e,"_id"))throw new TypeError(i+" method called on incompatible receiver "+typeof e)}function n(e){return e+"_"+s()+"."+s()}function s(){return Math.random().toString().substring(2)}return r(e.prototype,"delete",(function(e){if(i(this,"delete"),!a(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)&&(delete e[this._id],!0)})),r(e.prototype,"get",(function(e){if(i(this,"get"),a(e)){var t=e[this._id];return t&&t[0]===e?t[1]:void 0}})),r(e.prototype,"has",(function(e){if(i(this,"has"),!a(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)})),r(e.prototype,"set",(function(e,t){if(i(this,"set"),!a(e))throw new TypeError("Invalid value used as weak map key");var n=e[this._id];return n&&n[0]===e?(n[1]=t,this):(r(e,this._id,[e,t]),this)})),r(e,"_polyfill",!0),e}()}function a(e){return Object(e)===e}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:p);var f=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){
/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
var t,r,a;a=function(){var e,t,r,a=Object.prototype.toString,n=void 0!==i?function(e){return i(e)}:setTimeout;try{Object.defineProperty({},"x",{}),e=function(e,t,i,r){return Object.defineProperty(e,t,{value:i,writable:!0,configurable:!1!==r})}}catch(t){e=function(e,t,i){return e[t]=i,e}}function s(e,i){r.add(e,i),t||(t=n(r.drain))}function o(e){var t,i=typeof e;return null==e||"object"!=i&&"function"!=i||(t=e.then),"function"==typeof t&&t}function l(){for(var e=0;e<this.chain.length;e++)d(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function d(e,t,i){var r,a;try{!1===t?i.reject(e.msg):(r=!0===t?e.msg:t.call(void 0,e.msg))===i.promise?i.reject(TypeError("Promise-chain cycle")):(a=o(r))?a.call(r,i.resolve,i.reject):i.resolve(r)}catch(e){i.reject(e)}}function u(e){var t,i=this;if(!i.triggered){i.triggered=!0,i.def&&(i=i.def);try{(t=o(e))?s((function(){var r=new m(i);try{t.call(e,(function(){u.apply(r,arguments)}),(function(){h.apply(r,arguments)}))}catch(e){h.call(r,e)}})):(i.msg=e,i.state=1,i.chain.length>0&&s(l,i))}catch(e){h.call(new m(i),e)}}}function h(e){var t=this;t.triggered||(t.triggered=!0,t.def&&(t=t.def),t.msg=e,t.state=2,t.chain.length>0&&s(l,t))}function c(e,t,i,r){for(var a=0;a<t.length;a++)!function(a){e.resolve(t[a]).then((function(e){i(a,e)}),r)}(a)}function m(e){this.def=e,this.triggered=!1}function p(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function f(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var t=new p(this);this.then=function(e,i){var r={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return r.promise=new this.constructor((function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");r.resolve=e,r.reject=t})),t.chain.push(r),0!==t.state&&s(l,t),r.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,(function(e){u.call(t,e)}),(function(e){h.call(t,e)}))}catch(e){h.call(t,e)}}r=function(){var e,i,r;function a(e,t){this.fn=e,this.self=t,this.next=void 0}return{add:function(t,n){r=new a(t,n),i?i.next=r:e=r,i=r,r=void 0},drain:function(){var r=e;for(e=i=t=void 0;r;)r.fn.call(r.self),r=r.next}}}();var y=e({},"constructor",f,!1);return f.prototype=y,e(y,"__NPO__",0,!1),e(f,"resolve",(function(e){return e&&"object"==typeof e&&1===e.__NPO__?e:new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");t(e)}))})),e(f,"reject",(function(e){return new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");i(e)}))})),e(f,"all",(function(e){var t=this;return"[object Array]"!=a.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t((function(i,r){if("function"!=typeof i||"function"!=typeof r)throw TypeError("Not a function");var a=e.length,n=Array(a),s=0;c(t,e,(function(e,t){n[e]=t,++s===a&&i(n)}),r)}))})),e(f,"race",(function(e){var t=this;return"[object Array]"!=a.call(e)?t.reject(TypeError("Not an array")):new t((function(i,r){if("function"!=typeof i||"function"!=typeof r)throw TypeError("Not a function");c(t,e,(function(e,t){i(t)}),r)}))})),f},(r=p)[t="Promise"]=r[t]||a(),e.exports&&(e.exports=r[t])})),y=new WeakMap;function v(e,t,i){var r=y.get(e.element)||{};t in r||(r[t]=[]),r[t].push(i),y.set(e.element,r)}function g(e,t){return(y.get(e.element)||{})[t]||[]}function T(e,t,i){var r=y.get(e.element)||{};if(!r[t])return!0;if(!i)return r[t]=[],y.set(e.element,r),!0;var a=r[t].indexOf(i);return-1!==a&&r[t].splice(a,1),y.set(e.element,r),r[t]&&0===r[t].length}function b(e,t){var i=y.get(e);y.set(t,i),y.delete(e)}function P(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return console.warn(e),{}}return e}function w(e,t,i){if(e.element.contentWindow&&e.element.contentWindow.postMessage){var r={method:t};void 0!==i&&(r.value=i);var a=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));a>=8&&a<10&&(r=JSON.stringify(r)),e.element.contentWindow.postMessage(r,e.origin)}}function k(e,t){var i,r=[];if((t=P(t)).event){if("error"===t.event)g(e,t.data.method).forEach((function(i){var r=new Error(t.data.message);r.name=t.data.name,i.reject(r),T(e,t.data.method,i)}));r=g(e,"event:".concat(t.event)),i=t.data}else if(t.method){var a=function(e,t){var i=g(e,t);if(i.length<1)return!1;var r=i.shift();return T(e,t,r),r}(e,t.method);a&&(r.push(a),i=t.value)}r.forEach((function(t){try{if("function"==typeof t)return void t.call(e,i);t.resolve(i)}catch(e){}}))}var E=["autopause","autoplay","background","byline","color","controls","dnt","height","id","interactive_params","keyboard","loop","maxheight","maxwidth","muted","playsinline","portrait","responsive","speed","texttrack","title","transparent","url","width"];function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E.reduce((function(t,i){var r=e.getAttribute("data-vimeo-".concat(i));return(r||""===r)&&(t[i]=""===r?1:r),t}),t)}function M(e,t){var i=e.html;if(!t)throw new TypeError("An element must be provided");if(null!==t.getAttribute("data-vimeo-initialized"))return t.querySelector("iframe");var r=document.createElement("div");return r.innerHTML=i,t.appendChild(r.firstChild),t.setAttribute("data-vimeo-initialized","true"),t.querySelector("iframe")}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){if(!d(e))throw new TypeError("“".concat(e,"” is not a vimeo.com url."));var n="https://vimeo.com/api/oembed.json?url=".concat(encodeURIComponent(e));for(var s in t)t.hasOwnProperty(s)&&(n+="&".concat(s,"=").concat(encodeURIComponent(t[s])));var o="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;o.open("GET",n,!0),o.onload=function(){if(404!==o.status)if(403!==o.status)try{var t=JSON.parse(o.responseText);if(403===t.domain_status_code)return M(t,i),void a(new Error("“".concat(e,"” is not embeddable.")));r(t)}catch(e){a(e)}else a(new Error("“".concat(e,"” is not embeddable.")));else a(new Error("“".concat(e,"” was not found.")))},o.onerror=function(){var e=o.status?" (".concat(o.status,")"):"";a(new Error("There was an error fetching the embed code from Vimeo".concat(e,".")))},o.send()}))}var F=new WeakMap,I=new WeakMap,A={},R=function(){function e(t){var i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r(this,e),window.jQuery&&t instanceof jQuery&&(t.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),t=t[0]),"undefined"!=typeof document&&"string"==typeof t&&(t=document.getElementById(t)),!o(t))throw new TypeError("You must pass either a valid element or a valid id.");if("IFRAME"!==t.nodeName){var n=t.querySelector("iframe");n&&(t=n)}if("IFRAME"===t.nodeName&&!d(t.getAttribute("src")||""))throw new Error("The player element passed isn’t a Vimeo embed.");if(F.has(t))return F.get(t);this._window=t.ownerDocument.defaultView,this.element=t,this.origin="*";var s=new f((function(e,r){if(i._onMessage=function(t){if(d(t.origin)&&i.element.contentWindow===t.source){"*"===i.origin&&(i.origin=t.origin);var a=P(t.data);if(a&&"error"===a.event&&a.data&&"ready"===a.data.method){var n=new Error(a.data.message);return n.name=a.data.name,void r(n)}var s=a&&"ready"===a.event,o=a&&"ping"===a.method;if(s||o)return i.element.setAttribute("data-ready","true"),void e();k(i,a)}},i._window.addEventListener("message",i._onMessage),"IFRAME"!==i.element.nodeName){var n=S(t,a);C(h(n),n,t).then((function(e){var r=M(e,t);return i.element=r,i._originalElement=t,b(t,r),F.set(i.element,i),e})).catch(r)}}));if(I.set(this,s),F.set(this.element,this),"IFRAME"===this.element.nodeName&&w(this,"ping"),A.isEnabled){var l=function(){return A.exit()};this.fullscreenchangeHandler=function(){A.isFullscreen?v(i,"event:exitFullscreen",l):T(i,"event:exitFullscreen",l),i.ready().then((function(){w(i,"fullscreenchange",A.isFullscreen)}))},A.on("fullscreenchange",this.fullscreenchangeHandler)}return this}var t,i,n;return t=e,(i=[{key:"callMethod",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new f((function(r,a){return t.ready().then((function(){v(t,e,{resolve:r,reject:a}),w(t,e,i)})).catch(a)}))}},{key:"get",value:function(e){var t=this;return new f((function(i,r){return e=s(e,"get"),t.ready().then((function(){v(t,e,{resolve:i,reject:r}),w(t,e)})).catch(r)}))}},{key:"set",value:function(e,t){var i=this;return new f((function(r,a){if(e=s(e,"set"),null==t)throw new TypeError("There must be a value to set.");return i.ready().then((function(){v(i,e,{resolve:r,reject:a}),w(i,e,t)})).catch(a)}))}},{key:"on",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(!t)throw new TypeError("You must pass a callback function.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");0===g(this,"event:".concat(e)).length&&this.callMethod("addEventListener",e).catch((function(){})),v(this,"event:".concat(e),t)}},{key:"off",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(t&&"function"!=typeof t)throw new TypeError("The callback must be a function.");T(this,"event:".concat(e),t)&&this.callMethod("removeEventListener",e).catch((function(e){}))}},{key:"loadVideo",value:function(e){return this.callMethod("loadVideo",e)}},{key:"ready",value:function(){var e=I.get(this)||new f((function(e,t){t(new Error("Unknown player. Probably unloaded."))}));return f.resolve(e)}},{key:"addCuePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.callMethod("addCuePoint",{time:e,data:t})}},{key:"removeCuePoint",value:function(e){return this.callMethod("removeCuePoint",e)}},{key:"enableTextTrack",value:function(e,t){if(!e)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:e,kind:t})}},{key:"disableTextTrack",value:function(){return this.callMethod("disableTextTrack")}},{key:"pause",value:function(){return this.callMethod("pause")}},{key:"play",value:function(){return this.callMethod("play")}},{key:"requestFullscreen",value:function(){return A.isEnabled?A.request(this.element):this.callMethod("requestFullscreen")}},{key:"exitFullscreen",value:function(){return A.isEnabled?A.exit():this.callMethod("exitFullscreen")}},{key:"getFullscreen",value:function(){return A.isEnabled?f.resolve(A.isFullscreen):this.get("fullscreen")}},{key:"requestPictureInPicture",value:function(){return this.callMethod("requestPictureInPicture")}},{key:"exitPictureInPicture",value:function(){return this.callMethod("exitPictureInPicture")}},{key:"getPictureInPicture",value:function(){return this.get("pictureInPicture")}},{key:"unload",value:function(){return this.callMethod("unload")}},{key:"destroy",value:function(){var e=this;return new f((function(t){if(I.delete(e),F.delete(e.element),e._originalElement&&(F.delete(e._originalElement),e._originalElement.removeAttribute("data-vimeo-initialized")),e.element&&"IFRAME"===e.element.nodeName&&e.element.parentNode&&(e.element.parentNode.parentNode&&e._originalElement&&e._originalElement!==e.element.parentNode?e.element.parentNode.parentNode.removeChild(e.element.parentNode):e.element.parentNode.removeChild(e.element)),e.element&&"DIV"===e.element.nodeName&&e.element.parentNode){e.element.removeAttribute("data-vimeo-initialized");var i=e.element.querySelector("iframe");i&&i.parentNode&&(i.parentNode.parentNode&&e._originalElement&&e._originalElement!==i.parentNode?i.parentNode.parentNode.removeChild(i.parentNode):i.parentNode.removeChild(i))}e._window.removeEventListener("message",e._onMessage),A.isEnabled&&A.off("fullscreenchange",e.fullscreenchangeHandler),t()}))}},{key:"getAutopause",value:function(){return this.get("autopause")}},{key:"setAutopause",value:function(e){return this.set("autopause",e)}},{key:"getBuffered",value:function(){return this.get("buffered")}},{key:"getCameraProps",value:function(){return this.get("cameraProps")}},{key:"setCameraProps",value:function(e){return this.set("cameraProps",e)}},{key:"getChapters",value:function(){return this.get("chapters")}},{key:"getCurrentChapter",value:function(){return this.get("currentChapter")}},{key:"getColor",value:function(){return this.get("color")}},{key:"setColor",value:function(e){return this.set("color",e)}},{key:"getCuePoints",value:function(){return this.get("cuePoints")}},{key:"getCurrentTime",value:function(){return this.get("currentTime")}},{key:"setCurrentTime",value:function(e){return this.set("currentTime",e)}},{key:"getDuration",value:function(){return this.get("duration")}},{key:"getEnded",value:function(){return this.get("ended")}},{key:"getLoop",value:function(){return this.get("loop")}},{key:"setLoop",value:function(e){return this.set("loop",e)}},{key:"setMuted",value:function(e){return this.set("muted",e)}},{key:"getMuted",value:function(){return this.get("muted")}},{key:"getPaused",value:function(){return this.get("paused")}},{key:"getPlaybackRate",value:function(){return this.get("playbackRate")}},{key:"setPlaybackRate",value:function(e){return this.set("playbackRate",e)}},{key:"getPlayed",value:function(){return this.get("played")}},{key:"getQualities",value:function(){return this.get("qualities")}},{key:"getQuality",value:function(){return this.get("quality")}},{key:"setQuality",value:function(e){return this.set("quality",e)}},{key:"getSeekable",value:function(){return this.get("seekable")}},{key:"getSeeking",value:function(){return this.get("seeking")}},{key:"getTextTracks",value:function(){return this.get("textTracks")}},{key:"getVideoEmbedCode",value:function(){return this.get("videoEmbedCode")}},{key:"getVideoId",value:function(){return this.get("videoId")}},{key:"getVideoTitle",value:function(){return this.get("videoTitle")}},{key:"getVideoWidth",value:function(){return this.get("videoWidth")}},{key:"getVideoHeight",value:function(){return this.get("videoHeight")}},{key:"getVideoUrl",value:function(){return this.get("videoUrl")}},{key:"getVolume",value:function(){return this.get("volume")}},{key:"setVolume",value:function(e){return this.set("volume",e)}}])&&a(t.prototype,i),n&&a(t,n),e}();n||(A=function(){var e=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=t.length,a={};i<r;i++)if((e=t[i])&&e[1]in document){for(i=0;i<e.length;i++)a[t[0][i]]=e[i];return a}return!1}(),t={fullscreenchange:e.fullscreenchange,fullscreenerror:e.fullscreenerror},i={request:function(t){return new Promise((function(r,a){var n=function e(){i.off("fullscreenchange",e),r()};i.on("fullscreenchange",n);var s=(t=t||document.documentElement)[e.requestFullscreen]();s instanceof Promise&&s.then(n).catch(a)}))},exit:function(){return new Promise((function(t,r){if(i.isFullscreen){var a=function e(){i.off("fullscreenchange",e),t()};i.on("fullscreenchange",a);var n=document[e.exitFullscreen]();n instanceof Promise&&n.then(a).catch(r)}else t()}))},on:function(e,i){var r=t[e];r&&document.addEventListener(r,i)},off:function(e,i){var r=t[e];r&&document.removeEventListener(r,i)}};return Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(document[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[e.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[e.fullscreenEnabled])}}}),i}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=[].slice.call(e.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),i=function(e){"console"in window&&console.error&&console.error("There was an error creating an embed: ".concat(e))};t.forEach((function(e){try{if(null!==e.getAttribute("data-vimeo-defer"))return;var t=S(e);C(h(t),t,e).then((function(t){return M(t,e)})).catch(i)}catch(e){i(e)}}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoPlayerResizeEmbeds_){window.VimeoPlayerResizeEmbeds_=!0;var t=function(t){if(d(t.origin)&&t.data&&"spacechange"===t.data.event)for(var i=e.querySelectorAll("iframe"),r=0;r<i.length;r++)if(i[r].contentWindow===t.source){i[r].parentElement.style.paddingBottom="".concat(t.data.data[0].bottom,"px");break}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoSeoMetadataAppended){window.VimeoSeoMetadataAppended=!0;var t=function(t){if(d(t.origin)){var i=P(t.data);if(i&&"ready"===i.event)for(var r=e.querySelectorAll("iframe"),a=0;a<r.length;a++){var n=r[a],s=n.contentWindow===t.source;if(u(n.src)&&s)new R(n).callMethod("appendVideoMetadata",window.location.href)}}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoCheckedUrlTimeParam){window.VimeoCheckedUrlTimeParam=!0;var t=function(e){"console"in window&&console.error&&console.error("There was an error getting video Id: ".concat(e))},i=function(i){if(d(i.origin)){var r=P(i.data);if(r&&"ready"===r.event)for(var a=e.querySelectorAll("iframe"),n=0;n<a.length;n++){var s=a[n],o=s.contentWindow===i.source;u(s.src)&&o&&function(){var e=new R(s);e.getVideoId().then((function(t){var i=new RegExp("[?&]vimeo_t_".concat(t,"=([^&#]*)")).exec(window.location.href);if(i&&i[1]){var r=decodeURI(i[1]);e.setCurrentTime(r)}})).catch(t)}()}}};window.addEventListener("message",i)}}()),t.a=R}).call(this,i(0),i(3).setImmediate)},,function(e,t,i){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,a=Function.prototype.apply;function n(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new n(a.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new n(a.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(4),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i(0))},function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var r,a,n,s,o,l=1,d={},u=!1,h=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){n.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(a=h.documentElement,r=function(e){var t=h.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,a.removeChild(t),t=null},a.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(s="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&p(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(s+t,"*")}),c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var a={callback:e,args:t};return d[l]=a,r(l),l++},c.clearImmediate=m}function m(e){delete d[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=d[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(void 0,i)}}(t)}finally{m(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,i(0),i(5))},function(e,t){var i,r,a=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(i===setTimeout)return setTimeout(e,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:n}catch(e){i=n}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l,d=[],u=!1,h=-1;function c(){u&&l&&(u=!1,l.length?d=l.concat(d):h=-1,d.length&&m())}function m(){if(!u){var e=o(c);u=!0;for(var t=d.length;t;){for(l=d,d=[];++h<t;)l&&l[h].run();h=-1,t=d.length}l=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new p(e,t)),1!==d.length||u||o(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=f,a.addListener=f,a.once=f,a.off=f,a.removeListener=f,a.removeAllListeners=f,a.emit=f,a.prependListener=f,a.prependOnceListener=f,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,i){"use strict";i.r(t),i.d(t,"videoManagerFactoryGlobal",(function(){return _}));let r={info(e,t){},warn(e,t){},error(e,t){}};function a(e,t,i,r){return new(i||(i=Promise))((function(a,n){function s(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}Object.create;Object.create;const n="Content-Type",s="application/json; charset=utf-8",o="X-Correlation-Id",l="Accept-Language",d="Authorization",u={YouTube:["https://(\\w+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist)\\?.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist)\\?.*","https://(\\w+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist)\\?.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com/gif.*","https://youtu\\.be/.*"],Vimeo:["https://(\\w+\\.)?(player\\.)?vimeo\\.com/.*"],Flip:["https://(\\w+\\.)?flipgrid\\.com/s/.*","https://(\\w+\\.)?flip\\.com/s/.*","https://(\\w+\\.)?shorts\\.flipgrid\\.com/watch/.*","https://(\\w+\\.)?shorts\\.flip\\.com/watch/.*"],StreamClassic:["https://(\\w+\\.)?microsoftstream\\.com/embed/video/.*","https://(\\w+\\.)?microsoftstream\\.com/video/.*"],Ted:["https://embed\\.ted\\.com/talks/.*","https://www\\.ted\\.com/talks/.*","https://www\\.ted\\.com/index\\.php/talks/.*\\.html.*"],SlideShare:["https://(\\w+\\.)?slideshare\\.net/.*"]};function h(e,t){Object.assign(e.style,t)}function c(e){h(e,{zIndex:"6",pointerEvents:"all",position:"absolute",objectFit:"fill",height:"100%",width:"100%"})}class m{constructor(){this.rateChanges=0,this.volumeChanges=0,this.plays=0,this.seeks=0,this.stalls=0,this.totalBufferingTimeMs=0,this.totalPlayingTimeMs=0}}class p{constructor(e,t,i,r,a){this.perfSummary=new m,this.shouldUseLocalTelemetry=a,this.pageLoadingTime=Date.now(),this.isDesignerElement=i,this.mediaProperties=r,this.player=this.createLocalPlayer(e,t,i),void 0!==this.shouldUseLocalTelemetry&&this.shouldUseLocalTelemetry&&this.createPerfTelemetry()}logSummary(){return a(this,void 0,void 0,(function*(){}))}play(){return a(this,void 0,void 0,(function*(){try{yield this.player.play()}catch(e){r.info(541882e3,"Error local video play")}r.info(520378572,"Local.play: this.player.paused: "+this.player.paused)}))}pause(){this.player.pause()}setVisible(){!0===this.isDesignerElement&&(this.player.loop=!0),this.player.style.visibility="visible",this.setFocus()}setHidden(){!0===this.isDesignerElement&&(this.player.loop=!1,this.player.autoplay=!1),this.player.style.pointerEvents="none",this.player.style.visibility="hidden"}stop(){this.player.pause(),this.player.currentTime=0,void 0!==this.shouldUseLocalTelemetry&&this.shouldUseLocalTelemetry&&this.logPerfSummary()}togglePause(){return a(this,void 0,void 0,(function*(){if(r.info(520378573,"Local.togglePause: Before toggle, this.player.paused: "+this.player.paused),this.player.paused)try{yield this.play()}catch(e){r.info(541882001,"Error local video play while toggle pause")}else this.pause();r.info(520378574,"Local.togglePause: After toggle, this.player.paused: "+this.player.paused)}))}getPlayer(){return this.player}getCurrentTime(){}getDuration(){}seekTo(e){}ensureMediaClient(){}setMute(){}setUnMute(){}setVolume(e){}logPerfSummary(){this.updateTotalBufferingTime(),this.updateTotalPlayingTime(),0===this.perfSummary.totalBufferingTimeMs&&0===this.perfSummary.totalPlayingTimeMs&&void 0===this.perfSummary.errorCode||(this.perfSummary.durationMs=Math.round(1e3*this.player.duration),this.perfSummary.width=this.player.videoWidth,this.perfSummary.height=this.player.videoHeight,this.perfSummary.hasControls=this.player.controls,this.perfSummary.isAutoplay=this.player.autoplay,this.perfSummary.isLoop=this.player.loop,this.perfSummary.lastRate=this.player.playbackRate,this.perfSummary.lastVolume=Math.round(100*this.player.volume),this.perfSummary.lastIsMuted=this.player.muted,r.info(541882002,"EmbeddedPlayback "+JSON.stringify(this.perfSummary)),this.perfSummary.totalBufferingTimeMs=0,this.perfSummary.totalPlayingTimeMs=0,this.perfSummary.errorCode=void 0)}createPerfTelemetry(){this.player.addEventListener("loadstart",()=>{void 0===this.perfSummary.timeToLoadStartMs&&(this.perfSummary.timeToLoadStartMs=Date.now()-this.pageLoadingTime)}),this.player.addEventListener("canplay",()=>{void 0===this.perfSummary.timeToInteractivityMs&&(this.perfSummary.timeToInteractivityMs=Date.now()-this.pageLoadingTime)}),this.player.addEventListener("play",()=>{this.lastPlayTime=Date.now(),this.perfSummary.plays+=1}),this.player.addEventListener("playing",()=>{this.lastPlayingTime=Date.now(),void 0===this.perfSummary.timeToPlayingMs&&void 0!==this.lastPlayTime&&(this.perfSummary.timeToPlayingMs=this.lastPlayingTime-this.lastPlayTime),this.updateTotalBufferingTime()}),this.player.addEventListener("waiting",()=>{this.lastWaitingTime=Date.now(),this.updateTotalPlayingTime()}),this.player.addEventListener("pause",()=>{this.updateTotalBufferingTime(),this.updateTotalPlayingTime()}),this.player.addEventListener("seeking",()=>{this.perfSummary.seeks+=1}),this.player.addEventListener("stalled",()=>{this.perfSummary.stalls+=1}),this.player.addEventListener("ended",()=>{this.perfSummary.isPlayedUntilEnd=!0}),this.player.addEventListener("ratechange",()=>{this.perfSummary.rateChanges+=1}),this.player.addEventListener("volumechange",()=>{this.perfSummary.volumeChanges+=1}),this.player.addEventListener("error",()=>{this.updateTotalBufferingTime(),this.updateTotalPlayingTime(),void 0===this.perfSummary.errorCode&&null!==this.player.error&&(this.perfSummary.errorCode=this.player.error.code)}),this.player.addEventListener("abort",()=>{this.updateTotalBufferingTime(),this.updateTotalPlayingTime(),this.perfSummary.wasAborted=!0})}updateTotalBufferingTime(){void 0!==this.lastWaitingTime&&(this.perfSummary.totalBufferingTimeMs+=Date.now()-this.lastWaitingTime,this.lastWaitingTime=void 0)}updateTotalPlayingTime(){void 0!==this.lastPlayingTime&&(this.perfSummary.totalPlayingTimeMs+=Date.now()-this.lastPlayingTime,this.lastPlayingTime=void 0)}setFocus(){void 0!==this.player&&this.player.focus()}seekToTrimStartIfNeeded(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&(this.player.currentTime<this.mediaProperties.trimStartSec||this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec)&&(this.player.currentTime=this.mediaProperties.trimStartSec)}onTimeUpdate(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec&&(this.player.pause(),this.player.currentTime=this.mediaProperties.trimmedEndTimeSec)}isTrimValid(){return void 0!==this.mediaProperties.durationSec&&(this.mediaProperties.trimStartSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimEndSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec+this.mediaProperties.trimEndSec<this.mediaProperties.durationSec)}setTrim(e){void 0===e||isNaN(e.duration)||(this.mediaProperties.durationSec=e.duration,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec-this.mediaProperties.trimEndSec,this.isTrimValid()?(e.addEventListener("timeupdate",()=>{this.onTimeUpdate()}),e.addEventListener("play",()=>{this.seekToTrimStartIfNeeded()})):(this.mediaProperties.trimStartSec=0,this.mediaProperties.trimEndSec=0,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec))}createLocalPlayer(e,t,i){const r=document.createElement("video");return r.controls=!0,r.setAttribute("disablePictureInPicture","true"),r.setAttribute("controlsList","nodownload nofullscreen noremoteplayback"),r.src=t,e.appendChild(r),r.autoplay=!0,r.style.visibility=i?"hidden":"visible",c(r),i?(r.loop=!0,r.muted=!0,r.addEventListener("canplay",()=>{r.style.visibility="visible"},{once:!0})):this.setFocus(),(this.mediaProperties.trimStartSec>0||this.mediaProperties.trimEndSec>0)&&r.addEventListener("loadedmetadata",()=>{this.setTrim(r)},{once:!0}),r}}class f{constructor(e,t){this.playButton=t,this.parent=e}setPlayButtonVisible(){this.isPlayButtonBiggerThanParent()||(this.playButton.style.display="block",this.playButton.style.pointerEvents="visible")}setPlayButtonHidden(){this.playButton.style.display="none"}updatePlayButtonVisibility(){this.isPlayButtonBiggerThanParent()?this.setPlayButtonHidden():(this.playButton.style.display="block",this.playButton.style.pointerEvents="visible")}onSelectPlayButton(){if(void 0===this.shapeOverlayElement&&this.findShapeSelectionOverlay(),void 0!==this.shapeOverlayElement){const e=parseFloat(this.parent.style.left)+parseFloat(this.parent.style.width)/2-28.3,t=parseFloat(this.parent.style.top)+parseFloat(this.parent.style.height)/2-28.3;this.playButton.style.top=t+"px",this.playButton.style.left=e+"px",this.shapeOverlayElement.appendChild(this.playButton)}}onDeSelectPlayButton(){this.playButton.style.top="calc(50% - 28.3px)",this.playButton.style.left="calc(50% - 28.3px)",this.parent.appendChild(this.playButton)}findShapeSelectionOverlay(){null!==this.parent.parentElement&&void 0!==this.parent.parentElement.getElementsByClassName("ShapeSelectionOverlay")[0]?this.shapeOverlayElement=this.parent.parentElement.getElementsByClassName("ShapeSelectionOverlay")[0]:this.shapeOverlayElement=void 0}isPlayButtonBiggerThanParent(){return 56.6>parseFloat(this.parent.style.width)||56.6>parseFloat(this.parent.style.height)}}function y(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}class v{constructor(e,t,i,a,n,s,o,l){this.appSettings=o,this.isPlaying=!1,this.isNativeVideo=a,this.isDesignerElement=n,this.parent=e,this.url=t,this.videoToolTip=i,this.videoLibraryCallback=s,this.playButton=this.createPlayButton(),this.playButtonHandler=new f(this.parent,this.playButton),this.createOnlineClient=l,r.info(541882006,"Video Element Count"),this.isDesignerElement&&this.startPlaying()}setPlayButtonHidden(){void 0!==this.playButtonHandler&&this.playButtonHandler.setPlayButtonHidden()}updatePlayButtonVisibility(){this.isPlaying||void 0===this.playButtonHandler||this.playButtonHandler.updatePlayButtonVisibility()}setPlayButtonVisible(){this.isPlaying||void 0===this.playButtonHandler||this.playButtonHandler.setPlayButtonVisible()}startPlaying(){if(this.isNativeVideo&&""===this.url)return this.setPlayButtonHidden(),this.isPlaying=!0,void this.videoLibraryCallback.fetchLocalVideoSrc();void 0===this.client?this.createClient(this.url):this.isPlaying||(this.client.setVisible(),this.client.play(),this.setDefaultStyles()),void 0!==this.client&&(this.isPlaying=!0),r.info(541882007,"Video Play Count"),this.setPlayButtonHidden()}stopPlaying(){void 0!==this.client&&(this.client.setHidden(),this.isPlaying&&this.client.stop(),this.isNativeVideo||void 0===this.client.getPerfData||r.info(509384070,"OnlineVideoPlayback Summary: "+JSON.stringify(this.client.getPerfData())),this.isPlaying=!1)}hasClient(){return void 0!==this.client}setLocalVideoSrc(e){this.url=e,(this.videoLibraryCallback.isSelected()||this.isDesignerElement)&&this.startPlaying()}onSelectPlayButton(){void 0!==this.playButtonHandler&&this.playButtonHandler.onSelectPlayButton()}onDeSelectPlayButton(){void 0!==this.playButtonHandler&&this.playButtonHandler.onDeSelectPlayButton()}dispose(){null!==this.playButton&&void 0!==this.playButton&&null!==this.playButton.parentNode&&void 0!==this.playButton.parentNode&&this.playButton.parentNode.removeChild(this.playButton)}setDefaultStyles(){if(void 0!==this.client){const e=this.client.getPlayer();void 0!==e&&c(e)}}createClient(e){try{if(this.isNativeVideo)this.client=new p(this.parent,e,this.isDesignerElement,void 0!==this.videoLibraryCallback?void 0!==(t=this.videoLibraryCallback.getMediaProperties())?{trimStartSec:void 0!==t.trimStartSec?t.trimStartSec:0,trimEndSec:void 0!==t.trimEndSec?t.trimEndSec:0,volume:void 0!==t.volume?t.volume:.8,mute:void 0!==t.mute&&t.mute,repeat:void 0!==t.repeat&&t.repeat,rewind:void 0!==t.rewind&&t.rewind,playAcrossSlides:void 0!==t.playAcrossSlides&&t.playAcrossSlides,hideDuringShow:void 0!==t.hideDuringShow&&t.hideDuringShow,startOption:void 0!==t.startOption?t.startOption:"NYI",trimmedEndTimeSec:void 0,durationSec:void 0}:{trimStartSec:0,trimEndSec:0,volume:.8,mute:!1,repeat:!1,rewind:!1,playAcrossSlides:!1,hideDuringShow:!1,startOption:"NYI",trimmedEndTimeSec:void 0,durationSec:void 0}:{trimStartSec:0,trimEndSec:0,volume:.8,mute:!1,repeat:!1,rewind:!1,playAcrossSlides:!1,hideDuringShow:!1,startOption:"NYI",trimmedEndTimeSec:void 0,durationSec:void 0},this.appSettings.useNewLocalTelemetry);else{if(void 0===this.createOnlineClient)throw new Error("Non native video not supported.");this.appSettings.CapturePerfData=!0,this.appSettings.LoadYouTubePlayerScriptInClient=!0,this.client=this.createOnlineClient(e,this.parent,this.appSettings,void 0,()=>this.onClientReady())}const i=this.client.getPlayer();void 0!==i&&i.setAttribute("title",this.videoToolTip),r.info(541882009,"Success VideoManager")}catch(e){r.info(541882008,"Error VideoManager: "+e)}var t}onClientReady(){void 0!==this.client&&this.client.play()}playButtonOnClick(e){void 0!==e&&(e.stopImmediatePropagation(),e.preventDefault()),this.videoLibraryCallback.selectShape(),this.startPlaying()}createPlayButton(){const e=function(){const e=y("svg");e.setAttribute("viewBox","-1 -1 2 2"),h(e,{height:"56.6px",width:"56.6px",position:"absolute",zIndex:"6",top:"calc(50% - 28.3px)",left:"calc(50% - 28.3px)",cursor:"pointer",pointerEvents:"all"});const t=y("circle");t.setAttribute("cx","0"),t.setAttribute("cy","0"),t.setAttribute("r","1"),t.setAttribute("fill","#404040");const i=y("path");return i.setAttribute("d","M.5 0 L-.25 -.5 L-.25 .5 Z"),i.setAttribute("fill","none"),i.setAttribute("stroke","white"),i.setAttribute("stroke-width",".05"),i.setAttribute("opacity",".5"),e.appendChild(t),e.appendChild(i),e}();return e.addEventListener("click",e=>this.playButtonOnClick(e),!1),this.isDesignerElement&&e.setAttribute("visibility","hidden"),this.parent.appendChild(e),e}}class g{constructor(e,t){this.url=e,this.iFrame=document.createElement("iframe"),this.iFrame.src=e,this.iFrame.setAttribute("frameBorder","0"),this.iFrame.setAttribute("allow","autoplay"),c(this.iFrame),this.iFrame.addEventListener("load",()=>{null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}),t.appendChild(this.iFrame)}play(){""===this.iFrame.src&&(this.iFrame.src=this.url),this.setFocus()}pause(){}stop(){this.iFrame.src=""}togglePause(){}setVisible(){this.iFrame.style.visibility="visible"}setHidden(){this.iFrame.style.visibility="hidden",this.iFrame.style.pointerEvents="none"}getPlayer(){return this.iFrame}getCurrentTime(){}getDuration(){}seekTo(e){}ensureMediaClient(){}setFocus(){null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}}class T{constructor(e,t,i,r,a){this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.onMessage=e=>{e.origin===this.url.origin&&void 0!==this.flipIFrame&&this.flipIFrame.contentWindow===e.source&&(this.handlePlayerEvent(e),void 0!==this.perfTracker&&this.capturePlayerPerf(e))},this.url=new URL(e),this.parent=t,this.perfTracker=i,this.onReadyCallback=r,this.onMediaEventCallback=a,this.url.searchParams.set("options","messaging"),this.init()}play(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-play",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}pause(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-pause",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}stop(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-stop",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}togglePause(){this.paused?this.play():this.pause()}setVisible(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="visible")}setHidden(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="hidden")}getPlayer(){return this.flipIFrame}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}seekTo(e){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const t=this.getMessage("fg-wvp-seek",{time:e});this.flipIFrame.contentWindow.postMessage(t,this.url.origin)}}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}isPaused(){return this.paused}cleanUpMediaClient(){void 0!==this.flipIFrame&&this.flipIFrame.remove(),this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.flipIFrame=void 0,window.removeEventListener("message",this.onMessage),void 0!==this.perfTracker&&this.perfTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}init(){this.flipIFrame=document.createElement("iframe"),this.flipIFrame.src=this.url.toString(),this.setProperties(this.flipIFrame),this.parent.append(this.flipIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),c(e),e.style.border="0px",this.setVisible())}handlePlayerEvent(e){switch(e.data.name){case"fg-wvp-onReady":case"fg-wvp-onInitialReady":if(this.isFirstReady){if(this.isFirstReady=!1,void 0===this.duration&&void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-getDuration",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}void 0!==this.onReadyCallback&&this.onReadyCallback()}break;case"fg-wvp-onPlay":this.paused=!1,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1);break;case"fg-wvp-onPause":this.paused=!0,(void 0===this.duration||this.currentTime<this.duration)&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0);break;case"fg-wvp-onSeek":void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"fg-wvp-onTimeUpdate":this.currentTime=e.data.data.currentTime;break;case"fg-wvp-onBuffering":break;case"fg-wvp-onEnded":this.paused=!0,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6);break;case"fg-wvp-onError":r.error(554230686,"Flipgrid player entered error state "+e.data.data.error);break;case"fg-wvp-getDurationResult":this.duration=e.data.data.duration;break;case"fg-wvp-getCurrentTimeResult":this.currentTime=e.data.data.currentTime}}capturePlayerPerf(e){const t=e.data.name;if(void 0!==this.perfTracker)switch(t){case"fg-wvp-onReady":this.perfTracker.onReady(),void 0!==this.duration&&this.perfTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.perfTracker.onPlaying();break;case"fg-wvp-onPause":this.perfTracker.onPause();break;case"fg-wvp-onSeek":this.perfTracker.onSeeked();break;case"fg-wvp-onEnded":this.perfTracker.onEnded();break;case"fg-wvp-onError":const t="Flipgrid player entered error state "+e.data.data.error;this.perfTracker.onError(t,!0)}}getMessage(e,t){return{name:e,data:t}}}class b{constructor(e,t,i,a,n,s,o){this.paused=!0,this.currentTime=0,this.onMessage=e=>{if(this.url.origin===e.origin&&void 0!==this.streamIFrame&&this.streamIFrame.contentWindow===e.source)switch(e.data.name){case"initializestreamconnection":r.info(553940224,"StreamAuth: Received handshake request");let t=!1;if(void 0!==this.streamIFrame){const i=this.streamIFrame.contentWindow;if(null!==i){const r=e.data;r.result=!0,i.postMessage(r,e.origin),t=!0}}t||r.info(555017826,"StreamAuth: Received handshake request, but unable to reply");break;case"getstreamtoken":r.info(553940225,"StreamAuth: Received auth request");const i=e.data,a=e.origin;this.streamAuthContext={messageObj:i,origin:a},void 0!==this.onTokenRequestCallback?(this.onTokenRequestCallback(i.eventData.resourceId),r.info(572846686,"StreamAuth: Triggered authTokenRequestor to forward Token request upward for Host to fulfill")):r.info(553935756,"StreamAuth: authTokenRequestor unavailable, auth pipeline won't be triggered");break;case"signinevent":case"loaddata":break;case"playerevent":this.handlePlayerEvent(e),this.trackPlayerPerf(e)}},this.url=new URL(e),this.parent=t,this.appSettings=i,this.perfTracker=a,this.onReadyCallback=n,this.onMediaEventCallback=s,this.onTokenRequestCallback=o,void 0!==i.App&&this.url.searchParams.set("app",i.App),void 0!==i.AppPlatform&&this.url.searchParams.set("appPlatform",i.AppPlatform),void 0!==i.AppCorrelation&&this.url.searchParams.set("appCorrelation",i.AppCorrelation),this.url.searchParams.set("thinEmbed","true"),this.init()}play(){const e=this.getMessage("playerfunction","play");this.sendMessage(e)}pause(){const e=this.getMessage("playerfunction","pause");this.sendMessage(e)}stop(){this.pause(),this.seekTo(0)}togglePause(){this.paused?this.play():this.pause()}getPlayer(){return this.streamIFrame}isPaused(){return this.paused}getCurrentTime(){return this.currentTime}getDuration(){}seekTo(e){const t=this.getMessage("playerfunction","setplaytime",e.toString());this.sendMessage(t)}setVisible(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="visible")}setHidden(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="hidden")}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.streamIFrame&&this.streamIFrame.remove(),this.paused=!0,this.currentTime=0,this.streamIFrame=void 0,window.removeEventListener("message",this.onMessage),void 0!==this.perfTracker&&this.perfTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}postAuthToken(e){if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;null!==t&&void 0!==this.streamAuthContext?(this.streamAuthContext.messageObj.eventData.token=e,this.streamAuthContext.messageObj.result=!0,t.postMessage(this.streamAuthContext.messageObj,this.streamAuthContext.origin),r.info(572846115,"StreamAuth: Posted Aad Token back to Stream Player")):r.error(572846144,"StreamAuth: Got a Stream iframe but unable to get ContentWindow or cached Context")}}init(){this.streamIFrame=document.createElement("iframe"),this.streamIFrame.src=this.url.toString(),this.setProperties(this.streamIFrame),this.parent.append(this.streamIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),c(e),e.style.border="0px",this.setVisible())}handlePlayerEvent(e){const t=e.data.eventData.eventname;if(void 0!==this.onMediaEventCallback){switch(t){case"play":this.onMediaEventCallback(1);break;case"playing":this.paused=!1,this.onMediaEventCallback(1);break;case"pause":this.paused=!0,this.onMediaEventCallback(0);break;case"ready":void 0!==this.onReadyCallback&&this.onReadyCallback();break;case"timeupdate":{const t=this.currentTime;this.currentTime=e.data.eventData.time,void 0!==this.currentTime&&void 0!==this.appSettings.SeekToTimeThreshold&&Math.abs(this.currentTime-t)>this.appSettings.SeekToTimeThreshold&&this.onMediaEventCallback(3);break}case"error":r.error(538039177,`Stream media error: ${e.data.eventData.errorcode}, message: ${e.data.eventData.message}`)}r.info(576582675,"Stream Media Event: "+t)}}trackPlayerPerf(e){if(void 0!==this.perfTracker){const t=e.data.eventData.eventname,i=e.data.eventData.message;switch(t){case"play":this.perfTracker.onPlay();break;case"playing":this.perfTracker.onPlaying();break;case"pause":this.perfTracker.onPause();break;case"ready":this.perfTracker.onReady();break;case"error":void 0!==i&&this.perfTracker.onError(i,!0)}}}getMessage(e,t,i){return void 0!==i?{name:e,methodData:{methodname:t,data:i}}:{name:e,methodData:{methodname:t}}}sendMessage(e){void 0!==this.streamIFrame&&null!==this.streamIFrame.contentWindow&&(r.info(528623694,`sendMessage: Calling postMessage with: msg = ${JSON.stringify(e)}, target = ${this.streamIFrame.src}`),this.streamIFrame.contentWindow.postMessage(e,this.streamIFrame.src))}}function P(e,t){const i=new Headers;return void 0!==e.AppCorrelation&&i.set(o,e.AppCorrelation),void 0!==e.AcceptLanguage&&i.set(l,e.AcceptLanguage),void 0!==t&&i.set(d,t),i.set(n,s),i}var w,k=new Uint8Array(16);function E(){if(!w&&!(w="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return w(k)}var S=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var M=function(e){return"string"==typeof e&&S.test(e)},C=[],F=0;F<256;++F)C.push((F+256).toString(16).substr(1));var I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]).toLowerCase();if(!M(i))throw TypeError("Stringified UUID is invalid");return i};var A=function(e,t,i){var r=(e=e||{}).random||(e.rng||E)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(var a=0;a<16;++a)t[i+a]=r[a];return t}return I(r)};class R{constructor(e,t,i,a,n,s,o){this.paused=!0,this.currentTime=0,this.isIFrameLoaded=!1,this.initPostMessageCommunication=e=>{if(void 0!==this.embedURL&&e.origin===this.embedURL.origin)try{"initialize"===e.data.type&&e.data.channelId===this.channelId&&(e.data.replyTo.onmessage=e=>this.onMessage(e),e.data.replyTo.postMessage({type:"activate"}),this.messagePort=e.data.replyTo,void 0!==this.playerPerf&&this.playerPerf.onPostMessagingInitialized())}catch(e){void 0!==this.playerPerf&&this.playerPerf.onError(`Post Messaging Error - Error initializing communication channel (${e})`,!0)}else r.warn(509437538,"Received post message from unidentified source")},this.videoUrl=e,this.appSettings=i,this.parentElement=t,this.playerPerf=a,this.onReadyCallback=n,this.onMediaEventCallback=s,R.onTokenRequestCallback=o,void 0!==i.MaxAADTokenWaitingTime&&(R.tokenRequestWaitingTime=i.MaxAADTokenWaitingTime),this.init()}static setAADTokenForWaitingClients(e){for(const t of R.clientsWaitingForToken)t.setAADToken(e);clearTimeout(R.tokenRequestTimeout),R.clientsWaitingForToken.clear(),R.tokenRequestTimeout=void 0}static requestAADToken(e=3){if(void 0===R.tokenRequestTimeout)if(e>0&&void 0!==R.onTokenRequestCallback)R.tokenRequestTimeout=window.setTimeout(()=>{R.tokenRequestTimeout=void 0,R.requestAADToken(e-1)},R.tokenRequestWaitingTime),R.onTokenRequestCallback("84a0e9dd-6e58-4aad-82af-ebe485acd09d");else{for(const e of R.clientsWaitingForToken)void 0!==e.playerPerf&&e.playerPerf.onError(`AAD Token Request Error - No token was received after ${3*R.tokenRequestWaitingTime}ms`);R.clientsWaitingForToken.clear()}}play(){this.postMessage({command:"one-player-play"}),this.setFocus()}pause(){this.postMessage({command:"one-player-pause"})}stop(){this.postMessage({command:"one-player-stop"})}seekTo(e){this.postMessage({command:"one-player-seek",position:e})}togglePause(){this.paused?this.play():this.pause()}setMute(){!0!==this.muted&&this.postMessage({command:"one-player-mute"})}setUnMute(){!1!==this.muted&&this.postMessage({command:"one-player-unmute"})}setVolume(e){this.postMessage({command:"one-player-set-volume",volumeLevel:e})}getVolume(){return this.volume}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){R.clientsWaitingForToken.delete(this),0===R.clientsWaitingForToken.size&&void 0!==R.tokenRequestTimeout&&(clearTimeout(R.tokenRequestTimeout),R.tokenRequestTimeout=void 0),void 0!==this.stream2iFrame&&this.stream2iFrame.remove(),this.paused=!0,this.currentTime=0,this.muted=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.messagePort=void 0,this.stream2iFrame=void 0,this.oEmbedResponseTimeStamp=void 0,this.channelId=void 0,this.isIFrameLoaded=!1,this.embedURL=void 0,window.removeEventListener("message",this.initPostMessageCommunication),void 0!==this.playerPerf&&this.playerPerf.cleanup()}isPaused(){return this.paused}isMuted(){return this.muted}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}setVisible(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="visible")}setHidden(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="hidden")}getPlayer(){return this.stream2iFrame}getPerfData(){if(void 0!==this.playerPerf)return this.playerPerf.getPerfData()}setAADToken(e){void 0!==this.playerPerf&&this.playerPerf.onAADTokenSet(),void 0===this.stream2iFrame&&this.initOnePlayer(e)}postMessage(e){void 0!==this.messagePort?this.messagePort.postMessage({type:"command",id:0,data:e}):void 0!==this.playerPerf&&this.playerPerf.onError(`Post Messaging Error - Failed to send "${e.command}" postmessage (undefined message port)`)}onMessage(e){const t=e.data.type;if("notification"===t)this.handleNotificationMessage(e.data);else if("result"===t)this.handleResultMessage(e.data);else if("command"===t){const t=e.data;r.info(509215636,`Received command postmessage (command: ${t.data.command})`)}else"acknowledge"===t||r.warn(509219079,`Received unrecognized postmessage (type: ${t})`)}handleResultMessage(e){if("error"!==e.data.result)void 0!==e.data.durationInSeconds?(this.duration=e.data.durationInSeconds,void 0!==this.playerPerf&&this.playerPerf.setDuration(this.duration)):void 0!==e.data.volume?(this.volume=e.data.volume,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playerPerf&&this.playerPerf.setVolume(this.volume)):void 0!==e.data.isMute?(this.muted=e.data.isMute,void 0!==this.playerPerf&&this.playerPerf.setMute(this.muted)):r.warn(509215635,`Unrecognized result type received (type: ${e.data.result})`);else{const t=e.data;r.error(509437569,`Post Messaging Error - Result: ${t.error.code} (${t.error.message})`)}}handleNotificationMessage(e){switch(e.data.notification){case"one-player-player-ready":e.data.isReady&&(this.postMessage({command:"one-player-get-duration"}),this.postMessage({command:"one-player-get-volume"}),this.postMessage({command:"one-player-get-mute"}),void 0!==this.onReadyCallback&&this.onReadyCallback(),void 0!==this.playerPerf&&this.playerPerf.onReady());break;case"one-player-play-state":const t=e.data.playState;this.onPlayStateChanged(t);break;case"one-player-current-time":this.currentTime=e.data.currentTime;break;case"one-player-muted":if(this.muted=e.data.isMuted,!this.muted){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.022))}void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playerPerf&&this.playerPerf.onMuteChanged(this.muted);break;case"one-player-volume":this.volume=e.data.volume,0===this.volume?this.setMute():this.lastNonZeroVolume=this.volume,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playerPerf&&this.playerPerf.onVolumeChanged(this.volume);break;case"error":if(void 0!==this.playerPerf){const t=e.data.error;this.playerPerf.onError(`Post Messaging Error - Notification: ${t.code} (${t.message})`,!0)}break;default:r.warn(509437568,`Unrecognized notification type received (type: ${e.data.notification})`)}}onPlayStateChanged(e){this.paused="Playing"!==e,"Playing"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1),void 0!==this.playerPerf&&this.playerPerf.onPlaying()):"Paused"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0),void 0!==this.playerPerf&&this.playerPerf.onPause()):"Ended"===e&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6),void 0!==this.playerPerf&&this.playerPerf.onEnded())}init(){if(!0!==this.appSettings.GetAADTokenFromTeams)this.initOnePlayer("");else{if(void 0===R.onTokenRequestCallback)return void(void 0!==this.playerPerf&&this.playerPerf.onError("AAD Token Request Error - onTokenRequestCallback is undefined",!0));R.clientsWaitingForToken.add(this),R.requestAADToken()}}initOnePlayer(e){this.initOEmbedIFrame(e).then(()=>{window.addEventListener("message",this.initPostMessageCommunication)}).catch(e=>{void 0!==this.playerPerf&&this.playerPerf.onError(`Init iFrame Error - Error creating iFrame from OEmbed response (${e})`)})}initOEmbedIFrame(e){return a(this,void 0,void 0,(function*(){let t;try{t=yield function(e,t,i){return a(this,void 0,void 0,(function*(){if(void 0===e.HubbleVideoEndpoint)throw Error("No Hubble OEmbed endpoint available");const r=P(e,i),n=new URL(e.HubbleVideoEndpoint);return n.pathname="/mediasvc/api/media/oembed",void 0!==e.App&&n.searchParams.set("app",e.App),void 0!==e.AppPlatform&&n.searchParams.set("platform",e.AppPlatform),n.searchParams.set("url",t),fetch(n.toString(),{method:"GET",headers:r}).then(e=>a(this,void 0,void 0,(function*(){const t=yield e.json();if(!e.ok){let i="status: "+e.status;throw void 0!==t.Error&&void 0!==t.Error.Message&&(i+=", message: "+t.Error.Message),Error(i)}return t})))}))}(this.appSettings,this.videoUrl,e)}catch(e){return void(void 0!==this.playerPerf&&this.playerPerf.onError("OEmbed Request Error - "+e.message,!0))}if(void 0!==this.playerPerf&&this.playerPerf.onOEmbedResponse(),void 0===t.embed_url)return void(void 0!==this.playerPerf&&this.playerPerf.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0));this.oEmbedResponseTimeStamp=Date.now(),this.stream2iFrame=document.createElement("iframe"),this.embedURL=new URL(t.embed_url),this.setProperties(this.stream2iFrame,this.embedURL.toString());const i=this.embedURL.searchParams.get("access_token");null!==i&&(this.embedURL.searchParams.delete("access_token"),this.embedURL.searchParams.set("auth","readwrite"),this.channelId=A(),this.embedURL.searchParams.set("origin",new URL(location.href).origin),this.embedURL.searchParams.set("channelId",this.channelId),this.embedURL.searchParams.set("embed",JSON.stringify({hp:"Web",hv:"edit",hm:"view",ha:this.appSettings.App})),this.stream2iFrame.addEventListener("load",()=>{if(!this.isIFrameLoaded)if(void 0===this.oEmbedResponseTimeStamp||Date.now()-this.oEmbedResponseTimeStamp>=24e4)this.ensureMediaClient();else if(void 0!==this.embedURL){void 0!==this.playerPerf&&this.playerPerf.onIFrameLoad();const e=new URL(this.videoUrl).searchParams.get("nav");null!==e&&this.embedURL.searchParams.set("nav",e),void 0!==this.stream2iFrame&&null!==this.stream2iFrame.contentWindow&&(this.navigateToEmbedURL(this.stream2iFrame.contentWindow,this.embedURL,i),this.isIFrameLoaded=!0)}}),this.parentElement.append(this.stream2iFrame))}))}navigateToEmbedURL(e,t,i){const r=e.document.createElement("form");r.setAttribute("action",t.toString()),r.setAttribute("method","POST");const a=e.document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name","access_token"),a.setAttribute("value",i),r.appendChild(a),e.document.body.appendChild(r),r.submit()}setProperties(e,t){e.setAttribute("allow","autoplay "+t),e.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-forms allow-top-navigation-by-user-activation"),c(e),e.style.border="0px",this.setVisible()}setFocus(){void 0!==this.stream2iFrame&&null!==this.stream2iFrame.contentWindow&&this.stream2iFrame.contentWindow.focus()}}R.clientsWaitingForToken=new Set,R.tokenRequestWaitingTime=2e3;var L=i(1);class V{constructor(e,t,i,r,a){this.url=e,this.parent=t,this.perfTracker=i,this.onReadyCallback=r,this.onMediaEventCallback=a,this.init()}play(){void 0!==this.player&&this.player.play()}pause(){void 0!==this.player&&this.player.pause()}stop(){void 0!==this.player&&(this.player.pause(),this.player.setCurrentTime(0))}togglePause(){void 0!==this.player&&void 0!==this.paused&&(this.paused?this.player.play():this.player.pause())}setVisible(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="visible"),void 0!==this.backDrop&&(this.backDrop.style.visibility="visible")}setHidden(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="hidden"),void 0!==this.backDrop&&(this.backDrop.style.visibility="hidden")}getPlayer(){return this.vimeoIframe}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}isPaused(){return this.paused}seekTo(e){void 0!==this.player&&this.player.setCurrentTime(e)}setVolume(e){void 0!==this.player&&this.player.setVolume(e)}setMute(){void 0!==this.player&&this.player.setMuted(!0)}setUnMute(){void 0!==this.player&&this.player.setMuted(!1)}getVolume(){return this.volume}isMuted(){return this.muted}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.vimeoIframe&&this.vimeoIframe.remove(),void 0!==this.backDrop&&this.backDrop.remove(),this.paused=void 0,this.player=void 0,this.currentTime=void 0,this.volume=void 0,this.muted=void 0,this.vimeoIframe=void 0,this.backDrop=void 0,void 0!==this.perfTracker&&this.perfTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}init(){this.backDrop=document.createElement("div"),this.backDrop.style.backgroundColor="black",this.setProperties(this.backDrop),this.parent.append(this.backDrop),this.vimeoIframe=document.createElement("iframe"),this.vimeoIframe.src=this.url,this.vimeoIframe.setAttribute("allow","autoplay"),this.setProperties(this.vimeoIframe),this.parent.append(this.vimeoIframe),this.player=new L.a(this.vimeoIframe,{controls:!0,responsive:!1}),this.player.ready().then(()=>a(this,void 0,void 0,(function*(){if(void 0!==this.player){this.registerOnStateChange();try{this.paused=yield this.player.getPaused(),this.currentTime=yield this.player.getCurrentTime(),this.duration=yield this.player.getDuration(),this.volume=yield this.player.getVolume(),this.muted=yield this.player.getMuted()}catch(e){r.error(509354830,`Vimeo error while getting video info on player ready (error: ${e})`)}this.player.setAutopause(!1),this.paused=!0,void 0!==this.perfTracker&&(this.perfTracker.onReady(),void 0!==this.volume&&this.perfTracker.setVolume(this.volume),void 0!==this.muted&&this.perfTracker.setMute(this.muted),void 0!==this.duration&&this.perfTracker.setDuration(this.duration)),void 0!==this.onReadyCallback&&this.onReadyCallback()}}))).catch(e=>{void 0!==this.perfTracker&&this.perfTracker.onError(`Error loading Vimeo player (error: ${e})`,!0)})}registerOnStateChange(){void 0!==this.player&&(this.player.on("play",e=>{this.paused=!1,this.onStateChange(1,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onPlay()}),this.player.on("pause",e=>{this.paused=!0,Math.abs(e.seconds-e.duration)>.1&&this.onStateChange(0,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onPause()}),this.player.on("seeked",e=>{this.onStateChange(3,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onSeeked()}),this.player.on("volumechange",e=>a(this,void 0,void 0,(function*(){const t=this.volume,i=this.muted;this.volume=e.volume,void 0!==this.player&&(this.muted=yield this.player.getMuted());const r=t!==this.volume,a=i!==this.muted;(r||a)&&this.onStateChange(4),r&&void 0!==this.perfTracker&&this.perfTracker.onVolumeChanged(this.volume),a&&void 0!==this.perfTracker&&void 0!==this.muted&&this.perfTracker.onMuteChanged(this.muted)}))),this.player.on("playing",()=>{void 0!==this.perfTracker&&this.perfTracker.onPlaying()}),this.player.on("seeking",()=>{void 0!==this.perfTracker&&this.perfTracker.onSeeking()}),this.player.on("ended",e=>{this.paused=!0,this.onStateChange(6,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onEnded()}),this.player.on("error",e=>{if(void 0!==this.perfTracker){const t=`${e.name} error raised by Vimeo player's "${e.method}" method: (${e.message})`;this.perfTracker.onError(t)}}),this.player.on("timeupdate",e=>{this.currentTime=e.seconds}))}onStateChange(e,t){void 0!==t&&(this.currentTime=t),void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){null!==e&&(c(e),e.style.border="0px",this.setVisible())}}function x(){return!!document.head.querySelector('script[src="https://www.youtube.com/iframe_api"]')}function D(e){const t=new RegExp(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/).exec(e);return null!=t&&t.length>=2?t[2]:""}class B{constructor(e,t,i,a,n,s,o){this.youtubeIframe=null,this.paused=!0,this.iFrameId="gfx-video-youtube-"+A(),this.url=new URL(t),this.seekToTimeThreshold=i.SeekToTimeThreshold,this.parentElement=e,this.mediaSizeInfo=a,this.playerPerf=o,this.onReadyCallBack=n,this.mediaEventCallback=s,!0!==i.LoadYouTubePlayerScriptInClient||x()||(window.onYouTubeIframeAPIReady=()=>{B.isYouTubeIFrameAPIReady=!0;for(const e of B.clientsWaitingForIFrameAPI)e.init();B.clientsWaitingForIFrameAPI=[]},function(){const e=document.createElement("script");e.setAttribute("type","text/javascript"),e.src="https://www.youtube.com/iframe_api",document.head.appendChild(e)}()),!0!==i.LoadYouTubePlayerScriptInClient||B.isYouTubeIFrameAPIReady?this.init():(r.info(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),B.clientsWaitingForIFrameAPI.push(this))}play(){void 0!==this.player&&void 0!==this.player.playVideo&&(this.player.playVideo(),this.setFocus())}getVolume(){if(void 0!==this.player&&void 0!==this.player.getVolume)return this.player.getVolume()}pause(){void 0!==this.player&&void 0!==this.player.pauseVideo&&this.player.pauseVideo()}getPlayer(){if(null!==this.youtubeIframe)return this.youtubeIframe}stop(){void 0!==this.player&&void 0!==this.player.stopVideo&&this.player.stopVideo()}togglePause(){void 0!==this.player&&(this.paused?this.play():this.pause())}setVisible(){null!==this.youtubeIframe&&(this.youtubeIframe.style.visibility="visible")}setHidden(){null!==this.youtubeIframe&&(this.youtubeIframe.style.visibility="hidden")}getCurrentTime(){if(void 0!==this.player&&void 0!==this.player.getCurrentTime)return this.player.getCurrentTime();r.warn(575703250,"Attempted to getCurrentTime www.youtube.com but undefined player")}getDuration(){if(void 0!==this.player&&void 0!==this.player.getDuration)return this.player.getDuration()}seekTo(e){void 0!==this.player?this.shouldSeekOnlineMedia(e)&&void 0!==this.player.seekTo&&this.player.seekTo(e,!0):r.warn(575703251,"Attempted to seek www.youtube.com but undefined player")}setMute(){void 0!==this.player&&void 0!==this.player.mute&&this.player.mute()}setUnMute(){void 0!==this.player&&void 0!==this.player.unMute&&this.player.unMute()}isMuted(){if(void 0!==this.player&&void 0!==this.player.isMuted)return this.player.isMuted()}setVolume(e){void 0!==this.player&&void 0!==this.player.setVolume&&this.player.setVolume(e)}isPaused(){return this.paused}ensureMediaClient(){const e=this.getIFrameById();null!==e?(e.remove(),this.initNewYoutubePlayer()):r.warn(574634017,"Attempted to ensuremediaclient but undefined IFrame")}cleanUpMediaClient(){this.paused=!0,void 0!==this.playerPerf&&this.playerPerf.cleanup(),void 0!==this.pollPlayerVol&&clearInterval(this.pollPlayerVol)}getPerfData(){if(void 0!==this.playerPerf)return this.playerPerf.getPerfData()}init(){this.player=this.initNewYoutubePlayer(),this.youtubeIframe=this.getIFrameById()}shouldSeekOnlineMedia(e){if(void 0!==this.player){const t=this.getCurrentTime();if(void 0!==t&&void 0!==this.seekToTimeThreshold&&Math.abs(e-t)>=this.seekToTimeThreshold)return!0}return!1}handlePartiallyOffSlideLinkedMedia(e){let t=0,i=0;e.mediaPosition.x<0&&(t=e.mediaPosition.x,this.parentElement.style.left="0px",this.parentElement.style.width=e.mediaSize.x+e.mediaPosition.x+"px"),e.mediaPosition.y<0&&(i=e.mediaPosition.y,this.parentElement.style.top="0px",this.parentElement.style.height=e.mediaSize.y+e.mediaPosition.y+"px"),e.mediaPosition.x+e.mediaSize.x>e.slideSize.x&&(e.mediaPosition.x<=0?this.parentElement.style.width=e.slideSize.x+"px":this.parentElement.style.width=e.slideSize.x-e.mediaPosition.x+"px"),e.mediaPosition.y+e.mediaSize.y>e.slideSize.y&&(e.mediaPosition.y<=0?this.parentElement.style.height=e.slideSize.y+"px":this.parentElement.style.height=e.slideSize.y-e.mediaPosition.y+"px"),this.parentElement.style.overflow="hidden";const a=this.youtubeIframe;null!==a?h(a,{width:e.mediaSize.x+"px",height:e.mediaSize.y+"px",position:"relative",left:t+"px",top:i+"px"}):r.warn(541881949,"Attempted to adjust iframe bounds but iframe is null")}initNewYoutubePlayer(){this.youtubeIframe=document.createElement("div"),this.youtubeIframe.id=this.iFrameId,this.parentElement.append(this.youtubeIframe);const e={start:this.url.searchParams.get("start"),t:this.url.searchParams.get("t")};return this.player=new YT.Player(this.youtubeIframe,{playerVars:e,videoId:D(this.url.toString()),height:"100%",width:"100%",events:{onReady:e=>{this.onPlayerReady(e)},onError:e=>{void 0!==this.playerPerf&&this.playerPerf.onError("YouTube player entered error state "+e.data,!0)}}}),void 0!==this.mediaSizeInfo&&this.mediaSizeInfo.fEnableCropping&&this.handlePartiallyOffSlideLinkedMedia(this.mediaSizeInfo),this.player}getIFrameById(){return document.getElementById(this.iFrameId)}onPlayerReady(e){this.onVolumeChangeHandler(),this.pollPlayerVol=setInterval(()=>this.onVolumeChangeHandler(),500),void 0!==this.player&&void 0!==this.playerPerf&&(this.playerPerf.onReady(),this.playerPerf.setVolume(this.player.getVolume()),this.playerPerf.setMute(this.player.isMuted()),this.playerPerf.setDuration(this.player.getDuration())),this.youtubeIframe=this.getIFrameById(),this.setProperties(),e.target.addEventListener("onStateChange",e=>{this.onStateChange(e),this.capturePlayerPerf(e)}),void 0!==this.onReadyCallBack&&this.onReadyCallBack()}onVolumeChangeHandler(){if(void 0===this.player)return;const e=this.player.isMuted(),t=this.player.getVolume(),i=void 0===this.muted||void 0===this.volume,r=this.muted!==e,a=this.volume!==t;this.muted=e,this.volume=t,i||((r||a)&&this.sendMediaEvent(4),a&&void 0!==this.playerPerf&&this.playerPerf.onVolumeChanged(this.volume),r&&void 0!==this.playerPerf&&void 0!==this.muted&&this.playerPerf.onMuteChanged(this.muted))}onStateChange(e){switch(e.data){case-1:break;case 0:this.paused=!0,this.sendMediaEvent(6);break;case 1:this.paused=!1,this.sendMediaEvent(1);break;case 2:this.paused=!0,this.sendMediaEvent(0);break;case 3:this.sendMediaEvent(3);break;case 5:break;default:r.info(578675600,"Unexpected Youtube Media Event: "+e.data)}}capturePlayerPerf(e){if(void 0!==this.playerPerf)switch(e.data){case 0:this.playerPerf.onEnded();break;case 1:this.playerPerf.onPlaying();break;case 2:this.playerPerf.onPause();break;case 3:this.playerPerf.onBuffering()}}sendMediaEvent(e){void 0!==this.mediaEventCallback&&this.mediaEventCallback(e)}setProperties(){null!==this.youtubeIframe&&(h(this.youtubeIframe,{zIndex:"6",pointerEvents:"all",position:"absolute",objectFit:"fill",border:"0px"}),this.setVisible())}setFocus(){const e=document.getElementById(this.iFrameId);null!==e&&null!==e.contentWindow&&e.contentWindow.focus()}}B.isYouTubeIFrameAPIReady=x(),B.clientsWaitingForIFrameAPI=[];class O{constructor(e,t){this.totalPlayingTime=0,this.isPlaying=!1,this.isFirstReady=!0,this.errors=[],this.creationTime=Date.now(),this.providerName=e,this.onVetoCallback=t}onReady(){this.logEvent("ready"),this.isFirstReady&&(this.isFirstReady=!1,this.timeToInteractivity=Date.now(),this.timeToFirstPlay=void 0,this.timeToFirstPlaying=void 0)}onPlay(){this.logEvent("play"),this.lastPlayTime=Date.now(),void 0===this.timeToFirstPlay&&(this.timeToFirstPlay=Date.now()),this.lastPlayingTime=void 0}onPlaying(){this.logEvent("playing"),void 0===this.timeToFirstPlaying&&(this.timeToFirstPlaying=Date.now()),this.isPlaying=!0,this.setTimeSincePlay(),this.calculateBufferingTime(),this.lastPlayTime=void 0,void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}onPause(){this.logEvent("pause"),this.isPlaying=!1,this.setTimeSincePlay(),this.lastPlayTime=void 0,this.calculatePlayingTime()}onEnded(){this.logEvent("ended"),this.isPlaying=!1,this.playedUntilEnd=!0,this.calculatePlayingTime()}onSeeking(){this.logEvent("seeking"),this.setTimeSinceSeek(),this.lastSeekTime=Date.now()}onSeeked(){this.logEvent("seeked"),this.setTimeSinceSeek(),this.lastSeekTime=void 0}onVolumeChanged(e){this.logEvent("volumeChanged"),this.volume=e}onMuteChanged(e){this.logEvent("muteChanged"),this.isMuted=e}onBuffering(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}onAADTokenSet(){void 0===this.timeToAADToken&&(this.timeToAADToken=Date.now())}onOEmbedResponse(){void 0===this.timeToOEmbedResponse&&(this.timeToOEmbedResponse=Date.now())}onIFrameLoad(){void 0===this.timeToIFrameLoad&&(this.timeToIFrameLoad=Date.now())}onPostMessagingInitialized(){void 0===this.timeToPostMessagingInitialized&&(this.timeToPostMessagingInitialized=Date.now())}onError(e,t=!1){this.logEvent("error",e),this.errors.push(e),t&&this.checkForVetoes(e)}setProviderName(e){this.providerName=e}setDuration(e){this.duration=e}setVolume(e){this.volume=e}setMute(e){this.isMuted=e}cleanup(){this.timeToAADToken=void 0,this.timeToOEmbedResponse=void 0,this.timeToIFrameLoad=void 0,this.timeToPostMessagingInitialized=void 0,this.timeToInteractivity=void 0,this.timeToFirstPlay=void 0,this.timeToFirstPlaying=void 0,this.lastBufferTime=void 0,this.lastSeekTime=void 0,this.lastPlayTime=void 0,this.lastPlayingTime=void 0,this.totalPlayingTime=0,this.totalBufferingTime=void 0,this.maxTimeSincePlay=void 0,this.maxTimeSinceSeek=void 0,this.playedUntilEnd=void 0,this.volume=void 0,this.isMuted=void 0,this.isPlaying=!1,this.isFirstReady=!0,this.errors=[],this.wasVetoLogged=void 0}getPerfData(){return this.calculatePlayingTime(),this.calculateBufferingTime(),{creationTime:this.creationTime,providerName:this.providerName,timeToAADToken:this.timeToAADToken,timeToOEmbedResponse:this.timeToOEmbedResponse,timeToIFrameLoad:this.timeToIFrameLoad,timeToPostMessagingInitialized:this.timeToPostMessagingInitialized,timeToInteractivity:this.timeToInteractivity,timeToFirstPlay:this.timeToFirstPlay,timeToFirstPlaying:this.timeToFirstPlaying,lastBufferTime:this.lastBufferTime,lastSeekTime:this.lastSeekTime,lastPlayTime:this.lastPlayTime,lastPlayingTime:this.lastPlayingTime,totalPlayingTime:this.totalPlayingTime,totalBufferingTime:this.totalBufferingTime,maxTimeSincePlay:this.maxTimeSincePlay,maxTimeSinceSeek:this.maxTimeSinceSeek,currentTimeSincePlay:this.setTimeSincePlay(),currentTimeSinceSeek:this.setTimeSinceSeek(),duration:this.duration,wasPlayedUntilEnd:this.playedUntilEnd,lastVolume:this.volume,lastMuteState:this.isMuted,isPlaying:this.isPlaying,errors:this.errors.length>0?this.errors:void 0,wasVetoLogged:this.wasVetoLogged}}setTimeSincePlay(){if(void 0===this.lastPlayTime)return;const e=Date.now()-this.lastPlayTime;return this.maxTimeSincePlay=void 0!==this.maxTimeSincePlay?Math.max(this.maxTimeSincePlay,e):e,e}setTimeSinceSeek(){if(void 0===this.lastSeekTime)return;const e=Date.now()-this.lastSeekTime;return this.maxTimeSinceSeek=void 0!==this.maxTimeSinceSeek?Math.max(this.maxTimeSinceSeek,e):e,e}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;void 0===this.totalBufferingTime&&(this.totalBufferingTime=0),this.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;this.totalPlayingTime+=e,this.lastPlayingTime=void 0}}checkForVetoes(e){const t="Stream2"===this.providerName?"Stream2":"Online";if(this.isPlaying){const i=t+"MediaPlaybackFailure",r=t+"VideoErrorWhilePlaying";this.sendVeto(i,r,e)}else if(void 0!==this.timeToFirstPlaying){const i=t+"MediaPlaybackFailure",r=t+"VideoErrorAfterPlaying";this.sendVeto(i,r,e)}else{const i=e.indexOf("status: 401")>-1,r=e.indexOf("status: 403")>-1;if("Stream2"===this.providerName&&(i||r))return void this.sendVeto("Stream2MediaPlaybackFailure","Stream2VideoAuthenticationError",e);const a=t+"MediaPlaybackFailure",n=t+"VideoError";this.sendVeto(a,n,e)}}sendVeto(e,t,i){r.error(509437396,"Veto raised for video: "+JSON.stringify({vetoName:e,errorName:t,details:i,providerName:this.providerName})),this.wasVetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback(e,t,i)}logEvent(e,t){let i=`OnlineVideoPlaybackTelemetry: Received ${e} event from ${this.providerName} video`;void 0!==t&&(i+=` (errorMessage: ${t})`),r.info(527983830,i)}}function N(e,t,i,a,n,s,o,l){if(!function(e){try{return void 0!==new URL(e)}catch(e){return!1}}(e))throw new Error("Attempted to create an online video client with an invalid URL");if("https:"!==new URL(e).protocol)throw new Error("Attempted to create an online video client with an unsafe URL");let d,h=function(e){for(const[t,i]of Object.entries(u))for(const r of i){if(new RegExp(r).test(e))return t}r.error(512271065,"Error getting provider name from URL (scheme not found in ONLINE_PROVIDER_URL_SCHEMES)")}(e);return!0===i.IsStream2Enabled&&void 0===h&&(h="Stream2"),!0===i.CapturePerfData&&void 0!==h&&(d=new O(h,l)),"YouTube"===h?new B(t,e,i,a,n,s,d):"Vimeo"===h?new V(e,t,d,n,s):"Flip"===h?new T(e,t,d,n,s):"StreamClassic"===h?new b(e,t,i,d,n,s,o):"Ted"===h||"SlideShare"===h?new g(e,t):"Stream2"===h?new R(e,t,i,d,n,s,o):(r.warn(512271066,"Creating Default client for unidentified provider URL"),new g(e,t))}const _=new class{createVideoManager(e,t,i,r,a,n,s){return new v(e,t,i,r,a,n,s,N)}setLogger(e){!function(e){r=e}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(e)}}}]);
//# sourceMappingURL=video.js.map