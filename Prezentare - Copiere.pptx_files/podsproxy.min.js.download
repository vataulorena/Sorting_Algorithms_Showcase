!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PodsProxy=t():e.PodsProxy=t()}(window,(function(){return function(e){var t={};function s(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=7)}([function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),o=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||t.hasOwnProperty(s)||r(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),o(s(5),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var s in e)t.hasOwnProperty(s)||(t[s]=e[s])}(s(4))},function(e,t,s){"use strict";(function(e){const s={},r=t=>"undefined"!=typeof self&&self&&t in self?self:"undefined"!=typeof window&&window&&t in window?window:void 0!==e&&e&&t in e?e:"undefined"!=typeof globalThis&&globalThis?globalThis:void 0,o=["Headers","Request","Response","ReadableStream","fetch","AbortController","FormData"];for(const e of o)Object.defineProperty(s,e,{get(){const t=r(e),s=t&&t[e];return"function"==typeof s?s.bind(t):s}});const n=e=>null!==e&&"object"==typeof e,i="function"==typeof s.AbortController,a="function"==typeof s.ReadableStream,d="function"==typeof s.FormData,l=(...e)=>{let t={};for(const s of e)if(Array.isArray(s))Array.isArray(t)||(t=[]),t=[...t,...s];else if(n(s))for(let[e,r]of Object.entries(s))n(r)&&Reflect.has(t,e)&&(r=l(t[e],r)),t={...t,[e]:r};return t},p=["get","post","put","patch","head","delete"],c={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},u=[413,429,503],m=Symbol("stop");class h extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}class g extends Error{constructor(){super("Request timed out"),this.name="TimeoutError"}}const f=e=>new Promise(t=>setTimeout(t,e)),C=e=>p.includes(e)?e.toUpperCase():e,I={limit:2,methods:["get","put","head","delete","options","trace"],statusCodes:[408,413,429,500,502,503,504],afterStatusCodes:u},y=(e={})=>{if("number"==typeof e)return{...I,limit:e};if(e.methods&&!Array.isArray(e.methods))throw new Error("retry.methods must be an array");if(e.statusCodes&&!Array.isArray(e.statusCodes))throw new Error("retry.statusCodes must be an array");return{...I,...e,afterStatusCodes:u}};class _{constructor(e,t={}){if(this._retryCount=0,this._input=e,this._options={credentials:this._input.credentials||"same-origin",...t,hooks:l({beforeRequest:[],beforeRetry:[],afterResponse:[]},t.hooks),method:C(t.method||this._input.method),prefixUrl:String(t.prefixUrl||""),retry:y(t.retry),throwHttpErrors:!1!==t.throwHttpErrors,timeout:void 0===t.timeout?1e4:t.timeout},"string"!=typeof this._input&&!(this._input instanceof URL||this._input instanceof s.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&"string"==typeof this._input){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(i&&(this.abortController=new s.AbortController,this._options.signal&&this._options.signal.addEventListener("abort",()=>{this.abortController.abort()}),this._options.signal=this.abortController.signal),this.request=new s.Request(this._input,this._options),this._options.searchParams){const e=new URL(this.request.url);e.search=new URLSearchParams(this._options.searchParams),!(d&&this._options.body instanceof s.FormData||this._options.body instanceof URLSearchParams)||this._options.headers&&this._options.headers["content-type"]||this.request.headers.delete("content-type"),this.request=new s.Request(new s.Request(e,this.request),this._options)}void 0!==this._options.json&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type","application/json"),this.request=new s.Request(this.request,{body:this._options.body}));const r=async()=>{if(this._options.timeout>2147483647)throw new RangeError("The `timeout` option cannot be greater than 2147483647");await f(1);let e=await this._fetch();for(const t of this._options.hooks.afterResponse){const r=await t(this.request,this._options,e.clone());r instanceof s.Response&&(e=r)}if(!e.ok&&this._options.throwHttpErrors)throw new h(e);if(this._options.onDownloadProgress){if("function"!=typeof this._options.onDownloadProgress)throw new TypeError("The `onDownloadProgress` option must be a function");if(!a)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return this._stream(e.clone(),this._options.onDownloadProgress)}return e},o=this._options.retry.methods.includes(this.request.method.toLowerCase())?this._retry(r):r();for(const[e,t]of Object.entries(c))o[e]=async()=>{this.request.headers.set("accept",this.request.headers.get("accept")||t);const s=(await o).clone();return"json"===e&&204===s.status?"":s[e]()};return o}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof g)){if(e instanceof h){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const t=e.response.headers.get("Retry-After");if(t&&this._options.retry.afterStatusCodes.includes(e.response.status)){let e=Number(t);return Number.isNaN(e)?e=Date.parse(t)-Date.now():e*=1e3,void 0!==this._options.retry.maxRetryAfter&&e>this._options.retry.maxRetryAfter?0:e}if(413===e.response.status)return 0}return.3*2**(this._retryCount-1)*1e3}return 0}async _retry(e){try{return await e()}catch(t){const s=Math.min(this._calculateRetryDelay(t),2147483647);if(0!==s&&this._retryCount>0){await f(s);for(const e of this._options.hooks.beforeRetry)if(await e({request:this.request,options:this._options,error:t,response:t.response.clone(),retryCount:this._retryCount})===m)return;return this._retry(e)}if(this._options.throwHttpErrors)throw t}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const t=await e(this.request,this._options);if(t instanceof Request){this.request=t;break}if(t instanceof Response)return t}return!1===this._options.timeout?s.fetch(this.request.clone()):(e=s.fetch(this.request.clone()),t=this._options.timeout,r=this.abortController,new Promise((s,o)=>{const n=setTimeout(()=>{r&&r.abort(),o(new g)},t);e.then(s).catch(o).then(()=>{clearTimeout(n)})}));var e,t,r}_stream(e,t){const r=Number(e.headers.get("content-length"))||0;let o=0;return new s.Response(new s.ReadableStream({start(s){const n=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:r},new Uint8Array),async function e(){const{done:i,value:a}=await n.read();i?s.close():(t&&(o+=a.byteLength,t({percent:0===r?0:o/r,transferredBytes:o,totalBytes:r},a)),s.enqueue(a),e())}()}}))}}const S=(...e)=>{for(const t of e)if((!n(t)||Array.isArray(t))&&void 0!==t)throw new TypeError("The `options` argument must be an object");return l({},...e)},P=e=>{const t=(t,s)=>new _(t,S(e,s));for(const s of p)t[s]=(t,r)=>new _(t,S(e,r,{method:s}));return t.HTTPError=h,t.TimeoutError=g,t.create=e=>P(S(e)),t.extend=t=>P(S(e,t)),t.stop=m,t};t.a=P()}).call(this,s(6))},function(e,t,s){"use strict";var r,o="object"==typeof Reflect?Reflect:null,n=o&&"function"==typeof o.apply?o.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var d=10;function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function p(e,t,s,r){var o,n,i,a;if("function"!=typeof s)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s);if(void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,s.listener?s.listener:s),n=e._events),i=n[t]),void 0===i)i=n[t]=s,++e._eventsCount;else if("function"==typeof i?i=n[t]=r?[s,i]:[i,s]:r?i.unshift(s):i.push(s),(o=l(e))>0&&i.length>o&&!i.warned){i.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=i.length,a=d,console&&console.warn&&console.warn(a)}return e}function c(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,n(this.listener,this.target,e))}function u(e,t,s){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},o=c.bind(r);return o.listener=s,r.wrapFn=o,o}function m(e,t,s){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?s?[o.listener||o]:[o]:s?function(e){for(var t=new Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}(o):g(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var s=t[e];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function g(e,t){for(var s=new Array(t),r=0;r<t;++r)s[r]=e[r];return s}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");d=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var d=o[e];if(void 0===d)return!1;if("function"==typeof d)n(d,this,t);else{var l=d.length,p=g(d,l);for(s=0;s<l;++s)n(p[s],this,t)}return!0},a.prototype.addListener=function(e,t){return p(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return p(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,u(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,u(this,e,t)),this},a.prototype.removeListener=function(e,t){var s,r,o,n,i;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(s=r[e]))return this;if(s===t||s.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,s.listener||t));else if("function"!=typeof s){for(o=-1,n=s.length-1;n>=0;n--)if(s[n]===t||s[n].listener===t){i=s[n].listener,o=n;break}if(o<0)return this;0===o?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,o),1===s.length&&(r[e]=s[0]),void 0!==r.removeListener&&this.emit("removeListener",e,i||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,s,r;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[e]),this;if(0===arguments.length){var o,n=Object.keys(s);for(r=0;r<n.length;++r)"removeListener"!==(o=n[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=s[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return m(this,e,!0)},a.prototype.rawListeners=function(e){return m(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var r=function(){function e(){}return e.load=function(t){for(var s in t)e.m_settings[s]=t[s]},e.readBooleanOrDefault=function(t,s){var r=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===r?"true"===e.m_settings[t].toLowerCase():"boolean"===r?e.m_settings[t]:s},e.readNumberOrDefault=function(t,s){var r=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===r||"number"===r?Number(e.m_settings[t]):s},e.readStringOrDefault=function(t,s){return void 0===e.m_settings||"string"!=typeof e.m_settings[t]?s:e.m_settings[t]},e.addOrUpdateSettingsFromUrl=function(t,s){var r=s.get("wdset");if(!r)return t;for(var o=0,n=r.split(",");o<n.length;o++){var i=n[o].split(":"),a=i[0].split("."),d=a[0],l=a[1],p=i[1];l&&p&&e.addOrUpdateSetting(t,d,l,p)}return t},e.addOrUpdateSetting=function(e,t,s,r){"__proto__"!==t&&(e[t]||(e[t]={}),e[t][s]=r)},e.m_settings={},e}();t.Settings=r},function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(e){"object"==typeof window&&(s=window)}e.exports=s},function(e,t,s){"use strict";var r,o,n;s.r(t),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(r||(r={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(o||(o={}));class i{}i.unknown="unknown",i.ErrorCode="ErrorCode",i.ErrorCategory="ErrorCategory",i.errorCategory="errorCategory",i.errorCode="errorCode",i.XCorrelationId="X-CorrelationId",i.ContentType="Content-Type",i.ContentLength="Content-Length",i.ContenEncoding="Content-Encoding",i.TransferEncoding="Transfer-Encoding",i.XusedOutputCache="X-usedOutputCache",i.ContentDisposition="Content-Disposition",i.CallerCorrelationId="CallerCorrelationId",i.action="action",i.parser="parser",i.server="server",i.callId="callId",i.dateHeader="x-ms-date",i.clientTimeoutHeader="x-ms-client-timeout",i.clientRequestIdHeader="x-ms-client-request-id",i.newSnapUrlHeader="x-newsnapurl",i.correlationId="correlationId",i.firstResponseCheck="firstResponseCheck",i.fetchBoundary="fetchBoundary",i.downloadResponse="downloadResponse",i.parserCallback="parserCallback",i.createResponse="createResponse",i.contentLength="contentLength",i.usedOutputCache="usedOutputCache",i.itemUsedOutputCacheMap="itemUsedOutputCacheMap",i.podsProxyCallSuceeded="podsProxyCallSuceeded",i.PriorityHint="PriorityHint",i.RequestInfo="RequestInfo",i.ResponseHeaders="ResponseHeaders",i.IsBootRequest="IsBootRequest",function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(n||(n={}));class a{}a.PresInfoMetaData="presinfo/metadata",a.PresinfoslimSlideOrder="presinfo/slimSlideOrder",a.slideInfoIndex="pres/sldIdx",a.slideInfoSid="pres/sldSid",a.slideNotesIndex="pres/NotesSldIdx",a.slideNotesSid="pres/NotesSldSid",a.slideCommentsIndex="pres/CommentsSldIdx",a.slideCommentsSid="pres/CommentsSldSid",a.slideMetadataIndex="pres/SlideMetadatasldIdx",a.slideMetadataSid="pres/SlideMetadataSldSid",a.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",a.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid";class d{}d.JsonType="application/json",d.ImagePng="image/png",d.ImageJpg="image/jpg",d.PlainTextType="text/plain";class l{async processMultipartResponse(e,t,s){if(null==e)throw"multipartContentBuffer is empty";try{const r=new TextDecoder("utf-8").decode(e);this.parseMultipart(r,t).forEach(e=>{const t=this.parseResponsePart(e);s(t)})}catch(e){const t={Err:new Error(e)};s(t)}}fetchBoundary(e){let t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,s,r){return r&&r.forceNewCodePath||!(e instanceof Uint8Array)?await this.processMultipartBinaryResponseImpl(e,t,s):await this.processMultipartBinaryResponseOldImpl(e,t,s)}async processMultipartBinaryResponseOldImpl(e,t,s){if(null==e)throw"multipartContentBuffer is empty";let r,o="",n=void 0,i=0,a=[];try{for(r=0;r<e.length;r+=1){const d=e[r],l=r>0?e[r-1]:null,p=10===d||13===d,c=10===d&&13===l,u=10===l&&13===d;if(a.push(d),p||(o+=String.fromCharCode(d)),0===i&&c)"--"+t===o&&(i=1,o="",a=[]);else if(1===i&&u)n=new Uint8Array(a),i=2,o="",a=[];else if(2===i&&c)i=3,o="",a=[];else if(3===i){if(o.length>t.length+4&&(o=""),"--"+t===o){let e=a.length-o.length,t=a.slice(0,e-1);i=1,s({Headers:this.processHeader(n),Body:new Uint8Array(t)}),o="",n=void 0,a=[]}c&&(o="")}}}catch(e){s({Err:new Error(e)})}}async processMultipartBinaryResponseImpl(e,t,s){if(!e)throw"multipartContentBufferOrStream is empty";let r,o="",n=void 0,i=0,a=[],d=null;const l=e instanceof Uint8Array;try{for(;;){if(l)r=e;else{const{done:t,value:s}=await e.read();if(t)break;r=s}for(const e of r){const r=10===e||13===e,l=10===e&&13===d,p=10===d&&13===e;if(a.push(e),r||(o+=String.fromCharCode(e)),0===i&&l)"--"+t===o&&(i=1,o="",a=[]);else if(1===i&&p)n=new Uint8Array(a),i=2,o="",a=[];else if(2===i&&l)i=3,o="",a=[];else if(3===i){if(o.length>t.length+4&&(o=""),"--"+t===o){let e=a.length-o.length,t=a.slice(0,e-1);i=1,s({Headers:this.processHeader(n),Body:new Uint8Array(t)}),o="",n=void 0,a=[]}l&&(o="")}d=e}if(l)break}}catch(e){s({Err:new Error(e)})}}parseMultipart(e,t){const s="--"+t;return e.split(s).map(e=>e.trim()).filter(e=>""!==e&&"--"!==e)}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),s=new Map;t.forEach(e=>{const t=e.split(": ");2===t.length&&s.set(t[0],t[1])});const r=this.parseResponseBodyFromPart(e),o=(new TextEncoder).encode(r);return{Headers:s,Body:o}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){let t=new Map;if(e){let s="";for(let t=0;t<e.byteLength;t+=1)s+=String.fromCharCode(e[t]);s.split("\n").forEach(e=>{let s=e.split(": ");2===s.length&&t.set(s[0],s[1])})}return t}}var p,c,u=s(1),m=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(p||(p={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"}(c||(c={})),function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,s,r){return"tag_"+e.tagIntToString(t)+" ["+c[s]+"] "+r},e.prototype.sendTraceTag=function(t,s,r,o){var n=console.log;switch(r){case p.Error:n=console.error;break;case p.Warning:n=console.warn;break;case p.Info:n=console.info;break;case p.Verbose:n=console.debug;break;case p.Spam:default:n=console.log}try{n(e.getLogMessage(t,s,o))}catch(e){var i="undefined"!=typeof navigator?navigator:void 0;if(i&&!/rv:11.0/i.test(i.userAgent))throw e}},e.prototype.shipAssertTag=function(t,s,r,o){console.assert(r,e.getLogMessage(t,s,o))},e.prototype.debugAssertTag=function(e,t,s,r){this.shipAssertTag(e,t,s,r)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}();var h,g=new(function(){function e(){this.externalLogger=new m}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,s,r){this.externalLogger.sendTraceTag(e,t,s,r)},e.prototype.debugAssertTag=function(e,t,s,r){this.externalLogger.debugAssertTag(e,t,s,r)},e.prototype.shipAssertTag=function(e,t,s,r){this.externalLogger.shipAssertTag(e,t,s,r)},e}());!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(h||(h={})),function(){function e(t,s){var r=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){r.triggerUpload(!1,!1)},this.flush=function(){r.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,s){window.clearTimeout(r.timeoutId),r.logCache.length>0&&(r.uploadId+=1,function(e,t,s){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,s),r.send(e))}}(function(e,t,s,r){var o=e.map((function(e){return function(e,t){var s={};s.G=e.tag,s.T=e.timestamp-t,s.M=e.message,s.C=e.category;var r=1e3*e.type+e.level;return s.D=r,s}(e,r)})),n=function(e,t,s,r){var o={};return o.T=e,o.L=t,o.S=s,o.I=r,o.V=1,o}(r,o,t,s);return JSON.stringify(n)}(r.logCache,r.userSessionId,r.uploadId,r.timestampBase),r.remoteUrlEndpoint,s),r.logCache=[],r.timestampBase=Date.now()),t&&(r.timeoutId=window.setTimeout(r.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=s+"?usid="+t,window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===p.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}(),p.Info;var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(e,t)};!function(e){!function(e,t){function s(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(m);var C=s(2),I=s(3);class y{constructor(e,t,s,r){this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=e,this.m_responses=t,this.m_perfDictionary=s,this.m_parsedBasedResponse=r}parsePart(e){if(e&&e.Headers){this.m_perfDictionary[i.parserCallback]?(this.m_perfDictionary[i.parserCallback].callCounter=this.m_perfDictionary[i.parserCallback].callCounter+1,this.m_perfDictionary[i.parserCallback].lastCallStart=E.performanceNowTrimmed()):this.m_perfDictionary[i.parserCallback]={lastCallStart:E.performanceNowTrimmed(),lastCallEnd:E.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};const t=e.Headers.get(i.ContentDisposition),s=e.Headers.get(i.ContentType);this.m_parsedBasedResponse.usedOutputCache=e.Headers.get(i.XusedOutputCache);let r=e.Headers.get(i.ErrorCode)||"ErrorRESERVEDSuccess",o=e.Headers.get(i.ErrorCategory)||"ErrorRESERVEDSuccess",n=e.Headers.get(i.XusedOutputCache);if(t){let a;const d=t.indexOf("pres%2fSlideMetadatasldIdx")>0;try{a=decodeURIComponent(t.substring(t.indexOf("name=")+5).trim())}catch(e){g.sendTraceTag(595641600,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - partResponse Error:"+e)}if(a){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(a,r),this.m_parsedBasedResponse.itemErrorCategoryMap.set(a,o),n&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(a,n),r&&r.trim().toLowerCase()==="ErrorRESERVEDSuccess".toLowerCase())if(t.indexOf("presinfo%2fslimSlideOrder")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body));for(const e of t)this.parsedResponse.slideOrder.push({sid:e,cid:0})}else if(t.indexOf("presinfo%2fmetadata")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body));let s=[],r=[];for(const e of t.SidSlideOrder)s.push({sid:e,cid:0});if(t.SidHiddenSlides)for(const e of t.SidHiddenSlides)r.push({sid:e,cid:0});let o={Item:null};t.SlideShowProperties.Item||(o={Item:null}),t.SlideShowProperties.Item.s?o={Item:{sid:t.SlideShowProperties.Item.s}}:t.SlideShowProperties.Item.st&&(o={Item:{start:t.SlideShowProperties.Item.st,end:t.SlideShowProperties.Item.end}});const n={SlideOrder:s,HiddenSlideOrder:r,SlideEmuWidth:t.SlideEmuWidth,SlideEmuHeight:t.SlideEmuHeight,ViewScalingFactor:t.ViewScalingFactor,SlideShowProperties:o,Sections:t.Sections};this.parsedResponse.slideAllInfo.push(n)}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&s&&y.getSupportedImageType(s)){const r=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx");let o="";for(let t=0;t<e.Body.length;t+=1)o+=String.fromCharCode(e.Body[t]);const n=`data:${y.getSupportedImageType(s)};base64, ${btoa(o)}`;this.m_perfDictionary[i.parserCallback].slidesHaveImages.push(r),this.m_responses[r]||(this.m_responses[r]={ID:{sid:r,cid:0}}),this.m_responses[r].SlideImageData=n}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&s&&-1!==s.indexOf("application/json")){const s=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[s]||(this.m_responses[s]={ID:{sid:r.sld[0].id,cid:0}}),this.m_responses[s].SlideShowInfo=r}else if(t.indexOf("pres%2fNotesSldSid")>0||t.indexOf("pres%2fNotesSldIdx")>0){const s=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),r=new TextDecoder("utf-8").decode(e.Body);this.m_responses[s]||(this.m_responses[s]={ID:{sid:s,cid:0}}),this.m_responses[s].NoteHtml=r}else if(t.indexOf("pres%2fCommentsSldSid")>0||t.indexOf("pres%2fCommentsSldIdx")>0){const s=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[s]||(this.m_responses[s]={ID:{sid:s,cid:0}}),this.m_responses[s].Comments=r}else if(t.indexOf("pres%2fSlideMetadataSldSid")>0||d){const s=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[s]||(this.m_responses[s]={ID:r.ID}),this.m_responses[s].Title=r.Title,this.m_responses[s].HasAnimation=r.HasAnimation,this.m_responses[s].Hidden=r.Hidden,this.m_responses[s].HasTransition=r.HasTransition}else if(t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||t.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){const s=y.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[s]||(this.m_responses[s]={ID:r.ID}),this.m_responses[s].AccessibilityModel=r.AccessibilityModel}else if(t.indexOf("Res%2fSldSid")>0&&s&&y.getSupportedImageType(s)){let r,o;if(r=y.extractStringInBetweenStrings(t,"Res%2fSldSid","%2f"),o=y.extractStringInBetweenStrings(t,"filename=","\r"),r&&o){let t={sid:+r,cid:0};const n=y.getSupportedImageType(s);let a,d;if(e.Body)if(this.m_settings.allowImagesAsBinary)a={Id:o,Base64:"",Binary:e.Body,MimeType:n,ByteCount:e.Body.length};else{let t="";for(let s=0;s<e.Body.length;s+=1)t+=String.fromCharCode(e.Body[s]);const s=`data:${n};base64,${btoa(t)}`;a={Id:o,Base64:s,MimeType:n,ByteCount:s.length}}else g.sendTraceTag(529331297,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::parseMultipartResponse - Body is undefined. slideId:${r}, resourceId:${o}`),a={Id:o,Base64:"",MimeType:n,ByteCount:0};this.m_perfDictionary[i.parserCallback].slidesHaveImageResources.push(t.sid);for(const[,e]of Object.entries(this.m_responses))e.ID&&e.ID.sid===t.sid&&(d=e);d?d.ResourceData?d.ResourceData.push(a):d.ResourceData=[a]:this.m_responses[t.sid]={ID:t,ResourceData:[a]}}else g.sendTraceTag(595628568,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:${r}, resourceId:${o}`),this.m_parsedBasedResponse.responseErrorCode="ErrorResponseNotValid"}}else this.m_parsedBasedResponse.responseErrorCode="ErrorItemNameNotValid"}else this.m_parsedBasedResponse.responseErrorCode="ErrorContentDispositionHeaderNotValid";this.m_perfDictionary[i.parserCallback].lastCallEnd=E.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode="ErrorResponseNotValid";e.Err&&(this.m_parsedBasedResponse.responseErrorCode="ErrorResponseNotValid",g.sendTraceTag(595687003,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy::parseMultipartResponse - partResponse Error:"+e.Err))}static getSupportedImageType(e){return E.s_supportedImageType.find(t=>-1!==e.indexOf(t))||""}static getSlideKeyFromHeader(e,t){let s=new RegExp(`.*${t}(.*)`);if(!e)return g.sendTraceTag(529331298,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;let r=s.exec(e);return null!=r&&r.length>=2?+r[1]:(g.sendTraceTag(529331299,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::getSlideLocationFromHeader - regex result is null header:${e}, itemId: ${t}`),-1)}static extractStringInBetweenStrings(e,t,s){let r=e.indexOf(t)+t.length,o=s?e.indexOf(s,r):-1;return-1===o?e.substring(r):e.substring(r,o)}}var _=s(0);let S={};function P(e){e.logger&&g.setLogger(e.logger),e.settings&&_.Settings.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&u.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=S)}class E{constructor(e,t,s,r,o,n){if(this.events=new I.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new l,g.setLogger(r),g.sendTraceTag(595686994,c.msoulscat_Wac_PptSession,e&&t&&t.DownloadUrl&&s&&t.DocID?p.Info:p.Warning,`PodsProxy::constructor - podsUrl:${e}, fileUrl:${null!==t?t.DownloadUrl:null}, fileExtension:${s}, docId:${t.DocID}, requestHeaders:${JSON.stringify(o)}`),this.m_podsUrl=e,this.m_settings=n||{timeout:3e4,throwHttpErrors:!0},u.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),o&&o.forEach((e,t)=>{this.m_requestHeaders.append(t,e)}),this.m_getPresInfoRequest={Source:t,FileExtension:s||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:s||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),n&&n.perfTimingMonitorEnabled)try{new PerformanceObserver(e=>E.logPerformanceEntries(e)).observe({entryTypes:["resource"]})}catch(e){g.sendTraceTag(572379985,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:PerformanceObserver failed with exception "+e)}}async getSlideOrderAsync(){const e=await this.getPresInfoAsync("getSlideOrderAsync");return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",slideId:(await e.json()).SlideOrder}}async getSlideInfosAsync(e){e.RenderOptions&&(this.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map(e=>e.slideId),RenderOptions:e.RenderOptions}]),this.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_getPresInfoRequest.ClientWidth,this.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_getPresInfoRequest.ClientHeight,this.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:this.m_getPresInfoRequest.DevicePixelRatio,this.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_getPresInfoRequest.IsHighContrast,this.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_getPresInfoRequest.ClientColorSettings,this.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_getPresInfoRequest.MinClientWidth,this.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_getPresInfoRequest.MinClientHeight,this.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_getPresInfoRequest.MaxClientWidth,this.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_getPresInfoRequest.MaxClientHeight;const t=await this.getPresInfoAsync("getSlideInfosAsync");return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",slideInfo:(await t.json()).Slides}}async getItemsSlideOrderAsync(){this.m_itemsList=new Array,this.m_itemsList.push({Id:a.PresinfoslimSlideOrder,AcceptTypes:[d.JsonType]}),this.m_getItemsRequest.Items=this.m_itemsList;const e=await this.getItemsAsync("getItemsSlideOrderAsync");return await this.createSlideIdResponse(this.parseMultipartResponseAsync(e,{}))}async getItemsPresInfoAsync(e){this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:a.PresInfoMetaData,AcceptTypes:[d.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(i.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(i.XCorrelationId,e.CorrelationId||"");let t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(i.RequestInfo,JSON.stringify(t));const s=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(i.clientRequestIdHeader,s),this.m_requestHeaders.set(i.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(i.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const r={action:"getItemsPresInfoAsync",correlationId:e.CorrelationId,server:{start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()}};E.logPerf(r);const o=await this.getItemsAsync("getItemsPresInfoAsync");r[i.server].end=E.performanceNowTrimmed(),o&&o.response&&o.response.headers&&(r[i.contentLength]=o.response.headers.get(i.ContentLength)),E.logPerf(r),r[i.parser]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()};const n=this.setTimeoutForParsingResponse(r),l=await this.createPresInfoResponse(this.parseMultipartResponseAsync(o,r));return clearTimeout(n),r[i.parser].end=E.performanceNowTrimmed(),r[i.usedOutputCache]=!!l.usedOutputCache&&"true"===l.usedOutputCache.trim().toLowerCase(),r[i.itemUsedOutputCacheMap]=!!l.itemUsedOutputCacheMap&&Array.from(l.itemUsedOutputCacheMap.entries()),E.logPerf(r),l.metadata=this.generateReportPerfDictionary(r),l}async getItemsPresInfoAndSlideInfosAsync(e,t,s){const n={action:"getItemsPresInfoAndSlideInfoAsync"};let l=null;try{this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:a.PresInfoMetaData,AcceptTypes:[d.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_imageOptions.InputProperties.ClientWidth=t.ClientWidth?t.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=t.ClientHeight?t.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=t.IsHighContrast?t.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=t.MinClientWidth?t.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=t.MinClientHeight?t.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=t.TranslateLanguage?t.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage;for(let e=0;e<t.SlideLocations.length;e+=1)t.GetSlideImage?this.m_itemsList.push({Id:t.SlideLocations[e].slideId?a.slideInfoSid+t.SlideLocations[e].slideId.sid.toString():a.slideInfoIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:E.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):t.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:t.ClientWidth?t.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:t.ClientHeight?t.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:t.IsHighContrast?t.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:t.ColorMode?t.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:t.ClientColorSettings?t.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage},this.m_slideInfoOptions.Filters=E.ensureISlideInfoFilters(t.Filters),this.m_itemsList.push({Id:t.SlideLocations[e].slideId?a.slideInfoSid+t.SlideLocations[e].slideId.sid.toString():a.slideInfoIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage},void 0!==t.GetSlideAccessibilityModelData&&t.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?a.slideAccessibilityModelSid+t.SlideLocations[e].slideId.sid.toString():a.slideAccessibilityModelIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),t.GetSlideNotes&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?a.slideNotesSid+t.SlideLocations[e].slideId.sid.toString():a.slideCommentsIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[d.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),t.GetSlideComments&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?a.slideCommentsSid+t.SlideLocations[e].slideId.sid.toString():a.slideCommentsIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:t.CommentOptions});this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(i.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(i.XCorrelationId,e.CorrelationId||"");let p={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(i.RequestInfo,JSON.stringify(p));const c=this.objectDictionaryToRequestIdString(p);this.m_requestHeaders.set(i.clientRequestIdHeader,c),this.m_requestHeaders.set(i.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(i.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():""),n.correlationId=e.CorrelationId,n[i.server]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},E.logPerf(n),this.events.emit("requestStageChanged",{requestType:r.getItemsPresInfoAndSlideInfoAsync,stageInfo:o.GetItemsCall});const u=await this.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:s&&s.overrideGetItemsTimeoutMs});if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&"ServerErrorFileDownloadResourceInconsistent"===u.errorCode)return{presInfo:void 0,slideInfo:[],responseErrorCode:"ServerErrorFileDownloadResourceInconsistent",responseErrorCategory:u.errorCategory,itemErrorCodeMap:void 0};if(n[i.server].end=E.performanceNowTrimmed(),u&&u.response&&u.response.headers){n[i.contentLength]=u.response.headers.get(i.ContentLength),n[i.ContenEncoding]=u.response.headers.get(i.ContenEncoding),n[i.TransferEncoding]=u.response.headers.get(i.TransferEncoding);let e=u.response.headers.keys();if(e){let t=[];for(let s of e)t.push(s);n[i.ResponseHeaders]=t}}let m;if(E.logPerf(n),n[i.parser]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},l=this.setTimeoutForParsingResponse(n),m=await this.parseMultipartResponseAsync(u,n,{shouldTimeoutResponseStreamDownload:s&&s.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:s&&s.overrideDownloadTimeoutMs,requestType:r.getItemsPresInfoAndSlideInfoAsync}),m&&"ErrorDownloadResponseStreamTimeout"===m.responseErrorCode)return{presInfo:void 0,slideInfo:[],responseErrorCode:"ErrorDownloadResponseStreamTimeout",responseErrorCategory:"Transient",itemErrorCodeMap:void 0};const h=this.createPresInfoAndSlideInfoResponse(m,n);return null!==l&&(clearTimeout(l),l=null),n[i.parser].end=E.performanceNowTrimmed(),n[i.usedOutputCache]=!!h.usedOutputCache&&"true"===h.usedOutputCache.trim().toLowerCase(),n[i.itemUsedOutputCacheMap]=!!h.itemUsedOutputCacheMap&&Array.from(h.itemUsedOutputCacheMap.entries()),n[i.podsProxyCallSuceeded]=!0,E.logPerf(n),h.metadata=this.generateReportPerfDictionary(n),h}catch(e){return g.sendTraceTag(571548234,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: "+e),n[i.podsProxyCallSuceeded]=!1,E.logPerf(n),null!==l&&(clearTimeout(l),l=null),{presInfo:void 0,slideInfo:[],responseErrorCode:"ErrorRESERVEDItemFailed",responseErrorCategory:"Transient",itemErrorCodeMap:void 0}}}async getItemsSlideInfosAsync(e){const t={action:"getItemsSlideInfosAsync"};try{this.m_imageOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=null!=e.IsHighContrast?e.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ColorMode=null!=e.ColorMode?e.ColorMode:this.m_imageInputProperties.ColorMode,this.m_imageOptions.InputProperties.ClientColorSettings=null!=e.ClientColorSettings?e.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=e.TranslateLanguage?e.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage,this.m_itemsList=new Array;for(let t=0;t<e.SlideLocations.length;t+=1)e.GetSlideImage?this.m_itemsList.push({Id:e.SlideLocations[t].slideId?a.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():a.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:E.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):e.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage},this.m_slideInfoOptions.Filters=E.ensureISlideInfoFilters(e.Filters),e.SkipGetSlideInfo||this.m_itemsList.push({Id:e.SlideLocations[t].slideId?a.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():a.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage},void 0!==e.GetSlideAccessibilityModelData&&e.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?a.slideAccessibilityModelSid+e.SlideLocations[t].slideId.sid.toString():a.slideAccessibilityModelIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),e.GetSlideNotes&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?a.slideNotesSid+e.SlideLocations[t].slideId.sid.toString():a.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[d.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),e.GetSlideComments&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?a.slideCommentsSid+e.SlideLocations[t].slideId.sid.toString():a.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:e.CommentOptions});if(0===this.m_itemsList.length)return g.sendTraceTag(595076497,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRequestFailed",responseErrorCategory:"BadRequest",slideInfo:[]};this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(i.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(i.XCorrelationId,e.CorrelationId||"");let t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(i.RequestInfo,JSON.stringify(t));const s=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(i.clientRequestIdHeader,s),this.m_requestHeaders.set(i.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(i.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const r={action:"getItemsSlideInfosAsync",correlationId:e.CorrelationId,server:{start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()}};r.correlationId=e.CorrelationId,r[i.server]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},E.logPerf(r);const o=await this.getItemsAsync("getItemsSlideInfosAsync");if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&"ServerErrorFileDownloadResourceInconsistent"===o.errorCode)return{slideInfo:[],responseErrorCode:"ServerErrorFileDownloadResourceInconsistent",responseErrorCategory:o.errorCategory,itemErrorCodeMap:void 0};r[i.server].end=E.performanceNowTrimmed(),o&&o.response&&o.response.headers&&(r[i.contentLength]=o.response.headers.get(i.ContentLength)),r[i.parser]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},E.logPerf(r);const n=this.setTimeoutForParsingResponse(r),l=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(o,r),r);return clearTimeout(n),r[i.parser].end=E.performanceNowTrimmed(),r[i.usedOutputCache]=!!l.usedOutputCache&&"true"===l.usedOutputCache.trim().toLowerCase(),r[i.itemUsedOutputCacheMap]=!!l.itemUsedOutputCacheMap&&Array.from(l.itemUsedOutputCacheMap.entries()),r[i.podsProxyCallSuceeded]=!0,E.logPerf(r),l.metadata=this.generateReportPerfDictionary(r),l}catch(e){return g.sendTraceTag(570950493,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: "+e),t[i.podsProxyCallSuceeded]=!1,E.logPerf(t),{slideInfo:[],responseErrorCode:"ErrorRESERVEDItemFailed",responseErrorCategory:"Transient",itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}}}async getItemsResourceAsync(e){this.m_slideResourceOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideResourceInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideResourceInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideResourceInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideResourceInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideResourceInputProperties.TranslateLanguage},this.m_slideResourceOptions.Filters.EnableClustering=void 0!==e.EnableClustering&&e.EnableClustering,this.m_itemsList=new Array;for(let t of e.ResourceParams){this.m_slideResourceOptions.InputProperties.ResourceId=t.Id;let e="";switch(String(t.Name.match("[^.]+$"))){case"jpg":e=d.ImageJpg;break;case"png":e=d.ImagePng}this.m_itemsList.push({Id:t.Name,AcceptTypes:e?[e]:E.s_supportedImageType,Options:JSON.stringify(this.m_slideResourceOptions)})}this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(i.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(i.XCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(i.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const t={action:"getItemsResourceAsync",correlationId:e.CorrelationId,server:{start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()}};E.logPerf(t);const s=await this.getItemsAsync("getItemsResourceAsync");t[i.server].end=E.performanceNowTrimmed(),s&&s.response&&s.response.headers&&(t[i.contentLength]=s.response.headers.get(i.ContentLength)),t[i.parser]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},E.logPerf(t);const r=this.setTimeoutForParsingResponse(t),o=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(s,t),t);return clearTimeout(r),t[i.parser].end=E.performanceNowTrimmed(),t[i.usedOutputCache]=!!o.usedOutputCache&&"true"===o.usedOutputCache.trim().toLowerCase(),t[i.itemUsedOutputCacheMap]=!!o.itemUsedOutputCacheMap&&Array.from(o.itemUsedOutputCacheMap.entries()),E.logPerf(t),o.metadata=this.generateReportPerfDictionary(t),o}async getItemsSlideOrderAndSlidesInfoIndexAsync(e,t,s){this.m_getItemsRequest.Items.push({Id:a.PresinfoslimSlideOrder,AcceptTypes:[d.JsonType],Options:JSON.stringify(s)});let r=JSON.stringify(t);e&&e.forEach(e=>{this.m_getItemsRequest.Items.push({Id:`${a.slideInfoIndex}${e}`,AcceptTypes:[d.ImagePng,d.ImageJpg],Options:r})});const o={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()}};E.logPerf(o);const n=await this.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync");o[i.server].end=E.performanceNowTrimmed(),o[i.parser]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},n&&n.response&&n.response.headers&&(o[i.contentLength]=n.response.headers.get(i.ContentLength)),E.logPerf(o);const l=this.setTimeoutForParsingResponse(o);let p=await this.createSlideOrderAndSlidesInfoIndexResponse(this.parseMultipartResponseAsync(n,o));return clearTimeout(l),o[i.parser].end=E.performanceNowTrimmed(),o[i.usedOutputCache]=!!p.usedOutputCache&&"true"===p.usedOutputCache.trim().toLowerCase(),o[i.itemUsedOutputCacheMap]=!!p.itemUsedOutputCacheMap&&Array.from(p.itemUsedOutputCacheMap.entries()),E.logPerf(o),p.metadata=this.generateReportPerfDictionary(o),p}async getPresInfoAsync(e){g.sendTraceTag(593896001,c.msoulscat_Wac_PptSession,p.Info,`PodsProxy::getPresInfoAsync - Function:${e}, requestCorrelation:${this.m_requestHeaders.get(i.CallerCorrelationId)}`);const t=await C.a.post(this.m_podsUrl+"/presinfo.ashx",{json:this.m_getPresInfoRequest,headers:this.m_requestHeaders,timeout:3e4}).catch(async t=>{throw g.sendTraceTag(595686995,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy:getPresInfo - Function: ${e}, Error: ${t}`),t});return g.sendTraceTag(595686996,c.msoulscat_Wac_PptSession,t.ok?p.Info:p.Error,`PodsProxy::getPresInfo - Function: ${e}, Status:${t.status}, StatusText: ${t.statusText}, CorrelationId: ${t.headers.get(i.XCorrelationId)}`),t}static getFieldFromReponseHeader(e,t){return e.headers?e.headers.get(t):i.unknown}async getItemsAsync(e,t){const s=this.m_requestHeaders.get(i.CallerCorrelationId);g.sendTraceTag(593896002,c.msoulscat_Wac_PptSession,p.Info,`PodsProxy::getItemsAsync - Function:${e}, requestCorrelation:${s}`);const r={errorCode:"ErrorRESERVEDSuccess"};let o=r,n="getItemsPresInfoAndSlideInfoAsync"===e&&this.m_settings.shouldUseBootRequestTimeout&&this.m_settings.bootRequestTimeout?this.m_settings.bootRequestTimeout:this.m_settings.timeout;t&&t.overrideGetItemsTimeoutMs&&(n=t.overrideGetItemsTimeoutMs),this.m_requestHeaders.set(i.dateHeader,(new Date).toISOString()),this.m_requestHeaders.set(i.clientTimeoutHeader,n.toString()),this.m_requestHeaders.set(i.callId,this.m_settings.callId||"empty");const a=this.m_podsUrl+"/getitems.ashx",d=this.m_getItemsRequest.Items.map(e=>e.Id);E.s_events.emit("networkCall",{url:a,itemIds:d}),o=await C.a.post(a,{json:this.m_getItemsRequest,headers:this.m_requestHeaders,timeout:n,throwHttpErrors:this.m_settings.throwHttpErrors}).catch(async t=>{const o=t.response&&t.response.headers?t.response.headers.get(i.XCorrelationId):i.unknown,n=t.response&&t.response.headers?t.response.headers.get(i.ErrorCode):i.unknown,a=t.response&&t.response.headers?t.response.headers.get(i.ErrorCategory):i.unknown,d=t.response&&t.response.status?t.response.status:i.unknown;let l=t.toString();l.length>0&&("."===l.slice(-1)||"。"===l.slice(-1))&&(l=l.slice(0,-1));let u=this.getMappedError(l);return u?r.errorCode=u:"HTTPError"===t.name&&d!==i.unknown&&500!==d&&this.m_errorMap.has(d)?r.errorCode=this.m_errorMap.get(d):"TimeoutError"===t.name?r.errorCode="ErrorRequestTimeout":r.errorCode=E.convertServerError(n,this.m_settings.enableServerSpecificErrorCode),this.m_settings.shouldUpdateNewFileUrlFromSnap&&"ServerErrorFileDownloadResourceInconsistent"===r.errorCode&&(r.newSnapUrl=E.getFieldFromReponseHeader(t.response,i.newSnapUrlHeader)),r.errorCategory=a&&""!==a.trim()&&a!==i.unknown?a:"Transient",g.sendTraceTag(595687001,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy:getItems - Function:${e}, Error:${t}, ErrorName:${t.name}, Status:${t.status}, HeaderCorrelationId:${o}, HeaderErrorCode:${n}, HeaderErrorCategory:${a}, result.errorCode:${r.errorCode}, requestCorrelation:${s}, status:${d}`),r}),r.response=o;try{if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&("ServerErrorFileDownloadResourceInconsistent"===r.errorCode||r.newSnapUrl)){if(g.sendTraceTag(541403227,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),r.newSnapUrl)return g.sendTraceTag(541403228,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",r.newSnapUrl),r;g.sendTraceTag(541345432,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){g.sendTraceTag(541403229,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}200!==o.status&&"ErrorRESERVEDSuccess"===r.errorCode&&(o.headers&&o.headers.get(i.ErrorCode)?(r[i.errorCode]=E.convertServerError(o.headers.get(i.ErrorCode)),r[i.errorCategory]=o.headers.get(i.ErrorCategory)?o.headers.get(i.ErrorCategory):"BadRequest"):(o.status!==i.unknown&&this.m_errorMap.has(o.status)?r[i.errorCode]=this.m_errorMap.get(o.status):r[i.errorCode]="ErrorRequestFailed",r[i.errorCategory]="Transient"));const l={functionName:e,status:o.status,statusText:o.statusText,headerCorrelation:o.headers?o.headers.get(i.XCorrelationId):"",headerErrorCode:o.headers?o.headers.get(i.ErrorCode):"",headerErrorCategory:o.headers?o.headers.get(i.ErrorCategory):"",requestCorrelation:s,resultErrorCode:r.errorCode,resultErrorCategory:r.errorCategory};return g.sendTraceTag(595687002,c.msoulscat_Wac_PptSession,o.ok?p.Info:p.Error,JSON.stringify(l)),r}async getSessionUtcAsync(){let e=-1;const t=await C.a.get(this.m_podsUrl+"/podhandler.ashx?action=GetSessionUTC&format=jsms",{timeout:2500}).catch(async e=>{g.sendTraceTag(587831243,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getSessionUtcAsync - Error: "+e)});try{t?(e=parseInt(await t.text(),10),g.sendTraceTag(587831244,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy::getSessionUtcAsync: "+e)):g.sendTraceTag(572613792,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getSessionUtcAsync - Null response.")}catch(e){g.sendTraceTag(587831245,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::getSessionUtcAsync - error parsing response. "+e)}return e}updateDocSource(e){g.sendTraceTag(573855198,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:g.sendTraceTag(573855199,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:g.sendTraceTag(573855200,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}async generateSnapDownloadUrlAsync(e,t){try{g.sendTraceTag(573875969,c.msoulscat_Wac_PptSession,p.Info,`PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ${e.ID}.`);const s=new Headers;s.append(i.ContentType,"application/json; charset=utf-8"),s.append(i.CallerCorrelationId,e.ID),t&&t.forEach((e,t)=>{s.append(t,e)});const r=this.m_podsUrl+"/SnapUrlHandler.ashx",o=await C.a.post(r,{json:e,headers:s,timeout:this.m_settings.timeout,throwHttpErrors:this.m_settings.throwHttpErrors}).catch(async e=>{g.sendTraceTag(573875971,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : "+e)});let n="";if(o){let e=await o.json();g.sendTraceTag(573875972,c.msoulscat_Wac_PptSession,p.Info,`PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:${e.FSuccess}, ErrorCode:${e.ErrorCode}`),e.FSuccess?n=e.SnapUrl:g.sendTraceTag(573875973,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : "+e.ErrorCode)}return n}catch(e){return g.sendTraceTag(573875974,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: "+e),""}}setErrorMap(){let e=["cancelled","cancelado","キャンセルしました","Abgebrochen","취소됨","已取消","annulé","مُلغى","avbruten","отменено","annullato","zrušeno","poništeno","geannuleerd","ถูกยกเลิก","avbrutt","annulleret","скасовано","בוטל","đã huỷ","Kumottu","dibatalkan","vazgeçildi","anulat","anulowane","ακυρώθηκε","visszavonva"];for(let t=0;t<e.length;t+=1)this.m_errorMap.set(e[t],"ErrorRequestCanceled");let t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexión de red se perdió","ネットワーク接続が切れました","La connexion réseau a été perdue","Сетевое соединение потеряно","網路連線中斷","การเชื่อมต่อกับเครือข่ายหายไป","Зʼєднання з мережею втрачено","网络连接已中断","Nätverksanslutningen förlorades","A conexão de rede foi perdida","Ağ bağlantısı kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione è stata persa","A ligação à rede foi interrompida","Mistet nettverksforbindelsen","La conexión de red se ha perdido","網絡連線中斷","Đã mất kết nối mạng","Kehilangan jaringan koneksi","تم فقدان اتصال الشبكة","無法連接伺服器","네트워크 연결이 유실되었습니다","Verkkoyhteys katkesi","Netværksforbindelsen gik tabt","Bylo ztraceno připojení k síti","Połączenie sieciowe zostało utracone","A conexão à internet parece estar desativada","The Internet connection appears to be offline","La conexión a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de rețea a fost pierdută","ネットワーク接続が切れました","החיבור לרשת אבד","NetworkError when attempting to fetch resource","无法连接服务器","No se ha podido establecer conexión con el servidor","Tidak dapat terhubung ke server","ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้","No se pudo establecer conexión con el servidor","A hálózati kapcsolat megszakadt"];for(let e=0;e<t.length;e+=1)this.m_errorMap.set(t[e],"ErrorConnectionLost");let s=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operación. El software causó la anulación de la conexión","Không thể hoàn tất tác vụ. Phần mềm đã khiến kết nối bị hủy bỏ","تعذر إكمال العملية. ‏نتج عن البرنامج إيقاف الاتصال قبل اكتماله","Не удалось завершить операцию. Программа вызвала разрыв подключения","The operation couldn’t be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","L’opération n’a pas pu s’achever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operación. El software causó la anulación de la conexión","A operação não pôde ser concluída. O software provocou o cancelamento da conexão","No se ha podido completar la operación. El software ha causado la anulación de la conexión","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","未能完成该操作。软件导致连接中止","無法完成作業。軟體導致連線失敗","無法完成操作。軟件導致連線失敗","ไม่สามารถดำเนินการให้เสร็จสิ้นได้ ซอฟต์แวร์เป็นสาเหตุให้ยกเลิกการเชื่อมต่อ","操作を完了できませんでした。ソフトウェアにより接続が中止されました","Postupak se nije mogao dovršiti. Softver je uzrokovao prekid veze","Åtgärden kunde inte slutföras. Program orsakade avbrott i anslutningen","İşlem tamamlanamadı. Yazılım bağlantının kesilmesine neden oldu","Не вдалося завершити операцію. Програма обірвала звʼязок"];for(let e=0;e<s.length;e+=1)this.m_errorMap.set(s[e],"ErrorSoftwareConnectionAbort");let r=["The request timed out","要求がタイムアウトになりました","La requête a expiré","要求がタイムアウトになりました","Se agotó el tiempo de espera","Esgotou-se o tempo limite da solicitação","请求超时"];for(let e=0;e<r.length;e+=1)this.m_errorMap.set(r[e],"ErrorRequestTimeout");let o=["cannot parse response","impossible d’analyser la réponse","无法解析响应"];for(let e=0;e<o.length;e+=1)this.m_errorMap.set(o[e],"ErrorCannotParseResponse");this.m_errorMap.set("The operation was aborted","ErrorRequestAbort"),this.m_errorMap.set("Failed to fetch","ErrorFailedToFetch"),this.m_errorMap.set(404,"ErrorRequestFailedServerNotFound"),this.m_errorMap.set(502,"ErrorRequestFailedBadGateway"),this.m_errorMap.set(503,"ErrorRequestFailedServiceUnavailable"),this.m_errorMap.set(504,"ErrorRequestFailedGatewayTimeout")}getMappedError(e){let t=e;return t=E.trimErrorName(t,["TypeError:","Loading failed:"]),t.indexOf("Bylo ztraceno")>=0?"ErrorConnectionLost":t.indexOf("AbortError:")>=0?"ErrorRequestAbort":this.m_errorMap.get(t)}static trimErrorName(e,t){let s=e;for(let e=0;e<t.length;e+=1)s.lastIndexOf(t[e])>=0&&(s=s.substring(s.lastIndexOf(t[e])+t[e].length));return s?s.trim():""}static convertServerError(e,t){return t&&e&&""!==e.trim()&&e!==i.unknown?"Server"+e:"ErrorRequestFailed"}async parseMultipartResponseAsync(e,t,s){let n={},a={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",data:void 0},d={slideOrder:[],slideAllInfo:[]};if(t[i.firstResponseCheck]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},e.response&&e.response.body&&e.response.headers&&e.response.headers.get(i.ContentType)){const l=e.response;let u="";try{t[i.fetchBoundary]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},u=this.m_multipartParser.fetchBoundary(l.headers.get(i.ContentType)),t[i.fetchBoundary].end=E.performanceNowTrimmed()}catch(e){const t=l.headers.get(i.ErrorCode),s=l.headers.get(i.ErrorCategory),r=l.headers.get(i.XCorrelationId);return g.sendTraceTag(593253142,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ${l.headers.get(i.ContentType)}, ErrorCode:${t}, ErrorCategory:${s}, Correlation:${r}, Exception:${e}`),a.responseErrorCode=t||"ErrorRequestFailed",a.responseErrorCategory=s||"BadRequest",a}const m=E.performanceNowTrimmed();t[i.downloadResponse]={start:m,end:m},g.sendTraceTag(561640520,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy::parseMultipartResponse - download response stream start: "+m),s&&s.requestType===r.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.DownloadResponseStream});let h,f=!1,C=void 0,I=null;const S=l.headers?l.headers.get(i.ContentLength):-1;let P=-1;if(g.sendTraceTag(545063708,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: "+this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength),this.m_settings.parsingWhileDownloadingEnabled){let e=!1,h=!1,C=n=>{e=!0,h=n;let a={receivedDataLength:P,responseContentLength:S,duration:E.performanceNowTrimmed()-m,downloadFailed:h};g.sendTraceTag(529331328,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy - return from response stream reading. "+JSON.stringify(a));let d=E.performanceNowTrimmed();g.sendTraceTag(529331329,c.msoulscat_Wac_PptSession,p.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${d}, duration: ${d-m}`),t[i.downloadResponse].end=d,t[i.downloadResponse].length=P,!f&&s&&s.requestType===r.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.ParseMultipartResponse})};P=0;const I=l.body,[T,w]=I.tee(),R=new Promise(async e=>{try{const t=_.Settings.readNumberOrDefault("hackMaxBytes",-1),s=T.getReader();for(;;){const{done:r,value:o}=await s.read();if(r){C(!1),e();break}if(o&&(P+=o.length,t>0&&P>t))throw"hackMaxBytes hit"}}catch(t){g.sendTraceTag(528766114,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::measuringDownloadPromise - exception ${t}.`),C(!0),e()}});let v;if(s&&s.shouldTimeoutResponseStreamDownload){const t=s&&s.overrideDownloadTimeoutMs?s.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4;v=window.setTimeout(()=>{e||(f=!0,g.sendTraceTag(529331330,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),g.sendTraceTag(529331331,c.msoulscat_Wac_PptSession,p.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),T.cancel(),w.cancel())},t)}const O=new y(this.m_settings,n,t,a),M=this.m_multipartParser.processMultipartBinaryResponse(w.getReader(),u,e=>{O.parsePart(e)});if(await Promise.all([R,M]),h)return _.Settings.readBooleanOrDefault("retryOnNetworkFailure",!1)&&(a.responseErrorCode="ErrorRequestFailed",a.responseErrorCategory="Transient"),a.data=void 0,a;if(s&&s.shouldTimeoutResponseStreamDownload&&(clearTimeout(v),g.sendTraceTag(529331332,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy - response download check. "+JSON.stringify({hasTimeout:f,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:P,responseContentLength:S}))),f){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&S>0&&P>0&&S===P))return a.responseErrorCode="ErrorDownloadResponseStreamTimeout",a;g.sendTraceTag(529331333,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}d=O.parsedResponse}else{if(s&&s.shouldTimeoutResponseStreamDownload){const e=s&&s.overrideDownloadTimeoutMs?s.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4,t="downloadResponseStreamTimeout";let r,o=new Promise(s=>{C=setTimeout(()=>{g.sendTraceTag(560347103,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),r&&(g.sendTraceTag(558465244,c.msoulscat_Wac_PptSession,p.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),r.cancel()),s(t)},e)});r=l.body.getReader(),I=this.readResponseStream(r,S),I.then(e=>{P=e&&e.length||-1;let t={receivedDataLength:P,responseContentLength:S,duration:E.performanceNowTrimmed()-m};g.sendTraceTag(558465177,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy - return from response stream reading. "+JSON.stringify(t))}),h=await Promise.race([I,o]),h===t?f=!0:void 0!==C&&clearTimeout(C)}else{h=new Uint8Array(await l.arrayBuffer());const e=_.Settings.readNumberOrDefault("hackMaxBytes",-1);e>0&&h.length>e&&(h=h.slice(0,e))}if(s&&s.shouldTimeoutResponseStreamDownload&&g.sendTraceTag(543019648,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy - response download check. "+JSON.stringify({hasTimeout:f,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:P,responseContentLength:S})),f){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&I&&S>0&&P>0&&S===P))return a.responseErrorCode="ErrorDownloadResponseStreamTimeout",a;g.sendTraceTag(558465245,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),h=await I}const e=E.performanceNowTrimmed();g.sendTraceTag(561640521,c.msoulscat_Wac_PptSession,p.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${e}, duration: ${e-m}`);let T=h;t[i.downloadResponse].end=e,T&&T.length&&(t[i.downloadResponse].length=T.length),s&&s.requestType===r.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.ParseMultipartResponse});const w=new y(this.m_settings,n,t,a);await this.m_multipartParser.processMultipartBinaryResponse(T,u,e=>{w.parsePart(e)},{forceNewCodePath:!0}),d=w.parsedResponse}}else{const t=e.hasOwnProperty(i.errorCode)&&"ErrorRESERVEDSuccess"!==e[i.errorCode]?e[i.errorCode]:"ErrorRequestFailed",s=e[i.errorCategory]?e[i.errorCategory]:"BadRequest";a.responseErrorCode=t,a.responseErrorCategory=s,g.sendTraceTag(593253143,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::parseMultipartResponse - responseErrorCode:${t}, responseErrorCategory:${s}`)}t[i.firstResponseCheck].end=E.performanceNowTrimmed(),"ErrorRESERVEDSuccess"!==a.responseErrorCode&&"ErrorRESERVEDSuccess"===a.responseErrorCategory&&(a.responseErrorCategory="BadRequest",g.sendTraceTag(593253145,c.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:"+a.responseErrorCode));for(let e in n)d.slideAllInfo.push({ID:n[e].ID,SlideImageData:n[e].SlideImageData,SlideShowInfo:n[e].SlideShowInfo,Title:n[e].Title,NoteHtml:n[e].NoteHtml,Comments:n[e].Comments,HasAnimation:n[e].HasAnimation,Hidden:n[e].Hidden,HasTransition:n[e].HasTransition,ResourceData:n[e].ResourceData,AccessibilityModel:n[e].AccessibilityModel});return a.data=d,a}async readResponseStream(e,t){let s=new Uint8Array(0);try{let r=await e.read();for(;!r.done;){s=new Uint8Array([...s,...r.value]);const o=_.Settings.readNumberOrDefault("hackMaxBytes",-1);if(o>0&&s.length>o)throw s=s.slice(0,o),"hackMaxBytes hit";if(t>0&&s.length===t&&(g.sendTraceTag(545063709,c.msoulscat_Wac_PptSession,p.Info,"PodsProxy::readResponseStream - received length reached content length: "+t),this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength))break;r=await e.read()}}catch(e){return g.sendTraceTag(558465246,c.msoulscat_Wac_PptSession,p.Error,`PodsProxy::readResponseStream - exception ${e}.`),new Uint8Array(0)}return s}generateReportPerfDictionary(e){let t={};return e[i.action]&&(t[i.action]=e[i.action]),e[i.correlationId]&&(t[i.correlationId]=e[i.correlationId]),e[i.server]&&(t[i.server]=e[i.server]),e[i.parser]&&(t[i.parser]=e[i.parser]),e[i.downloadResponse]&&(t[i.downloadResponse]=e[i.downloadResponse]),e[i.usedOutputCache]&&(t[i.usedOutputCache]=e[i.usedOutputCache]),e[i.contentLength]&&(t[i.contentLength]=e[i.contentLength]),t}createPresInfoAndSlideInfoResponse(e,t){let s={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",presInfo:void 0,slideInfo:[]};return t[i.createResponse]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},s={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap},t[i.createResponse].end=E.performanceNowTrimmed(),s}async createSlideInfoResponse(e,t){let s={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",slideInfo:[]};return t[i.createResponse]={start:E.performanceNowTrimmed(),end:E.performanceNowTrimmed()},await e.then(e=>{s={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t[i.createResponse].end=E.performanceNowTrimmed(),s}async createSlideIdResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t}async createPresInfoResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",presInfo:void 0};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t}static logPerf(e){g.sendTraceTag(594564678,c.msoulscat_Wac_PptSession,p.Info,""+JSON.stringify(e))}static ensureISlideInfoFilters(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}static performanceNowTrimmed(){return Math.round(performance.now())}async createSlideOrderAndSlidesInfoIndexResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:"ErrorRESERVEDSuccess",responseErrorCode:"ErrorRESERVEDSuccess",slideInfo:[],slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}),t}static logPerformanceEntries(e){const t=e.getEntriesByType("resource"),s={};for(let e of t){const t=e;if("fetch"!==t.initiatorType)continue;let r=!1;if(r=u.ChangeGate.isChangeGateEnabled("PodsProxy.logAdditionalPerfTiming")?t.name.indexOf("getitems.ashx")>0||t.name.indexOf("getmedia.ashx")>0||t.name.indexOf("remoteuls.ashx")>0||t.name.indexOf("podhandler.ashx")>0||t.name.indexOf("remotetelemetry.ashx")>0:t.name.indexOf("getitems.ashx")>0,r){if(s.name=t.name,s.dateTime=performance.now(),u.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){const e=new URL(t.name);s.hostname=e.hostname,s.pathname=e.pathname}s.start=t.startTime,s.redirectStart=t.redirectStart,s.redirectEnd=t.redirectEnd,s.domainLookupStart=t.domainLookupStart,s.domainLookupEnd=t.domainLookupEnd,s.tcpHandshakeStart=t.connectStart,s.tcpHandshakeEnd=t.connectEnd,s.secureConnectionStart=t.secureConnectionStart,s.responseStart=t.responseStart,s.responseEnd=t.responseEnd,s.fetchStart=t.fetchStart,s.requestStart=t.requestStart,"decodedBodySize"in t&&(s.decodedBodySize=t.decodedBodySize),"encodedBodySize"in t&&(s.encodedBodySize=t.encodedBodySize),"transferSize"in t&&(s.transferSize=t.transferSize),Object.keys(s).length>0&&g.sendTraceTag(572379986,c.msoulscat_Wac_PptSession,p.Info,""+JSON.stringify(s))}}}setTimeoutForParsingResponse(e){return window.setTimeout(()=>{g.sendTraceTag(571342915,c.msoulscat_Wac_PptSession,p.Warning,"Parsing didn't finish in the time. "+JSON.stringify(e))},this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}objectDictionaryToRequestIdString(e){let t="";for(let s in e)e[s]&&(t=`${t}${s}=${e[s]};`);return t}}E.s_events=new I.EventEmitter,E.s_supportedImageType=[d.ImagePng,d.ImageJpg],s.d(t,"exposed",(function(){return S})),s.d(t,"setupGlobals_PodsProxy",(function(){return P})),s.d(t,"PodsProxy",(function(){return E})),s.d(t,"PodsProxyRequestType",(function(){return r})),s.d(t,"PodsProxyRequestStageType",(function(){return o})),s.d(t,"PodsProxyConstants",(function(){return i})),s.d(t,"SlideImageAppendOption",(function(){return n})),s.d(t,"GetRequestItemIds",(function(){return a})),s.d(t,"ItemType",(function(){return d}))}])}));
//# sourceMappingURL=PodsProxy.js.map