'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1036:function(I,Y,d){I=d(0);var h;(function(n){n[n.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";n[n.peopleImageClassName=1]="peopleImageClassName";n[n.peopleImageClusterPath=4]="peopleImageClusterPath";n[n.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";n[n.imageDimension=6]="imageDimension";n[n.rtl=8]="rtl";n[n.pointerInputManager=9]="pointerInputManager";n[n.clickInputManager=
10]="clickInputManager";n[n.vertical=11]="vertical";n[n.zIndex=12]="zIndex";n[n.contextMenuInputManager=13]="contextMenuInputManager";n[n.imageDomElement=14]="imageDomElement";n[n.useIdleTooltip=15]="useIdleTooltip";n[n.viewportBoundsCallback=16]="viewportBoundsCallback";n[n.flipHorizontalDirection=17]="flipHorizontalDirection";n[n.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";n[n.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";n[n.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(I.b)("PresenceTooltipSettingKeys",h);d.d(Y,"a",function(){return e});class e{constructor(){this.Ny={}}get(n,m=null){n=h[n];return"number"===typeof m?(m=this.Ny[n])?Number.parseInvariant(m.toString()):0:this.Ny[n]}add(n,m){this.Ny[h[n]]=m}MD(n,m){h[n]in this.Ny||(this.Ny[h[n]]=m)}remove(n){delete this.Ny[h[n]]}}Object(I.a)(e,"PresenceTooltipSettings",null,[])},1037:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(14),n=d(1062),m=d(352),z=d(18);class B{constructor(y){this.messageId=y;this.t8k=
(new Date).getTime();this.qne=new z.a}}Object(I.a)(B,"MessageLatencyDetails",null,[]);d.d(Y,"ClientToClientMessageTelemetry",function(){return v});class v{constructor(y,A,E){this.oqa=null;this.KFd=this.qKd=0;this.Jc=A;this.Gif=E;this.GWb=!1;this.rl=y;this.rl.WBa(Object(e.a)(this,this.$Qk,"receiveMessage"))}start(){if(this.Gif&&!this.GWb){const y=this.Jc.nmh;this.KFd=this.Jc.kmh;y<=this.KFd?(h.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.Jc.nmh,this.Jc.kmh),this.Gif=!1):(this.GWb=!0,this.qKd=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),y))}}sendMessage(){if(this.GWb){const y=m.a.create().toString();this.oqa=new B(y);this.rl.gPe(16,y,!1,new n.a);window.setTimeout(()=>{this.e3j(y)},this.KFd)}}e3j(y){this.oqa&&this.oqa.messageId===y&&(0<this.oqa.qne.count?(y=this.oqa.qne.toArray().join(","),h.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",y)):h.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),
this.oqa=null)}stop(){this.qKd&&(window.clearInterval(this.qKd),this.GWb=!1)}$Qk(y,A){16===A.type?this.rl.gPe(17,A.Eza,!1,new n.a):17===A.type&&this.GWb&&A.Eza&&this.lKk(A.Eza)}lKk(y){y&&this.oqa&&y.toString()===this.oqa.messageId&&this.oqa.qne.add((new Date).getTime()-this.oqa.t8k)}static get instance(){return v.Ka}static pej(y,A,E){return v.instance||(v.Ka=new v(y,A,E))}}v.Ka=null;Object(I.a)(v,"ClientToClientMessageTelemetry",null,[])},1136:function(I,Y,d){d.r(Y);d.d(Y,"RealtimeChannelMetrics",
function(){return z});I=d(0);var h=d(387),e=d(176),n=d(105),m=d(190);class z{constructor(){this.Ijf=this.Jjf=this.Kjf=this.Gjf=this.Fjf=this.Hjf=this.cVb=this.UGd=0;this.uyc=this.fFd=this.pUb=this.WEd=this.XEd=this.OEd=this.$Na=this.jUb=this.Mob=this.NEd=this.syc=this.Wnb=null;this.PFd=this.MUb=this.Wnf=this.k9e=0;this.Iif=!1;this.Dkd=this.yPe;this.BPe=this.CPe;this.Ekd=this.APe;this.Onc=this.EPe;this.Dfh=this.DPe;this.LPe=this.MPe;this.IPe=this.JPe;this.kib=this.GPe;this.Qnc=this.HPe;this.yfh=this.zPe;
this.zGb=this.iFe;this.qjc=this.jFe}yPe(){this.UGd++;this.NEd=new Date;this.Wnb||(this.Wnb=new Date)}CPe(){this.cVb++;this.$Na=new Date;this.syc||(this.syc=this.$Na);this.pUb=this.$Na;this.Hwi()}APe(){this.Hjf++;this.OEd=new Date}EPe(){this.Fjf++;this.Mob=new Date}DPe(){this.Gjf++;this.jUb=new Date}JPe(){this.XEd=new Date;this.Kjf++}HPe(){this.uyc||(this.uyc=new Date);this.Jjf++}GPe(){this.WEd=new Date;this.Ijf++}MPe(){if(!this.Iif&&this.UGd){var B=this.gKc();h.ULS.sendTraceTag(39321871,500,15,n.a.toJSON(B));
this.Iif=!0}}zPe(B){let v,y;({Wce:B,Xce:v,Yi:y}=m.RtcUtils.$Tf(B));B&&B!==e.a.Uv&&(h.ULS.sendTraceTag(40157596,500,15,n.a.toJSON({["HttpErrorCode"]:B,["HttpErrorStatus"]:v,["Exception"]:y})),e.a.Wgg(B)&&this.k9e++,e.a.emg(B)&&this.Wnf++)}iFe(){this.fFd=new Date}jFe(){this.Mob=this.pUb=new Date}gKc(){return{["numberOfConnectionAttempts"]:this.UGd,["numberOfSuccessfulConnections"]:this.cVb,["numberOfFailedConnections"]:this.Hjf,["numberOfDisconnectedConnections"]:this.Fjf,["numberOfExplicitDisconnectedConnections"]:this.Gjf,
["numberOfSentMessages"]:this.Kjf,["numberOfReceivedMessages"]:this.Jjf,["numberOfLostMessages"]:this.Ijf,["firstConnectionAttempt"]:this.Wnb?this.Wnb:null,["firstMessageReceived"]:this.uyc?this.uyc:null,["firstConnectionSuccess"]:this.syc?this.syc:null,["lastConnectionAttempt"]:this.NEd?this.NEd:null,["lastConnectionSuccess"]:this.$Na?this.$Na:null,["lastConnectionFailure"]:this.OEd?this.OEd:null,["lastMessageSent"]:this.XEd?this.XEd:null,["lastMessageLost"]:this.WEd?this.WEd:null,["lastDisconnect"]:this.Mob?
this.Mob:null,["lastExplicitDisconnect"]:this.jUb?this.jUb:null,["lastTimeOnline"]:this.pUb?this.pUb:null,["lastTimeOffline"]:this.fFd?this.fFd:null,["maxDisconnectedTimeMs"]:this.MUb,["maxExplicitDisconnectedTimeMs"]:this.PFd,["clientConnectionErrors"]:this.k9e,["serverConnectionErrors"]:this.Wnf}}Hwi(){this.Wnb&&1===this.cVb&&(this.MUb=Math.max(this.MUb,this.$Na.getTime()-this.Wnb.getTime()));this.Mob&&1<this.cVb&&(this.MUb=Math.max(this.MUb,this.$Na.getTime()-this.Mob.getTime()));this.jUb&&1<this.cVb&&
(this.PFd=Math.max(this.PFd,this.$Na.getTime()-this.jUb.getTime()))}static createInstance(B){z.Ka||(z.Ka=new z,h.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",B));return z.Ka}}z.Ka=null;Object(I.a)(z,"RealtimeChannelMetrics",null,[1357,278])},1137:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n){super();this.tPb=e;this.XOf=n}}Object(I.a)(h,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1138:function(I,Y,d){d.d(Y,
"a",function(){return h});I=d(0);var h;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";e[e.last=10]="last"})(h||(h={}));Object(I.b)("RtcClientAppName",h)},1141:function(I,Y,d){I=d(0);var h=d(387),e=d(14),n=d(237),m=d(238);class z{static s6d(F,sa,ia){return z.t6d(F,
sa,ia,!0)}static t6d(F,sa,ia,Na){const Ca=document.createElementNS(z.gmb,"svg");Ca.setAttribute("viewBox",String.format(z.sZd,z.Xuc,z.Wuc));Ca.appendChild(z.C$d(F,sa,ia,Na));return Ca}static C$d(F,sa,ia,Na){const Ca=z.Xuc/F,ha=sa/2*Ca,Ba=z.Wuc/2;let va=0;Na&&(va=(F-3*sa-4*ia)*Ca/2);F=document.createElementNS(z.gmb,"g");Sys.UI.DomElement.addCssClass(F,z.rZd);for(Na=1;3>=Na;Na++)F.appendChild(z.S5d(Na,ha,va+(Na*(sa+ia)-sa/2)*Ca,Ba));return F}static S5d(F,sa,ia,Na){const Ca=document.createElementNS(z.gmb,
"circle");Sys.UI.DomElement.addCssClass(Ca,String.format("{0}-{1}",z.WUd,F));Ca.setAttribute("cx",String.format("{0}",ia));Ca.setAttribute("cy",String.format("{0}",Na));Ca.setAttribute("r",String.format("{0}",sa));return Ca}}z.gmb="http://www.w3.org/2000/svg";z.rZd="prDancingDots";z.WUd="prAnimateCircle";z.sZd="0 0 {0} {1}";z.Wuc=40;z.Xuc=120;Object(I.a)(z,"ModernPresenceTooltipDancingDots",null,[]);var B=d(27),v=d(174),y=d(75),A=d(67),E=d(134),u=d(199),J=d(97),G=d(47),S=d(2);class P extends n.a{constructor(F,
sa){super(F);this.RXb=this.gS=this.u2a=this.gN=this.bN=this.$o=this.Ln=null;this.lI=sa.get(8,!1);this.dS=sa.get(6,0);this.cNd=sa.get(15,!1);this.Jc=sa;this.mSb=0;this.element=F;this.element.className=P.W8a;this.Ws=document.createElement("span");this.element.appendChild(this.Ws);this.oAd=z.s6d(sa.get(6,0),4,2);this.OJ(sa);this._state=5}bW(F){this.addHandler(m.a.kp,F)}g1(F){this.removeHandler(m.a.kp,F)}get user(){return this.RXb}get state(){return this._state}dispose(){this.element&&(this.Ln.yb(A.a.click,
this.element,Object(e.a)(this,this.onClick,"onClick")),this.Ln.yb(A.a.doubleClick,this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(A.a.pointerDown,this.element,Object(e.a)(this,this.ixa,"onPointerDown")),this.$o.yb(A.a.pointerOut,this.element,Object(e.a)(this,this.yz,"onPointerOut")),this.$o.yb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver")),this.bN.yb(this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")));
super.dispose()}OJ(F){this.Ln=F.get(10);this.Ln.pb(A.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.Ln.pb(A.a.doubleClick,this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"));this.$o=F.get(9);this.$o.pb(A.a.pointerOver,this.element,Object(e.a)(this,this.cD,"onPointerOver"));this.$o.pb(A.a.pointerOut,this.element,Object(e.a)(this,this.yz,"onPointerOut"));this.$o.pb(A.a.pointerDown,this.element,Object(e.a)(this,this.ixa,"onPointerDown"));this.bN=F.get(13);
this.bN.pb(this.element,Object(e.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"))}hide(F=null,sa=0,ia=0){this.cNd&&F?this.BYe(F,sa,ia):(3===this.state&&this.noc(),this.visible=!1,this._state=5)}BYe(F,sa,ia=0){this.show(F,sa,15,4,void 0,ia)}krc(F,sa,ia,Na=!1,Ca=!1,ha=!1,Ba=0){this.show(F,sa,ia+20,Na?2:Ca?1:0,ha,Ba)}qYe(F,sa,ia,Na=!1,Ca=0){this.show(F,sa,ia+20,3,Na,Ca)}show(F,sa,ia,Na=3,Ca=!1,ha=0){!F||Na===this.state&&this.bce(sa,ia)||(this.gOd(Na,Ca,ha),this.Xx(F,Na,ha),this._state=Na,
4===ha||0===ha&&!this.lI?this.element.style.left=sa+"px":this.element.style.right=sa+"px",this.element.style.top=ia+"px",this.visible=!0)}Xx(F,sa,ia){this.RXb=F;J.a.Au(this.Ws);u.a.CFf(this.Ws);this.Ws.id="fly_"+F.clientId;this.Ws.style.backgroundColor=F.color;4!==sa?(this.Ws.style.height=this.dS+"px",this.Ws.style.lineHeight=this.dS+"px",u.a.JY(this.Ws,"border-radius",this.dS+"px")):4===ia||0===ia&&!this.lI?this.Ws.style.left="0px":this.Ws.style.right="0px";2!==sa&&(4===sa?J.a.Nx(this.Ws,""):1===
sa?this.Ws.appendChild(this.oAd):(this.Ws.setAttribute("dir","auto"),ia=G.a.K7d(F.userName,!1),(!F.isAnonymous||B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ia||0!==sa?(F=F.userName,0===sa&&(F=ia,u.a.JY(this.Ws,"text-align","center")),J.a.Nx(this.Ws,F)):(this.gN||(this.gN=this.vXd()),this.Ws.appendChild(this.gN),u.a.JY(this.Ws,"text-align","start"))))}onClick(F){if(0===this.state)return this.raiseEvent(m.a.kp,new m.a(1,F)),!0;
3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}yz(F){3===this.state&&this.raiseEvent(m.a.kp,new m.a(3,F));return!1}cD(F){3!==F.Xf&&this.raiseEvent(m.a.kp,new m.a(2,F));return!1}ixa(F){if(3!==F.Xf)return!0;this.raiseEvent(m.a.kp,new m.a(4,F));return!1}vXd(){const F=document.createElement("img");F.src=v.a.XK("doughperson_white_glyph.svg");F.setAttribute("Unselectable","on");E.a.eP(F,E.a.ef,E.a.nN);return y.createClusteredImageFromClusterWithImageClass(this.dS,
this.dS,null,null,P.e4d,"",!1,"",this.element.ownerDocument,F)}gOd(F,sa=!1,ia=0){if(!this.Pka(this.state)||!this.Pka(F))switch(Sys.UI.DomElement.removeCssClass(this.element,this.u2a),this.state){case 4:3===F?this.mN(P.X8a,P.B4b):this.Pka(F)&&this.mN(P.V8a,P.B4b);break;case 3:4===F?this.mN(P.Z8a,P.A4b):this.Pka(F)&&(sa&&this.noc(),this.mN(P.V8a,P.A4b,sa?P.d4d:""));break;case 0:case 1:case 2:4===F?this.mN(P.Z8a,P.Y8a):3===F&&(sa&&this.tOd(),this.mN(P.X8a,P.Y8a,sa?P.C4b:"",3===ia?P.g4d:P.f4d));break;
default:4===F?this.mN(P.Z8a):3===F?this.mN(P.X8a):this.Pka(F)&&this.mN(P.V8a)}}mN(...F){this.u2a=F.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.u2a)}tOd(){this.mSb=window.setTimeout(()=>{this.element&&(this.gS=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.gS),this.element.style.zIndex="2",this.gS.style.zIndex="1")},300)}noc(){window.clearTimeout(this.mSb);this.gS&&(Sys.UI.DomElement.removeCssClass(this.gS,P.Y8a+" "+P.C4b),Sys.UI.DomElement.addCssClass(this.gS,P.c4d),
S.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.gS.parentNode&&this.element.parentNode.removeChild(this.gS)}),u.a.jKb(this.element,"z-index"))}Pka(F){return 0===F||1===F||2===F}bce(F,sa){const ia=u.a.FH(this.element.style.top);return u.a.FH(this.element.style.left)===F&&ia===sa}Rib(F){3===F&&u.a.$P(this.element,"left")?(F=u.a.FH(this.element.style.left),u.a.jKb(this.element,"left"),this.element.style.right=-1*F+"px"):4===F&&u.a.$P(this.element,"right")&&(F=u.a.FH(this.element.style.right),
u.a.jKb(this.element,"right"),this.element.style.left=-1*F+"px")}}P.W8a="prModernFlyout UIFont";P.Z8a="flyoutIdle";P.X8a="flyoutExpanded";P.V8a="flyoutCollapsed";P.B4b="flyoutFromIdle";P.A4b="flyoutFromExpanded";P.Y8a="flyoutFromCollapsed";P.C4b="flyoutStacked";P.d4d="flyoutFromStacked";P.c4d="flyoutFadeOut";P.e4d="cui-img-cont-float cui-img-20by20";P.f4d="flyoutLtrDir";P.g4d="flyoutRtlDir";Object(I.a)(P,"ModernPresenceTooltipFlyoutControl",n.a,[]);class Q{constructor(F,sa,ia=2,Na=4){this.offsetTop=
F;this.offsetLeft=sa;this.Puc=ia;this.c8b=Na}}Object(I.a)(Q,"FlyoutsPositioningInfo",null,[]);var D=d(65);class O{constructor(F=!1,sa=!1){this.Vi=F;this.a3a=sa}S7d(F,sa,ia,Na,Ca,ha,Ba){const va=Ba.y,ta=Ba.height;var Fa=this.K5d(ha);const pa=Fa+sa;Ca=F*ia+(F-1)*Ca;ia=null;1===F||this.WTd(Fa,Ca,va,ta)?F=new Q(0,0,2):(F=this.Q3d(pa,Ca,va,ta),F.offsetTop-=Fa);this.a3a?ia=new Q(0,0,void 0,this.Vi?4:3):(ha=this.J5d(ha,Ba),Fa=Math.max(0,Ba.x),Ba=Ba.width,sa=ha+sa,this.XTd(ha,Na,Fa,Ba)?ia=new Q(0,0,void 0,
this.Vi?3:4):this.YTd(sa,Na,Fa)&&(ia=new Q(0,0,void 0,this.Vi?4:3)),ia||(ia=this.P3d(ha,sa,Fa,Ba)));return new Q(F.offsetTop,ia.offsetLeft,F.Puc,ia.c8b)}K5d(F){return D.a.uRc(F)}J5d(F,sa){return this.Vi?sa.width-D.a.WZf(F):D.a.tRc(F)}WTd(F,sa,ia,Na){return F+sa<=ia+Na}Q3d(F,sa,ia,Na){let Ca=1,ha=Math.max(ia,F-sa);sa>F-ia&&(Ca=2,ha=sa<Na?Na-sa:ia);return new Q(ha,0,Ca)}XTd(F,sa,ia,Na){return F+sa<=ia+Na}YTd(F,sa,ia){return sa<=F-ia}P3d(F,sa,ia,Na){Na-sa>=F-ia?F=4:(sa=F,F=3);return new Q(0,sa,void 0,
F)}}Object(I.a)(O,"ModernPresenceTooltipPositioner",null,[]);class X{constructor(F,sa,ia,Na,Ca,ha,Ba){this.Yv=F;this._parent=sa;this.XQb=ia;this.Nyd=Na;this.uCd=Ca;this.E7=ha;this.lI=Ba;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(F,sa){if(3!==F)if(5!==F&&this.Yv&&this.Yv.length){if(4===F){var ia=this.uCd;var Na=(this.E7-ia)/2;this.element.style.height=this.E7+"px";this.element.style.width=this.E7+"px";F=u.a.FH(this.Yv[0].element.style.top);
sa=u.a.FH(this.lI?this.Yv[0].element.style.right:this.Yv[0].element.style.left)}else ia=this.XQb,Na=(this.E7-ia)/2,this.element.style.height=this.E7+"px",this.element.style.width=this.Z5d()+2*Na+"px",F=u.a.FH(this.Yv[this.Yv.length-1].element.style.top),sa=this.KTd(this.Yv[this.Yv.length-1].element,ia,sa);u.a.JY(this.element,"border-radius",this.E7+"px");this.element.style.top=F-Na-ia+"px";this.lI?this.element.style.right=sa-Na+"px":this.element.style.left=sa-Na+"px";this.element.parentNode||this._parent.insertBefore(this.element,
this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}KTd(F,sa,ia){return this.lI&&!ia?u.a.FH(F.style.right):this.lI||ia?this.lI&&ia?-u.a.FH(F.style.left)-sa:-u.a.FH(F.style.right)-sa:u.a.FH(F.style.left)}Z5d(){return this.Yv&&this.Yv.length?this.XQb+Math.min(this.Yv.length-1,2)*this.Nyd:0}}Object(I.a)(X,"ModernPresenceTooltipTarget",null,[]);var N=d(71),aa=d(118),V=d(201);class ca extends n.a{constructor(F,sa,ia){super(F);this.x7=this.eI=this.nTb=
this.vZ=!1;this.Df=[];this.AAa={};this.Jc=ia;this.Vi=ia.get(8,!1);this.$Sb=ia.get(15,!1);this.xzd=ia.get(12,0);this.KS=ia.get(6,0);this.f5a=sa;this.TXb=ia.get(16);this.a3a=ia.get(17,!1);this.wCd=ia.get(19,!1);this.uId=ia.get(20,!1);this.GAa=0;this.oId=new O(this.Vi,this.a3a);this.Rga=this.s5b();this.x4a=!1;this.YM=[];this.wha=[];this.element.id=ca.i9a();this.element.className=n.a.aub("prControl",this.Vi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Vi;this.Djb(sa);this.iF=this.createElement("div");
this.iF.className="prFlyoutContainer";this.element.appendChild(this.iF);this.Yv=[];this.lS=new X(this.ft,this.element,this.KS,4,6,32,this.Vi);this.$o=ia.get(9);this.$o.pb(A.a.pointerDown,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.pb(A.a.pointerOver,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.pb(A.a.pointerOut,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"))}get Khb(){return V.a.clone(this.Df)}get ft(){return this.Yv}get defaultZIndex(){return this.xzd}get FN(){return this.ft?
this.ft.length:0}get lV(){return 0<this.FN?this.ft[0].state:5}get Fab(){return 3===this.lV&&!this.vZ}bW(F){this.addHandler(m.a.kp,F)}g1(F){this.removeHandler(m.a.kp,F)}dispose(){if(this.Fab)this.x4a=!0;else{if(this.ft)for(const F of this.ft)F.g1(Object(e.a)(this,this.fG,"onInteractivityChanged")),aa.a.Kx(F);this.Yv=null;this.$o.yb(A.a.pointerDown,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.yb(A.a.pointerOver,this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));this.$o.yb(A.a.pointerOut,
this.lS.element,Object(e.a)(this,this.daa,"onHitTarget"));super.dispose()}}iga(){this.XZ();this.visible=!0}skb(){this.visible=!0;this.L3b();this.vZ=!0}Lya(){this.skb()}hide(){this.ooc();this.ON();this.lS.update(this.lV,this.x7)}Xx(F){const sa=this.lV,ia=this.vZ;F.clientId||(F.clientId=(ca.Cha++).toString());if(F.clientId in this.AAa){var Na=this.bT(F.clientId);if(0<=Na){Na=this.Df[Na];if(Na.color===F.color&&Na.userName===F.userName)return;this.RJ(F.clientId)}}this.hide();Na=new P(this.createElement("div"),
this.Jc);Na.bW(Object(e.a)(this,this.fG,"onInteractivityChanged"));this.iF.insertBefore(Na.element,this.iF.firstChild);this.AAa[F.clientId]=Na;Array.add(this.Df,F);Array.add(this.ft,Na);this.wuc(sa,ia);this.visible=!0}RJ(F){if(this.Fab)Array.add(this.wha,F);else{var sa=this.lV,ia=this.vZ;this.hide();this.hoa(F);this.wuc(sa,ia)}}qgb(F){const sa=this.bT(F);if(!(0>=sa)){var ia=this.Df[sa];F=this.AAa[F];Array.removeAt(this.Df,sa);Array.insert(this.Df,0,ia);Array.removeAt(this.ft,sa);Array.insert(this.ft,
0,F);this.iF.removeChild(F.element);this.iF.appendChild(F.element);this.XZ()}}wuc(F,sa){0>=this.Df.length?this.hide():3===F&&sa?this.skb():this.iga()}Zjb(F,sa){sa?this.$Nd(F):this.hoc(F)}F3b(F){if(this.Fab&&this.wCd)return!1;F=ca.X9a(F);if(this.iF!==F&&J.a.mua(this.iF,F))return!0;for(const sa of this.ft)if(J.a.mua(sa.element,F))return!0;return!1}position(F,sa){this.element.style.top=sa+"px";this.element.style.left=F+"px"}XZ(F=!1){if(!F||this.eI){this.nTb&&this.hqc(!0);var sa=Math.min(3,this.FN)-1;
F=0;var ia=1,Na=0;this.x7&&(F=this.Rga,ia=-1,Na=-this.KS);for(let Ca=this.FN-1;Ca>sa;Ca--)this.ft[Ca].krc(this.Df[Ca],-4*sa*ia+Na,0,!0,!1,!0,F);for(;0<=sa;sa--)this.ft[sa].krc(this.Df[sa],-4*sa*ia+Na,0,0<sa,Array.contains(this.YM,this.Df[sa].clientId),sa!==this.GAa,F);this.GAa=0;this.lS.update(0,this.x7);this.zIndex=this.defaultZIndex;this.vZ=!1;this.ooc(0);this.x4a&&this.dispose()}}L3b(){this.nTb&&this.hqc(!1);this.zIndex=this.defaultZIndex+1;let F,sa,ia;({offsetX:sa,offsetY:F,b8b:ia}=this.EVe());
for(let Na=0;Na<this.FN;Na++)this.ft[Na].qYe(this.Df[Na],sa,F+(this.KS+2)*Na,Na!==this.GAa,ia)}ON(){let F=0,sa=0;this.x7&&(F=this.Rga,sa=-6);for(let ia=0;ia<this.FN;ia++)this.ft[ia].hide(this.Df[ia],sa,F);this.zIndex=this.defaultZIndex;this.visible=this.vZ=!1;this.x4a&&this.dispose()}l7a(F=0){F?(this.eI=!0,S.Task.delay(F).continueWith(()=>{this.$Sb?this.Ece():this.XZ(!0);this.eI=!1})):this.$Sb?this.hide():this.XZ()}Ece(){this.eI&&this.hide()}rSd(){if(B.AFrameworkApplication.Aa&&B.AFrameworkApplication.Aa.hb.o9&&
N.c()){const F=appChrome.selectors.getShyState();return F.isActive&&0!==F.state}return!1}fG(F,sa){F=this.lV;this.rSd()||2!==sa.type&&(4!==sa.type||3===F)?4===sa.type&&3===F?(this.eI&&(this.eI=!1),this.l7a()):3!==sa.type||3!==F||this.vZ||(1<this.FN?(this.eI=!0,S.Task.delay(250).continueWith(()=>{this.XZ(!0);this.eI=!1})):this.l7a()):(this.eI&&(this.eI=!1),3!==F&&(this.L3b(),3===sa.Xi.Xf&&this.l7a(2E3)));this.raiseEvent(m.a.kp,sa)}daa(F){3===F.Xf?this.fG(this,new m.a(4,F)):F.eventName===A.a.pointerOver?
this.fG(this,new m.a(2,F)):F.eventName===A.a.pointerOut&&this.fG(this,new m.a(3,F));return!1}Djb(F){this.element.style.width=F+"px";this.element.style.height=this.KS+"px"}hoa(F){this.hoc(F);F=this.bT(F);if(!(0>F)){var sa=this.Df[F];Array.removeAt(this.Df,F);delete this.AAa[sa.clientId];sa=this.ft[F];this.iF.removeChild(sa.element);this.Jc.get(18,!1)&&sa.g1(Object(e.a)(this,this.fG,"onInteractivityChanged"));Array.removeAt(this.ft,F);sa.dispose()}}ooc(F=5){if(this.wha.length){this.visible&&this.ON();
for(let sa=0;sa<this.wha.length;sa++)this.hoa(this.wha[sa]);Array.clear(this.wha);0>=this.Df.length||5===F?this.hide():0===F&&this.iga()}}bT(F){for(let sa=0;sa<this.Df.length;sa++)if(this.Df[sa].clientId===F)return sa;return-1}$Nd(F){if(-1===this.bT(F))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.YM,F)){if(this.Df[0].clientId===F)return;Array.remove(this.YM,F)}Array.add(this.YM,F);this.qgb(F);1!==this.lV&&this.XZ()}}hoc(F){-1===
this.bT(F)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.YM,F)&&(Array.remove(this.YM,F),this.Df[0].clientId===F&&0<this.YM.length&&this.qgb(this.YM[this.YM.length-1]),this.Df[0].clientId===F&&1===this.lV&&this.XZ())}hqc(F){F?Sys.UI.DomElement.addCssClass(this.iF,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.iF,"prBackgroundSelection")}EVe(){let F,sa;sa=F=0;var ia=this.Rga;if(this.TXb){const Na=this.TXb(this);if(!Na)return{offsetX:F,
offsetY:sa,b8b:ia};const Ca=4===this.lV;ia=this.oId.S7d(this.FN,Ca?6:this.KS,this.KS,150,2,this.element,Na);sa=ia.offsetTop;this.GAa=this.J7d(ia.Puc,ia.offsetTop);ia=ia.c8b;ia!==this.Rga&&(this.Rib(ia),this.element.dir=3===ia?"rtl":"ltr",this.Rga=ia);ia!==this.s5b()?(F=this.uId?-2:Ca?-6:-this.KS,this.x7=!0):this.x7=!1}return{offsetX:F,offsetY:sa,b8b:ia}}J7d(F,sa){if(1===F)return this.FN-1;F=Math.abs(sa);return 0<F?F/(this.KS+2):0}Rib(F){for(let sa=0;sa<this.FN;sa++)this.ft[sa].Rib(F)}s5b(){return this.Vi?
3:4}static i9a(){return String.format("{0}-{1}","presencetooltip",ca.Cha++)}static X9a(F){return F.qc.rawEvent.relatedTarget}}ca.Cha=0;Object(I.a)(ca,"ModernPresenceTooltipControl",n.a,[487,106]);var fa=d(225),ma=d(289),da=d(267);d.d(Y,"a",function(){return qa});class qa{constructor(F){this.Jc=F;this.Jc.MD(10,fa.a.instance);this.Jc.MD(9,da.a.instance);this.Jc.MD(6,20);this.Jc.MD(13,ma.a.instance);this.Jc.MD(17,!1)}zLc(F,sa){this.Jc.MD(15,!1);return new ca(F,sa,this.Jc)}Ttb(F){this.Jc.MD(15,!1);return new ca(F,
20,this.Jc)}}Object(I.a)(qa,"ModernPresenceTooltipFactory",null,[486])},1144:function(I,Y,d){I=d(0);var h=d(14),e=d(1200),n=d(237),m=d(238),z=d(67),B=d(97);class v extends n.a{constructor(D,O){super(D);this.Df=null;this.lI=O.get(8,!1);this.dS=O.get(6,0);this.element=D;this.element.className=v.W8a;this.D5a=this.createElement("ul");this.element.appendChild(this.D5a);this.Ln=O.get(10);this.Ln.pb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.$o=O.get(9);this.$o.pb(z.a.pointerOut,
this.element,Object(h.a)(this,this.yz,"onPointerOut"));this.$o.pb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"));this.bN=O.get(13);this.bN.pb(this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"))}bW(D){this.addHandler(m.a.kp,D)}g1(D){this.removeHandler(m.a.kp,D)}get bba(){return this.Df}dispose(){this.element&&(this.Ln.yb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.$o.yb(z.a.pointerDown,this.element,
Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut")),this.bN.yb(this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(D,O,X){this.hide();!D||0>=D.length||(this.lI?this.element.style.right=O+"px":this.element.style.left=O+"px",this.element.style.top=X+"px",this.aPd(D),this.visible=!0)}aPd(D){this.Df=D;B.a.Au(this.D5a);for(let O=
D.length-1;0<=O;O--)this.Xx(D[O])}Xx(D){const O=document.createElement("li");O.style.backgroundColor=D.color;O.style.height=this.dS+"px";O.id="fly_"+D.clientId;O.style.lineHeight=this.dS+"px";B.a.Nx(O,D.userName);O.setAttribute("dir","auto");this.D5a.appendChild(O)}onClick(){this.hide();return!1}yz(D){this.raiseEvent(m.a.kp,new m.a(3,D));return!1}}v.W8a="prFlyout UIFont";Object(I.a)(v,"PresenceTooltipFlyoutControl",n.a,[]);var y=d(75);class A extends n.a{constructor(D,O,X){super(D);this.gN=null;this.Df=
[];this.element.className="prGlyph";this.Jc=O;this.v7=this.Jc.get(9);this.yn=this.Jc.get(10);this.bN=this.Jc.get(13);this.Jce();this.Xx(X);this.E3a=!1}get TO(){return this.Df.length}get bba(){return this.Df}bW(D){this.addHandler(m.a.kp,D)}g1(D){this.removeHandler(m.a.kp,D)}dispose(){this.Y3e();super.dispose()}Xx(D){Array.add(this.Df,D);2===this.TO?this.Zaa(!0):1===this.TO?this.Zaa(!1):this.Zaa(this.E3a)}RJ(D){this.q3d(D)&&(1<this.TO&&this.Zaa(!0),1===this.TO?this.Zaa(!1):1>this.TO&&this.hide())}show(){this.Zaa(2<=
this.TO);this.visible=!0}hide(){this.visible=!1}F7d(D){return D?this.k5b(0,5):this.k5b(1,4)}q3d(D){for(let O=0;O<this.TO;O++)if(this.Df[O].clientId===D)return D=this.Df[O],Array.removeAt(this.Df,O),D;return null}Zaa(D){this.E3a!==D&&(this.gN&&this.element.removeChild(this.gN),this.gN=this.F7d(D),this.element.appendChild(this.gN),this.E3a=D);this.gN.childNodes[0].style.backgroundColor=this.Df[this.Df.length-1].color}k5b(D,O){const X=this.Jc.get(6,0),N=this.Jc.get(14);return y.createClusteredImageFromClusterWithImageClass(X,
X,this.Jc.get(D),this.Jc.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,N?N.cloneNode(!0):null)}cD(D){3!==D.Xf&&this.raiseEvent(m.a.kp,new m.a(2,D));return!1}onClick(D){this.raiseEvent(m.a.kp,new m.a(1,D));return!0}yz(D){3!==D.Xf&&this.raiseEvent(m.a.kp,new m.a(3,D));return!1}Y3e(){this.element&&(this.v7.yb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.v7.yb(z.a.pointerOver,this.element,Object(h.a)(this,this.cD,
"onPointerOver")),this.v7.yb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut")),this.yn.yb(z.a.doubleClick,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.yn.yb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.bN.yb(this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")))}Jce(){this.element&&(this.v7.pb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),
this.v7.pb(z.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.v7.pb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut")),this.yn.pb(z.a.doubleClick,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.yn.pb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.bN.pb(this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")))}}Object(I.a)(A,"PresenceTooltipGlyph",n.a,[]);var E=d(118);
d(65);var u=d(201);class J extends n.a{constructor(D,O,X){super(D);this.Df=[];this.hm=[];this.iI=0;this.eia=this.c7=!1;this.fQb=null;this.vha={};this.Jc=X;this.Vi=X.get(8,!1);this.CG=X.get(11,!1);D=X.get(12,0);this.imageDimension=X.get(6,0);this.f5a=O;this.element.id=J.i9a();this.element.className=n.a.aub("prControl",this.Vi);D&&(this.zIndex=D);this.rtl=this.Vi;this.Djb(O);this.Hz=this.createElement("div");this.Hz.className=this.CG?"prContainerV":"prContainerHr";this.element.appendChild(this.Hz);
this.ySb=Array(this.iI);for(O=0;O<this.iI;O++)this.iw[O]=new v(this.createElement("div"),this.Jc),this.iw[O].bW(Object(h.a)(this,this.fG,"onInteractivityChanged")),this.element.appendChild(this.iw[O].element)}get Khb(){return u.a.clone(this.Df)}getGlyph(D){return this.vha[D]}get iw(){return this.ySb}get nYb(){return this.fQb}get uLa(){return this.imageDimension+2}get width(){return this.CG?this.uLa:this.f5a}get height(){return this.CG?this.f5a:this.uLa}bW(D){this.addHandler(m.a.kp,D)}g1(D){this.removeHandler(m.a.kp,
D)}dispose(){if(this.iw)for(const D of this.iw)D.g1(Object(h.a)(this,this.fG,"onInteractivityChanged")),E.a.Kx(D);E.a.Xmd(this.hm);this.hm=this.ySb=null;super.dispose()}iga(){this.ON();this.qkb();this.visible=!0;this.c7=!1}skb(){!this.hm||1>this.hm.length||(this.ON(),this.visible=!0,this.qkb(),this.JJa(this.hm[this.hm.length-1]),this.c7=!0)}Lya(){if(this.hm&&!(1>this.hm.length)){this.visible=!0;this.qkb();var D=0;for(const O of this.hm)this.JJa(O,D++);this.c7=!1;this.eia=!0}}hide(){this.visible=!1;
this.ON();for(let D=0;D<this.hm.length;D++)this.hm[D].hide();this.c7=!1}R_b(){if(!this.eia)return!1;let D=0;for(const O of this.iw)O.visible&&D++;return this.eia=0<D&&(this.Df.length<=this.iI?D===this.Df.length:D===this.iI)}Xx(D){if(!(0>=this.iI)){D.clientId||(D.clientId=(J.Cha++).toString());if(D.clientId in this.vha){var O=this.bT(D.clientId);if(0<=O){O=this.Df[O];if(O.color===D.color&&O.userName===D.userName)return;this.RJ(D.clientId)}}O=this.R_b();var X=0;if(this.Df.length<this.iI){var N=new A(this.createElement("div"),
this.Jc,D);N.bW(Object(h.a)(this,this.fG,"onInteractivityChanged"));this.Vi&&!this.CG&&0<this.Df.length?this.Hz.insertBefore(N.element,this.Hz.firstChild):(this.Hz.appendChild(N.element),X=this.hm.length);Array.add(this.hm,N)}else this.Vi&&!this.CG?N=this.hm[0]:(X=this.hm.length-1,N=this.hm[X]),N.Xx(D);N.show();this.vha[D.clientId]=N;Array.add(this.Df,D);this.nuc(N,X);O&&this.Lya()}}RJ(D){const O=this.R_b();O&&this.ON();this.hoa(D);this.Df.length>=this.iI&&this.hm.length<this.iI&&this.wPe();0>=this.Df.length?
this.hide():O&&this.Lya()}qgb(){}hoa(D){var O=this.bT(D);0>O||(D=this.Df[O],Array.removeAt(this.Df,O),O=this.vha[D.clientId],delete this.vha[D.clientId],O.RJ(D.clientId),this.nuc(O),0>=O.TO&&(this.Hz.removeChild(O.element),Array.remove(this.hm,O),O.dispose()))}Zjb(){}wPe(){var D=this.Q8d();!D||1>=D.bba.length||(D=Array.clone(this.Df),D.forEach(O=>{this.hoa(O.clientId)}),D.forEach(O=>{this.Xx(O)}))}bT(D){for(let O=0;O<this.Df.length;O++)if(this.Df[O].clientId===D)return O;return-1}Q8d(){return this.Vi&&
!this.CG?this.hm[0]:this.hm[this.hm.length-1]}position(D,O){this.element.style.top=O+"px";this.element.style.left=D+"px"}qkb(){for(let D=0;D<this.hm.length;D++)this.hm[D].show()}ON(){for(let D=0;D<this.iI;D++)this.iw[D].hide();this.eia=!1}JJa(D,O=0){if(D)if(this.fQb=D,this.CG){const X=this.imageDimension;if(1<D.bba.length)this.iw[O].show(D.bba,X,this.height-this.imageDimension);else{const N=this.Hz.children.length;for(let aa=0;aa<this.Hz.children.length;aa++)D.element===this.Hz.children[aa]&&this.iw[O].show(D.bba,
X,this.height-(N-aa)*this.uLa+2)}}else this.iw[O].show(D.bba,this.width,0)}fG(D,O){var X=Object(e.a)(A,D);X=X?this.b4b(X):-1;if(2===O.type||1===O.type&&-1!==X&&!this.iw[X].visible)this.JJa(D);else if(1===O.type)this.ON(),this.c7=!1;else if(3===O.type){if(this.F3b(O.Xi))return;this.c7||this.ON()}this.raiseEvent(m.a.kp,O)}F3b(D){D=J.X9a(D);let O=!1;for(const X of this.iw)if(B.a.mua(X.element,D)){O=!0;break}return this.Hz!==D&&B.a.mua(this.Hz,D)||O}nuc(D,O=0){const X=this.jie(D);X&&0>=D.TO?this.iw[O].hide():
X?this.JJa(D):this.iw[O].hide()}b4b(D){let O=0;for(const X of this.hm){if(D===X)return O;O++}return-1}jie(D){const O=this.b4b(D);return!!this.nYb&&D===this.nYb&&-1!==O&&this.iw[O].visible}Djb(D){this.iI=D===this.imageDimension?1:Math.floor(D/this.uLa);this.CG?(this.element.style.height=D+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=D+"px",this.element.style.height=this.imageDimension+"px")}static i9a(){return String.format("{0}-{1}","presencetooltip",J.Cha++)}static X9a(D){D=
D.qc.rawEvent;return D.relatedTarget||D.toElement}}J.Cha=0;Object(I.a)(J,"PresenceTooltipControl",n.a,[487,106]);var G=d(225),S=d(289),P=d(267);d.d(Y,"a",function(){return Q});class Q{constructor(D){this.Jc=D;this.Jc.MD(10,G.a.instance);this.Jc.MD(9,P.a.instance);this.Jc.MD(6,16);this.Jc.MD(13,S.a.instance)}zLc(D,O){return new J(D,O,this.Jc)}Ttb(D){return new J(D,16,this.Jc)}}Object(I.a)(Q,"PresenceTooltipFactory",null,[486])},1243:function(I,Y,d){d.r(Y);var h=d(0),e=d(387),n=d(14),m=d(18),z=d(78),
B=d(81),v=d(37),y=d(2);class A{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc=!1){this.KMa=null;this.aBd=!0;this.vId=this.tS=this.Cxd=null;this.Pa=new z.a;this.FWh=Ua;this.inf=Bb;this.rlf=mc;this.qlf=Nc;this.h8e=Dd;A.Zd=nd;this.AYh=La;this.tOa=gb;this.rZh=vc;y.Task.WAA(Bb,mc).continueWith(Object(n.a)(this,this.jDj,"initOnTaskReady"))}Veh(){this.Pa.raiseEvent("u",null,this)}jDj(){this.inf.result&&this.rlf.result&&(this.tS=this.inf.result,this.vId=this.rlf.result,this.tS.GGc(Object(n.a)(this,this.okc,"onPresenceUpdated")),
this.Cxd=new B.a(2,2,this.h8e,Object(n.a)(this,this.sCl,"updateAwayClientsTask"),88),A.Zd.Db(this.Cxd))}okc(Ua,Bb){(this.aBd||this.cRk(Bb.tPb))&&A.Zd.V5(this.Cxd,0)}cRk(Ua){for(let mc in Ua){var Bb=this.qlf.g5f({key:mc,value:Ua[mc]});if(Bb&&Bb.clientId&&(Bb=Bb.clientId.toLowerCase(),(Bb=this.KMa[Bb]||this.KMa[Bb.toUpperCase()])&&2===Bb.status))return!0}return!1}sCl(Ua){var Bb=this.tS.b3i();if(Bb){var mc=new Date,Nc=!1;if(this.aBd){this.KMa=Bb;this.aBd=!1;var nd=this.KMa;for(var Dd in nd){Bb=Dd;var La=
nd[Dd];La.JAb<mc&&(mc=La.JAb);2===La.status&&(Nc=!0,this.vId.jld(Bb))}Nc&&this.Veh();A.Zd.V5(Ua,this.a4f(mc))}else{La=new m.a;Dd=!1;var gb=this.KMa;for(nd in gb){gb=nd;if(!(gb in this.KMa)||this.FWh.clientId===gb)continue;var vc=this.KMa[gb];const td=Bb[gb];if(vc&&td){vc=vc.status;const Nd=td.status;2===vc&&1===Nd?(La.add(gb),e.ULS.sendTraceTag(38052609,392,50,gb+" returned from away")):1===vc&&2===Nd&&(Dd=Nc=!0,this.vId.jld(gb),e.ULS.sendTraceTag(38052610,392,50,gb+" went away"));1===Nd&&td.JAb<
mc&&(mc=td.JAb)}}this.KMa=Bb;A.Zd.V5(Ua,this.a4f(mc));(0<La.count||Nc)&&this.Veh();0<La.count&&!this.rZh?(Ua=this.p5i(La),this.Uvl(Ua)):Ua=new m.a;(Dd||0<Ua.count)&&this.AYh(v.a.k7a,2)}}}Uvl(Ua){if(Ua.count)for(let Bb of Ua)Ua=this.tOa.LCa(String.format(CommonUIStrings.l_EditorsToastArriving,Bb),!1),Ua.image=5,Ua.Cda="CoAuth_AuthorStatus_16x16x32",this.tOa.Zh(Ua)}p5i(Ua){const Bb=this.tS.gRc(),mc=new m.a;for(let Nc in Bb){const nd={key:Nc,value:Bb[Nc]};if(Ua.contains(nd.key)){const Dd=this.qlf.g5f(nd);
Dd&&(mc.add(Dd.userName),Ua.remove(nd.key))}}mc.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return mc}a4f(Ua){return Math.max(Ua.getTime()+this.h8e-(new Date).getTime(),0)}}A.Zd=null;Object(h.a)(A,"AwayManager",null,[]);var E=d(577),u=d(27),J=d(291),G=d(57),S=d(338),P=d(70),Q=d(1138),D=d(1062),O=d(995),X=d(704),N=d(702),aa=d(190),V=d(994),ca=d(29),fa=d(552),ma=d(210),da=d(28),qa=d(779),F=d(47),sa=d(1200),ia=d(24),Na=d(951),Ca=d(378),ha=d(40),Ba=d(63);class va{constructor(Ua,
Bb){this.shapeNode=Ua;this.Wxh=Bb}}Object(h.a)(va,"ShapeNodeStartEditingNotificationTracking",null,[]);class ta{constructor(Ua,Bb,mc,Nc,nd="",Dd=""){if(!Ua||!Bb||0>mc)throw Error.argumentNull("LockEntry");this.ww=Ua;this.uB=Bb;this.bfa=mc;this.Zak=Nc;this.PUg=nd;this.GUg=Dd;this.ZFg=new Date}get clientId(){return this.ww}get Uqd(){return this.uB}get shapeId(){return this.bfa}get lockType(){return this.Zak}get CAh(){return this.PUg}get oAh(){return this.GUg}get Omg(){return!F.a.Wa(this.GUg)&&!F.a.Wa(this.PUg)}get Oog(){return this.ZFg}set Oog(Ua){this.ZFg=
Ua}}Object(h.a)(ta,"LockEntry",null,[]);class Fa{constructor(Ua,Bb,mc,Nc,nd="",Dd=""){this.clientId=Ua;this.slideId=Bb;this.shapeId=mc;this.lockType=Nc;this.rowId=nd;this.cellId=Dd}}Object(h.a)(Fa,"SerializableLockData",null,[]);var pa=d(186),ka=d(217);class Ha{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc,td,Nd,Od,Oc,Af,Ae,Ye,Wd,je,dg,nf,Cb,Cf){this.epj=new E.a("",ResourceStrings.L_GhostUserName,Na.a.LMf,new qa.a(1));this.EDb={};this.FDb={};this.DDb={};this.FFg=ca.App.Vm;this.Mxe=null;this.ZAe={};this.H2c=
{};this.K2c={};this.GFg=ca.App.Vm;this.yUg=!0;this.SHg=this.XGg=0;this.G8c=(new Date(0)).getTime();this.H8c=(new Date(0)).getTime();this.Tfc=(new Date(0)).getTime();this.lze=(new Date(0)).getTime();this.xUg=!1;this.bWa=Ua;this.uE=Bb;this.NDb=mc;this.Jgc=Nc;this.Vb=nd;this.zb=Dd;this.pa=La;this.F6j=gb;this.lr=vc;this.Fa=td;this.yc=Nd;this.bgc=Od;this.vre=Oc.Bhg;this.Hs=Af;this.cY=Ae;this.ua=Ye;this.$Sg=Wd;this.qd=je;this.qd.Iai(Object(n.a)(this,this.Oxk,"onShapeViewElementRequestUpdateAuthorInfo"));
(this.Hv=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.pa.wF(Object(n.a)(this,this.EH,"onSelectionChanged"));this.Jgc.WBa(Object(n.a)(this,this.Ikc,"onUpdateNotificationReceived"));this.cik=dg;this.Te=nf;this.ahk=Cb;this.Ha=Oc;this.TXa=Cf;this.pDj()}pDj(){da.a.J(509219588,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.vre,this.Hs.e4j());this.Hs.F_d||(0<this.Hs.Aib?this.zb.Db(new B.a(2,2,this.Hs.Aib,Object(n.a)(this,
this.removeExpiredLock,"removeExpiredLock"),90,"71")):da.a.J(509219587,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Hs.MNb?(this.zb.Db(new B.a(2,2,this.Hs.MNb/2,Object(n.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.yUg=!1):da.a.J(509219586,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Hs.x8b?this.zb.Db(new B.a(2,2,this.Hs.x8b,Object(n.a)(this,this.updateLockIfImeActive,"updateLockIfImeActive"),
90,"73")):da.a.J(509219585,804,50,"IME typing lock notification disabled"),0<this.Hs.dgb?this.zb.Db(new B.a(2,2,this.Hs.dgb,Object(n.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):da.a.J(509219584,804,50,"Lock leack detection is disabled"),this.F6j.addHandler(Ca.a.uHf,(Ua,Bb)=>{this.zwi(Bb)}),this.Hs.pNc||this.ssc||(this.bgc.UBa(Object(n.a)(this,this.P1g,"onBeforeParagraphNodePropertyChanged")),0<this.Hs.Llb?this.zb.Db(new B.a(2,2,this.Hs.Llb,Object(n.a)(this,this.updateLockForActiveShapeNodes,
"updateLockForActiveShapeNodes"),90,"75")):da.a.J(509219555,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.ssc&&(this.ahk.UBa(Object(n.a)(this,this.pgd,"onTableCellNodePropertyChanged")),this.bgc.UBa(Object(n.a)(this,this.P1g,"onBeforeParagraphNodePropertyChanged")),this.cik.initialize(),0<this.Hs.Llb&&this.zb.Db(new B.a(2,2,this.Hs.Llb,Object(n.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),90,"76")),0<this.Hs.Aib&&this.zb.Db(new B.a(2,
2,this.Hs.Aib,Object(n.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get ssc(){return this.Hs.$0d&&this.Hs.pRf}removeExpiredLock(){var Ua=ka.a(this.EDb);for(const Bb of Ua){Ua=Object(sa.a)(117,this.EDb[Bb]);if(!Ua){delete this.EDb[Bb];continue}const mc=Ua.shapeNode;mc&&mc.isConnected?this.cY.j1f(mc)||this.hjd(Bb)||(delete this.EDb[Bb],this.cY.u5b(mc)||Ua.Al?da.a.J(509219554,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.uFh(Ua)):delete this.EDb[Bb]}}removeExpiredTableCellLock(){var Ua=ka.a(this.FDb);for(const Bb of Ua){Ua=Object(sa.a)(1128,this.FDb[Bb]);if(!Ua){delete this.FDb[Bb];continue}const mc=Ua.tableCellNode;mc&&mc.isConnected?F.a.Wa(this.cY.h5b(mc))&&!this.hjd(Bb)&&(delete this.FDb[Bb],this.vFh(Ua)):delete this.FDb[Bb]}}detectLockLeak(){const Ua=[],Bb=new Date,mc=this.B8f();for(const Nc of mc)Nc.$p&&+Bb-+Nc.W1c>this.Hs.dgb&&Ua.push(Nc.shapeNode.Er);0<Ua.length&&da.a.J(509219553,828,15,"Following objects are locked longer than {0} : {1}",
this.Hs.dgb,Ua.join(";"))}switchPendingSveToFidelity(){const Ua=new Date,Bb=this.B8f();for(const mc of Bb)mc.$p||mc.shapeNode.ud&&this.ssc||!mc.Un||mc.hy||!(+Ua-+mc.Z0j>this.Hs.MNb)||mc.dB||mc.LNb()}updateLockIfImeActive(){if(this.FFg>=this.GFg&&this.Mxe){const Ua=this.kYi(this.Mxe);this.rvd(Ua)&&this.Mpc(Ua.slideId,Ua.get_shapeId(),2)}this.GFg=new Date}updateLockForActiveShapeNodes(){var Ua=ka.a(this.H2c);for(const Bb of Ua)Ua=Object(sa.a)(4,this.H2c[Bb]),this.rvd(Ua)&&this.Mpc(Ua.slideId,Ua.get_shapeId(),
3);this.H2c={}}updateLockForActiveTableCellNodes(){var Ua=ka.a(this.K2c);for(const Bb of Ua)if(Ua=Object(sa.a)(123,this.K2c[Bb]),this.rvd(Ua)){const mc=this.Fa.$m(Ua);this.Mpc(mc.slideId,mc.get_shapeId(),3,Ua.rowId.toString(),Ua.cellId.toString())}this.K2c={}}kYi(Ua){return(Ua=this.lr.HI(Ua))?this.Fa.$m(Ua.gb):null}P1g(Ua,Bb){Bb&&Bb.node?(Ua=Object(sa.a)(5,Bb.node),Ua)?Ua.loading||Ua.Hmc||Bb.property.id!==ha.a.pq.id||(Bb=this.Fa.oda(Ua),Ua=this.yc.uEa(Ua),Bb&&(Ua?(Bb=this.ARc(Bb.slideId,Bb.get_shapeId(),
Ua.rowId.toString(),Ua.cellId.toString()),this.K2c[Bb]=Ua):(Ua=this.xxb(Bb.slideId,Bb.get_shapeId()),this.H2c[Ua]=Bb))):da.a.J(509219551,828,10,"Invalid argument."):da.a.J(509219552,828,10,"Invalid argument.")}Y5k(Ua){const Bb=new B.a(2,1,this.Hs.ird,Object(n.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");Bb.customData=new va(Ua,!1);this.zb.Db(Bb);this.ZAe[this.xxb(Ua.slideId,Ua.get_shapeId())]=Bb}rtcNotifyStartEditing(Ua){Ua=Object(sa.a)(va,Ua.customData);const Bb=Ua.shapeNode;
this.rvd(Bb)&&this.VUj(Bb)&&this.Mpc(Bb.slideId,Bb.get_shapeId(),1);Ua.Wxh=!0}rvd(Ua){return Ua?Ua.isConnected:!1}VUj(Ua){return(Ua=this.$k(Ua))?Ua.cO:!1}$k(Ua){return Object(sa.a)(117,Ua.mg(this.Vb.Dn.Ma))}B8f(){const Ua=[];if(!this.ua.Ba)return Ua;var Bb=this.ua.Ba.Ek();if(!Bb)return Ua;for(const mc of Bb)(Bb=this.$k(mc))&&!Bb.Al?Ua.push(Bb):da.a.J(509219549,828,50,"Shape {0} on active slide doesn't have valid view element",mc.Er);return Ua}Exk(Ua){this.puh(Ua)&&(this.bWa.amIAlone||this.Y5k(Ua))}EH(Ua,
Bb){for(Ua=0;Ua<Bb.EE.length;Ua++){const Nc=Bb.EE[Ua];var mc=Object(sa.a)(4,Nc.context.node);mc&&mc.isConnected&&(mc=Object(sa.a)(117,mc.sc(this.Te)))&&(mc=this.$Sg.IF(mc.shapeNode))&&(1===Nc.Oca?mc.ajc():0===Nc.Oca&&mc.NEe())}}Dxk(Ua){if(this.puh(Ua)&&!this.Hs.nNc){var Bb=this.xxb(Ua.slideId,Ua.get_shapeId()),mc=Object(sa.a)(B.a,this.ZAe[Bb]);if(mc){const Nc=Object(sa.a)(va,mc.customData);this.zb.Lg(mc);Nc&&Nc.Wxh&&this.Mpc(Ua.slideId,Ua.get_shapeId(),4);this.ZAe[Bb]=null}}}Oxk(Ua,Bb){this.d7g(Bb.Jw)}d7g(Ua){Ua.sL()||
Ua.shapeNode.xab?this.l6h(Ua):this.e7g(Ua)}pgd(Ua,Bb){if((Bb=Object(sa.a)(pa.TableCellNode,Bb.node))&&(Ua=Object(sa.a)(1128,Bb.mg(this.Te)))&&Bb.isConnected){Bb=this.cY.h5b(Bb);const mc=this.ONe(Ua.tableCellNode);F.a.Wa(Bb)?mc?(this.doe(Ua,this.gka(mc.clientId,Ha.M0d)),this.Q4e(Ua)):F.a.Wa(Bb)&&(this.ONe(Ua.tableCellNode)||this.vFh(Ua)):(this.doe(Ua,this.gka(Bb,Ha.M0d)),this.Q4e(Ua))}}doe(Ua,Bb){Ua.lock(Bb)}vFh(Ua){Ua.unlock()}Mpc(Ua,Bb,mc,Nc="",nd=""){try{const Dd=new Fa(this.NDb,Ua.cvc,Bb,mc,Nc,
nd);this.Jgc.Zfa(7,Dd)}catch(Dd){da.a.J(509219548,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.NDb,Dd.stack)}}Ikc(Ua,Bb){this.Ha.pptCoauthSurveyFloodgateEnabled&&!this.xUg&&8===Bb.type&&this.TXa&&this.yjl(Bb)&&(da.a.J(509219547,814,50,"Log coauth activity"),this.xUg=!0,this.TXa.continueWith(()=>{this.TXa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===Bb.type&&((Ua=Bb.Eza)?Ua.clientId===this.NDb?da.a.J(509219545,828,15,"Lock notification : lock notification from myself recieved"):
(da.a.J(509219544,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Ua.clientId,this.NDb),Ua=new ta(Ua.clientId,Ua.slideId,Ua.shapeId,Ua.lockType,Ua.rowId,Ua.cellId),this.A6h(Ua),this.wKk(Ua)):da.a.J(509219546,828,10,"Lock notification: invalid lock data recieved"))}e7g(Ua){if(!Ua||Ua.Al)da.a.J(509219543,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Ua);else{var Bb=Ua.shapeNode;if(!(Bb.Rf||this.vre&&Bb.ud&&(this.Hs.Fub||this.ssc))){var mc=this.cY.u5b(Bb);mc?this.V1c(Ua,
this.gka(mc,Ha.M0d)):(Bb=this.cY.j1f(Bb))?(this.V1c(Ua,this.gka(Bb,Ha.JPi)),this.P4e(Ua)):(Bb=this.ONe(Ua.shapeNode))?(this.V1c(Ua,this.gka(Bb.clientId,this.j8d(Bb.lockType))),this.P4e(Ua)):Ua.$p&&this.uFh(Ua)}}}uFh(Ua){const Bb=this.$Sg.IF(Ua.shapeNode);Bb&&(Bb.Pud(null),Ua.unlock(this.yUg||!Bb.Zbe))}V1c(Ua,Bb){Ua.lock(Bb);Ua.sL()&&this.pa.Qh()}yjl(Ua){if(!Ua||null===Ua.Eza)return!1;Ua=this.$Ck(Ua.Eza);for(const Bb of Ua)Bb&&Bb.clientId&&(Bb.clientId.toLowerCase()===this.NDb.toLowerCase()?(this.XGg++,
this.G8c=this.G8c===(new Date(0)).getTime()?(new Date).getTime():this.G8c,this.H8c=(new Date).getTime()):this.aQj(Bb.clientId)||(this.SHg++,this.Tfc=this.Tfc===(new Date(0)).getTime()?(new Date).getTime():this.Tfc,this.lze=(new Date).getTime()));return 5<=this.XGg&&5<=this.SHg&&(this.lze>=this.G8c&&this.Tfc<=this.H8c||this.H8c>=this.Tfc&&this.H8c<=this.lze)&&1<=this.uE.jxb()?!0:!1}$Ck(Ua){let Bb=null;try{Bb=Ua}catch(mc){}if(null===Bb||!Bb.length){let mc=null;try{mc=Ua}catch(Nc){da.a.J(509219541,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==mc)return[mc]}return Bb}aQj(Ua){Ua=this.gka(Ua);const Bb=this.gka(this.NDb);return Ua&&Bb&&Ua.userName===Bb.userName&&Ua.email===Bb.email?!0:!1}j8d(Ua){switch(Ua){case 1:return Ha.Tpl;case 2:return Ha.PBj;case 3:return Ha.yAl;case 4:return Ha.XQi}da.a.J(509219539,828,10,"Unknown lock type");return"Unknown lock type"}A6h(Ua){if(Ua&&Ua.Uqd){var Bb=Ua.Omg?this.ARc(new Ba.a(Ua.Uqd),Ua.shapeId,Ua.CAh,Ua.oAh):this.xxb(new Ba.a(Ua.Uqd),Ua.shapeId);
if(4===Ua.lockType)this.DDb[Bb]=Ua;else{var mc=Object(sa.a)(ta,this.DDb[Bb]);mc?(mc=this.i8d(mc),this.i8d(Ua)>mc&&(this.DDb[Bb]=Ua)):this.DDb[Bb]=Ua}}}i8d(Ua){return this.ecj(Ua.lockType)-(+new Date-+Ua.Oog)}ecj(Ua){switch(Ua){case 1:return this.Hs.hrd;case 2:return this.Hs.LWc;case 3:return this.Hs.Ytd;case 4:return this.Hs.dvb}da.a.J(509219536,828,10,"Unknown lock type");return 0}ONe(Ua){if(Object(ia.a)(4,Ua)){Ua=Object(sa.a)(4,Ua);if(!Ua.slideId)return null;Ua=this.xxb(Ua.slideId,Ua.get_shapeId());
return this.hjd(Ua)}if(Object(ia.a)(123,Ua)){Ua=Object(sa.a)(123,Ua);let Bb=this.Fa.oda(Ua);if(!Bb.slideId)return null;Ua=this.ARc(Bb.slideId,Bb.get_shapeId(),Ua.rowId.toString(),Ua.cellId.toString());return this.hjd(Ua)}return null}hjd(Ua){if(!Ua)return null;const Bb=Object(sa.a)(ta,this.DDb[Ua]);return Bb?0>=this.i8d(Bb)?this.DDb[Ua]=null:Bb:null}P4e(Ua){const Bb=this.Uij(Ua);Bb&&(this.EDb[Bb]=Ua)}Q4e(Ua){const Bb=this.wlj(Ua);Bb&&(this.FDb[Bb]=Ua)}Uij(Ua){return Ua?this.xxb(Ua.shapeNode.slideId,
Ua.shapeNode.get_shapeId()):null}wlj(Ua){if(!Ua)return null;Ua=Ua.tableCellNode;const Bb=this.Fa.oda(Ua);return this.ARc(Bb.slideId,Bb.get_shapeId(),Ua.rowId.toString(),Ua.cellId.toString())}xxb(Ua,Bb){return String.format("{0}#{1}#{2}",Ua.sid,Ua.cid,Bb)}ARc(Ua,Bb,mc,Nc){return String.format("{0}#{1}#{2}#{3}#{4}",Ua.sid,Ua.cid,Bb,mc,Nc)}EPj(Ua){const Bb=Object(sa.a)(116,this.ua.Ba);return Bb&&Ba.a.Hwh(Ua.Uqd,Bb.Cb.cvc)?!0:!1}wKk(Ua){if(this.EPj(Ua)){var Bb=Ua.shapeId,mc=Ua.clientId;this.ua.Ba&&(Bb=
this.ua.Ba.iT(Bb))&&(Ua.Omg&&this.Hs.$0d?this.JKk(Ua,mc,Bb):this.DKk(Ua,mc,Bb))}}DKk(Ua,Bb,mc){mc.Rf||this.vre&&mc.ud&&(this.Hs.Fub||this.ssc)||!(mc=this.$k(mc))||(this.V1c(mc,this.gka(Bb,this.j8d(Ua.lockType))),this.P4e(mc))}JKk(Ua,Bb,mc){if((mc=this.ylj(mc,Ua.CAh,Ua.oAh))&&mc.isConnected){var Nc=Object(sa.a)(1128,mc.mg(this.Te));Nc&&F.a.Wa(this.cY.h5b(mc))&&(this.doe(Nc,this.gka(Bb,this.j8d(Ua.lockType))),this.Q4e(Nc))}}ylj(Ua,Bb,mc){Ua=this.yc.JN(Object(sa.a)(4,Ua));if(!Ua)return null;var Nc=this.yc.oka(Ua);
Ua=null;for(const nd of Nc){Nc=this.yc.h$a(nd);for(const Dd of Nc)if(Dd.rowId.toString()===Bb&&Dd.cellId.toString()===mc){Ua=Dd;break}}return Ua}l6h(Ua){const Bb=new B.a(0,1,0,()=>{this.e7g(Ua)},90,"79");this.zb.Db(Bb)}zwi(Ua){this.FFg=new Date;this.Mxe=this.tXi(Ua.Ec)}tXi(Ua){return Ua?Ua.querySelector(".Paragraph"):null}gka(Ua,Bb=""){const mc=this.uE.gka(Ua);if(mc)return mc;da.a.J(509219531,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Ua,Bb);return this.epj}puh(Ua){return!this.Hs.F_d&&
!(this.Hs.Fub&&Ua.ud)&&!Ua.Rf}}Ha.M0d="EditingBy";Ha.JPi="EditingByInSameWorker";Ha.Tpl="StartEditing";Ha.XQi="EndEditing";Ha.PBj="ImeTyping";Ha.yAl="Typing";Object(h.a)(Ha,"CoauthStateChangesHandler",null,[1243]);class Ya{constructor(Ua){this.Rua={};this.ww=Ua.bD;this.init(Ua)}init(Ua){if(Ua=Ua.g_)for(const Bb of Ua)Bb.ID!==this.ww&&(this.Rua[Bb.ID]=new Date)}q5h(Ua){for(let Bb=0;Bb<Ua.length;Bb++)Ua[Bb]in this.Rua||Ua[Bb]===this.ww||(this.Rua[Ua[Bb]]=new Date)}Uql(Ua){const Bb=this.Rua[Ua];Bb&&
(da.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.ww,Ua,(new Date).getTime()-Bb.getTime()),delete this.Rua[Ua])}Tql(Ua){const Bb=this.Rua[Ua];Bb&&(da.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.ww,Ua,(new Date).getTime()-Bb.getTime()),delete this.Rua[Ua])}Sql(){for(const Ua of Object.keys(this.Rua))da.a.J(37590345,
814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.ww,Ua,(new Date).getTime()-this.Rua[Ua].getTime());this.Rua={}}}Object(h.a)(Ya,"EditorPresenceTracker",null,[1242]);class Ka{constructor(Ua){this.Kek=Ua;this.lM=new D.a;this.lM.Gg(this.Kek)}}Object(h.a)(Ka,"PPTRtcProvider",null,[1241]);var Pa=d(106),Oa=d(1199),oa=d(699);class Xa{constructor(Ua,Bb,mc,Nc,nd){this.xea=null;this.dU=!1;this.Wqe=this.sye=null;this.L6j=
Pa.a.create();this.V4c=!1;this.i4b=0;this.kU=nd;mc.vg&&(this.findSessionResponse=Ua,Nc.Ruf(Object(n.a)(this,this.V8k,"sessionPropertiesChanged")));this.OGa=new Oa.a(()=>Bb())}get findSessionResponse(){return this.xea}set findSessionResponse(Ua){if(this.dU)da.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.xea=Ua)this.dU=!0,this.sye=this.xea.nHf,this.Wqe=this.xea.QA}get bna(){return this.dU?this.sye:
this.OGa.value.bna}set bna(Ua){this.dU?this.sye=Ua:this.OGa.value.bna=Ua}cWe(Ua){this.OGa.value.cWe(Ua)}get QA(){return this.dU?this.Wqe:this.OGa.value.QA}set QA(Ua){this.dU?this.Wqe=Ua:this.OGa.value.QA=Ua}ASc(){let Ua;da.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.dU,this.V4c);return this.dU?(Ua=this.xea.correlationId||this.L6j.toString(),da.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",
Ua),{returnValue:String.format("{0}&{1}={2}",this.xea.Q5,u.AFrameworkApplication.iXd,F.a.Ne(Ua)),correlationId:Ua}):this.V4c?this.OGa.value.ASc():(da.a.J(51140183,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}H9d(Ua,Bb,mc,Nc,nd){da.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.dU);this.dU?(Ua(this.xea.I0b),mc(new oa.a(this.xea.Dcd,this.xea.Acd,this.xea.zcd,
this.xea.ZUc))):(this.OGa.value.H9d(Ua,Bb,mc,Nc,nd),this.V4c=!0);this.kU&&this.kU.Zh(26,!this.V4c)}X_d(){da.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.dU);this.dU?this.dU=!1:this.OGa.value.X_d()}tna(Ua,Bb){da.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.dU);this.dU||this.OGa.value.tna(Ua,Bb)}V8k(){da.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",
this.dU);this.dU=!1}}Object(h.a)(Xa,"PptAssignRtcMachineStrategy",null,[1240]);var Hb=d(1156);class Ob{constructor(){this.lo=null}SYb(Ua,Bb){this.lo||(this.lo={});this.lo[Bb]||(this.lo[Bb]=0);this.lo[Bb]+=Ua}getData(){return this.lo}reset(){this.lo=null}}Object(h.a)(Ob,"MultiSumDataAggregator",null,[1524]);class eb{constructor(Ua,Bb){this.$wd=Hb.a.GW(Ua,Bb,new Ob,!0)}Ff(Ua){this.$wd.track(1,Ua)}}Object(h.a)(eb,"MultiCounter",null,[1553]);class Eb{constructor(Ua,Bb,mc,Nc){this.uz=Ua;this.V4=Bb;this.Khk=
mc;this.M9j=Nc;this.uz.WBa(Object(n.a)(this,this.a4k,"rtcOnUpdateNotificationReceived"))}a4k(Ua,Bb){0===Bb.type&&(this.M9j.Ff("CU"),this.Khk||this.DF())}DF(){!u.AFrameworkApplication.Ug&&this.V4.gX&&this.V4.DF(null,null,null)}}Object(h.a)(Eb,"ContentNotificationManager",null,[]);class oc extends Eb{constructor(Ua,Bb,mc,Nc){super(Ua,Bb,mc,Nc)}static init(){if(ca.App.Kb){var Ua=ca.App.Kb.Kd;if(Ua&&(Ua.Stf(oc.y1g),Ua=Ua.xi)&&(Ua=Ua.contentReplicator)){var Bb=ca.App.Ih;if(Bb&&Bb.rw&&(Bb=G.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var mc=
u.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),Nc=new eb(11,1);oc.v3c=oc.v3c||new oc(Bb,Ua,mc,Nc);oc.v3c.DF()}}}}static y1g(Ua){oc.v3c||(Ua.$hh(oc.y1g),oc.init())}}oc.v3c=null;Object(h.a)(oc,"PptContentNotificationManager",Eb,[]);var Sb=d(105),qc=d(346),$a;(function(Ua){Ua[Ua.signalRConnectFailed=0]="signalRConnectFailed";Ua[Ua.findSessionFailed=1]="findSessionFailed"})($a||($a={}));Object(h.b)("RtcConnectFailureType",$a);var ab=d(261);class Ib{constructor(Ua,Bb,mc,Nc,nd,Dd){this.P8c=
this.jHg=this.geb=this.feb=0;this.Rdb=this.nHa=this.jma=this.afc=this.l5c=this.g0=null;this.J5c=this.L5c=this.M5c=this.H5c=this.I5c=!1;this.gSg=Ua;this.wj=Bb;this.zO=mc;this.zO.tGc(Object(n.a)(this,this.gHb,"onNetworkHealthStateChanged"));this.Uj=Nc;this.VAe=Dd;$addHandler(window,"visibilitychange",Object(n.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.xfk=nd;this.xfk.yai(Object(n.a)(this,this.Zwk,"onRtcConnectFailed"))}gHb(Ua,Bb){Bb.YZc||(this.L5c=this.M5c=!0)}onVisibilityChange(){window.document.hidden&&
(this.H5c=this.I5c=!0)}Zwk(Ua,Bb){Ua=Bb.VVi;if(Bb=Bb.errorMessage){if(0===Ua){let Nc,nd;({Wce:mc,Xce:Nc,Yi:nd}=aa.RtcUtils.$Tf(Bb.ErrorDetails));Bb.HttpErrorCode=mc;Bb.HttpErrorStatus=Nc;Bb.Exception=nd;delete Bb.ErrorDetails;if(!mc&&this.VAe&&0<this.VAe.length)try{var mc=!0;const Dd=window.location.hostname.toLowerCase();for(const La of this.VAe.split(";"))if(Dd.endsWith(La)){mc=!1;break}Bb.IsCORS=mc.toString()}catch(Dd){Bb.Unexpected=Dd.message}}da.a.J(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",
this.wj.amIAlone,window.document.hidden,this.Uj.JQ,$a[Ua],Sb.a.toJSON(Bb));this.J5c||(this.J5c=this.aUj(Ua,Bb))}}aUj(Ua,Bb){const mc=ab.c(Bb,"HttpErrorCode",-1);return 500<=mc&&599>=mc||1===Ua&&"FindSessionRequestFailed"!==Bb.FindSessionFailureReason?!0:!1}rbg(){return this.g0&&1===this.geb?this.I5c||this.M5c:this.jma&&1<this.geb?this.H5c||this.L5c:!1}hyj(){return this.jma&&0<this.P8c?this.H5c||this.L5c:this.g0&&0<this.feb?this.I5c||this.M5c:!1}Dkd(){this.feb++;this.afc=new Date;this.g0||(this.g0=
new Date,this.I5c=window.document.hidden,this.M5c=!this.Uj.JQ)}BPe(){this.zfh(0)}zfh(Ua){this.geb++;this.nHa=new Date;this.l5c?this.FKc>this.gSg.hmh&&(Ua={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.geb,["numberOfConnectionAttempts"]:this.feb,["firstConnectionAttempt"]:this.g0?this.g0.toISOString():"",["lastConnectionSuccess"]:this.nHa?this.nHa.toISOString():"",["lastUnexpectedDisconnect"]:this.jma?this.jma.toISOString():"",["lastExplicitDisconnect"]:this.Rdb?this.Rdb.toISOString():
"",["reconnectDurationInMs"]:this.FKc,["hasPageHiddenOrNetworkIssue"]:this.rbg()},da.a.J(36804373,500,15,Sb.a.toJSON(Ua))):(this.l5c=this.nHa,qc.a.instance.ic("FirstPresenceUpdated",(new Date).getTime().toString()),this.FKc>this.gSg.hmh&&(Ua={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.feb,["firstConnectionAttempt"]:this.g0?this.g0.toISOString():"",["firstConnectionSuccess"]:this.l5c?this.l5c.toISOString():"",["lastExplicitDisconnect"]:this.Rdb?this.Rdb.toISOString():
"",["connectDurationInMs"]:this.FKc,["connectionDurationFromStopWatchInMs"]:Ua,["hasPageHiddenOrNetworkIssue"]:this.rbg()},da.a.J(36804373,500,15,Sb.a.toJSON(Ua))))}Ekd(){this.jHg++;const Ua={["numberOfFailedConnections"]:this.jHg,["numberOfConnectionAttempts"]:this.feb,["firstConnectionAttempt"]:this.g0?this.g0.toISOString():"",["lastConnectionAttempt"]:this.afc?this.afc.toISOString():"",["lastExplicitDisconnect"]:this.Rdb?this.Rdb.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),
["disconnectedDurationMs"]:this.XMi,["hasPageHiddenOrNetworkIssue"]:this.hyj()};this.J5c?e.ULS.sendTraceTag(41702299,500,15,Sb.a.toJSON(Ua)):e.ULS.sendTraceTag(36804375,500,15,Sb.a.toJSON(Ua))}Onc(){this.P8c++;this.jma=new Date;this.H5c=window.document.hidden;this.L5c=!this.Uj.JQ}JRk(){this.qil()&&this.Ekd();this.Rdb=new Date;this.uti()}uti(){this.P8c=this.geb=this.feb=0;this.nHa=this.jma=this.afc=this.g0=null;this.J5c=!1}qil(){return!!this.afc&&!this.nHa&&!this.jma}get FKc(){if(this.nHa){if(this.g0&&
1===this.geb)return this.wj.JRc(this.g0,this.nHa);if(this.jma&&1<this.geb)return this.wj.JRc(this.jma,this.nHa)}return 0}get XMi(){return this.jma&&0<this.P8c?this.wj.JRc(this.jma,new Date):this.g0&&0<this.feb?this.wj.JRc(this.g0,new Date):0}}Object(h.a)(Ib,"PptRealtimeChannelMetrics",null,[1239]);var gc=d(76),Ta=d(33),Ab=d(39);class kc{constructor(Ua,Bb,mc,Nc,nd){this.Mbk=Ua.toLowerCase();this.uHa=Bb;this.Ml=mc;this.eu=Nc;this.Nq=nd;this.eu.Bia(Object(n.a)(this,this.wkc,"onShapeNodeLoaded"));this.Nq.Wuf(Object(n.a)(this,
this.ykc,"onShapeViewElementUnlocked"))}dispose(){this.eu.k_a(Object(n.a)(this,this.wkc,"onShapeNodeLoaded"));this.Nq.Uih(Object(n.a)(this,this.ykc,"onShapeViewElementUnlocked"))}kC(Ua){return this.szi(Ua)||this.XHf(Ua)}XHf(Ua){if(!Ua||Ua.Rf)return!1;const Bb=Ua.sa(Ab.a.L0d,"");return+new Date-+Ua.W1c<this.uHa&&!!Bb&&Bb.toLowerCase()!==this.Mbk}szi(Ua){return!!this.u5b(Ua)}j1f(Ua){let Bb="";Ua&&this.XHf(Ua)&&(Bb=Ua.eb(Ab.a.L0d));return Bb}u5b(Ua){return Ua?Ua.sa(Ab.a.DQf,""):""}h5b(Ua){return Ua?
Ua.sa(Ab.a.$pi,""):""}vFl(Ua){if(Ua&&(Ua.kC=this.kC(Ua),Ua.anchor)){const mc=this.Ml.fsa(Ua);for(;mc.moveNext();){var Bb=mc.currentNode;Ta.ParagraphReader.$d(Bb)&&(Bb=Object(sa.a)(gc.AParagraphNode,Bb))&&(Bb.kC=Ua.kC)}}}ykc(Ua,Bb){this.vFl(Bb.Jw.shapeNode)}wkc(Ua,Bb){Ua=Bb.node;Ua.rEl();Ua.kC=this.kC(Ua)}}Object(h.a)(kc,"PptWetChangeHandler",null,[1238,106]);class fb{constructor(Ua){this.nek=Ua}z3(){return this.nek.z3()}}Object(h.a)(fb,"PresenceCache",null,[]);var Qb=d(919),mb=d(1137),Jb=d(1224),
Ub=d(1019),tb=d(1212);class Bc extends z.a{constructor(){super();this.J9c=[]}yia(Ua){Ua&&(da.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Ua.clientId,Ua.presence.toString()),Array.add(this.J9c,Ua))}jld(Ua){(Ua=this.p$a(Ua))&&this.hKb(Ua);return Ua}hKb(Ua){Ua&&(da.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Ua.clientId,Ua.presence.toString()),Array.remove(this.J9c,Ua))}p$a(Ua){for(const Bb of this.J9c)if(Bb.clientId===
Ua)return Bb;return null}z3(){return this.J9c}}Object(h.a)(Bc,"PresenceDataManager",z.a,[]);var Gb=d(41),Hc=d(733);class $b{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc,td,Nd){this.clientId=Ua;this.data=La;this.chatThreadId=Bb;this.chatThreadDiscoveryUri=mc;this.inChat=Nc;this.email=nd;this.capabilities=Dd;this.userName=gb;this.clientType=vc;this.fHasClientEverExperiencedNetworkLoss=td;this.isAnonymous=Nd}}Object(h.a)($b,"SerializablePresenceInfo",null,[]);class lc{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc,
td,Nd){this.ygc=null;this.ww=Ua.toLowerCase();this.uB=Bb;this.bAe=mc;this.Mtg=Nc;this.Ltg=nd;this.uAg=Dd;this.bdc=La;this.ztg=gb;this.Yma=vc;this.dSg=td;this.rxg=Nd}Q9d(){return new $b(this.ww,this.Mtg,this.Ltg,this.uAg,this.bdc,this.ztg.capabilities,this.bAe?this.bAe.Q9d():null,this.Yma,this.dSg,this.rxg,u.AFrameworkApplication.Ylb||u.AFrameworkApplication.PQ)}syj(Ua){if(!(Ua&&this.ak.equals(Ua.slideId)&&this.presence&&this.presence.QU))return!1;for(const Bb of this.presence.QU)if(Bb===Ua.get_shapeId())return!0;
return!1}get presence(){return this.bAe}get clientId(){return this.ww}get chatThreadId(){return this.Mtg}get chatThreadDiscoveryUri(){return this.Ltg}get inChat(){return this.uAg}get email(){return this.bdc}get capabilities(){return this.ztg}get ak(){return this.uB}get userName(){return this.Yma}get clientType(){return this.dSg}get fHasClientEverExperiencedNetworkLoss(){return this.rxg}get presenceUser(){return this.ygc}set presenceUser(Ua){this.ygc&&(Ua?!this.ygc.client||0===this.ygc.client||Ua.client&&
0!==Ua.client||da.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.ww):da.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.ww));this.ygc=Ua}static ALc(Ua){if(!Ua||!Ua.clientId)return da.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const Bb=Hc.a.ALc(Ua.data);let mc=0;Ua.clientType&&8>=Ua.clientType&&(mc=Ua.clientType);return new lc(Ua.clientId,Bb.ak,Bb,Ua.chatThreadId,
Ua.chatThreadDiscoveryUri,Ua.inChat,Ua.email,new qa.a(Ua.capabilities),Ua.userName,mc,Ua.fHasClientEverExperiencedNetworkLoss)}}Object(h.a)(lc,"PresenceEntry",null,[]);class Vb extends Sys.EventArgs{constructor(Ua,Bb,mc,Nc,nd,Dd){super();this.uB=Ua;this.tik=mc;this.nad=Bb;this.rTh=Nc;this.vgk=nd;this.qek=Dd}get slideId(){return this.uB}get user(){return this.tik}get shapes(){return this.nad}get c9(){return this.rTh}get Uwh(){return this.vgk}get sbh(){return this.qek}}Object(h.a)(Vb,"SlidePresenceChangedEventArgs",
Sys.EventArgs,[]);var ic=d(30);class qb extends z.a{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc,td,Nd,Od,Oc,Af,Ae,Ye,Wd,je,dg,nf,Cb,Cf,of,Lg,vd,Lh,tf){super();this.kR=new Bc;this.So=null;this.Cug=[];this.Dug=null;this.TBb=!0;this.vdb=!1;this.SFg=new Date;this.dYa=null;this.Cxg=this.sxg=this.Izg=!1;this.I9c=null;this.k$=Ua;Ua.userName||(Ua.userName=Lg);this.Pb=Bb;this.uz=mc;this.ww=Nc.clientId;this.G$=Nc.Lw;this.Ce=nd;this.mc=Cb;this.vgc=nf;this.kU=Cf;this.zO=vd;this.bma=tf;of.execute(Ue=>{this.So=Ue});
this.Bzj();this.wj=Oc;this.Gq=Af;this.dDb=Ae.qlg;this.Tec=Ae.jUj;this.oec=Ae.podsDefaultToRtcForPresenceEnabled;this.M$j=Ae.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.oFg=u.AFrameworkApplication.Yz;this.Swe=Ae.vg&&Ae.pptNoRtcConnectWhenReadOnlyEnabled;this.pa=Dd;this.pa.wF(Object(n.a)(this,this.EH,"onSelectionChanged"));this.Es=La;this.Es.wbi(Object(n.a)(this,this.ezk,"onValidShapeIdLoaded"));this.qd=gb;this.qd.aW(Object(n.a)(this,this.fqk,"onActiveSlideDOMReady"));this.kJ=vc;this.kJ.gPd(Object(n.a)(this,
this.Led,"onEditorTableUpdate"));this.ai=Ye;this.ai.KA(Object(n.a)(this,this.DB,"onSessionEnd"));this.ai.fC(Object(n.a)(this,this.Do,"onSessionRehydrated"));this.ai.EPa(Object(n.a)(this,this.mkc,"onOutboundReplication"));this.S5j=Ae.pptAwayStatusTimeGapForPresenceUpdateInMs;this.Ixg=Ae.qnl;this.ia=Nd;this.ua=td;this.K9c=Od;this.C4c=Wd;this.Meb=je;this.aCb=dg;Ae.vg&&(this.ai.Quf(Object(n.a)(this,this.skc,"onSessionAccessTokenExpiring")),this.ai.IGc(Object(n.a)(this,this.Fna,"onSessionAccessTokenExpired")),
this.ai.EPd(Object(n.a)(this,this.agd,"onSessionExpired")),this.Pb.gf(()=>{this.k$.userName=this.Pb.appSettings.UserName;this.k$.email||(this.k$.email=u.AFrameworkApplication.fa.Ga("UserPrincipalName"));this.mc.zL||(da.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.Swe&&this.ai.O7(Object(n.a)(this,this.Dw,"onUnifiedAppStateChanged"))}),this.oFg&&this.ai.LGc(Object(n.a)(this,this.zfa,"onWopiTokenRefreshed")));da.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",
this.oFg)}wb(){this.ia.ra(ic.a.WZa,Gb.a.application,Object(n.a)(this,this.WZa,"querySlidePresenceUsers"),96)}WZa(Ua,Bb,mc,Nc,nd){nd.Frc=this.v6b(nd.slideId);nd.rbh=this.jxb();return 32}v6b(Ua){return(Ua=this.M6f(Ua))?Ua.length:0}Bzj(){this.uz.f6a(Object(n.a)(this,this.Myi,"connectionStateChanged"));this.uz.GGc(Object(n.a)(this,this.presenceUpdated,"presenceUpdated"));u.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&this.uz.WBa(Object(n.a)(this,this.AEl,"updateNotificationReceived"));
N.a.getInstance().e9h(Object(n.a)(this,this.F3g,"onGotCompletePersistentStateWithMetadata"));this.Ixg&&this.zO.tGc(Object(n.a)(this,this.ovk,"onNetworkHealthChanged"));this.dYa=this.G$.Ci("WebServiceCall","RtcConnection");this.kU.gSi();this.uz.connect()}agh(){const Ua=this.uz.gRc();this.qHh(new mb.a(Ua,null));this.Ipc()}ovk(Ua,Bb){Bb.YZc||(this.kU.hSi(),this.sxg=!0)}F3g(Ua,Bb){this.kU.kSi(Bb.TIk);N.a.getInstance().eYk(Object(n.a)(this,this.F3g,"onGotCompletePersistentStateWithMetadata"))}Myi(Ua,Bb){da.a.J(512360715,
814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",qb.f6d(Bb.oldState),qb.f6d(Bb.newState),this.ww);switch(Bb.newState){case 2:this.dYa.stop();Ua=this.dYa.Vq;this.kU.fSi();this.agh();this.vgc.zfh(Ua);break;case 1:2===Bb.oldState&&this.vgc.Onc();this.vgc.Dkd();break;case 0:this.TBb?this.yti():2===Bb.oldState&&(window.setTimeout(()=>{this.uz.connect()},0),da.a.J(512360714,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.Ce.k6b().getTime()),
this.vgc.Onc())}}getSelectedShapes(){if(!this.Tec)return null;const Ua=[],Bb=this.pa.Wd();for(let mc=0;mc<Bb.length;++mc)Array.add(Ua,Bb[mc].get_shapeId());0<Ua.length&&Ua.sort();return Ua}yti(){var Ua=this.kR.z3();if(Ua&&Ua.length){Ua=Array.clone(Ua);for(const Bb of Ua)this.hKb(Bb);this.raiseEvent("PresenceChanged")}}CUe(Ua,Bb){try{this.k$.email||(this.k$.email=u.AFrameworkApplication.fa.Ga("UserPrincipalName"));const mc=new Hc.a(Ua,Bb),Nc=new lc(this.k$.clientId,Ua,mc,this.k$.chatThreadId,this.k$.chatThreadDiscoveryUri,
this.k$.inChat,this.k$.email,this.k$.capabilities,this.k$.userName,1,this.sxg);this.k$.email||da.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");this.uz.CUe(Nc.Q9d()).continueWith(()=>{da.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.ww,mc.toString(),this.Ce.k6b().getTime())});this.SFg=new Date;this.kU.o2j();this.GRk(Ua,Bb);da.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",
this.ww,mc.toString(),this.Ce.k6b().getTime());this.gSk(mc)}catch(mc){da.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",mc.toString(),this.ww)}}presenceUpdated(Ua,Bb){Ua=!!this.So&&this.So.k_;da.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.ww,Ua);if(!Ua){this.kU.q2j(Bb.tPb);Ua=null;this.G$&&(Ua=this.G$.Ci("ServerNotification","Presence Updated"));try{this.qHh(Bb)}finally{Ua&&
Ua.stop()}}}AEl(Ua,Bb){da.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",Bb.type,this.ww)}qHh(Ua){this.B6h(Ua.tPb);this.i_a(Ua.XOf);da.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}Ipc(){this.ua.ak?this.CUe(this.ua.ak,this.getSelectedShapes()):da.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}EH(){if(this.ua.ak){var Ua=
this.getSelectedShapes();(qb.wyj(this.Dug,this.ua.ak)||qb.cce(Ua,this.Cug))&&this.Ipc()}else da.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}fqk(Ua,Bb){Bb.Ba?this.ua.ak?this.Ipc():da.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):da.a.J(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}ezk(Ua,Bb){this.ua.ak?Array.contains(this.getSelectedShapes(),
Bb.shapeNode.get_shapeId())&&this.Ipc():da.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}Jml(Ua,Bb,mc){Bb=this.O_f(Bb);Ua=this.O_f(Ua);this.Ce.q5i().ctc.raiseEvent(qb.P0d,new Jb.a(this.wj.bD,null,Bb,Ua,null,0,0,mc))}O_f(Ua){const Bb=new Ub.a;for(let mc=0;mc<Ua.length;mc++){const Nc=Ua[mc];if(!Nc)continue;if(Nc.ID===this.wj.bD)continue;if(!Nc.EmailAddress){Bb.$(Nc.ID,this.N_f(Nc));continue}const nd=this.kR.p$a(this.wj.bD);nd&&nd.email&&
Nc.EmailAddress&&nd.email.toUpperCase()===Nc.EmailAddress.toUpperCase()||Bb.$(Nc.EmailAddress.toUpperCase(),this.N_f(Nc))}return Bb.values}N_f(Ua){const Bb=new tb.a;Bb.EmailAddress=Ua.EmailAddress;Bb.Id=Ua.ID;Bb.Name=Ua.Name;return Bb}Led(Ua,Bb){this.Jml(Bb.gpg,Bb.iyf,Bb.ZMj);if(Ua=this.wj.g_){var mc=Bb.gpg;for(var Nc=0;Nc<mc.length;Nc++)this.C4c.Uql(mc[Nc].ID);mc=[];Bb=Bb.iyf;for(Nc=0;Nc<Bb.length;Nc++){let Dd=Bb[Nc];const La=Dd.ID;if(La!==this.wj.bD){const gb=this.kR.p$a(La);gb?this.aCb.BAf(gb.email,
Dd.EmailAddress):Array.add(mc,La)}}this.C4c.q5h(mc);2<=Ua.length&&da.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.ww,Ua.length);mc=[];Bb=[];for(var nd of Ua)Array.add(mc,nd.ID),nd.ID===this.wj.bD||this.kR.p$a(nd.ID)||Array.add(Bb,nd.ID);da.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",
this.ww,Ua.length,mc.join(","),Bb.join(","));for(const Dd of this.kR.z3())({editor:nd}=this.wj.Hlb(Dd.clientId)).returnValue?this.Eyj(nd.ColorIndex)?(this.cSk(Dd),Ua=this.Meb.Gta(new Qb.a(nd.EmailAddress,void 0,nd.Name),nd.ColorIndex,nd.ID,0),Dd.presenceUser=new E.a(Dd.clientId,nd.Name,Ua,new qa.a(1),null,null,Dd.clientType),this.K9c.rkd(new Vb(Dd.ak,Dd.presence.QU,Dd.presenceUser,!0,this.v6b(Dd.ak),this.jxb())),da.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",
Dd.clientId,Dd.presence.toString(),Dd.presenceUser.color,this.ww)):da.a.J(512360672,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",Dd.clientId,Dd.presence.toString(),this.ww):da.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Dd.clientId,Dd.presence.toString(),Dd.presenceUser?Dd.presenceUser.color:"",this.ww);this.raiseEvent("PresenceChanged")}else da.a.J(512360675,
814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.ww)}DB(Ua,Bb){this.C4c.Sql();5!==Bb.lG&&(da.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}skc(){da.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.vdb||(da.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.vdb=!0)}Fna(){da.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");
this.vdb||(da.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.vdb=!0)}agd(){da.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}zfa(Ua,Bb){da.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{Bb.t0c?(da.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",qb.f6d(this.uz.connectionState)),this.vdb=!1,this.Swe&&!this.mc.zL?da.a.J(512360661,
814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.TBb||2!==this.uz.connectionState?this.connect():(Ua={},Ua.qs=this.bma.presentationId.string,da.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.uz.Plb(Ua))):da.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(mc){da.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",mc)}}Do(Ua,Bb){this.M$j&&this.vdb||
this.Swe&&!this.mc.zL?da.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.vdb,this.mc.zL):4!==Bb.Wxa||this.TBb?this.connect():(da.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.agh())}Dw(Ua,Bb){Bb.bke&&!this.mc.zL&&(da.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){da.a.J(512360654,
814,50,"PresenceManager : Connect");this.TBb=!1;this.uz.connect()}mkc(){this.Fil()&&(da.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.Ipc())}Fil(){const Ua=this.uz.rdj();return Ua?2===Ua.status||+new Date-+this.SFg>this.S5j?!0:!1:!1}rSj(){const Ua=this.kR.z3();if(0<Ua.length)for(const Bb of Ua)if(Bb.presence&&Bb.presence.ak)return!0;return!1}bil(){return!this.Izg&&this.oec&&2!==this.wj.Kca}B6h(Ua){for(let mc in Ua){var Bb=Ua[mc];try{const Nc=
lc.ALc(Bb);if(!Nc||Nc.clientId===this.ww)continue;const nd=Nc.clientId;this.bil()&&(this.Izg=!0,this.Gq.juc(2),da.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));da.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",nd,Nc.presence.toString());const Dd=Nc.email;if(!this.aCb.D6d(Dd)){let La;({editor:La}=this.wj.Hlb(nd)).returnValue&&this.aCb.BAf(Dd,La.EmailAddress)}this.D6h(Nc);this.kU.eSi()}catch(Nc){da.a.J(512360651,
814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",Nc.toString(),this.ww)}}this.kU.p2j(Ua)}D6h(Ua){this.bRi(Ua);const Bb=this.uz.N3(Ua.clientId);Bb&&2===Bb.status?da.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Ua.clientId):this.C6h(Ua)}C6h(Ua){const Bb=this.kR.p$a(Ua.clientId);if(Bb){if(!this.myj(Bb,Ua))return;da.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Ua.clientId,Bb.presence.toString(),Ua.presence.toString(),this.ww);this.hKb(Bb)}this.T6h(Ua)}hKb(Ua){Ua&&(this.kR.hKb(Ua),Ua.presenceUser&&this.K9c.rkd(new Vb(Ua.ak,Ua.presence.QU,Ua.presenceUser,!1,this.v6b(Ua.ak),this.jxb())))}vSf(Ua){if(Ua)if(Ua.presenceUser)da.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Ua.clientId);else{const Bb=this.f5f(Ua.clientId);Bb?Ua.presenceUser=Bb:da.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Ua.clientId)}}T6h(Ua){Ua&&(this.kR.yia(Ua),this.C4c.Tql(Ua.clientId),this.vSf(Ua),Ua.presenceUser?this.K9c.rkd(new Vb(Ua.ak,Ua.presence.QU,Ua.presenceUser,!0,this.v6b(Ua.ak),this.jxb())):da.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Ua.clientId))}Eyj(Ua){return!this.dDb||Ua?!0:!1}myj(Ua,Bb){let mc;(mc=!Ua.ak.equals(Bb.ak))&&da.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Ua.ak,Bb.ak);(Ua=this.Tec&&qb.Ufl(Ua,
Bb))&&da.a.J(512360646,814,50,"Shape Presence Changed");return mc||Ua}i_a(Ua){if(Ua){for(let Bb=0;Bb<Ua.length;Bb++)Ua[Bb]=Ua[Bb].toLowerCase();for(const Bb of Ua)da.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",Bb),(Ua=this.kR.jld(Bb))?Ua.presenceUser?this.K9c.rkd(new Vb(Ua.ak,Ua.presence.QU,Ua.presenceUser,!1,this.v6b(Ua.ak),this.jxb())):da.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):da.a.J(512360644,
814,15,"PresenceManager : RemovePresence; entry did not exist")}}M6f(Ua){const Bb=[];for(const mc of this.kR.z3())mc.ak.equals(Ua)&&mc.presenceUser&&Array.add(Bb,mc.presenceUser);return Bb}v6f(Ua){const Bb=[];for(const mc of this.kR.z3())mc.presence&&mc.syj(Ua)&&mc.presenceUser&&Array.add(Bb,mc.presenceUser);return Bb}U4b(){const Ua=[];for(const Bb of this.kR.z3())Bb.presenceUser&&Array.add(Ua,Bb.presenceUser);return Ua}jxb(){const Ua=this.U4b();return Ua?Ua.length:0}gka(Ua){if(!Ua)return null;Ua=
Ua.toLocaleLowerCase();for(const Bb of this.kR.z3())if(Bb.presenceUser&&Bb.presenceUser.clientId===Ua)return Bb.presenceUser;return this.f5f(Ua)}jld(Ua){const Bb=this.kR.p$a(Ua);this.hKb(Bb);da.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",Bb?Bb.clientId:Ua+" not found",this.ww)}hai(Ua){this.addHandler("PresenceChanged",Ua)}z3(){return this.kR.z3()}connectionState(){return this.uz.connectionState}disconnect(){try{da.a.J(512360640,
814,50,"PresenceManager : Disconnect"),this.TBb||this.vgc.JRk(),this.TBb=!0,this.uz.disconnect()}catch(Ua){da.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Ua.message,Ua.stack)}}GRk(Ua,Bb){this.Dug=Ua;this.Cug=Bb}f5f(Ua){let Bb;const mc=({editor:Bb}=this.wj.Hlb(Ua)).returnValue;var Nc=this.uz.Hta(Ua),nd=!!Nc;if(!mc&&!nd)return da.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Ua),null;
Nc=nd?Nc:null;mc||da.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Ua);nd||da.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Ua);nd&&mc&&da.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Ua,Nc.clientId!==Bb.ID,Nc.email!==Bb.EmailAddress);var Dd=mc?new Qb.a(Bb.EmailAddress,void 0,Bb.Name):new Qb.a(this.aCb.D6d(Nc.email)||Nc.email,void 0,Nc.userName);Dd=this.Meb.Gta(Dd,
mc?Bb.ColorIndex:null,mc?Bb.ID:Nc.clientId,0);nd=nd?Nc.clientType:0;return new E.a(Ua,mc?Bb.Name:Nc.userName,Dd,new qa.a(1),null,null,nd)}cSk(Ua){this.ua.ak.equals(Ua.ak)&&Ua.presence.QU&&Ua.presence.QU.length&&da.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Ua.clientId,Ua.presence.toString(),this.ww,this.Ce.k6b().getTime());da.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Ua.clientId,Ua.presence.toString(),this.ww,this.Ce.k6b().getTime())}gSk(Ua){const Bb=[this.wj.userName];let mc=0;for(var Nc of this.kR.z3())Nc.presence.ak.equals(Ua.ak)&&!qb.cce(Nc.presence.QU,Ua.QU)&&(mc++,Nc.presenceUser&&Array.add(Bb,Nc.presenceUser.userName));if(0<mc){Nc={};let nd=0,Dd=0;for(let La=0;La<Bb.length;++La){let gb=Bb[La];gb&&gb.length||(gb="anonymous",Dd++);gb in Nc||(Nc[gb]=!0,nd++)}da.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",
mc+1,Ua.QU&&0<Ua.QU.length?"shape":"slide",nd,Dd)}}bRi(Ua){try{!this.kU.GVi()||this.kR.p$a(Ua.clientId)||this.Ixg&&Ua.fHasClientEverExperiencedNetworkLoss||(this.vSf(Ua),this.cRi(Ua.presenceUser))}catch(Bb){da.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",Bb.toString())}}cRi(Ua){Ua&&Ua.clientId&&(this.Cxg||this.I9c||(this.Cxg=!0,this.I9c=G.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.I9c&&this.I9c.gRi(Ua.clientId,qb.Chj(Ua)))}static f6d(Ua){let Bb=
"";switch(Ua){case 2:Bb="Connected";break;case 1:Bb="Connecting";break;case 0:Bb="Disconnected"}return Bb}static cce(Ua,Bb){if(!Ua&&!Bb)return!1;if(!Ua&&Bb||Ua&&!Bb||Ua.length!==Bb.length)return!0;for(let mc=0;mc<Ua.length;mc++)if(Ua[mc]!==Bb[mc])return!0;return!1}static wyj(Ua,Bb){return!Ba.a.Jaa(Ua,Bb)}static Ufl(Ua,Bb){return Ua.ak.equals(Bb.ak)&&qb.cce(Ua.presence.QU,Bb.presence.QU)}static Chj(Ua){return Ua&&1===Ua.client?1:0}}qb.P0d="ETU";Object(h.a)(qb,"PresenceManager",z.a,[1234,1235,1236,
1237]);var Wb=d(1141),Xc=d(1144),xb=d(1036),Rb=d(75),wc=d(49),ud=d(301);class uc{constructor(Ua,Bb,mc,Nc,nd){this.iu=null;this.Hv=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled");Bb=this.Kfj(Bb,Nc,nd);this.iu=this.Hv?(new Wb.a(Bb)).Ttb(Ua):(new Xc.a(Bb)).zLc(Ua,mc)}dispose(){this.iu.dispose()}WLe(){return wc.a.$h(document.getElementById(ud.a.g_b))}Kfj(Ua,Bb,mc){const Nc=new xb.a;Nc.add(0,Rb.getImageClassWithCluster(u.AFrameworkApplication.PN,"MoreUsersGlyph_16x16x32"));Nc.add(5,u.AFrameworkApplication.rm);
Nc.add(1,Rb.getImageClassWithCluster(u.AFrameworkApplication.PN,this.Hv?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));Nc.add(4,u.AFrameworkApplication.rm);Nc.add(6,mc);Nc.add(8,u.AFrameworkApplication.isRtl);Nc.add(12,Ua);Nc.add(11,Bb);this.Hv&&(Nc.add(16,Object(n.a)(this,this.WLe,"presenceViewportBoundsCallback")),Nc.add(17,!0));return Nc}Xx(Ua){this.iu?(da.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Ua.clientId),this.iu.Xx(Ua)):da.a.J(509219530,
814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Ua.clientId)}RJ(Ua){this.iu?(da.a.J(509219528,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Ua.clientId),this.iu.RJ(Ua.clientId)):da.a.J(509219529,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Ua.clientId)}clear(){if(this.iu)if(da.a.J(509219526,814,50,"PresencePawn:Clear at PresencePawn "),this.M8())for(const Ua of this.M8())this.RJ(Ua);
else da.a.J(509219525,814,50,"PresencePawn:Clear - Pawn has no users");else da.a.J(509219527,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}M8(){return this.iu?this.iu.Khb:null}QYe(){this.iu&&(this.Hv&&this.iu.iga(),this.iu.Lya())}wce(){this.iu&&this.iu.iga()}}Object(h.a)(uc,"PresencePawn",null,[449,106]);class db{rLf(Ua,Bb,mc){return new uc(Ua,2,Bb,!0,mc)}}Object(h.a)(db,"PresencePawnFactory",null,[1097]);var Yb=d(32);class Zc{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,
vc,td,Nd){this.Eze=[];this.TXa=null;this.ryg=this.qyg=this.Oue=0;this.F5c=this.G5c=null;this.e9c=[];if(!Bb)throw Error.argumentNull("graphTopologyManager");if(!mc)throw Error.argumentNull("presenceManager");if(!Nc)throw Error.argumentNull("dragInputManager");if(!nd)throw Error.argumentNull("coauthStateChangesHandler");this.qd=Ua;this.ua=Bb;this.uE=mc;this.au=Nc;this.Hqe=nd;this.zma=Dd;this.Tb=La;this.Te=gb;this.Hfb=vc;this.yma=td;this.fR=Nd;this.yma.h6a(Object(n.a)(this,this.Yqd,"slidePresenceChanged"));
this.qd.aW(Object(n.a)(this,this.hZa,"onSlideNavigation"));this.qd.KPd(Object(n.a)(this,this.uHb,"onThumbnailRefresh"));this.qd.irb(Object(n.a)(this,this.SIe,"onThumbnailVisibleRangeChanged"));this.lBg=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceFloodGateSurveyEnabled");(this.Hv=u.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.lBg&&(this.qyg=u.AFrameworkApplication.fa.Bc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.ryg=u.AFrameworkApplication.fa.Bc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",
3),this.Oue=0,this.TXa=J.a.$u(G.a.instance.Ja("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.qd.grb(Object(n.a)(this,this.cgl,"shapeViewElementAdded"));this.qd.Uuf(Object(n.a)(this,this.dgl,"shapeViewElementLocked"));this.qd.K$h(Object(n.a)(this,this.Pxk,"onShapeViewElementShowLockHint"));this.qd.L$h(Object(n.a)(this,this.Qxk,"onShapeViewElementShowPresenceHint"));this.qd.I$h(Object(n.a)(this,this.Jxk,"onShapeViewElementHidePresenceHint"))}hZa(){this.ua.ak&&(da.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",
this.ua.ak),this.bTk(this.ua.ak))}bTk(Ua){if(this.ua.ak&&this.ua.ak.equals(Ua)&&(da.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Ua),Ua=new Yb.GraphIterator,Ua.set(this.ua.Ba),Ua.Bb(1))){do if(0<Ua.currentNode.eb(Ab.a.shapeId)){const Bb=Object(sa.a)(4,Ua.currentNode);Bb&&this.kgh(Bb)}while(Ua.Cf(1))}}Yqd(Ua,Bb){this.au.oFa?(da.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.F5c||(this.F5c=
new B.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(Bb)},90,"68"),u.AFrameworkApplication.ye.Db(this.F5c)),Bb&&this.e9c.push(Bb)):(this.GKk(Bb),this.EKk(Bb))}handlePendingPresenceChangedEvent(){this.F5c=null;this.$Sk();if(this.ua.ak&&0<this.e9c.length){const mc={},Nc={};var Ua=this.ua.ak;for(var Bb of this.e9c){if(!Ua.equals(Bb.slideId))continue;if(!Bb.shapes||!Bb.user)continue;Bb.user.clientId in Nc||(mc[Bb.user.clientId]=Bb.user,Nc[Bb.user.clientId]=new Ub.a(0));const nd=Nc[Bb.user.clientId];
for(const Dd of Bb.shapes){const La=Bb.c9?1:0;nd.Hb(Dd)?0<(nd.ga(Dd)^La)&&nd.$(Dd,La):nd.add(Dd,La)}}for(let nd in mc){Ua=mc[nd];Bb=nd;if(!(Bb in Nc))continue;const Dd=[],La=[];Nc[Bb].forEach((gb,vc)=>{0<vc?La.push(gb):Dd.push(gb);return!0});0<Dd.length&&this.Shh(Dd,Ua);0<La.length&&this.vtf(La,Ua)}this.e9c=[]}}GKk(Ua){Ua.c9?this.yia(Ua.slideId,Ua.user):this.i_a(Ua.slideId,Ua.user)}uHb(Ua,Bb){this.igh([Bb.QBh])}SIe(Ua,Bb){this.igh(Bb.Aga)}igh(Ua){const Bb=[];for(const mc of Ua)Ua=this.fR?this.Tb.mUc(mc):
this.Tb.kka(mc),this.fR&&0>=Ua.iV||Ua&&Array.add(Bb,Ua);this.hgh(Bb)}yia(Ua,Bb){const mc=this.X7f(Ua);mc?(mc.yia(Bb),this.foe(),da.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Ua.toString())):da.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Ua.toString())}i_a(Ua,Bb){const mc=this.X7f(Ua);mc?mc.i_a(Bb):da.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ua.toString())}X7f(Ua){const Bb=
this.Tb.kka(Ua);return Bb?Object(sa.a)(609,Bb.mg(this.Hfb)):(da.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Ua.toString()),null)}$Sk(){const Ua=this.ua.presentation;if(!Ua)throw Error.argumentNull("Presentation is null");this.hgh(Ua.slides||[])}hgh(Ua){for(const mc of Ua){var Bb=Object(sa.a)(116,mc);Bb?(Ua=Bb.Cb,(Bb=Object(sa.a)(609,Bb.mg(this.Hfb)))?(da.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",
Ua.toString()),Bb.B1a(this.uE.M6f(Ua))):da.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Ua.toString())):da.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",mc.Cb.toString())}}foe(){this.Hv&&this.lBg&&(this.cyl()||this.TXa&&this.TXa.continueWith(()=>{this.TXa.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",
this.qyg)&&this.Oue++}))}cyl(){return this.Oue>=this.ryg}EKk(Ua){this.ua.ak&&this.ua.ak.equals(Ua.slideId)&&Ua.shapes&&(Ua.c9?this.vtf(Ua.shapes,Ua.user):this.Shh(Ua.shapes,Ua.user))}cgl(Ua,Bb){Ua=Bb.Jw;this.kmg(Ua.shapeNode)&&(this.Eze.push(Ua),this.G5c||(this.G5c=new B.a(2,1,0,Object(n.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),u.AFrameworkApplication.ye.Db(this.G5c)))}handlePendingShapePresenceUpdate(){this.G5c=null;for(const Ua of this.Eze){if(!this.kmg(Ua.shapeNode))return;
this.kgh(Ua.shapeNode)}Array.clear(this.Eze)}kgh(Ua){const Bb=Object(sa.a)(117,Ua.sc(this.Te));if(Bb&&!Ua.get_smartArtModelId()){var mc=this.uE.v6f(Ua);if(mc)if(mc.length){Ua=this.zma.ZG(Ua);Ua.wFf();for(const Nc of mc)Ua.yia(Nc),this.foe()}else(mc=this.zma.IF(Ua))&&mc.wFf();this.Hqe.d7g(Bb)}}vtf(Ua,Bb){var mc=this.y6f();let Nc=!1;for(const nd of mc){if(!Array.contains(Ua,nd.get_shapeId())||nd.get_smartArtModelId())continue;mc=Object(sa.a)(117,nd.sc(this.Te));if(!mc||nd.get_smartArtModelId())continue;
const Dd=this.zma.ZG(nd);Dd?(mc.isSelected&&(Dd.msb=!1),Dd.yia(Bb),this.foe(),mc.isSelected&&Dd.ajc()):Nc=!0}Nc||da.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}Shh(Ua,Bb){var mc=this.y6f();for(const Nc of mc)Array.contains(Ua,Nc.get_shapeId())&&(mc=this.zma.ZG(Nc))&&mc.i_a(Bb)}y6f(){let Ua=null;this.ua.Ba&&(Ua=this.ua.Ba.Ek());return Ua||[]}kmg(Ua){return!!this.ua.Ba&&this.ua.Ba.Cb.equals(Ua.slideId)}dgl(Ua,Bb){this.zma.ZG(Bb.Jw.shapeNode).Pud(Bb.presenceUser)}Pxk(Ua,Bb){(Bb.Jw.$p||
Bb.Jw.fqd)&&(Ua=this.zma.IF(Bb.Jw.shapeNode))&&Ua.pYe()}Qxk(Ua,Bb){(Ua=this.zma.IF(Bb.Jw.shapeNode))&&Ua.Yjl()}Jxk(Ua,Bb){(Ua=this.zma.IF(Bb.Jw.shapeNode))&&Ua.t_()}}Object(h.a)(Zc,"PresencePresenter",null,[]);class Kb{constructor(Ua){this.Jgc=Ua}Hta(Ua){return this.Jgc.Hta(Ua)}N3(Ua){return this.Jgc.N3(Ua)}}Object(h.a)(Kb,"PresenceUserInfoGetter",null,[1099,1074]);class Yc{constructor(Ua=null){this.wj=Ua}g5f(Ua){if(!Ua||!Ua.value)return null;Ua=Ua.value;let Bb=Ua.userName;if(!Bb&&this.wj){let mc;
({editor:mc}=this.wj.Hlb(Ua.clientId)).returnValue&&(Bb=mc.Name)}return Object.assign(new E.a,{clientId:Ua.clientId,chatThreadId:Ua.chatThreadId,chatThreadDiscoveryUri:Ua.chatThreadDiscoveryUri,inChat:Ua.inChat,email:Ua.email,capabilities:new qa.a(Ua.capabilities),userName:Bb})}}Object(h.a)(Yc,"PresenceUtils",null,[1233]);var ec;(function(Ua){Ua[Ua.coauthHandlerResponse=0]="coauthHandlerResponse";Ua[Ua.popSessionResponse=1]="popSessionResponse";Ua[Ua.defaultFallback=2]="defaultFallback"})(ec||(ec=
{}));Object(h.b)("RtcDiscoverType",ec);class rb{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc,td,Nd,Od,Oc,Af,Ae,Ye){this.F_d=Ua;this.ird=Bb;this.hrd=mc;this.dvb=Nc;this.x8b=nd;this.LWc=Dd;this.Llb=La;this.Ytd=gb;this.Aib=vc;this.pNc=td;this.nNc=Nd;this.MNb=Od;this.dgb=Oc;this.Fub=Af;this.pRf=Ae;this.$0d=Ye}e4j(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.F_d,this.ird,this.hrd,
this.dvb,this.x8b,this.LWc,this.Llb,this.Ytd,this.Aib,this.pNc,this.nNc,this.MNb,this.dgb,this.Fub,this.pRf,this.$0d)}}Object(h.a)(rb,"RttLockSettings",null,[]);var ac=d(340);class Jc{constructor(Ua,Bb,mc,Nc){this.ifc=this.hfc=null;this.kgf=!1;this.Fgk=Ua;this.Fa=Bb;this.Hh=mc;this.cY=Nc;this.rFb=new Date;this.uHa=-1}get gb(){return this.Fgk}get A0c(){return this.kgf}set A0c(Ua){this.kgf=Ua}aVi(){return 0<this.uHa&&Date.now()>=this.uHa}zqh(Ua){this.uHa=Ua}M6b(){return""}N6b(){return""}QJb(Ua){this.hfc=
Ua?this.M6b():this.N6b();this.ifc=new Date}QUd(){}SUd(){return!1}enh(Ua,Bb){Ua=Ua||"";Bb=Bb||"";if(Ua.length!==Bb.length)return null;const mc=[];for(let Nc=0;Nc<Ua.length;Nc+=1)Ua.charAt(Nc)!==Bb.charAt(Nc)&&mc.push(Nc);return 0<mc.length?Sb.a.QH("Length",Ua.length,"FirstDiffPos",mc[0],"DiffCount",mc.length):null}ZSa(Ua){return F.a.replaceAll(Ua,"\u00a0"," ").trim()}}Object(h.a)(Jc,"ATextContentRecord",null,[]);var Db=d(36),dd=d(43);class Cd extends Jc{constructor(Ua,Bb,mc,Nc){super(Ua,Bb,mc,Nc);
this.VWg=Ua.DC}get shapeNode(){return Object(sa.a)(4,this.gb)}Wel(){this.VWg=this.shapeNode.DC}M6b(){const Ua=new m.a;var Bb=this.shapeNode.$D();for(const mc of Bb)(Bb=this.Hh.text(mc))&&0<Bb.length&&Ua.add(Bb);return Ua.toArray().join(" ")}N6b(){return this.Fa.rda(this.shapeNode)}QUd(){try{const Ua=this.M6b()||"",Bb=this.hfc||"";if(Ua!==Bb){const mc=this.ZSa(Ua)===this.ZSa(Bb),Nc=this.VWg||this.shapeNode.DC;if(!mc&&!Nc&&!this.shapeNode.ud){const nd=Sb.a.QH("Shape",this.shapeNode.Er,"Start",dd.a.nf(this.rFb),
"LastSnapshotTime",dd.a.nf(this.ifc),"EverEdit",this.A0c,"Type",this.getShapeType());nd.Expiration=-1<this.uHa?(+new Date(this.uHa)-+this.rFb).toString():null;const Dd=Ua.length-Bb.length;Dd?nd.TextLengthDelta=Dd:nd.SameLengthDiffDetails=this.enh(Ua,Bb);da.a.J(25539747,814,15,Db.c(nd))}}}catch(Ua){da.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ua)}}SUd(){try{const Ua=this.cY.u5b(this.shapeNode);if(Ua&&0<Ua.length)return!1;const Bb=this.N6b()||"",mc=this.hfc||"";if(Bb!==mc&&
0>Bb.indexOf(mc)&&!(0<=this.ZSa(Bb).indexOf(this.ZSa(mc))||this.shapeNode.ud)){const Nc=Sb.a.QH("Shape",this.shapeNode.Er,"Start",dd.a.nf(this.rFb),"LastSnapshotTime",dd.a.nf(this.ifc),"TextLengthDelta",Bb.length-mc.length,"Type",this.getShapeType());da.a.J(25981903,814,15,Db.c(Nc))}}catch(Ua){da.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ua)}return!0}getShapeType(){return this.shapeNode.ud?"Table":this.shapeNode.Rf?"SmartArt":this.shapeNode.px?"TextBox":this.shapeNode.fl?
"PlaceHolder":this.shapeNode.zua?"Shape":"Unknown"}}Object(h.a)(Cd,"ShapeContentRecord",Jc,[]);class pd{constructor(Ua,Bb,mc,Nc,nd,Dd,La,gb,vc,td,Nd,Od,Oc){this.Bfb=this.uFb=null;this.MO={};this.KIa={};this.pa=gb;this.kJ=vc;this.Oc=Ua;this.lq=Bb;this.f9j=mc;this.eu=Nc;this.ua=nd;this.Pg=Dd;this.cY=La;this.Fa=td;this.yc=Nd;this.sCe=Od;this.Hs=Oc;this.pa.Juf(Object(n.a)(this,this.ewk,"onPreSelectionChanged"));this.pa.wF(Object(n.a)(this,this.rHb,"onSetSelectionFinished"));this.kJ.ebi(Object(n.a)(this,
this.xyk,"onTableCellViewElementLocked"));this.Oc.g9h(Object(n.a)(this,this.Chi,"beforeProcessInboundResponse"));this.lq.NYb(Object(n.a)(this,this.Mxk,"onShapeViewElementOpenTextEditView"));this.lq.JGc(Object(n.a)(this,this.Gxk,"onShapeViewElementCloseTextEditView"));this.lq.Uuf(Object(n.a)(this,this.Lxk,"onShapeViewElementLocked"));this.f9j.Buf(Object(n.a)(this,this.tyk,"onSuccessfulInbound"));this.eu.jk(Object(n.a)(this,this.kh,"onPropertyChanged"));this.Pg.rI(Object(n.a)(this,this.AB,"onActiveSlideChanged"))}Mxk(Ua,
Bb){Ua=Object(sa.a)(4,Object(sa.a)(ac.a,Bb.Jw).gb);Bb=this.sCe.BYd(Ua);this.MO[Ua.id.toString()]=Bb;Bb.QJb(!0)}Gxk(Ua,Bb){Ua=Object(sa.a)(4,Object(sa.a)(ac.a,Bb.Jw).gb).id.toString();Ua in this.MO&&this.MO[Ua].zqh(Date.now()+this.Hs.dvb)}Lxk(Ua,Bb){Ua=Object(sa.a)(4,Object(sa.a)(ac.a,Bb.Jw).gb).id.toString();Ua in this.MO&&delete this.MO[Ua]}ewk(){this.uFb=this.OLf}rHb(){this.Bfb=this.OLf;if(!(!this.uFb&&!this.Bfb||this.uFb&&this.Bfb&&this.Bfb.id.equals(this.uFb.id))){if(this.uFb){var Ua=this.uFb.id.toString();
Ua in this.MO&&this.MO[Ua].zqh(Date.now()+this.Hs.dvb)}this.Bfb&&(Ua=this.sCe.BYd(this.Bfb),this.MO[this.Bfb.id.toString()]=Ua,Ua.QJb(!0))}}get OLf(){var Ua=this.pa.Na;if(!Ua||!Ua.mb||Ua.mb.Hl)return null;Ua=Ua.mb;return Ua.Ua.node&&Ua.Ua.node.isConnected?this.yc.uEa(Ua.Ua.node):null}xyk(Ua,Bb){Ua=Bb.tableCellNode.id.toString();Ua in this.MO&&delete this.MO[Ua]}Chi(){this.nhh();for(const Ua of Object.keys(this.MO))this.MO[Ua].QJb(!0)}tyk(){this.nhh();for(const Ua of Object.keys(this.MO))this.MO[Ua].QUd();
for(const Ua of Object.keys(this.KIa))this.KIa[Ua].SUd()&&delete this.KIa[Ua]}kh(Ua,Bb){if(Bb&&Bb.node&&Bb.property.id===ha.a.pq.id){Ua=Object(sa.a)(5,Bb.node);Bb=!Bb.node.loading;const mc=this.yc.uEa(Ua);if(mc)this.qZg(mc,Bb),this.rZg(mc,Bb);else if(Ua=this.Fa.oda(Ua))this.qZg(Ua,Bb),this.rZg(Ua,Bb)}}AB(){this.KIa={}}nhh(){for(const Ua of Object.keys(this.MO))this.MO[Ua].aVi()&&delete this.MO[Ua]}qZg(Ua,Bb){Ua=Ua.id.toString();if(Ua in this.MO){Ua=this.MO[Ua];const mc=Object(sa.a)(Cd,Ua);mc&&mc.Wel();
Ua.QJb(!0);Bb&&(Ua.A0c=!0)}}rZg(Ua,Bb){var mc=this.Fa.$m(Ua);mc&&this.ua.Ba&&this.ua.Ba.sid===mc.get_sid()&&this.ua.Ba.cid===mc.get_cid()&&(mc=Ua.id.toString(),Bb?mc in this.KIa&&delete this.KIa[mc]:(Bb=Object(ia.a)(123,Ua)?this.cY.h5b(Object(sa.a)(123,Ua)):this.cY.u5b(Object(sa.a)(4,Ua)))&&0<Bb.length&&(mc in this.KIa?this.KIa[mc].QJb(!1):(Ua=this.sCe.BYd(Ua),this.KIa[mc]=Ua,Ua.QJb(!1))))}}Object(h.a)(pd,"TextContentMonitor",null,[]);class Ge extends Jc{constructor(Ua,Bb,mc,Nc,nd){super(Ua,Bb,Nc,
nd);this.yc=mc}get tableCellNode(){return Object(sa.a)(123,this.gb)}M6b(){const Ua=new m.a;this.yc.tmc(this.tableCellNode,Bb=>{(Bb=this.Hh.text(Bb))&&0<Bb.length&&Ua.add(Bb)});return Ua.toArray().join(" ")}N6b(){const Ua=new m.a;this.yc.tmc(this.tableCellNode,Bb=>{Bb.Sa(ha.a.pq)&&(Bb=Bb.eb(ha.a.pq))&&0<Bb.length&&Ua.add(Bb)});return Ua.toArray().join(" ")}QUd(){try{const Ua=this.M6b()||"",Bb=this.hfc||"";if(Ua!==Bb&&this.ZSa(Ua)!==this.ZSa(Bb)){const mc=Sb.a.QH("TableCellNode",this.Gsh+"/"+this.tableCellNode.Er,
"Start",dd.a.nf(this.rFb),"LastSnapshotTime",dd.a.nf(this.ifc),"EverEdit",this.A0c);mc.Expiration=-1<this.uHa?(+new Date(this.uHa)-+this.rFb).toString():null;const Nc=Ua.length-Bb.length;Nc?mc.TextLengthDelta=Nc:mc.SameLengthDiffDetails=this.enh(Ua,Bb);da.a.J(37748808,814,15,Db.c(mc))}}catch(Ua){da.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Ua)}}SUd(){try{const Ua=this.cY.h5b(this.tableCellNode);if(Ua&&0<Ua.length)return!1;const Bb=this.N6b()||"",mc=this.hfc||"";if(Bb!==
mc&&0>Bb.indexOf(mc)&&!(0<=this.ZSa(Bb).indexOf(this.ZSa(mc)))){const Nc=Sb.a.QH("TableCellNode",this.Gsh+"/"+this.tableCellNode.Er,"Start",dd.a.nf(this.rFb),"LastSnapshotTime",dd.a.nf(this.ifc),"TextLengthDelta",Bb.length-mc.length);da.a.J(37748812,814,15,Db.c(Nc))}}catch(Ua){da.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Ua)}return!0}get Gsh(){const Ua=this.Fa.$m(this.tableCellNode);return Ua?Ua.Er:"UnknownShape"}}Object(h.a)(Ge,"TableCellContentRecord",Jc,[]);class kd{constructor(Ua,
Bb,mc,Nc){this.Fa=Ua;this.yc=Bb;this.Hh=mc;this.cY=Nc}BYd(Ua){return Object(ia.a)(4,Ua)?new Cd(Object(sa.a)(4,Ua),this.Fa,this.Hh,this.cY):Object(ia.a)(123,Ua)?new Ge(Object(sa.a)(123,Ua),this.Fa,this.yc,this.Hh,this.cY):null}}Object(h.a)(kd,"TextContentRecordFactory",null,[1098]);var Xf=d(630);class Kd{constructor(Ua,Bb,mc,Nc,nd){this.Fb=Ua;this.zma=Bb;this.pa=mc;this.kJ=Nc;this.uy=nd;this.A4c=!1}initialize(){this.pa.wF(Object(n.a)(this,this.rHb,"onSetSelectionFinished"));this.kJ.mbi(Object(n.a)(this,
this.a7g,"onTypingLockStatusChanged"))}dispose(){this.pa.jRe(Object(n.a)(this,this.rHb,"onSetSelectionFinished"));this.kJ.b_k(Object(n.a)(this,this.a7g,"onTypingLockStatusChanged"))}rHb(){var Ua=this.pa.xv();let Bb=null;for(const mc of Ua)if(Ua=Object(sa.a)(pa.TableCellNode,mc))if(Ua=Object(sa.a)(1128,Ua.mg(this.Fb.Ma)))if(Bb=Ua.U1c)break;this.XHh(Bb)}a7g(Ua,Bb){this.XHh(Bb.PIi)}XHh(Ua=null){this.pa.k9()?this.dsl(Ua):this.d3k()}dsl(Ua=null){if(this.Fb.editingView&&this.Fb.editingView.Wl){const Bb=
this.z0f();Bb&&(this.zma.ZG(Bb.shapeNode).Pud(Ua),Ua&&(Bb.fqd=!0,this.uy.Deh(new Xf.a(Bb)),Bb.fqd=!1));this.A4c||da.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Fb.editingView.disable(!1,14);this.A4c=!0}}d3k(){if(this.Fb.editingView&&this.Fb.editingView.Wl){const Ua=this.z0f();Ua&&Ua.shapeNode.ud&&(this.zma.ZG(Ua.shapeNode).Pud(null),Ua.xce());this.A4c&&da.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");
this.Fb.editingView.Y0a();this.A4c=!1}}z0f(){let Ua=null;const Bb=this.pa.Wd();1===Bb.length&&(Ua=Object(sa.a)(117,Bb[0].sc(this.Fb.Ma)));return Ua}}Object(h.a)(Kd,"TypingLockHandler",null,[1187,106]);var lg=d(904);class ve{constructor(){this.a6c=this.nh=this.U4=this.k5c=this.uE=this.K=this.lH=null;this.rcc=0;this.K$c=null;this.sse=!1;this.r2c=null;this.Bue=!1;this.b5c=!0}get name(){return"Presence"}eyi(){this.K.register(E.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(Yc,
"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().oa(()=>new Yc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.sse=!0}Zb(Ua){this.rcc=(new Date).getTime();this.K!==Ua&&(this.K=Ua,this.U4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.nh=this.U4.kEa(1,this.name),this.sse=!1,this.Bue=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);this.lH=this.K.resolve("Common.AFrameworkApplication");Ua=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.b5c=!u.AFrameworkApplication.fa.ka("PPTODeprecateRtcFallback");this.sse||this.eyi();const Bb=Ua.ari&&Ua.APb?!1:Ua.vg,mc=this.rGi(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),Bb,Ua["368"]);mc&&(this.K.register(1095,"Common.IRealtimeChannelBasic").ma().oa(()=>mc),this.K.register(1096,"AppRealtimeChannel.IRealtimeChannel").ma().oa(()=>mc),this.byi(Ua))}byi(Ua){this.K.register(Ka,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().oa(()=>
new Ka(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(Ya,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().oa(()=>new Ya(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Ib,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().oa(()=>new Ib(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.K.resolve("PowerPointWebEditor.Core.INetworkState"),N.a.getInstance(),Ua.rtcAllowCrossDomainAccessOrigins));this.K.register(qb,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().oa(()=>new qb(this.K.resolve("Common.IPresenceUser"),u.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),
this.lH.FS,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Ua,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").NUc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(fb,"PowerpointPresence.PresenceCache").ma().oa(()=>new fb(this.K.resolve("PowerpointPresence.IPresenceManager")));this.K.register(Zc,"PowerpointPresence.PresencePresenter").ma().oa(()=>new Zc(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Ua.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(kc,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().oa(()=>new kc(this.K.resolve("Common.IPresenceUser").clientId,Ua.vgl,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const Bb=new rb(Ua.PMi,
Ua.ird,Ua.hrd,Ua.dvb,Ua.x8b,Ua.LWc,Ua.Llb,Ua.Ytd,Ua.Aib,Ua.pNc,Ua.nNc,Ua.MNb,Ua.dgb,Ua.Fub,Ua.podsTableRTTEnabled,Ua.podsTableCellLockEnabled);this.K.register(Kd,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().oa(()=>new Kd(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Ha,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().oa(()=>new Ha(ca.App.Ih,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").yd(12),Ua,Bb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma,this.K.resolve("Box4.Graph.IGraphInstance").yd(16),J.a.$u(G.a.instance.Ja("Common.ISystemInitiatedFeedback"))));this.K.register(1097,"PowerpointPresence.IPresencePawnFactory").ma().oa(()=>new db);this.K.register(1098,"PowerpointPresence.ITextContentRecordFactory").ma().oa(()=>new kd(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(pd,"PowerpointPresence.TextContentMonitor").ma().oa(()=>new pd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),fa.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").yd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),Bb));this.K.register(A,"Common.App.Presence.AwayManager").ma().oa(()=>this.eCi(this.K.resolve("Common.IPresenceUser"),
this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Ua.ka("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(1099,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().oa(()=>new Kb(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));this.IOc().Cjb("RTCConfigured")}ogj(Ua){let Bb;var mc=Ua;Bb=0;if(Ua=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Dhj())return mc=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Vpd(),
{eTe:Ua,cTe:Bb,u2d:mc};Bb=1;if(Ua=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").imh)return mc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Vpd,{eTe:Ua,cTe:Bb,u2d:mc};if(this.b5c)return{eTe:mc,cTe:2,u2d:!0}}qGi(){const Ua=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;0<Ua&&(this.K$c=new B.a(2,1,Ua,()=>{this.b5c?this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").GUf=!0:this.K.ub("AppRealtimeChannel.IRealtimeChannel")||da.a.J(509670485,
828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Ua);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Hih(Object(n.a)(this,this.qIe,"onPopsRtcEndpointUrlReady"));this.K.ub("AppRealtimeChannel.IRealtimeChannel")||(this.Zb(G.a.instance),this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Db(this.K$c))}rGi(Ua,Bb,mc,Nc){da.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",mc);Bb.clientId=
Ua.clientId;var nd=null;Bb=null;const Dd=N.a.getInstance();if(mc){Bb=Nc+"rtc2";({eTe:Bb,cTe:mc,u2d:Nc}=this.ogj(Bb));nd=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const La=this.b5c&&this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").GUf,gb=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").clg;da.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",
ec[mc],nd,Nc,La,gb);if(2===mc&&!La)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").dai(Object(n.a)(this,this.qIe,"onPopsRtcEndpointUrlReady")),this.qGi(),null;if(!Nc&&!nd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").fPd(Object(n.a)(this,this.ZGb,"onCoauthStatusChanged")),null;nd=this.ZBi(Ua,Bb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Dd)}return S.RealtimeChannel.createInstance(Ua.clientId,Ua.userSessionId,Ua.Kmd,Ua.yca,Ua.dph,
3,Ua.Lw,Bb,nd,Dd)}eCi(Ua,Bb,mc,Nc,nd){const Dd=new D.a;Dd.Gg(mc);mc=new D.a;mc.Gg(Bb);return new A(Ua,mc.task,Dd.task,Nc,this.K.resolve("Common.ITaskManager"),this.lH.FS.od.dSd?6E4:this.lH.FS.od.awayCoauthorThresholdMs,Object(n.a)(this.lH.FS.VG(),this.lH.FS.VG().processAction,"processAction"),ma.App.T5a.notificationBar,nd)}init(){const Ua=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Ua.Zh(21,ve.Lgc);Ua.Zh(22,this.rcc);Ua.Zh(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?
this.IOc().Cjb("PresentationId"):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").Huf(Object(n.a)(this,this.pkc,"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Pyb(()=>{this.IOc().Cjb("B2IFinished")})}pkc(){this.IOc().Cjb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").Iih(Object(n.a)(this,this.pkc,"onPresentationIdReady"))}qIe(){this.K$c&&this.K.resolve("Common.ITaskManager").Lg(this.K$c);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Hih(Object(n.a)(this,
this.qIe,"onPopsRtcEndpointUrlReady"));this.K.ub("AppRealtimeChannel.IRealtimeChannel")||(this.Zb(G.a.instance),this.init())}ZGb(Ua,Bb){2!==Bb.z_g||this.K.ub("AppRealtimeChannel.IRealtimeChannel")||(this.Zb(G.a.instance),this.init());this.K.ub("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").UQe(Object(n.a)(this,this.ZGb,"onCoauthStatusChanged"))}IOc(){this.a6c||(this.a6c=new lg.a(Object(n.a)(this,this.xyb,"initInternal"),["PresentationId",
"B2IFinished","RTCConfigured"]));return this.a6c}xyb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").Zh(4,this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").dPe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Zh(23,(new Date).getTime());this.kEj();this.cFj();this.a6c=null}cFj(){try{let Ua="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Ua=this.nh.zu("presencemanager");this.dFj();this.nh.Fu(Ua);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").C_c=
!0;da.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");ca.App.LWd&&(Ua=this.nh.zu("contentnotification"),oc.init(),this.nh.Fu(Ua));Ua=this.nh.zu("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").ySi();this.uE=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.lH.FS.od.fUi&&(da.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.lH.FS.VG().processAction(v.a.k7a,
2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.lH.FS.od.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.nh.Fu(Ua);this.K.resolve("PowerpointPresence.IPresencePerfLogger").jSi();
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").u3j()}catch(Ua){da.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Ua)}}dispose(){this.uE?this.uE.disconnect():da.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}dFj(){this.K.resolve("PowerpointPresence.PresenceManager").wb();da.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}ZBi(Ua,
Bb,mc,Nc){let nd=Bb;nd=nd.endsWith("/")?nd+"findsession":nd+"/findsession";da.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",nd,Ua.yca.Oga);Bb=()=>X.FindSessionStrategy.gEi(Ua.userSessionId,Ua.yca,nd,Ua.Lw,u.AFrameworkApplication.buildVersion,Ua.clientId,ve.h1i(u.AFrameworkApplication.buildVersion),Nc,Ua.dph,()=>{if(u.AFrameworkApplication.gh)return u.AFrameworkApplication.gh;const La=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;
La||da.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return La},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Bhj());const Dd=!!this.k5c;return this.Bue||Dd?this.r2c=new Xa(this.k5c,Bb,mc,Nc,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):Bb()}kEj(){var Ua;if(Ua=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():
this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").G3d)Ua=aa.RtcUtils.deserialize(Ua,"PresencePackage","Deserialize existing FindSession response",!0),this.fhd(Ua)}fhd(Ua){if(Ua)try{this.k5c=Object.assign(new O.a,{J$b:Ua[V.a.Pzb],errorMessage:Ua[V.a.errorMessage],I0b:Ua[V.a.mZe],Q5:Ua[V.a.Q5],QA:Ua[V.a.QA],ZUc:Ua[V.a.Fae],zcd:Ua[V.a.egb],Acd:Ua[V.a.XLa],Dcd:Ua[V.a.ggb]}),this.Bue&&this.r2c&&(this.r2c.findSessionResponse=this.k5c)}catch(Bb){da.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",
Bb)}}static main(){ve.Lgc=(new Date).getTime();const Ua=new ve;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Ua.Zb(G.a.instance),Ua.K.ub("AppRealtimeChannel.IRealtimeChannel")&&Ua.init()):P.a.instance.Dc(Ua)}static h1i(Ua){return String.format("{0}, {1}, {2}",ve.DDf(Q.a[3]),ve.DDf("browser"),Ua)}static DDf(Ua){return Ua?Ua.charAt(0).toLocaleUpperCase()+Ua.substring(1,Ua.length):Ua}}ve.Lgc=0;Object(h.a)(ve,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");ve.main()},190:function(I,Y,d){d.r(Y);d.d(Y,"RtcUtils",function(){return m});I=d(0);var h=d(387),e=d(338),n=d(36);class m{static HUd(z,B=e.RealtimeChannel.PDe){let v;try{v=n.c(z)}catch(y){throw z=String.format("Failed to JSON-serialize payload : {0}",y),h.ULS.sendTraceTag(18637072,500,10,z),Error.argument("payload",z);}if(v.length>
B)throw z=String.format("Payload exceeds maximum length: {0} > {1}.",v.length,B),h.ULS.sendTraceTag(18637074,500,10,z),Error.argument("payload",z);return v}static deserialize(z,B,v){if(!z)return null;if(Object.getType(z)!==String){var y=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",B,Object.getType(z).getName(),v);h.ULS.sendTraceTag(18637075,500,10,y);return null}y=null;try{y=n.a(z)}catch(A){z=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
B,A,v),h.ULS.sendTraceTag(18637077,500,10,z)}return y}static PGb(z){if(!z)return"";if("string"===typeof z)return z.toString();try{return n.c(z)}catch(B){return z.toString()}}static $Tf(z){let B,v,y;B=0;y=v=null;if(!z)return{Wce:B,Xce:v,Yi:y};try{const A=z.source;A&&Object.getType(A)===String&&(y=A);const E=z.context;E&&(z=E,B=z.status?z.status:0,v=z.statusText?z.statusText:null)}catch(A){}return{Wce:B,Xce:v,Yi:y}}}Object(I.a)(m,"RtcUtils",null,[])},237:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Px(){return!0}static aub(e,n){return e+(n?"Rtl":"")}}Object(I.a)(h,"BasePresenceControl",d.a,[106,484])},238:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n){super();this.type=e;this.Xi=n}}h.kp="InteractivityChanged";Object(I.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,
[])},309:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(14),n=d(105),m;(function(y){y[y.SendNotification=0]="SendNotification";y[y.SendPersistentState=1]="SendPersistentState";y[y.FindSession=2]="FindSession";y[y.Last=3]="Last"})(m||(m={}));Object(I.b)("ApiType",m);var z;(function(y){y[y.AttemptCount=0]="AttemptCount";y[y.SuccessCount=1]="SuccessCount";y[y.DropCount=2]="DropCount";y[y.FailedCount=3]="FailedCount";y[y.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";y[y.LatencyUnderThresholdCount=
5]="LatencyUnderThresholdCount";y[y.ThrottledCount=6]="ThrottledCount";y[y.Last=7]="Last"})(z||(z={}));Object(I.b)("EventCountType",z);var B=d(698);d.d(Y,"FrequentLoggingMetrics",function(){return v});class v{constructor(y){this.EHf=this.aWf=null;this.kYg=this.uYf=0;this.It=null;this.aif=this.JFd=0;this.Xh=y;this.QEj();this.MAd=this.Rbf=this.aGd=!1;this.DFd=0}get hUi(){return this.MAd}aql(y){this.aif=y;window.setInterval(Object(e.a)(this,this.toe,"logMetricsBatchAndReset"),y);this.JFd=(new Date).getTime()}fH(y,
A){this.Hgl(y)&&!this.Rbf||this.hUi||!window.navigator.onLine||this.Xh.uFa||(this.It[y][A]++,this.aGd=!0)}QEj(){this.It=Array(3);for(let y=0;3>y;y++){this.It[y]=Array(7);for(let A=0;7>A;A++)this.It[y][A]=0}}Gki(){const y={};for(let A=0;3>A;A++)for(let E=0;7>E;E++)this.YWj(A,E)&&(y[m[A]+z[E]]=this.It[A][E]);y.FSDomain=this.aWf;y.ConnectionDomain=this.EHf;y.FSRetryInterval=this.uYf;y.MaxPayloadSize=this.kYg;y.LogNumber=this.DFd;1===this.DFd&&(y.FSLatencies=B.a.instance.G9i(),y.ConLatencies=B.a.instance.W5i());
return y}YWj(y,A){return 2===y&&3!==A&&0!==A?!1:!0}Hgl(y){return 2===y?!1:!0}toe(){if(this.aGd){this.DFd++;if((new Date).getTime()-this.JFd<5E3+this.aif){var y=n.a.toJSON(this.Gki());h.ULS.sendTraceTag(50644352,500,15,y)}this.JFd=(new Date).getTime();for(y=0;3>y;y++)for(let A=0;7>A;A++)this.It[y][A]=0;this.aGd=!1}}Wjk(){this.Rbf=!0}static get instance(){return v.Ka}static create(y){v.instance||(v.Ka=new v(y));return v.instance}}v.Ka=null;Object(I.a)(v,"FrequentLoggingMetrics",null,[1307])},338:function(I,
Y,d){d.r(Y);I=d(0);var h=d(387),e=d(14),n=d(1062),m=d(988),z=d(69),B=d(27);class v{constructor(Oa,oa){this.status=Oa;this.JAb=oa}}Object(I.a)(v,"UserStatusInfo",null,[]);var y=d(80),A=d(698);class E{constructor(Oa,oa){this.data=Oa;this.timeStamp=oa}}Object(I.a)(E,"PresenceData",null,[]);class u{constructor(Oa){this.Xqa=!1;this.Bqb=0;this.Vyd=!1;this.setTimeout=u.LZd;this.clearTimeout=u.BZd;this.D4j=Object(e.a)(this,this.Q3j,"logRtcConnectingUsageStatement");this.$r=Oa}Vrk(){this.Xqa||(this.Bqb=this.setTimeout(()=>
{this.Xqa=!1;this.Rqg()},8E3),this.Xqa=!0,this.Vyd=!1)}Esk(){this.sN()}syk(){this.Rqg()}Rqg(){this.sN();this.Vyd||(this.Vyd=!0,this.D4j())}Q3j(){h.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.$r)}sN(){this.Xqa&&this.clearTimeout(this.Bqb);this.Bqb=0;this.Xqa=!1}static LZd(Oa,oa){return window.setTimeout(Oa,oa)}static BZd(Oa){window.clearTimeout(Oa)}}Object(I.a)(u,"ConnectedUsageKpiLogger",null,[1365]);class J{constructor(){this.Dkd=this.yPe;this.BPe=
this.CPe;this.Ekd=this.APe;this.Onc=this.EPe;this.Dfh=this.DPe;this.LPe=this.MPe;this.IPe=this.JPe;this.kib=this.GPe;this.Qnc=this.HPe;this.yfh=this.zPe;this.zGb=this.iFe;this.qjc=this.jFe}yPe(){}CPe(){}APe(){}EPe(){}DPe(){}JPe(){}HPe(){}GPe(){}MPe(){}zPe(){}iFe(){}jFe(){}}Object(I.a)(J,"NoopRealtimeChannelMetrics",null,[1357,278]);class G{}G.B1a="presenceUpdated";G.updateNotification="updateNotification";G.n$g="persistentStateCleared";G.updatePersistentState="persistentStateUpdated";Object(I.a)(G,
"RtcClientMethodNames",null,[]);class S{}S.hAj="realtimeChannelHub";S.B1a="UpdatePresence";S.Zfa="SendUpdateNotification";S.e6d="GetCompletePersistentStateWithMetadata";S.updatePersistentState="UpdatePersistentState";S.Plb="UpdateClientInfo";Object(I.a)(S,"RtcHubMethodNames",null,[]);class P{constructor(Oa){this.Mz=Oa}bVk(Oa){this.Mz.on(G.B1a,Oa)}BVk(Oa){this.Mz.on(G.updateNotification,Oa)}ZUk(Oa){this.Mz.on(G.updatePersistentState,Oa)}YUk(Oa){this.Mz.on(G.n$g,Oa)}DBl(Oa){this.Mz.off(G.B1a,Oa)}IBl(Oa){this.Mz.off(G.updateNotification,
Oa)}CBl(Oa){this.Mz.off(G.updatePersistentState,Oa)}BBl(Oa){this.Mz.off(G.n$g,Oa)}B1a(Oa){return this.Mz.invoke(S.B1a,Oa)}Plb(Oa){return this.Mz.invoke(S.Plb,Oa)}Zfa(Oa,oa){return this.Mz.invoke(S.Zfa,Oa,oa)}e6d(Oa){return this.Mz.invoke(S.e6d,Oa)}updatePersistentState(Oa,oa){return this.Mz.invoke(S.updatePersistentState,Oa,oa)}}Object(I.a)(P,"RealtimeChannelProxy",null,[1362,1363,1364]);class Q{constructor(){this.Dxd=this.g8e=!1;this.Bxd=0;this.Eyd=this.IKd=this.HKd=this.cxd=!1;this.ZAd=0;this.gnf=
!1;this.fnf=this.enf=0;this.JJd=!1;this.NJd=this.LJd=this.OJd=this.KJd=0;this.MJd=!1}get dSd(){return this.Dxd}get awayCoauthorThresholdMs(){return this.Bxd}get adi(){return this.cxd}get Thl(){return this.HKd}get Uhl(){return this.IKd}get Uti(){return this.Eyd}get i4b(){return this.ZAd}get $3k(){return this.gnf}get jmh(){return this.enf}get Z3k(){return this.fnf}get U3k(){return this.JJd}get V3k(){return this.KJd}get nmh(){return this.OJd}get kmh(){return this.LJd}get mmh(){return this.NJd}get lmh(){return this.MJd}static createInstance(Oa){const {RealtimeChannel:oa}=
d(338);return Oa?Object.assign(new Q,{g8e:Oa.ka("AwayStatusManagerIsEnabled"),Dxd:Oa.ka("AwayStatusOneMinuteTimeoutIsEnabled"),Bxd:Oa.Bc("AwayCoauthorThresholdMs",9E5),cxd:Oa.ka("RtcAllowCrossDomainAccessEnabled"),HKd:Oa.ka("ShouldLogOnContentNotification"),IKd:Oa.ka("ShouldLogOnHostSubscriptionNotification"),Eyd:Oa.ka("RtcClientMetricsEnabled"),ZAd:Oa.Bc("RtcFindSessionRequestTimeoutInMS",6E4),gnf:Oa.ka("RtcJsClientFrequentlyLogsMetrics"),enf:Oa.Bc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),fnf:Oa.Bc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),JJd:Oa.ka("RtcClientMessageTelemetryEnabled"),KJd:Oa.Bc("RtcClientMessageTelemetrySampleSize",5),OJd:Oa.Bc("RtcSendTelemetryMessageIntervalInMS",3E5),LJd:Oa.Bc("RtcLogClientMessageMetricsTimeOutInMs",2E4),NJd:Oa.Bc("RtcMaxPayloadSizeInCharactersOverride",oa.PDe),MJd:Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new Q,{g8e:!1,Dxd:!1,Bxd:9E5,cxd:!1,HKd:!1,IKd:!0,Eyd:!1,ZAd:9E4,
JJd:!1,KJd:5,OJd:3E5,LJd:2E4,NJd:oa.PDe,MJd:!1})}}Object(I.a)(Q,"RealtimeChannelSettings",null,[1361]);var D=d(702),O=d(1200),X=d(158);class N{constructor(Oa){this.wXb=null;this.jya=0;this.y8a=!1;this.rl=Oa;this.rl.f6a(Object(e.a)(this,this.tna,"onConnectionStateChanged"))}tna(Oa,oa){this.jya=oa.newState}Jyk(){h.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.rl.pkd()}GDj(Oa){this.wXb.init(Oa)}}Object(I.a)(N,"ARtcMessageHandler",null,[]);var aa=d(1014);
class V{constructor(){this.Presence=null;this.TimeStamp=0}}Object(I.a)(V,"PresenceDataEntryForClients",null,[]);var ca=d(105);class fa{constructor(Oa,oa=""){this.s_h=Oa;this.LAa=oa}send(){return this.s_h()}get messageId(){return this.LAa}}Object(I.a)(fa,"MessageHandler",null,[1380]);var ma=d(728);class da extends Sys.EventArgs{constructor(Oa,oa,Xa,Hb){super();this.ORe=Oa;this.reconnectDelay=oa;this.reason=Xa;this.rUe=Hb}}Object(I.a)(da,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var qa=d(992);
class F{constructor(){this.oLd=this.Kj=null}get Vq(){return this.Kj?this.oLd?this.oLd.getTime()-this.Kj.getTime():(new Date).getTime()-this.Kj.getTime():0}start(){this.Kj=new Date}stop(){this.oLd=new Date}}Object(I.a)(F,"SimpleStopwatch",null,[]);var sa=d(993),ia;(function(Oa){Oa[Oa.contentUpdate=0]="contentUpdate";Oa[Oa.editorsTableUpdate=1]="editorsTableUpdate";Oa[Oa.fileNameUpdate=2]="fileNameUpdate";Oa[Oa.wetContentUpdate=3]="wetContentUpdate";Oa[Oa.persistedContentUpdate=4]="persistedContentUpdate";
Oa[Oa.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Oa[Oa.replicationTelemetry=6]="replicationTelemetry";Oa[Oa.lockUpdate=7]="lockUpdate";Oa[Oa.collabServiceContentUpdate=8]="collabServiceContentUpdate";Oa[Oa.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Oa[Oa.saveTargetUpdate=10]="saveTargetUpdate";Oa[Oa.uploadToOcsUpdate=11]="uploadToOcsUpdate";Oa[Oa.labelUpdate=12]="labelUpdate";Oa[Oa.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Oa[Oa.subscribeOrExtend=
14]="subscribeOrExtend";Oa[Oa.elapsedBootTelemetry=15]="elapsedBootTelemetry";Oa[Oa.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Oa[Oa.clientToClientResponseMessage=17]="clientToClientResponseMessage";Oa[Oa.verifyNotificationPipeline=18]="verifyNotificationPipeline";Oa[Oa.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Oa[Oa.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Oa[Oa.last=21]="last"})(ia||(ia={}));Object(I.b)("UpdateNotificationType",ia);var Na=d(926),
Ca=d(924),ha=d(925);class Ba extends N{constructor(Oa,oa,Xa,Hb,Ob,eb,Eb,oc,Sb,qc){super(Eb);this.Mz=null;this.Vhf=!1;this.LAa=0;this.aId=new X.a;this.fVh=Ba.g6i();this.GHd=B.AFrameworkApplication.fa.Ga("OwningFeatureCrewForRtcNotificationKpis");this.Jc=Oa;this.Bjf=this.Ajf=0;this.wXb=oa;this.wXb.KGc(Object(e.a)(this,this.Jyk,"onTooManyUndeliveredMessages"));this._clientId=Xa;this.WYh=Ob;this.rl.oai(Object(e.a)(this,this.Fwk,"onRefreshProxyRequired"));this.rl.mai(Object(e.a)(this,this.Dwk,"onRefreshAllPersistentStateRequest"));
this.rl.Bai(Object(e.a)(this,this.Zfa,"sendUpdateNotification"));this.rl.l9h(Object(e.a)(this,this.tuk,"onInternalPresenceUpdated"));this.rl.m9h(Object(e.a)(this,this.uuk,"onInternalUpdateNotificationReceived"));this.rl.k9h(Object(e.a)(this,this.suk,"onInternalPersistentStateUpdated"));this.rl.j9h(Object(e.a)(this,this.ruk,"onInternalPersistentStateCleared"));this.rl.Aai(Object(e.a)(this,this.BUe,"sendPersistentState"));this.rl.tbi(Object(e.a)(this,this.Plb,"updateClientInfo"));this.Yh=eb;this.$r=
Hb;this.It=oc;this.fN=Sb;this.NUb=qc;this.Jmb=Object(O.a)(String,B.AFrameworkApplication.gd.Application)||""}Fwk(Oa,oa){this.Mz=this.WYh(oa.hubConnection);this.wXb.reset();this.Mz.bVk(Object(e.a)(this,this.okc,"onPresenceUpdated"));this.Mz.ZUk(Object(e.a)(this,this.Lfd,"onPersistentStateUpdated"));this.Mz.YUk(Object(e.a)(this,this.mIe,"onPersistentStateCleared"));this.Mz.BVk(Object(e.a)(this,this.Ikc,"onUpdateNotificationReceived"))}tna(Oa,oa){this.jya=oa.newState;2===oa.newState&&this.Z7k()}Z7k(){for(let Oa of this.aId)this.Zfa(null,
new qa.a(Oa.key,Oa.value,!1,new n.a));this.aId=new X.a}Dwk(Oa,oa){oa.aVd();for(Oa=0;3>Oa;++Oa)this.L7k(Oa,oa)}L7k(Oa,oa){try{this.Mz.e6d(Oa).done(Xa=>{oa.FPb(oa.sWd,"GetCompletePresenceSuccess")&&(oa.Kyi.syk(),h.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.$r),this.rl.SOk(),this.Wvk(Oa,Xa),this.rl.VNk(Xa),oa.ETf.Hb(Oa)&&this.rl.weh(Oa,oa.ETf.ga(Oa),new n.a))}).fail(Xa=>{const {RtcUtils:Hb}=d(190);oa.FPb(oa.sWd,"GetCompletePresenceFail")&&(h.ULS.sendTraceTag(3249541,
500,15,"Failed to retrieve complete session state : {0} for [{1}]",Hb.PGb(Xa),this.$r),this.rl.pkd())}).always(()=>{oa.Hy&&oa.Hy.stop()})}catch(Xa){h.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",oa.sWd,Xa.message)}}BUe(Oa,oa){var {RtcUtils:Xa}=d(190);Oa=oa.presence;let Hb;const Ob=oa.MLa;this.fN.fH(1,0);try{Hb=Xa.HUd(Oa,this.NUb)}catch(Eb){this.fN.fH(1,
3);h.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Eb.message);Ob.setException(Eb);return}Xa=new z.a;Xa.$(this._clientId,Object.assign(new V,{Presence:Oa,TimeStamp:(new Date).getTime()}));this.rl.Ueh(oa.type,Xa);if(2!==this.jya)this.It.kib(),this.fN.fH(1,2),Ob.Gg(null);else{var eb=this.LAa.toString();++this.LAa;Oa=new fa(()=>this.a8k(oa.type,Hb,eb),eb);Oa=this.KBh(0,oa.type).add(Oa);Oa.tfd(Eb=>{2===Eb&&this.fN.fH(1,6);Ob.Gg(null)});
Oa.sfd(()=>{})}}a8k(Oa,oa,Xa){let Hb=null;const Ob=new F,eb=new ma.a;h.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.$r);if(2!==this.jya)return this.It.kib(),this.fN.fH(1,2),h.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.$r),eb.GDe(),eb;this.Yh&&20>this.Ajf&&(Hb=this.Yh.Ci("WebServiceCall","Send Presence Message"),this.Ajf++);Ob.start();eb.Aic(1);try{this.Mz.updatePersistentState(Oa,oa).done(()=>{this.It.IPe();this.fN.fH(1,
1);h.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",Xa,this.$r);eb.zYa(1);Ob&&(Ob.stop(),Ob.Vq>this.Jc.jmh?this.fN.fH(1,4):this.fN.fH(1,5))}).fail(Eb=>{const {RtcUtils:oc}=d(190);this.y8a||(this.It.kib(),this.fN.fH(1,3),h.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Xa,oc.PGb(Eb),this.$r));eb.zYa(2)}).always(()=>{Hb&&Hb.stop()})}catch(Eb){h.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
Eb.message),this.fN.fH(1,3),eb.zYa(2)}return eb}Plb(Oa,oa){({RtcUtils:Oa}=d(190));const Xa=oa.Tti,Hb=oa.MLa;let Ob;try{Ob=Oa.HUd(Xa,this.NUb)}catch(eb){h.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",eb.message);Hb.setException(eb);return}try{this.Mz.Plb(Ob).done(()=>{h.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(eb=>{const {RtcUtils:Eb}=d(190);this.y8a||h.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
Eb.PGb(eb));Hb.Gg(null)})}catch(eb){h.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",eb.message),Hb.Gg(null)}}Zfa(Oa,oa){({RtcUtils:Oa}=d(190));const Xa=oa.type,Hb=oa.Eza,Ob=oa.PKi,eb=oa.MLa;let Eb;this.fN.fH(0,0);try{Eb=Oa.HUd(Hb,this.NUb)}catch(Sb){this.fN.fH(0,3);h.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Sb.message);eb.setException(Sb);return}if(2!==this.jya)Ob?this.aId.$(Xa,
Hb):(this.It.kib(),this.fN.fH(0,2)),eb.Gg(null);else{var oc=this.LAa.toString();++this.LAa;oa=new fa(()=>this.w8k(Xa,Eb,oc),oc);oa=this.KBh(1,Xa).add(oa);oa.tfd(Sb=>{2===Sb&&this.fN.fH(0,6);eb.Gg(null)});oa.sfd(()=>{})}}w8k(Oa,oa,Xa){let Hb=null;const Ob=new F,eb=new ma.a;h.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.$r);if(2!==this.jya)return this.It.kib(),this.fN.fH(0,2),h.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",
this.$r),eb.GDe(),eb;this.Yh&&3===Oa&&20>this.Bjf&&(Hb=this.Yh.Ci("WebServiceCall","Send WetContent Update"),this.Bjf++);Ob.start();eb.Aic(1);this.Mz.Zfa(Oa,oa).done(()=>{this.It.IPe();this.fN.fH(0,1);h.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",Xa,this.$r);eb.zYa(1);Ob&&(Ob.stop(),Ob.Vq>this.Jc.jmh?this.fN.fH(0,4):this.fN.fH(0,5))}).fail(Eb=>{const {RtcUtils:oc}=d(190);this.y8a||(this.It.kib(),this.fN.fH(0,3),h.ULS.sendTraceTag(3249507,500,
15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Xa,oc.PGb(Eb),this.$r));eb.zYa(2)}).always(()=>{Hb&&Hb.stop()});return eb}Dza(){this.Mz.DBl(Object(e.a)(this,this.okc,"onPresenceUpdated"));this.Mz.CBl(Object(e.a)(this,this.Lfd,"onPersistentStateUpdated"));this.Mz.BBl(Object(e.a)(this,this.mIe,"onPersistentStateCleared"));this.Mz.IBl(Object(e.a)(this,this.Ikc,"onUpdateNotificationReceived"))}tuk(Oa,oa){this.okc(oa.tPb,oa.XOf)}okc(Oa){this.It.Qnc();this.Lfd(0,Oa)}suk(Oa,
oa){this.Lfd(oa.type,oa.tPb)}Wvk(Oa,oa){const Xa={};for(let Hb in oa)Xa[Hb]=oa[Hb].Presence;this.V4g(Oa,Xa,oa)}Lfd(Oa,oa){this.It.Qnc();this.V4g(Oa,oa)}V4g(Oa,oa,Xa=null){var {RtcUtils:Hb}=d(190);if(h.ULS.Kya(500,100))for(var Ob in oa);delete oa[this._clientId];if(!ca.a.isEmpty(oa)){for(var eb in oa)Ob=eb,oa[Ob]=Hb.deserialize(oa[eb],"Presence",Ob,!1,this.NUb);Hb=new z.a;eb=(new Date).getTime();for(let Eb in oa){Ob=oa[Eb];let oc=Eb,Sb;Xa?(Sb=Xa[oc],Sb.Presence=Ob):Sb=Object.assign(new V,{Presence:Ob,
TimeStamp:eb});Hb.$(oc,Sb)}this.rl.Ueh(Oa,Hb);switch(Oa){case 0:this.Vhf||(h.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.$r),this.Vhf=!0,B.AFrameworkApplication.Xg&&B.AFrameworkApplication.Xg.Sjk());this.rl.leh(oa,[]);break;default:this.rl.FOk(Oa,oa)}}}ruk(Oa,oa){this.mIe(oa.sVd)}mIe(Oa){this.It.Qnc();if(h.ULS.Kya(500,100))for(let oa=0;oa<Oa.length;++oa);Oa.length&&(this.rl.UPk(Oa),this.rl.EOk(Oa),this.rl.leh({},Oa))}uuk(Oa,oa){this.Ikc(oa.type,oa.Eza)}Ikc(Oa,
oa=null){this.Jc.Thl&&0===Oa&&h.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Oa&&this.GHd&&0<this.GHd.length){var Xa=Object.assign(new Na.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.GHd,vetoPillar:"RealTimeCoauth"});(Xa=aa.a.getInstance(Xa))&&Xa.logKpiUsage(this.fVh)}this.Jc.Uhl&&13===Oa&&h.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
oa||"<none>"));this.It.Qnc();5===Oa?(oa=(Oa=this.SCk(oa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Oa.reason,Oa.reconnectDelay):"Received client reconnection request from the server without params.",h.ULS.sendTraceTag(18637071,500,50,oa),this.rl.pkd(Oa)):(oa=d(190).RtcUtils.deserialize(oa,String.format("UpdateNotification-{0}",ia[Oa]),null,!1,this.NUb),this.rl.TPk(Oa,oa))}SCk(Oa){try{if(!Oa||""===Oa)return null;const oa=JSON.parse(Oa);return new da(oa[sa.a.fTe],
oa[sa.a.T3k],oa[sa.a.X3k],oa[sa.a.rUe])}catch(oa){return h.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",oa.message),null}}KBh(Oa,oa){return this.wXb.smj(this.tmj(Oa,oa))}tmj(Oa,oa){return Oa+","+oa}static g6i(){var Oa=new Map;Oa.set("SkipAria","True");Oa=Object.assign(new Ca.a,{extendedProperties:Oa});return Object.assign(new ha.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Oa,blockFutureEmissionDurationInMs:3E5})}}Object(I.a)(Ba,"RtcMessageHandler",
N,[]);class va{tKf(Oa,oa=""){const {MaxOutstandingThrottler:Xa}=d(989);return Xa.createInstance(Oa,oa)}GEi(Oa,oa=""){const {MaxRateThrottler:Xa}=d(991);return Xa.createInstance(Oa,oa)}}Object(I.a)(va,"ThrottlerFactory",null,[1360]);var ta=d(78),Fa=d(699);class pa{constructor(Oa){this.Jc=null;this.EP=!1;this.Pa=new ta.a;this.WFd=new z.a;this.UFd=new z.a;this.mMd=Oa;this.eob=this.mMd.tKf(oa=>oa.send(),"GlobalMaxOustandingThrottler");this.eob.KGc(()=>{this.Pa.raiseEvent("TMUDM")})}init(Oa){this.EP||
(this.Jc=Oa,this.eob.init(this.Jc.XLa,this.Jc.kpj),this.EP=!0)}smj(Oa){var {MaxRateThrottler:oa}=d(991),{MaxOutstandingThrottler:Xa}=d(989);this.EP||this.init(new Fa.a(oa.yMf,Xa.PMf,Xa.EMf,pa.Xkk));({value:oa}=this.WFd.Uf(Oa)).returnValue||(({value:oa}=this.UFd.Uf(Oa)).returnValue||(oa="MaxOutstandingThrottler-"+Oa,oa=this.mMd.tKf(Object(e.a)(this.eob,this.eob.add,"add"),oa),oa.init(this.Jc.XLa,this.Jc.Wkk),oa.KGc(()=>{this.Pa.raiseEvent("TMUDM")}),this.UFd.add(Oa,oa)),Xa="MaxRateThrottler-"+Oa,oa=
this.mMd.GEi(Object(e.a)(oa,oa.add,"add"),Xa),oa.init(this.Jc.Tlk),this.WFd.add(Oa,oa));return oa}reset(){for(let Oa of this.WFd)Oa.value.KPe();for(let Oa of this.UFd)Oa.value.KPe(),Oa.value.reset();this.eob.KPe();this.eob.reset()}KGc(Oa){this.Pa.addHandler("TMUDM",Oa)}}pa.Xkk=1E3;Object(I.a)(pa,"ThrottlerManager",null,[1359]);var ka=d(1138);const Ha=(Oa,oa,Xa,Hb,Ob,eb,Eb,oc,Sb=null,qc=null,$a=null,ab=null)=>{const Ib=Q.createInstance(B.AFrameworkApplication.fa),gc=B.AFrameworkApplication.buildVersion?
B.AFrameworkApplication.buildVersion:"1.0",Ta=Ya(Oa,oa,Eb,gc),Ab=Ib.Uti?d(1136).RealtimeChannelMetrics.createInstance(Ta):new J;var kc=d(309).FrequentLoggingMetrics.create(Ob);Ib.$3k&&kc.aql(Ib.Z3k);var fb="";fb=Sb&&""!==Sb?Sb:"/rtc2/";kc.aWf=y.a.YD(fb);const Qb=fb+"signalr";Sb=fb+"findsession";const mb=S.hAj;fb=new va;$a=$a||D.a.getInstance();h.ULS.shipAssertTag(556867617,500,Ib.mmh<=d(338).RealtimeChannel.lYg,"Client attempting to override max payload size beyond absolute limit");const Jb=Math.min(Ib.mmh,
d(338).RealtimeChannel.lYg);kc.kYg=Jb;kc=new Ba(Ib,new pa(fb),Oa,Ta,Ub=>new P(Ub.createHubProxy(mb)),oc,$a,Ab,kc,Jb);qc||(qc=d(704).FindSessionStrategy.createInstance(oa,Ob,Sb,oc,gc,Eb,Oa,Ta,$a,eb,Hb,ab));qc.i4b=Ib.i4b;oa=new u(Ta);Xa=Xa?Xa.split(","):null;Oa=new (d(338).RealtimeChannel)(Oa,Xa,Ta,oc,()=>$.hubConnection(Qb),qc,kc,oa,$a,Ab,Ib,Ob);Oa.init();return Oa},Ya=(Oa,oa,Xa)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Oa,Ka(ka.a[Xa]),Ka("browser"),oa),Ka=Oa=>Oa?Oa.charAt(0).toLocaleUpperCase()+
Oa.substring(1,Oa.length):Oa;d.d(Y,"RealtimeChannel",function(){return Pa});class Pa{constructor(Oa,oa,Xa,Hb,Ob,eb,Eb,oc,Sb,qc,$a,ab){this.mLd=!1;this.nZ=null;this.qS=new z.a;this.gRb=1;this.j2=null;this.tK=!1;this.PEd=(new Date(0)).getTime();this.Eof=0;this._clientId=Oa;this.QEc=oa;this.oZ=0;this.Yh=Hb;this.Uyd=oc;this.c_h=Eb;this.mMh=Sb;this.WOh=Ob;this.OMa=eb;this.$r=Xa;this.It=qc;this.Jc=$a;this.Xh=ab;this.v0h=1>100*Math.random()}get bna(){return this.OMa.bna}set bna(Oa){this.OMa.bna=Oa}get D_a(){return this.c_h}get rl(){return this.mMh}init(){this.rl.nai(Object(e.a)(this,
this.qNc,"disconnectAndCreateNewConnection"));this.rl.vbi(Object(e.a)(this,this.Yyk,"onUpdatePersistentStateRequestReceivedInternal"));this.rl.ubi(Object(e.a)(this,this.Xyk,"onUpdatePersistentStateClearedRequestReceived"));this.Xh.bGc(this.It);B.AFrameworkApplication.pga(()=>{const {FrequentLoggingMetrics:Oa}=d(309);this.It.LPe();Oa.instance&&Oa.instance.toe()});this.AKf();this.OMi();this.rl.Ruf(Object(e.a)(this,this.SCl,"updateConnectionQueryString"))}OMi(){try{const Xa=$.signalR;if(!Xa)throw Error.invalidOperation("Failed to retrieve Signalr object");
const Hb=Xa.version;if(!Hb)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Hb){var Oa=Xa.transports;if(!Oa)throw Error.invalidOperation("Failed to retrieve transports object");var oa=Oa.longPolling;if(!oa)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!oa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");oa.supportsKeepAlive=this.LGi()}}catch(Xa){h.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",Xa.message)}}LGi(){return()=>!1}AKf(){const Oa=++this.gRb;this.PEd=(new Date(0)).getTime();this.j2=this.WOh();this.rl.OOk(this.j2);this.j2.stateChanged(oa=>{this.Zrk(oa,Oa)});this.j2.connectionSlow(Object(e.a)(this,this.kyk,"onSlowConnection"));this.j2.error(Object(e.a)(this,this.Wxk,"onSignalRError"));this.j2.log=Object(e.a)(this,this.Xxk,"onSignalRLog")}FPb(Oa,oa){return Oa!==this.gRb?(h.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
oa),!1):!0}connect(){2!==this.oZ&&1!==this.oZ&&(h.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.$r),this.Uyd.Vrk(),A.a.instance.bql(),this.tna(1,this.oZ),this.Txh())}Txh(){const Oa=this.gRb;this.mLd=!1;this.It.Dkd();this.OMa.H9d(Object(e.a)(this,this.Jyi,"connectSignalrConnection"),Object(e.a)(this,this.f3g,"onFailureToConnect"),Object(e.a)(this.D_a,this.D_a.GDj,"initThrottlerManager"),Object(e.a)(this,this.FPb,"verifyConnectionToken"),Oa)}f3g(Oa=null){this.It.Ekd();
let oa=null;!Oa||"documentsessiondeleted"!==(oa=Oa.toLowerCase())&&"documentsessionexpired"!==oa?this.qNc():(h.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.$r,Oa),this.disconnect())}qNc(Oa,oa=null){h.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.nZ);Oa=(Oa=2===this.oZ||1===this.oZ)&&!this.D_a.y8a;let Xa=!0,Hb=0;oa&&Object.getType(oa)!==Object.getType(Sys.EventArgs.Empty)&&
oa.ORe&&""!==oa.ORe&&(Oa=!0,this.OMa.cWe(oa.ORe),Xa=oa.rUe,Hb=oa.reconnectDelay);Oa&&this.tna(1,this.oZ);++this.gRb;this.D_a.Dza();this.Qql(Xa);this.OMa.X_d();this.AKf();Oa&&window.setTimeout(Object(e.a)(this,this.Txh,"startConnecting"),Math.min(Hb,3E4))}SCl(){let Oa=null;const oa=({correlationId:Oa}=this.OMa.ASc()).returnValue;this.j2.qs=oa;h.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.$r,Oa)}Jyi(Oa){const {FrequentLoggingMetrics:oa}=
d(309);this.PEd=(new Date).getTime();let Xa=null;this.j2.qs=({correlationId:Xa}=this.OMa.ASc()).returnValue;this.Jc.adi&&(this.j2.url=Oa,oa.instance&&(oa.instance.EHf=y.a.YD(Oa)));let Hb=null;this.Yh&&(Hb=this.Yh.Ci("WebServiceCall","ConnectToServer"));h.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.$r);Oa={};this.QEc&&(Oa.transport=1===this.QEc.length?this.QEc[0]:this.QEc);Oa.pingInterval=null;A.a.instance.Pnc(1,0);Oa.waitForPageLoad=!1;this.j2.start(Oa,null).done(Ob=>
{this.It.BPe();A.a.instance.Pnc(1,1,!0);h.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",Ob.id,Xa)}).fail(Ob=>{h.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.OMa.QA,Xa,this.$r);this.f3g();this.It.yfh(Ob);A.a.instance.Pnc(1,1,!1);this.rl.teh(0,{["CorrelationId"]:Xa,["ErrorDetails"]:Ob,["ConnectionState"]:m.a[this.oZ]})}).always(()=>{const {FrequentLoggingMetrics:Ob}=
d(309);Hb&&Hb.stop();Ob.instance&&(Ob.instance.MAd=!1)})}disconnect(){const {FrequentLoggingMetrics:Oa}=d(309);0===this.oZ?h.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.$r):(this.It.Dfh(),Oa.instance&&(Oa.instance.MAd=!0),h.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.$r),this.D_a.y8a=!0,this.Uyd.Esk(),this.tna(0,this.oZ),this.qNc(),this.D_a.y8a=!1)}Qql(Oa){const oa=this.woi(),Xa=this.j2,Hb=this.nZ,
Ob=()=>{if(this.mLd)h.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.mLd=!0,Xa.stop(!0,Oa)}catch(eb){h.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",eb.message)}};0<oa?(h.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Hb,oa),window.setTimeout(Ob,oa)):(h.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Hb),Ob())}woi(){let Oa=0;0===this.j2.state&&(Oa=this.PEd+Pa.wJl-
(new Date).getTime(),0>Oa&&(Oa=0));return Oa}get connectionState(){return this.oZ}f6a(Oa){this.rl.f6a(Oa)}CUe(Oa){return this.BUe(0,Oa)}BUe(Oa,oa){const Xa=new n.a;this.rl.weh(Oa,oa,Xa);return Xa.task}GGc(Oa){this.rl.GGc(Oa)}Hta(Oa){return this.znj(Oa)}gRc(){return this.U2i()}U2i(){const Oa={};for(let oa of this.qS)oa.value.Hb(0)&&(Oa[oa.key]=oa.value.ga(0).data);return Oa}znj(Oa){return this.qS.Hb(Oa)&&this.qS.ga(Oa).Hb(0)?this.qS.ga(Oa).ga(0).data:null}Yyk(Oa,oa){for(let Xa of oa.zGl)this.qS.Hb(Xa.key)||
this.qS.$(Xa.key,new X.a),Oa=Xa.value,this.qS.ga(Xa.key).$(oa.type,new E(Oa.Presence,new Date(Oa.TimeStamp))),Xa.key===this._clientId&&0===oa.type&&this.rl.nOk(Oa.Presence)}Xyk(Oa,oa){for(const Xa of oa.sVd)this.qS.remove(Xa)}T2i(){const Oa=new X.a;if(!this.qS.Hb(this._clientId))return Oa;for(let oa of this.qS.ga(this._clientId))Oa.$(oa.key,oa.value.data);return Oa}Zfa(Oa,oa=null,Xa=!1){const Hb=new n.a;this.rl.gPe(Oa,oa,Xa,Hb);return Hb.task}WBa(Oa){this.rl.WBa(Oa)}rdj(){return this.N3(this._clientId)}N3(Oa){let oa,
Xa;return({value:oa}=this.qS.Uf(Oa)).returnValue&&({value:Xa}=oa.Uf(0)).returnValue?new v(this.Dnj(Xa),Xa.timeStamp):null}b3i(){const Oa={};for(let oa of this.qS)oa.value.Uf(0).returnValue&&(Oa[oa.key]=this.N3(oa.key));return Oa}Plb(Oa){const oa=new n.a;this.rl.SPk(Oa,oa);return oa.task}get clientId(){return this._clientId}get Zml(){return this.v0h}dispose(){const {FrequentLoggingMetrics:Oa}=d(309);this.tK||(this.D_a.Dza(),this.Xh.fld(this.It),this.It.LPe(),Oa.instance&&Oa.instance.toe(),this.tK=
!0)}Zrk(Oa,oa){this.FPb(oa,"StateChangedSignalR")&&this.tna(this.CIf(Oa.newState),this.CIf(Oa.oldState))}tna(Oa,oa){var {FrequentLoggingMetrics:Xa}=d(309),{ClientToClientMessageTelemetry:Hb}=d(1037);if((1!==this.oZ||0!==oa||1!==Oa)&&this.oZ!==oa){const Ob=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.oZ,oa,Oa]));h.ULS.sendTraceTag(3290053,500,10,Ob)}if(this.oZ!==Oa){switch(Oa){case 2:Xa.instance&&
Xa.instance.Wjk();this.nZ=this.j2.id;h.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.nZ,this.$r);this.t4j(this.j2);h.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Xa=null;this.Yh&&(Xa=this.Yh.Ci("WebServiceCall","Receive First Presence"));Hb=this.gRb;this.rl.NOk(Object(e.a)(this,this.FPb,"verifyConnectionToken"),Hb,this.Uyd,Object(e.a)(this,this.aVd,"clearExistingPersistentState"),this.T2i(),Xa);this.Jc.U3k&&(Xa=100*Math.random()<=this.Jc.V3k,
d(1037).ClientToClientMessageTelemetry.pej(this.rl,this.Jc,Xa).start());break;case 1:2===oa&&h.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.nZ);break;case 0:if(Hb.instance&&Hb.instance.stop(),this.D_a.y8a)h.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.nZ);else{1===oa&&(h.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.nZ),this.It.Onc());2===oa&&h.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.nZ);this.qNc();return}}this.oZ=Oa;this.rl.yNk(Oa,oa)}}t4j(Oa){if(Oa&&Oa.transport&&Oa.transport.name){Oa=Oa.transport.name;var oa=Oa.toLowerCase();"websockets"===oa?h.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"serversentevents"===oa?h.ULS.sendTraceTag(4290752,
500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"foreverframe"===oa?h.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"longpolling"===oa?h.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",Oa,this.$r):"mocktransport"!==oa&&h.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Oa)}else h.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}kyk(){if(this.Jc.lmh){const Oa=y.a.hT(this.bna,"mid");h.ULS.sendTraceTag(3249544,
500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.nZ,Oa)}else h.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.nZ)}Wxk(){h.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.nZ)}Xxk(Oa){Oa=d(190).RtcUtils.PGb(Oa);if(this.Jc.lmh&&Oa.startsWith("Keep alive timed out.")){const oa=y.a.hT(this.bna,"mid");h.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",Oa,oa)}else this.Zml&&2E3>this.Eof&&
!Oa.startsWith("Invok")&&!Oa.startsWith("Trigger")&&(h.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Oa),this.Eof++)}aVd(){let Oa;const oa=[];({value:Oa}=this.qS.Uf(this._clientId)).returnValue&&this.qS.remove(this._clientId);for(let Xa of this.qS.keys)Array.add(oa,Xa);for(const Xa of oa)this.qS.remove(Xa);Oa&&this.qS.$(this._clientId,Oa);this.rl.dOk(oa)}CIf(Oa){switch(Oa){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Oa,"Unknown SignalR state");
}}Dnj(Oa){return Oa&&Oa.timeStamp?(new Date).getTime()-Oa.timeStamp.getTime()>(this.Jc.dSd?6E4:this.Jc.awayCoauthorThresholdMs)?2:1:1}static createInstance(Oa,oa,Xa,Hb,Ob,eb,Eb,oc=null,Sb=null,qc=null,$a=null,ab=null,Ib=null){return Ha(Oa,oa,Xa,Ib,Hb,Ob,eb,Eb,oc,Sb,qc,ab,$a)}}Pa.lYg=31E3;Pa.PDe=8E3;Pa.wJl=15E3;Object(I.a)(Pa,"RealtimeChannel",null,[1096,1095])},698:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.kpf=!1;this.BId=null;this.Z9e=0;this.YAd=this.uLf();
this.Mwc=this.uLf();this.y2a=this.aob=0;this.EF=()=>new Date}get Frl(){return this.kpf}uLf(){const e=Array(6);for(let n=0;n<e.length;n++)e[n]=0;return e}G9i(){return this.YAd.toString()}W5i(){return this.Mwc.toString()}bql(){this.BId=this.EF()}Pnc(e,n,m=!1){this.Frl||(m&&(this.kpf=!0),m=this.EF(),0===e&&5<this.aob||1===e&&5<this.y2a||(this.Z9e<e?(1===this.aob%2&&(this.YAd[this.aob]=-1,this.aob++),this.Z9e=e,1===n&&(this.Mwc[this.y2a]=-1,this.y2a++),this.Mwc[this.y2a]=this.w_e(m),this.y2a++):0===e?
(this.YAd[this.aob]=this.w_e(m),this.aob++):(this.Mwc[this.y2a]=this.w_e(m),this.y2a++)))}w_e(e){const n=e.getTime()-this.BId.getTime();this.BId=e;return n}static get instance(){h.Ka||(h.Ka=new h);return h.Ka}static set instance(e){h.Ka=e}}h.Ka=null;Object(I.a)(h,"LatencyMetrics",null,[])},699:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n,m,z){this.Tlk=e;this.XLa=n;this.Wkk=m;this.kpj=z}}Object(I.a)(h,"ThrottlerManagerSettings",null,[])},702:function(I,Y,d){I=d(0);
class h extends Sys.EventArgs{constructor(X,N){super();this.newState=X;this.oldState=N}}Object(I.a)(h,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(X,N){super();this.Tti=X;this.MLa=N}}Object(I.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(X){super();this.presence=X}}Object(I.a)(n,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class m extends Sys.EventArgs{constructor(X){super();this.sVd=X}}Object(I.a)(m,"PersistentStateClearedEventArgs",
Sys.EventArgs,[]);class z extends Sys.EventArgs{constructor(X,N){super();this.type=X;this.tPb=N}}Object(I.a)(z,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var B=d(1137);class v extends Sys.EventArgs{constructor(X,N=null){super();this.JG=X;this.M2h=N}get type(){return this.JG}get Eza(){return this.M2h}}Object(I.a)(v,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class y extends Sys.EventArgs{constructor(X){super();this.TIk=X}}Object(I.a)(y,"GotCompletePersistentStateWithMetadataEventArgs",
Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(X,N,aa,V,ca,fa){super();this.FPb=X;this.sWd=N;this.Kyi=aa;this.ETf=ca;this.aVd=V;this.Hy=fa}}Object(I.a)(A,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(X){super();this.hubConnection=X}}Object(I.a)(E,"RefreshProxyEventArgs",Sys.EventArgs,[]);class u extends Sys.EventArgs{constructor(X,N){super();this.VVi=X;this.errorMessage=N}}Object(I.a)(u,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class J extends Sys.EventArgs{constructor(X,
N,aa){super();this.type=X;this.presence=N;this.MLa=aa}}Object(I.a)(J,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var G=d(992);class S extends Sys.EventArgs{constructor(){super()}}Object(I.a)(S,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class P extends Sys.EventArgs{constructor(X){super();this.sVd=X}}Object(I.a)(P,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class Q extends Sys.EventArgs{constructor(X,N){super();this.type=X;this.zGl=N}}Object(I.a)(Q,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var D=d(78);d.d(Y,"a",function(){return O});class O{constructor(){this.Pa=new D.a}yNk(X,N){this.Pa.raiseEvent("CSC",new h(X,N))}OOk(X){this.Pa.raiseEvent("RP",new E(X))}pkd(X){this.Pa.raiseEvent("RC",X)}SOk(){this.Pa.raiseEvent("RMID")}NOk(X,N,aa,V,ca,fa){this.Pa.raiseEvent("RPS",new A(X,N,aa,V,ca,fa))}Ueh(X,N){this.Pa.raiseEvent("UPSR",new Q(X,N))}leh(X,N){this.Pa.raiseEvent("PU",new B.a(X,N))}nOk(X){this.Pa.raiseEvent("MPU",new n(X))}gPe(X,N,aa,V){this.Pa.raiseEvent("SUN",new G.a(X,
N,aa,V))}TPk(X,N){this.Pa.raiseEvent("UNR",new v(X,N))}weh(X,N,aa){this.Pa.raiseEvent("SP",new J(X,N,aa))}FOk(X,N){this.Pa.raiseEvent("PSU",new z(X,N))}EOk(X){this.Pa.raiseEvent("PSC",new m(X))}dOk(X){this.Pa.raiseEvent("IPSC",new m(X))}UPk(X){this.Pa.raiseEvent("UPSC",new P(X))}aPk(X,N){this.Pa.raiseEvent("SPC",new S(X,N))}teh(X,N){this.Pa.raiseEvent("RCF",new u(X,N))}VNk(X){this.Pa.raiseEvent("CPSWM",new y(X))}SPk(X,N){this.Pa.raiseEvent("UCI",new e(X,N))}f6a(X){this.Pa.addHandler("CSC",X)}oai(X){this.Pa.addHandler("RP",
X)}nai(X){this.Pa.addHandler("RC",X)}uai(X){this.Pa.addHandler("RMID",X)}mai(X){this.Pa.addHandler("RPS",X)}vbi(X){this.Pa.addHandler("UPSR",X)}GGc(X){this.Pa.addHandler("PU",X)}l9h(X){this.Pa.addHandler("IPU",X)}tbi(X){this.Pa.addHandler("UCI",X)}Bai(X){this.Pa.addHandler("SUN",X)}m9h(X){this.Pa.addHandler("IUNR",X)}WBa(X){this.Pa.addHandler("UNR",X)}k9h(X){this.Pa.addHandler("IPSU",X)}j9h(X){this.Pa.addHandler("IPSC",X)}ubi(X){this.Pa.addHandler("UPSC",X)}Aai(X){this.Pa.addHandler("SP",X)}Ruf(X){this.Pa.addHandler("SPC",
X)}yai(X){this.Pa.addHandler("RCF",X)}e9h(X){this.Pa.addHandler("CPSWM",X)}eYk(X){this.Pa.removeHandler("CPSWM",X)}static getInstance(){return O.Ka||(O.Ka=new O)}}O.Ka=null;Object(I.a)(O,"RtcEventHub",null,[1244])},704:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(14),n=d(18),m=d(988),z=d(994),B=d(27),v=d(80),y=d(65),A=d(452),E=d(496),u=d(105),J=d(47),G=d(106),S=d(995);class P{}P.clientId="ClientId";P.dHl="UserApp";P.userSessionId="usid";P.userType="UserType";P.sHl="UserVersion";P.unc="qs";P.Wti=
"clientProtocol";P.aok="NoAuth";Object(I.a)(P,"RtcFindSessionInputQueryParamConstants",null,[]);class Q{constructor(da,qa,F,sa,ia,Na){this.D4a=null;const {FindSessionStrategy:Ca}=d(704);this.$Yh=da;da=String.format("{0}={1}",P.clientId,J.a.Ne(sa));da=String.format("{0}&{1}={2}",da,P.userSessionId,J.a.Ne(ia));da=String.format("{0}&{1}={2}",da,P.dHl,J.a.Ne(F.toString()));da=String.format("{0}&{1}={2}",da,P.userType,J.a.Ne("1"));da=String.format("{0}&{1}={2}",da,P.sHl,J.a.Ne(qa));da=String.format("{0}&{1}={2}",
da,P.Wti,J.a.Ne(Ca.Vti));(qa=Q.A3i(F,Na))&&(da=String.format("{0}&{1}",da,qa));this.YOh=da}jgh(){this.D4a=this.$Yh()}$0i(){this.D4a&&""!==this.D4a||(this.jgh(),h.ULS.sendTraceTag(575784194,500,this.D4a&&""!==this.D4a?50:15,"Query signature delegate called for refresh returned: {0} ",this.D4a));const da=String.format("{0}={1}",P.unc,J.a.Ne(this.D4a));return String.format("{0}&{1}",da,this.YOh)}static A3i(da,qa){return 4===da?String.format("{0}={1}",P.aok,"1"):qa?qa.Hnj():null}}Object(I.a)(Q,"FindSessionQueryStringGenerator",
null,[]);var D=d(309),O=d(698),X=d(190),N=d(699);class aa{}aa.jYi="FSType";Object(I.a)(aa,"RtcFindSessionRequestHeaders",null,[]);class V{}V.PQk="polling";Object(I.a)(V,"RtcFindSessionTypes",null,[]);var ca=d(993);class fa{}fa.pIl="RTC-TokenProofkey";fa.qXj="RTC-IsWacJsBootFsRequest";Object(I.a)(fa,"RtcRequestHeaders",null,[]);d.d(Y,"FindSessionStrategy",function(){return ma});class ma{constructor(da,qa,F,sa,ia,Na,Ca,ha,Ba,va,ta,Fa,pa=null){this.Tgf=(new Date(0)).getTime();this.eif=0;this.IAc=!1;
this.Xnf=null;this.UPe=36E5;this.rnb=ma.deg;this.iSb=0;this.Uib=null;this.jya=0;this.QKb=this.FHf=null;this.GZh=[z.a.Pzb,z.a.errorMessage,z.a.mZe,z.a.QA,z.a.Q5,z.a.Fae,z.a.egb,z.a.XLa,z.a.ggb];this.FZh=[z.a.Pzb,z.a.errorMessage];this.QA=this.bna=null;this.Lbf=new Q(ta?ta:()=>B.AFrameworkApplication.gh,ia,Na,Ca,da,qa);this.NQb=Fa;this.Yh=sa;this.Xh=qa;this.wRh=F;this.$r=ha;this.rl=Ba;this.uSb=pa;this.Mbf=!1;this.i4b=9E4;va&&va.execute(ka=>{ka.DGc(()=>{h.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.$r);this.Lbf.jgh()})});2>=100*Math.random()&&(this.UPe=3E5);D.FrequentLoggingMetrics.instance&&(D.FrequentLoggingMetrics.instance.uYf=this.UPe)}cWe(da){this.QKb=da}init(){this.rl.uai(Object(e.a)(this,this.z1k,"resetGetMachineIdDelay"));this.rl.f6a(Object(e.a)(this,this.tna,"onConnectionStateChanged"))}tna(da,qa){this.jya=qa.newState;2===qa.newState&&(this.iSb=0)}ASc(){let da;da=this.Uib.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Uib.Q5,ma.iXd,J.a.Ne(da)),correlationId:da}}H9d(da,
qa,F,sa,ia){this.K7k(()=>{sa(ia,"GetMachineIdSuccess")&&(h.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.QA,this.$r),da(this.Xnf),F(this.umj()))},Na=>{sa(ia,"GetMachineIdFailure")&&(h.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.$r),qa(Na))},sa,ia)}X_d(){this.pFf();this.iCj()}K7k(da,qa,F,sa){h.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.QA);this.QA?da():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(da,qa,F,sa)},this.doi())}sendFindSessionRequestToServerInternal(da,qa,F,sa){F(sa,"RequestMachineId")&&(this.Tgf=(new Date).getTime(),F=y.a.uj(),this.D1f(ia=>{const Na=y.a.uj();this.fhd(ia);this.LVe();da();ia=y.a.uj()-Na;h.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ia)},ia=>{const Na=y.a.uj();this.pFf();D.FrequentLoggingMetrics.instance&&D.FrequentLoggingMetrics.instance.fH(2,3);qa(ia);
ia=y.a.uj()-Na;h.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ia)},!1),F=y.a.uj()-F,h.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",F))}iCj(){this.rnb+=ma.qcj;this.rnb=Math.min(this.rnb,ma.Qkk)}doi(){let da=this.Tgf+this.rnb-(new Date).getTime();0>da&&(da=0);return da}fhd(da){try{this.Uib=da,this.bna=da.nHf,this.QA=da.QA,this.FHf=da.Q5,this.Xnf=da.I0b}catch(qa){h.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",
qa.toString())}}pFf(){this.QA=null;this.qFf()}LVe(){this.qFf();this.IAc=!0;this.eif=window.setTimeout(Object(e.a)(this,this.WSk,"refreshMachineId"),this.UPe)}qFf(){this.IAc&&(window.clearTimeout(this.eif),this.IAc=!1)}WSk(){this.IAc=!1;this.D1f(da=>{const qa=this.FHf!==da.Q5,F=this.QA!==da.QA,sa=this.QA;this.fhd(da);0!==this.jya&&(F?(h.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",sa||"null",da.QA),this.rl.pkd()):(this.rl.aPk(qa,F),this.LVe()))},
()=>{D.FrequentLoggingMetrics.instance&&D.FrequentLoggingMetrics.instance.fH(2,3);this.LVe()},!0)}z1k(){this.rnb=ma.deg}umj(){return new N.a(this.Uib.Dcd,this.Uib.Acd,this.Uib.zcd,this.Uib.ZUc)}uxl(da){if(Object.getType(da)!==Object)return null;for(let qa in da);return this.rDi(da)}rDi(da){if(!(z.a.Pzb in da))return null;const qa=da[z.a.Pzb];var F=qa?this.GZh:this.FZh;for(const sa of F)if(!(sa in da))return null;F=Object.assign(new S.a,{J$b:da[z.a.Pzb],errorMessage:da[z.a.errorMessage],correlationId:G.a.create().toString()});
qa&&(F.I0b=da[z.a.mZe],F.Q5=da[z.a.Q5],F.QA=da[z.a.QA],F.ZUc=da[z.a.Fae],F.zcd=da[z.a.egb],F.Acd=da[z.a.XLa],F.Dcd=da[z.a.ggb]);return F}H9i(da,qa){h.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.uSb.hYi.continueWith(()=>{this.uSb.hYi.result?(h.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),da(this.uSb.iYi)):(h.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),qa(this.uSb.iYi))})}xkh(da,
qa,F,sa,ia=!1){return Na=>{O.a.instance.Pnc(0,1);da&&da.stop();this.NQb=this.QKb=null;this.Nqg(Na.data,!0,qa);var Ca=X.RtcUtils.deserialize(Na.data.Sd,"FindSession",null);if(Ca)if(Ca=this.uxl(Ca)){if(Ca.J$b&&Ca.Q5&&Ca.QA){h.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.$r);this.U1j(Na.data);F(Ca);return}qa.FindSessionFailureReason="FindSessionInvalidResponse";qa.IsRtcEnabled=Ca.J$b;qa.IsQueryStringEmpty=!Ca.Q5;qa.IsConnectionStringEmpty=!Ca.QA;h.ULS.sendTraceTag(4290720,
500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.$r,Ca.J$b,!Ca.Q5,!Ca.QA)}else qa.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",h.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.$r);else qa.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",h.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",
this.$r);this.ueh(qa,ia);sa(null)}}pkh(da,qa,F,sa=!1){return ia=>{O.a.instance.Pnc(0,1);da&&da.stop();this.NQb=this.QKb=null;this.Nqg(ia.data,!1,qa);let Na=null;var Ca="unknown";let ha="unknown";ia.data&&((Ca=ia.data.sj)&&ma.lpc in Ca&&(Na=Ca[ma.lpc].toString()),Ca=E.a[ia.data.status],ha=ia.data.oe.toString());qa.FindSessionFailureReason="FindSessionRequestFailed";qa.HttpErrorCode=ha;qa.HttpErrorStatus=Ca;qa[ma.lpc]=Na;h.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
Ca,ha,this.$r,Na,sa);this.ueh(qa,sa);F(ha)}}D1f(da,qa,F=!1){let sa=null;h.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.$r);const ia={};var Na=this.Lbf.$0i();ia[A.a.FCa]=G.a.create().toString();this.QKb&&""!==this.QKb?Na=String.format("{0}&{1}={2}",Na,ca.a.fTe,this.QKb):this.NQb&&""!==this.NQb&&(Na=String.format("{0}&{1}={2}",Na,ca.a.fTe,this.NQb),ia[fa.pIl]="True",ia[fa.qXj]="True");Na=this.wRh+"?"+Na;F&&(ia[aa.jYi]=V.PQk);const Ca={};Ca.IsNetworkOfflineBeforeSendRequest=
this.Xh.uFa;Ca.HasAvailableConnectionsBeforeSendRequest=this.Xh.Mag;Ca.MaxConnectionsAllowed=this.Xh.gYg;Ca.IsRefreshMachineId=F;this.uSb&&!this.Mbf?(this.H9i(this.xkh(null,Ca,da,qa,F),this.pkh(null,Ca,qa,F)),this.Mbf=!0):(this.Yh&&(sa=this.Yh.Ci("WebServiceCall","GetMachineIdFromTheServer")),D.FrequentLoggingMetrics.instance&&D.FrequentLoggingMetrics.instance.fH(2,0),0>this.Xh.ZV(Na,1,null,ia,[ma.fLc,ma.lpc,ma.Djc,ma.dTe,ma.UZg,ma.O0g,ma.N0g],1,this.xkh(sa,Ca,da,qa,F),this.pkh(sa,Ca,qa,F),null,null,
!1,null,this.i4b,"3",null,!0)&&(5<this.iSb&&200>this.iSb&&h.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.iSb),window.setTimeout(()=>{this.iSb++;qa("-1")},1E3)))}Nqg(da,qa,F){F||(F={});F.IsNetworkOfflineAfterRequestComplete=this.Xh.uFa;F.IsRequestSucceeded=qa;da&&(F.EnqueueTime=da.yI,F.InvokedTime=da.Xt,F.CompletedTime=da.pv,da.sj&&(ma.fLc in da.sj&&(F.CorrelationId=da.sj[ma.fLc]),ma.Djc in da.sj&&(F[ma.Djc]=
da.sj[ma.Djc])));h.ULS.sendTraceTag(38633565,500,qa?50:15,X.RtcUtils.PGb(F))}ueh(da,qa){da||(da={});da.ConnectionState=m.a[this.jya];qa||this.rl.teh(1,da)}U1j(da){try{var qa=!1,F=!1,sa=da.sj,ia=v.a.YD(da.request.get_url());if(sa&&ma.dTe in sa){const va=sa[ma.dTe].toString().toLocaleLowerCase();F="true"===va;qa="false"===va}sa=!1;const Ba=0<=ia.toLocaleLowerCase().indexOf("collab");F&&!Ba?sa=!0:qa&&Ba&&(sa=!0);if(sa){qa={};qa.HostName=ia;qa.Status=E.a[da.status];qa.HttpStatus=da.oe.toString();var Na=
da.request.get_headers();for(let va in Na){var Ca=Na[va];(ia=va)&&0<ia.length&&(F=0,Ca&&(F=Ca.toString().length),qa["r_"+ia]=F)}if(da.sj){const va=new n.a;va.add(ma.fLc);va.add(ma.Djc);va.add(ma.lpc);va.add(ma.O0g);va.add(ma.N0g);va.add(ma.UZg);ma.b7h(qa,da.sj,va)}ma.X6h(da.request.get_url(),qa);var ha=u.a.toJSON(qa);h.ULS.sendTraceTag(559437006,500,15,ha)}}catch(Ba){h.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",Ba.toString())}}static createInstance(da,qa,F,sa,ia,Na,
Ca,ha,Ba,va,ta,Fa=null){return ma.HLc(da,qa,F,sa,ia,Na,Ca,ha,Ba,va,null,ta,Fa)}static gEi(da,qa,F,sa,ia,Na,Ca,ha,Ba,va,ta=null){return ma.HLc(da,qa,F,sa,ia,3,Na,Ca,ha,Ba,va,ta,null)}static HLc(da,qa,F,sa,ia,Na,Ca,ha,Ba,va,ta,Fa,pa=null){da=da||G.a.create().toString();da=new ma(da,qa,F,sa,ia,Na,Ca,ha,Ba,va,ta,Fa,pa);da.init();return da}static b7h(da,qa,F){for(let sa of F)sa in qa&&(da[sa]=qa[sa])}static X6h(da,qa){if(da){var F=da.indexOf("?");if(-1!==F)for(da=da.substr(F+1).split("&"),F=0;F<da.length;++F){var sa=
da[F].split("=");if(2===sa.length){const ia=sa[0];if(ia&&0<ia.length){let Na=0;if(sa=sa[1])Na=sa.length;qa["q_"+ia]=Na}}}}}}ma.qcj=3E3;ma.Qkk=3E5;ma.Vti="1.0";ma.deg=1E3;ma.fLc="X-CorrelationId";ma.iXd="corrid";ma.lpc="RtcErrorCode";ma.Djc="X-OfficeCluster";ma.dTe="X-NewEnv";ma.UZg="X-MSEdge-Ref";ma.N0g="X-OFFICEFD";ma.O0g="X-OfficeFE";Object(I.a)(ma,"FindSessionStrategy",null,[1240])},728:function(I,Y,d){I=d(0);class h{constructor(){this.I8e=this.Ryd=!1;this.callback=null}Pjc(n){this.callback=n;
this.QCh()}GXg(n){this.Ryd||(this.Ryd=!0,this.TOh=n,this.QCh())}QCh(){this.Ryd&&this.callback&&!this.I8e&&(this.I8e=!0,this.callback(this.TOh))}}Object(I.a)(h,"CompletionTask",null,[]);d.d(Y,"a",function(){return e});class e{constructor(){this.Fif=new h;this.Dif=new h}tfd(n){this.Fif.Pjc(n)}sfd(n){this.Dif.Pjc(n)}Aic(n){this.Fif.GXg(n)}zYa(n){this.Dif.GXg(n)}GDe(){this.Aic(2);this.zYa(2)}}Object(I.a)(e,"MessageStatus",null,[1379])},988:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;
(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(h||(h={}));Object(I.b)("ChannelConnectionState",h)},989:function(I,Y,d){d.r(Y);d.d(Y,"MaxOutstandingThrottler",function(){return m});I=d(0);var h=d(14),e=d(78);Y=d(990);var n=d(728);class m extends Y.a{constructor(z,B=""){super(z,B);this.egb=this.XLa=0;this.Pa=new e.a;this.Eob=!1;this.rBc=this.fxc=this.Nwc=this.lMd=0;this.JEc=[];this.clearTimeout=m.BZd}add(z){this.Fob||this.init(m.PMf,m.EMf);
this.u5a++;const B=new n.a;this.Czb?this.opd(z,B):this.rBc<this.egb?this.Kpc(z,B):(this.opd(z,B),this.Eob=!1);return B}Kpc(z,B){z=this.Tnf(z);const v=this.setTimeout(Object(h.a)(this,this.avk,"onMessageWaitTimeExpired"),this.XLa);++this.rBc;Array.add(this.JEc,v);const y=this.Nwc;z.tfd(A=>{B.Aic(A)});z.sfd(A=>{this.Nwc===y&&(this.$uk(y,v),B.zYa(A))})}$uk(z,B){this.Nwc===z&&(--this.rBc,this.clearTimeout(B),Array.remove(this.JEc,B),this.Czb&&this.r8k())}r8k(){this.Czb&&!this.Eob&&(this.lMd=this.setTimeout(Object(h.a)(this,
this.s8k,"sendThrottledMessageFromTimer"),0),this.Eob=!0)}s8k(){this.Eob=!1;if(this.Czb){const z=this.FEc,B=this.Aqb;this.$_b(!1);this.Kpc(z,B)}}avk(){++this.fxc;this.fxc>Math.floor(this.egb/2)&&(this.fxc=-1E9,this.Pa.raiseEvent("TMUDM"))}KGc(z){this.Pa.addHandler("TMUDM",z)}reset(){this.u5a=this.vXb=this.TRb=this.fxc=0;++this.Nwc;for(const z of this.JEc)this.clearTimeout(z);this.rBc=0;this.JEc=[];this.$_b(!0);this.Eob&&(this.clearTimeout(this.lMd),this.lMd=0,this.Eob=!1)}init(z,B){this.Fob||(this.XLa=
z,this.egb=B,this.Fob=!0)}static createInstance(z,B=""){return new m(z,B)}static BZd(z){window.clearTimeout(z)}}m.PMf=15E3;m.EMf=5;Object(I.a)(m,"MaxOutstandingThrottler",Y.a,[1375,1376])},990:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(387);class e{constructor(n,m=""){this.TRb=this.vXb=0;this.MDd=!1;this.Aqb=this.FEc=null;this.Fob=!1;this.Tnf=n;this.LBh=m;this.setTimeout=e.LZd;this.u5a=this.vXb=this.TRb=0}KPe(){0<this.u5a&&0<this.TRb&&h.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",
this.LBh,this.TRb,this.u5a);0<this.u5a&&0<this.vXb&&h.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.LBh,this.vXb,this.u5a)}get Czb(){return this.MDd}opd(n,m){this.vXb++;this.$_b(!0);this.MDd=!0;this.FEc=n;this.Aqb=m}$_b(n){this.MDd=!1;this.Aqb&&n&&(this.TRb++,this.Aqb.GDe());this.Aqb=this.FEc=null}static LZd(n,m){return window.setTimeout(n,m)}}Object(I.a)(e,"ThrottlerBase",null,[])},991:function(I,Y,d){d.r(Y);d.d(Y,"MaxRateThrottler",function(){return n});
I=d(0);var h=d(14);Y=d(990);var e=d(728);class n extends Y.a{constructor(m,z=""){super(m,z);this.ggb=0;this.oUb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(m){this.Fob||(this.ggb=m,this.Fob=!0)}add(m){this.Fob||this.init(n.yMf);this.u5a++;const z=this.currentTime(),B=new e.a;this.oUb>z&&(this.oUb=z);this.Czb?(this.$_b(!0),this.opd(m,B)):this.oUb+this.ggb<=z?this.Kpc(m,B):(this.opd(m,B),this.setTimeout(Object(h.a)(this,this.q8k,"sendThrottledMessage"),this.oUb+this.ggb-z));
return B}q8k(){if(this.Czb){const m=this.FEc,z=this.Aqb;this.$_b(!1);this.Kpc(m,z)}}Kpc(m,z){this.oUb=this.currentTime();m=this.Tnf(m);m.tfd(B=>{z.Aic(B)});m.sfd(B=>{z.zYa(B)})}static createInstance(m,z=""){return new n(m,z)}}n.yMf=200;Object(I.a)(n,"MaxRateThrottler",Y.a,[1377,1376])},992:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n,m,z){super();this.type=e;this.Eza=n;this.PKi=m;this.MLa=z}}Object(I.a)(h,"SendUpdateNotificationEventArgs",Sys.EventArgs,
[])},993:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.fTe="rr";h.X3k="rd";h.T3k="rbp";h.rUe="sa";Object(I.a)(h,"RtcReconnectParams",null,[])},994:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.ggb="throttling_messageDelay";h.Pzb="enabled";h.XLa="throttling_timeToWaitForResponse";h.egb="throttling_maxNumberOfOutstandingMessages";h.Fae="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.mZe="url";h.Q5="queryString";h.QA="connectionString";
Object(I.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[])},995:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.ZUc=this.zcd=this.Acd=this.Dcd=0;this.J$b=!1;this.correlationId=this.QA=this.Q5=this.I0b=this.errorMessage=null}get nHf(){return this.I0b+"?"+this.Q5}}Object(I.a)(h,"FindSessionResponse",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.presence1.js.map