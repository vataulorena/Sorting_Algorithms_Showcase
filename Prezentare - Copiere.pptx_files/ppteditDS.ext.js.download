/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1E3:function(I,Y,d){d.r(Y);I=d(0);var h=d(78),e=d(47),n=d(93),m=d(67),z=d(27),B=d(1199),v=d(14),y=d(18),A=d(87),E=d(347),u=d(28),J=d(35);class G{constructor(Xa){this.ApiType=0;this.ApiType=Xa}}Object(I.a)(G,"SlideshowApiMessage",null,[]);class S extends G{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(I.a)(S,"DockSlideshowViewMessage",G,[]);class P extends G{constructor(){super(6);
this.AnimStep=this.SlideIndex=0}}Object(I.a)(P,"GoToSlideApiMessage",G,[]);class Q extends G{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(I.a)(Q,"GoToSlideWithTimeLinesApiMessage",G,[]);class D extends G{constructor(){super(19);this.Color=this.Item=null}}Object(I.a)(D,"InkManagerMessage",G,[]);class O{constructor(Xa){this.vH=Xa.origin;this.cUg=Xa.source;this.ova=Xa.data}}Object(I.a)(O,"MessageEvent",null,[]);var X=d(941),N=d(939),aa=d(942),V=d(943);class ca extends Sys.EventArgs{constructor(Xa){super();
this.Z$b=Xa.IsStartTranscription;this.Tv=Xa.SubtitlesPosition}}Object(I.a)(ca,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class fa extends Sys.EventArgs{constructor(Xa){super();this.Mx=Xa.SessionTelemetry}}Object(I.a)(fa,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ma=d(946),da=d(947),qa=d(944);class F extends Sys.EventArgs{constructor(Xa,Hb){super();this.$Ij=Xa;this.category=Hb.Category;this.code=Hb.Code;this.message=Hb.Message;this.Vy=Hb.ExtraInfo;this.correlationId=
Hb.CorrelationId;this.sessionId=Hb.SessionId}}Object(I.a)(F,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var sa=d(940);class ia extends Sys.EventArgs{constructor(Xa){super();this.isFinal=Xa.IsFinal;this.FCh=Xa.Transcripts}}Object(I.a)(ia,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Na=d(948),Ca=d(945);class ha extends Sys.EventArgs{constructor(Xa){super();this.errorName=Xa.ErrorName;this.vetoName=Xa.VetoName;this.isIntentional=Xa.IsIntentional;this.isInternal=Xa.IsInternal;this.alertOnPillar=
Xa.AlertOnPillar;this.isSessionEndingError=Xa.IsSessionEndingError;this.durationMs=Xa.DurationMs}}Object(I.a)(ha,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class Ba extends G{constructor(){super(11);this.StartSlideShowTime=0}}Object(I.a)(Ba,"RecordStartedSlideShowTimestampApiMessage",G,[]);class va extends G{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(I.a)(va,"RefreshPodSessionApiMessage",G,[]);class ta extends G{constructor(){super(21);this.IsMute=!1}}Object(I.a)(ta,"SetMicrophoneStateMessage",
G,[]);class Fa extends G{constructor(){super(12);this.OsfLocalStorageData=null}}Object(I.a)(Fa,"SetOsfLocalStorageApiMessage",G,[]);class pa{constructor(){this.Z$b=this.Mjg=!1;this.Tv=null}}Object(I.a)(pa,"SlideShowViewDockingState",null,[]);var ka=d(1003);class Ha extends G{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=
null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(I.a)(Ha,"StartSlideShowApiMessage",G,[]);class Ya extends G{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(I.a)(Ya,"ToggleTranscriberLiveBroadcastModeMessage",
G,[]);class Ka extends G{constructor(){super(18);this.HideUI=!1}}Object(I.a)(Ka,"ToggleTranscriberUIVisibilityMessage",G,[]);class Pa extends G{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(I.a)(Pa,"TranscribeApiMessage",G,[]);var Oa=d(72);d.d(Y,"SlideshowFrame",function(){return oa});class oa{constructor(Xa,Hb,Ob,eb,Eb,oc,Sb,qc){this.kb=this.oXa=this.nXa=
this.xva=null;this.va=new h.a;this.HGa=null;this.RBe=this.gUg=!1;this.mf=Hb;this.la=Ob;this.Hc=eb;this.Ub=Eb;this.iO=oc;this.Ll=Sb;this.YBb=qc;this.Hak=new B.a(Object(v.a)(Xa,Xa.tji,"browserSupportsRenderingSVGInWebGL"))}init(Xa,Hb,Ob){if(!this.kb){this.xva=document.getElementById("HiddenFocusTrapAnchor");this.kb=document.createElement("iframe");this.kb.id="SlideShowHostFrame";this.kb.className="SlideShowHostFrame";this.kb.style.display=Oa.a.Gf;this.kb.setAttribute("allow","microphone; autoplay");
this.HGa=new pa;Ob=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Ne(ResourceStrings.l_EndOfSlideShowMessage),e.a.Ne(Ob),e.a.Ne(Hb)):"";Ob+=String.format(Ob?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Ne(this.la.hostSupportsSessionRefreshEnabled.toString()));Ob+=String.format(Ob?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.Ne(this.la.isInkingInSlideShowEnabled.toString()));Ob+=String.format(Ob?
"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Ne(this.la.lXj.toString()));Ob+=String.format(Ob?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Ne(this.la.Hab.toString()));Ob+=String.format(Ob?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Ne(this.la.qAb.toString()));Ob+=String.format(Ob?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Ne(this.la.oie.toString()));Ob+=String.format(Ob?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",
e.a.Ne(this.la.f$b.toString()));Ob+=String.format("&ImageCachingEnabled={0}",e.a.Ne(this.la.Onl.toString()));Ob+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Ne(this.la.YEk.toString()));Ob+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Ne(this.la.podsLoadSlideShowFrameFromCdn.toString()));Ob+=String.format("&PodsBase={0}",e.a.Ne(this.la.podsWebServiceBase));var eb=this.la.Hfa;this.la.$Ua&&(eb=new E.a(eb),eb.Guc=this.la.$Ua,eb.Hqc=this.la.Bsh,eb.Gqc=this.la.Ash,eb=eb.toString());
var Eb=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Wa(this.la.podsBaseSlideShowFramePath);this.kb.src=Eb?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.kb.src=String.format(this.kb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Xa,e.a.Ne(Hb),e.a.Ne(this.la.pptEditorSlideShowWrsEndpoint),A.a.rlc,eb);u.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",Eb,this.la.hla));if(this.la.hla||this.la.kac)this.kb.src=String.format(this.kb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",
e.a.Ne(this.la.pptEditorTranscriberJsUri),e.a.Ne(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Ne(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Ne(this.la.pptEditorSpeechHandlerBaseUri)),this.kb.src=String.format(this.kb.src+"&SpeechResponseMessageJS={0}",e.a.Ne(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.qg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.kb.src=String.format(this.kb.src+"&QualityStatusMessageJS={0}",
e.a.Ne(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.kac&&e.a.qg(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.kb.src=String.format(this.kb.src+"&RehearsalResultMessageJS={0}",e.a.Ne(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.qg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.kb.src=String.format(this.kb.src+"&AgentCommandMessageJS={0}",
e.a.Ne(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.kb.src+="&wdLiveBroadcast=true");this.kb.src=String.format(this.kb.src+"#{0}",Ob);J.a("PresenterCoachTabFix")&&this.xva?this.mf.insertBefore(this.kb,this.xva):this.mf.appendChild(this.kb);n.a.addHandler(window,m.a.message,Object(v.a)(this,this.gyk,"onSlideshowMessage"));this.Hc.tvb&&this.la.wid&&this.u0j();J.a("PresenterCoachTabFix")&&(this.nXa=document.getElementById("legacySlideshowBeginningFocusTrap"),
this.oXa=document.getElementById("legacySlideshowEndFocusTrap"),this.nXa||this.oXa||(this.nXa=document.createElement("div"),this.nXa.id="legacySlideshowBeginningFocusTrap",this.nXa.className="FocusTrap",this.nXa.tabIndex=0,n.a.addHandler(this.nXa,m.a.focus,Object(v.a)(this,this.Akc,"onSlideShowContainerDivFocusHandler")),this.oXa=document.createElement("div"),this.oXa.id="legacySlideshowEndFocusTrap",this.oXa.className="FocusTrap",this.oXa.tabIndex=0,n.a.addHandler(this.oXa,m.a.focus,Object(v.a)(this,
this.Akc,"onSlideShowContainerDivFocusHandler")),this.mf.insertBefore(this.nXa,this.mf.firstChild),this.mf.insertBefore(this.oXa,this.xva.nextSibling)))}}H8a(){return this.la.wid&&this.RBe}myk(){u.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.gUg=!0;return null}u0j(){const Xa=new y.a;Xa.add(this.YBb.loadScript("PPTSpeechClient"));Promise.all(Xa.toArray()).then(()=>this.myk()).catch(Hb=>{u.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",
Hb)})}jrd(Xa,Hb,Ob,eb,Eb,oc,Sb,qc,$a){this.HGa=new pa;Sb&&u.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",qc));this.gG(Object.assign(new Ha,{WacCluster:Ob,PodSessionId:eb,UserId:Eb,WacUserSessionId:oc,SlideId:Xa,SlideIndex:Hb,FPrerenderSS:Sb,PrerenderCid:qc,SlideShowClickTime:$a,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.Hak.value?"1":"0",RenderShapeBuilder:this.la.$Ua?"1":"0",FileHost:z.AFrameworkApplication.fa.Ga("FileHost"),
VetoAppSettingsStr:this.Ynj(),DisabledTransitionsList:this.la.cMa,CustomTransitionResourceUrl:this.la.aMf,StreamVideoUseThinEmbed:z.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:z.AFrameworkApplication.fa.Ga("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:z.AFrameworkApplication.Hia,AllowExternalMarketplace:z.AFrameworkApplication.fa.ka("51")}))}prev(){this.gG(new G(2))}next(){this.gG(new G(1))}transcribe(Xa,Hb,Ob,eb,Eb,oc,Sb){var qc=!!this.Ub&&!!this.Ub.instance&&
(this.Ub.instance.dSa||this.Ub.instance.dr);(this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.ADa||qc)&&!this.Ub.instance.xvb()?u.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.H8a()?(ka.a.instance.transcribe(Xa,Hb,Ob,eb,Eb,oc,Sb),this.KNc(this.Hc.Kh&&5!==Eb,this.Hc.Tv)):(qc={},qc.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",qc.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.la.powerPointLiveBroadcastEnabled?
!0:!1,this.gG(Object.assign(new Pa,{SubtitlesAppSettingsStr:this.alj(Xa,Ob,Hb,eb,Eb,oc),SubtitlesContextStr:this.Hc.Drl,SubtitlesResourceStr:this.blj(),RehearsalContextStr:Sb?Sb.IVk:"",LiveBroadcastContextStr:JSON.stringify(qc),MicrophoneDeviceId:this.iO.microphoneDeviceId})))}setMicrophoneState(Xa){this.H8a()?ka.a.instance.setMicrophoneState(Xa):(this.gG(Object.assign(new ta,{IsMute:Xa})),this.Ub&&this.Ub.instance&&(Xa?this.Ub.instance.xqh():this.Ub.instance.yqh()))}vOb(Xa,Hb=""){this.HGa.Mjg=Xa;
u.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.H8a()?(ka.a.instance.lCh(Xa,Hb),this.KNc(this.Hc.Kh,this.Hc.Tv)):this.gG(Object.assign(new Ya,{IsToggleOn:Xa,PragueSessionInfo:Hb}));this.J2g()}toggleTranscriberUIVisibility(Xa){u.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.H8a()?(Xa=Xa?Xa?!1:!0:!ka.a.instance.isVisible(),ka.a.instance.setVisibility(Xa),ka.a.instance.SGc(),this.KNc(this.Hc.Kh,this.Hc.Tv)):this.gG(Object.assign(new Ka,
{HideUI:Xa}))}KNc(Xa,Hb){this.HGa.Z$b=Xa;this.HGa.Tv=Hb;this.J2g()}setOsfLocalStorage(){const Xa={};let Hb=!1;try{const Ob=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let eb=0;eb<localStorage.length;++eb){const Eb=localStorage.key(eb);if(Ob.test(Eb)){const oc=localStorage.getItem(Eb);Xa[Eb]=oc;Hb=!0}}}catch(Ob){u.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",Ob.toString())}Hb&&this.gG(Object.assign(new Fa,{OsfLocalStorageData:Xa}))}show(){u.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.kb){this.kb.style.display=Oa.a.Wk;var Xa=(new Date).getTime();u.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Xa);this.gG(Object.assign(new Ba,{StartSlideShowTime:Xa}))}else u.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}mbb(){return this.kb&&this.kb.style.display!==Oa.a.Gf?!0:!1}N8(){return"Legacy"}wtc(Xa){this.kb.style.display=Xa?Oa.a.Wk:
Oa.a.Gf;this.H8a()&&ka.a.instance.setVisibility(Xa&&this.Hc.Kh)}WQc(){u.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.gG(new G(3))}exit(){this.kb.style.display===Oa.a.Gf?this.va.raiseEvent("OnExit",new N.a({SlideId:0,IsBeforeReady:!0})):(u.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.kb.style.display=Oa.a.Gf,this.gG(new G(3)));this.H8a()&&ka.a.instance.v_e()}restoreFocus(){this.kb.style.display===Oa.a.Gf||this.pje()||(this.kb.focus(),this.gG(new G(4)))}pausePresentation(){this.gG(new G(15))}f2e(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.gG(new G(5))}getCurrentPositionWithTimeLines(){this.gG(new G(17))}getCurrentSlideDimensions(){this.gG(new G(20))}tTa(Xa){this.gG(Object.assign(new P,{SlideIndex:Xa,AnimStep:0}))}iLe(Xa){this.gG(Object.assign(new D,{Item:Xa.item,Color:Xa.color}))}EUe(Xa){this.va.raiseEvent("OnSpecialKey",new sa.a({["Key"]:Xa.keyCode,["ShiftKey"]:Xa.shiftKey}))}Qoh(){this.gG(new G(22))}p9f(Xa,Hb){this.gG(Object.assign(new Q,{SlideIndex:Xa,TimeLineMappings:Hb}))}refreshPodSession(Xa,
Hb){this.gG(Object.assign(new va,{PodSessionId:Xa,WacCluster:Hb}))}setVisibility(Xa){this.kb.style.visibility=Xa?Oa.a.Dz:Oa.a.Qs}hga(Xa){this.gG(new G(Xa?9:10));this.H8a()&&ka.a.instance.hga(Xa)}BGc(Xa){this.va.addHandler("OnSlideshowReady",Xa)}rld(Xa){this.va.removeHandler("OnSlideshowReady",Xa)}oPd(Xa){this.va.addHandler("OnBrowserEvent",Xa)}YQe(Xa){this.va.removeHandler("OnBrowserEvent",Xa)}quf(Xa){this.va.addHandler("OnFullscreenClick",Xa)}tih(Xa){this.va.removeHandler("OnFullscreenClick",Xa)}qPd(Xa){this.va.addHandler("OnSlideshowContextMenu",
Xa)}$Qe(Xa){this.va.removeHandler("OnSlideshowContextMenu",Xa)}vPd(Xa){this.va.addHandler("OnPodSessionExpired",Xa)}dRe(Xa){this.va.removeHandler("OnPodSessionExpired",Xa)}GPa(Xa){this.va.addHandler("OnPositionChangeEventId",Xa)}Dib(Xa){this.va.removeHandler("OnPositionChangeEventId",Xa)}Aia(Xa){this.va.addHandler("OnExit",Xa)}Rfa(Xa){this.va.removeHandler("OnExit",Xa)}nuf(Xa){this.va.addHandler("OnSlideshowError",Xa)}qih(Xa){this.va.removeHandler("OnSlideshowError",Xa)}MYb(Xa){this.va.addHandler("OnGetCurrentPosition",
Xa)}Cib(Xa){this.va.removeHandler("OnGetCurrentPosition",Xa)}xGc(Xa){this.va.addHandler("OnGetCurrentSlideDimensions",Xa)}pld(Xa){this.va.removeHandler("OnGetCurrentSlideDimensions",Xa)}CGc(Xa){this.va.addHandler("OnSpecialKey",Xa)}tld(Xa){this.va.removeHandler("OnSpecialKey",Xa)}Duf(Xa){this.va.addHandler("OnVisibilityChangeEventId",Xa)}hRe(Xa){this.va.removeHandler("OnVisibilityChangeEventId",Xa)}tuf(Xa){this.va.addHandler("OnLogEndOfTranscriptionSession",Xa)}vih(Xa){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Xa)}suf(Xa){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Xa)}uih(Xa){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Xa)}sPd(Xa){this.va.addHandler("OnEnterEndOfShowEventId",Xa)}aRe(Xa){this.va.removeHandler("OnEnterEndOfShowEventId",Xa)}uPd(Xa){this.va.addHandler("OnLeaveEndOfShowEventId",Xa)}cRe(Xa){this.va.removeHandler("OnLeaveEndOfShowEventId",Xa)}Auf(Xa){this.va.addHandler("OnSubtitleUpdatedEventId",Xa)}Cih(Xa){this.va.removeHandler("OnSubtitleUpdatedEventId",Xa)}Cuf(Xa){this.va.addHandler("OnTranscriberStartedEventId",
Xa)}Dih(Xa){this.va.removeHandler("OnTranscriberStartedEventId",Xa)}Kuf(Xa){this.va.addHandler("RecordQosErrorEventId",Xa)}Kih(Xa){this.va.removeHandler("RecordQosErrorEventId",Xa)}gyk(Xa){Xa=new O(Xa.rawEvent);if(this.bXj(Xa)){var Hb=this.f3k(Xa.ova),Ob=Hb.EventType;28===Ob&&u.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Xa.ova);switch(Ob){case 23:this.Qed(Hb);break;case 18:this.Ggb(Hb);break;case 6:this.iwk();break;case 11:this.p6g(!1,Hb);break;case 13:this.p6g(!0,
Hb);break;case 2:this.ufa(Hb);break;case 7:this.exa(Hb);break;case 12:this.oxa(Hb);break;case 24:this.fyk(Hb);break;case 26:this.lZa(Hb);break;case 27:this.Ofd(Hb);break;case 29:this.pfd(Hb);break;case 5:this.Qfd(Hb);break;case 30:this.ryk(Hb);break;case 32:this.wgd(Hb);break;case 31:this.ofd(Hb);break;case 19:this.Ned(Hb);break;case 20:this.lfd(Hb);break;case 33:this.Fkd(Hb)}}}bXj(Xa){try{if(Xa.cUg!==this.kb.contentWindow)return u.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Xa.cUg.location.href),!1}catch(Hb){return u.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",Hb.toString()),!1}return!0}f3k(Xa){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Xa)}catch(Hb){let Ob=Hb.toString();J.a("DisableLogPostMsgData")&&(Xa="<redacted>");J.a("DisableLogPostMsgEx")&&(Ob="<redacted>");u.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Xa,Ob)}return{}}iwk(){if(this.la.wid&&this.gUg&&!this.RBe)try{const Xa=(new Date).getTime();ka.a.instance.init(this.la,this.kb.contentDocument.body,this.Hc,this,this.Ll,this.Ub,this.iO);this.RBe=!0;u.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Xa)}catch(Xa){u.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Xa.toString())}u.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}Ggb(Xa){this.va.raiseEvent("OnBrowserEvent",new X.a(Xa))}Qed(Xa){u.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");u.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.kb.style.display=Oa.a.Gf;this.va.raiseEvent("OnExit",new N.a(Xa))}ufa(Xa){u.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new aa.a(Xa))}exa(Xa){u.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new V.a(Xa))}p6g(Xa,Hb){this.va.raiseEvent("OnSlideshowError",new F(Xa,Hb))}oxa(Xa){Xa=new sa.a(Xa);u.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Xa.key);this.va.raiseEvent("OnSpecialKey",Xa)}fyk(Xa){u.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new qa.a(Xa))}lZa(Xa){u.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new Ca.a(Xa))}Ofd(Xa){u.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new ma.a(Xa))}pfd(Xa){u.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new fa(Xa));this.Hc.zvb=!1}Qfd(Xa){u.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new da.a(Xa))}ryk(Xa){u.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new ia(Xa))}wgd(Xa){u.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new Na.a(Xa));this.Hc.zvb=!0}Akc(){this.restoreFocus()}ofd(Xa){u.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const Hb=new ca(Xa);this.KNc(Hb.Z$b,Hb.Tv);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",Hb)}catch(Hb){u.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
Hb.toString())}}Ned(){u.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}lfd(){u.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}Fkd(Xa){u.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new ha(Xa))}gG(Xa){this.kb&&this.kb.contentWindow&&this.kb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Xa),
"*")}J2g(){var Xa=0,Hb=100;this.HGa.Z$b&&("BelowSlide"===this.HGa.Tv?(Xa=0,Hb=85):"AboveSlide"===this.HGa.Tv&&(Xa=15,Hb=85));Xa=Xa.toString()+"%";Hb=Hb.toString()+"%";this.HGa.Mjg&&(Xa=String.format("calc({0} + {1})",Xa,"26px"),Hb=String.format("calc({0} - {1})",Hb,"26px"));this.gG(Object.assign(new S,{TopValue:Xa,HeightValue:Hb}))}Ynj(){const Xa={};Xa.AnimTranstionMinDurationMs=z.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Xa.AnimTranstionWorstFrameIndex=z.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Xa.AnimTranstionMaxFrameDurationMs=z.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Xa.AnimTranstionMinFPS=z.AFrameworkApplication.fa.Bc("PodSlideShowVetoAnimTranstionMinFPS",24);Xa.NavDurationMs=z.AFrameworkApplication.fa.Bc("PodSlideShowVetoNavDurationMs",1250);Xa.SlideShowEUPLThresholdInMs=z.AFrameworkApplication.fa.Bc("SlideShowEUPLThresholdInMs",6E3);Xa.SlideShowNavigationThresholdInMs=z.AFrameworkApplication.fa.Bc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Xa)}alj(Xa,Hb,Ob,eb,Eb,oc){const Sb=this.la.nHk&&e.a.qg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),qc={};qc.WacUserSessionId=Xa;qc.WacUserDatacenterCluster=Hb;qc.PodSessionId=Ob;qc.DocId=eb;qc.EntryPoint=Eb;qc.StartTime=oc;qc.PodsWebServiceBase=this.la.podsWebServiceBase;qc.TranscriberLoggingIntervalInMS=this.la.cxl;qc.TranscribeRealTimeFactorLowerThreshold=this.la.Zwl;qc.TranscribeRealTimeFactorUpperThreshold=this.la.$wl;qc.IsTranscriberLogEachTranscriptMessage=
this.la.lWj;qc.IsTranscriberContentLoggingEnabled=this.la.iWj;qc.FUseEndpointInWebapp=this.la.oWj;qc.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;qc.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;qc.HeartbeatInterval=5E3;qc.RoundtripLatencyThreshold=1E6;qc.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;qc.FragmentLatencyWarnThreshold=1E6;qc.FragmentLatencyErrorThreshold=1E6;qc.MessageType=this.la.pptEditorTransciberMessageType;
qc.MaxAllowedFragmentLatencyMS=this.la.aFk;qc.DynamicBufferEnabled=this.la.jWj;qc.DefaultBufferSize=this.la.bxl;qc.MaxAllowedFinalFragmentLatencyMS=this.la.$Ek;qc.FSupportSpeechResponseMessage=Sb;qc.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&Sb&&e.a.qg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");qc.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;qc.TranscriberShowListeningDetectionTextInMS=this.la.mHk;
qc.PodTranscriberAudioContextSampleRate=this.la.ZEk;qc.RehearsalGrammarIsEnabled=this.la.zLe;qc.PodRehearsalMonotoneEnabled=this.la.NKe;return JSON.stringify(qc)}blj(){const Xa={};Xa.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Xa.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Xa.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Xa.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Xa.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Xa.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Xa.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Xa.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Xa.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Xa.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Xa.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Xa.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Xa.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Xa.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Xa.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Xa.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Xa.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Xa.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Xa.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Xa.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Xa.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Xa.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Xa.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Xa.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Xa.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Xa.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Xa)}pje(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.qUf}}Object(I.a)(oa,"SlideshowFrame",null,[326])},1001:function(I,Y,d){I=d(0);var h=d(387);class e{}e.taskPaneWidth="TaskPaneWidth";e.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";e.WE="TaskPaneTitle";e.nonPersistedSettings="NonPersistedSettings";e.onTaskPaneClose=
"OnTaskPaneClose";e.E5="OnRenderedCallback";e.dNc="DialogIsModal";e.hNc="DialogShowTitleBar";e.dialogWidth="DialogWidth";e.dialogHeight="DialogHeight";e.dialogLeft="DialogLeft";e.gNc="DialogRight";e.dialogTop="DialogTop";e.bNc="DialogBottom";Object(I.a)(e,"PropertyNames",null,[]);var n=d(27),m=d(14),z=d(18),B=d(965),v;(function(Ib){Ib[Ib.OK=0]="OK";Ib[Ib.notReady=1]="notReady";Ib[Ib.storeDisabled=2]="storeDisabled";Ib[Ib.invokeFailure=3]="invokeFailure"})(v||(v={}));Object(I.b)("AddinDetailsQueryError",
v);class y{constructor(Ib){this.Upb=Ib}next(Ib){this.Upb=(9301*this.Upb+49297)%233280;return Math.floor(this.Upb/233280*Ib)}}Object(I.a)(y,"Random",null,[]);class A{constructor(){this.buttonText=this.buttonId=this.links=this.description=this.title=this.icon=this.buttonCommandId=this.commandId=this.id=null}}Object(I.a)(A,"AddInListItemProps",null,[]);class E{constructor(){this.text=this.href=null}}Object(I.a)(E,"AddInListLinkProps",null,[]);var u=d(933),J=d(216),G=d(932),S=d(585),P=d(1131),Q=d(1127),
D=d(315),O=d(273),X=d(193),N=d(47);class aa{constructor(Ib,gc,Ta,Ab,kc,fb=null){this.vAa={};this.MSb={};this.dob=0;this.jlf=!1;this.kQb=0;this.Ocf=!1;this.rof=!0;this.Caf=0;this.Dmb=gc;this.NV=null;this.hVh=Ta;this.jVh=Ab;this.n_h=kc;this.$a=fb||n.AFrameworkApplication.fa;Ib=this.SSj?Object(m.a)(this,this.hGe,"onAddinDetailsRefreshed"):Object(m.a)(this,this.Bgh,"registerIcons");this.Dmb.HUk(Ib);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1));appChrome.addInApi.loadOfficeAddInIcons()}get oIf(){return this.MSb}Bgh(Ib,
gc){if(gc.R7)for(Ib=0;Ib<gc.R7.length;Ib++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+gc.R7[Ib].solutionId,gc.R7[Ib].iconUrl);else h.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get SSj(){return!!this.$a&&this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.FlyoutGeneratorRefactorEnabled")}get pke(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}ghl(Ib){0===Ib.krb&&(this.kQb|=
1);1===Ib.krb&&(this.kQb|=2);return!!this.kQb}hGe(Ib,gc){this.Bgh(Ib,gc);this.ghl(gc)&&(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.$a.isChangeGateEnabled("OfficeVSO:7611216_UnderstandDataProvider")&&h.ULS.sendTraceTag(509224609,220,50,"UnderstandDataProvider, Flyout button enabled, collectionType: {0}",B.a[gc.krb]),this.$a&&this.$a.isChangeGateEnabled("OverflowTelemetryForAddinButton")&&this.t3j())}fEf(){let Ib=this.Dmb.S4b(0);if(1!==Ib.errorCode)return!0;
Ib=this.Dmb.S4b(1);return 1!==Ib.errorCode}CEk(Ib){const gc=[];var Ta=new y((new Date).getDate());for(var Ab=0;8>Ab;Ab++)Array.add(gc,Ta.next(Ib.count));Ta=0;for(let kc of Ib){Ab=!1;for(const fb of gc)if(Ta===fb){Ab=!0;break}Ta++;if(Ab){let fb;(fb=kc.addinInfo).AUP=20*fb.AUP}else if(1===kc.addinInfo.priority){let fb;(fb=kc.addinInfo).AUP=4*fb.AUP}else if(2===kc.addinInfo.priority){let fb;(fb=kc.addinInfo).AUP=2*fb.AUP}}Ib.Sc((kc,fb)=>kc.addinInfo.AUP<fb.addinInfo.AUP?1:-1);return Ib}DEk(Ib){for(let gc of Ib)if(1===
gc.addinInfo.priority){let Ta;(Ta=gc.addinInfo).AUP=4*Ta.AUP}else if(2===gc.addinInfo.priority){let Ta;(Ta=gc.addinInfo).AUP=2*Ta.AUP}Ib.Sc((gc,Ta)=>gc.addinInfo.AUP<Ta.addinInfo.AUP?1:-1);return Ib}pYd(Ib,gc){const Ta={};Ta.width=Ib;Ta.height=gc;Ta.backgroundColor="transparent";return Ta}VXd(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word",
"text-overflow":"ellipsis"}}HSc(){const Ib={},gc={},Ta={};gc.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};gc.inner={margin:"-4px"};Ta.root=this.pYd(100,100);Ta.flexContainer={flexDirection:"column"};Ta.label=this.VXd();Ib.galleryButtonInExpanded=Ta;Ib.galleryStack=gc;return Ib}U1i(){return Object.assign(new Q.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"QuickSearchNoCategories_16",Command:this.n_h,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,
FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}ewb(Ib,gc,Ta){Ib=Object.assign(new Q.a,{Id:Ta,ExternalId:Ta,Icon:"AddinFlyoutControl"+gc.solutionId,Command:Ib===CommonUIStrings.l_PopularAddins?this.hVh:this.jVh,LabelText:gc.displayName,FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",
overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},Alt:gc.displayName});this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)&&(Ib.Alt=gc.description);return Ib}LFk(Ib,gc,Ta){const Ab=Object.assign(new P.a,{SectionId:Ib,Title:Ib,GalleryButtons:[]});for(let kc=0;kc<Ta;kc++)Array.add(Ab.GalleryButtons,this.ewb(Ib,gc[kc],this.vAa[gc[kc].solutionId]));return Ab}$5b(){var Ib=[];const gc=this.Dmb.S4b(0);Array.addRange(Ib,gc.R7);const Ta=this.Dmb.S4b(1);
Array.addRange(Ib,Ta.R7);let Ab=Ib.length;this.Caf=0<Ab?5:6;n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&h.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",Ab,v[gc.errorCode],gc.R7.length,v[Ta.errorCode],Ta.R7.length);Ib.sort((tb,Bc)=>{tb=X.d(tb.displayName);Bc=X.d(Bc.displayName);return N.a.localeCompare(tb,Bc)});const kc=6<Ab;kc&&(Ab=5);if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))for(var fb=
0;fb<Ab;fb++)this.pAf(Ib[fb]);else for(fb=0;fb<Ab;fb++)if(!(Ib[fb].solutionId in this.vAa)){var Qb="AddinGalleryButton"+this.dob.toString();this.vAa[Ib[fb].solutionId]=Qb;this.MSb[Qb]=Ib[fb].solutionId;this.dob++}let mb=[];fb=null;if(this.NV)mb=this.NV;else if(fb=this.Dmb.S4b(2),0===fb.errorCode)if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))fb.R7.forEach(tb=>{-1!==tb.addinInfo.priority&&(this.pAf(tb),mb.push(tb))});else for(mb=fb.R7,fb=0;fb<mb.length;fb++)mb[fb].solutionId in
this.vAa||(Qb="AddinGalleryButton"+this.dob.toString(),this.vAa[mb[fb].solutionId]=Qb,this.MSb[Qb]=mb[fb].solutionId,this.dob++);fb=!0;mb.length||(fb=!1);Qb=0;if(fb&&(Qb=Ib.length?3>=Ib.length?9:6:12,mb=this.pke?this.Oei(mb,Ib):this.Nei(mb,Ib),Qb>mb.length&&(Qb=mb.length),n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.jlf&&!this.pke)){var Jb="",Ub="";for(let tb=0;tb<mb.length&&tb<Qb;tb++)Jb+=mb[tb].displayName,Jb+=",",Ub+=mb[tb].solutionId,
Ub+=",";h.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",Qb,Jb,Ub);this.jlf=!0}Jb=Object.assign(new O.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Ub=Object.assign(new J.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Jb.ControlList,Ub);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",
CommonUIStrings.l_AddinPickerButtonMore));Jb=Object.assign(new D.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Jb,UpdateDynamically:!0});2!==gc.errorCode||Ib.length?3===gc.errorCode||3===Ta.errorCode?(h.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),Ib=this.OYf("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Jb.MenuSectionList,Ib)):(0<Ab&&this.gJf(Jb,Ib,Ab,"MRUAddins",CommonUIStrings.l_MyAddinSection,kc),fb&&(this.pke?Array.add(Jb.MenuSectionList,
this.R1i(mb,this.Caf)):this.gJf(Jb,mb,Qb,"PopularAddins",CommonUIStrings.l_PopularAddins))):(h.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),Ib=this.OYf("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Jb.MenuSectionList,Ib));return Jb}R1i(Ib,gc){const Ta=Object.assign(new O.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[]}),Ab=Object.assign(new u.a,{Id:"PopularAddInsList",ExternalId:"PopularAddInsList",Items:[]});for(let kc=
0;kc<0+gc&&kc<Ib.length;kc++)this.a1i(Ab.Items,Ib[kc]);Array.add(Ta.ControlList,Ab);return Ta}a1i(Ib,gc){const Ta=[];var Ab=Object.assign(new E,{text:CommonUIStrings.l_AddinListPrivacy,href:gc.privacyUrl});Array.add(Ta,Ab);Ab=Object.assign(new E,{text:CommonUIStrings.l_AddinListLicense,href:gc.licenseUrl});Array.add(Ta,Ab);Ab=Object.assign(new E,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+gc.solutionId});Array.add(Ta,Ab);gc=Object.assign(new A,
{id:this.vAa[gc.solutionId],icon:"AddinFlyoutControl"+gc.solutionId,title:gc.displayName,description:gc.description,links:Ta,buttonText:CommonUIStrings.l_AddinListAdd,buttonId:this.vAa[gc.solutionId]+"Add",buttonCommandId:"2882601901",commandId:"1497204054"});Array.add(Ib,gc)}pAf(Ib){if(!(Ib.solutionId in this.vAa)){const gc="AddinGalleryButton"+this.dob.toString();this.vAa[Ib.solutionId]=gc;this.MSb[gc]=Ib.solutionId;this.MSb[gc+"Add"]=Ib.solutionId;this.dob++}}OYf(Ib,gc){const Ta=Object.assign(new O.a,
{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});Ib=Object.assign(new G.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:Ib,Label:gc});Array.add(Ta.ControlList,Ib);return Ta}Nei(Ib,gc){var Ta=new z.a;for(let Ab=0;Ab<Ib.length;Ab++)Ta.add(Ib[Ab]);this.NV||(8<Ta.count&&(Ta=this.CEk(Ta)),this.NV=Ta.toArray());for(Ib=0;Ib<this.NV.length;Ib++)for(Ta=0;Ta<gc.length;Ta++)if(this.NV[Ib].solutionId.toLowerCase()===gc[Ta].solutionId.toLowerCase()){Array.remove(this.NV,this.NV[Ib--]);
break}return this.NV}Oei(Ib,gc){var Ta=new z.a;for(let Ab=0;Ab<Ib.length;Ab++)Ta.add(Ib[Ab]);this.NV||(8<Ta.count&&(Ta=this.DEk(Ta)),this.NV=Ta.toArray());if(this.rof){for(Ib=0;Ib<this.NV.length;Ib++)for(Ta=0;Ta<gc.length;Ta++)if(this.NV[Ib].solutionId.toLowerCase()===gc[Ta].solutionId.toLowerCase()){Array.remove(this.NV,this.NV[Ib--]);break}this.rof=!1}return this.NV}gJf(Ib,gc,Ta,Ab,kc,fb=!1){const Qb=Object.assign(new O.a,{Id:Ab+"Section",ControlsId:Ab+"Section.Controls",ControlList:[]});Ab=Object.assign(new S.a,
{Id:Ab+"GalleryControl",ExternalId:Ab+"GalleryControl",GalleryStyle:this.HSc(),Width:3,Type:4,GallerySections:[]});Array.add(Ib.MenuSectionList,Qb);Array.add(Qb.ControlList,Ab);Ib=this.LFk(kc,gc,Ta);fb&&Array.add(Ib.GalleryButtons,this.U1i());Ab.GallerySections.push(Ib)}Zhd(Ib){if(Ib)try{Ib.MenuItems=this.$5b()}catch(gc){h.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(gc?gc.toString():""))}else h.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}t3j(){if(!this.Ocf&&
this.Ond){var Ib=appChrome.selectors.getSelectedTabId();Ib&&X.a(Ib,"Home")&&((Ib=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(Ib,"").display||h.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.Ocf=!0)}}get Ond(){return!!window.appChrome&&!!appChrome.selectors}}Object(I.a)(aa,"AppsFlyoutGenerator",null,[106]);var V=d(966),ca=d(373),fa=d(209),ma=d(1200);class da{}da.M3b="extId";da.C0b="ComponentType";da.rW="ComponentId";da.Qkc="OptionalProps";
Object(I.a)(da,"ActionPropertyNames",null,[]);var qa=d(37),F=d(42),sa=d(84),ia=d(39);class Na{constructor(){this.idField=null;this.stateField=0}}Object(I.a)(Na,"CT_OsfBackgroundAppData",null,[]);class Ca{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=
!1}}Object(I.a)(Ca,"CT_OsfInsertionInfo",null,[]);var ha=d(52),Ba=d(964),va=d(967),ta=d(333),Fa=d(35),pa=d(30),ka=d(278),Ha=d(182),Ya=d(927),Ka=d(530);class Pa extends Ka.a{constructor(Ib){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ib.paragraphs;this.image=Ib.image;this.imageWidth=Ib.imageWidth;this.imageHeight=Ib.imageHeight}}Object(I.a)(Pa,"TextAboveImage",Ka.a,[]);class Oa{constructor(Ib,gc){this.imageHeight=this.imageWidth=this.image=
this.paragraphs=null;this.paragraphs=Ib;this.image=gc}}Object(I.a)(Oa,"TextAboveImageCustomProps",null,[]);var oa=d(141),Xa=d(1118),Hb=d(929),Ob=d(928),eb=d(351),Eb=d(81),oc=d(133),Sb=d(142),qc=d(172);class $a{constructor(){this.Eak="ClickOnLaunch";this.o7j="ClickOnDismiss";this.egk="Show";this.V8j="BetterEntryPoint_InsertTab";this.ohk=500;this.I9j=280;this.E9j=192;this.T9j="InsertAddInFlyout";this.qfk="RibbonOverflowMenu-overflow";this.pfk="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.n9j=
"[data-unique-id=Home]";this.U9j="InsertAddinTransitionEntry"}NBi(){Object(ka.a)(this,void 0,void 0,function*(){try{let Ib=yield oa.UISurfaces.mL();$a.CEb&&(Ib.removeNotification($a.CEb),$a.CEb=null);let gc=this.pfk,Ta=document.getElementById(this.U9j);const Ab=Ta?window.getComputedStyle(Ta,null):null;if(null==Ta||Ab&&"none"===Ab.display)gc=this.n9j;const kc=CommonUIStrings.l_BetterEntryPointTUI_Title,fb=CommonUIStrings.l_BetterEntryPointTUI_Content,Qb=new Ya.a("https://iriscoremetadataprod.blob.core.windows.net/assets/add-ins_powerpoint_1677568738672.svg"),
mb=new Oa(fb,Qb),Jb=new Pa(mb);Jb.imageWidth=this.I9j;Jb.imageHeight=this.E9j;const Ub=new Xa.a;Ub.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;Ub.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;Ub.onExecute=()=>{this.Euj();this.hea(this.Eak)};const tb=new Xa.a;tb.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;tb.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;tb.onExecute=()=>{Ib.removeNotification($a.CEb);this.hea(this.o7j)};const Bc=new Hb.a;
Bc.onDismiss=()=>{Ib.removeNotification($a.CEb)};Bc.setInitialFocus=!0;const Gb=new Ob.a;Gb.target=gc;Gb.title=kc;Gb.content=Jb;Gb.showCloseIcon=!0;Gb.hasDynamicSizing=!1;Gb.preventLightDismiss=!1;Gb.useTeachingStyles=!0;Gb.primaryButtonProps=Ub;Gb.secondaryButtonProps=tb;Gb.calloutProps=Bc;const Hc=Ib.callout(Gb),$b=new eb.a;$b.onShow=()=>{this.hea(this.egk)};$a.CEb=Ib.addNotification(Hc,$b);return null}catch(Ib){return h.ULS.sendTraceTag(509207556,220,15,"Failed to GetNotificationsAPIAsync: {0}",
Ib),null}})}Euj(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));const Ib=new Eb.a(0,1,this.ohk,()=>{this.ZYj()});oc.a.instance.Db(Ib)}ZYj(){const Ib=document.getElementById(this.T9j),gc=Ib?window.getComputedStyle(Ib,null):null;if(null==Ib||gc&&"none"===gc.display){const Ta=document.getElementById(this.qfk);null!=Ta?(Ta.onclick=function(){const Ab=new Eb.a(0,1,500,()=>{const kc=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=kc?(kc.click(),h.ULS.sendTraceTag(509207555,
220,50,"Launch flyout in overflow")):h.ULS.sendTraceTag(509207554,220,10,"Neither ribbon nor overflow can launch flyout")});oc.a.instance.Db(Ab);Ta.onclick=function(){}},Ta.click()):h.ULS.sendTraceTag(509207553,220,10,"Neither ribbon nor overflow can launch flyout")}else Ib.click(),h.ULS.sendTraceTag(509207552,220,50,"Launch flyout in ribbon button")}hea(Ib){Ib={["AppTeachingUICalloutAction"]:Ib,["AppTeachingUICalloutGoal"]:this.V8j};Sb.a.sendTelemetryEvent(Object.assign(new Ha.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:qc.a.pC(Ib)}))}}$a.CEb=null;Object(I.a)($a,"PPTBetterEntryTeachingCallout",null,[]);d.d(Y,"a",function(){return ab});class ab{constructor(Ib,gc,Ta,Ab,kc,fb,Qb,mb,Jb,Ub,tb,Bc,Gb){this.pBb=0;this.wzg=!1;this.r5j="g_InstallOrigin";this.eUg=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"]]);this.MLg=null;this.Kuj=()=>this.tRd&&!this.Pb.ka("AppsForOfficeThirdPartyIsDisabled")&&this.Dra&&this.Dra.fEf()?32:8;this.nuj=(Hc,$b,
lc,Vb,ic)=>{if(2!==lc)return this.Dra&&this.Dra.fEf()?32:8;if(!this.Dra)return 8;this.Dra.Zhd(ic);return 32};this.etj=(Hc,$b,lc,Vb,ic)=>{if(!this.H4||!ic)return 8;if(1===lc)return this.Jd?32:8;if(!this.Jd)return this.pBb||(this.pBb=window.performance.now()),this.KL.Zia(),this.KL.xPa(Hc,ic),8;Hc=ic[da.M3b];ic=ic[da.Qkc].optionalProperties;$b={};$b.WE=ic.MLh;$b.assetId=Hc.getId();$b.E5=ic.zLh;$b.nonPersistedSettings=ic.$Mc;$b.dNc=ic.ALl;$b.hNc=ic.DLl;$b.dialogWidth=ic.FLl;$b.dialogHeight=ic.zLl;$b.dialogLeft=
ic.BLl;$b.gNc=ic.CLl;$b.dialogTop=ic.ELl;$b.bNc=ic.yLl;this.Jd.H_k($b);return 32};this.cwj=(Hc,$b,lc,Vb,ic)=>{if(2!==lc)return 32;if(!this.Jd)return 8;$b=ic[da.M3b];lc=ic[da.Qkc].optionalProperties;Hc={};Hc.WE=lc.MLh;Hc.assetId=$b.getId();Hc.sourceLocationOverrideResourceId=lc.ULl;Hc.E5=lc.zLh;Hc.nonPersistedSettings=lc.$Mc;$b=this.Jd.dwb(Hc);$b=this.Jd.pQ($b);ic=ic[da.C0b];return $b&&"taskpane"==ic.toLowerCase()?(this.Jd.$$k($b.instanceId,Hc),32):8};this.cqj=(Hc,$b,lc,Vb,ic)=>{if(2!==lc)return 32;
if(ic.SourceControlId)return this.MLg=new $a,this.MLg.NBi(),32;h.ULS.sendTraceTag(509207557,220,10,"Control id is null.")};this.ftj=(Hc,$b,lc,Vb,ic)=>{if(2!==lc)return 32;if(!this.Dra)return 8;$b=this.Dra.oIf[ic.SourceControlId];if(!$b)return h.ULS.sendTraceTag(509383066,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Jd?this.Jd.SYj($b):(this.KL.Zia(),this.KL.xPa(Hc,ic));return 32};this.dtj=(Hc,$b,lc,Vb,ic)=>{if(2!==lc)return 32;if(!this.Dra)return 8;$b=this.Dra.oIf[ic.SourceControlId];
if(!$b)return h.ULS.sendTraceTag(509383065,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Jd?this.Jd.y1c($b):(this.KL.Zia(),this.KL.xPa(Hc,ic));return 32};this.D$f=(Hc,$b,lc,Vb,ic)=>{$b=this.ua.Ba;Vb=this.Vb.Ef;if(!(this.H4&&$b&&Vb)||this.hf.$c($b))return 8;if(!this.tRd)return h.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===lc)return 32;Fa.a("LogAddinInstallOriginEnabledForPPT")&&(lc=ic?ic.SourceControlId:void 0,window[this.r5j]=
this.eUg.get(lc)?this.eUg.get(lc):"Unknown");this.Jd?Fa.a("UpdateLaunchInsertDialog")?(Hc=ic?ic.SourceControlId:void 0,ic=ic?ic.CommandValueId:null,"InsertMoreAddInsFromFooter"===Hc?this.Jd.Yog("{98143890-AC66-440E-A448-ED8771A02D52}"):"AddinFlyoutMoreButton"===Hc?this.Jd.Yog("0"):"LaunchAddinDialogFromTellMe"==Hc&&ic?this.Jd.bZj(ic):this.Jd.launchInsertDialog()):this.Jd.launchInsertDialog():(this.KL.Zia(),this.KL.xPa(Hc,ic));return 32};this.y$f=(Hc,$b,lc,Vb,ic)=>{if(!ic)return 8;null!=this.Jd&&this.Pb.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&
this.Jd.$jc("handleInsertAppForOffice",ic);return this.z$f(Hc,ic)};this.Nsj=(Hc,$b,lc,Vb,ic)=>ic?this.z$f(Hc,ic):8;this.z$f=(Hc,$b)=>{if(!this.tRd)return h.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(0===$b.targetType)return this.AGj($b,Hc);if(1===$b.targetType){if(this.hf.$c(this.Vb.Ef))return 16;this.m$j?$b.isAddinCommands?Fa.a("AddinCommandsActionTypeUndefinedCheck")?void 0===$b.addinCommandsActionType||null===$b.addinCommandsActionType||0===$b.addinCommandsActionType?
this.HOb($b):1===$b.addinCommandsActionType?this.vXc($b):h.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+$b.addinCommandsActionType.toString()):0===$b.addinCommandsActionType?this.HOb($b):1===$b.addinCommandsActionType&&this.vXc($b):(Hc={},Hc.solutionId=$b.solutionId,Hc.version=$b.version,Hc.storeType=$b.storeType,Hc.storeId=$b.storeId,Hc.targetData=$b,this.Jd.vl.isAddinCommandsAsync(Hc,(lc,Vb,ic)=>{Vb?this.HOb(ic.targetData):this.vXc(ic.targetData);
lc||(lc=ic.targetData,h.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(lc.solutionId,lc.storeType,lc.assetId,null,null,lc.storeId),lc.storeType))})):this.vXc($b);Ba.a.add($b.solutionId,$b.targetType,$b.storeId,$b.storeType,$b.version);return 32}return 8};this.la=Ib;this.Pb=gc;this.H4=this.la.pptEditInsertAppsForOfficeEnabled;this.m$j=this.la.aua;this.Ms=Ta;this.ia=Ab;this.Vb=kc;this.ua=fb;this.c8c=mb;this.Jb=Qb;this.KL=
Jb;this.Yc=Ub;this.Qb=tb;this.hf=Bc;this.Wj=Gb}get tRd(){return this.H4&&n.AFrameworkApplication.Hia}wb(){this.ia.ra(pa.a.Byb,ha.a.application,this.D$f,516);this.ia.ra(pa.a.gXc,ha.a.application,this.Nsj,4);this.ia.ya(pa.a.dWc,ha.a.application,Object(m.a)(this,this.xsj,"handleHideAppForOfficeTaskPane"));this.ia.ra(pa.a.Iib,ha.a.application,Object(m.a)(this,this.xvj,"handleRenderAppForOfficeTaskPane"),4);this.ia.ra(pa.a.OZa,ha.a.application,Object(m.a)(this,this.OZa,"queryEntitledAppsForOffice"),96);
this.ia.ya(pa.a.gga,ha.a.application,Object(m.a)(this,this.uag,"handleShowFirstPartyTaskPane"));this.ia.ya(pa.a.ttb,ha.a.application,Object(m.a)(this,this.grj,"handleCloseAppsForOfficeTaskPane"));this.ia.ya(qa.a.Lkl,ha.a.application,Object(m.a)(this,this.iwj,"handleShowExtensionTaskPane"));this.ia.ya(qa.a.yui,ha.a.application,Object(m.a)(this,this.hrj,"handleCloseExtensionTaskPane"));this.ia.ya(qa.a.K2k,ha.a.application,Object(m.a)(this,this.Jvj,"handleRestartExtensionTaskPane"));this.ia.ya(pa.a.XFh,
ha.a.application,Object(m.a)(this,this.Wwj,"handleUpdateBackgroundAppData"));Fa.a("EnableSDXDialog2")&&this.ia.ya(qa.a.iZj,ha.a.application,this.etj);Fa.a("EnabledTellMeAddinOnPPTO")&&(this.ia.ra(qa.a.Yeg,ha.a.application,this.y$f,4),this.ia.ra(qa.a.une,ha.a.application,this.D$f,4));this.cvf&&(this.ia.ya(qa.a.y1c,ha.a.application,this.dtj),this.ia.ya(qa.a.Fee,ha.a.application,this.y$f),this.ia.ya(qa.a.cpg,ha.a.application,this.ftj),this.ia.ya(qa.a.xLk,ha.a.application,this.Kuj),this.ia.ya(qa.a.rFk,
ha.a.application,this.nuj),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1)));Fa.a("EnableSetTitleExtensionTaskPane")&&this.ia.ya(qa.a.qel,ha.a.application,this.cwj);this.Jbi&&this.ia.ra(qa.a.Neg,ha.a.application,this.cqj,516)}get Dra(){if(!this.cvf)return null;if(!this.Jd)return this.KL.Zia(),h.ULS.sendTraceTag(509383064,220,10,"appForOfficeManager is null"),null;this.zsg||(this.Jd.$uf?this.zsg=new aa(this.ia,this.Jd.$uf,qa.a.y1c.toString(),qa.a.cpg.toString(),
pa.a.Byb.toString(),this.Pb):h.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null"));return this.zsg}get cvf(){return this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.Pb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get Jbi(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",!1)}Ee(){}get Jd(){return this.Yc.instance}iwj(Ib,
gc,Ta,Ab,kc){if(2!==Ta)return 32;const fb=kc[da.M3b];kc=kc[da.Qkc];const Qb={};Qb.WE=kc.optionalProperties[e.WE];Qb.assetId=fb.getId();Qb.E5=kc.optionalProperties[e.E5];Qb.nonPersistedSettings=kc.$Mc;return this.uag(Ib,gc,Ta,Ab,Qb)}hrj(Ib,gc,Ta,Ab,kc){if(2!==Ta)return 32;Ib=kc[da.M3b];kc=kc[da.Qkc];gc={};gc.WE=kc.optionalProperties[e.WE];gc.assetId=Ib.getId();gc.sourceLocationOverrideResourceId=kc.optionalProperties[e.sourceLocationOverrideResourceId];gc.E5=kc.optionalProperties[e.E5];gc.nonPersistedSettings=
kc.$Mc;kc=this.Jd.dwb(gc);return(kc=this.Jd.pQ(kc))&&this.Jd.yVd(kc.instanceId)?32:8}Jvj(Ib,gc,Ta,Ab,kc){if(2!==Ta)return 32;Ib=kc[da.M3b];gc=kc[da.Qkc];kc={};kc.WE=gc.optionalProperties[e.WE];kc.assetId=Ib.getId();kc.sourceLocationOverrideResourceId=gc.optionalProperties[e.sourceLocationOverrideResourceId];kc.E5=gc.optionalProperties[e.E5];kc.nonPersistedSettings=gc.$Mc;Ib=this.Jd.dwb(kc);return(Ib=this.Jd.pQ(Ib))?(this.Jd.dgh(Ib.instanceId,kc),32):8}xsj(Ib,gc,Ta,Ab,kc){if(!this.H4)return 16;if(!kc)return 8;
if(1===Ta)return 32;Ib=Object(ma.a)(String,kc);if(!Ib||!Ib.length)return 8;if((gc=this.Jd.WPc(Ib))&&gc.taskpane){if(this.Jd.oua(Ib))return this.Jd.yLb(Ib,!1),32;if(gc.Ho&&OSF.OsfControl.isFirstPartyStoreString(gc.Ho.storeType))return this.Jd.BNc(Ib),this.Jd.QNk(Ib),32;gc=gc.taskpane.ownerAddinSolutionId;if(this.Jd.yIj(Ib)||gc)this.Jd.BNc(Ib);else if(gc=this.Jd.nRc(),Ta=this.Qb.Nc(gc),Ib=this.Jd.dWf(Ib)){Ta.Pk(Object(ma.a)(sa.a,Ib));Ib=this.Jb.Ad(4,void 0,void 0,void 0,!0);try{Ib.nc(gc),Ta.Mi()}finally{Ib&&
Ib.dispose()}}}return 32}xvj(Ib,gc,Ta,Ab,kc){if(!this.H4)return 16;if(!kc)return 8;if(1===Ta)return 32;gc=Object(ma.a)(String,kc);if(!gc||!gc.length)return 8;this.Jd?this.Jd.Iib(gc):this.KL.xPa(Ib,kc);return 32}uag(Ib,gc,Ta,Ab,kc){if(!this.H4)return 16;if(!kc)return 8;if(1===Ta)return 32;if(this.Jd){if(!kc||!kc.assetId||!n.AFrameworkApplication.zle(kc.assetId))return 8;kc.nonPersistedSettings||(kc.nonPersistedSettings={});kc.nonPersistedSettings.ShowFeedback=n.AFrameworkApplication.TE;!this.wzg&&
this.pBb&&(this.wzg=!0,Ib=window.performance.now()-this.pBb,h.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",Ib));Ib=this.Jd.dwb(kc);if(Ib=this.Jd.pQ(Ib))return this.Jd.dgh(Ib.instanceId,kc),32;this.Jd.s_k(kc)}else this.pBb||(this.pBb=window.performance.now()),this.KL.Zia(),this.KL.xPa(Ib,kc);return 32}Wwj(Ib,gc,Ta,Ab,kc){if(1===Ta)return this.H4?32:8;if(!this.H4)return 16;if(!(kc&&kc.ew&&-1!==kc.ew.state&&kc.ew.kya&&this.Jd))return 8;Ib=this.Jd.HDa(kc.Ho.id);if(!Ib)return 8;gc=
this.Jb.Ad(4,void 0,void 0,void 0,!0);try{gc.nc(Ib),Ib.setValue(ia.a.asb,kc.ew.state),Ib.setValue(ia.a.z6a,kc.ew.kya),Ib.setValue(F.a.dZb,kc.Ho.storeType)}finally{gc&&gc.dispose()}return 32}grj(Ib,gc,Ta,Ab,kc){return this.H4?kc?1===Ta?32:this.Jd&&kc&&kc.length?this.Jd.yVd(kc)?32:8:8:8:16}OZa(Ib,gc,Ta,Ab,kc){var fb;if(2===Ta){gc=kc.callback;if(!gc)return 16;Fa.a("AllowQueryAddinsForStoreTypes")?this.Jd?this.KLk(gc,null!==(fb=kc.storeType)&&void 0!==fb?fb:OSF.StoreTypeEnum.MarketPlace):(kc=Object.assign({},
kc),this.KL.xPa(Ib,kc)):this.JLk(gc)}return 32}KLk(Ib,gc){const Ta=new V.a;Ta.callbackFunc=Ib;Ta.storeType=gc;Ta.fromInsertDialog=!1;Ta.refresh="true"===ca.a.instance.getItem(fa.a.NPd);this.Jd.vl.queryEntitlementDetails(Ta)}JLk(Ib){const gc=new V.a;gc.callbackFunc=Ib;gc.storeType=OSF.StoreTypeEnum.MarketPlace;gc.fromInsertDialog=!1;gc.refresh="true"===ca.a.instance.getItem(fa.a.NPd);this.Jd.vl.queryEntitlementDetails(gc)}HOb(Ib){const gc=new z.a;gc.add(Ib);Ib={};Ib[fa.a.NGc]=gc;Ib[fa.a.P7]=3;this.ia.La(qa.a.w1c,
2,Ib)}AGj(Ib,gc){const Ta=this.ua.Ba;if(!Ta||this.hf.$c(Ta))return 16;if(!this.Wj.OF(Ta,1))return this.Wj.nG(Ta),16;try{return this.$eg(Ib,Ta,Ta.Cb,gc)}catch(Ab){return 8}}$eg(Ib,gc,Ta,Ab){Ta=gc.kFi(Ib.width,Ib.height,gc.Ut()+1);va.a.btf(Ta,Ib,this.Jd);this.Ms.BW([Object(ma.a)(4,Ta)],gc,Ab);Ba.a.add(Ib.solutionId,Ib.targetType,Ib.storeId,Ib.storeType,Ib.version);return 32}vXc(Ib){if(!this.Jd.pQ(Ib.solutionId)){var gc=this.Jd.HDa(Ib.solutionId),Ta=this.Jd.nRc();if(gc){Ta=new ta.a(gc);if(!Ta.visibility){let Ab=
this.Jb.Ad(4,void 0,void 0,void 0,!0);try{Ab.nc(gc),gc.setValue(F.a.fZb,!0),gc.setValue(F.a.dZb,Ib.storeType)}finally{Ab&&Ab.dispose()}}this.Jd.Iib(Ta.id)}else{gc=va.a.UBi(this.c8c.value,Ib,this.Jd);Ib=this.Jb.Ad(4,void 0,void 0,void 0,!0);try{Ib.nc(Ta),va.a.z4h(Ta,gc)}finally{Ib&&Ib.dispose()}}}}}Object(I.a)(ab,"AppForOfficeActor",null,[352])},1003:function(I,Y,d){I=d(0);var h=d(289),e=d(27),n=d(47),m=d(14),z=d(24),B=d(1200),v=d(36),y=d(28);class A{}A.speechMode="Subtitles";A.ULf=[A.speechMode];
A.sourceLanguage=null;A.targetLanguages=null;A.speechFDBase=null;A.podSessionId=null;A.tJh=null;A.docId=null;A.webServiceBase=null;A.userSessionId=e.AFrameworkApplication.userSessionId;Object(I.a)(A,"PPTSpeechClientConfig",null,[]);var E=d(78);class u{constructor(){this.va=new E.a}onFinalRecognitionText(ca){this.va.raiseEvent("OnFinalRecognitionText",ca)}onPartialRecognitionText(ca){this.va.raiseEvent("OnPartialRecognitionText",ca)}onError(ca){this.va.raiseEvent("OnError",ca)}onSpeechRecognitionStarted(ca){this.va.raiseEvent("OnSpeechRecognitionStarted",
ca)}onEventUpdate(ca){this.va.raiseEvent("OnEventUpdate",ca)}a9h(ca){this.va.addHandler("OnFinalRecognitionText",ca)}aYk(ca){this.va.removeHandler("OnFinalRecognitionText",ca)}aai(ca){this.va.addHandler("OnPartialRecognitionText",ca)}pZk(ca){this.va.removeHandler("OnPartialRecognitionText",ca)}V8h(ca){this.va.addHandler("OnError",ca)}WXk(ca){this.va.removeHandler("OnError",ca)}$ai(ca){this.va.addHandler("OnSpeechRecognitionStarted",ca)}UZk(ca){this.va.removeHandler("OnSpeechRecognitionStarted",ca)}X8h(ca){this.va.addHandler("OnEventUpdate",
ca)}YXk(ca){this.va.removeHandler("OnEventUpdate",ca)}}Object(I.a)(u,"PPTSpeechClientObserverController",null,[]);var J=d(387),G=d(398);class S{constructor(){this.accessToken=null}}Object(I.a)(S,"IAuthenticationProvider",null,[]);class P{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(I.a)(P,"IDocumentDownloadConfig",null,[]);class Q{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=
this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(I.a)(Q,"ISpeechConfig",null,[]);class D{constructor(ca){this.h5=ca}onFinalText(){}onFragmentText(){}onFinalRecognitionText(ca,fa){this.h5.onFinalRecognitionText(ca,fa)}onPartialRecognitionText(ca,fa){this.h5.onPartialRecognitionText(ca,fa)}onError(ca){if("ErrorNone"!==ca)switch(ca){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.h5.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.h5.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.h5.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.h5.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.h5.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.h5.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.h5.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.h5.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.h5.onError("NotReadableError");break;default:this.h5.onError("CustomError-"+ca)}}onSpeechRecognitionStarted(ca){J.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",ca);this.h5.onSpeechRecognitionStarted(ca)}onEventUpdate(ca){this.h5.onEventUpdate(ca)}}Object(I.a)(D,"PPTSpeechClientObserver",null,[452]);class O{constructor(ca){this.F$=null;this.rIa=0;this.microphoneDeviceId="";this.Ggk=new D(ca)}TUj(){return 2===this.rIa}wFj(){const ca=this.EXd(),fa=Object.assign(new S,{accessToken:""});this.F$&&0!==this.rIa&&(this.F$.stopSpeechRecognition(),this.rIa=0);this.F$=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(ca,
this.Ggk,fa,null,new G.a);return this.F$?!0:(J.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}kyh(){this.F$&&(0===this.rIa?(this.F$.startSpeechRecognition(),this.rIa=2):1===this.rIa&&(this.F$.resumeSpeechRecognition(),this.rIa=2))}Rql(){this.F$&&(this.F$.stopSpeechRecognition(),this.rIa=0)}YDk(){this.F$&&(this.F$.pauseSpeechRecognition(),this.rIa=1)}setCustomSetting(ca,fa){this.F$&&this.F$.setCustomSetting(ca,fa)}EXd(){return Object.assign(new Q,{speechMode:A.speechMode,
sourceLanguage:A.sourceLanguage,targetLanguages:A.targetLanguages,speechFDBase:A.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new P,{docId:A.docId,podsSessionId:A.podSessionId,userDataCenterClusterId:A.tJh,webServiceBase:A.webServiceBase}),userSessionId:A.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(I.a)(O,"PPTSpeechClientProxy",null,[]);var X;(function(ca){ca[ca.none=0]="none";ca[ca.singleLineRibbon=1]="singleLineRibbon";
ca[ca.multipleLineRibbon=2]="multipleLineRibbon";ca[ca.slideShowToolbar=3]="slideShowToolbar";ca[ca.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";ca[ca.liveBroadcast=5]="liveBroadcast"})(X||(X={}));Object(I.b)("TranscriptionEntryPoint",X);var N=d(674),aa=d(72);d.d(Y,"a",function(){return V});class V{constructor(){this.mf=this.H$=this.XC=this.zfb=this.Or=this.kb=this.la=this.Ub=this.Hc=null;this.YCb=!1;this.Ll=null;this.Jfb=this.Xhc=0;this.LCg=!1;this.vIa=this.uIa="";this.$4c=!1;this.bCe=
"";this.pre=0;this.wCb=this.J0=this.OFb="";this.iO=null;this.Ewa={};this.xma=new u;this.s$=new O(this.xma);V.AFj()}init(ca,fa,ma,da,qa,F,sa){y.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.mf=fa;this.la=ca;this.Hc=ma;this.kb=da;this.Ll=qa;this.Ub=F;this.iO=sa;this.Or=document.createElement("div");this.Or.id="SubtitleContainer";this.Or.className="SubtitleContainer";this.Or.style.display=aa.a.Gf;this.Or.style.visibility=aa.a.Qs;this.zfb=document.createElement("div");this.zfb.id="SubtitleResultDiv";
this.zfb.className="SubtitleResultDiv";this.Hc.$Ui&&(this.zfb.style.direction="rtl");this.XC=document.createElement("span");this.XC.id="SubtitleResultSpan";this.XC.className="SubtitleResultSpan";this.XC.setAttribute("aria-hidden","true");this.H$=document.createElement("span");this.H$.id="SubtitleAccessibilitySpan";this.H$.className="SubtitleAccessibilitySpan";this.H$.innerText="";this.H$.setAttribute("lang",this.Hc.xza);this.H$.setAttribute("aria-live","assertive");this.H$.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.H$.setAttribute("aria-atomic","true");this.zfb.appendChild(this.XC);this.zfb.appendChild(this.H$);this.Or.appendChild(this.zfb);this.mf.appendChild(this.Or);h.a.instance.pb(this.XC,()=>!1);e.AFrameworkApplication.fa.Mda?this.Pm():e.AFrameworkApplication.fa.gf(Object(m.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){this.OFb=this.getUserId();this.J0=e.AFrameworkApplication.fa.Ga("TenantId");this.wCb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ga("HostAuthType")||
"Unknown"}getUserId(){let ca=e.AFrameworkApplication.fa.Ga("PptEditingUserId");n.a.Wa(ca)&&(ca=e.AFrameworkApplication.fa.Ga("LoggableUserId"),y.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",n.a.Wa(ca)));return ca}CXk(){this.Or.style.display=aa.a.Gf;this.Or.style.visibility=aa.a.Qs}transcribe(ca,fa,ma,da,qa,F){this.mAb()&&(this.Ll.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,N.a.Rdd),this.Xhc=window.setTimeout(Object(m.a)(this,this.Cce,
"hideSoundReminderNotification"),3E3));this.EEl(fa,ma,da,this.Hc);this.s$&&(this.s$.microphoneDeviceId=this.iO.microphoneDeviceId);this.Hc.Kh&&this.s$.wFj()?(this.Ewa.StartTime=F,this.Ewa.LastError="ErrorNone",this.Ewa.EntryPoint=X[qa],this.xma.a9h(Object(m.a)(this,this.p3g,"onFinalRecognitionTextHandler")),this.xma.aai(Object(m.a)(this,this.R4g,"onPartialRecognitionTextHandler")),this.xma.V8h(Object(m.a)(this,this.y6g,"onSpeechProxyErrorHandler")),this.xma.X8h(Object(m.a)(this,this.z6g,"onSpeechProxyEventUpdateHandler")),
this.xma.$ai(Object(m.a)(this,this.A6g,"onSpeechRecognitionStartedHandler")),this.s$.kyh(),this.s$.setCustomSetting("clientMetadata",JSON.stringify(this.I0f())),this.XC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.XC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==qa),this.SGc(),this.kb.xGc(Object(m.a)(this,this.exa,"onGetCurrentSlideDimensionsHandler")),this.kb.GPa(Object(m.a)(this,this.egd,"onSlideChangedHandler"))):this.v_e()}I0f(ca=""){const fa=v.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
ma={};ma.userID=this.OFb;ma.tenantId=this.J0;ma.identityProvider=this.wCb;ma.audienceChannel="";ma.audienceGroup=fa.Ring||"Unknown";ma.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";ma.locale=this.la.HJa||"Unknown";ma.wacHost=fa.Host||"Unknown";ma.wacDatacenter=fa.WACDatacenter||"Unknown";ma.livePragueSessionInfo=ca;return ma}v_e(){this.Or.style.display=aa.a.Gf;this.Or.style.visibility=aa.a.Qs;this.s$.Rql();this.xma.aYk(Object(m.a)(this,this.p3g,"onFinalRecognitionTextHandler"));this.xma.pZk(Object(m.a)(this,
this.R4g,"onPartialRecognitionTextHandler"));this.xma.WXk(Object(m.a)(this,this.y6g,"onSpeechProxyErrorHandler"));this.xma.YXk(Object(m.a)(this,this.z6g,"onSpeechProxyEventUpdateHandler"));this.xma.UZk(Object(m.a)(this,this.A6g,"onSpeechRecognitionStartedHandler"));this.kb.pld(Object(m.a)(this,this.exa,"onGetCurrentSlideDimensionsHandler"));this.kb.Dib(Object(m.a)(this,this.egd,"onSlideChangedHandler"));this.mAb()&&this.Ll.instance.hide();this.Ewa.EndTime=Date.now();y.a.J(512495705,817,15,JSON.stringify(this.Ewa,
V.RAl));this.Ewa={};this.Hc.zvb=!1}SGc(){let ca=3;this.Ewa.LastPosition=this.Hc.Tv;"AboveSlide"===this.Hc.Tv&&this.Or.style.visibility===aa.a.Dz?(this.Or.style.display=aa.a.$ya,this.Or.style.backgroundColor="black",this.Or.style.bottom="auto"):"BelowSlide"===this.Hc.Tv&&this.Or.style.visibility===aa.a.Dz?(this.Or.style.display=aa.a.$ya,this.Or.style.backgroundColor="black",this.Or.style.bottom="3%",ca=-1):"TopOverlay"===this.Hc.Tv?(this.Or.style.display=aa.a.$ya,this.Or.style.backgroundColor="transparent",
this.Or.style.bottom="auto",ca=5):"BottomOverlay"===this.Hc.Tv&&(this.Or.style.display=aa.a.$ya,this.Or.style.backgroundColor="transparent",this.Or.style.bottom="5%",ca=-1);this.YCb&&document.getElementById("LiveURLBarLayerHost")?this.Or.style.top=-1<ca?String.format("calc({0}% + {1})",ca.toString(),"26px"):"auto":(this.Or.style.top=-1<ca?ca.toString()+"%":"auto",this.xvf())}isVisible(){return this.Or.style.visibility===aa.a.Dz}lCh(ca,fa=""){A.ULf=ca?["Live","Subtitles"]:["Subtitles"];this.YCb=ca;
this.setVisibility(this.Or.style.visibility===aa.a.Dz);this.SGc();this.s$.setCustomSetting("clientMetadata",JSON.stringify(this.I0f(fa)));this.s$.setCustomSetting("slideIndex",this.pre);this.s$.setCustomSetting("currentSpeechModes",JSON.stringify(A.ULf))}hga(ca){this.Or.style.cursor=ca?"default":"none"}xvf(){this.XC.style.fontSize=Math.floor(this.Or.clientHeight/2/1.5).toString()+"px";this.bCe=Math.floor(this.Or.clientHeight/12-2)+"px";this.XC.style.display="inline"}setVisibility(ca){this.Or?(null===
ca&&(ca=this.Or.style.visibility===aa.a.Qs),this.Or.style.visibility=ca?aa.a.Dz:aa.a.Qs):y.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}exa(){this.xvf()}egd(ca,fa){this.pre=fa.slideIndex;this.s$.TUj()&&this.YCb&&(this.s$.setCustomSetting("currentSlideIndex",this.pre),y.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(ca){ca?(this.s$.YDk(),this.Poc(),this.$4c=!0,this.Ub&&this.Ub.instance&&
this.Ub.instance.xqh()):(this.s$.kyh(),this.Ub&&this.Ub.instance&&this.Ub.instance.yqh())}Cce(){this.mAb()&&(window.clearTimeout(this.Xhc),this.Ll.instance.hide())}EEl(ca,fa,ma,da){A.sourceLanguage=da.Toa;A.targetLanguages=da.ylb;A.podSessionId=ca;A.tJh=fa;A.docId=ma;A.webServiceBase=this.la.podsWebServiceBase;A.speechFDBase=e.AFrameworkApplication.fa.Ga("715");ca=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.dSa||this.Ub.instance.dr);A.speechMode=this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&
this.Ub.instance.ADa||ca?"Live":"Subtitles"}kPf(ca,fa){this.LCg||(this.XC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Jfb),this.XC.innerText=this.Vmj(ca,fa),this.XC.scrollTop=this.XC.scrollHeight,this.Jfb=window.setTimeout(Object(m.a)(this,this.Poc,"resetSubtitlesToEmpty"),1E4),fa&&(this.H$.innerText=ca,this.H$.focus()),this.XC.style.padding=n.a.Wa(ca)?"0px":this.bCe)}tv(ca){this.LCg||(this.XC.style.color="rgba( 255, 255, 0, 1 )",n.a.Wa(ca)&&(ca=ResourceStrings.L_SubtitleGenericErrorMessage),
window.clearTimeout(this.Jfb),this.XC.innerText="["+ca+"]",this.XC.scrollTop=this.XC.scrollHeight,this.Jfb=window.setTimeout(Object(m.a)(this,this.Poc,"resetSubtitlesToEmpty"),1E4),this.XC.style.padding=this.bCe,this.H$.innerText="",this.H$.focus())}vwj(ca){if(null!==ca)switch(ca){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.tv(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.Ewa.LastError="MicrophoneError";break;case "FailedToConnect":this.tv(ResourceStrings.L_SubtitleRetryErrorMessage);
this.Ewa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.tv(ResourceStrings.L_SubtitleGenericErrorMessage);this.Ewa.LastError="FailedToCreateSpeechSession";break;default:y.a.J(512495703,830,15,"HandleSpeechProxyError {0}",ca)}}p3g(ca,fa){this.Or.style.visibility!==aa.a.Qs&&this.kPf(fa[this.Hc.ylb],!0)}R4g(ca,fa){this.Or.style.visibility!==aa.a.Qs&&this.kPf(fa[this.Hc.ylb],!1)}y6g(ca,fa){y.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",fa);(ca=fa.toString())&&
(-1<ca.indexOf("NotAllowedError")||-1<ca.indexOf("NotFoundError")||-1<ca.indexOf("NotReadableError")||-1<ca.indexOf("MicrophoneError"))&&this.mAb()&&this.Ll.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,N.a.RYa);this.vwj(ca)}A6g(ca,fa){({SlideShowCoreFrame:ca}=d(727));const {SlideshowFrame:ma}=d(1E3);y.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",fa.toString());Object(z.a)(ca,this.kb)?Object(B.a)(ca,this.kb).wgd(fa.toString()):Object(z.a)(ma,this.kb)&&this.la.wid&&
Object(B.a)(ma,this.kb).wgd(fa.toString());this.Poc();this.mAb()&&this.Ll.instance.hide()}z6g(ca,fa){if(this.mAb())switch(ca=fa.eventName,ca){case "MediaEvent":"AudioDeviceConnected"===fa.mediaStatus&&this.Ll.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,N.a.Rdd);break;case "ConnectionRetry":this.Ll.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,N.a.RYa);this.tv(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const ma=fa.shortCode;ca=fa.longCode;
const da=fa.shortString,qa=fa.longString;switch(fa.severity){case 0:this.Ll.instance.hide();break;case 1:(fa=0<ma?V.wY[ma]:da)&&this.Ll.instance.show(fa,N.a.MGb);break;case 2:(fa=0<ma?V.wY[ma]:da)&&this.Ll.instance.show(fa,N.a.RYa),fa=null===ca?qa:V.wY[ca],n.a.Wa(fa)||(window.clearTimeout(this.Jfb),this.tv(fa),this.Jfb=window.setTimeout(Object(m.a)(this,this.Poc,"resetSubtitlesToEmpty"),3E4))}break;default:y.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",ca)}}mAb(){return this.la.pptEditorVoiceUXEnabled&&
!!this.Ll&&!!this.Ll.instance}Poc(){this.XC.style.color="rgba( 255, 255, 255, 1 )";this.XC.innerText="";this.XC.scrollTop=this.XC.scrollHeight;this.vIa=this.uIa="";this.$4c=!1;this.Jfb=0;this.XC.style.padding="0px"}Vmj(ca,fa){this.$4c?this.Zdi(ca):this.Z_k(ca);this.$4c=fa;return n.a.Wa(this.uIa)||n.a.Wa(this.vIa)?n.a.Wa(this.uIa)?this.vIa:this.uIa:this.uIa+"\n"+this.vIa}Zdi(ca){this.uIa=n.a.Wa(this.vIa)?this.uIa:this.vIa;this.vIa=ca}Z_k(ca){n.a.Wa(this.uIa)||n.a.Wa(this.vIa)?this.uIa=ca:this.vIa=
ca}static get instance(){return V.Qp}static AFj(){V.wY[1]=ResourceStrings.L_SubtitleDetection_Listening;V.wY[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;V.wY[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;V.wY[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;V.wY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static RAl(ca,fa){return"undefined"===typeof fa?null:fa}}V.wY=Array(20);V.Qp=new V;Object(I.a)(V,"SlideshowSubtitles",null,[406])},1005:function(I,
Y,d){I=d(0);var h=d(27),e=d(55),n=d(57),m=d(270),z=d(312);class B{constructor(Ka,Pa=null){this.RWh=Ka;this.yS=Pa||z.a.n7d(e.a.G6a,"")}get Pu(){return this.RWh}get Nb(){return this.yS}CVe(Ka){this.Nb.d++;return this.Pu.CVe(Ka)}mMb(Ka){this.Nb.e++;return this.Pu.mMb(Ka)}MH(Ka){this.Nb.f++;return this.Pu.MH(Ka)}d0a(Ka){this.Nb.h++;return this.Pu.d0a(Ka)}LY(Ka){this.Nb.i++;return this.Pu.LY(Ka)}IY(Ka){this.Nb.j++;return this.Pu.IY(Ka)}e6(Ka){this.Nb.k++;return this.Pu.e6(Ka)}KY(Ka){this.Nb.l++;return this.Pu.KY(Ka)}sVe(Ka){this.Nb.m++;
return this.Pu.sVe(Ka)}UKa(Ka,Pa=!1){this.Nb.n++;return this.Pu.UKa(Ka,Pa)}Tae(){this.Nb.o++;return this.Pu.Tae()}lZe(){this.Nb.p++;return this.Pu.lZe()}zLb(Ka){this.Nb.m++;return this.Pu.zLb(Ka)}Sr(Ka){this.Nb.q++;return this.Pu.Sr(Ka)}Coa(Ka){this.Nb.r++;return this.Pu.Coa(Ka)}ULb(Ka){this.Nb.g++;return this.Pu.ULb(Ka)}mpd(Ka){return this.Pu.mpd(Ka)}j0a(Ka){this.Nb.s++;return this.Pu.j0a(Ka)}Sod(Ka){this.Nb.s++;return this.Pu.Sod(Ka)}cga(Ka){this.Nb.s++;return this.Pu.cga(Ka)}i0a(Ka){this.Nb.s++;
return this.Pu.i0a(Ka)}Wjb(Ka){this.Nb.t++;return this.Pu.Wjb(Ka)}npd(Ka){this.Nb.u++;return this.Pu.npd(Ka)}aqc(Ka){this.Nb.v++;return this.Pu.aqc(Ka)}Foa(Ka){return this.Pu.Foa(Ka)}sod(Ka){this.Nb.z++;return this.Pu.sod(Ka)}nSe(){return this.Pu.nSe()}ZKa(Ka,Pa){this.Nb.w++;this.Nb.x++;return this.Pu.ZKa(Ka,Pa)}w1(Ka){this.Nb.y++;return this.Pu.w1(Ka)}clearFormatting(){return this.Pu.clearFormatting()}clone(){return new B(this.Pu.clone(),this.Nb)}}Object(I.a)(B,"FormattingStewardUsageCollector",
null,[583]);class v extends B{constructor(Ka,Pa=null){super(Ka,Pa)}get A5(){return this.Pu}get jE(){return this.A5.jE}set jE(Ka){this.A5.jE=Ka}get textIndent(){return this.A5.textIndent}get marginLeft(){return this.A5.marginLeft}get Vgd(){return this.A5.Vgd}get lineSpacing(){return this.A5.lineSpacing}get kga(){return this.A5.kga}get F1c(){return this.A5.F1c}get Cfa(){return this.A5.Cfa}get paragraph(){return this.A5.paragraph}set paragraph(Ka){this.A5.paragraph=Ka}get c9a(){return this.A5.c9a}xtd(Ka){return this.A5.xtd(Ka)}Z2e(Ka){return this.A5.Z2e(Ka)}clone(){const Ka=
this.Pu.clone();return new v(Ka,this.Nb)}}Object(I.a)(v,"FormattingStewardUsageCollector",B,[582,583]);var y=d(33),A=d(77),E=d(184),u=d(673),J=d(54),G=d(147),S=d(74),P=d(59),Q=d(352),D=d(1097),O=d(339),X=d(47),N=d(1208),aa=d(1203),V=d(1202),ca=d(113),fa=d(40),ma=d(83),da=d(42),qa=d(38),F=d(88),sa=d(308);class ia{}ia.yellow="FFFF00";ia.lime="00FF00";ia.aqua="00FFFF";ia.fuchsia="FF00FF";ia.blue="0000FF";ia.red="FF0000";ia.navy="000080";ia.teal="008080";ia.green="008000";ia.purple="800080";ia.maroon=
"800000";ia.olive="808000";ia.gray="808080";ia.dol="C0C0C0";ia.black="000000";Object(I.a)(ia,"FontHighlightColorEnum",null,[]);var Na=d(342),Ca=d(51),ha=d(884),Ba=d(372),va=d(109);class ta{constructor(Ka,Pa,Oa,oa,Xa,Hb,Ob,eb,Eb=null,oc=!1){this.Xv=this.WBc=null;this.xVb=0;this.c9e=this.wVb=null;this.w2=0;this.DOa=this.mEc=this.xAc=this.VDc=this.R3a=this.Uha=this.KAc=this.zEc=null;this.KMf=.25*ca.Font.wI;this.paragraph=Ka;this.Kf=Pa;this.IK=Oa;this.yP=oa;this.qha=Xa;this.EV=Hb;this.sZ=Ob;this.b3a=
eb;Eb?(va.a(4223818,307,!!Eb.Xv),this.Xv=Eb.Xv.VJc(this.paragraph),this.xVb=Eb.xVb,this.wVb=Eb.wVb,Eb.Uha&&(this.Uha=new ha.a,this.Uha.afterSpacing.value=Eb.Uha.afterSpacing.value,this.Uha.beforeSpacing.value=Eb.Uha.beforeSpacing.value),Eb.R3a&&(this.R3a=Eb.R3a.clone()),this.w2=Eb.w2,this.mEc=Eb.mEc.clone(),this.zEc=Eb.zEc,this.KAc=Eb.KAc,this.VDc=Eb.VDc,this.xAc=Eb.xAc,Eb.Cfa&&(this.DOa=Eb.Cfa)):(this.Xv=new sa.a(this.paragraph,0),this.Xv.formatting=new Na.a(this.Xv,Q.a.nil),Pa=Ca.a.SQa(Ka),Pa=this.yP.xs(Pa),
this.v$k(Pa),ta.Ljl(Ka)?(this.qha.vVe(this.Xv.formatting,Pa,oc),this.w2=Ka.Sa(fa.a.Jl)?Ka.eb(fa.a.Jl):0):this.w2=-1,this.xVb=0,this.wVb=null,this.Uha=this.J7i(),this.b3a&&(this.Uha=this.qha.LW(Ka),this.R3a=this.qha.U7d(Ka),this.VDc=this.qha.mTa(Ka),this.xAc=this.qha.K8(Ka)),this.mEc=new D.DictionaryPropertySet,this.qha.gVe(this.Xv.formatting,Ka,oc))}get paragraph(){return this.WBc}set paragraph(Ka){va.a(4223816,307,!!Ka&&y.ParagraphReader.$d(Ka));this.WBc=Ka}get c9a(){return this.Xv.formatting}get jlc(){return this.xVb}get P8g(){return this.wVb}get V2(){return this.c9e}get jE(){return this.w2}set jE(Ka){va.a(4223817,
307,1===Ka||2===Ka||3===Ka||qa.a.instance.ga(54)&&6===Ka);this.w2=Ka}get textIndent(){return this.zEc}get marginLeft(){return this.KAc}get Vgd(){return this.Uha}get lineSpacing(){return this.R3a}get kga(){return this.VDc}get F1c(){return this.xAc}get Cfa(){return this.DOa}v$k(Ka){const Pa=this.yP.language(Ka);Pa&&this.Kf.Zpc(this.Xv.formatting,Pa,0,Ka.cache.RUa,!1)}J7i(){if(qa.a.instance.ga(54))return null;const Ka=new ha.a;Ka.afterSpacing.value=this.KMf;Ka.beforeSpacing.value=this.KMf;return Ka}CVe(Ka){(Ka=
m.a.xe(Ka))&&this.Kf.e0a(this.Xv.formatting,Ka.LCID);return!0}mMb(){return!1}MH(Ka){this.Kf.MH(this.Xv.formatting,Ka);return!0}d0a(Ka){this.Kf.setItalic(this.Xv.formatting,Ka);return!0}LY(Ka){this.Kf.LY(this.Xv.formatting,Ka);return!0}IY(Ka){this.Kf.IY(this.Xv.formatting,Ka);return!0}e6(Ka){this.Kf.e6(this.Xv.formatting,Ka);return!0}KY(Ka){this.Kf.KY(this.Xv.formatting,Ka);return!0}sVe(Ka){if(0>=Ka)return!1;this.Kf.Pq(this.Xv.formatting,Ka);return!0}UKa(Ka,Pa){if(!Ka||""===Ka)return!1;if(({fontInfo:Oa}=
O.FontUtils.jAl(Ka)).returnValue)return this.Kf.UU(this.Xv.formatting,Oa.fontName),!0;var Oa=!1;const oa=O.FontUtils.eG(Ka);Pa&&this.h0c(oa,this.EV)&&(this.EV.createFontUrl(Ka),Oa=!0);this.h0c(oa,this.sZ)&&(Oa=!0);Oa&&this.Kf.UU(this.Xv.formatting,oa);return Oa}h0c(Ka,Pa){return!!Pa&&Pa.isEnabled&&Pa.h0c(Ka)}Tae(){this.Kf.oVc(this.Xv.formatting);return!0}lZe(){this.Kf.Pqd(this.Xv.formatting);return!0}zLb(Ka){if(0>=Ka)return!1;this.Kf.zLb(this.Xv.formatting,Ka);return!0}Sr(Ka){var {Box4PasteSteward:Pa}=
d(251);if(!this.Kf.Vlg(Ka)){if(null===Ka||""===Ka)return!1;Ka=Pa.y7a(Ka)}Pa=null;this.Cfa&&this.Cfa.hasOwnProperty(da.a.listLevel.id.toString())&&(Pa=this.Cfa[da.a.listLevel.id.toString()]);this.Kf.Sr(this.Xv.formatting,Ka,Pa);return!0}Coa(Ka){const {Box4PasteSteward:Pa}=d(251);if(!Ka||""===Ka||qa.a.instance.ga(49)&&!ta.apj().contains(Ka)||this.qha.zuh(this.Xv.formatting))return!1;this.Kf.Coa(this.Xv.formatting,Pa.y7a(Ka));return!0}ULb(Ka){this.Kf.ULb(this.Xv.formatting,Ka);return!0}mpd(Ka){let Pa=
0;switch(X.a.qg(Ka)){case "small-caps":Pa=1;break;case "uppercase":Pa=2}this.Kf.Dm(this.Xv.formatting,ma.a.capitalization,Pa);return!0}sod(Ka){const {Box4PasteSteward:Pa}=d(251);if(!Ka||""===Ka)return!1;this.mEc.setValue(fa.a.jJc,parseInt(Pa.y7a(Ka),16));return!0}i0a(Ka){return 0>=Ka?!1:this.Sod(F.StyleReader.Qkj(Ka))}j0a(Ka){this.clearFormatting();this.xVb=Ka;return!0}Sod(Ka){const {Box4PasteSteward:Pa}=d(251);return Ka&&0<Ka.length&&Pa.CNb&&Pa.CNb.$G(Ka)?(this.wVb=Ka,!0):!1}cga(Ka){const {Box4PasteSteward:Pa}=
d(251);return Ka&&0<Ka.length&&Pa.CNb&&Pa.CNb.$G(Ka)?(this.c9e=Ka,!0):!1}Z2e(Ka){if(this.V2){Ka=d(251).Box4PasteSteward.CNb||F.StyleReader.qL(Ka);if(!Ka)return va.a(41968715,307,!1),!1;(Ka=Ka.$G(this.V2))&&this.Kf.cga(this.Xv.formatting,Ka);return!0}return!1}ZKa(Ka,Pa){if(qa.a.instance.ga(54))return!1;va.a(5297416,307,0<=Ka&&0<=Pa);0<=Ka&&(this.Uha.beforeSpacing.value=Ka);0<=Pa&&(this.Uha.afterSpacing.value=Pa);return 0<=Ka||0<=Pa}w1(Ka){if(!qa.a.instance.ga(54)||!Ka)return!1;const Pa=parseFloat(X.a.substring(Ka,
0,X.a.qg(Ka).indexOf("px")));if(!isNaN(Pa))return this.R3a=new Ba.a(3,N.a.Gfa(Pa,1)),!0;Ka=parseFloat(X.a.substring(Ka,0,X.a.qg(Ka).indexOf("%")));return isNaN(Ka)?!1:(this.R3a=new Ba.a(2,Ka/100),!0)}Wjb(Ka){let Pa=0;if(!Ka||""===Ka)return!1;switch(Ka){case "left":Pa=1;break;case "center":Pa=2;break;case "right":Pa=3;break;case "justify":qa.a.instance.ga(54)&&(Pa=6)}if(0===Pa)return!1;this.jE=Pa;return!0}npd(Ka){this.zEc=Ka;return!0}aqc(Ka){this.KAc=Ka;return!0}Foa(Ka){this.DOa=JSON.parse(Ka);return this.Cfa?
!0:!1}clearFormatting(){this.Xv.formatting=new Na.a(this.Xv,Q.a.nil);return!0}nSe(){this.w2=0;return!0}xtd(Ka){var {Box4PasteSteward:Pa}=d(251);if(!qa.a.instance.ga(71))return!1;if(0<this.jlc&&Pa.tJa[this.jlc]){va.a(4223819,307,1<=this.jlc);va.a(4223820,307,7>=this.jlc);Pa=F.StyleReader.qL(Ka);if(!Pa)return va.a(4223821,307,!1),!1;Pa=Pa.$G(d(251).Box4PasteSteward.tJa[this.jlc]);this.IK.Eaa(Pa,Ka,!1);return!0}if(this.P8g){Pa=d(251).Box4PasteSteward.CNb||F.StyleReader.qL(Ka);if(!Pa)return va.a(41968716,
307,!1),!1;this.IK.Eaa(Pa.$G(this.P8g),Ka,!1);return!0}return!1}clone(){return new ta(this.paragraph,this.Kf,this.IK,this.yP,this.qha,this.EV,this.sZ,this.b3a,this)}static apj(){ta.QP||(ta.QP=new aa.a(V.a.to()),ta.QP.add(ia.yellow),ta.QP.add(ia.lime),ta.QP.add(ia.aqua),ta.QP.add(ia.fuchsia),ta.QP.add(ia.blue),ta.QP.add(ia.red),ta.QP.add(ia.navy),ta.QP.add(ia.teal),ta.QP.add(ia.green),ta.QP.add(ia.purple),ta.QP.add(ia.maroon),ta.QP.add(ia.olive),ta.QP.add(ia.gray),ta.QP.add(ia.dol),ta.QP.add(ia.black));
return ta.QP}static Ljl(Ka){if(!qa.a.instance.ga(71))return!0;Ka=F.StyleReader.wQ(F.StyleReader.bE(Ka));return Ka===F.StyleReader.QJh||Ka===F.StyleReader.zMa||Ka===F.StyleReader.TJh||Ka===F.StyleReader.Woa}}ta.QP=null;Object(I.a)(ta,"FormattingSteward",null,[582,583]);class Fa{l3e(){return!1}lbe(Ka){return Ka}Foa(){}RLb(){}sZc(){return!1}get q_c(){return!1}w1(){}ZKa(){}Brh(){}rqh(){}get Cuh(){return!1}}Object(I.a)(Fa,"NoOpPasteStewardBridge",null,[569]);var pa=d(18);class ka{constructor(Ka,Pa){this.Iok=
Ka;this.Jok=Pa||"Normal"}}Object(I.a)(ka,"NoteTagInfoBox4",null,[]);const Ha=Ka=>{const Pa=new pa.a;for(let Oa of Ka)Ka=new ka(Oa.Iok,Oa.Jok),Pa.add(Ka);return Pa};d.d(Y,"a",function(){return Ya});class Ya{constructor(Ka,Pa,Oa=null,oa=null){this.sZ=this.EV=null;this.c_i=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.Tkf=0;this.Ab=Ka;this.DG=Pa;this.iZ=oa||new Fa;this.yS=Oa||z.a.n7d(e.a.G6a,"")}get Nb(){return this.yS}get characterPropertiesEditor(){return Ya.fh||(Ya.fh=
n.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.EV||(this.EV=n.a.instance.ub("Box4.IFontService"))}get UCa(){return this.sZ||(this.sZ=n.a.instance.ub("Box4.CustomFontService"))}reset(){}get d2b(){return this.x6d(!1)}x6d(Ka){va.a(4223770,307,P.OutlineElementReader.Yg(this.Ab));const Pa=J.OutlineElementNavigator.wi(this.Ab);J.OutlineElementNavigator.Re(this.Ab);va.a(4223771,307,!!Pa&&y.ParagraphReader.$d(Pa));Ka=new ta(Pa,Ya.mh,Ya.jP,Ya.Q_i,Ya.R_i,this.fontService,
this.UCa,this.c_i,void 0,Ka);return new v(Ka,this.Nb)}U0(){}Bna(){}jZa(){}Ana(){}zna(){}cxa(){}bxa(){}uA(){}tA(){}dZa(){}cZa(){}hxa(){}lJa(){}Ena(){}Cna(){}gxa(){}Dna(){}eZa(){}oGb(Ka){P.OutlineElementReader.Yg(this.Ab)?(Ya.Ph.T8b(this.Ab,!0),J.OutlineElementNavigator.FJ(this.Ab,!1,!1)):S.OutlineReader.Zt(this.Ab)?G.OutlineNavigator.V$(this.Ab)?Ka?(this.Ab.Mi(),Ya.EB.LZ(this.Ab,!1)):Ya.Ph.joc(this.Ab):Ya.EB.LZ(this.Ab,!1):va.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Ab.ri)}XSa(Ka){let Pa=
null;if(Ka&&Ka.BU&&Ka.cultureName)try{Pa=Object.assign(new u.a,{languageId:m.a.xe(Ka.cultureName).LCID})}catch(Oa){va.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Ka.cultureName,Oa)}Pa||null==this.DG||(Pa=Object.assign(new u.a,{languageId:this.DG}));return Pa}get vM(){return this.Tkf}set vM(Ka){this.Tkf=Ka}yHc(){}jtd(){}fVd(){}get w7a(){return!1}get L7a(){return!1}k_j(Ka){let Pa=1;if(Ka.Jjg){var Oa=0;switch(Ka.listStyleType){case 1:Pa=0;break;case 7:Pa=1;break;case 8:Pa=2;break;case 9:Pa=
3;break;case 10:Pa=4;break;case 11:Pa=5}}else switch(Oa=1,Ka.listStyleType){case 1:Pa=0;break;case 3:Pa=1;break;case 4:Pa=2;break;case 5:Pa=3}let oa;Oa=(oa=A.ListReader.D8a)?E.a.wN(Oa,Pa,Ha(Ka.I5),Ka.listId,Ka.listLevel,Ka.levelText,Ka.font):E.a.wN(Oa,Pa,Ha(Ka.I5));Ka.Jjg&&!Ka.vJj&&(Oa.xA=oa&&0<Ka.listId&&0<=Ka.listLevel&&!Ka.VHb?Ka.eql:Ka.JIi);this.iZ.RLb(this.Ab,Oa,Ka);return Oa}pY(){}mY(){}oY(){}nY(){}lY(){}kY(){}static get Ph(){return Ya.Di||(Ya.Di=n.a.instance.resolve("Box4.IOutlineElementEditor"))}static get EB(){return Ya.Tx||
(Ya.Tx=n.a.instance.resolve("Box4.IOutlineEditor"))}static get mh(){return Ya.Kf||(Ya.Kf=n.a.instance.resolve("Box4.IFormattingEditor"))}static get jP(){return Ya.IK||(Ya.IK=n.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Q_i(){return Ya.yP||(Ya.yP=n.a.instance.resolve("Box4.IFormattingReader"))}static get R_i(){return Ya.qha||(Ya.qha=n.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}Ya.Di=null;Ya.Tx=null;Ya.fh=null;Ya.Kf=null;Ya.IK=null;Ya.yP=null;Ya.qha=null;Object(I.a)(Ya,
"Box4PasteStewardBase",null,[535,536,507])},1008:function(I,Y,d){d.r(Y);I=d(0);var h=d(717),e=d(1027),n=d(1013),m=d(201),z=d(14),B=d(40),v=d(74),y=d(32),A=d(39),E=d(28),u=d(43);class J{constructor(V,ca){this.re=V;this.$f=ca}}Object(I.a)(J,"RowSpan",null,[]);class G{constructor(V){this.xB=V;this.qIa=[]}TOd(V,ca){Array.add(this.qIa,new J(V,ca))}R3k(V){for(let ca=0;ca<this.qIa.length;ca++){const fa=this.qIa[ca];V<=fa.re&&fa.re++;V<=fa.$f&&fa.$f++}}get x(){return this.xB}get gmh(){return this.qIa}static Ume(V,
ca){return V.xB===ca}static hWd(V,ca){V=V.xB-ca.xB;return 0<V?1:0>V?-1:0}}Object(I.a)(G,"ColSplit",null,[]);const S=(V,ca,fa)=>{let ma;ma=-1;for(let da=0;da<V.length;++da)if(fa(V.ga(da),ca))return ma=da,{returnValue:!0,kyb:ma};return{returnValue:!1,kyb:ma}};class P{constructor(V,ca){this.ge=V;this.Of=ca}}Object(I.a)(P,"ColSpan",null,[]);class Q{constructor(V){this.yB=V;this.qIa=[]}TOd(V,ca){Array.add(this.qIa,new P(V,ca))}Tui(V){for(let ca=0;ca<this.qIa.length;ca++){const fa=this.qIa[ca];V<=fa.ge&&
fa.ge++;V<=fa.Of&&fa.Of++}}get tGf(){return this.qIa}get y(){return this.yB}static Ume(V,ca){return V.yB===ca}static hWd(V,ca){V=V.yB-ca.yB;return 0<V?1:0>V?-1:0}}Object(I.a)(Q,"RowSplit",null,[]);var D=d(954),O=d(29);class X{constructor(V,ca,fa,ma,da,qa,F,sa,ia,Na,Ca,ha,Ba,va,ta){this.GUa=!1;this.Yi=this.hJc=this.nUg=this.Oad=null;this.NEh=V;this.Uc=ca;this.Ixh=fa;this.H0a=ma;this.Cvd=da;this.tableNode=qa;this.Ld=F;this.VY=sa;this.XSa=ia;this.S3k=Na;this.Uui=Ca;this.Imd=ha;this.dKc=Ba;this.rows=
va;this.cols=ta;this.I0a=0;this.aac=!1}D6a(V){this.Oad=new Date;this.nUg=V}o8a(){this.Oad>O.App.Vm&&this.Uc&&this.Uc.Va(this.nUg,(+new Date-+this.Oad).toString());this.Oad=O.App.Vm}finish(){const {TableMergeSplitEditor:V}=d(1008);this.Uc&&(this.Yi&&(this.aac=!1,this.Uc.Va(V.BMl,this.Yi.message)),this.Uc.Va("SplitCellsSucceeded",this.aac.toString()),this.Uc.finish(),this.Uc=null);if(this.Yi)throw this.Yi;this.Ixh&&this.Ixh(this.aac,this.H0a)}}Object(I.a)(X,"SplitCellsArguments",null,[]);var N=d(331);
d.d(Y,"TableMergeSplitEditor",function(){return aa});class aa{constructor(V,ca,fa,ma,da,qa,F,sa,ia,Na,Ca,ha,Ba,va,ta){this.Qb=V;this.ZX=ca;this.qA=fa;this.k5=ma;this.Yad=da;this.VL=qa;this.C9c=F;this.Kq=ia;this.pea=Na;this.Vfc=Ca;this.Tk=ha;this.Jb=Ba;this.pa=va;this.Y$c=ta}merge(V,ca,fa){const ma=V.qf(ca.re,ca.ge),da=this.Qb.Nc(ma);let qa=da.ZA(1);const F=[A.a.rowId,A.a.cellId];qa&&da.zc();let sa=!0;for(let Na=ca.re;Na<ca.$f;++Na){let Ca=V.qf(Na,ca.ge);for(let ha=ca.ge+(Na===ca.re?1:0);ha<ca.Of;++ha)if(ha!==
ca.ge&&(Ca=V.qf(Na,ha)),!Ca||!Ca.isGhostCell){Ca.fo(A.a.rowSpan,A.a.colSpan);Ca.isGhostCell=!0;var ia=y.GraphIterator.nb(Ca);v.OutlineReader.isEmpty(ia)?this.jhh(ia):(sa&&v.OutlineReader.isEmpty(da)&&(sa=!1,qa=null,this.jhh(da)),this.VL.v_i(Ca,Ba=>{this.VL.$x(da.currentNode,Ba,F);return!0},Ba=>11===Ba.type||22===Ba.type||12===Ba.type),ia=this.Qb.s7d(ia),ia.Bb(1),this.VL.Jmk(da,qa,ia.role,ia.role,ia),ia.Ixb(1),qa=ia.currentNode)}}this.k5.DCl(fa,ma,ca);ma.rowSpan=ca.UO;ma.colSpan=ca.xR;V.setValue(A.a.complexTable,
!0);this.C9c.RQe(V);V.Hda(511);this.qA.Y8b(V);return ma}lpl(V,ca,fa,ma,da,qa,F,sa,ia){if(1>=fa&&1>=ma)ia&&ia(!0,ca);else{var Na=new Date,Ca=u.a.yk("SplitCells",1);Ca.Nj=!0;var ha=new h.a,Ba=new e.a,va=new e.a,ta=this.pea.xDa(V,da,ca);ca=this.Kq.dPc(da,ca);var Fa=qa.T5f();for(qa=qa.P_f();ta.moveNext();){ha.add(ta.f5b().id.toString());const Ya=ta.dA;for(var pa=1;pa<fa;pa++){var ka=Fa[Ya.re];ka+=(Fa[Ya.$f]-ka)*pa/fa;var Ha=void 0;({kyb:Ha}=S(Ba,ka,Q.Ume)).returnValue||(Ha=Ba.length,Ba.add(new Q(ka)));
Ba.ga(Ha).TOd(Ya.ge,Ya.Of)}for(pa=1;pa<ma;pa++)ka=qa[Ya.ge],ka+=(qa[Ya.Of]-ka)*pa/ma,({kyb:Ha}=S(va,ka,G.Ume)).returnValue||(Ha=va.length,va.add(new G(ka))),va.ga(Ha).TOd(Ya.re,Ya.$f)}Ba=Ba.toArray();va=va.toArray();Ba.sort((Ya,Ka)=>Q.hWd(Ka,Ya));va.sort((Ya,Ka)=>G.hWd(Ka,Ya));Ca.Va("Prep",(+new Date-+Na).toString());Na=this.Jb.me(15);Na.nc(V);V=new X(Na,Ca,ia,ca,ha,V,F,da,sa,Fa,qa,Ba,va,fa,ma);V=new n.a(null,Object(z.a)(this,this.tpl,"splitRowSeams"),V);V.Oi=!1;V.Pl("SplitTableCells");V.run()}}tpl(V,
ca){try{for(ca.D6a("SplitRowSeams");ca.I0a<ca.Imd.length;){const fa=({GUa:ca.GUa}=this.QBi(ca.tableNode,ca.Ld,ca.VY,ca.XSa,ca.S3k,ca.Imd[ca.I0a])).returnValue;ca.I0a++;if(ca.GUa){let ma;(ma=ca.H0a).$f=ma.$f+1;for(let da=0;da<ca.dKc.length;da++)ca.dKc[da].R3k(fa)}if(V.dpa)return!0}ca.o8a();ca.I0a=0;V.Wg(Object(z.a)(this,this.qpl,"splitColSeams"))}catch(fa){ca.Yi=fa,V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}return!0}qpl(V,ca){try{for(ca.D6a("SplitColSeams");ca.I0a<ca.dKc.length;){const fa=({GUa:ca.GUa}=
this.PBi(ca.tableNode,ca.Ld,ca.VY,ca.XSa,ca.Uui,ca.dKc[ca.I0a])).returnValue;ca.I0a++;if(ca.GUa){let ma;(ma=ca.H0a).Of=ma.Of+1;for(let da=0;da<ca.Imd.length;++da)ca.Imd[da].Tui(fa)}if(V.dpa)return!0}ca.o8a();ca.I0a=0;V.Wg(Object(z.a)(this,this.iPb,"updateIsComplexTableProperty"))}catch(fa){ca.Yi=fa,V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}return!0}iPb(V,ca){try{ca.D6a("UpdateComplex"),this.C9c.q4e(this.Qb.Nc(ca.tableNode)),ca.o8a(),ca.hJc=this.pea.xDa(ca.tableNode,ca.VY,ca.H0a),V.Wg(Object(z.a)(this,
this.eZi,"fixSplitCells"))}catch(fa){ca.Yi=fa,V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}return!0}eZi(V,ca){try{for(ca.D6a("FixInsideBorders");ca.hJc.moveNext();)if(ca.Cvd.contains(ca.hJc.f5b().id.toString())&&this.dZi(ca.tableNode,ca.VY,ca.hJc,ca.rows,ca.cols),V.dpa)return!0;ca.o8a();V.Wg(Object(z.a)(this,this.nSi,"ensureMinRowHeightColumnWidth"))}catch(fa){ca.Yi=fa,V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}return!0}nSi(V,ca){try{ca.D6a("EnsureMinHeightWidth"),1<ca.rows&&this.oSi(ca.tableNode,
ca.H0a),1<ca.cols&&this.mSi(ca.tableNode,ca.H0a),ca.o8a(),V.Wg(Object(z.a)(this,this.setSelection,"setSelection"))}catch(fa){ca.Yi=fa,V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}return!0}setSelection(V,ca){try{ca.D6a("SetSelection");ca.aac=!ca.H0a.bSa();if(ca.aac){const fa=this.Y$c.uHi(ca.tableNode,ca.VY,ca.H0a);fa&&this.pa.QE(fa)}ca.o8a();ca.D6a("Render");V.Oi||ca.NEh.Fqh(V);ca.NEh.dispose();V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}catch(fa){ca.Yi=fa,V.Wg(Object(z.a)(this,this.clb,"tearDownSplit"))}return!0}clb(V,
ca){ca.o8a();ca.finish();return!1}QBi(V,ca,fa,ma,da,qa){var F;let sa=({Ike:F}=D.c(da,qa.y)).returnValue;if(F=!F){sa++;var ia=da[sa-1],Na=da[sa],Ca=this.Qb.Nc(V);this.jjc(Ca,sa-1);var ha=Ca.currentNode;Ca=this.C9c.Cee(Ca);ia=qa.y-ia;ha.setValue(A.a.su,ca.rf(ia,1));ia=Na-qa.y;Ca.setValue(A.a.su,ca.rf(ia,1));Array.insert(da,sa,qa.y);fa.pUa(3)}for(ca=0;ca<qa.tGf.length;++ca){da=qa.tGf[ca];Na=[];for(ha=da.ge;ha<=da.Of;++ha)({ola:ia}=this.Yad.BDh(V,fa,ha,sa)),Na[Na.length]=ia;ha=new N.a;ha.ge=da.ge;ha.Of=
da.Of;ha.re=sa-1;ha.$f=sa+1;for(ha=this.pea.xDa(V,fa,ha);ha.moveNext();)ia=ha.dA,Ca=ha.f5b(),this.LIf(sa,ia.ge,Ca),this.Qph(sa,ia.ge,Ca,ma);for(ha=da.ge;ha<da.Of;++ha){ia=V.qf(sa-1,ha);Ca=V.qf(sa,ha);var Ba=this.Kq.CI(fa,sa-1,ha);Ba.ge===ha&&(ia=V.qf(Ba.re,Ba.ge),Ba=sa-Ba.re,Ca.rowSpan=ia.rowSpan-Ba,ia.rowSpan=Ba,Ca.colSpan=ia.colSpan);Ca.isGhostCell=ia.isGhostCell}fa.pUa(1);this.k5.S3d(V,fa,sa,da.ge,da.Of,!0);for(let va=da.ge,ta=0;va<=da.Of;++va,++ta)Na[ta]&&this.k5.EWe(V,fa,va,sa,sa+1,Na[ta])}return{returnValue:sa,
GUa:F}}PBi(V,ca,fa,ma,da,qa){var F;let sa=({Ike:F}=D.b(da,qa.x)).returnValue;if(F=!F){sa++;var ia=da[sa-1],Na=da[sa],Ca=this.Qb.Nc(V);this.ZX.HZg(Ca);Ca.Zp(sa-1,1);this.C9c.Bee(Ca);if(Ca=V.sa(B.a.Zu,null))Ca=m.a.clone(Ca),Ca[sa-1]=ca.rf(qa.x-ia,0),Ca[sa]=ca.rf(Na-qa.x,0),V.setValue(B.a.Zu,Ca);Array.insert(da,sa,qa.x);fa.pUa(3)}for(ca=0;ca<qa.gmh.length;++ca){da=qa.gmh[ca];ia=[];for(Na=da.re;Na<=da.$f;++Na)({ola:Ca}=this.Yad.xDh(V,fa,Na,sa)),ia[ia.length]=Ca;Na=new N.a;Na.re=da.re;Na.$f=da.$f;Na.ge=
sa-1;Na.Of=sa+1;for(Na=this.pea.xDa(V,fa,Na);Na.moveNext();){Ca=Na.dA;var ha=Na.f5b();this.LIf(Ca.re,sa,ha);this.Qph(Ca.re,sa,ha,ma)}for(Na=da.re;Na<da.$f;++Na){Ca=V.qf(Na,sa-1);ha=V.qf(Na,sa);var Ba=this.Kq.CI(fa,Na,sa-1);Ba.re===Na&&(Ca=V.qf(Ba.re,Ba.ge),Ba=sa-Ba.ge,ha.colSpan=Ca.colSpan-Ba,Ca.colSpan=Ba,ha.rowSpan=Ca.rowSpan);ha.isGhostCell=Ca.isGhostCell}fa.pUa(1);this.k5.U3d(V,fa,sa,da.re,da.$f,!0);for(let va=da.re,ta=0;va<=da.$f;++va,++ta)ia[ta]&&this.k5.yVe(V,fa,va,sa,sa+1,ia[ta])}return{returnValue:sa,
GUa:F}}dZi(V,ca,fa,ma,da){var qa=this.pea.xDa(V,ca,fa.sE);qa.moveTo(fa.HO,fa.ML);fa=qa.dA;for(let F=1;F<ma;++F)qa.Tmk(),fa.$f=qa.dA.$f,fa.Of=qa.dA.Of;for(ma=1;ma<da;++ma)qa.moveNext(),fa.$f=qa.dA.$f,fa.Of=qa.dA.Of;for(da=this.pea.xDa(V,ca,fa);da.moveNext();){qa=da.dA;let F;qa.$f<fa.$f&&({ola:F}=this.Yad.xDh(V,ca,fa.$f,qa.ge)).returnValue&&this.k5.yVe(V,ca,qa.$f,qa.ge,qa.Of,F);qa.Of<fa.Of&&({ola:F}=this.Yad.BDh(V,ca,fa.Of,qa.re)).returnValue&&this.k5.EWe(V,ca,qa.Of,qa.re,qa.$f,F)}}oSi(V,ca){V=this.Qb.Nc(V);
this.jjc(V,ca.re);for(let fa=ca.re;fa<ca.$f;++fa){const ma=V.currentNode.sa(A.a.su,0);ma&&ma<this.Tk.PIc(V.currentNode)&&V.currentNode.setValue(A.a.su,0);V.Cf(1)}}mSi(V,ca){let fa=V.sa(B.a.Zu,null),ma=!1;if(fa){fa=m.a.clone(fa);for(let da=ca.ge;da<ca.Of;++da){const qa=this.Tk.Hsb(V,da);fa[da]&&fa[da]<qa&&(fa[da]=qa,ma=!0)}}ma&&V.setValue(B.a.Zu,fa)}LIf(V,ca,fa){const ma=fa.getContainingTable();ma||E.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");ma.qf(V,ca).cellShading=
fa.cellShading}Qph(V,ca,fa,ma){const da=fa.getContainingTable();da||E.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");V=y.GraphIterator.nb(da.qf(V,ca));this.Vfc.LZ(V,!0,ma(fa))}jjc(V,ca){for(this.ZX.HZg(V);0<ca--;)this.ZX.Zmk(V)}jhh(V){V=this.Qb.s7d(V);let ca=V.Bb(1);for(;ca;)ca=V.tRa(1)}}Object(I.a)(aa,"TableMergeSplitEditor",null,[276])},1009:function(I,Y,d){I=d(0);var h=d(14),e=d(387),n=d(27),m=d(166),z=d(197),B=d(57);class v{constructor(D,O,X,N){this.LFd=null;this.Gxc=
N;this.Pba=D;this.Qba=O;this.sP=X;this.qof=this.uXg.cil;D=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.TVh=D[0];this.SVh=D[1]}get uXg(){return this.LFd||(this.LFd=B.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get WTa(){return CommonUIStrings.l_OICErrorHelpLink}get Yqc(){return this.qof}get wXg(){return this.TVh}get vXg(){return this.SVh}get tXg(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.qof?
3:2}get D3b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get MKc(){return!!this.Qba}get E3b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get sRa(){return CommonUIStrings.l_DefaultDialogTitle}qPe(D){this.Hjc(D)}Ene(D){this.Hjc(D)}Hjc(D){let O=10;this.Qba&&1===D&&(this.Qba(this.sP),O=1);this.Pba&&this.Pba(this.sP);this.vp(O)}Egb(){z.Redirect.showHelp("OICFailure");this.vp(2)}dGe(){this.uXg.Zog();this.vp(4)}vp(D){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Gxc,D);n.AFrameworkApplication.Oib(m.a.A7g,this.Gxc,D)}dispose(){this.sP=this.Pba=this.Qba=null}}Object(I.a)(v,"AOICErrorDialog",null,[106]);var y=d(93),A=d(108);class E extends v{constructor(D,O,X,N){super(D,O,X,N);this.iOa=this.Jz=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=this.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));this.Jz=document.createElement("a");this.Jz.href="#";this.Jz.innerText=this.WTa;D.appendChild(this.Jz);
y.a.addHandler(this.Jz,"click",Object(h.a)(this,this.Egb,"oicErrorHelpLinkHandler"));O=new A.StandardDialog;O.hg=this.id;this.Yqc?(X=document.createElement("span"),N=document.createElement("span"),X.innerText=this.wXg,N.innerText=this.vXg,this.iOa=document.createElement("a"),this.iOa.href="#",this.iOa.innerText=this.tXg,D.appendChild(document.createElement("br")),D.appendChild(X),D.appendChild(this.iOa),D.appendChild(N),y.a.addHandler(this.iOa,"click",Object(h.a)(this,this.dGe,"oicErrorMacOfferLinkHandler"))):
this.MKc&&(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),X=document.createElement("span"),X.innerText=this.D3b,D.appendChild(X));this.MKc?(O.xd=1,O.Xe(1,this.E3b)):O.xd=0;O.Gx(this.sRa,null,this.icon,Object(h.a)(this,this.Ene,"legacyOICErrorDialogHandler"),D);O.c6("errorMessageText")}dispose(){this.Jz&&(y.a.removeHandler(this.Jz,"click",Object(h.a)(this,this.Egb,"oicErrorHelpLinkHandler")),this.Jz=null);this.iOa&&(y.a.removeHandler(this.iOa,"click",Object(h.a)(this,
this.dGe,"oicErrorMacOfferLinkHandler")),this.iOa=null);super.dispose()}}Object(I.a)(E,"OICErrorDialog",v,[]);class u{constructor(D,O,X){this.Pba=O;this.Qba=D;this.sP=X}get id(){return"OICErrorDialogWithDownload"}get TSf(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get WTa(){return CommonUIStrings.l_OICErrorHelpLink}get D3b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get E3b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get sRa(){return CommonUIStrings.l_DefaultDialogTitle}qPe(D){this.Hjc(D)}Ene(D){this.Hjc(D)}Hjc(D){let O=
10;1===D&&(this.Qba(this.sP),O=1);this.Pba&&this.Pba(this.sP);this.vp(O)}Egb(){z.Redirect.showHelp("OICFailure");this.vp(2)}vp(D){n.AFrameworkApplication.Oib(m.a.B7g,3,D)}dispose(){this.sP=this.Qba=this.Pba=null}}Object(I.a)(u,"AOICErrorDialogWithDownload",null,[106]);class J extends u{constructor(D,O,X){super(D,O,X);this.Jz=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=this.TSf;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));this.Jz=
document.createElement("a");this.Jz.href="#";this.Jz.innerText=this.WTa;D.appendChild(this.Jz);y.a.addHandler(this.Jz,"click",Object(h.a)(this,this.Egb,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));O=document.createElement("span");O.innerText=this.D3b;D.appendChild(O);O=new A.StandardDialog;O.hg=this.id;O.xd=1;O.Xe(1,this.E3b);O.Gx(this.sRa,null,this.icon,Object(h.a)(this,this.Ene,"legacyOICErrorDialogHandler"),D);O.c6("errorMessageText")}dispose(){this.Jz&&
(y.a.removeHandler(this.Jz,"click",Object(h.a)(this,this.Egb,"oicErrorHelpLinkHandler")),this.Jz=null);super.dispose()}}Object(I.a)(J,"OICErrorDialogWithDownload",u,[]);var G=d(82);class S extends v{constructor(D,O,X,N){super(D,O,X,N);O={["errorMessage"]:this.errorMessage};O.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.WTa,["onExecute"]:aa=>{this.Egb(aa)}};this.Yqc?(O.macOfficePreLinkText=this.wXg,O.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.tXg,
["onExecute"]:aa=>{this.dGe(aa)}},O.macOfficePostText=this.vXg):this.MKc&&(O.errorFileDownloadOffer=this.D3b);D=new G.a(!1,!1,!0);this.MKc?(D.xd=1,D.Xe(1,this.E3b)):D.xd=0;D.hg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};D.Zi(this.sRa,Object(h.a)(this,this.qPe,"reactOICErrorDialogHandler"),O)}}Object(I.a)(S,"ReactOICErrorDialog",v,[]);class P extends u{constructor(D,O,X){super(D,O,X);O={["errorMessage"]:this.TSf,["errorFileDownloadOffer"]:this.D3b};O.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.WTa,["onExecute"]:N=>{this.Egb(N)}};D=new G.a(!1,!1,!0);D.xd=1;D.Xe(1,this.E3b);D.hg=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};D.Zi(this.sRa,Object(h.a)(this,this.qPe,"reactOICErrorDialogHandler"),O)}}Object(I.a)(P,"ReactOICErrorDialogWithDownload",u,[]);d.d(Y,"a",function(){return Q});class Q{constructor(){this.iqa=!!n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.GC}eFi(D,O,X){this.iqa?new S(D,O,null,X):new E(D,O,null,X)}fFi(D,
O,X){this.iqa?new P(D,O,X):new J(D,O,X)}gFi(D,O,X,N,aa){const {ReactOICErrorDialogWithTrial:V}=d(1115),{OICErrorDialogWithTrial:ca}=d(1116);this.iqa?new V(D,O,X,null,N,aa):new ca(D,O,X,null,N,aa)}static get instance(){return Q.Ka||(Q.Ka=new Q)}}Q.Ka=null;Object(I.a)(Q,"OICErrorDialogFactory",null,[1390])},1014:function(I,Y,d){I=d(0);var h=d(387);d(1200);var e=d(96),n=d(65),m=d(89);class z{constructor(){this.hasImpliedUsage=this.additionalValues=this.isInternal=this.isIntentional=null}}Object(I.a)(z,
"IKpiFailureOptionalProperties",null,[]);class B{constructor(){this.hasImpliedUsage=this.additionalValues=null}}Object(I.a)(B,"IKpiSuccessOptionalProperties",null,[]);var v=d(924);class y{constructor(){this.blockFutureEmissionDurationInMs=this.optionalVeto=this.optionalProperties=this.errorName=this.kpiName=null}}Object(I.a)(y,"KpiFailureParams",null,[]);class A{constructor(){this.blockFutureEmissionDurationInMs=this.optionalProperties=this.kpiName=null}}Object(I.a)(A,"KpiSuccessParams",null,[]);
var E=d(925);d.d(Y,"a",function(){return u});class u{static getInstance(J){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(e.Health.instance,J)}catch(G){return h.ULS.ujb(521457890,383,10,G,"Failed to initialize extendedHealth"),null}}static RRk(J,G){const S=u.getInstance(J);S&&S.logKpiUsage(u.fbj());const P=n.a.uj();try{const Q=G();Q.then(D=>{const O=u.ebj(n.a.uj()-P);S&&S.logKpiSuccess(O);return D}).catch(D=>{let O="UnknownError";D&&(O=D.toString());D=u.$2f(O,n.a.uj()-P);S&&
S.logKpiFailure(D)});return Q}catch(Q){throw J="",J=Q.message,J=u.$2f(J,n.a.uj()-P),S&&S.logKpiFailure(J),Q;}}static fbj(){const J=Object.assign(new v.a,{extendedProperties:u.K6d()});return Object.assign(new E.a,{kpiName:"InitFloodgate",kpiType:0,optionalProperties:J,blockFutureEmissionDurationInMs:3E5})}static ebj(J=null){J=Object.assign(new B,{additionalValues:Object.assign(new m.a,{extendedProperties:u.K6d(),durationMs:J})});return Object.assign(new A,{kpiName:"InitFloodgate",optionalProperties:J,
blockFutureEmissionDurationInMs:3E5})}static $2f(J,G=null){G=Object.assign(new z,{additionalValues:Object.assign(new m.a,{extendedProperties:u.K6d(),durationMs:G})});return Object.assign(new y,{kpiName:"InitFloodgate",errorName:J,optionalProperties:G,optionalVeto:null,blockFutureEmissionDurationInMs:3E5})}static K6d(){const J=new Map;J.has("SkipAria")||J.set("SkipAria","True");return J}}Object(I.a)(u,"ExtendedHealth",null,[])},1017:function(I,Y,d){I=d(0);class h{constructor(){this.results=null;this.totalResultCount=
0;this.hasTooManyResults=!1}}Object(I.a)(h,"DocumentContentSearchResults",null,[]);class e{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(P,Q,D,O,X){this.selectRange(Q,D,O,X)}selectRangeV3(){}search(){}searchV2(P,Q){this.search(P,D=>{Q(Object.assign(new h,{results:D,totalResultCount:D.length,hasTooManyResults:100<D.length}))})}searchWithParam(P,Q){this.search(P.query,Q)}searchWithParamV2(P,Q){this.searchWithParam(P,D=>{Q(Object.assign(new h,{results:D,totalResultCount:D.length,
hasTooManyResults:D.length>P.totalResultLimit}))})}highlight(){}highlightWithParam(P){this.highlight(P.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(I.a)(e,"BaseDocumentContentExecutor",null,[739,850]);class n{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(I.a)(n,"DocumentContentSearchResult",null,[]);var m=d(106),z=d(27),B=d(47),v=d(18),y=d(76),A=d(33),E=d(51),u=d(387),J=d(678),G=d(30);d.d(Y,"a",function(){return S});class S extends e{constructor(P,
Q,D,O,X,N,aa,V,ca,fa,ma){super();if(!P)throw Error("pageNode is null");if(!Q)throw Error("interactiveViewManager is null");if(!D)throw Error("selectionFactory is null");if(!O)throw Error("slideReader is null");if(!X)throw Error("workspace is null");if(!N)throw Error("graphTopologyManager is null");if(!aa)throw Error("searchContextFactory is null");if(!V)throw Error("actionManager is null");if(!ca)throw Error("selectionManager is null");if(!fa)throw Error("clipServiceManager is null");if(!ma)throw Error("presentationReader is null");
this.wck=P;this.hA=Q;this.Y$c=D;this.jc=O;this.Vb=X;this.ua=N;this.Gfk=aa;this.ia=V;this.pa=ca;this.jO=fa;this.oc=ma}getAllParagraphsInDocument(){const P=this.$8d(),Q=new v.a;for(let D of P)Q.add(S.X8d(D));return Q.toArray()}selectRange(P,Q,D,O){if(!(0>P||0>Q||0>D||0>O||P>D||P===D&&Q>O)){var X=this.$8d();X.count<=D||(P=X.ga(P),D=X.ga(D),S.Gng(P,Q)&&S.Gng(D,O)&&(X=this.jc.kg(P),this.ua.Ba!==X&&this.Vb.mph(X),Q=this.Y$c.Sg(P,Q),O=this.Y$c.DN(Q,E.a.Lj(D,O+1)),this.hA.FWe(this.Vb.MK,O)))}}search(P,Q){const D=
new v.a,O=P.toLowerCase();var X=this.$8d();let N=0;for(let V of X){X=S.X8d(V);const ca=X.toLowerCase();let fa=0;for(;-1<(fa=ca.indexOf(O,fa));){var aa=this.Gfk.uGi(X,fa,fa+P.length);aa=Object.assign(new n,{snippet:aa.Vzi,startOffsetInSnippet:aa.$2k,endOffsetInSnippet:aa.X2k-1,paragraphIndex:N,startOffsetInParagraph:fa,endOffsetInParagraph:fa+P.length-1});D.add(aa);fa+=P.length}N++}D.Sc((V,ca)=>V.paragraphIndex===ca.paragraphIndex?V.startOffsetInParagraph-ca.startOffsetInParagraph:V.paragraphIndex-
ca.paragraphIndex);Q(D.toArray())}getSelectedSlidesAsPPTXStream(){const P=this.pa.Qe();if(P&&P.length)return this.K_f(P);u.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const P=this.oc.V6f();if(P&&P.length)return this.K_f(P);u.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}K_f(P){var Q=this.jO.qLc(1,P.length,!1),D=m.a.create().toString();
D=new J.a(Q,D,P);var O=8;O=this.ia.La(G.a.gXd,2,D);Q.sW=O;D=z.AFrameworkApplication.fa.Ga("361");O=B.a.Ne(Q.Gp);const X=B.a.Ne(Q.tD);Q=B.a.Ne(Q.zy);if(O&&X&&Q)return{url:`${D}GetClipboardBytes.ashx?Id=${O}&DC=${X}&pkey=${Q}&wdwaccluster=${X}&DataType=${1}`,selectedSlideIDs:P.map(N=>N.id.toString())}}$8d(){var P=A.ParagraphReader.FTc(this.wck.value,!0,!1);const Q=new v.a;for(let D of P)P=this.jc.kg(D),P.SN||P.lAb||Q.add(D);return Q}static X8d(P){P=A.ParagraphReader.text(P);return y.AParagraphNode.gld(P,
" ")}static Gng(P,Q){P=S.X8d(P);return Q<P.length}}Object(I.a)(S,"PPTDocumentContentExecutor",e,[])},1020:function(I,Y,d){I=d(0);var h=d(387),e=d(1200),n=d(1201),m=d(1202),z=d(121),B=d(27),v=d(1014),y=d(200),A=d(271),E=d(95),u=d(252),J=d(310),G=d(36),S=d(193),P=d(55),Q=d(47);class D{constructor(){this.cvFlights=this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(I.a)(D,"CustomerVoiceSurveyParams",null,[]);var O=d(142),X=d(529);class N{sendTelemetryEvent(ca){const fa=new X.a;fa.otelEvent=
ca;O.a.sendOtelEvent(fa)}}Object(I.a)(N,"OtelTelemetrySink",null,[1403]);var aa=d(926);d.d(Y,"a",function(){return V});class V{static init(ca,fa,ma,da,qa){qa.onDismiss=ca;qa.onError=fa;ca=null;OfficeBrowserFeedback.initOptions?("screenshot"in qa&&(OfficeBrowserFeedback.initOptions.screenshot=qa.screenshot),"showEmailAddress"in qa&&(OfficeBrowserFeedback.initOptions.showEmailAddress=qa.showEmailAddress),"feedbackForumUrl"in qa&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=qa.feedbackForumUrl),
ca=qa):OfficeBrowserFeedback.initOptions=qa;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=V.FKf());OfficeBrowserFeedback.multiFeedback(ca).then(()=>{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(F=>h.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+F.toString()))}static Xde(ca,fa,ma,da){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(V.pob===V.initialized)return Promise.resolve(1);if(V.pob===
V.weg)return V.xeg||(V.xeg=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(V.pob!==V.error){V.pob=V.weg;h.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");if(V.rDj(ca,fa,ma,da))return V.XCj();V.pob=V.error;Promise.reject(V.H0g)}return Promise.reject(0)}static XCj(){try{return v.a.RRk(V.dbj(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>V.e_e())).catch(ca=>{let fa=10;ca&&ca.toString()&&S.a(ca.toString(),V.X0j)&&
(fa=15);h.ULS.sendTraceTag(36546402,356,fa,"BFCOCV Floodgate initialize error:"+ca.toString())})}catch(ca){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+ca.toString()),Promise.reject(V.Lpk)}}static dbj(){return Object.assign(new aa.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static e_e(){return OfficeBrowserFeedback.floodgate.start().then(()=>{V.JZi()}).catch(ca=>{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+
ca.toString())})}static JZi(){V.pob=V.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const ca=B.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const fa of ca.split("|"))fa&&V.logActivity(fa,null)}catch(ca){h.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static Iua(){let ca=!1;const fa=B.AFrameworkApplication.fa;fa&&(ca="teams"===(fa.Ga(B.AFrameworkApplication.eK)||"").toLowerCase());
return P.a.NFa||ca}static M0g(){return"undefined"==typeof OfficeBrowserFeedback}static rDj(ca,fa,ma,da){let qa=!0;try{if(V.M0g())return h.ULS.sendTraceTag(39900617,356,15,V.H0g),!1;OfficeBrowserFeedback.initOptions||(ma.onDismiss=da,ma.onError=fa,ma=V.Ldi(ma),OfficeBrowserFeedback.initOptions=ma);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=V.FKf());fa={};da={};da.onSurveyActivated=V.vyk;da.onTeachingCampaignRender=ma.onTeachingCampaignRender;fa.onSurveyActivatedCallback=
da;fa.onDismiss=ca;fa.autoDismiss=ma.FloodgateUIAutoDismissTimeEnum;fa.telemetryGroup=ma.telemetryGroup;fa.uIStringGetter=ma.uIStringGetter;fa.authTokenCallback=ma.authTokenCallback;fa.augLoopCallback=ma.augLoopCallback;fa.campaignFlights="";fa.governanceServiceEnabled=ma.governanceServiceEnabled;fa.governanceServiceConfig=ma.governanceServiceConfig;fa.personalizerEnabled=ma.personalizerEnabled;fa.messagingServiceSettings=ma.messagingServiceSettings;fa.isPriorityEnabled=ma.isPriorityEnabled;B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&("surveyEnabled"in ma&&(fa.surveyEnabled=ma.surveyEnabled),"showEmailAddress"in ma&&(fa.showEmailAddress=ma.showEmailAddress));fa.isEudbUxEnabled=!1;B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(fa.isEudbUxEnabled=!0);const sa=V.d7i(ma),ia=V.P1f(sa);let Na=V.y7i(ma);for(let Ca in ia){ca=Ca;var F=ia[Ca];-1!==ca.toLowerCase().indexOf("flight")?fa.campaignFlights+=F+";":Na=Na+ca+"="+F+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+
fa.campaignFlights+" campaignQueryParameters: "+Na);fa.campaignQueryParameters=Na;fa.customerVoiceSurveyParams=V.p7i(ma.Application.toString(),V.Iua()?V.Qtl:"");OfficeBrowserFeedback.floodgate.initOptions=fa}catch(sa){qa=!1,h.ULS.sendTraceTag(39900618,356,15,sa.toString())}return qa}static Ldi(ca){try{const fa=ca.applicationGroup?ca.applicationGroup:{},ma=fa.appData,da=ma?G.a(G.a('"'+ma+'"')):{};da.fgUIAutoDismiss=ca.FloodgateUIAutoDismissTimeEnum;fa.appData=G.c(da);ca.applicationGroup=fa}catch(fa){h.ULS.sendTraceTag(588842831,
356,10,"Failed to parse applicationGroup.appData",fa.toString())}return ca}static d7i(ca){ca=Array.isArray(ca.Flights)?ca.Flights:null;ca||(ca=(ca=B.AFrameworkApplication.fa.Ga("FlightId"))?ca.toString().split(";"):null);if(B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const fa=B.AFrameworkApplication.fa.hQc;if(fa)for(let ma in fa){const da={key:ma,value:fa[ma]};-1!==(da&&da.key?da.key.toLowerCase():"").indexOf("floodgateflight")&&
"unset"!==(da&&da.value?da.value.toString().toLowerCase():"")&&ca.push(da.key)}}return ca}static P1f(ca){const fa={SelfTriggerActivity:""};if(!ca||!ca.length)return fa;try{for(let qa=0;qa<ca.length;qa++){let F=ca[qa]?ca[qa].toLowerCase():"";if(-1===F.indexOf("floodgateflight"))continue;const sa=F.lastIndexOf(".");-1!==sa&&(F=F.substring(sa+1,F.length));if(-1!==("AppFlights"in fa?fa.AppFlights:"").indexOf(F))continue;fa.AppFlights="AppFlights"in fa?fa.AppFlights+(";"+F):F;const ia=Q.a.replaceAll(F,
"-",""),Na=B.AFrameworkApplication.fa.Ga(ia);if(Na)try{const Ca=G.a(Na);Ca&&Ca.SelfTriggerActivity||(fa.SelfTriggerActivity+=";"+ia);if(Ca)for(let ha in Ca){var ma=ha,da=Ca[ha];ma in fa?fa[ma]!==da&&(fa[ma]=fa[ma]+";"+da):fa[ma]=da}}catch(Ca){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+ia+" json data",Ca.toString())}else fa.SelfTriggerActivity+=";"+ia}}catch(qa){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",qa.toString())}return fa}static y7i(ca){let fa=
"";const ma={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let F in ma){var da=F,qa=ma[F];let sa=ca[Object(e.a)(String,qa)];sa||(sa=B.AFrameworkApplication.fa.Ga(Object(e.a)(String,qa)));sa&&(fa+=da+"="+encodeURIComponent(sa)+"&")}return fa}static t$k(ca){V.nZd=ca}static vyk(ca,fa,ma){if(ca)try{const qa=fa?fa.getCampaignId():"",F=fa?fa.getLauncherType():"",sa=ma?ma.contextInfo:null;var da=fa?fa.getSurveyInfo():null;const ia=da?da.getPreferredLaunchType():
null,Na=da?da.getMetadata():null,Ca=Na?Na.getContentMetadata():null,ha=Ca?Ca.customSurveyName:null,Ba=Ca?Ca.telemetryEventName:null;V.gKj(qa)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+qa):(da={},da.campaignId=qa,da.surveyName=ha,da.launcherType=F,da.contextInfoLength=sa?sa.length.toString():"-1",da.preferredLaunchType=ia,da.telemetryEventName=Ba,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(da)),F&&"coachingux"===F.toLowerCase()&&
ia&&"default"!==ia.toLowerCase()&&V.zag(Ca,fa,ma)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(da)):(ca.launch(ma),V.ush()))}catch(qa){h.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(qa?qa.toString():""))}else h.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static Kwj(ca){ca=ca?ca.surfaceContext:null;if(!ca||!ca.surveyForm)return h.ULS.sendTraceTag(555071516,
356,10,"Missing activation arguments"),!1;try{const fa=ca.surveyForm.getSurveyInfo(),ma=fa?fa.getMetadata():null,da=ma?ma.getContentMetadata():null;return V.zag(da,ca.surveyForm,ca.surveyParams)}catch(fa){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(fa?fa.toString():""))}return!1}static zag(ca,fa,ma){if(!ca||!ca.customSurveyName||!fa)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(ca?ca.customSurveyName:null)),!1;const da=fa.getCampaignId();
if(ca.telemetryEventName){var qa={["action"]:"Opened",["id"]:da,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:ca.customSurveyName,["telemetryEventName"]:ca.telemetryEventName};V.nZd?V.nZd(ca.telemetryEventName,qa):(B.AFrameworkApplication.hk(ca.telemetryEventName),B.AFrameworkApplication.obc(ca.telemetryEventName),h.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(qa)))}qa=V.Drf.Hb(ca.customSurveyName)?V.Drf.ga(ca.customSurveyName):
null;if(!qa)return h.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+ca.customSurveyName+", "+da),!1;(ca=qa(fa,ma))&&ca.then(F=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(F))}).catch(F=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(F?F.toString():""))});return!0}static gKj(ca){try{return-1!==B.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((ca||
"").toLowerCase())}catch(fa){h.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+ca)}return!1}static logActivity(ca,fa=null){if(V.NUd(ca,"LogActivity")){var ma=V.f7d();ma&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+ca),ma.logActivity(ca,1,fa))}}static YMb(ca){ca?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(ca),V.ush()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static ush(){V.mra(V.$Wf)}static uEj(ca,
fa,ma){var da=[3,2,5,1];const qa=E.FocusManager.instance(),F=qa.Fc(ca);F.parent=z.AFrame.gj;F.bJ=!0;A.a.instance.K2(ca,!0);fa&&F.kca(fa);if(ma){u.a.instance.J7(ca,ma,!1,!0);J.a.instance.J7(ca,ma,!1,!0);ca=new y.DOMFocusListing(()=>ma);for(fa=0;fa<da.length;++fa)ca.Go(da[fa]);qa.Tia(()=>ma,F,ca).nX=!0}}static mra(ca){const fa=document.getElementById(ca);fa?V.uEj(ca,V.mtk,fa):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+ca)}static mtk(ca,fa){h.ULS.sendTraceTag(37107265,356,
100,"BFCOCV.OnFocusAction. PrevScopeName "+(ca?ca.name:"")+" NextScopeName "+(fa?fa.name:""));fa&&(ca=E.FocusManager.instance().uQ(fa.name))&&ca.edd()}static hbc(ca){if(V.NUd(ca,"LogActivityStart")){var fa=V.f7d();fa&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+ca),fa.logActivityStartTime(ca))}}static aqg(ca){if(V.NUd(ca,"LogActivityEnd")){var fa=V.f7d();fa&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+ca),fa.logActivityStopTime(ca,
new Date))}}static KZi(){OfficeBrowserFeedback.floodgate.start()}static LZi(){OfficeBrowserFeedback.floodgate.stop()}static NUd(ca,fa){ca||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+fa);return!!ca}static f7d(){let ca=null;const fa=OfficeBrowserFeedback.floodgate.getEngine();fa?(ca=fa.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):V.r0g||(V.r0g=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));
return ca}static FKf(){return new N}static p7i(ca,fa){return Object.assign(new D,{productName:ca,uiHost:fa,cvFlights:"",isCVSurveyEnabled:!0})}}V.$Wf="obf-ToastContainer";V.notInitialized=0;V.weg=1;V.initialized=2;V.error=-1;V.pob=V.notInitialized;V.r0g=!1;V.xeg=!1;V.X0j="window.localStorage is not available";V.H0g="OFB still undefined";V.Lpk="OFB Floodgate is undefined or does not contain initialize function";V.Qtl="Teams";V.Drf=new n.a(m.a.to());V.nZd=null;Object(I.a)(V,"BrowserFeedbackControlOCV",
null,[])},1024:function(I,Y,d){I=d(0);var h=d(351),e=d(530);class n extends e.a{constructor(E,u=null,J=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=u;this.messageText=E;this.isDeferred=J}}Object(I.a)(n,"DeferredContentProps",e.a,[]);var m=d(28),z=d(928),B=d(929);const v=(E,u)=>Object.assign(new z.a,{target:".EditingRibbonPanel",content:E,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new B.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,
preventDismissOnScroll:!0,onDismiss:u,preventDismissOnResize:!0})});var y=d(48);d.d(Y,"a",function(){return A});class A{constructor(){this.TT=new n(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}mNi(E,u,J,G){G=Object.assign(new h.a,{onShow:()=>{J.pI(y.a.s0a)}});u=E.callout(u);return G=E.addNotification(u,G)}nWk(E,u){E.removeNotification(u);m.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return u}vFi(E){return v(this.TT,
()=>{E.Ko(y.a.s0a)})}}Object(I.a)(A,"DownloadACopyDeferred",null,[495])},1025:function(I,Y,d){I=d(0);var h=d(582),e=d(1200),n=d(298),m=d(501);class z{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(I.a)(z,"CT_LineJoinMiterProperties",null,[]);var B=d(959);class v{constructor(){this.valField=0}}Object(I.a)(v,"CT_PositiveFixedPercentage",null,[]);var y=d(960),A=d(368),E=d(323),u=d(299);d.d(Y,"a",function(){return J});class J{r6f(G,S,P,Q,D,O){G=Object(e.a)(573,O.Ba.mg(D.Ma));P=D.Ld;D=
Math.round(Q.GM(P.Pe(S.width*h.a.aD,0),G.qT));S=Math.round(Q.GM(P.Pe(S.height*h.a.aD,1),G.qT));return{Msh:D,Esh:S}}tJf(G,S){return Object.assign(new n.a,{TopLeft:Object.assign(new u.a,{X:0,Y:0}),TopRight:Object.assign(new u.a,{X:G,Y:0}),BottomLeft:Object.assign(new u.a,{X:0,Y:S}),BottomRight:Object.assign(new u.a,{X:G,Y:S})})}tqh(G){G.lineStyle=Object.assign(new B.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new z,
{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new y.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new E.a,{schemeClrField:Object.assign(new A.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}Eqh(G){G.fill=Object.assign(new m.a,{solidFillField:Object.assign(new E.a,{schemeClrField:Object.assign(new A.a,{valField:4})})});G.lineStyle=Object.assign(new B.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new z,
{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new y.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new E.a,{schemeClrField:this.tGi(Object.assign(new v,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}tGi(G){const S={itemsElementNameField:[26]};S.itemsField=[G];S.valField=4;return S}}Object(I.a)(J,"InsertShapeActorHelper",null,[847])},1035:function(I,Y,d){I=d(0);var h=d(14),e=d(1199),n=d(27),m=d(67),z=d(81);class B{constructor(y,A,E,u=null){this.origin=y;
this.data=A;this.source=E;this.qc=u}}Object(I.a)(B,"MessageEventArgs",null,[]);d.d(Y,"a",function(){return v});class v{constructor(y,A){this.vNd=null;this.t3h=y;this.Zd=A;this.XAc=null}get klb(){return this.t3h.value}get taskManager(){return this.Zd.value}ugi(y){this.XAc=y;this.vNd=Object(h.a)(this,this.sGk,"postMessageEventHandler");this.klb.addHandler(m.a.message,this.vNd,null)}CLi(){this.XAc=null;this.klb.removeHandler(m.a.message,this.vNd)}$Xc(y,A){const E=new z.a(0,1,1,()=>{y(A)},7);this.taskManager.Db(E)}SHj(y,
A){const E=new z.a(0,1,1,()=>{y(A)},7);this.taskManager.Db(E)}sGk(y){return this.XAc?this.XAc(new B(y.origin,y.data,y.source,y.qc)):!1}static get instance(){return v.m9a()}static m9a(){return new v(new e.a(()=>n.AFrameworkApplication.klb),new e.a(()=>n.AFrameworkApplication.ye))}}Object(I.a)(v,"MessageEventHandler",null,[468])},1038:function(I,Y,d){I=d(0);var h=d(387),e=d(105),n=d(270),m=d(14),z=d(1200),B=d(36);class v{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(I.a)(v,"CritiqueTypeOption",
null,[]);var y=d(2);d.d(Y,"a",function(){return A});class A{constructor(E,u,J){this.wKd={};this.ol=null;this.Wmf=E;this.YZh=u;this.ZZh=J;this.W3a=y.Task.Rt({})}init(){this.W3a=this.Wmf.kae(this.YZh,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(m.a)(this,this.Quk,"onLoadSettingsTaskFinished"),8)}lxl(E){const u={};if(!(E&&"ProofingSettingLanguageList"in E))return u;const J=Array.isArray(B.a(E.ProofingSettingLanguageList))?B.a(E.ProofingSettingLanguageList):null;for(const G of J)"ProofingSettings"+
G in E&&(u[G]=Object(z.a)(Object,B.a(E["ProofingSettings"+G])));return u}mxl(E){const u={},J=[];for(let P in E){var G=P,S=E[P];S&&(J.push(G),u["ProofingSettings"+G]=B.c(S))}u.ProofingSettingLanguageList=B.c(J);return u}saveSettings(E){this.W3a=y.Task.Rt(E);this.ol=null;try{const u=this.mxl(E);this.Wmf.Xrh(this.ZZh,u).continueWith(Object(m.a)(this,this.dxk,"onSaveSettingsTaskFinished"),8)}catch(u){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",u.toString())}}k6d(){if(!this.ol){if(6!==
this.W3a.status)return[];try{var E=this.W3a.result;let S;if(e.a.isEmpty(this.wKd))S=E;else if(e.a.isEmpty(E))S=this.wKd;else{S={};var u=this.wKd;for(let P in u)S[P]=e.a.Bqc(u[P]);S=A.merge(S,E)}this.ol=[];for(let P in S){var J=S[P];const Q=n.a.xe(parseInt(P));if(!Q)continue;const D=Q.name;u=J;for(let O in u){E=O;var G=u[O];const X=Object.assign(new v,{LanguageId:D,Id:E,Value:G.toString()});this.ol.push(X)}}}catch(S){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",
S.toString())}}return this.ol}IMi(E,u){const J=this.W3a.result;if(J)try{let G=J[E];G||(G={});G[u]=!1;J[E]=G;this.saveSettings(J)}catch(G){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",G.toString())}}Quk(E){if(E.tm)return h.ULS.sendTraceTag(34964619,375,10,"Load setting failed with exception {0}",E.Yi),null;if(6===E.status)try{return this.lxl(E.result)}catch(u){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",u.toString())}return null}dxk(E){E.tm&&
h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",E.Yi)}static merge(E,u){E=E||{};if(u)for(let S in u){var J=S,G=u[S];E[J]=E[J]||{};for(let P in G)E[J][P]=G[P]}return E}}Object(I.a)(A,"CritiqueTypeSettings",null,[627])},1041:function(I,Y,d){I=d(0);var h=d(134),e=d(80),n=d(1208),m=d(27),z=d(201),B=d(47),v=d(165),y=d(28),A=d(443),E=d(536);class u{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(I.a)(u,"ImagePasteArgs",null,[]);
var J=d(328),G=d(43),S=d(49),P=d(30);d.d(Y,"a",function(){return Q});class Q{constructor(D,O,X,N,aa,V,ca,fa,ma,da,qa,F){this.ia=D;this.Ea=O;this.KHa=X;this.pa=N;this.Uik=aa;this.Po=V;this.Cla=ca;this.Le=da;this.nB=qa;this.Cc=F;this.Lec=fa;this.k7c=ma;this.sad=!1;this.ufc=-1}nQ(D){if(!this.KHa.j9b(this.Ea)||!D)return!1;if(D.pPc&&D.hde)return this.sad=!1,D.nQ=this.Lec;if(!D.un||0<D.un.getElementsByTagName(S.a.Zcg).length)return!1;this.sad=!this.Uxj(D)&&this.zUj(this.pa.Wd());D.nQ=this.sad?this.k7c:
this.Lec;return D.nQ}zUj(D){return 1===D.length?D[0].RVj:!1}cKk(D,O){this.ech(D,O,0);if(!D.firstChild||!D.firstChild.className||!A.a.$fg(D.firstChild.className))if(!this.Po.eg||"<br>"!==D.innerHTML){const X=v.b(D);X&&0<X.length&&(O.XY=D.innerHTML)}}ech(D,O,X){if(D){if(X>=Q.vIc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",Q.vIc));if(1===D.nodeType){var N=D.tagName.toLowerCase();if(this.Cla.CSj(N))D.parentNode.removeChild(D);else{for(let V=D.firstChild;V;V=aa){var aa=V.nextSibling;
this.ech(V,O,X+1)}N===S.a.W8?(D.parentNode.removeChild(D),this.dKk(D,O)):N===S.a.VNb?(D.parentNode.removeChild(D),this.KKk(D,O)):N===S.a.listTag&&this.jKk(D);this.Cc.qWe(D,O.Wb)}}}}jKk(D){if(D){var O=D.getAttribute("data-"+h.a.tZb);if(O&&0<O.length&&D.style){var X=parseInt(O);if(1!==O.length||isNaN(X)||1>X||X>J.a.a8)O="1",X=1;X>this.ufc&&(this.ufc=X);O=String.format(S.a.m_j,O);(X=D.style.cssText)?D.setAttribute("style",O+X):D.setAttribute("style",O)}if((O=D.parentNode)&&!this.Le.xPj(O.tagName)){X=
D.nextSibling;const N=this.Le.E1b();N.appendChild(D);O.insertBefore(N,X)}}}dKk(D,O){if(D&&D.src&&D.src.length){var X=window.location.href.toLowerCase();X=e.a.sQ(X);if(D.src.startsWith(X))y.a.J(20501650,826,50,"Pasted image src is an empty string.");else{X=Math.ceil(n.a.Pe(this.Cla.paj(D),0,!1));var N=Math.ceil(n.a.Pe(this.Cla.gaj(D),1,!1));O.Bda.push(Object.assign(new u,{src:D.src,alt:D.alt,width:X?X:D.width,height:N?N:D.height}))}}}KKk(D,O){D&&D.innerHTML&&D.rows&&D.rows.length&&(D.getElementsByTagName(S.a.bsd).length||
D.getElementsByTagName(S.a.$sl).length)&&(D=v.c(D),!D||0>=D.length||O.alb.push(D))}Uxj(D){if(D.pPc)return!0;const O=D.un.getElementsByTagName(S.a.VNb).length;return 0<D.un.getElementsByTagName(S.a.W8).length||0<O}paste(D){if(m.AFrameworkApplication.PQ)this.Uik.Arc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const O=Object.assign(new E.a,{Wb:D.Wb});let X=!0;O.brc=this.sad;if(D.pPc)O.Bda.push(Object.assign(new u,{src:D.hde,width:0,height:0}));else try{this.cKk(D.un,
O),0<this.ufc&&(y.a.J(21050954,826,50,String.format("max list level pasted into new shape = {0}.",this.ufc-1)),this.ufc=-1)}catch(N){X=!1,y.a.J(23634591,826,15,N.message)}X&&(this.ihl(O)?this.DDk(O):this.ia.La(P.a.vJa,2,O))}}ihl(D){return z.a.Wa(D.alb)&&B.a.Wa(D.XY)&&!!D.Bda&&1===D.Bda.length&&this.LWj(D.Bda[0].src)}LWj(D){if(B.a.Wa(D)||!D.startsWith("data:image"))return!1;D=D.split(";");if(!D||2!==D.length)return!1;D=D[0].replace("/",".");return 0===this.nB.qvd(D,!0)}DDk(D){let O=new Image;const X=
D.Bda[0],N=G.a.Ib;if(X.width&&X.height)D.s_c=!0,this.ia.La(P.a.vJa,2,D);else{const aa=new Date;O.onload=()=>{D.ZJe=+new Date-+aa;X.width=O.width;X.height=O.height;D.s_c=!0;O=null;G.a.AF(N,()=>{this.ia.La(P.a.vJa,2,D)})};O.onerror=()=>{O=null;G.a.AF(N,()=>{this.ia.La(P.a.vJa,2,D)})};O.src=X.src}}}Q.vIc=100;Object(I.a)(Q,"HtmlPasteHandler",null,[1202])},1042:function(I,Y,d){I=d(0);var h=d(18),e=d(27),n=d(1205),m=d(239),z=d(39);class B{constructor(E,u){this.actionId=E;this.rd=u}}Object(I.a)(B,"CommandActionData",
null,[]);var v=d(30),y=d(35);d.d(Y,"a",function(){return A});class A{constructor(E,u,J,G,S,P){this.iWg=[];this.Jkg=!1;this.Lbc=null;this.z3c=new h.a;this.ia=E;this.Wze=u;this.Orf=!1;this.Qb=J;this.lH=G;this.y$=S;this.wsg=this.UDb=null;P&&Object(y.a)("EnhancementOfSDXPaneBootTime")&&this.ECj()}ECj(){this.UDb||(this.UDb=e.AFrameworkApplication.Aj("officeExtensionMerge.js",5));this.wsg||(this.wsg=e.AFrameworkApplication.Aj("appforoffice.hermes"+this.lH.Ome,1));if(!this.Lbc){const E=[this.y$.$tb(this.cGe)];
this.Lbc=n.a.create("pptedit.appforoffice",E,()=>d.e(9).then(d.bind(null,1238)))}}get $td(){return this.iWg}get cGe(){this.UDb||(this.UDb=e.AFrameworkApplication.Aj("officeExtensionMerge.js",5));return this.UDb}set cGe(E){this.UDb=E}get wdi(){if(!this.Lbc){const E=[this.y$.$tb(this.cGe)];this.Lbc=n.a.create("pptedit.appforoffice",E,()=>d.e(9).then(d.bind(null,1238)))}return this.Lbc}k7h(E){this.$td.push(E)}Zia(){this.Jkg||(m.a.ey(this.wdi),this.Jkg=!0)}Wxl(){for(const E of this.$td)E.okb();this.iWg=
[]}Xxl(){var E=this.Qb.Nc(this.Wze.Ef).Bb(18);E=this.Qb.Nc(E);let u=E.Bb(19);if(u){do u=E.yq,this.ia.La(v.a.Iib,2,u.eb(z.a.KZ));while(E.Cf(19))}}xPa(E,u){this.z3c.add(new B(E,u))}krj(){if(0<this.z3c.count){for(let E of this.z3c)this.ia.La(E.actionId,2,E.rd);this.z3c.clear()}}Fbe(){const E=!!this.$td&&0<this.$td.length;let u=!1;if(this.Wze.Ef&&!E){const J=this.Qb.Nc(this.Wze.Ef).Bb(18);J&&0<this.Qb.Nc(J).E8(19)&&(u=!0)}return E||u}}Object(I.a)(A,"AppForOfficeManagerFactory",null,[720])},1043:function(I,
Y,d){I=d(0);var h=d(47);class e{constructor(m,z){this.A$j=m;this.y8c=z}get CUa(){return this.A$j}get message(){return this.y8c}}Object(I.a)(e,"CalloutNotificationError",null,[]);d.d(Y,"a",function(){return n});class n{constructor(m,z){this.vtg=m;this.sfk=z}fga(m,z,B,v,y,A,E,u,J,G,S,P){this.vtg.show(this.sfk,null,!1,J,G,m,z,B,y,v,A,E,u,S,P)}I_d(){this.vtg.dismiss()}bvh(m){if(!m)throw Error.argumentNull("CalloutNotificationMessageAttributes");const z=this.ZHl(m);if(z&&z.CUa)return z;this.fga(m.title,
m.message,m.tbg,m.MIb,m.ybg,m.ind,m.qJk,m.A6k,m.rJk,m.B6k,!!m.timeoutInSeconds,m.timeoutInSeconds);return new e(!1,null)}ZHl(m){return h.a.Wa(m.title)?new e(!0,"Invalid Title"):h.a.Wa(m.message)?new e(!0,"Invalid Message"):m.tbg&&h.a.Wa(m.MIb)?new e(!0,"Missing PrimaryButtonLabel"):m.ybg&&h.a.Wa(m.ind)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(I.a)(n,"CalloutNotificationAdapter",null,[557])},1044:function(I,Y,d){I=d(0);var h=d(27),e=d(730),n=d(231);class m extends e.a{constructor(B,
v){super(B);this.U5j=v}bCh(B){return n.i(n.g(B))}X1e(B){return n.i(B)}utc(B){return this.U5j?B.Yhi:B.utc().toString()}Dli(B,v,y){const A=new Sys.StringBuilder;A.append(String.format('<Menu Id="{0}">',"menuFontColor"));A.append(this.xae(B,v,y));A.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');A.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",
h.AFrameworkApplication.rm,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));A.append("</Controls> </MenuSection>");A.append("</Menu>");return A.toString()}}Object(I.a)(m,"ColorMenuBuilder",e.a,[]);d.d(Y,"a",function(){return z});class z{z5i(B){return new e.a(B)}T_f(B,v){return new m(B,v)}}Object(I.a)(z,"ColorPickerBuilderFactory",null,[631])},1046:function(I,Y,d){I=d(0);var h=d(660),e=d(143);class n extends h.a{constructor(){super();this.languageId=null;this.startOfSentence=
!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(I.a)(n,"TextPredictorSignalBase",h.a,[]);d.d(Y,"a",function(){return m});class m extends n{constructor(){super();this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static getBaseTypes(){return["AugLoop_Signals_TextPredictorSignalBase",
"AugLoop_Signals_Signal"]}}Object(I.a)(m,"TextPredictorSignal",n,[])},111:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(1228);class e{constructor(){this.f9a=this.$Af=this.w3=this.Kaa=this.tIc=this.$Qc=this.awb=this.QDa=this.YZ=this.oKc=this.Zsd=null}Mf(n){this.Zsd=new h.a;this.Zsd.value=n}Qpc(){this.oKc=new h.a;this.oKc.value=!0}VU(n){this.$Qc=new h.a;this.$Qc.value=n}}Object(I.a)(e,"QueryResult",null,[])},1112:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(97);class e{constructor(n){this.Iyd=
n.cloneNode(!0);this.okf=n}restore(){for(h.a.Au(this.okf);this.Iyd.firstChild;){const n=this.Iyd.firstChild;h.a.$O(n);this.okf.appendChild(n)}this.Iyd=null}}Object(I.a)(e,"DomElementContentState",null,[])},1113:function(I,Y,d){d.r(Y);d.d(Y,"SpellingRequestObjectUpdatedV2",function(){return n});I=d(0);var h=d(665),e=d(664);class n extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=
0}static O4d(m,z){const B=new n;h.a.UKe(B,m,z);B.UserActionType=e.a[m.userAction];B.ProofingEngine=m.Mfa;B.Descriptors=m.descriptors;B.OverriddenCritiqueTypeOptions=m.overriddenCritiqueTypeOptions;B.UxLcid=m.EIh;2===m.Mfa?B.TextUnit=m.range.textUnit:1===m.Mfa&&(B.UseContextualResults=!0);return B}}Object(I.a)(n,"SpellingRequestObjectUpdatedV2",h.a,[])},1114:function(I,Y,d){d.r(Y);d.d(Y,"SpellingRequestObjectUpdated",function(){return n});I=d(0);var h=d(665),e=d(664);class n extends h.a{constructor(){super();
this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static O4d(m,z,B,v,y,A){const E=new n;h.a.UKe(E,m,z);E.UserActionType=e.a[m.userAction];E.UseOneSpeller=B;E.TrackMetrics=v;E.UseContextualResults=y;A&&(E.ExperimentId=A);return E}}Object(I.a)(n,"SpellingRequestObjectUpdated",h.a,[])},1115:function(I,Y,d){d.r(Y);d.d(Y,"ReactOICErrorDialogWithTrial",function(){return m});I=d(0);var h=d(14);Y=d(921);var e=d(197),n=d(82);class m extends Y.a{constructor(z,B,v,y,A,
E){super(z,B,v,y,A,E);B={["errorMessage"]:this.SSf,["offerString"]:this.L0g};z=new n.a(!1,!1,!0);this.uvh?(z.xd=1,B.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.WTa,["onExecute"]:()=>{e.Redirect.showHelp(this.Nbg)}}):(z.xd=4,z.Xe(2,this.Mcg));z.Xe(1,this.yrf);z.hg=this.id;B={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:B};z.Zi(this.sRa,Object(h.a)(this,this.sQk,"reactOICErrorDialogWithTrialHandler"),B)}}Object(I.a)(m,"ReactOICErrorDialogWithTrial",Y.a,[])},1116:function(I,
Y,d){d.r(Y);d.d(Y,"OICErrorDialogWithTrial",function(){return n});I=d(0);var h=d(14);Y=d(921);var e=d(108);class n extends Y.a{constructor(m,z,B,v,y,A){super(m,z,B,v,y,A);m=document.createElement("span");m.innerText=this.SSf;m.appendChild(document.createElement("br"));m.appendChild(document.createElement("br"));z=document.createElement("span");z.innerText=this.L0g;m.appendChild(z);z=new e.StandardDialog;this.uvh?(z.xd=1,z.zOd(this.WTa,this.Nbg)):(z.xd=4,z.Xe(2,this.Mcg));z.Xe(1,this.yrf);z.hg=this.id;
z.Gx(this.sRa,null,this.icon,Object(h.a)(this,this.OZj,"legacyOICErrorDialogWithTrialHandler"),m)}}Object(I.a)(n,"OICErrorDialogWithTrial",Y.a,[])},1117:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(I.a)(h,"HeaderButtonInfo",null,[])},1118:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(I.a)(h,"CalloutButtonProps",
null,[])},1119:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.y=this.x=0}}Object(I.a)(h,"IPoint",null,[])},1120:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(27);d=d(78);class e{static P9h(n){e.c7e.addHandler(e.CGf,n)}static uNk(n){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.c7e.raiseEvent(e.CGf,n)}}e.CGf="CommandClickEvent";e.c7e=new d.a;Object(I.a)(e,"CommandClickEvents",null,[])},1121:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";Object(I.a)(h,"SplitButtonCommandProperties",null,[])},1122:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n=null,m=null,z=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=n;this.iconSet.icon24=
m;this.iconSet.icon32=z}}Object(I.a)(h,"IconSetContainer",null,[])},1123:function(I,Y,d){d.r(Y);d.d(Y,"NewCustomEventFactory",function(){return h});I=d(0);d=d(534);class h extends d.a{constructor(){super()}create(e,n){const m={};m.detail=n;return new CustomEvent(e,m)}}Object(I.a)(h,"NewCustomEventFactory",d.a,[])},1124:function(I,Y,d){d.r(Y);d.d(Y,"IECustomEventFactory",function(){return h});I=d(0);d=d(534);class h extends d.a{constructor(){super()}create(e,n){const m=window.document.createEvent("CustomEvent");
m.initCustomEvent(e,!1,!1,n);return m}}Object(I.a)(h,"IECustomEventFactory",d.a,[])},1125:function(I,Y,d){d.r(Y);d.d(Y,"CheckRoamingRightsRequest",function(){return h});I=d(0);d=d(953);class h extends d.a{constructor(){super()}kxb(){return 2}Zk(){return 1}}Object(I.a)(h,"CheckRoamingRightsRequest",d.a,[])},1126:function(I,Y,d){d.r(Y);d.d(Y,"GetRoamingLauncherRequest",function(){return h});I=d(0);d=d(953);class h extends d.a{constructor(){super()}kxb(){return 0}Zk(){return 2}}Object(I.a)(h,"GetRoamingLauncherRequest",
d.a,[])},1127:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(356);class h extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(I.a)(h,"IconGalleryButtonProps",d.a,[])},1128:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.Eah="WAC_Powerpoint";h.d8b=null;Object(I.a)(h,"AddinHostApp",null,[])},1129:function(I,Y,d){d.d(Y,"a",function(){return n});I=d(0);var h=d(200),e=d(95);class n{constructor(m){this.dw=
m;this.cN=Array.indexOf(this.dw,this.Pja)}dispose(){this.dw=null}get b_(){return this.dw[this.cN]}YE(m){this.Rpc(m,!1);return!0}b9a(m){this.Rpc(m,!0)}Rpc(m,z){m&&(this.b_!==m||z)&&(m.tabIndex=0,e.FocusManager.Wr(m));Array.contains(this.dw,m)&&(this.cN=Array.indexOf(this.dw,m))}get Cbh(){let m=this.cN;do if(m)if(0<m&&m<this.dw.length)m--;else break;else m=this.dw.length-1;while(!h.DOMFocusListing.pDa(this.dw[m])&&m!==this.cN);return this.dw[m]}get B_g(){let m=this.cN;do if(m===this.dw.length-1)m=0;
else if(0<=m&&m<this.dw.length-1)m++;else break;while(!h.DOMFocusListing.pDa(this.dw[m])&&m!==this.cN);return this.dw[m]}get Pja(){let m=0;for(;!h.DOMFocusListing.pDa(this.dw[m])&&m<this.dw.length;)m++;return h.DOMFocusListing.pDa(this.dw[m])?this.dw[m]:null}get FAb(){let m=this.dw.length-1;for(;!h.DOMFocusListing.pDa(this.dw[m])&&0<m;)m--;return h.DOMFocusListing.pDa(this.dw[m])?this.dw[m]:null}}Object(I.a)(n,"DialogFocusListing",null,[232])},1130:function(I){(function(Y,d){I.exports=d()})(this,
function(){function Y(qc,$a){if("object"!==d(qc)||"function"!==typeof qc.createPolicy)return null;var ab=null;$a.currentScript&&$a.currentScript.hasAttribute("data-tt-policy-suffix")&&(ab=$a.currentScript.getAttribute("data-tt-policy-suffix"));$a="dompurify"+(ab?"#"+ab:"");try{return qc.createPolicy($a,{createHTML:function(Ib){return Ib},createScriptURL:function(Ib){return Ib}})}catch(Ib){return console.warn("TrustedTypes policy "+$a+" could not be created."),null}}function d(qc){"@babel/helpers - typeof";
return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function($a){return typeof $a}:function($a){return $a&&"function"==typeof Symbol&&$a.constructor===Symbol&&$a!==Symbol.prototype?"symbol":typeof $a},d(qc)}function h(qc,$a){h=Object.setPrototypeOf||function(ab,Ib){ab.__proto__=Ib;return ab};return h(qc,$a)}function e(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.kOl)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,
[],function(){})),!0}catch(qc){return!1}}function n(qc,$a,ab){n=e()?Reflect.construct:function(Ib,gc,Ta){var Ab=[null];Ab.push.apply(Ab,gc);Ib=new (Function.bind.apply(Ib,Ab));Ta&&h(Ib,Ta.prototype);return Ib};return n.apply(null,arguments)}function m(qc){var $a=Array.isArray(qc)?z(qc):void 0;$a||($a="undefined"!==typeof Symbol&&null!=qc[Symbol.iterator]||null!=qc["@@iterator"]?Array.from(qc):void 0);if(!$a)a:{if(qc){if("string"===typeof qc){$a=z(qc,void 0);break a}$a=Object.prototype.toString.call(qc).slice(8,
-1);"Object"===$a&&qc.constructor&&($a=qc.constructor.name);if("Map"===$a||"Set"===$a){$a=Array.from(qc);break a}if("Arguments"===$a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($a)){$a=z(qc,void 0);break a}}$a=void 0}if(!(qc=$a))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return qc}function z(qc,$a){if(null==$a||$a>qc.length)$a=qc.length;for(var ab=0,Ib=Array($a);ab<$a;ab++)Ib[ab]=
qc[ab];return Ib}function B(qc){return function($a){for(var ab=arguments.length,Ib=Array(1<ab?ab-1:0),gc=1;gc<ab;gc++)Ib[gc-1]=arguments[gc];return N(qc,$a,Ib)}}function v(qc,$a,ab){ab=ab?ab:ma;J&&J(qc,null);for(var Ib=$a.length;Ib--;){var gc=$a[Ib];if("string"===typeof gc){var Ta=ab(gc);Ta!==gc&&(G($a)||($a[Ib]=Ta),gc=Ta)}qc[gc]=!0}return qc}function y(qc){var $a=O(null),ab;for(ab in qc)N(u,qc,[ab])&&($a[ab]=qc[ab]);return $a}function A(qc,$a){for(;null!==qc;){var ab=P(qc,$a);if(ab){if(ab.get)return B(ab.get);
if("function"===typeof ab.value)return B(ab.value)}qc=S(qc)}return function(Ib){console.warn("fallback value for",Ib);return null}}function E(){function qc(yd){var me,Ic;ab("beforeSanitizeAttributes",yd,null);var Fe=yd.attributes;if(Fe){var Uc={attrName:"",Byf:"",pog:!0,cMl:Kd};for(Ic=Fe.length;Ic--;){var Uf=me=Fe[Ic],vg=Uf.name;Uf=Uf.namespaceURI;me="value"===vg?me.value:ia(me.value);var Yg=ff(vg);Uc.attrName=Yg;Uc.Byf=me;Uc.pog=!0;Uc.C_i=void 0;ab("uponSanitizeAttribute",yd,Uc);me=Uc.Byf;if(!Uc.C_i&&
(Ab(vg,yd),Uc.pog))if(Na(/\/>/i,me))Ab(vg,yd);else{Dd&&(me=F(me,rb," "),me=F(me,ac," "),me=F(me,Jc," "));var Cc=ff(yd.nodeName);a:{var Rc=Cc;var Ve=Yg,ob=me;if(Od&&("id"===Ve||"name"===Ve)&&(ob in Ub||ob in wh))Rc=!1;else{if(!Nc||Bb[Ve]||!Na(Db,Ve))if(!mc||!Na(dd,Ve))if(!Kd[Ve]||Bb[Ve]){if(!(0<Rc.indexOf("-")&&(ve.I1 instanceof RegExp&&Na(ve.I1,Rc)||ve.I1 instanceof Function&&ve.I1(Rc))&&(ve.w6a instanceof RegExp&&Na(ve.w6a,Ve)||ve.w6a instanceof Function&&ve.w6a(Ve))||"is"===Ve&&ve.aHc&&(ve.I1 instanceof
RegExp&&Na(ve.I1,ob)||ve.I1 instanceof Function&&ve.I1(ob)))){Rc=!1;break a}}else if(!(Cb[Ve]||Na(Ge,F(ob,pd,""))||("src"===Ve||"xlink:href"===Ve||"href"===Ve)&&"script"!==Rc&&0===sa(ob,"data:")&&dg[Rc]||nd&&!Na(Cd,F(ob,pd,"")))&&ob){Rc=!1;break a}Rc=!0}}if(Rc){!Oc||"id"!==Yg&&"name"!==Yg||(Ab(vg,yd),me="user-content-"+me);if(ud&&"object"===d(Wb)&&"function"===typeof Wb.getAttributeType&&!Uf)switch(Wb.getAttributeType(Cc,Yg)){case "TrustedHTML":me=ud.createHTML(me);break;case "TrustedScriptURL":me=
ud.createScriptURL(me)}try{Uf?yd.setAttributeNS(Uf,vg,me):yd.setAttribute(vg,me),ca(Qb.removed)}catch(Mb){}}}}ab("afterSanitizeAttributes",yd,null)}}function $a(yd){ab("beforeSanitizeElements",yd,null);if(yd instanceof ic&&("string"!==typeof yd.nodeName||"string"!==typeof yd.textContent||"function"!==typeof yd.removeChild||!(yd.attributes instanceof Vb)||"function"!==typeof yd.removeAttribute||"function"!==typeof yd.setAttribute||"string"!==typeof yd.namespaceURI||"function"!==typeof yd.insertBefore||
"function"!==typeof yd.hasChildNodes)||Na(/[\u0080-\uFFFF]/,yd.nodeName))return kc(yd),!0;var me=ff(yd.nodeName);ab("uponSanitizeElement",yd,{tagName:me,dMl:kd});if(!(!yd.hasChildNodes()||Ib(yd.firstElementChild)||Ib(yd.content)&&Ib(yd.content.firstElementChild))&&Na(/<[/\w]/g,yd.innerHTML)&&Na(/<[/\w]/g,yd.textContent)||"select"===me&&Na(/<template/i,yd.innerHTML))return kc(yd),!0;if(!kd[me]||Ua[me]){if(!Ua[me]&&0<me.indexOf("-")&&(ve.I1 instanceof RegExp&&Na(ve.I1,me)||ve.I1 instanceof Function&&
ve.I1(me)))return!1;if(Af&&!Wd[me]){me=wc(yd)||yd.parentNode;var Ic=Rb(yd)||yd.childNodes;if(Ic&&me)for(var Fe=Ic.length-1;0<=Fe;--Fe)me.insertBefore(Xc(Ic[Fe],!0),xb(yd))}kc(yd);return!0}if(Ic=yd instanceof Hc){(Ic=wc(yd))&&Ic.tagName||(Ic={namespaceURI:of,tagName:"template"});Fe=ma(yd.tagName);var Uc=ma(Ic.tagName);Ic=!(vd[yd.namespaceURI]&&("http://www.w3.org/2000/svg"===yd.namespaceURI?"http://www.w3.org/1999/xhtml"===Ic.namespaceURI?"svg"===Fe:"http://www.w3.org/1998/Math/MathML"===Ic.namespaceURI?
"svg"===Fe&&("annotation-xml"===Uc||xh[Uc]):Ag[Fe]:"http://www.w3.org/1998/Math/MathML"===yd.namespaceURI?"http://www.w3.org/1999/xhtml"===Ic.namespaceURI?"math"===Fe:"http://www.w3.org/2000/svg"===Ic.namespaceURI?"math"===Fe&&qd[Uc]:He[Fe]:"http://www.w3.org/1999/xhtml"===yd.namespaceURI?"http://www.w3.org/2000/svg"===Ic.namespaceURI&&!qd[Uc]||"http://www.w3.org/1998/Math/MathML"===Ic.namespaceURI&&!xh[Uc]?0:!He[Fe]&&(Hf[Fe]||!Ag[Fe]):"application/xhtml+xml"===tf&&vd[yd.namespaceURI]))}if(Ic||("noscript"===
me||"noembed"===me)&&Na(/<\/no(script|embed)/i,yd.innerHTML))return kc(yd),!0;Dd&&3===yd.nodeType&&(me=yd.textContent,me=F(me,rb," "),me=F(me,ac," "),me=F(me,Jc," "),yd.textContent!==me&&(fa(Qb.removed,{element:yd.cloneNode()}),yd.textContent=me));ab("afterSanitizeElements",yd,null);return!1}function ab(yd,me,Ic){ec[yd]&&V(ec[yd],function(Fe){Fe.call(Qb,me,Ic,Ef)})}function Ib(yd){return"object"===d(Gb)?yd instanceof Gb:yd&&"object"===d(yd)&&"number"===typeof yd.nodeType&&"string"===typeof yd.nodeName}
function gc(yd){return Yb.call(yd.ownerDocument||yd,yd,$b.SHOW_ELEMENT|$b.SHOW_COMMENT|$b.SHOW_TEXT,null,!1)}function Ta(yd){if(gb)yd="<remove></remove>"+yd;else var me=(me=qa(yd,/^[\r\n\t ]+/))&&me[0];"application/xhtml+xml"===tf&&"http://www.w3.org/1999/xhtml"===of&&(yd='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+yd+"</body></html>");var Ic=ud?ud.createHTML(yd):yd;if("http://www.w3.org/1999/xhtml"===of)try{var Fe=(new qb).parseFromString(Ic,tf)}catch(Uc){}if(!Fe||!Fe.documentElement){Fe=
db.createDocument(of,"template",null);try{Fe.documentElement.innerHTML=Lg?"":Ic}catch(Uc){}}Ic=Fe.body||Fe.documentElement;yd&&me&&Ic.insertBefore(Ub.createTextNode(me),Ic.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===of?Kb.call(Fe,La?"html":"body")[0]:La?Fe.documentElement:Ic}function Ab(yd,me){try{fa(Qb.removed,{attribute:me.getAttributeNode(yd),from:me})}catch(Ic){fa(Qb.removed,{attribute:null,from:me})}me.removeAttribute(yd);if("is"===yd&&!Kd[yd])if(vc||td)try{kc(me)}catch(Ic){}else try{me.setAttribute(yd,
"")}catch(Ic){}}function kc(yd){fa(Qb.removed,{element:yd});try{yd.parentNode.removeChild(yd)}catch(me){try{yd.outerHTML=uc}catch(Ic){yd.remove()}}}function fb(yd){return yd instanceof RegExp||yd instanceof Function}function Qb(yd){return E(yd)}var mb=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;Qb.version="2.4.1";Qb.removed=[];if(!mb||!mb.document||9!==mb.document.nodeType)return Qb.g0c=!1,Qb;var Jb=mb.document,Ub=mb.document,tb=mb.DocumentFragment,
Bc=mb.HTMLTemplateElement,Gb=mb.Node,Hc=mb.Element,$b=mb.NodeFilter,lc=mb.NamedNodeMap,Vb=void 0===lc?mb.NamedNodeMap||mb.MLl:lc,ic=mb.HTMLFormElement,qb=mb.DOMParser,Wb=mb.trustedTypes;lc=Hc.prototype;var Xc=A(lc,"cloneNode"),xb=A(lc,"nextSibling"),Rb=A(lc,"childNodes"),wc=A(lc,"parentNode");"function"===typeof Bc&&(Bc=Ub.createElement("template"),Bc.content&&Bc.content.ownerDocument&&(Ub=Bc.content.ownerDocument));var ud=Y(Wb,Jb),uc=ud?ud.createHTML(""):"";Bc=Ub;var db=Bc.implementation,Yb=Bc.createNodeIterator,
Zc=Bc.createDocumentFragment,Kb=Bc.getElementsByTagName,Yc=Jb.importNode;Bc={};try{Bc=y(Ub).documentMode?Ub.documentMode:{}}catch(yd){}var ec={};Qb.g0c="function"===typeof wc&&db&&"undefined"!==typeof db.createHTMLDocument&&9!==Bc;var rb=Oa,ac=oa,Jc=Xa,Db=Hb,dd=Ob,Cd=Eb,pd=oc,Ge=eb,kd=null,Xf=v({},[].concat(m(ha),m(Ba),m(va),m(Fa),m(ka))),Kd=null,lg=v({},[].concat(m(Ha),m(Ya),m(Ka),m(Pa))),ve=Object.seal(Object.create(null,{I1:{writable:!0,configurable:!1,enumerable:!0,value:null},w6a:{writable:!0,
configurable:!1,enumerable:!0,value:null},aHc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ua=null,Bb=null,mc=!0,Nc=!0,nd=!1,Dd=!1,La=!1,gb=!1,vc=!1,td=!1,Nd=!1,Od=!0,Oc=!1,Af=!0,Ae=!1,Ye={},Wd=null,je=v({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),dg=null,nf=v({},"audio video img source image track".split(" ")),Cb=null,Cf=v({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),
of="http://www.w3.org/1999/xhtml",Lg=!1,vd=null,Lh=v({},["http://www.w3.org/1998/Math/MathML","http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],da),tf,Ue=["application/xhtml+xml","text/html"],ff,Ef=null,wh=Ub.createElement("form"),xh=v({},["mi","mo","mn","ms","mtext"]),qd=v({},["foreignobject","desc","title","annotation-xml"]),Hf=v({},["title","style","font","a","script"]),Ag=v({},Ba);v(Ag,va);v(Ag,ta);var He=v({},Fa);v(He,pa);var af=function Ic(me){var Fe,Uc=gc(me);for(ab("beforeSanitizeShadowDOM",
me,null);Fe=Uc.nextNode();)ab("uponSanitizeShadowNode",Fe,null),$a(Fe)||(Fe.content instanceof tb&&Ic(Fe.content),qc(Fe));ab("afterSanitizeShadowDOM",me,null)};Qb.sanitize=function(me){var Ic=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(Lg=!me)&&(me="\x3c!--\x3e");if("string"!==typeof me&&!Ib(me)){if("function"!==typeof me.toString)throw Ca("toString is not a function");me=me.toString();if("string"!==typeof me)throw Ca("dirty is not a string, aborting");}if(!Qb.g0c){if("object"===d(mb.$1e)||
"function"===typeof mb.$1e){if("string"===typeof me)return mb.$1e(me);if(Ib(me))return mb.$1e(me.outerHTML)}return me}Ef&&Ef===Ic||(Ic&&"object"===d(Ic)||(Ic={}),Ic=y(Ic),tf=-1===Ue.indexOf(Ic.BLh)?tf="text/html":tf=Ic.BLh,ff="application/xhtml+xml"===tf?da:ma,kd="ALLOWED_TAGS"in Ic?v({},Ic.qLl,ff):Xf,Kd="ALLOWED_ATTR"in Ic?v({},Ic.oLl,ff):lg,vd="ALLOWED_NAMESPACES"in Ic?v({},Ic.pLl,da):Lh,Cb="ADD_URI_SAFE_ATTR"in Ic?v(y(Cf),Ic.B6e,ff):Cf,dg="ADD_DATA_URI_TAGS"in Ic?v(y(nf),Ic.nLl,ff):nf,Wd="FORBID_CONTENTS"in
Ic?v({},Ic.J6e,ff):je,Ua="FORBID_TAGS"in Ic?v({},Ic.HLl,ff):{},Bb="FORBID_ATTR"in Ic?v({},Ic.GLl,ff):{},Ye="USE_PROFILES"in Ic?Ic.WLl:!1,mc=!1!==Ic.sLl,Nc=!1!==Ic.tLl,nd=Ic.uLl||!1,Dd=Ic.RLl||!1,La=Ic.XLl||!1,vc=Ic.OLl||!1,td=Ic.PLl||!1,Nd=Ic.QLl||!1,gb=Ic.ILl||!1,Od=!1!==Ic.SLl,Oc=Ic.TLl||!1,Af=!1!==Ic.KLl,Ae=Ic.JLl||!1,Ge=Ic.rLl||Ge,of=Ic.NLl||"http://www.w3.org/1999/xhtml",Ic.BMa&&fb(Ic.BMa.I1)&&(ve.I1=Ic.BMa.I1),Ic.BMa&&fb(Ic.BMa.w6a)&&(ve.w6a=Ic.BMa.w6a),Ic.BMa&&"boolean"===typeof Ic.BMa.aHc&&
(ve.aHc=Ic.BMa.aHc),Dd&&(Nc=!1),td&&(vc=!0),Ye&&(kd=v({},m(ka)),Kd=[],!0===Ye.html&&(v(kd,ha),v(Kd,Ha)),!0===Ye.esl&&(v(kd,Ba),v(Kd,Ya),v(Kd,Pa)),!0===Ye.rOl&&(v(kd,va),v(Kd,Ya),v(Kd,Pa)),!0===Ye.gNl&&(v(kd,Fa),v(Kd,Ka),v(Kd,Pa))),Ic.xKh&&(kd===Xf&&(kd=y(kd)),v(kd,Ic.xKh,ff)),Ic.wKh&&(Kd===lg&&(Kd=y(Kd)),v(Kd,Ic.wKh,ff)),Ic.B6e&&v(Cb,Ic.B6e,ff),Ic.J6e&&(Wd===je&&(Wd=y(Wd)),v(Wd,Ic.J6e,ff)),Af&&(kd["#text"]=!0),La&&v(kd,["html","head","body"]),kd.table&&(v(kd,["tbody"]),delete Ua.UAh),Q&&Q(Ic),Ef=
Ic);Qb.removed=[];"string"===typeof me&&(Ae=!1);if(Ae){if(me.nodeName&&(Ic=ff(me.nodeName),!kd[Ic]||Ua[Ic]))throw Ca("root node is forbidden and cannot be sanitized in-place");}else if(me instanceof Gb){var Fe=Ta("\x3c!----\x3e");Ic=Fe.ownerDocument.importNode(me,!0);1===Ic.nodeType&&"BODY"===Ic.nodeName?Fe=Ic:"HTML"===Ic.nodeName?Fe=Ic:Fe.appendChild(Ic)}else{if(!vc&&!Dd&&!La&&-1===me.indexOf("<"))return ud&&Nd?ud.createHTML(me):me;Fe=Ta(me);if(!Fe)return vc?null:Nd?uc:""}Fe&&gb&&kc(Fe.firstChild);
for(var Uc=gc(Ae?me:Fe);Ic=Uc.nextNode();)if((3!==Ic.nodeType||Ic!==Uf)&&!$a(Ic)){Ic.content instanceof tb&&af(Ic.content);qc(Ic);var Uf=Ic}if(Ae)return me;if(vc){if(td)for(Uf=Zc.call(Fe.ownerDocument);Fe.firstChild;)Uf.appendChild(Fe.firstChild);else Uf=Fe;Kd.jOl&&(Uf=Yc.call(Jb,Uf,!0));return Uf}Uf=La?Fe.outerHTML:Fe.innerHTML;La&&kd["!doctype"]&&Fe.ownerDocument&&Fe.ownerDocument.doctype&&Fe.ownerDocument.doctype.name&&Na(Sb,Fe.ownerDocument.doctype.name)&&(Uf="<!DOCTYPE "+Fe.ownerDocument.doctype.name+
">\n"+Uf);Dd&&(Uf=F(Uf,rb," "),Uf=F(Uf,ac," "),Uf=F(Uf,Jc," "));return ud&&Nd?ud.createHTML(Uf):Uf};return Qb}var u=Object.hasOwnProperty,J=Object.setPrototypeOf,G=Object.isFrozen,S=Object.getPrototypeOf,P=Object.getOwnPropertyDescriptor,Q=Object.freeze,D=Object.seal,O=Object.create,X="undefined"!==typeof Reflect&&Reflect,N=X.apply,aa=X.construct;N||(N=function(qc,$a,ab){return qc.apply($a,ab)});Q||(Q=function(qc){return qc});D||(D=function(qc){return qc});aa||(aa=function(qc,$a){return n(qc,m($a))});
var V=B(Array.prototype.forEach),ca=B(Array.prototype.pop),fa=B(Array.prototype.push),ma=B(String.prototype.toLowerCase),da=B(String.prototype.toString),qa=B(String.prototype.match),F=B(String.prototype.replace),sa=B(String.prototype.indexOf),ia=B(String.prototype.trim),Na=B(RegExp.prototype.test),Ca=function(qc){return function(){for(var $a=arguments.length,ab=Array($a),Ib=0;Ib<$a;Ib++)ab[Ib]=arguments[Ib];return aa(qc,ab)}}(TypeError),ha=Q("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
Ba=Q("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),va=Q("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
ta=Q("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Fa=Q("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),pa=Q("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
ka=Q(["#text"]),Ha=Q("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
Ya=Q("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Ka=Q("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Pa=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Oa=D(/\{\{[\w\W]*|[\w\W]*\}\}/gm),oa=D(/<%[\w\W]*|[\w\W]*%>/gm),Xa=D(/\${[\w\W]*}/gm),Hb=D(/^data-[\-\w.\u00B7-\uFFFF]/),Ob=D(/^aria-[\-\w]+$/),eb=D(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Eb=D(/^(?:\w+script|data):/i),oc=D(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sb=D(/^html$/i);return E()})},1131:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.InsertionPoint=
this.GalleryButtons=this.Title=this.SectionId=null}}Object(I.a)(h,"GallerySectionProps",null,[])},1132:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(304);class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(I.a)(h,"LabelCommandProperties",null,[])},1139:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(14),n=d(1200),m=d(27),z=d(141),B=d(459),v=d(269),y=d(198),A=d(57),E=d(73),u=d(37);class J{constructor(fb,Qb,mb,Jb,Ub){this.mGd=null;this.BP=
!0;this.uP=null;this.Ca=fb;this.Rh=Qb;this.qzd=mb;this.B_h=Jb;this.Xg=Ub;m.AFrameworkApplication.rGc(Object(e.a)(this,this.gEl,"updateLastError"));this.B_h.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(this.BP=m.AFrameworkApplication.TE,A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(tb=>{tb.isFeatureEnabled("mso_sendASmile",!0).then(Bc=>{this.BP=m.AFrameworkApplication.TE&&Bc;this.Rh&&this.Rh.updateCommandUI();
return null},()=>null)})):A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(tb=>{tb.C3("Enabled").then(Bc=>{this.BP=Bc;return null},()=>null)})}get Xg(){this.uP||(m.AFrameworkApplication.Xg||(m.AFrameworkApplication.Xg=new B.a),this.uP=m.AFrameworkApplication.Xg);return this.uP}set Xg(fb){this.uP=fb}gEl(fb,Qb){void 0!==Qb&&null!==Qb&&Qb&&(this.mGd=Qb.errorCode)}wb(){this.Ca.ya(u.a.giveFeedback,E.a.frame,Object(e.a)(this,this.hpj,"giveFeedbackHandler"));this.Ca.ya(u.a.N2e,
E.a.frame,Object(e.a)(this,this.N2e,"triggerFloodgateSurvey"));this.Rh.updateCommandUI()}N2e(fb,Qb,mb,Jb,Ub){if(1===mb)return 32;if(2===mb&&!Ub)return 8;A.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(tb=>{tb.logActivity(Object(n.a)(String,Ub.ActivityName),Object(n.a)(String,Ub.BRSName))});return 32}hpj(fb,Qb,mb,Jb,Ub){if(1===mb)return m.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.BP=!1),this.BP&&y.SessionStatusManager.instance.G_?32:8;if(2===mb){h.ULS.sendTraceTag(8405838,
356,50,"");this.Xg.Feedback|=v.a.mWi;const tb=Ub||{};void 0!==tb.ErrorCode&&null!==tb.ErrorCode||null==this.mGd||(tb.ErrorCode=this.mGd);m.AFrameworkApplication.fa.BOd(tb);this.qzd&&(this.qzd.instance||3===m.AFrameworkApplication.Aa.hb.Uk&&1===m.AFrameworkApplication.Aa.hb.$Ia||A.a.instance.ub("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.qzd.execute(Bc=>{m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",!1)?z.UISurfaces.n4f().then(Gb=>
{void 0!==Gb&&null!==Gb?(Bc.fZj(tb,Gb),h.ULS.sendTraceTag(8405838,356,100,"Opened OCV vNext Modal")):(h.ULS.sendTraceTag(520626707,356,15,"feedbackAPI not retrived"),Bc.vne(tb));return Gb},()=>{h.ULS.sendTraceTag(520626706,356,15,"error while retieving feedbackAPI");Bc.vne(tb);return null}):Bc.vne(tb)}))}return 32}}Object(I.a)(J,"CustomerFeedbackActor",null,[1319]);class G{constructor(fb,Qb,mb){this.$Tb=this.zFd=!1;this.uP=this.S9e=null;this.C5a=fb;this.XCc=Qb;this.Xg=mb}get Xg(){this.uP||(m.AFrameworkApplication.Xg||
(m.AFrameworkApplication.Xg=new B.a),this.uP=m.AFrameworkApplication.Xg);return this.uP}set Xg(fb){this.uP=fb}vne(fb){this.S9e=fb;this.Zdg()||this.dbc()}fZj(fb,Qb){this.C5a.Okl(fb,Qb)}dbc(){this.zFd||(this.zFd=!0,this.XCc.p0d(Object(e.a)(this,this.Gpk,"oFeedbackJsDownloadFinished")))}Gpk(fb){fb?(this.$Tb=!0,this.Xg.Feedback|=v.a.qWi,this.Zdg(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Xg.Feedback|=v.a.pWi,h.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.zFd=
!1}Zdg(){return this.$Tb?(this.C5a.Oml(this.S9e),!0):!1}eog(fb){this.$Tb=fb}}Object(I.a)(G,"CustomerFeedbackC3FormManager",null,[1398]);var S=d(18),P=d(668),Q=d(174),D=d(239),O=d(284);class X{constructor(fb=null){this.Yjf=null;this.FBc=new S.a;this.sP=fb}p0d(fb){X.Aac()?this.FBc.add(fb):this.Yjf=fb;var Qb="Feedback/officebrowserfeedback_floodgate.js";P.a.Hje()&&(Qb="Feedback/latest/officebrowserfeedback_floodgate.js");fb="OFeedbackIntl";m.AFrameworkApplication.fa.Cu("IsServerFlavorDebug")&&m.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&
(fb+=".debug");fb+=".js";Qb=Q.a.y0b(Qb);Q.a.dwi(fb);fb=O.a.create(Qb);fb.DS(Object(e.a)(this,this.xuk,"onJsDownloadFinished"));D.a.ey(fb);h.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",Qb)}O9k(fb){this.sP?fb&&this.sP.add(fb):this.sP=fb}xuk(fb,Qb){if(X.Aac()){for(fb=0;fb<this.FBc.count;fb++)this.FBc.ga(fb)(Qb.succeeded,this.sP);this.FBc.clear()}else this.Yjf(Qb.succeeded,this.sP)}static Aac(){return!!m.AFrameworkApplication.Aa&&!!m.AFrameworkApplication.Aa.hb&&3===m.AFrameworkApplication.Aa.hb.Uk&&
1===m.AFrameworkApplication.Aa.hb.$Ia}}Object(I.a)(X,"CustomerFeedbackResourceDownloadManager",null,[1397]);class N{constructor(){this.audienceGroup=null;this.aGe=this.cjb=0}slg(){return!this.aGe}}Object(I.a)(N,"OCVData",null,[]);var aa=d(121),V=d(200),ca=d(104);class fa extends Sys.EventArgs{constructor(fb){super();this.zrl=fb}}Object(I.a)(fa,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ma=d(172),da=d(71),qa=d(197),F=d(36),sa=d(193),ia=d(270),Na=d(47),Ca=d(1020),ha=d(78);class Ba{constructor(fb,
Qb){this.ijk="obf-MainContentHolder";this.VZj="obf-OverallSmileAnchor";this.bJl="obf-visible";this.RQb=this.QQb=Ba.Vld;this.qDd=this.pDd=this.BP=!0;this.qef=this.xob=this.cBd=this.bBd=this.bAc=this.Czc=this.KTb=!1;this.Gzc=!0;this.MFd=this.qFd=this.uP=this.Ged=this.SCd=this.yLd=null;this.kRh=m.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Nd=fb;this.Xg=Qb;this.Pa=new ha.a;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)){const tb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>{Gb.isFeatureEnabled("mso_sendASmile",tb.BP).then(Hc=>{tb.BP=Hc;return null},()=>null);Gb.isFeatureEnabled("FloodgateSurvey",tb.bAc).then(Hc=>{tb.bAc=Hc;tb.cBd=!0;return null},()=>null)});const Bc=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Gb=>{Gb.C3("IncludeScreenshot").then(Hc=>{Bc.KTb=Hc;return null},()=>null);Gb.C3("IncludeEmail").then(Hc=>
{Bc.Czc=Hc;Bc.bBd=!0;return null},()=>null)})}else{const tb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Bc=>{Bc.C3("Enabled").then(Gb=>{tb.BP=Gb;return null},()=>null);Bc.C3("IncludeScreenshot").then(Gb=>{tb.KTb=Gb;return null},()=>null);Bc.C3("IncludeEmail").then(Gb=>{tb.Czc=Gb;tb.bBd=!0;return null},()=>null);Bc.C3("SurveyEnabled").then(Gb=>{tb.bAc=Gb;tb.cBd=!0;return null},()=>null)})}if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",
!0)){this.xob=m.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const tb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Bc=>{tb.xob=Bc.isFreemiumUpsellEnabled();Bc.isFeatureEnabled("mso_sendASmile",!1).then(Gb=>{tb.qef=Gb;return null},()=>null)})}const mb=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(tb=>{tb.isFeatureEnabled("FeedbackForum",mb.Gzc).then(Bc=>{mb.Gzc=Bc;return null},()=>null)});const Jb=
this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(tb=>{tb.isFeatureEnabled("FeedbackComplianceCannotConsent",Jb.pDd).then(Bc=>{Jb.pDd=Bc;return null},()=>null)});const Ub=this;A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(tb=>{tb.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Ub.qDd).then(Bc=>{Ub.qDd=Bc;return null},()=>null)});P.a.Hje()?(this.yLd=Q.a.y0b("Feedback/latest/officebrowserfeedback.css"),
this.SCd=Q.a.fWd("Feedback/latest/Intl/")):(this.yLd=Q.a.y0b("Feedback/officebrowserfeedback.css"),this.SCd=Q.a.fWd("Feedback/Intl/"))}get Xg(){this.uP||(m.AFrameworkApplication.Xg||(m.AFrameworkApplication.Xg=new B.a),this.uP=m.AFrameworkApplication.Xg);return this.uP}set Xg(fb){this.uP=fb}get Fne(){return this.qFd||(this.qFd=document.getElementById(this.VZj))}get gcd(){return this.MFd||(this.MFd=document.getElementById(this.ijk))}c$h(fb){this.Pa.addHandler(Ba.h3g,fb)}Zsi(){this.MFd=this.qFd=null}nMj(fb){return!!fb&&
0<=fb.className.toLowerCase().indexOf(this.bJl.toLowerCase())}Okl(fb,Qb){m.AFrameworkApplication.TE?this.BP&&(h.ULS.sendTraceTag(520626705,356,50,"Feedback api retrieved"),fb=fb||{},this.getContext(fb),Qb.initializeFeedbackModal(fb,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError")),h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.Xg.Feedback|=v.a.dVf):h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}Oml(fb){if(!m.AFrameworkApplication.TE)h.ULS.sendTraceTag(520626704,
356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.BP){fb=fb||{};this.getContext(fb);var Qb=Ba.LLi(fb.AppMode||"Unknown");Ca.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,Qb,fb);this.qEj();Ba.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Xg.Feedback|=v.a.dVf}}ZWi(fb,Qb){Qb&&2>=Qb.cjb?((Qb=m.AFrameworkApplication.fa.Ga("UserPrincipalName"))&&
0<Qb.length&&(fb.userEmail=Qb),fb.userEmailConsentDefault=!0):fb.userEmail=""}yZf(fb){const Qb={};if(void 0!==fb.appData&&null!==fb.appData){var mb=fb.appData;for(var Jb in mb)Qb[Jb]=mb[Jb]}Qb.App=fb.Application||"";Qb.AppMode=fb.AppMode||"";Qb.AppModeExt=fb.ApplicationMode||"";Qb.Host=fb.Host||"";Qb.Language=fb.locale;Qb.IsError=fb.Error||!1;Qb.IsCrash=fb.Crash||!1;Qb.ServerDocId=fb.ServerDocId||"";fb.ErrorCode&&""!==fb.ErrorCode.toString()&&(Qb.IsError=!0);"Origin"in fb&&(Qb.Origin=fb.Origin);Qb.ClientThrottlingProtection=
this.Xg.ClientThrottlingProtection||"";Qb.HostServiceLevel=this.Xg.HostServiceLevel||"";Qb.RequestedCallThrottling=this.Xg.RequestedCallThrottling||"";Qb.WacServiceLevel=this.Xg.WacServiceLevel||"";this.Xg.HostResponseStats&&(mb=this.Xg.HostResponseStats.Label)&&(Qb.HostFarmHint=mb);mb=m.AFrameworkApplication.fa;(Jb=mb.Ga(m.AFrameworkApplication.eK))&&""!==Jb&&(Qb.UiHost=Jb);(Jb=mb.Ga(m.AFrameworkApplication.WEh))&&""!==Jb&&(Qb.UiHostIntegrationType=Jb);mb.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&
(mb=fb.SessionOrigin,mb&&""!==mb||(fb=fb.SourceControlId)&&""!==fb&&sa.a(sa.d(fb),"feedback")&&(mb=this.m0f().SessionOrigin),mb&&""!==mb&&(Qb.SessionOrigin=mb));fb=null;try{fb=F.c(Qb),fb=Na.a.Uca(fb,Na.a.AAb)}catch(Ub){fb="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData:"+Ub.message)}return{["appData"]:fb||""}}l7i(fb){const Qb={};for(let mb in fb)Qb[mb]=fb[mb];Qb.IsFreemiumUpsellEnabled=this.xob;Qb.IsAadcEnabled=this.qef;Qb.IsFeedbackEnabled=this.BP;return Qb}o7i(){let fb=
null;try{const Qb=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",null);Qb&&(fb=F.b(Qb))}catch(Qb){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return fb||{}}S5i(fb,Qb){if(fb&&Qb){fb.LanguageID?fb.locale=ia.a.xe(fb.LanguageID).name||"":fb.ApplicationLCID&&(fb.locale=fb.ApplicationLCID);fb.applicationGroup=this.yZf(fb);fb.applicationSettings=this.l7i(m.AFrameworkApplication.fa.appSettings);fb.webSurfacesSettings=
this.o7i();Ba.$Nf(Qb,fb);fb.appId=Ba.QLi();fb.environment=Qb.aGe;fb.stylesUrl=this.yLd;fb.intlUrl=this.SCd;fb.rtl=m.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var mb=Ba.PLi();fb.primaryColour=mb.primaryColour;fb.secondaryColour=mb.secondaryColour;fb.sessionId=fb.SessionID||fb.WACSessionID||"";fb.build=fb.ApplicationVersion||fb.WFEVersion||"";mb=fb.FlightIDs?fb.FlightIDs.toString():fb.Flights?fb.Flights.toString():"";var Jb="";fb.ErrorCode&&(Jb=fb.ErrorCode.toString());var Ub=this.pfj(fb),tb=Qb.slg()?
m.AFrameworkApplication.fa.Ga("TenantId"):"";tb&&"0"!==tb||(tb="");var Bc=m.AFrameworkApplication.fa.Ga("LoggableUserIdSpace"),Gb=m.AFrameworkApplication.fa.Ga("LoggableUserId")||"";switch(Bc){case "MsaPuid":Gb="p:"+Gb;break;case "MsaCid":Gb="m:"+Gb;break;case "OrgIdPuid":Gb="a:"+(m.AFrameworkApplication.fa.Ga("AADUserObjectId")||Gb);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: "+Gb+", LoggableUserIdSpace: "+Bc),Gb=""}Bc={};if(void 0!==fb.telemetryGroup&&
null!==fb.telemetryGroup){const Hc=fb.telemetryGroup;for(let $b in Hc)Bc[$b]=Hc[$b]}Bc.audienceGroup=Qb.audienceGroup;Bc.audience=Qb.audienceGroup;Bc.flights=mb;Bc.platform=Ub;Bc.ringId=Qb.cjb;Bc.officeUILang=m.AFrameworkApplication.lcid;Bc.errorCode=Jb;Bc.loggableUserId=Gb;Bc.processSessionId=fb.SessionID||fb.WACSessionID||"";Bc.officeBuild=fb.ApplicationVersion||fb.WFEVersion||"";0<tb.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==tb&&(Bc.tenantId=tb);fb.telemetryGroup=Bc;fb.webGroup={["browser"]:fb.Browser||
"",["browserVersion"]:(fb.BrowserMajorVersion||"")+"."+(fb.BrowserMinorVersion||""),["dataCenter"]:fb.Datacenter||fb.WACDatacenter||""};fb.isCommercialHost=m.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.JLi(fb);fb.disableIncludeScreenshot=!this.KTb;fb.screenshot=this.KTb;fb.showEmailAddress=this.Czc;fb.emailPolicyValue=this.Czc?1:0;fb.screenshotPolicyValue=this.KTb?1:0;m.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(fb.disableIncludeScreenshot=!1,fb.showEmailAddress=!0,fb.screenshot=
!0);m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&(fb.surveyEnabled=this.bAc,m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(fb.showEmailAddress=!0,fb.surveyEnabled=!0));this.ZWi(fb,Qb);this.Ged=fb.DismissHandler?fb.DismissHandler:null;this.HLi(fb)}}xfi(){return this.bBd&&this.cBd}getContext(fb){fb=fb||this.m0f();const Qb=new N;this.S5i(fb,Qb);return fb}pfj(fb){let Qb="";fb.Platform&&(Qb=fb.Platform.toString());fb.PlatformMajorVersion&&
(0<Qb.length&&(Qb+=" "),Qb+=fb.PlatformMajorVersion.toString()+".");fb.PlatformMinorVersion&&(Qb+=fb.PlatformMinorVersion.toString());return Qb}Jpl(fb){fb.ApplicationMode&&(fb.AppMode=fb.ApplicationMode);fb.ApplicationModeExtended&&(fb.ApplicationMode=fb.ApplicationModeExtended)}m0f(){let fb;try{fb=F.b(m.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.Jpl(fb)}catch(Qb){h.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),fb={}}return fb}onError(fb){h.ULS.sendTraceTag(37259477,
356,10,"FB submit error: "+fb);this.Xg.Feedback|=v.a.oWi;Ba.allowKeytips(!0)}ZNi(){if(Ba.dkg()){h.ULS.sendTraceTag(40112215,356,50,Ba.q0g);var fb=A.a.instance.resolve("Common.ISystemInitiatedFeedback");fb&&fb.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(fb){this.coa();this.Zsi();ma.a.RGb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ma.a.mVa()&&ca.c(fb?u.a.lWi:u.a.gWi,!0,null,2,8);fb?(ma.a.RGb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Xg.Feedback|=v.a.rWi):(this.Xg.Feedback|=
v.a.nWi,this.ZNi());this.Pa.raiseEvent(Ba.h3g,new fa(fb));Ba.allowKeytips(!0);this.Ged&&(this.Ged(),this.Ged=null)}qEj(){if(this.Nd){let fb=!1,Qb=5,mb=!1;this.RQb=this.clearInterval(this.RQb);this.QQb=this.clearInterval(this.QQb);this.QQb=window.setInterval(()=>{if(this.Fne){mb=!0;var Jb=this.Nd.Fc(Ba.N7a);Jb.bJ=!0;Jb.parent=aa.AFrame.gj;Jb.Y5a(Ba.WIi);Jb.M7(()=>{let Ub=this.Nd.uQ(Ba.N7a),tb=null,Bc=5,Gb=!1;this.RQb=window.setInterval(()=>{this.nMj(this.gcd)&&(Gb=!0,this.Fne.focus(),Ub||(Ub=this.Nd.uQ(Ba.N7a)),
Ub&&!tb&&(tb=Ub.vj),tb&&tb.YE(this.Fne));Bc--;if(Gb||!Bc)this.RQb=this.clearInterval(this.RQb)},1E3)});fb||(this.Nd.HU(Ba.N7a,!0),fb=!0);this.kRh&&this.gcd&&(Jb=new V.DOMFocusListing(()=>this.gcd),Jb.Go(1),Jb.Go(2),Jb.Go(3),Jb.Go(5),Jb=this.Nd.Tia(()=>this.gcd,this.Nd.Fc(Ba.N7a),Jb),Jb.xib(),Jb.nX=!0,Jb.KQa=!0,Jb.zZg())}Qb--;if(mb||!Qb)this.QQb=this.clearInterval(this.QQb)},1E3)}}clearInterval(fb){fb!==Ba.Vld&&(window.clearInterval(fb),fb=Ba.Vld);return fb}coa(){this.Nd&&(this.Nd.X0(Ba.N7a),this.Nd.iKb(Ba.N7a))}HLi(fb){this.pDd?
this.qDd||(fb.ageGroup=4):fb.ageGroup=3;m.AFrameworkApplication.fa.ka("IsAnonymousUser")?fb.authenticationType=2:fb.authenticationType="aad"===m.AFrameworkApplication.fa.Ga("HostAuthType")?1:0}JLi(fb){this.Gzc&&(fb.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",fb.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.Gzc){const Qb=Ba.KLi();void 0!==Qb&&null!==Qb&&(fb.feedbackPortalUrl=Qb,fb.feedbackForumUrl=Qb)}}static allowKeytips(fb){m.AFrameworkApplication.Aa.hb.Oo&&
da.a("allowKeytips")&&appChrome.api.allowKeytips(fb)}static $Nf(fb,Qb){if(Qb){fb.cjb=parseInt(Qb.Ring);if(isNaN(fb.cjb))fb.audienceGroup="Unknown",fb.cjb=-2;else switch(fb.cjb){case 0:case 1:fb.audienceGroup="Dogfood";break;case 2:fb.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:fb.audienceGroup="Production";break;default:fb.audienceGroup="Unknown"}var mb=!0;Qb.Host&&(mb="MsInternal"!==Qb.Host&&"Blue Chicken"!==Qb.Host);fb.aGe=mb?0:1}}static QLi(){let fb=0;switch(qa.Redirect.application){case 2:fb=
2155;break;case 4:fb=2158;break;case 3:fb=2157;break;case 1:fb=2156;break;case 5:fb=2159;break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",qa.Redirect.application.toString())}return fb}static PLi(){const fb={};let Qb="#2B579A",mb="#3C65A4";switch(qa.Redirect.application){case 2:m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?(Qb="#185ABD",mb="#2E6AC5"):(Qb="#2B579A",mb="#3C65A4");break;case 4:Qb="#7719AA";mb="#9953C0";break;case 3:Qb=
"#B7472A";mb="#C75033";break;case 1:Qb="#217346";mb="#3F8159";break;case 5:Qb="#3955A3";mb="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",qa.Redirect.application.toString())}fb.primaryColour=Qb;fb.secondaryColour=mb;return fb}static KLi(){let fb=null;switch(qa.Redirect.application){case 2:fb="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:fb="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:fb="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";
break;case 1:fb="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:fb="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",qa.Redirect.application.toString())}return fb}static LLi(fb){let Qb=356;switch(qa.Redirect.application){case 2:switch(fb){case "Edit":Qb=364;break;case "View":case "Attendee":case "Presenter":Qb=363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",
m.AFrameworkApplication.Aa.FYa),Qb=363}break;case 4:Qb=362;break;case 3:switch(fb){case "Edit":Qb=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":Qb=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",m.AFrameworkApplication.Aa.FYa),Qb=360}break;case 1:switch(fb){case "Edit":Qb=358;break;case "View":Qb=357;break;case "Survey":Qb=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",
m.AFrameworkApplication.Aa.FYa),Qb=357}break;case 5:switch(fb){case "View":Qb=373;break;case "Edit":Qb=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",m.AFrameworkApplication.Aa.FYa),Qb=373}break;default:h.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",qa.Redirect.application.toString())}return Qb}static WIi(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static dkg(){if(!Ba.QFe){const fb=
!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka(Ba.q0g);Ba.QFe=fb?2:1}return 2===Ba.QFe}}Ba.N7a="CustomerFeedbackFocusId";Ba.h3g="FUID";Ba.Vld=-1;Ba.QFe=0;Ba.q0g="NPSLocalizationTestingIsEnabled";Object(I.a)(Ba,"CustomerFeedbackUiWrapper",null,[1392]);var va=d(15),ta=d(1201),Fa=d(1202);class pa{constructor(fb,Qb,mb,Jb){this.L8e=fb;this.Sga=Qb;this.K8e=mb;this.$Wh=Jb}activityName(){return this.Sga}object(){return this.$Wh}}Object(I.a)(pa,"OneCallBackData",null,[]);class ka{constructor(fb,
Qb,mb,Jb){this.YMa=[];Array.add(this.YMa,new pa(fb,Qb,mb,Jb))}add(fb){fb&&Array.addRange(this.YMa,fb.YMa)}ati(){Array.clear(this.YMa)}}Object(I.a)(ka,"CallBackData",null,[]);var Ha=d(530);class Ya extends Ha.a{constructor(fb,Qb,mb=null,Jb=!1,Ub=!1,tb=null,Bc=null,Gb=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=fb;this.message=Qb;this.image=
mb;this.positionImageAtLeft=Jb;this.smallHeadline=Ub;this.title=tb;this.primaryButtonProps=Bc;this.secondaryButtonProps=Gb}}Object(I.a)(Ya,"FloodgateCalloutContent",Ha.a,[]);class Ka{constructor(){this.Nch=this.options=null}}Object(I.a)(Ka,"Notification",null,[]);var Pa=d(1118),Oa=d(928),oa=d(351);class Xa extends Ha.a{constructor(fb,Qb,mb=null,Jb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=fb;this.content=Qb;this.imageProps=mb;this.imageHeight=
Jb}}Object(I.a)(Xa,"PremiumUpsellCalloutContentProps",Ha.a,[]);var Hb=d(929),Ob=d(927);class eb{static WWd(fb){return eb.ugj().then(Qb=>{try{const mb=[];for(let Jb=0;Jb<fb.length;Jb++){const Ub=fb[Jb],tb=eb.lVj(Ub.surfaceType),Bc=new Ka;Bc.options=eb.Zdj(Ub,!tb);Bc.Nch=tb?Qb.callout(eb.wjk(fb[Jb])):Qb.externalNotification();mb.push(Bc)}return eb.Ykl(Qb,mb)}catch(mb){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+mb.message);}})}static lVj(fb){switch(fb.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;
default:return!1}}static Zdj(fb,Qb){const mb=new oa.a;Qb&&(mb.onShow=fb.onUnsupportedSurfaceType);mb.telemetryId="FloodgateTeachingUx-Surface"+(Qb?"NotSupported":"Supported");return mb}static wjk(fb){var Qb="premiumupsell"!==fb.surfaceType.toLowerCase()?new Ya(fb.footer,fb.description,fb.illustrationImage?Object.assign(new Ob.a(fb.illustrationImage),{ariaLabel:fb.imageAriaLabel}):null,"left"===fb.position,fb.smallHeadline,fb.title,eb.xRc(fb.primaryButtonText,fb.primaryButtonAction),eb.xRc(fb.secondaryButtonText,
fb.secondaryButtonAction)):new Xa(fb.title,fb.description,fb.illustrationImage?Object.assign(new Ob.a(fb.illustrationImage),{ariaLabel:fb.imageAriaLabel}):null);Qb=Object.assign(new Oa.a,{target:fb.selector,content:Qb,showCloseIcon:null!=fb.hasCloseButton?fb.hasCloseButton:!0,preventLightDismiss:null!=fb.preventAutoDismiss?fb.preventAutoDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new Hb.a,{onDismiss:()=>{if(fb.onClosed)fb.onClosed("close")},directionalHint:fb.anchorHint,setInitialFocus:!0})});
"coachmark"===fb.surfaceType.toLowerCase()?(Qb.hasDynamicSizing=!1,Qb.useCoachmark=!0,Qb.calloutProps.setInitialFocus=!1):"premiumupsell"===fb.surfaceType.toLowerCase()&&(Qb.primaryButtonProps=eb.xRc(fb.primaryButtonText,fb.primaryButtonAction),Qb.secondaryButtonProps=eb.xRc(fb.secondaryButtonText,fb.secondaryButtonAction),Qb.showCloseIcon=!1,Qb.useTeachingStyles=!1,Qb.calloutProps.preventDismissOnLostFocus=!1);return Qb}static xRc(fb,Qb){return fb&&""!==fb&&Qb?Object.assign(new Pa.a,{label:fb,onExecute:Qb}):
(h.ULS.shipAssertTag(594569111,356,(!fb||""===fb)&&!Qb,"A callout button needs both a caption and an action."),null)}static ugj(){eb.jQc||(m.AFrameworkApplication.Aa.hb.WUa&&m.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?eb.jQc=z.UISurfaces.mL().then(fb=>{const Qb=new Ya(null,null);if(fb.isCustomContentSupported&&fb.isCustomContentSupported(Qb))return fb;throw Error.create("Custom Content not supported: "+Qb.type);},fb=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",
fb);return null}):eb.jQc=Promise.reject("React Notifications not enabled"));return eb.jQc}static Ykl(fb,Qb){if(!Qb||!Qb.length)return[];const mb=[];for(let Jb=0;Jb<Qb.length;Jb++){const Ub=eb.Nll(fb,Qb[Jb]);mb.push(Ub)}return mb}static Nll(fb,Qb){const mb=fb.addNotification(Qb.Nch,Qb.options);return()=>{fb.removeNotification(mb)}}}eb.jQc=null;Object(I.a)(eb,"FloodgateNotifications",null,[]);const Eb=(fb,Qb)=>{fb=m.AFrameworkApplication.fa.Ga("UserPrincipalName");if(Qb=!!Qb.G0g&&2===Qb.G0g.cjb)Qb=
(Qb=fb.toLowerCase())?0<Qb.indexOf("linkedin.com")||0<Qb.indexOf("linkedin.biz"):!1;return Qb};class oc{constructor(fb,Qb){this.G0g=fb;this.context=Qb}}Object(I.a)(oc,"SurveyMetadata",null,[]);var Sb=d(67),qc=d(271),$a=d(93),ab=d(81);class Ib{constructor(fb){this.CUa=this.isInitialized=!1;this.tja=this.Lmb=null;this.J1a=!1;this.m0e=null;this.hig=!1;this.EMc=0;this.UMf=-1;this.eLe=this.DMc=null;this.VTa=!0;this.gQ=fb;this.ptc={};this.Ayf=!1;this.GKb=this.na=null;this.iQc=0}NFj(fb){this.isInitialized&&
this.Lmb||this.CUa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===fb?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.J1a=fb.J1a,h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}DFj(){const fb=this.gQ.getContext(null),Qb=new N;Ba.$Nf(Qb,fb);this.m0e=new oc(Qb,fb);this.GKb=new va.ScriptSharpLegacyMap;this.GKb.$("LinkedInWACUsage",
Eb)}get Drb(){this.Lmb||(this.Lmb=A.a.instance.ub("Common.App.IAppSpecificFeedbackData"));return this.Lmb}logActivity(fb,Qb,mb=null){fb&&this.U8a(fb,Ib.agb,Qb)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+fb),Ca.a.logActivity(fb,mb)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+fb),this.hee(new ka(Ca.a.logActivity,fb,null,mb))))}eoe(fb){try{m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",
!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+fb),-1===this.UMf&&(this.UMf=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Ib.xMf)),this.DMc||(this.DMc=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.DMc&&
fb&&fb.startsWith("Ribbon_")&&-1===this.DMc.indexOf(fb.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.EMc&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.EMc),h.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+fb)),this.EMc=window.setTimeout(()=>{this.EMc=0;this.logActivity(fb,null)},Ib.xMf)):h.ULS.sendTraceTag(592217692,
356,50,"SIFB: LogActivityDeferred called before initialization "+fb)}catch(Qb){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(Qb?Qb.toString():""))}}hbc(fb,Qb){fb&&this.U8a(fb,Ib.agb,Qb)&&(this.cqg(fb,Qb),this.ptc[fb]=Qb)}cqg(fb,Qb){this.U8a(fb,Ib.agb,Qb)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+fb),Ca.a.hbc(fb,null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+fb),
this.hee(new ka(Ca.a.hbc,fb,null,null))))}aqg(fb){fb&&this.isInitialized&&this.U8a(fb,Ib.agb,void 0)&&(fb in this.ptc&&delete this.ptc[fb],this.bqg(fb,void 0))}bqg(fb,Qb){this.isInitialized&&this.U8a(fb,Ib.agb,Qb)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+fb),Ca.a.aqg(fb))}YMb(fb,Qb){if(this.U8a(fb,Ib.agb,Qb))if(this.Drb){if(Qb=this.Drb.jae(fb))this.isInitialized?(h.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+fb),Ca.a.YMb(Qb)):(h.ULS.sendTraceTag(38605912,
356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+fb),this.hee(new ka(null,null,Ca.a.YMb,Qb)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}U8a(fb,Qb,mb){if(this.CUa)return!1;if(!m.AFrameworkApplication.TE)return h.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.iNj())return!1;this.XBi();return(this.$Lj(fb)||this.IIi(fb)||this.GIj(fb))&&this.Vii(Qb,mb)&&this.csl(fb)}XBi(){if(!this.Lmb){const fb=A.a.instance.ub("Common.App.IAppSpecificFeedbackData");
fb?this.Lmb=fb:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}jNj(fb){return 6!==fb}iNj(){if(0===this.iQc){const fb=this.gQ.getContext(null);this.iQc=this.jNj(parseInt(fb.Ring))?1:2;2===this.iQc&&h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.iQc}csl(fb){null===this.GKb&&this.DFj();return fb&&this.GKb&&this.GKb.Hb(fb)?this.GKb.ga(fb)(fb,this.m0e):!0}f7i(){if(!this.tja&&!this.Ayf){this.Ayf=!0;
const fb=this.gQ.getContext(null);this.tja="locale"in fb?fb.locale:"";this.tja=this.tja.toLowerCase()}return this.tja}IIi(fb){this.tja||(this.tja=this.f7i());if(!(this.tja&&this.tja.length&&fb&&fb.length))return!1;let Qb="en-us"===this.tja||this.mQj(fb)||Ba.dkg();!Qb&&this.bQj(fb)&&(Qb=this.cQj(this.tja));return Qb}bQj(fb){return this.Drb?"AppUsageNPS"===fb||"AppUsageTimeSatisfiedNPS"===fb||"SuiteUsageNPS"===fb||"SuiteUsageTimeSatisfiedNPS"===fb:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+
fb),!1)}$Lj(fb){return!!fb&&-1!==fb.toLowerCase().indexOf("floodgateflight")}mQj(fb){return!!fb&&-1!==fb.toLowerCase().indexOf("nlqs")}cQj(fb){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!fb||!fb.length)return!1;if(!m.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===fb;let Qb=!1;switch(fb){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":Qb=
!0}return Qb}Vii(fb,Qb){return m.AFrameworkApplication.fa.ka(fb)?Qb&&!m.AFrameworkApplication.fa.ka(Qb)?(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+Qb+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+fb+") is off"),!1)}GIj(fb){const Qb=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!fb&&!!Qb&&-1!==Qb.toLowerCase().indexOf(fb.toLowerCase())}hee(fb){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1))m.AFrameworkApplication.fa.gf(()=>{try{this.TNc(fb)}catch(Qb){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+Qb)}});else try{this.TNc(fb)}catch(Qb){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+Qb)}}Kkc(){this.J1a||this.start()}lzk(){this.J1a||this.stop()}e_e(){this.J1a&&this.start()}Jql(){this.J1a&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",
!1)){const fb=ab.a.OLc(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",10),Object(e.a)(this,this.lyh,"startSurvey"),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));m.AFrameworkApplication.ye.Db(fb)}else this.lyh(null)}lyh(){Ca.a.KZi();this.tvl()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.svl(),Ca.a.LZi())}tvl(){const fb=
this.ptc;for(let Qb in fb)this.cqg(Qb,fb[Qb])}svl(){const fb=this.ptc;for(let Qb in fb)this.bqg(Qb,fb[Qb])}TNc(fb){h.ULS.sendTraceTag(36546388,356,100,"SIFB: Entered DownloadResources");var Qb=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");Qb&&(Qb.$Tb?this.aXf(!0,fb):(Qb=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),Qb.O9k(fb),Qb.p0d(Object(e.a)(this,this.aXf,"floodgateJsDownloadFinished"))))}aXf(fb,Qb){h.ULS.sendTraceTag(36546389,
356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+fb);let mb="";Qb&&Qb.YMa&&0<Qb.YMa.length&&(mb=Qb.YMa[0].activityName());if(fb)if(P.a.Hje())if(this.isInitialized)this.a0d(Qb);else{if(this.CUa||!this.eLe)this.eLe=this.gah();this.eLe.then(()=>{this.a0d(Qb)}).catch(Jb=>this.hah(mb,Jb))}else this.gah().then(()=>{this.a0d(Qb)}).catch(Jb=>this.hah(mb,Jb));else this.CUa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+mb)}hah(fb,Qb){this.CUa=!0;h.ULS.sendTraceTag(36546390,
356,10,"SIFB Error: in post download init. Activity name "+fb+". "+Qb.toString())}MZi(fb){this.na||this.JFj();let Qb=fb;fb&&0<fb.length&&(Qb=this.na&&this.na.Hb(fb)?this.na.ga(fb):fb);return Qb?Qb:""}gah(){var fb=A.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");fb&&fb.eog(!0);this.yfl();this.Zel();this.initOptions();if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&m.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.R2i().then(Qb=>
{this.moe(Qb);return Qb}).then(Qb=>Ca.a.Xde(Object(e.a)(this,this.BIe,"onSIFeedbackDismiss"),Object(e.a)(this.gQ,this.gQ.onError,"onError"),Qb,Object(e.a)(this.gQ,this.gQ.onDismiss,"onDismiss")));if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&m.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&m.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return Ib.nKi(this.P2f()).then(()=>{const Qb=this.m5d();this.moe(Qb);return Qb}).then(Qb=>
Ca.a.Xde(Object(e.a)(this,this.BIe,"onSIFeedbackDismiss"),Object(e.a)(this.gQ,this.gQ.onError,"onError"),Qb,Object(e.a)(this.gQ,this.gQ.onDismiss,"onDismiss")));fb=this.m5d();this.moe(fb);return Ca.a.Xde(Object(e.a)(this,this.BIe,"onSIFeedbackDismiss"),Object(e.a)(this.gQ,this.gQ.onError,"onError"),fb,Object(e.a)(this.gQ,this.gQ.onDismiss,"onDismiss"))}R2i(){return new Promise(fb=>{A.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Qb=>{const mb=this.m5d();Qb.isFeatureEnabled("FloodgateSurvey",
!0).then(Jb=>{mb.surveyEnabled="surveyEnabled"in mb?Jb&&mb.surveyEnabled:Jb;fb(mb);return null},Jb=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",Jb.toString());fb(mb);return null})})})}n7i(){let fb=null;try{const Qb=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);Qb&&(fb=F.b(Qb))}catch(Qb){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return fb||{}}m5d(){const fb=
this.gQ.getContext(null);fb.FloodgateUIAutoDismissTimeEnum=this.C3i();fb.uIStringGetter=Object(e.a)(this,this.MZi,"floodgateUIStringGetter");fb.authTokenCallback=Ib.dCi(Object(n.a)(String,fb.AudienceGroup));fb.augLoopCallback=Ib.bCi();fb.onTeachingCampaignRender=Ib.WWd;fb.governanceServiceEnabled=Ib.h2f();fb.governanceServiceConfig=Ib.q$i();fb.personalizerEnabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);fb.messagingServiceSettings=
this.n7i();fb.isPriorityEnabled=Ib.Ufj();return fb}moe(fb){const Qb=this.gQ.xfi(),mb=this.P2f(),Jb=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),Ub=m.AFrameworkApplication.fa.ka("IsO365CommercialHost"),tb=m.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Bc=m.AFrameworkApplication.fa.ka("OcpsIsEnabled"),Gb="surveyEnabled"in fb?fb.surveyEnabled:"null or undefined",Hc="showEmailAddress"in fb?fb.showEmailAddress:"null or undefined",
$b=Ib.h2f(),lc=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',
Qb,Jb,Ub,tb,Bc,mb,Hc,Gb,$b,F.c(fb.governanceServiceConfig),lc)}C3i(){return Eb(null,this.m0e)?(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",m.AFrameworkApplication.fa.Bc("FloodgateUIAutoDismissTimeEnum",2))}P2f(){return m.AFrameworkApplication.fa.Bc("FloodgateContextAndInitDelayInMilliSeconds",Ib.TJi)}a0d(fb){this.isInitialized=!0;this.q8h();
Ca.a.t$k(Object(e.a)(this,this.v4j,"logTriggerEvent"));if(fb){for(const Qb of fb.YMa)Qb.L8e?(0,Qb.L8e)(Qb.activityName(),Qb.object()):Qb.K8e?(0,Qb.K8e)(Qb.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");fb.ati()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const Qb=this.gQ.getContext(null),mb=Ca.a.P1f(Array.isArray(Qb.Flights)?Qb.Flights:null),Jb=mb?Object(n.a)(String,mb.SelfTriggerActivity):null;if(Jb)for(const Ub of Jb.split(";"))Ub&&
""!==Ub&&this.logActivity(Ub,null)}catch(Qb){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(Qb?Qb.toString():""))}}q8h(){if(!this.hig&&window.addEventListener){const fb=Object(e.a)(this,this.izk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",fb,!0);this.hig=!0}}jqg(fb,Qb){fb&&(m.AFrameworkApplication.hk(fb),m.AFrameworkApplication.obc(fb));h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+Qb)}oLj(fb){if(!fb)return!1;try{const Qb=(m.AFrameworkApplication.fa.Ga("FlightId")||
"").toLocaleLowerCase(),mb=fb.toString().toLocaleLowerCase().split(";");for(const Jb of mb)if(2<Jb.length&&(Jb.lastIndexOf("-control")===Jb.length-8||Jb.lastIndexOf("cf")===Jb.length-2&&-1!==Qb.indexOf(Jb)))return!0}catch(Qb){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(Qb?Qb.toString():""))}return!1}v4j(fb,Qb){Qb=Qb||{};if(fb&&!("isControl"in Qb)){const mb=this.oLj(fb);mb&&(Qb.isControl=mb)}this.jqg(fb,JSON.stringify(Qb))}izk(fb){if(fb=fb?fb.detail:null){var Qb=!m.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),
mb=(fb.action||"").toLowerCase();switch(mb){case "dismissed":Qb&&qc.a.instance.Ko("obf-DynamicWebSurfaces");break;case "updated":Qb&&Ca.a.mra("obf-DynamicWebSurfaces");break;case "opened":case "":mb=fb.telemetryEventName;let Jb;try{Jb=JSON.stringify(fb)}catch(Ub){Jb="id : "+fb.id+" telemetryEventName: "+mb,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+Jb+" Error: "+(Ub?Ub.toString():""))}fb.success?this.jqg(mb,Jb):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+
Jb);fb.isHidden||fb.isAA||!Qb||Ca.a.mra("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+mb)}}}myl(fb){var Qb=["Live"];if(!fb)return null;try{const mb=F.b(fb),Jb=new S.a;for(const Ub of mb){const tb=Ub.Tags;if(tb)for(const Bc of Qb)Array.contains(tb,Bc)&&Jb.add(Ub)}return F.c(Jb.toArray())}catch(mb){return h.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}yfl(){let fb=!1,Qb=null;const mb=this.R9a();if(mb&&this.Drb)try{let Jb=
this.Drb.v4i();m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&m.AFrameworkApplication.uua&&(Jb=this.myl(Jb));Jb?(mb.setItem(Ib.Moi,Jb),fb=!0):(Qb="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,356,10,Qb))}catch(Jb){Qb="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+Jb,h.ULS.sendTraceTag(594143441,356,50,Qb)}else this.Drb?(Qb="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",
h.ULS.sendTraceTag(594143440,356,50,Qb)):(Qb="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,Qb));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+fb+" errorString: "+(Qb?Qb:"null"))}BIe(fb,Qb){ma.a.RGb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",Qb,fb);ma.a.mVa()&&ca.c(Qb?u.a.pHl:u.a.oHl,!0,null,2,8);qc.a.instance.Ko(Ca.a.$Wf)}initOptions(){}Zel(){this.J1a||($a.a.addHandler(window.self,
Sb.a.focus,Object(e.a)(this,this.Kkc,"onWindowFocus")),$a.a.addHandler(window.self,Sb.a.blur,Object(e.a)(this,this.lzk,"onWindowBlur")))}R9a(){if(!this.VTa)return null;let fb=null;try{fb=localStorage}catch(Qb){this.VTa=!1,fb=null,h.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(Qb?Qb.toString():""))}return fb}JFj(){h.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.na=new ta.a(Fa.a.to()),this.na.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.na.$("nps_PromptQuestion",
CommonUIStrings.l_WAC_NPS_PromptQuestion),this.na.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.na.$("nps_RatingQuestion_Word",Ib.Q8f()),this.na.$("nps_RatingQuestion_OneNote",Ib.yoj()),this.na.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.na.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.na.$("nps_OneClickRatingQuestion_Excel",Ib.O8f()),this.na.$("nps_OneClickRatingQuestion_PowerPoint",
Ib.P8f()),this.na.$("nps_RatingQuestion_PowerPoint",Ib.P8f()),this.na.$("nps_RatingQuestion_Excel",Ib.O8f()),this.na.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.na.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.na.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.na.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.na.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.na.$("nps_Rating_Values_5",
CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.na.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.na.$("nps_OneClickRatingQuestion_Word",Ib.Q8f()),this.na.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.na.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.na.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),
this.na.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.na.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.na.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.na.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.na.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.na.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),
this.na.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.na.$("NSV_Prompt_Title_Feedback",
CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.na.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.na.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.na.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.na.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.na.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.na.$("NSVFreeformDidntCreateSheetView",
CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.na.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.na.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.na.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.na.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.na.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.na.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),
this.na.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.na.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.na.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),
this.na.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.na.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.na.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.na.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.na.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.na.$("ReviewMode_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.na.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.na.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.na.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.na.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.na.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),
this.na.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.na.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.na.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.na.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.na.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.na.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),
this.na.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.na.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.na.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.na.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.na.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.na.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),
this.na.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.na.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.na.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.na.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.na.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),
this.na.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.na.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.na.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.na.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.na.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),
this.na.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.na.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.na.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.na.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.na.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),
this.na.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.na.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.na.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.na.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.na.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),
this.na.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.na.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.na.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.na.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.na.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),
this.na.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.na.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.na.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.na.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.na.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),
this.na.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.na.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.na.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.na.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.na.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.na.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),
this.na.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.na.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.na.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.na.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.na.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.na.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.na.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.na.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.na.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.na.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.na.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),
this.na.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.na.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.na.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.na.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.na.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),
this.na.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.na.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.na.$("ExcelRecommendedCharts_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.na.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.na.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_3_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.na.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.na.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.na.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_Question",
CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.na.$("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.na.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),
this.na.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.na.$("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.na.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.na.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.na.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.na.$("Download_as_Image_Rating_Values_1",
CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.na.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.na.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("TextPredictions_FloodgatePromptTitle",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.na.$("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.na.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.na.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.na.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),
this.na.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.na.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.na.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.na.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.na.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),
this.na.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.na.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.na.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.na.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.na.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.na.$("SoftwareITDiagrams_Rating_Values_2",
CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.na.$("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.na.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.na.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.na.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.na.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),
this.na.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.na.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.na.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.na.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.na.$("ExternalContent_FloodgateRating_1",
CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.na.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.na.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.na.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.na.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.na.$("ExternalContent_FloodgateQuestion",
CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.na.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.na.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.na.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.na.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.na.$("Translator_RatingQuestion",
CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.na.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.na.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.na.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.na.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.na.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),
this.na.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.na.$("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.na.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),
this.na.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.na.$("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.na.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.na.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.na.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.na.$("LinkedIn_Title",
CommonUIStrings.l_LinkedIn_Title),this.na.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.na.$("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.na.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.na.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.na.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.na.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),
this.na.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.na.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.na.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.na.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.na.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.na.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.na.$("VHRestore_SurveyQuestion",
CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.na.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.na.$("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.na.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.na.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.na.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.na.$("ShowChanges_Prompt",
CommonUIStrings.l_Excel_ShowChanges_Prompt),this.na.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.na.$("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.na.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.na.$("ShowChanges_RatingValue_2",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.na.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.na.$("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.na.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.na.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.na.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),
this.na.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.na.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.na.$("ModernUxExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.na.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.na.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.na.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.na.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),
this.na.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.na.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),
this.na.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),this.na.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.na.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.na.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.na.$("PollLoopComponent_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.na.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.na.$("PollLoopComponent_FloodgateRatingValue_2",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.na.$("PollLoopComponent_FloodgateRatingValue_3",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.na.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.na.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.na.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),
this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),
this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),this.na.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.na.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.na.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),
this.na.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.na.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.na.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),
this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),
this.na.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),this.na.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.na.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.na.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.na.$("ShortcutDiscovery_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.na.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.na.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("ShortcutDiscovery_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.na.$("Fonts_PromptTitle",CommonUIStrings.l_FontExperience_FloodgatePromptTitle),this.na.$("Fonts_PromptQuestion",CommonUIStrings.l_FontExperience_FloodgatePromptQuestion),this.na.$("Fonts_PromptAnswer_NotNow",
CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_NotNow),this.na.$("Fonts_PromptAnswer_Sure",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_Sure),this.na.$("Fonts_RatingQuestion",CommonUIStrings.l_FontExperience_FloodgateRatingQuestion),this.na.$("Fonts_RatingValue_1",CommonUIStrings.l_FontExperience_FloodgateRatingValue_1),this.na.$("Fonts_RatingValue_2",CommonUIStrings.l_FontExperience_FloodgateRatingValue_2),this.na.$("Fonts_RatingValue_3",CommonUIStrings.l_FontExperience_FloodgateRatingValue_3),
this.na.$("Fonts_RatingValue_4",CommonUIStrings.l_FontExperience_FloodgateRatingValue_4),this.na.$("Fonts_RatingValue_5",CommonUIStrings.l_FontExperience_FloodgateRatingValue_5),this.na.$("Fonts_WhyQuestion",CommonUIStrings.l_FontExperience_FloodgateWhyQuestion),this.na.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.na.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.na.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.na.$("Ruler_PromptAnswer_Sure",
CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.na.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.na.$("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.na.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.na.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.na.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.na.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.na.$("Ruler_WhyQuestion",
CommonUIStrings.l_WordRuler_WhyQuestion),this.na.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),this.na.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.na.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.na.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.na.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),
this.na.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.na.$("CustomTabDialog_RatingValue_2",CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.na.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.na.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.na.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.na.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),
this.na.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),this.na.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.na.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.na.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.na.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),
this.na.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.na.$("WordStyles_FloodgateRating_2",CommonUIStrings.l_WordStyles_FloodgateRating_2),this.na.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.na.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.na.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.na.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),
this.na.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),this.na.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.na.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.na.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.na.$("UnsavedChangesHighlight_RatingQuestion",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.na.$("UnsavedChangesHighlight_Rating_Yes",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.na.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.na.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.na.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),
this.na.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),this.na.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.na.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.na.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.na.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),
this.na.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),this.na.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.na.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.na.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.na.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),
this.na.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),this.na.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.na.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.na.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.na.$("GrammarSuggestions_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.na.$("GrammarSuggestions_FloodgateRating_1",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.na.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.na.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.na.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),
this.na.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.na.$("GrammarSuggestions_FloodgateQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.na.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.na.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.na.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),
this.na.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.na.$("WordRemoveSsr_FloodgateRatingQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.na.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.na.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.na.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.na.$("WordRemoveSsr_FloodgateRating_4",
CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.na.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),this.na.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.na.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.na.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.na.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),
this.na.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),this.na.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.na.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.na.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.na.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.na.$("WordDrawing_FloodgateRating_4",
CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.na.$("WordDrawing_FloodgateRating_5",CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.na.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.na.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.na.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.na.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.na.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.na.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.na.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.na.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.na.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),
this.na.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),this.na.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.na.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.na.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.na.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.na.$("ShyRibbon_Floodgate_Option_3",
CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.na.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),this.na.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.na.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.na.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.na.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),
this.na.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),this.na.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.na.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.na.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.na.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),
this.na.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),this.na.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.na.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.na.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),
this.na.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.na.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_4",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),this.na.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.na.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.na.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.na.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("WordSimilarity_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.na.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.na.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.na.$("WordSimilarity_FloodgateRating_3",
CommonUIStrings.l_WordSimilarity_FloodgateRating_3),this.na.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.na.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.na.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.na.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.na.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),
this.na.$("PremiumPreviewFloodgateRatingQuestion",CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.na.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.na.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.na.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.na.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.na.$("FloodgateNLQSPromptSubtitle",
CommonUIStrings.l_FloodgateNLQSPromptSubtitle),this.na.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.na.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.na.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.na.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.na.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.na.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),
this.na.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),this.na.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.na.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.na.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.na.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.na.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.na.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.na.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.na.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.na.$("ExcelWebEaseOfUse_RatingValue_4",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.na.$("ExcelWebEaseOfUse_RatingValue_5",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.na.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.na.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.na.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.na.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.na.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.na.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.na.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.na.$("ExcelWebPrintSurvey_RatingValue_4",
CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),this.na.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.na.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.na.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.na.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.na.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ReactAutoFilter_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.na.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.na.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.na.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.na.$("ReactAutoFilter_RatingValue_4",
CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),this.na.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.na.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.na.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.na.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.na.$("WordLinksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),this.na.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.na.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.na.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.na.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),
this.na.$("WordLinksExperience_FloodgateRating_3",CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.na.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.na.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.na.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.na.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),
this.na.$("OnlineVideoSupport_FloodgatePromptQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.na.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.na.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.na.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.na.$("OnlineVideoSupport_FloodgateRating_1",
CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),this.na.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.na.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.na.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.na.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.na.$("OnlineVideoSupport_FloodgateWhyQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),this.na.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.na.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.na.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.na.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),
this.na.$("NavPaneExperience_FloodgateRatingQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.na.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.na.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.na.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.na.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),
this.na.$("NavPaneExperience_FloodgateRating_5",CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.na.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.na.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.na.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.na.$("BookmarksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),this.na.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.na.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.na.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.na.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),
this.na.$("BookmarksExperience_FloodgateRating_3",CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.na.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.na.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.na.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.na.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),
this.na.$("WordPictureBorder_FloodgatePromptQuestion",CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.na.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.na.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.na.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.na.$("WordPictureBorder_FloodgateRating_1",
CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),this.na.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.na.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.na.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.na.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.na.$("WordPictureBorder_FloodgateWhyQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),this.na.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.na.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.na.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.na.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.na.$("WordComment_FloodgateRatingQuestion",
CommonUIStrings.l_WordComment_FloodgateRatingQuestion),this.na.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.na.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.na.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.na.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.na.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),
this.na.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),this.na.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.na.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.na.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.na.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),
this.na.$("WordTrackChanges_FloodgateRatingQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.na.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.na.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.na.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.na.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),
this.na.$("WordTrackChanges_FloodgateRating_5",CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.na.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),this.na.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.na.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.na.$("CollabCorner_Survey_DownloadCopies_Comment_Question",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),this.na.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.na.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.na.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.na.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),
this.na.$("WordListsExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.na.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.na.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.na.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.na.$("WordChartsSupport_FloodgatePromptTitle",
CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),this.na.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.na.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.na.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.na.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),
this.na.$("WordChartsSupport_FloodgateRating_1",CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.na.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.na.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.na.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.na.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),
this.na.$("WordChartsSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.na.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.na.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.na.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.na.$("WordTablesSupport_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),this.na.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.na.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.na.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.na.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.na.$("WordTablesSupport_FloodgateRating_4",
CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),this.na.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.na.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.na.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.na.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.na.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ModernPresence_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.na.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.na.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.na.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.na.$("ModernPresence_RatingValue_4",
CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),this.na.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.na.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.na.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.na.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.na.$("WordInsertImages_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),this.na.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.na.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.na.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.na.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.na.$("WordInsertImages_FloodgateRating_3",
CommonUIStrings.l_WordInsertImages_FloodgateRating_3),this.na.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.na.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.na.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.na.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.na.$("FontPicker_FloodgatePromptQuestion",
CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),this.na.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.na.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.na.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.na.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.na.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),
this.na.$("FontPicker_FloodgateRating3",CommonUIStrings.l_FontPicker_FloodgateRating3),this.na.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.na.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.na.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.na.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.na.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.na.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.na.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.na.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.na.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.na.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.na.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.na.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.na.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.na.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.na.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.na.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.na.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.na.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.na.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.na.$("OnenotePerf_FloodgatePromptTitle",Ib.zoj()),this.na.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.na.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.na.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.na.$("OnenotePerf_FloodgateRatingQuestion",Ib.Aoj()),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.na.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.na.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.na.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.na.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.na.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.na.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.na.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.na.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.na.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.na.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.na.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.na.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.na.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.na.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.na.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.na.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.na.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.na.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.na.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.na.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.na.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.na.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.na.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.na.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.na.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.na.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.na.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.na.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.na.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.na.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.na.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.na.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.na.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.na.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.na.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.na.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.na.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.na.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.na.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.na.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.na.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.na.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.na.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.na.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.na.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.na.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.na.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.na.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.na.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.na.$("WordDesignerDesignerPasteFeedbackRatingQuestion",Ib.Boj()),this.na.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.na.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.na.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.na.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.na.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.na.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.na.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.na.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.na.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.na.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.na.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.na.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.na.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.na.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.na.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.na.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.na.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.na.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.na.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.na.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.na.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.na.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.na.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.na.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.na.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.na.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.na.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.na.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.na.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.na.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.na.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.na.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.na.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.na.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.na.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.na.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.na.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.na.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.na.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.na.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.na.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.na.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.na.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.na.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.na.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.na.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.na.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.na.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.na.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.na.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.na.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.na.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.na.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.na.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.na.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.na.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.na.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.na.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.na.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.na.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.na.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.na.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.na.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.na.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.na.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.na.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.na.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.na.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.na.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.na.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.na.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.na.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.na.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.na.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.na.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.na.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.na.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.na.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.na.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.na.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.na.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.na.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.na.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.na.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.na.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.na.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.na.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.na.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.na.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.na.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.na.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.na.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.na.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.na.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.na.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.na.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.na.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.na.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.na.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.na.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.na.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.na.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.na.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.na.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.na.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.na.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.na.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.na.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.na.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.na.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.na.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.na.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.na.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.na.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.na.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.na.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.na.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.na.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.na.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.na.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.na.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.na.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.na.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.na.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.na.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.na.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.na.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.na.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.na.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.na.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.na.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.na.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.na.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.na.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.na.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.na.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.na.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.na.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.na.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.na.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.na.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.na.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.na.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.na.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.na.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.na.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.na.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.na.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.na.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.na.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.na.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.na.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.na.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.na.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.na.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.na.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.na.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.na.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.na.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.na.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.na.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.na.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.na.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.na.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.na.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.na.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.na.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.na.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.na.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.na.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.na.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.na.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.na.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.na.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.na.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.na.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("PerformanceExperience_RatingQuestion",Ib.X6b(0)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile",Ib.X6b(1)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness",Ib.X6b(2)),this.na.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Ib.X6b(3)),this.na.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Ib.X6b(4)),this.na.$("PerformanceExperience_RatingValue_1",
CommonUIStrings.l_Excel_Rating_1_Satisfied),this.na.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.na.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.na.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.na.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.na.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),
this.na.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.na.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.na.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.na.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),
this.na.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.na.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.na.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.na.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.na.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.na.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),
this.na.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.na.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),
this.na.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.na.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.na.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),
this.na.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.na.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2Survey_RatingValue_2",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.na.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.na.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.na.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),
this.na.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.na.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.na.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),
this.na.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.na.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.na.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.na.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.na.$("ConsumerExperiment_PromptQuestion",
CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.na.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),this.na.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.na.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.na.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.na.$("ConsumerExperiment_RatingValue4",
CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.na.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),this.na.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.na.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),
this.na.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.na.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),this.na.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.na.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.na.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.na.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.na.$("AIMakerSurvey_CommentQuestion",
CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.na.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.na.$("CheckPerformance_PromptQuestion",CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.na.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),
this.na.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.na.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),this.na.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.na.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.na.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.na.$("CheckPerformance_CommentQuestion",
CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.na.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.na.$("SmartSuggestion_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.na.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),
this.na.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.na.$("SmartSuggestion_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.na.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.na.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.na.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),
this.na.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.na.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.na.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.na.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.na.$("PPTO_Picture_FloodgateRatingQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.na.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.na.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.na.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.na.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.na.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.na.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.na.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.na.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.na.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.na.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.na.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.na.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.na.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.na.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.na.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.na.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion),this.na.$("FRE_FirstTeachingCalloutTitle",CommonUIStrings.l_FRE_FirstTeachingCalloutTitle),this.na.$("FRE_FirstTeachingCalloutDescription",CommonUIStrings.l_FRE_FirstTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutNextButtonText",CommonUIStrings.l_FRE_TeachingCalloutNextButtonText),
this.na.$("FRE_SecondTeachingCalloutTitle",CommonUIStrings.l_FRE_SecondTeachingCalloutTitle),this.na.$("FRE_SecondTeachingCalloutDescription",CommonUIStrings.l_FRE_SecondTeachingCalloutDescription),this.na.$("FRE_ThirdTeachingCalloutTitle",CommonUIStrings.l_FRE_ThirdTeachingCalloutTitle),this.na.$("FRE_ThirdTeachingCalloutDescription",CommonUIStrings.l_FRE_ThirdTeachingCalloutDescription),this.na.$("FRE_TeachingCalloutGotItButtonText",CommonUIStrings.l_FRE_TeachingCalloutGotItButtonText),this.na.$("FloodgateSurveyNoRealEditPromptTitle",
CommonUIStrings.l_FloodgateSurveyNoRealEditPromptTitle),this.na.$("FloodgateSurveyNoRealEditPromptQuestion",CommonUIStrings.l_FloodgateSurveyNoRealEditPromptQuestion),this.na.$("FloodgateSurveyNoRealEditSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FloodgateSurveyNoRealEditNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FloodgateSurveyNoRealEditQuestion1",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion1),this.na.$("FloodgateSurveyNoRealEditOption1",CommonUIStrings.l_FloodgateSurveyNoRealEditOption1),
this.na.$("FloodgateSurveyNoRealEditOption2",CommonUIStrings.l_FloodgateSurveyNoRealEditOption2),this.na.$("FloodgateSurveyNoRealEditOption3",CommonUIStrings.l_FloodgateSurveyNoRealEditOption3),this.na.$("FloodgateSurveyNoRealEditOption4",CommonUIStrings.l_FloodgateSurveyNoRealEditOption4),this.na.$("FloodgateSurveyNoRealEditOption5",CommonUIStrings.l_FloodgateSurveyNoRealEditOption5),this.na.$("FloodgateSurveyNoRealEditQuestion2",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion2),this.na.$("FormulaByExample_PromptTitle",
CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptTitle),this.na.$("FormulaByExample_PromptQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptQuestion),this.na.$("FormulaByExample_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("FormulaByExample_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("FormulaByExample_RatingQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingQuestion),this.na.$("FormulaByExampleIgnored_RatingQuestion",
CommonUIStrings.l_Excel_FormulaByExampleIgnored_Survey_RatingQuestion),this.na.$("FormulaByExample_RatingValue_1",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_1),this.na.$("FormulaByExample_RatingValue_2",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_2),this.na.$("FormulaByExample_RatingValue_3",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_3),this.na.$("FormulaByExample_RatingValue_4",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_4),this.na.$("FormulaByExample_RatingValue_5",
CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_5),this.na.$("FormulaByExample_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_CommentQuestion),this.na.$("FormulaByExampleDeclined_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExampleDeclined_Survey_CommentQuestion),this.na.$("CIQSeenNotKeptFPS_Title",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Title),this.na.$("CIQSeenNotKeptFPS_Question",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Question),this.na.$("CIQSeenNotKeptFPS_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.na.$("CIQSeenNotKeptFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.na.$("CIQSeenNotKeptFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_RatingQuestion),this.na.$("CIQSeenNotKeptFPS_RatingValue_Yes",CommonUIStrings.l_DialogYes),this.na.$("CIQSeenNotKeptFPS_RatingValue_No",CommonUIStrings.l_DialogNo),this.na.$("CIQSeenNotKeptFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_WhyQuestion)}catch(fb){h.ULS.sendTraceTag(594052319,
356,15,"SIFB.InitializeUIStringGetter error "+(fb?fb.toString():""))}}static nKi(fb){try{return new Promise(Qb=>{window.setTimeout(()=>{Qb(null)},fb)})}catch(Qb){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static h2f(){return!m.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static Ufj(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",
!1)}static WWd(fb){const Qb=fb?fb[0]:null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(Qb?Qb.surfaceId:""));if(Qb&&"customsurface"===(Qb&&Qb.surfaceType?Qb.surfaceType.toLocaleLowerCase():null)){const mb=Ca.a.Kwj(Qb);if(mb)return h.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+mb+", "+Qb.surfaceId),null}return eb.WWd(fb)}static q$i(){const fb={};fb.retry=m.AFrameworkApplication.fa.Bc("FloodgateGovernanceServiceRetryCount",0);fb.timeout=
m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);fb.simpleRequestEnabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);fb.forceServicelessSurveyDisplay=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return fb}static dCi(fb){if(!("Unknown"!==fb&&
"Automation"!==fb&&m.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+fb),null;fb={};fb.getUserPuid=Ib.Cnj;return fb}static bCi(){const fb={},Qb=!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));fb.isEnabled=Qb;return fb}static Cnj(){return m.AFrameworkApplication.fa.Ga("Puid")}static Q8f(){return Ca.a.Iua()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static P8f(){return Ca.a.Iua()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static O8f(){return Ca.a.Iua()&&
m.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static X6b(fb){if(Ca.a.Iua())switch(fb){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;
case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(fb){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;
default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static yoj(){return Ca.a.Iua()&&m.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static Aoj(){return Ca.a.Iua()?CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static zoj(){return Ca.a.Iua()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:
CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static Boj(){switch(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}Ib.agb="SystemInitiatedFeedbackIsEnabled";
Ib.Moi="obf-CampaignDefinitions";Ib.xMf=100;Ib.TJi=8002;Object(I.a)(Ib,"SystemInitiatedFeedback",null,[1368]);class gc{constructor(fb){if(!fb)throw Error.argumentNull("SystemInitiatedFeedback is null");this.Cof=fb;this.Mwd={};this.Gvc={};this.Jwd={}}logActivity(fb,Qb,mb){const Jb=new Date;if(!fb||!this.Cof.U8a(fb,Ib.agb,Qb))return!1;let Ub=null;fb in this.Mwd&&(Ub=this.Mwd[fb]);const tb=this.z2i(fb),Bc=this.y2i(fb);if(this.kRi(Ub,Jb,mb))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",
tb,fb),this.Cof.logActivity(fb,Qb),this.Mwd[fb]=Jb,this.Gvc[fb]=0,this.Jwd[fb]=Bc+1,!0;this.Gvc[fb]=tb+1;return!1}kRi(fb,Qb,mb){return fb?Qb.getTime()-fb.getTime()>=1E3*mb:!0}z2i(fb){let Qb=0;fb in this.Gvc&&(Qb=this.Gvc[fb]);return Qb}y2i(fb){let Qb=0;fb in this.Jwd&&(Qb=this.Jwd[fb]);return Qb}}Object(I.a)(gc,"SystemInitiatedFeedbackWithTimeLapse",null,[1396]);var Ta=d(95),Ab=d(70);d.d(Y,"CustomerFeedbackPackage",function(){return kc});class kc{constructor(){this.g$e=this.Da=null}get name(){return"Common.App.CustomerFeedback"}Zb(fb){m.AFrameworkApplication.Xg||
(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),m.AFrameworkApplication.Xg=new B.a);fb.register(X,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();fb.register(Ba,"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().oa(()=>new Ba(Ta.FocusManager.instance(),m.AFrameworkApplication.Xg));fb.register(G,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().oa(()=>
new G(fb.resolve("Common.App.ICustomerFeedbackUiWrapper"),fb.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),m.AFrameworkApplication.Xg));fb.register(1319,"Common.ICustomerFeedbackActor").ma().oa(()=>new J(m.AFrameworkApplication.Ta,m.AFrameworkApplication.Aa,fb.Ja("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),m.AFrameworkApplication.fa,m.AFrameworkApplication.Xg));fb.register(Ib,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().oa(()=>
new Ib(fb.resolve("Common.App.ICustomerFeedbackUiWrapper")));fb.register(gc,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().oa(()=>new gc(fb.resolve("Common.ISystemInitiatedFeedback")));this.Da=fb}init(){kc._initialized||(kc.Aac()||(this.g$e=this.Da.resolve("Common.ICustomerFeedbackActor"),this.g$e.wb(),m.AFrameworkApplication.Aa.updateCommandUI()),this.Da.Ja("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");
this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),kc._initialized=!0)}dispose(){}static Aac(){return!!m.AFrameworkApplication.Aa&&!!m.AFrameworkApplication.Aa.hb&&3===m.AFrameworkApplication.Aa.hb.Uk&&1===m.AFrameworkApplication.Aa.hb.$Ia}static main(){let fb=!1;kc.Aac()&&(fb=!0);Ab.a.instance.Dc(new kc,0,fb)}}kc._initialized=!1;Object(I.a)(kc,"CustomerFeedbackPackage",null,[2,3])},1149:function(I,Y,d){I=d(0);var h=d(14),e=d(36);class n{constructor(){this.classId=
0}static U7a(y){try{return e.a(y)}catch(A){}return null}}Object(I.a)(n,"ARoamingAppsResponse",null,[]);class m{constructor(){this.state=this.callback=null;this.Eje=!1}}Object(I.a)(m,"GetRoamingAppsLauncherContext",null,[]);var z=d(27),B=d(81);d.d(Y,"a",function(){return v});class v{constructor(y){this.xyd=!1;this.A7=v.eab;this.DJd=this.XGd=0;this.platform=null;this.XZh=y;this.Cqf=this.EJd=!1}get WSe(){return this.XZh}get nHl(){return this.WSe&&this.EJd?this.Cqf:!1}jsi(){z.AFrameworkApplication.i$b&&
this.WSe&&!this.EJd&&!this.xyd&&(this.DJd=3,this.xyd=!0,this.L1k(),this.kTf())}L1k(){this.A7=v.eab;this.XGd=0}getRoamingAppsLauncher(y,A,E){this.nHl?(y=new m,y.callback=A,y.state=E,y.Eje=!0,this.pTf(y)):A(!1,"",E)}kTf(){const y=new (d(1125).CheckRoamingRightsRequest);y.RoamingApp=this.DJd;y.BaseDocQuerySignature=z.AFrameworkApplication.gh;y.execute(Object(h.a)(this,this.lsi,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.ksi,"checkUserRoamingRightsFailed"),null)}lsi(y){z.AFrameworkApplication.Ug||
((y=n.U7a(y.data.Sd))?this.DWe(y.HasRights):this.DWe(!1))}ksi(){if(!z.AFrameworkApplication.Ug)if(this.XGd>=v.Ukk)this.DWe(!1);else{var y=new B.a(2,1,this.A7,Object(h.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);z.AFrameworkApplication.ye.Db(y);this.XGd++;this.A7*=v.KSe;this.A7>v.Hic&&(this.A7=v.Hic)}}DWe(y){this.Cqf=y;this.EJd=!0;this.xyd=!1}retryCheckUserRoamingRights(){this.kTf()}pTf(y){const A=new (d(1126).GetRoamingLauncherRequest);A.RoamingApp=this.DJd;A.BaseDocQuerySignature=
z.AFrameworkApplication.gh;A.execute(Object(h.a)(this,this.jhj,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.ihj,"getRoamingAppsLauncherFailed"),y)}jhj(y){if(!z.AFrameworkApplication.Ug){var A=n.U7a(y.data.Sd);y=y.data.state;A?(this.platform=A.Platform,y.callback(!0,A.Launcher,y.state)):y.callback(!1,"",y.state)}}ihj(y){if(!z.AFrameworkApplication.Ug){var A=y.data.state;5===y.data.status&&A.Eje?(A.Eje=!1,this.pTf(A)):A.callback(!1,"",A.state)}}static get instance(){return v.Lt||(v.Lt=new v(z.AFrameworkApplication.Afi))}}
v.eab=1E3;v.KSe=5;v.Hic=12E5;v.Ukk=5;v.Lt=null;Object(I.a)(v,"RoamingAppsManager",null,[])},1150:function(I,Y,d){I=d(0);var h=d(14),e=d(958),n=d(67);class m extends e.a{constructor(u,J,G,S,P,Q=null){super(u,G,P.TR,Q);this.Nif=0;this.gba=this.Ucj(S);this.Eqb=J;this.Rh=P;this.R1e=7;this.gs=this.Eqb.ownerDocument.createElement("div");this.gs.className="ModalCalloutControlOverlay";this.gs.tabIndex=0;this.Eqb.insertBefore(this.gs,this.Eqb.firstChild)}show(){this.yL||(this.Rh.Ihb(),this.Rh.eQa(!1),this.gs.style.zIndex=
String(this.Rh.jra),super.show(),this.Vu(),this.Nif=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.R1e))}dismiss(){this.yL&&(this.Rh.PRa(!1),this.kpa(),this.Eqb&&this.Eqb.contains(this.gs)&&this.Eqb.removeChild(this.gs),super.dismiss(),window.clearTimeout(this.Nif))}Vu(){this.Rh.mca(Object(h.a)(this,this.dismiss,"dismiss"));this.Rh.Iy.pb(n.a.click,this.gs,Object(h.a)(this,this.onClick,"onClick"))}kpa(){this.Rh.tKa(Object(h.a)(this,this.dismiss,"dismiss"));this.Rh.Iy.yb(n.a.click,
this.gs,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}Ucj(u){let J=0;switch(u){case 0:J=190;break;case 1:J=250;break;case 2:J=300;break;case 3:J=360}return J}}Object(I.a)(m,"ModalCallout",e.a,[]);var z=d(387),B=d(351),v=d(141);class y extends m{constructor(u,J,G,S,P,Q=null){super(u,J,G,S,P,Q);this.nBc=null}show(){if(!this.yL){const u=Object.assign(new B.a,{onShow:()=>{m.prototype.show.call(this)}});v.UISurfaces.mL().then(J=>{const G=J.externalNotification();this.nBc=
J.addNotification(G,u);return null},J=>{z.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}}dismiss(){this.yL&&this.nBc&&(v.UISurfaces.mL().then(u=>{u.removeNotification(this.nBc);return this.nBc=null},u=>{z.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",u);return null}),super.dismiss())}}Object(I.a)(y,"ReactManagedModalCallout",m,[]);var A=d(27);d.d(Y,"a",function(){return E});class E{static ZXd(u,J,G,S,P=null){return A.AFrameworkApplication.Aa.hb.WUa?
new y(u,J,G,S,A.AFrameworkApplication.Aa,P):new m(u,J,G,S,A.AFrameworkApplication.Aa,P)}}Object(I.a)(E,"ModalCalloutControlFactory",null,[])},1151:function(I,Y,d){d.r(Y);I=d(0);var h=d(516),e=d(517);class n{constructor(v){this.IP=this.f9e=h.a.unused;this.QDc=v}get mtb(){return this.f9e}wGe(v,y,A,E){A===this.QDc.element&&(this.f9e=v,this.IP=E+this.QDc.offset)}vIe(){}XSd(v){return this.mtb!==h.a.unused?Object.assign(new e.a,{element:v,offset:this.IP}):null}}Object(I.a)(n,"ChildSelectionHelper",null,
[1381]);class m{constructor(v,y){this.pGd=!1;this.QDc=y;this._parent=v;this.IP=y.offset}get mtb(){return h.a.unused}wGe(v,y,A,E){y||this.QDc.offset!==v||(this.IP=E,this.pGd=!0)}vIe(v,y){!this.pGd&&this.IP>y&&(this.IP-=y-v+1)}XSd(v){return Object.assign(new e.a,{element:this.pGd?v:this._parent,offset:this.IP})}}Object(I.a)(m,"ParentSelectionHelper",null,[1381]);var z=d(908);d.d(Y,"CombineHelper",function(){return B});class B{constructor(v,y,A){this.Waf=h.a.unused;this.aRb="";this._element=v;this.eXb=
y;this.FWb=this.U_f(v,A.start);this.CWb=this.U_f(v,A.end)}U_f(v,y){return y.element===v?new m(v,y):new n(y)}R7h(v){const y=v===this.eXb,A=this._element.childNodes[v],E=this.aRb.length;this.FWb.wGe(v,y,A,E);this.CWb.wGe(v,y,A,E);this.aRb+=A.nodeValue}end(v,y){this.eXb!==y&&(this.Waf=y,Array.add(v,this))}tvi(){var v=this.Nfj();this.fhh(this.eXb,v-1);this.fhh(v+1,this.Waf);v=this._element.childNodes[this.eXb];this.aRb!==v.nodeValue&&(v.nodeValue=this.aRb);return this.Ali(v)}fhh(v,y){if(!(y<v)){this.FWb.vIe(v,
y);this.CWb.vIe(v,y);for(let A=v;A<=y;A++)this._element.removeChild(this._element.childNodes[v])}}Ali(v){return Object.assign(new z.a,{start:this.FWb.XSd(v),end:this.CWb.XSd(v)})}Nfj(){return this.FWb.mtb!==h.a.unused?this.FWb.mtb:this.CWb.mtb!==h.a.unused?this.CWb.mtb:this.eXb}}Object(I.a)(B,"CombineHelper",null,[])},1156:function(I,Y,d){I=d(0);var h=d(1199),e=d(387),n=d(27),m=d(81),z=d(69);class B{static Doj(){if(!B.Nvc&&(B.Nvc=new z.a,n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.Cu("AggregatorIdDisabledList"))){const A=
n.AFrameworkApplication.fa.WA("AggregatorIdDisabledList");for(let E=0;E<A.length;E++)B.Nvc.$(A[E],!0)}return B.Nvc}}B.Nvc=null;Object(I.a)(B,"DisabledAggregatorListStore",null,[]);var v=d(287);d.d(Y,"a",function(){return y});class y{constructor(A,E,u,J,G,S=!0,P=null){this.W$e=this.jpf=this.hgf=!1;this.Zd=null;if(!A)throw v.a.argument("taskManagerLazy");if(!G)throw v.a.argument("dataAggregator");this.z1h=A;this.kHd=E;this._id=u;this.jef=6E4*J;this.wxc=G;this.zmf=S;this.sWb=P;B.Doj().Hb(this._id.toString())&&
(this.W$e=!0)}get taskManager(){return this.Zd||(this.Zd=this.z1h.value)}track(A,E=null){this.W$e||(this.DSi(),this.Z5k(),this.wxc.SYb(A,E))}Z5k(){!this.hgf&&0<this.jef&&(this.hgf=!0,this.Lnh())}Lnh(){const A=new m.a(5,1,this.jef,()=>{this.G7k()},19,this._id.toString());this.taskManager.Db(A)}G7k(){!this.sWb||this.sWb.uXe()?this.Rnd():this.zmf&&this.wxc.reset();this.Lnh()}Rnd(){const A=this.wxc.getData();if(A){const E=parseInt(String(A.length));if(isNaN(E)||0<E)this.Uoh(A),this.zmf&&this.wxc.reset()}}Uoh(A){e.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:A})}DSi(){this.jpf||(this.kHd(()=>{this.Rnd()}),this.jpf=!0)}static xr(A,E,u,J,G){return new y(new h.a(()=>n.AFrameworkApplication.ye),n.AFrameworkApplication.pga,A,E,u,J,G)}static GW(A,E,u,J=!0){return y.xr(A,E,u,J,null)}}Object(I.a)(y,"Aggregator",null,[1266])},1227:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]=
"safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(h||(h={}));Object(I.b)("BrowserCode",h)},1228:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.value=!1}}Object(I.a)(h,"OutBool",null,[])},1229:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(I.a)(h,"ColorCellProps",null,[])},1230:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(356);class h extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}Object(I.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1231:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(512);class e{constructor(n){this.yca=n}DUe(n){return h.a.then(this.yca.Wqb(n,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),m=>this.bhj(m))}bhj(n){return n&&n.Wi&&n.Wi.data?n.Wi.data.Sd:
null}}Object(I.a)(e,"SimpleRequestManager",null,[1518])},1232:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(304);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.myb;h.Image32by32Class=d.a.LEa;h.Image48by48Class=d.a.gde;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(I.a)(h,"ButtonCommandProperties",null,[])},1235:function(I,Y,d){function h(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.ZFe)||void 0===
l?void 0:l.forEach(x=>{x&&c.add(x)})});return Array.from(c).map(f=>b.Be(ka.a.Hf(f))).filter(f=>null!==f&&void 0!==f)}function e(a,b){return b&&b.TableNode?new xF(b):new yF(a)}function n(a,b){Tw.set(a,b)}d.r(Y);var m=d(0),z=d(70),B=d(55),v=d(95),y=d(180),A=d(173),E=d(121),u=d(27),J=d(1097),G=d(37),S=d(157),P=d(38);class Q{constructor(a){this.value=a}}Object(m.a)(Q,"RefTriState",null,[]);var D=d(34);class O{aQe(){this.TSi();this.kAj();this.bYj();this.Q4j();P.a.instance.ga(70)&&this.dLk();this.v7k();
P.a.instance.ga(71)&&this.zNb();this.ysl();this.ttl();this.XIi();this.MXj();this.A3k();this.Sol();this.xul();P.a.instance.ga(79)&&(B.a.vk||this.qCj(),this.u_j(),this.Kok(),this.XAl())}TSi(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);a.bindAction(y.KeyInputManager.Oa(A.a.tq,0),D.a.enter);a.bindAction(y.KeyInputManager.Oa(A.a.tq,4),D.a.Qpd)}kAj(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Hyperlink),D.a.insertHyperlink)}qCj(){const a=
v.FocusManager.instance().Fc(E.AFrame.gj);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.Mga,5),D.a.oC);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.dba,5),D.a.By)}MXj(){if(!B.a.mx){const a=v.FocusManager.instance().Fc(E.AFrame.gj);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.uvc,y.KeyInputManager.Oe),D.a.$ng,O.$ib("faOpen"))}}bYj(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);P.a.instance.ga(54)&&E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_CenterJustify),D.a.centerJustify,O.MJ);B.a.vk?(E.AFrame.kk(a,
y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),D.a.leftJustify,O.MJ),E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),D.a.rightJustify,O.MJ)):(E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_LeftJustify),D.a.leftJustify,O.MJ),E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_RightJustify),D.a.rightJustify,O.MJ));P.a.instance.ga(54)&&E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.iwd,y.KeyInputManager.Oe),D.a.fullJustify,O.MJ)}u_j(){var a=
v.FocusManager.instance();const b=a.Fc(E.AFrame.gj);a=a.Fc(S.AppFrame.zW);E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.uMa,y.KeyInputManager.Oe),D.a.NM,O.xOf);E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.J5e,y.KeyInputManager.Oe),D.a.mP,O.xOf);B.a.zAb&&a.bindAction(y.KeyInputManager.Oa(A.a.tvc,4|y.KeyInputManager.Oe),D.a.NM)}Q4j(){const a=v.FocusManager.instance().Fc(E.AFrame.gj);E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_TellMe),G.a.ssd,O.MJ)}Kok(){if(P.a.instance.ga(27)||P.a.instance.ga(58)){const a=
v.FocusManager.instance().Fc(E.AFrame.gj),b=P.a.instance.ga(58)?D.a.H5k:D.a.save;E.AFrame.kk(a,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Save),b);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.Y6e,0),D.a.sync)}}dLk(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.rvc,1),D.a.Hdd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.rvc,0),D.a.Hdd)}v7k(){this.Aoh(S.AppFrame.zW);
this.Aoh(S.AppFrame.sPe)}Aoh(a){var b=v.FocusManager.instance(),c=A.a.dba,f=A.a.Mga;a=b.Fc(a);const l=b.Fc(u.AFrameworkApplication.zhb);a.bindAction(y.KeyInputManager.Oa(c,0),D.a.leftArrow);a.bindAction(y.KeyInputManager.Oa(f,0),D.a.rightArrow);a.bindAction(y.KeyInputManager.Oa(A.a.cZ,0),D.a.upArrow);a.bindAction(y.KeyInputManager.Oa(A.a.K6,0),D.a.downArrow);a.bindAction(y.KeyInputManager.Oa(f,4),D.a.u0a);a.bindAction(y.KeyInputManager.Oa(c,4),D.a.t0a);B.a.vk?(a.bindAction(y.KeyInputManager.Oa(f,
1),D.a.RCa),a.bindAction(y.KeyInputManager.Oa(c,1),D.a.QCa),a.bindAction(y.KeyInputManager.Oa(f,5),D.a.aRa),a.bindAction(y.KeyInputManager.Oa(c,5),D.a.$Qa),a.bindAction(y.KeyInputManager.Oa(f,8),D.a.IYa),a.bindAction(y.KeyInputManager.Oa(c,8),D.a.JYa),a.bindAction(y.KeyInputManager.Oa(f,12),D.a.XRa),a.bindAction(y.KeyInputManager.Oa(c,12),D.a.YRa)):(a.bindAction(y.KeyInputManager.Oa(f,y.KeyInputManager.Oe),D.a.RCa),a.bindAction(y.KeyInputManager.Oa(c,y.KeyInputManager.Oe),D.a.QCa),a.bindAction(y.KeyInputManager.Oa(f,
y.KeyInputManager.Oe|4),D.a.aRa),a.bindAction(y.KeyInputManager.Oa(c,y.KeyInputManager.Oe|4),D.a.$Qa));a.bindAction(y.KeyInputManager.Oa(A.a.cZ,4),D.a.xMb);a.bindAction(y.KeyInputManager.Oa(A.a.K6,4),D.a.gkb);a.bindAction(y.KeyInputManager.Oa(A.a.cZ,y.KeyInputManager.Oe),D.a.O1b);a.bindAction(y.KeyInputManager.Oa(A.a.K6,y.KeyInputManager.Oe),D.a.gub);a.bindAction(y.KeyInputManager.Oa(A.a.cZ,y.KeyInputManager.Oe|4),D.a.G7a);a.bindAction(y.KeyInputManager.Oa(A.a.K6,y.KeyInputManager.Oe|4),D.a.ZQa);
a.bindAction(y.KeyInputManager.Oa(A.a.aF,0),D.a.JYa);a.bindAction(y.KeyInputManager.Oa(A.a.aF,4),D.a.YRa);if(P.a.instance.ga(41))a.bindAction(y.KeyInputManager.Oa(A.a.aF,y.KeyInputManager.Oe),D.a.fdd),a.bindAction(y.KeyInputManager.Oa(A.a.Qw,y.KeyInputManager.Oe),D.a.JEe);else if(P.a.instance.ga(17)||P.a.instance.ga(77))a.bindAction(y.KeyInputManager.Oa(A.a.aF,y.KeyInputManager.Oe),D.a.kgb),a.bindAction(y.KeyInputManager.Oa(A.a.Qw,y.KeyInputManager.Oe),D.a.jgb);a.bindAction(y.KeyInputManager.Oa(A.a.aF,
y.KeyInputManager.Oe|4),D.a.A8a);a.bindAction(y.KeyInputManager.Oa(A.a.Qw,0),D.a.IYa);a.bindAction(y.KeyInputManager.Oa(A.a.Qw,4),D.a.XRa);a.bindAction(y.KeyInputManager.Oa(A.a.Qw,y.KeyInputManager.Oe|4),D.a.z8a);B.a.vk&&(a.bindAction(y.KeyInputManager.Oa(A.a.cZ,2),D.a.JYa),a.bindAction(y.KeyInputManager.Oa(A.a.cZ,6),D.a.YRa),a.bindAction(y.KeyInputManager.Oa(A.a.K6,2),D.a.IYa),a.bindAction(y.KeyInputManager.Oa(A.a.K6,6),D.a.XRa),a.bindAction(y.KeyInputManager.Oa(A.a.aF,1),D.a.kgb),a.bindAction(y.KeyInputManager.Oa(A.a.Qw,
1),D.a.jgb),P.a.instance.ga(6)&&(a.bindAction(y.KeyInputManager.Oa(A.a.cZ,5),D.a.G7a),a.bindAction(y.KeyInputManager.Oa(A.a.K6,5),D.a.ZQa)));c=y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,D.a.Ksa);l.bindAction(c,G.a.uRa);P.a.instance.ga(79)&&(f=b.Fc(E.AFrame.ND),b=b.Fc(E.AFrame.gj),f.bindAction(c,G.a.iCa),b.bindAction(y.KeyInputManager.Oa(A.a.DMa,y.KeyInputManager.Oe|4),D.a.knd),P.a.instance.ga(41)&&B.a.vk&&(a.bindAction(y.KeyInputManager.Oa(A.a.SB,1),D.a.kgb),a.bindAction(y.KeyInputManager.Oa(A.a.RB,
1),D.a.jgb)),b.bindAction(y.KeyInputManager.Oa(A.a.RB,0),D.a.pageDown),b.bindAction(y.KeyInputManager.Oa(A.a.SB,0),D.a.pageUp),b.bindAction(y.KeyInputManager.Oa(A.a.RB,4),D.a.Pqc),b.bindAction(y.KeyInputManager.Oa(A.a.SB,4),D.a.Spd));P.a.instance.ga(6)&&(a.bindAction(y.KeyInputManager.Oa(A.a.RB,y.KeyInputManager.Oe|4),G.a.uRa),a.bindAction(y.KeyInputManager.Oa(A.a.SB,y.KeyInputManager.Oe|4),G.a.uRa));B.a.Tj||a.bindAction(y.KeyInputManager.Oa(A.a.tMa,0),D.a.Iaa);a.bindAction(y.KeyInputManager.Oa(A.a.xpa,
4),D.a.Rpd);a.bindAction(y.KeyInputManager.Oa(A.a.xpa,4|y.KeyInputManager.Oe),D.a.Rpd)}zNb(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.fwd,y.KeyInputManager.Oe|1),D.a.$Qd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.gwd,y.KeyInputManager.Oe|1),D.a.aRd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.S6e,y.KeyInputManager.Oe|1),D.a.bRd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.T6e,y.KeyInputManager.Oe|1),D.a.cRd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.U6e,y.KeyInputManager.Oe|
1),D.a.dRd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.V6e,y.KeyInputManager.Oe|1),D.a.eRd);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.Qza,y.KeyInputManager.Oe|4),D.a.ZQd);P.a.instance.ga(61)&&v.FocusManager.instance().Fc(E.AFrame.gj).bindAction(y.KeyInputManager.Oa(A.a.lwd,y.KeyInputManager.Oe|4),D.a.Xei)}ysl(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);a.bindAction(y.KeyInputManager.Oa(A.a.Sq,0),D.a.tab);a.bindAction(y.KeyInputManager.Oa(A.a.Sq,4),D.a.Qqc)}ttl(){if(P.a.instance.ga(30)){const a=
v.FocusManager.instance().Fc(S.AppFrame.zW);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.tq,y.KeyInputManager.Oe),D.a.$ta)}}xul(){const a=v.FocusManager.instance(),b=a.Fc(S.AppFrame.zW);a.Fc(E.AFrame.ND);E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Bold),D.a.bold,O.MJ);E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Italic),D.a.setItalic,O.MJ);E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Underline),D.a.underline,O.MJ);B.a.vk&&(E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Bold_Mac),
D.a.bold,O.MJ),E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Italic_Mac),D.a.setItalic,O.MJ),E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Underline_Mac),D.a.underline,O.MJ));E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_ClearFormatting),D.a.clearFormatting);P.a.instance.ga(54)&&E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.tmb,y.KeyInputManager.Oe|4),D.a.clearFormatting);E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.rmb,y.KeyInputManager.Oe|1),D.a.v1,O.$ib("00FFFF"));
if(P.a.instance.ga(94)||P.a.instance.ga(96))E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.uMa,y.KeyInputManager.Oe|4),D.a.bH,O.MJ),E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.Nuc,y.KeyInputManager.Oe),D.a.bH,O.MJ),E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.ivd,y.KeyInputManager.Oe|4),D.a.NH,O.MJ),E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.Luc,y.KeyInputManager.Oe),D.a.NH,O.MJ);u.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&E.AFrame.kk(b,y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_ToggleCase),D.a.$sd);
u.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.kvd,y.KeyInputManager.Oe|4),D.a.superscript,O.MJ),E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.nvd,y.KeyInputManager.Oe|4),D.a.superscript,O.MJ),E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.lvd,y.KeyInputManager.Oe|4),D.a.subscript,O.MJ),E.AFrame.kk(b,y.KeyInputManager.Oa(A.a.Muc,y.KeyInputManager.Oe|4),D.a.subscript,O.MJ))}XAl(){const a=v.FocusManager.instance().Fc(E.AFrame.ND),b=v.FocusManager.instance().Fc(S.AppFrame.zW);
var c=y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,G.a.iCa);b.bindAction(c,D.a.undo);c=y.KeyInputManager.Oa(A.a.TH,1);a.bindAction(c,G.a.iCa);B.a.vk||b.bindAction(c,D.a.undo);c=y.KeyInputManager.lw(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,G.a.iCa);b.bindAction(c,D.a.redo);c=y.KeyInputManager.Oa(A.a.TH,5);a.bindAction(c,G.a.iCa);B.a.vk||b.bindAction(c,D.a.redo)}Sol(){const a=v.FocusManager.instance().Fc(S.AppFrame.zW);P.a.instance.ga(54)?(B.a.vk?this.Lra(a,y.KeyInputManager.Oa(A.a.gwd,
5),"\u20ac"):this.Lra(a,y.KeyInputManager.Oa(A.a.pmb,y.KeyInputManager.Oe|1),"\u20ac"),this.Lra(a,y.KeyInputManager.Oa(A.a.Oza,y.KeyInputManager.Oe|1),"\u00a9"),this.Lra(a,y.KeyInputManager.Oa(A.a.YPb,y.KeyInputManager.Oe|1),"\u00ae"),this.Lra(a,y.KeyInputManager.Oa(A.a.ZPb,y.KeyInputManager.Oe|1),"\u2122"),this.Lra(a,y.KeyInputManager.Oa(A.a.Muc,y.KeyInputManager.Oe|1),"\u2014"),this.Lra(a,y.KeyInputManager.Oa(A.a.uMa,y.KeyInputManager.Oe|1),"\u2026"),this.Lra(a,y.KeyInputManager.Oa(A.a.J5e,y.KeyInputManager.Oe|
5),"\u00bf"),this.Lra(a,y.KeyInputManager.Oa(A.a.fwd,y.KeyInputManager.Oe|5),"\u00a1")):P.a.instance.ga(25)&&this.Lra(a,y.KeyInputManager.Oa(A.a.pmb,y.KeyInputManager.Oe|1),"\u20ac")}Lra(a,b,c){E.AFrame.kk(a,b,D.a.mUa,O.OGj("symbol_"+c))}XIi(){if(u.AFrameworkApplication.TE){var a=v.FocusManager.instance().Fc(E.AFrame.gj);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.W6e,y.KeyInputManager.Oe|1),G.a.giveFeedback);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.X6e,y.KeyInputManager.Oe|1),G.a.giveFeedback)}}A3k(){const a=
v.FocusManager.instance().Fc(E.AFrame.gj);B.a.mx||E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.rmb,1),D.a.activateRibbonTab,O.$ib("tabHome"));E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.Qza,1),D.a.activateRibbonTab,O.$ib("tabInsert"));E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.smb,1),D.a.activateRibbonTab,O.$ib("tabPageLayout"));E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.YPb,1),D.a.activateRibbonTab,O.$ib("tabReview"));E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.$6e,1),D.a.activateRibbonTab,O.$ib("tabView"))}static get instance(){return O.Ka||
(O.Ka=new O)}static xOf(){return new J.DictionaryPropertySet}static MJ(){return new Q(2)}static OGj(a){return()=>{const b={};b.SourceControlId=a;return b}}static $ib(a){return()=>a}}O.Ka=null;Object(m.a)(O,"ShortcutRegistration",null,[]);class X{get name(){return"Box4.Shortcuts"}Zb(){}init(){O.instance.aQe()}dispose(){}static main(){z.a.instance.Dc(new X)}}Object(m.a)(X,"Box4ShortcutsPackage",null,[2,3]);var N=d(307);class aa{Ot(a,b,c=!1,f=!1,l=!1,x=null){return N.a.Ot(a,b,c,f,l,x)}Buc(a,b,c){return N.a.Buc(a,
b,c)}osb(a,b){return N.a.osb(a,b)}jW(a,b,c,f,l=!1,x=!1){return N.a.jW(a,b,c,f,l,x)}iQa(a,b=null){return N.a.iQa(a,b)}Ida(){N.a.Ida()}B7a(a,b,c,f=null){return N.a.B7a(a,b,c,f)}tEa(a,b,c=!1,f=!0){return N.a.tEa(a,b,c,f)}M$b(a,b){return N.a.M$b(a,b)}}Object(m.a)(aa,"TextMetricsAdapterProxy",null,[1299]);var V=d(314),ca=d(151);class fa{amj(a){var b=a;for(a=null;!a&&b&&"P"!==b.tagName;)a=V.a.Be(b,ca.a.bOb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(fa,"TextMetricsHelper",
null,[313]);class ma{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}Zb(a){this.Da=a;this.Da.register(1299,"Box4.ITextMetricsAdapter").ma().oa(()=>new aa);this.Da.register(313,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new fa)}static main(){z.a.instance.Dc(new ma)}}Object(m.a)(ma,"Box4TextMetricsPackage",null,[2,3]);var da=d(339),qa=d(252),F=d(14),sa=d(99),ia=d(387),Na=d(717),Ca=d(97),ha=d(47),Ba=d(1219),va=d(1215),
ta=d(67),Fa=d(565),pa=d(105),ka=d(352),Ha=d(794),Ya=d(270),Ka=d(18),Pa=d(6);class Oa{static sal(a){const b=new Na.a;for(let c of a)b.add(c);return b}static ohh(a,b){const c=new Ka.a;b=Oa.sal(b);for(let f of a)b.contains(f)||c.add(f);return c}static BWk(a,b){return Oa.ohh(Pa.asEnumerable(a),b).toArray()}static CWk(a,b){return Oa.ohh(a,b)}}Object(m.a)(Oa,"ExtendedGuidUtils",null,[]);var oa=d(1200),Xa=d(24),Hb=d(165);class Ob{}Ob.Spi="ChangeInfo";Object(m.a)(Ob,"CatchUpActivityConstants",null,[]);class eb{}
eb.GHb="\u00a0";eb.Ozf="\ue200";eb.wdg="\ue201";eb.LPi=32767;eb.xNc=3;eb.R_d=1;Object(m.a)(eb,"ContentEditableViewConstants",null,[]);var Eb=d(547),oc=d(123),Sb=d(33),qc=d(367),$a=d(40),ab=d(42),Ib=d(90),gc=d(92),Ta=d(54),Ab=d(88);class kc{constructor(a,b,c){this.Qa=b;this.Mb=c}}Object(m.a)(kc,"ChangeInfo",null,[]);d(610);var fb=d(813);class Qb{}Object(m.a)(Qb,"InternalLinkConstants",null,[]);class mb extends Sys.EventArgs{constructor(){super();this.j8a=null}}Object(m.a)(mb,"EditEventArgs",Sys.EventArgs,
[]);class Jb extends mb{constructor(){super();this.EZj=0;this.Jwl=this.mOc=this.y1e=this.f_j=this.XBj=this.Xfg=this.WXf=this.HWi=this.WSi=!1}}Object(m.a)(Jb,"ParagraphContentUpdatedEventArgs",mb,[]);class Ub{constructor(a){this.o1c=a}}Object(m.a)(Ub,"BlobPresenterArgs",null,[]);var tb=d(32);class Bc{}Bc.T3="TrackedChange";Bc.EAh="TrackChangeTableRowInsertion";Bc.BAh="TrackChangeTableRowDeletion";Bc.pBh="TrackChangeTextInsertion";Bc.nBh="TrackChangeTextDeletion";Bc.xBj="TrackChangeImageModified";Bc.vBj=
"TrackChangeImageInsertion";Bc.rBj="TrackChangeImageDeletion";Bc.Mne="TrackChangeIndirectEffect";Object(m.a)(Bc,"TrackChangeConstants",null,[]);var Gb=d(907),Hc=d(98);const $b=a=>!!a.eRa&&Pa.AT(a.eRa,b=>3===b.type||2===b.type||4===b.type),lc=(a,b)=>{let c=!1,f=!1,l=null;if(b.eRa)for(let x of b.eRa)1===x.type&&(c=!0),3===x.type&&(f=!0),4===x.type&&x.He&&x.He.paragraph&&(l=x);l&&Sys.UI.DomElement.addCssClass(a,Hc.a.qIi);f&&Sys.UI.DomElement.addCssClass(a,Hc.a.ocg);c&&Sys.UI.DomElement.addCssClass(a,
Hc.a.kIi)},Vb=a=>{const b=[Hc.a.VOi,Hc.a.WOi,Hc.a.UOi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var ic=d(361);class qb{constructor(a){this.dSb=this.fXb=this.a$e=null;this.Ii=a}get paragraphNode(){return this.Ii}get eRa(){return this.a$e}get Ikb(){return this.fXb}get p8a(){return this.dSb}get isEmpty(){return(!this.eRa||!this.eRa.count)&&(!this.Ikb||!this.Ikb.count)&&(!this.p8a||!this.p8a.count)}qvk(){this.Ikb&&(this.fXb=new Ka.a);this.p8a&&(this.dSb=new Ka.a)}Xud(a){this.eRa||(this.a$e=
new ic.a);this.Ikb||(this.fXb=new Ka.a);this.p8a||(this.dSb=new Ka.a);this.eRa.Xud(a,b=>{this.Ikb.add(b)},b=>{this.p8a.add(b)})}}Object(m.a)(qb,"IntentRenderingState",null,[]);class Wb{constructor(a,b){this.element=a;this.next=b}}Object(m.a)(Wb,"ElementStackNode",null,[]);class Xc{constructor(a=!1){this._history=new Sys.StringBuilder;this.uAa=this.nv=null;this.EXb=a}k2j(a){if(this.EXb&&a){this._history.append("[Cp "+a.cp+":");if(a.Wh)for(var b=0;b<a.Wh.length;b++)this._history.append(a.Wh.ga(b).vy+
","+a.Wh.ga(b).mfa),b!==a.Wh.length-1&&this._history.append("|");if(a.lk)for(a.Wh&&this._history.append("|"),b=0;b<a.lk.length;b++)this._history.append(a.lk.ga(b).hua?"B":"I"),this._history.append(a.lk.ga(b).wk?"S":"E"),this._history.append(a.lk.ga(b).Uzb?"R":"F"),b!==a.lk.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.nv){for(var a=this.nv;a.next;)a=a.next;a.next=this.uAa;this.uAa=this.nv;this.nv=null;this.EXb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&
ia.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.EXb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.nv.element}pop(a=""){this.isEmpty()&&ia.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=this.nv.element;this.nv.element=null;const c=this.nv.next;this.nv.next=this.uAa;this.uAa=this.nv;this.nv=c;this.EXb&&this._history.append(String.format("Pop {0} Label:{1}\n",
b?b.className:"Null Element",a));return b}push(a,b=""){if(this.uAa){const c=this.uAa.next;this.uAa.next=this.nv;this.nv=this.uAa;this.uAa=c;this.nv.element=a}else this.nv=new Wb(a,this.nv);this.EXb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.nv}}Object(m.a)(Xc,"ElementStack",null,[]);class xb{constructor(){this.D$b=!1;this.span=null}}Object(m.a)(xb,"IntelligentPlaceholderRenderingState",null,[]);class Rb{constructor(a,b,c){this.eventName=
a;this.Ec=b;this.handler=c}}Object(m.a)(Rb,"ParagraphContentRendererMouseEventRegistration",null,[]);var wc=d(78);class ud extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.aKb=c}}Object(m.a)(ud,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class uc extends ud{constructor(a,b,c,f,l){super(a,b,c);this.fXb=f.Ikb;this.dSb=f.p8a;this.EQh=l}get Ikb(){return this.fXb}get p8a(){return this.dSb}get elementType(){return this.EQh}}Object(m.a)(uc,"IntentRangeRenderedEventArgs",
ud,[]);class db extends ud{constructor(a,b,c,f){super(a,b,c);this.Up=f}}Object(m.a)(db,"SpellingErrorRenderedEventArgs",ud,[]);class Yb{constructor(){this.Pa=new wc.a}dispose(){this.Pa&&(this.Pa.dispose(),this.Pa=null)}FPk(a,b,c,f){this.Pa&&this.Pa.raiseEvent(Yb.nyk,new db(a,b,c,f))}Ydh(a,b,c,f,l){this.Pa&&this.Pa.raiseEvent(Yb.puk,new uc(a,b,c,f,l))}}Yb.nyk="OnSpellingErrorRangeRendered";Yb.puk="OnIntentRangeRendered";Object(m.a)(Yb,"ParagraphRenderEvents",null,[106]);class Zc{constructor(){this.FEf=
null;this.Fbg=!1;this.vZg=this.vrf=null}}Object(m.a)(Zc,"RenderParagraphContentResults",null,[]);var Kb=d(158),Yc=d(69);class ec{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){this.CAa=this.AEd=this.CDd=this.Cpb=null;this.Lf=a;this.GP=b;this.fd=c;this.dqa=f;this.hN=l;this.aw=H;this.I4a=U;this.cOa=ja;this.qPh=Va;this.FV=hb;this.cZh=yb;this.VRh=Zb;this.WNh=Kc;this.jqf=new Na.a;this.pEc=fc;this.Iob=!!ya&&ya.jFa(65);this.AEc=this.Fyc=null;this.MNa=x;this.jUh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");
this.hd=ya}get cCf(){return!0}get vjg(){null==this.CDd&&(this.CDd=!!this.hd&&this.hd.isFeatureEnabled(85));return this.CDd}get Png(){null==this.AEd&&(this.AEd=!!this.hd&&this.hd.isFeatureEnabled(77));return this.AEd}get WN(){null==this.CAa&&(this.CAa=!!this.hd&&this.hd.isFeatureEnabled(79));return this.CAa}C_k(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){this.Fyc={};this.AEc=new Kb.a;const we=Sb.ParagraphReader.text(a),$d=new Ka.a;var Te=!1;u.AFrameworkApplication.fa&&(Te=u.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));
const Ze=new Xc(Te);Ze.push(c,"RenderParagraphContentStart");let Vf=null,gg=null,Qg=null,Rg=null,Wf=Te=null;const rg=new Jb;var Sg=!1;let Gh=!1,Zi=!1,Ei=!1,fj=0,Fi=null,Gi=null;const Mk=new Ka.a;this.pEc&&this.pEc.SMl(a,c);const Cj=this.cOa.LW(a);this.cOa.Aei(c,a,b,Cj,b.Ld);if(this.I4a.nx&&b.Wl){var Bk=this.Lf.Pd;Bk&&1===Bk.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}Bk=!a.SW;let Il=!1,lk=!1,Jl=!1,Vj=!1,Wj=0,sk=!1,kl=!1,vj=null,vh=0;const ll=new xb,Xl=Array(a.Ra.length+1);let xm=
this.vjg?new Ka.a:null,Nk=null,Ok=null;for(;fj<a.Ra.length;){const le=a.Ra.ga(fj);var pi=void 0,Hg=void 0,qi=!1;Ze.k2j(le);({uKc:pi,qKc:Hg}=ec.Y_f(le));this.vjg&&(!this.jUh||pi.length||Hg.length)&&({uKc:pi,qKc:Hg,HIi:xm,QOj:qi}=ec.RCl(le.paragraph.Fh,pi,Hg,xm),ll.D$b=0<xm.count);Vj=0<pi.length||Vj;Xl[fj]=c.childNodes.length;if(0<le.cp&&le.Mj)break;let Fg=le.cp;const $h=fj<a.Ra.length-1?a.Ra.ga(fj+1).cp:Sb.ParagraphReader.textLength(a);fj++;var hg=!1;0<Fg&&Ze.pop("CurrentCpLargerThanZero");le.GL&&
(Vf=null);le.sv&&(Ok=le.sv);le.isDictationCorrectionEnd&&(Ok=null);le.FY&&(gg=null);le.a4&&(Qg=null);le.Yka&&(Rg=null);var Ld=void 0,Oe=void 0;this.WN?(Ld=le.Vda,Oe=le.C_):(Ld=!!le.Lo,Oe=!!le.fieldRangeEnd);if(!Sg||le.blob||le.formatting||le.hyperlink||le.hn||le.c4||Oe||Ld||this.Iob&&(le.isTrackChangeInfoEnd||le.dO)||le.ow&&!le.ow.isEmpty)hg=!0,0<Fg&&Sg&&Ze.pop("InFormattingSpan");Oe&&(Ze.pop("HasFieldEnd"),Sg=!1);le.hn&&(Il||(Zi=!0),lk=Il=!1);le.hyperlink&&(Il&&(Zi=!0),Il=!0,lk=le.hyperlink.fua);
le.hn&&!Zi&&(Ze.pop("IsHyperlinkEnd"),Sg=!1);this.hd&&this.hd.isFeatureEnabled(17)&&(le.isChangeEnd&&(sk||ia.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),sk=!1,Gi=null),le.changeStart&&(sk&&ia.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),Gi=le,sk=!le.Mj));if(this.Iob&&(le.isTrackChangeInfoEnd&&(Jl||(Ei=!0),Jl=!1,Fi=null),le.dO&&(Jl&&(Ei=!0),Fi=le,Jl=!le.Mj),le.isTrackChangeInfoEnd&&!Ei)){for(Sg=0;Sg<Wj;Sg++)Ze.pop("IsTrackChangeInfoEnd");
Wj=0;Sg=!1}Nk&&Nk.qvk();le.ow&&(Nk||(Nk=new qb(a)),Nk.Xud(le.ow));if(le.c4&&!le.Mj){Te=Te||le.formatting;Oe=this.eKf(Ze.peek("CreateIpFormattingSpan"),Te,Cj,b,a,Va,ja,Fi);Oe=Ca.a.P9a(Oe);for(let ji of Oe)hb=ec.xia(l,hb,ji);rg.Xfg=!0}le.hyperlink&&!Zi&&({UFa:hb,qQi:kl,returnValue:Wf}=this.v_k(Wf,le,Ze,Cj,rg,b,a,f,l,x,H,ja,Fi,hb,Va,Bk,Sg,kl));!this.Iob||Ei||le.Mj||(le.yp&&(this.DRe(le.yp,Ze,rg,b,ja),Wj++),le.Fo&&(this.DRe(le.Fo,Ze,rg,b,ja),Wj++),le.Rs&&(this.DRe(le.Rs,Ze,rg,b,ja),Wj++));Ld&&({cRa:Te,
UFa:hb,returnValue:Wf}=this.r_k(Wf,l,a,le,Te,Ze,Cj,rg,b,ja,Va,hb,Sg,Bk,Fi));this.Png&&this.VDf(a,b,Lc&&Kc);le.blob?({UFa:hb,e_j:vj,d_j:vh,returnValue:Gh}=this.j_k(hb,Sg,Te,le,x,H,Bk,Wf,Ze,Cj,rg,Fg,Gh,Kc,b,Mk,Lc,a,Va,l,yb,Zb,U,ja,$d,Fi,Gi,pi,Hg,vj,vh,Nk),Sg=!1,Te=Wf=null):(Ld=le.c4&&!ha.a.substring(we,Fg,$h).length,hg&&(hg=Wf,{cRa:Te,returnValue:Wf}=this.t_k(Te,le,Cj,Ze,rg,b,a,ja,Fi,Va,Ld),Sg=!0,Wf&&Wf.style&&(kl&&hg&&hg.style&&(hg.style.fontSize=Wf.style.fontSize,hg.style.lineHeight=Wf.style.lineHeight),
vj&&vj.style&&0<vh&&le.formatting&&le.formatting.cache.Lta&&vh>le.formatting.cache.fontSize&&(vj.style.fontSize=Wf.style.fontSize,vj.style.lineHeight=Wf.style.lineHeight))),kl=!1,vj=null,vh=0,Ld||(le.Up&&(Vf=le.Up),le.BF&&(Qg=le.BF),le.HL&&(Rg=le.HL),le.Gw&&(gg=le.Gw),hg=ha.a.substring(we,Fg,$h),qi=this.CYd(Ze.peek("CreateTextOverlaySpan1"),Te,a,Vf,Qg,Rg,gg,b,Mk,ja,hg,Lc&&(yb<=Fg&&Fg<Zb||a.SW),ae,ll,qi,Nk,!!Ok,lk),Ze.push(qi,"TextOverlaySpan1"),rg.y1e=!0,this.iOd(Ze.peek("AddCommentHintCssAndDataToElement"),
pi,Hg),this.hN&&this.hN.Vyb&&Vf&&Vf.Gh&&(pi=Object(oa.a)(615,Vf.Gh))&&pi.xN&&pi.xN.TraceId&&5===pi.proofingType&&!pi.KEa&&(this.sWk(Ze.peek("RemoveConsistencyCheckCustomData")),Hg=this.Y5i(le.Up,a,fj),V.a.Qv(Ze.peek("errorDetails"),Hg,pi.xN.TraceId)),this.ZUe(Gi,Ze.peek("SetChangeId"),le.cp,$h),Lc&&yb!==Zb&&({UFa:hb,returnValue:Fg}=this.CKk(qi,Ze,Te,a,Vf,Qg,Rg,gg,rg,b,l,Mk,ja,we,yb,Zb,hb,Fg,$h,ae,ll,Nk,!!Ok,lk)),Ca.a.Nx(Ze.peek("SetElementText"),ha.a.substring(we,Fg,$h)),hb=ec.xia(l,hb,Ze.peek("AddLeafNodeElement"))))}if(a.NVc!==
Vj||this.Iob||this.I4a.dvc)a.NVc=Vj,(f=Ta.OutlineElementNavigator.UA(a))&&f.Jda(b.Ma,32,!0);({o1c:Wf,UFa:hb,returnValue:Sg}=this.x_k(a,c,Te,Cj,rg,Wf,b,a,l,ja,Fi,Va,hb,Sg,Bk));!ll.D$b&&ll.span&&this.OQd(null,ll.span);Bk&&this.q_k(c,Wf,rg,b,a,l,ja,ya,hb,fc,Gi);Xl[Xl.length-1]=c.children.length;this.NDl(Gh,Gc,b);this.IEl(rg,Sg,l);this.Iqh(b,a,c);let yf;return yf=new Zc,yf.FEf=$d,yf.Fbg=Gh,yf.vrf=Xl,yf.vZg=Mk,yf}aKb(a,b,c,f){this.GP.pb(a,b,c,f);return new Rb(a,b,c)}Y5i(a,b,c){let f=0;a&&a.Gh&&(f|=16);
if(c<b.Ra.length&&b.Ra.ga(c).GL||c===b.Ra.length)f|=1;switch(f){case 0:return Gb.a.uFe;case 16:return Gb.a.E1c;case 1:return Gb.a.zmd;case 17:return Gb.a.fIc}return""}sWk(a){V.a.foa(a,Gb.a.uFe);V.a.foa(a,Gb.a.E1c);V.a.foa(a,Gb.a.zmd);V.a.foa(a,Gb.a.fIc)}ZUe(a,b,c,f){this.hd&&this.hd.isFeatureEnabled(17)&&a&&a.changeStart&&V.a.Qv(b,Ob.Spi,new kc(a.changeStart.id,c,f))}v_k(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){!Kc||Lc||b.c4||(a=this.n1b(c.peek("CreateFormattingSpan1"),null,f,x,H,hb,fc,yb),
a.className+=" EmptyTextRun",Zb=ec.xia(ja,Zb,a),Gc=l.mOc=!0);b=this.oEi(c.peek("CreateLinkAnchor"),b.hyperlink,x,U,ya,Va,hb);c.push(b,"RenderHyperlink");l.f_j=!0;return{returnValue:a,UFa:Zb,qQi:Gc}}DRe(a,b,c,f,l){a=this.IHi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.Jwl=!0}r_k(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){yb||f.c4||(l=f.formatting||l,Zb?(a=this.n1b(x.peek("CreateFormattingSpan2"),l,H,ja,c,ya,Va,fc),a.appendChild(ja.ownerDocument.createTextNode("")),a.className+=
" EmptyTextRun",hb=ec.xia(b,hb,a),U.mOc=!0):(a=this.ZLc(l,H,ja,c,Va,fc),U.WXf=!0));b=this.pDi(x.peek("CreateFieldRangeSpan1"),ja,ya,c);x.push(b,"RenderFieldRange");U.HWi=!0;return{returnValue:a,cRa:l,UFa:hb}}j_k(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh,Zi){b||(c=f.formatting||c,H&&!f.c4?(U=this.n1b(ja.peek("CreateFormattingSpan4"),c,ya,fc,Gc,Vf,ae,Qg),U.appendChild(fc.ownerDocument.createTextNode("")),U.className+=" EmptyTextRun",a=ec.xia(we,a,U),Va.mOc=
!0):U=this.ZLc(c,ya,fc,Gc,ae,Qg));1===f.blob.Wq&&(yb=!0);b=f.blob.Mfj(fc);b.NYf(new Ub(U));U=b.element;Sys.UI.DomElement.containsCssClass(U,Hc.a.Uac)&&(Sg=U,c&&c.cache.Lta&&(Gh=c.cache.fontSize));Sys.UI.DomElement.addCssClass(U,Hc.a.pN);this.I4a.bPi&&5!==f.blob.Wq&&Sys.UI.DomElement.addCssClass(U,Hc.a.YOi);this.Iob&&this.w_k(f,fc,U,Qg);this.iOd(U,Wf,rg);Zi&&!Zi.isEmpty?(lc(U,Zi),this.Cpb&&this.Cpb.Ydh(U,Gc,(Ei,fj,Fi,Gi)=>{Kc.add(this.aKb(Ei,fj,Fi,Gi))},Zi,1)):Vb(U);this.ZUe(Rg,U,f.cp,f.cp+1);ja.peek("blobElt").appendChild(U);
Ze(U,!0);gg.add(f.blob);Lc&&($d<=hb&&hb+1<=Te||Gc.SW)?(Zb&&(Sys.UI.DomElement.containsCssClass(U,Hc.a.UYd)||Sys.UI.DomElement.addCssClass(U,Hc.a.UYd),u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Lf&&this.Lf.Pd&&Object(Xa.a)(Eb.PageView,this.Lf.Pd)&&(c=this.Lf.Pd,hb=u.AFrameworkApplication.Ta,c&&3===c.Kog?hb.La(D.a.vCh,2,U):hb.La(D.a.wCh,
2,U))),Sys.UI.DomElement.addCssClass(U,Hc.a.h8)):(Sys.UI.DomElement.removeCssClass(U,Hc.a.UYd),Sys.UI.DomElement.removeCssClass(U,Hc.a.h8));this.Png||this.VDf(Gc,fc,Lc&&Zb);Sys.UI.DomElement.removeCssClass(U,Hc.a.mIi);this.hd&&this.hd.isFeatureEnabled(162)&&5===f.blob.Wq&&(f=f.blob,f.properties&&f.properties.Sa($a.a.o8b)&&(f=f.properties.eb($a.a.o8b))&&""!==f&&(Kc.add(this.aKb(ta.a.gna,U,l,f)),Kc.add(this.aKb(ta.a.gna,U,x,f))));a=ec.xia(we,a,U);ja.push(U,"RenderBlob");return{returnValue:yb,UFa:a,
e_j:Sg,d_j:Gh}}iOd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,Hc.a.tKc),V.a.Qv(a,Hc.a.ZVd,b)):Sys.UI.DomElement.removeCssClass(a,Hc.a.tKc);c.length&&V.a.Qv(a,Hc.a.VVd,c)}VDf(a,b,c){a=tb.GraphIterator.nb(a);a.$e();a.Jg(11);if(b=a.currentNode.sc(b.Ma))b.htmlElement.style.zIndex=c?"1":""}w_k(a,b,c,f){let l=Ca.a.O4i(c,ec.xCh);5===a.blob.Wq&&f?(l||(l=b.hp(va.a.span),l.id=ec.xCh,Sys.UI.DomElement.addCssClass(l,Bc.xBj),Sys.UI.DomElement.addCssClass(l,Bc.T3),c.appendChild(l)),this.aZf(b,l,f.yp,Bc.rBj),
this.aZf(b,l,f.Fo,Bc.vBj)):l&&c.removeChild(l)}aZf(a,b,c,f){c&&!Ca.a.j5b(b,f)&&(a=a.hp(va.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}t_k(a,b,c,f,l,x,H,U,ja,ya,Va){a=b.formatting||a;b=Va?this.ZLc(a,c,x,H,ya,ja):this.n1b(f.peek("CreateFormattingSpan5"),a,c,x,H,U,ya,ja);f.push(b,"RenderFormattingSpan");l.WXf=!0;return{returnValue:b,cRa:a}}CKk(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf){Gc<fc&&fc<ae&&(Gc=ha.a.substring(Zb,Gc,fc),Ca.a.Nx(a,Gc),Lc=
ec.xia(Va,Lc,a),b.pop("ProcessSelectionBegins"),a=this.CYd(b.peek("CreateTextOverlaySpan2"),c,f,l,x,H,U,ya,hb,yb,Gc,!0,we,$d,!1,Te,Ze,Vf),b.push(a,"TextOverlaySpan2"),Gc=fc,ja.y1e=!0);Gc<Kc&&Kc<ae&&(Zb=ha.a.substring(Zb,Gc,Kc),Ca.a.Nx(a,Zb),Lc=ec.xia(Va,Lc,a),b.pop("ProcessSelectionEnds"),a=this.CYd(b.peek("CreateTextOverlaySpan3"),c,f,l,x,H,U,ya,hb,yb,Zb,!1,we,$d,!1,Te,Ze,Vf),b.push(a,"TextOverlaySpan3"),Gc=Kc,ja.y1e=!0);return{returnValue:Gc,UFa:Lc}}x_k(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){if(0<
a.Ra.length){const Kc=a.Ra.last;let Lc;Lc=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=tb.GraphIterator.nb(a);!Kc.hn||Lc&&a.rc(16)||(Zb=!1,c=null);if(this.WN?Kc.C_:Kc.fieldRangeEnd)Zb=!1,c=null;if(Kc.c4){c||(c=Kc.formatting);x=this.eKf(b,c,f,H,U,hb,ya,Va);b=Ca.a.P9a(x);for(let Gc of b)yb=ec.xia(ja,yb,Gc);l.Xfg=!0}else!Zb&&fc&&(c||(c=Kc.formatting),x=this.n1b(b,c,f,H,U,ya,hb,Va),x.appendChild(H.ownerDocument.createTextNode("")),x.className+=
" EmptyTextRun",yb=ec.xia(ja,yb,x),l.mOc=!0)}else ia.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:Zb,o1c:x,UFa:yb}}q_k(a,b,c,f,l,x,H,U,ja,ya,Va){var hb=ec.g4i(a,ya);b=this.NJf(b,f,U,hb);Fa.a.instance.shipAssertTag(25519712,8,0<l.Ra.length,"Chps should never be empty");U=null;l.Ra&&0<l.Ra.length&&(U=l.Ra.last);this.Iob&&U&&(U.yp||U.Fo||U.Rs)&&(b.className+=" "+Bc.T3);let yb;({uKc:hb,qKc:yb}=ec.Y_f(U));this.iOd(b,hb,yb);this.ZUe(Va,b,U?U.cp:0,-1);ya&&(b.className+=
" "+qc.a.KZd);this.Iqh(f,l,b);a.appendChild(b);H(b);ec.xia(x,ja,b);c.WSi=!0}Iqh(a,b,c){if(a.Wl&&this.dqa.ohd&&this.dqa.Iil(c)){if((a=this.dqa.yta(b))&&0<pa.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){ia.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.dqa.emj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}IHi(a,b,c,f){c=c.hp(va.a.span);switch(b.changeType){case 2:c.className=
Bc.nBh+" "+Bc.T3;c.style.color="#000";break;case 1:c.className=Bc.pBh+" "+Bc.T3;c.style.color="#000";break;case 3:c.className=Bc.T3}a.appendChild(c);f(c);return c}NDl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}IEl(a,b,c){a.EZj=c.count;a.XBj=b;this.cZh(a)}oEi(a,b,c,f,l,x,H){c=c.hp(va.a.a);c.className=Hc.a.Jcg;b.fua&&b.Xqc&&!P.a.instance.ga(61)&&(b.url.endsWith(u.AFrameworkApplication.fa.Ga("UserPrincipalName"))?c.className+=" "+Hc.a.sIi:c.className+=" "+Hc.a.tIi);this.aw.Puh()&&(c.style["pointer-events"]=
"all");this.aw.iuh(this.I4a.aHl,!0)&&this.aXk(c);this.GP.pb(ta.a.gna,c,l,b.url);this.GP.pb(ta.a.hna,c,x);f.add(c);b.url&&ha.a.j9(b.url)&&!B.a.Ni&&(Hb.d(c,Ba.a.href,b.url),Hb.d(c,Ba.a.target,"_blank"),Hb.d(c,Ba.a.rel,"noreferrer"));a.appendChild(c);H(c);return c}aXk(a){a.style.textDecoration="none";a.style.color="inherit"}n1b(a,b,c,f,l,x,H,U){b=this.ZLc(b,c,f,l,H,U);a.appendChild(b);x(b);return b}ZLc(a,b,c,f,l,x){if(this.cCf){var H=a?a.om.toString():ka.a.nil.toString();if(H in this.Fyc)a=this.Fyc[H];
else{let U=a?a.cache:fb.FormattingCacheManager.d5b(f,ka.a.nil);a=this.yXd(a,U,b,c,f,l);this.Fyc[H]=a}b=a.cloneNode();V.a.bLc(a,b)}else H=a?a.cache:fb.FormattingCacheManager.d5b(f,ka.a.nil),b=this.yXd(a,H,b,c,f,l);this.Ixf(b,x);return b}yXd(a,b,c,f,l,x){const H=f.hp(va.a.span);b=this.aw.E0f(f,b,l)||b;this.kei(f,H,b,l);this.pei(H,b,l,f,x);this.yei(H,a);this.cOa.Bei(H,l,c,f.Ld,b.fontSize,b.GN);return H}kei(a,b,c,f){a=this.aw.D0f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}eKf(a,b,c,f,l,x,H,
U){var ja=b?b.cache:fb.FormattingCacheManager.d5b(l,ka.a.nil);ja=this.WNh(ja,l);b=this.yXd(b,ja,c,f,l,x);this.Ixf(b,U);ja.isSuperscript||ja.QF?(f=f.hp(va.a.span),this.Exf(f,ja,!0),b.appendChild(f),Ca.a.Nx(f,""),H(f)):Ca.a.Nx(b,"");a.appendChild(b);H(b);return b}pei(a,b,c,f,l){var x=b.ht;const H=[];Array.add(H,Hc.a.QLa);var U=this.aw.i7d(c,b,this.I4a.bHl,x);var ja=null;b.M$a&&(ja=b.KR,ja=ja===Ib.a.auto?"transparent":Ib.a.vI(ja));b.QTa&&(ja=b.highlight,ja=ja===Ib.a.auto?"transparent":Ib.a.vI(ja));c.V_g!==
Ib.a.nil&&(U=Ib.a.vI(c.V_g));l!==Ib.a.nil&&(ja=Ib.a.vI(l));Ca.a.rCa(a);b.kbg&&(a.style.opacity=b.wXf.toString());b.wab&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);U?(a.style.color=U,Hb.d(a,Ba.a.jMf,"WindowText"===U?"auto":"none")):Hb.d(a,Ba.a.jMf,"auto");ja?(a.style.backgroundColor=ja,"transparent"!==ja&&Array.add(H,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.QF)l=Math.floor(l*this.aw.A$d());U=this.aw.W1f(l,c,f.Ld);ja=this.aw.A5b(b);l=this.FV&&
this.FV.l_i?this.FV.g5h(b.GN):this.qPh(ja);this.I4a.Jje&&l&&da.FontUtils.aAb(ja)&&(l=this.aw.Kxf(ja,l));let ya=b.KTa&&b.isBold;void 0===ya&&(ya=!1);let Va=b.J$a&&b.isItalic;void 0===Va&&(Va=!1);l=this.aw.xch(new Ha.a(ja,ya,Va),l,c);!this.kAl(ja,b,a.style)&&b.KTa&&(b.isBold?(a.style.fontWeight="bold",B.a.vk&&B.a.Tj&&Array.add(H,"MacChromeBold")):a.style.fontWeight="normal");b.J$a&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.Xxb||x&&this.aw.kuh()||b.Wxb||b.G7b)&&this.ERe(a,b,c,H);U&&(a.style.fontSize=
U);if(l&&(a.style.fontFamily=l,P.a.instance.ga(118))){Fa.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");x=l.split(",");for(l=0;l<x.length-1;l++)c.append('"'+x[l].trim()+'",');0<x.length&&c.append('"'+x[x.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.LTa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.aw.A_f(b,f.Ld))a.style.letterSpacing=f;if(b=
this.aw.Y2f(b))a.style.fontKerning=b,B.a.yT&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=H.join(" ")}kAl(a,b,c){return P.a.instance.ga(116)&&B.a.vk&&B.a.Tj?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}Ixf(a,b){this.fd.gg&&b&&!b.Mj&&(b.yp||b.Fo)&&
(a.style.color="#000")}yei(a,b){if(b=b?this.VRh(b):0){const c=Ya.a.xe(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.jqf.contains(b)||(ia.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.jqf.add(b))}}ERe(a,b,c,f){c="";const l=b.iE,x=b.PF;b=b.A_;l&&(c="underline",f[f.length]="Underlined");if(x||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||x||b||(c="none");0<c.length&&(a.style.textDecoration=c)}Exf(a,b,c){b.isSuperscript&&
(a.style.verticalAlign="super",a.className+=" Superscript");b.QF&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.QF)&&Hb.d(a,Ba.a.lMf,(b.fontSize/2).toString())}CYd(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){const ae=b?b.cache:fb.FormattingCacheManager.d5b(c,ka.a.nil);Va=!f||yb||this.URa(f,Va)?0:f.Gh.proofingType;yb=!!l;const we=!!x,$d=!!H;x=this.aw.Guh(ae,hb,l,x,H);if(Zb.D$b||Kc&&$b(Kc))x=!1;this.cCf?(l=this.hmj(ae,Va,yb,we,
$d,hb,x,Lc),this.AEc.Hb(l)?hb=this.AEc.ga(l):(hb=this.nLf(U,ae,Va,yb,we,$d,hb,x,Lc),this.AEc.$(l,hb)),U=hb.cloneNode(),V.a.bLc(hb,U)):U=this.nLf(U,ae,Va,yb,we,$d,hb,x,Lc);this.uci(a,U,ae);this.cQd(a,U);this.zvf(U);this.yvf(a,U);this.dqa.bBi&&this.vci(U,b,c);this.Cpb&&0!==Va&&this.Cpb.FPk(U,c,(Te,Ze,Vf,gg)=>{ja.add(this.aKb(Te,Ze,Vf,gg))},f);Zb.D$b&&fc&&Zb.span&&(this.OQd(null,Zb.span),Zb.span=null);if((b=Zb.D$b?U:null)||Zb.span)this.OQd(b,Zb.span),Zb.span=b,Zb.span&&(b=(b=V.a.Be(a,ca.a.K1c))?b:-1,
0<b&&(Zb.span.style.lineHeight=String.format("{0}px",b+3)));Kc&&!Kc.isEmpty&&(lc(U,Kc),this.Cpb&&this.Cpb.Ydh(U,c,(Te,Ze,Vf,gg)=>{ja.add(this.aKb(Te,Ze,Vf,gg))},Kc,0));Gc&&Sys.UI.DomElement.addCssClass(U,Hc.a.rIi);a.appendChild(U);ya(U);return U}URa(a,b){b=a&&a.Gh&&a.Gh.token?a.Gh.token:b;return 0!==a.Gh.errorType&&!!this.MNa&&this.MNa.contains(b,a.Gh.lcid)}hmj(a,b,c,f,l,x,H,U){b|=0;x&&(b|=16);H&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);U&&(b|=2048);a.isSuperscript&&(b|=512);a.QF&&(b|=1024);return b}nLf(a,
b,c,f,l,x,H,U,ja){a=a.hp(va.a.span);const ya=[];if(0!==c){if(!this.I4a.eKl)switch(c){case 1:ya[ya.length]=Hc.a.gMc;break;case 2:ya[ya.length]=Hc.a.eMc;break;case 3:ya[ya.length]=Hc.a.dMc}b.isSuperscript&&(ya[ya.length]=Hc.a.WYd)}else ja&&(ya[ya.length]=Hc.a.jIi);H&&(ya[ya.length]=Hc.a.h8);f&&(ya[ya.length]=Hc.a.RYd);l&&(ya[ya.length]=Hc.a.TYd);x&&(ya[ya.length]=Hc.a.fMc);a.className=0<ya.length?ya.join(" "):Hc.a.L1b;this.Exf(a,b,U);return a}vci(a,b,c){if(b&&a){if(b=gc.a.pwb(b))if(b=Ab.StyleReader.wQ(b)){a.setAttribute("data-ccp-charstyle",
b);return}(c=Sb.ParagraphReader.$d(c)?Ab.StyleReader.bE(c):null)&&(c=Ab.StyleReader.wQ(c))&&c!==Ab.StyleReader.zMa&&c!==Ab.StyleReader.RJh&&a.setAttribute("data-ccp-parastyle",c)}}uci(a,b,c){(c=this.aw.t7f(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(ha.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.aw.A$d()*c/100+"px"))}cQd(){}zvf(){}yvf(){}pDi(a,b,c,f){b=b.hp(va.a.span);b.className=Hc.a.W2d;this.pEc&&this.pEc.aOl(f,b);a.appendChild(b);
c(b);return b}NJf(a,b,c,f){b=b.hp(va.a.span);b.className=Hc.a.CN;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.I6d(a),b.style.fontFamily=a.style.fontFamily);a="";for(let l=0;l<f;l++)a+=c;b.innerText=a;return b}I6d(a){return a.style.lineHeight}OQd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,Hc.a.nIi),b||Sys.UI.DomElement.addCssClass(a,Hc.a.SYd)):b&&((a=Sys.UI.DomElement.containsCssClass(b,Hc.a.SYd))&&Sys.UI.DomElement.removeCssClass(b,Hc.a.SYd),
Sys.UI.DomElement.addCssClass(b,a?Hc.a.pIi:Hc.a.oIi))}static xia(a,b,c){V.a.Qv(c,ca.a.TFa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static Y_f(a){let b,c;b=[];c=[];if(a&&a.yg)for(let f=0;f<a.yg.length;f++){const l=a.yg.ga(f);Array.add(l.wk?b:c,l.uI)}return{uKc:b,qKc:c}}static Qji(a,b){const c=new Yc.a;for(const l of b){var f=a.Be(l);b=f.eb(ab.a.u0b);if(f=f.sa(ab.a.rKc,null)){let x;({value:x}=c.Uf(f)).returnValue||(x=new Ka.a,c.$(f,x));x.add(b)}}return c}static $_f(a,b,c){const f=new Ka.a,l=ec.Qji(a,
b);for(const x of b){const H=a.Be(x),U=H.eb(ab.a.u0b),ja=H.sa(ab.a.kzi,!1),ya=H.sa(ab.a.RGf,!1);H.sa(ab.a.dke,!1)&&!ya&&(c.add(x),ja||l.Hb(U)||f.add(H.id))}return Oa.BWk(b,f)}static RCl(a,b,c,f){const l=new Ka.a,x=new Ka.a;b=ec.$_f(a,b,l);a=ec.$_f(a,c,x);c=new Ka.a;c.addRange(f);c.addRange(l);c=Oa.CWk(c,x);return{uKc:b,qKc:a,HIi:c,QOj:0<x.count}}static g4i(a,b){var c=1;if(B.a.NF&&!b){a=Ca.a.fRc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&(c+=
eb.xNc+eb.R_d)}return c}}ec.j_i=.8;ec.xCh="TrackChangeImageOverlay";Object(m.a)(ec,"ParagraphContentRenderer",null,[1335]);var rb=d(77),ac=d(606),Jc=d(1214),Db=d(57);class dd{constructor(a){this._element=null;this.ii=a;this.czc=[]}get ownerDocument(){return this.ii}get element(){return this._element}$jb(a){this._element=a}h0g(){var a=Sys.EventArgs.Empty;if(this.czc)for(let b=0;b<this.czc.length;b++)(0,this.czc[b])(this,a)}dispose(){this.czc=this._element=this.ii=null}}Object(m.a)(dd,"APresenter",
null,[1378,106]);class Cd extends dd{constructor(a,b){super(b.htmlElement.ownerDocument);this.Nob=null;this.vVb=a;this.j3h=b}NYf(a){this.element&&a.o1c===this.Nob||(this.Nob=a.o1c,this.$jb(this.vVb.NJf(this.Nob,this.j3h.Md,ca.a.wOc,1)),this.element.className=Hc.a.Uac,this.element.style.lineHeight=this.Nob.style.lineHeight,a=""+V.a.Be(this.Nob,ca.a.bOb),V.a.Qv(this.element,ca.a.bOb,a),a=Jc.a.createElement(this.ownerDocument,va.a.span),a.innerText=ca.a.Opi,Ca.a.Au(this.element),this.element.appendChild(a),
a=Jc.a.createElement(this.ownerDocument,va.a.br),this.element.appendChild(a))}Hfg(){}dispose(){super.dispose();this.Nob=null}}Object(m.a)(Cd,"LineBreakPresenter",dd,[]);class pd{constructor(a){this.vVb=a}create(a){return new Cd(this.vVb,a)}}Object(m.a)(pd,"LineBreakPresenterFactory",null,[1334]);class Ge extends dd{constructor(a,b){super(a.ownerDocument);this.YMd=b;this.gca=a}NYf(){this.element||(this.$jb(this.gca.hp(va.a.span)),19===this.YMd.kind||18===this.YMd.kind?Sys.UI.DomElement.addCssClass(this.element,
Hc.a.QYd):(Sys.UI.DomElement.addCssClass(this.element,Hc.a.M1b),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.YMd.$7a,this.h0g())}Hfg(){this.$jb(null);this.h0g()}}Object(m.a)(Ge,"UnsupportedObjectPresenter",dd,[]);class kd{create(a,b){return new Ge(a,b)}}Object(m.a)(kd,"UnsupportedObjectPresenterFactory",null,[1333]);class Xf{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,x=!1,H=!1){this.nx=a;this.bPi=b;this.aHl=c;this.bHl=f;this.dvc=l;this.Jje=x;this.eKl=H}}Object(m.a)(Xf,
"ParagraphContentRendererSettings",null,[]);var Kd=d(113);class lg{constructor(a,b,c){this.EV=a;this.sZ=b;this.ZRb=c}E9a(a){return a}W1f(a,b,c){return c.kja(a)}A_f(){return null}Y2f(){return B.a.Tj&&window.chrome?"none":null}uEf(){return!1}pDh(){return!1}Kxf(){return""}YHh(){}oHf(){}Luh(a){return a===D.a.underline||a===D.a.Joa||a===D.a.strikethrough||a===D.a.Zs||a===D.a.v1}ZMe(a,b){this.EV&&this.EV.isEnabled&&this.EV.createFontUrl(a);this.sZ&&this.sZ.isEnabled&&(b=da.FontUtils.erb(b,a,!1,!1,!0),this.sZ.createFontUrl(a));
return b}xch(a,b,c=null){if(!a)return b;b=this.ZMe(a.fontName,b);this.ZRb&&this.ZRb.isEnabled&&(b=da.FontUtils.erb(b,a.fontName,!1,!0),this.ZRb.bNl(a)||this.ZRb.lMl(c),this.ZRb.vMl(a));return b}dZc(){return!1}i7d(a,b,c,f){a=null;!c&&f||!b.P3||(b=b.fontColor,a=b===Ib.a.auto?"WindowText":Ib.a.vI(b));return a}Guh(a,b,c,f,l){return!b&&!c&&!f&&!l}t7f(){return 0}A$d(){return.8}iuh(a,b){return a||!b}Puh(){return!1}kuh(){return!1}D0f(){return new Yc.a}E0f(){return null}A5b(a){return Kd.Font.cEa(a.GN)}}Object(m.a)(lg,
"TextRenderingStrategy",null,[1295]);class ve{get name(){return"Box4.ParagraphRenderElements"}Zb(a){a.register(pd,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().oa(()=>new pd(a.resolve("Box4.IParagraphContentRenderer")));a.register(kd,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();a.register(lg,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().oa(()=>new lg(a.ub("Box4.IFontService"),a.ub("Box4.CustomFontService"),
a.ub("Box4.IEmbeddedFontService")));a.register(Xf,"Box4.ParagraphContentRendererSettings").ma().oa(()=>new Xf(rb.ListReader.nx,u.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),P.a.instance.ga(49),P.a.instance.ga(53),u.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),u.AFrameworkApplication.fa.ka(da.FontUtils.hGf),u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));a.register(ec,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>
new ec(sa.InteractiveViewManager.instance,qa.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.ub("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.ub("Box4.IFeatureHelper"),da.FontUtils.jja,a.ub("Box4.IFontSlotProvider"),Object(F.a)(a.resolve("Box4.IEditStateEventManager"),
a.resolve("Box4.IEditStateEventManager").geh,"raiseParagraphContentUpdatedEvent"),gc.a.language,a.ub("Box4.ITableOfContentRenderHelper"),ac.a.oAf))}init(){}dispose(){}static main(){z.a.instance.Dc(new ve)}}Object(m.a)(ve,"Box4ParagraphRenderElementsPackage",null,[2,3]);class Ua{constructor(a,b,c,f,l,x,H){this.Lke=a;this.EXj=b;this.d_c=c;this.$Rj=f;this.YUj=l;this.nx=x;this.vVj=b&&H||f}}Object(m.a)(Ua,"TableCellViewElementSettings",null,[]);class Bb{get name(){return"Box4.TableViewElements"}Zb(a){a.register(Ua,
"Box4.TableCellViewElementSettings").ma().oa(()=>new Ua(u.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),P.a.instance.ga(63),P.a.instance.ga(30),P.a.instance.ga(77),P.a.instance.ga(71),rb.ListReader.nx,u.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){z.a.instance.Dc(new Bb)}}Object(m.a)(Bb,"Box4TableViewElementsPackage",null,[2,3]);var mc=d(1199),Nc=d(388),nd=d(1223),Dd=d(225),La=d(163),gb=d(179),vc=d(1155);class td{Be(a,
b){return V.a.Be(a,b)}Qv(a,b,c){V.a.Qv(a,b,c)}foa(a,b){V.a.foa(a,b)}nKa(a){V.a.nKa(a)}bLc(a,b){V.a.bLc(a,b)}}Object(m.a)(td,"CustomDataProxy",null,[1566]);var Nd=d(353),Od=d(65),Oc=d(29);class Af{constructor(){this.Pa=new wc.a}oNk(a){this.Pa.raiseEvent("OnBackspaceDelete",a)}}Object(m.a)(Af,"BackspaceDeleteEventSource",null,[1424,1425]);class Ae extends Sys.EventArgs{constructor(a,b){super();this.RM=a;this.RU=b}}Ae.eventId="AEV.AVLD";Object(m.a)(Ae,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,
[]);class Ye extends wc.a{constructor(){super()}duf(a){this.addHandler(Ae.eventId,a)}qYk(a){this.removeHandler(Ae.eventId,a)}}Ye.Dzi="AEV.CR";Object(m.a)(Ye,"ContentEditableViewEventSource",wc.a,[]);var Wd=d(51);class je{constructor(){this.FCc=null;this.Sh=0}Aej(a){if(!this.FCc){var b=a.Mb?Wd.a.createTextRange(a.node,0,a.Mb):Wd.a.Lj(a.node,a.Mb);this.FCc=oc.HyperlinkReader.tC(b,!1);this.Sh=this.FCc.length-1}for(;0<=this.Sh;)if(b=this.FCc[this.Sh],a.Mb<=b.Qa)--this.Sh;else return b.Mb<=a.Qa?null:b;
return null}}Object(m.a)(je,"OverlappingHyperlinkHelper",null,[]);class dg{constructor(a,b,c,f,l){this.d1a=a;this.LD=b;this.Nra=c;this.Zcd=f;this.$cd=l}}Object(m.a)(dg,"PersistActiveSpanEditState",null,[]);class nf{constructor(a,b){this.Cg=a;this.fh=b;this.iCc=[];this.bI=this.aI=-1}MRe(){if(-1!==this.aI&&-1!==this.bI&&this.fh){this.iCc.reverse();const a=this.iCc.join("");let b,c;this.aI===this.bI?(b=Wd.a.Lj(this.Cg,this.aI),c=!!a.length):(b=Wd.a.createTextRange(this.Cg,this.aI,this.bI),c=this.bI-
this.aI!==a.length||this.S$d(b)!==a);c&&this.fh.replaceTextRange(b,a,!0,void 0,D.a.typing)}this.bI=this.aI=-1;Array.clear(this.iCc)}$di(a,b){this.aI=a.Qa;-1===this.bI&&(this.bI=a.Mb);0<b.length&&Array.add(this.iCc,b)}S$d(a){return Sb.ParagraphReader.text(a.node).substring(a.Qa,a.Mb)}}Object(m.a)(nf,"ReplacementTextRangeBuilder",null,[]);var Cb=d(41);class Cf{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.Ch=a;this.yD=b;this.tqa=c;this.ag=f;this.ld=l;this.zn=x;this.zd=H;this.Sm=ja;this.nd=ya;this.uf=
Va;this.$a=hb;this.eAc=this.$a.ka("TextLayoutServiceUseResponse");this.fgf=this.$a.ka("TextLayoutServiceEnableActiveContentSpanFix")}bzl(){let a,b;a=b=null;if(this.zd&&this.zd.dV){var c=this.Sm.getSelection(this.nd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,Hc.a.Bfa);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,rXf:a,sXf:b}}}return{returnValue:!1,rXf:a,sXf:b}}$dj(a){let b=0;for(let c of Ca.a.P9a(a))"span"===
c.nodeName.toLowerCase()&&b++;return b}b7k(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,Hc.a.Bfa)&&!Sys.UI.DomElement.containsCssClass(b,Hc.a.u9);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of Ca.a.P9a(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=b.parentNode}return null}B6i(a,b,c,f,l){let x=Ca.a.yv(c);const H=Ca.a.n5d(c,Hc.a.Bfa);l=this.$dj(H)+
this.Ch.Ei.length-l.nt.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?x=Ca.a.yv(f)+Ca.a.yv(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?x=Ca.a.yv(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(x=Ca.a.yv(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(x=Ca.a.yv(f)+Ca.a.yv(f.nextSibling)):2<l&&(x=b.innerText,ia.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));
a.B0b||!b.innerText.endsWith(" ")||x.endsWith(" ")||(x+=b.innerText.substr(b.innerText.trimEnd().length));return x}pEk(a,b,c,f,l){const x=new dg(null,null,!0,null,null);let H=null,U=null;if(1===this.uf.mode||2===this.uf.mode)({rXf:H,sXf:U}=this.bzl());let ja=!1,ya=!1;const Va=new je,hb=new nf(a,f),yb=0<this.Ch.Ei.length&&this.Ch.Ei[0].B0b;let Zb=null;H&&this.$a.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&(Zb=this.b7k(H));for(let Kc=this.Ch.Ei.length-1;0<=Kc;Kc--){const Lc=this.Ch.Ei[Kc],Gc=
Lc.yF;let ae=!1;if(this.fgf&&this.eAc&&U&&!Ca.a.f3b(Gc)){var fc=!1;yb&&Kc===this.Ch.Ei.length-1&&!Ca.a.n5d(H,Hc.a.CN)?ae=fc=!0:1===this.Ch.Ei.length&&(fc=!0);fc&&(Gc.innerText=this.B6i(Lc,Gc,H,U,c),x.Nra=!1)}x.LD=Ca.a.yv(Gc);this.yD.s7&&this.iRi(x.LD)&&(x.LD=ha.a.substr(x.LD,0,x.LD.length-1));fc=this.k6i(a,Kc);this.Wmk(a,b,Kc,x);ya=!!x.d1a||ya;Zb===Gc&&(x.$cd=Gc.innerText+Ca.a.yv(H),H.nodeValue="",x.Nra=!1,ia.ULS.sendTraceTag(541172698,323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));
x.Zcd||(x.Zcd=this.KXi(a,fc,Va));const we=!!l&&l.Pzi(fc);this.WBl(a,b,Gc,Kc,x,ae);we&&0<x.LD.length?(hb.MRe(),this.replaceTextRange(f,x,"",fc),this.vei(l,we,x,fc)):this.Vwi(Lc,x.LD,fc,hb);ja=Gc===U||ja}hb.MRe();this.QDl(a,x);H&&Ca.a.yv(H)&&!ja&&!ya&&(this.ld.Xb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),Cf.Zhf||(ia.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),Cf.Zhf=!0));return x.Nra}Vwi(a,b,c,f){if(c.contextId!==
Cb.a.Pf&&!a.B0b&&0<=a.Lgd){let l=a.Lgd,x=a.vJe;a=l!==x?Wd.a.createTextRange(c.node,l,x):Wd.a.Lj(c.node,l);b=b.substring(l-c.Qa,b.length-(c.Mb-x))}else a=c;a.Mb-a.Qa!==b.length||b!==this.S$d(a)?f.$di(a,b):f.MRe()}iRi(a){return a.charAt(a.length-1)===eb.GHb||B.a.vo&&a.charCodeAt(a.length-1)===A.a.DPb}S$d(a){return Sb.ParagraphReader.text(a.node).substring(a.Qa,a.Mb)}replaceTextRange(a,b,c,f){b.LD!==c&&a&&a.replaceTextRange(f,b.LD,!0,!0)}vei(a,b,c,f){b&&0<c.LD.length&&(b=Wd.a.createTextRange(f.node,
f.Qa,f.Mb+c.LD.length),a.xei(b))}QDl(a,b){b.Zcd&&(b=oc.HyperlinkReader.tC(b.Zcd,!0),1===b.length&&this.zn&&this.zn.Nel(a,b[0]))}WBl(a,b,c,f,l,x){const H=Ca.a.Q5f(c);this.Ch.Ei[f].B0b&&H?x||this.orj(b,f,l,H):l.d1a&&!Sys.UI.DomElement.containsCssClass(c,Hc.a.pN)?(this.ld.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.ag.bc++,l.LD+=l.d1a,l.d1a=null,Ca.a.Nx(this.Ch.Ei[f].yF,l.LD)):l.$cd?(l.LD=l.$cd,l.$cd=null):this.eAc&&this.fgf&&(a=Sb.ParagraphReader.text(a),b=this.Ch.Ei[f],
c=b.Lgd,x=b.vJe,f+1<this.Ch.Ei.length&&!Ca.a.f3b(this.Ch.Ei[f+1].yF)&&c===x&&0<c&&" "===a.charAt(c-1)&&(l.LD=l.LD.substr(0,c-1)+" "+l.LD.substr(c-1),l.Nra=!1),b.yF.innerText.endsWith(" ")||" "!==a.charAt(x)||b.oZa+b.uTa!==x+1||(l.LD+=" ",l.Nra=!1))}orj(a,b,c,f){!b&&c.d1a?(this.ld.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.ag.bb++,c.LD=c.d1a,Ca.a.Nx(this.Ch.Ei[b].yF,c.LD),this.zd.RF&&(a=a.lastChild,this.eAc&&Sys.UI.DomElement.containsCssClass(a,Hc.a.u9)&&(a=a.lastChild),
a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.d1a=null):(this.ld.Xb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.ag.bd++,c.LD="",Ca.a.Nx(this.Ch.Ei[b].yF,c.LD))}k6i(a,b){b=this.Ch.Ei[b];return b.oZa?Wd.a.createTextRange(a,b.uTa,b.uTa+b.oZa):Wd.a.Lj(a,b.uTa)}Wmk(a,b,c,f){if(this.Ch.Ei[c].uTa+this.Ch.Ei[c].oZa===Sb.ParagraphReader.textLength(a)&&(a=b.lastChild,this.eAc&&Sys.UI.DomElement.containsCssClass(a,Hc.a.u9)&&(a=a.lastChild),c=Ca.a.yv(a),c.length>this.tqa.M1d)){this.ag.ba++;
this.yD.Njb(!1,b,this.Ch);f.d1a=ha.a.substr(c,0,c.length-this.tqa.M1d);b="";for(c=0;c<this.tqa.M1d;c++)b+=ca.a.wOc;a.innerText=b;f.Nra=!1}}KXi(a,b,c){return(b=c.Aej(b))&&Cf.FJj(b)?Wd.a.Lj(a,b.Qa):null}static FJj(a){return!!a.hyperlink&&a.hyperlink.url===Sb.ParagraphReader.text(a.paragraph).substring(a.Qa,a.Mb)}}Cf.Zhf=!1;Object(m.a)(Cf,"ActiveContentSpansPersistanceManager",null,[1423]);class of{constructor(a){this.Us=a}Kqk(a){a&&this.Us.UY()}}Object(m.a)(of,"AppFrameResizeEventProcessor",null,[]);
class Lg{constructor(){this.lYb=new Ka.a}ya(a){this.lYb.add(a)}fta(a){return this.lYb.count>a?this.lYb.ga(a):null}get WFa(){return this.lYb.count}isEmpty(){return!this.lYb.count}}Object(m.a)(Lg,"AggregatedAutoCorrectActions",null,[1401]);var vd=d(235);class Lh{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){this.yR=this.zn=this.fzc=this.Ve=null;this.gv=a;this.mK=b;this.xh=c;this.Ob=f;this.Ch=l;this.qZ=x;this.Ap=H;this.Ui=U;this.Iha=ja;this.Us=ya;this.uf=Va;this.aS=hb;this.Ak=yb;this.Tc=Zb;this.fd=
fc;this.ap=Kc}JS(a){this.Ve=a}get FZb(){return this.mK}get hyperlinkEditor(){return this.zn||(this.zn=Db.a.instance.ub("Box4.IHyperlinkEditor"))}get iAj(){return this.fzc||(this.fzc=Db.a.instance.ub("Box4.IHyperlinkActionFactory"))}bIj(a){if(this.gv.instance&&a&&2===this.xh.mode)if(this.Ve.Ss(!0),this.Iha.value.qw(),a.jx)this.gv.instance.$Hj(a),this.Iha.value.qw();else{var b=this.Ui.C8(this.xh.mode,this.Ob.Hi);a.Hcg.innerText=a.Hcg.innerText;this.aS.Noc();this.Ap.raiseEvent(vd.a.autoCorrect);1===
this.gv.instance.aIj(a)&&(this.uf.Daa(!0),b>=a.vR&&(b+=a.H1c),this.Ui.aT(b,this.Ob.Vh),this.Ve.Ss(!0),this.Iha.value.qw(),this.Us.UY())}}xDe(a,b){if(!this.gv.instance||!this.iAj||!this.hyperlinkEditor)return null;this.Ve.Ss(!0);a=this.qZ.ota(b).Ua;b=a.Qa;if(0>=b||!this.Ch.Ei.length)return null;if(a=this.gv.instance.xDe(a.node,b))this.yR||(this.yR=new Lg),this.yR.ya(a);return a}QNi(a,b){if(2===this.xh.mode&&this.Ch.Ei.length){var c=this.Ui.C8(this.xh.mode,this.Ob.Hi);!this.yR&&this.gv.instance&&(b=
this.qZ.ota(b).Ua,0>c||!this.Ch.Ei.length||(this.yR=new Lg,this.yR=this.gv.instance.sJf(b.node,c,c-this.Ch.Ei[0].iIc,this.Ch.Ei[0].yF,!this.Ch.Ei[0].iIc,a),this.yR.WFa||(this.yR=null)))}}gEk(){if(2===this.xh.mode){if(0<this.yR.WFa){this.Ve.Ss(!0);for(var a=0;a<this.yR.WFa;a++)this.yR.fta(a).MIh();for(a=0;a<this.yR.WFa;a++)this.bIj(this.yR.fta(a))}this.yR=null}}}Object(m.a)(Lh,"AutocorrectActionExecutor",null,[]);var tf=d(317);class Ue{constructor(a,b,c,f,l,x,H,U,ja,ya){this.K2h=x;this.qZ=a;this.kj=
b;this.DD=c;this.kf=f;this.uK=l;this.d7e=H;this.fd=U;this.BD=ja;this.Tza=!!ya;this.gv=ya}nzl(a,b,c,f,l,x,H){if(!f)return!1;f=this.qZ.ota(l);if(!f||!this.kf.lx(f)||!f.Ua.al)return!1;l=f.Ua;if(this.qRj(l)||this.WOj(a,l)||this.Wab(l))return!1;if(Oc.App.nhi){if(this.pRj(x))return!1}else if(this.oRj(x))return!1;return this.uK&&this.uK.ozb(f)||!this.Woi(a,this.kj,H,Ca.a.yv(c),b)||this.Tza&&!a&&this.gv.instance&&this.gv.instance.Byj()?!1:!0}pRj(a){if(this.d7e&&a&&Sys.UI.DomElement.containsCssClass(a,Hc.a.Bfa)){const b=
Ca.a.gda(a,Hc.a.u9);b&&(a=b)}return Ca.a.gda(a,Ue.U_g)?!0:!1}oRj(a){if(this.d7e&&a&&Sys.UI.DomElement.containsCssClass(a,Hc.a.Bfa)){const b=Ca.a.gda(a,Hc.a.u9);b&&(a=b)}return Ca.a.gda(a,tf.a.Lbb)||Ca.a.gda(a,Ue.U_g)?!0:!1}Wab(a){return this.BD.Wab(a).returnValue}qRj(a){return this.kj&&(!this.K2h.r_b(a.node)||P.a.instance.ga(14)&&this.DD.L8g(a.node))?!0:!1}WOj(a,b){return P.a.instance.ga(14)&&this.DD.DPj(b,!a)}Woi(a,b,c,f,l){if(!f||""===f)return!1;var x=this.fd.gg&&this.fd.Uy;x=a&&!x?0:1;!a&&1<c&&
ha.a.ox(f,c-1)?x=2:c<f.length&&ha.a.ox(f,c)&&(x=1);if(a){if(a=c+x,a>=f.length-2||!this.Xoi(c,f,x))return!1}else{a=c-x;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&ha.a.fz(f.charCodeAt(0))&&(f.length===c||ha.a.fz(f.charCodeAt(c))))return!1}b=N.a.tEa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,ca.a.lIi)||Sys.UI.DomElement.containsCssClass(b,Hc.a.CN)||Sys.UI.DomElement.containsCssClass(b,Hc.a.pN)||Sys.UI.DomElement.containsCssClass(b,ca.a.fW)?!1:!0}Xoi(a,b,c){return ha.a.fz(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&ha.a.fz(b.charCodeAt(0)))?!1:!0}}Ue.U_g="NoteTagContainer";Object(m.a)(Ue,"BackspaceInBrowserHandler",null,[]);var ff=d(1210),Ef=d(199);class wh{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(m.a)(wh,"UnroundedRectangle",null,[]);var xh=d(1066),qd=d(64),Hf=d(146);class Ag{constructor(a,b,c,f,l,x,H,U,ja){this.yh=null;this.ega=!1;this.Kba=a;this.nd=b;this.wZ=c;this.n2=f;this.zd=l;this.Lf=x;this.uf=H;this.Ob=U;this.KP=ja}LZb(a){this.yh=a}UY(){if(2===
this.uf.mode&&this.Ob.Dg){var a=this.Ob.wW,b=this.Ob.Vh;if(a&&b){if(!this.nd.zg&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),u.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){ia.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.yh.Ma);return}this.nd.zg.KFe(a);b=this.nd.zg.tu;var c=this.m1f(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;
a=c.width;c=c.height;0>a&&(a=0);var l=ff.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.Wuh()&&(f=this.nd.qm(),this.oXj()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.Kba.instance.mEl(b.parentNode,this.Ob.Lca,!!this.yh&&this.yh.Wl&&this.yh.Ivb)}}}}Wuh(){return this.zd.RF&&!this.zd.Ni&&P.a.instance.ga(30)}jMj(a){return Ca.a.FUa(a)}oXj(){return Hf.c(this.yh.xg)}$h(a){return Od.a.$h(a)}Qzh(a){var b=
qd.a.instance.Na.mb;if(1===this.uf.mode){var c=(b.yf?b.Ye:b.Ua).node;b=c.sc(this.Lf.Pd.Ma);a=c.sc(a);if(b&&a){this.nd.zg.KFe(b);a=this.nd.zg.tu;var f=this.m1f(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.zd.tjb)this.n2.icg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}m1f(a,b){if(!this.jMj(a))return null;var c=this.$h(a),f=this.$h(b);
let l=c.x-f.x;f=c.y-f.y;var x=ff.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{x&&x.dispose()}b=c.width;c=c.height;this.wZ&&this.wZ.instance&&this.wZ.instance.ojg(a)&&(x=this.wZ.instance.i3,b/=x,c/=x);if(this.KP.Yzb(a)){var H=Ef.a.Vt(a);H&&(x=parseFloat(H.width),H=parseFloat(H.height),isNaN(x)||isNaN(H)||(b=x,c=H))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.zd.HUa||this.zd.vo)b+=.001,l+=.001,f+=.001;c+=1.001;return new wh(new xh.a(l,f),b,c)}}Object(m.a)(Ag,"BoundsSynchronizer",
null,[1422]);var He=d(564),af=d(81);class yd{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.MWh=new He.a(RegExp("\r\n","g"),"\n");this.fDd=null;this.VEd=0;this.NId=!1;this.rzc=!0;this.ld=b;this.ag=c;this.vAc=a;this.nd=f;this.Yo=l;this.zd=x;this.Lf=H;this.Zd=U;this.kj=ja;this.Sm=ya;this.bKd=Va;this.$qa=yb}get yhg(){null==this.fDd&&(this.fDd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.fDd}get rVa(){return this.VEd}get $Pk(){return this.NId}get fHj(){return this.rzc}yRc(a,
b){var c=this.nd.aEa();if(1===a||0===a)return 0;if(this.zd.dV){var f=this.ZDa();if(f){this.NId=!this.F_c(f);c=this.Sm.qUc(f);var l=this.Sm.b7f(f),x=l;u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.yhg&&this.zd.vk&&(f=this.Sm.q1f(f),l!==f&&(x=f));return this.Yo.U8d(c,b,x,this.ag,this.ld,this.kj)}ia.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.zd.NF)try{return l=c.selection.createRange(),
x=this.nd.qm().innerText,b=0,""!==x&&(b=Math.abs(this.Sm.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.Sm.moveEnd(l.range,-1E5)),this.NId=b!==f),x=this.MWh.CJa(x),b>=x.length&&(b=x.length-1),b}catch(H){this.ld.Xb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.ag.bg++,ia.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",H.message,H.toString())}else ia.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.ag.bh++;return 0}F_c(a){return Od.a.F_c(a)}ZDa(){return Od.a.ZDa(this.nd.contentWindow)}mjl(a,b,c,f,l){if(!u.AFrameworkApplication.fa||!u.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.nt.length-1||Sys.UI.DomElement.containsCssClass(b.nt[a+1],Hc.a.CN))return!1;a=b.nt[a];b=Ca.a.n5d(a,Hc.a.u9);if(!b)return!1;b=Ca.a.P9a(b).toArray();return b[b.length-1]!==a?!1:!0}aT(a,b){var c=this.nd.contentWindow;this.rzc=!0;this.VEd=a;try{if(this.zd.dV){const x=b.nt;
let H;var f=0;const U=this.Sm.getSelection(c);if(U)for(H=0;H<b.nt.length;H++){const ja=b.nt;ia.ULS.shipAssertTag(18437200,315,x===ja);let ya=ja[H],Va=this.Yo.KI(ya,this.ag,this.ld,this.kj);var l=a<=Va+f;const hb=Sys.UI.DomElement.containsCssClass(ya,Hc.a.pN),yb=Sys.UI.DomElement.containsCssClass(ya,ca.a.fW),Zb=this.mjl(H,b,a,f,Va);if(l&&!hb&&!yb&&!Zb){b=H+1;if(a===Va+f&&b<ja.length){const fc=ja[b];!this.Yo.KI(fc,this.ag,this.ld,this.kj)&&Ca.a.f3b(fc)&&(ya=fc,f=a)}a-=f;this.vAc.value.q0b(ya,c);for(c=
ya;c.firstChild;)c=c.firstChild;this.XJj(U,c,a)||(c=this.GSi(c,this.nd.aEa()),this.yhg&&this.zd.vk?2!==this.Lf.editingView.jub&&this.$Rf(c,a,U):this.$Rf(c,a,U));break}f+=Va}}else this.zd.NF&&(f=this.bKd.create(this.Lf.Pd),l=this.Sm.createRange(this.nd.qm()),this.Sm.collapse(l,!0),this.Sm.moveStart(l,a),l.select(),f.dispose())}catch(x){ia.ULS.shipAssertTag(4203852,315,!1)}}GSi(a,b){"SPAN"===a.nodeName&&(b=b.Tl.createTextNode(""),a.appendChild(b),a=b);return a}$Rf(a,b,c){if(this.Yo.Xhg(a)){this.Sm.removeAllRanges(c);
var f=this.Sm.createRange(a.ownerDocument);this.Sm.YLb(f,!0,a,b);this.Sm.YLb(f,!1,a,b);try{this.Sm.addRange(c,f)}catch(l){this.ag.bl++,this.ld.Xb("PossibleNoIp",{["Reason"]:"AddRangeException"}),ia.ULS.shipAssertTag(1708946,315,!1)}this.Sm.collapse(f,!0)}else ia.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.VEd=this.yRc(a,b)}mouseDown(){return this.rzc=!1}EJ(){this.rzc=!0;return!1}C8(a,b){this.$qa&&this.$qa.$Hl(this.rVa,this.yRc(a,
b));return this.rVa}XJj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,x=a.focusOffset;return a.isCollapsed&&l&&f===b&&x===c}aNf(a,b){const c=new af.a(0,1,0,()=>{b.oVa(a.mode)&&this.updateCaretPosition(a.mode,b.Hi)},28);this.Zd.Db(c)}}Object(m.a)(yd,"CaretPositionManager",null,[1421]);var me=d(266);class Ic{constructor(){this.tI=me.a.instance.L5d()}}Object(m.a)(Ic,"CevUsageDataTracker",null,[]);class Fe{constructor(a,b){this.hxc=null;this.lia=0;this.Dg=this.wW=null;this.Lca=!1;this.zBa=a;this.Lf=
b}init(a){this.lia=a}get Gyj(){return!!this.Dg&&!!this.Dg.mg(this.lia)}get bRa(){ia.ULS.shipAssertTag(18437208,315,!!this.Dg);return this.Vh?this.Vh.htmlElement:null}get Hi(){return this.Vh?this.Vh.Hi:null}get Vh(){return this.hxc}set Vh(a){this.hxc=a;a=null;this.zBa.instance&&(a=this.zBa.instance.ODh());this.hxc&&a&&a.zOl(this.hxc.N8g)}oVa(a){return 1!==a||qd.a.instance.Na.Wda?this.Dg&&this.Vh&&this.wW?(a=this.Lf.Pd)&&Sb.ParagraphReader.$d(this.Dg)&&this.Vh===this.Dg.sc(this.lia)&&this.wW===this.Dg.sc(a.Ma)?
!0:!1:!1:!0}}Object(m.a)(Fe,"CevViewContentManager",null,[1420]);var Uc=d(1217),Uf=d(378);class vg{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){this.Ve=null;this.rK=a;this.eMd=b;this.ld=c;this.ECd=f;this.$qa=l;this.bia=x;this.Mk=H;this.xh=U;this.ds=ja;this.uf=ya;this.PNa=Va;this.pba=hb;this.$B=yb;this.LV=Zb;this.fqb=fc}JS(a){this.Ve=a}nWd(a,b,c){if(this.PNa.WBj||this.rK.z8b||!b)return!1;if(this.eMd.vth)return!0;b=this.ld.Vp(D.a.typing);b.properties.$(Uc.a.source,"Composition");a=this.Awi(a,c);
b.end();return a}Awi(a,b){this.ECd.correctBadImeState()&&this.$qa.Ioc(D.a.wAl);this.bia.fixupAfterMagnifierDrag();if(this.LV.Mgd(a))return!1;this.Mk.gne=(new Date).getTime();if(1===this.xh.mode){let c;({O3:b,pNb:c}=this.LV.RDh(a,b));if(b)return c}this.ds.isComposing=!0;this.fqb||this.uf.Daa(!0);a.eventName===ta.a.oWd&&this.pba.raiseEvent(Uf.a.uHf,a);this.$B.CPa(a);return!1}F0b(a,b,c){this.fqb&&this.Ve&&this.Ve.Ss(!0,!0);return this.nWd(a,b,c)}E0b(a,b,c){this.nWd(a,b,c);return this.ds.isComposing=
!1}}Object(m.a)(vg,"CompositionEventProcessor",null,[]);class Yg{constructor(a,b,c){this.cDd=!1;this.pba=a;this.Ap=b;this.f7=c}get isComposing(){return this.cDd}set isComposing(a){(this.cDd=a)?(this.pba.raiseEvent(Uf.a.Bwi),this.Ap.raiseEvent(vd.a.QBj)):(this.pba.raiseEvent(Uf.a.ywi),this.Ap.raiseEvent(vd.a.OBj))}get HFa(){return!this.isComposing&&!this.f7.Adg}}Object(m.a)(Yg,"CompositionStateManager",null,[]);var Cc=d(134),Rc=d(91);class Ve{constructor(a,b,c){this.KTh=u.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.IBa=this.nAd=this.BNd=this.pAa=this.Dzd=null;this.Lqb=a;this.WH=b;this.Opa=c;this.render();this.Opa.mdd&&this.WH.PK(Object(F.a)(this,this.Ycd,"modeSwitched"))}Ycd(){this.Opa.tuh&&this.uod(!0);this.gSf()}get tu(){return this.BNd}get contentWindow(){return Od.a.Zej(this.Lqb.ownerDocument)}get contentDocument(){return this.Lqb.ownerDocument}get Nza(){return this.Lqb}get Rn(){return this.nAd}get WJh(){return this.IBa}get isValid(){return!0}initialize(a,b){this.pAa=a;this.pAa.vSd=Object(F.a)(this,
this.onBlur,"onBlur");b()}Vkh(){this.tu.style.left="0px";this.tu.style.top="0px"}ERi(){this.pAa&&this.pAa.wSi(this,this.WH)}coa(){}Atd(){v.FocusManager.Wr(this.contentWindow)}DDh(){v.FocusManager.dAl(this.Rn)}get ikb(){return!Od.a.qIj(this.Rn)}set ikb(a){}QUe(a,b,c){this.Rn.setAttribute(Cc.a.ns,a);this.Dzd&&(this.Dzd.innerText=b);this.Upc(c)}Upc(a){a&&this.Rn.setAttribute(Cc.a.ef,a)}uod(a){if(B.a.Ej||a)a=!this.Opa.tie&&a,this.Rn.setAttribute("contenteditable",a?"true":"false"),this.Opa.tuh?(Sys.UI.DomElement.addCssClass(this.Rn,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.Rn,S.AppFrame.wQf),Sys.UI.DomElement.addCssClass(this.Rn,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.Rn,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.Rn,S.AppFrame.wQf),Sys.UI.DomElement.removeCssClass(this.Rn,"EditingSurfaceBody"))}dispose(){this.yBl();this.tu&&(this.tu.parentNode&&this.tu.parentNode.removeChild(this.tu),this.nAd=this.BNd=null)}render(){const a=String.format("{0}_EditingElement",this.Lqb.id),b=String.format("{0}_WrappingDiv",
a);this.BNd=document.createElement("div");this.tu.id=b;this.tu.style.height="0px";this.tu.style.width="0px";this.tu.style.display="none";Oc.App.instance.ZYc&&Sys.UI.DomElement.addCssClass(this.tu,"NoPointer");this.nAd=document.createElement("div");this.Rn.id=a;this.Rn.setAttribute("contenteditable",!this.Opa.tie);this.Rn.setAttribute("spellcheck","false");B.a.Wka&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.L9k();this.gSf();Rc.c(this.Rn,!0);Rc.c(this.tu,!0);this.IBa=document.createElement("div");
this.tu.appendChild(this.Rn);this.Lqb.appendChild(this.tu)}gSf(){if(this.Rn){const a=String.format("{0}_WACEditing_DescribedByElement",this.Lqb.id),b=this.Opa.L3h;this.Opa.tie?this.Rn.setAttribute("tabindex","0"):this.Rn.removeAttribute("tabindex");if(!this.KTh){const c=P.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Cc.a.w4i();this.Dzd=Cc.a.uwf(this.tu,this.Rn,a,c);this.QUe(b,c,null)}}}L9k(){B.a.Ej?Sys.UI.DomElement.addCssClass(this.Rn,"InternetExplorer"):
B.a.eg?Sys.UI.DomElement.addCssClass(this.Rn,"FireFox"):B.a.Lua&&Sys.UI.DomElement.addCssClass(this.Rn,"Safari");B.a.Ni?Sys.UI.DomElement.addCssClass(this.Rn,"iPad"):Sys.UI.DomElement.addCssClass(this.Rn,"usehover")}yBl(){this.pAa&&(this.pAa.xBl(this,this.WH),this.pAa=null)}onBlur(a){this.pAa.org(a);this.pAa.Dzf(a)}hmk(){this.tu.style.width="0px";this.tu.style.height="0px"}KFe(a){a=a.htmlElement;this.tu.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.tu,a)}Xyl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);Ca.a.rCa(a);a.appendChild(b);break}}}}Object(m.a)(Ve,"ContentEditableDiv",null,[1461,106]);class ob{create(a,b,c){return new Ve(a,b,c)}}Object(m.a)(ob,"ContentEditableDomFactory",null,[1419]);var Mb=d(76);class nc{constructor(a,b){this.zd=a;nc.$a=b}WYc(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}iQi(a,
b){a=Ca.a.yv(a);const c=ha.a.SFa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(ha.a.j9(b)||ha.a.C9b(b))?!0:!1}F6d(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Xb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return eb.wdg;if("BR"===a.tagName)return eb.Ozf;if(this.fjg(a)&&(u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),nc.$a.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.F6d(a.childNodes[l],b,c);return f}R7f(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(x){return ia.ULS.sendTraceTag(51463192,324,15,x.message),c.Xb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(nc.SZc(a))return this.xbj(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.fjg(a)&&(u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
nc.$a.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.WYc(a)&&(l+=eb.xNc+eb.R_d);for(let x=0;x<a.childNodes.length;x++){const H=this.R7f(a.childNodes[x],b,c,f);if(0<=H)l+=H;else return a.innerText.length}return l}fjg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}sVj(a){return Sys.UI.DomElement.containsCssClass(a,
Hc.a.wsl)}xbj(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):Mb.AParagraphNode.h_.length}KI(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Xb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.R7f(a,b,c,f)}y_f(a,b,c,f,l){let x=0;const H=a.nt;for(let U=0;U<H.length;U++){a=H[U];const ja=this.KI(a,f,c,l);if(b<x+ja)return b-=x,c=a.innerText,b>=c.length?0:ha.a.charCodeAt(c,
b);x+=ja}f.bt++;return 0}U8d(a,b,c,f,l,x){if(void 0===a||null===a)return l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,ia.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return ia.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let H=0;if(3===a.nodeType)H=c;else for(var U=0;U<c;U++)H+=this.KI(a.childNodes[U],f,l,x);for(;a!==b;){U=a;a=a.parentNode;
if(!a){ia.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),u.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.WYc(U)&&(H+=eb.xNc);let ja=0;for(;ja<a.childNodes.length&&a.childNodes[ja]!==U;)H+=
this.KI(a.childNodes[ja],f,l,x),ja++;if(ja===a.childNodes.length)if(3===U.nodeType)H=c;else return l.Xb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,ia.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return H}Xhg(a){return Ca.a.f3b(a)}static get instance(){nc.Ka||(nc.Ka=new nc(nd.a.instance,u.AFrameworkApplication.fa));return nc.Ka}static SZc(a){return Sys.UI.DomElement.containsCssClass(a,Hc.a.xkk)||
Sys.UI.DomElement.containsCssClass(a,Hc.a.YSi)||Sys.UI.DomElement.containsCssClass(a,Hc.a.IPi)}}nc.Ka=null;nc.$a=null;Object(m.a)(nc,"ContentEditableViewDomUtils",null,[1416]);class Qc{constructor(a,b){this.oCd=null;this.nd=a;this.Mk=b}fud(){return 1<this.G8i()||this.bbg(this.oCd,this.k1f())}Noc(){const a=this.k1f();this.oCd=a?a.cloneNode(!0):null}G8i(){if(this.nd){const a=this.nd.qm();if(a&&a.childNodes)return a.childNodes.length}return 0}k1f(){if(this.nd){const a=this.nd.qm();if(a)return a.firstChild}return null}bbg(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.Fxj(a,b)}catch(c){return ia.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}Fxj(a,b){if(ha.a.qg(a.nodeName)!==ha.a.qg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!B.a.eg||a.childNodes.length!==b.childNodes.length-1||"BR"!==ha.a.OB(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!nc.SZc(a.childNodes[c])||!nc.SZc(b.childNodes[c]))&&this.bbg(a.childNodes[c],b.childNodes[c]))return!0;return!1}YYi(a,b){if(B.a.RI&&P.a.instance.ga(98)){b.Xb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=Ca.a.gda(this.oCd,"EOP");const c=Ca.a.gda(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(m.a)(Qc,"ContentEditableHtmlStructureUtils",null,[]);class id{constructor(){this.BWh=u.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return u.AFrameworkApplication.Ta.mode}get mdd(){return this.BWh}get tuh(){return this.mdd?!0:1!==u.AFrameworkApplication.Ta.mode||Oc.App.Szb&&u.AFrameworkApplication.BT}get L3h(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get tie(){return this.mdd?1===u.AFrameworkApplication.Ta.mode||Oc.App.Szb&&u.AFrameworkApplication.BT:Oc.App.Szb&&u.AFrameworkApplication.BT?!(Oc.App.t_b||Oc.App.F$b):1===u.AFrameworkApplication.Ta.mode}get eqd(){return this.mdd?1===u.AFrameworkApplication.Ta.mode||Oc.App.Szb&&u.AFrameworkApplication.BT:Oc.App.Szb&&u.AFrameworkApplication.BT}}Object(m.a)(id,
"ContentEditableModeHelper",null,[1298]);var ld=d(192),xd=d(36);class ue{static zBi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return xd.c(b)}}Object(m.a)(ue,"CommonActivityAggregationMethods",null,[]);var Rd=d(1019),ce=d(1032),Ne=d(575),oe=d(289),Yd=d(267),Id=d(93);class zf{constructor(){this.vSd=this.org=this.Dzf=this.UNc=this.k1=this.vEe=this.igb=this.nLb=this.J_a=this.eQd=this.s2e=this.t2e=this.lC=this.g8a=this.iC=this.J2b=this.Y0b=this.oZd=this.tlc=this.P2b=this.nDa=this.oDa=
this.dlb=this.E0b=this.pWd=this.F0b=this.Bbb=this.PFa=this.Zz=null;this.e7=this.Ywd=this.bAd=this.UJd=this.OCd=this.fMd=this.Tyd=!1}wSi(a,b){if(!this.e7){this.e7=!0;var c=Ne.a.instance,f=b.qG,l=b.TR,x=b.jlb,H=b.Iy,U=oe.a.instance,ja=b.zga,ya=Yd.a.instance,Va=b.Gsd,hb=b.Dsd;B.a.Ni&&(La.EventHandlerManager.instance.LUk(this.eQd),this.Ywd=!0);b.mca(this.k1);this.STk(a.Rn,f,l,H,x,ya,ja,U,c,Va,hb)}}xBl(a,b){if(this.e7){var c=Ne.a.instance,f=b.qG,l=b.TR,x=b.jlb,H=b.Iy,U=oe.a.instance,ja=b.zga,ya=Yd.a.instance,
Va=b.Gsd,hb=b.Dsd;this.Ywd&&(La.EventHandlerManager.instance.ABl(this.eQd),this.Ywd=!1);b.tKa(this.k1);this.uBl(a.Rn,f,l,H,x,ya,ja,U,c,Va,hb);this.e7=!1}}STk(a,b,c,f,l,x,H,U,ja,ya,Va){b.Kp(a);c.Kp(a);f.Kp(a);l.Kp(a);x.Kp(a);Id.a.addHandler(a,ta.a.paste,this.tlc);Id.a.addHandler(a,ta.a.cut,this.oZd);Id.a.addHandler(a,ta.a.copy,this.Y0b);!zf.YSj&&B.a.eg&&(Id.a.addHandler(a,ta.a.l0d,this.J2b),this.bAd=!0);Id.a.addHandler(a,ta.a.blur,this.vSd);f.pb(ta.a.click,a,this.iC);2===Oc.App.mode?H.NJ(a,this.UNc,
!0):H.NJ(a,this.UNc);U.pb(a,this.lC);l.pb(ta.a.B6,a,this.t2e);l.pb(ta.a.K1,a,this.s2e);c.pb(ta.a.mouseDown,a,this.igb,null);c.pb(ta.a.EJ,a,this.vEe,null);b.pb(ta.a.Il,a,this.PFa);b.pb(ta.a.jy,a,this.Bbb);b.pb(ta.a.Yf,a,this.Zz);b.pb(ta.a.cQa,a,this.Zz);f.pb(ta.a.doubleClick,a,this.g8a);Id.a.addHandler(a,ta.a.scroll,this.J_a);if(B.a.b0e||B.a.eg)Va.pb(ta.a.tHf,a,this.F0b,this),Va.pb(ta.a.oWd,a,this.pWd,this),Va.pb(ta.a.mWd,a,this.E0b,this),this.Tyd=!0;Oc.App.ESd&&B.a.pzh||B.a.vo?(ya.pb(ta.a.input,a,
this.dlb,this),this.OCd=!0):B.a.f0e&&(ya.pb(ta.a.t1e,a,this.dlb,this),this.fMd=!0);ja.pb(ta.a.drop,a,this.oDa);B.a.Bua&&(ja.pb(ta.a.h8a,a,this.nDa),ja.pb(ta.a.cQf,a,this.P2b),this.UJd=!0);ja.pb(ta.a.mLb,a,this.nLb)}uBl(a,b,c,f,l,x,H,U,ja,ya,Va){Id.a.removeHandler(a,ta.a.paste,this.tlc);Id.a.removeHandler(a,ta.a.cut,this.oZd);Id.a.removeHandler(a,ta.a.copy,this.Y0b);this.bAd&&(Id.a.removeHandler(a,ta.a.l0d,this.J2b),this.bAd=!1);Id.a.removeHandler(a,ta.a.blur,this.vSd);f.yb(ta.a.click,a,this.iC);H.$E(a,
this.UNc);U.yb(a,this.lC);l.yb(ta.a.B6,a,this.t2e);l.yb(ta.a.K1,a,this.s2e);c.yb(ta.a.mouseDown,a,this.igb);c.yb(ta.a.EJ,a,this.vEe);b.Zq(a);c.Zq(a);f.Zq(a);l.Zq(a);x.Zq(a);b.yb(ta.a.Il,a,this.PFa);b.yb(ta.a.jy,a,this.Bbb);b.yb(ta.a.Yf,a,this.Zz);b.yb(ta.a.cQa,a,this.Zz);f.yb(ta.a.doubleClick,a,this.g8a);Id.a.removeHandler(a,ta.a.scroll,this.J_a);this.Tyd&&(Va.yb(ta.a.tHf,a,this.F0b),Va.yb(ta.a.oWd,a,this.pWd),Va.yb(ta.a.mWd,a,this.E0b),this.Tyd=!1);this.fMd&&(ya.yb(ta.a.t1e,a,this.dlb),this.fMd=
!1);this.OCd&&(ya.yb(ta.a.input,a,this.dlb),this.OCd=!1);ja.yb(ta.a.drop,a,this.oDa);this.UJd&&(ja.yb(ta.a.h8a,a,this.nDa),ja.yb(ta.a.cQf,a,this.P2b),this.UJd=!1);ja.yb(ta.a.mLb,a,this.nLb)}static get YSj(){null==zf.$Dd&&(zf.$Dd=u.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return zf.$Dd}}zf.$Dd=null;Object(m.a)(zf,"ContentEditableSurfaceEventHandlers",null,[]);var od=d(62),gf=d(120),Lf=d(833),ke=d(137),vf=d(258);class ng extends ce.a{constructor(a,b,c,f,l,x,H,U,
ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh,Zi,Ei,fj,Fi){super(fj);this.DCc=null;this.gOc=this.Ivb=this.h2b=this.RU=!1;this.Lf=a;this.Tc=b;this.Nk=c;this.Kt=H.create(this);this.lnb=Rg;this.nd=U;this.Opa=Fi;x.ya(D.a.jOf,Cb.a.application,ld.ActionManager.Mg);x.ya(D.a.kOf,Cb.a.application,ld.ActionManager.Mg);f.execute(Gi=>{Gi.nJi(D.a.typing,Uc.a.f$g);Gi.SUe(D.a.typing,Uc.a.source,ue.zBi)});l&&l.execute(Gi=>{Gi.FNl(Object(F.a)(this,this.pxa,"onZoomChanged"))});this.Ap=ya;this.Wpa=
Gc;this.sKd=yb;this.rK=Va;this.GK=Zb;this.GK.init(this.Ma);this.n2=fc;this.uf=Kc;this.Mk=hb;this.Ob=ja;this.Ob.init(this.Ma);this.xh=ae;this.t4a=we;this.Us=Lc;this.FOa=$d;this.YH=Vf;this.ds=Te;this.$B=gg;this.PNa=Ze;this.LV=Qg;this.dPh=Wf;this.ePh=rg;this.xQh=Sg;this.cPh=Gh;this.Dha=Zi;this.bPh=Ei;this.Dha.A9h(Object(F.a)(this,this.V1g,"onBindEditingDom"));this.Dha.S9h(Object(F.a)(this,this.b7g,"onUnbindEditingDom"));this.Dha.i9h(Object(F.a)(this,this.Vch,"pushViewElementValidationStates"));this.Dha.h9h(Object(F.a)(this,
this.V3g,"onInteractiveViewOnAfterLoadContent"));this.i9e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&B.a.AYc;this.Kaf=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&B.a.wT}get Ld(){return this.If.Ld}dispose(){this.Dha.oYk(Object(F.a)(this,this.V1g,"onBindEditingDom"));this.Dha.AYk(Object(F.a)(this,this.b7g,"onUnbindEditingDom"));this.Dha.hYk(Object(F.a)(this,this.Vch,"pushViewElementValidationStates"));
this.Dha.gYk(Object(F.a)(this,this.V3g,"onInteractiveViewOnAfterLoadContent"));this.cPh.dispose();super.dispose()}pxa(){this.ega=!0}get ownerDocument(){const a=this.nd.aEa();return a?a.Tl:null}get container(){return this.ERa}get IWd(){return this.Rn}createElement(a){a=this.ownerDocument.createElement(a);this.nd.zg.WJh.appendChild(a);return a}hp(a){a=Jc.a.createElement(this.ownerDocument,a);this.nd.zg.WJh.appendChild(a);return a}hCa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}xGe(){this.Ap.raiseEvent(vd.a.MPi);this.gOc=!0}get ERa(){return this.nd.zg?this.nd.zg.tu:null}get Rn(){return this.nd.qm()}get rzb(){return!0}Cti(){this.n2.PJc()}get M_c(){return this.ds.HFa}get isComposing(){return this.ds.isComposing}FIk(){this.i9e||this.Kaf?this.FOa.kbh(!0,""):(this.disable(!1,24),this.uod(!0),B.a.mx&&(this.ERa.style.overflow="hidden"),this.ERa.style.width="0px",this.ERa.style.height="0px",this.ERa.style.display="block",this.Ap.raiseEvent(vd.a.kDk),this.n2.PJc(),this.GK.IKa(this.xh.mode,
this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez))}Ttl(){this.i9e||this.Kaf?this.FOa.olh("none"):B.a.mx&&this.ERa&&(this.ERa.style.overflow="none")}Ss(a,b=!1){this.YH.Ss(a,b)}UY(){this.Us.UY()}get Wl(){return!0}Ega(a,b){if(1===this.mode&&17!==a.ri){const c=a.currentNode;if(!qd.a.instance.Na.jH&&!c.Nzb(qd.a.instance.Na.Rr)&&6!==a.role)return!1}return super.Ega(a,b)}get KF(){let a=super.KF;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get jub(){const a=
u.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.M_c?2:this.root&&this.ownerDocument&&this.isActive&&!this.Wpa.p9?a||this.M_c?1:2:3}hY(a){return this.ePh.hY(a)}Q0(a){return this.dPh.Q0(a)}JYd(){return new Lf.a(this.Ma)}CGe(a){!u.AFrameworkApplication.Ug&&0!==this.mode&&this.If&&this.If.uo&&(this.z2j(a),this.Tc.Phe())}z2j(a){if(a){var b=a.OA;a=this.sZf(a.Uu,!0);b=this.sZf(b,!1);ia.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}sZf(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",Sb.ParagraphReader.$d(a)&&(c+="paraId : "+Sb.ParagraphReader.S5b(a)+"; ",c+="hasImage : "+gf.a(a,5)+";"),b&&(b=tb.GraphIterator.nb(a),b.$e(),c+="inTable : "+od.TableReader.Cs(b)+";"));return c}THe(a){!u.AFrameworkApplication.Ug&&1===this.mode&&a&1&&this.If&&this.If.uo&&this.Tc.FIe()}uod(a){this.nd.b0a(a)}Gbb(a,b,c){this.lnb.Gbb(a,b,c)}FOc(){this.PNa.FOc()}kdl(){this.sKd.eUf(qd.a.instance.Na)}pjb(){this.GK.pjb(this.mode,this.Ob.Hi,this.Ob.Dg,
this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez)}IKa(){this.GK.IKa(this.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez)}get Dg(){return this.isActive?this.Ob.Dg:null}get mode(){return this.xh.mode}get isActive(){return this.uf.isActive}get xUa(){return this.uf.I5b(this.Ob.Dg)}get Dle(){return this.uf.X2f(this.Ob.Dg)}get If(){return this.Lf.Pd}get sJe(){return this.t4a.pIf}get Iya(){return this.PNa.Iya}set Iya(a){this.PNa.Iya=a}get ega(){return this.Us.ega}set ega(a){this.Us.ega=
a}get mje(){return!0}get yRe(){return 2}get eqd(){const a=this.Nk.value.isEditingAllowed||this.Nk.value.ez;return this.Opa.eqd?a:!0}get zJa(){return this.FOa.zJa}get Jtb(){return this.Mk}get AAl(){return this.$B}get Fzi(){return this.lnb}get NBj(){return this.PNa}get bBk(){return this.LV}$ac(a){return vf.a.Gpg(a,this)}qKb(a){return vf.a.mjh(a,this)}Boc(a){return vf.a.Ajh(a,this)}Kic(a){return vf.a.AYg(a,this)}Ksb(a){return vf.a.yCf(a,this)}Gpc(a){return vf.a.woh(a,this)}w4b(a){return vf.a.ZWf(a,this)}CZb(a){return vf.a.Pyf(a,
this)}fMj(){switch(this.mode){case 2:if(this.Ob.Dg)return this.gMj(this.Ob.Dg)}return!1}gMj(a){a=ke.a.nb(this.Ma,a.node);return a.Xq&&a.$e()?a.gRa.eY(510&~this.KF):!0}V1g(a,b){this.tzf(b.zg)}b7g(){this.nd.NAl()}mEj(a,b,c,f){a=this.bPh.create(a,b,this.Opa);b=new zf;b.UNc=c;this.xQh.yFk(b);a.initialize(b,f);return a}tzf(a){this.nd.bii(a,this)}disable(a,b){this.xh.Caa(0,a,b)}Y0a(){this.xh.Y0a()}suspend(){this.Wpa.suspend()}resume(){this.Wpa.resume()}Vch(a,b){this.Lf.Pd===b.If&&(this.DCc=this.wMa,this.wMa=
new Rd.a(0))}qFk(){const a=this.DCc,b=this.wMa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.wMa=a;this.DCc=null}FFf(){this.DCc=null}fYe(a){return 1!==this.mode||a.Ey||this.If.Lb.Na.jH?!1:!0}Bme(a,b){return this.If.Lb&&!this.If.Lb.Na.jH&&b?a.Ey!==b.$le:!0}V3g(a,b){this.Lf.Pd===b.If?this.qFk():this.Lf.Pd||this.FFf()}}Object(m.a)(ng,"ContentEditableView",ce.a,[408,162,106,1418]);class wg{constructor(a,b,c,f,l,x){this.ld=a;this.ag=b;this.kj=c;this.Yo=f;this.Lf=
l;this.sr=x}jhg(a){return Sys.UI.DomElement.containsCssClass(a,Hc.a.aIf)}}Object(m.a)(wg,"ContentEditableViewContentControlHelper",null,[1297]);var bf=d(402),Pd=d(128),Md=d(119),Mh=d(834);class Bh{constructor(a,b,c,f,l){this.B0b=!1;this.vJe=this.Lgd=-1;this.yF=a;this.Hhe=b;this.iIc=c;this.uTa=f;this.oZa=l}}Object(m.a)(Bh,"ActiveContentSpan",null,[]);class Vh{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze){this.pha=this.VRb=null;this.t9=!1;this.Tof=0;this.pzd=$d;this.Lf=a;
this.ld=b;this.ag=c;this.kj=f;this.Tc=l;this.kf=x;this.uK=H;this.xh=U;this.Ob=ja;this.Nk=ya;this.zpa=Va;this.uf=hb;this.Zd=yb;this.zd=Zb;this.Ui=fc;this.Yo=Kc;this.Ch=Lc;this.rK=Gc;this.nd=ae;this.yD=we;this.GA=Ze}get dda(){return this.pha||(this.pha=Db.a.instance.ub("Box4.IFormatPainter"))}cii(a){this.VRb=a}get cyh(){return this.Tof}SIi(a,b,c){const f=this.Lf.Pd;if(!f)return!1;f.zHe();if(2!==this.xh.mode)return this.ld.Xb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.ag.be++,
!1;if(this.kj&&b)return this.ld.Xb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.ag.bf++,!0;if(3!==a.Xf&&a.sA===Sys.UI.MouseButton.rightButton&&this.zd.eg)return Oc.App.Kb.Qaa.IYi(a.qc.rawEvent),!0;if(!f)return!1;b=f.Xja(a);if(3===a.Xf){var l=this.Tc.Na.mb;if(this.kf.lx(l)){var x=l.Ua.node.mg(f.Ma);l=this.GA?this.GA.MQa(l.Ua,!0):l.Ua.Qa;x=N.a.jW(l,x,!!l,!1,!1);x=new Sys.UI.Bounds(x.x-7,x.y,14,x.height);if(bf.a.Mhd(b,x))return Oc.App.Kb.i6(b,3),!0}}if(!c)return!0;this.Ui.aNf(this.xh,
this.Ob);v.FocusManager.SM()&&(v.FocusManager.instance().tf(f.DI),this.rK.setFocus(this.xh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez));(c=Rc.a(a.Ec))?(this.VRb.Ss(!0),f.E6(a.clientPoint,c,c.gb,f,a.qc.rawEvent.shiftKey,a.ZZ,a.Xf)):f.E6(b,null,null,f,a.shiftKey,a.ZZ,a.Xf);this.dda&&this.dda.wL&&this.zpa.processAction(D.a.Rja,2);this.VRb.Gbb(a.shiftKey,b,a.Xf);f.UGe(new Mh.a(a));this.zd.RI&&(a=new af.a(0,1,0,()=>{this.uf.WKa(!0);this.fixupAfterCursor(5)},
27),this.Zd.Db(a));return!0}w0e(a,b=!1){if(2===this.xh.mode&&this.Ob.Vh){var c=this.nd.zg.tu;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.zd.wle){c=this.Tc.Na.mb;var f=!!this.uK&&this.uK.Z$a();this.kj&&a?(this.ld.Xb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.ag.bm++):(this.q$k(b||f,this.Ob.Vh.nt,this.Tc.Na.mb.Ua),f&&this.uK.P0e(c))}}}q$k(a,b,c){let f=0,l=0;c=c.Qa;let x=!1;for(let H=0;H<b.length;H++){const U=b[H],ja=this.Yo.KI(U,this.ag,this.ld,
this.kj);if(Sys.UI.DomElement.containsCssClass(U,ca.a.fW))f+=ja;else if(x||(this.Tof=f,x=!0),Sys.UI.DomElement.containsCssClass(U,Hc.a.pN))c--,f+=ja,l++;else{if(c<=ja){a||this.Ui.aT(f+c,this.Ob.Vh);this.god(b,H,f,l,c);break}c-=ja;f+=ja;l+=ja}}}fixupAfterCursor(){if(2===this.xh.mode){var a=this.Ui.C8(this.xh.mode,this.Ob.Hi),b=0,c=0,f=this.Ob.Vh.nt,l;for(l=0;l<f.length;l++){const x=this.Yo.KI(f[l],this.ag,this.ld,this.kj);let H,U,ja;({W3:H,Rka:ja,$yb:U}=this.Wqi(f,l));if(a<=x&&this.lZi(f,l,a,H,ja,
b,c,U))return;a-=x;b+=x;H?c++:U||(c+=x)}this.ld.Xb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.ag.bq++}}lZi(a,b,c,f,l,x,H,U){const ja=a[b],ya=this.Yo.KI(ja,this.ag,this.ld,this.kj);if(f||this.kj&&l)if(l||!this.t9&&c!==ya){if(this.ag.bo++,this.Ui.aT(x,this.Ob.Vh),c=this.Yo.KI(a[b-1],this.ag,this.ld,this.kj),this.god(a,b-1,x-c,H-c,c),l)return!0}else this.ag.bn++,this.Ui.aT(x+ya,this.Ob.Vh),this.god(a,b+1,x+ya,H+1,0);else if(!U)return ha.a.ox(Ca.a.yv(ja),c)&&(this.ag.bp++,
this.Ui.aT(x+c+(this.t9?1:-1),this.Ob.Vh)),this.god(a,b,x,H,c),!0;return!1}Wqi(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],Hc.a.pN);f=Sys.UI.DomElement.containsCssClass(a[b],ca.a.fW);a=Sys.UI.DomElement.containsCssClass(a[b],Hc.a.CN);return{W3:c,Rka:a,$yb:f}}god(a,b,c,f,l){const x=this.Ob.wW,H=a[b];Sys.UI.DomElement.containsCssClass(H,Hc.a.CN)&&(ia.ULS.shipAssertTag(4318915,315,!1),this.ld.Xb(Pd.a.N1,{["Reason"]:Md.a.OSf}));Sys.UI.DomElement.containsCssClass(H,Hc.a.pN)&&(ia.ULS.shipAssertTag(4318916,
315,!1),this.ld.Xb(Pd.a.N1,{["Reason"]:Md.a.xzf}));a=this.TEi(a,b,c,f,l,x);b=a.length!==this.Ch.Ei.length;for(c=0;!b&&c<this.Ch.Ei.length;)this.Ch.Ei[c].yF!==a[c].yF&&(b=!0),this.Ch.Ei[c].oZa!==a[c].oZa&&(b=!0),c++;b&&(this.VRb.xUa&&this.VRb.Ss(!0),this.Ch.Ei=a)}TEi(a,b,c,f,l,x){const H=a[b];var U=this.Yo.KI(H,this.ag,this.ld,this.kj);const ja=[];let ya=null;b<a.length-1&&l===U&&(ya=a[b+1]);var Va=null;0<b&&!l&&(Va=a[b-1]);a=this.pzd.Be(H,ca.a.TFa);a=x.nt[a];Array.add(ja,new Bh(H,a,c,f,U-(this.yD.s7?
1:0)));!ya||Sys.UI.DomElement.containsCssClass(ya,Hc.a.CN)||Sys.UI.DomElement.containsCssClass(ya,Hc.a.pN)?!Va||Sys.UI.DomElement.containsCssClass(Va,Hc.a.CN)||Sys.UI.DomElement.containsCssClass(Va,Hc.a.pN)||Sys.UI.DomElement.containsCssClass(Va,ca.a.fW)||(a=this.pzd.Be(Va,ca.a.TFa),a=x.nt[a],U=this.Yo.KI(Va,this.ag,this.ld,this.kj),Array.insert(ja,0,new Bh(Va,a,c-U,f-U,U))):(a=this.pzd.Be(ya,ca.a.TFa),a=x.nt[a],Va=this.Yo.KI(ya,this.ag,this.ld,this.kj),Array.add(ja,new Bh(ya,a,c+U,f+U,Va)));return ja}}
Object(m.a)(Vh,"ContentEditableViewCursorManager",null,[1417]);class Jg{}Object(m.a)(Jg,"ContentEditableViewDebugLogger",null,[]);class Of{constructor(a,b,c,f,l,x,H){this.tqa=a;this.$B=b;this.Ch=c;this.fyc=f;this.ag=l;this.pba=x;this.xh=H}dispose(){this.tqa.rFf();this.$B.dispose();this.Ch.dFf();this.fyc.Rnd();me.a.instance.y1j(this.ag);this.pba.raiseEvent(Uf.a.T2j);this.xh.dispose()}}Object(m.a)(Of,"ContentEditableViewDisposer",null,[]);class bi{constructor(){this.tNc=!0}Gbb(a,b,c){a&&(this.tNc=!1,
Oc.App.Kb.i6(b,c))}}Object(m.a)(bi,"ContentEditableViewFloatieHandler",null,[1415]);var ij=d(1111),ig=d(145);class oj{constructor(a,b,c,f,l,x,H){this.Rgf=0;this.MZc=this.z8b=this.ude=this.yde=!1;this.nd=a;this.Lf=b;this.uK=c;this.kj=f;this.Ln=l;this.Sxd=x;this.Nd=H}wii(){this.kj&&!this.z8b&&100<(new Date).getTime()-this.Rgf&&(ig.GrippersManager.instance.Y7b=!0,this.MZc=!1)}setFocus(a,b,c,f,l){const x=this.Lf.Pd;this.Rgf=(new Date).getTime();this.uK&&this.uK.Z$a()||(1===a?this.kal(l):this.kj&&!this.Ln.Ade&&
La.EventHandlerManager.instance.ZSf!==ta.a.click||!this.nd.zg.ikb||(l=new ij.a(x),this.nd.zg.Atd(),this.kj&&(this.z8b=!0,this.nd.qm().blur(),this.z8b=!1),this.nd.zg.DDh(),c&&f&&""!==b.innerText&&b.focus(),this.Sxd.m9&&(this.MZc=!0),l&&l.dispose(),this.Sxd.Ej&&0!==a&&(this.nd.zg.ikb=!1)))}kal(a){if(!this.kj||a){a=null;B.a.Ej&&(a=new ij.a(this.Lf.Pd));this.nd.zg.ikb&&(this.nd.zg.Atd(),this.nd.zg.DDh(),B.a.Ej&&(this.nd.zg.ikb=!1),this.Sxd.m9&&this.Ln.Ade&&(this.MZc=!0));var b=this.nd.qm();this.nd.zg.ikb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}KRi(a){2!==a&&1!==a||this.nd.zg.Atd()}Ije(){const a=this.Nd.Ae;return!!a&&this.Lf.Pd.DI===a.name}}Object(m.a)(oj,"ContentEditableViewFocusHelper",null,[1414]);class fh{constructor(a,b,c){this.j8b=a;this.Nhb=b;this.Nra=c}}Object(m.a)(fh,"GraphUpdateState",null,[]);var Qd=d(53),$e=d(109);class yh{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh){this.Ve=this.ARb=null;this.Ak=
Sg;this.sr=rg;this.hha=a;this.xh=b;this.ld=c;this.Tc=f;this.uK=l;this.kf=x;this.uf=H;this.yK=U;this.Ob=ja;this.Mk=ya;this.yD=Va;this.Ch=hb;this.nd=yb;this.tV=Zb;this.aS=fc;this.Wpa=Kc;this.qZ=Lc;this.bia=ae;this.Ui=we;this.t4a=$d;this.Us=Te;this.ag=Ze;this.f7=Vf;this.Zd=gg;this.zd=Qg;this.Aha=Rg;this.xMh=Wf;this.fh=Gc;this.Kz=Gh}JS(a){this.Ve=a}get fVc(){const a=this.qZ.ota(this.tV.t9);return a?a.Ua.Qa:0}get bji(){return this.fVc}Ss(a,b=!1){ia.ULS.shipAssertTag(18437283,315,!!this.fh);if(this.Ve.xUa||
this.Ve.Dle)if(this.Ve.AAl.typingProcess(),this.Ve.isActive&&2===this.xh.mode&&(this.Ve.xUa||this.Ve.Dle)){var c=this.ld.Vp(D.a.Ss);this.hha.hG(()=>{this.KDl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}xal(a,b=!1){const c=this.kf.Ez;this.Tc.setSelection(a,void 0,void 0,b);this.kf.Ez=c}KDl(a,b=!1){$e.c(36226527,306,100,"UpdateGraphInternalCalled");this.uf.w1k();if(this.Ob.Vh){a=new fh(!1,a,!1);a.Nhb&&this.Wpa.suspend();this.bia.fixupAfterMagnifierDrag();var c=this.yK.SSa();c.set(this.Ob.Dg.node);
var f=this.Ak.me(b?12:15,D.a.Ss);f.jd=this.Mk.S2?D.a.gCa:D.a.typing;f.Fy(c);this.yD.vil(a.Nhb,this.Ve.M_c,this.Ch)&&(this.ag.v++,this.yD.Njb(!1,this.Ob.Hi,this.Ch));var l=!!this.uK&&this.uK.Z$a(),x=l?qd.a.instance.Na.mb:this.Lsi();this.qEk(a);this.GEl();this.rerenderWhenNeeded(b,a,c);l||this.wZi(b,x);this.Ch.dFf();f.dispose();this.vsl(a);this.Us.ega&&(this.Us.UY(),this.Us.ega=!1);a.Nhb&&this.Wpa.resume();this.Mk.j1();$e.c(18437313,306,100,"UpdateGraphInternalExited")}else ia.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}vsl(a){a.j8b||this.tV.w0e(this.Mk.Nda,a.Nra)}rerenderWhenNeeded(a,b,c){!b.j8b||this.Mk.qng()||a||(this.xh.Caa(0,!0,5),b.Nhb&&(this.Wpa.resume(),b.Nhb=!1),this.a9b(c.currentNode))}Lsi(){this.Ui.updateCaretPosition(this.xh.mode,this.Ob.Hi);this.t4a.X4e();this.aS.YYi(this.nd.qm(),this.ld);return this.qZ.ota(this.tV.t9)}wZi(a,b){const c=this.sr.textLength(b.Ua.node);b.Ua.Qa>c&&(b=Qd.SelectionFactory.Sg(b.Ua.node,c));this.xal(b,a);
a=!!this.uK&&this.uK.ozb(b);this.Mk.qng()&&!a&&this.Ui.aT(this.Ui.rVa,this.Ob.Vh)}a9b(a){P.a.instance.ga(70)&&Oc.App.UR.a9b(a)}GEl(){if(P.a.instance.ga(2)){const a=Ta.OutlineElementNavigator.UA(this.Ve.Dg);a&&rb.ListReader.JUa(a)}}SZd(){if(this.Ve.xUa||this.Ve.Dle)this.ARb?this.Zd.V5(this.ARb,yh.bNf):(this.ARb=new af.a(0,1,yh.bNf,Object(F.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.Zd.Db(this.ARb))}delayUpdateGraphCallback(){this.ARb=null;this.Ob.oVa(this.xh.mode)&&
this.Ss(!0)}DXk(){let a;if(this.Mk.S2){var b=this.fVc;a=this.Mk.hLc}else if(this.Mk.osa)b=this.fVc,a=b+(this.Mk.Asd-Ca.a.yv(this.Ob.bRa).length);else return;if(b===a)this.ld.Xb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{ia.ULS.shipAssertTag(18437315,315,b<=a);var c=this.sr.text(this.Ve.Dg),f="";this.sr.ISa(this.Ve.Dg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=eb.GHb;this.zti(this.Ve.Dg);b=Wd.a.createTextRange(this.Ve.Dg,
b,a);this.fh.replaceTextRange(b,f,void 0,void 0,D.a.fSd)}}zti(a){P.a.instance.ga(70)&&this.Kz.MJc(a)}qEk(a){let b=!0;if(this.f7.Adg)this.f7.YQi();else{const c=1<this.nd.qm().childNodes.length;a.j8b=this.aS.fud();if(a.j8b||this.Mk.osa||this.Mk.S2){a.j8b&&this.ag.w++;c&&(this.ld.Xb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.ag.x++,b=!1);if(this.Mk.S2||this.Mk.osa)this.DXk(),this.aS.Noc(),b=!1;a.Nhb&&(this.ld.Xb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.ag.z++,this.Wpa.resume(),a.Nhb=!1);this.Ch.Ksi(this.Ob.Vh)}}a.Nra=!0;b&&(a.Nra=this.xMh.pEk(this.Ob.Dg,this.Ob.Hi,this.Ob.Vh,this.fh,this.Aha.instance))}}yh.bNf=250;Object(m.a)(yh,"ContentEditableViewGraphUpdater",null,[]);class Ti{constructor(){this.Fjl=this.Lig=!1;this.p9g=null}}Object(m.a)(Ti,"OnPastedFloatieStatusChangeEventArgs",null,[]);var fe=d(59);class gi{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf){this.Ve=null;this.Jog=0;this.Yhf=!1;this.Pa=
a;this.xh=b;this.Ob=c;this.Lf=f;this.nd=l;this.dha=x;this.Us=H;this.yD=ja;this.zd=ya;this.ag=Va;this.sr=hb;this.Ch=yb;this.aS=Zb;this.gMd=fc;this.tqa=Kc;this.rK=Lc;this.t4a=Gc;this.Tc=ae;this.kj=we;this.GK=$d;this.Nk=Te;this.Mk=Ze;this.Ap=Vf;this.yK=gg;this.iPa=Qg;this.Tba=Rg;this.hd=Wf}JS(a){this.Ve=a}wqk(a){this.Pa.raiseEvent(Ae.eventId,new Ae(a.RM,this.Ve.RU),this.Ve);if(1===this.xh.mode)return this.xqk(a);if(0===this.xh.mode||!this.pDl(a))return!1;this.yD.sFf();if(this.oDl())return!0;this.sZi();
this.tqa.oyh(this.Ob.Vh);this.qZi();!this.Yhf&&this.Ob.Vh&&0<this.Ob.Vh.Xrd&&(this.Yhf=!0,u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));this.hd&&this.hd.isFeatureEnabled(84)&&this.tjh(this.Ob.Vh);this.t4a.X4e();this.Tba.bPe(Object.assign(new Ti,{Fjl:!0}));this.hd&&this.hd.isFeatureEnabled(84)||this.tjh(this.Ob.Vh);return!0}tjh(a){a&&a.Xrd&&(this.iPa?this.iPa.NNl(a,!0):ia.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}pDl(a){if(!this.Ob.Dg)return!1;
this.Ob.Vh=this.Ob.Dg.sc(this.Ve.Ma);this.Ob.Vh||ia.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Ob.wW=this.Ob.Dg.sc(this.Lf.Pd.Ma);if(!this.Ob.wW)return!1;this.nd.zg.KFe(this.Ob.wW);const b=this.nd.qm(),c=this.Ob.bRa;(b?b.firstChild:null)!==c&&c&&(Ca.a.Au(b),b.appendChild(c));if(!a.RM&&!this.Ve.gOc){this.Ve.RU&&this.dha.w0e(this.Mk.Nda);this.Ve.RU=!1;if(this.Us.ega||!a.qJa)this.Us.UY(),this.Us.ega=!1;return!1}this.Ve.gOc&&(this.Ve.gOc=!1,this.Ve.Ivb=!0);return!0}qZi(){this.Us.UY();
if(this.Ve.Ivb){this.rK.setFocus(this.xh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez);if(this.zd.eg){const a=this.nd.qm(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.ag.bv++,a.removeChild(b))}this.Ve.Ivb=!1}this.dha.w0e(this.Mk.Nda)}sZi(){if(this.zd.eg){var a=this.nd.qm();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.ag.bu++,a.removeChild(b))}this.zd.HNb||(a=this.yK.Nc(this.Ob.Dg),this.sr.isEmpty(a)&&!this.sr.sje(a)&&this.yD.Njb(!0,this.Ob.Hi,
this.Ch));this.gMd.value.q0b(this.nd.qm(),this.nd.contentWindow);this.aS.Noc()}oDl(){var a=this.Ob.wW;const b=this.nd.qm().style;if(this.Ve.Ivb){if(!a)return!0;a=this.Ob.Vh.htmlElement;this.Us.Wuh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Ob.Lca=this.UQj();return!1}UQj(){return fe.OutlineElementReader.vm(Ta.OutlineElementNavigator.UA(this.Ob.Dg.node))}Vt(a){return Ef.a.Vt(a)}xqk(a){if(!this.Tc.Na||!this.Tc.Na.mb)return ia.ULS.sendTraceTag(19711041,324,
15,"Attempt to validate selection with empty selection."),!1;if(!this.Ve.RU&&(!a.RM||Oc.App.nie&&a.qJa))return this.Us.ega&&(this.Us.Qzh(this.Ve.Ma),this.Us.ega=!1),!1;this.Ve.RU=!1;a=(new Date).getTime();const b=this.Tc.bpa;!this.kj&&!b.Hke&&!b.vme&&250<a-this.Jog?this.YMf(null):(this.Ap.raiseEvent(vd.a.Bok),b.Kbl(Object(F.a)(this,this.YMf,"delayOnAfterValidateSelection")));return!0}YMf(){1===this.xh.mode&&(this.Tc.Na.Wda&&this.Ob.Dg&&(this.Ob.Vh=this.Ob.Dg.sc(this.Ve.Ma),this.Ob.Vh||ia.ULS.sendTraceTag(18437327,
324,15,"current editing view element is set to null!"),this.Ob.wW=this.Ob.Dg.sc(this.Lf.Pd.Ma)),this.Tc.Na.Wda&&this.nd.qm().firstChild!==this.Ob.bRa&&this.Ob.bRa&&(Ca.a.Au(this.nd.qm()),this.nd.qm().appendChild(this.Ob.bRa)),this.nd.qm().firstChild&&(this.Tc.Na.Wda?this.nd.qm().style.direction=this.Vt(this.nd.qm().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.nd.qm().firstChild,"Rtl")?this.nd.qm().style.direction="rtl":this.nd.qm().style.direction="ltr",this.Tc.Na.Wda&&this.tqa.oyh(this.Ob.Vh),
this.Us.Qzh(this.Ve.Ma),this.GK.pjb(this.xh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez)),this.Jog=(new Date).getTime(),this.Ap.raiseEvent(vd.a.GYi))}Q0(a){const b=this.wqk(a);this.Ap.raiseEvent(!a.RM||Oc.App.nie&&a.qJa?vd.a.XGc:vd.a.M8g);return b}}Object(m.a)(gi,"ContentEditableViewOnAfterValidateHandler",null,[]);class vi{constructor(a,b,c,f,l){this.Ve=null;this.Us=a;this.ds=c;this.nd=f;this.Ap=l}JS(a){this.Ve=a}hY(a){const b=this.Ve.jub;let c=3===b;c||
2!==b||(this.Ve.root.fde(510),c=!0,this.Us.UY());if(c)return a.cancel=!0,!1;this.Ap.pNk(a);return!1}}Object(m.a)(vi,"ContentEditableViewOnBeforeValidateHandler",null,[]);class bk{constructor(a,b,c,f,l){this.s7=!1;this.QAa=null;this.Ap=a;this.ld=b;this.ag=c;this.nd=f;this.jmf=l}sFf(){this.s7=!1}Njb(a,b,c){const f=this.nd.aEa();a&&(this.s7=Ca.a.yv(b)!==ca.a.wOc);if(a&&!this.s7){for(b=this.nd.qm();b.firstChild;)b=b.firstChild,this.jmf&&Sys.UI.DomElement.containsCssClass(b,Hc.a.QLa)&&Sys.UI.DomElement.addCssClass(b,
Hc.a.yJe);3!==b.nodeType?(this.QAa=f.Tl.createTextNode(eb.GHb),b.appendChild(this.QAa)):(this.QAa=b,this.QAa.nodeValue=eb.GHb);this.s7=!0;this.Ap.feh(!0)}if(!a&&this.s7){a=this.QAa;b=null;try{b=this.QAa.parentNode,b||""!==a.nodeValue||(this.QAa=null)}catch(l){this.ag.i++,this.QAa=null}this.QAa&&b!==f||(this.ld.Xb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.ag.j++,c.Ei.length&&(a=this.SVf(c.Ei[c.Ei.length-1].yF)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(eb.GHb))){if(this.jmf)for(c=
a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,Hc.a.yJe)){Sys.UI.DomElement.removeCssClass(c,Hc.a.yJe);break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.s7=!1;this.Ap.feh(!1)}}vil(a,b,c){return!this.s7||a||(B.a.RF&&!B.a.Tj||B.a.NF)&&!b?!1:c.Grf()}SVf(a){if(a.className===Hc.a.CN)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.SVf(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&
(b=a.nodeValue,b.endsWith(" ")||b.endsWith(eb.GHb)))return a;return null}}Object(m.a)(bk,"ContentEditableViewPaddingManager",null,[1413]);class Zg{constructor(a){this.XZd=this.u1e=this.osa=this.S2=!1;this.u1c=this.Asd=this.hLc=-1;this.hDd=!1;this.gne=0;this.zpa=a}get Nda(){return this.hDd}set Nda(a){a!==this.hDd&&this.zpa.processAction(a?D.a.jOf:D.a.kOf,2);this.hDd=a}qng(){return this.u1e||this.osa||this.S2}j1(){this.XZd=this.u1e=this.osa=this.S2=!1;this.u1c=this.Asd=this.hLc=-1}}Object(m.a)(Zg,"ContentEditableViewTypingState",
null,[]);class Ek{constructor(a,b,c,f,l,x,H){this.Ui=a;this.ag=b;this.ld=c;this.Yo=f;this.uf=l;this.Ob=x;this.kj=H}ota(a){if(!this.Ob.Vh||1===this.uf.mode&&!this.Wda())return null;const b=this.Ui.C8(this.uf.mode,this.Ob.Hi);let c=b,f=0;const l=this.Ob.Vh.nt;let x,H=!1;for(x=0;x<l.length;x++){var U=l[x];if(!this.Yo.Xhg(U)){H=!0;continue}const ja=this.Yo.KI(U,this.ag,this.ld,this.kj),ya=Sys.UI.DomElement.containsCssClass(U,Hc.a.pN);U=Sys.UI.DomElement.containsCssClass(U,ca.a.fW);if(c<=ja)return ya?
c=a||c===ja?1:0:U&&(c=0),this.Sg(this.Ob.Dg,f,c);c-=ja;ya?f++:U||(f+=ja)}return H?this.Sg(this.Ob.Dg,0,b):this.Sg(this.Ob.Dg,0,0)}Sg(a,b,c){return Qd.SelectionFactory.Sg(a,b+c)}Wda(){return qd.a.instance.Na.Wda}}Object(m.a)(Ek,"CurrentEditSelectionProvider",null,[1412]);class Ch{constructor(a,b,c){this.eQb=[];this.KFc=null;this.ld=a;this.yS=b;this.gMd=c}get Ei(){return this.eQb}set Ei(a){this.eQb=a}Grf(){return this.eQb.length?1<this.eQb.length||1<this.eQb[0].yF.innerText.length:!1}UWf(a,b,c){const f=
V.a.Be(a,ca.a.TFa),l=b?a.firstChild:a.lastChild;let x=null;b&&0<f?x=c.nt[f-1]:!b&&f<c.nt.length&&(x=c.nt[f+1]);if(x)for(this.ld.Xb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),this.yS.u++,a.removeChild(l),b?x.appendChild(l):x.insertBefore(l,x.firstChild),a=0;a<this.Ei.length;a++);}Ksi(a){for(let b=0;b<this.Ei.length;b++){const c=this.Ei[b].yF;B.a.RF&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.UWf(c,!0,a):3===c.lastChild.nodeType&&this.UWf(c,!1,a));
Ca.a.Nx(c,c.innerText)}}pok(a){for(let b=0;b<this.Ei.length;b++)this.gMd.q0b(this.Ei[b].yF,a)}pWk(){for(let a=0;a<this.Ei.length;++a){const b=this.Ei[a].yF;if(Sys.UI.DomElement.containsCssClass(b,Hc.a.gMc)||Sys.UI.DomElement.containsCssClass(b,Hc.a.eMc)||Sys.UI.DomElement.containsCssClass(b,Hc.a.dMc)||Sys.UI.DomElement.containsCssClass(b,Hc.a.fMc)){const c=this.Ei[a].oZa;c&&c!==b.innerText.length&&(b.className=Hc.a.L1b)}}}Vjk(a,b){for(let c=0;c<this.Ei.length;c++){const f=this.Ei[c],l=a<=f.uTa,x=
f.uTa+f.oZa,H=x<=b;f.Lgd=l?f.uTa:a;f.vJe=H?x:b;l&&H&&(f.B0b=!0)}}dFf(){Array.clear(this.Ei)}}Object(m.a)(Ch,"CurrentlyActiveContentSpans",null,[1411]);class Ui{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){this.rzd=!1;this.kf=a;this.Tc=b;this.ld=c;this.uf=f;this.Ap=l;this.Lf=x;this.Ch=H;this.Ob=U;this.zd=ja;this.GK=ya;this.Nk=Va;this.$za=hb;this.KQb=yb;this.TPh=Zb;this.ik=fc;this.nd=Kc;this.Ca=Gc;this.fd=ae;this.GTh=Lc.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.HTb=Lc.ka("PasteKeepSourceFontSizeFixIsEnabled");
this.cUh=(this.UYh=Lc.ka("ProtectInClient"))||Lc.ka("ProtectedFile");this.RTh=Lc.ka("EnableExtractForProtectedFile");this.mTb=Lc?Lc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.VTb=Lc?Lc.ka("TextLayoutServiceUseResponse"):!1;this.Rmf=this.Qmf=!1}get VZ(){return this.$za.instance}get sbb(){return this.fd.gg&&this.fd.Uy}a$f(a,b,c,f){this.wIk(a,b,c,f)}wIk(a,b,c,f){this.cUh&&!this.RTh?a.preventDefault():!b||this.Nk.value.isEditingAllowed||this.Nk.value.ez&&this.sbb?1!==this.uf.mode||this.rzd||
!c||f||(this.VZ?b&&!this.kf.PYc(this.Tc.Pj)?(ia.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.pZd}),this.KQb.show(),a.preventDefault()):(this.Tc.bpa.x4d(),this.rzd=!0,b&&this.Ap.raiseEvent(vd.a.YIi),B.a.Aua&&a.rawEvent&&a.rawEvent.currentTarget&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this.mTb&&this.ik.Ild(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.zd.Tj&&this.GTh&&this.fZi(a),this.HTb&&
(this.Qmf=this.bZi(a)),this.VTb&&(this.Rmf=this.$Wk(a)),a=this.TPh.create(null,Object(F.a)(this,this.gNi,"dispatchCutCopy"),b),a.Pl("Browser "+(b?"Cut":"Copied")),a.run()):(ia.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.Goe(b?D.a.cut:D.a.copy),a.preventDefault())):a.preventDefault()}fZi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.f4i();({pMc:c}=this.ik.Eyl(c));c&&(a.preventDefault(),b.setData("text/html",Hb.c(c)),b.setData("text/plain",
c.innerText))}}bZi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=this.ik.qZa(c),this.ik.B_b(a,this.Lf.Pd.Ld,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.ik.B_b(a.rawEvent.currentTarget,this.Lf.Pd.Ld,!0)}$Wk(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();a=c&&0<c.length?this.ik.qZa(c):a.rawEvent.currentTarget;if(this.ik.Aud(a,
!1))return b.setData("text/html",Hb.c(a)),b.setData("text/plain",a.innerText),!0}return!1}f4i(){if(this.zd.dV){const a=this.nd.aEa();if(a&&a.Tl)return a.Tl.getSelection()}return null}gNi(a,b){this.rzd=!1;if(this.Lf.Pd.uo&&1!==u.AFrameworkApplication.Aa.state){if(b){if(this.zd.eg){for(b=0;b<this.Ch.Ei.length;b++){const c=this.Ch.Ei[b].yF,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.GK.IKa(this.uf.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||
this.Nk.value.ez)}this.VZ.cji(a)}else this.VZ.aji(a);B.a.Aua&&this.mTb&&this.Lf&&this.ik.Ild(this.Lf.Pd.zg.Rn,"data-srcurl","data-src");this.HTb&&this.Qmf&&this.Lf&&this.Lf.Pd&&this.ik.B_b(this.Lf.Pd.zg.Rn,this.Lf.Pd.Ld,!1);this.VTb&&this.Rmf&&this.Lf&&this.Lf.Pd&&this.ik.Aud(this.Lf.Pd.zg.Rn,!0)}}}Object(m.a)(Ui,"CutCopyHandler",null,[1410]);class pg{constructor(a,b,c,f,l,x,H,U){this.zd=a;this.xh=b;this.ds=c;this.ld=f;this.uf=l;this.Eha=x;this.Us=H;this.fqb=U}J2b(a,b){this.zd.eg&&2===this.xh.mode&&
b&&this.ds.isComposing&&(a=this.ld.Vp(D.a.typing),a.properties.$(Uc.a.source,"DomChange"),this.EOi(),a.end())}EOi(){this.fqb||this.uf.Daa(!0);this.Eha.dGb();this.Us.UY()}}Object(m.a)(pg,"DomChangeEventProcessor",null,[]);class Mg{constructor(a,b,c,f){this.Ui=a;this.xh=b;this.Ob=c;this.Lf=f}Kgb(a,b){if(!b)return!1;this.Ui.aNf(this.xh,this.Ob);return this.Lf.Pd?this.Lf.Pd.Kgb(a):!1}}Object(m.a)(Mg,"DoubleClickProcessor",null,[]);class gh{constructor(a,b,c){this.zd=a;this.Nnb=b;this.pAd=c}nDa(){this.Nnb.K7a=
!0;return!1}P2b(){return this.Nnb.K7a=!1}oDa(a){this.Nnb.K7a=!1;this.pAd.cancelEventAndRestoreEditingSurface(a.qc);return!0}}Object(m.a)(gh,"DragEventsProcessor",null,[]);class Ie{constructor(a){this.xaf=0;this.mzd=!1;this.zd=a}get K7a(){return this.mzd}set K7a(a){this.mzd=a;window.clearTimeout(this.xaf);this.mzd&&(this.xaf=window.setTimeout(Object(F.a)(this,this.lqk,"onAfterDragInactivity"),1E3))}lqk(){this.K7a=!1}}Object(m.a)(Ie,"DragStateManager",null,[]);class Ia extends mb{constructor(){super();
this.x_g=this.Vpk=0}}Object(m.a)(Ia,"SetModeEditEventArgs",mb,[]);class lb extends mb{constructor(){super();this.updates=null;this.wza=new Ka.a}}Object(m.a)(lb,"BeforeValidateEditEventArgs",mb,[]);class Lb{constructor(){this.q7k=this.FOi=null}}Object(m.a)(Lb,"EditStateFactoryManager",null,[]);class hc extends mb{constructor(){super();this.charCode=0;this.dQj=this.isComposing=!1}}Object(m.a)(hc,"KeyDownEditEventArgs",mb,[]);class Pc extends mb{constructor(){super();this.charCode=0;this.isComposing=
!1}}Object(m.a)(Pc,"KeyPressEditEventArgs",mb,[]);class Td extends mb{constructor(){super();this.gyj=!1}}Object(m.a)(Td,"PaddingChangedEventArgs",mb,[]);class ie{constructor(a){this.Pa=new wc.a;this.T2a=Object.assign(new Lb,{FOi:()=>a.qm(),q7k:()=>Od.a.ZDa(a.contentWindow)})}addHandler(a,b){this.Pa.addHandler(a,b)}removeHandler(a,b){this.Pa.removeHandler(a,b)}raiseEvent(a){this.Pa.raiseEvent(a,Object.assign(new mb,{j8a:this.T2a}))}cPk(a,b){0===a&&0===b||this.Pa.raiseEvent(vd.a.zbl,Object.assign(new Ia,
{Vpk:a,x_g:b,j8a:this.T2a}))}pNk(a){this.Pa.raiseEvent(vd.a.Ehi,Object.assign(new lb,{j8a:this.T2a,updates:a.updates,wza:a.wza}))}geh(a){a.j8a=this.T2a;this.Pa.raiseEvent(vd.a.M8g,a)}aPe(a,b){this.Pa.raiseEvent(vd.a.jy,Object.assign(new Pc,{charCode:a.qc.charCode,isComposing:b,j8a:this.T2a}))}gOk(a,b,c){this.Pa.raiseEvent(vd.a.Yf,Object.assign(new hc,{charCode:a.qc.charCode,isComposing:b,dQj:c,j8a:this.T2a}))}feh(a){this.Pa.raiseEvent(vd.a.dBk,Object.assign(new Td,{j8a:this.T2a,gyj:a}))}}Object(m.a)(ie,
"EditStateEventManager",null,[1408]);class Sd{constructor(a){this.gEd=this.xzc=!1;this.phf=null;this.R9e=0;this.BWc=!1;this.Pa=a;this.Gaf=0;this.iFd=2}get mode(){return this.Gaf}Gjb(a,b){0===a?(0===b&&(b=1),this.phf=(new Date).toISOString(),this.iFd=b):this.iFd=0;this.Gaf=a}get t1c(){return this.iFd}get OYj(){return this.phf}get isActive(){return 0!==this.mode}get Gzi(){return this.R9e}WKa(a){this.gEd=a}I5b(a){return this.isActive&&!!a&&this.xzc}Daa(a){!this.xzc&&a&&this.Pa.raiseEvent(Ye.Dzi);this.xzc=
a;this.bpk(a);a&&(this.R9e=(new Date).getTime())}X2f(a){return this.isActive&&!!a&&this.gEd}bpk(a){a&&ig.GrippersManager.instance.setVisibility(!1)}w1k(){this.gEd=this.xzc=!1}}Object(m.a)(Sd,"EditViewStateManager",null,[1407]);var wf=d(909);class Pf{constructor(a,b,c,f,l,x){this.nd=a;this.yD=b;this.Ap=c;this.GK=f;this.$a=l;this.Lf=x;this.$a&&(this.$a.ka("WordEditorImageOverflowIsEnabled")||this.$a.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(Pf.aOc=-1*Math.pow(2,31))}PJc(){this.yD.sFf();
Ca.a.Au(this.nd.qm())}u1d(a){const b=this.nd.qm();if(2===a){var c=eb.LPi;a=Pf.KPi;b.style.overflow="visible"}else if(1===a)c=B.a.tjb?0:Pf.aOc,a="0",b.style.overflow="hidden";else return;const f=this.nd.zg.tu;f.style.position="absolute";this.$a&&(this.$a.ka("WordEditorImageOverflowIsEnabled")||this.$a.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility=
"visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}hSf(a){if(this.nd&&this.nd.zg&&this.nd.zg.tu){var b=this.nd.zg.tu;b.style.zIndex=String(B.a.tjb?0:Pf.aOc);B.a.tjb&&!a&&(b.style.visibility="hidden",this.nd.qm().style.visibility="hidden")}}CIk(a){this.Ap.raiseEvent(vd.a.hIj);this.PJc();this.nd.b0a(!0);this.nd.qm().style.direction="";this.u1d(a);this.nd.zg.hmk()}yIk(a){this.nd.b0a(!0);this.u1d(a);B.a.tjb&&this.icg();B.a.NF&&Sys.UI.DomElement.addCssClass(this.nd.qm(),
"NonStandardIEClipboard")}BIk(a){this.u1d(a);B.a.NF&&Sys.UI.DomElement.removeCssClass(this.nd.qm(),"NonStandardIEClipboard")}AIk(a,b,c,f,l,x,H){this.Ap.raiseEvent(vd.a.endEditing);const U=this.nd.qm();U&&(Ca.a.Au(U),B.a.$W&&b&&a&&(this.nd.b0a(!0),U.innerText=" ",this.GK.IKa(c,f,l,x,H)),a||Od.a.AFf(U),this.nd.b0a(!1),this.hSf(b))}zIk(a){this.nd.b0a(!1);B.a.NF&&Sys.UI.DomElement.removeCssClass(this.nd.qm(),"NonStandardIEClipboard");this.hSf(a);this.Ap.raiseEvent(vd.a.cui)}DIk(){const a=Sys.UI.DomElement.getBounds(this.Lf.Pd.WJ),
b=this.nd.zg.tu;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Lf.Pd.scrollTop,wf.a)+"px");b.style.opacity="0";b.style.zIndex=String(Pf.aOc);B.a.Ej&&(b.style.visibility="Hidden",this.nd.qm().style.visibility="Hidden")}icg(){const a=1E3-this.Lf.Pd.container.getBoundingClientRect().left+this.Lf.Pd.scrollLeft+1,b=this.nd.zg.tu;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}Pf.aOc=-1E3;Pf.KPi="1";Object(m.a)(Pf,"EditingDomDisplayManipulator",null,[]);class og{constructor(a){this.dZh=
a}get range(){return this.dZh}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}Object(m.a)(og,"RangeProxy",
null,[1530]);class Dh{constructor(a){this.wDc=a}get selection(){return this.wDc}get type(){return this.selection.type}createRange(){return new og(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(m.a)(Dh,"SelectionProxy",null,[1521]);class Bi{constructor(a){this.mQh=a}get Tl(){return this.mQh}get body(){return this.Tl.body}get activeElement(){return this.Tl.activeElement}get documentElement(){return this.Tl.documentElement}get document(){return this.Tl.cookie}get selection(){return new Dh(this.Tl.selection)}get designMode(){return this.Tl.designMode}get doctype(){return this.Tl.doctype}get domain(){return this.Tl.domain}get hidden(){return this.Tl.hidden}get implementation(){return this.Tl.implementation}get parentWindow(){return this.Tl.parentWindow}get referrer(){return this.Tl.referrer}get title(){return this.Tl.title}get URL(){return this.Tl.URL}get visibilityState(){return this.Tl.visibilityState}createAttribute(a){return this.Tl.createAttribute(a)}open(){this.Tl.open()}close(){this.Tl.close()}attachEvent(a,
b){return this.Tl.attachEvent(a,b)}detachEvent(a,b){this.Tl.detachEvent(a,b)}createAttributeNS(a,b){return this.Tl.createAttributeNS(a,b)}createDocumentFragment(){return this.Tl.createDocumentFragment()}createElement(a){return this.Tl.createElement(a)}createElementNS(a,b){return this.Tl.createElementNS(a,b)}createEvent(a){return this.Tl.createEvent(a)}createTextNode(a){return this.Tl.createTextNode(a)}dispatchEvent(a){return this.Tl.dispatchEvent(a)}execCommand(a,b,c){return this.Tl.execCommand(a,
b,c)}hasFocus(){return this.Tl.hasFocus()}focus(){this.Tl.focus()}getElementById(a){return this.Tl.getElementById(a)}getElementsByTagName(a){return this.Tl.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.Tl.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.Tl.getElementsByName(a)}write(a){this.Tl.write(a)}querySelector(a){return this.Tl.querySelector(a)}querySelectorAll(a){return this.Tl.querySelectorAll(a)}queryCommandEnabled(a){return this.Tl.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.Tl.queryCommandIndeterm(a)}queryCommandState(a){return this.Tl.queryCommandState(a)}queryCommandSupported(a){return this.Tl.queryCommandSupported(a)}queryCommandValue(a){return this.Tl.queryCommandValue(a)}}
Object(m.a)(Bi,"DOMDocumentProxy",null,[1565]);class Vi{constructor(){this.V2a=null}get isValid(){return this.zg.isValid}get contentWindow(){return this.zg?this.zg.contentWindow:null}get zg(){return this.V2a}Rsk(a){vf.a.IXg(a,this.zg.tu)}Qsk(){vf.a.$3e(this.zg.tu)}nSf(){this.zg.ERi()}ffj(a){if(!B.a.eg)return a.innerHTML;this.zg.Xyl(a);return a.innerHTML}NAl(){this.zg?(this.Qsk(),this.V2a=null):ia.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}bii(a,b){this.V2a=
a;this.Rsk(b)}qm(){return this.zg?this.zg.Rn:null}b0a(a){this.zg&&this.zg.uod(a)}aEa(){return this.zg?new Bi(this.zg.contentDocument):null}}Object(m.a)(Vi,"EditingDomManager",null,[1406]);var kh=d(147);class mi{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){this.dia=0;this.Ve=null;this.Ob=a;this.Ak=b;this.n2=c;this.Ap=f;this.Wpa=l;this.Zd=x;this.nd=H;this.uf=U;this.rK=ja;this.Nk=ya;this.zd=Va;this.yD=hb;this.Tc=yb;this.uK=Zb;this.Ch=fc;this.Lf=Kc;this.kf=Lc;this.fd=ae;this.Dha=Gc;this.Dha.dbi(Object(F.a)(this,
this.G6g,"onSynchronizeMode"))}dispose(){this.Dha.VZk(Object(F.a)(this,this.G6g,"onSynchronizeMode"))}LZb(a){(this.Ve=a)||ia.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.uf.mode}endClipboard(){if(1===this.mode){var a=this.Ak.me(2);a.kd(this.Ve.root);this.Ve.detach();this.Ob.Dg&&!this.uie&&this.Ob.Dg.Jda(this.Lf.Pd.Ma,4,!0);this.uf.Gjb(0,3);this.Ob.Dg=null;this.Ob.Vh=null;this.Ob.wW=null;this.n2.zIk(this.Ve.zJa);a.dispose()}}Caa(a,b,c){this.Ve.xUa&&
this.Ob.Vh?this.Ve.Ss(!1):this.Ve.xUa&&!this.Ob.Vh&&ia.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Ap.cPk(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.uf.Gjb(a,c);f=this.startEditing(this.RIi);break;case 1:if(this.mode!==a||this.Tc.Na.Rr!==this.dia)this.endEditing(!0),this.uf.Gjb(a,c),f=this.Ppl(),this.dia=this.Tc.Na.Rr;break;case 0:this.mode!==a&&(2===this.mode&&ig.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.uf.Gjb(a,c))}f||this.uf.Gjb(0,7)}E$k(){this.uf.Gjb(2,0)}get RIi(){return this.Tc.Na.mb.Ua.node}startEditing(a){if(1===this.Hrf)return!1;this.nd.nSf();this.Ve.Iya?this.Ve.Ss(!0):(this.Ve.NBj.pSf(!1),this.uf.I5b(this.Ob.Dg)&&this.Ve.Ss(!1));this.Ve.Iya=!1;if(this.Ob.Dg===a)return a=tb.GraphIterator.nb(a.node),this.B1d(a),this.Ob.Gyj&&(this.zd.Ni&&this.Ve.Jtb.Nda||this.rK.setFocus(this.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez)),!0;
const b=this.Ak.me(2,D.a.startEditing);b.kd(a.node);this.Ve.detach();this.Ob.Dg&&this.Ob.Dg.Jda(this.Lf.Pd.Ma,4,!0);this.Ob.Dg=a;this.Ob.Dg.Jda(this.Lf.Pd.Ma,4,!0);if(this.fd.gg){const c=gf.j(this.Ob.Dg,5);for(let f=0;f<c.length;f++)c[f].mPf(this.Ve)}this.Ve.Ivb=!0;this.n2.CIk(this.mode);this.Ve.Zx(a.node);this.yD.Njb(!1,this.Ob.Hi,this.Ch);this.uf.Daa(!1);this.uf.WKa(!1);a=tb.GraphIterator.nb(this.Ob.Dg.node);this.B1d(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Ve.FOc(),this.Ve.Ss(!0),
!this.uie)){var b=this.Ak.me(2);b.kd(this.Ve.root);this.Ve.detach();this.Ob.Dg&&this.Lf.Pd&&this.Ob.Dg.Jda(this.Lf.Pd.Ma,20,!0);this.uf.Gjb(0,4);this.Ob.Dg=null;this.Ob.Vh=null;this.Ob.wW=null;this.n2.AIk(a,this.Ve.zJa,this.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez);b.dispose()}}Ppl(){if(this.uie||P.a.instance.ga(11)&&1===this.Hrf)return!1;this.Ap.raiseEvent(vd.a.bui);this.nd.nSf();const a=this.Ak.me(2);a.kd(this.Tc.ilb);this.uf.I5b(this.Ob.Dg)&&this.Ve.Ss(!1);
this.Ve.detach();this.Ob.Dg=null;this.Ob.Vh=null;this.Ob.wW=null;if(this.Tc.Na.Wda){const b=this.Tc.Na.mb.Ua.node;this.Ve.Zx(b);const c=tb.GraphIterator.nb(b);this.Ob.Dg=b;this.Ob.Lca=this.WKj(b);this.B1d(c);this.Ob.Dg.Jda(this.Lf.Pd.Ma,4,!0)}else this.Ve.Zx(this.Tc.ilb);this.n2.yIk(this.mode);this.yD.Njb(!1,this.Ob.Hi,this.Ch);a.dispose();return!0}G6g(){this.Y0a()}Y0a(){if(!this.Wpa.p9&&!u.AFrameworkApplication.ye.tw&&this.Lf.Pd&&this.Lf.Pd.isActive){var a=this.Tc.Na.mb;a&&this.rK.Ije()?this.uK&&
this.uK.Z$a()?this.Caa(2,!0,10):this.kf.lx(a)?Oc.App.Kb.Kd.isEditingAllowed||Oc.App.Kb.Kd.ez?this.Caa(2,!0,0):this.Ve.eqd?(this.Caa(1,!0,0),this.Caa(0,!0,15)):this.Caa(2,!0,0):this.Caa(1,!0,0):this.Caa(0,!1,a?9:8)}}get uie(){return u.AFrameworkApplication.Ug}get Hrf(){return u.AFrameworkApplication.Aa.state}B1d(a){a.$e();kh.OutlineNavigator.NSe(a)}WKj(a){return fe.OutlineElementReader.vm(Ta.OutlineElementNavigator.UA(a))}}Object(m.a)(mi,"EditingModeTransitionManager",null,[1405]);class sh{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te){this.Ve=null;this.Zd=a;this.uf=b;this.Ob=c;this.eVh=f;this.Mk=l;this.dVh=x;this.bVh=H;this.Syd=U;this.P1h=ja;this.Mnb=ya;this.FOa=Va;this.j$e=hb;this.lQh=yb;this.rK=Zb;this.dha=fc;this.DXb=Kc;this.qQh=Lc;this.qXh=Gc;this.bNh=ae;this.QVh=we;this.bia=$d;this.Ui=Te}JS(a){this.Ve=a}get PY(){return!this.Zd.tw&&this.uf.isActive&&this.Ob.oVa(this.uf.mode)?!0:!1}yFk(a){a.PFa=b=>this.eVh.PFa(b,this.PY);a.Bbb=b=>this.dVh.Bbb(b,this.PY);a.Zz=b=>this.bVh.Zz(b,
this.PY,this.Ve.h2b);a.F0b=b=>this.Syd.F0b(b,this.PY,this.Ve.h2b);a.pWd=b=>this.Syd.nWd(b,this.PY,this.Ve.h2b);a.E0b=b=>this.Syd.E0b(b,this.PY,this.Ve.h2b);a.dlb=b=>this.P1h.dlb(b,this.PY&&this.Ve.eqd);a.oDa=Object(F.a)(this.Mnb,this.Mnb.oDa,"dropHandler");a.nDa=Object(F.a)(this.Mnb,this.Mnb.nDa,"dragOverHandler");a.P2b=Object(F.a)(this.Mnb,this.Mnb.P2b,"dragLeaveHandler");a.tlc=b=>{this.FOa.handlePaste(b,this.Ve.root,this.uf.BWc)};a.oZd=b=>{this.j$e.a$f(b,!0,this.PY,this.uf.BWc)};a.Y0b=b=>{this.j$e.a$f(b,
!1,this.PY,this.uf.BWc)};a.J2b=b=>{this.lQh.J2b(b,this.PY)};a.Dzf=()=>{this.rK.wii()};a.iC=b=>this.dha.SIi(b,this.Mk.Nda,this.PY);a.lC=b=>this.DXb.onContextMenu(b,this.Ve.Dg);a.t2e=Object(F.a)(this.DXb,this.DXb.Hkc,"onTouchMove");a.s2e=Object(F.a)(this.DXb,this.DXb.vHb,"onTouchEnd");a.eQd=()=>{this.rK.KRi(this.uf.mode)};a.g8a=b=>this.qQh.Kgb(b,this.PY);a.J_a=b=>{this.qXh.onScroll(b,this.PY,this.Ve.ownerDocument.documentElement)};a.k1=()=>{this.bNh.Kqk(this.PY)};a.org=b=>{this.QVh.lostFocus(b,this.PY)};
a.nLb=()=>this.bia.$vj(this.PY,this.Ve.Dg);a.igb=b=>this.Ui.mouseDown(b);a.vEe=b=>this.Ui.EJ(b)}}Object(m.a)(sh,"EditingSurfaceEventHandlerManager",null,[]);class Ng{constructor(a,b,c){this.ld=a;this.ag=b;this.xh=c}cancelEventAndRestoreEditingSurface(a){this.ld.Xb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.ag.bx++;Id.a.Bn(a);this.xh.Caa(0,!0,6);this.xh.Y0a()}}Object(m.a)(Ng,"EditingSurfaceEventHandlerUtils",null,[]);class Wh{constructor(){this.sBa=0}get p9(){return 0<
this.sBa}suspend(){this.sBa++}resume(){0<this.sBa&&this.sBa--}}Object(m.a)(Wh,"EditingSurfaceStateManager",null,[]);class Gg{constructor(a=30){this.wcd=this.Iic=-1;this.plb=Array(a);this.Ocd=Array(a-1)}yCh(){this.WRk();this.vEl()}Rnd(){const a=this.C8k();ia.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}WRk(){var a=(new Date).getTime();if(this.Iic<this.plb.length-1)this.Iic++;else for(let b=0;b<this.plb.length-1;b++)this.plb[b]=this.plb[b+1];this.plb[this.Iic]=a}vEl(){const a=this.Iic+1;
for(let b=2;b<=a;b++)this.rAl(b,this.B8i(b))}B8i(a){const b=this.Iic;return this.plb[b]-this.plb[b-(a-1)]}rAl(a,b){a-=2;this.wcd<a?(this.wcd++,this.Ocd[this.wcd]=b):b<this.Ocd[a]&&(this.Ocd[a]=b)}C8k(){const a=this.qXi();return Sys.Serialization.JavaScriptSerializer.serialize(a)}qXi(){const a=Array(this.wcd+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.Ocd[b]/(b+1));return a}}Object(m.a)(Gg,"EventFrequencyTracker",null,[]);var eg=d(1083),Tj=d(1085);class aj{constructor(a){this.Gt=null;this.Dp=
0;this.jK=a;this.Kj=new Date;this.Zvc=u.AFrameworkApplication.Aa.mode}end(a){this.Dp=a;this.Gt=new Date}get startTime(){return this.Kj}get endTime(){return this.Gt}get actionId(){return this.jK}get behavior(){return 2}get $Hc(){return this.Zvc}get SJ(){return null}get rd(){return null}get telemetryData(){return null}get response(){return this.Dp}get sT(){return 1}get xq(){return 30}get Xra(){return null}get Oi(){return!0}}Object(m.a)(aj,"TypingActionOperation",null,[1366,359,360]);class pj{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){this.Ve=this.ezc=this.nob=null;this.IXh=a;this.xh=b;this.Ap=c;this.Iha=f;this.n2=l;this.Ak=x;this.Ob=H;this.Lf=U;this.Zd=ja;this.Nk=ya;this.uf=Va;this.Ui=hb;this.Ch=yb;this.Us=Zb;this.Eha=fc;this.aS=Kc;this.Tc=Lc;this.DD=Gc}JS(a){this.Ve=a}get Adg(){return!!this.nob}startHybridTransition(){if(this.Nk.value.isEditingAllowed||this.Nk.value.ez){this.xh.E$k();this.Ap.raiseEvent(vd.a.aBk);this.Dal(D.a.overtype);this.Iha.value.qw();this.n2.BIk(this.xh.mode);
var a=this.Ak.me(2);a.kd(this.Ve.root);this.Ob.Dg&&!u.AFrameworkApplication.Ug&&this.Ob.Dg.Jda(this.Lf.Pd.Ma,4,!0);a.dispose();this.aS.Noc();this.uf.WKa(!0);this.Ui.updateCaretPosition(this.xh.mode,this.Ob.Hi);this.IXh.mZi(this.Ob.Vh,this.Ob.Dg,this.Ob.wW);this.Ch.Vjk(this.Tc.Na.mb.Ua.Qa,this.Tc.Na.mb.Ua.Mb);this.Us.UY();this.Eha.dGb();this.T5h();this.Ap.raiseEvent(vd.a.ZAk)}else this.xh.Caa(0,!0,12)}YQi(){this.aS.Noc();this.nob.end(32);eg.a.getInstance().Tnc(this.nob);Tj.a.getInstance().Snc(this.nob);
this.nob=null}T5h(){this.ezc||(this.ezc=new af.a(2,1,20,Object(F.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.Zd.Db(this.ezc))}Dal(a){this.nob=new aj(a)}hybridCleanup(){this.ezc=null;this.Ob.oVa(this.xh.mode)&&this.Ve.Ss(!0)}dYe(){if(!this.Tc.Na.Wda)return!1;const a=this.Tc.Na.mb.Ua,b=oc.HyperlinkReader.tC(a,!1);for(const c of b)if(c.Qa===a.Qa&&c.Mb<=a.Mb)return!1;return this.DD.STj(a)?!1:!gf.d(a.node,a.Qa)&&!gf.d(a.node,a.Mb-1)&&!a.node.nzi}}Object(m.a)(pj,"HybridTransitionManager",null,
[1404]);class Ji{constructor(a,b,c,f,l){this.GCd=this.Iya=!1;this.ds=a;this.xh=b;this.nd=c;this.Ch=f;this.Lf=l}get WBj(){return this.GCd}FOc(){this.pSf(!0)}pSf(a){this.ds.isComposing&&2===this.xh.mode&&(ia.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.GCd=!0,this.nd.zg.coa(),this.Ch.pok(this.nd.contentWindow),this.GCd=!1,this.ds.isComposing=!1,a&&this.Lf.Pd.uo&&(this.Lf.Pd.jtb()&&ia.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.xh.Y0a()))}}
Object(m.a)(Ji,"ImeManager",null,[]);class yg{constructor(a,b,c,f,l,x,H,U){this.yh=null;this.zd=a;this.nd=b;this.xh=c;this.Ak=f;this.ld=l;this.ag=x;this.Sm=U}LZb(a){this.yh=a}get UBj(){if(this.zd.eg){const a=Od.a.ZDa(this.nd.contentWindow);if(a&&this.Sm.qUc(a)===this.nd.qm())return!0}return!1}correctBadImeState(){if(!this.UBj)return!1;this.ld.Xb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.ag.bz++;const a=this.Ak.me(3);a.kd(this.yh.root);this.xh.Caa(0,!0,11);this.xh.Y0a();
a.dispose();return!0}}Object(m.a)(yg,"ImeRecoveryUtils",null,[]);class Aa{constructor(a,b,c,f,l,x,H,U,ja){this.Ch=a;this.ag=b;this.ld=c;this.kj=f;this.yK=l;this.Yo=x;this.Lf=H;this.Ob=ja}dGb(){for(let a=0;a<this.Ch.Ei.length;a++)this.Yo.KI(this.Ch.Ei[a].yF,this.ag,this.ld,this.kj)?Sys.UI.DomElement.removeCssClass(this.Ch.Ei[a].Hhe,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Ch.Ei[a].Hhe,"EmptyTextRun"),Ca.a.X0b(this.Ch.Ei[a].yF,this.Ch.Ei[a].Hhe)}}Object(m.a)(Aa,"InteractiveViewSynchronizer",
null,[]);var Ma=d(15),cb=d(201),Fb=d(243);class dc{constructor(){}}Object(m.a)(dc,"OnBackspaceDeleteEventArgs",null,[]);class zc{constructor(a){this.n3d=a}}Object(m.a)(zc,"OnDisMissFloatieEventArgs",null,[]);var Vc=d(549),rd=d(101);class Z{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh,Zi,Ei,fj,Fi,Gi,Mk,Cj,Bk,Il,lk,Jl,Vj,Wj,sk,kl){this.cia=null;this.iff=this.E7e=!1;this.cUb=new Ma.ScriptSharpLegacyMap;this.zBa=a;this.kj=b;this.Zd=c;this.nd=f;this.ld=
l;this.ag=x;this.$qa=H;this.bia=U;this.dha=ja;this.Ob=ya;this.Ui=Va;this.zd=hb;this.Sm=yb;this.qZ=Zb;this.kf=fc;this.aS=Kc;this.YH=Lc;this.lqa=Gc;this.Tc=ae;this.uf=we;this.ds=$d;this.Iha=Te;this.$B=Ze;this.fh=Vf;this.Nk=gg;this.GK=Qg;this.lnb=Rg;this.Mk=Wf;this.PNa=rg;this.LV=Sg;this.FNh=Gh;this.fqb=Zi;this.Ak=Ei;this.Ca=fj;this.fd=Fi;this.ap=Gi;this.JD=Mk;this.hSb=Cj;this.KP=Bk;this.V4a=Il;this.Tba=lk;this.Ap=Jl;this.ENh=Vj;this.Tza=!!Wj;this.gv=Wj;this.$a=sk;this.zn=kl}get $tc(){return this.zBa.instance?
this.zBa.instance.ODh():null}get RZd(){return this.hSb||(this.hSb=Db.a.instance.ub("Common.IEventTimingMeter"))}get R_a(){return this.cia||(this.cia=Db.a.instance.ub("Box4.ISelectionCommands"))}jYj(a,b){let c=this.hbe(a);c||(c=this.atj(a,b));return c}atj(a,b){const c=a.qc,f=c.keyCode,l=a.eventName===ta.a.cQa;if(this.Tza&&l&&this.gv.instance&&this.gv.instance.ark(f===A.a.TH))return Id.a.Bn(c),!0;if(f===A.a.T1a&&c.shiftKey&&c.ctrlKey)return l&&(u.AFrameworkApplication.Ta.processAction(D.a.BLf,2),ia.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===A.a.kvd||f===A.a.nvd)return this.Ioe(D.a.ALf),!1;if(f===A.a.lvd||f===A.a.Muc)return this.Ioe(D.a.zLf),!1;if(f===A.a.R6e)return this.Ioe(D.a.xIi),!1}this.kj&&(this.Zd.$Mf(Z.Htl),this.nd.zg.Atd());if(1===this.uf.mode)return this.zuk(a,b);if(this.kj&&this.Mk.Nda)return this.ld.Xb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.ag.bw++,Id.a.Bn(c),this.$qa.Ioc(D.a.typing),!0;this.bia.fixupAfterMagnifierDrag();this.nd.qm().scrollTop=
0;this.dha.t9=!this.Ob.Lca&&f===A.a.oP||this.Ob.Lca&&f===A.a.VR||f===A.a.Qw;this.Ui.updateCaretPosition(this.uf.mode,this.Ob.Hi);this.zd.Ej&&(c.ctrlKey||c.altKey)&&f!==A.a.jvd&&f!==A.a.sMa&&f!==A.a.$lb&&f!==A.a.hwd&&this.PNa.FOc();return this.$sj(a)}$sj(a){var b=a.qc.keyCode;const c=b===A.a.ppa,f=b===A.a.TH;let l=!1,x=!1,H=!1;switch(b){case A.a.Qw:case A.a.aF:H=!0;u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.$a.ka("BrowserHandledNavigationIsEnabled");
a.qc.altKey||a.qc.ctrlKey||a.qc.shiftKey||this.zd.vk||!b&&this.zd.Tj||(x=!0);break;case A.a.VR:case A.a.oP:H=!0;this.zd.vk&&this.Sm.K3f(a.qc.rawEvent)&&!a.qc.altKey&&!a.qc.shiftKey?x=!0:this.zd.Ej&&this.R_a?a.qc.altKey||a.qc.ctrlKey||a.qc.shiftKey||(x=!0):l=!0;this.$a&&this.$a.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.uf.WKa(!0);break;case A.a.U1:case A.a.S1:H=!0;this.zd.Ej&&this.R_a?x=this.Nrj(a):l=!0;this.$a&&this.$a.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.kf.U_c(this.V4a.mb)||
this.kf.AKa(),this.uf.WKa(!0));break;case A.a.ppa:case A.a.TH:if(!this.Nk.value.isEditingAllowed&&this.Nk.value.ez)l=!0;else if(this.Crj(a,c,f))return!0;break;case A.a.IIh:this.ld.Xb("InsertKeyPressed");l=!0;break;default:if(a.qc.keyCode===A.a.hwd||a.qc.keyCode===A.a.ovd||this.zd.pQd)this.ds.isComposing=!0,this.fqb||this.uf.Daa(!0)}(this.Mk.S2&&!f||this.Mk.osa&&!c)&&this.YH.Ss(!0);2!==this.uf.mode&&(H=x=!1);a.eventName===ta.a.cQa&&this.Ap.gOk(a,this.ds.isComposing,H);x&&(this.Iha.value.qw(),this.$B.CPa(a));
l&&Id.a.Bn(a.qc);return x}hbe(a){return u.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?Vc.a.hbe(a,this.V4a.l4b):!1}Drj(a){const b=this.V4a.l4b;var c=b.node;const f=b.Qa,l=Sb.ParagraphReader.text(c);let x=!1;if(a){if(f<Sb.ParagraphReader.textLength(c)){a=this.Ak.me(15);try{a.kd(c),c=f+1,ha.a.ox(l,c)&&c++,this.zn.KGb(b,null),this.Ca.processAction(D.a.rightArrow,2)}finally{a&&a.dispose()}x=!0}}else if(0<f){a=this.Ak.me(15);try{a.kd(c),c=f-1,ha.a.ox(l,c)&&c--,this.zn.KGb(b,null),this.Ca.processAction(D.a.leftArrow,
2)}finally{a&&a.dispose()}x=!0}return x}vij(a){return gc.a.xs(a.Ua).cache.fontSize}Nrj(a){var b=!1;if(!(a.qc.altKey||a.qc.ctrlKey||a.qc.shiftKey||(a=gf.f(this.Ob.Dg),cb.a.any(a,c=>5===c.Wq||8===c.Wq)))){if(this.nd.zg&&this.KP.Yzb(this.nd.zg.Rn))return!1;this.$B.Klb&&this.$B.typingProcess();b=this.qZ.ota(this.dha.t9);a=this.kf.Ria(b);a=this.Ob.Lca?a.x+a.width:a.x;-1===this.kf.Ez?(this.kf.Ez=a,b=!0):b=Math.abs(this.kf.Ez-a)<=this.vij(b)}return b}Crj(a,b,c){if(!a.qc.altKey&&!a.qc.ctrlKey&&!a.qc.shiftKey&&
(this.kj&&this.Mk.S2&&this.aS.fud()&&this.YH.Ss(!1),this.FNh.nzl(b,this.Ob.Vh,this.Ob.bRa,this.Ob.Dg,this.dha.t9,this.Ob.wW.Hi,this.YH.bji))){if(this.fd.gg&&this.fd.Uy)return(b=this.Drj(b))&&Id.a.Bn(a.qc),b;const f=this.ld.Vp(D.a.fSd);this.$tc&&this.$tc.pYj();const l=new dc(a,c,b);this.ENh.oNk(l);(c&&!this.Mk.S2||b&&!this.Mk.osa)&&this.YH.Ss(!1);P.a.instance.ga(50)&&this.lqa.value&&this.lqa.value.rw&&this.Tc.iYb();Ca.a.X0b(this.Ob.Vh.Hi,this.Ob.wW.Hi);this.$B.CPa(a);this.kf.AKa();this.uf.Daa(!0);
this.Mk.osa=b;this.Mk.S2=c;this.Mk.S2&&-1===this.Mk.hLc?this.Mk.hLc=this.YH.fVc:this.Mk.osa&&-1===this.Mk.Asd&&(this.Mk.Asd=Ca.a.yv(this.Ob.bRa).length);f.end();return!0}return!1}Zz(a,b,c){const f=this.RZd;try{f&&f.keyDownEventHandlerStart(a.qc.rawEvent);0===this.uf.mode&&a.qc.keyCode!==A.a.tq&&1!==this.Ca.mode&&this.U2j(this.uf,a.eventName);if(!b||!this.fh)return!1;(a.qc.keyCode!==A.a.$lb||this.lnb.tNc)&&this.Nk.value.wq.qC();if(!this.Khl(a)){const H=new zc(!0);this.Tba.FNk(H)}if(!this.uf.isActive)return!1;
this.Mk.gne=(new Date).getTime();const l=this.ld.Vp(D.a.typing);l.properties.$(Uc.a.source,"KeyDown");l.properties.$(Uc.a.f$g,"KeyDown");const x=this.jYj(a,c);x&&Id.a.ypi(a.qc);l.end();return x}finally{f&&f.keyDownEventHandlerEnd(a.qc.rawEvent)}}Khl(a){switch(a.qc.keyCode){case A.a.cba:case A.a.HIh:case A.a.K6:case A.a.cZ:case A.a.dba:case A.a.Mga:case A.a.ovd:case A.a.pvd:return!0}return!1}U2j(a,b){b={["EventName"]:b};u.AFrameworkApplication.Aa&&(b.Mode=u.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=
a.t1c,b.TriggeredTime=a.OYj,this.cUb.Hb(a.t1c)){let c,f;(c=this.cUb).$(f=a.t1c,c.ga(f)+1)}else this.cUb.$(a.t1c,1);b.Msg="BadEditSurfaceState";this.E7e?ia.ULS.sendTraceTag(18437408,323,50,"{0}",b):(ia.ULS.shipAssertTag(18437408,323,!1,"{0}",b),u.AFrameworkApplication.pga(()=>{this.V2j()}));this.E7e=!0}V2j(){if(!this.iff){var a="";for(let b of this.cUb.keys)a+=" Trigger "+b+" - "+this.cUb.ga(b)+",";ia.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.iff=!0}}zuk(a,b){this.kj&&
this.GK.pjb(this.uf.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez);if(this.fd.gg&&(y.KeyInputManager.YVc(a.qc)===y.KeyInputManager.Oa(A.a.Oza,y.KeyInputManager.Oe)||y.KeyInputManager.YVc(a.qc)===y.KeyInputManager.Oa(A.a.vvc,y.KeyInputManager.Oe))&&(u.AFrameworkApplication.yM||u.AFrameworkApplication.iG)&&!u.AFrameworkApplication.MRa)return Id.a.Bn(a.qc),!0;const c=this.V4a.l4b,f=c.node;if(a.qc.keyCode===A.a.tq){if(Fb.EmbeddedFileReader.RRj(f))return Id.a.Bn(a.qc),
!0;if(rd.ImageReader.iH(f)||!Fb.EmbeddedFileReader.Dab(f))if(rd.ImageReader.iH(f)||rd.ImageReader.rFa(c))return u.AFrameworkApplication.Ta.mi(c,D.a.zB,2,!1,null,null),Id.a.Bn(a.qc),!0}switch(a.qc.keyCode){case A.a.hwd:case A.a.ovd:if({O3:a,pNb:b}=this.LV.RDh(a,b),a)return b}return!1}Ioe(a){u.AFrameworkApplication.Ta.processAction(a,2)}}Z.Htl=2E3;Object(m.a)(Z,"KeyDownProcessor",null,[]);class Da{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){this.Yo=a;this.Ob=b;this.ag=c;this.ld=f;this.kj=l;this.yD=
x;this.YH=H;this.aS=U;this.xh=ja;this.Ui=ya;this.qZ=Va;this.tV=hb;this.kf=yb;this.Mk=Zb;this.uf=fc}get NJe(){return this.Yo.KI(this.Ob.Hi,this.ag,this.ld,this.kj)-(this.yD.s7?1:0)-this.Yo.KI(this.Ob.Hi.lastChild,this.ag,this.ld,this.kj)}hKk(a,b){switch(b.keyCode){case A.a.aF:case A.a.VR:if(this.zzj(a,b))return!0;break;case A.a.Qw:case A.a.oP:if(this.UQi(a,b))return!0;break;case A.a.U1:case A.a.S1:if(this.UBl(a,b))return!0;break;case A.a.TH:if(this.ohi())return!0}return!1}ohi(){return this.Mk.S2&&
this.aS.fud()?(this.YH.Ss(!1,!0),!0):!1}UBl(a,b){a.NYc=!0;var c=this.NJe;const f=this.Ui.C8(this.xh.mode,this.Ob.Hi);f>=c&&(this.Ui.aT(c,this.Ob.Vh),a.mb=this.qZ.ota(this.tV.t9));if(f===b.X1b)a.M7a=b.keyCode===A.a.cZ?1:3;else{if(f<c&&ha.a.fz(this.Yo.y_f(this.Ob.Vh,f-1,this.ld,this.ag,this.kj))){c=this.kf.Wsa(a.mb,!1,!1,!1,!0);c=this.kf.Ria(c);var l=a.mb.Ua;a=this.kf.Ria(a.mb);l=gc.a.xs(l);a.y>c.y&&Math.abs(a.x-this.kf.Ez)>2*l.cache.fontSize&&this.Ui.aT(f-1,this.Ob.Vh)}this.uf.WKa(!0);this.tV.fixupAfterCursor(b.keyCode===
A.a.cZ?1:3);this.YH.SZd();return!0}return!1}UQi(a,b){a.NYc=!0;const c=this.NJe;this.kf.AKa();const f=this.Ui.C8(this.xh.mode,this.Ob.Hi);f>=c&&(this.Ui.aT(c,this.Ob.Vh),a.mb=this.qZ.ota(this.tV.t9));if(b.keyCode===A.a.oP&&(b.X1b>=c&&!this.Ob.Lca||b.X1b===this.tV.cyh&&this.Ob.Lca))a.M7a=2;else return this.uf.WKa(!0),b.keyCode===A.a.Qw&&f<c&&ha.a.fz(this.Yo.y_f(this.Ob.Vh,f-1,this.ld,this.ag,this.kj))&&this.Ui.aT(f-1,this.Ob.Vh),this.tV.fixupAfterCursor(this.Ob.Lca?4:2),this.YH.SZd(),!0;return!1}zzj(a,
b){a.NYc=!0;const c=this.NJe;this.kf.AKa();if(b.keyCode===A.a.VR&&(b.X1b===this.tV.cyh&&!this.Ob.Lca||b.X1b>=c&&this.Ob.Lca))a.M7a=4;else return this.uf.WKa(!0),this.tV.fixupAfterCursor(this.Ob.Lca?2:4),this.YH.SZd(),!0;return!1}}Object(m.a)(Da,"KeyEntryProcessor",null,[]);var Wa=d(1206),ib=d(129),nb=d(44);class jc{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf){this.$za=this.wlf=null;this.zd=a;this.Sm=b;this.ld=c;this.bia=f;this.Nk=l;this.LV=x;this.f7=H;this.ds=
U;this.uf=ja;this.Tc=ya;this.nd=Va;this.fyc=hb;this.Ui=yb;this.Xga=Zb;this.Yo=fc;this.Ob=Kc;this.dha=Lc;this.Ch=Gc;this.lqa=ae;this.Ap=we;this.$B=$d;this.pba=Te;this.zBa=Ze;this.n1h=Vf;this.fha=gg;this.fd=Qg;this.ap=Rg;this.hSb=Wf}get $tc(){return this.zBa&&this.zBa.instance?this.zBa.instance.ODh():null}get sbb(){return this.fd.gg&&this.fd.Uy}get VZ(){return this.$za||(this.$za=Db.a.instance.ub("Box4.IClipboardCommands"))}get RZd(){return this.hSb||(this.hSb=Db.a.instance.ub("Common.IEventTimingMeter"))}Bbb(a,
b){if(!b)return!1;b=this.RZd;try{b&&b.keyPressedEventHandlerStart(a.qc.rawEvent);if(this.zd.RF&&this.zd.vk&&this.Sm.K3f(a.qc.rawEvent))return!1;this.$tc&&!y.KeyInputManager.ijg(a)&&this.$tc.pYj();const c=this.ld.Vp(D.a.typing);c.properties.$(Uc.a.source,"KeyPress");const f=this.oYj(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.qc.rawEvent)}}Iwj(){if((this.n1h||this.sbb)&&this.fha.Q2(this.Tc.Pj,14)){var a=Object(oa.a)(Wa.a,this.fha.N4b(this.Tc.Pj,16,!1));if(a&&1<a.length){const b=[],
c=this.Tc.Na.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!tb.GraphIterator.nb(l).Vaa(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Tc.setSelection(new ib.Selection(b,!0))}}}iOk(a,b){if(1===this.uf.mode)return!1;this.Ap.aPe(a,this.ds.isComposing);let c;(c=this.$B).$0c=c.$0c+1;B.a.vo||Oc.App.ESd&&B.a.pzh||(this.$B.ouh(this.ds.HFa)||this.$B.CPa(a),this.uf.Daa(!0));this.ds.isComposing&&P.a.instance.ga(50)&&this.lqa.value&&this.lqa.value.rw&&this.Tc.iYb();this.Ch.KFc=
"";0<this.Ch.Ei.length&&(this.zd.eg||" "===b)&&(this.Ch.KFc=Ca.a.yv(this.Ch.Ei[0].yF));this.pba.raiseEvent(Uf.a.Wme,a);this.fyc.yCh();return!1}RNi(a){let b=!1;this.ds.HFa&&this.Xga.FZb.instance&&(" "===a&&this.Yo.iQi(this.Ob.Hi,this.Ui.C8(this.uf.mode,this.Ob.Hi))&&(b=!!this.Xga.xDe(this.ds.HFa,this.dha.t9)),!b&&this.Xga.FZb.instance.qWj(a)&&this.Xga.QNi(a,this.dha.t9))}btj(a){if(1!==this.uf.mode||(this.zd.Ej||this.zd.vo)&&a.qc.ctrlKey&&!a.qc.altKey||this.zd.Wka&&a.qc.charCode===A.a.T1)return!1;if(this.LV.Kgd(a))return!0;
var b=this.LV.IXe();const c=this.LV.Nhl();if(b||c||!this.f7.dYe())return b&&!c&&this.Tc.setSelection(Qd.SelectionFactory.Sg(this.Tc.Na.mb.Ua.node,this.Tc.Na.mb.Ua.Qa)),b=this.Eab(),this.Iwj(),this.VZ&&(this.VZ.w9g(String.fromCharCode(a.qc.charCode),b),this.pba.raiseEvent(Uf.a.Wme,a)),Id.a.Bn(a.qc),!0;if(this.LV.wJe(a))return!0;if(this.sbb){b=this.fd.gsb();try{this.Ap.aPe(a,this.ds.isComposing),this.zd.vo&&this.VZ?(this.VZ.w9g(String.fromCharCode(a.qc.charCode)),Id.a.Bn(a.qc)):(this.$B.CPa(a),this.uf.Daa(!0))}finally{b&&
b.dispose()}}else this.f7.startHybridTransition(),this.Ap.aPe(a,this.ds.isComposing),this.$B.CPa(a),this.uf.Daa(!0);this.pba.raiseEvent(Uf.a.Wme,a);this.fyc.yCh();return!1}Eab(){if(this.Tc&&this.Tc.Na&&this.Tc.Na.mb){const a=this.Tc.Na.mb;return nb.SelectionEditor.Xl(a.ga(a.length-1))||a.ga(a.length-1).contextId===Cb.a.paragraph}return!1}oYj(a){this.bia.fixupAfterMagnifierDrag();if(!(this.Nk.value.isEditingAllowed||this.Nk.value.ez&&this.sbb))return Id.a.Bn(a.qc),!0;if(this.LV.Mgd(a))return!1;if(1===
this.uf.mode)return this.btj(a);this.nd.qm().scrollTop=0;this.zd.eg&&this.uf.I5b(this.Ob.Dg)&&" "===this.wlf&&this.$B.typingProcess();const b=ha.a.charAt(ha.a.fromCharCode(a.qc.charCode),0);this.wlf=b;this.ds.isComposing||(y.KeyInputManager.ijg(a)&&(this.ds.isComposing=!0),this.Ui.$Pk&&(this.ds.isComposing=!0));this.RNi(b);if(this.zd.eg&&!this.zd.vk){const c=a.qc;if(c.ctrlKey&&122===this.Sm.x_f(c)||c.ctrlKey&&121===this.Sm.x_f(c))return!0}return this.iOk(a,b)}}Object(m.a)(jc,"KeyPressProcessor",null,
[]);class cc{constructor(a,b){this.Wi=a;this.keyCode=this.Wi.qc.keyCode;this.X1b=b}get Rxj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(m.a)(cc,"KeyQueueEntry",null,[]);class Ad{constructor(a,b,c,f,l,x,H){this.dUb=[];this.cia=null;this.cVh=a;this.uf=b;this.Ob=c;this.kf=f;this.Tc=l;this.YH=x;this.Ui=H}get R_a(){return this.cia||(this.cia=Db.a.instance.ub("Box4.ISelectionCommands"))}gbh(a){let b=-1;if(y.KeyInputManager.Djg(a.eventName)&&2===this.uf.mode)switch(a.qc.keyCode){case A.a.aF:case A.a.Qw:case A.a.VR:case A.a.oP:case A.a.U1:case A.a.S1:P.a.instance.ga(45)&&
this.uf.I5b(this.Ob.Dg)&&this.YH.Ss(!1,!1);ig.GrippersManager.instance.YTa();b=this.Ui.C8(this.uf.mode,this.Ob.Hi);break;default:ig.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.dUb,new cc(a,b))}iKk(a){for(;0<this.dUb.length;){const b=this.dUb[0];Array.removeAt(this.dUb,0);const c=y.KeyInputManager.Djg(b.Wi.eventName);if(!(c&&(b.Wi.qc.altKey||b.Wi.qc.ctrlKey||b.Wi.qc.shiftKey)||this.dUb.length)){if(c)if(b.Rxj){if(this.cVh.hKk(a,b))return!0}else this.kf.AKa();if(this.Qzl(a))return!0}}return!1}Qzl(a){if(5!==
a.M7a){if(this.uf.X2f(this.Ob.Dg))if(1===a.M7a||3===a.M7a){const b=this.kf.Ez;this.Tc.setSelection(a.mb);this.kf.Ez=b}else this.Tc.setSelection(a.mb);this.R_a.Kmk(a.M7a);if(2!==this.uf.mode)return!0}return!1}}Object(m.a)(Ad,"KeyQueueProcessor",null,[]);class Xd{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.cia=null;this.ld=a;this.GK=b;this.xh=c;this.ds=f;this.Ob=l;this.Nk=x;this.Eha=H;this.Us=U;this.iAc=ja;this.nd=ya;this.lnb=Va;this.$B=hb}get R_a(){return this.cia||(this.cia=Db.a.instance.ub("Box4.ISelectionCommands"))}PFa(a,
b){if(!b)return!1;b=this.ld.Vp(D.a.typing);b.properties.$(Uc.a.source,"KeyUp");a=this.rYj(a);b.end();return a}rYj(a){a.qc.keyCode===A.a.$lb&&(this.lnb.tNc=!0);a.qc.ctrlKey&&this.GK.UNf(this.xh.mode,qd.a.instance.Na,this.R_a,this.Ob.Vh,this.Ob.Hi,this.Ob.Dg,this.Nk.value.isEditingAllowed||this.Nk.value.ez);this.ds.isComposing&&(this.Eha.dGb(),this.Us.UY());this.$B.ouh(this.ds.HFa)&&(this.iAc.gbh(a),this.$B.Klb=!0,this.$B.typingProcess());this.nd.qm().scrollTop=0;return!1}}Object(m.a)(Xd,"KeyUpProcessor",
null,[]);class xe{constructor(a){this.Jyd=this.rxd=this.vG=null;this.Zd=a}get W7(){return this.vG||(this.vG=Db.a.instance.resolve("Common.Utils.IAriaNotifier"))}opk(a){a&&(this.Jyd=a,this.rxd=new af.a(2,1,500,Object(F.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),29),this.Zd.Db(this.rxd))}tryAriaNotifyParagraphLockedTask(a){this.Jyd&&a&&this.rxd===a&&this.W7.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.Jyd),!0)}}Object(m.a)(xe,
"LockedParagraphAriaNotifier",null,[]);class Ff{constructor(a){this.YH=a}lostFocus(a,b){u.AFrameworkApplication.Ug||b&&this.YH.Ss(!0,!1)}}Object(m.a)(Ff,"LostFocusEventProcessor",null,[]);class xg{constructor(a,b,c,f){this.ag=a;this.xh=b;this.Eha=c;this.Us=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&(this.ag.h++,c.scrollLeft=0,c.scrollTop=0,2===this.xh.mode&&(this.Eha.dGb(),this.Us.UY()))}}Object(m.a)(xg,"OnScrollProcessor",null,[]);var Eg=d(1112);class De{constructor(a,b,c,f){this.html=a;this.text=
b;this.Rul=c;this.MWd=f}dispose(){this.MWd=null}}Object(m.a)(De,"OriginalElementContent",null,[106]);class zd{constructor(a,b,c){this.kVb=[];this.cbf=0;this.ld=a;this.yS=b;this.Yo=c}get M1d(){return this.cbf}get T7g(){return this.kVb}rFf(){for(let a=0;a<this.kVb.length;a++)this.kVb[a]&&(this.kVb[a].dispose(),this.kVb[a]=null)}oyh(a){this.rFf();a=a.nt;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,
Hc.a.W2d));if(b||Sys.UI.DomElement.containsCssClass(f,Hc.a.pN)||Sys.UI.DomElement.containsCssClass(f,ca.a.fW)||Sys.UI.DomElement.containsCssClass(f,Hc.a.CN)){let l=b=null,x=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=Ca.a.yv(f):(l=this.Yo.F6d(f,this.ld,this.yS),x=new Eg.a(f));this.T7g[c]=new De(f.innerHTML,b,l,x)}Sys.UI.DomElement.containsCssClass(f,Hc.a.CN)&&(this.cbf=Ca.a.B9a(f))}}}Object(m.a)(zd,"OriginalElementContentArray",null,[1402]);class Gd{constructor(a,b,c,f,l,x,H){this.Ch=
a;this.ag=l;this.ld=f;this.kj=H;this.yD=b;this.Tc=c;this.Yo=x}mZi(a,b,c){var f=this.Tc.Na.mb.Ua;const l=f.Qa;f=f.Mb;let x=0,H=0;a=a.nt;Array.clear(this.Ch.Ei);for(let Va=0;Va<a.length;Va++){var U=a[Va],ja=this.Yo.KI(U,this.ag,this.ld,this.kj);if(Sys.UI.DomElement.containsCssClass(U,Hc.a.pN))H<l?x+=ja:H<f&&(ja=gf.d(b,H))&&!ja.mCa&&(ja=V.a.Be(U,ca.a.TFa),Array.add(this.Ch.Ei,new Bh(U,c.nt[ja],x,H,1))),H++;else if(Sys.UI.DomElement.containsCssClass(U,ca.a.fW))x+=ja;else if(!Sys.UI.DomElement.containsCssClass(U,
Hc.a.CN)){if(H+ja>=l&&H<=f){let hb=V.a.Be(U,ca.a.TFa);var ya=c.nt[hb];Sys.UI.DomElement.removeCssClass(ya,Hc.a.h8);Array.add(this.Ch.Ei,new Bh(U,ya,x,H,ja-(this.yD.s7?1:0)));for(U=this.Yo.KI(ya,this.ag,this.ld,this.kj);U<ja&&!(hb+1>=c.nt.length);)ya=c.nt[hb+1],U+=this.Yo.KI(ya,this.ag,this.ld,this.kj),ya.parentNode.removeChild(ya),Array.removeAt(c.nt,hb+1)}else if(H>f)break;x+=ja;H+=ja}}}}Object(m.a)(Gd,"OvertypeDomPreparer",null,[]);var fd=d(122),Mc=d(61);class uk{constructor(a,b,c,f,l,x,H,U,ja,
ya,Va,hb,yb,Zb,fc,Kc){this.SHd=!1;this.$za=null;this.KVh=a;this.xh=b;this.zd=c;this.Tc=f;this.$qa=l;this.kf=x;this.Nk=H;this.Lf=U;this.ds=ja;this.f7=ya;this.kj=Va;this.Ob=hb;this.GK=yb;this.$B=Zb;this.fd=fc;this.ap=Kc}get VZ(){return this.$za||(this.$za=Db.a.instance.ub("Box4.IClipboardCommands"))}Jzl(){return 1===this.xh.mode?(this.SHd&&this.zd.eg&&this.mSd(),this.SHd=!1,!0):!1}mSd(){if(this.VZ){const a=new J.DictionaryPropertySet;a.setValue(Mc.a.FU,"<span></span>");this.VZ.Z7(null,a,!1)}}wJe(a){const b=
this.Tc.bpa;return b.vme||b.Hke?(Id.a.Bn(a.qc),this.$qa.Ioc(D.a.$Ak),!0):!1}Kgd(a){if(!this.kf.dua(qd.a.instance.Na.mb))return!1;Id.a.Bn(a.qc);this.$qa.Ioc(D.a.Kgd);return!0}Mgd(a){if(!P.a.instance.ga(14))return!1;var b=qd.a.instance.Na.ga(0);if(!fd.a.instance.n7k(b))return!1;b=this.kf.Juc(qd.a.instance.Na);this.KVh.opk(b);Id.a.Bn(a.qc);this.$qa.Ioc(2===this.xh.mode?D.a.xAl:D.a.Mgd);return!0}RDh(a,b){let c,f;f=c=!1;if(!this.Nk.value.isEditingAllowed)return Id.a.Bn(a.qc),{O3:!0,pNb:!0};if(!b)return{O3:!0,
pNb:!0};if(this.Kgd(a)||this.Lf.Pd.Lb.Na.jH&&a.qc.type===ta.a.mWd)return{O3:!0,pNb:f};this.ds.isComposing=!0;b=this.IXe();if(!b&&this.f7.dYe()){if(this.wJe(a))return{O3:!0,pNb:f};this.kj&&this.GK.pjb(this.xh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez);this.fd.gg&&this.fd.Uy?(Id.a.Bn(a.qc),f=c=!0):this.f7.startHybridTransition()}else b&&this.Tc.setSelection(Qd.SelectionFactory.Sg(qd.a.instance.Na.mb.Ua.node,qd.a.instance.Na.mb.Ua.Qa)),this.Tc.bpa.Usb(),this.fd.gg&&
this.fd.Uy?(Id.a.Bn(a.qc),f=c=!0):this.zd.eg?(this.SHd=!0,this.$B.CPa(a),c=!0):(this.mSd(),Id.a.Bn(a.qc));return{O3:c,pNb:f}}IXe(){if(!this.Tc.Na.Wda)return!1;var a=qd.a.instance.Na.mb.Ua;return a.Qa!==a.Mb-1?!1:(a=gf.d(a.node,a.Qa))&&5===a.Wq?!0:!1}Nhl(){if(!this.Tc.Na.Wda)return!1;const a=this.Tc.Na.mb.Ua;return!gf.d(a.node,a.Mb)||0<a.Qa&&!gf.d(a.node,a.Qa-1)||a.Qa===a.Mb?!1:!0}}Object(m.a)(uk,"OvertypeUtils",null,[]);class Ki{constructor(a,b,c,f,l,x){this.H2a=null;this.nd=a;this.mPh=b;this.Lf=
c;this.xh=f;this.Ob=l;this.CHd=x}get pIf(){return this.mPh}X4e(){if(2===this.xh.mode&&this.Lf.Pd.lp&&this.Ob.oVa(this.xh.mode)){var a=this.Ob.Vh,b=this.pIf.R8d(a.gb);this.CHd.ijh(b,this.H2a,a,this.nd.zg.tu,!1,!0);this.H2a=b}}}Object(m.a)(Ki,"ParagraphOverlayPositioner",null,[]);class bj{constructor(a,b){this.uDk=this.location=null;this.Hu=a;this.isRtl=b}}Object(m.a)(bj,"OnShowFloatieEventArgs",null,[]);class wi{constructor(){this.type=0;this.payload=this.rJe=null;this.I1c=!1;this.BQa=this.style=this.$Me=
null}}Object(m.a)(wi,"PasteDataContext",null,[]);class za{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg){this.VHd=this.Skf=this.Nn=null;this.FKd=Qg;this.Nqa=Rg;this.Rkf=a.ka("PasteClipboardImageInChromeIsEnabled");this.WXh=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.SId=a.ka("ReadImageBlobForIE11UpIsEnabled");this.BOh=a.Bc("ClipboardDataImageBlobLimitaton",10);this.MWb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.zof=a.ka("PasteInBootLoadingUIIsEnabled");
this.KKd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.Zd=b;this.ld=c;this.Ak=f;this.Tc=l;this.xh=x;this.nd=H;this.n2=U;this.Lf=ja;this.zd=ya;this.GK=Va;this.Ob=hb;this.Xga=yb;this.Nk=Zb;this.$za=fc;this.ik=Kc;this.SPh=Gc;this.dPa=ae;this.rS=we;this.Ca=$d;this.Tga=Te;this.xqa=Ze;this.Tba=Vf;this.wBa=gg;this.n9e=[Object(F.a)(this,this.jBj,"imageClipboardDataHandler"),Object(F.a)(this,this.QEk,"plainTextClipboardDataHandler"),Object(F.a)(this,this.Zzj,"htmlClipboardDataHandler")]}get VZ(){return this.$za.instance}get zJa(){return this.VHd}efj(a){switch(a){case "image/png":a=
1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get f0h(){return this.KKd||this.MWb}itj(a){const b=new wi;b.type=this.efj(a.type);b.payload=a.data;b.I1c=!0;this.Bmh(b)}kbh(a,b){this.Tc.bpa.Usb();this.xh.Caa(0,!0,13);this.nd.b0a(!0);const c=this.nd.zg.tu.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.n2.DIk();this.Lf.Pd.Kza();this.zd.Bua?this.GK.IKa(this.xh.mode,this.Ob.Hi,this.Ob.Dg,this.Ob.Vh,this.Nk.value.isEditingAllowed||this.Nk.value.ez):
this.n2.PJc();return b}olh(a){this.nd.zg.tu.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.zJa&&!this.Zd.tw)if(this.VZ||this.zof){this.Xga.yR&&(this.Xga.yR=null);this.VHd=this.Ak.me(3);this.zJa.kd(b);b=new wi;b.BQa=this.wBa.i_e();b.BQa.tHc("pasteHandler");b.I1c=!1;b.rJe=this.kbh(this.rS.Zpd,b.rJe);if(c=this.ik.ida(a)){this.f0h&&this.GCk(c,b);for(let f=0;f<this.n9e.length&&this.n9e[f](a,c,b);++f);}this.Nqa&&a.preventDefault();u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");
!this.VZ&&this.zof?this.Bmh(b):this.Amh(b)}else ia.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.cNf}),this.Ca.Goe(D.a.Z7),a.preventDefault()}Bmh(a){ia.ULS.sendTraceTag(24492118,307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Qoa();this.Tga.ek(6,()=>{this.bNi(a)})}Qoa(){this.Nn=this.xqa();this.Nn.Ar=!1;this.Nn.xd=5;this.Nn.Qoa(null,null,null)}bNi(a){this.Nn&&(this.Nn.close(),this.Nn=null);ia.ULS.sendTraceTag(24492119,
307,50,"Clipboard commands available. Dismissing progress dialog.");this.Amh(a)}Amh(a){a=this.SPh.create(null,Object(F.a)(this,this.eOi,"doPasteOperation"),a);a.Pl("Browser Pasted (Editing Surface)");a.run()}jBj(a,b,c){if((this.Rkf||this.SId)&&(b=this.ik.V5d(a.rawEvent))&&this.ik.cvd(this.nd.qm())){let f=null;if(({v8b:f}=this.ik.Etd(b,this.BOh,this.rS.Fic)).returnValue)return c.type=1,c.payload=f,this.SId&&this.zd.$W&&a.preventDefault(),!1}return!0}QEk(a,b,c){return this.WXh&&this.ik.BRj(b)&&(a=this.ik.e9d(b))?
(c.type=2,c.payload=a,!1):!0}Zzj(a,b,c){return this.FKd&&(a=this.ik.C5b(b))?(c.type=3,c.payload=a,this.KKd&&c.style&&(c.payload+=c.style),!1):!0}eOi(a,b){var c=this.nd.zg.tu.style;b&&this.rS.Zpd&&"hidden"===c.overflow&&this.olh(b.rJe);if(c=this.nd.qm()){if(this.zd.Lua)for(var f=c.firstChild;f&&1===c.childNodes.length&&Rc.a(f);)c=f,f=f.firstChild;if(b&&(this.Rkf||this.SId)&&1===b.type&&this.ik.cvd(c)&&(f=b.payload)){this.Skf=a;this.rS.U0b(f,l=>{this.BPf(this.Skf,l,b)});return}this.BPf(a,this.nd.ffj(c),
b)}}mrf(a){a=this.dPa.create(a,Object(F.a)(this,this.XAh,"teardownPaste"),null);a.Pl("Aborting Paste in ContentEditableView");a.run()}BPf(a,b,c){this.zd.Ej&&(Ca.a.Au(this.nd.qm()),this.zd.Wka||this.nd.zg.coa());if(this.Nqa&&!c)ia.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.mrf(a);else{c.I1c&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.I1c;this.Nqa&&(f=!c.payload&&f);f?(ia.ULS.sendTraceTag(18437454,307,15,""),this.mrf(a)):(c.style&&(b+=c.style),this.nd.b0a(!0),f=new J.DictionaryPropertySet,
f.setValue(Mc.a.FU,b),f.setValue(ab.a.Zje,!0),f.setValue($a.a.YN,!0),1===c.type&&this.rS.$qc?f.setValue(Mc.a.HWc,b):2===c.type&&c.payload?f.setValue(Mc.a.mhb,c.payload):3===c.type&&c.payload&&(this.Nqa?f.setValue(Mc.a.FU,c.payload):f.setValue(Mc.a.dKe,c.payload)),this.MWb&&c.$Me&&f.setValue(Mc.a.N9g,c.$Me),c.BQa&&f.setValue(Mc.a.BQa,c.BQa),a=this.dPa.create(a,Object(F.a)(this,this.Goi,"callPasteAction"),f),a.Pl("Paste in ContentEditableView"),a.run())}}Goi(a,b){this.VZ.Z7(a,b,!0);a.Wg(Object(F.a)(this,
this.XAh,"teardownPaste"));return!0}XAh(a){this.xh.Y0a();this.zJa&&(this.zJa.TU(a),this.zJa.dispose(),this.VHd=null);a.Wg(Object(F.a)(this,this.NTd,"callPasteFloatie"));return!0}NTd(a,b){a=Object(oa.a)(J.DictionaryPropertySet,b);if(!a||a.sa(Mc.a.mhb,null)||a.sa(Mc.a.HWc,null))return!1;b=new bj(1,u.AFrameworkApplication.isRtl);b.uDk=a.sa(Mc.a.FU,null);this.Tba.Eeh(b);return!1}GCk(a,b){if(a=this.ik.aUf(a)){u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");
if(this.MWb){let c=this.ik.bUf(a);null===c?c="inaccessible":""===c&&(c="unknown");b.$Me=c}this.KKd&&(b.style=this.ik.LUi(a))}}}Object(m.a)(za,"PasteHandler",null,[1400]);class sb{constructor(a,b,c,f,l){this.fjf=new He.a(RegExp("\u00a0","g")," ");this.Gpf=new He.a(new RegExp("["+eb.Ozf+eb.wdg+"]","g"),"");this.ld=a;this.ag=b;this.Ui=c;this.Yo=f;this.zd=l}Esi(a,b,c,f,l){if(l){l=!1;for(let ja=0;ja<a.length;++ja){const ya=b.T7g[ja];if(!ya)continue;const Va=a[ja];var x=Va.innerHTML,H=ya.html;if(x.length===
H.length||x===H)continue;if(nc.SZc(Va))continue;l=!0;x=Sys.UI.DomElement.containsCssClass(Va,ca.a.fW);H=Sys.UI.DomElement.containsCssClass(Va,Hc.a.pN);const hb=Sys.UI.DomElement.containsCssClass(Va,Hc.a.CN);let yb=!1,Zb=!1;Va.parentNode&&Va.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Va.parentNode.parentNode,Hc.a.W2d)&&(yb=Va.parentNode.parentNode.firstChild===Va.parentNode,Zb=Va.parentNode.parentNode.lastChild===Va.parentNode);var U=void 0;let fc;ya.text?(U=Ca.a.yv(Va),fc=ya.text):
(U=this.Yo.F6d(Va,this.ld,this.ag),fc=ya.Rul);const Kc=this.fjf.CJa(U).indexOf(this.fjf.CJa(fc));if(0<=Kc){const Lc=this.Gpf.CJa(ha.a.substring(U,0,Kc));U=this.Gpf.CJa(ha.a.right(U,Kc+fc.length));0<Lc.length&&((hb||H||yb)&&0<ja?(this.kdd(a[ja-1],Lc,!0,this.ag),this.Yo.WYc(Va)&&(f-=eb.xNc)):x&&ja!==a.length-1&&this.kdd(a[ja+1],Lc,!1,this.ag));0<U.length&&((H||Zb||x)&&ja!==a.length-1?(this.kdd(a[ja+1],U,!1,this.ag),this.Yo.WYc(Va)&&(f+=eb.R_d)):hb&&0<ja&&this.kdd(a[ja-1],U,!0,this.ag))}else hb&&(this.zd.Ej||
this.zd.vo)&&1===fc.length&&!U.length?ia.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):hb&&this.zd.eg||ia.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),x=fc?fc.length:0,H=U.length,H>x&&(f-=H-x);ya.text?Ca.a.Nx(Va,ya.text):(this.Yo.sVj(Va)||ya.MWd.restore(),ya.MWd=new Eg.a(Va))}l&&this.Ui.aT(f,c)}}kdd(a,b,c,f){f.n++;c?Ca.a.Nx(a,Ca.a.yv(a)+b):Ca.a.Nx(a,b+Ca.a.yv(a))}}Object(m.a)(sb,"ReadOnlyObjectsCleaner",null,[]);class Nb{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,
Zb,fc,Kc,Lc,Gc,ae,we){this.lia=0;this.nd=a;this.sKd=b;this.rK=c;this.ag=f;this.ld=l;this.vAc=x;this.Tc=H;this.Ui=U;this.Yo=ja;this.zd=ya;this.af=Va;this.kf=hb;this.Lf=yb;this.kj=Zb;this.bKd=fc;this.Sm=Kc;this.sr=Lc;this.eUh=Gc;this.zRh=we}init(a){this.lia=a}pjb(a,b,c,f,l){if(this.nd.isValid){var x=this.nd.qm();x&&x.firstChild&&1!==u.AFrameworkApplication.Aa.state&&(this.sKd.eUf(this.Tc.Na),this.cUe(a,b,c,f,l))}}IKa(a,b,c,f,l){if(this.rK.Ije()&&(!this.kj||this.af.zch))if(this.rK.setFocus(a,b,c,f,l),
this.zd.dV){a="Window.getSelection";b=this.nd.qm();if(this.zd.yT){if("none"===b.style.display){ia.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!Ca.a.mua(this.nd.zg.Nza,b)){ia.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var x=this.Sm.getSelection(this.nd.contentWindow);x&&(a="Selection.removeAllRanges",this.Sm.removeAllRanges(x),a="Selection.selectAllChildren",this.Sm.P6k(x,b))}catch(H){x=Ca.a.Q5f(b),ia.ULS.sendTraceTag(18437461,
324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?Od.a.x0d(b):"",H.stack,b?b.style.display:"",x?x.tagName+","+x.id+","+x.className:"")}}else this.Sm.cUe(this.nd.aEa().Tl)}cUe(a,b,c,f,l){const x=this.Tc.Na.mb;try{if(this.rK.Ije()&&(!this.kj||this.af.zch)){var H=x.Ua,U=x.Ye,ja=this.bKd.create(this.Lf.Pd);this.IKa(a,b,c,f,l);a=null;var ya=this.nd.aEa();if(this.zd.dV){a=this.Sm.getSelection(this.nd.contentWindow);if(!a)return;if(this.Sm.qgj(a)){var Va=this.Sm.getRangeAt(a,
0);this.Sm.removeAllRanges(a)}else Va=this.Sm.createRange(ya.Tl)}else if(this.zd.NF)Va=ya.selection.createRange();else return;this.eUh&&this.tbl(Va);(this.kf.gk(H)||this.kf.Xl(H))&&this.iZi(H,Va);this.kf.gk(U)&&this.jZi(U,Va);this.zd.dV?this.Sm.addRange(a,Va):this.zd.NF&&Va.select();ja.dispose()}}catch(hb){H=this.nd.qm(),ia.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",hb.message,hb.stack,H?Od.a.x0d(H):"")}}jZi(a,b){var c=a.node.sc(this.lia).nt;let f=0,l=0,x=0;
a=a.Mb;for(var H=!1;f<c.length;){const U=this.Yo.KI(c[f],this.ag,this.ld,this.kj);if(H)x+=U;else if(Sys.UI.DomElement.containsCssClass(c[f],Hc.a.pN))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],ca.a.fW)){if(a<=l+U)if(H=a-l,this.zd.dV){c=c[f];this.vAc.value.q0b(c,this.nd.contentWindow);this.brh(b,c,H,!1);break}else x=U-H,H=!0;l+=U}f++}this.zd.NF&&this.Sm.moveEnd(b,-x)}iZi(a,b){var c=a.node.sc(this.lia).nt;let f=0;var l=0;let x=0,H=a.Qa;for(this.kf.Xl(a)&&(H=this.sr.textLength(a.node));f<c.length;)if(a=
this.Yo.KI(c[f],this.ag,this.ld,this.kj),Sys.UI.DomElement.containsCssClass(c[f],Hc.a.pN))l++,f++,x+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],ca.a.fW))f++,x+=a;else if(this.zRh&&Sys.UI.DomElement.containsCssClass(c[f],Hc.a.V0d))f++,x+=a;else{if(H<=l+a){l=H-l;this.zd.dV?(c=c[f],this.vAc.value.q0b(c,this.nd.contentWindow),this.brh(b,c,l,!0)):this.Sm.moveStart(b,x+l);break}l+=a;x+=a;f++}}brh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&ia.ULS.sendTraceTag(18437465,
324,50,"Span is not normalized"):ia.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,x=null;b=Ca.a.fRc(b,!0);for(let H of b)if(3===H.nodeType){b=H.nodeValue.length;if(c<=l+b){this.Sm.YLb(a,f,H,c-l);return}x=H;l+=b}x?(ia.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.Sm.YLb(a,f,x,c-l)):ia.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}UNf(a,b,c,f,l,x,H){var U=this.Tc.bpa;if(U.vme||
U.Hke)return!1;var ja=this.nd.qm();if(!ja.innerHTML.length)return!1;U=!1;if(this.zd.dV)(b=Od.a.ZDa(this.nd.contentWindow))&&(this.Sm.qUc(b)===ja?U=!0:this.kj&&Od.a.GSj(b)&&Od.a.FSj(b)&&(U=!0));else if(this.zd.NF){var ya=this.nd.aEa().selection.createRange();ya=this.Sm.V$i(ya.range);ya=ya.replace(ha.a.zAc,"");ja=ja.innerHTML;ja=ja.replace(ha.a.zAc,"");if(ya===ja)switch(a){case 2:U=!0;break;case 1:1<b.length||!(this.kf.Yt(b.mb.Ua)||this.kf.Xl(b.mb.Ua)||this.kf.Yt(b.mb.Ye)||this.kf.Xl(b.mb.Ye))||(U=
!0)}}if(!U)return!1;this.ag.by++;this.kj&&c?c.Ksa():2===a?this.Ui.aT(this.Ui.rVa,f):1===a&&this.pjb(a,l,x,f,H);return!0}tbl(a){a=Ca.a.fRc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=Ca.a.Yja(b),a.startsWith("OutlineElement")&&(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(m.a)(Nb,"SelectContentHelper",null,[]);class Ac{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){this.cia=this.$pa=this.Ve=null;this.xh=a;this.Ui=b;this.ag=yb;this.Ob=c;this.uf=f;this.nd=l;this.Zd=x;this.Sm=H;this.Yo=U;this.ld=hb;this.Tc=ja;this.kj=fc;this.GK=ya;this.tV=Va;this.Nk=Zb;this.aS=Kc}get R_a(){return this.cia||(this.cia=Db.a.instance.ub("Box4.ISelectionCommands"))}JS(a){this.Ve=a}$vj(a,b){if(!a)return!1;var c=this.xh.mode;if(2===c)if(!this.Ui.fHj)this.ag.b++,this.Ui.aT(this.Ui.rVa,this.Ob.Vh);else if(this.kj){if(500>(new Date).getTime()-this.uf.Gzi)return this.Ve.Jtb.Nda=
!1;a=Od.a.ZDa(this.nd.contentWindow);if(!a)return!1;if(Od.a.F_c(a)){b=this.Ui.yRc(c,this.Ob.Hi);if(this.Ui.rVa===b&&!this.Ve.Jtb.Nda)return this.$pa&&(this.Zd.Lg(this.$pa),this.Zd.Db(this.$pa)),!1;if(this.aS.fud())return this.ag.c++,this.Ve.Jtb.Nda=!0,!1;if(this.Ve.Jtb.Nda)return this.ag.d++,this.uf.Daa(!0),this.Ve.Ss(!0),this.Ve.Jtb.Nda=!1;this.$pa||this.Ve.Ss(!0);ig.GrippersManager.instance.setVisibility(!1);this.aal();return!1}if(this.GK.UNf(c,qd.a.instance.Na,this.R_a,this.Ob.Vh,this.Ob.Hi,this.Ob.Dg,
this.Nk.value.isEditingAllowed||this.Nk.value.ez))return this.ag.e++,!1;c=this.Yo.U8d(this.Sm.qUc(a),this.Ob.Hi,this.Sm.b7f(a),this.ag,this.ld,this.kj);a=this.Yo.U8d(this.Sm.b9i(a),this.Ob.Hi,this.Sm.q1f(a),this.ag,this.ld,this.kj);if(0>c||a<c||Sb.ParagraphReader.textLength(b.node)<a)return!1;this.ag.f++;this.Tc.setSelection(Qd.SelectionFactory.f3(b.node,c,a))}return!1}aal(){this.$pa?this.Zd.Lg(this.$pa):this.$pa=new af.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.Zd.Db(this.$pa)}fixupAfterMagnifierDrag(){if(this.$pa){this.$pa=
null;var a=this.xh.mode;2===a&&this.Ob.oVa(a)&&(this.ag.g++,this.Ui.updateCaretPosition(a,this.Ob.Hi),this.uf.WKa(!0),this.tV.fixupAfterCursor(5),this.Ve.Ss(!0),ig.GrippersManager.instance.tvh())}}}Object(m.a)(Ac,"SelectionChangeHandler",null,[1345]);class Jd{constructor(a,b){this.nd=a;this.HWb=b}eUf(a){this.Dxf(this.nd.qm(),this.HWb+a.Rr,B.a.hji)}Dxf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.iXk(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.Dxf(a,
b,c))}iXk(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.HWb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else ia.ULS.sendTraceTag(18437474,324,50,"Class string for DOMElement is null")}}Object(m.a)(Jd,"SequenceCodeHelper",null,[1343]);class ge{constructor(a,b,c,f){this.ag=f;this.Ui=b;this.ld=c;this.$a=a}wLk(a,b,c,f){if(a.Ei.length){var l=a.Ei[0].yF,x=Ca.a.yv(l);if((a=a.KFc)&&x&&x.length===a.length+1&&x.endsWith(" ")){var H=Od.a.V7d(l);H&&((a=V.a.Be(l,ca.a.TFa),
a=b.nt[a+1],a)?Od.a.V7d(a)!==H&&(c=this.Ui.C8(c,f),f=Ca.a.yv(a),this.ld.Xb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.ag.q++,Ca.a.Nx(l,x.substring(0,x.length-1)),Ca.a.Nx(a," "+f),this.Ui.aT(c,b)):this.ag.p++)}}}Npi(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.$a.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,Hc.a.u9))for(let x=0;x<l.childNodes.length;x++)this.FDf(l.childNodes[x],
x,b,a,c)&&x--;else this.FDf(l,f,b,a,c)&&f--}}FDf(a,b,c,f,l){const x=a.parentNode;f=x===f;if(3===a.nodeType){let H=-1;const U=a.nodeValue;let ja=null,ya="";if(b){const Va=x.childNodes[b-1];if(Rc.a(Va)&&(!f||Sb.ParagraphReader.$d(Rc.a(Va).gb))){for(ja=Va;ja.lastChild&&1===ja.lastChild.nodeType;)ja=ja.lastChild;ya=ja.innerText+U}}if(!ja&&b!==x.childNodes.length-1&&(b=x.childNodes[b+1],Rc.a(b)&&(!f||Sb.ParagraphReader.$d(Rc.a(b).gb)))){for(ja=b;ja.firstChild&&1===ja.firstChild.nodeType;)ja=ja.firstChild;
ya=U+ja.innerText}ja?(H=this.Ui.C8(c,x),this.ld.Xb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.ag.r++,Ca.a.Nx(ja,ya)):(this.ld.Xb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),this.ag.s++);x.removeChild(a);-1!==H&&this.Ui.aT(H,l);return!0}return!1}kWk(a,b,c,f){if(B.a.eg&&a.Ei.length){var l=Ca.a.yv(a.Ei[0].yF),x=a.KFc;l&&x&&l.length===x.length+2?this.Chh(0,a,b,c,f):2===a.Ei.length&&this.Chh(1,a,b,c,f)}}Chh(a,b,c,f,l){c=this.Ui.C8(c,f);(f=Ca.a.yv(b.Ei[a].yF))&&f.endsWith("\u00a0 ")&&
(this.ag.t++,f=f.substr(0,f.lastIndexOf("\u00a0 "))+" ",b.Ei[a].yF.innerText=f,(0<a?c-(b.Ei[0].iIc+Ca.a.yv(b.Ei[0].yF).length):c-b.Ei[0].iIc)>f.length&&c--,this.Ui.aT(c,l))}}Object(m.a)(ge,"StrayTextCleanupUtils",null,[]);class re{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){this.pha=null;this.eMd=a;this.Nnb=b;this.pAd=c;this.ld=f;this.bia=l;this.xh=x;this.Tc=H;this.f7=U;this.zd=ja;this.uf=ya;this.Mk=Va;this.$B=hb;this.Eha=yb;this.Us=Zb;this.LV=fc;this.pba=Kc;this.Ob=Lc;this.iPa=
Gc;this.fd=ae}get dda(){return this.pha||(this.pha=Db.a.instance.ub("Box4.IFormatPainter"))}dlb(a,b){if(!b)return!1;if(this.eMd.vth)return a.qc.preventDefault(),!0;if(this.Nnb.K7a&&this.zd.Bua)return this.Nnb.K7a=!1,this.pAd.cancelEventAndRestoreEditingSurface(a.qc),!0;this.dda&&this.dda.wL&&(this.dda.wL=!1);this.Brj(a.qc);b=this.ld.Vp(D.a.typing);b.properties.$(Uc.a.source,"TextInput");a=this.yul(a);b.end();return a}yul(a){this.bia.fixupAfterMagnifierDrag();if(1===this.xh.mode){if(this.LV.IXe())this.Tc.setSelection(Qd.SelectionFactory.Sg(qd.a.instance.Na.mb.Ua.node,
qd.a.instance.Na.mb.Ua.Qa));else if(this.f7.dYe()){if(this.LV.wJe(a))return!1;this.f7.startHybridTransition()}this.zd.RI&&this.LV.mSd()}this.pba.raiseEvent(Uf.a.zul,a);this.uf.Daa(!0);this.Mk.u1e=!0;this.$B.CPa(a);this.iPa&&this.iPa.YNl(this.Ob.Vh);this.Eha.dGb();this.Us.UY();return!1}Brj(a){this.zd.eg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Mk.XZd=!this.Mk.S2,this.Mk.XZd&&u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=re.mUd.yRc(2,this.Ob.Hi),
a<re.mUd.rVa&&(a=Qd.SelectionFactory.f3(this.Ob.Dg,a,re.mUd.rVa),u.AFrameworkApplication.Ta.La(D.a.pRa,2,a))))}static get mUd(){return re.Ui||(re.Ui=Db.a.instance.resolve("Box4.ICaretPositionManager"))}}re.Ui=null;re.aS=null;re.YH=null;Object(m.a)(re,"TextInputEventProcessor",null,[]);class Xe{constructor(a,b,c,f,l,x){this.rK=a;this.zd=b;this.af=c;this.Mk=f;this.Nk=l;this.fd=x}get sbb(){return this.fd.gg&&this.fd.Uy}get vth(){if(this.rK.z8b||!this.Nk.value.isEditingAllowed&&this.Nk.value.ez&&!this.sbb)return!0;
if(this.zd.m9){var a=this.af.EYj;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Mk.gne;if(500>a&&a<b)return!0}}return!1}}Object(m.a)(Xe,"TextInputHandlerUtils",null,[]);var $f=d(516),Tg=d(310);class hh{constructor(a,b,c,f){this.gqa=null;this.zd=a;this.rK=b;this.Lf=c;this.kf=f}onContextMenu(a,b){let c=!1;this.zd.m9&&this.rK.MZc&&(b=this.kf.Wtb(this.Lf.Pd,b,this.Lf.Pd.Xja(a),!1),this.kf.lx(b)&&(c=!0));c?(this.gqa=a.clientPoint,a=!0):(this.gqa=null,a=this.Lf.Pd.onContextMenu(a));return a}Hkc(a){if(this.zd.m9&&
this.gqa){const b=Tg.a.q2e;if(a.clientPoint.x>this.gqa.x+b||a.clientPoint.x<this.gqa.x-b||a.clientPoint.y>this.gqa.y+b||a.clientPoint.y<this.gqa.y-b)this.gqa=null}return!1}vHb(a){let b=!1;this.zd.m9&&this.gqa&&(b=this.Lf.Pd.onContextMenu(a),this.gqa=null);return b}}Object(m.a)(hh,"TouchEventProcessor",null,[]);class qj{create(a){return new aj(a)}}Object(m.a)(qj,"TypingActionOperationFactory",null,[1341]);var de=d(73),Yf=d(250);class vk{constructor(a,b,c,f,l,x){this.dqf=0;this.Lgf=ka.a.nil;this.STb=
this.yzc=!1;this.Cff=4===Oc.App.mode;this.XBc=!1;this.s2h=new Kb.a;this.s2h.add(0,D.a.WRe);this.SEc=new Kb.a;this.SEc.add(0,0);this.thf=a;this.knb=b;this.Lf=c;this.Ap=f;this.t2h=l;this.syd=x;this.ugf=Object(F.a)(this,this.S0k,"reportTypingCharCount");u.AFrameworkApplication.pga(()=>{this.x4j()});this.syd&&this.pUk();this.oUk();u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.ra(D.a.WRe,de.a.frame,ld.ActionManager.Mg,96)}pUk(){this.Ap&&this.Ap.addHandler(vd.a.jy,this.ugf)}oUk(){this.knb&&this.knb.duf(Object(F.a)(this,
this.VGc,"afterEditingViewValidateEventHandler"))}Ioc(a){this.thf.value&&0===this.thf.value.mode||(a=new aj(a),a.end(8),eg.a.getInstance().Tnc(a),Tj.a.getInstance().Snc(a))}q2g(a,b){if(!this.Cff&&Oc.App.Kb&&2===Oc.App.Kb.mode&&b&&b.graphNode&&Sb.ParagraphReader.$d(b.graphNode)&&!gf.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.Lgf){if(this.XBc){var c;(c=this.SEc).$(0,c.ga(0)+1);u.AFrameworkApplication.Ta.processAction(D.a.WRe,2);c="Paragraph rendering is blocked";this.t2h&&(c+=", so graph transaction manager is reset",
Yf.GraphTransactionManager.instance.HWe());ia.ULS.sendTraceTag(38547550,323,15,c)}this.Lgf=a;this.XBc=!0}}else this.XBc=!1}VGc(a,b){this.Cff||!b.RM&&!b.RU||(!this.yzc&&this.Lf.Pd&&(this.Lf.Pd.J9h(Object(F.a)(this,this.q2g,"onContentEditableViewClick")),this.yzc=!0),this.XBc=!1)}S0k(){this.dqf++}$Hl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),ia.ULS.sendTraceTag(18437207,323,15,a))}x4j(){this.STb||(this.syd&&(ia.ULS.sendTraceTag(38114780,323,50,
""+this.dqf),this.FNi(),this.syd=!1),0<this.SEc.ga(0)&&ia.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.SEc.ga(0)),this.ENi(),this.STb=!0)}FNi(){this.Ap&&this.Ap.removeHandler(vd.a.jy,this.ugf)}ENi(){this.knb&&this.knb.qYk(Object(F.a)(this,this.VGc,"afterEditingViewValidateEventHandler"));this.yzc&&this.Lf.Pd&&(this.Lf.Pd.uYk(Object(F.a)(this,this.q2g,"onContentEditableViewClick")),this.yzc=!1)}}Object(m.a)(vk,"TypingLogger",null,[1296]);const Gj=a=>{u.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&
(a.execute(b=>{b.hbc("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};class Pm{constructor(a){this.NYc=!1;this.M7a=5;this.p_g=!1;this.fFe=!0;this.mb=a}}Object(m.a)(Pm,"TypingProcessState",null,[]);var ok=d(910);class wk{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh){this.iia=this.Ve=null;this.Klb=!1;this.Xtd=null;this.$0c=0;this.NSb=a;this.Ob=b;this.ECd=c;this.Ui=f;this.t4a=
l;this.Ap=x;this.iAc=H;this.qZ=U;this.tV=ja;this.uf=ya;this.lqa=Va;this.Tc=hb;this.uK=yb;this.Eha=Zb;this.ld=fc;this.ag=Kc;this.YH=Lc;this.Zd=Gc;this.Mk=ae;this.Ch=we;this.yD=$d;this.tqa=Te;this.Xga=Ze;this.zd=Vf;this.Aha=gg;this.Ak=Qg;this.Us=Rg;this.kZh=Wf;this.uLd=rg;this.ds=Sg;this.fd=Gh;this.vgf=0;this.Wbf=!1;this.IFj()}JS(a){this.Ve=a}get c1a(){return this.iia||(this.iia=Db.a.instance.ub("Box4.ITextFormattingCommands"))}zAl(){$e.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.fd.gsb();
try{this.$0c=0;if(this.Ve.bBk.Jzl()||2!==this.uf.mode||!this.uf.isActive||u.AFrameworkApplication.Ug||!this.Ob.Dg||this.ECd.correctBadImeState())return;this.Ui.updateCaretPosition(this.uf.mode,this.Ob.Hi);this.t4a.X4e();this.Qsi();this.Ap.raiseEvent(vd.a.typingProcess);if(!this.Ob.bRa||(2==Oc.App.mode||ok.a("SkipTypingProcessorDuringComposition"))&&this.ds.isComposing)return;const b=new Pm(this.qZ.ota(this.tV.t9));if(this.iAc.iKk(b))return;b.NYc||(this.uf.Daa(!0),b.p_g=!0);this.pKk(b);if(!this.Ob.oVa(this.uf.mode))return;
const c=this.Ob.wW.gb;this.fd.gg&&(c.hGb=this.Tc.Na.mb.Ua.Qa);b.p_g&&P.a.instance.ga(50)&&this.lqa.value&&this.lqa.value.rw&&this.Tc.iYb();if(b.fFe){try{this.Eha.dGb()}catch(f){this.ld.Xb("PossibleEditSurfaceIncorrectSize",{["Reason"]:"MirrorToPageViewCrash"}),this.ag.l++,this.YH.Ss(!1,!1)}this.Us.UY();this.ds.HFa&&(this.YH.Ss(!0,!0),this.fri())}}finally{a&&a.dispose()}$e.c(18437510,306,100,"TypingProcessInternalExited")}fri(){Oc.App.Kb.Dyj&&Oc.App.Kb.j4k()}CPa(a){this.iAc.gbh(a);this.Klb||(this.Klb=
!0,this.Zd.Db(this.Xtd))}rKi(){if(!this.Mk.S2&&!this.Mk.osa)return!1;const a=!this.lqa.value||this.lqa.value.amIAlone?wk.Lpj:wk.Kpj,b=this.NSb();-1===this.Mk.u1c&&(this.Mk.u1c=b);return b-this.Mk.u1c<a?(this.Zd.Db(this.Xtd),this.Klb=!0):!1}typingProcess(){if(this.Klb&&(this.Klb=!1,this.vgf++,!this.Zd.tw&&this.Ob.oVa(this.uf.mode)&&!(this.uK&&this.uK.Z$a()||this.rKi()))){var a=this.ld.Vp(D.a.typingProcess);this.zAl();a.end();this.Wbf||this.vgf!==wk.Hqi||((a=Db.a.instance.Ja("Common.ISystemInitiatedFeedback"))&&
Gj(a),this.Wbf=!0)}}Qsi(){if(this.ds.HFa){if(this.Ch.Grf())if((this.zd.RF||this.zd.vo)&&this.yD.s7){const a=this.Ui.C8(this.uf.mode,this.Ob.Hi);this.yD.Njb(!1,this.Ob.Hi,this.Ch);this.Ui.aT(a,this.Ob.Vh)}else this.yD.Njb(!1,this.Ob.Hi,this.Ch);this.kZh.Esi(this.Ob.Vh.nt,this.tqa,this.Ob.Vh,this.Ui.C8(this.uf.mode,this.Ob.Hi),this.ds.HFa);this.uLd.Npi(this.Ob.Hi,this.uf.mode,this.Ob.Vh);this.uLd.wLk(this.Ch,this.Ob.Vh,this.uf.mode,this.Ob.Hi);this.Ch.pWk();this.uLd.kWk(this.Ch,this.uf.mode,this.Ob.Hi,
this.Ob.Vh)}}pKk(a){this.Xga.yR?(this.Xga.gEk(),a.fFe=!1):this.Aha.instance&&this.Aha.instance.$be()&&!this.zd.HNb&&(this.ds.HFa&&this.c1a?(this.wei(a.mb),a.fFe=!1):this.Aha.instance.u_a())}wei(a){if(this.c1a&&this.Aha.instance){this.Aha.instance.freeze();var b=qd.a.instance.Na.mb,c=this.Ak.me(15);c.kd(this.Ob.Dg.node);a=Qd.SelectionFactory.DN(a,b.Ua);this.c1a.MLb(a.Ua,!0);this.Aha.instance.F1e();this.Aha.instance.u_a();this.Ob.Vh&&this.Tc.setSelection(this.qZ.ota(this.tV.t9));c.dispose();this.uf.Daa(!0);
this.YH.Ss(!0,!1)}}IFj(){let a=1;B.a.vo&&(a=u.AFrameworkApplication.fa.Bc("Box4TypingTaskTimeEdge",1));this.Xtd=new af.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Xtd=null}ouh(a){return this.zd.m9&&a?this.Xga.yR||this.$0c>wk.Rkk||this.Aha.instance&&this.Aha.instance.$be()||this.yD.s7?!0:!1:!1}}wk.Rkk=7;wk.Kpj=250;wk.Lpj=2E3;wk.Hqi=500;Object(m.a)(wk,"TypingProcessManager",null,[1340,106]);class Am{constructor(){this.Pa=new wc.a}FNk(a){this.Pa.raiseEvent("OnDismissPasteFloatie",a)}LNk(){this.Pa.raiseEvent("OnExpandMenuPasteFloatie")}bPe(a){this.Pa.raiseEvent("OnPastedContentUpdated",
a)}Eeh(a){this.Pa.raiseEvent("OnShowPasteFloatie",a)}W9h(a){this.Pa.addHandler("OnDismissPasteFloatie",a)}b$h(a){this.Pa.addHandler("OnExpandMenuPasteFloatie",a)}O$h(a){this.Pa.addHandler("OnShowPasteFloatie",a)}}Object(m.a)(Am,"PasteFloatieEventSource",null,[1337,1338,1339]);var Fk=d(874),Ih=d(131),yj=d(321),zj=d(404),Zl=d(228),vn=d(829);class lm{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}Zb(a){this.Da=a;a.register($f.a,"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().oa(()=>
new $f.a);a.register(ob,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().oa(()=>new ob);a.register(Gg,"Box4.EventFrequencyTracker").ma().oa(()=>new Gg);a.register(Ic,"Box4.CevUsageDataTracker").ma().oa(()=>new Ic);a.register(Ye,"Box4.ContentEditableViewEventSource").ma().oa(()=>new Ye);a.register(Ch,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().oa(()=>new Ch(Nc.a.instance,me.a.instance.L5d(),a.resolve("Box4.TextNodeCombiner")));a.register(zd,
"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().oa(()=>new zd(Nc.a.instance,me.a.instance.L5d(),nc.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Vi,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().oa(()=>new Vi);a.register(ie,"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().oa(()=>new ie(a.resolve("Box4.IEditingDomManager")));a.register(bk,"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().oa(()=>
new bk(a.resolve("Box4.EditStateEventManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1296,"Box4.ITypingLogger").ma().oa(()=>new vk(a.ie("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),sa.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(yd,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().oa(()=>new yd(a.ie("Box4.ITextNodeCombiner"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.EditingDomManager"),nc.instance,nd.a.instance,sa.InteractiveViewManager.instance,u.AFrameworkApplication.ye,nd.a.instance.Ni,Fk.a.instance,a.resolve("Common.IScrollLockFactory"),a.resolve("Box4.IContentEditableViewContentControlHelper"),
a.resolve("Box4.ITypingLogger")));a.register(oj,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().oa(()=>new oj(a.resolve("Box4.EditingDomManager"),sa.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),nd.a.instance.Ni,Dd.a.instance,nd.a.instance,v.FocusManager.instance()));a.register(sb,"Box4.ReadOnlyObjectsCleaner").ma().oa(()=>new sb(Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.CaretPositionManager"),nc.instance,
nd.a.instance));a.register(ge,"Box4.StrayTextCleanupUtils").ma().oa(()=>new ge(u.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI));a.register(1297,"Box4.IContentEditableViewContentControlHelper").ma().oa(()=>new wg(Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,nd.a.instance.Ni,nc.instance,sa.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(Cf,"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().oa(()=>
new Cf(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").tI,Nc.a.instance,a.ub("Box4.IHyperlinkEditor"),nd.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),Fk.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Common.IAppSettingsManager")));a.register(Fe,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().oa(()=>
new Fe(a.Ja("Common.ITypingSpeedMeterProvider"),sa.InteractiveViewManager.instance));a.register(Zg,"Box4.ContentEditableViewTypingState").ma().oa(()=>new Zg(u.AFrameworkApplication.Ta));a.register(Qc,"Box4.ContentEditableHtmlStructureUtils").ma().oa(()=>new Qc(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(Jd,"Box4.SequenceCodeHelper").ma().oa(()=>new Jd(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").Xoh));a.register(Nb,
"Box4.SelectContentHelper").ma().oa(()=>new Nb(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").tI,Nc.a.instance,a.ie("Box4.ITextNodeCombiner"),qd.a.instance,a.resolve("Box4.ICaretPositionManager"),nc.instance,nd.a.instance,La.EventHandlerManager.instance,yj.a.instance,sa.InteractiveViewManager.instance,nd.a.instance.Ni,a.resolve("Common.ScrollLockFactory"),Fk.a.instance,a.resolve("Box4.IParagraphReader"),
rb.ListReader.nx,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(Pf,"Box4.EditingDomDisplayManipulator").ma().oa(()=>new Pf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),u.AFrameworkApplication.fa,sa.InteractiveViewManager.instance));a.register(Sd,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().oa(()=>
new Sd(a.resolve("Box4.ContentEditableViewEventSource")));a.register(Aa,"Box4.InteractiveViewSynchronizer").ma().oa(()=>new Aa(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").tI,Nc.a.instance,nd.a.instance.Ni,a.resolve("Box4.Graph.IGraphIteratorFactory"),nc.instance,sa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager")));a.register(Ek,"Box4.CurrentEditSelectionProvider").ma().oa(()=>new Ek(a.resolve("Box4.ICaretPositionManager"),
a.resolve("Box4.CevUsageDataTracker").tI,Nc.a.instance,nc.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),nd.a.instance.Ni,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Ue,"Box4.BackspaceInBrowserHandler").ma().oa(()=>new Ue(a.resolve("Box4.CurrentEditSelectionProvider"),nd.a.instance.Ni,fd.a.instance,yj.a.instance,a.resolve("Box4.IExternalSelectionManager"),Zl.a.instance,u.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.IHyperlinkStrategy"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ja("Box4.IAutoCorrectScheduler"):null));a.register(Gd,"Box4.OvertypeDomPreparer").ma().oa(()=>new Gd(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),qd.a.instance,Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,nc.instance,nd.a.instance.Ni,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Ui,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().oa(()=>
new Ui(yj.a.instance,qd.a.instance,Nc.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),sa.InteractiveViewManager.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),nd.a.instance,a.resolve("Box4.SelectContentHelper"),new mc.a(()=>Oc.App.Kb.Kd),a.Ja("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),
u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Am,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().oa(()=>new Am);a.register(Af,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().oa(()=>new Af);a.register(Ag,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().oa(()=>
new Ag(a.Ja("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ja("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),nd.a.instance,sa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IRotatingCoordinateConverter")));a.register(Wh,"Box4.EditingSurfaceStateManager").ma().oa(()=>new Wh);a.register(mi,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().oa(()=>
new mi(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),u.AFrameworkApplication.ye,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new mc.a(()=>Oc.App.Kb.Kd),nd.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),qd.a.instance,a.resolve("Box4.IExternalSelectionManager"),
a.resolve("Box4.ICurrentlyActiveContentSpans"),sa.InteractiveViewManager.instance,yj.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ki,"Box4.ParagraphOverlayPositioner").ma().oa(()=>new Ki(a.resolve("Box4.IEditingDomManager"),new vn.a,sa.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(Jg,
"Box4.ContentEditableViewDebugLogger").ma().oa(()=>new Jg);a.register(yg,"Box4.ImeRecoveryUtils").ma().oa(()=>new yg(nd.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.ContentEditableViewDebugLogger"),Fk.a.instance));a.register(Lh,"Box4.AutocorrectActionExecutor").ma().oa(()=>new Lh(a.Ja("Box4.IAutoCorrectScheduler"),a.Ja("Box4.IAutoCorrectRules"),
a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),a.ie("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),qd.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(za,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().oa(()=>new za(a.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.ye,Nc.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),qd.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),sa.InteractiveViewManager.instance,nd.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new mc.a(()=>Oc.App.Kb.Kd),a.Ja("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),u.AFrameworkApplication.Ta,gb.a.get_instance(),()=>new vc.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),
Oc.App.instance.Q9b,Oc.App.instance.AMb));a.register(Vh,"Box4.ContentEditableViewCursorManager").ma().oa(()=>new Vh(sa.InteractiveViewManager.instance,Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,nd.a.instance.Ni,qd.a.instance,yj.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new mc.a(()=>Oc.App.Kb.Kd),u.AFrameworkApplication.Ta,a.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.ye,
nd.a.instance,a.resolve("Box4.ICaretPositionManager"),nc.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),new td,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.ub("Box4.CharacterPointConverter")));a.register(Ac,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().oa(()=>new Ac(a.resolve("Box4.IEditingModeTransitionManager"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.ye,Fk.a.instance,nc.instance,qd.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,new mc.a(()=>Oc.App.Kb.Kd),nd.a.instance.Ni,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(pj,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().oa(()=>
new pj(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.ie("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),sa.InteractiveViewManager.instance,u.AFrameworkApplication.ye,new mc.a(()=>Oc.App.Kb.Kd),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),qd.a.instance,fd.a.instance));a.register(Yg,"Box4.CompositionStateManager").ma().oa(()=>new Yg(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(Ji,"Box4.ImeManager").ma().oa(()=>new Ji(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),sa.InteractiveViewManager.instance));a.register(Ie,"Box4.DragStateManager").ma().oa(()=>new Ie(nd.a.instance));a.register(hh,"Box4.TouchEventProcessor").ma().oa(()=>new hh(nd.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),sa.InteractiveViewManager.instance,yj.a.instance));a.register(of,"Box4.AppFrameResizeEventProcessor").ma().oa(()=>new of(a.resolve("Box4.BoundsSynchronizer")));a.register(xg,"Box4.OnScrollProcessor").ma().oa(()=>
new xg(a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(Ng,"Box4.EditingSurfaceEventHandlerUtils").ma().oa(()=>new Ng(Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.IEditingModeTransitionManager")));a.register(gh,"Box4.DragEventsProcessor").ma().oa(()=>new gh(nd.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));
a.register(Mg,"Box4.DoubleClickProcessor").ma().oa(()=>new Mg(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),sa.InteractiveViewManager.instance));a.register(pg,"Box4.DomChangeEventProcessor").ma().oa(()=>new pg(nd.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),Nc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),
u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Xe,"Box4.TextInputHandlerUtils").ma().oa(()=>new Xe(a.resolve("Box4.IContentEditableViewFocusHelper"),nd.a.instance,La.EventHandlerManager.instance,a.resolve("Box4.ContentEditableViewTypingState"),new mc.a(()=>Oc.App.Kb.Kd),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(yh,"Box4.ContentEditableViewGraphUpdater").ma().oa(()=>new yh(Nd.a.instance,a.resolve("Box4.EditingModeTransitionManager"),
Nc.a.instance,qd.a.instance,a.resolve("Box4.IExternalSelectionManager"),yj.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),
a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.HybridTransitionManager"),u.AFrameworkApplication.ye,nd.a.instance,a.Ja("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.ub("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(Da,"Box4.KeyEntryProcessor").ma().oa(()=>new Da(nc.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").tI,Nc.a.instance,nd.a.instance.Ni,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),
a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),yj.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditViewStateManager")));a.register(Ad,"Box4.KeyQueueProcessor").ma().oa(()=>new Ad(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),yj.a.instance,qd.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),
a.resolve("Box4.ICaretPositionManager")));a.register(wk,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().oa(()=>new wk(Od.a.uj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),
new mc.a(()=>Oc.App.Ih),qd.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.ContentEditableViewGraphUpdater"),u.AFrameworkApplication.ye,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),nd.a.instance,
a.Ja("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(uk,"Box4.OvertypeUtils").ma().oa(()=>new uk(new xe(u.AFrameworkApplication.ye),a.resolve("Box4.EditingModeTransitionManager"),nd.a.instance,qd.a.instance,a.resolve("Box4.ITypingLogger"),
yj.a.instance,new mc.a(()=>Oc.App.Kb.Kd),sa.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),nd.a.instance.Ni,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(bi,"Box4.ContentEditableViewFloatieHandler").ma().oa(()=>new bi);
a.register(Xd,"Box4.KeyUpProcessor").ma().oa(()=>new Xd(Nc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new mc.a(()=>Oc.App.Kb.Kd),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));
const b=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(jc,"Box4.KeyPressProcessor").ma().oa(()=>new jc(nd.a.instance,Fk.a.instance,Nc.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new mc.a(()=>Oc.App.Kb.Kd),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),qd.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),nc.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new mc.a(()=>Oc.App.Ih),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ja("Common.ITypingSpeedMeterProvider"),b,Ih.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.ub("Common.IEventTimingMeter")));a.register(Z,"Box4.KeyDownProcessor").ma().oa(()=>new Z(a.Ja("Common.ITypingSpeedMeterProvider"),nd.a.instance.Ni,u.AFrameworkApplication.ye,a.resolve("Box4.IEditingDomManager"),Nc.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),
nd.a.instance,Fk.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),yj.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new mc.a(()=>Oc.App.Ih),qd.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.ie("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new mc.a(()=>Oc.App.Kb.Kd),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),a.resolve("Box4.Graph.IGraphTransactionFactory"),u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.ub("Common.IEventTimingMeter"),
a.resolve("Box4.IRotatingCoordinateConverter"),zj.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ja("Box4.IAutoCorrectScheduler"):null,u.AFrameworkApplication.fa,a.ub("Box4.IHyperlinkEditor")));a.register(gi,"Box4.ContentEditableViewOnAfterValidateHandler").ma().oa(()=>new gi(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),
a.resolve("Box4.CevViewContentManager"),sa.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.IContentEditableViewPaddingManager"),nd.a.instance,a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.ie("Box4.ITextNodeCombiner"),
a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),qd.a.instance,nd.a.instance.Ni,a.resolve("Box4.SelectContentHelper"),new mc.a(()=>Oc.App.Kb.Kd),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.ub("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.ub("Box4.IFeatureHelper")));a.register(vi,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().oa(()=>
new vi(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));a.register(vg,"Box4.CompositionEventProcessor").ma().oa(()=>new vg(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),Nc.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(re,"Box4.TextInputEventProcessor").ma().oa(()=>new re(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),
Nc.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),qd.a.instance,a.resolve("Box4.HybridTransitionManager"),nd.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),
a.ub("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Ff,"Box4.LostFocusEventProcessor").ma().oa(()=>new Ff(a.resolve("Box4.ContentEditableViewGraphUpdater")));a.register(sh,"Box4.EditingSurfaceEventHandlerManager").ma().oa(()=>new sh(u.AFrameworkApplication.ye,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),
a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),
a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));a.register(Of,"Box4.ContentEditableViewDisposer").ma().oa(()=>new Of(a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").tI,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));
a.register(qj,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().oa(()=>new qj);a.register(1298,"Box4.IContentEditableModeHelper").ma().oa(()=>new id);a.register(ng,"Box4.ContentEditableView").as("Box4.IEditingView").ma().oa(()=>new ng(sa.InteractiveViewManager.instance,qd.a.instance,new mc.a(()=>Oc.App.Kb.Kd),a.Ja("Common.IActivityAggregationInfo"),a.Ja("Common.IZoomManager"),u.AFrameworkApplication.Ta,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),
a.resolve("Box4.IContentEditableDomFactory"),Oc.App.TLa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").LZb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.BoundsSynchronizer").LZb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ImeRecoveryUtils").LZb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").cii(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.SelectionChangeHandler").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewGraphUpdater").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.TypingProcessManager").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").JS(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").JS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.CompositionEventProcessor").JS(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){z.a.instance.Dc(new lm)}}Object(m.a)(lm,"ContentEditableViewPackage",null,[2,3]);class $l{get name(){return"PowerPointWebEditor.AutoFit"}Zb(){}init(){}dispose(){}static main(){z.a.instance.Dc(new $l)}}
Object(m.a)($l,"PPTWebEditorAutoFitPackage",null,[2,3]);class mm{constructor(a){this.Sw=a}}Object(m.a)(mm,"DynamicScriptLoaderProvider",null,[1560]);var xk=d(354),cl=d(239),If=d(313);const Bl=(a,b)=>{var c=rj(b);c=a.identifier+c+".js";let f="";f=a.isLocalized?f+(u.AFrameworkApplication.lcid+"/"):f+Bm(b);return f+c},rj=()=>u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"":u.AFrameworkApplication.fa.Cu("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",
Bm=a=>a&&u.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!u.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"exp/":"",dn=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:f=>{var l=xk.AppChromeOverrideUtilities.Ejg(c.knownScripts,f.identifier);if(xk.AppChromeOverrideUtilities.isEnabled&&l)l=f.isLocalized?xk.AppChromeOverrideUtilities.z3f(u.AFrameworkApplication.lcid):xk.AppChromeOverrideUtilities.YKb,
f.isLocalized||(l+=Bm(!0)),f=l+f.identifier+xk.AppChromeOverrideUtilities.HPc+".js";else if(If.a.instance.isEnabled){var x=u.AFrameworkApplication.nga;f=Bl(f,l);If.a.instance.isEnabled&&(l=If.a.instance.t7d(u.AFrameworkApplication.o1+f))&&(x=l+u.AFrameworkApplication.o1);ia.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+f);f=x+f}else if(x=rj(l),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",
!1))f.isLocalized?f=u.AFrameworkApplication.Aj(f.identifier+x,3):(f=Bm(l)+f.identifier,f=u.AFrameworkApplication.Aj(f+x+".js",5));else{var H=u.AFrameworkApplication.nga;H=f.isLocalized?H+(u.AFrameworkApplication.lcid+"/"):H+Bm(l);f=H+f.identifier+x+".js"}return f},resolveSriHash:f=>{const l=xk.AppChromeOverrideUtilities.Ejg(c.knownScripts,f.identifier);If.a.instance.isEnabled?(f=Bl(f,l),f=If.a.instance.okj(u.AFrameworkApplication.o1+f)):f=null;return f}};c.crossOriginAttributeValue=a;c.knownScripts=
window[b];return c};var xa=d(28),hi=d(653);class Hj{constructor(){this.Sxe=this.y$=this.K=null;this.dEg=this.CBg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}Zb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.y$=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.K.register(mm,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().oa(()=>{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=dn();
if(hi.a.XNj){const c=b.resolveScript;b.resolveScript=f=>{let l=hi.a.r3e(f.identifier+(xk.AppChromeOverrideUtilities.isEnabled?xk.AppChromeOverrideUtilities.HPc:".min")+".js");l||(l=c(f));return l}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&(b.loadScriptHandler=Object(F.a)(this,this.loadScript,"loadScript"));return new mm(new dynamicScriptLoader.DynamicScriptLoader(b))}u.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||b.a7e&&b.a7e(Object(F.a)(this,
this.loadScript,"loadScript"));return new mm(b)});this.CBg=u.AFrameworkApplication.fa.ka("EarlyLazySprite");this.dEg=u.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");u.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Hj.rpc.push("slidegrid");Hj.rpc.push("comment-pane-strings");Hj.rpc.push("sharedcomments");Hj.rpc.push("floatingcontainermanager")}loadScript(a,b){let c=this.Sxe;c&&c.isCompleted&&(this.Sxe=c=null);const f=this.CBg&&Array.contains(Hj.rpc,a),l=u.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&
Array.contains(Hj.y4k,a)?this.y$.gCi(b,Array.contains(Hj.Rmh,a),!(this.dEg&&Array.contains(Hj.T4k,a))):this.y$.oYd(b,null,Array.contains(Hj.Rmh,a));f||(this.Sxe=l.XFa);return new Promise((x,H)=>{const U=Date.now(),ja=()=>{l.XFa.continueWith(ya=>{if(6===ya.status)x(a);else{let Va=String.format("Failed to download the script with identifier: {0} at url: {1}.",a,b);ya.Yi&&(Va+=" "+ya.Yi.message);H(Error.create(Va))}});xa.a.J(540113033,813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-
U);cl.a.ey(l)};!c||f?ja():c.continueWith(()=>{ja()})})}init(){}dispose(){}}Hj.Rmh=["common","powerpoint-ribbon-intl","appChrome"];Hj.rpc="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Hj.y4k="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Hj.T4k=["common","appchrome"];Object(m.a)(Hj,"DynamicScriptLoaderPackage",null,[2,3]);var ql=d(278),Ug=d(106),dl=d(176);class yk{constructor(a,b,c,f,l){this.O6j=a;this.ubk=b;this.Xa=c;this.PFb=f;this.Ds=l}IYf(a){var b;return Object(ql.a)(this,void 0,void 0,function*(){try{const f=null!==(b=a.CorrelationId)&&void 0!==b?b:Ug.a.create().toString();xa.a.J(509214920,817,50,`CopilotProxy::generateAndMergeSlides: Correlation=${f}`);var c=yield this.P1i(a);if(!c||!c.DownloadablePPTInfos||0==c.DownloadablePPTInfos.length)return xa.a.J(509214919,
817,10,"CopilotProxy::generateAndMergeSlides: generatePPTFromOutline returned invalid response"),!1;const l=c.DownloadablePPTInfos[0].DownloadUrl;if(!l)return xa.a.J(509163081,817,10,`CopilotProxy::generateAndMergeSlides: generatePPTFromOutline failed; error code: ${c.DownloadablePPTInfos[0].ErrorCode}.`),!1;c={};c.PodSID=this.Xa.podSessionId;c.Client=a.ClientName;c["X-UserSessionId"]=this.PFb;c["X-CorrelationId"]=f;yield this.send({Qua:"mergeGeneratedSlides",url:this.ubk,payload:JSON.stringify({DownloadUrl:l,
MergeAction:a.MergeAction,InsertPosition:a.InsertPosition}),headers:c});return!0}catch(f){return xa.a.J(509214918,817,10,`CopilotProxy::generateAndMergeSlides: ${f}`),!1}})}P1i(a){var b;return Object(ql.a)(this,void 0,void 0,function*(){const c=null!==(b=a.CorrelationId)&&void 0!==b?b:Ug.a.create().toString();xa.a.J(509214917,817,50,`CopilotProxy::generatePPTFromOutline: Correlation=${c}`);const f={};f.Client=a.ClientName;f["X-CorrelationId"]=c;f["X-UserSessionId"]=this.PFb;try{const l=yield this.send({Qua:"generatePPTFromOutline",
url:`${this.O6j}?action=OutlineToPPT`,payload:JSON.stringify(a.OutlineInput),headers:f});return JSON.parse(l)}catch(l){xa.a.J(509214916,817,50,`CopilotProxy::generatePPTFromOutline: exception: ${l}`)}})}send(a){return new Promise((b,c)=>{const f=new Date;this.Ds.mj(a.url,2,a.payload,a.headers,!1,0,l=>{var x;xa.a.J(509214915,817,50,`CopilotProxy::${a.Qua}: Time Taken ${+new Date-+f}`);l.data.oe!==dl.a.Uv&&(xa.a.J(509214914,817,10,`CopilotProxy::${a.Qua}: Bad Http Status ${l.data.oe}`),c(`Bad Http Status ${l.data.oe}`));
xa.a.J(509214913,817,50,`CopilotProxy::${a.Qua}: call successful`);b(null!==(x=l.data.Sd)&&void 0!==x?x:"")},l=>{var x,H;const U=new Date;xa.a.J(509214912,817,15,`CopilotProxy::${a.Qua}: request failed Status: ${null===(x=null===l||void 0===l?void 0:l.data)||void 0===x?void 0:x.oe}, Time Taken ${+U-+f}`);c(`${a.Qua} failed with ${null===(H=null===l||void 0===l?void 0:l.data)||void 0===H?void 0:H.oe}`)},null)})}}Object(m.a)(yk,"CopilotProxy",null,[1332]);class el{constructor(a,b,c,f){this.M6j=5;this.kre=
0;this.wfc="ReplaceAll";this.bug="colorSchemeTextArea";this.CVg="themeIdsTextArea";this.nQg="presOutlineTextArea";this.ure="CopilotStatusBarDebugUI";this.rGg="CopilotLogPanelId";this.HAf=l=>{l.innerText="";const x=this.oc.hwb();for(let H=0;H<x.length;++H){const U=x[H],ja=document.createElement("option");ja.value=U.sid+";"+U.cid;ja.textContent=""+(H+1);l.appendChild(ja)}(l=l.options[l.selectedIndex].value.split(";"))&&2===l.length&&(this.OAg={ReferenceSlide:{Sid:parseInt(l[0]),Cid:parseInt(l[1])},
InsertBefore:!1})};this.fwk=()=>{const l=document.getElementById("InsertPositionSelect");l&&this.HAf(l)};this.gWa=a;this.xre={ColorScheme:b.Ga("CopilotTestDefaultColorScheme"),ThemeIds:b.Ga("CopilotTestDefaultThemeIds"),PresOutline:b.Ga("CopilotTestDefaultPresOutline")};this.oc=c;this.sEb=f;this.sEb.vF(this.fwk);document.getElementById("StatusBar").addEventListener("contextmenu",()=>{this.kre++;this.kre>=this.M6j&&(this.ykl(),this.kre=0)})}ykl(){if(!document.getElementById(this.ure)){var a=document.createElement("div");
a.id=this.ure;a.setAttribute("style","position: absolute; right: 0; bottom: 24px; display: block; z-Index: 10001; border:1px solid gray; padding: 10px; background-color:#f1f1f1");a.appendChild(this.SSd("Color Scheme",this.bug,this.xre.ColorScheme,"100px"));a.appendChild(this.SSd("Theme Ids",this.CVg,this.xre.ThemeIds,"30px"));a.appendChild(this.SSd("Presentation Outline",this.nQg,this.xre.PresOutline,void 0));a.appendChild(this.Dki());a.appendChild(this.jli());a.appendChild(this.Bki());document.body.appendChild(a);
"ReplaceAll"==this.wfc?this.Lod(!1):this.Lod(!0)}}SSd(a,b,c,f){const l=document.createElement("div");l.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");const x=document.createElement("div");x.setAttribute("style","margin: 2px; color: black; display: inline");const H=document.createElement("textarea");H.id=b;H.value=c;H.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");void 0!==
f&&(H.style.height=f);b=document.createElement("div");b.setAttribute("style","display: inline; float: right; margin-bottom: 2px");f=document.createElement("button");f.innerText="Default";f.onclick=()=>{H.value=c};b.appendChild(f);f=document.createElement("button");f.style.marginLeft="10px";f.innerText="Clear";f.onclick=()=>{H.value=""};b.appendChild(f);f=document.createElement("label");f.textContent=a;f.setAttribute("style","color: black; margin: 2px");x.appendChild(f);x.appendChild(b);l.appendChild(x);
l.appendChild(H);return l}Dki(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.Cki());a.appendChild(this.wki());return a}Cki(){const a=document.createElement("div");a.setAttribute("style","display:inline; margin: 2px 20px;");const b=document.createElement("label");b.textContent="MergeAction: ";b.style.color="black";const c=document.createElement("select"),f=document.createElement("option");
f.value="ReplaceAll";f.textContent="ReplaceAll";const l=document.createElement("option");l.value="Insert";l.textContent="Insert";"ReplaceAll"==this.wfc?f.selected=!0:l.selected=!0;c.appendChild(f);c.appendChild(l);a.appendChild(b);a.appendChild(c);c.addEventListener("change",()=>{"Insert"===c.options[c.selectedIndex].value?(this.wfc="Insert",this.Lod(!0)):(this.wfc="ReplaceAll",this.Lod(!1))});return a}wki(){const a=document.createElement("div");a.id="InsertPositionDiv";a.setAttribute("style","display:inline; margin: 2px 20px; visibility: hidden");
const b=document.createElement("label");b.textContent="After slide: ";b.style.color="black";const c=document.createElement("select");c.id="InsertPositionSelect";this.HAf(c);c.addEventListener("change",()=>{const f=c.options[c.selectedIndex].value.split(";");f&&2===f.length&&(this.OAg={ReferenceSlide:{Sid:parseInt(f[0]),Cid:parseInt(f[1])},InsertBefore:!1})});a.appendChild(b);a.appendChild(c);return a}Lod(a){document.getElementById("InsertPositionDiv").style.visibility=a?"visible":"hidden"}jli(){const a=
document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.kli());a.appendChild(this.Oji());return a}kli(){const a=document.createElement("button");a.style.marginRight="10px";a.innerText="GenerateAndMergeSlides";a.onclick=()=>Object(ql.a)(this,void 0,void 0,function*(){try{const b={ClientName:"ChatPPT",MergeAction:this.wfc,OutlineInput:{ColorScheme:JSON.parse(document.getElementById(this.bug).value),ThemeIds:JSON.parse(`[${document.getElementById(this.CVg).value}]`),
FRenderFirstThumb:!0,PresOutline:JSON.parse(document.getElementById(this.nQg).value)},InsertPosition:this.OAg,CorrelationId:void 0},c=yield this.gWa.IYf(b);this.log(`generateAndMergeSlides succeeded: ${c}`)}catch(b){this.log(`generateAndMergeSlides error: ${b}`)}});return a}Oji(){const a=document.createElement("button");a.innerText="Close";a.onclick=()=>{document.body.removeChild(document.getElementById(this.ure))};return a}Bki(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px; user-select: text;");
var b=document.createElement("label");b.style.color="black";b.style.userSelect="text";b.textContent=`UserSessionId: ${u.AFrameworkApplication.userSessionId}`;a.appendChild(b);b=document.createElement("textarea");b.id=this.rGg;b.value="";b.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");b.disabled=!0;b.style.height="50px";a.appendChild(b);return a}log(a){document.getElementById(this.rGg).value+=a+"\r\n"}}Object(m.a)(el,"StatusBarDebugUI",
null,[]);class Cm{get name(){return"PowerPointWebEditor.CopilotProxy"}Zb(a){this.K=a;a.register(yk,"PowerPointWebEditor.CopilotProxy").as("PowerPointWebEditor.ICopilotProxy").ma().oa(()=>new yk(a.resolve("Common.IAppSettingsManager").Ga("CreatorServiceBase"),a.resolve("Common.IAppSettingsManager").Ga("MergeSlidesFromUrlEndpoint"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.Ke))}init(){this.K.resolve("PowerPointWebEditor.ICopilotProxy");
this.K.resolve("Common.IAppSettingsManager").ka("CopilotDebugUIEnabled")&&new el(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7))}dispose(){}static main(){(u.AFrameworkApplication.fa.ka("EnableChatPPT")||u.AFrameworkApplication.fa.ka("EnableChatPPTCopilot")||u.AFrameworkApplication.fa.ka("EnableStoryTeller"))&&z.a.instance.Dc(new Cm)}}Object(m.a)(Cm,
"PPTWebEditorCopilotProxyPackage",null,[2,3]);var am=d(166),kf=d(96),Dm=d(640),rc=d(52),Em;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(Em||(Em={}));Object(m.b)("RefreshDocTrigger",Em);var Tc=d(43),df=d(86);class Aj extends Sys.EventArgs{constructor(a,b){super();this.JTj=
b}}Object(m.a)(Aj,"FailoverEventArgs",Sys.EventArgs,[]);var ti=d(246),rf=d(110);class Ll extends rf.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}Zk(){return 61}}Object(m.a)(Ll,"CheckUnblockUIRequest",rf.a,[]);var ck=d(873),K=d(30);class Fm{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te){this.hma=!1;this.ywa=this.pAe=this.yGa=this.FGa=this.YT=this.Fs=null;this.la=a;this.zb=b;this.Lek=c;this.hf=f;this.pa=l;this.Ea=x;this.hA=H;this.V3c=fc;this.Ldb=
Lc;this.Mm=U;this.T5j=ja;this.ua=ya;this.Vb=Va;this.u$=hb;this.Ce=yb;this.Rd=Zb;this.BGa=Kc;this.ia=Gc;this.LC=ae;this.jn=we;this.rYa=$d;this.fj=Te;this.f8j=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.Lak=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}wb(){this.ia.ra(K.a.UJb,rc.a.application,Object(F.a)(this,this.HSk,"refeshDoc"),64)}HSk(a,b,c,f,l){this.x3e(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in l&&l.isPodSessionRefreshed?
3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get xi(){return this.Vb.xi}Hsa(a){a.L7b()&&a.Hsa()}x3e(a,b,c,f){if(!this.Ce.od.hermesFailOverImprovementIsEnabled||this.Ldb())return!1;if(this.hma||this.BGa.Ghg)return!0;const l=this.xi;if(!(l&&l.zi&&l.zi.ax&&l.zi.ax.id!==ka.a.nil&&l.contentReplicator&&this.ua.presentation&&this.ua.presentation.id.equals(Dm.a.DJe)))return!1;5===f&&this.Crf();this.Mm.pause();this.u$.suspend();this.hA.Pd&&this.hA.Pd.endEditing(!1,14);
this.hA.forEach(Object(F.a)(this,this.Hsa,"ensureGraphUpdated"));l.lT(!0)&&l.Xfa();this.pa.setSelection(null);this.Ea.Ed();this.Fs=Tc.a.yk("RefreshDoc");this.Fs.Va("IsPlanedShutdown",b.toString());this.Fs.Va("PodSessionId",c);this.Fs.Va("RefreshDocTrigger",Em[f]);xa.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.Fs.actionId,this.Fs.kOb());this.YT=a;b?(this.FGa=new Date,this.BGa.jvh(),this.V3c.Db(this.BXd())):this.cgh();this.LC.Udh(new Aj(b,!1));this.ua.presentation.tSe();
this.hf.blockContent(this.ua.presentation,"RefreshDoc",!0);xa.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Rd.disabled=!0;return this.hma=this.Ce.V9a().Oed=!0}Crf(){this.Mm.isPaused&&(xa.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Mm.Mlb());try{this.Mm.lDf()}catch(a){xa.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",a)}}BXd(){return this.yGa=
new ti.a(new Ll(this.YT),Object(F.a)(this,this.RGe,"onCheckUnBlockUISuccess"),Object(F.a)(this,this.QGe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}cgh(){this.Fs.Va("FailedMachineId",this.YT);this.pAe=new Date;this.Lek.UJb(this.YT,this.Fs,!this.Ce.od.refreshDocSynchronouslyIsEnabled,!1,Object(F.a)(this,this.qOi,"docRefreshSuccessCallback"),Object(F.a)(this,this.pOi,"docRefreshFailedCallback"));this.T5j.jxa()}RGe(){this.BGa.eWc();this.Fs.Va("DeploymengUIBlockingTime",(+new Date-
+this.FGa).toString());this.Fs.Va("CheckUnblockUISucceeded","True");this.cgh()}QGe(a){if(142===a.ServerError.Code)return xa.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.YT,+new Date-+this.FGa),this.V3c.Db(this.yGa),!0;this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.FGa).toString());this.Fs.Va("CheckUnblockUISucceeded","False");this.BGa.eWc();return this.i5g(a)}qOi(){this.jn.hPd(Object(F.a)(this,this.HIe,"onSlideDrawComplete"));
this.ywa&&this.zb.Lg(this.ywa);const a=this.Fs.cK("RefreshDocTrigger");this.ywa=new af.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.f8j:this.Lak,Object(F.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.zb.Db(this.ywa);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.Crf()}pOi(a){return this.i5g(a)}HIe(){ia.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.ywa&&(this.zb.Lg(this.ywa),this.ywa=null);this.jn.nld(Object(F.a)(this,this.HIe,
"onSlideDrawComplete"));this.Fs&&(this.Fs.Va("ReStoreStatusAfterRefreshStartTime",Tc.a.nf(new Date)),this.u$.resume(),this.Fs.Va("SlideDrawResult","True"),this.Fs.Xm("SlideDrawCompleteET",new Date),this.Mm.isPaused&&this.Mm.Mlb(),this.Fs.Va("LoadAndRenderTime",(+new Date-+this.pAe).toString()),this.Ce.od.OPe||this.Ce.V9a().lxa(),this.Fs.Va("ReStoreStatusAfterRefreshEndTime",Tc.a.nf(new Date)),this.uIe(!0),this.rYa.keh(new ck.a("DocRefresh")),this.fj.hmb=2,u.AFrameworkApplication.Oib(df.a.Uh(180),
am.a.unknown,am.a.fuc),kf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.jn.nld(Object(F.a)(this,this.HIe,"onSlideDrawComplete"));this.ywa&&(this.zb.Lg(this.ywa),this.ywa=null);ia.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.Fs.Va("SlideDrawResult","False");this.uIe(!1);this.y0k()}y0k(){this.Rd.disabled=!1;u.AFrameworkApplication.vp(df.a.Uh(379));kf.Health.instance.recordQosError("RefreshDocTimeout",
["UnexpectedAppRefresh"],!1,!1,!0,!0,null);u.AFrameworkApplication.av&&u.AFrameworkApplication.av.y8();this.ia.La(K.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}i5g(a){ia.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Jh);this.uIe(!1);return!1}uIe(a){this.hma=
!1;this.yGa=this.YT=null;this.pAe=new Date(0);Tc.a.Oac=new Date;this.Fs&&(this.Fs.Va("Result",a?"Success":"Failed"),this.Fs.finish(!0),this.Fs=null);this.Rd.disabled=!1;this.Ce.V9a().Oed=!1;this.hf.fK(this.ua.presentation)}}Object(m.a)(Fm,"DocRefreshHandler",null,[1305]);var Ml=d(154);class cj{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.hma=!1;this.yGa=this.FGa=this.YT=this.Fs=null;this.ia=a;this.vi=b;this.ai=c;this.hf=f;this.pa=l;this.Ea=x;this.Mm=H;this.ua=U;this.u$=ja;this.BGa=ya;this.Xa=
Va;this.la=hb;this.Ldb=yb;this.la.qig&&this.ai.KA(Object(F.a)(this,this.DB,"onSessionEnd"))}wb(){this.ia.ra(K.a.failover,rc.a.application,Object(F.a)(this,this.gsj,"handleFailover"),64)}DB(){this.Mm.isPaused||this.Mm.pause()}gsj(a,b,c,f,l){if(1===c||this.Ldb()||this.hma||this.BGa.Ghg)return 32;this.YT=l;if(!this.YT)return 8;this.Fs=Tc.a.yk("SeamlessFailover");this.Mm.pause();this.u$.suspend();this.pa.setSelection(null);this.Ea.Ed();this.hf.blockContent(this.ua.presentation,"SeamlessFailover",!0);
xa.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.FGa=new Date;this.BGa.jvh();this.ai.Udh(new Aj(!0,!0));u.AFrameworkApplication.fvb();this.vi.RFc(this.BXd());this.hma=!0;return 32}BXd(){return this.yGa=new ti.a(new Ll(this.YT),Object(F.a)(this,this.RGe,"onCheckUnBlockUISuccess"),Object(F.a)(this,this.QGe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}RGe(){this.BGa.eWc();this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.FGa).toString());
this.Fs.Va("CheckUnblockUISucceeded","True");this.Fs.Va("FailedMachineId",this.YT);this.Xa.Avb=this.YT;this.gQk()}QGe(a){if(142===a.ServerError.Code)return xa.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.YT,+new Date-+this.FGa),this.vi.RFc(this.yGa),!0;this.Fs.Va("DeploymengUIBlockingTime",(+new Date-+this.FGa).toString());this.Fs.Va("CheckUnblockUISucceeded","False");this.BGa.eWc();return this.atk(a)}gQk(){this.Fs.Va("ReStoreStatusAfterRefresh",
Tc.a.nf(new Date));this.Mm.Mlb();this.u$.resume();this.b3g(!0);u.AFrameworkApplication.Oib(df.a.Uh(180),am.a.unknown,am.a.fuc);kf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}atk(a){ia.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Jh);this.b3g(!1);
a.ServerError=Object.assign(new Ml.a,{Code:157,Source:0});return!1}b3g(a){this.hma=!1;this.yGa=this.YT=null;this.Fs&&(this.Fs.Va("Result",a?"Success":"Failed"),this.Fs.finish(),this.Fs=null);this.hf.fK(this.ua.presentation)}dispose(){this.la.qig&&this.ai.paa(Object(F.a)(this,this.DB,"onSessionEnd"))}}Object(m.a)(cj,"SeamlessFailoverHandler",null,[106]);var xi=d(220),jj=d(108),kj=d(1153),zh=d(290),Mn=d(827),dk=d(232),Se=d(625);class Bg{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.la=b;this.P9=c;this.sB=f;this.Pb=l;this.Ddb=!1}tv(a,b=!1,...c){this.v2b.apply(this,[df.a.Uh(a),this.P9.RTc(a),this.P9.$$d(a),this.P9.x8d(a),b].concat(c))}v2b(a,b,c,f,l=!1,...x){if(!xi.a.$w){var H=2,U=!1;if(a===df.a.Uh(83))this.la.tUj&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,H=3);else if(a===df.a.Uh(8)||a===df.a.Uh(256)||a===df.a.Uh(257)||a===df.a.Uh(291))H=0,U=!0;x&&0<x.length&&(f=String.format.apply(null,[f].concat(x)));this.At(new Se.a(a,
c,f,b,H),l,U)}}At(a,b=!1,c=!1){let f=a.Ckd;var l=df.a.xT(a.Im)?dk.a[df.a.YK(a.Im)]:"";xa.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Im,l,b,u.AFrameworkApplication.TE,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));if(this.njl(a))xa.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",
a.Im);else{l=new jj.StandardDialog;var x=null,H=!1,U=this.Pb.ka("UserCanWriteRelative");f&64&&xa.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.Pb.Ga("DocumentPermissions")||"");var ja=!1;f&64&&this.la.pptFileRecoveryEnabled&&(ja=!0);f&64&&!U&&xa.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");!ja&&f&64&&(c=!1,f=this.xDl(a));U=!!(f&4)&&
!(u.AFrameworkApplication.kDh||u.AFrameworkApplication.PQ);var ya=!!(f&2)&&u.AFrameworkApplication.Kda;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.Ar=ya||!!(f&1);f&8?(l.xd=0,x=Object(F.a)(this,this.Hkd,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Im.toString())?l.fP(kj.a.v3(a.title),kj.a.v3(a.message),x):(xa.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Im),l.Xe(1,ResourceStrings.L_Refresh),l.Gy(a.Im,kj.a.v3(a.title),
kj.a.v3(a.message),x,b)),H=this.Ddb=!0):ja?(xa.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Im),this.ia.processAction(K.a.repair,2)):ya&&U?(l.xd=4,l.Xe(1,c),l.Xe(2,ResourceStrings.L_Close),x=Object(F.a)(this,this.Yzk,"openOrCloseActionHandler"),this.Ddb=!0):U?(l.xd=0,l.Xe(1,c),x=Object(F.a)(this,this.Dgd,"openInClientActionHandler"),this.Ddb=!0):ya?(l.xd=0,l.Xe(1,ResourceStrings.L_Close),x=Object(F.a)(this,this.oui,"closeActionHandler"),this.Ddb=
!0):(c=!!(f&1)||0===f,l.Ar=c,l.xd=c?0:5);H||ja||(f&16&&f&32?(b||u.AFrameworkApplication.vp(a.Im),l.B0a=!1,l.Gx(kj.a.v3(a.title),kj.a.v3(a.message),a.icon,x)):l.Gy(a.Im,kj.a.v3(a.title),kj.a.v3(a.message),x,b));this.Ddb&&this.sB&&this.sB.closeSession(4);this.Ddb?kf.Health.instance.recordQosError(df.a.lja(a.Im),["NonDismissibleDialog"],!1,!1,!0,!0,null):kf.Health.instance.recordQosError(df.a.lja(a.Im),["DismissibleDialog"],!1,!1,!0,!1,null)}}get $Zc(){return this.Ddb}xDl(a){xa.a.J(512497105,801,15,
"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Im===df.a.Uh(8)||a.Im===df.a.Uh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}Dgd(a,b){xa.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.pch()}Yzk(a,b){xa.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.pch():this.ia.La(K.a.Nvb,2,zh.c)}oui(a,b){xa.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(K.a.Nvb,2,zh.c)}Hkd(a,b){xa.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(K.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}pch(){(new Mn.a(D.a.openInClient)).aie()}njl(a){return a.Im===df.a.Uh(83)&&(u.AFrameworkApplication.JL("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.mnl)||a.Im===
df.a.Uh(56)&&(u.AFrameworkApplication.JL("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.nnl)?!0:!1}}Object(m.a)(Bg,"ErrorDialog",null,[1303]);var Ci=d(282),jf=d(126),yi=d(515),Cl=d(1002),Ud=d(35);class ag extends Sys.EventArgs{constructor(){super();this.tCa=this.jC=0;this.message=this.title=null}}Object(m.a)(ag,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class Jf extends ag{constructor(a){super();this.ZRa=null;this.errorCode=a;this.jC=0}}Object(m.a)(Jf,
"OnBeforeHandleClientErrorEventArgs",ag,[]);class Gm extends ag{constructor(){super();this.jC=0}}Object(m.a)(Gm,"OnBeforeHandleServerErrorEventArgs",ag,[]);class Dc extends Sys.EventArgs{constructor(a,b,c){super();this.FO=a;this.$7j=b;this.uh=c}get podSessionId(){return this.FO}get mPc(){return this.$7j}get errorCode(){return this.uh}}Object(m.a)(Dc,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class Dl{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){this.Kve=!1;this.k9j=[8];this.ewe={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.P9=a;this.O9=b;this.gl=c;this.dwg=f;this.ia=l;this.Xa=x;this.Pb=H;this.Rb=U;this.kEb=ja;this.Uaf=!1;this.Mm=ya;this.sB=Va;this.So=yb;this.wj=Zb;this.Ce=hb}zs(a,b,c=null,f=!1){if(this.disabled)return ia.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.sB.Ejk();if(this.sB.e4)return ia.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,x=0,H=0,U=null;var ja=null;c&&(ja=new Gm,l=c(ja),x=ja.jC,H=ja.tCa,U=ja.title,ja=ja.message);l||(l=this.bwj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.cVi(b)&&(this.Uaf=!0,this.Mm.pause()),a?this.Gy.apply(this,[x,b,H,U,ja,f].concat(a)):this.Gy(x,
b,H,U,ja,f));return l}bwj(a,b){if(!a)return!1;ia.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return Ci.a.instance.xPe(Date.now()),Ci.a.X1c(u.AFrameworkApplication.userSessionId),u.AFrameworkApplication.Oib(df.a.Uh(153),am.a.unknown,am.a.fuc),({U1e:c}=Ci.a.instance.GDh()).returnValue&&ia.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.ASk(a.ExtraErrorParam[0]):ia.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.La(K.a.failover,2,a.ExtraErrorParam[0]):this.dwg.x3e(a.ExtraErrorParam[0],!0,this.Xa.podSessionId||"",1))||this.Gy(0,157,0,null,null),
!0;if(274===a.Code)return ia.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.So.instance&&!ha.a.Wa(this.Xa.FPc))return ia.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.So.instance.L2e(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.Pb.ka("685")&&c.toLowerCase()!==this.Xa.podSessionId.toLowerCase()?(xa.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.Pb.ka("884")&&this.Kve?(xa.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.dwg.x3e(a.ExtraErrorParam[0],
!1,this.Xa.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.Pb.ka("560")&&229===a.Code||this.Pb.ka("914")&&this.So.instance&&this.So.instance.LVi(a.Code)){if(b!==this.Xa.podSessionId)return xa.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;if(this.Pb.ka("914")&&this.So.instance&&this.So.instance.k_)return xa.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;xa.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.kEb.HOk(new Dc(this.Xa.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Rb.notificationBar.LCa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.Pb.ka("IsAutomation")?a.displayTimeoutSeconds=this.Pb.Bc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:xa.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Rb.notificationBar.Zh(a),!0;if(238===a.Code&&this.Pb.ka("561")&&this.So.instance&&this.So.instance.k_)return xa.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return xa.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.wwh(a.Code,null),!0;if(104===a.Code)return b=2===this.wj.Kca,a.Code=b?56:105,xa.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",dk.a[a.Code]),this.Gy(0,a.Code,0,
null,null),!0;if(this.oKj(a.Code)&&2!==this.Pb.state)return xa.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.Gy.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Gy.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}cH(a,b){if(this.disabled)return ia.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,x=null,H=null;var U=null;b&&(U=new Jf(a),c=b(U),f=U.jC,l=U.tCa,x=U.title,H=U.message,U=U.ZRa);c||(c=!1);c||(U?this.Gy.apply(this,[f,a,l,x,H,!1].concat(U)):this.Gy(f,a,l,x,H));return c}Gy(a,b,c,f,l,x=!1,...H){0===a&&(a=this.P9.Cgj(b));0===c&&(c=this.P9.RTc(b));f||(f=this.P9.$$d(b));l||(3===b&&this.Pb.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.Y7i():(xa.a.J(512263007,
801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.P9.x8d(b)));const U=()=>{this.Ikl.apply(this,[a,b,c,f,l,x].concat(H))};2===this.Pb.state?U():this.Pb.gf(U)}Y7i(){xa.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+u.AFrameworkApplication.b2b);return u.AFrameworkApplication.b2b&&this.ewe[u.AFrameworkApplication.b2b]?this.ewe[u.AFrameworkApplication.b2b]:this.ewe.Generic}Ikl(a,b,c,f,l,x,...H){if(2===a){let U;(U=this.gl).v2b.apply(U,
[b,c,f,l].concat(H))}else 3===a?this.wwh.apply(this,[b].concat(H)):this.ysa.apply(this,[df.a.Uh(b),c,f,l,x].concat(H))}ysa(a,b,c,f,l,...x){0===b&&(b=this.P9.RTc(df.a.YK(a)));if(Cl.GraphSpaceRootReplicator.Elg(df.a.YK(a))&&x&&0<x.length){this.Xa.Eld=x[0];var H=new Ka.a;for(var U=1;U<x.length;U++)H.add(x[U]);x=H.toArray()}H=Object.assign(new yi.a,{Type:6,Token:this.Ce.od.Xlc,Data:{["Reason"]:"FatalError",["ErrorName"]:df.a.lja(a)}});Ud.a("PPT.BootstrapperMessageNewValues")&&(H.MessageId=jf.a.ZFh,U=
{Reason:"FatalError"},U.ErrorName=H.Data.ErrorName,H.Values=U);window.parent.postMessage(xd.c(H),"*");ia.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let ja;(ja=this.O9).v2b.apply(ja,[a,b,c,f,l].concat(x))}ASk(a){Od.a.openWindow(1,a)}get xka(){return this.Kve}set xka(a){this.Kve=a;xa.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get d1d(){return this.Uaf}ePd(){}CPd(){}wwh(a,...b){const c=df.a.Uh(a);xa.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");u.AFrameworkApplication.vp(c);kf.Health.instance.recordQosError(df.a.lja(c),["SilentFailure"],!1,!0,!0,!1,null)}oKj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}cVi(a){return Array.contains(this.k9j,a)?!0:!1}}Object(m.a)(Dl,"GlobalErrorHandler",null,[1306,1336]);class Nl{constructor(a){this.idc=!1;this.TX=null;this.rt=a}get Ghg(){return this.idc}jvh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.idc||(this.TX=new vc.a,this.TX.xd=5,this.TX.message=kj.a.v3(b),this.TX.Ar=!1,xa.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.TX.Qoa(kj.a.v3(a),null,null),this.idc=!0,this.rt.yzf(!0))}eWc(){this.idc&&(this.TX.hide(),this.idc=!1,this.TX=null,this.rt.yzf(!1))}}Object(m.a)(Nl,"DeployingDialog",null,[1301]);var Xh=d(1013),th=d(435),Li=d(646),$g=d(422),L=d(159),M=d(63),Ja=d(903);class pb{constructor(a,b,
c,f,l,x,H,U){this.qea=this.Qf=this.DCb=this.xCb=null;this.N4c=!1;this.e5c=this.Sad=this.I2c=null;this.hma=!1;this.ua=a;this.Vb=b;this.Iq=c;this.Tb=f;this.V3c=l;this.Jwg=x;this.So=H;this.qik=U}get xi(){return this.Vb.xi}UJb(a,b,c,f,l,x){this.hma||(this.hma=!0,this.N4c=c,this.Qf=b,this.Sad=l,this.e5c=x,this.So.instance&&this.So.instance.JNd("abortedOnRefreshDoc"),this.Jwg&&this.Jwg(),this.V3c.Db(this.WFi(a,f)))}WFi(a,b){let c=this.ua.Ba&&!M.a.ix(this.ua.Ba.Cb)?this.ua.Ba.Cb:M.a.empty;c=b?M.a.empty:
c;this.Qf.Va("CurrentActiveSlideId",c.toString());this.I2c=M.a.ix(c)?M.a.empty:c;return new ti.a(new Ja.a(c,a),Object(F.a)(this,this.vtk,"onGetCellSuccess"),Object(F.a)(this,this.utk,"onGetCellFailed"),this.qik?null:Object(F.a)(this,this.lIl,"validateResponse"))}lIl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}vtk(a){this.Qf.Va("GetCells",a.Jh);a=new Xh.a(null,Object(F.a)(this,this.dCj,"inboundSetup"),
a);a.Oi=!this.N4c;a.Pl("RefreshUIOperation");a.run()}utk(a){this.Qf.Va("GetCells",a.Jh);200!==a.HttpStatusCode&&this.Qf.Va("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.e5c&&this.e5c(a))return!0;a.ServerError=Object.assign(new Ml.a,{Code:294,Source:0});kf.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}dCj(a,b){(this.qea=this.Vb.Dn)&&this.qea.VM&&this.qea.VM.h2c();this.qea&&this.qea.lp&&(this.qea.VM=new Li.a(me.a.instance,"FailoverView"));
this.Qf.Va("InboundSetupStartTime",Tc.a.nf(new Date));if(Ud.a("UseBuildIncrementalInboundOperation"))this.Vb.Ba=null,this.xCb=this.xi.contentReplicator.rAf(b);else{const c=b.Cells[b.Cells.length-1],f=this.xi.zi.ax.id;c.RevisionList[0].BaseId=L.a(f);this.Vb.Ba=null;this.xCb=new th.a(c,f,!1,new Date,b.Jh,!1,!1,!1)}this.DCb=this.Iq.me(3);this.DCb.kd(this.ua.presentation);this.N4c&&this.DCb.TU(a);a.Wg(Object(F.a)(this,this.Bka,"inboundIncrementally"));this.Qf.Va("InboundSetupEndTime",Tc.a.nf(new Date));
return!0}Bka(a){this.Qf.Va("InboundIncrementallyStartTime",Tc.a.nf(new Date));this.xi.contentReplicator.Bka(this.xCb,new Date);this.xCb.GQ&&(this.DCb.dispose(),a.Wg(Object(F.a)(this,this.d9k,"setActiveSlideAndRender")),this.DCb=this.xCb=null,this.Qf.Va("InboundIncrementallyEndTime",Tc.a.nf(new Date)));return!0}d9k(a){this.Qf.Va("SetActiveSlideAndRenderStartTime",Tc.a.nf(new Date));a.Wg(Object(F.a)(this,this.FYi,"finishRefreshDoc"));if(M.a.empty.equals(this.I2c))return this.Qf.Va("SetActiveSlideAndRenderEndTime",
Tc.a.nf(new Date)),!0;const b=this.Tb.zl(this.I2c);if(!b)return this.Qf.Va("SetActiveSlideAndRenderEndTime",Tc.a.nf(new Date)),!0;const c=this.Iq.me(3);try{c.kd(b),this.N4c&&c.TU(a),this.Vb.Ba=b}finally{c&&c.dispose()}this.Qf.Va("SetActiveSlideAndRenderEndTime",Tc.a.nf(new Date));return!0}FYi(){this.Sad&&this.Sad();this.qea&&this.qea.VM&&(this.qea.VM.h2c(),this.qea.VM=new $g.a);this.j1();return!1}j1(){this.hma=!1;this.e5c=this.Sad=this.I2c=this.qea=this.Qf=this.DCb=this.xCb=null}}Object(m.a)(pb,"RefreshDocExecutor",
null,[1304]);class Tb{x8d(a){switch(a){case 1:a=ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;
case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;
break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;
break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;
break;case 28:a=ResourceStrings.errorMessage_NoLicense;break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 39:a=ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;case 450:a=ResourceStrings.errorMessage_UploadedVideoTooLarge;break;default:a=ResourceStrings.errorMessage_Unknown}return a}$$d(a){switch(a){case 1:a=
ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;
break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;
break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;
break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;
break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;
break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 450:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}RTc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=
6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=
6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=
116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;
case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=
8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;case 450:a=49;break;default:a=0}return a}Cgj(a){switch(a){case 5:a=
1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;
case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(m.a)(Tb,"DefaultErrorMapping",null,[1302]);var Wc=d(708);class sd{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Zb(a){this.K=a;a.register(1301,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().oa(()=>new Nl(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1302,"PowerPointWebEditor.IErrorMapping").ma().oa(()=>new Tb);a.register(1303,
"PowerPointWebEditor.IErrorDialog").ma().oa(()=>new Bg(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new mc.a(()=>new Wc.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),
a.resolve("PowerPointWebEditor.IReplicationTimerFactory").A1b(a.resolve("Box4.IReplicationParameters")),Db.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Ug));a.register(1304,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().oa(()=>new pb(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),
b.value,u.AFrameworkApplication.XRf,this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));a.register(1305,"PowerPointWebEditor.IDocRefreshHandler").ma().oa(()=>new Fm(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),
()=>u.AFrameworkApplication.Ug,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(cj,"PowerPointWebEditor.SeamlessFailoverHandler").ma().oa(()=>new cj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.Ug));
a.register(1306,"PowerPointWebEditor.IDelayedErrorHandler").ma().oa(()=>new Dl(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),
this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").wb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").wb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){z.a.instance.Dc(new sd)}}
Object(m.a)(sd,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var Ed=d(1222),ee=d(87),kb=d(39);class cf{constructor(){this.font=null;this.oZc=this.isValid=!1}}Object(m.a)(cf,"EmbeddedFontClientStatus",null,[]);class Tf{constructor(a,b,c,f,l,x){this.Mbd=this.Qcb=null;this.Ha=a;this.ly=b;this.uQg=c.yd(7);this.oc=f;this.NEb=l;this.lz=x;this.uQg.jk(Object(F.a)(this,this.Tgb,"onPresentationPropertyChanged"));this.ly.bFa(()=>{this.C4e(0)})}dispose(){this.uQg.Cm(Object(F.a)(this,this.Tgb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.Qcb}get LIh(){return this.Mbd}U5d(a){return this.isInitialized?
this.Qcb.Hb(a)?this.Qcb.ga(a):null:null}createFontUrl(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(xa.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.C4e(2),this.isInitialized){var b=this.lz.eG(a);if((b=this.U5d(b))&&!b.oZc&&b.isValid){b.font.Name!==a&&xa.a.J(41296397,820,15,"Name is not identical");a=da.FontUtils.v5b(a);const c=this.NEb.resolve(ee.a.f_i,Tf.o_i(b.font));ha.a.Wa(a)||ha.a.Wa(c)?xa.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.lz.lQa(a,String.format("url('{0}')",
c)),b.oZc=!0)}}else xa.a.J(41296401,820,10,"Dictionary is not initialized")}Tgb(a,b){b&&b.node&&b.property&&b.property===kb.a.embeddedFonts&&this.C4e(1)}C4e(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(xa.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.oc.U8i()){this.Qcb?xa.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.Qcb=new Yc.a,xa.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(ha.a.Wa(b.Name)){xa.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=Tf.sNj(b);const c=this.lz.eG(b.Name),f=this.U5d(c);f&&(f.isValid===a||f.oZc)||this.Qcb.$(c,Object.assign(new cf,{font:b,isValid:a,oZc:!1}))}this.Mbd=Tf.RHi(this.Qcb);this.lz.uDl(this.Mbd);da.FontUtils.s5h(this.Mbd,Object(F.a)(this,this.createFontUrl,"createFontUrl"))}else xa.a.J(41296403,820,10,"EmbeddedFonts is null")}static o_i(a){return JSON.stringify(a)}static sNj(a){return!ha.a.Wa(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static RHi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new Ed.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(m.a)(Tf,"EmbeddedFontsManager",null,[1291,106]);class zg{}zg.loading="loading";zg.loaded="loaded";zg.error="error";Object(m.a)(zg,"FontFaceStatus",null,[]);class ci{constructor(){this.s7c=this.dsg=!1;this.hve=null;this.init()}get Emg(){return this.s7c}load(a){return new Promise((b,c)=>{this.s7c&&!ha.a.Wa(a)||c([]);let f;f=this.dsg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.hve.load(f).then(l=>{for(const x of l)ha.a.Wa(x.family)||x.status===zg.loaded||xa.a.J(40429085,801,15,"Font load status {0}",x.status);l.length||xa.a.J(41494563,801,15,"No font resolved");b(l)},l=>{xa.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.hve=a&&a.fonts?a.fonts:null;this.s7c=!!this.hve;this.dsg=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");xa.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.s7c)}}Object(m.a)(ci,"FontFaceSetObserver",null,[1289]);class ah{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.cdb=a}gee(a){return a?a:{}}$de(a){return a?a:()=>{}}BJh(a,b,c,f,l,x,H){if(!a)return[];b=this.gee(b);c=this.$de(c);f=this.gee(f);l=this.$de(l);x=this.gee(x);H=this.$de(H);const U=[];for(const ja of a)ja in f?(l(ja),U.push(this.cdb.load(String.format("{0}_MSCustomFont",ja)))):ja in b?(c(ja),U.push(this.cdb.load(String.format("{0}_MSFontService",
ja)))):ja in x&&(H(ja),U.push(this.cdb.load(String.format("{0}_EmbeddedFont",ja))));return U}}Object(m.a)(ah,"FontsObserver",null,[1290]);class Qe{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}Zb(a){this.K=a;this.K.register(1289,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().oa(()=>new ci);this.K.register(1290,"PowerPointWebEditor.Fonts.IFontsObserver").ma().oa(()=>new ah(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1291,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().oa(()=>
new Tf(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){z.a.instance.Dc(new Qe)}}Object(m.a)(Qe,"PPTWebEditorFontsPackage",
null,[2,3]);var Di=d(431);class pk{Duh(){return!1}}Object(m.a)(pk,"DefaultParagraphViewElementSetUpdateStrategy",null,[1427]);var ch=d(222),hf=d(1077),Ij=d(244);class Kf extends ch.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){super(a,b,l);this.qAc=null;this.kUb=Ib.a.nil;this.dcf=this.NBd=!1;this.lZ=this.kZ=this.onb=this.nnb=-1;this.jCd=this.ETb=!1;this.cBc=this.J1c=this.JHd=this.nmf=this.mpb=null;this.Xrd=0;this.E8e=this.H2a=this.Odf=null;a.VM.b_a(b);this.CVa=c;this.KHd=x;this.$Rh=H;this.ZRh=U;this.SXh=
ja;this.fd=ya;this.ASh=Va;this.aw=hb;this.y1a(!0);this.LWe(!0);this.nEd=new mc.a(Object(F.a)(this,this.NLi,"determineIsShapesAndTextboxesEnabled"));this.nt=[];this.HNa=new Ka.a;this.e9e=new Ka.a;this.wgb();this.Qc.Mh&&(b=this.Qc.Mej(this.gb))&&(b.isSelected&&(this.FR.qGb=!0),b.g9&&(this.ETb=!0),this.FR.qGb&&(this.nnb=b.mja,this.onb=b.nja,this.kZ=b.MS,this.lZ=b.Ora));a.lp&&(a=Object(oa.a)(1050,a))&&a.XPk(this.gb);this.vVb=f;this.CHd=yb}get zBk(){return this.vVb}get OJe(){return this.KHd}get ujh(){return this.nmf||
(this.nmf=this.$Rh())}get Ugd(){if(!this.JHd){const a=this.ZRh();a&&(this.JHd=a.vOl())}return this.JHd}get Tf(){return this.fd}get u_(){return this.ASh}get Iog(){return this.kUb}set Iog(a){this.kUb=a}get jAj(){return this.HNa}get N8g(){return this.Hi?Ca.a.nZf(this.Hi,!1):0}get Hi(){return this.mpb}get W$a(){return this.Odf}y1a(a){let b=!1;this.Tgl(a)&&(a=this.F7a(),this.nc(a),this.qAc=null,this.kUb=Ib.a.nil,b=!0);this.Tf.gg&&this.gb.xlb?Sys.UI.DomElement.addCssClass(this.htmlElement,Bc.T3):Sys.UI.DomElement.containsCssClass(this.htmlElement,
Bc.T3)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Bc.T3),this.htmlElement.removeAttribute("title"));return b}Tgl(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Hi||"p"!==ha.a.qg(this.Hi.tagName)}F7a(){this.mpb=this.Md.hp(va.a.p);this.mpb.className="Paragraph";this.Odf=this.Md.hp(va.a.span);this.W$a.className="WACImageGroupContainer";return this.Md.Wl?this.mpb:this.KKl()}KKl(){const a=this.Md.hp(va.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.mpb);this.Xo(this.mpb);return a}JU(a){super.JU(a);if(this.gb.WZ)return a=this.gb.WZ.sc(a.W1).kwc,this.gb.WZ=null,new Ij.a(a.ena,a.minWidth,a.fna);let b;b=this.E8e;a.Bb(88)&&(b=Ij.a.max(b,a.Xq.pLa),a.zc());return b}Ky(a){if(u.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.J1c=null,this.Hi)){const b=this.Hi.getElementsByClassName("LineBox");if(b&&0<b.length){this.J1c=Array(b.length);for(let c=0;c<b.length;c++)this.J1c[c]=Ca.a.yv(b[c]).length}}this.y1a(!1)&&
(a.currentNode.anchor.fk(this.Ma,8),a.parentNode.anchor.fk(this.Ma,8),this.qAc=null);super.Ky(a);this.uFi(a,this.Hi)}uFi(a,b){var c=this.gb;if(this.Qc.Mh){var f=sa.InteractiveViewManager.instance.Pd;f&&f.Ma===this.Qc.Ma&&f.editingView.Wl&&f.editingView.Dg===this.gb&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,Kf.Pbg):Sys.UI.DomElement.removeCssClass(this.htmlElement,Kf.Pbg)}if(c.WZ)c=c.WZ.sc(a.W1).htmlElement,Ca.a.X0b(c,b),b=this.Qc,b.Mh&&b.KF&128&&(this.gb.WZ=null);else{a=
this.Nej();f=Ab.StyleReader.q2f(a);Ab.StyleReader.E0c(a)&&f?(Hb.d(b,Ba.a.role,Cc.a.$xf),Hb.d(b,Ba.a.byf,f)):(b.removeAttribute(Cc.a.ef),b.removeAttribute(Cc.a.tZb));var l="";if(P.a.instance.ga(71)||P.a.instance.ga(77))l=this.b7i(c);f=a=null;var x=Sb.ParagraphReader.a7f(c,P.a.instance.ga(53),P.a.instance.ga(71),P.a.instance.ga(77),P.a.instance.ga(54));if(this.dcf||l!==this.qAc||this.kUb!==c.CFe){a="WindowText";f="transparent";this.qAc=l;this.dcf=!1;l="";let U=null;"P"!==b.tagName&&x.I$a&&(U=da.FontUtils.jja(x.fontName));
if(x.P3){var H=x.fontColor;H!==Ib.a.auto&&(a=Ib.a.vI(H))}P.a.instance.ga(49)||(x.M$a&&(H=x.KR,H!==Ib.a.auto&&(f=Ib.a.vI(H))),x.QTa&&(H=x.highlight,H!==Ib.a.auto&&(f=Ib.a.vI(H))));if(H=Sb.ParagraphReader.language(this.gb))if(H=Ya.a.xe(H))b.setAttribute("xml:lang",H.name),b.setAttribute("lang",H.name);b.style.fontWeight=x.isBold?"bold":"normal";b.style.fontStyle=x.isItalic?"italic":"normal";b.style.verticalAlign="baseline";x.isSuperscript&&(b.style.verticalAlign="super");x.QF&&(b.style.verticalAlign=
"sub");x.iE&&(l="underline");if(x.PF||x.A_)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=U?U:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";x.LTa?1===x.capitalization?b.style.fontVariant="small-caps":2===x.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.kUb=c.CFe;P.a.instance.ga(49)&&(x.M$a&&(l=x.KR,l!==Ib.a.auto&&(f=Ib.a.vI(l))),x.QTa&&(x=x.highlight,x!==Ib.a.auto&&(f=Ib.a.vI(x))));this.gb.properties.sa($a.a.ehg,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Cc.a.Fra,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Cc.a.Fra),f?(b.style.backgroundColor=f,Kf.Btf(f,b)):P.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.CFe!==Ib.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,Kf.Btf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=fe.OutlineElementReader.vm(Ta.OutlineElementNavigator.UA(this.gb));this.Qc.Wl&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(Sb.ParagraphReader.HN(this.gb)){case 1:b.style.textAlign="left";b.style.elb="";break;case 2:b.style.textAlign="center";b.style.elb="";break;case 3:b.style.textAlign="right";b.style.elb="";break;case 6:b.style.textAlign="justify";b.style.elb="auto";break;case 7:b.style.textAlign="justify";b.style.elb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.elb="kashida";break;case 13:b.style.textAlign="justify";b.style.elb="inter-cluster";break;default:b.style.textAlign="",b.style.elb=""}4===Oc.App.mode&&P.a.instance.ga(86)&&B.a.Ej&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");P.a.instance.ga(54)&&(Hb.d(b,Ba.a.Hx,this.gb.sa(ab.a.io,0)),Hb.d(b,Ba.a.tBk,this.gb.id.toString()));this.OJe.Hqh(this.gb,
b,c,this.Ma)}}Nej(){var a=P.a.instance.ga(71)?(a=Ab.StyleReader.bE(this.gb))?Ab.StyleReader.wQ(a):P.a.instance.ga(61)?Ab.StyleReader.zMa:Ab.StyleReader.Woa:Ab.StyleReader.Woa;return a}b7i(a){let b="";var c=Ab.StyleReader.bE(a);c&&(b+=c.id);Ab.StyleReader.nr&&({tableStyle:a,q7a:c}=Ab.StyleReader.nr.j$a(a),a&&(b+=a.id),c&&(b+=c.id));return b}Yaa(){this.gb.Jda(this.Ma,16,!0)}wgb(){this.nEd.value&&this.gb.X$a.wgb()}gK(a){if(!this.knl()){this.wgb();var b=this.gb;this.SEf();Ca.a.Au(this.Hi);Ca.a.Au(this.W$a);
var c=this.Hi;c.style.minHeight="";this.nt=[];this.Xrd=0;var f=new Ka.a,l=0;a&&(l=this.pgi(a,b,f,c,l));if(!this.jnl()){a=!1;var x=this.htmlElement.parentNode,H=this.htmlElement.nextSibling;x&&(this.ioc(x,this.htmlElement),a=!0);this.Ugd&&this.Ugd.ONl();var U=l;l=this.zBk.C_k(b,this.Md,c,this.jAj,f,Object(F.a)(this,this.G4g,"onOverHyperlink"),Object(F.a)(this,this.C4g,"onOutHyperlink"),Object(F.a)(this,this.MM,"takeOwnershipOfSubtree"),Object(F.a)(this,this.Xo,"takeOwnership"),ca.a.wOc,this.Iog,l,
this.nnb,this.onb,this.ETb,Kf.F0c,!!this.FR&&this.FR.qGb,this.NBd,Oc.App.UR.HXe,fe.OutlineElementReader.vm(Ta.OutlineElementNavigator.UA(this.gb)));if(!u.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.aw.uEf(b,f))this.aw.pDh(c,this.Md,l.vrf,b,U,f,qd.a.instance.Na?qd.a.instance.Na.mb:null,this.J1c)||this.Md.lp||this.aw.YHh(b);this.nt=f.toArray();this.cBc=l.vZg;this.e9e=l.FEf;this.NBd=l.Fbg;this.Ugd&&this.Ugd.JNl(this.N8g);this.ujh&&this.ujh.MNl(c);this.HGh();this.jCd=
!0;a&&x.insertBefore(this.htmlElement,H);!this.Qc.Wl&&x&&"li"===ha.a.qg(x.tagName)&&this.vgi(b,x);this.Qc.Wl||this.aw.oHf(c)}}}vgi(a,b){if(rb.ListReader.sna){if(b=this.gTc(a)){const c=b.sc(this.Qc.Ma);if(c){const f=Ca.a.gda(this.htmlElement,"Paragraph");this.gBk(a)?(a=(a=this.Bej(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):Ca.a.dOd(f,c.htmlElement);b.anchor.fk(this.Ma,64)}}}else this.CVa.mJf(b,a,this.Ma)}Bej(a){for(let b=0;b<a.children.length;b++){const c=
a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}gBk(a){if(!a)return!1;a=a.Ra;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Wq:!1:!1}gTc(a){const b=new tb.GraphIterator;b.set(a);return b.$e()?(Ta.OutlineElementNavigator.Re(b),this.Tf.gg&&!b.NI(4)?b.Bb(31):b.Bb(4)):null}pgi(a,b,c,f,l){a=ke.a.nb(a.W1,a.currentNode);if(!a.Gi())return l;let x=0,H=!1,U=0,ja=0,ya=0,Va=!1;const hb=Sb.ParagraphReader.YW(b),yb=this.nEd.value;do{const Zb=a.Xq.htmlElement;Sys.UI.DomElement.containsCssClass(Zb,
ca.a.fW)?(yb&&b.X$a.mOl?(Va||(rb.ListReader.nx&&hb||b.X$a.eOl(this.W$a),f.appendChild(this.W$a)),this.W$a.appendChild(Zb)):f.appendChild(Zb),V.a.Qv(Zb,ca.a.TFa,l++),c.add(Zb),this.Qc.Mh&&({cmk:U,Fkk:ja,Ekk:ya}=Kf.ybl(b,Zb,yb,a,Va,U,ja,ya)),H=Va=!0):f.appendChild(Zb)}while(a.CEa());yb?this.Qc.Wl?this.TDl():(this.KGh(ya+6,ja+6),x=ja+6):x=ja-U+6;H&&!Oc.App.instance.zBj&&this.Qc.Mh&&f.clientHeight<x&&(f.style.minHeight=x+"px");return l}KGh(a=0,b=0){this.nEd.value&&this.gb.X$a.dOl(this.W$a,a,b)}Bud(){const a=
new ke.a(this.Ma);a.set(this.gb);a.$e();Ta.OutlineElementNavigator.Re(a);rb.ListReader.nx&&(this.OJe.Hqh(this.gb,this.Hi,fe.OutlineElementReader.vm(a.currentNode),this.Ma),this.CVa.pEl(a))}HGh(){this.u_.nkc(this.gb,this.Hi)}NLi(){const a=Db.a.instance.ub("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.lZ=this.kZ=this.onb=this.nnb=-1)}get mja(){return this.Qc.Wl?this.gb.sc(this.Qc.If.Ma).mja:this.nnb}set mja(a){this.nnb!==
a&&(this.nnb=a,this.Koa(16),this.gb.anchor.fk(this.Qc.Ma,16))}get nja(){return this.Qc.Wl?this.gb.sc(this.Qc.If.Ma).nja:this.onb}set nja(a){this.onb!==a&&(this.onb=a,this.Koa(48),this.gb.anchor.fk(this.Qc.Ma,48))}get MS(){return this.Qc.Wl?this.gb.sc(this.Qc.If.Ma).MS:this.kZ}set MS(a){this.kZ!==a&&(this.kZ=a,this.Koa(16),this.gb.anchor.fk(this.Qc.Ma,16))}get Ora(){return this.Qc.Wl?this.gb.sc(this.Qc.If.Ma).Ora:this.lZ}set Ora(a){this.lZ!==a&&(this.lZ=a,this.Koa(48),this.gb.anchor.fk(this.Qc.Ma,
48))}get g9(){return this.Qc.Wl?this.gb.sc(this.Qc.If.Ma).g9:this.ETb}set g9(a){this.ETb!==a&&(this.ETb=a,this.Koa(16),this.gb.anchor.fk(this.Qc.Ma,16))}get NSf(){return this.nt[this.nt.length-1]}dispose(){this.wWk();super.dispose();this.SEf();for(let a of this.e9e)a.mPf(this.Md)}wWk(){if(this.H2a&&this.htmlElement)for(let a of this.H2a)a.vWk(this.htmlElement)}vna(){super.vna();this.NBd&&this.Qc.notify(2)}xud(a){const b=u.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Qc.sJe.R8d(this.gb);
this.CHd.ijh(c,this.H2a,this,this.htmlElement,b,this.wil());this.H2a=c;this.jCd||this.HGh();this.jCd=!1;super.xud(a)}Koa(a){this.SXh.Duh(this.gb)||super.Koa(a)}knl(){if(this.xjg()){const a=this.Qc;if(1!==a.editingView.jub)return a.ZYd=!0}return!1}jnl(){return this.Qc.Wl&&nb.SelectionEditor.dua(qd.a.instance.Na.mb)?!0:!1}TDl(){var a=this.gb.sc(this.Qc.If.Ma);a&&(a=Sys.UI.DomElement.getBounds(a.W$a),this.KGh(a.width,a.height))}wil(){return!this.xjg()&&!this.Qc.Wl}xjg(){if(sa.InteractiveViewManager.instance.Pd!==
this.Qc)return!1;const a=this.Qc.editingView;return a.Dg===this.gb&&2===a.mode}rRj(){const a=this.getBounds(),b=Od.a.$h(this.Qc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}VDe(a){a.tkh(this);0<this.Xrd&&a.e1k(this)}get DYa(){return this.Hi}$Gh(a){this.E8e=new Ij.a(0,a,0)}getBounds(){const a=N.a.osb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Qc.Mh?this.gb.id.toString():"");this.OJe.Rbi(this.gb,a,fe.OutlineElementReader.vm(Ta.OutlineElementNavigator.UA(this.gb)),
this.Qc.Ma);return a}G4g(a){ch.a.uel(a.Ec,a.rD);if(Oc.App.t_b){const b=a.Ec,c=b.querySelector(".NormalTextRun")||b;P.a.instance.ga(8)||a.ZZ?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,Kf.uEe);hf.a.instance().Q9h(Object(F.a)(this,this.dHe,"onCtrlKeyDown"));hf.a.instance().R9h(Object(F.a)(this,this.fHe,"onCtrlKeyUp"))}return!0}C4g(a){Sys.UI.DomElement.removeCssClass(a.Ec,Kf.uEe);hf.a.instance().lih(Object(F.a)(this,this.dHe,"onCtrlKeyDown"));hf.a.instance().mih(Object(F.a)(this,
this.fHe,"onCtrlKeyUp"));return!0}SEf(){for(let a=0;a<this.HNa.count;a++)Oc.App.Kb.TR.yb(ta.a.gna,this.HNa.ga(a),Object(F.a)(this,this.G4g,"onOverHyperlink")),Oc.App.Kb.TR.yb(ta.a.hna,this.HNa.ga(a),Object(F.a)(this,this.C4g,"onOutHyperlink")),hf.a.instance().lih(Object(F.a)(this,this.dHe,"onCtrlKeyDown")),hf.a.instance().mih(Object(F.a)(this,this.fHe,"onCtrlKeyUp"));this.HNa.clear();if(this.cBc){for(let a of this.cBc)Oc.App.Kb.TR.yb(a.eventName,a.Ec,a.handler);this.cBc=null}}dHe(){this.wya("pointer")}fHe(){this.wya("text")}wya(a){for(let b=
0;b<this.HNa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.HNa.ga(b),Kf.uEe)){const c=this.HNa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get F0c(){return!!qd.a.instance.Na&&!!qd.a.instance.Na.mb&&qd.a.instance.Na.mb.F0c}static Btf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static ybl(a,b,c,f,l,x,H,U){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.X$a.MMl(f.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<x)x=b.y;if(!l||a>H)H=a;b=b.x+b.width;if(!l||b>U)U=b;return{cmk:x,Fkk:H,Ekk:U}}}Kf.Pbg="HiddenParagraph";Kf.uEe="MouseIsOn";Object(m.a)(Kf,"ParagraphViewElement",ch.a,[477,1429,456,351,106]);class ne extends ch.a{constructor(a,b,c,f,l,x){super(a,b);this.Vg=this.fd=this.Kba=this.KHd=null;rb.ListReader.sna?(this.OOf(),this.LWe(!0),this.Kba=c,this.KHd=l,this.fd=x,this.Vg=f,this.y1a(!0)):(this.LWe(!1),a=this.Md.hp(va.a.span),a.className=
"ListGhost",this.nc(a))}y1a(a){if(rb.ListReader.sna){var b=this.K4f(this.gb);a&&(a=this.XXd(),this.nc(a),(b=Object(oa.a)(Kf,b.sc(this.Qc.Ma)))&&b.htmlElement&&(b=b.Hi))&&((a=Ca.a.j5b(b,ne.Lbb))?b.replaceChild(this.htmlElement,a):Ca.a.dOd(b,this.htmlElement))}}get One(){return Ca.a.j5b(this.htmlElement,ne.Zac)}Ky(){this.y1a(!1);if(!this.Qc.Wl&&rb.ListReader.sna)if(this.fd.gg)this.lbl(this.htmlElement,this.One,this.gb);else{const a=this.Kba.UAb(this.gb);this.One.innerText=a}}gK(a){this.Qc.Wl||rb.ListReader.sna&&
a.currentNode.anchor.fk(this.Ma,64)}VDe(a){rb.ListReader.sna&&a.tkh(this)}get DYa(){return this.htmlElement}$Gh(){}Bud(){this.mbl()}t3f(){return-1}lbl(a,b,c){var f=this.Vg.c8d(c);if(f)if(12!==f.type)Fa.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Ra,x=l?l.last.Fo:null;l=l?l.last.yp:null;var H=f.xlb,U=f.LIb,ja=f.H8();f=!!H&&U.Y0f(ja).Sa(ab.a.listID);H=null;f&&(H=U.Sa(ab.a.listID)&&ja.Sa(ab.a.listID)?3:U.Sa(ab.a.listID)?2:1);U=this.Kba.UAb(c);
c=this.Kba.UAb(c);x=!!x||f&&(1===H||3===H);l=!!l||f&&(2===H||3===H);H=!x&&!l&&""!==U&&U!==c;for(ja=!x&&!l&&!H;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,Bc.Mne);Sys.UI.DomElement.removeCssClass(a,Bc.T3);if(ja)b.innerText=c;else{if(l||H)ja=Jc.a.createElement(b.ownerDocument,va.a.span),Sys.UI.DomElement.addCssClass(ja,Bc.nBh),ja.innerText=U,b.appendChild(ja);if(x||H)U=Jc.a.createElement(b.ownerDocument,va.a.span),Sys.UI.DomElement.addCssClass(U,
Bc.pBh),U.innerText=c,b.appendChild(U);x||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Bc.Mne);f&&Sys.UI.DomElement.addCssClass(a,Bc.T3)}}else Fa.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}K4f(a){if(!a)return null;const b=new tb.GraphIterator;b.set(a);b.$e();return Ta.OutlineElementNavigator.Re(b)?b.Bb(2):null}XXd(){const a=this.Md.hp(va.a.span);Sys.UI.DomElement.addCssClass(a,ne.Lbb);this.JLc(a);return a}JLc(a){const b=Jc.a.createElement(a.ownerDocument,
va.a.span);Sys.UI.DomElement.addCssClass(b,ne.Zac);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}mbl(){if(!this.Qc.Wl){var a=this.K4f(this.gb),b=a.sc(this.Qc.Ma).htmlElement.parentNode;!this.Qc.Wl&&b&&"li"===ha.a.qg(b.tagName)&&this.Kba.YGh(b,a,this.Ma,this.One,!1)}}}ne.Lbb="ListMarkerWrappingSpan";ne.Zac="ListMarker";Object(m.a)(ne,"NumberListViewElement",ch.a,[1429,456,351,106]);var xf=d(391),wn=d(1096);class Nn{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(m.a)(Nn,"ListMarkerOffset",null,[]);class en{constructor(){this.Tak="ListMarkerMeasuringPad";this.mfc=new Rd.a}Rbj(a){let b=a.innerHTML;if(!b.length)return new Nn(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.mfc.Hb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),wn.a.IZb(),wn.a.b$a(this.Tak).appendChild(a),{width:c,height:a}=Od.a.rSc(a),this.mfc.$(b,new Nn(c,a)),wn.a.r3b());return this.mfc.ga(b)}}Object(m.a)(en,"ListMarkerOffsetCache",null,[1293]);var Rf=d(1208),ko=d(1225),dh=d(83),zk=d(256),dj=d(184),xn=d(491);class Jj{constructor(a,b){this.fd=this.wZ=this.AK=null;this.Vg=a;this.EG=b;this.zG=rb.ListReader.nx;this.mx=B.a.mx||B.a.vo}get Sf(){return this.Vg}get tM(){return this.EG}get IL(){return this.AK||
(this.AK=Db.a.instance.ub("Box4.List.ListSettings"))}get Uja(){return this.wZ||(this.wZ=Db.a.instance.Ja("Common.IZoomManager"))}set Uja(a){this.wZ=a}get Tf(){return this.fd||(this.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.zG}UAb(a){const b=this.Sf.Q9a(a);return b&&b.propertySet.sa($a.a.Ri,null)?1===b.listType?this.QAf(b):0===b.listType?this.A0g(b,a):"":""}oEl(a,b){if(this.enabled&&b&&(this.Sf.Qda(b)||this.Tf.gg&&63===b.type)&&this.zzb(a)){a.style.display=
"block";var c=this.Vwb(a);this.Mod(a,b);c&&(a=this.UAb(b),c.innerText=a)}}mJf(a,b,c){if(this.enabled&&this.zzb(a)){var f=this.Vwb(a);f&&this.YGh(a,b,c,f)}}YGh(a,b,c,f,l=!1){var x=tb.GraphIterator.nb(b);x.$e();Ta.OutlineElementNavigator.Re(x);if(rb.ListReader.uk(x)||this.Tf.gg&&rb.ListReader.N$b(x)){const U=x.currentNode;var H=fe.OutlineElementReader.vm(U);this.Tf.gg?this.Sf.KZg(x):this.Sf.ina(x);x=x.currentNode;if(!rb.ListReader.sna){const ja=this.UAb(x);f.innerText=ja}f.setAttribute(Cc.a.QK,Cc.a.gC);
12!==b.type?xn.a.OZc(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.Fwb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=H?"13px":c+"px",f.style.marginRight=H?c+"px":"13px",Ca.a.L$k(f,H?"right":"left"),H=0,{height:H}=this.Fwb(a.parentNode),f.style.marginTop=Math.max((H-b)/2,0)+"px"):(this.Mdl(a,f,b,U,x,c),this.N4e(b,f,c,x,H,l))}}pEl(a){this.enabled&&a&&a.Xq&&fe.OutlineElementReader.vm(a.currentNode)}M4e(a,b,c,f,l=-1){this.enabled&&(Sb.ParagraphReader.YW(a)||
this.Tf.gg&&Sb.ParagraphReader.ONj(a))&&this.WGh(a,b,c,l,null)}mEl(a,b,c){if(this.enabled&&this.zzb(a)){var f=Ca.a.D_f(a,Jj.OPi);if(f&&(f=Ca.a.D_f(f,Jj.NPi))&&(f=Ca.a.D8(f,Jj.Bfa))&&f.style&&(B.a.eg||(f.style.marginTop="0px"),(a=Ca.a.D8(a,Jj.xBk))&&(a=Ca.a.D8(a,Jj.Bfa))&&f.className.startsWith(Jj.Bfa))){if(this.Tf.gg){var l=Ca.a.qwb(a,Jj.QLa);var x=Ca.a.qwb(f,Jj.QLa)}else l=this.N3d(a,Jj.QLa),x=Ca.a.D8(f,Jj.QLa);l&&x&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{JWf:b,xWf:c}=this.UGh(a,f,l,x,b,c),this.hci(b,c,f))}}}N3d(a,b){return Ca.a.D8(a,b)}UGh(a,b,c,f,l,x){var H;""!==a.style.textIndent&&(x&&this.Sf.Mbb||""===b.style.textIndent)&&(x=a.style.textIndent,this.Sf.Mbb&&(H=this.fTc(a))&&(x=this.$ni(H,x)),b.style.textIndent=x);x=this.Cwb(c);H=this.Cwb(f);Math.floor(H.x)!==Math.floor(x.x)?(a=this.loi(l,x,H),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(l=b.style.textIndent,x=l.lastIndexOf("px"),0<x&&(l=l.substring(0,x),a+=parseInt(l))),b.style.textIndent=a+"px",x=this.Cwb(c),H=this.Cwb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{JWf:x,xWf:H}}loi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.IL.yPj||(f=this.L4f(a,b,c)):f=this.L4f(a,b,c);return f}L4f(a,b,c){return a?c.x-b.x:b.x-c.x}$ni(a,b){let c=b,f;({width:f}=this.Fwb(a));if(f){var l=a.style.marginLeft,x=a.style.marginRight;const H=l.lastIndexOf("px"),
U=x.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<H&&0<U&&(l=this.SJe(l,H),x=this.SJe(x,U),(b=this.SJe(b,a))||l||x)&&(c=b+f+l+x+"px")}return c}SJe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}hci(a,b,c){if(B.a.eg){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}t3f(a,b=!1){return(a=this.Vwb(a))?({width:a}=this.Fwb(a),b?a+0:a):0}Vwb(a){return this.enabled&&this.zzb(a)?(a=xn.a.$bj(a))?
this.r3f(a):null:null}Mod(a,b,c=!1){if(this.enabled&&this.zzb(a)){if(this.Tf.gg){var f="1";var l=this.Sf.Z7d(b)}else f=this.Qbj(b),l=this.Sf.Q9a(b);b=this.J5b(b,l);c?(Hb.d(a,Ba.a.eJi,b),Hb.d(a,Ba.a.role,Cc.a.WPa),Hb.d(a,Ba.a.dJi,f)):(Hb.d(a,Ba.a.Ufi,b),Hb.d(a,Ba.a.role,Cc.a.WPa),Hb.d(a,Ba.a.byf,f))}}r3f(a){if(!this.enabled||!a)return null;let b=null;(a=this.fTc(a))&&(b=Ca.a.D8(a,Jj.Zac)||this.JLc(a));return b}zzb(a){return!!a&&"li"===ha.a.qg(a.tagName)}WGh(){}O0f(){return 720}Fwb(a){let b,c;({width:b,
height:c}=Od.a.rSc(a));this.Uja&&this.Uja.instance&&this.Uja.instance.ojg(a)&&(b/=this.Uja.instance.i3,c/=this.Uja.instance.i3);return{width:b,height:c}}Cwb(a){const b=Od.a.rSc(a).returnValue;this.Uja&&this.Uja.instance&&this.Uja.instance.ojg(a)&&(b.x/=this.Uja.instance.i3,b.y/=this.Uja.instance.i3);return b}dka(a,b){switch(a.dka()){case 0:return b+"";case 4:return ha.a.FIf(b-1,!0);case 2:return ha.a.HIf(b,!0);case 3:return ha.a.FIf(b-1,!1);case 1:return ha.a.HIf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}QAf(a){if(1!==a.listType)return"";a=this.bej(a.listType,a.listStyle);return zk.a.gAf(a[0])}A0g(a,b){b=this.J5b(b,a);return this.dka(a,b)+"."}bej(a,b){return dj.a.wN(a,b).propertySet.sa($a.a.Ri,null)}J5b(a,b){const c=b.Eja;return c!==zk.a.Kw?c:this.roi(a,b)}roi(a,b){if(b.hX!==zk.a.Kw)return b.hX;if(b.xA!==zk.a.Kw)return b.xA;let c=1;const f=new tb.GraphIterator;f.set(a);f.$e();for(Ta.OutlineElementNavigator.Re(f);f.Jta();)if(rb.ListReader.uk(f)){const l=this.Sf.jw(f);if(l&&
b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.hX!==zk.a.Kw)return c+l.hX;if(l.xA!==zk.a.Kw)return c+l.xA;if(a.Sa(ab.a.listID)&&f.currentNode.Sa(ab.a.listID)&&f.currentNode.eb(ab.a.listID)!==a.eb(ab.a.listID))break;c++}}return c}PFl(a,b){Oc.App.Kbb&&(a.Sa($a.a.fontColor)&&(b.fontColor=a.eb($a.a.fontColor)),a.Sa($a.a.fontSize)&&(b.fontSize=a.eb($a.a.fontSize)),a.Sa($a.a.font)&&(b.fontName=a.eb($a.a.font)),a.Sa($a.a.bold)&&(b.isBold=a.eb($a.a.bold)),a.Sa($a.a.italic)&&(b.isItalic=a.eb($a.a.italic)),
a.Sa($a.a.superscript)&&(b.isSuperscript=a.eb($a.a.superscript)),a.Sa($a.a.subscript)&&(b.QF=a.eb($a.a.subscript)),a.Sa($a.a.strikethrough)&&(b.PF=a.eb($a.a.strikethrough)),a.Sa(dh.a.Zs)&&(b.A_=a.eb(dh.a.Zs)))}V8d(a,b){a=Sb.ParagraphReader.a7f(a,P.a.instance.ga(53),P.a.instance.ga(71),P.a.instance.ga(77),P.a.instance.ga(54));this.PFl(b,a);return a}F0f(){return null}XGh(a,b,c,f){const l=c.parentNode;let x=f.sa($a.a.fontSize,Kd.Font.wI);if(a.QF||a.isSuperscript)Hb.d(c,Ba.a.lMf,(x/2).toString()),x=Math.floor(x*
ec.j_i),l&&(l.style.fontSize=x/2+"pt"),c.style.fontSize=x/2+"pt";else if(rb.ListReader.sna){if(c.style.fontSize=x/2+"pt",!f.Sa($a.a.fontSize)&&(a=Ca.a.qwb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}Mdl(a,b,c,f,l,x){b&&this.zzb(a)&&(b.style.verticalAlign=a.style.verticalAlign,f&&l&&Oc.App.Kbb&&(x=f.mg(x)))&&(f=this.V8d(c,l,P.a.instance.ga(53),P.a.instance.ga(71),P.a.instance.ga(77),P.a.instance.ga(54)),f=this.F0f(x.Md,c)||f,this.A5b(a,b,l),!this.Tf.gg||""===
b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Bc.Mne)?(c="",f.P3&&(x=f.fontColor,x!==Ib.a.auto&&(c=Ib.a.vI(x))),b.style.color=c,c=this.Sf.Q9a(l)):c=this.Sf.Z7d(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?b.style.verticalAlign="super":f.QF&&(b.style.verticalAlign="sub"),this.XGh(f,a,b,l),f.PF||f.A_)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":
"line-through")}A5b(a,b){b.style.fontFamily=a.style.fontFamily}fTc(a){return a?Ca.a.j5b(a,tf.a.Lbb)||this.XXd(a):null}JLc(a){const b=Jc.a.createElement(a.ownerDocument,va.a.span);Sys.UI.DomElement.addCssClass(b,Jj.Zac);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}XXd(a){if(!a)return null;const b=Jc.a.createElement(a.ownerDocument,va.a.span);Sys.UI.DomElement.addCssClass(b,tf.a.Lbb);Ca.a.dOd(a,b);this.JLc(b);return b}N4e(a,b,c){this.M4e(a,b.parentNode.parentNode,this.tM.Iwb(a).EPb,
this.tM.G9a(a).EPb,c)}}Jj.Bfa="Paragraph";Jj.xBk="ParaWrappingDiv";Jj.NPi="_EditingElement";Jj.OPi="_EditingElement_WrappingDiv";Jj.QLa="TextRun";Jj.Zac="ListMarker";Object(m.a)(Jj,"AListMarkerUtility",null,[1294]);var Le=d(66),Do=d(808);class El{}El.YSd=8226;El.OAf="Arial";El.lZd=65532;El.ZIa=65533;Object(m.a)(El,"PptListConstants",null,[]);var Mf=d(60),Be=d(233);class lo extends Jj{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){super(a,b);this.W4j=[12295,19968,20108,19977,22235,20116,
20845,19971,20843,20061];this.gpe=c;this.mfc=f;this.Fa=l;this.Yl=x;this.Agk=H;this.Qb=U;this.ZC=ja;this.Hh=ya;this.nJ=Va;this.uH=hb;this.hA=yb;this.Brg=Zb;this.aXa=fc;this.kA=Gc;this.Gva=Kc;this.Iec=Lc}Qbj(a){const b=new tb.GraphIterator;b.set(a);b.$e();Ta.OutlineElementNavigator.Re(b);return b.currentNode.sa(ab.a.listLevel,0)+1+""}WGh(a,b,c,f,l=null){const x=this.gpe.Vp(K.a.nEl);l=new ke.a(f);l.set(a);l.$e();Ta.OutlineElementNavigator.Re(l);if(rb.ListReader.uk(l)){if(!b){this.gpe.Xb(Pd.a.vh,{["Reason"]:"ParagraphElementNull"});
x.end();return}f=this.r3f(b);if(!f){this.gpe.Xb(Pd.a.vh,{["Reason"]:"ListMarkerNotFound"});x.end();return}let H=this.Fwb(f).width;const U=l.Xq.Md.Ld;a=U.dK(this.tM.K8(a).UM,0);c=U.dK(Rf.a.Gfa(c,0),0);this.kA&&Object(Xa.a)(299,this.hA.Pd)&&(c=0);l=fe.OutlineElementReader.vm(l.currentNode);this.ibl(b,f,a,c,H,l)}x.end()}Fwb(a){a=this.mfc.Rbj(a);return{width:a.offsetWidth,height:a.offsetHeight}}fTc(a){let b=a;this.aXa&&a&&0<=a.className.indexOf(Hc.a.Bfa)&&(a=Ca.a.gda(a,Hc.a.u9))&&(b=a);return super.fTc(b)}N3d(a,
b){return this.aXa?Ca.a.D8(a,Hc.a.u9)?Ca.a.qwb(a,b):Ca.a.D8(a,b):super.N3d(a,b)}UGh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.Cwb(c);f=this.Cwb(f);return{JWf:a,xWf:f}}dka(a,b){switch(a.dka()){case 18:return 21>b?ha.a.fromCharCode(b-1+9312):b.toString();case 19:return this.L1i(b)}return super.dka(a,b)}QAf(a){let b="";if(1===a.listType){const c=a.propertySet.sa($a.a.Ri,null);c&&c.length&&c[0]&&(b=ha.a.hw(c[0],4))}b=this.yci(b?b:"2022",a);if(Ud.a("FixEvalSecurityBugForListMarkerUtility")&&
String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));xa.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(ko.a)(String.format("'\\u{0}'",b))}A0g(a,b){b=this.J5b(b,a);return this.dka(a,b)+this.aej(a)}ibl(a,b,c,f,l,x){f?this.kbl(a,b,f,c,l,x):this.jbl(a,b,l,x)}kbl(a,b,c,f,l,x){const H=Math.max(Math.abs(c),l);a.style.textIndent=0<c?H+"px":Math.max(H-f,0)+"px";this.wqh(H-l,-1*H,b,x)}jbl(a,b,c,f){a.style.textIndent=c+"px";this.wqh(0,-1*c,b,f)}wqh(a,b,c,f){c.style.marginLeft=
f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}aej(a){a=a.v9;for(let b=0;b<a.length;b++)if(a[b]===El.ZIa){if(b+2>=a.length)break;return a[b+2]?ha.a.fromCharCode(a[b+2]):""}return"."}L1i(a){let b="";for(;0<a;)b=ha.a.fromCharCode(this.W4j[a%10])+b,a=parseInt(String(a/10));return b}yci(a,b){let c=a;1===b.listType&&b.H$a&&0<=Array.indexOf(lo.u4k,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}V8d(a,b,c,f,l,x){if(!this.Brg)return super.V8d(a,b,c,f,l,x);f=this.Qb.Nc(b);f.rc(11);f.Jg(11);l=this.nJ.qQ(f,
this.uH.nda(f));c=new Do.ParagraphStandardProperties;(x=this.Yl.Nka(b))||this.Agk.qKj(b)?(c.fontColor=Ib.a.kRa,c.fontSize=x?Mf.a.Z_g:Sb.ParagraphReader.Mja(a,$a.a.fontSize,Kd.Font.wI)):(b.Sa($a.a.fontColor)?c.fontColor=b.eb($a.a.fontColor):l&&l.Sa($a.a.fontColor)&&!Le.isTableCellOrInside(f)?c.fontColor=l.eb($a.a.fontColor):c.fontColor=this.Hh.Mja(a,$a.a.fontColor,Ib.a.nil),f=this.Hh.Mja(a,$a.a.fontSize,Kd.Font.wI),a=this.Fa.WDa(this.Fa.$m(a)),a*=f,b.Sa(kb.a.Mvb)&&(a*=b.eb(kb.a.Mvb)),c.fontSize=a);
return c}XGh(a,b,c){this.Brg&&(b=this.ZC.HI(b))&&a.Lta&&(c.style.fontSize=b.Md.Ld.kja(a.fontSize),c.style.lineHeight="0.1")}U1f(a,b){let c="";const f=this.Sf.Q9a(b);1===f.listType&&f.H$a?c=f.font&&-1===f.font.indexOf(",")?da.FontUtils.jja(f.font):f.font:19===f.dka()||18===f.dka()&&21>this.J5b(b,f)?c=da.FontUtils.jja("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}A5b(a,b,c){a=this.U1f(b,c);b.style.fontFamily=
a;b.style.fontFamily||!B.a.Tj&&!B.a.vo||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}N4e(a,b,c,f,l,x=!1){if(this.aXa){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(Hc.a.u9)?b.parentNode:b,this.M4e(a,b,this.tM.Iwb(a).EPb,this.tM.G9a(a).EPb,c)}else super.N4e(a,b,c,f,l,x)}Vwb(a){return super.Vwb(a)}Ibj(a,b){return this.J5b(b,a)}Mod(a,b,c=!1){if(this.Gva){const l=this.Qb.Nc(b);l.rc(11);
l.Jg(11);l.Bb(2);if(c){if(b&&b.Sa(kb.a.Chg)&&!b.eb(kb.a.Chg)){var f=b.sa($a.a.Ri,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.Vwb(a);f=this.U1f(f,b);ha.a.Wa(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.sa(kb.a.autonumberBulletType,8))}this.Iec&&l.currentNode.Sa(kb.a.fje)&&!l.currentNode.eb(kb.a.fje)&&a.setAttribute("data-margin",l.currentNode.sa(ab.a.$l,Be.a.leftMargin).toString())}}super.Mod(a,b,c)}F0f(a,b){return this.kA&&a&&b&&(Object(Xa.a)(299,
a)||Object(Xa.a)(299,this.hA.Pd)&&a.Wl)?(a=new Do.ParagraphStandardProperties,a.fontName=Kd.Font.VS,a.fontColor=Ib.a.kRa,a.fontSize=Mf.a.nol,a):null}}lo.u4k="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(m.a)(lo,"ListMarkerUtility",Jj,[988]);class yn{static q3j(){"GetSpecialIndentWithTabs"in yn.Vmh||(yn.Vmh.GetSpecialIndentWithTabs=!0,xa.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}yn.Vmh={};Object(m.a)(yn,"SessionLogger",
null,[]);class ek{constructor(a,b,c,f,l,x){this.h8c=a;this.m$=b;this.Hh=c;this.Qb=f;this.nJ=l;this.Kug=x}Hqh(a,b,c,f=-1){let l=this.Kug;0<=f&&(l=this.a1f(a,f)||l);this.Zbl(a,b,c,l);this.$bl(a,b,l,f)}a1f(a,b){let c=null;(a=a.sc(b))&&a.Md&&(c=a.Md.Ld);return c}Zbl(a,b,c,f){let l=0;this.Hh.YW(a)||(l=f.dK(this.m$.K8(a).UM,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=l+"px",b.style.marginRight="")}$bl(a,b,c,f=-1){var l=this.m$.BSc(a).UM;a.anchor&&this.Hh.YW(a)&&0<=f?this.h8c.M4e(a,
b,Rf.a.dK(l,0),0,f):(f=c.dK(l,0),l=c.dK(this.m$.K8(a).UM,0),b.style.textIndent=this.kkj(f,l,this.BBi(a),this.L7i(a),c)+"px")}BBi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}L7i(a){let b=a.sa(ab.a.uub,ek.KIc);if(!a.Sa(ab.a.uub)){const c=this.Qb.Nc(a);c.set(a);c.rc(11);c.Jg(11);(a=this.nJ.qQ(c,a.sa(ab.a.listLevel,Be.a.NEa)))&&(b=a.sa(ab.a.uub,ek.KIc))}return b}kkj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&
(c=0,yn.q3j());0<c&&(f=l.dK(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}Rbi(a,b,c,f=-1){var l=this.Kug;0<=f&&(l=this.a1f(a,f)||l);a=this.m$.BSc(a).UM;l=l.dK(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}ek.KIc=1440;Object(m.a)(ek,"ParagraphViewIndentationStrategy",null,[1428]);var Gf=d(427),nm=d(641),lh=d(368),pe=d(149),Ol=d(231),zn=d(264);class Pl{constructor(a,b,c){this.success=a;this.RAk=b;this.nJk=c}}Object(m.a)(Pl,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var Qm=d(814);class Rm{constructor(){this.Lm=
new J.DictionaryPropertySet}eb(a){return this.Lm.eb(a)}sa(a,b){return this.Lm.sa(a,b)}Sa(a){return this.Lm.Sa(a)}get propertySet(){return this.Lm.clone()}get GN(){return this.Lm.sa($a.a.font,Kd.Font.VS)}get hV(){return this.Lm.sa(ab.a.hV,-1)}get fieldInstruction(){return this.Lm.sa(ab.a.fieldInstruction,"")}get Lta(){return this.Lm.Sa($a.a.fontSize)}get fontSize(){return this.Lm.sa($a.a.fontSize,Kd.Font.wI)}get P3(){return this.Lm.Sa($a.a.fontColor)}get fontColor(){return this.Lm.sa($a.a.fontColor,
Ib.a.nil)}get kbg(){return this.Lm.Sa(Qm.a.n0b)}get wXf(){return this.Lm.sa(Qm.a.n0b,1)}get QTa(){return this.Lm.Sa($a.a.highlight)}get highlight(){return this.Lm.sa($a.a.highlight,Ib.a.nil)}get M$a(){return this.Lm.Sa(dh.a.KR)}get KR(){return this.Lm.sa(dh.a.KR,Ib.a.nil)}get mbg(){return this.Lm.Sa($a.a.it)}get language(){return this.Lm.sa($a.a.it,0)}get KTa(){return this.Lm.Sa($a.a.bold)}get isBold(){return this.Lm.sa($a.a.bold,!1)}get J$a(){return this.Lm.Sa($a.a.italic)}get isItalic(){return this.Lm.sa($a.a.italic,
!1)}get Xxb(){return this.Lm.Sa($a.a.underline)}get iE(){return this.Lm.sa($a.a.underline,!1)}get WVc(){return this.Lm.Sa($a.a.Ow)}get Ow(){return this.Lm.sa($a.a.Ow,Kd.Font.pV)}get Wxb(){return this.Lm.Sa($a.a.strikethrough)}get PF(){return this.Lm.sa($a.a.strikethrough,!1)}get G7b(){return this.Lm.Sa(dh.a.Zs)}get A_(){return this.Lm.sa(dh.a.Zs,!1)}get isSuperscript(){return this.Lm.sa($a.a.superscript,!1)}get QF(){return this.Lm.sa($a.a.subscript,!1)}get NG(){return this.Lm.sa(ab.a.NG,null)}get ht(){return this.Lm.sa($a.a.ht,
!1)}get E_(){return this.Lm.sa($a.a.E_,!1)}get en(){return this.Lm.sa($a.a.en,!1)}get wab(){return this.Lm.sa(ab.a.wab,!1)}get RUa(){return this.Lm.sa(Mc.a.Ywa,!1)}get LTa(){return this.Lm.Sa(dh.a.capitalization)}get capitalization(){return this.Lm.sa(dh.a.capitalization,0)}get dFa(){return this.Lm.sa(ab.a.dFa,!1)}Xp(a,b){b.Sa(a)&&this.Lm.setValue(a,b.Lh(a))}static oIc(a){const b=new Rm;b.Lm.setValue($a.a.fontSize,Mf.a.kol);b.Xp($a.a.superscript,a.propertySet);b.Xp($a.a.subscript,a.propertySet);a.ht&&
b.Lm.setValue($a.a.underline,!0);return b}}Object(m.a)(Rm,"PptSmartArtFormattingCache",null,[597]);class Uj{constructor(a,b,c,f){this.Uhi=a;this.Xhi=b;this.Vhi=c;this.Whi=f}}Object(m.a)(Uj,"SelectionImageProperty",null,[]);var di=d(150),mf=d(72);class Wi{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg){this.Bzg=this.Azg=!1;if(!gg)throw Error.argumentNull("graphTopologyManager");this.hA=a;this.Fa=b;this.jc=c;this.v6j=f;this.Po=l;this.ZC=x;this.ugc=H;this.JC=U;this.iz=
ja;this.AX=ya;this.ua=gg;this.xdb=Va;this.d7c=hb;this.bDb=yb&&!ae;this.aXa=Zb;this.hXa=fc;this.mDb=Kc;this.lec=Lc;this.Jbd=Gc&&!ae;this.kA=we;this.fma=$d;this.e7c=Te;this.$ef=Ze;this.rak=Vf;this.ua=gg;this.iak=Qg}E9a(a,b){if(b.sa(kb.a.vFa,!1))return Mf.a.Z_g;b=this.Fa.WDa(this.Fa.$m(b));return bf.a.$y(b,1)?a:2*Math.round(a*b/2)}Kxf(a,b){if(!this.$ef||!a)return b;Wi.V1f(a);return b}Fij(a){if(!this.iak||ha.a.Wa(a))return null;const b=this.ua.presentation.q4d;if(!b)return null;for(const c of b)if(c.Font===
a)return c.SubstitutedByFont;return null}W1f(a,b,c){return c.kja(this.E9a(a,b))}A_f(a,b){return a.Sa(kb.a.gtb)?b.Ifa(a.eb(kb.a.gtb)/Gf.a.bmc,0)+"px":null}Y2f(a){if(a.Sa(kb.a.BAb)){const b=a.eb(kb.a.BAb)/Gf.a.bmc;a=a.fontSize;return 0<b&&a*Gf.a.S$a>=b?"normal":"none"}return null}i7d(a,b,c,f){let l=null;this.xdb?l=Ib.a.vI(0):!c&&f||!b.P3?this.bDb&&f&&(l=P.a.instance.ga(119)?b.sa(kb.a.l8b,!1)?this.y2f(a):Ib.a.vI(b.fontColor):this.y2f(a)):(a=b.fontColor,l=a===Ib.a.auto?"WindowText":Ib.a.vI(a));return l}Guh(a,
b,c,f,l){return!b&&!c&&!f&&!l&&(!this.d7c||a.isSuperscript||a.QF)}t7f(a){return a.Sa(kb.a.oN)?a.eb(kb.a.oN)/1E3:0}A$d(){return 2/3}y2f(a){let b=null;var c=Object.assign(new nm.a,{schemeClrField:Object.assign(new lh.a,{valField:10})});a=Object(oa.a)(115,this.jc.kg(a));(c=this.v6j.TJ(c,a?a.ke:null))&&(b=pe.Box4ColorHelper.epa(c).jV());return b}iuh(a,b){return this.bDb||a||!b}Puh(){return!0}kuh(){return this.bDb}dGl(a,b,c,f){if(!c||!c.Ua||!f||1>f.length)return b;let l=0,x=0;for(let H=0;H<f.length;H++){if(c.Ua.Qa>=
x&&c.Ua.Qa<x+f[H]||c.Ua.Qa===x+f[H]&&f[H]>b.Lines[H]){l=H;break}x+=f[H]}c=0;for(const H of b.Lines)c+=H;a=a.Ra.ga(a.Ra.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}uEf(a,b){a=Object(oa.a)(Mb.AParagraphNode,a);if(!a||!a.Ra)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}pDh(a,b,c,f,l,x,H,U){if(!(this.aXa&&a&&c&&c.length&&b))return!1;var ja=this.Fa.$m(f);if(!ja)return!1;ja=this.hXa&&
ja.nCb;if(!b.lp&&!ja)return!1;f=Object(oa.a)(Mb.AParagraphNode,f);if(!f||!f.Ra||!ja&&this.ugc.W7a(f))return!1;c=this.H6i(c,f,!b.lp);if(this.DLi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.Po||this.Po.Bua)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.mDb?this.vyl(f,a,b,l,x,H,U):this.tyl(a,b,c)}YHh(a){this.hXa&&a&&(a=this.Fa.$m(a))&&a.nCb&&(xa.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),
a.Ulb(!1))}Ebj(a,b){const c=di.a.ui(a,kb.a.cOb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Ra.length)return xa.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Ra.ga(a.Ra.length-1).cp+1!==b)return null}return c}tyl(a,b,c){if(!c)return!1;const f=new Ka.a;for(const l of c){c=b.hp(va.a.span);Sys.UI.DomElement.addCssClass(c,Hc.a.u9);f.add(c);let x=!1;for(let H=0;H<l;H++)if(a.firstChild)c.appendChild(a.firstChild);
else{xa.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");x=!0;break}if(x)break}b=Object(oa.a)(477,this.ZC.HI(a));if(!b)return xa.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(let l of f)b.Xo(l),a.appendChild(l);return!0}vyl(a,b,c,f,l,x,H){if(!b||!c)return!1;let U=di.a.ui(a,kb.a.cOb,null);if(!U||!U.Lines||!U.Lines.length)return!1;for(this.rak&&(U=this.dGl(a,U,x,H));l.count>f;)l.removeAt(f);a=new Ka.a;H=x=f=null;
for(let ja=0;ja<U.Lines.length;ja++){f=c.hp(va.a.span);Sys.UI.DomElement.addCssClass(f,Hc.a.u9);a.add(f);const ya=this.z7h(U.Lines[ja],b,f,x,H,l);x=ya.RAk;H=ya.nJk;this.m4j(ja,U.Lines.length,f.lastChild);if(!ya.success){xa.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");break}}for(this.jGc(x,f,l);b.firstChild;)this.jGc(b.firstChild,f,l);return this.uyl(b,a)}m4j(a,b,c){Wi.Dzg||(kf.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",
0,"pptotext",null),Wi.Dzg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!Wi.Czg&&!a&&b&&c&&(kf.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),Wi.Czg=!0))}z7h(a,b,c,f,l,x){let H=!0;for(;0<a;){if(!(f&&f.innerText.length||b.firstChild)){xa.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");H=!1;break}let U;f?
(l=U=f,f=null):(U=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(U,Hc.a.CN)&&(l.style.lineHeight=U.style.lineHeight),l=null);const ja=U.innerText.length;a>=ja?(this.jGc(U,c,x),a-=ja):(f=U.cloneNode(!1),this.upl(U,f,a),this.jGc(U,c,x),a-=U.innerText.length)}return new Pl(H,f,l)}upl(a,b,c){a=a.childNodes;let f=-1;for(let l=0;l<a.length;l++){const x=a[l];if(c)if(c>=x.innerText.length)c-=x.innerText.length;else{const H=x.cloneNode(!0);H.innerText=x.innerText.substring(c,x.innerText.length+1);b.appendChild(H);
x.innerText=x.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}jGc(a,b,c){if(a&&b&&c){b.appendChild(a);a=Ca.a.P9a(a);for(let f of a)c.add(f),V.a.Qv(f,"leafEltIdx",c.count-1)}}uyl(a,b){const c=Object(oa.a)(477,this.ZC.HI(a));if(!c)return xa.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(let f of b)c.Xo(f),a.appendChild(f);return!0}H6i(a,b,c){const f=this.KAi(this.Ebj(b,c));if(!f||!f.length)return null;c=f.length;
const l=Array(c);let x=0,H=1;for(let U=0;U<b.Ra.length;U++)H<c&&b.Ra.ga(U).cp===f[H]&&(l[x]=a[U],x++,H++);l[c-1]=a[a.length-1];if(H!==c)return xa.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}KAi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}DLi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=
!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],Hc.a.pN)||Sys.UI.DomElement.containsCssClass(a[l],Hc.a.V0d)||(b=!1);if(b)return!0;c+=f}return!1}D0f(a,b,c){const f=new Yc.a;if(!a||!b||!c)return xa.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":"null",c?"not null":"null"),f;this.Cgl(a,b)&&(a=null,c.Sa(kb.a.schemeColor)&&(a=c.eb(kb.a.schemeColor),a=this.Sdj(b,a)),ha.a.Wa(a)||f.$("data-scheme-color",
a),this.e7c&&c.Sa(kb.a.QYc)&&(c.eb(kb.a.QYc)?f.$("data-usefontface","false"):f.$("data-usefontface","true")));return f}Sdj(a,b){if(ha.a.Wa(b))return"";const c=zn.SchemeColor.parse(b);if(c&&c.color&&!c.Kta){a=Object(oa.a)(115,this.jc.kg(a));a=c.resolve(a?a.ke:null);if(!a)return"";c.ZP=Ol.g(a.B_a);return c.toString()}return b}Cgl(a,b){return this.lec&&a.Wl&&Wi.gVj(b)}oHf(a){if(this.Jbd){a=a.querySelectorAll("."+Wi.VYd);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.K_k(a[b]);for(b=0;b<c;++b)mf.a.fGj(a[b],
f[b].Uhi,f[b].Xhi,f[b].Vhi,f[b].Whi)}}I_k(a){return new Uj("linear-gradient(to right, "+mf.a.jKc+", "+mf.a.jKc+")",mf.a.E_e,"0px "+a.style.verticalAlign,mf.a.Ard)}FIj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,Hc.a.h8))return!1;a=a.nextSibling}return!0}J_k(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+Hc.a.h8);for(let x=0;x<l.length;x++){const H=l[x];f+=this.R8i(H);b=Math.min(b,H.offsetLeft);c=Math.max(c,H.offsetLeft+H.offsetWidth)}return new Uj("linear-gradient(to right, "+
mf.a.jKc+", "+mf.a.jKc+")",0<c-a.offsetLeft?f+"px 100%":mf.a.E_e,b-a.offsetLeft+"px "+a.style.verticalAlign,mf.a.Ard)}K_k(a){return this.FIj(a)?this.I_k(a):this.J_k(a)}R8i(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}E0f(a,b,c){return this.kA&&a&&b&&c&&(Object(Xa.a)(299,a)||Object(Xa.a)(299,this.hA.Pd)&&a.Wl)?Rm.oIc(b):null}Luh(){return!1}A5b(a){let b=a.sa(kb.a.latinFont,Kd.Font.VS);b.startsWith("+")&&(b=a.sa($a.a.font,Kd.Font.VS));let c=new Ka.a;c.add(b);
var f=[kb.a.eastAsianFont,kb.a.complexScriptFont,kb.a.NNb];for(var l of f)a.Sa(l)&&(f=a.eb(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.Fij(b))l=new Ka.a,l.add(b),Ud.a("UseServerFallbackFontFirst")?l.insert(0,a):l.add(a),this.W3j(a,c),c=l;return c.toArray().join(",")}W3j(a,b){this.Azg||da.FontUtils.isMissingFont(b.ga(0))?this.Bzg||b.contains(a)||(xa.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.Bzg=!0):(xa.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),
this.Azg=!0)}ZMe(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.JC&&this.JC.isEnabled;const f=!!this.iz&&this.iz.isEnabled;if(f||c||this.fma)b=da.FontUtils.erb(b,a,c,this.fma,f);f&&this.iz.createFontUrl(a);c&&(this.$ef&&a?(c=Wi.V1f(a),this.JC.createFontUrl(a),c&&this.JC.createFontUrl(c)):this.JC.createFontUrl(a));this.fma&&this.AX.createFontUrl(a);return b}xch(a,b){return a?this.ZMe(a.fontName,b):b}dZc(){return this.fma}static b7d(a){if(ha.a.Wa(a))return null;const b=a.indexOf(",");
-1<b&&(a=a.substring(0,b).trim());return a}static V1f(a){if(ha.a.Wa(a))return null;a=Wi.b7d(a);let b=a.toLowerCase();for(;b;){let c=!1;b=b.trim();for(const f of Wi.m_i){let l=f;b.endsWith("\u200b")&&(l+="\u200b");b.endsWith(l)&&(c=!0,b=b.substring(0,b.lastIndexOf(l)+1))}if(!c)break}return a.substring(0,b.length)}static gVj(a){return a.sa(kb.a.vFa,!1)?!1:!0}}Wi.VYd="Selection";Wi.yLf="SelectionShadow";Wi.m_i=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");
Wi.Dzg=!1;Wi.Czg=!1;Object(m.a)(Wi,"TextRenderingStrategy",null,[1295]);class fn{constructor(){this.cyb=[]}fQe(a){a&&!Array.contains(this.cyb,a)&&(a.u_=this,Array.add(this.cyb,a))}nkc(a,b){for(let c=0;c<this.cyb.length;c++){const f=this.cyb[c];f.dyb&&f.nkc(a,b)}}}Object(m.a)(fn,"AHighlightManager",null,[1292]);class Eo extends fn{constructor(){super();this.QFg=this.Acc=null}get qja(){return this.Acc}get Fbb(){return this.QFg}xod(a){if(a&&((this.Acc=a)&&0===this.Acc.action&&(this.QFg=this.Acc),a.Ada||
a.Ohb)){var b=[];for(let c=0;c<this.cyb.length;c++){const f=this.cyb[c];f.dyb&&Array.addRange(b,f.XCh(a.Ada,a.Ohb))}}}}Object(m.a)(Eo,"HighlightManager",fn,[]);class On{constructor(a,b){this.Vva=a;this.$cc=b;this.Vva.jk(Object(F.a)(this,this.kh,"onPropertyChanged"))}dispose(){this.Vva.Cm(Object(F.a)(this,this.kh,"onPropertyChanged"))}kh(a,b){a=b.node;b.property.id===kb.a.cOb.id&&a.isConnected&&!this.$cc.isComposing&&a.anchor.Dr(208)}}Object(m.a)(On,"ParagraphNodeViewBehavior",null,[106]);class fl{constructor(a){this.$cc=
a}Duh(a){if(a=Object(oa.a)(5,a)){if(this.$cc.isComposing){if(!a.o0c)return xa.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),!0;xa.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.o0c=!1}return!1}}Object(m.a)(fl,"ParagraphViewElementCEVSetUpdateStrategy",null,[1427]);class fk{constructor(a){this.b9c=[kb.a.jX,kb.a.ux,kb.a.aea,kb.a.qla,kb.a.$da,kb.a.pla,ab.a.$l,ab.a.sY,ab.a.eo,ab.a.HHb,ab.a.listLevel,$a.a.Jl,$a.a.eJ];
this.$Xh=a.Oke;this.HZc=a.HZc;this.ZXh=a.pptCopyPasteMarginAndIndentationEnabled}get ohd(){return this.$Xh}get bBi(){return!1}get y9g(){return this.ZXh}get FBk(){return this.b9c}Iil(a){return!!a.tagName&&"p"===ha.a.qg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,Hc.a.Bfa)}yta(a){const b={};for(const c of this.b9c)b[c.id.toString()]=a.Lh(c);return b}Foa(a,b){if(b){const c=Sb.ParagraphReader.YW(a);this.tcl(a,b,this.b9c,this.Nkg(a),c);a.setValue(Mc.a.r$b,!0)}}Nkg(a){let b=!1;(a=tb.GraphIterator.nb(a).parentNode)&&
fe.OutlineElementReader.n9(a)&&(b=rb.ListReader.JUa(a));return b}Ilk(a,b,c,f){this.y9g||(f=!0);if(this.ohd){const l=a.sa(Mc.a.r$b,!1),x=b.sa(Mc.a.r$b,!1),H=l||!f&&!x&&!l?b:a;this.fBi(H,l||!f&&!x&&!l?a:b,this.b9c,this.Nkg(H),c)}}emj(a){return this.y9g&&a?Sb.ParagraphReader.YW(a)&&a.Sa(kb.a.eje)&&!a.eb(kb.a.eje)&&a.Sa(ab.a.eo)?a.eb(ab.a.eo).toString():"":""}tcl(a,b,c,f,l){for(const x of c)this.Buh(x,f,l)||(c=b[x.id.toString()],void 0!==c?a.setValue(x,c):a.removeProperty(x))}fBi(a,b,c,f,l){for(const x of c)this.Buh(x,
f,l)||(c=b.Lh(x),void 0!==c?a.we(x,c):a.removeProperty(x))}Buh(a,b,c){return this.HZc&&!b&&c&&(a===ab.a.$l||a===ab.a.eo)}}Object(m.a)(fk,"PptFormattingPropertyTransitStrategy",null,[1426]);class ej{}ej.gFh="UnderlineColor";ej.cud="UnderlinePositionInEm";ej.dud="UnderlineThicknessInEm";ej.tQc="FontSizePx";Object(m.a)(ej,"ParagraphViewElementProperties",null,[]);class Mi extends ec{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze){super(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc);
this.ubc=Lc;this.REg=Gc;this.pCg=ae&&!$d;this.Jbd=we&&!$d;this.SEg=Te;this.qad=Ze}cQd(a,b){this.ubc?a.style&&!ha.a.Wa(a.style.verticalAlign)&&(ha.a.Wa(b.style.verticalAlign)?(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.aci(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.cQd(a,b)}aci(a){if(null!==a.style&&!ha.a.Wa(a.style.verticalAlign)){if(this.REg&&this.hOj(a)){const b=a.style.backgroundColor;
a.style.backgroundColor=null;mf.a.twf(a,String.format("linear-gradient(to right, {0}, {0})",b),mf.a.E_e,String.format("0px {0}",a.style.verticalAlign),mf.a.Ard)}if(this.Jbd||this.REg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}I6d(a){return this.ubc?"0px":super.I6d(a)}zvf(a){a.style.position=mf.a.dsc}hOj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&
a.style.backgroundColor!==mf.a.pvi}ERe(a,b,c,f){if(this.pCg&&b.ht){if(b.PF||b.A_)a.style.textDecoration=mf.a.srl,f[f.length]="Strikethrough";b.iE&&(f[f.length]="Underlined");let l,x;this.qad&&({cud:l,dud:x}=this.gnj(b.GN)).returnValue?(V.a.Qv(a,ej.gFh,this.fnj(c,b)),V.a.Qv(a,ej.cud,l),V.a.Qv(a,ej.dud,x)):ha.a.Wa(a.style.textDecoration)?a.style.textDecoration=mf.a.bzh:a.style.textDecoration+=" "+mf.a.bzh}else super.ERe(a,b,c,f)}fnj(a,b){a=this.aw.i7d(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",
a)}gnj(a){return{returnValue:"Calibri"===a,cud:1.1133,dud:.0654}}pKj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,Hc.a.h8))return!0;a=a.nextSibling}return!1}yvf(a,b){this.Jbd&&(Sys.UI.DomElement.containsCssClass(b,Hc.a.h8)||this.pKj(a,Hc.a.h8)?(Sys.UI.DomElement.addCssClass(a,Wi.VYd),this.SEg&&B.a.Tj&&Sys.UI.DomElement.addCssClass(a,Wi.yLf)):(Sys.UI.DomElement.removeCssClass(a,Wi.VYd),this.SEg&&B.a.Tj&&Sys.UI.DomElement.removeCssClass(a,Wi.yLf)));if(this.pCg&&
Sys.UI.DomElement.containsCssClass(a.parentNode,Hc.a.Jcg)){const c=V.a.Be(a,ej.gFh),f=V.a.Be(a,ej.dud);let l=V.a.Be(a,ej.cud);if(c&&f&&l){if(!ha.a.Wa(a.style.fontSize)&&a.style.fontSize.endsWith("px")&&!ha.a.Wa(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const x=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(x)||(l-=x/a)}mf.a.twf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),mf.a.Ard);b.style.textDecoration=mf.a.trl}}}}Object(m.a)(Mi,
"PptParagraphContentRenderer",ec,[]);class Hm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Zb(a){this.K=a;this.hQe();this.oQe();this.TUk();this.kQe();this.$Uk();this.aVk();this.SUk()}init(){this.K.register(1292,"Box4.Highlight.IHighlightManager").ma().oa(()=>new Eo);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new Di.a((a,b)=>new Kf(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),
new qc.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Wl&&u.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new Di.a((a,b)=>new ne(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}hQe(){this.K.register(1293,
"PowerPointWebEditor.IListMarkerOffsetCache").ma().oa(()=>new en);this.K.register(1294,"Box4.IListMarkerUtility").ma().oa(()=>new lo(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),Nc.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").abb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}oQe(){this.K.register(1295,"Box4.ITextRenderingStrategy").ma().oa(()=>new Wi(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.ub("Box4.CloudFontService"),this.K.ub("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jgg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").hlg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").elg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").abb,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").dOb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").rBh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").z_c,this.K.resolve("PowerPointWebEditor.IApplicationSettings").glg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").tNj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Lul,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").I8k))}TUk(){this.K.register(pk,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(fl,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().oa(()=>
new fl(this.K.resolve("Box4.IEditingView")))}kQe(){this.K.register(ek,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().oa(()=>new ek(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new xf.a))}$Uk(){this.K.register(fk,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().oa(()=>
new fk(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}aVk(){this.K.register(Mi,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().oa(()=>new Mi(sa.InteractiveViewManager.instance,qa.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.ub("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.ub("Box4.IFeatureHelper"),da.FontUtils.nAi,this.K.ub("Box4.IFontSlotProvider"),Object(F.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").geh,"raiseParagraphContentUpdatedEvent"),gc.a.language,this.K.ub("Box4.ITableOfContentRenderHelper"),ac.a.oAf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").hlg,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").elg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").glg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").shl))}SUk(){this.K.register(On,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().oa(()=>new On(this.K.resolve("Box4.Graph.IGraphInstance").yd(12),
this.K.resolve("Box4.IEditingView")))}static main(){z.a.instance.Dc(new Hm)}}Object(m.a)(Hm,"PPTWebEditorParagraphPackage",null,[2,3]);var Ql=d(496),Pn=d(624);class gn extends Sys.EventArgs{constructor(a){super();this.Kk=a}}Object(m.a)(gn,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class Fo{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){this.Vye=this.awa=null;this.Fe=a;this.Ds=b;this.Rd=c;this.mc=f;this.la=l;this.kic=x;this.t9c=H;this.ly=U;this.Ze=ja;this.Uea=ya;this.pa=Va;this.hf=
hb;this.ua=yb;this.ia=Zb;this.zb=fc;this.O9=Kc;this.So=Gc;this.LC=ae;H.zPd(Object(F.a)(this,this.lHb,"onPodSessionUnavailable"));H.frb(Object(F.a)(this,this.vfa,"onPodSessionRefreshed"));Lc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.Mze=new af.a(4,2,2E3,Object(F.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.vg}get w$b(){return!!this.awa}sfj(a,b){const c=Tc.a.yk("GetPodSessionInfo");try{const f=this.Fe.podSessionId,l=Ug.a.create().toString(),
x=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),H={};H.PodSID=f;H["X-UserSessionId"]=this.kic();H["X-CorrelationID"]=l;c.Va("PodSessionId",f);c.Va("Cid",l);this.Ds.ZV(x,2,null,H,[ee.a.K5],0,U=>{try{if(f!==this.Fe.podSessionId)c.Va("ExpectedPodSessionId",f),c.Va("ActualPodSessionId",this.Fe.podSessionId),c.Va("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var ja=!0;if(U.data){if(c.Va("HttpStatus",U.data.oe.toString()),c.Va("RequestStatus",Ql.a[U.data.status]),
U.data.sj){const ya=U.data.sj[ee.a.K5];ya&&"errorCannotFindSession"===ya&&(c.Va("ErrorCode",ya),ja=!1)}}else c.Va("HttpStatus","UNKNOWN"),c.Va("RequestStatus","UNKNOWN");ja?(c.Va("Result","Succeeded"),c.finish(),a&&a()):(c.Va("Result","Failed"),c.finish(!0),b&&b())}}catch(ya){xa.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ya),b&&b()}},U=>{try{if(f!==this.Fe.podSessionId)c.Va("ExpectedPodSessionId",f),c.Va("ActualPodSessionId",this.Fe.podSessionId),c.Va("Result","PodSessionIdUnexpected"),
c.finish(!0),a&&a();else{if(U.data){if(c.Va("HttpStatus",U.data.oe.toString()),c.Va("RequestStatus",Ql.a[U.data.status]),U.data.sj){const ja=U.data.sj[ee.a.K5];ja&&c.Va("ErrorCode",ja)}}else c.Va("HttpStatus","UNKNOWN"),c.Va("RequestStatus","UNKNOWN");c.Va("Result","Failed");c.finish(!0);b&&b()}}catch(ja){xa.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ja),b&&b()}},null,void 0,void 0,this.la.ufj,this.la.vfj,"GetPodSessionInfo",void 0,!0)}catch(f){xa.a.J(512496141,801,
10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Va("Result","Failed"),c.finish(!0),b&&b()}}lHb(a,b){a=!1;this.awa?xa.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Fe.presentationId.string,this.ly.Kka,this.Ze.wA,this.Fe.Kk,this.Fe.podSessionId,
!this.mc.Gn,Tc.a.nf(this.awa),!!this.So.instance,b.mPc):(this.awa=new Date,a=!0,xa.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Fe.presentationId.string,this.ly.Kka,this.Ze.wA,this.Fe.Kk,this.Fe.podSessionId,!this.mc.Gn,Tc.a.nf(this.awa),
!!this.So.instance,b.mPc));this.O9.instance&&this.O9.instance.$Zc?xa.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Fe.Kk,this.Fe.podSessionId):this.ly.Kka&&this.la.podsSeamlessFailoverEnabled&&this.So.instance?this.So.instance.L2e(b.mPc,4,b.errorCode):(this.Rd.xka=!1,this.ly.Kka?this.Ze.wA?(a&&this.zb.Db(this.Mze),this.Uea.xTc(this.Fe.presentationId.string,this.Fe.Kk,
this.Fe.podSessionId,b.mPc,c=>{this.h3k(c,this.Fe.Kk)},c=>{this.g3k(c,this.Fe.Kk)}),this.pa.setSelection(null),this.hf.blockContent(this.ua.presentation,"OnPodSessionUnavailable",!0),xa.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.Jtj():xa.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Fe.podSessionId))}Jtj(){this.Vye||(this.Vye=new Date);const a=+new Date-+this.Vye;a>this.la.podsNullSrmWaitTimeInMs?
(xa.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Fe.podSessionId),u.AFrameworkApplication.vp(df.a.Uh(305)),kf.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.La(K.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):xa.a.J(512496134,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",
this.la.podsNullSrmWaitTimeInMs,a,this.Fe.podSessionId)}detectFailoverTimeout(){if(this.awa){var a=+new Date-+this.awa;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.zb.Lg(this.Mze),xa.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Fe.podSessionId,this.Fe.Kk),a=Object.assign(new Ml.a,{Code:293,Source:6}),this.Rd.zs(a,this.Fe.podSessionId,b=>{b.jC=1;b.tCa=8;return!1}))}}h3k(a,
b){a&&(this.Fe.Kk!==b?xa.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Fe.Kk,b,this.Fe.podSessionId):(b=a.result)?(xa.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Fe.podSessionId,b.DocumentSessionID),this.Fe.podSessionId!==b.DocumentSessionID&&(a=this.Fe.podSessionId,this.Fe.podSessionId=b.DocumentSessionID,
this.t9c.ieh(new Pn.a(a,b.DocumentSessionID)))):xa.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Fe.podSessionId,this.Fe.Kk))}g3k(a,b){if(this.Fe.Kk!==b)xa.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Fe.Kk,b,this.Fe.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=df.a.YK(a.error.Im),c=a.error.Im);
xa.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Fe.presentationId.string,this.Fe.Kk,this.Fe.podSessionId,"",Tc.a.nf(new Date),c,b);c===df.a.Uh(241)&&(this.Ze.wA=!1,this.Ze.Lga&&this.LC.cPe(new gn(this.Ze.Yda)))}}vfa(a,b){Tc.a.LAb=new Date;Tc.a.Nsd=[];this.Fe.podSessionId!==b.gY?xa.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",
this.Fe.podSessionId,b.gY,this.Fe.Kk):(this.zb.Lg(this.Mze),xa.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",this.Fe.presentationId.string,this.Fe.Kk,b.UGb,b.gY,Tc.a.nf(this.awa||new Date),Tc.a.nf(new Date)),this.Rd.xka=!1,this.la.podsSeamlessFailoverEnabled&&this.So.instance?xa.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):
(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.gY,this.ia.La(K.a.UJb,2,a)),this.awa=null)}Do(){this.awa=null}}Object(m.a)(Fo,"PodSessionManager",null,[1287]);var bm;(function(a){a[a.active=0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(bm||(bm={}));Object(m.b)("AppVisibilityState",bm);class Bd{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(m.a)(Bd,"GetHostSessionInfoParams",null,[]);
class Nh{constructor(a,b,c,f,l,x,H,U,ja,ya){this.y$c=0;this.qHa=this.kma=this.FAe=null;this.wSg=0;this.hDe=!1;this.Xa=b;this.mEb=a;this.Ze=c;this.la=f;this.O9=l;this.GO=x;this.Tea=H;this.mc=U;this.zO=ja;this.Pwa=ya;this.HBb=0;this.hEb=this.la.getHostSessionInfoRequestTimeoutInMs;this.Hck=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.Nck=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.D6j=f.maxPopsRehydrationCount;this.oEb=this.la.R$g;this.nEb=this.la.podsPopSessionDisconnectedTimeLimitInMS;
this.Gla=!1;this.yDb=this.Xa.Kk;this.wFg="";this.Tld();this.FKa(0,!0)}Tld(){this.y$c=0;this.qHa=new Date}Eoi(a){if(this.Oka&&!u.AFrameworkApplication.Ug&&this.mc.zL){var b=!1;this.Pwa&&this.Pwa.instance&&(b=2===this.Pwa.instance.m6a,this.hDe||(this.hDe=!0,this.Pwa.instance.FGc(Object(F.a)(this,this.oJh,"visiblityChanged"))));var c=Object.assign(new Bd,{PopSessionID:this.Xa.Kk,PresentationID:this.Xa.presentationId.string,IsTabHidden:b});this.FAe=new Date;b=Math.min(this.hEb+2E3*this.y$c,this.Hck);
var f=pa.a.QH("RequestTimeout",b.toString());this.mEb.OSc(c,()=>{this.Dtk(c.PopSessionID,a)},l=>{this.Ctk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.mc.zL&&(xa.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",this.Oka,u.AFrameworkApplication.Ug,!!this.O9.instance&&this.O9.instance.$Zc,!this.mc.Gn),this.close(this.Oka?this.mc.zL?"AppShuttingDown":
"TransitionedToReadingMode":"ClientDisabled"))}FKa(a,b){this.kma=new Date;this.wSg=window.setTimeout(()=>{this.Eoi(b)},a)}VFl(a){xa.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.FAe);this.Tld();this.HBb=0;this.Ze.pne=this.qHa;this.Ze.one=a}Dtk(a,b){this.zO.Hoc();this.GO.BUf(a,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.FKa(0,b):(this.VFl(a),b&&this.FKa(this.la.getHostSessionInfoPingIntervalInMs,!0))}oJh(a,
b){xa.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",bm[b.oldState],bm[b.newState]);this.FKa(0,!1)}mpi(){return this.Tea.w$b||!this.Oka?(xa.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Tea.w$b,this.Oka,Tc.a.nf(new Date)),!1):this.HBb>this.D6j?(xa.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",
this.HBb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.GO.kbe(df.a.Uh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}Qfa(a){this.mpi()&&(++this.HBb,this.GO.Qfa(a),this.Tld())}til(a){if(df.a.xT(a))switch(df.a.YK(a)){case 326:case 240:case 103:return!0;case 329:return this.la.LVk}return!1}d9i(a){if(df.a.xT(a))switch(df.a.YK(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}Ctk(a,b,c){a.AY&&
200===a.AY.oe&&this.zO.Hoc();if(this.GO.BUf(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.FKa(0,c);else{++this.y$c;var f=+new Date-+this.qHa,l=44,x=-1;a&&a.error&&(l=df.a.xT(a.error.Im)?df.a.YK(a.error.Im):44,x=a.error.Im);a=pa.a.QH("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",x,"TimeTakenInMs",+new Date-+this.FAe,"RetryCount",this.y$c,"PopSessionDisconnectedTimeLimitInMS",this.nEb,"PopsIdleTimeLimitInMS",this.oEb,"Now",Tc.a.nf(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",
this.HBb,"LastPingScheduledTime",Tc.a.nf(this.kma),"LastSuccessfulEnsureHostSessionId",this.Ze.nne);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(H){xa.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",H)}xa.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.kma>this.nEb?this.FKa(0,c):this.til(x)?this.Qfa(this.d9i(x),x):x===df.a.Uh(370)?
f<this.oEb?this.FKa(this.la.getHostSessionInfoPingIntervalInMs,c):this.Qfa(11,x):f>=this.nEb?this.Qfa(3,x):this.FKa(this.Nck,c)}}xoe(a){const b=pa.a.QH("LastUsedPopSessionId",this.yDb,"LastClientClosedReason",this.wFg,"IsClientActive",this.Oka,"AppInEditingMode",this.mc.Gn,"PopSessionDisconnectedTimeLimitInMS",this.nEb,"PopsIdleTimeLimitInMS",this.oEb,"Now",Tc.a.nf(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.HBb,"LastPingScheduledTime",Tc.a.nf(this.kma),"LastSuccessfulEnsureHostSessionId",
this.Ze.nne);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){xa.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}xa.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}hKa(a){xa.a.J(36282957,801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Kk,this.yDb,this.Oka);this.Oka&&this.yDb===this.Xa.Kk||
(this.yDb=this.Xa.Kk,this.Tld(),this.Gla?(this.Gla=!1,this.FKa(0,!0)):xa.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Kk,this.yDb,this.Oka))}close(a){this.Gla||(xa.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Xa.Kk,Tc.a.nf(new Date),a),this.hDe&&this.Pwa&&this.Pwa.instance&&this.Pwa.instance.mZk(Object(F.a)(this,
this.oJh,"visiblityChanged")),this.Gla=!0,this.yDb="",this.wFg=a,window.clearTimeout(this.wSg))}get Oka(){return!this.Gla}}Object(m.a)(Nh,"HostSessionInfoCaller",null,[]);class Je{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.wma=null;this.mEb=a;this.Xa=b;this.Oc=c;this.Ze=f;this.la=l;this.O9=x;this.GO=H;this.Tea=U;this.mc=ja;this.zO=Va;this.Pwa=hb;this.Oc.APd(Object(F.a)(this,this.Rgb,"onPopSessionClosed"));this.Oc.KA(Object(F.a)(this,this.nxa,"onSessionEnded"));this.Ze.Lga&&this.Oc.BPd(Object(F.a)(this,
this.bZa,"onPopSessionInitialized"))}AEj(){xa.a.J(24655587,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Ze.wA?this.oIe():this.Ze.Lga||this.Ze.Nlc.task.continueWith(()=>{this.oIe()})}bZa(){this.oIe()}oIe(){this.Ze.Lga?!this.wma&&this.Ze.wA?this.wma=new Nh(this.mEb,this.Xa,this.Ze,this.la,this.O9,this.GO,this.Tea,this.mc,this.zO,this.Pwa):this.hKa("PopSessionInitialized"):this.Ze.wA&&(this.gsc(),this.wma=new Nh(this.mEb,this.Xa,this.Ze,this.la,this.O9,this.GO,this.Tea,this.mc,
this.zO,this.Pwa))}Rgb(){this.close("PopSessionClosed")}nxa(){this.xoe("SessionClosed")}xoe(a){this.wma&&this.wma.xoe(a)}gsc(){this.Ze.Nlc.task.continueWith(()=>{this.pIe()})}pIe(){this.Ze.wA&&this.hKa("PopSessionInitialized");this.gsc()}hKa(a){this.wma&&this.wma.hKa(a)}close(a){this.wma&&this.wma.close(a)}get Oka(){return!!this.wma&&this.wma.Oka}dispose(){this.Oc.Gih(Object(F.a)(this,this.Rgb,"onPopSessionClosed"));this.Ze.Lga&&this.Oc.iRe(Object(F.a)(this,this.bZa,"onPopSessionInitialized"))}}Object(m.a)(Je,
"PopSessionInfoClient",null,[1288,106]);var sj=d(285),Ee=d(224),gl=d(114),Ni=d(654),mh=d(326),Rl=d(860),An=d(847);const xp=a=>{if(df.a.xT(a)){a=df.a.YK(a);if(An.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case df.a.EDa:case df.a.N0c:return 0;default:return 3}};class Go{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.Xa=a;this.Ze=b;this.Rd=c;this.la=f;this.Kv=l;this.LC=
x;this.q$=H;this.Uea=Va;this.mc=hb;this.Tea=ja;this.gHg=this.la.hermesNotRefreshErrorList;this.yye=this.la.podsMaxRetryTimesForEnsureHostSession;this.DGg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.vg&&(U.cbi(Object(F.a)(this,this.wyk,"onSyncLoopStatusNotified")),ya.S$h(Object(F.a)(this,this.uyk,"onSuccessfulOutbound")),ya.O7(Object(F.a)(this,this.Dw,"onUnifiedAppStateChanged")));u.AFrameworkApplication.Yz&&ya.LGc(Object(F.a)(this,this.zfa,"onWopiTokenRefreshed"))}Qfa(a,b=null,c=
null){var f=this.q$.j9a(this.Xa.presentationId.string);f=Object.assign(new Ni.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Hfa,IsCoauthSession:u.AFrameworkApplication.Xg.IsCoauthSession,IsCreateNewSession:this.la.HQ,UseSharedHostFile:this.la.APb});this.q$.SIc(f,b,c,a)}rHe(a,b){if(this.CUf(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.Rgh();
else{var c=new Date;this.Xa.Kk=b.FB.PopSessionID;this.Ze.wA=!0;this.Ze.Mlc=!0;this.Ze.nne=b.FB.PopSessionID;this.Ze.ila=c;this.Ze.Lga&&this.LC.IOk();xa.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",b.TYa,b.FB.PopSessionID,b.FB.PodSessionID,this.Xa.podSessionId,Rl.a[b.trigger],b.retryCount,
Tc.a.nf(b.startTime),Tc.a.nf(c),+c-+b.startTime,b.actionId);b.KH&&b.KH(a)}}cHb(a,b){let c=a.error.Im;const f=new Date;if(this.CUf(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.Rgh();else{if(b.retryCount<this.yye&&+f-+b.startTime<=this.DGg){if(0===xp(c)||c===df.a.Uh(252)){b.retryCount++;a=this.q$.j9a(this.Xa.presentationId.string);xa.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.TYa,b.FB.PopSessionID,b.FB.PodSessionID,this.Xa.podSessionId,Rl.a[b.trigger],b.retryCount,Tc.a.nf(b.startTime),Tc.a.nf(f),+f-+b.startTime,c,b.actionId);b.FB.PopSessionID=a;b.FB.IsRetrySession=!0;this.q$.CCf(b);return}this.Ze.ila=f;var l="FatalError"}else this.Ze.ila=f,l=b.retryCount>=this.yye?String.format("Exceeded the limit of {0} times of retrying",this.yye):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.DGg,+f-+b.startTime);c===df.a.EDa&&(c=0===b.trigger?df.a.Uh(375):df.a.Uh(309));xa.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.TYa,b.FB.PopSessionID,b.FB.PodSessionID,this.Xa.podSessionId,Rl.a[b.trigger],b.retryCount,Tc.a.nf(b.startTime),
Tc.a.nf(f),+f-+b.startTime,c,l,b.actionId);b.$s&&b.$s(a)||this.kbe(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}CUf(a,b){return a.FB.PodSessionID!==this.Xa.podSessionId?(xa.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Xa.podSessionId,a.FB.PodSessionID,b),!0):!1}Rgh(){this.Ze.ila=new Date;this.Qfa(8)}wyk(a,b){a=df.a.Uh(b.Nzh);xa.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.Nzh,a,this.Xa.Kk,this.Xa.podSessionId);this.Ze.wA=!1;this.Ze.Lga&&this.LC.cPe(new gn(this.Ze.Yda));this.kbe(a,"PopSessionManager::OnSyncLoopStatusNotified",b.wUi)}zfa(a,b){try{b.t0c?(xa.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.SRj||(this.Lsb(()=>{},()=>{}),this.Qfa(9))):xa.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){xa.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}BUf(a,b){return a&&this.Xa.Kk&&this.Xa.Kk!==a?(xa.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Xa.Kk,a,this.Ze.Yda),!0):!1}kbe(a,b,c=null){xa.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.fsj(a)){if(u.AFrameworkApplication.Yz&&
a===df.a.Uh(320)){const f=sj.a.instance.X6a();if(f){xa.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.Kv.sbe(a,b)||this.U_d(a,b,c)}}Lsb(a,b,c=!1){xa.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Xa.Kk,this.Xa.podSessionId,this.Ze.wA,this.Ze.Yda,this.Ze.Vhd);if(this.Ze.wA||!this.Ze.Vhd){if(this.C3e(c,
""))a(new mh.a(null)),xa.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=u.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.Uea.XJc(this.Ze.Yda,this.Xa.podSessionId,this.Xa.presentationId.string,u.AFrameworkApplication.fa.appSettings["361"],this.Xa.iaa,c,a,b,null,f)}this.Ze.wA=!1;this.Ze.Vhd=!0;this.LC.cPe(new gn(this.Ze.Yda))}}C3e(a,b){if(!B.a.rsb())return!1;try{const c=this.M3i(a,b),f=this.D5d();u.AFrameworkApplication.Ke.LKa(f,c);
return!0}catch(c){return xa.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}M3i(a,b){const c={};c.popSessionID=this.Ze.Yda;c.podSessionID=b.length?b:this.Xa.podSessionId;c.presentationID=this.Xa.presentationId.string;c.podUrl=u.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Xa.iaa;c.fTimeoutOrUserClose=a;return gl.c(c)}D5d(){var a=u.AFrameworkApplication.fa.Ga("368")+u.AFrameworkApplication.fa.Ga("367")+"/ClosePopWacSession";a=new Ee.QueryStringBuilder(a);
a.Pz(u.AFrameworkApplication.N1a,u.AFrameworkApplication.userSessionId);a.Pz(u.AFrameworkApplication.JSd,u.AFrameworkApplication.buildVersion);a.Pz("waccluster",this.Xa.pk);a.Pz("WacUserType",u.AFrameworkApplication.userType);a.Pz(u.AFrameworkApplication.ZAb,u.AFrameworkApplication.$1c);a.Pz(u.AFrameworkApplication.WV,u.AFrameworkApplication.accessToken);a.Pz(u.AFrameworkApplication.hca,u.AFrameworkApplication.im.toString());a.Pz("X-UsePopsRole",this.Xa.Iza.toString());a.Pz("X-PopsAffinityRoutingEnabled",
this.Xa.BFa.toString());return a=a.toString()}fsj(a){if(a!==df.a.Uh(245))return!1;if(this.Ze.Cog>this.Ze.ila&&this.Ze.wA)return xa.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Ze.Cog=new Date;this.vEf(0);return!0}vEf(a){const b=this.Xa.podSessionId;this.Tea.sfj(()=>{if(b!==this.Xa.podSessionId)xa.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Xa.podSessionId);else{var c=df.a.Uh(245);this.Kv.sbe(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.U_d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Xa.podSessionId?xa.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId):this.Tea.w$b?xa.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.tfj?(xa.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.vEf(a+1)):(xa.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Rd.zs(Object.assign(new Ml.a,{Code:223,Source:6}),b))})}U_d(a,b,c=null){xa.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=df.a.YK(a);df.a.xT(a)?(a=Object.assign(new Ml.a,{Code:df.a.YK(a),Source:5,ExtraErrorParam:c}),this.Rd.zs(a,this.Xa.podSessionId,l=>{l.jC=1;Array.contains(this.gHg,dk.a[f].toUpperCase())||(l.tCa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.gHg,dk.a[f].toUpperCase())||(b=8),this.Rd.ysa(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}uyk(){this.Ze.wA||(xa.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Xa.Kk,!this.Xa.presentationId.string),this.Qfa(5))}Dw(a,b){Ud.a("Pops.CloseSessionDueToReadonly")&&b.bke&&!this.mc.zL&&this.Ze.wA&&(xa.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.Lsb(()=>{},()=>{}))}}Object(m.a)(Go,"PopSessionManager",null,[1286]);class Bn{get name(){return"PowerPointWebEditor.PodsPops"}Zb(a){a.register(1286,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().oa(()=>new Go(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1287,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().oa(()=>
new Fo(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.Ke,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ja("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1288,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().oa(()=>
new Je(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ja("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ja("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){z.a.instance.Dc(new Bn)}}Object(m.a)(Bn,"PPTWebEditorPodsPopsPackage",null,[2,3]);class Ho{constructor(a,b,c,f,l){this.g$=new Ka.a;this.occ=this.pcc=null;this.kwg=this.Ycc=0;this.hwe=this.gwe=!1;this.vCb=Rf.a.Ifa(2,0,!1);this.qYa=Rf.a.Ifa(2,1,!1);this.Iad=a;this.Ldc=c;this.il=f;this.Mq=b;this.xGg=l}get Ic(){return this.Ldc.Ic}J5g(a,b,c,f){if(!b)return!1;
this.gwe||(this.Ycc=Date.now(),this.gwe=!0);b=!1;try{if(this.il.Vxf(c.shapeNode)){this.g$.clear();this.joi();const l=this.V5i(c);if(a){const H=this.il.ckj(this.il.GI(c,a),this.GSa(l),this.Ic,this.vCb,this.qYa);if(H.top||H.bottom||H.left||H.right)b=!0,this.il.Krc(c,H);if(this.xGg){const U=this.il.g9i(this.il.GI(c,a),l,this.vCb,this.qYa,f);if(U.top||U.bottom||U.left||U.right)b=!0,this.il.Krc(c,U);const ja=this.il.h9i(this.il.GI(c,a),l,this.Ic,this.qYa,f,a);if(ja.top||ja.bottom||ja.left||ja.right)b=
!0,this.il.Krc(c,ja);const ya=this.il.vcj(this.il.GI(c,a),l,this.Ic,this.qYa,f,a);if(ya.top||ya.bottom||ya.left||ya.right)b=!0,this.il.Krc(c,ya)}}else b=this.il.yol(c,this.il.GI(c,a),this.GSa(l),this.Ic,this.vCb,this.qYa);this.g$.addRange(this.il.Sni(this.il.GI(c,a),this.GSa(l),this.Ic));const x=this.il.Gsb(this.il.GI(c,a),this.GSa(l));if(x.count)this.g$.addRange(x);else if(!b){let H;H=a?this.il.xol(this.il.GI(c,!0),this.GSa(l),c):this.il.wol(this.il.GI(c,!1),this.GSa(l),c,this.qYa,this.vCb);this.g$.addRange(H);
b=!!H&&0<H.count}if(this.xGg)if(a)this.g$.addRange(this.il.DTd(this.il.GI(c,a),this.il.CSa(l),this.Ic,f,a)),this.g$.addRange(this.il.P6a(this.il.GI(c,a),this.il.CSa(l),this.Ic,f,a)),this.g$.addRange(this.il.aoi(this.il.GI(c,a),this.il.CSa(l),f));else{const H=this.il.P6a(this.il.GI(c,a),this.il.CSa(l),this.Ic,f,a);if(H.count)this.g$.addRange(H);else if(!b){const ja=this.il.lxh(this.il.GI(c,!1),this.GSa(l),c,this.Ic,this.qYa,this.vCb);this.g$.addRange(this.il.P6a(this.il.GI(c,a),this.il.CSa(l),this.Ic,
f,a));b=ja}const U=this.il.DTd(this.il.GI(c,a),this.il.CSa(l),this.Ic,f,a);if(U.count)this.g$.addRange(U);else if(!b){const ja=this.il.lxh(this.il.GI(c,!1),this.GSa(l),c,this.Ic,this.qYa,this.vCb);this.g$.addRange(this.il.DTd(this.il.GI(c,a),this.il.CSa(l),this.Ic,f,a));b=ja}}this.Iad.kQf(this.g$.toArray());this.Iad.visible=!0}}catch(l){this.hwe||(xa.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.hwe=!0)}return b}N5g(a){a&&(this.Iad.visible=!1,this.occ=this.pcc=null,this.g$.clear(),
this.Iad.kQf([]),this.kwg=Date.now(),this.hwe=this.gwe=!1,xa.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.kwg-this.Ycc).toString()))}joi(){this.il.I0g=this.Mq.Qm(this.Ic.CU.offsetLeft-this.Ic.Qc.scrollLeft);this.il.J0g=this.Mq.Qm(this.Ic.CU.offsetTop-this.Ic.Qc.scrollTop)}V5i(a){return this.pcc?this.pcc:this.pcc=this.il.U5i(this.il.mjj(this.Ic,this.Ic.Ma),a)}GSa(a){return this.occ?this.occ:this.occ=this.il.CSa(a)}}Object(m.a)(Ho,"SmartGuideManager",null,[1281]);var ei=d(132),te=d(167),
Oi=d(195),hd=d(58),Kj=d(162);class jg{constructor(){this.Y3c=this.rGa=null;this.E5c=0;this.Rcb=this.tfb=null;this.bff=!1}get color(){return this.rGa}set color(a){this.rGa=a}get dashStyle(){return this.Y3c}set dashStyle(a){this.Y3c=a}get j7b(){return this.E5c}set j7b(a){this.E5c=a}get Nf(){return this.tfb}set Nf(a){this.tfb=a}get Eg(){return this.Rcb}set Eg(a){this.Rcb=a}get hH(){return this.bff}set hH(a){this.bff=a}length(){let a=-1;this.tfb&&this.Rcb&&(a=Math.sqrt(Math.pow(this.Rcb._x-this.tfb._x,
2)+Math.pow(this.Rcb._y-this.tfb._y,2)));return a}reset(){const a=new jg;this.rGa=a.rGa;this.Y3c=a.Y3c;this.E5c=a.E5c;this.tfb=a.tfb;this.Rcb=a.Rcb}}Object(m.a)(jg,"SmartGuideLine",null,[1353]);class bp{constructor(a,b,c,f){this.distance=a;this.jSd=b;this.i1d=c;this.direction=f}}Object(m.a)(bp,"DistancePair",null,[]);class cp{constructor(a,b){this.shape=a;this.Fk=b}}Object(m.a)(cp,"LightSet",null,[]);class Sl{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(m.a)(Sl,
"LightSetItem",null,[]);class Im{constructor(){this.Kcb={};this.rFg=[]}ga(a){return this.Kcb[a]}$(a,b){a in this.Kcb||this.rFg.push(a);return this.Kcb[a]=b}get keys(){return this.rFg}}Object(m.a)(Im,"NumberDictionary",null,[]);class Rh{constructor(a,b){this.first=a;this.second=b}}Object(m.a)(Rh,"NumberPair",null,[]);var Gk=d(661);class Lj{constructor(a,b){this.gBe=[];this.wg=5;this.k4=this.Bw=2;this.xO=4;this.qB=3;this.S8c=this.R8c=0;this.Mq=a;this.lFb=b}mjj(a,b){a=tb.GraphIterator.nb(a.gb);const c=
[];for(var f=a.Bb(1);f;f=a.Cf(1))f=Kj.a(f,b),c.push(f);return c}GI(a,b){for(const c of this.gBe)if(c.mG(a))return c.GI(a,b);return null}addHandler(a){this.gBe.push(a)}wol(a,b,c,f,l){f=this.erd(f,Lj.AIc);l=this.erd(l,Lj.AIc);for(var x of f){f=a.copy();f.move(0,0-x);f=this.Gsb(f,b);if(f.count)return this.rLa(c,0,-x),f;f=a.copy();f.move(0,x);f=this.Gsb(f,b);if(f.count)return this.rLa(c,0,x),f}for(let H of l){x=a.copy();x.move(0-H,0);x=this.Gsb(x,b);if(x.count)return this.rLa(c,-1*H,0),x;x=a.copy();x.move(H,
0);x=this.Gsb(x,b);if(x.count)return this.rLa(c,H,0),x}return new Ka.a}erd(a,b){const c=new Ka.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}xol(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.Gsb(f,b),f.count)return this.Krc(c,l),f;return new Ka.a}CSa(a){const b=[];for(const c of a)b.push(new Gk.a(c.us()));return b}yol(a,b,c,f,l,x){const H=new hd.a(Number.MAX_VALUE,Number.MAX_VALUE);let U=Number.MAX_VALUE;var ja=Number.MAX_VALUE;let ya=[];for(const Va of c)ya.push(Va);
this.lFb&&(ya=this.u7h(ya,f));for(const Va of ya)c=this.Qcj(b,Va,U),Math.abs(H.y)>Math.abs(c)&&(H.y=c),U=Math.abs(c),c=this.Ocj(b,Va,ja),Math.abs(H.x)>Math.abs(c)&&(H.x=c),ja=Math.abs(c);ja=this.E8i(b,U,f);Math.abs(H.y)>Math.abs(ja)&&(H.y=ja);ja=this.D8i(b,U,f);Math.abs(H.x)>Math.abs(ja)&&(H.x=ja);Math.abs(H.x)>l&&(H.x=0);Math.abs(H.y)>x&&(H.y=0);return H.x||H.y?(this.rLa(a,H.x,H.y),!0):!1}u7h(a,b){var c=this.Mq.Qm(b.te.width);b=this.Mq.Qm(b.te.height);var f=new Gk.a(new ei.a(new hd.a(0,0),new hd.a(c,
0),new hd.a(c,b),new hd.a(0,b)));a.push(f);f=new Gk.a(new ei.a(new hd.a(0,0),new hd.a(c,0),new hd.a(c,b/2),new hd.a(0,b/2)));a.push(f);c=new Gk.a(new ei.a(new hd.a(0,0),new hd.a(c/2,0),new hd.a(c/2,b),new hd.a(0,b)));a.push(c);return a}Krc(a,b){this.KVc(a,c=>{c.setOffsets(a,b)})}rLa(a,b,c){this.KVc(a,f=>{f.setPosition(a,b,c)})}KVc(a,b){for(const c of this.gBe)if(c.mG(a)){b(c);break}}ckj(a,b,c,f,l){let x=Number.MAX_VALUE,H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE;var ya=[];for(var Va of b)ya.push(Va.copy());
b=this.Mq.Qm(c.te.width);c=this.Mq.Qm(c.te.height);Va=new Gk.a(new ei.a(new hd.a(0,0),new hd.a(b,0),new hd.a(b,c),new hd.a(0,c)));ya.push(Va);this.lFb&&(Va=new Gk.a(new ei.a(new hd.a(0,0),new hd.a(b,0),new hd.a(b,c/2),new hd.a(0,c/2))),ya.push(Va),b=new Gk.a(new ei.a(new hd.a(0,0),new hd.a(b/2,0),new hd.a(b/2,c),new hd.a(0,c))),ya.push(b));for(const hb of ya)ya=this.Cnd([hb.Yb-a.kc,hb.kc-a.kc,hb.Wf().y-a.kc],l),this.GT(ya,l)&&Math.abs(ya)<Math.abs(x)&&(x=ya),ya=this.Cnd([hb.Yb-a.Yb,hb.kc-a.Yb,hb.Wf().y-
a.Yb],l),this.GT(ya,l)&&Math.abs(ya)<Math.abs(H)&&(H=ya),ya=this.Cnd([hb.hc-a.hc,hb.$b-a.hc,hb.Wf().x-a.hc],f),this.GT(ya,f)&&Math.abs(ya)<Math.abs(U)&&(U=ya),ya=this.Cnd([hb.hc-a.$b,hb.$b-a.$b,hb.Wf().x-a.$b],f),this.GT(ya,f)&&Math.abs(ya)<Math.abs(ja)&&(ja=ya);a=new Oi.a;a.top=x===Number.MAX_VALUE?a.top:x;a.bottom=H===Number.MAX_VALUE?a.bottom:H;a.left=U===Number.MAX_VALUE?a.left:U;a.right=ja===Number.MAX_VALUE?a.right:ja;return a}Vxf(a){return a.zua||a.Fj||a.fl||a.hr||a.Rf}n8i(a,b){return Math.abs(a-
b)}Qcj(a,b,c){a=[new Rh(a.kc,b.kc),new Rh(a.kc,b.Yb),new Rh(a.kc,b.Wf().y),new Rh(a.Yb,b.kc),new Rh(a.Yb,b.Yb),new Rh(a.Yb,b.Wf().y),new Rh(a.Wf().y,b.kc),new Rh(a.Wf().y,b.Yb),new Rh(a.Wf().y,b.Wf().y)];return this.kTc(a,c)}Ocj(a,b,c){a=[new Rh(a.hc,b.hc),new Rh(a.hc,b.$b),new Rh(a.hc,b.Wf().x),new Rh(a.$b,b.hc),new Rh(a.$b,b.$b),new Rh(a.$b,b.Wf().x),new Rh(a.Wf().x,b.hc),new Rh(a.Wf().x,b.$b),new Rh(a.Wf().x,b.Wf().x)];return this.kTc(a,c)}E8i(a,b,c){c=this.Mq.Qm(c.te.height);a=[new Rh(a.kc,0),
new Rh(a.kc,c),new Rh(a.Yb,0),new Rh(a.Yb,c),new Rh(a.Wf().y,0),new Rh(a.Wf().y,c)];return this.kTc(a,b)}D8i(a,b,c){c=this.Mq.Qm(c.te.width);a=[new Rh(a.hc,0),new Rh(a.hc,c),new Rh(a.$b,0),new Rh(a.$b,c),new Rh(a.Wf().x,0),new Rh(a.Wf().x,c)];return this.kTc(a,b)}kTc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.n8i(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}GT(a,b){a=Math.abs(a);return.2<a&&a<b}Cnd(a,b){let c=Number.MAX_VALUE;for(const f of a)this.GT(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}U5i(a,b){const c=new Ka.a;for(const f of a)this.Vxf(f.shapeNode)&&f.gb!==b.gb&&c.add(f);return c.toArray()}Gsb(a,b){var c=new Ka.a;c.add(a);var f=new Ka.a;f.add(a);var l=new Ka.a;l.add(a);var x=new Ka.a;x.add(a);for(const H of b)H.Yb<a.kc||H.kc>a.Yb||(H.hc<a.hc&&this.NFc(c,H,2),H.$b>a.$b&&this.NFc(f,H,3)),H.$b<a.hc||H.hc>a.$b||(H.kc<a.kc&&this.NFc(l,H,0),H.Yb>a.Yb&&this.NFc(x,H,1));a=this.pTc(c,2);f=this.pTc(f,3);b=this.pTc(l,0);c=this.pTc(x,1);x=new Im;this.KLc(x,a[0]);this.KLc(x,
f[0]);l=new Im;this.KLc(l,b[0]);this.KLc(l,c[0]);this.IPc(x,a,2);this.IPc(x,f,3);this.IPc(l,b,0);this.IPc(l,c,1);a=new Ka.a;f=new Ka.a;this.jKf(x,a,f);this.jKf(l,a,f);this.Q0a(a,1);this.Q0a(f,2);a.addRange(f);for(let H of a)this.Pv(H);return a}pTc(a,b){const c=new Ka.a;for(let l=0;l<a.count;++l){var f=new Sl(this.w7i(a,l,b),this.O7i(a,l,b),null,-1);f=new cp(a.ga(l),[f]);for(let x=l+1;x<a.count;++x){const H=f.Fk.length;let U=H;for(let ja=0;ja<H;++ja)if(!f.Fk[ja].shape&&-1===f.Fk[ja].distance&&f.Fk[ja].end>
f.Fk[ja].begin){const ya=this.o8i(a,l,x,b);U+=this.ZJk(a,x,ja,U,l,ya,f,b);U+=this.aKk(a,x,ja,U,l,ya,f,b);U+=this.QKk(a,x,ja,U,l,ya,f,b);U+=this.$Jk(a,x,ja,l,ya,f,b)}}c.add(f)}return c.toArray()}jKf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const x=new Ka.a;for(let H of f){f=!1;for(let U of x)if(this.wfi(H,U)){f=!0;x.remove(U);break}f||x.add(H)}for(let H of x)this.nEi(H,b,c)}}}wfi(a,b){return this.Qxf(a.jSd,b.jSd)&&this.Qxf(a.i1d,b.i1d)}Qxf(a,b){return a.hc===b.hc&&a.$b===b.$b&&a.kc===
b.kc&&a.Yb===b.Yb}NFc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const x=a.ga(l);if(3===c&&(b.hc<a.ga(0).$b?b.$b:b.hc)<(x.hc<a.ga(0).$b?x.$b:x.hc)||2===c&&(b.$b>a.ga(0).hc?b.hc:b.$b)>(x.$b>a.ga(0).hc?x.hc:x.$b)||0===c&&(b.Yb>a.ga(0).kc?b.kc:b.Yb)>(x.Yb>a.ga(0).kc?x.kc:x.Yb)||1===c&&(b.kc<a.ga(0).Yb?b.Yb:b.kc)<(x.kc<a.ga(0).Yb?x.Yb:x.kc)){a.insert(l,b);return}}a.add(b)}KLc(a,b){for(const c of b.Fk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Ka.a)}IPc(a,b,c){const f=new Im;for(const l of b){for(const x of a.keys)f.$(x,
0);for(const x of l.Fk)if(0<x.distance&&x.shape)for(const H of a.keys)if(b=H,this.Ju(x.distance,b)){const U=f.ga(H);1>U&&(a.ga(H).add(new bp(b,l.shape,x.shape,c)),f.$(H,U+1));break}}}w7i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.kc,a.kc);case 0:case 1:return Math.max(b.hc,a.hc);default:return-1}}O7i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Yb,a.Yb);case 0:case 1:return Math.min(b.$b,a.$b);default:return-1}}ZJk(a,b,c,f,l,x,H,U){const ja=a.ga(b);
l=a.ga(l);switch(U){case 3:case 2:if(ja.Yb>=H.Fk[c].begin&&ja.Yb<=H.Fk[c].end&&ja.kc<=H.Fk[c].begin)return a=new Sl(H.Fk[c].begin,ja.Yb,a.ga(b),3===U?x-l.$b:l.hc-x),H.Fk[f]=a,H.Fk[c].begin=ja.Yb,1;break;case 0:case 1:if(ja.$b>=H.Fk[c].begin&&ja.$b<=H.Fk[c].end&&ja.hc<=H.Fk[c].begin)return a=new Sl(H.Fk[c].begin,ja.$b,a.ga(b),0===U?l.kc-x:x-l.Yb),H.Fk[f]=a,H.Fk[c].begin=ja.$b,1}return 0}aKk(a,b,c,f,l,x,H,U){const ja=a.ga(b);l=a.ga(l);switch(U){case 3:case 2:if(ja.kc>=H.Fk[c].begin&&ja.kc<=H.Fk[c].end&&
ja.Yb>=H.Fk[c].end)return a=new Sl(ja.kc,H.Fk[c].end,a.ga(b),3===U?x-l.$b:l.hc-x),H.Fk[f]=a,H.Fk[c].end=ja.kc,1;break;case 0:case 1:if(ja.hc>=H.Fk[c].begin&&ja.hc<=H.Fk[c].end&&ja.$b>=H.Fk[c].end)return a=new Sl(ja.hc,H.Fk[c].end,a.ga(b),0===U?l.kc-x:x-l.Yb),H.Fk[f]=a,H.Fk[c].end=ja.hc,1}return 0}QKk(a,b,c,f,l,x,H,U){const ja=a.ga(b);l=a.ga(l);switch(U){case 3:case 2:if(ja.kc>H.Fk[c].begin&&ja.kc<H.Fk[c].end&&ja.Yb>H.Fk[c].begin&&ja.Yb<H.Fk[c].end)return a=new Sl(ja.kc,ja.Yb,a.ga(b),3===U?x-l.$b:
l.hc-x),H.Fk[f]=a,a=new Sl(ja.Yb,H.Fk[c].end,null,-1),H.Fk[++f]=a,H.Fk[c].end=ja.kc,2;break;case 0:case 1:if(ja.hc>H.Fk[c].begin&&ja.hc<H.Fk[c].end&&ja.$b>H.Fk[c].begin&&ja.$b<H.Fk[c].end)return a=new Sl(ja.hc,ja.$b,a.ga(b),0===U?l.kc-x:x-l.Yb),H.Fk[f]=a,a=new Sl(ja.$b,H.Fk[c].end,null,-1),H.Fk[++f]=a,H.Fk[c].end=ja.hc,2}return 0}$Jk(a,b,c,f,l,x,H){const U=a.ga(b);f=a.ga(f);switch(H){case 3:case 2:U.kc<x.Fk[c].begin&&U.Yb>x.Fk[c].end&&(x.Fk[c].shape=a.ga(b),x.Fk[c].distance=3===H?l-f.$b:f.hc-l);break;
case 0:case 1:U.hc<x.Fk[c].begin&&U.$b>x.Fk[c].end&&(x.Fk[c].shape=a.ga(b),x.Fk[c].distance=0===H?f.kc-l:l-f.Yb)}return 0}o8i(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.hc<a.$b&&c.$b>=a.$b&&(l=c.$b);c.hc>=a.$b&&(l=c.hc);break;case 2:c.$b>a.hc&&c.hc<=a.hc&&(l=c.hc);c.$b<=a.hc&&(l=c.$b);break;case 0:c.Yb>a.kc&&c.kc<=a.kc&&(l=c.kc);c.Yb<=a.kc&&(l=c.Yb);break;case 1:c.kc<a.Yb&&c.Yb>=a.Yb&&(l=c.Yb),c.kc>=a.Yb&&(l=c.kc)}return l}nEi(a,b,c){const f=a.jSd;var l=a.i1d;switch(a.direction){case 3:var x=
Math.max(f.Yb,l.Yb),H=new jg;H.Nf=new hd.a(f.$b-this.qB,f.kc);H.Eg=new hd.a(f.$b-this.qB,x+this.wg);b.add(H);H=new jg;H.Nf=new hd.a(f.$b+a.distance-this.qB,l.kc);H.Eg=new hd.a(f.$b+a.distance-this.qB,x+this.wg);b.add(H);b=new jg;b.Nf=new hd.a(f.$b-this.qB,x+this.wg);b.Eg=new hd.a(f.$b+a.distance-this.qB,x+this.wg);c.add(b);break;case 2:x=Math.max(f.Yb,l.Yb);H=new jg;H.Nf=new hd.a(f.hc-a.distance-this.qB,l.kc);H.Eg=new hd.a(f.hc-a.distance-this.qB,x+this.wg);b.add(H);l=new jg;l.Nf=new hd.a(f.hc-this.qB,
f.kc);l.Eg=new hd.a(f.hc-this.qB,x+this.wg);b.add(l);b=new jg;b.Nf=new hd.a(f.hc-a.distance-this.qB,x+this.wg);b.Eg=new hd.a(f.hc-this.qB,x+this.wg);c.add(b);break;case 0:x=Math.max(f.$b,l.$b);H=new jg;H.Nf=new hd.a(f.hc,f.kc-this.Bw);H.Eg=new hd.a(x+this.wg,f.kc-this.Bw);b.add(H);H=new jg;H.Nf=new hd.a(l.hc,f.kc-a.distance-this.Bw);H.Eg=new hd.a(x+this.wg,f.kc-a.distance-this.Bw);b.add(H);b=new jg;b.Nf=new hd.a(x+this.wg,f.kc-this.Bw);b.Eg=new hd.a(x+this.wg,f.kc-a.distance-this.Bw);c.add(b);break;
case 1:x=Math.max(f.$b,l.$b),H=new jg,H.Nf=new hd.a(f.hc,f.Yb-this.Bw),H.Eg=new hd.a(x+this.wg,f.Yb-this.Bw),b.add(H),H=new jg,H.Nf=new hd.a(l.hc,f.Yb+a.distance-this.Bw),H.Eg=new hd.a(x+this.wg,f.Yb+a.distance-this.Bw),b.add(H),b=new jg,b.Nf=new hd.a(x+this.wg,f.Yb-this.Bw),b.Eg=new hd.a(x+this.wg,f.Yb+a.distance-this.Bw),c.add(b)}}aoi(a,b,c){const f=new Ka.a;if(!c)return f;let l=!1;var x=!1;const H=c.equals(te.a.west)||c.equals(te.a.Qu)||c.equals(te.a.PH),U=c.equals(te.a.east)||c.equals(te.a.DE)||
c.equals(te.a.VE),ja=c.equals(te.a.north)||c.equals(te.a.Qu)||c.equals(te.a.DE);c=c.equals(te.a.south)||c.equals(te.a.PH)||c.equals(te.a.VE);for(const Va of b){if(this.pmg(a,Va,!0,b)&&(H||U)){l=!0;var ya=new jg;ya.Nf=new hd.a(Va.hc,Va.Wf()._y);ya.Eg=new hd.a(Va.$b-this.qB,Va.Wf()._y);ya.hH=!0;f.add(this.Pv(ya))}this.pmg(a,Va,!1,b)&&(ja||c)&&(x=!0,ya=new jg,ya.Nf=new hd.a(Va.Wf()._x,Va.kc),ya.Eg=new hd.a(Va.Wf()._x,Va.Yb-this.k4),ya.hH=!1,f.add(this.Pv(ya)))}l&&(b=new jg,b.Nf=new hd.a(a.hc,a.Wf()._y),
b.Eg=new hd.a(a.$b-this.qB,a.Wf()._y),b.hH=!0,f.add(this.Pv(b)));x&&(x=new jg,x.Nf=new hd.a(a.Wf()._x,a.kc),x.Eg=new hd.a(a.Wf()._x,a.Yb-this.k4),x.hH=!1,f.add(this.Pv(x)));this.Q0a(f,2);return f}w5(a,b,c){var f=this.Dda(a,b,!1),l=this.Dda(a,b,!0);if(!f&&!l)return!1;let x=[];if(f){if(a.$b<=b.hc||a.$b<=b.$b){var H;var U=b.kc>a.kc?b.kc:a.kc;var ja=b.Yb<a.Yb?b.Yb:a.Yb;f=H=b.hc;a.$b>b.hc&&(f=H=b.$b);f=new Gk.a(new ei.a(new hd.a(f,U),new hd.a(H,U),new hd.a(H,ja),new hd.a(f,ja)));Array.add(x,f)}if(a.hc>=
b.$b||a.hc>=b.hc)U=b.kc>a.kc?b.kc:a.kc,ja=b.Yb<a.Yb?b.Yb:a.Yb,f=H=b.$b,a.hc<b.$b&&(f=H=b.hc),f=new Gk.a(new ei.a(new hd.a(f,U),new hd.a(H,U),new hd.a(H,ja),new hd.a(f,ja))),Array.add(x,f)}if(l){if(a.Yb<=b.kc||a.Yb<=b.Yb)l=b.hc>a.hc?b.hc:a.hc,U=b.$b<a.$b?b.$b:a.$b,f=H=b.kc,a.Yb>b.kc&&(f=H=b.Yb),l=new Gk.a(new ei.a(new hd.a(l,f),new hd.a(U,f),new hd.a(U,H),new hd.a(l,H))),Array.add(x,l);if(a.kc>=b.Yb||a.kc>=b.kc)l=b.hc>a.hc?b.hc:a.hc,U=b.$b<a.$b?b.$b:a.$b,f=H=b.Yb,a.kc<b.Yb&&(f=H=b.kc),l=new Gk.a(new ei.a(new hd.a(l,
f),new hd.a(U,f),new hd.a(U,H),new hd.a(l,H))),Array.add(x,l)}for(const ya of c)this.xbg(ya,a)||this.xbg(ya,b)||(x=this.jEl(a,ya,x));return 0<x.length?!0:!1}jEl(a,b,c){let f=[];for(const l of c)c=!0,l.hc===l.$b?(this.Dda(l,b,!1)||(c=!1),a.$b<=l.hc&&b.$b<=a.$b&&(c=!1),a.$b<=l.hc&&b.hc>=l.$b&&(c=!1),a.hc>=l.$b&&b.hc>=a.hc&&(c=!1),a.hc>=l.$b&&b.$b<=l.hc&&(c=!1),c?b.kc<=l.kc&&b.Yb<l.Yb?f=this.nPb(f,!0,!0,!1,l,b):b.Yb>=l.Yb&&b.kc>l.kc?f=this.nPb(f,!0,!1,!1,l,b):b.kc>l.kc&&b.Yb<l.Yb&&(f=this.nPb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.kc===l.Yb&&(this.Dda(l,b,!0)||(c=!1),a.Yb<=l.kc&&b.Yb<=a.Yb&&(c=!1),a.Yb<=l.kc&&b.kc>=l.Yb&&(c=!1),a.kc>=l.Yb&&b.kc>=a.kc&&(c=!1),a.kc>=l.Yb&&b.Yb<=l.kc&&(c=!1),c?b.hc<=l.hc&&b.$b<l.$b?f=this.nPb(f,!1,!0,!1,l,b):b.$b>=l.$b&&b.hc>l.hc?f=this.nPb(f,!1,!1,!1,l,b):b.hc>l.hc&&b.$b<l.$b&&(f=this.nPb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}nPb(a,b,c,f,l,x){let H,U,ja,ya,Va,hb,yb;if(c)b?(c=U=l.hc,H=x.Yb,ja=l.Yb):(H=ja=l.kc,c=x.$b,U=l.$b);else if(c||f){if(b?(c=U=ya=hb=l.hc,H=l.kc,
ja=x.kc,Va=x.Yb,yb=l.Yb):(H=ja=Va=yb=l.kc,c=l.hc,U=x.hc,ya=x.$b,hb=l.$b),f&&b&&!this.Ju(Va,yb)||f&&!b&&!this.Ju(ya,hb))f=new Gk.a(new ei.a(new hd.a(ya,Va),new hd.a(hb,Va),new hd.a(hb,yb),new hd.a(ya,yb))),Array.add(a,f)}else b?(c=U=l.hc,H=l.kc,ja=x.kc):(H=ja=l.kc,c=l.hc,U=x.hc);if(b&&!this.Ju(H,ja)||!b&&!this.Ju(c,U))b=new Gk.a(new ei.a(new hd.a(c,H),new hd.a(U,H),new hd.a(U,ja),new hd.a(c,ja))),Array.add(a,b);return a}xbg(a,b){return a.$b!==b.$b||a.hc!==b.hc||a.kc!==b.kc||a.Yb!==b.Yb?!1:!0}pmg(a,
b,c,f){if(c)return c=this.Ju(a.hc,b.hc)&&this.Ju(a.$b,b.$b),this.Ju(a.$b-a.hc,b.$b-b.hc)&&!c&&this.w5(a,b,f);c=this.Ju(a.kc,b.kc)&&this.Ju(a.Yb,b.Yb);return this.Ju(a.Yb-a.kc,b.Yb-b.kc)&&!c&&this.w5(a,b,f)}g9i(a,b,c,f,l){const x=new Oi.a;if(!l)return x;let H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,ya=Number.MAX_VALUE;const Va=l.equals(te.a.west)||l.equals(te.a.Qu)||l.equals(te.a.PH),hb=l.equals(te.a.east)||l.equals(te.a.DE)||l.equals(te.a.VE),yb=l.equals(te.a.north)||l.equals(te.a.Qu)||
l.equals(te.a.DE);l=l.equals(te.a.south)||l.equals(te.a.PH)||l.equals(te.a.VE);const Zb=[];for(const fc of b)Zb.push(new Gk.a(fc.us()));for(const fc of Zb)b=fc.Yb-fc.kc-(a.Yb-a.kc),this.GT(b,f)&&Math.abs(b)<Math.abs(H)&&this.w5(a,fc,Zb)&&yb&&(H=-1*b),this.GT(b,f)&&Math.abs(b)<Math.abs(U)&&this.w5(a,fc,Zb)&&l&&(U=b),b=fc.$b-fc.hc-(a.$b-a.hc),this.GT(b,c)&&Math.abs(b)<Math.abs(ja)&&this.w5(a,fc,Zb)&&Va&&(ja=-1*b),this.GT(b,c)&&Math.abs(b)<Math.abs(ya)&&this.w5(a,fc,Zb)&&hb&&(ya=b);x.top=H===Number.MAX_VALUE?
x.top:H;x.bottom=U===Number.MAX_VALUE?x.bottom:U;x.left=ja===Number.MAX_VALUE?x.left:ja;x.right=ya===Number.MAX_VALUE?x.right:ya;return x}h9i(a,b,c,f,l,x){let H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,ya=Number.MAX_VALUE,Va=!0,hb=!0,yb=!0,Zb=!0;x&&l&&(Va=l.equals(te.a.west)||l.equals(te.a.Qu)||l.equals(te.a.PH),hb=l.equals(te.a.east)||l.equals(te.a.DE)||l.equals(te.a.VE),yb=l.equals(te.a.north)||l.equals(te.a.Qu)||l.equals(te.a.DE),Zb=l.equals(te.a.south)||l.equals(te.a.PH)||l.equals(te.a.VE));
l=[];for(var fc of b)l.push(new Gk.a(fc.us()));b=this.Mq.Qm(c.te.width);c=this.Mq.Qm(c.te.height);for(const Kc of l)Kc.hc>b/2&&Kc.hc<3*b/4&&a.$b<b/2&&hb&&(fc=b/2-a.$b-(Kc.hc-b/2),this.GT(fc,f)&&Math.abs(fc)<Math.abs(ya)&&this.w5(a,Kc,l)&&(ya=fc)),Kc.$b<b/2&&Kc.$b>b/4&&a.hc>b/2&&Va&&(fc=b/2-Kc.$b-(a.hc-b/2),this.GT(fc,f)&&Math.abs(fc)<Math.abs(ja)&&this.w5(a,Kc,l)&&(ja=fc)),Kc.kc>c/2&&Kc.kc<3*c/4&&a.Yb<c/2&&Zb&&(fc=c/2-a.Yb-(Kc.kc-c/2),this.GT(fc,f)&&Math.abs(fc)<Math.abs(U)&&this.w5(a,Kc,l)&&(U=fc)),
Kc.Yb<c/2&&Kc.Yb>c/4&&a.kc>c/2&&yb&&(fc=c/2-Kc.Yb-(a.kc-c/2),this.GT(fc,f)&&Math.abs(fc)<Math.abs(H)&&this.w5(a,Kc,l)&&(H=fc));a=new Oi.a;a.top=H===Number.MAX_VALUE?a.top:H;a.bottom=U===Number.MAX_VALUE?a.bottom:U;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=ya===Number.MAX_VALUE?a.right:ya;return a}lxh(a,b,c,f,l,x){l=this.erd(l,Lj.AIc);x=this.erd(x,Lj.AIc);for(var H of l){l=a.copy();l.move(0,0-H);if(this.P6a(l,b,f,null,!1).count)return this.rLa(c,0,-H),!0;l=a.copy();l.move(0,H);if(this.P6a(l,b,
f,null,!1).count)return this.rLa(c,0,H),!0}for(let U of x){H=a.copy();H.move(0-U,0);if(this.P6a(H,b,f,null,!1).count)return this.rLa(c,-1*U,0),!0;H=a.copy();H.move(U,0);if(this.P6a(H,b,f,null,!1).count)return this.rLa(c,U,0),!0}return!1}Dda(a,b,c){return c?a.hc>=b.hc&&a.hc<=b.$b||a.$b>=b.hc&&a.$b<=b.$b||b.hc>=a.hc&&b.hc<=a.$b||b.$b>=a.hc&&b.$b<=a.$b:a.kc>=b.kc&&a.kc<=b.Yb||a.Yb>=b.kc&&a.Yb<=b.Yb||b.kc>=a.kc&&b.kc<=a.Yb||b.Yb>=a.kc&&b.Yb<=a.Yb}DTd(a,b,c,f,l){const x=new Ka.a,H=new Ka.a,U=new Ka.a;
let ja=!1,ya=!1,Va=!1,hb=!1,yb=!0,Zb=!0,fc=!0,Kc=!0;l&&f&&(yb=f.equals(te.a.west)||f.equals(te.a.Qu)||f.equals(te.a.PH),Zb=f.equals(te.a.east)||f.equals(te.a.DE)||f.equals(te.a.VE),fc=f.equals(te.a.north)||f.equals(te.a.Qu)||f.equals(te.a.DE),Kc=f.equals(te.a.south)||f.equals(te.a.PH)||f.equals(te.a.VE));f=this.Mq.Qm(c.te.width);c=this.Mq.Qm(c.te.height);l=new jg;l.Nf=new hd.a(f/2-this.xO,0-this.Bw);l.Eg=new hd.a(f/2-this.xO,c-this.Bw);const Lc=new jg;Lc.Nf=new hd.a(0-this.xO,c/2-this.Bw);Lc.Eg=new hd.a(f-
this.xO,c/2-this.Bw);Lc.hH=!0;for(const Gc of b)Gc.hc>f/2&&Gc.hc<3*f/4&&a.$b<f/2&&this.w5(a,Gc,b)&&Zb&&this.Ju(f/2-a.$b,Gc.hc-f/2)&&(ja=!0,0>Gc.kc&&(l.Nf=new hd.a(f/2,Gc.kc)),Gc.Yb>c&&(l.Eg=new hd.a(f/2,Gc.Yb+this.wg)),x.add(this.zPa(Gc,!1,!1)),H.add(this.vPa(Gc,!1,!1,f,c))),Gc.$b<f/2&&Gc.$b>f/4&&a.hc>f/2&&this.w5(a,Gc,b)&&yb&&this.Ju(a.hc-f/2,f/2-Gc.$b)&&(ya=!0,0>Gc.kc&&(l.Nf=new hd.a(f/2,Gc.kc)),Gc.Yb>c&&(l.Eg=new hd.a(f/2,Gc.Yb+this.wg)),x.add(this.zPa(Gc,!1,!0)),H.add(this.vPa(Gc,!1,!0,f,c))),
Gc.kc>c/2&&Gc.kc<3*c/4&&a.Yb<c/2&&this.w5(a,Gc,b)&&Kc&&this.Ju(c/2-a.Yb,Gc.kc-c/2)&&(Va=!0,0>Gc.hc&&(Lc.Nf=new hd.a(Gc.hc,c/2)),Gc.$b>f&&(Lc.Eg=new hd.a(Gc.$b+this.wg,c/2)),x.add(this.zPa(Gc,!0,!1)),H.add(this.vPa(Gc,!0,!1,f,c))),Gc.Yb<c/2&&Gc.Yb>c/4&&a.kc>c/2&&this.w5(a,Gc,b)&&fc&&this.Ju(a.kc-c/2,c/2-Gc.Yb)&&(hb=!0,0>Gc.hc&&(Lc.Nf=new hd.a(Gc.hc,c/2)),Gc.$b>f&&(Lc.Eg=new hd.a(Gc.$b+this.wg,c/2)),x.add(this.zPa(Gc,!0,!0)),H.add(this.vPa(Gc,!0,!0,f,c)));(ja||ya)&&x.add(this.Pv(l));(Va||hb)&&x.add(this.Pv(Lc));
Va&&(a.hc<Lc.Nf._x&&(Lc.Nf=new hd.a(a.hc,c/2)),a.$b>Lc.Eg._x&&(Lc.Eg=new hd.a(a.$b,c/2+this.wg)),x.add(this.zPa(a,!0,!0)),H.add(this.vPa(a,!0,!0,f,c)));hb&&(a.hc<Lc.Nf._x&&(Lc.Nf=new hd.a(a.hc,c/2)),a.$b>Lc.Eg._x&&(Lc.Eg=new hd.a(a.$b,c/2+this.wg)),x.add(this.zPa(a,!0,!1)),H.add(this.vPa(a,!0,!1,f,c)));ja&&(a.kc<l.Nf._y&&(l.Nf=new hd.a(f/2,a.kc)),a.Yb>l.Eg._y&&(l.Eg=new hd.a(f/2,a.Yb+this.wg)),x.add(this.zPa(a,!1,!0)),H.add(this.vPa(a,!1,!0,f,c)));ya&&(a.kc<l.Nf._y&&(l.Nf=new hd.a(f/2,a.kc)),a.Yb>
l.Eg._y&&(l.Eg=new hd.a(f/2,a.Yb+this.wg)),x.add(this.zPa(a,!1,!1)),H.add(this.vPa(a,!1,!1,f,c)));this.Q0a(x,1);this.Q0a(H,2);for(let Gc of x)U.add(Gc);for(let Gc of H)U.add(Gc);return U}zPa(a,b,c){const f=b&&c,l=b&&!c,x=!b&&!c;return!b&&c?(b=new jg,b.Nf=new hd.a(a.$b-this.qB,a.Yb),b.Eg=new hd.a(a.$b-this.qB,a.Yb+this.wg),this.Pv(b)):x?(b=new jg,b.Nf=new hd.a(a.hc-this.xO,a.Yb),b.Eg=new hd.a(a.hc-this.xO,a.Yb+this.wg),this.Pv(b)):f?(b=new jg,b.Nf=new hd.a(a.$b,a.Yb-this.k4),b.Eg=new hd.a(a.$b+this.wg,
a.Yb-this.k4),this.Pv(b)):l?(b=new jg,b.Nf=new hd.a(a.$b,a.kc-this.Bw),b.Eg=new hd.a(a.$b+this.wg,a.kc-this.Bw),this.Pv(b)):null}vPa(a,b,c,f,l){const x=b&&c,H=b&&!c,U=!b&&!c;return!b&&c?(l=new jg,l.hH=!0,l.Nf=new hd.a(f/2-this.xO,a.Yb+this.wg),l.Eg=new hd.a(a.$b-this.qB,a.Yb+this.wg),this.Pv(l)):U?(l=new jg,l.hH=!0,l.Nf=new hd.a(f/2-this.xO,a.Yb+this.wg),l.Eg=new hd.a(a.hc-this.xO,a.Yb+this.wg),this.Pv(l)):x?(f=new jg,f.hH=!0,f.Nf=new hd.a(a.$b+this.wg,l/2-this.Bw),f.Eg=new hd.a(a.$b+this.wg,a.Yb-
this.k4),this.Pv(f)):H?(f=new jg,f.hH=!0,f.Nf=new hd.a(a.$b+this.wg,l/2-this.Bw),f.Eg=new hd.a(a.$b+this.wg,a.kc-this.Bw),this.Pv(f)):null}vcj(a,b,c,f,l,x){let H=Number.MAX_VALUE,U=Number.MAX_VALUE,ja=Number.MAX_VALUE,ya=Number.MAX_VALUE,Va=!0,hb=!0,yb=!0,Zb=!0;x&&l&&(Va=l.equals(te.a.west)||l.equals(te.a.Qu)||l.equals(te.a.PH),hb=l.equals(te.a.east)||l.equals(te.a.DE)||l.equals(te.a.VE),yb=l.equals(te.a.north)||l.equals(te.a.Qu)||l.equals(te.a.DE),Zb=l.equals(te.a.south)||l.equals(te.a.PH)||l.equals(te.a.VE));
l=[];for(const fc of b)l.push(new Gk.a(fc.us()));b=this.Mq.Qm(c.te.width);c=this.Mq.Qm(c.te.height);for(const fc of l)fc.$b>3*b/4&&fc.$b<b&&a.hc<b/4&&0<a.hc&&this.Dda(a,fc,!1)&&Va&&(l=b-fc.$b-a.hc,this.GT(l,f)&&Math.abs(l)<Math.abs(ja)&&(ja=l)),fc.hc<b/4&&0<fc.hc&&a.$b>3*b/4&&a.$b<b&&this.Dda(a,fc,!1)&&hb&&(l=b-a.$b-fc.hc,this.GT(l,f)&&Math.abs(l)<Math.abs(ya)&&(ya=l)),fc.Yb>3*c/4&&fc.Yb<c&&a.kc<c/4&&0<a.kc&&this.Dda(a,fc,!0)&&yb&&(l=c-fc.Yb-a.kc,this.GT(l,f)&&Math.abs(l)<Math.abs(H)&&(H=l)),fc.kc<
c/4&&0<fc.kc&&a.Yb>3*c/4&&a.Yb<c&&this.Dda(a,fc,!0)&&Zb&&(l=c-a.Yb-fc.kc,this.GT(l,f)&&Math.abs(l)<Math.abs(U)&&(U=l));a=new Oi.a;a.top=H===Number.MAX_VALUE?a.top:H;a.bottom=U===Number.MAX_VALUE?a.bottom:U;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=ya===Number.MAX_VALUE?a.right:ya;return a}P6a(a,b,c,f,l){const x=new Ka.a,H=new Ka.a,U=new Ka.a;var ja=!1,ya=!1,Va=!1,hb=!1,yb=!0;let Zb=!0,fc=!0,Kc=!0;l&&f&&(yb=f.equals(te.a.west)||f.equals(te.a.Qu)||f.equals(te.a.PH),Zb=f.equals(te.a.east)||f.equals(te.a.DE)||
f.equals(te.a.VE),fc=f.equals(te.a.north)||f.equals(te.a.Qu)||f.equals(te.a.DE),Kc=f.equals(te.a.south)||f.equals(te.a.PH)||f.equals(te.a.VE));f=this.Mq.Qm(c.te.width);c=this.Mq.Qm(c.te.height);for(const Lc of b)Lc.$b>3*f/4&&Lc.$b<f&&a.hc<f/4&&0<a.hc&&this.Dda(a,Lc,!1)&&yb&&this.Ju(a.hc,f-Lc.$b)&&(ja=!0,b=new jg,b.Nf=new hd.a(Lc.$b-this.qB,Lc.Yb),b.Eg=new hd.a(Lc.$b-this.qB,Lc.Yb+this.wg),x.add(this.Pv(b)),b=new jg,b.hH=!0,b.Nf=new hd.a(f-this.qB,Lc.Yb+this.wg),b.Eg=new hd.a(Lc.$b-this.qB,Lc.Yb+this.wg),
H.add(this.Pv(b))),Lc.hc<f/4&&0<Lc.hc&&a.$b>3*f/4&&a.hc<f&&this.Dda(a,Lc,!1)&&Zb&&this.Ju(f-a.$b,Lc.hc)&&(ya=!0,b=new jg,b.Nf=new hd.a(Lc.hc-this.xO,Lc.Yb),b.Eg=new hd.a(Lc.hc-this.xO,Lc.Yb+this.wg),x.add(this.Pv(b)),b=new jg,b.hH=!0,b.Nf=new hd.a(0-this.xO,Lc.Yb+this.wg),b.Eg=new hd.a(Lc.hc-this.xO,Lc.Yb+this.wg),H.add(this.Pv(b))),Lc.Yb>3*c/4&&Lc.Yb<c&&a.kc<c/4&&0<a.kc&&this.Dda(a,Lc,!0)&&fc&&this.Ju(a.kc,c-Lc.Yb)&&(Va=!0,b=new jg,b.Nf=new hd.a(Lc.$b,Lc.Yb-this.k4),b.Eg=new hd.a(Lc.$b+this.wg,Lc.Yb-
this.k4),x.add(this.Pv(b)),l=new jg,b.hH=!0,l.Nf=new hd.a(Lc.$b+this.wg,Lc.Yb-this.k4),l.Eg=new hd.a(Lc.$b+this.wg,c-this.k4),H.add(this.Pv(l))),Lc.kc<c/4&&0<Lc.kc&&a.Yb>3*c/4&&a.Yb<c&&this.Dda(a,Lc,!0)&&Kc&&this.Ju(c-a.Yb,Lc.kc)&&(hb=!0,b=new jg,b.Nf=new hd.a(Lc.$b,Lc.kc-this.Bw),b.Eg=new hd.a(Lc.$b+this.wg,Lc.kc-this.Bw),x.add(this.Pv(b)),l=new jg,b.hH=!0,l.Nf=new hd.a(Lc.$b+this.wg,0-this.Bw),l.Eg=new hd.a(Lc.$b+this.wg,Lc.kc-this.Bw),H.add(this.Pv(l)));Va&&(Va=new jg,Va.Nf=new hd.a(a.$b,a.kc-
this.Bw),Va.Eg=new hd.a(a.$b+this.wg,a.kc-this.Bw),x.add(this.Pv(Va)),yb=new jg,Va.hH=!0,yb.Nf=new hd.a(a.$b+this.wg,0-this.Bw),yb.Eg=new hd.a(a.$b+this.wg,a.kc-this.Bw),H.add(this.Pv(yb)));hb&&(hb=new jg,hb.Nf=new hd.a(a.$b,a.Yb-this.k4),hb.Eg=new hd.a(a.$b+this.wg,a.Yb-this.k4),x.add(this.Pv(hb)),Va=new jg,hb.hH=!0,Va.Nf=new hd.a(a.$b+this.wg,c-this.k4),Va.Eg=new hd.a(a.$b+this.wg,a.Yb-this.k4),H.add(this.Pv(Va)));ja&&(ja=new jg,ja.Nf=new hd.a(a.hc-this.xO,a.Yb),ja.Eg=new hd.a(a.hc-this.xO,a.Yb+
this.wg),x.add(this.Pv(ja)),ja=new jg,ja.hH=!0,ja.Nf=new hd.a(0-this.xO,a.Yb+this.wg),ja.Eg=new hd.a(a.hc-this.xO,a.Yb+this.wg),H.add(this.Pv(ja)));ya&&(ya=new jg,ya.Nf=new hd.a(a.$b-this.qB,a.Yb),ya.Eg=new hd.a(a.$b-this.qB,a.Yb+this.wg),x.add(this.Pv(ya)),ya=new jg,ya.hH=!0,ya.Nf=new hd.a(f-this.qB,a.Yb+this.wg),ya.Eg=new hd.a(a.$b-this.qB,a.Yb+this.wg),H.add(this.Pv(ya)));this.Q0a(x,1);this.Q0a(H,2);for(let Lc of x)U.add(Lc);for(let Lc of H)U.add(Lc);return U}Sni(a,b,c){var f=new jg;const l=new jg,
x=new jg,H=new jg,U=new jg,ja=new jg,ya=new Ka.a;ya.add(f);ya.add(l);ya.add(x);ya.add(H);ya.add(U);ya.add(ja);this.Q0a(ya,0);this.QFj(f,l,x,H,U,ja,a);for(const Va of b)this.m3(a.kc,Va.kc,Va.Yb,f,Va),this.m3(a.Yb,Va.kc,Va.Yb,l,Va),this.m3(a.hc,Va.hc,Va.$b,x,Va),this.m3(a.$b,Va.hc,Va.$b,H,Va),this.lFb&&(this.m3(a.kc,Va.Wf()._y,null,f,Va),this.m3(a.Yb,Va.Wf()._y,null,l,Va),this.m3(a.hc,Va.Wf()._x,null,x,Va),this.m3(a.$b,Va.Wf()._x,null,H,Va),this.m3(a.Wf()._y,Va.kc,null,U,Va),this.m3(a.Wf()._y,Va.Yb,
null,U,Va),this.m3(a.Wf()._x,Va.hc,null,ja,Va),this.m3(a.Wf()._x,Va.$b,null,ja,Va)),this.m3(a.Wf()._y,Va.Wf()._y,null,U,Va),this.m3(a.Wf()._x,Va.Wf()._x,null,ja,Va);0<f.length()&&0<l.length()&&(this.lFb?(U.Nf=new hd.a(a.hc-this.wg,a.Wf()._y),U.Eg=U.Nf.copy()):U.reset());0<x.length()&&0<H.length()&&(this.lFb?(ja.Nf=new hd.a(a.Wf()._x,a.hc-this.xO),ja.Eg=ja.Nf.copy()):ja.reset());if(this.lFb&&c){b=this.Mq.Qm(c.te.width);c=this.Mq.Qm(c.te.height);if(this.Ju(a.kc,c/2)||Math.abs(a.kc)<=Lj.K6a||this.Ju(a.kc,
c))f.Nf._x=Math.min(f.Nf._x,-1*this.wg),f.Eg._x=Math.max(f.Eg._x,b+this.wg);if(this.Ju(a.Yb,c/2)||Math.abs(a.Yb)<=Lj.K6a||this.Ju(a.Yb,c))l.Nf._x=Math.min(l.Nf._x,-1*this.wg),l.Eg._x=Math.max(l.Eg._x,b+this.wg);if(this.Ju(a.Wf()._y,c/2)||Math.abs(a.Wf()._y)<=Lj.K6a||this.Ju(a.Wf()._y,c))U.Nf._x=Math.min(U.Nf._x,-1*this.wg),U.Eg._x=Math.max(U.Eg._x,b+this.wg);if(this.Ju(a.$b,b/2)||Math.abs(a.$b)<=Lj.K6a||this.Ju(a.$b,b))H.Nf._y=Math.min(H.Nf._y,-1*this.wg),H.Eg._y=Math.max(H.Eg._y,c+this.wg);if(this.Ju(a.hc,
b/2)||Math.abs(a.hc)<=Lj.K6a||this.Ju(a.hc,b))x.Nf._y=Math.min(x.Nf._y,-1*this.wg),x.Eg._y=Math.max(x.Eg._y,c+this.wg);if(this.Ju(a.Wf()._x,b/2)||Math.abs(a.Wf()._x)<=Lj.K6a||this.Ju(a.Wf()._x,b))ja.Nf._y=Math.min(ja.Nf._y,-1*this.wg),ja.Eg._y=Math.max(ja.Eg._y,c+this.wg)}f=new Ka.a;for(let Va of ya)Va.Nf&&0<Va.length()&&(this.QTf(Va,a),f.add(this.Pv(Va)));return f}m3(a,b,c,f,l){(this.Ju(a,b)||this.Ju(a,c))&&this.QTf(f,l)}QTf(a,b){a.hH?(a.Nf._x=Math.min(a.Nf._x,b.hc-this.wg),a.Eg._x=Math.max(a.Eg._x,
b.$b+this.wg)):(a.Nf._y=Math.min(a.Nf._y,b.kc-this.wg),a.Eg._y=Math.max(a.Eg._y,b.Yb+this.wg))}Pv(a){let b;(b=a.Nf).x=b.x+this.R8c;let c;(c=a.Nf).y=c.y+this.S8c;let f;(f=a.Eg).x=f.x+this.R8c;let l;(l=a.Eg).y=l.y+this.S8c;return a}Ju(a,b){var c=Lj.K6a;return!!a&&!!b&&Math.abs(a-b)<=c}QFj(a,b,c,f,l,x,H){a.Nf=new hd.a(H.hc-this.wg,H.kc-this.Bw);a.Eg=a.Nf.copy();a.hH=!0;b.Nf=new hd.a(H.hc-this.wg,H.Yb-this.k4);b.Eg=b.Nf.copy();b.hH=!0;c.Nf=new hd.a(H.hc-this.xO,H.kc-this.wg);c.Eg=c.Nf.copy();f.Nf=new hd.a(H.$b-
this.qB,H.kc-this.wg);f.Eg=f.Nf.copy();b=H.Wf();l.Nf=new hd.a(a.Nf._x-this.wg,b._y-this.Bw);l.Eg=l.Nf.copy();l.hH=!0;x.Nf=new hd.a(b._x-this.wg,c.Nf._y-this.wg);x.Eg=x.Nf.copy()}Q0a(a,b){for(let c of a)0===b?(c.color=mf.a.ovi,c.dashStyle="4,4",c.j7b=0):1===b?(c.color=mf.a.nvi,c.dashStyle="4,4",c.j7b=1):2===b&&(c.color=mf.a.zGf,c.dashStyle="4,4",c.j7b=2)}get I0g(){return this.R8c}set I0g(a){this.R8c=a}get J0g(){return this.S8c}set J0g(a){this.S8c=a}}Lj.K6a=.4;Lj.AIc=5;Object(m.a)(Lj,"SmartGuideUtility",
null,[1283]);var mo=d(138),Jm=d(208),om=d(169),Km=d(196);class lj{constructor(a,b,c,f,l){this.nFb=this.oFb=this.xb=null;this.lma=new Sys.UI.Bounds(0,0,0,0);this.LIa=1;this.Eb=!1;this.Fg=a;this.Bi=b;this.qd=f;this.Kc=c;this.qd.OYb(Object(F.a)(this,this.onResize,"onResize"));l&&this.qd.DPa(Object(F.a)(this,this.P0,"onActiveSlideDomDisplayed"));this.Jm()}get visible(){return!!this.xb&&this.Eb}set visible(a){this.xb||this.Jm();this.Eb!==a&&(this.xb.Qd(a),this.Eb=a)}kQf(a){this.nFb&&this.oFb.xa.removeChild(this.nFb.xa);
this.nFb=new Jm.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new om.a,l=lj.QZj(lj.afh(hd.a.scale(c.Nf,this.LIa,this.LIa)),lj.afh(hd.a.scale(c.Eg,this.LIa,this.LIa)));f.zt(l);f.Yu(this.lZf(c.color));f.Goa(c.dashStyle);f.mr(1);this.nFb.appendChild(f);2===c.j7b&&this.dPi(l[0],l[1])}this.oFb.appendChild(this.nFb)}dPi(a,b){a._y===b._y?a._x<b._x?this.qJf(a,b):this.qJf(b,a):a._y>b._y?this.rJf(a,b):this.rJf(b,a)}qJf(a,b){const c=this.sCf(b._x-a._x);this.kLc([new hd.a(a._x,a._y),new hd.a(a._x+c,a._y-c/2),
new hd.a(a._x+c,a._y+c/2)]);this.kLc([new hd.a(b._x,b._y),new hd.a(b._x-c,b._y-c/2),new hd.a(b._x-c,b._y+c/2)])}rJf(a,b){const c=this.sCf(a._y-b._y);this.kLc([new hd.a(a._x,a._y),new hd.a(a._x-c/2,a._y-c),new hd.a(a._x+c/2,a._y-c)]);this.kLc([new hd.a(b._x,b._y),new hd.a(b._x-c/2,b._y+c),new hd.a(b._x+c/2,b._y+c)])}sCf(a){return Math.min(a,10)/2}kLc(a){const b=new om.a,c=this.lZf(mf.a.zGf);b.zt(a);b.Yu(c);b.mr(1);b.OE(c);b.Qd(!0);this.nFb.appendChild(b)}lZf(a){return this.Bi&&this.Bi.highContrastColors?
this.Bi.highContrastColors.foregroundTextColor:a}Jm(){this.xb=new mo.a;this.xb.ur("SmartGuideView");this.xb.Yj(0);this.xb.Qd(!1);this.Fg.xa.appendChild(this.xb.xa);this.oFb=new Km.a;this.oFb.xa.style.overflow="visible";this.xb.appendChild(this.oFb);this.Xr(this.Kc.Ic)}onResize(a,b){b&&this.Xr(b.oG)}P0(a,b){b&&this.Xr(b.oG)}Xr(a){this.xb&&a&&a.te&&a===this.Kc.Ic&&(this.lma.x!==a.te.x||this.lma.y!==a.te.y||this.lma.width!==a.te.width||this.lma.height!==a.te.height)&&(this.lma=new Sys.UI.Bounds(a.te.x,
a.te.y,a.te.width,a.te.height),this.xb.setPosition(a.te.x,a.te.y),this.oFb.lh(a.te.width,a.te.height),this.xb.lh(a.te.width,a.te.height))}static QZj(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static afh(a){return new hd.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(m.a)(lj,"SmartGuideView",null,[1282]);class Cn{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Oi.a.add(a.SYa,b),!0)}GI(a){return new Gk.a(a.us())}mG(a){return!a.shapeNode.gy}}
Object(m.a)(Cn,"DefaultShapeMoveResizeHandler",null,[603]);class Qn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Zb(a){this.K=a;this.K.register(1281,"PowerPointWebEditor.ISmartGuideManager").ma().oa(()=>new Ho(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1282,"PowerPointWebEditor.ISmartGuideView").ma().oa(()=>new lj(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Dua));this.K.register(1283,"PowerPointWebEditor.ISmartGuideUtility").ma().oa(()=>new Lj(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Cn)}dispose(){}static main(){z.a.instance.Dc(new Qn)}}Object(m.a)(Qn,"PPTWebEditorSmartGuidePackage",null,[2,3]);class Tl{}Tl.dqg=[D.a.backspace,D.a.fub,D.a.$K,D.a.N1b,D.a.$Ca,D.a.enter,D.a.Qpd,D.a.zB,D.a.tab,D.a.Qqc,D.a.pageDown,D.a.pageUp,D.a.JYa,D.a.MEe,D.a.IYa,D.a.LEe];Tl.W0j=[D.a.backspace,D.a.fub,D.a.$K,D.a.N1b,D.a.$Ca,
D.a.enter,D.a.Qpd,D.a.zB,D.a.tab,D.a.Qqc,D.a.font,D.a.P5,D.a.DKa,D.a.Pq,D.a.QJa,D.a.A_a,D.a.bH,D.a.NH,D.a.bold,D.a.setItalic,D.a.underline,D.a.strikethrough,D.a.Sr,D.a.v1,D.a.aja,D.a.NM,D.a.mP,D.a.oC,D.a.By,D.a.Xia,D.a.nla,D.a.toa,D.a.PDa,K.a.Kna,K.a.$0,K.a.Z0,K.a.Y0,D.a.bDa,D.a.yka,D.a.kza,D.a.lza,D.a.mza,D.a.ILa,D.a.JLa,D.a.K8b,D.a.L8b,D.a.hab,D.a.hUa,D.a.kUa,D.a.$ta,D.a.o8,K.a.mIb,D.a.deleteRow,K.a.amc,D.a.ZCa,K.a.jid,D.a.insertTable,K.a.vLe,D.a.OZ,D.a.NZ,K.a.N5,K.a.NJa,K.a.n0a,K.a.cLa,K.a.Hoa,
K.a.dLa,K.a.crd,K.a.brd,D.a.zM,D.a.mUa,D.a.centerJustify,D.a.leftJustify,D.a.rightJustify,D.a.fullJustify,D.a.z2b,D.a.Cac,D.a.uqc,K.a.wkb,K.a.xkb,K.a.ykb,K.a.zkb,D.a.RZb];Tl.l7k=[D.a.leftArrow,D.a.rightArrow,D.a.upArrow,D.a.downArrow,D.a.u0a,D.a.t0a,D.a.RCa,D.a.QCa,D.a.aRa,D.a.$Qa,D.a.xMb,D.a.gkb,D.a.O1b,D.a.gub,D.a.G7a,D.a.ZQa,D.a.JYa,D.a.YRa,D.a.kgb,D.a.jgb,D.a.A8a,D.a.IYa,D.a.XRa,D.a.z8a,D.a.Ksa,D.a.Rpd,K.a.Bpc,K.a.WOb,K.a.D0a,K.a.cNb];Object(m.a)(Tl,"ActionIdList",null,[]);class Hk{constructor(){this.ActionTime=
this.ActionName=this.ActionId=null}}Object(m.a)(Hk,"ActionInformation",null,[]);class pm{constructor(a,b,c,f,l,x){this.Xbb=[];this.Bbc=[];this.fJ=a;this.dpe=b||[];this.ia=c;this.ia.oaa(this);this.Xa=f;this.CX=l;this.pH=x}D5(a){this.Iuh(a)&&this.Noa(a.actionId)&&(this.Xbb.push(a.actionId),this.Bbc.push(Date.now()))}C5(a){this.Iuh(a)&&this.Noa(a.actionId)&&(this.Xbb.pop(),this.Bbc.pop())}Noa(a){if(Array.contains(this.dpe,a))return!0;a=this.ia.dT(a);return!!a&&!(a.flags[32]||a.flags[64])}Iuh(a){return 2===
a.behavior&&a.Oi?!0:!1}getCommandName(a,b=""){return(a=this.fJ?this.fJ.W5(a):null)?a:b}eY(a){a&&a.nsa&&xa.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.nsa.toString(),this.actionName||(this.CX.jd===D.a.typing||this.CX.jd===D.a.gCa||this.CX.jd===D.a.oRa?"Typing":null)||(this.pH.CYc?"ClosingTextUndoStack":""),this.Xa.podSessionId||"",this.fJ.W5(this.CX.jd));return!!this.Xbb.length}update(a,b){a=new Hk;a.ActionId=this.f3f();a.ActionName=this.g3f();a.ActionTime=
this.sbj().toString();di.a.Eo(b,kb.a.V3h,a);b.setValue(kb.a.C8b,!0);b.setValue(kb.a.tmd,1)}get actionName(){return this.g3f()}get actionId(){return this.f3f()}Q7d(){return this.Xbb[this.Xbb.length-1]}f3f(){return this.Xbb.length?this.Q7d().toString():null}g3f(){return this.Xbb.length?this.getCommandName(this.Q7d(),this.Q7d().toString()):null}sbj(){return this.Bbc.length?this.Bbc[this.Bbc.length-1]:Number.MAX_VALUE}}Object(m.a)(pm,"ActionInfoRevisionMetaDataUpdater",null,[1328,141]);class qm{constructor(){this.va=
new wc.a}Teh(a){this.va.raiseEvent("UCI",a)}sbi(a){this.va.addHandler("UCI",a)}e_k(a){this.va.removeHandler("UCI",a)}}Object(m.a)(qm,"CcpEventSource",null,[1431,1432,1433]);class Vg{constructor(a,b){this.fcc=this.oqe=this.nqe=null;this.pqe=a;this.nU=b;this.pqe.sbi(Object(F.a)(this,this.b2g,"onCcpPropertyChanged"))}b2g(a,b){this.nqe=b.Gp;this.oqe=b.Vpi;this.fcc=b.Wpi}eY(a){a=this.nU.nEa(a.hya);!this.fcc&&a.Sa(kb.a.f7a)&&(a.removeProperty(kb.a.tN),a.removeProperty(kb.a.aQ),a.removeProperty(kb.a.f7a));
return!!this.fcc}update(a,b){b.setValue(kb.a.tN,this.nqe);b.setValue(kb.a.aQ,this.oqe);b.setValue(kb.a.f7a,this.fcc);this.fcc=this.oqe=this.nqe=null}dispose(){this.pqe&&this.pqe.e_k(Object(F.a)(this,this.b2g,"onCcpPropertyChanged"))}}Object(m.a)(Vg,"CcpInfoRevisionMetaDataUpdater",null,[1279,1328,106]);var Dn=d(324);class rl extends rf.a{constructor(a,b,c,f,l,x,H){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=null;this.Cid=a;this.Sid=b;
this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=x;this.AuthToken=H}Zk(){return 108}}Object(m.a)(rl,"AugmentImageRequest",rf.a,[]);class Fl extends rf.a{constructor(){super()}Zk(){return 81}}Object(m.a)(Fl,"FlushRequest",rf.a,[]);class cm extends rf.a{constructor(a,b,c,f,l,x){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=f;this.DeckSuggestionId=
l;this.Hints=x}Zk(){return 111}}Object(m.a)(cm,"GenerateAgendaDeckSuggestionRequest",rf.a,[]);class Io extends rf.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}Zk(){return 110}}Object(m.a)(Io,"GenerateAgendaSuggestionRequest",rf.a,[]);class Sk extends rf.a{constructor(a,b,c,f,l,x,H,U,ja,ya){super();this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=
this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=x;this.SubNodeWidth=H;this.SubNodeHeight=U;this.CorrelationId=ja;this.Trigger=ya}Zk(){return 99}}Object(m.a)(Sk,"GenerateIconSuggestionRequest",rf.a,[]);class nh extends rf.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=this.IsSVGBlipFill=!1;
this.GraphNodeId=L.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}Zk(){return 91}}Object(m.a)(nh,"GenerateImageDescriptionRequest",rf.a,[]);class Ik extends rf.a{constructor(a,b,c,f,l,x,H){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=x;this.Hints=H}Zk(){return 66}}Object(m.a)(Ik,"GenerateSuggestionRequest",
rf.a,[]);class Bj extends Ik{constructor(a,b,c,f,l,x,H,U){super(a,b,f,null,l,x,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=H;this.ShapeViewHeight=U}Zk(){return 83}}Object(m.a)(Bj,"GenerateReplaceObjectRequest",Ik,[]);class ef extends rf.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}Zk(){return 57}}Object(m.a)(ef,"GetPictureCropInfoRequest",rf.a,[]);class hn extends rf.a{constructor(){super();
this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}Zk(){return 109}}Object(m.a)(hn,"ImageTransformRequest",rf.a,[]);class zi extends rf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Zk(){return 84}}Object(m.a)(zi,"ReportReplaceObjectInfoRequest",rf.a,[]);class hl extends rf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Zk(){return 67}}Object(m.a)(hl,"ReportSuggestionSessionInfoRequest",
rf.a,[]);class dp extends rf.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}Zk(){return 59}}Object(m.a)(dp,"UpdateContentAddinSnapshotInfoRequest",rf.a,[]);class Ai{constructor(a,b,c){this.pH=a;this.Vb=b;this.nug=c}get CYc(){return this.pH.CYc}j7a(a,b=!1){this.pH.j7a(a,b)}forceOutbound(){this.pH.forceOutbound()}$fa(a,b,c=!1){this.pH.$fa(a,b,c)}RFc(a){this.pH.RFc(a)}Qwb(a){return this.pH.Qwb(a)}Db(a){this.pH.Db(a)}S4f(a,
b,c,f=null,l=null,x=!1){a=new ti.a(new ef(a,b,c),f,l,H=>0===H.StatusCode);this.pH.$fa(a,this.Vb,x)}Vja(a,b,c,f,l,x,H,U=null,ja=null){a=new ti.a(new Ik(a,b,c,f,l,x,H),U,ja,ya=>0===ya.StatusCode);this.pH.$fa(a,this.Vb)}generateImageDescription(a,b,c,f){a=new ti.a(new nh(a,b,c,f),null,null,l=>0===l.StatusCode);this.pH.$fa(a,this.Vb)}noa(a,b,c){a=new ti.a(new hl(a,b),null,()=>!0,f=>0===f.StatusCode);this.pH.$fa(a,this.Vb,c)}UYf(a,b,c,f,l,x,H,U=null,ja=null){a=new ti.a(new Bj(a,b,c,f,l,null,x,H),U,ja,
ya=>0===ya.StatusCode);this.pH.$fa(a,this.Vb)}M0k(a,b,c=null,f=null){a=new ti.a(new zi(a,b),c,f,l=>0===l.StatusCode);this.pH.$fa(a,this.Vb)}D1i(a,b,c,f,l,x,H,U,ja=null,ya=null){a=new ti.a(new Sk(a,b,c,f,l,x,74,74,H,U),ja,ya,Va=>0===Va.StatusCode);this.pH.$fa(a,this.Vb)}augmentImage(a,b,c,f,l,x,H,U=null,ja=null){a=new ti.a(new rl(a,b,c,f,l,x,H),U,ja,ya=>0===ya.StatusCode);this.pH.$fa(a,this.Vb)}generateAgendaSuggestion(a,b,c,f,l,x=null,H=null){a=new ti.a(new Io(a,b,c,f,l),x,H,U=>0===U.StatusCode);
this.pH.$fa(a,this.Vb)}generateAgendaDeckSuggestion(a,b,c,f,l,x,H=null,U=null){a=new ti.a(new cm(a,b,c,f,l,x),H,U,ja=>0===ja.StatusCode);this.pH.$fa(a,this.Vb)}kGh(a,b,c,f=null,l=null){const x=new ti.a(new dp(a,b,c),f,l,ja=>0===ja.StatusCode),H=()=>{this.zTi(x)};a=this.pH.Qwb(this.Vb.Ef);const U=new Dn.a;a?a.forceOutbound(()=>{H()},l?()=>{l(U)}:null,null):(xa.a.J(20460503,823,10,"Can't find graph space replicator when trying to do outbound"),l&&l(U))}flush(a=null,b=null){a=new ti.a(new Fl,a,b,c=>
0===c.StatusCode,3);this.pH.Jsa(a)}Jsa(a){this.pH.Jsa(a)}bSc(){return this.Qwb(this.Vb.Ef)}zTi(a){this.nug.Db(a);this.nug.forceOutbound(null,null,null)}}Object(m.a)(Ai,"OutboundHelper",null,[1276,18,1331]);var ui=d(259),Mj=d(168);class Tk{constructor(a,b,c,f,l){this.aM=[];this.aeb=new ui.a;this.fbd=null;this.Jrg=[];this.V4=null;this.va=new wc.a;this.fyg=this.ODb=this.Kad=!1;this.Tb=a;this.la=b;this.ua=c;this.cfk=l;this.Sva=f;this.obk=this.la.wua?1:4;f.jk(Object(F.a)(this,this.qfd,"onMainMastersLoaded"));
this.la.wua&&f.jk(Object(F.a)(this,this.o4g,"onMasterIdListChanged"))}get vkk(){if(this.la.wua&&this.ua.Ba){const a=this.ua.Ba.hj;a&&Array.contains(this.aM,a)&&this.GEe(a)}return this.aM.slice(0,Math.min(this.obk,this.aM.length))}fXk(a){Array.remove(this.aM,a)}get wtl(){return this.fbd}get OO(){return this.aeb}get gYb(){return this.Jrg}get fCj(){return!this.fbd}get dEk(){return 0<this.aM.length&&(!this.la.cVa||this.Kad)}get dFe(){return this.ODb}set dFe(a){this.ODb=a}$pl(a){a&&this.UDh(a.hj)}ayh(){this.Kad=
!0;this.Kkd(!0);this.RKb()}UDh(a){this.Kad=!0;a&&(Array.remove(this.aM,a),Array.insert(this.aM,0,a));this.RKb()}h_e(a){this.la.wua?this.UDh(a):this.ayh()}E3f(a){if(!a||!this.aeb)return null;a=a.hj;if(!a)return null;let b=null;return({value:b}=this.aeb.Uf(a)).returnValue?b:null}o4g(a,b){b.property.id===kb.a.tcd.id&&(xa.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.ODb),this.ODb&&(this.ODb=!1,this.Kad&&(this.Kkd(!1),this.RKb())),this.nEf())}qfd(a,b){a=b.property;if(this.la.wua)if(a.id===
kb.a.YFb.id){a=this.Tb.obj();const f=this.Tb.FI();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],x=f[c];l.Id<x.Id?(this.oGh(l.Id),b++):x.Id<l.Id?(this.U4e(x.Id),c++):(xd.c(l)!==xd.c(x)&&this.nDl(x.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.U4e(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.oGh(a[b].Id);this.RKb()}else Mj.b(f,null,l=>{this.U4e(l.Id)})}else a.id===kb.a.zY.id&&(xa.a.J(38847375,824,50,"Slide size changed, need to reload the resources."),this.Kkd(!0),
this.RKb());else if(a.id===kb.a.YFb.id||a.id===kb.a.zY.id)xa.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.Kkd(!0),this.RKb()}U4e(a){this.GEe(a)}nDl(a){this.GEe(a)}GEe(a){Array.contains(this.aM,a)&&Array.remove(this.aM,a);Array.insert(this.aM,0,a)}oGh(a){this.aeb.remove(a);-1!==Array.indexOf(this.aM,a)&&Array.remove(this.aM,a)}RKb(){this.V4=this.V4||this.cfk(this);this.V4.DF(null,null,null)}Kkd(a){if(this.la.wua){xa.a.J(38847378,824,50,"RefreshMastersToLoad, need clean cache: {0} ",
a);var b=this.Tb.gwb();a&&(Array.clear(this.aM),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.aM,c.idField)&&Array.add(this.aM,c.idField);else this.ODb=!0,(a=this.Tb.XA(0))&&(a=a.hj)&&Array.add(this.aM,a)}else if(a=this.Tb.FI(),Array.clear(this.aM),this.clearCache(),a)for(b of a)this.aeb.remove(b.Id),-1===Array.indexOf(this.aM,b.Id)&&Array.add(this.aM,b.Id)}Uuk(a){if(a){for(const b of a)b&&(xa.a.J(38847381,824,50,"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",
b.MasterId),this.aeb.$(b.MasterId,b),this.fbd=this.fbd||b.TableStyleGallery,this.la.wua||Array.remove(this.aM,b.MasterId));this.nEf();this.va.raiseEvent("MainMasterResourcesLoaded")}else xa.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}nEf(){!this.fyg&&this.ryf()&&(this.fyg=!0,xa.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),Ud.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}$pk(a){this.la.powerPointEnableAccCheck&&
(a&&a.length?(this.Jrg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):xa.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}ryf(){if(!this.la.wua)return!0;const a=this.Tb.gwb();if(a&&0<a.length)for(const b of this.Tb.gwb())if(0<b.layoutCountField&&this.OO.Hb(b.idField)&&this.OO.ga(b.idField).LayoutIcons.length===b.layoutCountField)return xa.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",
b.idField,b.layoutCountField),!0;return!1}yGc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}RYk(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}e$h(a){this.va.addHandler("FirstMasterRetrieved",a)}z9h(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}nYk(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.aeb=new ui.a}dispose(){this.Sva.Cm(Object(F.a)(this,this.qfd,"onMainMastersLoaded"));this.la.wua&&this.Sva.Cm(Object(F.a)(this,this.o4g,"onMasterIdListChanged"));
this.va.dispose();this.V4&&this.V4.dispose()}}Object(m.a)(Tk,"PresentationResourcesManager",null,[1278,106]);var Jo=d(389);class Sm extends rf.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}Zk(){return 52}static wWd(a,b,c){const f=new Sm;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(m.a)(Sm,"GetEditPresResourcesRequest",rf.a,[]);class jn extends Jo.a{constructor(a,b,c,f){super();this.IBb=0;this.zeb=this.t4=!1;this.Mm=
a;this.EXa=b;this.zO=f;this.enabled=2;this.Fw=c.lDi();this.Mm.register(this)}DF(){this.Fw.E_i();this.Fw.$$a();this.Mm.zaa()}forceOutbound(){}tka(){return this.EXa.dEk||this.EXa.dFe}NN(){return!1}MTa(){return this.Vd&&2===this.Vd.status?!0:this.t4||this.zeb?!1:this.tka()&&this.Fw.M7b()}uKb(){if(1===this._state){var a=this.EXa.vkk;this.Vd.JH=Sm.wWd(a,this.EXa.fCj,this.EXa.dFe);for(const b of a)this.EXa.fXk(b);this.Vd.status=1;this._state=3}else 3===this._state&&this.Vd&&2===this.Vd.status&&(this.zeb?
(this._state=4,this.dispose()):(200===this.Vd.zv&&this.zO.Hoc(),this.Fw.lMa(),2!==this.Vd.statusCode?this.DH():this.Vd.Qr&&1===this.Vd.Qr.length?(a=this.Vd.Qr[0],0===a.StatusCode?(this.EXa.Uuk(xd.a(a.MainMasterResources)),this.EXa.$pk(xd.a(a.AccRuleInfoList)),this.R0()):this.DH()):this.DH()))}get Nca(){return this.tka()?this.Fw.Pib():super.Nca}dispose(){1===this._state||4===this._state?(this.t4||this.Mm.unregister(this),this.t4=!0):this.zeb=!0}R0(){this.IBb=0;this._state=1;this.tka()||this.Fw.E0a()}DH(){4<
++this.IBb?(this._state=4,xa.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.IBb)):(xa.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(m.a)(jn,"PresentationResourcesReplicator",Jo.a,[106]);class kn{constructor(a,b){this.ofk=a;this.nU=b}Twk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.hya;let c=null,f=!1;for(const l of this.ofk)if(l.eY(a)){if(!c&&(c=this.nU.nEa(b),!c)){xa.a.J(23594507,
817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.nU.KOd(b,a,c)}}Object(m.a)(kn,"RevisionMetaDataUpdateListener",null,[1280]);var no=d(411);class ze{nEa(a){if(!a)return null;const b=a.oL(4);return b&&!b.equals(ka.a.nil)?a.Be(b):new no.a}e5e(a,b,c,f,l,x,H,U,ja){if(a&&f){a.fo.apply(a,ze.G4k);a.setValue(kb.a.Vkg,b);a.setValue(kb.a.C8b,!0);a.setValue(kb.a.tmd,1);a.setValue(kb.a.sid,f.sid);a.setValue(kb.a.cid,f.cid);c&&a.setValue(kb.a.vFa,!0);l&&a.setValue(kb.a.shapeId,l.get_shapeId());
x&&(a.setValue(kb.a.aq,!0),a.setValue(kb.a.qAh,x.cellId),a.setValue(kb.a.rowId,x.rowId));if(H&&0<H.length){b=H.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=H[l].rowId,f[l]=H[l].cellId;a.setValue(kb.a.aq,!0);a.setValue(kb.a.Zkb,f);a.setValue(kb.a.DAh,c)}a.setValue(kb.a.C1e,U);a.setValue(kb.a.B1e,ja)}}KOd(a,b,c){if(a&&b&&c){var f=!1;a.Be(ze.Vfa)||(a.HE(c,ze.Vfa),f=!0);b.pra(c);f&&b.Bya(c.id,4)}}xHh(a,b){if(a){var c=a.hya,f=this.nEa(c);f.setValue(kb.a.tmd,b);this.KOd(c,a,f)}}iFl(a){if(a){var b=
a.hya,c=this.nEa(b);c.setValue(kb.a.t3k,0);this.KOd(b,a,c)}}}ze.Vfa=ka.a.Hf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");ze.G4k=[kb.a.Vkg,kb.a.shapeId,kb.a.aq,kb.a.vFa,kb.a.qAh,kb.a.rowId,kb.a.Zkb,kb.a.DAh,kb.a.C1e,kb.a.B1e];Object(m.a)(ze,"RevisionMetadataHelper",null,[1430]);var ln=d(662),Ko=d(849);class rm extends rf.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=
c;this.SessionKey=f}Zk(){return 32}}Object(m.a)(rm,"SaveAndCloseRequest",rf.a,[]);class oo{constructor(a,b,c,f,l,x,H,U,ja){this.vi=a;this.O$c=b;this.LC=c;this.Xa=f;this.la=l;this.sB=x;this.Rd=H;this.mc=U;this.Mm=ja}G_i(a){this.Xa.fAb=!0;a=new rm(!0,!1,a,this.Xa.podSessionId);this.Rd.xka=!0;const b=this.vi.bSc();b&&b.NN()&&this.mc.Gn?this.la.VCa?(ia.ULS.sendTraceTag(509436876,844,50,"SaveAndCloseHandler: forceSaveOnUnload - application is unloading, forceOutbound to save any remaining changes."),b.forceOutbound(null,
null,null),this.O$c.e2d(a,null,null)):b.a9a(null,null,null,a):this.O$c.e2d(a,null,null)}u3(a=!1,b=!0,c=null,f=null,l=1){xa.a.J(509691458,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const x=new rm(a,!0,l,this.Xa.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.sB.markSessionClosingAtForceSave(l),this.Mm.pause(),this.O$c.a9a(x,H=>{xa.a.J(509691457,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.la.NTf?
this.sB.closeSession(l):this.LC.qkd(new ln.a(l));c(H)},()=>{xa.a.J(509691456,823,15,"SaveAndCloseHandler::ForceSave Failed.");this.Mm.Mlb();f&&f(null);return!0});else{a=this.vi.bSc();const H=U=>{this.qtk(x,c,f,ja=>0===ja.StatusCode,U,b,l)};a?a.forceOutbound(()=>{H(!0)},()=>{H(!1)},null):(xa.a.J(509691427,823,10,"Can't find graph space replicator when trying to do outbound"),H(!1))}}qtk(a,b,c,f,l,x,H){xa.a.J(509691426,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",
a.ShouldReleaseLock,l,x);l&&x||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Rd.xka=!0),this.O$c.Jsa(a,U=>{a.ShouldReleaseLock&&(this.la.NTf?this.sB.closeSession(H):this.LC.qkd(new ln.a(H)));b(U)},c,f)):l&&b?b(new Ko.a):!l&&c&&c(new Dn.a)}}Object(m.a)(oo,"SaveAndCloseHandler",null,[1277]);var En=d(1028),ni=d(102);class Og{constructor(a,b,c,f){this.vi=a;this.MCe=b;this.Nhc=c;this.Jwa=f}eY(a){let b=null,c=!0;if(this.vi.CYc)b=a.nsa,c=!1;else if(this.MCe.jd===D.a.typing||this.MCe.jd===D.a.gCa||this.MCe.jd===
D.a.oRa)b=a.nsa;b&&(this.Jwa&&this.LHi(b.toString()),Tc.a.ybb(),this.Nhc.CCh(b,c),xa.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.nsa.toString(),Tc.a.nf(new Date)));return!1}update(){}LHi(a){const b=new En.ActionContext(ni.a.REh,1,null);b.Nj=!0;b.sF=new Date;b.Va(ni.a.BY,Tc.a.$9a(a).toString());b.Ur=!0;Tc.a.Ofa(b)}}Object(m.a)(Og,"TextEditingRevisionInfoMetaDataUpdater",null,[1328]);class Ak{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Zb(a){this.K=a;
const b=()=>new Wc.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").A1b(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Ug);a.register(1276,"PowerPointWebEditor.Storage.IOutboundHelper").ma().oa(()=>new Ai(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1277,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().oa(()=>new oo(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1278,"PowerPointWebEditor.IPresentationResourcesManager").ma().oa(()=>new Tk(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").yd(7),c=>new jn(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),
this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.jyi()}jyi(){this.K.register(ze,"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(qm,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1279,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().oa(()=>new Vg(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),
this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));this.K.register(1280,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().oa(()=>new kn([new pm(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),Tl.dqg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new Og(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();
this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){z.a.instance.Dc(new Ak)}}Object(m.a)(Ak,"PPTWebEditorStoragePackage",null,[2,3]);class sc{constructor(a,b,c){this.fMh=a;this.DPh=b;this.h_h=c}get LCID(){return this.fMh}get k6k(){return this.h_h}get CLf(){return this.DPh}get Sie(){return!!(this.CLf&sc.jLh)}get y9b(){return!!(this.CLf&sc.kLh)}static XWc(){sc.yTe={["20490"]:new sc(20490,4215112,"Latn"),["8251"]:new sc(8251,4215112,"Latn"),["17418"]:new sc(17418,
4215112,"Latn"),["17417"]:new sc(17417,4215112,"Latn"),["8218"]:new sc(8218,4215304,"Cyrl"),["8204"]:new sc(8204,4215112,"Latn"),["8202"]:new sc(8202,4215112,"Latn"),["8201"]:new sc(8201,4215112,"Latn"),["8193"]:new sc(8193,4493640,"Arab"),["6154"]:new sc(6154,4215112,"Latn"),["7227"]:new sc(7227,4215112,"Latn"),["19466"]:new sc(19466,4215112,"Latn"),["16394"]:new sc(16394,4215112,"Latn"),["16393"]:new sc(16393,4215112,"Latn"),["16385"]:new sc(16385,4493640,"Arab"),["7194"]:new sc(7194,4215048,"Cyrl"),
["7180"]:new sc(7180,20808,"Latn"),["7178"]:new sc(7178,4215112,"Latn"),["7177"]:new sc(7177,4215112,"Latn"),["7169"]:new sc(7169,4493640,"Arab"),["12289"]:new sc(12289,4493640,"Arab"),["6203"]:new sc(6203,4215080,"Latn"),["15372"]:new sc(15372,4215112,"Latn"),["15370"]:new sc(15370,4215112,"Latn"),["15369"]:new sc(15369,4215112,"Latn"),["15361"]:new sc(15361,4493640,"Arab"),["6170"]:new sc(6170,4215304,"Latn"),["6156"]:new sc(6156,4215112,"Latn"),["18442"]:new sc(18442,4215112,"Latn"),["6153"]:new sc(6153,
4215112,"Latn"),["6145"]:new sc(6145,4493640,"Arab"),["4155"]:new sc(4155,4215080,"Latn"),["11274"]:new sc(11274,4215112,"Latn"),["5179"]:new sc(5179,4215112,"Latn"),["14348"]:new sc(14348,4215112,"Latn"),["14346"]:new sc(14346,4215112,"Latn"),["14345"]:new sc(14345,20808,"Latn"),["14337"]:new sc(14337,4493640,"Arab"),["5146"]:new sc(5146,4215048,"Latn"),["5132"]:new sc(5132,4215112,"Latn"),["5130"]:new sc(5130,4215112,"Latn"),["5129"]:new sc(5129,4215112,"Latn"),["5127"]:new sc(5127,4215112,"Latn"),
["5124"]:new sc(5124,4281672,"Hant"),["5121"]:new sc(5121,4493640,"Arab"),["31770"]:new sc(31770,4210820,""),["31748"]:new sc(31748,4277380,""),["10266"]:new sc(10266,4215048,"Cyrl"),["10252"]:new sc(10252,4215112,"Latn"),["10250"]:new sc(10250,4215112,"Latn"),["10249"]:new sc(10249,4215112,"Latn"),["13324"]:new sc(13324,4215112,"Latn"),["13322"]:new sc(13322,4215112,"Latn"),["13321"]:new sc(13321,4215112,"Latn"),["10241"]:new sc(10241,4493640,"Arab"),["13313"]:new sc(13313,4493640,"Arab"),["4122"]:new sc(4122,
4215048,"Latn"),["4108"]:new sc(4108,4215112,"Latn"),["4106"]:new sc(4106,4215112,"Latn"),["4105"]:new sc(4105,4215112,"Latn"),["4103"]:new sc(4103,4215112,"Latn"),["4100"]:new sc(4100,4282696,"Hans"),["3179"]:new sc(3179,4215048,"Latn"),["4097"]:new sc(4097,4493640,"Arab"),["1085"]:new sc(1085,299432,"Hebr"),["1144"]:new sc(1144,4280616,"Yiii"),["21514"]:new sc(21514,4215112,"Latn"),["2145"]:new sc(2145,5132616,"Deva"),["3131"]:new sc(3131,4215112,"Latn"),["2143"]:new sc(2143,4215432,"Latn"),["12314"]:new sc(12314,
4215048,"Cyrl"),["1070"]:new sc(1070,4215080,"Latn"),["1130"]:new sc(1130,4215080,"Latn"),["12300"]:new sc(12300,4215112,"Latn"),["1091"]:new sc(1091,4215080,"Latn"),["12298"]:new sc(12298,4215112,"Latn"),["12297"]:new sc(12297,4215112,"Latn"),["2055"]:new sc(2055,4215112,"Latn"),["2052"]:new sc(2052,4282664,"Hans"),["2115"]:new sc(2115,4215368,"Cyrl"),["9242"]:new sc(9242,4215304,"Latn"),["3098"]:new sc(3098,4215048,"Cyrl"),["2107"]:new sc(2107,4215112,"Latn"),["9228"]:new sc(9228,4215112,"Latn"),
["3084"]:new sc(3084,4215112,"Latn"),["9226"]:new sc(9226,4215112,"Latn"),["3082"]:new sc(3082,4215080,"Latn"),["3081"]:new sc(3081,4215112,"Latn"),["2094"]:new sc(2094,4215080,"Latn"),["3079"]:new sc(3079,4215112,"Latn"),["2092"]:new sc(2092,4215368,"Cyrl"),["1064"]:new sc(1064,4215080,"Cyrl"),["3076"]:new sc(3076,4281640,"Hant"),["2155"]:new sc(2155,4215048,"Latn"),["3073"]:new sc(3073,4493640,"Arab"),["1153"]:new sc(1153,4215080,"Latn"),["1119"]:new sc(1119,299400,"Arab"),["1086"]:new sc(1086,
4215080,"Latn"),["2144"]:new sc(2144,938632,"Deva"),["2077"]:new sc(2077,4215112,"Latn"),["1053"]:new sc(1053,4215080,"Latn"),["2141"]:new sc(2141,4215336,"Latn"),["2074"]:new sc(2074,4215304,"Latn"),["2073"]:new sc(2073,20808,"Cyrl"),["2072"]:new sc(2072,4215112,"Latn"),["2137"]:new sc(2137,4493896,"Arab"),["2070"]:new sc(2070,4215048,"Latn"),["2068"]:new sc(2068,4215048,"Latn"),["2067"]:new sc(2067,4215112,"Latn"),["1073"]:new sc(1073,4215080,"Latn"),["2064"]:new sc(2064,4215112,"Latn"),["2129"]:new sc(2129,
414016,"Tibt"),["2128"]:new sc(2128,4608584,"Mong"),["2060"]:new sc(2060,4215112,"Latn"),["1132"]:new sc(1132,4215080,"Latn"),["1097"]:new sc(1097,5132584,"Taml"),["2057"]:new sc(2057,4215080,"Latn"),["1164"]:new sc(1164,4493608,"Arab"),["106"]:new sc(106,4210820,""),["2118"]:new sc(2118,4493640,"Arab"),["2117"]:new sc(2117,5132584,"Beng"),["2049"]:new sc(2049,4493640,"Arab"),["1156"]:new sc(1156,4215080,"Latn"),["2110"]:new sc(2110,4215112,"Latn"),["1054"]:new sc(1054,4608296,"Thai"),["2108"]:new sc(2108,
4215048,"Latn"),["1083"]:new sc(1083,4215080,"Latn"),["136"]:new sc(136,4210820,""),["1114"]:new sc(1114,4493608,"Syrc"),["1148"]:new sc(1148,4215080,"Latn"),["1145"]:new sc(1145,20776,"Latn"),["11290"]:new sc(11290,4215304,"Latn"),["1075"]:new sc(1075,20776,"Latn"),["1106"]:new sc(1106,4215080,"Latn"),["1140"]:new sc(1140,4215080,"Latn"),["120"]:new sc(120,4276356,""),["1136"]:new sc(1136,4215080,"Latn"),["1066"]:new sc(1066,4215080,"Latn"),["1098"]:new sc(1098,5132584,"Telu"),["1169"]:new sc(1169,
4215048,"Latn"),["11276"]:new sc(11276,4215112,"Latn"),["61"]:new sc(61,295044,"Hebr"),["1060"]:new sc(1060,4215080,"Latn"),["11273"]:new sc(11273,4215112,"Latn"),["1058"]:new sc(1058,4215080,"Cyrl"),["128"]:new sc(128,4489348,""),["1160"]:new sc(1160,4215080,"Latn"),["1159"]:new sc(1159,4215080,"Latn"),["1158"]:new sc(1158,20776,"Latn"),["1157"]:new sc(1157,4215080,"Cyrl"),["11265"]:new sc(11265,4493640,"Arab"),["1155"]:new sc(1155,4215080,"Latn"),["1154"]:new sc(1154,4215080,"Latn"),["1117"]:new sc(1117,
4215080,"Cans"),["1152"]:new sc(1152,4493608,"Arab"),["1115"]:new sc(1115,5132584,"Sinh"),["1150"]:new sc(1150,4215080,"Latn"),["1113"]:new sc(1113,938280,"Deva"),["1112"]:new sc(1112,938280,"Beng"),["51"]:new sc(51,16516,""),["1146"]:new sc(1146,4215080,"Latn"),["1109"]:new sc(1109,5132584,"Mymr"),["115"]:new sc(115,4210820,""),["1143"]:new sc(1143,4215080,"Latn"),["1142"]:new sc(1142,20872,"Latn"),["1141"]:new sc(1141,4215080,"Latn"),["1104"]:new sc(1104,4215080,"Cyrl"),["2058"]:new sc(2058,4215112,
"Latn"),["1102"]:new sc(1102,5132584,"Deva"),["1137"]:new sc(1137,20776,"Latn"),["1100"]:new sc(1100,5132584,"Mlym"),["1135"]:new sc(1135,4215080,"Latn"),["1134"]:new sc(1134,4215080,"Latn"),["1133"]:new sc(1133,4215080,"Cyrl"),["1096"]:new sc(1096,5132584,"Orya"),["1131"]:new sc(1131,4215048,"Latn"),["1094"]:new sc(1094,5132584,"Guru"),["1129"]:new sc(1129,20872,"Latn"),["1128"]:new sc(1128,4215080,"Latn"),["1127"]:new sc(1127,20776,"Latn"),["1126"]:new sc(1126,20776,"Latn"),["1125"]:new sc(1125,
4493608,"Thaa"),["1124"]:new sc(1124,4215080,"Latn"),["1123"]:new sc(1123,4493608,"Arab"),["1122"]:new sc(1122,4215080,"Latn"),["1121"]:new sc(1121,5132584,"Deva"),["1120"]:new sc(1120,299400,"Arab"),["1118"]:new sc(1118,4215080,"Ethi"),["1082"]:new sc(1082,4215080,"Latn"),["1116"]:new sc(1116,4215080,"Cher"),["1080"]:new sc(1080,4215080,"Latn"),["1079"]:new sc(1079,4215080,"Geor"),["1078"]:new sc(1078,4215080,"Latn"),["1077"]:new sc(1077,4215080,"Latn"),["1111"]:new sc(1111,5132584,"Deva"),["1110"]:new sc(1110,
4215080,"Latn"),["1074"]:new sc(1074,4215080,"Latn"),["1108"]:new sc(1108,4608296,"Laoo"),["1107"]:new sc(1107,4608296,"Khmr"),["1071"]:new sc(1071,4215080,"Cyrl"),["1105"]:new sc(1105,4608296,"Tibt"),["1069"]:new sc(1069,4215080,"Latn"),["1103"]:new sc(1103,5132584,"Deva"),["1067"]:new sc(1067,4215080,"Armn"),["1101"]:new sc(1101,5132584,"Beng"),["1065"]:new sc(1065,4493608,"Arab"),["1099"]:new sc(1099,5132584,"Knda"),["1063"]:new sc(1063,4215080,"Latn"),["1062"]:new sc(1062,4215080,"Latn"),["1061"]:new sc(1061,
4215080,"Latn"),["1095"]:new sc(1095,5132584,"Gujr"),["1059"]:new sc(1059,4215080,"Cyrl"),["1093"]:new sc(1093,5132584,"Beng"),["1092"]:new sc(1092,4215080,"Cyrl"),["1056"]:new sc(1056,4493608,"Arab"),["1090"]:new sc(1090,4215080,"Latn"),["1089"]:new sc(1089,4215080,"Latn"),["1088"]:new sc(1088,4215080,"Cyrl"),["1087"]:new sc(1087,4215080,"Cyrl"),["1052"]:new sc(1052,4215080,"Latn"),["1051"]:new sc(1051,4215080,"Latn"),["1050"]:new sc(1050,4215048,"Latn"),["1049"]:new sc(1049,4215080,"Cyrl"),["1048"]:new sc(1048,
4215080,"Latn"),["1081"]:new sc(1081,5132584,"Deva"),["1046"]:new sc(1046,4215048,"Latn"),["1045"]:new sc(1045,4215080,"Latn"),["1044"]:new sc(1044,4215048,"Latn"),["1043"]:new sc(1043,4215080,"Latn"),["1076"]:new sc(1076,4215080,"Latn"),["1041"]:new sc(1041,4280616,"Jpan"),["1040"]:new sc(1040,4215080,"Latn"),["119"]:new sc(119,4210820,""),["1072"]:new sc(1072,4215176,"Latn"),["1037"]:new sc(1037,4493608,"Hebr"),["1036"]:new sc(1036,4215080,"Latn"),["1035"]:new sc(1035,4215080,"Latn"),["1068"]:new sc(1068,
4215080,"Latn"),["1033"]:new sc(1033,4215048,"Latn"),["1032"]:new sc(1032,4215080,"Grek"),["1031"]:new sc(1031,4215080,"Latn"),["1030"]:new sc(1030,4215080,"Latn"),["1029"]:new sc(1029,4215080,"Latn"),["1028"]:new sc(1028,4281672,"Hant"),["1027"]:new sc(1027,4215080,"Latn"),["1026"]:new sc(1026,4215080,"Cyrl"),["140"]:new sc(140,4489348,""),["1057"]:new sc(1057,4215080,"Latn"),["50"]:new sc(50,4210820,""),["1055"]:new sc(1055,4215080,"Latn"),["135"]:new sc(135,4210820,""),["134"]:new sc(134,16516,
""),["133"]:new sc(133,4210820,""),["132"]:new sc(132,4210820,""),["131"]:new sc(131,4210820,""),["130"]:new sc(130,4210820,""),["129"]:new sc(129,4210820,""),["1047"]:new sc(1047,4215080,"Latn"),["126"]:new sc(126,4210820,""),["89"]:new sc(89,5128324,""),["124"]:new sc(124,4210820,""),["1042"]:new sc(1042,4280616,"Hang"),["122"]:new sc(122,4210820,""),["121"]:new sc(121,16516,""),["1039"]:new sc(1039,4215080,"Latn"),["1038"]:new sc(1038,4215080,"Latn"),["118"]:new sc(118,16516,""),["117"]:new sc(117,
4210820,""),["116"]:new sc(116,4210820,""),["1034"]:new sc(1034,4219176,"Latn"),["114"]:new sc(114,4210820,""),["113"]:new sc(113,16516,""),["112"]:new sc(112,4210820,""),["111"]:new sc(111,4210820,""),["110"]:new sc(110,4210820,""),["109"]:new sc(109,4210820,""),["108"]:new sc(108,4210820,""),["107"]:new sc(107,4210820,""),["1025"]:new sc(1025,4493608,"Arab"),["105"]:new sc(105,16516,""),["104"]:new sc(104,4210820,""),["103"]:new sc(103,4210820,""),["102"]:new sc(102,16516,""),["101"]:new sc(101,
4489348,""),["100"]:new sc(100,4210820,""),["99"]:new sc(99,4489348,""),["98"]:new sc(98,4210820,""),["97"]:new sc(97,5128324,""),["96"]:new sc(96,966788,""),["95"]:new sc(95,4505732,""),["94"]:new sc(94,4210820,""),["93"]:new sc(93,4210820,""),["92"]:new sc(92,4210820,""),["91"]:new sc(91,5128324,""),["90"]:new sc(90,4489348,""),["85"]:new sc(85,5128324,""),["88"]:new sc(88,934020,""),["87"]:new sc(87,5128324,""),["86"]:new sc(86,4210820,""),["9275"]:new sc(9275,4215112,"Latn"),["84"]:new sc(84,
4604036,""),["83"]:new sc(83,4604036,""),["82"]:new sc(82,4210820,""),["81"]:new sc(81,4604036,""),["80"]:new sc(80,4604036,""),["79"]:new sc(79,5128324,""),["78"]:new sc(78,5128324,""),["77"]:new sc(77,5128324,""),["76"]:new sc(76,5128324,""),["75"]:new sc(75,5128324,""),["74"]:new sc(74,5128324,""),["73"]:new sc(73,5128324,""),["72"]:new sc(72,4210820,""),["71"]:new sc(71,4210820,""),["70"]:new sc(70,5128324,""),["69"]:new sc(69,5128324,""),["68"]:new sc(68,4210820,""),["67"]:new sc(67,4210820,
""),["66"]:new sc(66,4210820,""),["65"]:new sc(65,4210820,""),["64"]:new sc(64,4210820,""),["63"]:new sc(63,4210820,""),["62"]:new sc(62,4210820,""),["18441"]:new sc(18441,4215112,"Latn"),["59"]:new sc(59,4210820,""),["58"]:new sc(58,4210820,""),["57"]:new sc(57,5128324,""),["56"]:new sc(56,4210820,""),["55"]:new sc(55,4210820,""),["54"]:new sc(54,4210820,""),["53"]:new sc(53,4210820,""),["52"]:new sc(52,4210820,""),["31"]:new sc(31,4210820,""),["47"]:new sc(47,4210820,""),["49"]:new sc(49,4210820,
""),["48"]:new sc(48,4210820,""),["44"]:new sc(44,4210820,""),["46"]:new sc(46,4210820,""),["45"]:new sc(45,4210820,""),["41"]:new sc(41,4489348,""),["43"]:new sc(43,4210820,""),["42"]:new sc(42,4210820,""),["38"]:new sc(38,4210820,""),["40"]:new sc(40,4210820,""),["39"]:new sc(39,4210820,""),["35"]:new sc(35,4210820,""),["37"]:new sc(37,4210820,""),["36"]:new sc(36,4210820,""),["9225"]:new sc(9225,4215112,"Latn"),["34"]:new sc(34,4210820,""),["33"]:new sc(33,4210820,""),["32"]:new sc(32,4489348,
""),["29"]:new sc(29,4210820,""),["30"]:new sc(30,4604036,""),["27"]:new sc(27,4210820,""),["28"]:new sc(28,4210820,""),["9217"]:new sc(9217,4493640,"Arab"),["26"]:new sc(26,4210820,""),["25"]:new sc(25,4210820,""),["24"]:new sc(24,4210820,""),["23"]:new sc(23,4210820,""),["22"]:new sc(22,4210820,""),["21"]:new sc(21,4210820,""),["20"]:new sc(20,4210820,""),["19"]:new sc(19,4210820,"Latn"),["18"]:new sc(18,4276356,""),["17"]:new sc(17,4276356,""),["16"]:new sc(16,4210820,""),["15"]:new sc(15,4210820,
""),["14"]:new sc(14,4210820,""),["13"]:new sc(13,4489348,""),["12"]:new sc(12,4210820,""),["11"]:new sc(11,4210820,""),["10"]:new sc(10,4210820,""),["9"]:new sc(9,4210820,""),["8"]:new sc(8,4210820,""),["7"]:new sc(7,4210820,""),["6"]:new sc(6,4210820,""),["5"]:new sc(5,4210820,""),["4"]:new sc(4,4278404,""),["3"]:new sc(3,4210820,""),["2"]:new sc(2,4210820,""),["1"]:new sc(1,4489348,""),["0"]:new sc(0,1,"")}}static xe(a){sc.yTe||sc.XWc();return sc.yTe[a.toString()]}}sc.yTe=null;sc.jLh=262144;sc.kLh=
65536;Object(m.a)(sc,"ExtendedCultureInfo",null,[]);class Xi{UU(a,b){var c=a.sa($a.a.it,1033);Ya.a.xe(c)&&(c=sc.xe(c))&&(c.y9b?a.setValue(kb.a.eastAsianFont,b):c.Sie&&a.setValue(kb.a.complexScriptFont,b));a.setValue(kb.a.latinFont,b)}static qwi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.we($a.a.subscript,!0):0<b.baselineField?a.we($a.a.superscript,!0):(a.we($a.a.subscript,!1),a.we($a.a.superscript,!1)));b.bFieldSpecified&&a.we($a.a.bold,b.bField);b.noProofFieldSpecified&&a.we(ab.a.noProof,
b.noProofField);b.iFieldSpecified&&a.we($a.a.italic,b.iField);b.strikeFieldSpecified&&a.we($a.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.we($a.a.underline,b.uField);if(b.langField){var f=Ya.a.xe(b.langField);f?a.we($a.a.it,f.LCID):xa.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=Ya.a.xe(b.altLangField))?a.we(kb.a.dHc,f.LCID):xa.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+
b.altLangField));b.hlinkClickField&&(a.we($a.a.ht,!0),a.we($a.a.E_,!0));Xi.twi(a,b,c)}static wIf(a){a>Gf.a.xcd?a=Gf.a.xcd:a<Gf.a.Pcd&&(a=Gf.a.Pcd);return Xi.rQi(a)}static twi(a,b,c){b.szFieldSpecified&&a.we($a.a.fontSize,Xi.wIf(b.szField));(c=pe.Box4ColorHelper.AKb(b,c))&&a.setValue($a.a.fontColor,c.sD);b.latinField&&a.we(kb.a.latinFont,b.latinField.typefaceField);b.eaField&&a.we(kb.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.we(kb.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&
a.we(dh.a.capitalization,b.capField);b.symField&&a.we(kb.a.NNb,b.symField.typefaceField)}static rQi(a){return a/(Gf.a.bmc*Gf.a.S$a)}static Kzf(a){return a*Gf.a.S$a}}Object(m.a)(Xi,"FormattingHelper",null,[1227]);class Gl{w5i(a,b,c){let f="";const l=a.sa(ab.a.Q_,[]);l&&0<=b&&b<l.length&&(a=a.Fh)&&(b=a.Be(l[b]))&&b.Sa(kb.a.schemeColor)&&((b=zn.SchemeColor.parse(b.eb(kb.a.schemeColor)))?b.Kta?f=Ol.i(b.ZP):b.RPe(c)&&(f=Ol.i(b.ZP)):xa.a.J(38606471,826,50,"schemeClr is null."));return f}y5i(a,b){let c=
"";(a=a.Kpd)||xa.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&xa.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");a&&a.schemeClrField&&(14===a.schemeClrField.valField?xa.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?xa.a.J(38549312,826,50,"The color of shapeFont is B"):xa.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=pe.Box4ColorHelper.Tib(a,b),b=Ol.g(b.B_a),c=Ol.i(b),"000000"===c?xa.a.J(38549316,
826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?xa.a.J(38549318,826,50,"The resolved color of shapeFont is W"):xa.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));return c}}Object(m.a)(Gl,"NonTableThemeColorHelper",null,[1285]);class dm{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(m.a)(dm,"CT_TextFont",null,[]);class gk{constructor(){this.oSa=this.w_a=null}}Object(m.a)(gk,"ThemeFont",null,[]);
class We{static isThemeFont(a){return We.W4k.hasOwnProperty(a)}static i$i(a){let b="",c,f;({M8a:c,Bkb:f}=We.a$i(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static yli(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=We.P_,x=We.P_,H=We.P_;({Rog:l,rQf:x,xLf:H}=We.pIh(l,x,H,a));({Rog:l,rQf:x,xLf:H}=We.pIh(l,x,H,b));a=c.FontScheme;l!==We.P_?(We.XIb(a,0,l,We.jcd,f),We.XIb(a,
1,l,We.Vcd,f)):(l=We.m$a(a,0,0),b=We.m$a(a,1,0),We.Wa(l)||We.Wa(b)||(f.push(Object.assign(new gk,{w_a:l,oSa:We.jcd})),f.push(Object.assign(new gk,{w_a:b,oSa:We.Vcd}))));x!==We.P_?(We.XIb(a,0,x,We.icd,f),We.XIb(a,1,x,We.Ucd,f)):(x=We.m$a(a,0,1),l=We.m$a(a,1,1),We.Wa(x)||We.Wa(l)||(f.push(Object.assign(new gk,{w_a:x,oSa:We.icd})),f.push(Object.assign(new gk,{w_a:l,oSa:We.Ucd}))));H!==We.P_?(We.XIb(a,0,H,We.hcd,f),We.XIb(a,1,H,We.Tcd,f)):(H=We.m$a(a,0,2),x=We.m$a(a,1,2),We.Wa(H)||We.Wa(x)||(f.push(Object.assign(new gk,
{w_a:H,oSa:We.hcd})),f.push(Object.assign(new gk,{w_a:x,oSa:We.Tcd}))));return f}static Wa(a){return!a||!a.length}static XIb(a,b,c,f,l){a&&c!==We.P_&&(c=We.cnj(a,b,c),We.Wa(c)&&(c=We.m$a(a,b,0),We.Wa(c)&&(c="Arial")),l.push(Object.assign(new gk,{w_a:c,oSa:f})))}static m$a(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=We.s8f(a.majorFontField,c));break;case 1:a.minorFontField&&(f=We.s8f(a.minorFontField,c))}return f}static s8f(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);
break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static cnj(a,b,c){if(!a||c===We.P_)return"";let f="";if(1066===c)f="Viet";else if(1152===c)f="Uigh";else if(c=sc.xe(c))f=c.k6k;return We.dnj(a,b,f)}static dnj(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=We.r8f(a.majorFontField,c));break;case 1:a.minorFontField&&(f=We.r8f(a.minorFontField,c))}return f}static r8f(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=
0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static pIh(a,b,c,f){if(f!==We.P_){const l=sc.xe(f);l&&(l.y9b?b===We.P_&&(b=f):l.Sie?c===We.P_&&(c=f):a===We.P_&&(a=f))}return{Rog:a,rQf:b,xLf:c}}static a$i(a){switch(a){case We.hcd:return{returnValue:!0,M8a:0,Bkb:2};case We.icd:return{returnValue:!0,M8a:0,Bkb:1};case We.jcd:return{returnValue:!0,M8a:0,Bkb:0};case We.Tcd:return{returnValue:!0,M8a:1,Bkb:2};
case We.Ucd:return{returnValue:!0,M8a:1,Bkb:1};case We.Vcd:return{returnValue:!0,M8a:1,Bkb:0}}return{returnValue:!1,M8a:2,Bkb:0}}static dub(a,b){let c=null;if(0===a)switch(b){case 2:c=We.hcd;break;case 1:c=We.icd;break;case 0:c=We.jcd}else if(1===a)switch(b){case 2:c=We.Tcd;break;case 1:c=We.Ucd;break;case 0:c=We.Vcd}null===c&&(xa.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new dm,{typefaceField:c,charsetField:1})}}We.hcd="+mj-cs";
We.icd="+mj-ea";We.jcd="+mj-lt";We.Tcd="+mn-cs";We.Ucd="+mn-ea";We.Vcd="+mn-lt";We.P_=0;We.W4k={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(m.a)(We,"TextFontHelper",null,[]);class po{constructor(a,b,c){this.ua=a;this.jc=b;this.D9c=c}c2k(a,b){let c="";var f=a.sa($a.a.it,We.P_),l=a.sa(kb.a.dHc,We.P_),x=sc.xe(f===We.P_?1033:f);if(x){let H="";a.Sa(kb.a.NNb)?H=a.eb(kb.a.NNb):x.Sie&&a.Sa(kb.a.complexScriptFont)?H=a.eb(kb.a.complexScriptFont):x.y9b&&a.Sa(kb.a.eastAsianFont)?
H=a.eb(kb.a.eastAsianFont):a.Sa(kb.a.latinFont)&&(H=a.eb(kb.a.latinFont));if(We.isThemeFont(H)){x=!1;let U=null;if(this.D9c){if(b=Object(oa.a)(115,this.jc.kg(b)))U=b.ke}else{if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");U=this.ua.Ba.ke}if(U&&(f=We.yli(f,l,U)))for(l=0;l<f.length;l++)if(H===f[l].oSa){c=f[l].w_a;x=!0;break}x||(c=We.i$i(H))}else c=H}c&&a.we($a.a.font,c)}}Object(m.a)(po,"FontResolver",null,[1284]);class Lo{constructor(a){this.A8j=a}UAi(a,b,c){a($a.a.it);a(kb.a.latinFont);
a(kb.a.eastAsianFont);a(kb.a.complexScriptFont);a(kb.a.NNb);a(kb.a.dHc);a(kb.a.ke);a(kb.a.gtb);a(kb.a.BAb);a(kb.a.oN);a(kb.a.schemeColor);a(kb.a.QYc);a(kb.a.IZd);a(kb.a.FZd);a(kb.a.CZd);a(kb.a.MZd);a(kb.a.l8b);this.A8j.c2k(b(),c)}}Object(m.a)(Lo,"PptFormattingCacheCopyPropertyStrategy",null,[1329]);class qo{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Zb(a){this.K=a;a.register(1284,"Box4.IFontResolver").ma().oa(()=>new po(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1227,"PowerPointWebEditor.IFormattingHelper").ma().oa(()=>new Xi);a.register(Lo,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().oa(()=>new Lo(a.resolve("Box4.IFontResolver")));a.register(1285,"PowerPointWebEditor.INonTableThemeColorHelper").ma().oa(()=>new Gl)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");
this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){z.a.instance.Dc(new qo)}}Object(m.a)(qo,"PPTWebEditorTextFormattingPackage",null,[2,3]);class Mo{constructor(a){this.fd=a;this.pOh=P.a.instance.ga(115)}rkg(a){return this.Vig(a)?!0:this.pOh?1074135161===a.Ue||1074135162===a.Ue:!1}Uig(a){return this.Vig(a)||131162===a.Ue||4325465===a.Ue||1179729===a.Ue}Vig(a){return 131140===a.Ue||this.fd.gg&&131120===a.Ue}JPf(a){return pa.a.any(a.UJ,(b,c)=>!this.Uig(c)&&!this.rkg(c))}}
Object(m.a)(Mo,"UndoRevisionValidator",null,[1449]);class Tm{constructor(){this.hd=Db.a.instance.ub("Box4.IFeatureHelper")}yMb(){return u.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}v0a(){return this.yMb()&&u.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(m.a)(Tm,"UndoSettingsManager",null,[1448]);var em=d(345),Nj=d(1027),Rn=d(202);class mn{Sa(a){return a.Sa(void 0)}q5f(a,b){return a.sa(b,null)}OTc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Nj.a(a)}t5f(a,b){return a.sa(b,
"")}Yqh(a,b,c){a.setValue(b,c)}}Object(m.a)(mn,"MergeableObjectUtilities",null,[365]);class ro{constructor(a,b,c,f,l){this.Fb=a;this.ua=b;this.Fa=c;this.pa=f;this.j0=l}led(a,b,c){if(a)if("PowerPointGroupShapes"===b&&c)for(a=a.UJ,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Ue&&f.Sa(kb.a.S8)){f=(new mn).OTc(f,kb.a.S8);for(var l=0;l<f.length;l++){var x=this.ua.Ba;if(!x)throw Error.argumentNull("ActiveSlide is null");const H=this.j0.qda(f.ga(l));x=x.wC(H.get_shapeId());b.push(x)}this.czj(b)}}else if("PowerPointUngroupShapes"===
b&&!c)for(a=a.UJ,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Ue&&c.Sa(kb.a.jpa))for(c=(new mn).OTc(c,kb.a.jpa),f=0;f<c.length;f++){l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");x=this.j0.qda(c.ga(f));l=l.wC(x.get_shapeId());this.bzj(l)}}cWc(a){if(a){const b=a.mg(this.Fb.Ma);b.wka();b.eLb=!0;this.pa.p8(a)}else xa.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}czj(a){if(a.length){var b=this.Fa.ys(a[0]);this.cWc(b);
for(const c of a)this.cWc(c)}}bzj(a){this.cWc(a);if(a.Jf){a=this.Fa.ex(a);for(const b of a)this.cWc(b)}}}Object(m.a)(ro,"GroupUngroupUndoRedoActionController",null,[1271]);class Uk{k2g(){}led(){}M1g(){}m1g(){}x0c(){return!1}}Object(m.a)(Uk,"NoOpTablePartialEditController",null,[1272]);class ep{constructor(a,b,c,f,l,x){this.teb=null;this.vi=a;this.Fa=b;this.Nhc=c;this.Vb=f;this.pa=l;this.Fec=x}k2g(){this.sme()&&this.u_e()}led(a){a&&this.sme()&&(a=this.teb,this.u_e(),this.nyh(a))}M1g(a,b,c,f){this.sme()&&
!this.uRj(a,b,c,f)&&this.u_e()}m1g(a,b,c){if(a&&b&&c){this.teb=null;a=this.pa.Wd();c=new Rd.a;b=b.UJ;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Ue&&f.Sa(kb.a.cellId)&&(f=this.Fa.$m(f),Array.contains(a,f)&&c.$(f.get_shapeId(),f))}0<c.count&&this.nyh(c.values.ga(0))}}uRj(a,b,c,f){let l=!1;b&&this.x0c(a)&&(f=b.vT&&f,l=(c||f)&&b.actionId===a,this.Fec||(l=(b.actionId===a||this.x0c(b.actionId))&&1===this.Nhc.Cxb(b.o6)||l));return l}x0c(a){let b=a===D.a.gCa||a===D.a.oRa||a===D.a.typing;this.Fec||
(b=a===D.a.zB||a===D.a.enter||b);return b}nyh(a){this.teb=a}u_e(){if(this.teb){const a=this.Vb.xi.zi.ax.id;0!==this.Nhc.Cxb(a)&&this.Nhc.CCh(a,!1);this.vi.j7a(this.teb,!0)}this.teb=null}sme(){return!!this.teb}}Object(m.a)(ep,"TablePartialEditController",null,[1272]);var yp=d(916);class Qk{constructor(a,b,c,f){this.Mv=a;this.dik=c;this.ia=f;this.wb()}wb(){this.ia.ra(K.a.Whb,rc.a.application,Object(F.a)(this,this.Whb,"queryIsShapeTextEditHappened"),96)}Whb(a,b,c,f,l){l.nua=this.nua(l.Ksc,l.GYj);return 32}Vpj(a,
b,c){this.dik.Qvl(new yp.a(a,b,c))}nua(a,b){let c=!1;a&&(c=!this.Mv.QZc()&&a.RFa!==b,this.Mv.QZc()||a.RFa!==b||xa.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",Object(Xa.a)(4,a)?"Shape":"Notes"));return c}}Object(m.a)(Qk,"PPTUndoActionBehavior",null,[1447]);class No extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(m.a)(No,"OnUndoEventArgs",Sys.EventArgs,[]);
var t=d(724),ba=d(136);class ua extends t.a{constructor(a=null,b=null,c=null){super(a,b);this.ZFd=c||new mn}OIb(){super.OIb();const a=new Nj.a,b=new Na.a;b.add(ka.a.nil);this.djb.forEach((l,x)=>{b.add(x);a.add(x);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<a.length;){var c=a.ga(0);a.TZd(0);var f=this.objects.ga(c)||this.c_.Xwb(c);if(f){c=f;f=c.$z();for(let l=0;l<f.length;l++){const x=f[l],H=ba.a.y6b(ba.a.mYf(x));8===H?this.Xsf(this.ZFd.q5f(c,x),a,b):9===H&&this.ZFd.OTc(c,
x).forEach(U=>{this.Xsf(U,a,b);return!0})}}else Fa.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}Xsf(a,b,c){c.contains(a)||(c.add(a),this.xkg(a)&&(c=this.c_.Xwb(a),this.YFe(c),b.add(a)))}}Object(m.a)(ua,"ReferenceFollowingRevisionDiffer",t.a,[]);class Ra{jGi(a,b){return new ua(a,b)}}Object(m.a)(Ra,"UndoDifferFactory",null,[1435]);var jb=d(287),w=d(589);class T{constructor(a,b,c,f,l,x,H){a||jb.a.argument("revisionStore cannot be null","revisionStore");b||jb.a.argument("undoRevisionValidator cannot be null",
"undoRevisionValidator");c||jb.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||jb.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||jb.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");x||jb.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.TZh=a;this.VEc=b;this.eca=c;this.z2h=f;this.lWb=l;this.D2h=x;this.lef=H}ILc(a,b){const c=this.z2h.jGi(a,b);c.OIb();const f=new w.a;f.o_e(this.lWb,a);c.djb.forEach((H,
U)=>{f.Bya(U,H);return!0});const l=new Nj.a,x=a.HT<b.HT;c.objects.forEach((H,U)=>{if(this.VEc.rkg(U))return!0;if(x&&!this.VEc.Uig(U)&&!b.I_(H)&&!a.I_(H))return l.add(H),!0;f.pra(U);return!0});0<l.length&&ia.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,l.Er());this.lef&&this.lef.$Dl(f);return f.YPc()}kGi(a,b,c,f){b=this.ILc(a,b);if(!b)return null;if(a.id===c.id)return ia.ULS.sendTraceTag(22607312,365,this.eca.v0a()?15:
50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.eca.v0a()),b;a=this.ILc(a,c);if(!a)return null;var l=b;this.VEc.JPf(a)?(ia.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),l=new Nj.a,l.add(a),a=new Nj.a,a.add(b),l=this.D2h.Klk(f,a,l,c.rmd).PO.last()):ia.ULS.sendTraceTag(22607314,365,this.eca.v0a()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",
this.eca.v0a());return this.ILc(c,l)}lGi(a,b,c,f,l){let x=null;f||(this.eca.v0a()||!this.eca.yMb()?x=this.ILc(c,b):(ia.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(x=this.kGi(a,b,c,l));return x&&this.$ql(x)?x:null}$ql(a){return this.VEc.JPf(a)?(this.TZh.Mkb(a),!0):!1}}Object(m.a)(T,"UndoRevisionManager",null,[1434]);var ea=d(160);class ra{constructor(a){this.kif=null;this.Pa=new wc.a;this.Amb=null;this.Jqb=[];this.E2h=
a}dispose(){for(;0<this.Jqb.length;)this.Xhh(this.Jqb[0])}get LK(){return this.Amb}set LK(a){this.Amb&&(this.Amb.isActive=!1);if(this.Amb=a)this.Amb.isActive=!0}register(a){if(!this.dla(a)){const b=this.E2h.MHi(a);b.bsh(c=>{this.Pa.raiseEvent(ra.Syk,new No(c))});a.addListener(this);Array.add(this.Jqb,b)}}unregister(a){if(a=this.Exb(a))a===this.LK&&(this.LK=null),this.Xhh(a)}setActive(a){this.LK=this.Exb(a)}QJc(){const a=this.Exb(void 0);a&&(a.soa(void 0),this.PFe())}get NW(){return this.MI?this.LK.NW:
!1}get gZd(){return this.MI?this.LK.gZd:null}get vka(){return this.MI?this.LK.vka:!1}get tFa(){return this.MI?this.LK.tFa():!1}f_e(a,b){this.MI&&this.LK.f_e(a,b)}qw(){this.MI&&this.LK.qw()}IW(){return this.MI?this.LK.IW():null}undo(){return this.MI?this.LK.undo():!1}redo(){return this.MI?this.LK.redo():!1}AYa(a,b,c=!1){this.MI&&this.LK.AYa(a,b,c)&&(this.PFe(),this.kif&&this.kif())}XIe(){this.MI&&this.LK.XIe()}Xhh(a){a.graphSpace.removeListener(this);a.bsh(null);a.dispose();Array.remove(this.Jqb,a)}dla(a){return!!this.Exb(a)}get MI(){return!!this.LK}Exb(a){for(let b=
0;b<this.Jqb.length;b++){const c=this.Jqb[b];if(c.oJj(a))return c}return null}PFe(){Oc.App.Kb.updateCommandUI()}Yed(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.Exb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.Exb(a);if(b)b.onAfterLoadContent(a);this.LK===b&&(this.LK.NW||this.LK.vka)&&this.PFe()}onAfterFirstSaveContent(){}}ra.Syk="OnUndo";Object(m.a)(ra,"UndoManager",null,[1445,798,106,1446]);class wa extends ra{constructor(a,b,c){super(a);this.J6j=b;this.Tbd=c;
this.J6j.$8h(Object(F.a)(this,this.btk,"onFailoverSucceeded"));this.Tbd.iPd(Object(F.a)(this,this.iuk,"onInitialSelectionSet"))}get Ixa(){return this.LK}xLj(a){return this.MI?this.Ixa.whg(a):!1}XUd(){this.MI&&this.Ixa.Rsi()}r6d(a){return this.MI?this.Ixa.r6d(a):null}dSc(a){return this.MI?this.Ixa.dSc(a):0}u0e(){this.MI&&this.Ixa.u0e()}get NW(){return this.MI?this.Ixa.Vxj:!1}soa(){this.MI&&this.Ixa.soa(!0)}btk(a,b){b.JTj&&this.soa()}iuk(){this.AYa(D.a.fUa,null)}u4e(a){this.MI&&this.Ixa.u4e(a)}QZc(){return this.MI?
this.Ixa.QZc():!1}Pab(){return this.MI?this.Ixa.Pab():!1}}Object(m.a)(wa,"PPTUndoManager",ra,[1444,1445,798,106,1446]);class Za{Klk(a,b,c,f){return a?a.Icd(b,c,null,f,1,!1,5):null}}Object(m.a)(Za,"PPTUndoRevisionMergeStrategy",null,[1443]);var ub=d(140),zb=d(48);class tc{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){this.oxe=!1;if(ae&&!Gc)throw Error.argumentNull("viewElementEventNotifier");this.$pe=a;this.uB=b;this.JTg=c;this.VXa=f;this.lIa=l;this.lfb=x;this.Qhc=H;this.CJ=Gc;this.d5=
ae;U===zb.a.Az&&(U=zb.a.Hp);this.tyg=U;this.pa=ja;this.Tb=ya;this.g9j=Va;this.Vb=hb;this.Ea=yb;this.ia=Zb;this.Hec=fc;this.thc=Kc;this.Fb=Lc}U2k(){this.HEh();if(this.uB){var a=this.Tb.zl(this.uB);a&&this.g9j.Ba!==a&&(this.Vb.Ba=a)}if(this.Hec){if(this.VXa&&0<this.VXa.length){a=[];for(const b of this.VXa){let c=this.Tb.zl(b);c&&a.push(c)}if(0<a.length){let b;(b=this.pa).JR.apply(b,a)}}this.ia.processAction(K.a.K_a,2)}this.d5&&this.CJ&&this.CJ.neh()}MU(a=!1,b=null){this.U2k();if(this.oxe||this.pgg())return this.oxe=
!1,null;b||(b=this.Jsb());this.setSelection(a,b);return b}Jsb(){let a=null;if(0<this.lfb.length){const b=this.Tb.zl(this.uB);if(b){const c=[];for(const f of this.lfb){if(!f)continue;const l=b.iT(f);if(l){const x=l.mg(this.Fb.Ma);x&&!x.eLb&&c.push(Qd.SelectionFactory.wl(l))}}0<c.length&&(a=new ub.SelectionCollection(c,c.length-1))}}a||(a=this.$pe.Jsb(!0));!a&&this.Qhc&&(a=this.Qhc.WYf());return a}setSelection(a=!1,b=null){this.$pe.setSelection(a,b);b&&this.Qhc&&xa.a.J(509445784,816,50,"Selection restore to IP level");
b||this.tyg!==zb.a.sg?this.Ea.tf(this.tyg):(this.pa.Qh(),this.Ea.Ed())}rIc(){return this.$pe.rIc()}HEh(){this.uB=this.I3e(this.uB,this.JTg);const a=[];let b=0;for(const c of this.VXa)a.push(this.I3e(c,this.lIa[b++]));this.VXa=a}I3e(a,b){let c=a;a&&M.a.ix(a)&&(a=this.Tb.u6b(b),a||(b=this.thc.yjj(b),null!=b&&(a=this.Tb.sEa(b))),a&&(c=a.Cb));return c}qAl(){this.uB=this.I3e(this.uB,this.JTg);this.Hec&&this.HEh();if(this.lfb.length&&Array.contains(this.lfb,0)){Array.clear(this.lfb);var a=this.Jsb();if(this.pa.K_(a))for(let b of a)(a=
Object(oa.a)(4,b.Ua.node))&&this.lfb.push(a.get_shapeId())}}wFl(){this.oxe=this.pgg()}pgg(){const a=this.Tb.zl(this.uB);if(!a)return!1;var b=this.Qhc?[this.Qhc.yWd]:this.lfb;for(const c of b)if((b=a.iT(c))&&b.$p)return!0;return!1}}Object(m.a)(tc,"PPTUndoSelectionReference",null,[446,1442]);class pc{constructor(a,b,c,f,l){this.oc=a;this.are=b;this.H3c=c;this.Lhc=f;this.Khc=l}WYf(){var a=this.oc.zl(this.are);if(!a)return null;a=a.iT(this.H3c);if(!a)return null;a=a.vUc();if(!a)return null;var b=a.sa($a.a.iza,
0);const c=a.sa($a.a.xga,0);if(!this.Lhc||!this.Khc||this.Lhc.HLa>=b||this.Lhc.GLa>=c||this.Khc.HLa>=b||this.Khc.GLa>=c)return null;b=tb.GraphIterator.nb(a.qf(this.Lhc.HLa,this.Lhc.GLa));b.rc(14);a=tb.GraphIterator.nb(a.qf(this.Khc.HLa,this.Khc.GLa));a.rc(14);return Qd.SelectionFactory.B1b(b,a)}get yWd(){return this.H3c}}Object(m.a)(pc,"PPTUndoTableCellSelectionPos",null,[1473]);class bc{constructor(a,b,c,f,l,x,H,U){this.Qb=a;this.oc=b;this.ZX=c;this.E6j=f;this.are=l;this.H3c=x;this.abd=H;this.whk=
U}WYf(){var a=this.oc.zl(this.izi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.iT(this.yWd),!b)return null;var c=[];switch(this.containerType){case 10:c=this.Y4d(b);break;case 16:a=this.Qb.Nc(b);if(!a.Gi()||!a.Gi())return null;if(0>this.HLa||0>this.GLa||this.HLa>=a.currentNode.sa($a.a.iza,0)||this.GLa>=a.currentNode.sa($a.a.xga,0)){this.ZX.MZg(a,0,0);c.push(Qd.SelectionFactory.tj(a.currentNode,!0));break}this.ZX.MZg(a,this.HLa,this.GLa);c=this.Y4d(a.currentNode);
break;case 60:c=a.$Sa();if(!c)return null;c=this.Y4d(c);break;default:return null}return 0<c.length?new ub.SelectionCollection(c,0):null}get yWd(){return this.H3c}Y4d(a){const b=[];for(const c of this.vul){const f=c.V1i(a);f&&b.push(f)}b.length||b.push(Qd.SelectionFactory.tj(a,!0));return b}get containerType(){return this.E6j}get izi(){return this.are}get GLa(){return this.abd?this.abd.GLa:-1}get HLa(){return this.abd?this.abd.HLa:-1}get vul(){return this.whk}}Object(m.a)(bc,"PPTUndoTextSelectionPos",
null,[1473]);class yc{constructor(a,b){this.chk=a;this.khk=b}get GLa(){return this.chk}get HLa(){return this.khk}}Object(m.a)(yc,"TableCellIndex",null,[]);class $c{constructor(a,b,c,f,l,x){this.Qb=a;this.Hh=b;this.zck=c;this.H6j=f;this.k$j=l;this.j$j=x}get contextId(){return this.H6j}get paragraphIndex(){return this.zck}get f9b(){return this.k$j}get e9b(){return this.j$j}V1i(a){a=this.Qb.Nc(a);if(!a.Hae(this.paragraphIndex)||11!==a.yq.type||!a.Bb(2)||12!==a.yq.type&&21!==a.yq.type||this.f9b>this.e9b||
-1>this.f9b||this.e9b>this.Hh.textLength(a.currentNode))return null;switch(this.contextId){case Cb.a.Pf:return Qd.SelectionFactory.f3(a.currentNode,this.f9b,this.e9b);case Cb.a.textRange:return Qd.SelectionFactory.f3(a.currentNode,this.f9b,this.e9b);case Cb.a.endOfParagraph:return Qd.SelectionFactory.Gca(a.currentNode);case Cb.a.paragraph:return Qd.SelectionFactory.Du(Wd.a.QQa(this.f9b,this.e9b,!1,a.currentNode))}return null}}Object(m.a)($c,"TextContextRecord",null,[]);class gd{constructor(a,b,c,
f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){if(Kc&&!fc)throw Error.argumentNull("viewElementEventNotifier");this.$5j=a;this.pa=b;this.rzg=c;this.Vb=f;this.Qb=l;this.Ea=x;this.oc=H;this.Fa=U;this.Hh=ja;this.ZX=ya;this.ia=Va;this.Hec=hb;this.thc=yb;this.Fb=Zb;this.CJ=fc;this.d5=Kc}gsa(){const a=this.$5j.gsa();let b=null,c=ka.a.nil;const f=this.rzg.Ba;f&&(b=f.Cb,c=f.id);const l=[],x=[];if(this.Hec){var H=this.pa.Qe();for(var U of H)l.push(U.Cb),x.push(U.id)}H=[];U=null;f&&(this.pa.gH()&&this.hSk(H),this.pa.Xz()&&
(U=this.mSk(b)));return new tc(a,b,c,l,x,H,U,this.Ea.i8,this.pa,this.oc,this.rzg,this.Vb,this.Ea,this.ia,this.Hec,this.thc,this.Fb,this.CJ,this.d5)}b_c(a){return 10===a.type||60===a.type||16===a.type}hSk(a){const b=this.pa.Wd();for(const c of b)a.push(c.get_shapeId())}mSk(a){return this.pa.Na.mb.jg?this.kSk(a):this.lSk(this.pa.Na,a)}lSk(a,b){var c=Object(oa.a)(5,a.mb.Ua.node),f=this.Qb.Nc(c);if(f.D6(Object(F.a)(this,this.b_c,"isOEContainerNode")))if(f.zc()&&11===f.currentNode.type){if(f.zc()){c=(c=
this.Fa.oda(c))?c.get_shapeId():0;const l=f.yq.type;f=16===l?this.J$d(Object(oa.a)(123,f.yq)):null;const x=a.mb,H=[];this.Cwf(x,H);for(let U of a)U!==x&&this.zfi(U,x)&&this.Cwf(U,H);return new bc(this.Qb,this.oc,this.ZX,l,b,c,f,H)}}else xa.a.J(509445783,816,15,"Find text selection but its container is not OutlineElement");return null}kSk(a){var b=this.pa.Na.ga(0),c=this.pa.Na.last,f=b.jg;b=16===f.Ua.node.type?this.J$d(Object(oa.a)(123,f.Ua.node)):null;f=c.jg;c=16===f.Ye.node.type?this.J$d(Object(oa.a)(123,
f.Ye.node)):null;f=(f=this.Fa.oda(f.Ua.node))?f.get_shapeId():0;return new pc(this.oc,a,f,b,c)}J$d(a){return a?new yc(a.pi,a.rowIndex):null}Cwf(a,b){for(let c of a){if(!Object(Xa.a)(102,c.node))continue;a=this.Qb.Nc(c.node);if(!a.D6(Object(F.a)(this,this.b_c,"isOEContainerNode")))continue;a.zc();const f=a.currentNode;a.zc();a=a.FSa(f);b.push(new $c(this.Qb,this.Hh,a,c.contextId,c.Qa,c.Mb))}}zfi(a,b){a=this.Qb.Nc(a.Ua.node);b=this.Qb.Nc(b.Ua.node);return a.D6(Object(F.a)(this,this.b_c,"isOEContainerNode"))&&
b.D6(Object(F.a)(this,this.b_c,"isOEContainerNode"))&&a.zc()&&11===a.currentNode.type&&b.zc()&&11===b.currentNode.type&&a.zc()&&b.zc()?a.currentNode===b.currentNode:!1}}Object(m.a)(gd,"PPTUndoSelectionReferenceFactory",null,[428]);class md{constructor(){this.BWa=this.ESg=this.cBe=this.lWg=null;this.h7c=!1;this.TCe=null}F3e(){if(!this.BWa.izb&&this.BWa.v1c)for(const a of this.BWa.v1c)if(a.equals(this.lWg)){this.cBe.MU(!1,this.ESg);xa.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.TCe);this.BWa.roc(Object(F.a)(this,this.F3e,"trySetSelectionWhenServerUndoRedoFinish"));this.h7c=!0;break}}jVk(a,b,c,f){a&&(this.lWg=b,this.ESg=f,(this.cBe=Object(oa.a)(1442,c))?(this.f4e(),this.TCe=new Date,this.BWa=a,this.BWa.uGc(Object(F.a)(this,this.F3e,"trySetSelectionWhenServerUndoRedoFinish")),this.h7c=!1):xa.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}f4e(){this.BWa&&!this.h7c&&(xa.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.TCe),this.BWa.roc(Object(F.a)(this,this.F3e,"trySetSelectionWhenServerUndoRedoFinish")),this.h7c=!0)}}Object(m.a)(md,"PPTUndoSelectionRestoreExecutor",null,[1270]);class Sc{constructor(){this.Sgk=new Rd.a(!1);this.gik=new Rd.a(!1);this.yGg=new Rd.a(!1);this.init()}init(){this.cDj()}cDj(){this.yGg.add(K.a.xI,!0)}wBi(a){return a&&this.Sgk.Hb(a)?!0:!1}vBi(a){return a&&this.gik.Hb(a)?!1:!0}Yhl(a){return a&&this.yGg.Hb(a)?!0:!1}}Object(m.a)(Sc,"PPTUndoSettings",null,[1441]);class Zd{constructor(a){this.Kj=
null;this.X8e=a}start(a){this.Kj=a}Gxj(){var a=new Date;return this.X8e?+a-+this.Kj>this.X8e:!1}}Object(m.a)(Zd,"UndoTimer",null,[1472]);var Pe=d(478),qe=d(519);class cg{constructor(a){this.xba=this.I2=null;this.evb=this.Xrc=a}get Xrc(){return this.I2}set Xrc(a){this.I2&&(this.I2.XO&=-2);this.I2=a;this.I2.XO|=1}get evb(){return this.xba}set evb(a){this.xba&&(this.xba.XO&=-3);this.xba=a;this.xba.XO|=2}get o6(){return this.I2?this.I2.id:ka.a.nil}get g1d(){return this.xba?this.xba.id:ka.a.nil}get UJ(){return this.I2?
this.I2.spg():[]}combineWithPrevious(){}dispose(){this.I2&&(this.I2.XO&=-2);this.xba&&(this.xba.XO&=-3)}}Object(m.a)(cg,"Box4UndoRecordData",null,[1478,106]);class mg{constructor(a,b,c,f,l,x){this.rya=a;this.rjb=b;this.A2h=c;this.actionId=f;this.vT=l;this.zKa=x}get M1(){return this.A2h}get o6(){return this.M1.o6}dispose(){this.M1&&this.M1.dispose()}}Object(m.a)(mg,"UndoRecord",null,[106]);class Zf{constructor(){this.ara=[]}ga(a){return this.ara[a]}get length(){return this.ara.length}add(a){this.ara.push(a)}clear(){for(let a=
0;a<this.ara.length;a++)this.ara[a].dispose();Array.clear(this.ara)}remove(a){const b=Array.remove(this.ara,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.ara.length&&(this.ara[a].dispose(),Array.removeAt(this.ara,a))}}Object(m.a)(Zf,"UndoRecordsArray",null,[]);class Sj{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze){this.b5a=!0;this.u3a=this.Qcf=this.Ozc=this.$pb=!1;this.Tnb=null;this.SGd=this.zjf=0;this.tNd=null;this.Gof=!0;this.isActive=!1;this.Iz=a;this.nyd=b;this.sVh=
c;this.rBd=f;this.A3h=l;this.EXh=x;this.Ak=H;this.WH=U;this.umf=ja;this.q_h=ya;this.Zd=Va;this.r2h=hb;this.A_h=yb;this.Ilf=Zb;this.B2h=Kc;this.gqf=Lc;this.F2h=Gc;this.iqf=ae;this.eca=we;this.Py=Te;this.Qg=new Zf;this.rs=this.qh=-1;this.$df=Object(F.a)(this,this.bKf,"createInitialUndoRecord");this.dDc=fc;this.dDc.wai(Object(F.a)(this,this.Whh,"removeUndoRecordForRevision"));this.Gof=Ze}dispose(){this.$df=null;this.QJc();this.Iz=null;this.dDc.zZk(Object(F.a)(this,this.Whh,"removeUndoRecordForRevision"))}get graphSpace(){return this.Iz}get Gmc(){return this.sVh.value}oJj(a){return this.Iz===
a?!0:!1}QJc(){this.Qg.clear();this.rs=this.qh=-1;this.b5a=!0}oti(){if(this.qh===this.Qg.length-1)this.QJc();else{let a=0;for(;a<this.qh;)this.Qg.removeAt(0),a++;this.qh=0;this.rs=1}}get NW(){return 0<this.qh}get gZd(){return this.NW?this.Qg.ga(this.qh).actionId:null}get hZd(){return 0<=this.qh&&this.qh<this.Qg.length?this.Qg.ga(this.qh).M1:null}f_e(a,b){this.u3a?(this.Qsc(),this.soa()):(this.Ilf&&this.Gmc.suspend(),this.u3a=!0,this.Tnb=a,this.zjf=b,this.SGd=0)}Qsc(){this.u3a=!1;this.Ilf&&this.Gmc.resume()}UAl(){this.A_h(new ka.a(this.Tnb,
1));this.Qsc()}AYa(a,b,c=!1){if(!this.nyd()||a===D.a.fUa&&this.Qg.length)return!1;var f=this.Iz.lT();if(!f&&a!==D.a.fUa&&!c||!this.Iz||!this.Iz.zi)return!1;f&&(this.Qcf||(ia.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.Qcf=!0),this.rBd.execute(x=>{x.J0d()}));if(this.u3a){ia.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.Tnb);this.Qsc();for(c=this.Qg.length-2;0<=c;c--)this.Qg.removeAt(c);this.qh=0;this.rs=-1}c=this.IW();f=
this.$Lc(f,a);this.Gub();b=this.wvi(a,f,b);const l=this.eca.yMb()&&!this.eca.v0a();a=new mg(b,c,f,a,this.$pb,l);this.Qg.add(a);this.qh=this.Qg.length-1;return!0}$Lc(a,b){return this.B2h(a,b)}wvi(a,b,c){if(0<=this.qh){switch(a){case D.a.gCa:case D.a.oRa:case D.a.typing:this.b5a&&this.Qg.ga(this.qh).actionId===a?(a=this.Qg.ga(this.qh),c=a.rya,b.combineWithPrevious(a.M1),this.Qg.removeAt(this.qh)):u.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.r2h.create(a),b.end(32),this.A3h.Tnc(b),
this.EXh.Snc(b))}this.b5a=!0}return c}XIe(){this.F2h(this)}GMi(){this.Gof&&!this.b5a||!this.eca.yMb()||(this.b5a=!1,this.$pb=!0)}dkk(){if(this.eca.v0a())for(let a=0;a<this.Qg.length;a++)this.Qg.ga(a).zKa=!0}Gub(){if(this.qh<this.Qg.length-1){for(let a=this.Qg.length-1;a>this.qh;a--)this.Qg.removeAt(a);this.rs=-1}}aFl(){var a=ea.ObjectSpace.G8(this.Iz.zi);a=new cg(a);const b=this.IW(),c=this.Qg.ga(this.qh).rya;a=new mg(c,b,a,D.a.kud,this.Qg.ga(this.qh).vT,this.Qg.ga(this.qh).zKa);this.Qg.removeAt(this.Qg.length-
1);this.Qg.add(a)}Qhb(a,b,c,f){return a.Qhb(b,c,f)}sKe(a,b,c){this.Ozc=!0;a.Sne();this.Ozc=!1;b.MU(void 0,c)}undo(){if(!this.NW)return!1;this.rBd.execute(ya=>{ya.J0d()});var a=!0;let b=!1;var c=!1;const f=this.Ak.me(7);f.kd(this.Iz);let l=0,x=!1,H=this.IW(),U=null;const ja=this.gqf(!0);for(this.iqf.start(new Date);this.NW&&a;){const ya=this.Qg.ga(this.qh),Va=this.Qg.ga(this.qh-1);a=ya.vT&&Va.vT;ia.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,qe.a[this.Py]);
this.rs=this.qh;try{if(b=this.Qhb(ja,ya.M1,Va.M1,ya.zKa||Va.zKa))H=this.Qg.ga(this.qh).rya,U=this.Qg.ga(this.rs).rjb,this.tNd&&this.tNd(this.Qg.ga(this.qh).actionId)}catch(hb){ia.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",hb.message,hb.stack),b=!1,c=!0}l++;b?this.qh--:(ia.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,qe.a[this.Py]),this.oti(),a=!1);if(this.iqf.Gxj()){x=!0;break}}b&&this.sKe(ja,H,null,U,!0);f.dispose();this.qw();
this.u3a&&(this.UAl(),this.Gub());this.WH.updateCommandUI();this.umf.zaa();if(0<this.qh&&x&&this.Qg.ga(this.qh).vT){a=this.qh;for(c=0;0<a&&this.Qg.ga(a).vT;)c++,a--;this.Qg.ga(this.qh).vT=!1;ia.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&ia.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}qw(){this.$pb=this.b5a=!1}get vka(){return 0<this.rs}redo(){if(!this.vka)return!1;
this.rBd.execute(H=>{H.J0d()});var a=!0;let b=!1,c=!1;const f=this.Ak.me(7);f.kd(this.Iz);let l=this.IW();const x=this.gqf(!1);for(;this.vka&&a;){a=this.Qg.ga(this.rs);const H=this.Qg.ga(this.qh);ia.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Qg.ga(this.rs).vT&&this.Qg.ga(this.qh).vT,qe.a[this.Py]);try{if(b=this.Qhb(x,a.M1,H.M1,a.zKa||H.zKa))l=this.Qg.ga(this.rs).rjb}catch(U){ia.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
U.message,U.stack),b=!1,c=!0}b?(this.qh=this.rs,this.rs<this.Qg.length-1?(this.rs++,a=this.Qg.ga(this.rs).vT&&this.Qg.ga(this.qh).vT):(this.rs=-1,a=!1)):(ia.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,qe.a[this.Py]),this.soa(),a=!1)}b&&this.sKe(x,l,null,null,!1);f.dispose();this.qw();this.WH.updateCommandUI();this.umf.zaa();return b}IW(){return this.nyd()?this.q_h.gsa():null}AKk(a){return this.u3a&&Ug.a.compare(a.Bq,this.Tnb)?(ia.ULS.sendTraceTag(512362002,
365,50,"Incremental Action in progress"),this.aFl(),this.SGd=a.n,this.SGd===this.zjf&&(ia.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.Tnb),this.Qsc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.Ozc&&!this.AKk(a.zi.ax.id))if(this.u3a&&(ia.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.Tnb,this.Iz.zi.ax.id),this.Qsc()),!this.eca.yMb())this.soa();else if(this.vka||this.NW)this.GMi(),
this.dkk()}soa(a=!1){this.QJc();a?this.bKf(null):(a=new af.a(2,1,0,this.$df,50),this.Zd.Db(a))}Whh(a,b){if(b&&(1===(b.XO&1)||2===(b.XO&2))){a=this.vka;const f=this.NW;for(var c=this.Qg.length-1;0<=c;c--){const l=Object(oa.a)(cg,this.Qg.ga(c).M1);!l||l.Xrc!==b&&l.evb!==b||(this.Qg.removeAt(c),-1!==this.qh&&this.qh--,-1!==this.rs&&this.rs--)}b=this.vka;c=this.NW;!this.isActive||a===b&&f===c||(ia.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,
c),this.WH.updateCommandUI())}}bKf(){this.nyd()&&this.AYa(D.a.fUa,this.IW())}tFa(){return this.Ozc}bsh(a){this.tNd=a}}Object(m.a)(Sj,"UndoStack",null,[1479,106]);var Rk=d(795);class Fj extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(m.a)(Fj,"RevisionStateArgs",Sys.EventArgs,[]);class Si{constructor(a,b,c,f,l,x){this.rya=a;this.rjb=b;this.o6=c;this.actionId=f;this.vT=l;this.zKa=x}}Object(m.a)(Si,"PPTLocalUndoRecord",null,[]);class nk extends Sj{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,
hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh,Zi,Ei,fj,Fi){super(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,Rg,fj,4,Fi);this.x7c=!1;this.pgc=-1;this.$L=[];this.nU=we;this.Vze=$d;this.Tze=Te;this.Qb=Ze;this.la=Vf;this.Tma=gg;this.Ea=Qg;this.AWa=Wf;this.AWa.Luf(Object(F.a)(this,this.pHb,"onRevisionProcessed"));this.Efb=rg;this.pa=Sg;this.SCe=Gh;this.hFg=Zi;this.mWg=Ei;this.dHg=Rg.yMb()&&!Rg.v0a()}AYa(a,b,c=!1){let f=!1;b=this.mWg.sFl(b);var l=this.qh;this.Vze.Yhl(a)?f=this.qkk(a,
b):this.Vze.vBi(a)?(f=this.Foi(a,b,c))&&this.Dyl(a):this.soa();b=null;f?(l=this.qh-l,b=this.Q6b(this.qh),this.SRk(b,!l),this.Pab()||this.I1d()):this.mWg.kHj();l=null;this.la.designerSendActionDuration&&b&&b.M1&&b.M1.g1d!==ka.a.nil&&(l=b.M1.g1d);this.Tze.Vpj(a,f,l);return f}$Lc(a,b){const c=0<=this.qh?this.Qg.ga(this.qh):null;this.Efb.M1g(b,c,this.b5a,this.$pb);b=super.$Lc(a,b);this.Efb.m1g(c,b,a);return b}whg(a){let b=!1,c=null;a&&this.NW?c=this.Qg.ga(this.qh):!a&&this.vka&&(c=this.Qg.ga(this.rs));
c&&(b=this.GZc(c.o6));return b&&this.Pab()}Qhb(a,b,c,f){let l=!1;if(this.whg(a.vbb))(l=super.Qhb(a,b,c,f))&&this.kkk(a.lla);else{const x=a.vbb?2:3;l=a.Rch(H=>{this.nU.xHh(H,x)});this.Zjk(a.lla);this.AWa.ukd(new Fj(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.x7c&&this.AWa.ukd(new Fj(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.x7c&&(this.AWa.ukd(new Fj(3)),this.x7c=!1)}dispose(){this.AWa.Lih(Object(F.a)(this,this.pHb,"onRevisionProcessed"));super.dispose()}sKe(a,
b,c,f,l){a&&a.lla!=ka.a.nil&&(this.hFg&&(f&&this.IHh(f),b&&this.IHh(b)),0<this.$L.length&&(f=new Si(this.IW(),b,a.lla,l?K.a.FZa:K.a.EZa,!1,this.dHg),Array.add(this.$L,f)),a.Sne(),b&&0<this.$L.length?b.MU(void 0,c):(Tc.a.Ib&&(Tc.a.Ofa(Tc.a.Ib),Tc.a.Ib.PB(ni.a.BY,Tc.a.$9a(a.lla.toString()).toString())),this.hFg&&(f=Object(oa.a)(134,this.Iz.contentReplicator))&&b&&this.SCe.jVk(f,a.lla,b,c)))}pHb(a,b){b&&(!(a=b.taa)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.x7c=!0,this.la.Bhg||(b=2===a.RevisionSource?
Object(oa.a)(1442,this.Qg.ga(0<this.rs?this.rs:this.Qg.length-1).rya):Object(oa.a)(1442,this.Qg.ga(this.qh).rjb))&&b.wFl(),this.aSi(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.AWa.ukd(new Fj(1))))}aSi(a,b,c,f){a!==this.qh&&xa.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.qh);if(a<this.qh||f){do this.Qg.removeAt(this.qh--);while(this.qh>a);this.rs=0<this.rs?this.qh+1:-1;this.SCe.f4e()}if(!(0>this.rs)&&
(b!==this.Qg.length-this.rs&&xa.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Qg.length-this.rs),b<this.Qg.length-this.rs||c)){do this.Qg.removeAt(this.rs);while(this.Qg.length-this.rs>b);if(!b||this.rs>=this.Qg.length)this.rs=-1;this.SCe.f4e()}}IHh(a){(a=Object(oa.a)(1442,a))&&a.qAl()}Rsi(){if(this.la.Azb&&this.$L.length){var a=this.Q6b(this.qh);if(a){var b=a.rya;if(this.GZc(a.o6)){for(let c=this.qh-1;0<c;c--){const f=this.Q6b(c);if(!f)break;if(this.GZc(f.o6))b=
f.rya,this.Qg.removeAt(c),this.qh--;else break}this.Gub()}else this.Qg.add(a),this.qh++,this.rs=-1;a.rya=b;a.vT=!1;this.Wld();this.I1d()}else this.Gub(),this.Wld()}}u0e(){if(this.la.Azb){var a=this.Q6b(this.qh);if(a){if(0<(-1===this.pgc?0:this.Qg.length-this.pgc)){for(var b=this.Qg.length-1;b>=this.pgc;b--)this.Qg.removeAt(b);for(b=0;0<=b&&b<this.$L.length;){var c=b;let f=!0;for(;f&&b<this.$L.length;)b<this.$L.length-1?(f=this.$L[b].vT&&this.$L[b+1].vT,b++):(f=!1,b=-1);c=this.$L[c];this.Qg.add(new mg(c.rya,
this.$L[0>b?this.$L.length-1:b-1].rjb,a.M1,c.actionId,!1,c.zKa))}this.qh=this.Qg.length-1}this.rs=-1;this.Wld();this.I1d()}else this.Gub(),this.Wld()}}get Vxj(){if(this.la.Azb&&this.Pab()){const a=this.Q6b(this.qh);if(!a||0<this.$L.length&&!this.GZc(a.o6))return!1}return this.NW}I1d(){var a=this.la.hlk;if(this.qh>a){var b=0;for(a=this.qh-a-1;0<=a;a--)this.Qg.removeAt(a),b++;this.qh-=b;b=this.rs-b;this.rs=0<b?b:-1}}Foi(a,b,c){const f=0<=this.qh?this.Qg.ga(this.qh):null;this.$pb=!!f&&this.Efb.x0c(a)&&
f.actionId===a&&this.$pb;return super.AYa(a,b,c)}SRk(a,b){this.la.Azb&&a&&(this.Pab()||this.Vze.wBi(a.actionId))&&(this.$L.length||(this.pgc=this.qh),b&&Array.removeAt(this.$L,this.$L.length-1),Array.add(this.$L,new Si(a.rya,a.rjb,a.o6,a.actionId,a.vT,a.zKa)))}Q6b(a){return 0<a&&a<=this.qh?this.Qg.ga(a):null}r6d(a){a=a?this.qh:this.rs;return 0<=a&&a<this.Qg.length?this.Qg.ga(a).M1:null}dSc(a){a=a?this.qh:this.rs;return 0<=a&&a<this.Qg.length?this.Qg.ga(a).actionId:0}Wld(){Array.clear(this.$L);this.pgc=
-1}Pab(){const a=this.Ea.Ae;return a?a.name!==zb.a.sg&&a.name!==zb.a.rna&&a.name!==zb.a.MR&&a.name!==zb.a.hza&&a.name!==zb.a.ZO||!this.pa.Xz()||this.zKj()?!1:!0:!1}Mkb(a){ea.ObjectSpace.D3(this.graphSpace.zi,!1).Mkb(a)}Dyl(a){this.la.Azb||this.Cyl(a);this.Byl(a)}Cyl(a){if(1<=this.qh&&this.tng(a)){const b=this.qh-1,c=this.Qg.ga(b),f=c.actionId;f!==a&&!this.tng(f)||1!==this.Tma.Cxb(c.o6)||(this.Qg.removeAt(b),this.qh=this.Qg.length-1)}}Byl(a){if(1<=this.qh&&this.dJj(a)){const b=this.qh-1,c=this.Qg.ga(b).actionId;
if(c===a||this.ILj(c))this.Qg.removeAt(b),this.qh=this.Qg.length-1}}tng(a){return a===D.a.zB||a===D.a.gCa||a===D.a.oRa||a===D.a.typing||a===D.a.enter}ILj(a){return a===K.a.ZBa||a===K.a.shd}dJj(a){return a===K.a.Irb||a===K.a.vlc||a===K.a.WHb}qkk(a,b){const c=this.$Lc(this.Iz.lT(),a);this.Gub();a=new mg(b,null,c,a,!1,this.dHg);this.Qg.add(a);this.qh=this.Qg.length-1;return!0}kkk(a){let b=null;this.pa.Zka()?b=this.pa.e6f():this.pa.Xz()&&(b=this.pa.Jp());b&&this.AWa.Seh(new Rk.a(b,a))}Zjk(a){const b=
this.Qb.Nc(this.graphSpace);b.Bb(80);Object(oa.a)(537,b.yq).isDirty=!0;this.AWa.Seh(new Rk.a(b.currentNode,a))}u4e(a){0>this.qh||(this.Qg.ga(this.qh).rjb=a)}QZc(){return!this.$L.length}GZc(a){for(const b of this.$L)if(b.o6===a)return!0;return!1}zKj(){for(const a of this.pa.Wd())if(a.eb(kb.a.clearFormatting))return!0;return!1}}Object(m.a)(nk,"PPTUndoStack",Sj,[]);class Dk{constructor(a){this.eik=a}MHi(a){const b=this.eik.tLf(a);return new nk(a,()=>!!sa.InteractiveViewManager.instance.Pd,new mc.a(()=>
Oc.App.UR),Db.a.instance.Ja("Common.Interface.IEditNotificationManager"),eg.a.getInstance(),Tj.a.getInstance(),Db.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Db.a.instance.resolve("Box4.IAppFrame"),Db.a.instance.resolve("Box4.IReplicationScheduler"),Db.a.instance.resolve("Box4.ISelectionReferenceFactory"),Db.a.instance.resolve("Common.ITaskManager"),Db.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},P.a.instance.ga(70),Pe.a.instance,b.hFh,b.iFh,b.mFh,new Zd(Oc.App.GDf),
Db.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Db.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),Db.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),Db.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),Db.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),Db.a.instance.resolve("Common.IFocusManager"),Db.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
Db.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Db.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),Db.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Db.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,Db.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
Db.a.instance.ie("Box4.ICoauthCashTelemetry"),Object(Ud.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(m.a)(Dk,"PPTUndoStackFactory",null,[1440]);class Zj{constructor(){this.f4c=new wc.a}Qvl(a){this.f4c.raiseEvent("MU",a)}KYb(a){this.f4c.addHandler("MU",a)}WQe(a){this.f4c.removeHandler("MU",a)}dispose(){this.f4c.dispose()}}Object(m.a)(Zj,"UndoEventSource",null,[1437,1438,1439,106]);class Al{constructor(a,b){this.Mfb=0;this.X$c=null;this.nxe=!1;this.Mv=a;this.Qk=b;this.Qk.Ytf(Object(F.a)(this,
this.L1g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Qk.Xtf(Object(F.a)(this,this.Ved,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Qk.dih(Object(F.a)(this,this.L1g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Qk.dYk(Object(F.a)(this,this.Ved,"onForceOutboundGraphTransactionDisposed"))}sFl(a){return 1===this.Mfb&&this.X$c?this.X$c:a}kHj(){1===this.Mfb&&(this.nxe=!0)}L1g(a,b){this.vng(b.transaction.wza)&&(this.Mfb+=1,1===this.Mfb&&(this.X$c=this.Mv.IW()))}Ved(a,
b){this.vng(b.transaction.wza)&&(1===this.Mfb&&(this.X$c=null,this.nxe||(a=this.Mv.IW(),this.Mv.u4e(a)),this.nxe=!1),--this.Mfb)}vng(a){return 8===(a&8)}}Object(m.a)(Al,"UndoSelectionUpdater",null,[1273,106]);var ak=d(594);class io{constructor(a,b,c){this.Iz=a;this.wEd=b;this.PMd=c;this.rZ=ea.ObjectSpace.G8(this.Iz.zi)}Qhb(a,b,c){a=this.PMd.lGi(this.wEd?a.Xrc:b.evb,this.wEd?b.evb:a.Xrc,this.rZ,c,Oc.App.SLa);if(b=!!a)this.rZ=a;return b}Rch(a){const b=new w.a;b.o_e(this.Iz.zi,this.rZ);a(b);a=b.YPc();
ea.ObjectSpace.D3(this.Iz.zi,!1).Mkb(a);this.rZ=a;return!!a}Sne(){const a=new ak.a(ea.ObjectSpace.G8(this.Iz.zi),this.rZ);this.Iz.WAb(a)}get vbb(){return this.wEd}get lla(){return this.rZ.id}}Object(m.a)(io,"Box4UndoRedoPerformer",null,[1477]);class Xp{constructor(a,b){this.hFh=c=>{c&&this.Iz.Xfa();c=ea.ObjectSpace.G8(this.Iz.zi);return new cg(c)};this.iFh=c=>new io(this.Iz,c,this.PMd);this.mFh=c=>{if(c.hZd&&(this.Iz.lT()&&this.Iz.Xfa(),c.hZd&&(c=c.hZd))){var f=ea.ObjectSpace.G8(this.Iz.zi);c.evb=
f}};this.Iz=a;this.PMd=b}}Object(m.a)(Xp,"Box4UndoStackDataSyncHelper",null,[1471]);class jo{constructor(a){this.C2h=a}tLf(a){return new Xp(a,this.C2h(a.zi))}}Object(m.a)(jo,"Box4UndoStackDataSyncHelperFactory",null,[1436]);class Ii{constructor(a,b,c){this.Zeb=[];this.JFb=a;this.A$c=b;this.Ifc=c}get o6(){return this.A$c}get g1d(){return this.A$c}get UJ(){return this.Zeb}perform(){try{if(this.JFb){const a=this.JFb.perform();this.JFb=a.undoOperation;this.Zeb=h(a.kVc,this.Ifc);return a}}catch(a){ia.ULS.sendTraceTag(0,
844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.JFb&&this.JFb.combineWithPrevious(a.JFb)}dispose(){}}Object(m.a)(Ii,"FluidUndoRecordData",null,[1478,106]);class ht{constructor(a,b){this.Mdc=[];this.gdb=a;this.wak=b}Qhb(a){return a?(a=a.perform(),this.dch(a)):!1}Rch(a){const b=this.gdb.zi.nOi.vLc();b.start(this.gdb.zi);a(b);a=b.finish();return this.dch(a)}Sne(){this.Mdc.forEach(a=>{this.gdb.WAb(a)})}get vbb(){return this.wak}get lla(){return 0<this.Mdc.length?
this.Mdc[this.Mdc.length-1].kla:ka.a.nil}dch(a){return a?(a.kVc&&this.Mdc.push(...a.kVc),!0):!1}}Object(m.a)(ht,"FluidUndoRedoPerformer",null,[1477]);class hs{constructor(a){this.hFh=b=>{var c,f;let l=null;b&&(l=this.gdb.Xfa());return new Ii(null!==(c=null===l||void 0===l?void 0:l.undoOperation)&&void 0!==c?c:null,null!==(f=null===l||void 0===l?void 0:l.revisionId)&&void 0!==f?f:ka.a.nil,this.gdb.zi)};this.iFh=b=>new ht(this.gdb,b);this.mFh=()=>{};this.gdb=a}}Object(m.a)(hs,"FluidUndoStackDataSyncHelper",
null,[1471]);class pr{tLf(a){return new hs(a)}}Object(m.a)(pr,"FluidUndoStackDataSyncHelperFactory",null,[1436]);class Ap{constructor(a){this.nU=a}$Dl(a){this.nU.xHh(a,1);this.nU.iFl(a)}}Object(m.a)(Ap,"PPTInverseRevisionUpdater",null,[1325]);class Pi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Zb(a){this.K=a;a.register(Tm,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(Mo,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().oa(()=>
new Mo(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(428,"Box4.ISelectionReferenceFactory").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new gd(em.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.FC,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),b.Jn):em.SelectionReferenceFactory.instance});a.register(Za,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();
a.register(Sc,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").VCa?a.register(pr,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(jo,"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().oa(()=>new jo(b=>new T(ea.ObjectSpace.D3(b,a.resolve("PowerPointWebEditor.IApplicationSettings").VCa),
a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new Ra,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Ap(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(Dk,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().oa(()=>new Dk(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(Qk,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().oa(()=>
new Qk(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(wa,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().oa(()=>new wa(a.resolve("Box4.UndoRedo.IUndoStackFactory"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1270,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().oa(()=>new md);a.register(Zj,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.ryi(a);this.vyi(a);a.register(1271,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().oa(()=>
new ro(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}ryi(a){a.register(1272,"PowerPointWebEditor.ITablePartialEditController").ma().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.EVj?new ep(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.Azb):new Uk})}vyi(a){a.register(1273,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().oa(()=>new Al(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");
var b=this.K.resolve("Box4.IPageView");b.xg&&(b=b.xg.No(),a.register(b),a.setActive(b),a.AYa(D.a.fUa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){z.a.instance.Dc(new Pi)}}Object(m.a)(Pi,"PPTWebEditorUndoRedoPackage",null,[2,3]);class Ul{constructor(a=!1,b,c=!1,f=!1,l=!1,x=!1,H=!1){this.MUa=a;this.uke=c;this.G$a=f;this.A9b=l;this.F9b=x;this.jZc=H}}Object(m.a)(Ul,
"DocModeSwitcherData",null,[]);var on=d(848);class is{constructor(a,b,c,f,l){this.PCb=!1;this.lAe=null;this.lDd=this.zEd=this.LDd=this.VDd=this.ODd=this.iEd=this.EDd=this.lEd=this.BAa=this.uDd=this.BDd=this.SDd=this.rDd=this.KDd=this.Oef=!1;this.mc=a;this.gl=b;this.Oc=c;this.Kv=l;this.NBg=f.$Nj;this.uva=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.Hdb=f.zlg;this.Mek=u.AFrameworkApplication.Yz;this.reset()}initialize(){this.Oc.O7(Object(F.a)(this,this.Dw,"onUnifiedAppStateChanged"));this.Oc.EPa(Object(F.a)(this,
this.mkc,"onOutboundReplication"));this.lAe=[Object(F.a)(this,this.Fri,"checkIsInlineRepairedDocument"),Object(F.a)(this,this.Cri,"checkIrmProtection"),Object(F.a)(this,this.isi,"checkUserPermission"),Object(F.a)(this,this.bri,"checkFileFormats"),Object(F.a)(this,this.cri,"checkFileLock"),Object(F.a)(this,this.Ori,"checkPasswordProtection"),Object(F.a)(this,this.eri,"checkFontRestriction"),Object(F.a)(this,this.Gri,"checkIsMarkedFinal"),Object(F.a)(this,this.Hri,"checkIsMarkedReadOnlyRecommended"),
Object(F.a)(this,this.Tri,"checkSessionRestriction"),Object(F.a)(this,this.Sri,"checkSessionAccessTokenExpired"),Object(F.a)(this,this.Lri,"checkNetworkIssueHappened"),Object(F.a)(this,this.Pri,"checkPopsHostIssueHappened"),Object(F.a)(this,this.psi,"checkWopiAccessTokenOutOfRefreshRange"),Object(F.a)(this,this.Eri,"checkIsEmergencyViewMode")];this.tmh(this.lAe)}dispose(){this.Oc.Hib(Object(F.a)(this,this.Dw,"onUnifiedAppStateChanged"))}reset(){this.lDd=this.BDd=this.zEd=this.LDd=this.VDd=this.ODd=
this.iEd=this.EDd=this.lEd=this.uDd=this.SDd=this.BAa=this.rDd=this.KDd=this.Oef=!1}Dw(a,b){xa.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.Bab&&this.mc.Gn||(this.gl.YOf(),this.tmh(this.lAe))}mkc(){this.uva&&!this.PCb&&(this.PCb=!0);this.mc.zL||xa.a.J(38633602,801,15,"Outbound on RO mode")}tmh(a){if(a)for(const b of a)if(b())break}bri(){if(this.QMj||!this.mc.fg(64)||this.NBg&&!(this.mc.fg(4)&&this.mc.fg(16)&&this.mc.fg(8)))return!0;if(!this.mc.getState(64))return!1;
if(this.NBg&&this.mc.getState(4)&&!this.mc.getState(16)&&!this.mc.getState(8)){var a=u.AFrameworkApplication.Ta.La(K.a.hDa,2,Object.assign(new Ul,{jZc:!0,G$a:this.mc.getState(1)}));xa.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.gl.bL(10);xa.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=u.AFrameworkApplication.Ta.La(K.a.hDa,2,Object.assign(new Ul,{F9b:!0,G$a:this.mc.getState(1)})),
xa.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.rDd=!0}Cri(){return this.$Oj||!this.mc.fg(32768)?!0:this.mc.getState(32768)?(this.gl.bL(14),this.EDd=!0,xa.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}cri(){return this.SMj?!0:this.mc.fg(128)&&this.mc.getState(128)?(this.gl.bL(3),this.BAa=!0,xa.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.mc.fg(256)&&this.mc.getState(256)?(this.gl.bL(4),this.BAa=!0,xa.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.mc.fg(512)&&this.mc.getState(512)?(this.gl.bL(5),this.BAa=!0,xa.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.mc.fg(1024)&&this.mc.getState(1024)?(this.gl.bL(6),this.BAa=!0,xa.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.mc.fg(2048)&&this.mc.getState(2048)?(this.gl.bL(7),this.BAa=!0,xa.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.mc.fg(4096)&&this.mc.getState(4096)?(this.gl.bL(8),this.BAa=!0,xa.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.mc.fg(8192)&&this.mc.getState(8192)?(this.gl.bL(9),this.BAa=!0,xa.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}Gri(){if(this.JPj||!this.mc.fg(2)||!this.mc.fg(16))return!0;if(!this.mc.getState(2)&&this.mc.getState(16)){const a=u.AFrameworkApplication.Ta.La(K.a.hDa,2,Object.assign(new Ul,{MUa:!0,G$a:this.mc.getState(1)}));xa.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.KDd=!0}return!1}Hri(){if(!this.Hdb)return!1;if(this.KPj||!this.mc.fg(2)||!this.mc.fg(524288))return!0;if(!this.mc.getState(2)&&this.mc.getState(524288)){const a=u.AFrameworkApplication.Ta.La(K.a.hDa,
2,Object.assign(new Ul,{uke:!0,G$a:this.mc.getState(1)}));xa.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.LDd=!0}return!1}Ori(){if(this.vRj||!this.mc.fg(2)||!this.mc.fg(32))return!0;if(!this.mc.getState(2)&&this.mc.getState(32)){const a=u.AFrameworkApplication.Ta.La(K.a.hDa,2,Object.assign(new Ul,{A9b:!0,G$a:this.mc.getState(1)}));xa.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.SDd=!0}return!1}Fri(){return this.FOj||!this.mc.fg(2097152)?!0:this.mc.getState(2097152)?(this.gl.bL(22),this.BDd=!0,xa.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}Eri(){var a=!1;if(this.sMj||!this.mc.fg(4194304))return!0;this.mc.getState(4194304)&&(a="NotAvailable",this.Kv&&(a=this.Kv.Dwb(),a=on.a[a]),kf.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===u.AFrameworkApplication.Ta.processAction(K.a.qsc,
1)?(a=u.AFrameworkApplication.Ta.processAction(K.a.qsc,2),xa.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.gl.bL(23),xa.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.lDd=a=!0);return a}eri(){return!this.oNj&&this.mc.fg(2)&&this.mc.fg(8)?!this.mc.getState(2)&&this.mc.getState(8)?(this.gl.bL(12),this.uDd=!0,xa.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}isi(){if(this.cMj||!this.mc.fg(1))return!0;if(!this.mc.getState(1)){const a=u.AFrameworkApplication.Ta.La(K.a.hDa,2,new Ul);xa.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}Tri(){return this.eUj?!0:this.mc.fg(16384)&&this.mc.getState(16384)?(this.gl.bL(13),this.lEd=!0,xa.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}Sri(){return this.cUj?!0:this.mc.fg(65536)&&this.mc.getState(65536)?
(kf.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.uva?this.gl.yNc(15,this.PCb):this.gl.bL(15),this.iEd=!0,xa.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}Pri(){return this.XRj?!0:this.mc.fg(262144)&&this.mc.getState(262144)&&this.uva?(this.gl.yNc(17,this.PCb),this.VDd=!0,xa.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}psi(){return this.wXj?
!0:this.mc.fg(1048576)&&this.mc.getState(1048576)&&this.uva&&this.Mek?(this.gl.yNc(21,this.PCb),this.zEd=!0,xa.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}Lri(){return this.fQj?!0:this.mc.fg(131072)&&this.mc.getState(131072)&&this.uva?(this.gl.yNc(16,this.PCb),this.ODd=!0,xa.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get cMj(){return this.Oef}get JPj(){return this.KDd}get QMj(){return this.rDd}get vRj(){return this.SDd}get FOj(){return this.BDd}get oNj(){return this.uDd}get SMj(){return this.BAa}get eUj(){return this.lEd}get $Oj(){return this.EDd}get cUj(){return this.iEd}get fQj(){return this.ODd}get XRj(){return this.VDd}get KPj(){return this.LDd}get wXj(){return this.zEd}get sMj(){return this.lDd}}
Object(m.a)(is,"ReadOnlyUIManager",null,[1274,106]);class it{constructor(a,b,c,f){this.OBg=!1;this.Dw=()=>{xa.a.J(509367064,809,50,"FilterPrivacyUIManager::OnUnifiedAppStateChanged");this.gPf()};this.UMj=()=>!this.Pb.ka("FilterPrivacyBusinessBarEnabled")||this.OBg?!1:this.mc.fg(16777216)?this.mc.getState(16777216):(xa.a.J(509367063,809,50,"FilterPrivacyUIManager::IsFilterPrivacyEnabled - business bar not displayed, filterPrivacyEnabled field not ready"),!1);this.gPf=()=>{this.UMj()&&(this.gl.bL(27),
this.OBg=!0,xa.a.J(509366796,809,15,"FilterPrivacyUIManager::DisplayFilterPrivacyBusinessBar - business bar displayed"))};if(!f)throw Error.argumentNull("appSettingsManager");this.mc=a;this.gl=b;this.Oc=c;this.Pb=f}initialize(){this.Oc.O7(this.Dw);this.gPf()}dispose(){this.Oc.Hib(this.Dw)}}Object(m.a)(it,"FilterPrivacyUIManager",null,[1275,106]);class js{constructor(){this.Sue=this.Igc=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Zb(a){this.K=a;this.K.register(1274,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().oa(()=>
new is(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")));this.K.register(1275,"PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager").ma().oa(()=>new it(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").mFa&&(this.Igc=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.Sue=this.K.resolve("PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager"),this.Igc.initialize(),this.Sue.initialize())}dispose(){this.Igc&&this.Igc.dispose();this.Igc&&this.Sue.dispose()}static main(){z.a.instance.Dc(new js)}}Object(m.a)(js,
"PPTWebEditorUnifiedAppPackage",null,[2,3]);var ii=d(275);class Yp{constructor(a,b,c,f){this.Fb=a;this.lr=b;this.zE=c;this.wva=f}aka(){const a=new Rd.a;a.$(0,Object(F.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(F.a)(this,this.pptTableColumnHandleClickHandler,"pptTableColumnHandleClickHandler"));a.$(2,Object(F.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(F.a)(this,this.backgroundClickHandler,
"backgroundClickHandler"));a.$(4,Object(F.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.lr.g4(a.Ec)||this.lr.fVa(a.Ec)||this.lr.l0c(a.Ec)?(this.Fb.ivb(),ii.a.Vl(!0)):ii.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.lr.Hua(a.Ec)){const b=this.lr.L$d(a.Ec);if(!b||!b.Dk)return xa.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),ii.a.Vl(!1);b.Dk.$p||this.lr.mKc(a.Ec,a.eV,a.Xi.Xf);
return ii.a.Vl(!0)}return ii.a.notHandled}pptTableRowHandleClickHandler(a){if(this.lr.fac(a.Ec)){const b=this.lr.L$d(a.Ec);if(!b||!b.Dk)return xa.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),ii.a.Vl(!1);b.Dk.$p||this.lr.Q3k(a.Ec,a.eV,a.Xi.Xf);return ii.a.Vl(!0)}return ii.a.notHandled}backgroundClickHandler(a){return this.Fb.V$b(a)?(this.wva.setVisibility(!1),ii.a.Vl(!0)):ii.a.notHandled}shapeClickHandler(a){let b=ii.a.notHandled;this.zE.O$b||(b=this.zE.UWe(a));
this.zE.O$b=!1;if((a=this.zE.rwb(a))&&!a.cO||a&&a.shapeNode&&a.shapeNode.ud&&a.cO)return ii.a.Vl(!0);this.wva.setVisibility(!1);return b}}Object(m.a)(Yp,"ClickHandlers",null,[]);var to=d(425),uo=d(430);class hp{constructor(a,b,c,f,l,x){this.Fb=a;this.pa=b;this.Ea=c;this.ia=f;this.zE=l;this.qEb=x}aka(){const a=new Rd.a;a.$(0,Object(F.a)(this,this.noContextMenuHandler,"noContextMenuHandler"));a.$(1,Object(F.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(F.a)(this,
this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Fb.suh(a)?to.a.notHandled:to.a.Vl(null)}slideBackgroundContextMenuHandler(a){return this.Fb.V$b(a)?(this.pa.ay(),this.pa.Qh(),this.Ea.Ed(),this.ia.La(K.a.RWd,2,a.Xi),to.a.Vl(null)):to.a.notHandled}shapeContextMenuHandler(a){var b=this.zE.rwb(a);if(this.fjl(b,a))b.wDa(),this.qEb?b.hy||this.ia.La(K.a.dQa,2,new uo.a(b.shapeNode,!0,a.Xi)):this.ia.La(K.a.dQa,2,new uo.a(b.shapeNode,!0,a.Xi));else if(this.cjl(b))return this.pa.ay(),
(b=this.zE.jjj(b,a))&&this.pa.selectShape(b,!0),this.Ea.Ed(),this.ia.La(K.a.QWd,2,a.Xi),to.a.Vl(null);return to.a.notHandled}fjl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.hng&&!a.azb(b.Xi)}cjl(a){return!!a||this.pa.gH()||!this.pa.Na.length}}Object(m.a)(hp,"ContextMenuClickHandlers",null,[]);class qr{constructor(a,b,c,f,l){this.Fb=a;this.lr=b;this.zE=c;this.ia=f;this.Bec=l}aka(){const a=new Rd.a;a.$(0,Object(F.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));
a.$(1,Object(F.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(F.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.lr.g4(a.Ec)||this.lr.fVa(a.Ec)||this.lr.l0c(a.Ec)?(this.Fb.ivb(),ii.a.Vl(!0)):this.lr.Hua(a.Ec)||this.lr.fac(a.Ec)?(this.Fb.ivb(),ii.a.Vl(!1)):ii.a.notHandled}shapeDoubleClickHandler(a){return this.zE.rwb(a)?(this.Fb.ivb(),ii.a.Vl(!1)):ii.a.notHandled}backgroundDoubleClickHandler(a){return this.Fb.V$b(a)?
(this.Fb.ivb(),this.Bec||this.ia.processAction(K.a.XEa,2,{DoubleClickInsert:"true"}),ii.a.Vl(!0)):ii.a.notHandled}}Object(m.a)(qr,"DoubleClickHandlers",null,[]);class rr{constructor(a,b,c,f,l){this.zE=a;this.ZC=b;this.ia=c;this.Fa=f;this.pO=l}T3f(){return Object(F.a)(this,this.ddd,"mouseUpHandlerFilter")}ddd(a){return a?(a=this.ZC.C9d(a.Ec))&&a.gb&&this.Fa.$m(a.gb)&&this.pO.jVa&&this.zE.GXe?(this.ia.processAction(D.a.Rja,2),!0):this.zE.GXe=!1:!1}}Object(m.a)(rr,"MouseInputHandlers",null,[]);var Jk=
d(277);class sr{constructor(a,b,c,f){this.zE=a;this.Rb=b;this.u0=c;this.Ge=f}aka(){const a=new Rd.a;a.$(0,Object(F.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(F.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,Object(F.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.Yzl();return this.zE.czf(a)}Yzl(){this.Ge.kie()||Tc.a.c2d("ScrollActiveThumbnailIntoView",K.a.ljb,()=>
{this.Ge.gnd();return 32})}shapePointerDownHandler(a){this.Rb.aX&&this.u0.show(3,-1);const b=this.zE.rwb(a);if(b&&b.shapeNode&&b.shapeNode.Rf&&!b.shapeNode.Ng)return ii.a.Vl(!1);if((Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.Fya)||Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.uMb)||Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.$We)||Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.gsd)||Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.rAh)||Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.FAh))&&b.isSelected&&
!b.cO||void 0!==b&&null!==b&&b.shapeNode.Mp)return this.zE.O$b=!1,ii.a.Vl(!0);this.zE.O$b=!0;a=this.zE.UWe(a);a.O3&&(this.zE.GXe=!0);return a}defaultPointerDownHandler(){return ii.a.Vl(!0)}}Object(m.a)(sr,"PointerDownHandlers",null,[]);class Gq{constructor(a){this.zE=a}aka(){const a=new Rd.a;a.$(0,Object(F.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(F.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(F.a)(this,this.shapePointerUpHandler,
"shapePointerUpHandler"));a.$(2,Object(F.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.zE.czf(a)}shapePointerUpHandler(a){const b=this.zE.rwb(a);return b&&b.shapeNode&&b.shapeNode.Rf&&!b.shapeNode.Ng?ii.a.Vl(!1):this.zE.UWe(a)}defaultPointerUpHandler(){return ii.a.Vl(!0)}}Object(m.a)(Gq,"PointerUpHandlers",null,[]);class Bp extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Bp,"SlideBackgroundClickedEventArgs",Sys.EventArgs,
[]);class Cp{constructor(a,b,c,f,l,x,H,U){this.Fb=a;this.lr=b;this.pa=c;this.wva=f;this.Ea=l;this.CJ=x;this.Mma=H;this.Fa=U;this.GXe=this.O$b=!1}czf(a){return this.Fb.V$b(a)?(this.pa.ay(),a=a.Xi,this.CJ.Heh(new Bp(!1)),(a.ctrlKey||a.shiftKey)&&a.sA===Sys.UI.MouseButton.leftButton?this.pa.ij():this.pa.Qh(),this.wva.setVisibility(!1),this.Ea.Ed(),ii.a.Vl(!0)):ii.a.notHandled}UWe(a){const b=this.rwb(a);b&&this.pa.ay();const c=Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.Fya)||Sys.UI.DomElement.containsCssClass(a.Ec,
Jk.a.uMb)||Sys.UI.DomElement.containsCssClass(a.Ec,Jk.a.$We),f=this.lr.l0c(a.Ec)||this.lr.g4(a.Ec)||this.lr.fVa(a.Ec);Tc.a.zk("isEventFromHandlers",c.toString());Tc.a.zk("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.cO?(this.pa.ij(),this.wva.setVisibility(!1),this.Ea.Ed(),ii.a.Vl(!0)):f&&b&&!b.cO?(b.H1g(a.Xi),ii.a.Vl(!0)):!b||b.cO&&!this.rie(a)?ii.a.notHandled:(b.Axk(a.Xi),ii.a.Vl(!0))}rwb(a){let b=this.lr.HI(a.Ec);if(!b){var c=a.Ec,f=Hb.a(c,Ba.a.role);f=f?f.toString()===Cc.a.uZb:!1;
if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.lr.HI(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(oa.a)(117,b);if(!c&&(this.lr.l0c(a.Ec)||this.lr.g4(a.Ec)||this.lr.fVa(a.Ec))&&(c=this.Mma.n5b(this.Fa.$m(b.gb)),!c))return xa.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.Mma.n5b(this.Fa.$m(b.gb)))&&
c.dB&&!(c.hy||c.$p||c.qme))return c}return null}rie(a){return a&&a.Ec?a.Ec.id.startsWith(Mf.a.yrb):!1}jjj(a,b){return a?this.ijj(a):this.hjj(b.graphNode)}ijj(a){let b=null;a.isSelected&&this.pa.gH()||(b=Object(oa.a)(4,a.gb));return b}hjj(a){let b=null;if(a){const c=tb.GraphIterator.nb(a);c.rc(10)?(a=Object(oa.a)(4,c.Jg(10)),this.pa.fX(a)||(b=a)):xa.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(m.a)(Cp,"ViewEventHandlerHelper",null,
[1327]);class Zp{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Zb(a){this.K=a;a.register(Yp,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().oa(()=>new Yp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(qr,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().oa(()=>
new qr(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").Gyb));a.register(hp,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().oa(()=>new hp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(sr,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().oa(()=>new sr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));
a.register(Gq,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().oa(()=>new Gq(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(rr,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().oa(()=>new rr(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(Cp,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().oa(()=>new Cp(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.C4h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").aka());a.p5h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").aka());a.d5h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").aka());
a.N6h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").aka());a.Q6h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").aka());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").pb(ta.a.EJ,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").T3f())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").yb(ta.a.EJ,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").T3f())}static main(){z.a.instance.Dc(new Zp)}}Object(m.a)(Zp,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var bg=d(80),tr;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(tr||(tr={}));Object(m.b)("WebSocketCompressionHelperLoadState",tr);var Oj=d(89),ks=d(347),
pn;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(pn||(pn={}));Object(m.b)("WebSocketState",pn);class Hq{constructor(a,b,c,f,l){this.Zfc=this.Nl=this.NFb=null;this.OHa=-1;this.Vdb=this.Ila=0;this.kcc=-1;this.sDb=0;this.tDb=null;this.cWa=0;if(!a)throw Error.argumentNull("webSocketClient");this.Nv=a;this.Xa=b;this.xE=c;this.Oc=f;a=document.createElement("a");a.href=this.Nv.MJl;a.protocol="http:"===a.protocol?"ws":"wss";Ud.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new Ee.QueryStringBuilder(a.href),Ud.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.yi(ee.a.b9g,b.pk),Ud.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.yi(ee.a.dCk,u.AFrameworkApplication.userSessionId),a.yi(ee.a.rlc,l.toString()),this.NFb=a.toString()):this.NFb=a.href;this.Zdb=bg.a.YD(this.NFb);this.H0b(2);this.Hma=this.Nv.wlh;this.wqe=this.Nv.Aui;this.SWe();this.Oc.JPa(Object(F.a)(this,this.Vgb,"onSessionEnding"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"))}dispose(){this.Oc.kRe(Object(F.a)(this,
this.Vgb,"onSessionEnding"));this.Oc.Sfa(Object(F.a)(this,this.Do,"onSessionRehydrated"))}H0b(a){this.Nl&&this.Nl.close();this.Nl=new WebSocket(this.NFb,[]);this.Nl.onopen=Object(F.a)(this,this.onOpen,"onOpen");this.Nl.onerror=Object(F.a)(this,this.onError,"onError");this.Nl.onclose=Object(F.a)(this,this.onClose,"onClose");this.Nl.onmessage=Object(F.a)(this,this.onMessage,"onMessage");this.cWa=a;xa.a.J(556541794,this.Nv.QQ,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.Zdb,this.Xa.pk,this.cWa)}ping(){if(this.Nl)if(1===this.Nl.readyState){const a=this.Nv.FFi();this.Nl.send(a)}else xa.a.J(559284698,this.Nv.QQ,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Nl.readyState),this.gya(4);else xa.a.J(559284697,this.Nv.QQ,50,"WebSocketFetcher::Ping Websocket is unavailable.")}Hui(){this.Nl.close()}onOpen(){xa.a.J(591208995,this.Nv.QQ,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.Zdb,this.Xa.pk);this.Ooc();this.sDb=0;this.tDb=null;
this.Nv.Yrk()}onError(a){xa.a.J(591208993,this.Nv.QQ,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.Zdb,this.Xa.pk)}onClose(a){xa.a.J(591208991,this.Nv.QQ,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.Zdb,this.Xa.pk,JSON.stringify(a),a.code,a.reason);this.sDb=a.code;this.tDb=a.reason}onMessage(a){try{a&&a.data&&this.Nv.Zuk(a)}catch(b){xa.a.J(559284699,this.Nv.QQ,10,"WebSocketFetcher::OnMessage",
b.toString())}}SWe(){this.Zfc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.kcc),this.Nl||(xa.a.J(559284700,this.Nv.QQ,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.gya(1))):this.kcc=window.setTimeout(()=>{this.Nl&&(xa.a.J(559284701,this.Nv.QQ,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.sDb=1E3,this.tDb="Lost visibility",this.Nl.close(this.sDb,this.tDb),this.Nl=null,window.clearTimeout(this.OHa))},
this.wqe)};window.self.addEventListener("visibilitychange",this.Zfc)}Ooc(){this.Ila=0}kQd(){0<this.Nv.Qcd&&(new Date).getTime()-this.Vdb>this.Nv.Qcd&&(this.Ooc(),xa.a.J(559284702,this.Nv.QQ,50,"WebSocketFetcher::Retry connect to server after long pause."))}dUd(){const a=!!this.xE&&!!this.xE.instance&&!this.xE.instance.e4,b=(new Date).getTime()-this.Vdb>this.Hma,c=this.Ila<this.Nv.fYg,f=!this.Nl||3===this.Nl.readyState||2===this.Nl.readyState,l=a&&b&&c&&f;xa.a.J(557181E3,this.Nv.QQ,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}aWe(){this.Vdb=(new Date).getTime();this.Hma=Math.pow(2,this.Ila)*this.Nv.wlh;0<this.Nv.Qcd&&(this.Hma=Math.min(this.Hma,this.Nv.Qcd));window.setTimeout(()=>{this.gya(3)},this.Hma)}gya(a){this.kQd();this.dUd()&&(this.H0b(a),this.aWe(),this.Ila++,a!==this.cWa&&xa.a.J(541671620,this.Nv.QQ,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.cWa),xa.a.J(559284703,this.Nv.QQ,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.cWa),this.Ila===this.Nv.fYg&&xa.a.J(559284704,this.Nv.QQ,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.cWa))}sendMessage(a,b){if(!this.Nl)return xa.a.J(559284705,this.Nv.QQ,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.sDb,this.tDb),1;xa.a.J(559284706,this.Nv.QQ,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",pn[this.Nl.readyState],
b,this.sDb,this.tDb);if(1===this.Nl.readyState)return this.Nl.send(a),0;this.gya(5);return 2}Xel(){this.Nl.binaryType="arraybuffer"}kHb(){-1!==this.OHa&&window.clearTimeout(this.OHa);this.OHa=window.setTimeout(()=>{this.ping()},this.Nv.MEk)}cti(){this.cWa=0}Vgb(){this.Nl&&(xa.a.J(557352418,this.Nv.QQ,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Nl.close(),this.Nl=null)}Do(){this.Nl||(xa.a.J(557352419,this.Nv.QQ,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.gya(6))}}Object(m.a)(Hq,"WebSocketFetcher",null,[1350,106]);var $p;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})($p||($p={}));
Object(m.b)("ConnectionReason",$p);var Iq;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Iq||(Iq={}));Object(m.b)("SendMessageStatusCode",Iq);class aq extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.E2k=b;this.TKj=c}}Object(m.a)(aq,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Ke=d(652);class Fn{constructor(a,b,c,f,l){this.Om=window.performance.now();this.JAe=new wc.a;this.ote=this.pdc=!0;this.YBb=
null;this.UFb=1;this.Xa=b;this.p8c=a.KJl;this.Kze=a.LJl;this.Fbk=a.IJl;this.kfk=a.JJl;this.q6j=a.GJl;this.AEb=a.Gvd;this.Lbd=a.$Gl;this.mDe=a.HJl;this.Zdb=bg.a.YD(this.mDe);this.Rwa=new Hq(this,b,c,f,new ks.a(a.Hfa));this.lxg=a.CKc;if(l)this.YBb=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Rwa.dispose()}ping(){this.Rwa.ping()}Lx(a){const b=new Map,c=this.koj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),kf.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.AEb?(a=this.Rwa.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",Iq[a]),kf.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new Oj.a,{extendedProperties:b})))):kf.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new Oj.a,{extendedProperties:b}))}vai(a){this.JAe.addHandler("ResponseReceivedEventId",a)}yZk(a){this.JAe.removeHandler("ResponseReceivedEventId",
a)}Yrk(){if(this.AEb){var a=Tc.a.Ib?Tc.a.Ib.actionId:Ug.a.create().toString(),b=u.AFrameworkApplication.userSessionId,c=this.Xa.pk;this.ote=!0;b=Ke.p(a,b,this.Xa.podSessionId,c);b=this.Rwa.sendMessage(JSON.stringify(b),"validateSession");xa.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Iq[b],this.Zdb,c)}}Zuk(a){if(this.AEb)try{const b=this.GUi(a);if(b.pong)this.kHb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.fzk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.Urk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.JAe.raiseEvent("ResponseReceivedEventId",new aq(b,this.$gj(a,c),c))}}catch(b){xa.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.kHb(a.data)}GUi(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.UFb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);xa.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}$gj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}fzk(a){if(a.isValid){if(this.lxg){a=Tc.a.Ib?Tc.a.Ib.actionId:Ug.a.create().toString();const b=u.AFrameworkApplication.userSessionId,c=this.Xa.podSessionId,
f=this.Xa.pk;xa.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",tr[this.UFb]);1===this.UFb?this.H0j(a,b,c,f):2===this.UFb&&this.Foh(a,b,c,f)}this.ping()}else xa.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.Zdb,this.Xa.pk),this.Rwa.Hui()}H0j(a,b,c,f){this.lxg&&this.YBb.loadScript("WebSocketCompressionHelper").then(()=>{this.UFb=
2;this.Foh(a,b,c,f)}).catch(()=>{xa.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.UFb=3})}Foh(a,b,c,f){a=Ke.a(a,b,c,!0,f);a=this.Rwa.sendMessage(JSON.stringify(a),"compressionHandshake");xa.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}Urk(a){a=a.clientReadyForCompression;xa.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.Rwa.Xel()}koj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}kHb(a){this.Rwa.kHb(a);ha.a.Wa(a)?xa.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?xa.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.AEb):(a={["PingTime"]:window.performance.now()-this.Om-a,MeasurementType:"Performance.Now"},a.First=this.pdc?1:0,a.WebSocketFrontDoorProtobufEnabled=this.AEb,a.PostConnectionPing=this.ote,a.ConnectionReason=$p[this.Rwa.cWa],this.Rwa.cti(),this.ote=this.pdc=!1,xa.a.J(591208985,839,50,pa.a.toJSON(a))))}FFi(){var a=(window.performance.now()-this.Om).toString();if(!this.AEb)return a;a=Ke.q(Ke.l(a),null,null,null,this.Xa.pk);return JSON.stringify(a)}get MJl(){return this.Lbd&&!ha.a.Wa(this.mDe)?this.mDe:
u.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get QQ(){return 839}get MEk(){return this.Kze}get fYg(){return this.p8c}get wlh(){return this.kfk}get Qcd(){return this.Fbk}get Aui(){return this.q6j}}Object(m.a)(Fn,"PodsWebSocketFrontDoor",null,[1268,106,1324]);class ur{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Zb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1268,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().oa(()=>{try{return new Fn(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ja("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").Sw)}catch(b){return xa.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){z.a.instance.Dc(new ur)}}
Object(m.a)(ur,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var vr=d(1147),Jq=d(1156);class wr{constructor(a=null){this.lo=null;this.reset();this.sWb=a}SYb(a,b){if(!this.sWb||this.sWb.uXe())b in this.lo||(this.lo[b]=[]),this.lo[b].push(a)}getData(){return pa.a.count(this.lo)?this.lo:null}reset(){this.lo={}}}Object(m.a)(wr,"NamedValuesAggregator",null,[1524]);class Kq{constructor(){this.lo=new Ka.a}get CRk(){return this.lo.count}SYb(a){this.lo.add(a)}getData(){return this.CRk?Pa.toArray(this.lo):
null}reset(){this.lo=new Ka.a}}Object(m.a)(Kq,"BatchDataAggregator",null,[1524]);var Dp;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Dp||(Dp={}));Object(m.b)("ApiType",Dp);class xr{constructor(a,b){this.Xh=a;this.EId=b}Lx(a,b,c){if(c){a=Dp[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=u.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Xh.mj(this.EId()+
"&apitype="+a,2,b,f,!1,3,Object(F.a)(this,this.yKa,"requestSucceeded"),Object(F.a)(this,this.wKa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}yKa(a){if(!u.AFrameworkApplication.Ug&&a&&a.data){var b=a.data.state;b&&b.HVc(b,a.data.Sd)}}wKa(a){!u.AFrameworkApplication.Ug&&a&&a.data&&(a=a.data.state)&&a.sVc(a)}}Object(m.a)(xr,"EditorServiceRequestManager",null,[1460]);class Lq extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(m.a)(Lq,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var sl=d(274);class Vm{constructor(a,b,c){this.begin=a;this.end=b;this.Gh=c}}Object(m.a)(Vm,"ErrorRange",null,[215]);class fm{constructor(a,b){this.Mn=a;this.SQh=b}get He(){return this.Mn}get Gh(){return this.SQh}ae(a){return new fm(a||this.Mn,this.Gh)}}Object(m.a)(fm,"SpellingErrorObject",null,[144]);class yr{constructor(a,b,c){this.Pa=new wc.a;this.sr=a;this.H_h=b;this.tUh=c}osf(a,b){b=this.oxh(a,b);if(!cb.a.Wa(b)){for(var c=this.GF(a),f=[],l=0,x=0;l<b.length&&x<c.length;){const H=c[x],U=b[l];
U.end<=H.begin?++l:(H.end>U.begin&&Array.add(f,H),++x)}c=a.W0a();try{const H=a.wja();try{this.lhh(a,f),this.psf(a,b)}finally{H&&H.dispose()}}finally{c&&c.dispose()}this.Tdd(a)}}qKa(a,b,c=!1){if(!cb.a.Wa(b)){c=c?null:a.W0a();try{const f=a.wja();try{this.lhh(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.Tdd(a)}}X_k(a,b){const c=a.W0a();try{const f=a.wja();try{this.$Ud(a),b=this.oxh(a,b),cb.a.Wa(b)||this.psf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}$Ud(a){const b=a.W0a();try{const c=
a.wja();try{const f=a.Ra;for(a=0;a<f.length;a++){const l=f.ga(a);l.Up&&(l.Up=null);l.GL=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}GF(a,b=null){const c=[];let f=0,l=null;var x=!1;a=a.Ra;for(let H=0;H<a.length;H++){const U=a.ga(H);if(U.GL){const ja=U.cp;l?(x=new Vm(f,ja,l),b&&!b(x)||Array.add(c,x)):x?ia.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):ia.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,ja);x=!1}U.Up&&(x=!0,f=U.cp,l=U.Up.Gh)}return c}OSa(a){if(!a||!nb.SelectionEditor.gk(a)&&!nb.SelectionEditor.Tg(a))return null;const b=a.node;let c=a.Qa,f=a.Mb;a=nb.SelectionEditor.Tg(a);const l=this.sr.text(b);for(const x of this.GF(b))if(a){if(x.begin<=c&&x.end>=f)return x}else if(x.begin<=c&&x.end>=c&&ha.a.uzi(l,x.end,f))return x;return null}Fpc(a){if(!this.tUh||!a||!(a.Cca||2===a.length&&nb.SelectionEditor.Xl(a.Ye)))return!1;a=this.OSa(a.Ua);if(!a)return!1;if(a=Object(oa.a)(615,a.Gh))if(a.xJh=
!0,a.Yje())return!1;return!a||5!==a.proofingType}oxh(a,b){if(cb.a.Wa(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Gh||(ia.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;sl.d(b);c=[];this.H_h&&Array.addRange(c,this.sr.QSa(a));c=sl.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const x=c[a];l.begin<x.end&&x.begin<l.end?Array.removeAt(b,f):l.end<
x.end?f++:a++}return b}psf(a,b){let c=!1;for(const f of b){b=f.Gh;c=1===b.proofingType||c;let l=a.gvb(f.begin);l.Up=new fm(l,b);l.isFromErrorRangeSplit=!0;l=a.gvb(f.end);l.GL=!0;l.isFromErrorRangeSplit=!0}c&&(a.fzb=!1)}lhh(a,b){if(!cb.a.Wa(b)){a=a.Ra;for(const c of b){b=a.eT(c.begin);const f=a.eT(c.end);b&&b.Up&&f&&f.GL?(b.Up=null,f.GL=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),ia.ULS.sendTraceTag(37532355,324,10,b))}}}$9h(a){this.Pa.addHandler("OnErrorRangesChanged",
a)}Tdd(a){if(this.Pa.P7b){const b=this.GF(a);this.Pa.raiseEvent("OnErrorRangesChanged",new Lq(a.id.toString(),b))}}}Object(m.a)(yr,"ErrorRangeEditor",null,[1459]);var Oo=d(214);class Mq{constructor(){this.Ndf=new Oo.a}contains(a,b){return a?this.Ndf.contains(ha.a.$Bh(a,b)):!1}add(a,b){a&&this.Ndf.add(ha.a.$Bh(a,b))}}Object(m.a)(Mq,"IgnoreAllKeywords",null,[1263]);var Kk=d(215);class zr extends Kk.a{constructor(a,b,c){super(b,c);this.DG=a;this.KJa=this.laa=-1;this.BUd=0;this.textUnit=2}get lcid(){return this.DG}}
Object(m.a)(zr,"ModifiedRange",Kk.a,[]);class ip{constructor(a,b,c,f){this.v3h=a;this.EK=b;this.hN=c;this.Klf=f}get Rid(){return this.Klf?this.Klf.instance:null}Qzf(a,b){const c=[];if(cb.a.Wa(a)||cb.a.Wa(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new zr(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let x=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const H=a.pop(),U=H.end,ja=Math.min(U,l);U>l&&a.push(new Kk.a(l,U));Array.add(c,new zr(x,H.begin,
ja))}f++}while(0<a.length&&f<b.length);ia.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}$Ti(a,b,c,f){let l,x;({eEe:l,MDe:x}=ip.hWf(a,c,b));c=0;let H=a.begin,U=a.end;const ja=this.Rid;let ya=!1;ja?(c=ja.findEndBoundary(b,U-1,x),f||-1!==c||this.Hbg(b,a)?c=-1===c?x:c:ya=!0):ya=!0;if(ya)return this.t1f(a,b,this.hN.C0g,l,x);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(ja.findBeginBoundary(b,H,l),l);return Kk.a.createTextRange(a,c)}ZTi(a,
b,c){return this.JTf(a,b,c,this.hN.C0g)}YTi(a,b){if(!a||cb.a.Wa(b))return a;let c=a.begin,f=a.end,l=!1;for(const x of b){if(a.end<=x.begin)break;a.begin>x.begin&&a.begin<x.end&&(c=x.begin,l=!0);a.end>x.begin&&a.end<x.end&&(f=x.end,l=!0)}return l?Kk.a.createTextRange(c,f):a}pil(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!ha.a.Kzb(b.substring(c,a))&&!ha.a.tzi(b,c,a)}H4i(a,b,c){if(!a||!c||cb.a.Wa(b))return 0;a=sl.c([a],b);b=0;for(const f of a)b+=this.v3h.K8f(c,f.begin,f.end);return b}v5h(a,
b,c,f){if(a&&b){var l=a.begin,x=a.end,H=this.hN.Cpk;if(0>=H)a.laa=l,a.KJa=x;else if(H=this.JTf(a,b,f,H)){b=a.lcid;f=H.begin;H=H.end;if(0>f||this.Qth(f,l,b,c))f=l;this.Qth(x,H,b,c)&&(H=x);a.laa=f;a.KJa=H}else a.laa=l,a.KJa=x}}Hbg(a,b){return this.Rid?-1!==this.Rid.findEndBoundary(a,b.begin,b.end):!1}Qth(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.Qzf([new Kk.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}JTf(a,b,c,f){if(!a||!b||0>f)return null;let l;({eEe:c,MDe:l}=ip.hWf(a,c,b));return this.t1f(a,
b,f,c,l)}t1f(a,b,c,f,l){return Kk.a.createTextRange(this.EK.XXi(b,c,a.begin,f),this.EK.DXi(b,c,a.end,l))}static hWf(a,b,c){let f;f=0;c=c.length;if(cb.a.Wa(b))return{eEe:f,MDe:c};let l=a.begin;a=a.end;let x=!1,H=!1;for(const U of b)if(!x&&U.end<=l?f=U.end:x=!0,!H&&U.begin>=a&&(c=U.begin,H=!0),x&&H)break;return{eEe:f,MDe:c}}}Object(m.a)(ip,"ModifiedExpandRangeHelper",null,[1458]);var Po=d(349);class jt{constructor(a,b){this.TCd=null;this.Cg=a;this.EK=b;this.HG=Sb.ParagraphReader.text(this.Cg);this.Flf=
[]}Nnj(a,b){return this.OUc(this.EK.j4b(this.HG,a,b))}OUc(a){return a?this.mae(a.begin,a.end):null}mae(a,b){this.TCd=this.TCd||this.EK.lSc(this.Cg);return this.EK.OUc(a,b,this.HG,this.TCd)}xEa(a,b){(a=this.mae(a,b))&&Array.add(this.Flf,a)}Y5b(){return Array.clone(this.Flf)}}Object(m.a)(jt,"ValidatedRangeContainer",null,[]);class jp{constructor(a,b,c,f,l,x){this.Gm=a;this.EK=b;this.Tc=c;this.hN=f;this.e0h=l;this.NYh=x}vwb(a){return new jt(a,this.EK)}Dci(a){const b=a.p_d.currentNode;var c=a.txh.currentNode;
const f=a.U7g;a=this.vta(b);const l=this.vwb(b);c=this.vta(c);for(var x of c)l.xEa(f+x.begin,f+x.end);Array.addRange(a,l.Y5b());if(x=l.Nnj(f,f))Array.add(a,x),this.IQe(b,x,0);b.N0=a}Eci(a,b,c){var f=a.N0;if(cb.a.Wa(f)||f[f.length-1].end<=c)this.MJc(b);else{var l=[],x=this.vwb(a),H=this.vwb(b);for(const U of f)if(f=U.end,f>c){const ja=U.begin;ja<c?(x.xEa(ja,c),H.xEa(0,f-c)):H.xEa(ja-c,f-c)}else Array.add(l,U);c=x.Y5b();Array.addRange(c,l);a.N0=c;b.N0=H.Y5b();a.Xpc();b.Xpc()}}Ybl(a){Sb.ParagraphReader.$d(a)&&
!this.EK.uUa(a)&&(this.Gm.$Ud(a),this.JRe(a,[new Kk.a(0,Sb.ParagraphReader.textLength(a))]))}arh(a,b){b&&a&&Sb.ParagraphReader.$d(a)&&!this.EK.uUa(a)&&!a.kC&&this.KYg(a,this.vwb(a).OUc(b),D.a.typing)}esh(a,b,c){a&&this.arh(a,this.EK.j4b(Sb.ParagraphReader.text(a),b,c))}JRe(a,b){if(Sb.ParagraphReader.$d(a))if(cb.a.Wa(b))this.MJc(a);else{const c=this.vwb(a);for(const f of b)c.xEa(f.begin,f.end);a.N0=c.Y5b()}}MJc(a){Sb.ParagraphReader.$d(a)&&(a.N0=null)}Wod(a,b,c=null){if(Sb.ParagraphReader.$d(a)&&!a.kC&&
!cb.a.Wa(b)){sl.d(b);var f=null;if(this.hN.Vyb||this.hN.qUa)f=U=>1===U.Gh.proofingType;f=this.Gm.GF(a,f);for(var l=[],x=0,H=0;H<f.length&&x<b.length;){const U=b[x],ja=f[H];U.end<=ja.begin?x++:(ja.end<=U.begin||ja.begin>=U.begin&&ja.end<=U.end&&(0!==ja.Gh.errorType||ja.begin!==U.begin)&&Array.add(l,ja),H++)}this.Gm.qKa(a,l);f=this.vta(a);b=sl.b(f,b);c&&(c=sl.c(f,[c]),0<c.length&&(b=sl.e(b,c)));this.JRe(a,b)}}vta(a){return Sb.ParagraphReader.$d(a)?a.N0||[]:[]}Kei(a,b,c,f,l=0){const x=a.node;if(Sb.ParagraphReader.$d(x)&&
!this.EK.uUa(x)&&!x.kC){var H=Sb.ParagraphReader.text(x),U=a.Qa,ja=a.Mb+f;this.e0h?(U=a.Qa+b,ja=a.Mb-c+f):this.NYh&&(b=this.Tc.Pj,0<=f&&b&&nb.SelectionEditor.Tg(b)&&(b=b.Qa,0<=b&&b<=H.length&&(b=this.EK.j4b(H,b,b))&&b.begin>=U&&b.end<=ja&&(U=b.begin,ja=b.end)));b=this.vwb(x);c=null;0<=f&&(c=b.mae(U,ja));c||(c=this.EK.j4b(H,U,ja));0<=f?this.KYg(x,c,l):this.wEl(x,a.Qa,a.Mb,c,b,f,l)}}KYg(a,b,c){if(b){var f=this.vta(a);Array.add(f,b);a.N0=f;a.Xpc();this.IQe(a,b,c)}}wEl(a,b,c,f,l,x,H){const U=this.vta(a),
ja=[];if(U.length)if(U[U.length-1].end<b)if(f)Array.addRange(ja,U);else return;else{for(const ya of U)ya.end<b?Array.add(ja,ya):ya.begin>=c?l.xEa(ya.begin+x,ya.end+x):ya.begin<b?ya.end>c?l.xEa(ya.begin,ya.end+x):l.xEa(ya.begin,b):ya.end>c&&l.xEa(b,ya.end+x);Array.addRange(ja,l.Y5b())}f&&(Array.add(ja,f),this.IQe(a,f,H));a.N0=ja;a.Xpc();this.Gm.Tdd(a)}IQe(a,b,c){const f=this.Gm.GF(a,x=>x.begin<=b.end&&x.end>=b.begin);if((c===D.a.fSd||c===D.a.typing||c===D.a.cut||c===D.a.paste)&&1===f.length&&f[0].Gh){c=
f[0].Gh;var l=Ya.a.xe(c.lcid);l=l?l.name:jp.iLh;const x=Object(Xa.a)(Po.a,c)?c.typeId:jp.yLh;ia.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",x,l);c.xJh&&ia.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",x,l)}this.Gm.qKa(a,f)}}jp.yLh="";jp.iLh="UNKNOWN";Object(m.a)(jp,"ModifiedRangeEditor",null,[1457]);class bq{constructor(a,b,c,f,l,x,H,U,ja,ya,Va=null){this.Gm=a;this.Kz=b;this.MXb=c;this.yK=f;this.L3a=l;this.pOa=x;this.EK=H;this.V4a=
U;this.M9e=ja;this.Wcf=Va||bq.IJi;this.Vnf=!1;ya.execute(hb=>{this.Vnf=!!hb})}iGh(a){if(a&&Sb.ParagraphReader.$d(a)&&a.TVc){let b=null;this.M9e.rua&&(b=c=>!!c.Gh&&1===c.Gh.proofingType);a.fzb=cb.a.Wa(this.Kz.vta(a))&&cb.a.Wa(this.Gm.GF(a,b))}}$cj(a,b){var c=this.bdj(a,b);if(cb.a.Wa(c))return[];const f=Sb.ParagraphReader.text(a).replace("\u00a0"," "),l=this.Gm.GF(a),x=this.B8k(a,l),H=x&&this.uBi(a),U=this.EK.AVf(a),ja=sl.e(this.EK.zVf(a),U);c=this.p9i(c,b,f,ja,l,x,H);if(cb.a.Wa(c))return[];b=this.L3a.kbj(a);
c=this.pOa.Qzf(c,b);if(cb.a.Wa(c))return[];this.sLk(a,f,c);a=this.Kz.vta(a);for(const ya of c)this.pOa.v5h(ya,f,b,U),ya.BUd=this.pOa.H4i(ya,a,f),x&&(H||this.pOa.Hbg(f,ya))&&(ya.textUnit=4);return c}vXi(a){if(this.Wcf()||!a||""===a.sa($a.a.pq,""))return null;var b=this.V4a.l4b;if(!b||!nb.SelectionEditor.Tg(b)||b.node!==a||!this.Wxj(a))return null;b=b.Qa;return this.EK.j4b(Sb.ParagraphReader.text(a),b,b)}Jei(a,b,c,f,l,x,H=0){this.yK.Nc(a.node).$e()&&(this.Kz.Kei(a,b,c,x,H),this.MXb.sGl(a,f,l))}Wxj(a){const b=
sl.a(this.Kz.vta(a));if(!b.length)return!1;a=sl.a(this.Gm.GF(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],x=a[c];l.begin>=x.begin&&l.end<=x.end?f++:c++}return f!==b.length}bdj(a,b){if(!a||a.Rie)return null;a=this.Kz.vta(a);return a.length&&b?sl.b(a,[b]):a}B8k(a,b){return this.Vnf&&this.M9e.rua?a.GTb||!b.length||cb.a.any(b,c=>!!c.Gh&&2===c.Gh.Vpg):!1}uBi(a){if(!a.GTb||this.Wcf())return!0;var b;(b=this.V4a.l4b)&&b.node===a?(a=this.Kz.vta(a),b=b.Qa<a[a.length-1].begin):b=!0;return b}p9i(a,
b,c,f,l,x,H){let U=[];for(const ja of a)a=x?this.pOa.$Ti(ja,c,f,H):this.pOa.ZTi(ja,c,f),(a=this.pOa.YTi(a,l))&&Array.add(U,a);U=sl.a(U);b=sl.f(f,b);return sl.b(U,b)}sLk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const x=c[l];this.pOa.pil(x,b)||(Array.removeAt(c,l),Array.add(f,x))}this.Kz.Wod(a,f)}static IJi(){return bf.a.zyj(Oc.App.Kb.qG.Fog)}}Object(m.a)(bq,"ParagraphProofingFacade",null,[1456]);var ik=d(1062);class kp{constructor(){this.sVc=this.HVc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(m.a)(kp,"EditorServiceAPIRequest",null,[]);class cq extends kp{constructor(){super();this.nza=this.request=null}}Object(m.a)(cq,"ProofingConfigV2Request",kp,[]);class dq{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(m.a)(dq,"ProofingConfigV2RequestObject",null,[]);var Ep;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(Ep||(Ep={}));Object(m.b)("ResponseStatus",Ep);var il=d(2);class Nq{constructor(a,b,c,f,l){this.WRb=a;this.ld=b;this.QVb=c;this.LYh=f;this.Hqf=u.AFrameworkApplication.lcid;this.Uga=Oc.App.mode;this.gxc={};this.iVb=new Yc.a;this.FYh=l}init(){this.Xhd(this.Hqf)}Xhd(a){if(!(a.toString()in this.gxc||u.AFrameworkApplication.Ug))try{this.LYh.Iri(a).continueWith(b=>{!b.result||this.iVb.Hb(a.toString())&&this.iVb.ga(a.toString())||this.E7k(a)},3)}catch(b){ia.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}E7k(a){var b=new ik.a;const c=Ya.a.xe(a).name,f=Ya.a.xe(this.Hqf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new cq,{request:new dq(a,this.u5d(),c,f,this.QVb.descriptors),activity:this.ld.Vp(D.a.a1k),nza:b,HVc:Object(F.a)(this,this.Fmc,"processSuccessResponse"),sVc:Object(F.a)(this,this.Dmc,"processFailResponse")}),this.iVb.$(a.toString(),!0),this.WRb.Lx(2,xd.c(b.request),b))}Fmc(a,b){if(!a||!a.request)return!1;this.iVb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.gxc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=xd.a(b)}catch(f){ia.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?Ep[c.ResponseStatus]:"EmptyResponse",ia.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.FYh.filter(b);
ia.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.gxc[a.request.Lcid.toString()]=b;return!0}Dmc(a){a&&(a.request&&this.iVb.$(a.request.Lcid.toString(),!1),a.nza.Gg(!1),ia.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return il.Task.Rt(this.gxc[a.toString()])}u5d(){const a=
qe.a[this.Uga];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(m.a)(Nq,"ProofingConfigV2Manager",null,[1267]);class tl{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new tl,{Name:a,Value:b})}static fee(){Object.assign(new tl,{Name:"IsCompliant",Value:void 0});Object.assign(new tl,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new tl,{Name:"IsGoLocal",Value:void 0})}}Object(m.a)(tl,"Descriptor",null,[]);class r{constructor(a,b){this.mAa=[];this.$a=
a;this.wbf=b}get descriptors(){if(!this.mAa.length)try{this.fee()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);ia.ULS.sendTraceTag(33952285,375,10,b)}return this.mAa}fee(){Array.clear(this.mAa);var a=this.$a.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.mAa,Object.assign(new tl,{Name:"IsGoLocal",Value:this.$a.ka("IsGoLocalEnvironment").toString()}));Array.add(this.mAa,Object.assign(new tl,{Name:"IsCompliant",Value:a}));
if(this.wbf.Mme||this.wbf.qUa)a=this.$a.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.mAa,Object.assign(new tl,{Name:"LicenseType",Value:a}));this.Pdi();this.Wdi()}Wdi(){var a=xd.b(this.$a.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.mAa,Object.assign(new tl,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.mAa,Object.assign(new tl,{Name:"Origin",Value:a}))}Pdi(){const a=
this.bXi(this.$a.Ga("FlightId"));let b;0<a.length&&(b=cb.a.join(a,";"),Array.add(this.mAa,Object.assign(new tl,{Name:"FlightIds",Value:b})),ia.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}bXi(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(m.a)(r,"ProofingDescriptors",null,[1262]);class R{constructor(a,b){this.qUa=this.Vyb=this.rKd=!1;this.ZGd=this.YGd=0;
this.xCc=a.ka("ProofingWithEditorServiceIsEnabled");this.mSh=a.ka("GrammarCheckIsEnabled");this.VUa=a.ka("ProofingSettingIsEnabled");this.dle=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.Azc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.z3h=a.ka("WritingStyleIsEnabled");this.iQh=a.ka("DoNotCheckThisIssueEnabled");this.XTh=a.ka("IgnoreProofingCommandIsEnabled");this.rua&&(this.rKd=!1,b.execute(()=>{this.rKd=!0}));2===this.Mfa?(this.ZGd=2,this.YGd=
3):(this.ZGd=a.Bc("NumberOfWordsToProofAroundModifiedRanges",1),this.YGd=a.Bc("NumberOfWordsAsContextAroundProofedRanges",0))}get djg(){return this.XTh}get rua(){return 2===this.Mfa&&this.mSh}get Mme(){return this.rua&&this.z3h}get kje(){return this.iQh&&this.dle&&this.VUa}get RLj(){return this.Azc}get Mfa(){return this.xCc?2:0}get Cpk(){return this.YGd}get C0g(){return this.ZGd}get isLoaded(){return!this.xCc||!this.rua||this.rKd}}Object(m.a)(R,"ProofingFeatureConfiguration",null,[1453]);class la extends kp{constructor(){super();
this.request=null}}Object(m.a)(la,"ProofingFeedbackLoopRequest",kp,[]);class Ea{constructor(a,b,c){this.WRb=a;this.ld=b;this.QVb=c}J7k(a){a.Descriptors=this.QVb.descriptors;a=Object.assign(new la,{request:a,activity:this.ld.Vp(D.a.e8k),HVc:Object(F.a)(this,this.Fmc,"processSuccessResponse"),sVc:Object(F.a)(this,this.Dmc,"processFailResponse")});this.WRb.Lx(1,xd.c(a.request),a)}Fmc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Dmc(a){a&&(ia.ULS.sendTraceTag(38847138,375,15,"Proofing feedback failed"),
a.endActivity("RequestFailed"))}}Object(m.a)(Ea,"ProofingFeedbackLoopManager",null,[1452]);class Qa extends kp{constructor(){super();this.nza=this.request=null}}Object(m.a)(Qa,"ProofingLanguageInfoRequest",kp,[]);class wb{constructor(a){this.AppId=a}}Object(m.a)(wb,"ProofingLanguageInfoRequestObject",null,[]);class Pb{constructor(a,b){this.WRb=a;this.ld=b;this.Uga=Oc.App.mode;this.jqa=new Ma.ScriptSharpLegacyMap;this.aha=null;this.J4a=0}Iri(a){if(this.jqa.Hb(a))return il.Task.Rt(!0);this.RTe();return this.aha.CWRCo(()=>
!!this.aha.result&&this.aha.result.Hb(a),3)}Jri(a,b){if(this.jqa.Hb(a))return il.Task.Rt(this.u7f(a,b));this.RTe();return this.aha.CWRCo(()=>this.u7f(a,b),3)}Q6i(a){if(0<this.jqa.count)return il.Task.Rt(this.s0f(a));this.RTe();return this.aha.CWRCo(()=>this.s0f(a),3)}V0k(){const a=new ik.a;u.AFrameworkApplication.Ug&&a.Gg(null);const b=Object.assign(new Qa,{request:new wb(qe.a[this.Uga]+"_Online"),activity:this.ld.Vp(D.a.b1k),nza:a,HVc:Object(F.a)(this,this.Fmc,"processSuccessResponse"),sVc:Object(F.a)(this,
this.Dmc,"processFailResponse")});this.WRb.Lx(0,xd.c(b.request),b);this.J4a+=1;return a.task}Fmc(a,b){let c=null;if(!a)return!1;try{c=xd.a(b)}catch(l){ia.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=Ya.a.xe(f.LanguageId))&&0!==f.SupportedTextUnit&&this.jqa.$(b.LCID,f);a.nza.Gg(this.jqa);a.endActivity("RequestSucceeded");return!0}a.nza.Gg(null);
f=c?Ep[c.ResponseStatus]:"EmptyResponse";ia.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}Dmc(a){a&&(a.nza.Gg(null),ia.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}u7f(a,b){if(!this.jqa||!this.jqa.Hb(a))return 0;a=this.jqa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.u9i(b,a)}u9i(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}s0f(a){const b=new Ka.a;if(!this.jqa)return b;for(let c of this.jqa)c.value.SupportedCritiqueTag&a&&b.add(c.key);
return b}RTe(){if(!this.aha||5===this.aha.status||4===this.aha.status||6===this.aha.status&&!this.aha.result)this.aha=this.V0k(),ia.ULS.sendTraceTag(38319180,375,1===this.J4a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.J4a,this.J4a)}}Object(m.a)(Pb,"ProofingLanguageInfoManager",null,[1451]);class xc{constructor(a,b){this.RUh=a;this.wpb=b}track(a,b=null){this.RUh&&this.wpb.track(a(),b)}}Object(m.a)(xc,"ProofingMetricsAggregator",null,[1266]);class ed{Mtf(a,
b){a&&Sb.ParagraphReader.$d(a)&&!cb.a.Wa(b)&&(sl.d(b),a.YOb=sl.e(a.YOb,b))}sGl(a,b,c){if(b){var f=a.Mb;a=a.node.YOb;for(let x=0;x<a.length;x++){var l=a[x];const H=l.begin;l=l.end;0>b?l>c&&(H>=f?a[x]=new Kk.a(H+b,l+b):H>=c&&l<=f?(Array.removeAt(a,x),x--):a[x]=new Kk.a(H<c?H:c,l<=f?c:l+b)):a[x]=new Kk.a(H>f?H+b:H,l>f?l+b:l)}}}}Object(m.a)(ed,"UnsupportedLanguageRangeEditor",null,[1450]);var jd=d(1253),bd=d(466),Ce=d(249),Bf=d(452),Df=d(1089),Eh=d(665);class jk{constructor(){this.Hy=this.s_a=null}}Object(m.a)(jk,
"ClientRequestManagerStateObject",null,[]);class tj{constructor(a,b){this.request=a;this.response=b}}Object(m.a)(tj,"SpellCheckRequestResponseTuple",null,[]);class rk{constructor(){this.EIh=0;this.WLf=this.Jna=this.paragraphNode=this.range=null;this.userAction=0;this.yI=null;this.Mfa=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}pjg(){const a=Sb.ParagraphReader.text(this.paragraphNode);if(!a||!this.Jna)return a===this.Jna;let b=this.range.begin,c=this.range.end;return ha.a.sRd(a.substring(b,
c),this.Jna.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.pjg()}}Object(m.a)(rk,"SpellCheckRequest",null,[]);var ul=d(664),Tn=d(840),Un=d(841);class Yh{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d){this.XMd=new Na.a;this.DVb=[];this.Rxc=0;this.VCc={};this.kba=null;this.b9e=Number.POSITIVE_INFINITY;this.Pwc=0;this.A7=Yh.eab;this.C4a=null;this.jEc=0;this.rqb=[];this.nxc=null;this.zZh=!1;this.gVb=[];this.aJd=[];this.GYh=0;this.KYh=c.ka(Yh.$Kk);this.PYh=c.ka(Yh.gLk);
this.HYh=c.appSettings[Yh.YKk];this.EYh=c.ka(Yh.XKk);this.OYh=c.ka(Yh.eLk);this.WH=f;this.Uga=Oc.App.mode;this.Gm=a;this.Kz=b;this.MXb=ya;this.Xh=l;this.jWh=c.Bc(Yh.cLk,Yh.bLk);this.MYh=yb;this.Ak=x;this.kf=H;this.yK=U;this.EK=ja;this.EId=Va;this.vCc=hb;this.Yh=new jd.a;this.JYh=c.ka(Yh.ZKk);this.uCc=fc;this.aLk=Kc;this.yPc=Zb;this.xCc=c.ka(Yh.fLk);this.QVb=Lc;this.DYh=Gc;this.pnb=ae;this.Tga=we;this.Zd=$d}get o7g(){return this.gVb}set o7g(a){this.gVb=a}get aRc(){return u.AFrameworkApplication.Ug}get J1b(){return this.pnb.instance}suspend(){this.jEc++}resume(){if(0>=
--this.jEc&&(this.jEc=0,0<this.rqb.length&&!this.nxc)){const a=this.Tga.isCompleted(4)?0:1;this.nxc=new af.a(a,1,1,Object(F.a)(this,this.$ol,"spellCheckSuspendedNodes"),74);this.Zd.Db(this.nxc)}}$ol(){this.nxc=null;const a=cb.a.clone(this.rqb);Array.clear(this.rqb);Date.now();let b=null;for(const c of a)b=this.zEh(c,!0,b);b&&b.dispose();this.zZh||Date.now()}NR(a,b=!1){(a=this.zEh(a,b,null))&&a.dispose()}zEh(a,b,c){switch(this.fta(a,b)){case 1:cb.a.contains(this.rqb,a)||Array.add(this.rqb,a);break;
case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}fta(a,b){return!a||this.aRc||!this.WH.Kd.isEditingAllowed&&!this.WH.Kd.ez?0:!b&&0<this.jEc||!this.yPc.isLoaded?1:!Sb.ParagraphReader.$d(a)||!a.isConnected||a.anchor.YI||a.Rie||a.SW||a.kC?3:this.kba&&cb.a.any(this.kba,c=>c.paragraphNode===a)?0:cb.a.any(this.DVb,c=>c.paragraphNode===a)||!this.kf.Bt(this.yK.Nc(a))?3:2}doSpellCheck(a,b){const c=(ya,Va)=>{this.Kz.Wod(ya,Va)};var f=this.EK.lSc(a);let l=
0<f.length;b=this.LMe(b,a,f,c);(f=this.uCc.vXi(a))&&this.tFi(a);const x=this.uCc.$cj(a,f),H=Sb.ParagraphReader.text(a),U=a.GTb,ja=[];for(let ya=x.length-1;0<=ya;ya--){const Va=x[ya];Va.begin!==Va.end&&(this.XMd.contains(Va.lcid)?Array.add(ja,Va):(this.HBi(a,H,f,Va,U),Array.removeAt(x,ya)))}l=0<ja.length||0<x.length||l;b=this.LMe(b,a,ja,Object(F.a)(this.MXb,this.MXb.Mtf,"addUnsupportedRanges"));b=this.LMe(b,a,x,c);l&&this.uCc.iGh(a);return b}me(a){const b=this.Ak.me(7,D.a.b5e);b.kd(a);return b}LMe(a,
b,c,f){cb.a.Wa(c)||(a=a||this.me(b),f(b,c));return a}tFi(a){const b=new af.a(4,1,500,Object(F.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.Zd.Db(b)}Dok(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.Jna.length+b.paragraphNode.id;this.VCc[b]=(this.VCc[b]||0)+1;this.Rxc=Math.max(this.VCc[b],this.Rxc);return this.Rxc>Yh.Jkk?(ia.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.Rxc=0,this.VCc=
{},this.Kz.MJc(a),!1):!0}HBi(a,b,c,f,l){const x=new rk;x.EIh=u.AFrameworkApplication.lcid;x.Jna=b;x.range=f;x.paragraphNode=a;x.WLf=c;x.userAction=l?1:0;const H=this.yPc.VUa;H&&this.J1b&&(x.overriddenCritiqueTypeOptions=this.J1b.k6d());this.Dok(a,x)&&this.llj(x.range.lcid,x.range.textUnit).continueWith(U=>{U=U.result;x.Mfa=2===this.yPc.Mfa?0!==U?2:0:this.GYh;x.range.textUnit=U;x.descriptors=this.QVb.descriptors;this.mRi(x);H&&2===x.Mfa&&this.DYh.Xhd(x.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}llj(a,
b){return 2===this.yPc.Mfa?this.aLk.Jri(a,b):il.Task.Rt(b)}mRi(a){a.yI=new Date;Array.enqueue(this.DVb,a)}recheckParagraphTask(a){this.NR(a.customData)}executeNextRequest(){if(!this.aRc&&!this.kba){var a=[];do{if(!this.DVb.length)break;const b=Array.dequeue(this.DVb);b.isValid()&&Array.add(a,b)}while(a.length<this.jWh);0>=a.length?(this.kba=null,this.apl()):(this.kba=a,this.kba.sort((b,c)=>+b.yI-+c.yI),a=this.kba[0],this.vCc.track(+new Date-+a.yI,"ProofingRequestInQueue."+ul.a[a.userAction]),this.executeRequest(this.kba))}}apl(){for(var a=
0;a<this.gVb.length;a++)(0,this.gVb[a])();Array.clear(this.gVb);for(a=0;a<this.aJd.length;a++)(0,this.aJd[a])();Array.clear(this.aJd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=Eh.a.Dij(this.KYh,a[c],this.Uga,this.PYh,this.OYh,this.EYh,this.HYh,this.xCc);Array.add(b,f)}b=Tn.a.Vyi(b,Oc.App.mode);this.Xh.mj(this.EId(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(F.a)(this,this.Yol,"spellCheckSucceeded"),Object(F.a)(this,this.Xol,"spellCheckFailed"),
Object.assign(new jk,{s_a:a,Hy:this.Yh.Ci("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Yol(a){if(!this.aRc){a=a.data;this.vCc.track(a.state.Hy.Vq,"ProofingRequestRoundtrip");var b=this.Yh.Ci("DOMUpdate","Proofing");this.Zol(a);this.vCc.track(b.Vq,"UpdateProofingResults")}}Zol(a){bd.a.mark(7798);this.kba=null;var b=a.state.s_a;if(({group:c}=Un.a.wDh(a.Sd)).returnValue){var c=c.Responses;var f=({o3k:b,J8k:c}=this.clj(b,c)).returnValue;if(0<f.length){const l=this.me(f[0].request.paragraphNode);
try{for(const x of f){const H=x.request;this.WH.oRi(H.paragraphNode,()=>{this.mkk(x.response,H)})}}finally{l&&l.dispose()}}b.length?(this.iSd(a),this.vMe(b),this.e1d()):this.K1k();this.iSd(a);for(const l of c)Ce.PageStats.EYb(l);this.e1d();this.executeNextRequest()}else this.vMe(b);bd.a.mark(7799)}clj(a,b){let c,f;const l=[];c=[];f=[];for(let x=0;x<a.length;x++){const H=a[x];if(!H.paragraphNode.isConnected)continue;const U=b[x];if(5===U.classId){const ja=U.Fault;if(ja)switch(ja.Type){case 1:ia.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.b9e,ja.Limit,ja.AttemptedValue);this.b9e=ja.Limit;break;default:ia.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(H)}else l.push(new tj(H,U));U.ServerPageStatsTrace&&f.push(U.ServerPageStatsTrace)}return{returnValue:l,o3k:c,J8k:f}}mkk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.kC)this.executeNextRequest();else{var f=this.me(c),l=this.MYh.h2k(a);
if(b.pjg()){var x=b.range;const H=[x];l.hmd(a)?(x=sl.a(this.Gm.GF(c)),1!==b.userAction&&c.nfi()&&this.JYh&&(a=l.uVf(a,b,x)),this.Kz.Wod(c,H,b.WLf),a=l.KUi(a,b,x),this.Gm.osf(c,a)):this.Twj(c,x);this.uCc.iGh(c)}c.Xpc();f.dispose();this.NR(c)}else this.executeNextRequest()}Twj(a,b){const c=[b];b=b.lcid;this.XMd.contains(b)||(ia.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.XMd.add(b));this.Kz.Wod(a,c);this.MXb.Mtf(a,c)}Xol(a){a=a.data;if(!this.aRc){var b=a.state;this.vCc.track(b.Hy.Vq,
"ProofingRequestRoundtrip");this.vMe(b.s_a);this.iSd(a);this.e1d()}}vMe(a){this.kba=a;a=new af.a(3,1,this.A7,Object(F.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.Zd.Db(a);++this.Pwc;this.A7*=Yh.KSe;this.A7>Yh.Hic&&(this.A7=Yh.Hic);4!==this.Pwc||this.Xh.uFa||(this.C4a=Oc.App.Kb.notificationBar.LCa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),Oc.App.Kb.notificationBar.Zh(this.C4a),u.AFrameworkApplication.jj.bab(Yh.hLh,1),ia.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.Xh.bGc(this))}K1k(){this.Pwc&&(this.Pwc=0,this.A7=Yh.eab);this.C4a&&(Oc.App.Kb.notificationBar.removeEntry(this.C4a),this.C4a=null,this.Xh.fld(this))}retryCurrentRequest(){this.executeRequest(this.kba)}zGb(){Oc.App.Kb.notificationBar.removeEntry(this.C4a);this.C4a=null;this.Xh.fld(this)}qjc(){}get Yle(){return!this.rqb.length&&!this.kba&&!this.DVb.length}iSd(a){Ce.PageStats.B6a("SpellCheck",a.Xt);(a=a.sj?a.sj[Bf.a.FCa]:null)&&Ce.PageStats.W5a(Df.a.Jh,a)}e1d(){Ce.PageStats.uDa("SpellCheck")}}
Yh.cLk="ProofingRequestsBatched";Yh.bLk=1;Yh.XKk="ProofingContextualResultsIsEnabled";Yh.eLk="ProofingTrackMetricsIsEnabled";Yh.$Kk="ProofingInstrumentedAndContextualIsEnabled";Yh.gLk="ProofingWithOneSpellerIsEnabled";Yh.YKk="ProofingExperimentId";Yh.fLk="ProofingWithEditorServiceIsEnabled";Yh.ZKk="ProofingFilterSpellCheckResultIsEnabled";Yh.hLh=11093;Yh.Jkk=30;Yh.eab=1E3;Yh.KSe=5;Yh.Hic=72E6;Object(m.a)(Yh,"ProofingCheckOperator",null,[278,1455]);var Vn=d(521);class Wn{constructor(a){this.wpb=a}KUi(a,
b,c){if(this.ESe(a)){const f={};a=this.fUf(b,a,c,f);this.Qci(b,f);return a}b&&this.Rci(b);return[]}Qci(a,b){this.wpb.track(()=>Object.assign(new Vn.a,{E:a.Mfa,C:a.range.BUd,F:b}))}Rci(a){this.wpb.track(()=>Object.assign(new Vn.a,{E:a.Mfa,C:a.range.BUd}))}ekg(a,b,c){return!a||cb.a.all(a,f=>f.begin!==b||f.end!==c)}Qng(a,b,c){return!!a&&cb.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(m.a)(Wn,"AProofingResultsManager",null,[1474]);var Gn=d(520),jl;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";
a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(jl||(jl={}));Object(m.b)("ProofingType",jl);class Hl extends Wn{constructor(a,b,c,f=null){super(a);this.$a=f;this.TQh=b;this.hN=c}hmd(a){return a&&63===a.classId?!0:(ia.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}ESe(a){return this.hmd(a)&&!!a.Critiques&&0<a.Critiques.length}fUf(a,b,c,f){const l=[];b=b.Critiques;for(const U of b)if(this.ayj(b,
U)&&this.Egl(U)){var x=0<=a.range.laa?a.range.laa+U.Start:a.range.begin+U.Start;const ja=x+U.Length;var H=a.Jna.substring(x,ja);const ya=this.TQh.create(U,this.wpb,this.$a);ya.lcid=a.range.lcid;ya.token=H;ya.originalText=a.Jna;ya.laa=a.range.laa;ya.KJa=a.range.KJa;a.range.end>=ja&&(H=new Vm(x,ja,ya),Array.add(l,H));this.ekg(c,x,ja)&&(x=1===ya.proofingType?jl[ya.proofingType]:ya.typeId,f[x]=x in f?f[x]+1:1)}return l}uVf(a,b,c){if(!this.ESe(a))return a;const f=[];for(const l of a.Critiques){const x=
0<=b.range.laa?b.range.laa+l.Start:b.range.begin+l.Start;this.Qng(c,x,x+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}Egl(a){return 2!==Gn.b(a)||!this.hN.qUa}ayj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(m.a)(Hl,"ProofingCheckResultsManager",Wn,[]);var pf=d(50),Vl=d(94);class Oq{constructor(a,b,c,f,l,x,H){this.gCd=!1;H&&c.PK(Object(F.a)(this,this.dRk,"recheckAllParagraphs"));b.y8h(Object(F.a)(this,
this.rqk,"onAfterParagraphMerge"));l&&l.yd(12).N7(Object(F.a)(this,this.Svk,"onParagraphDisconnected"));this.Kz=a;this.PVb=f;this.Gm=x}Svk(a,b){Sb.ParagraphReader.$d(b.node)&&this.Gm&&this.Gm.Tdd(b.node)}rqk(a,b){this.Kz.Dci(b);this.NR(b.p_d.currentNode)}a9b(a){this.Kz.Ybl(a);this.NR(a)}dRk(a){if(2===a.mode&&(a=this.J7f(a)))for(a=Vl.a.Sz(a);a.moveNext();)Sb.ParagraphReader.el(a.iterator)&&this.NR(a.currentNode)}suspend(){this.PVb.suspend()}resume(){this.PVb.resume()}get Yle(){return this.PVb.Yle}get HXe(){return this.gCd}set HXe(a){if(this.gCd!==
a&&(this.gCd=a,a=this.J7f(Oc.App.Kb))){var b=new pf.GraphTransaction(2);try{b.set(a.Sj);const c=Vl.a.Sz(a);for(;c.moveNext();)Sb.ParagraphReader.el(c.iterator)&&c.currentNode.Bv(16,!0)}finally{b&&b.dispose()}}}J7f(a){return(a.Kd.isEditingAllowed||a.Kd.ez)&&a.Kd.Dn.uo?a.Kd.Dn.xg:null}V6h(a){Array.add(this.PVb.o7g,a)}NR(a){this.PVb.NR(a,!1)}}Object(m.a)(Oq,"ProofingManager",null,[1265]);var vo=d(1209),kt=d(663);class lt extends kt.a{constructor(a){super(a);this.jXb=null}get proofingType(){return 1}get suggestions(){return this.jXb?
Array.clone(this.jXb):null}Sdl(a){this.jXb=a}aMa(a,b=0){this.Jlf.track(()=>Object.assign(new Vn.a,{E:0,T:1,A:a,I:b}))}}Object(m.a)(lt,"OfficeSpellerErrorDetails",kt.a,[]);class Fp extends Wn{constructor(a){super(a)}hmd(a){return!!a.Errors}ESe(a){return this.hmd(a)&&0<a.Errors.length}fUf(a,b,c,f){let l=0;const x=[],H=b.Errors;for(let ya=0;ya<H.length;ya++){var U=H[ya],ja=Object.assign(new lt(this.wpb),{token:U.Word,errorType:U.Type,lcid:a.range.lcid});ja.Sdl(vo.a.ZIh(b.Suggestions,ya*vo.a.tog));const Va=
U.Offset+a.range.begin;U=Va+U.Word.length;ja=new Vm(Va,U,ja);Array.add(x,ja);this.ekg(c,Va,U)&&l++}f.spelling=l;return x}uVf(a,b,c){if(cb.a.Wa(c)||!a)return a;const f=[],l=[];for(let H=0;H<a.Errors.length;++H){const U=a.Errors[H];var x=U.Offset+b.range.begin;this.Qng(c,x,x+U.Word.length)&&(x=H*vo.a.tog,Array.add(f,vo.a.kYj(a.Suggestions,x)),Array.add(f,vo.a.ZIh(a.Suggestions,x)),Array.add(l,U))}a.Suggestions=f;a.Errors=l;return a}}Object(m.a)(Fp,"ProofingResultsManager",Wn,[]);class Yv{constructor(a,
b,c){this.wCc=new Rd.a;this.s$e=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.wCc.add(63,c.value);this.wCc.add(4,this.s$e)}h2k(a){if(this.wCc.Hb(a.classId))return this.wCc.ga(a.classId);ia.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.s$e}}Object(m.a)(Yv,"ProofingResultsManagerResolver",null,[1264]);class Xn{constructor(a=null,b=null){this.JD=this.fd=null;this.KMd=a;this.LMd=b}get Tf(){!this.fd&&this.KMd&&this.KMd.instance&&
(this.fd=this.KMd.instance.instance);return this.fd}get Gtc(){!this.JD&&this.LMd&&this.LMd.instance&&(this.JD=this.LMd.instance.instance);return this.JD}XXi(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:c}DXi(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;
" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}uUa(a){return a.properties.sa($a.a.uUa,!1)}zVf(a){a=Sb.ParagraphReader.text(a);let b;const c=[];for(;b=Xn.cBj.exec(a);)Array.add(c,new Kk.a(b.index+b[1].length,b.index+b[0].length));return c}AVf(a,b=!0,c=!1){let f=[],l=!1,x=!1,H=!1,U=!1,ja=-1;a=a.Ra;for(let Va=0;Va<a.length;Va++){var ya=a.ga(Va);ya.hyperlink?x=!0:ya.hn&&(x=!1);b&&ya.formatting&&(H=ya.formatting.cache.RUa);if(c&&(ya.GL&&(U=!1),ya.Up)){const hb=Object(oa.a)(615,ya.Up.Gh);hb&&
(U=hb.KEa)}l!==(x||H||U||!!ya.blob)&&(ya=ya.cp,l?Array.add(f,new Kk.a(ja,ya)):ja=ya,l=!l)}l&&(b=Kk.a.createTextRange(ja,a.last.cp))&&Array.add(f,b);return f}lSc(a,b=!0,c=!1){return sl.e(this.zVf(a),this.AVf(a,b,c))}j4b(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return Kk.a.createTextRange(b,c)}OUc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=Xn.RZf(a,b,c);for(var l=0;l<f.length;l++){var x=f[l];if(a<
x.begin)break;a<x.end&&(a=Xn.RZf(x.end,b,c))}b=Xn.p1f(b,c);for(l=f.length-1;0<=l;l--){x=f[l];if(b>x.end)break;b>x.begin&&(b=Xn.p1f(x.begin,c))}return(a=Kk.a.createTextRange(a,b))&&a.dXj()?a:null}static RZf(a,b,c){for(;a<b&&ha.a.fz(c.charCodeAt(a));)a++;return a}static p1f(a,b){for(;0<a&&Xn.IJj(a,b);)a--;return a}static IJj(a,b){a=b.charAt(a-1).toString();return a===Mb.AParagraphNode.jOc||a===Mb.AParagraphNode.h_}}Xn.cBj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)",
"ig");Object(m.a)(Xn,"ProofingTextUtility",null,[1454]);class Ar{constructor(){this.Da=null}get name(){return"Box4.Proofing"}Zb(a){this.Da=a;this.Da.register(yr,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().oa(()=>new yr(this.Da.resolve("Box4.IParagraphReader"),P.a.instance.ga(14),P.a.instance.ga(70)));this.Da.register(jp,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().oa(()=>new jp(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),
this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),u.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Da.register(ed,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().oa(()=>new ed);this.Da.register(ip,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().oa(()=>
new ip(vr.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(bq,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().oa(()=>new bq(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),
this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),zj.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(Xn,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().oa(()=>new Xn(this.Da.Ja("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.Ja("Box4.TrackChange.ITrackChangeReaderFactory")));
const b=()=>{const c=u.AFrameworkApplication.fa.Ga("ProofingWebServiceBase");return(void 0===c?Oc.App.webServiceBase:c)+"proofing.ashx?"+u.AFrameworkApplication.gh};this.Da.register(xr,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().oa(()=>new xr(u.AFrameworkApplication.Ke,b));this.Da.register(Pb,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().oa(()=>new Pb(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),
Nc.a.instance));this.Da.register(Ea,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().oa(()=>new Ea(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),Nc.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));this.Da.register(R,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().oa(()=>new R(u.AFrameworkApplication.fa,this.Da.Ja("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(1262,
"Box4.Proofing.IProofingDescriptors").ma().oa(()=>new r(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(Yh,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().oa(()=>new Yh(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),u.AFrameworkApplication.fa,Oc.App.Kb,u.AFrameworkApplication.Ke,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),yj.a.instance,
this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Jq.a.GW(4,1,new wr),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.Da.Ja("Box4.Proofing.ICritiqueTypeSettings"),gb.a.get_instance(),u.AFrameworkApplication.ye));this.Da.register(Fp,"Box4.Proofing.ProofingResultsManager").ma().oa(()=>new Fp(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Da.register(1263,"Box4.Proofing.IIgnoreAllKeywords").ma().oa(()=>new Mq);this.Da.register(Hl,"Box4.Proofing.ProofingCheckResultsManager").ma().oa(()=>new Hl(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),
this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa));this.Da.register(1264,"Box4.Proofing.IProofingResultsManagerResolver").ma().oa(()=>new Yv(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.ie("Box4.Proofing.ProofingCheckResultsManager")));this.Da.register(1265,"Box4.IProofingManager").ma().oa(()=>new Oq(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.ub("Box4.INotebookManager").fV,this.Da.ub("Box4.Proofing.IErrorRangeEditor"),4!==Oc.App.mode));this.Da.register(1266,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().oa(()=>new xc(u.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),Jq.a.GW(15,1,new Kq)));this.Da.register(1267,"Box4.Proofing.IProofingConfigV2Manager").ma().oa(()=>
new Nq(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),Nc.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){z.a.instance.Dc(new Ar)}}Object(m.a)(Ar,"Box4ProofingPackage",null,[2,3]);var Pj=d(175);class kg{constructor(a){this.S1e=0;this.R$a=this.TIb=this.Jkb=null;this.Maa=
u.AFrameworkApplication.Aa.gV;this.EQ=a;this.EQ.wu(jf.a.Jph);this.EQ.HB(jf.a.Jph,Object(F.a)(this,this.Awk,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.R$a)return ia.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.R$a;this.Jkb=this.Maa.Ci("ComponentAttach","getCustomAuthConfig");return this.R$a=new Promise((a,b)=>{const c={};let f=!1,l=!1,x=0;this.S1e=window.setInterval(()=>{4>x?(x++,this.EQ.sendMessage(jf.a.getCustomAuthConfig,c)):(window.clearInterval(this.S1e),
f=!0,ia.ULS.sendTraceTag(588087303,344,10,xd.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.TIb=(H,U)=>{window.clearInterval(this.S1e);f||l||(l=!0,H?(ia.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(H)):(ia.ULS.sendTraceTag(589050654,369,10,xd.c({["error"]:U.toString()})),b(U)))};this.EQ.sendMessage(jf.a.getCustomAuthConfig,c)})}Awk(a){try{const b=xd.a(a.Values[Pj.a.Hni]);let c=u.AFrameworkApplication.fa.Ga("Application")||"";c=ha.a.qg(c);
b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.Jkb&&(this.Jkb.stop(),this.Jkb=null);this.TIb(b,"")}catch(b){ia.ULS.sendTraceTag(589050655,344,10,xd.c({["error"]:b.message,["stack"]:b.stack})),
this.TIb(null,b.message)}}}Object(m.a)(kg,"AccountSwitchingManager",null,[1351]);class mt{get name(){return"Common.App.AccountSwitching"}Zb(a){a.register(kg,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().oa(()=>new kg(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){z.a.instance.Dc(new mt)}}Object(m.a)(mt,"AccountSwitchingPackage",null,[2,3]);class nt{constructor(){this.Pa=new wc.a}vGc(a){this.Pa.addHandler("OnEditHappenedEvent",
a)}GNk(){this.Pa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(nt,"EditNotificationEventSource",null,[]);var Gp=d(104);class xu{constructor(a,b,c,f,l,x,H=0){this.mAd=!1;this.lAd=this.k4a=null;this.Bqf=!1;this.Zd=b;this.oBc=a;this.GNa=c;this.mha=f;this.zqf=l;this.wQh=x;this.Txc=0;this.Ryc=!1;try{0<H&&(this.Txc=H,3E5>this.Txc&&(this.Txc=3E5),this.Zd&&!this.lAd&&(this.lAd=new af.a(3,2,this.Txc,Object(F.a)(this,this.x0k,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Zd.Db(this.lAd)))}catch(U){ia.ULS.sendTraceTag(51246176,
383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+U)}}get mHl(){return this.Bqf}J0d(){this.mHl?this.Ryc=!0:(this.Bqf=!0,kf.Health.instance.addQosPillar("Save"),kf.Health.instance.addQosPillar("ContentCreation"),Gp.c(G.a.editDocument));this.mAd=!0;this.zqf&&this.zqf.Mrf();this.mha&&this.mha.GNk();u.AFrameworkApplication.Xg&&u.AFrameworkApplication.Xg.Tjk();this.wQh&&!this.k4a&&(this.Opc(null),this.k4a=new af.a(3,2,this.oBc,Object(F.a)(this,this.Opc,
"sendPostMessageIfNecessary"),113),this.Zd.Db(this.k4a))}Opc(){this.mAd&&(this.GNa.CWR(()=>this.GNa.result.sendMessage(jf.a.editNotification,null)),ia.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.mAd=!1)}x0k(){try{this.Ryc&&(Gp.c(G.a.editDocument),this.Ryc=!1)}catch(a){this.Ryc=!1,ia.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(m.a)(xu,"EditNotificationManager",null,[1354]);
class yu{constructor(a,b,c,f,l){this.OBd=this.k4a=null;this.fob=this.Iwd=!1;this.Zd=b;this.oBc=a;this.GNa=c;this.GP=f;this.kHd=l;this.ygh(null)}ygh(){const a=document.getElementById(u.AFrameworkApplication.jZb);!this.fob&&this.GP&&a&&(this.GP.pb(ta.a.mq,a,Object(F.a)(this,this.tEe,"mouseActivityHandler"),null),this.fob=!0);this.kHd(()=>{this.dispose()})}tEe(){this.fob&&(this.GP.yb(ta.a.mq,document.getElementById(u.AFrameworkApplication.jZb),Object(F.a)(this,this.tEe,"mouseActivityHandler")),this.fob=
!1);this.Mrf();return!1}Mrf(){this.Iwd=!0;this.OBd||(this.OBd=new af.a(3,2,this.oBc,Object(F.a)(this,this.ygh,"registerHandlerTask"),112),this.Zd.Db(this.OBd));this.k4a||(this.Opc(null),this.k4a=new af.a(3,2,this.oBc,Object(F.a)(this,this.Opc,"sendPostMessageIfNecessary"),111),this.Zd.Db(this.k4a))}Opc(){this.Iwd&&(this.GNa.CWR(()=>this.GNa.result.sendMessage(jf.a.cHl,null)),ia.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Iwd=!1)}dispose(){this.fob&&
(this.GP.yb(ta.a.mq,document.getElementById(u.AFrameworkApplication.jZb),Object(F.a)(this,this.tEe,"mouseActivityHandler")),this.fob=!1)}}Object(m.a)(yu,"UserActivityHostNotificationManager",null,[1352,106]);var gm=d(133),Pq=d(291);class Hp{constructor(){this.Da=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.gf(Object(F.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){Hp.CPi&&0<Hp.K0d&&(this.Da.register(nt,"Common.App.HostNotification.EditNotificationEventSource").ma(),
this.Da.register(yu,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().oa(()=>new yu(6E4,gm.a.instance,Pq.a.$u(this.Da.Ja("Postmessage.IHostPostmessenger")),qa.a.instance,u.AFrameworkApplication.pga)),this.Da.register(xu,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().oa(()=>new xu(Hp.K0d,gm.a.instance,Pq.a.$u(this.Da.Ja("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.ub("Common.Interface.IUserActivityHostNotificationManager"),Hp.DPi,Hp.APi)),this.Da.resolve("Common.Interface.IEditNotificationManager"),ia.ULS.shipAssertTag(38086291,209,0<Hp.K0d,"EditNotification Interval is less than or equal to 0."))}Zb(a){this.Da=a}dispose(){}static get K0d(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get APi(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get CPi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get DPi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){z.a.instance.Dc(new Hp)}}Object(m.a)(Hp,"CommonHostNotificationPackage",null,[2,3]);class Wm{}Wm.Fcd="ReactSharedHeaderMeControlFlexPane";Wm.HEa="headerui";Wm.M_b="chat_wrapper_pane";Object(m.a)(Wm,"ReactSharedHeaderConstants",null,[]);class zu{constructor(a){this.vlf=
0;this.vyd=null;this.hZh=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get jXe(){return this.hZh.value}wb(){this.isInitialized?this.Mkd():this.MUk(Object(F.a)(this,this.Mkd,"registerActionsInternal"))}Mkd(){ia.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(F.a)(this,this.qrk,"onChatContainerReady"))}).catch(a=>{ia.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(F.a)(this,this.Jqi,"chatCountChanged"))}).catch(a=>{ia.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(F.a)(this,this.trk,"onChatKeyPress"))}).catch(a=>{ia.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){ia.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}Jqi(a){ia.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",a);if(!a)this.jXe.prk();else if(1===a&&!this.vlf){const b=document.getElementById(this.vyd?this.vyd:Wm.M_b);b?this.jXe.urk(b,Object(F.a)(this,this.gxl,"transferFocusToChat")):ia.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.vlf=a}qrk(a){this.vyd=a}trk(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.fxl(a.shiftKey)}MUk(a){Ne.a.instance.pb(ta.a.isl,window.self,()=>{a();return!0})}gxl(){ia.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{ia.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){ia.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}fxl(a){ia.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.jXe.rrk(a)}}Object(m.a)(zu,"ChatManager",null,[1356]);class Zv{constructor(){this.Pa=new wc.a;this.Tpf=!1}T$h(a){this.Pa.addHandler("OnTopRowControlsCreatedEvent",a)}A$h(a){this.Pa.addHandler("OnRenameTextboxStatusChangedEventKey",
a)}get zwl(){return this.Tpf}vOk(){this.Tpf=!1;this.Pa.raiseEvent("OnTopRowControlsDisposingEvent")}peh(a){this.Pa.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(m.a)(Zv,"HeaderEventSource",null,[]);var eq=d(200);class Au{constructor(a,b,c,f,l){this.PEc=null;this.Nd=a;this.vK=b;this.GP=c;this.e2h=f;this.Ca=l}xgh(a,b,c,f=null){const l=this.Nd.Fc(b);l.parent=c;l.bJ=!0;f&&l.kca(f);this.GP.J7(b,a,!1);this.e2h.J7(b,a,!1);b=new eq.DOMFocusListing(()=>a);b.Go(2);b.Go(1);b.Go(8);
b.Go(5);b.Go(3);b.Go(6);this.Nd.Tia(()=>a,l,b).nX=!0;b=y.KeyInputManager.Oa(A.a.Sq,0);c=y.KeyInputManager.Oa(A.a.Sq,4);l.zp(b);l.zp(c)}onFlexPaneOpen(a){this.xgh(a,Wm.Fcd,Wm.HEa);this.Nd.tf(Wm.Fcd);this.vK.K2(Wm.Fcd)}onFlexPaneClose(){this.vK.Ko(Wm.Fcd);this.Nd.tf(Wm.HEa)}urk(a,b){this.PEc||(this.PEc=b,this.xgh(a,Wm.M_b,E.AFrame.ND,Object(F.a)(this,this.srk,"onChatFocus")));this.Nd.tf(Wm.M_b);this.vK.K2(Wm.M_b)}srk(){this.PEc&&this.PEc()}prk(){this.vK.Ko(Wm.M_b);this.Nd.AQc(E.AFrame.yW)}rrk(a){this.Ca.processAction(a?
G.a.r2d:G.a.awd,2)}}Object(m.a)(Au,"ReactSharedHeaderFocusManager",null,[1103]);var gy=d(522);class Bu{constructor(a){this.Ca=a}wb(){this.Ca.ya(G.a.OQc,de.a.frame,Object(F.a)(this,this.k_g,"navigateToUpsellPage"));this.Ca.ya(G.a.g0i,de.a.frame,Object(F.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.ya(G.a.D0k,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.Mjh,de.a.frame,ld.ActionManager.Mg)}k_g(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.d6d(l,"experience","gopremiumribbon"),
l=bg.a.JW("2116536"),l=bg.a.a6a(l,"ocid",gy.b(u.AFrameworkApplication.Aa.hb.Uk,u.AFrameworkApplication.Aa.hb.$Ia,c)),Od.a.vn(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(G.a.Mjh,2),ia.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var x=8;2===c&&(ia.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(x=Db.a.instance.ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(a=this.d6d(l,"experience","gopremium"),l=this.d6d(l,"dimeCampaignId",null),x.launchUpsellExperience(a,l),x=32):(ia.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),x=this.k_g(a,b,c,f,l)));return x}d6d(a,b,c){a&&a[b]&&(c=Object(oa.a)(String,a[b]));return c}}Object(m.a)(Bu,"UpsellActor",null,[1349]);class Cu{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){Db.a.instance.resolve("Common.App.Header.IUpsellActor").wb();Db.a.instance.resolve("Common.App.Header.IChatManager").wb()}dispose(){}Zb(a){this.Da=
a;this.Da.register(Zv,"Common.App.Header.HeaderEventSource").ma();this.Da.register(Bu,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().oa(()=>new Bu(u.AFrameworkApplication.Ta));this.Da.register(Au,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().oa(()=>new Au(u.AFrameworkApplication.Aa.Vr,u.AFrameworkApplication.Aa.Mw,u.AFrameworkApplication.Aa.TR,u.AFrameworkApplication.Aa.jlb,u.AFrameworkApplication.Ta));this.Da.register(zu,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().oa(()=>new zu(this.Da.ie("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){z.a.instance.Dc(new Cu)}}Object(m.a)(Cu,"CommonAppHeaderPackage",null,[2,3]);class $v{constructor(a,b,c,f=null,l=null){this.mF=a;this.RSb=b;this.OSb=c;this.mlf=f;this.LVb=l}$Oc(a){const b=new Sys.StringBuilder(this.mF.epc);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.o9d(a));
b.append("&");b.append(u.AFrameworkApplication.gh);u.AFrameworkApplication.Ke.mj(b.toString(),1,null,null,!0,2,Object(F.a)(this,this.mEa,"getRequestSuccessCallback"),Object(F.a)(this,this.ika,"getRequestFailureCallback"),null)}nvb(a){var b=new Sys.StringBuilder(this.mF.epc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(u.AFrameworkApplication.gh);b=b.toString();a=xd.c(a);u.AFrameworkApplication.Ke.mj(b,2,a,null,!0,4,Object(F.a)(this,
this.wGk,"postRequestSuccessCallback"),Object(F.a)(this,this.jaa,"postRequestFailureCallback"),null)}mEa(a){let b=!1,c=null;try{if(0<a.data.Sd.length){const f=Object(oa.a)(Object,xd.a(a.data.Sd)),l=f?f[this.mF.yQd]:null;l&&(c=Object(oa.a)(Object,xd.a(l.toString())))}b=!0}catch(f){this.ika(null)}b&&this.RSb&&this.RSb(a.data,c)}ika(a){this.OSb&&this.OSb(a?a.data:null)}wGk(a){this.mlf&&this.mlf(a?a.data:null)}jaa(a){this.LVb&&this.LVb(a?a.data:null)}o9d(a){const b=new Sys.StringBuilder("requestedsettings=");
for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(m.a)($v,"FirstRunExperienceRequestHandler",null,[]);var Du=d(403);class aw{constructor(){this.xSb=this.wyc=this.mF=null}sYe(a){a?(this.mF=a,this.PPj()&&(ia.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Ka.a,a.add(this.mF.yQd),this.wyc=new $v(this.mF,Object(F.a)(this,this.mEa,"getRequestSuccessCallback"),Object(F.a)(this,this.ika,
"getRequestFailureCallback"),null,Object(F.a)(this,this.jaa,"postRequestFailureCallback")),this.wyc.$Oc(a)),(this.mF.eng||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.tYe()):ia.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}PPj(){try{if(this.mF.eng)return!0;if(!u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||u.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;
if(this.mF.GLj||this.mF.wAb||u.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=u.AFrameworkApplication.fa.Ga("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){ia.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",a?a.toString():null)}return!1}snh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.mF.yQd]=xd.c(c);ia.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.wyc&&this.wyc.nvb(b)}mEa(a,b){a=a?+a.pv-+a.Xt:-1;a>this.mF.Slh?ia.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",a,this.mF.Slh):b?this.Qjl(b)?(ia.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.mF.UYg),this.tYe()):(this.P_d(!1),
ia.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ia.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.tYe())}ika(a){this.P_d(!1);ia.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.oe:-1)}jaa(a){ia.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
a?a.oe:-1)}tYe(){this.P_d(!0);var a=Db.a.instance.ub("Common.ISystemInitiatedFeedback");a?this.pvh(a):(ia.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((a=Db.a.instance.Ja("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.pvh(b)}):ia.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}pvh(a){if(a){var b=this.mF.CZi;
b&&(u.AFrameworkApplication.hk(b),u.AFrameworkApplication.obc(b));ia.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.xSb=Object(F.a)(this,this.ftk,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.xSb,!0),window.addEventListener("FRELaunchedEvent",this.xSb,!0)):(ia.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.snh(this.mF.currentVersion))}else ia.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}ftk(a){if(a){var b=a.detail;a=a.type;var c=this.mF&&this.mF.ECf?this.mF.ECf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(ia.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.snh(this.mF.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.xSb,!0),window.removeEventListener("FRELaunchedEvent",
this.xSb,!0))}}Qjl(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.mF.UYg)return!0}else if(u.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in a&&a.VersionDisplayed<this.mF.currentVersion)return ia.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}P_d(a){u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
Du.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(m.a)(aw,"FirstRunExperienceLauncher",null,[1326]);class Eu{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Zb(a){this.Da=a;this.Da.register(1326,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().oa(()=>new aw)}init(){}dispose(){}static main(){z.a.instance.Dc(new Eu)}}Object(m.a)(Eu,"FirstRunExperienceLauncherPackage",null,[2,3]);class ot{constructor(){this.Fwd={}}e4h(a){this.Fwd[a.id.toString()]=
a}Vok(a){const b=this.Fwd;for(let c in b)b[c].notify(a,!1);this.Fwd={}}RLk(a,b){b&&this.e4h(b);return this.v5g(a,b)}R0d(a){this.Vok(a)}eRf(a,b){a.notify(b,!0)}}Object(m.a)(ot,"AEventEmitter",null,[1348]);var ls;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(ls||(ls={}));Object(m.b)("EventResultState",ls);class ms{constructor(){this._state=0}get state(){return this._state}set state(a){ia.ULS.sendTraceTag(5849616,202,
50,"Changing event result state. {0}",{["OldState"]:ls[this._state],["NewState"]:ls[a]},"ResultType",this.M5f());this._state=a}}Object(m.a)(ms,"AEventResult",null,[1388]);class bw extends ms{constructor(){super();this.sLd=this.HVb=null;this.state=0;this.UCd=this.fef=!1}get AR(){return this.HVb}get zLa(){return this.sLd}get eHj(){return this.fef}M5f(){return"GetMoreInfo Result"}}Object(m.a)(bw,"GetMoreInfoResult",ms,[1387,1388]);var Fu=d(438),cw=d(523);class lp{constructor(a,b,c,f,l,x,H,U){this.Ca=
a;this.Xh=b;this.WH=c;this.Vga=f;this.Zd=l;this.NSb=x;this.tSh=H;this.gEc=U}ATk(){this.AGb.ya(G.a.CHb,de.a.frame,Object(F.a)(this,this.CHb,"openUrlInNewTab"));this.AGb.ya(G.a.gJe,de.a.frame,Object(F.a)(this,this.gJe,"openDocumentUrl"));u.AFrameworkApplication.Pca?this.Fqg():this.AGb.ra(G.a.ONc,de.a.frame,Object(F.a)(this,this.ONc,"documentLoaded"),96)}CHb(a,b,c,f,l){l&&l.MenuItemId&&(ia.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:cw.a[this.Wwa]}),Od.a.vn(l.MenuItemId.toString(),
"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}gJe(a,b,c,f,l){if(l&&l.MenuItemId){const x=u.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),H=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");ia.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",x,H);if(x&&H){ia.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:cw.a[this.Wwa]});a=l.MenuItemId.toString();
const U={};U[Pj.a.PJb]="1";U[Pj.a.documentUrl]=a;U[Pj.a.reason]=Fu.a.open;ia.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.kT().execute(ja=>{ja.sendMessage(jf.a.lDa,U)})}else this.CHb(a,b,c,f,l)}return 32}ONc(){this.Fqg();return 32}Sbb(a,b,c=""){if(b&&b.Xt){const f=Ql.a[b.status];b=b.Xt.getTime();const l=this.EF()-b;ia.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,
["StartTime"]:b,["Notes"]:c})}else ia.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}Fqg(){var a=u.AFrameworkApplication.fa.ka("QPGVCI"),b=bg.a.hT(document.URL,"wdNewAndOpenCt",a);if(b){b=parseInt(b);var c=bg.a.hT(document.URL,"wdPreviousSession",a);a=bg.a.hT(document.URL,"wdPreviousCorrelation",a);var f=u.AFrameworkApplication.fa.ka("NAOPLP");if(u.AFrameworkApplication.Pca){var l=u.AFrameworkApplication.Pca.getTime();!b||
b>l?ia.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):ia.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else ia.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get AGb(){return this.Ca.value}get rjc(){return this.Xh.value}get r_g(){return this.WH.value}get Wwa(){return this.Vga.value}get wdd(){return this.Zd.value}get EF(){return this.NSb}get lna(){return this.tSh.value}get ALa(){return this.gEc.value}static get instance(){return lp.Ka||(lp.Ka=lp.xr())}static xr(){return new lp(new mc.a(()=>u.AFrameworkApplication.Ta),new mc.a(()=>u.AFrameworkApplication.Ke),new mc.a(()=>u.AFrameworkApplication.Aa),
new mc.a(()=>u.AFrameworkApplication.Aa.hb.Uk),new mc.a(()=>u.AFrameworkApplication.ye),()=>(new Date).getTime(),new mc.a(()=>u.AFrameworkApplication.Aa.hb.lna),new mc.a(()=>u.AFrameworkApplication.ALa))}}lp.Ka=null;Object(m.a)(lp,"NewAndOpenCommonHelpers",null,[1347]);class dw{constructor(a,b,c){this.BDc=this.Um=null;this.zJd=0;this.w_h=a;this.Zd=b;this.A$e=c}Bci(){this.zJd=this.JKb+1}sSe(a){this.Um&&(this.Zd.Lg(this.Um),this.Um=null);a&&(this.zJd=0)}dql(a){const b=this.Cvl;0<=b?(this.Bci(),this.sSe(!1),
this.Um=new af.a(4,1,b,a,107),this.Zd.Db(this.Um)):(this.sSe(!0),ia.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.A$e}))}get JKb(){return this.zJd}get Cvl(){return this.JKb>=this.bph.length?-1:this.bph[this.JKb]}get bph(){if(!this.BDc){const a=(this.w_h.value||"0").split(",");this.BDc=[];for(let b=0;b<a.length;b++){const c=parseInt(a[b]);isNaN(c)?ia.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.A$e,["Entry"]:a[b]}):
Array.add(this.BDc,c)}}return this.BDc}}Object(m.a)(dw,"RetryHelper",null,[]);class um extends ot{constructor(a,b){super();this.Lha=a;this.kWb=new dw(b,this.Xic.wdd,"GetMoreInfo");this.Vx=new bw}tjk(){this.wDe("Document opened")}EEi(a){return()=>{this.wDe(a,!0)}}v5g(a,b=null){ia.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.Vx.state?(b&&this.eRf(b,this.Vx),ia.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):
this.wDe(a);return this.Vx}wDe(a,b=!1){this.kWb.sSe(!b);1===this.Vx.state?ia.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.kWb.JKb}):(ia.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.kWb.JKb}),this.Vx.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Xic.lna,u.AFrameworkApplication.gh),this.Xic.rjc.ZV(b,1,null,null,[um.alf,um.dpf],5,this.IDi(),this.HDi(a),
null))}IDi(){return a=>{var b=!1;let c=!1;var f=!1,l;u.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.Sd?({rv:l}=xd.d(a.data.Sd)).returnValue?l?(f=!0,this.Vx.sLd=l.StorageServiceDisplayName,this.Vx.HVb=um.Jng(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.Vx.AR&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ga("FileSource")&&(this.Vx.HVb=bg.a.boa(u.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.Vx.AR&&""!==this.Vx.zLa):ia.ULS.sendTraceTag(25298113,
202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):ia.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):ia.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));f||((l=a.data.sj)?(this.Vx.sLd=(l[um.dpf]||"").toString(),b=(l[um.alf]||"").toString(),
this.Vx.HVb=um.Jng(b)?b:"",""===this.Vx.AR&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ga("FileSource")?(this.Vx.HVb=bg.a.boa(u.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.Vx.AR&&""!==this.Vx.zLa):b=""===b&&""!==this.Vx.zLa):(ia.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.kWb.JKb,c,b,f);this.Xic.Sbb("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",
a.data,f);this.oph(3,b,c)}}HDi(a){return b=>{this.Xic.Sbb("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.oph(2);this.kWb.dql(this.EEi(a))}}oph(a,b=!1,c=!1){this.Vx.state=a;this.Vx.fef=b;this.Vx.UCd=c;this.R0d(this.Vx)}get Xic(){return this.Lha.value}static get instance(){return um.Ka||(um.Ka=um.xr())}static xr(){return new um(new mc.a(()=>lp.instance),new mc.a(()=>u.AFrameworkApplication.fdj))}static Jng(a){if(!a)return ia.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),
!1;if(ha.a.qg(a).startsWith("https://"))return!0;ia.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}um.alf="PersonalFileStorageUrl";um.dpf="StorageServiceDisplayName";um.Ka=null;Object(m.a)(um,"GetMoreInfoActor",ot,[]);class mp{constructor(a,b,c,f,l){this.WSh=6E4;this.Bdg="inactive";this.Erf="active";this.Fha=!0;this.Zd=a;this.WRh=b;this.NSb=c;this.IEc=f;this.Pa=new wc.a;l&&this.Wpl();this.Ggf=this.h3f()}Urf(a){this.Pa.addHandler(this.Erf,a)}y6h(a){this.Pa.addHandler(this.Bdg,
a)}Wpl(){const a=new af.a(5,2,this.WSh,Object(F.a)(this,this.aCj,"inactiveLoop"),108);this.bCj.Db(a)}aCj(){const a=this.h3f(),b=this.EF()-a;b>this.Ssd&&this.Fha&&(ia.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.Fha=!1,this.Pa.raiseEvent(this.Bdg));a-this.Ggf>this.Ssd&&(this.Fha=!0,this.Pa.raiseEvent(this.Erf));this.Ggf=a}get bCj(){return this.Zd.value}get h3f(){return this.WRh}get EF(){return this.NSb}get Ssd(){return this.IEc.value}static get instance(){return mp.Ka||
(mp.Ka=mp.xr())}static xr(){return new mp(new mc.a(()=>gm.a.instance),()=>u.AFrameworkApplication.rne.getTime(),()=>(new Date).getTime(),new mc.a(()=>u.AFrameworkApplication.Ssd),!0)}}mp.Ka=null;Object(m.a)(mp,"InactivityManager",null,[]);var ns=d(917);class ew extends ms{constructor(){super();this.CWh=this.Xif=this.Wif=null;this.state=this.Ppf=0;this.UCd=!1}get ZEe(){return this.Wif}get RZg(){return this.Xif}get Fvl(){return this.Ppf}M5f(){return"MruActor Result"}}Object(m.a)(ew,"MruResult",ms,[1389,
1388]);class Gu{constructor(a,b,c){this.task=null;this.eab=a;this.alk=b;this.taskManager=c;this.retryCount=this.W8b=0;this.zId=this.Jac=null}ERj(a,b){return a===dl.a.t4d||20===b||18===b||3===b}gTj(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get Iid(){return this.zId}reset(){this.W8b=this.retryCount=0;this.zId=this.Jac=null;this.task&&(this.taskManager.Lg(this.task),this.task=null)}SFj(a,b,c,f){this.zId=String.format("{0}_{1}",
c,f);if(this.retryCount>=this.alk)return ia.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.ERj(c,f))return ia.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.gTj(f)&&1<=this.W8b)return this.Jac=c,!1;b=Math.max(b,this.eab*Math.pow(2,this.W8b));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.Jac||412!==this.Jac)?b=500:this.W8b+=1;this.Jac=c;this.retryCount+=1;this.task&&this.taskManager.Lg(this.task);
ia.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new af.a(2,1,b,a,107);this.taskManager.Db(this.task);return!0}}Object(m.a)(Gu,"RetryManager",null,[]);var Yn=d(221),Pg=d(71);class fw{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(fw,"WriteOptions",null,[]);class qn extends ot{constructor(a,b,c,f,l,x,H){super();this.Lha=a;this.JVh=b;this.POa=new Gu(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.VO.wdd);this.tPa=new Gu(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.VO.wdd);this.lZh=c;this.frf=f;this.y3h={};this.n7=new ew;this.SRh=l;this.fBc="";this.fF=x;this.Taf=H}get Svd(){return this.y3h}HVk(){this.VO.AGb.ya(G.a.ajh,de.a.frame,
Object(F.a)(this,this.g_k,"renameMruEntry"))}g_k(){return this.u6e("Rename")}Bjk(){this.BXg("File Opened")}Cjk(){this.BXg("IntervalUpdate")}BXg(a){ia.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.u6e(a)}fT(a){(a=ha.a.fT(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}BZf(){switch(this.VO.Wwa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Jnj(a){var b=this.SRh();
if(!b)return null;const c=new fw;c.documentUrl=this.Taf.value?encodeURI(b):b;c.mruItemId=this.fBc;c.app=this.BZf();if(b=this.fF())c.folderName=b.breadcrumbFolderName,b=b.Xw,c.documentName=ha.a.XG(b),c.documentExt=this.fT(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}u6e(a,b=!1){if(4===
this.VO.Wwa&&!u.AFrameworkApplication.MNc)return 2;var c=Yn.a.Rz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.fBc?"true":"false"),c.set("URLEncoded",this.Taf.value?"true":"false"));kf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.Jnj(c);if(!a)return b=!u.AFrameworkApplication.fmb,c&&(c.set("WebEditingIsEnabled",u.AFrameworkApplication.fmb?"true":"false"),c.set("ProtectedFile",u.AFrameworkApplication.yM?"true":"false")),kf.Health.instance.recordKpiFailure("WriteMru",
"MissingDocumentUrl",b,!1,Object.assign(new Oj.a,{extendedProperties:c})),2;this.tPa&&!b&&this.tPa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.VO.lna,this.Ypg);this.frf?this.Svd["X-FileId"]=u.AFrameworkApplication.gh:c+=String.format("&{0}",u.AFrameworkApplication.gh);u.AFrameworkApplication.gd&&(this.Svd["X-Office-AudienceGroup"]=Object(oa.a)(String,u.AFrameworkApplication.gd.AudienceGroup)||"");this.Svd["X-Timeout"]=15E3;return this.VO.rjc.mj(c,2,a,this.Svd,!0,5,Object(F.a)(this,
this.OKl,"writeMruV2EntryOnServerSuccessCallback"),Object(F.a)(this,this.bIi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}OKl(a){this.J$f(a.data)}J$f(a){const b=Yn.a.Rz();this.tPa&&(b&&this.tPa.Iid&&(b.set("LastError",this.tPa.Iid),b.set("NumRetries",this.tPa.retryCount.toString())),this.tPa.reset());const c=ns.c(a.Sd);c&&c.diagnostics_data&&(this.fBc=c.diagnostics_data.mru_id);a=+a.pv-+a.Xt;b&&b.set("RequestDuration",a.toString());kf.Health.instance.recordKpiSuccess("WriteMru",
Object.assign(new Oj.a,{extendedProperties:b}))}bIi(a){if(a.data.oe===dl.a.G1b)this.J$f(a.data);else{var b=a.data.oe===dl.a.umc,c=Yn.a.Rz();this.fag(this.tPa,a,this.QHi(),c);c&&(c.set("StatusCode",a.data.oe.toString()),b||this.nOd(a.data,c));kf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.oe),b,!1,Object.assign(new Oj.a,{extendedProperties:c}))}}QHi(){return()=>{this.u6e("Retry",!0)}}ldj(){this.lcd("Polling")}kdj(){this.lcd("Retry",!0)}vjk(){this.lcd("Open")}ujk(){this.lcd("Activity")}lcd(a,
b=!1){ia.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const c=Yn.a.Rz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"));kf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",c);this.POa&&!b&&this.POa.reset();this.JDi(Object(F.a)(this,this.ndj,"getMruV2FromServerSuccessCallback"),Object(F.a)(this,this.jdj,"getMruFromServerFailureCallback"))}nOd(a,b){a&&a.sj&&(a=a.sj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}y2j(a,b){a&&(b&&b.set("RequestDuration",
(+a.pv-+a.Xt).toString()),kf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Oj.a,{extendedProperties:b})))}ndj(a){this.odj(a)}odj(a){var b="";let c=null,f=null,l=null;const x=ns.c(a.data.Sd);x&&(c=x.places?x.places.items:[],f=x.documents?x.documents.items:[],(l=ns.a(x,!1))&&(b=xd.c(l)));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.EFa&&Pg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0));b=Yn.a.Rz();this.POa&&(b&&this.POa.Iid&&(b.set("LastError",this.POa.Iid),
b.set("NumRetries",this.POa.retryCount.toString())),this.POa.reset());l||c||f?(this.VO.Sbb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.Fud(3,l,c,f),this.y2j(a.data,b)):(this.VO.Sbb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),b&&this.nOd(a.data,b),kf.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Oj.a,{extendedProperties:b})),this.Fud(3,null,null,null,!0));this.R0d(this.n7)}fag(a,b,c,f){let l=0,x=0;const H=
ns.c(b.data.Sd);H&&(null!=H.response_code&&(l=H.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.fBc="")),H.error_data&&null!=H.error_data.retry_after_ms&&(x=H.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",x.toString())));a&&(b=a.SFj(c,x,b.data.oe,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}jdj(a){this.mdj(a)}mdj(a){const b=a.data.oe===dl.a.umc,c=Yn.a.Rz();c&&(c.set("StatusCode",a.data.oe.toString()),b||this.nOd(a.data,
c));this.VO.Sbb("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.Fud(2);this.fag(this.POa,a,Object(F.a)(this,this.kdj,"getMruFromServerRetryTask"),c);kf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.oe),b,!1,Object.assign(new Oj.a,{extendedProperties:c}));this.R0d(this.n7);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.EFa&&Pg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}Fud(a,b=null,c=null,f=null,l=!1){if(3!==this.n7.state||3===a)this.n7.Wif=b,this.n7.Xif=c,this.n7.CWh=f,this.n7.state=a,this.n7.UCd=l,this.n7.Ppf=this.VO.EF()}v5g(a,b){ia.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.n7.state});b&&3===this.n7.state&&this.eRf(b,this.n7);return this.n7}JDi(a,b){this.Fud(1);let c;const f={};c=String.format(this.VO.lna+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.BZf(),this.Ypg);this.lZh.value||
(c+="&entity=docs");u.AFrameworkApplication.gd&&(f["X-Office-AudienceGroup"]=Object(oa.a)(String,u.AFrameworkApplication.gd.AudienceGroup)||"");this.frf?f["X-FileId"]=u.AFrameworkApplication.gh:c+=String.format("&{0}",u.AFrameworkApplication.gh);this.VO.rjc.mj(c,1,null,f,!0,5,a,b,null)}get VO(){return this.Lha.value}get Ypg(){return this.JVh.value}static get instance(){return qn.Ka||(qn.Ka=qn.xr())}static xr(){return new qn(new mc.a(()=>lp.instance),new mc.a(()=>Ya.a.xe(u.AFrameworkApplication.lcid).name),
new mc.a(()=>u.AFrameworkApplication.Aa.hb.GC),u.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.Aa.hb.zca,()=>u.AFrameworkApplication.Eu,new mc.a(()=>u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}qn.Ka=null;Object(m.a)(qn,"MruActor",ot,[]);class gw{constructor(){this.NXb=this.Ylf=this.Da=null;this.oo=!1}get name(){return"Common.App.NewAndOpen.Core"}Zb(a){this.Da=a;a.register(1347,"Common.INewAndOpenCommonHelpers").ma().oa(()=>lp.instance);a.register(1348,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().oa(()=>um.instance);a.register(1348,"Common.IEventEmitter<Common.IMruResult>").ma().oa(()=>qn.instance)}init(){u.AFrameworkApplication.fa.gf(()=>{this.PEa()})}PEa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;lp.instance.ATk();u.AFrameworkApplication.Xwa&&(a=!0);u.AFrameworkApplication.rPe&&(qn.instance.vjk(),
0<u.AFrameworkApplication.SZg&&this.Esf(),this.Gfl(),a=!0);u.AFrameworkApplication.ALa&&a&&um.instance.tjk();u.AFrameworkApplication.xEl&&(a=qn.instance,a.HVk(),a.Bjk(),gm.a.instance.Db(this.yEl))}Gfl(){mp.instance.Urf(Object(F.a)(qn.instance,qn.instance.ujk,"makeGetMruRequestActivityTrigger"));mp.instance.Urf(Object(F.a)(this,this.Esf,"addGetMruFromServerTask"));mp.instance.y6h(Object(F.a)(this,this.GKi,"deleteGetMruFromServerTask"))}GKi(){gm.a.instance.Lg(this.TZg)}Esf(){gm.a.instance.Db(this.TZg)}get TZg(){return this.Ylf||
(this.Ylf=new af.a(5,2,u.AFrameworkApplication.SZg,Object(F.a)(qn.instance,qn.instance.ldj,"getMruFromServerTask"),109))}get yEl(){return this.NXb||(this.NXb=new af.a(2,2,6E4*u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(F.a)(qn.instance,qn.instance.Cjk,"makeUpdateMruTask"),197))}dispose(){this.oo||(this.oo=!0,this.NXb&&(gm.a.instance.Lg(this.NXb),this.NXb=null))}}Object(m.a)(gw,"CorePackageManager",null,[2,3,106]);var Qi=d(124);
class hy{constructor(a,b,c,f,l,x,H,U,ja,ya){this.KGg=new Ka.a;this.XSg=null;this.Vb=f;this.ua=l;this.Ea=c;this.Zua=H;this.xla=U;this.hA=x;this.pa=b;this.la=ja;this.Nq=a;this.qd=ya;this.la.GTj&&(this.pa&&this.pa.wF(Object(F.a)(this,this.EH,"onSelectionChanged")),U&&U.GUk(this),this.Nq.sGc(Object(F.a)(this,this.AU,"onFocusChanged")),this.qd.Wuf(Object(F.a)(this,this.ykc,"onShapeViewElementUnlocked")),this.qd.hbi(Object(F.a)(this,this.V6g,"onThumbnailsSetFakeImage")),this.qd.ibi(Object(F.a)(this,this.W6g,
"onThumbnailsSetFocus")),this.qd.jbi(Object(F.a)(this,this.X6g,"onThumbnailsSetSelected")),this.la.yZc&&this.Nq.R$h(Object(F.a)(this,this.q6g,"onSlideshowNavigationToolbarClickedHandler")),this.la.vg&&this.Nq.Q$h(Object(F.a)(this,this.o6g,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Nq.mld(Object(F.a)(this,this.AU,"onFocusChanged"));this.Nq.VXk(Object(F.a)(this,this.osk,"onDesignerClickSuggestion"));this.qd.Uih(Object(F.a)(this,this.ykc,"onShapeViewElementUnlocked"));this.qd.YZk(Object(F.a)(this,
this.V6g,"onThumbnailsSetFakeImage"));this.qd.ZZk(Object(F.a)(this,this.W6g,"onThumbnailsSetFocus"));this.qd.$Zk(Object(F.a)(this,this.X6g,"onThumbnailsSetSelected"));this.la.yZc&&this.Nq.iZk(Object(F.a)(this,this.q6g,"onSlideshowNavigationToolbarClickedHandler"));this.la.vg&&this.Nq.hZk(Object(F.a)(this,this.o6g,"onSlideshowContextMenuFocusedHandler"))}EH(a,b){if(b&&b.ll&&this.pa.K_(b.ll))try{this.Tvj(b.ll)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),xa.a.J(17367906,822,10,a)}}Tvj(a){var b=this.pa.tg();if(1===a.length||1===b.length&&b[0].Ng){if(a=this.pa.Jp()){b=new Ka.a;let c=this.u5f(a,b,Object(F.a)(this,this.Vij,"getShapeName"));c||b.count||(c=this.xla.q6f(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:ha.a.Wa(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.xla.cjj(a);({eyf:c,G6e:b}=this.ywf(f,c,b));!a.As&&a.isUnread&&({eyf:c,G6e:b}=this.ywf(this.xla.djj(a,this.XSg),c,b));0<b.count?
this.mfh(b):this.Nfa(c||"")}}else 1<a.length&&(a=this.xla.qdj(this.pa.Wd()),this.Nfa(a||""))}ywf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{eyf:b,G6e:c}}AU(a,b){b=b.vgb;if(b===Qi.a.PD||b===zb.a.sg){a=this.ua.Ba;let c=null;b===Qi.a.PD?c=(a=this.Vb.htc.Zda)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.T9a()+this.xla.U$d(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.T9a()):b!==zb.a.sg||
!this.pa.Bs()&&this.pa.V3()||(this.hA&&this.hA.value&&(b=this.hA.value.Pd)&&a&&b.lp&&Kj.e(a,b.Ma),c=this.xla.Fjj());this.Nfa(c||"")}}setAttribute(a,b,c){a&&Cc.a.eP(a,b,c)}S5(a){this.KGg.add(a)}u5f(a,b,c=null){try{if(a&&this.Ea)for(let f of this.KGg)if(f){const l=f(a,this.Ea.Ae?this.Ea.Ae.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),xa.a.J(17662480,822,10,a)}return null}mfh(a){if(this.Zua&&
this.Zua.value){const b=this.Zua.value.acj();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}pfh(a,b){if(a){const c=new Ka.a;let f=this.u5f(a,c);f||c.count||(f=this.xla.q6f(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.mfh(c)):(b&&(f+=" "+b),this.Nfa(f||""))}}Nfa(a){this.Zua&&this.Zua.value&&this.Zua.value.sendNotification(a,!0)}ykc(a,b){b.presenceUser&&b.OTj&&this.Nfa(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}osk(a,b){this.Nfa(this.xla.V7i(b.j7k,b.Krl))}V6g(a,b){this.setAttribute(b.A6.image,Cc.a.ef,Cc.a.WPa)}W6g(a,b){b.hasFocus&&b.A6.isSelected&&this.Nfa(this.T9a()+this.xla.U$d(b.A6));this.setAttribute(b.A6.llb,Cc.a.t6a,b.hasFocus&&b.A6.isSelected?"true":"false")}X6g(a,b){b.A6.isSelected&&b.hasFocus?this.Nfa(this.T9a()+this.xla.U$d(b.A6)):b.A6.isSelected||this.Nfa(this.T9a());this.setAttribute(b.A6.llb,Cc.a.t6a,b.A6.isSelected?"true":"false")}q6g(a,b){this.Nfa(b.text)}Vij(a){this.XSg=
a||ResourceStrings.l_Object}o6g(a,b){this.Nfa(b.text)}T9a(){let a="";const b=this.pa.Qe();b&&1<b.length&&(b.sort((c,f)=>c.le-f.le),this.Prb(b)&&(a=this.xla.T9a(b[0].le+1,b[b.length-1].le+1)));return a}Prb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].le-a[0].le+1===b?!0:!1}}Object(m.a)(hy,"AriaManager",null,[1261,106]);var os=d(918);class Hu{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Zb(a){this.K=a;this.K.register(1046,"PowerPointWebEditor.IAriaMessageHelper").ma().oa(()=>
new os.a(this.K.Ja("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ja("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.K.ie("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1261,
"PowerPointWebEditor.IAriaManager").ma().oa(()=>new hy(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.ie("Box4.IInteractiveViewManager"),this.K.ie("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){z.a.instance.Dc(new Hu)}}Object(m.a)(Hu,"PptAriaPackage",null,[2,3]);var hw=d(1038);class ps{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=ps.nQi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}ps.nQi=[];Object(m.a)(ps,"Critique",null,[]);class iy{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(iy,"Suggestion",null,[]);class Iu{uIf(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new ps,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.EAi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.kAi(c.supportedActions)),c.suggestions&&(a.Suggestions=this.DAi(c.suggestions)),b.push(a);return b}DAi(a){if(!a)return null;const b=[];for(const c of a)(a=this.BAi(c))&&b.push(a);return b}BAi(a){if(!a)return null;
const b=Object.assign(new iy,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.jAi(a.confidenceLevel)});a.actions&&(b.Action=this.CAi(a.actions));return b}jAi(a){return 1===a?0:2===a?1:2}CAi(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}EAi(a){return a.consistency?1:0}kAi(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(m.a)(Iu,"CloudALResponseTransformer",null,[1462]);var ug=d(84),Ju=d(525);class iw{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.Vva=a;this.eeb=b;this.ZSg=c;this.ua=f;this.Jb=l;this.ia=x;this.jc=U;this.Yl=ja;this.Hh=ya;this.Oc=H;this.lA=Va;this.Vva.TBa(Object(F.a)(this,this.eJa,"onBeforeParagraphDisconnect"));this.Vva.jk(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.p9h(Object(F.a)(this,this.b4g,"onLanguageOnRangeChanged"));
this.eeb.TBa(Object(F.a)(this,this.O1g,"onBeforeNumberListDisconnect"));this.eeb.jk(Object(F.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.ZSg.vF(Object(F.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ua.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new Ju.a,{slideId:b.Cb});this.ia.La(K.a.WZa,2,c);return 0<c.Frc?(xa.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.Khe(this.ua.Ba)}dispose(){this.Vva.rKa(Object(F.a)(this,this.eJa,"onBeforeParagraphDisconnect"));this.Vva.Cm(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Oc.jYk(Object(F.a)(this,this.b4g,"onLanguageOnRangeChanged"));this.eeb.rKa(Object(F.a)(this,this.O1g,"onBeforeNumberListDisconnect"));this.eeb.Cm(Object(F.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.ZSg.bP(Object(F.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}eJa(a,b){this.Rtc(Object(oa.a)(Mb.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==$a.a.pq&&b.property!==ab.a.listLevel||this.Rtc(Object(oa.a)(Mb.AParagraphNode,b.node),!1)}b4g(a,b){this.Rtc(b.paragraphNode,!0)}O1g(a,b){b.node&&Object(Xa.a)(ug.a,b.node)&&this.Rtc(this.lA.c8d(Object(oa.a)(ug.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Xa.a)(ug.a,b.node)&&b.node.isConnected&&b.property===$a.a.Ri&&this.Rtc(this.lA.c8d(Object(oa.a)(ug.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(oa.a)(4,b.node))a=this.jc.kg(a),this.Khe(a)}Rtc(a,b){!this.Ohl(a)||b&&this.Hxj(a)||(a=Object(oa.a)(116,this.jc.kg(a)),this.Khe(a))}Khe(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Jb.me(7,D.a.b5e);b.nc(a);a.isSlideCritiqueReady=!1;b.dispose()}}Ohl(a){return!!a&&a.isConnected&&this.Hh.$d(a)&&!this.Yl.Nka(a)&&!a.sa(kb.a.zT,!1)}Hxj(a){a=a.sa($a.a.pq,"");return!a||!a.length}}Object(m.a)(iw,"ConsistencyCheckManager",null,[1258,106]);
var Wl=d(161),Ip=d(524);class Jp{constructor(){this.d=this.p=this.w=null}}Object(m.a)(Jp,"ProofingDashboardTraceMetrics",null,[]);class Lk{}Lk.$me="bs";Lk.e1c="bd";Lk.uJh="was";Lk.vJh="wad";Lk.eTj="rm";Lk.HKl="wd";Lk.uJl="ad";Lk.H2k="rs";Object(m.a)(Lk,"TelemetryFieldNames",null,[]);class vm{}vm.rvl="tcw";vm.Psd="tcc";vm.wog="bs";vm.CYj="bd";vm.vog="bpc";vm.KXg="md";Object(m.a)(vm,"TelemetryValues",null,[]);class Br{constructor(){this.wn=this.i=null}}Object(m.a)(Br,"Workflow",null,[]);class jw{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb){this.ua=a;this.NC=b;this.jAe=c;this.Jb=f;this.L7j=l;this.GQg=x;this.r$=H;this.Fa=U;this.Yl=ja;this.Ha=ya;this.yqe=Va;this.t$=hb}initialize(){this.r$.execute(a=>{a.addEventHandler(Ip.a.Jyf,Object(F.a)(this,this.Fqj,"handleAugResults"));this.Ha.pptAugmentationLoopCloudALEnabled&&a.addEventHandler(Ip.a.GVd,Object(F.a)(this,this.irj,"handleCloudALResults"))})}Fqj(a,b,c,f){xa.a.J(36962498,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,
(new Date).getTime().toString());var l=this.HZf(b.Content);c=this.H8i(f.Payload);if(l&&c){var x=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopCloudALEnabled||this.Ha.pptAugmentationLoopShadowCloudALEnabled)this.LXg(c.Critiques,l),x=!0;l=(new Date).getTime();if(f=this.t$.e_d(f.DashboardTelemetry))try{const H={};H[Lk.H2k]=c.ResponseStatus;H[Lk.eTj]=x;H[Lk.HKl]=l-f.d[Lk.$me];H[Lk.uJl]=f.d[Lk.vJh]-f.d[Lk.uJh];f.d=H;f.p=vm.KXg;this.t$.track(f)}catch(H){xa.a.J(37487777,
375,15,"trace metrics exception {0}",H.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());xa.a.J(36702229,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",x,b.Id,c.Critiques?c.Critiques.length:0,a)}else xa.a.J(36577357,375,10,c?"Aug slide is null":"Result is null")}}irj(a,b,c,f){xa.a.J(36962502,375,50,"Handle Cloud AL results");c=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&xa.a.J(37057568,375,15,"Get partial success response");a=String.format("MarkStart:{0}",c.toString());
var l=this.HZf(b.Content);if(l){var x=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopShadowCloudALEnabled)x=this.yqe.uIf(f.critiques),this.LXg(x,l),x=!0;l=(new Date).getTime();c=Object.assign(new Jp,{w:Object.assign(new Br,{wn:vm.Psd,i:b.Id}),p:vm.KXg,d:{["ms"]:c,["md"]:l,["rm"]:x,["rs"]:f.partialSuccess?1:0}});this.t$.track(c);a=String.format("{0}, MarkDone:{1}",a,l.toString());xa.a.J(36783304,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",
x,b.Id,f.critiques?f.critiques.length:0,a)}else xa.a.J(36783302,375,10,"Aug slide is null")}}HZf(a){let b=null;try{b=xd.a(a)}catch(c){return xa.a.J(36577355,375,10,"Try parse aug slide failed"),null}return b}H8i(a){let b=null;try{b=xd.a(a)}catch(c){return xa.a.J(36525519,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return xa.a.J(38545173,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return xa.a.J(36525521,
375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&xa.a.J(37057603,375,15,"Get partial success response");return b}LXg(a,b){try{const H=this.ua.Ba;if(!this.ljl(b,H)){var c=this.I4f(a,!1);if(c){var f=this.ua.Ba.Wia,l=new Ka.a,x=this.Jb.me(7,D.a.b5e);x.nc(H);for(const U of b.drawingElems)if(U.text&&U.text.paragraphs)for(const ja of U.text.paragraphs){const ya=ja.id;l.add(ya);const Va=Object(oa.a)(Mb.AParagraphNode,f.Be(ka.a.Hf(ya)));if(Va&&
!Va.sa(Wl.a.Tda,!1)){if(this.Ha.pptEditorGrammarAndWritingStyleIsEnabled)if(ya in c){const hb=Array.isArray(c[ya])?c[ya]:null;if(!hb||!hb.length||hb[0].RevisionId!==Va.sa(Wl.a.s1c,0).toString())continue;this.fkk(Va,hb,this.Hhj(ja.cfRuns))}else this.gXk(Va);Va.setValue(Wl.a.Tda,!0)}}if(this.Ha.pptEditorConsistencyCheckIsEnabled){const U=String.format("Start:{0}",(new Date).getTime().toString());b=0;const ja=H.isSlideCritiqueReady;c=!1;if(!ja){const ya=new Ka.a,Va=this.I4f(a,!0);(c=this.jXi(Va,l,H,
ya))&&(b=this.Sei(Va,l,H,ya))}xa.a.J(37298713,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",U,(new Date).getTime().toString(),ja,c,b)}H.setValue(Wl.a.jig,!0);x.dispose()}}}catch(H){xa.a.J(36525523,375,10,"MarkEditorServiceResults failed {0}",H.message)}}Hhj(a){const b=new Ma.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}fkk(a,b,c){var f=this.NC.GF(a,x=>!!x.Gh);const l=[];for(const x of f)1===x.Gh.proofingType&&Array.add(l,
x);b=this.iXi(a,b,l);f=this.hXi(b,f);this.NC.qKa(a,f);this.JXg(b,a,c);a.setValue(Wl.a.Tda,!0)}gXk(a){const b=this.NC.GF(a,c=>!!c.Gh&&1!==c.Gh.proofingType);this.NC.qKa(a,b);a.setValue(Wl.a.Tda,!0)}Sei(a,b,c,f){const l=c.Wia,x=new Rd.a;let H=0;this.P1k(c);for(let ja in a){var U=a[ja];const ya=Object(oa.a)(Mb.AParagraphNode,l.Be(ka.a.Hf(ja)));U=Array.isArray(U)?U:null;if(!(ya&&ya.isConnected&&U&&U.length))continue;const Va=[];for(const hb of U)this.fhg(hb)&&!f.contains(hb.BucketId)&&Va.push(hb);0<Va.length&&
(this.JXg(Va,ya),x.Hb(ya.id.toString())||x.$(ya.id.toString(),ya),H+=Va.length)}if(0<x.count)for(let ja of b)x.Hb(ja)&&(a=x.ga(ja))&&c.qLa.add(a);c.isSlideCritiqueReady=!0;return H}jXi(a,b,c,f){var l=this.Jej(c);if(b.count!==l.count)return this.e2c(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.Wia;for(var x of b){if(!l.contains(x))return this.e2c("ParaId changed"),!1;b=Object(oa.a)(Mb.AParagraphNode,c.Be(ka.a.Hf(x)));if(!b||!b.isConnected)return this.e2c("Invalid ParaId"),
!1;if(!b.sa(Wl.a.Tda,!1))return this.e2c("Para pending proofing"),!1}for(let H in a){x=a[H];l=Object(oa.a)(Mb.AParagraphNode,c.Be(ka.a.Hf(H)));x=Array.isArray(x)?x:null;if(!x||!x.length)continue;b=this.NC.GF(l,ja=>!!ja.Gh&&(1===ja.Gh.proofingType||2===ja.Gh.proofingType||3===ja.Gh.proofingType));const U=this.NC.GF(l,ja=>{ja=Object(oa.a)(615,ja.Gh);return!!ja&&5===ja.proofingType&&ja.KEa});l=this.jAe.lSc(l,!1,!0);for(const ja of x)if(this.fhg(ja)){if(this.LYc(ja,b)||this.tLj(ja,x))f.add(ja.BucketId),
xa.a.J(37298716,375,50,"Overlap critique: {0}",ja.BucketId);(this.LYc(ja,l)||this.LYc(ja,U))&&f.add(ja.BucketId)}}return!0}e2c(a){xa.a.J(37298718,375,50,"Skip apply: {0}",a)}iXi(a,b,c){const f=[];for(const l of b){if(this.Axj(b,l)||a.characterData.length<l.Start+l.Length||this.LYc(l,c))continue;const x=Gn.b(l);2!==x&&3!==x||f.push(l)}return f}hXi(a,b){const c=[];for(const f of b)this.Phl(a,f)||Array.add(c,f);return c}Phl(a,b){const c=b.Gh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===
c){for(const f of a)if(this.G_c(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}LYc(a,b){const c=a.Start;a=a.Start+a.Length;for(const f of b)if(this.G_c(c,a,f.begin,f.end))return!0;return!1}I4f(a,b){const c={};if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}VSa(a,b){let c=0;for(let f of a)if(b>=f.key)c=f.value;else break;return c}JXg(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const H of a){var x=H.Start;const U=x+
H.Length,ja=b.characterData.substring(x,U);a=this.L7j.create(H,this.GQg);a.token=ja;c&&(a.lcid=this.VSa(c,x));x=new Vm(x,U,a);Array.add(l,x);a=1===a.proofingType?jl[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.NC.osf(b,l);this.GQg.track(()=>Object.assign(new Vn.a,{E:2,C:this.CBi(b.characterData),F:f}))}}Axj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.G_c(c,f,l.Start,l.Start+l.Length)&&Gn.a(l)>Gn.a(b))return!0;return!1}tLj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==
a&&this.G_c(c,f,l.Start,l.Start+l.Length))return!0;return!1}G_c(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}CBi(a){return vr.a.instance.K8f(a,0,a.length-1)}ljl(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}fhg(a){return!!a&&5===Gn.b(a)}Jej(a){const b=new Ka.a;a=a?a.Ek():[];for(const c of a)this.Yl.wFa(c)||this.Fa.LJ(c,f=>{b.add(f.id.toString())});return b}P1k(a){for(let b of a.qLa){const c=b;if(c){const f=this.NC.GF(c,l=>{l=Object(oa.a)(615,l.Gh);return!!l&&5===l.proofingType&&!l.KEa});this.NC.qKa(c,
f)}}a.qLa.clear()}}Object(m.a)(jw,"EditorServiceResultsManager",null,[]);class jy extends Po.a{constructor(a,b,c,f,l,x=null){super(a,b,c,f,x);this.bG=l}get proofingType(){const a=super.proofingType;return this.bG.qUa||2!==a?a:1}}Object(m.a)(jy,"PPTEditorServiceErrorDetails",Po.a,[]);class ky{constructor(a,b,c){this.Z$j=a;this.zek=b;this.bG=c}create(a,b,c=null){return new jy(a,b,this.Z$j,this.zek,this.bG,c)}}Object(m.a)(ky,"PPTEditorServiceErrorDetailsFactory",null,[1255]);class kw{constructor(a){this.Ha=
a}filter(a){if(a&&(!this.Ha.pptEditorConsistencyCheckIsEnabled||!this.Ha.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=Gn.c(b.CritiquePriority,b.CritiqueTag);this.Ha.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ha.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(m.a)(kw,"PPTProofingCritiqueCategoryInfoFilter",
null,[1256]);class pt extends kt.a{constructor(a,b){super(null);this.GId=a;this.errorType=2;this.Vpg=b}get proofingType(){return this.GId}get suggestions(){return[]}aMa(){}}Object(m.a)(pt,"UnknownErrorDetails",kt.a,[]);class Cr{constructor(a,b,c,f,l){this.F8e=this.C8e=null;this.WMd=this.kGd=0;this.izd=!1;this.Ii=a;this.RVb=b;this.Kz=c;this.Gm=f;this.hN=l;this.oxc=0}Jfh(a,b,c){return{Hch:a,$0g:b,Z0g:c}}rEh(){}Yne(a,b,c,f,l,x,H,U){!x&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Ii.Ra.last.cp,x=
this.Ii.characterData.length,Array.add(H,new Kk.a(b,x)),(c||f)&&Array.add(U,new Vm(b,x,new pt(this.hN.Mme?l?l[a]:0:f?2:1,c?1:2))))}HEl(a,b){this.Kz.JRe(this.Ii,a);b&&this.Gm.X_k(this.Ii,b);this.Gch()}Gch(){this.RVb.NR(this.Ii)}v5k(a,b,c,f){this.qnh(this.oxc,b,c,f);this.GTe(a,this.izd)}qnh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.hN.Mme?a:0)}GTe(a,b){a.add(b)}p0j(a){let b,c,f,l;b=this.Ii.sa($a.a.Zwa,null);c=this.Ii.sa($a.a.wLa,null);f=this.Ii.sa(ab.a.u$a,null);l=this.Ii.sa(ab.a.IZa,null);
this.Ii.fzb=this.Ii.sa(dh.a.xjc,!1);({Zwa:b,wLa:c,u$a:f,IZa:l}=this.YIh(b,c,f,l,a,"loading"));return{Zwa:b,wLa:c,u$a:f,IZa:l}}ITe(a,b,c,f,l){({Zwa:a,wLa:b,u$a:c,IZa:f}=this.YIh(a,b,c,f,l,"saving"));this.SVe($a.a.Zwa,a);this.SVe($a.a.wLa,b);this.SXe()&&this.SVe(ab.a.u$a,c);this.Nbl(ab.a.IZa,f);this.Ii.fzb?this.Ii.we(dh.a.xjc,!0):this.Ii.removeProperty(dh.a.xjc)}SXe(){return!0}SVe(a,b){b&&Array.contains(b,!0)?this.Ii.we(a,b):this.Ii.removeProperty(a)}Nbl(a,b){!b||cb.a.all(b,c=>0===c)?this.Ii.removeProperty(a):
this.Ii.we(a,b)}hui(a,b){(b=this.Ii.Ra.ga(b).formatting)?(a.formatting=b.ae(a),P.a.instance.ga(57)&&(this.Ii.fv(),-1!==a.formatting.og&&this.Ii.wordRunProperties.Cyb(b.og,64))):(ia.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),Nc.a.instance.Xb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}YIh(a,b,c,f,l,x){const H=Nc.a.instance.Vp(D.a.kIl);H.properties.$(Uc.a.source,
x);let U=!1;a&&a.length!==l&&(ia.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,x),U=!0);b&&b.length!==l&&(ia.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,x),U=!0);this.SXe()&&c&&c.length!==l&&(ia.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
c.length,l,x),U=!0);f&&f.length!==l&&(ia.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,x),U=!0);if(U)for(f=c=b=null,a=[],x=0;x<l;x++)Array.add(a,!0);H.end();return{returnValue:!U,Zwa:a,wLa:b,u$a:c,IZa:f}}B6g(){}AGe(){this.oxc=0;this.C8e=this.Ii.N0||[];this.F8e=this.Ii.YOb||[];this.WMd=this.kGd=0;this.izd=!1}DGe(a,b){a.Up&&a.Up.Gh?this.oxc=a.Up.Gh.proofingType:a.GL&&(this.oxc=0);a=a.cp;b=b?b.cp:a;
this.izd=({p_e:this.kGd}=this.shg(a,b,this.C8e,this.kGd)).returnValue||({p_e:this.WMd}=this.shg(a,b,this.F8e,this.WMd)).returnValue}shg(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,p_e:f}}return{returnValue:!1,p_e:f}}}Object(m.a)(Cr,"ProofingDataHandler",null,[1374]);var lw=d(509);class mw extends Cr{constructor(a,b,c,f,l,x,H,U,ja){super(a,b,c,f,U);this.JBg=!1;this.$bc=null;this.uJ=l;this.ia=x;this.Fa=H;this.jc=ja;this.G3c=null}B6g(){this.uJ.Xzl(this.Ii)}Jfh(a,
b,c){this.Ii.Rie||(a=!1,c=this.Gm.GF(this.Ii));this.G3c=this.Gm.GF(this.Ii,f=>{f=Object(oa.a)(615,f.Gh);return!!f&&5===f.proofingType&&!f.KEa});return{Hch:a,$0g:b,Z0g:c}}rEh(a,b,c,f,l){const x=Object(oa.a)(116,this.jc.kg(this.Ii));this.Ii&&x&&x.isConnected&&x.isSlideCritiqueReady&&ha.a.sRd(this.Ii.characterData,b)&&this.G3c&&0<this.G3c.length&&(Array.addRange(l,this.G3c),l.sort((H,U)=>H.end-U.end));if(!a&&c&&0<c.length&&ha.a.sRd(this.Ii.characterData,b)&&f&&0<f.length){for(const H of c)this.vlg(H,
f)&&!this.vlg(H,l)&&Array.add(l,H);l.sort((H,U)=>H.end-U.end)}}vlg(a,b){a=sl.c([a],b);return!cb.a.Wa(a)&&cb.a.any(a,c=>c.begin<c.end)}Gch(){this.uJ.wSj(this.Ii)&&this.RVb.NR(this.Ii)}SXe(){return!1}GTe(a,b){this.JBg=!0;super.GTe(a,b);b&&(this.Ii.we(Wl.a.Tda,!1),this.Ii.we(Wl.a.s1c,(new Date).getTime()))}qnh(a,b){this.$bc||(this.$bc=this.Gm.GF(this.Ii));b.add(1===a)}AGe(){super.AGe();this.$bc=null}Yne(a,b,c,f,l,x,H,U){x||(b=!!b&&b[a],a=!!c&&c[a],c=this.Ii.Ra.ga(this.Ii.Ra.length-1),b?(Array.add(H,
new Kk.a(c.cp,this.Ii.characterData.length)),this.u5k()):(b=this.q4i(c.cp,this.Ii.characterData.length,this.Ii.characterData,ja=>{ja=ja.Gh.proofingType;return 2===ja||3===ja}))&&0<b.length&&Array.addRange(U,b),a&&(Array.add(H,new Kk.a(c.cp,this.Ii.characterData.length)),Array.add(U,new Vm(c.cp,this.Ii.characterData.length,new pt(1,1)))))}ITe(a,b,c,f,l){this.JBg||this.tyj()||xa.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.ITe(a,
b,c,null,l)}tyj(){if(!this.Ii)return xa.a.J(37368032,375,10,"ParagraphNode is null"),!1;var a=this.Fa.$m(this.Ii);if(!a)return xa.a.J(37368034,375,10,"ShapeNode is null"),!1;a=new lw.a(a,Oc.App.Vm);this.ia.La(K.a.Whb,2,a);return a.nua}u5k(){const a=new pf.GraphTransaction(4);a.kd(this.Ii);this.Ii.we(Wl.a.Tda,!1);this.Ii.we(Wl.a.s1c,(new Date).getTime());a.dispose()}q4i(a,b,c,f){const l=[];if(this.$bc)for(const x of this.$bc){const H=Object(oa.a)(Vm,x);H&&H.Gh&&H.Gh.token===c.substring(H.begin,H.end)&&
H.end>a&&H.end<=b&&f(H)&&Array.add(l,H)}return l}}Object(m.a)(mw,"PPTProofingDataHandler",Cr,[]);class nw{constructor(a,b,c,f,l,x,H,U){this.u$=a;this.Ibk=b;this.NC=c;this.uJ=f;this.bG=H;this.ia=l;this.jc=U;this.Fa=x}qFi(a){return new mw(a,this.u$,this.Ibk,this.NC,this.uJ,this.ia,this.Fa,this.bG,this.jc)}}Object(m.a)(nw,"PPTProofingDataHandlerFactory",null,[1259]);class Ku{constructor(a,b){this.r$=a;this.Jsg=b}initialize(){this.r$.execute(a=>{if(this.Jsg)for(const b of this.Jsg)this.GVk(a,b)})}GVk(a,
b){a.registerSimpleRemoteWorkflow(b.tG,b.esb,b.bKb,b.qrb)}}Object(m.a)(Ku,"ProofingAugLoopRuntimeManager",null,[]);class Qq{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){this.Fa=a;this.Yl=b;this.jc=c;this.Ml=f;this.Jb=l;this.Qb=x;this.Qk=H;this.ua=U;this.u$=ja;this.NC=ya;this.vi=hb;this.Hh=yb;this.Mma=Zb;this.zb=fc;this.qd=Lc;this.AMg=Gc;this.mYa=new Ka.a;this.Qk.pbi(Object(F.a)(this,this.c7g,"onUndoRevisionStateChanged"));this.hU=Va.yd(12);this.hU.jk(Object(F.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.iM=Va.yd(10);this.iM.vF(Object(F.a)(this,this.W5g,"onShapeTopologyChanged"));this.jfk=new af.a(3,1,0,Object(F.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.rhc=this.jHa=!1;this.qd.aW(Object(F.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Qk.d_k(Object(F.a)(this,this.c7g,"onUndoRevisionStateChanged"));this.hU.Cm(Object(F.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.iM.bP(Object(F.a)(this,
this.W5g,"onShapeTopologyChanged"));this.qd.ioa(Object(F.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}cqc(a,b){this.Fa.LJ(a,c=>{this.Kqh(c,b)})}Lqh(a,b){this.Yl.tmc(a,c=>{this.Kqh(c,b)})}WEl(a,b){b?this.Fa.LJ(a,c=>{c&&this.NC.$Ud(c)}):this.Fa.LJ(a,c=>{c&&(c.VYb=!0)})}sEh(a){if(a&&a.isConnected&&!a.$p){var b=this.Jb.me(4);try{let c=!1;const f=this.Qb.Nc(a);b.nc(f);const l=this.Ml.fsa(a);for(;l.moveNext();){const x=l.currentNode;this.Bil(x)&&(c=!0,x.Sfd(),x.Hmc=!0)}c&&this.RXg(a)}finally{b&&
b.dispose()}this.vi.forceOutbound()}}Xzl(a){if(this.sua(a)&&a.VYb)if(this.rhc&&!this.mYa.contains(a))this.mYa.add(a);else{var b=this.Jb.me(4);try{b.nc(a),a.Sfd(),a.Hmc=!0,this.gkk(a)}finally{b&&b.dispose()}a.VYb=!1}}Oid(a){this.sua(a)&&this.Fa.LJ(a,b=>{this.u$.NR(b)})}WKk(a){this.sua(a)&&this.Yl.tmc(a,b=>{this.u$.NR(b)})}wSj(a){return this.sua(a)&&(this.ySj(a)||this.xSj(a))}RXg(a){a&&a.isConnected&&this.Fa.KFa(a)&&this.Vqh(a)}gkk(a){const b=this.Fa.$m(a);this.RXg(b);this.Yl.Nka(a)&&(a=this.Yl.gxb(a))&&
a.isConnected&&this.Yl.wFa(a)&&this.Vqh(a)}c7g(a,b){if(b)switch(b.state){case 0:this.rhc=!0;break;case 3:this.rhc=!1,this.jHa||(this.zb.Db(this.jfk),this.jHa=!0)}}Bil(a){return this.sua(a)?a.sa($a.a.Zwa,null)?!0:a.sa($a.a.wLa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.rhc&&b&&b.node&&(12!==b.node.type||this.mYa.contains(b.node)||this.mYa.add(b.node))}W5g(a,b){this.rhc&&b&&b.node&&(10!==b.node.type||this.mYa.contains(b.node)||this.mYa.add(b.node))}resumeProofingAfterUndo(){this.jHa=!1;for(let b of this.mYa)if(this.sua(b))if(this.Fa.KFa(b)){var a=
b;a&&(this.cqc(a,!0),this.Oid(a))}else this.Hh.$d(b)&&(a=b)&&(a.VYb=!0,this.u$.NR(a));this.mYa.clear()}Kqh(a,b){a&&(a.VYb=b&&a.N0&&0<a.N0.length?!0:!1)}ySj(a){if(this.AMg){const b=this.ua.Ba;if(!this.sua(b))return!1;a=this.Fa.oda(a);return this.jc.kg(a)===b}return this.Mma.XKj(a)}xSj(a){var b=this.ua.Ba;if(!this.sua(b))return!1;a=this.Yl.gxb(a);b=b.$Sa();return this.sua(a)&&this.sua(b)&&ka.a.WP(a.id,b.id)}Vqh(a){a.setValue(kb.a.Qid,a.sa(kb.a.Qid,0)+1)}sua(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.AMg){var a=
this.ua.Ba;if(a&&(a=a.Ek())&&0<a.length)for(const b of a)this.Fa.dB(b)&&this.Oid(b)}}}Object(m.a)(Qq,"ProofingBehaviorController",null,[1260,106]);class ow extends Jq.a{constructor(a,b,c,f,l,x=!0,H=!1,U=50){super(a,b,c,f,l,x);this.sak=H;this.CGg=U}Uoh(a){a=Array.isArray(a)?a:null;if(!cb.a.Wa(a))if(a.length<=this.CGg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.CGg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&xa.a.J(37325012,375,
this.sak?15:50,"{0}",gl.c(a))}}Object(m.a)(ow,"DashboardAggregator",Jq.a,[]);class pw{constructor(a){this.t$=new ow(new mc.a(()=>u.AFrameworkApplication.ye),u.AFrameworkApplication.pga,15,a.pptProofingDashboardTraceIntervalInMinutes,new Kq,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.t$.track(a,"")}e_d(a){let b=null;try{b=xd.a(a)}catch(c){xa.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(m.a)(pw,"ProofingDashboardAggregator",
null,[1257]);class qw{track(){}e_d(){return null}}Object(m.a)(qw,"ProofingDashboardNonOperationAggregator",null,[1257]);var rw=d(440),qt=d(439);class Lu{constructor(a){this.dfk=a}Lx(a,b,c){this.dfk(b,c);return!0}}Object(m.a)(Lu,"NonOpProofingALRequestManager",null,[1355]);class Mu{constructor(a,b,c){this.z0=this.W_=null;this.NCe=a;this.scc=b.pptEditorConsistencyCheckIsEnabled;this.oye=b.pptProofingLogWorkflowExceptionEnabled;this.t$=c;this.iAe=new Lu(Object(F.a)(this,this.ZRe,"requestAL"))}get tG(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get esb(){this.W_||
(this.W_=Object.assign(new qt.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:rw.a.Grc,outputSchema:Ip.a.gGf,func:Object(F.a)(this,this.Dbb,"lambdaBeforeFunc")}));return this.W_}get qrb(){return null}get bKb(){this.z0||(this.z0=Object.assign(new qt.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:Ip.a.gGf,outputSchema:Ip.a.GVd,func:null}));return this.z0}ZRe(a,b){b(a)}Dbb(a,b,c){try{xa.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.tG);const H=Object.assign(new Jp,{d:{["bs"]:(new Date).getTime()},
w:Object.assign(new Br,{wn:vm.Psd})});this.t$.track(Object.assign(new Jp,{w:Object.assign(new Br,{wn:vm.Psd}),p:vm.wog}));let U=String.format("LambdaBeforeStart:{0}",H.d[Lk.$me].toString());if(a){H.w.i=a.Id;try{var f=xd.a(a.Content)}catch(ja){xa.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var x=({DFa:b}=this.NCe.Wnl(f)).returnValue;x?b&&(!this.scc||this.scc&&l)?(c(null),this.t$.track(Object.assign(new Jp,{w:Object.assign(new Br,{wn:vm.Psd}),
p:vm.vog})),xa.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.tG,a.Id,b,l)):(H.d[Lk.e1c]=(new Date).getTime(),H.p=vm.CYj,U=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,U,H.d[Lk.e1c].toString()),this.t$.track(H),xa.a.J(36783312,375,50,U),this.iAe.Lx(f.id,x,c)):(c(null),xa.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.tG,a.Id))}else c(null)}else c(null),xa.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.tG)}catch(H){a=
"CloudAL LambdaBefore Exception",this.oye&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",H.message,H.stack)),xa.a.J(37835201,375,10,a),c(null)}}}Object(m.a)(Mu,"ProofingTileCheckCloudALWorkflow",null,[960,1323]);class sw{}Object(m.a)(sw,"AugEditorServiceTileCheckRequest",null,[]);class tw{constructor(){this.contextId=this.f1c=null}}Object(m.a)(tw,"RequestStateObject",null,[]);class uj{constructor(a,b,c,f){this.efk=0;this.z0=this.W_=null;this.NCe=a;this.OT=b;this.scc=c.pptEditorConsistencyCheckIsEnabled;
this.oye=c.pptProofingLogWorkflowExceptionEnabled;this.t$=f;this.iAe=new Lu(Object(F.a)(this,this.ZRe,"requestAL"))}get tG(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get esb(){this.W_||
(this.W_=Object.assign(new qt.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:rw.a.Grc,outputSchema:Ip.a.Iyf,func:Object(F.a)(this,this.Dbb,"lambdaBeforeFunc")}));return this.W_}get qrb(){return null}get bKb(){this.z0||(this.z0=Object.assign(new qt.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:Ip.a.Iyf,outputSchema:Ip.a.Jyf,func:Object(F.a)(this,this.ane,"lambdaRemoteFunc")}));return this.z0}ZRe(a,b){if(b){var c=this.t$.e_d(a.DashboardTelemetry);c&&(c.d[Lk.uJh]=(new Date).getTime());
var f=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.OT.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.Joc(a.Topic,a.Data,a.ContextId,x=>{this.yKa(x,f,c)},x=>{this.wKa(x,f)},Object.assign(new tw,{contextId:a.ContextId,f1c:b}))})}}Dbb(a,b,c){try{xa.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.tG);const H=Object.assign(new Jp,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Br,{wn:vm.rvl})});let U=String.format("LambdaBeforeStart:{0}",
H.d[Lk.$me].toString());this.t$.track(Object.assign(new Jp,{w:H.w,p:vm.wog}));if(a){try{var f=xd.a(a.Content)}catch(ja){c(null);xa.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var x=({DFa:b}=this.NCe.Xnl(f,++this.efk)).returnValue;x?b&&(!this.scc||this.scc&&l)?(c(null),this.t$.track(Object.assign(new Jp,{w:H.w,p:vm.vog})),xa.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.tG,a.Id,b,l)):(H.d[Lk.e1c]=
(new Date).getTime(),U=String.format("{0}, LambdaBeforeDone:{1}",U,H.d[Lk.e1c].toString()),c(Object.assign(new sw,{Topic:Ip.a.$Pi,Data:xd.c(x),ContextId:f.id,Telemetry:U,DashboardTelemetry:gl.c(H)})),xa.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.tG,a.Id)):(c(null),xa.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.tG,a.Id))}else c(null)}else c(null),xa.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.tG)}catch(H){a="WACAL LambdaBefore Exception",this.oye&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
H.message,H.stack)),xa.a.J(37835210,375,10,a),c(null)}}ane(a,b,c){xa.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.tG);a?this.iAe.Lx(a.ContextId,a,c):(c(null),xa.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.tG))}yKa(a,b,c){if(!u.AFrameworkApplication.Ug&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var x=xd.a(a.data.Sd)}catch(H){l.f1c(null);xa.a.J(36525527,375,10,"Try parse aug response failed:{0}",H.message);return}x&&(x.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[Lk.vJh]=f,x.DashboardTelemetry=gl.c(c)));l.f1c(x);xa.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.tG)}}}wKa(a,b){!u.AFrameworkApplication.Ug&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),xa.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Sd,b),(a=a.data.state)&&a.f1c(null))}}Object(m.a)(uj,"ProofingTileCheckWacALWorkflow",null,[960,1323]);class wo{constructor(){this.groupType=0}}
Object(m.a)(wo,"AnalyzerData",null,[]);class rt{constructor(){this.nodes=this.metadata=null}}Object(m.a)(rt,"TopologyNode",null,[]);class Nu{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(m.a)(Nu,"Content",null,[]);class Ou{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(m.a)(Ou,"CritiqueTypeOption",null,[]);class ly{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(m.a)(ly,"Descriptors",null,[]);class np{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(m.a)(np,"EditorServiceTileCheckRequest",null,[]);class uw{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(m.a)(uw,"ListMetadata",null,[]);var st;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(st||
(st={}));Object(m.b)("ListNumeration",st);var tt;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(tt||(tt={}));Object(m.b)("ListType",tt);class vw{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(m.a)(vw,"ProofingRequest",null,[]);class qs{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(m.a)(qs,"TopologyNode",null,[]);class ww{constructor(){this.nodes=null}}Object(m.a)(ww,"ReadingOrderTopology",null,[]);class Pu{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(m.a)(Pu,"Span",null,[]);class Qu{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(m.a)(Qu,"TextTile",null,[]);class my{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(m.a)(my,"TextTileElement",null,[]);class Ru{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(m.a)(Ru,"TextTileElementSpan",null,[]);class ut{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(m.a)(ut,"TileContext",null,[]);class Su{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(m.a)(Su,"TileElement",null,[]);class rs{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(m.a)(rs,"TileMetadata",null,[]);class Tu{constructor(a,b,c,f,l,x){this.EQg=a;this.N3c=b;this.DQg=c;this.bG=f;this.Ha=l;this.oc=x;this.e4c=null}get Dmg(){return u.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.bG.qUa}get descriptors(){this.e4c||(this.e4c=this.U7i(),xa.a.J(37090579,375,50,"Descriptors: {0}",xd.c(this.e4c)));return this.e4c}Xnl(a,b){let c;c=!0;var f=Ya.a.xe(u.AFrameworkApplication.lcid);if(!f)return{returnValue:null,DFa:c};
var l=new qs,x=new qs;b=Object.assign(new np,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:u.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.N3c.k6d()});this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=Ug.a.F1b(u.AFrameworkApplication.fa.Ga("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.oc.pj(),l.AreChildrenOrdered=!1,x.Id=a.id,
x.Type=3,x.AnalyzerData=null,x.Children=[],x.NumberOfChildren=null,x.AreChildrenOrdered=!0,Array.add(l.Children,x));for(var H of a.drawingElems)if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(x.Children,this.jxl(H)),H.text&&H.text.paragraphs)for(const ja of H.text.paragraphs){if(null===ja.chars||!ja.cfRuns||!ja.cfRuns.length)continue;a=new Nu;a.TileId=ja.id;a.TileElements=[];l=new Su;l.Text=ja.chars;l.TextUnit=8;if(ja.pfRuns&&ja.pfRuns.length&&ja.pfRuns[0].pf){f=ja.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var U=tt[this.W5d(f.listType)];1===f.listType?(l.AnalyzerData.ListType=U,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=U,l.AnalyzerData.ListNumeration=st[this.M_f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;U=0;const ya=[];let Va=null;for(const hb of ja.cfRuns)if(hb)if(f=Ya.a.xe(hb.cf.lang)){this.DQg.Xhd(hb.cf.lang);f=Object.assign(new Pu,{Start:U,Length:hb.len,LanguageId:f.name,DoNotCheck:hb.cf.noProof});Va||(Va=f.LanguageId);if(Va!==f.LanguageId||hb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?ya.push(f):(f.Length||f.Start!==l.Text.length)&&xa.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
U+=hb.len}else U+=hb.len;!l.IsClean&&0<ya.length&&(l.Spans=Array.clone(ya));l.LanguageId=Va;ha.a.Wa(l.LanguageId)?xa.a.J(38385410,375,15,"Empty LanguageId, span length {0}",ya.length):(a.TileElements.push(l),b.Content.push(a))}for(x=b.Content.length-1;0<=x;x--)H=b.Content[x],H.TileElements.length&&null!==H.TileElements[0].Text||(xa.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",H.TileId),Array.removeAt(b.Content,x));b.Content.length||xa.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
DFa:c}}jxl(a){const b=Object.assign(new qs,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new qs,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}Wnl(a){let b;b=!0;var c=Ya.a.xe(u.AFrameworkApplication.lcid);if(!c)return{returnValue:null,DFa:b};var f={};c=Object.assign(new vw,{descriptors:this.j5i(this.descriptors),
languageUxId:c.name,documentSessionId:u.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.i5i(this.N3c.k6d()),tileContextDictionary:f,documentId:Ug.a.F1b(u.AFrameworkApplication.fa.Ga("ServerDocId")).toString(),readingOrderTopology:Object.assign(new ww,{nodes:[]})});const l=this.v7h(a,c.readingOrderTopology,f);for(var x of a.drawingElems)if(x.text&&x.text.paragraphs){a=this.Q5h(x,l,f);for(const H of x.text.paragraphs)({DFa:b}=this.S7h(c.tiles,H,b)),this.G6h(H,a,f)}for(f=
c.tiles.length-1;0<=f;f--)x=c.tiles[f],x.elements.length&&null!==x.elements[0].text||(xa.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",x.metadata?x.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||xa.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,DFa:b}}U7i(){if(!this.EQg.descriptors)return null;const a=Array.clone(this.EQg.descriptors);for(const b of a)if(this.Dmg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.Dmg&&Array.add(a,
Object.assign(new tl,{Name:"LicenseType",Value:"Subscription"}));return a}j5i(a){const b=new ly;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}W5d(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}i5i(a){const b=[];for(const c of a)a=Object.assign(new Ou,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}M_f(a){return a+
1}k5i(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}S7h(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,DFa:c};const f=new Qu;f.metadata=new rs;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new my;l.text=b.chars;l.textUnit=4;l.listMetadata=new uw;var x=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){x=b.pfRuns[0].pf;if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
x.listType){l.listMetadata.listLevel=x.lvl;var H=this.W5d(x.listType);1===x.listType?(l.listMetadata.listType=H,l.listMetadata.listTag=x.listTag):0===x.listType&&(l.listMetadata.listType=H,l.listMetadata.listNumeration=this.M_f(x.listNumeration),l.listMetadata.listElementIndex=x.listElementIndex)}else l.listMetadata.indentationLevel=x.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.W5d(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
x=!b.pfRuns[0].pf.proofingDirty;c=c&&x}H=0;const U=[];let ja=null;for(const ya of b.cfRuns)if(ya)if(b=Ya.a.xe(ya.cf.lang)){this.DQg.Xhd(ya.cf.lang);b=Object.assign(new Ru,{start:H,length:ya.len,languageId:b.name,doNotProcess:ya.cf.noProof});ja||(ja=b.languageId);if(ja!==b.languageId||ya.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?U.push(b):(b.length||b.start!==l.text.length)&&xa.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);H+=ya.len}else H+=ya.len;!x&&0<U.length&&(l.spans=Array.clone(U));l.languageId=ja;if(ha.a.Wa(l.languageId))return xa.a.J(38385415,375,15,"Empty LanguageId, span length {0}",U.length),{returnValue:null,DFa:c};f.elements.push(l);a.push(f);return{returnValue:f,DFa:c}}v7h(a,b,c){const f=Object.assign(new rt,{metadata:Object.assign(new rs,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ut,{analyzerData:new wo,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}Q5h(a,b,c){const f=Object.assign(new rt,{metadata:Object.assign(new rs,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ut,{analyzerData:Object.assign(new wo,{groupType:this.k5i(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}G6h(a,b,c){const f=Object.assign(new rt,{metadata:Object.assign(new rs,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new ut,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(m.a)(Tu,
"TileToTileCheckRequestTransformer",null,[1322]);class Uu{constructor(){this.bG=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Zb(a){this.K=a;this.fyi();this.gyi();this.K.register(1255,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().oa(()=>new ky(u.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(1256,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().oa(()=>
new kw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1257,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new pw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new qw);this.K.register(jw,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().oa(()=>new jw(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));this.K.register(1258,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().oa(()=>new iw(this.K.resolve("Box4.Graph.IGraphInstance").yd(12),this.K.resolve("Box4.Graph.IGraphInstance").yd(22),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(Tu,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().oa(()=>
new Tu(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Iu,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().oa(()=>
new Iu);this.K.register(uj,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>new uj(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Mu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().oa(()=>
new Mu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Ku,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().oa(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new Ku(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(hw.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().oa(()=>new hw.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
u.AFrameworkApplication.fa.Ga("PptRoamingServiceGetActionName"),u.AFrameworkApplication.fa.Ga("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.gf(()=>{this.bG=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.bG.qUa=a.ka("810");this.bG.Vyb=a.ka("809");this.bG.VUa=a.ka("299");if(this.bG.qUa||this.bG.Vyb)this.K.resolve("Box4.Proofing.IProofingDescriptors").fee(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.bG.VUa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.bG.Vyb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.bG.Vyb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose()}fyi(){this.K.register(1259,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().oa(()=>new nw(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader")))}gyi(){this.K.register(1260,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().oa(()=>new Qq(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cSj))}static main(){z.a.instance.Dc(new Uu)}}Object(m.a)(Uu,"PPTWebEditorProofingPackage",null,[2,3]);class xw{constructor(a,b,c,f,l,x,H,U,ja,ya){this.qd=a;this.qd.JGc(Object(F.a)(this,this.Q6g,"onTextEditViewClose"));this.qd.NYb(Object(F.a)(this,this.R6g,"onTextEditViewOpen"));this.qd.Gai(Object(F.a)(this,this.T1g,"onBeforeTextEditViewClose"));this.qd.Kai(Object(F.a)(this,
this.S6g,"onTextEditViewUpdate"));this.Hqe=b;this.vi=l;this.Mv=x;this.uJ=c;this.Efb=f;this.Ndc=H;this.$cc=U;this.xad=ja;this.xE=ya}get bKc(){return this.Hqe.instance}dispose(){this.qd.lRe(Object(F.a)(this,this.Q6g,"onTextEditViewClose"));this.qd.wld(Object(F.a)(this,this.R6g,"onTextEditViewOpen"));this.qd.FZk(Object(F.a)(this,this.T1g,"onBeforeTextEditViewClose"));this.qd.IZk(Object(F.a)(this,this.S6g,"onTextEditViewUpdate"))}S6g(){this.$cc.UY()}R6g(a,b){a=b.Jw.shapeNode;this.uJ.cqc(a,!1);this.uJ.Oid(a);
this.bKc&&this.bKc.Exk(a)}T1g(a,b){this.Ndc.w1d(b.Jw.Md)}Q6g(a,b){a=b.Jw;const c=b.Jw.shapeNode,f=!!c&&c.isConnected;b.nua?this.xE.instance&&((this.xE.instance.fAb||this.xE.instance.e4)&&2===this.xE.instance.lG||this.xE.instance.Z_c)?xa.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",this.xE.instance.lG,this.xE.instance.Z_c):(f&&c.gpd(),c.ud?(this.uJ.sEh(c),this.Efb.k2g(),this.Mv.u0e()):(this.vi.j7a(c),this.Mv.XUd())):
this.xad||this.uJ.sEh(c);this.uJ.cqc(b.Jw.shapeNode,f&&c.hZc);this.bKc&&!a.$p&&this.bKc.Dxk(c)}}Object(m.a)(xw,"ShapeViewElementTextEditHandler",null,[106]);class yw{constructor(a){this.$hc=null;this.qak=a;this.reset()}CCh(a,b){a&&this.$hc.$(a,b)}Cxb(a){let b=0;this.$hc.Hb(a)&&(b=this.$hc.ga(a)?1:2);return b}eFe(a){return this.qak?1===this.Cxb(a):!1}reset(){const a=this.$hc;this.$hc=new Rd.a(!1);return a}}Object(m.a)(yw,"TextEditingRevisionInfoTracker",null,[1463,1464]);var Rq=d(1068),ye=d(582),oi=
d(419),ny=d(846),Vu=d(323);class fq{constructor(){this.typeField=this.startAtField=0}}Object(m.a)(fq,"CT_TextAutonumberBullet",null,[]);class Wu{constructor(){this.charField=null}}Object(m.a)(Wu,"CT_TextCharBullet",null,[]);class zw{}Object(m.a)(zw,"CT_TextNoAutofit",null,[]);class vt{}Object(m.a)(vt,"CT_TextNoBullet",null,[]);class ss{constructor(){this.lnSpcReductionField=this.fontScaleField=0}}Object(m.a)(ss,"CT_TextNormalAutofit",null,[]);class Xu{constructor(){this.itemField=null}}Object(m.a)(Xu,
"CT_TextSpacing",null,[]);class ts{constructor(){this.valField=0}}Object(m.a)(ts,"CT_TextSpacingPercent",null,[]);class oy{constructor(){this.tField=this.rPrField=null}}Object(m.a)(oy,"CT_WebRegularTextRun",null,[]);class py{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(m.a)(py,"CT_WebTextBody",null,[]);class us{constructor(){this.lInsField=this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=
0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(m.a)(us,"CT_WebTextBodyProperties",null,[]);class wm{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=
this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;
this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(m.a)(wm,"CT_WebTextCharacterProperties",null,[]);class qy{constructor(){this.pPrField=
this.itemsField=this.endParaRPrField=null}}Object(m.a)(qy,"CT_WebTextParagraph",null,[]);class vs{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=
null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;
this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(m.a)(vs,"CT_WebTextParagraphProperties",null,[]);class Aw{constructor(a,b){this.shapeText=a;this.QPb=b}}Object(m.a)(Aw,"ShapeTextState",null,[]);class Kp{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(m.a)(Kp,
"IncrementalRequestTextOperation",null,[]);class kk{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}PG(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.PG()}uxa(a){return this.contains(a.cp)||a.contains(this.cp)}aFa(a){const b=Math.max(a.cp,this.cp);return new kk(b,Math.max(0,Math.min(a.PG(),this.PG())-1-b+1))}static copy(a){return new kk(a.cp,a.len)}}Object(m.a)(kk,"TextRange",null,[]);class op{constructor(a){this.Lq=a}}Object(m.a)(op,"ChangeState",null,[]);const Bw=(a,b)=>
{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new wm;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,
f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=
b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||
(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},wt=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new vs;let f=!1;Sq(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);Sq(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);Sq(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);Sq(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);Sq(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,
f=!0);Sq(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);xd.c(a.defRPrField)!==xd.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);xd.c(a.buCharField)!==xd.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);xd.c(a.buAutoNumField)!==xd.c(b.buAutoNumField)&&(c.buAutoNumField=b.buAutoNumField,f=!0);xd.c(a.buFontField)!==xd.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==
b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||
a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=
b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=
b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,
c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},Sq=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class xt{constructor(){this.$n=this.IHa=null}}Object(m.a)(xt,"TextParaRange",null,[]);class Tq{constructor(){this.$n=this.AIa=null}}Object(m.a)(Tq,"TextRunRange",null,[]);class Cw{constructor(a,
b,c,f,l,x){this.Yea=this.Cma=null;this.a5=this.yla=0;this.NL=this.q4=null;this.nwa=this.mGa=0;this.nGa=c;this.YHa=f;this.Ala=l;this.w$=x;this.Vod(new kk(0,a.shapeText.length),new kk(0,b.shapeText.length))}Vod(a,b){this.Cma=a;this.Yea=b;for(a=Math.max(0,this.mGa-1);a<this.nGa.length;a++)if(this.nGa[a].$n.uxa(this.Cma)||this.Cma.PG()<=this.nGa[a].$n.cp){this.mGa=a;break}for(a=Math.max(0,this.nwa-1);a<this.YHa.length;a++)if(this.YHa[a].$n.uxa(this.Yea)||this.Yea.PG()<=this.YHa[a].$n.cp){this.nwa=a;break}this.NL=
this.q4=null;for(a=Math.max(0,this.yla-1);a<this.Ala.length;a++)if(this.Ala[a].$n.uxa(this.Cma)||this.Cma.PG()<=this.Ala[a].$n.cp){this.yla=a;break}for(a=Math.max(0,this.a5-1);a<this.w$.length;a++)if(this.w$[a].$n.uxa(this.Yea)||this.Yea.PG()<=this.w$[a].$n.cp){this.a5=a;break}}JLf(){return this.mGa>=this.nGa.length?null:Object.assign(new xt,{IHa:this.nGa[this.mGa].IHa,$n:this.nGa[this.mGa].$n.aFa(this.Cma)})}KLf(){return this.nwa>=this.YHa.length?null:Object.assign(new xt,{IHa:this.YHa[this.nwa].IHa,
$n:this.YHa[this.nwa].$n.aFa(this.Yea)})}MLf(){return this.dje()&&this.q4?Object.assign(new Tq,{AIa:this.Ala[this.yla].AIa,$n:this.q4}):null}NLf(){return this.v9b()&&this.NL?Object.assign(new Tq,{AIa:this.w$[this.a5].AIa,$n:this.NL}):null}cje(){return this.uhg()&&this.u9b()}uhg(){return this.mGa>=this.nGa.length?!1:this.nGa[this.mGa].$n.uxa(this.Cma)}u9b(){return this.nwa>=this.YHa.length?!1:this.YHa[this.nwa].$n.uxa(this.Yea)}dje(){return!this.uhg()||this.yla>=this.Ala.length?!1:this.Ala[this.yla].$n.uxa(this.nGa[this.mGa].$n)&&
this.Ala[this.yla].$n.uxa(this.Cma)}v9b(){return!this.u9b()||this.a5>=this.w$.length?!1:this.w$[this.a5].$n.uxa(this.YHa[this.nwa].$n)&&this.w$[this.a5].$n.uxa(this.Yea)}aEh(){this.cje()&&(this.mGa++,this.nwa++);return this.cje()}bEh(){this.u9b()&&this.nwa++;return this.u9b()}Czl(){if(!this.dje()||!this.v9b())return!1;if(this.q4&&this.NL){this.q4.PG()===this.Ala[this.yla].$n.PG()&&this.yla++;this.NL.PG()===this.w$[this.a5].$n.PG()&&this.a5++;if(!this.dje()||!this.v9b())return!1;var a=this.Ala[this.yla].$n.aFa(this.Cma);
this.q4.cp=Math.max(a.cp,this.q4.PG());this.q4.len=a.PG()-this.q4.cp;a=this.w$[this.a5].$n.aFa(this.Yea);this.NL.cp=Math.max(a.cp,this.NL.PG());this.NL.len=a.PG()-this.NL.cp}else this.q4=this.Ala[this.yla].$n.aFa(this.Cma),this.NL=this.w$[this.a5].$n.aFa(this.Yea);a=Math.min(this.q4.len,this.NL.len);this.q4.len=a;this.NL.len=a;return 0<a}Dzl(){if(!this.v9b())return!1;this.q4||(this.q4=this.Ala[this.yla].$n.aFa(this.Cma));if(this.NL){if(this.NL.PG()===this.w$[this.a5].$n.PG()&&(this.a5++,!this.v9b()))return!1;
const a=this.w$[this.a5].$n.aFa(this.Yea);this.NL.cp=Math.max(a.cp,this.NL.PG());this.NL.len=a.PG()-this.NL.cp}else this.NL=this.w$[this.a5].$n.aFa(this.Yea);return 0<this.NL.len}}Object(m.a)(Cw,"TextFormatIterator",null,[]);class Dw{constructor(){this.txt=this.txtrng=null}}Object(m.a)(Dw,"TextModificationData",null,[]);class yt{constructor(a,b){this.textRange=new kk(a.cp,a.len);this.text=b}}Object(m.a)(yt,"TextModificationInfo",null,[]);class Lm{constructor(){this.len=this.cp=0}}Object(m.a)(Lm,"TextRangeData",
null,[]);class xo{constructor(){this.charPrp=this.txtrng=null}}Object(m.a)(xo,"WebTextCharFormatChange",null,[]);class Ew{constructor(){this.paraPrp=this.txtrng=null}}Object(m.a)(Ew,"WebTextParaFormatChange",null,[]);class Dr{constructor(a,b){this.Ssg=this.pXa=this.BDb=this.nma=this.gU=-1;this.sze=this.rqe=null;this.hWa=new kk(0,0);this.Kla=new kk(0,0);this.q0=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.sBb=a;this.Yeb=b;let c,
f;({mTe:a,JJe:c}=this.T7f(a.QPb));1<a.length&&(this.Ssg=a[a.length-1].$n.PG());({mTe:b,JJe:f}=this.T7f(b.QPb));this.oO=new Cw(this.sBb,this.Yeb,c,f,a,b)}Mwi(){this.Dwi();this.Ewi();this.Owi();const a=[],b=this.Uwi();b&&a.push(b);a.push.apply(a,this.Kwi());a.push.apply(a,this.Jwi());a.push.apply(a,this.Lwi());return a}T7f(a){const b=[],c=[];var f=[];var l=[];let x=0;if(!a.pField)return{mTe:f,JJe:l};for(const H of a.pField)if(a=new xt,a.IHa=H,a.$n=new kk(x,0),f=0,H.itemsField&&H.itemsField.length){for(const U of H.itemsField)U.tField&&
U.tField.length&&(l=new Tq,l.$n=new kk(x,U.tField.length),l.AIa=U,x+=U.tField.length,f+=U.tField.length,b.push(l));x+=1;a.$n.len=f;c.push(a)}return{mTe:b,JJe:c}}Dwi(){this.gU=this.vcd(!0)}Ewi(){this.gU===this.sBb.shapeText.length?this.nma=0:(this.nma=this.vcd(!1),this.gU+this.nma>this.sBb.shapeText.length?this.nma=this.sBb.shapeText.length-this.gU:this.gU+this.nma>this.Yeb.shapeText.length&&(this.nma=this.Yeb.shapeText.length-this.gU))}Owi(){this.BDb=this.sBb.shapeText.length-this.gU-this.nma;this.pXa=
this.Yeb.shapeText.length-this.gU-this.nma}Kwi(){const a=[];if(!this.gU)return a;this.oO.Vod(new kk(0,this.gU),new kk(0,this.gU));do this.q0=this.yDh(),0!==this.q0.Lq&&a.push(this.CRc(this.q0));while(0!==this.q0.Lq);return a}Uwi(){if(!this.BDb&&!this.pXa)return null;this.hWa=new kk(this.gU,this.BDb);this.Kla=new kk(this.gU,this.pXa);this.q0=!this.BDb&&0<this.pXa?new op(4):0<this.BDb&&!this.pXa?new op(5):new op(6);return this.CRc(this.q0)}Jwi(){const a=[];if(!this.pXa)return a;const b=new kk(this.gU-
1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.Ssg-1);this.oO.Vod(b,new kk(this.gU,this.pXa));do this.q0=this.Vyl(),0!==this.q0.Lq&&a.push(this.CRc(this.q0));while(0!==this.q0.Lq);return a}Lwi(){const a=[];if(!this.nma)return a;this.q0=null;this.oO.Vod(new kk(this.gU+this.BDb,this.nma),new kk(this.gU+this.pXa,this.nma));do this.q0=this.yDh(),0!==this.q0.Lq&&a.push(this.CRc(this.q0));while(0!==this.q0.Lq);return a}CRc(a){if(!a)return null;const b=new Kp;b.chngTyp=a.Lq;switch(a.Lq){case 3:b.charFrmtChng=
Object.assign(new xo,{txtrng:this.Kla,charPrp:this.rqe});break;case 2:b.paraFrmtChng=Object.assign(new Ew,{txtrng:this.Kla,paraPrp:this.sze});break;case 4:b.insChar=Dr.x1e(new yt(this.hWa,this.Yeb.shapeText.substring(this.Kla.cp,this.Kla.PG())));break;case 5:b.delChar=Dr.x1e(new yt(this.hWa,""));break;case 6:b.repChar=Dr.x1e(new yt(this.hWa,this.Yeb.shapeText.substring(this.Kla.cp,this.Kla.PG())))}return b}vcd(a){const b=this.sBb.shapeText,c=this.Yeb.shapeText,f=new kk(0,b.length),l=new kk(0,c.length);
let x=a?0:b.length-1,H=a?0:c.length-1;for(;f.contains(x)&&l.contains(H)&&b.charAt(x)===c.charAt(H);)x=a?x+1:x-1,H=a?H+1:H-1;return a?x:b.length-x-1}Vyl(){do{for(;this.oO.Dzl();){var a=this.oO.MLf(),b=this.oO.NLf();if(a&&b){var c=Bw(a.AIa,b.AIa);this.hWa=kk.copy(a.$n);this.Kla=kk.copy(b.$n);if(c)return this.rqe=c,new op(3)}}if(this.oO.u9b()&&(a=this.oO.JLf(),b=this.oO.KLf(),a&&b&&(c=wt(a.IHa,b.IHa),this.hWa=kk.copy(a.$n),this.Kla=kk.copy(b.$n),c)))return this.sze=c,this.oO.bEh(),new op(2)}while(this.oO.bEh());
return new op(0)}yDh(){do{for(;this.oO.Czl();){var a=this.oO.MLf(),b=this.oO.NLf();if(a&&b){var c=Bw(a.AIa,b.AIa);this.hWa=kk.copy(a.$n);this.Kla=kk.copy(b.$n);if(c)return this.rqe=c,new op(3)}}if(this.oO.cje()&&(a=this.oO.JLf(),b=this.oO.KLf(),a&&b&&(c=wt(a.IHa,b.IHa),this.hWa=kk.copy(a.$n),this.Kla=kk.copy(b.$n),c)))return this.sze=c,this.oO.aEh(),new op(2)}while(this.oO.aEh());return new op(0)}static x1e(a){return Object.assign(new Dw,{txt:a.text,txtrng:Dr.Mul(a.textRange)})}static Mul(a){return Object.assign(new Lm,
{cp:a.cp,len:a.len})}}Object(m.a)(Dr,"IncrementalChangeIterator",null,[]);class Fw{constructor(){this.rh=this.bh=this.increq=null}}Object(m.a)(Fw,"TextLayoutDeltaClientRequestData",null,[]);class Gw{constructor(){this.tb=null;this.h=this.w=0}}Object(m.a)(Gw,"TextLayoutFullClientRequest",null,[]);class Hw{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(m.a)(Hw,"TextLayoutRequest",null,[]);class Yu{constructor(a,b,c,f,l,x){this.Zfc=this.Nl=null;this.pdc=!0;this.OHa=
-1;this.Ock=(new Date).getTime();this.Vdb=this.Ila=0;this.kcc=-1;this.wqe=5E3;const H=document.createElement("a");H.href=a;H.protocol="http:"===H.protocol?"ws":"wss";this.NFb=H.href;this.G4=b;this.H0b();this.qGg=c;this.xHg=f;this.kck=l;this.Kze=x.Hul;this.p8c=x.Gul;this.MRg=x.Dul;this.x$c=x.Cul;this.Hma=this.MRg;this.SWe()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.kHb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.xHg&&this.xHg(a)}catch(b){xa.a.J(578828128,
824,50,(this.G4?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.qGg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.pdc;this.qGg(b)}this.pdc=!1}else xa.a.J(592304271,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){xa.a.J(592840414,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){xa.a.J(592840412,
820,10,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){xa.a.J(592840410,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.Ooc();this.ping();this.kck()}SWe(){this.Zfc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.kcc),this.Nl||(xa.a.J(587522389,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.gya())):this.kcc=
window.setTimeout(()=>{this.Nl&&(xa.a.J(587522387,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Nl.close(),this.Nl=null,window.clearTimeout(this.OHa))},this.wqe)};window.self.addEventListener("visibilitychange",this.Zfc)}H0b(){this.Nl&&this.Nl.close();this.Nl=new WebSocket(this.NFb,[]);this.Nl.onopen=Object(F.a)(this,this.onOpen,"onOpen");this.Nl.onerror=Object(F.a)(this,this.onError,"onError");this.Nl.onclose=Object(F.a)(this,
this.onClose,"onClose");this.Nl.onmessage=Object(F.a)(this,this.onMessage,"onMessage")}Ooc(){this.Ila=0}kQd(){0<this.x$c&&(new Date).getTime()-this.Vdb>this.x$c&&(this.Ooc(),xa.a.J(587337758,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}dUd(){return(new Date).getTime()-this.Vdb>this.Hma&&this.Ila<this.p8c&&(!this.Nl||3===this.Nl.readyState||2===this.Nl.readyState)}aWe(){this.Vdb=(new Date).getTime();this.Hma=Math.pow(2,this.Ila)*this.MRg;
0<this.x$c&&(this.Hma=Math.min(this.Hma,this.x$c));window.setTimeout(()=>{this.gya()},this.Hma)}gya(){this.kQd();this.dUd()&&(this.H0b(),this.aWe(),this.Ila++,xa.a.J(588071072,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.Ila===this.p8c&&xa.a.J(588071070,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.Nl?(xa.a.J(587804674,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",
pn[this.Nl.readyState]),1===this.Nl.readyState?this.Nl.send(xd.c(a)):this.gya()):xa.a.J(587522383,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.Nl?1===this.Nl.readyState?this.Nl.send("ping"+((new Date).getTime()-this.Ock).toString()):(xa.a.J(588294232,820,10,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.Nl.readyState),this.gya()):xa.a.J(587522380,820,50,(this.G4?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}kHb(){-1!==
this.OHa&&window.clearTimeout(this.OHa);this.OHa=window.setTimeout(()=>{this.ping()},this.Kze)}}Object(m.a)(Yu,"WebSocketTextLayoutFetcher",null,[1475]);class Er{constructor(a,b,c,f,l,x,H){this.dFb=this.mfb=this.byg=this.ayg=null;this.nextId=1;this.Dqe=-1;this.Cqe=0;this.oue=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");
if(!x)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Fa=a;this.jq=b;this.jfa=f;this.la=l;this.wU=-1;x.execute(U=>{this.mfb=U});this.la.Jul&&(this.ayg=new Yu(this.la.Ful,!1,Object(F.a)(this,this.p3j,"logOnResponseReceived"),Object(F.a)(this,this.Cyk,"onTextLayoutReceived"),Object(F.a)(this,this.o2g,"onConnectionOpen"),this.la),this.la.Yah&&(this.byg=new Yu(this.la.Eul,!0,Object(F.a)(this,this.o3j,"logOnDarkTrafficResponseReceived"),null,Object(F.a)(this,this.o2g,"onConnectionOpen"),this.la)));
this.Vea=H}rM(a,b,c){xa.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.wU){window.clearTimeout(this.wU);this.wU=-1;var f=this.jq.presentation;f?(a=Object(oa.a)(116,f.xC(M.a.UE(a,b))))?(c=a.iT(c))?c.Ulb(!1):xa.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):xa.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):xa.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}n3j(){this.Cqe++;
-1===this.Dqe&&(this.Dqe=window.setTimeout(Object(F.a)(this,this.Krk,"onCoauthLogTimer"),3E5))}Krk(){this.Dqe=-1;xa.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.Cqe);this.Cqe=0}w6f(a){let b="";a.LJ(c=>{(c=Object(oa.a)(Mb.AParagraphNode,c))&&(b+=Sb.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}Nwi(a){try{var b=Object,c=b.assign,f=new Fw,l=this.dFb;const ya=[];var x,H=l.QPb.bodyPrField,U=a.QPb.bodyPrField;let Va=!1;H.anchorField!==U.anchorField&&
(Va=!0);H.bInsField!==U.bInsField&&(Va=!0);H.tInsField!==U.tInsField&&(Va=!0);H.lInsField!==U.lInsField&&(Va=!0);H.rInsField!==U.rInsField&&(Va=!0);H.horzOverflowField!==U.horzOverflowField&&(Va=!0);H.vertOverflowField!==U.vertOverflowField&&(Va=!0);xd.c(H.normAutofitField)!==xd.c(U.normAutofitField)&&(Va=!0);xd.c(H.spAutoFitField)!==xd.c(U.spAutoFitField)&&(Va=!0);H.rotField!==U.rotField&&(Va=!0);H.spcFirstLastParaField!==U.spcFirstLastParaField&&(Va=!0);H.wrapField!==U.wrapField&&(Va=!0);(x=Va?
U:null)&&ya.push(Object.assign(new Kp,{chngTyp:1,bodyPrChng:x}));const hb=new Dr(l,a);var ja=ya.concat.apply(ya,hb.Mwi());const yb=c.call(b,f,{increq:ja});xa.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",xd.c(yb).length);return yb}catch(ya){xa.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",ya.message)}return null}R2d(a,b){if(this.la.qBh&&a)if(b&&xa.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),
this.jfa.Noi())if(0!==this.jfa.asi(a,this.Fa))a.Ulb(!1);else{if(!a.nCb)if(b)a.Ulb(this.la.dOb);else return;if(!a.DC&&a.rda().length&&(a.OLa||4===a.RK))try{const c=this.sae(a),f=Object.assign(new Hw,{id:this.nextId.toString(),corr:Ug.a.create().toString()});if(this.la.Iul)if(!this.dFb||b||this.oue)this.dFb=new Aw(this.w6f(a),c),this.oue=!1;else{const x=this.w6f(a),H=new Aw(x,c),U=Rq.a.fwb(xd.c(this.dFb.QPb));f.delta=this.Nwi(H);f.delta&&(f.delta.bh=U,f.delta.rh=Rq.a.fwb(xd.c(H.QPb)));if(f.delta&&!f.delta.increq.length)if(this.la.w1e)f.delta=
null;else return;if(f.delta&&f.delta.increq.length)for(const ja of f.delta.increq)if(ja.repChar){ja.repChar.txtrng.len===this.dFb.shapeText.length&&(f.delta=null);break}this.dFb=H}f.delta&&f.delta.increq.length&&!this.la.w1e||(f.full=Object.assign(new Gw,{tb:c,w:a.OLa?a.OLa.Right:a.get_widthPersisted(),h:a.OLa?a.OLa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.wU&&window.clearTimeout(this.wU);this.wU=window.setTimeout(()=>{this.rM(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.Kul);
f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.wU;f.h.reqHash=Rq.a.fwb(xd.c(c));f.h.reqSz=xd.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.w1e;const l=a.fmj();b&&l&&(f.h.initialTextLayout=l.toString());this.ayg.fetch(f);this.la.Yah&&this.byg.fetch(f)}catch(c){xa.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.n3j(),a.Ulb(!1)}AIf(a,b){switch(a.listType){case 16:b.buNoneField=
new vt;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new fq,{startAtField:a.xA});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new Wu,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new dm,b.buFontField.typefaceField=a.font}}cTa(a){const b=new ts;b.__type=Er.a_j;b.valField=Math.floor(1E5*a);return b}tAi(a){const b=new vs;var c=new tb.GraphIterator;c.set(a);c.rc(11);c.Jg(11);
a.Sf.jw(c)?this.AIf(a.Sf.jw(c),b):this.AIf(dj.a.wN(16,0),b);c=a.sa(ab.a.$l,Be.a.leftMargin);const f=a.sa(ab.a.sY,Be.a.rightMargin);b.indentField=ye.a.Vtd(a.sa(ab.a.eo,Be.a.indent));b.indentFieldSpecified=!0;b.marLField=ye.a.Vtd(c);b.marLFieldSpecified=!0;b.marRField=ye.a.Vtd(f);b.marRFieldSpecified=!0;b.defTabSzField=ye.a.Vtd(a.sa(ab.a.uub,Er.KIc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(ab.a.listLevel,Be.a.NEa);b.lvlFieldSpecified=!0;b.algnField=this.Aul(a.sa($a.a.Jl,1));b.algnFieldSpecified=
!0;2===this.Vea.LW(a).lineSpacing.unit&&(b.lnSpcField=new Xu,b.lnSpcField.itemField=this.cTa(this.Vea.LW(a).lineSpacing.value));2===this.Vea.LW(a).beforeSpacing.unit&&(b.spcBefField=new Xu,b.spcBefField.itemField=this.cTa(this.Vea.LW(a).beforeSpacing.value));2===this.Vea.LW(a).afterSpacing.unit&&(b.spcAftField=new Xu,b.spcAftField.itemField=this.cTa(this.Vea.LW(a).afterSpacing.value));a=Ta.OutlineElementNavigator.UA(a);a.properties.Sa($a.a.rY)&&(b.rtlField=a.Lh($a.a.rY));return b}Aul(a){switch(a){case 2:return 1;
case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}sae(a){try{const b=Object.assign(new py,{bodyPrField:new us,pField:[]});b.bodyPrField.noAutofitField=a.X$?new zw:null;a.Sa(kb.a.R2)&&(b.bodyPrField.normAutofitField=new ss,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.R2));a.Sa(kb.a.Jra)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new ss),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.Jra));b.bodyPrField.rotField=Math.floor(a.z1e);
b.bodyPrField.vertField=a.y6;b.bodyPrField.lInsField=Math.floor(Rf.a.pGb(a.Oia));b.bodyPrField.tInsField=Math.floor(Rf.a.pGb(a.Qia));b.bodyPrField.rInsField=Math.floor(Rf.a.pGb(a.Pia));b.bodyPrField.bInsField=Math.floor(Rf.a.pGb(a.Nia));b.bodyPrField.anchorField=a.$oa;b.bodyPrField.wrapField=a.q0c?0:1;this.Fa.LJ(a,c=>{if(c=Object(oa.a)(Mb.AParagraphNode,c)){var f=Object.assign(new qy,{itemsField:[]});f.pPrField=this.tAi(c);for(var l=Sb.ParagraphReader.text(c),x=0;x<c.Ra.length;){const U=new oy;U.__type=
"CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var H=c.Ra.ga(x);const ja=H.cp,ya=x<c.Ra.length-1?c.Ra.ga(x+1).cp:Sb.ParagraphReader.textLength(c);x++;H.formatting?U.rPrField=this.U7f(H.formatting.cache):(H=oi.c(c.Ra,H.cp).n1c,U.rPrField=H?this.U7f(H.cache):this.imj(a));U.tField=ha.a.substring(l,ja,ya);f.itemsField.push(U)}b.pField.push(f)}});return b}catch(b){throw xa.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");
}}U7f(a){const b=new wm;b.bField=a.isBold;b.bFieldSpecified=a.KTa;b.iField=a.isItalic;b.iFieldSpecified=a.J$a;b.uField=a.iE;b.uFieldSpecified=a.Xxb;b.strikeFieldSpecified=a.Wxb;b.strikeField=a.PF;b.szField=a.fontSize*Gf.a.bmc*Gf.a.S$a;b.szFieldSpecified=a.Lta;b.baselineFieldSpecified=a.Sa(kb.a.oN);b.baselineField=a.eb(kb.a.oN);b.capFieldSpecified=a.LTa;b.capField=a.capitalization;if(a.mbg){const c=Ya.a.xe(a.language);b.langField=c?c.Svb:"en-US"}a.Sa(kb.a.latinFont)&&(b.latinField=Object.assign(new dm,
{typefaceField:a.eb(kb.a.latinFont)}));a.Sa(kb.a.eastAsianFont)&&(b.eaField=Object.assign(new dm,{typefaceField:a.eb(kb.a.eastAsianFont)}));a.P3&&(b.rawSolidFillField=Object.assign(new Vu.a,{srgbClrField:Object.assign(new ny.a,{valField:Ib.a.hsb(a.fontColor)})}));a.QTa&&(b.highlightField=Object.assign(new nm.a,{srgbClrField:Object.assign(new ny.a,{valField:Ib.a.hsb(a.highlight)})}));a.Sa(kb.a.gtb)&&(b.spcField=a.eb(kb.a.gtb),b.spcFieldSpecified=!0);a.Sa(kb.a.BAb)&&(b.kernField=a.eb(kb.a.BAb),b.kernFieldSpecified=
!0);return b}imj(a){const b=new wm;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.iE;b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.PF;b.szField=a.Paa*Gf.a.bmc;b.szFieldSpecified=!!b.szField;const c=Ya.a.xe(a.VSa());b.langField=c?c.Svb:"en-US";a.Sa(kb.a.latinFont)&&(b.latinField=Object.assign(new dm,{typefaceField:a.eb(kb.a.latinFont)}));a.Sa(kb.a.eastAsianFont)&&(b.eaField=Object.assign(new dm,{typefaceField:a.eb(kb.a.eastAsianFont)}));
b.baselineField=a.oN;b.baselineFieldSpecified=!0;return b}p3j(a){if(a){xa.a.J(512493790,820,50,gl.c(a));var b=new Map;for(let l in a){var c=l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}kf.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else xa.a.J(512493791,820,50,"response data null")}o3j(a){a?xa.a.J(512493788,820,50,"Dark Traffic"+gl.c(a)):xa.a.J(512493789,820,50,"Dark Traffic response data null")}o2g(){this.oue=!0}B0f(a){var b=
this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.Glb(a,"cid"),f=this.Glb(a,"sid");a=this.Glb(a,"shapeId");if(!c||!f||!a)return xa.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(oa.a)(116,b.xC(M.a.UE(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.iT(Number.parseInvariant(a)):(xa.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}Cyk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&
a.h)xa.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.B0f(a.h))?this.R2d(a,!0):xa.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");else{if(xa.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?kf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new Oj.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),
kf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new Oj.a,{extendedProperties:b})))}}else if(this.la.dOb){b=this.Glb(a.h,"timeoutId");var c=this.Glb(a.h,"firstRequest");if(b&&-1!==this.wU&&this.wU===Number.parseInvariant(b))window.clearTimeout(this.wU),this.wU=-1;else if(!c||!Boolean.parse(c))return;if(b=this.B0f(a.h)){var f=this.Glb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",
a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),kf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new Oj.a,{extendedProperties:c})),xa.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.Ulb(!1)):b.Ulb(!0):(f=this.Glb(a.h,"reqHash"))?(c=this.sae(b),Rq.a.fwb(xd.c(c))!==f?xa.a.J(512493779,820,50,
"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.mfb&&this.mfb.Pbl(f,a.l,b),b.Tud(a.l))):xa.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else xa.a.J(512493782,820,50,"OnTextLayoutReceived - IShapeNode is null")}}Glb(a,b){return b in a?a[b].toString():null}}Er.a_j="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Er.KIc=1440;Object(m.a)(Er,"TextLayoutManager",null,[1253]);var Uq;(function(a){a[a.noWall=0]="noWall";
a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(Uq||(Uq={}));Object(m.b)("TextLayoutWall",Uq);var ry=d(866);class sy{constructor(a,b){this.qye=new Rd.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.bWa=a;this.jfa=b.tBh}yac(a){switch(a){case 1:return!!this.jfa.COAUTH;case 2:return!!this.jfa.LINEBREAKBLOBS;case 3:return!!this.jfa.TABLE;case 4:return!!this.jfa.SMARTART;
case 5:return!!this.jfa.NONRECTSHAPE}return!1}Noi(){return!this.yac(1)||this.bWa.RDa}osi(a,b){return a?this.yac(2)&&ry.a.xUf(a,b)?2:this.yac(3)&&a.ud?3:this.yac(4)&&a.Rf?4:this.yac(5)&&4!==a.RK?5:0:0}asi(a,b){b=this.osi(a,b);if(!this.qye.Hb(a.iMa)||this.qye.ga(a.iMa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.iMa.toString());c.set("IsShapeWalled",Uq[b]);kf.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",
Uq[b]),kf.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new Oj.a,{extendedProperties:c})))}this.qye.$(a.iMa,b);return b}}Object(m.a)(sy,"TextLayoutServiceWalls",null,[1252]);class zt{constructor(a,b,c,f){this.lq=a;this.Te=b.Ma;this.tO=c;this.A6c=f}initialize(){this.lq.DPa(Object(F.a)(this,this.uvf,"adjustShapeViews"))}dispose(){this.lq.mKb(Object(F.a)(this,this.uvf,"adjustShapeViews"))}uvf(a,b){if((a=b.oG)&&a.Fd&&(a=a.Fd.G3(c=>c.isEditable&&
c.MQ))&&a.length)for(const c of a)if(a=Object(oa.a)(117,c.mg(this.Te)))a.SHh(),c.ud&&a.Un&&a.yFl(),!this.A6c||this.tO&&!b.c0c||a.cO||!a.dB||a.Fzh()}}Object(m.a)(zt,"TextLocalRenderAdjustManager",null,[106]);class Iw{constructor(){this.dic=this.jEb=null;this.lug=-1;this.wcc=Date.now()}Nag(){return 0<=this.lug}}Object(m.a)(Iw,"LineBreakComparison",null,[]);class Zu{constructor(a){this.qH=new Rd.a;this.AFg=0;this.pBf="TextLayoutServiceAccuracy";this.Ohc=a}Obl(a,b){try{if(a&&b){var c=a.$D(),f=Rq.a.fwb(xd.c(b.sae(a)));
if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const x=di.a.ui(c[l],kb.a.cOb,null);x&&(b.push.apply(b,x.Lines),b.push(-1))}if(b.length){if(!this.qH.Hb(f))this.qH.add(f,new Iw);else if(this.qH.ga(f).Nag())return;this.qH.ga(f).jEb=b;this.mHf(f,a)}}}}catch(l){xa.a.J(512493704,820,10,l.message)}}Pbl(a,b,c){try{if(!this.qH.Hb(a))this.qH.add(a,new Iw);else if(this.qH.ga(a).Nag())return;this.qH.ga(a).dic=b;this.mHf(a,c)}catch(f){xa.a.J(512493703,820,10,f.message)}}mHf(a,b){if(this.qH.ga(a)&&this.qH.ga(a).jEb&&
this.qH.ga(a).dic){var c=!0;if(this.qH.ga(a).jEb.length!==this.qH.ga(a).dic.length)c=!1;else for(var f=0;f<this.qH.ga(a).jEb.length;f++)if(this.qH.ga(a).jEb[f]!==this.qH.ga(a).dic[f]){c=!1;break}xa.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.rda().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());kf.Health.instance.recordKpiUsage(this.pBf,0,"pptotext",
f);c||(f.set("UnifiedResponseLineCount",this.qH.ga(a).jEb.length.toString()),f.set("TextLayoutResponseLineCount",this.qH.ga(a).dic.length.toString()),kf.Health.instance.recordKpiFailure(this.pBf,"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new Oj.a,{extendedProperties:f})));this.qH.ga(a).lug=Date.now()}this.Bsi()}Bsi(){const a=Date.now();a-this.AFg<this.Ohc||(this.qH.keys.forEach(b=>{a-this.qH.get(b).wcc>this.Ohc&&this.qH.remove(b);return!0}),this.AFg=a)}}Object(m.a)(Zu,
"ServiceComparisonLineBreakTelemetry",null,[1254]);class $u{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Zb(a){this.K=a;this.K.register(yw,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().oa(()=>new yw(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(xw,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().oa(()=>
new xw(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ja("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,
a.Ja("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(zt,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().oa(()=>new zt(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").Ihg));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").qBh;xa.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",
b);b&&(this.K.register(1252,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().oa(()=>new sy(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1253,"PowerPointWebEditor.ITextLayoutManager").ma().oa(()=>{try{return new Er(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.AFrameworkApplication.Ke,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.Ja("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return xa.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(1254,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().oa(()=>new Zu(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bul)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.Ihg&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){z.a.instance.Dc(new $u)}}Object(m.a)($u,"PPTWebEditorTextEditingPackage",null,[2,3]);class av{constructor(){this.capabilities=
2}}Object(m.a)(av,"IExternalPeopleAPI",null,[]);class bv{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(m.a)(bv,"ExternalGrantAccessResponse",null,[]);class cv{constructor(a,b,c,f){this.authorImageURL=this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(m.a)(cv,"PersonaIconProperties",null,[]);var ws=d(919),Lp=d(666),ty=d(527);class gq extends av{constructor(a,b,c,f,l){super();this.MV=a;this.dYh=b;this.wcf=
c;this.QMh=l}f8g(a){this.MV.sya=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.MV.Dgg.continueWith(c=>{c.Tn||c.tm?(ia.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(Lp.a.Ys(-2130915318))):a(this.MV.Dgg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.MV.checkUserAccess([a]);f.continueWith(l=>{l.Tn||l.tm?(ia.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(Lp.a.Ys(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){ia.ULS.sendTraceTag(37582727,
380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.MV.pCa(a);f.continueWith(l=>{if(l.Tn||l.tm)ia.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),c(Lp.a.Ys(-2130915318));else{l=f.result;var x=!l.Canceled;for(var H of l.Result)if(!H.UserCanWrite&&!H.UserCanReview){x=!1;break}H=new bv(x,l);b(H)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const x=this.MV.getUserContacts(a,b,0,c,"AtMentions");
x.continueWith(H=>{H.Tn||H.tm?(ia.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(Lp.a.Ys(-2130915318))):f(x.result)})})}getAuthToken(){ia.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,b)=>{this.wcf.continueWith(c=>{c.Tn||c.tm?(ia.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(Lp.a.Ys(-2130915318))):this.wcf.result.hcj().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(ia.ULS.sendTraceTag(539100294,380,
15,"PeopleManager GetAuthToken use AAD token"),a(f.token)):u.AFrameworkApplication.fa.Ga("LokiUserDataSignature")?(ia.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.QMh.execute(l=>{l.d3i().then(x=>{void 0!==x&&null!==x&&0<x.length?(ia.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(x)):0<u.AFrameworkApplication.fa.Ga("LokiUserDataSignature").length&&(ia.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),
a(u.AFrameworkApplication.fa.Ga("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(ia.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(Lp.a.Ys(-2130915318))):(ia.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(Lp.a.Ys(-2130915318)))}).catch(f=>{ia.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(Lp.a.Ys(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>
{const c=[];for(const l of a){let x=null;var f=l;let H=l.Email;H&&""!==H||!l.UserId||""===l.UserId||"AD"!==l.Provider||(H=ty.a.E8a(l.UserId));H&&""!==H&&(x=this.MV.eub(H,l.Provider,u.AFrameworkApplication.gh,0),f=new ws.a(H,void 0,l.DisplayName));f=this.dYh.Gta(f,2);Array.add(c,new cv(l.DisplayName,l.UserId,f,x))}b(c)})}}Object(m.a)(gq,"ExternalPeopleAPI",av,[]);class uy{constructor(){this.J5a={};this.Fnb={};this.vGd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in
this.J5a?(b=this.J5a[a.UserId],!c||c in this.Fnb||(this.Fnb[c]=b)):c&&c in this.Fnb&&(b=this.Fnb[c],a.UserId&&(c in this.vGd?(delete this.vGd[c],this.J5a[a.UserId]=b):a.UserId in this.J5a||(b=null)));return b}add(a,b){a.UserId&&(this.J5a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.Fnb||(this.Fnb[c]=b,a.UserId||(this.vGd[c]=!0))}n5i(a){a=Array(a.lKc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of pa.a.lL(this.J5a))b=this.J5a[c],b.sources.contains(1)&&a[b.wGf]++;return a}normalize(a){return a?
a.toLowerCase():null}}Object(m.a)(uy,"ColorLookupDict",null,[]);class Vq{constructor(a,b){this.wGf=a;this.sources=new Ka.a;this.sources.add(b)}y7h(a){this.sources.contains(a)||this.sources.add(a)}}Object(m.a)(Vq,"ColorSource",null,[]);class At{constructor(a){this.ZQb=a;this.gNd=new uy;this.Igf=-1;this.ZMh=0}Gta(a,b,c=!0){if(!this.ZQb||!this.ZQb.lKc.length)return ia.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.b1i();else if(!a.UserId&&
!a.DisplayName)return ia.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.gNd.get(a);if(f)c=f.wGf,f.y7h(b);else{if(!c)return null;c=this.Cdj();this.gNd.add(a,new Vq(c,b));this.Igf=c}return this.t5i(this.ZQb.lKc[c])}Cdj(){const a=this.ZQb.lKc.length,b=this.gNd.n5i(this.ZQb),c=this.Gdg(this.Igf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.Gdg(f,a))||(l=!0);else break;l&&ia.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");
return f}Gdg(a,b){return(a+1)%b}b1i(){return"anonymous"+ ++this.ZMh}t5i(a){return 16777215>=a?"#"+ha.a.hw((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}Object(m.a)(At,"PeopleColorUtils",null,[1394]);class Wq{constructor(a,b,c,f,l,x){this.Egg=new ik.a;this.Eqa=a;this.I5a=b;this.Aqf=f;this.$a=c;this.Tga=l;this.Eqf=x;this.$a.gf(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=u.AFrameworkApplication.Ylb||u.AFrameworkApplication.PQ,b=this.$a.ka("PeopleEndPointIsEnabled");let c=b&&!a&&
(this.Alc||this.ENb&&this.FNb);const f=this.$a.ka("DisableAtmentionsForTeams"),l=this.$a.ka("ConsumerMentionsHostIsEnabled")||this.Aqf.mzh;c=c&&l&&this.kzh&&this.jzh&&!f;this.$a.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.$a.ka("OneDriveConsumerMentionsIsEnabled"));ia.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",
c,b,this.Alc,this.ENb,this.FNb,this.kzh,a,this.jzh);this.Egg.Gg(c);c&&this.Tga&&this.Tga.ek(4,Object(F.a)(this,this.SHe,"onInteractiveReady"))}SHe(){const a=this.$a.Bc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.tm||b.Tn)&&ia.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get ENb(){return this.I5a.ENb}get B0c(){return this.Eqf.B0c}get FNb(){return this.I5a.FNb}get Alc(){return this.I5a.Alc}get kzh(){return this.$a.ka("SupportsAddActivities")}get jzh(){return this.$a.ka("SupportsActivitiesNotification")}pCa(a){return this.I5a.pCa(a)}t1b(a,
b){return this.I5a.t1b(a,b)}get Dgg(){return this.Egg.task}get sya(){return this.Eqa.sya}set sya(a){this.Eqa.sya=a}checkUserAccess(a){ia.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.I5a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.I5a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.Aqf.getUserContacts(a,b,c,f,l)}eub(a,b,c,f){return this.Eqf.eub(a,b,c,f)}supportsExchangeRestApis(){const a=new ik.a,b=this.Eqa.supportsExchangeRestApis();b.continueWith(()=>
{b.tm||b.Tn?a.Gg(!1):a.Gg(!0)});return a.task}}Object(m.a)(Wq,"PeopleManager",null,[1393,1386]);var hq=d(380);class Bt{}Object(m.a)(Bt,"CheckUserAccessRequestItem",null,[]);class Jw extends hq.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.CXd(c)}CXd(a){const b=[];for(const c of a)Array.add(b,Object.assign(new Bt,{Id:c.UserId,Provider:c.Provider}));return b}Zk(){return 1}}Object(m.a)(Jw,"CheckUserAccessRequest",hq.a,[]);class Kw extends hq.a{constructor(a,b,c,f,l,x,H){super(a,b);
this.Filter=null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=x;this.Skip=l;this.Scenario=H}Zk(){return 2}}Object(m.a)(Kw,"GetUserContactsRequest",hq.a,[]);class Lw extends hq.a{constructor(a,b,c,f,l,x,H){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.CXd(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=x;this.GrantReviewAccess=H}CXd(a){const b=[];
for(const c of a)Array.add(b,Object.assign(new Bt,{Id:c.UserId,Provider:c.Provider}));return b}Zk(){return 4}}Object(m.a)(Lw,"GrantUserAccessRequest",hq.a,[]);class Ct extends hq.a{constructor(a,b){super(a,b)}Zk(){return 5}}Object(m.a)(Ct,"SupportsExchangeRestApisRequest",hq.a,[]);var Fr=d(526);class Mw{constructor(a,b,c,f){this.sya=null;this.CZh=a;this.l2a=b;this.$a=c;this.w2a=f}get c1k(){return this.$a.Bc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return ia.ULS.sendTraceTag(37757202,
380,15,"no user in the request"),a=new ik.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;ia.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new ik.a,c=this.w2a.execute(new Jw(this.l2a(),null,a),(f,l,x)=>this.ENc(f,l,x,"CheckUserAccess"),this.sya);c.continueWith(()=>{if(c.Tn||c.tm)b.rG(c.Yi);else{var f=this.dDk(c.result.Wi);b.Gg(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return ia.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new ik.a,a.Gg(null),a.task;ia.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const x=new ik.a,H=this.w2a.execute(new Lw(this.l2a(),null,a,b,c,f,l),(U,ja,ya)=>this.ENc(U,ja,ya,"GrantUserAccess"),this.sya);H.continueWith(()=>{if(H.Tn||H.tm)ia.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",H.Yi),x.rG(H.Yi);else{var U=this.FCk(H.result.Wi);x.Gg(U)}});return x.task}dDk(a){if(!a.data)return ia.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Sd)return ia.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=Fr.a.U7a(a.data.Sd);return a?a.Result?a.Result:(ia.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(ia.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}FCk(a){if(!a.data)return ia.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.Sd)return ia.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=Fr.a.U7a(a.data.Sd);return a?a.Result?a.Result:(ia.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(ia.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const x=new ik.a,H=this.w2a.execute(new Kw(this.l2a(),null,a,b,c,f,l),(U,ja,ya)=>this.ENc(U,ja,ya,"GetUserContacts"),
this.sya);H.continueWith(()=>{if(H.Tn||H.tm)x.rG(H.Yi);else{var U=H.result;try{const ja=this.cDk(U.Wi);x.Gg(ja.Result)}catch(ja){x.rG(ja)}}});return x.task}cDk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.Sd)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=Fr.a.U7a(a.data.Sd);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new ik.a,b=this.w2a.execute(new Ct(this.l2a(),null),(c,f,l)=>this.ENc(c,f,l,"SupportsExchangeRestApisRequest"),this.sya);b.continueWith(()=>{b.Tn||b.tm?(a.rG(b.Yi),ia.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(ia.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.PM(!0))});return a.task}ENc(a,b,c,f){return this.CZh.Wqb(a,2,c,b,2,f,null,!1,null,this.c1k)}}Object(m.a)(Mw,"PeopleRequestHandler",null,[1395]);class Dt{constructor(a,
b){this.MV=a;this.Ca=b;this.Ca.ya(G.a.hsi,de.a.frame,Object(F.a)(this,this.csi,"checkUserAccessAction"));this.Ca.ya(G.a.xnj,de.a.frame,Object(F.a)(this,this.wnj,"getUserContactsAction"));this.Ca.ya(G.a.gsi,de.a.frame,Object(F.a)(this,this.esi,"checkUserAccessAndGrantPermissionsAction"));this.Ca.ya(G.a.Bnj,de.a.frame,Object(F.a)(this,this.Anj,"getUserProfilePictureAction"));this.Ca.ya(G.a.Qrl,de.a.frame,Object(F.a)(this,this.Rrl,"supportsExchangeRestApisTestAction"))}Rrl(){this.supportsExchangeRestApis();
return 32}csi(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}wnj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}esi(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.pCa(a);return 32}Anj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.z8f(a);return 32}zmh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.pCa(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.z8f(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}il.Task.delay(5E3).continueWith(()=>{this.zmh()})}i4k(){window.setTimeout(Object(F.a)(this,
this.zmh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.MV.supportsExchangeRestApis();a.continueWith(b=>{if(b.tm)alert("Exception: "+b.Yi.message);else{b=a.result;var c=new jj.StandardDialog;c.xd=0;c.Xe(1,"Close");document.createElement("pre").innerText=b.toString();c.Gx("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}z8f(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.f8i(a)}catch(l){alert("Invalid dimension value");return}Db.a.instance.Ja("Common.App.People.IPeopleManager").execute(l=>
{var x=l.eub(b,c,u.AFrameworkApplication.gh,f);l=document.createElement("img");l.src=x;x=new jj.StandardDialog;x.xd=0;x.Xe(1,"Close");x.Gx("Profile photo",null,3,null,l)})}f8i(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.MV.t1b(a,"O365");
const b=this.MV.checkUserAccess(a);b.continueWith(c=>{if(c.tm)alert("Exception: "+c.Yi.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new jj.StandardDialog;l.xd=0;l.Xe(1,"Close");f=document.createElement("pre");f.innerText=c;l.Gx("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.MV.t1b(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),x=0<=c.toUpperCase().indexOf("REVIEW"),H=this.MV.grantUserAccess(a,b,f,l,x);H.continueWith(U=>{if(U.tm)alert("Exception: "+U.Yi.message);else{U=H.result;var ja="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(x?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const ya of U.Result)ja+="User: "+ya.Id+"\nMessage: "+ya.Message+"\nStatus Code: "+ya.Status+"\nProvider: "+ya.Provider+"\n\n";alert(ja)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.MV.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(x=>{if(x.tm)alert("Something went wrong"+x.Yi.message);else if(x.Tn)alert("Task was canceled");else{var H=l.result;x="";for(var U of H)H="ID => "+U.Id+" \n",H+="Provider => "+U.Provider+" \n",H+="DisplayName => "+U.DisplayName+" \n",H+="GivenName => "+U.GivenName+" \n",H+="Surname => "+U.Surname+" \n",H+="Email => "+U.Email+" \n",H+="Title => "+U.Title+" \n",x+=H+"----------------------\n";U=new jj.StandardDialog;U.xd=0;U.Xe(1,"Close");H=document.createElement("pre");H.innerText=x;
U.Gx("Contacts",null,3,null,H)}})}pCa(a){a=a.split(";");a=this.MV.t1b(a,"O365");const b=this.MV.pCa(a);b.continueWith(c=>{if(c.tm)alert("Exception: "+c.Yi.message);else{c=b.result;var f="";for(var l of c.Result){var x=[];Array.add(x,l.UserCanRead?"Read YES":"Read NO");Array.add(x,l.UserCanReview?"Review YES":"Review NO");Array.add(x,l.UserCanWrite?"Write YES":"Write NO");x=l.Id+"=>"+x.join(" | ");f+=x+"\r\n"}l=new jj.StandardDialog;l.xd=0;l.Xe(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Gx("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(m.a)(Dt,"PeopleTestHook",null,[]);var yo=d(213);class Nw{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(m.a)(Nw,"ShowSharingUiRequestBody",null,[]);class Gr{constructor(a,b){this.e5a=null;this.ZCc=new ik.a;this.UWb=new Nw(this.WEi(),a,b);ia.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.UWb.Persons?
this.UWb.Persons.length:0,this.UWb.UserPermissionsVerified)}get D2k(){return this.ZCc.task}get id(){return this.UWb.Id}get payload(){return this.UWb}Jcl(a){this.e5a=a;this.xIl()?this.ZCc.PM(this.e5a):this.ZCc.rG(Error.format("Format of the "+jf.a.RUd+" body is not valid"))}setException(a){ia.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.ZCc.rG(a)}WEi(){return Gr.NSh++}yIl(a){if(void 0===a.Id)return ia.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return ia.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(ia.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(ia.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):ha.a.Kzb(a.Status)?!0:(ia.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}xIl(){if(void 0===this.e5a.Persons)return ia.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!cb.a.isArray(this.e5a.Persons))return ia.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.e5a.Persons.length;a++)if(!this.yIl(this.e5a.Persons[a]))return!1;return void 0===this.e5a.DialogCanceled?(ia.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(ia.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):ha.a.Kzb(this.id)?!0:(ia.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}Gr.NSh=0;Object(m.a)(Gr,"PostmessageRequestState",null,[]);class Et{constructor(a){this.lJd=new yo.a;this.qTb=this.n3a=null;this.Xdf=!1;this.GNa=a}FCj(){ia.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.qTb)return this.qTb.task;this.qTb=new ik.a;this.GNa.continueWith(()=>{ia.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.n3a=this.GNa.result;this.Tde();this.qTb.Gg(!0)});return this.qTb.task}Tde(){this.Xdf||(ia.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.Xdf=!0,this.n3a.wu(jf.a.RUd),this.n3a.HB(jf.a.RUd,Object(F.a)(this,this.fsi,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}fsi(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)ia.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.lJd.Uf(a.Id)).returnValue?(ia.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.Jcl(a),this.lJd.remove(a.Id)):ia.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else ia.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}dsi(a,b){const c=new Gr(a,b);this.FCj().continueWith(()=>{const f=Ug.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,
f);ia.ULS.sendTraceTag(25036179,380,50,l);this.n3a.sendMessage(jf.a.pCa,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.lJd.add(c.id,c)});return c.D2k}}Object(m.a)(Et,"ShowSharingUiPostMessageHandler",null,[]);class dv{}Object(m.a)(dv,"GrantUserAccessResponse",null,[]);var Zh=d(82);class ev extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.tEk=a;this.MLa=c;this.scenario=f}}Object(m.a)(ev,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class Ft{static XCi(a){return Zh.a.sC(Ft.so,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}Ft.so="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(m.a)(Ft,"ShareAndNotifyDialogHtml",null,[]);class Gt extends Zh.a{constructor(a,b,c){super();this.oNa=!1;this.Pa=new wc.a;this.fYh=a;this.Z2h=Gt.N_i(a);this.$v=b;this.BZ=c}Mai(a){this.Pa.addHandler("SNEK",a)}WYe(){this.rg=Ft.XCi(this.Z2h);this.xd=8;this.hg="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(F.a)(this,this.fgl,"shareAndNotifyDialogResultHandler"));this.c6("ShareAndNotifyDialogTextId")}fxa(){}dispose(){this.oNa||(super.dispose(),this.oNa=!0)}fgl(a){this.Pa.raiseEvent("SNEK",new ev(this.fYh,a,this.$v,this.BZ))}static N_i(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(m.a)(Gt,"ShareAndNotifyDialog",Zh.a,[]);class Ow{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(m.a)(Ow,"ShowSharingUiRequestPerson",null,[]);class iq{constructor(a,b,c,f,l,x){this.Eqa=a;this.$a=b;this.r0h=c;this.UV=f;this.UNh=l;this.Zd=x}get ENb(){return this.$a.ka("SupportsCheckUserAccess")}get FNb(){return this.$a.ka("SupportsGrantUserAccess")}get Alc(){return this.$a.ka("PermissionsPostMessage")&&!this.$a.ka("CrossDocumentMessengerDisabled")&&this.UNh()}pCa(a){const b=new ik.a;if(cb.a.Wa(a))return b.Gg(this.UV.PQa([])),b.task;let c;const f=({p_b:c}=this.UV.I5e(a)).returnValue,
l=iq.uAi(f);0<f.length?this.Alc?this.lll(f,b,c,l):this.ENb&&this.FNb&&this.WYe(l,b,"mention"):b.Gg(this.UV.PQa(a));return b.task}lll(a,b,c,f){const l=Date.now();ia.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const x=this.r0h.dsi(f,c);c=new af.a(4,1,this.$a.Bc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(F.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.Zd.Db(c);c.customData=x;x.continueWith(H=>{if(H.tm)ia.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",H.Yi?H.Yi.message:"No inner exception"),b.rG(H.Yi);else{H=x.result;this.UV.BCl(H);var U=this.UV.PQa(a);U.Canceled=H.DialogCanceled;b.Gg(U);ia.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){ia.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.Tn?ia.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.tm?ia.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||ia.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):ia.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}WYe(a,b,c){a=new Gt(a,b,c);a.Mai(Object(F.a)(this,this.Sxk,"onShareAndNotify"));a.WYe()}Sxk(a,b){let c;const f=iq.yAi(b.tEk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.tm?(ia.ULS.sendTraceTag(36300674,380,15,
"GrantUserAccess from OnShareAndNotify failed with exception. {0}",l.Yi?l.Yi.message:"No inner exception"),b.MLa.rG(l.Yi)):(ia.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.UV.PQa(f),c.Canceled=!1,b.MLa.Gg(c))});break;default:ia.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.UV.PQa(f),c.Canceled=!0,b.MLa.Gg(c)}}checkUserAccess(a){const b=new ik.a;if(!this.ENb)return ia.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),
b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),b.task;if(!a||!a.length)return b.Gg(this.UV.PQa([])),b.task;let c;const f=({p_b:c}=this.UV.I5e(a)).returnValue;if(c)ia.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Gg(this.UV.PQa(a));else{const l=this.Eqa.checkUserAccess(f);l.continueWith(()=>{if(l.Tn||l.tm)ia.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));
else{ia.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var x=l.result;x&&this.UV.zCl(x);x=this.UV.PQa(a);b.Gg(x)}})}return b.task}grantUserAccess(a,b,c,f,l){const x=new ik.a;if(!this.FNb)return ia.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),x.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),x.task;if(!a||!a.length)return x.Gg(this.UV.VJf([])),x.task;let H;const U=({p_b:H}=
this.UV.I5e(a)).returnValue;if(H)ia.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),x.Gg(this.UV.VJf(a));else{const ja=this.Eqa.grantUserAccess(U,b,c,f,l);ja.continueWith(()=>{if(ja.Tn||ja.tm)ia.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),x.setException(Error.create("GrantUserAccess Call failed."));else{ia.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var ya=ja.result;this.UV.ACl(ya,c,f,l);ya=Object.assign(new dv,{Result:ya});
x.Gg(ya)}})}return x.task}t1b(a,b){const c=[];for(const f of a)c.push(new ws.a(f,b));return c}static uAi(a){const b=[];for(const c of a)a=new Ow(c.UserId,c.Provider,""),b.push(a);return b}static yAi(a){const b=[];for(const c of a)a=new ws.a(c.Id,c.Provider),b.push(a);return b}}Object(m.a)(iq,"UserAccessUtils",null,[1386]);class Pw{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=
a.Title)}}Object(m.a)(Pw,"PersonaProperties",null,[]);class fv{constructor(a,b){this.Dnf=[];this.dyd=[];this.yhf=-1;this.$a=a;this.Eqa=b}get mzh(){return this.$a.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){ia.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const x=new Map;x.set("Limit",b.toString());x.set("SearchGal",f.toString());x.set("Scenario",l);kf.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser",
"wackpitesting",x);if(!this.mzh)return ia.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),kf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new ik.a,a.rG(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return ia.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),kf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser",
"LimitShouldBeGreaterThanZero",!1,!0,null),a=new ik.a,a.rG(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===l&&ia.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.yhf&&!a&&!f)return a=new ik.a,c=this.dyd.slice(0,Math.max(b-1,this.dyd.length-1)),c=this.GYg(this.Dnf,c),a.Gg(c),a.task;const H=new ik.a;let U;try{U=this.Eqa.getUserContacts(a,b,c,f,l)}catch(ja){return H.rG(ja),H.task}if(f||"AtMentions"!==l)return U;U.continueWith(ja=>{if(ja.Tn||ja.tm){ja=ja.Tn?
"Canceled":ja.Yi.message;ia.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",ja);var ya=new Map;x.set("ErrorMessage",ja);ya=Object.assign(new Oj.a,{extendedProperties:ya});kf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,ya);H.rG(Error.create(ja))}else this.dyd=ja=U.result,this.yhf=b,ja=this.GYg(this.Dnf,ja),H.Gg(ja)});return H.task}GYg(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>
{this.Gtf(f,c)});b.forEach(f=>{this.Gtf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}Gtf(a,b){if(a&&(a=new Pw(a),a.Email&&a.DisplayName&&a.Id&&a.Provider)){const c=b[this.GKf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.GKf(a)]=a}}GKf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(m.a)(fv,"UserContactsUtils",null,[1385]);class Qw{}Object(m.a)(Qw,"CheckUserAccessResponse",null,[]);class Rw{}Object(m.a)(Rw,"GrantUserAccessResponseItem",
null,[]);class gv{}Object(m.a)(gv,"UserPermissions",null,[]);class Qo{constructor(){this.ZM=new Yc.a;this.X_e=0}I5e(a){let b;const c=[];if(!a)return ia.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,p_b:!1};if(!a.length)return ia.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,p_b:!1};b=!0;const f={};for(const l of a){a=
Qo.zXd(l);if(a in f)continue;f[a]=!0;const x=({value:a}=this.ZM.Uf(Qo.zXd(l))).returnValue;x&&(!a||a.UserCanWrite||a.UserCanReview)||Array.add(c,l);b=b&&x}return{returnValue:c,p_b:b}}zCl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.ZM.remove(Qo.oLc(b));this.ZM.add(Qo.oLc(b),b)}}ACl(a,b,c,f){if(!a)throw Error.argumentNull("result");
for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const x=Qo.AXd(l.Id,l.Provider);({value:a}=this.ZM.Uf(x)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new gv,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.ZM.remove(x),this.ZM.add(x,a))}}}BCl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");
a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");for(let b=0;b<a.length;b++){const c=new gv,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?ia.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.X_e,c.UserCanWrite=f.Status===this.X_e,c.UserCanReview=f.Status===this.X_e,c.Id=f.Id,c.Provider=f.Provider,this.ZM.remove(Qo.oLc(c)),
this.ZM.add(Qo.oLc(c),c))}}y8f(a){const b=[];for(const c of a)a=Qo.zXd(c),this.ZM.Hb(a)&&Array.add(b,this.ZM.ga(a));return b}PQa(a){a=this.y8f(a);return Object.assign(new Qw,{Result:a,Canceled:!1})}VJf(a){a=this.y8f(a);const b=[];for(const c of a)b.push(Object.assign(new Rw,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new dv,{Result:b,Canceled:!1})}static oLc(a){return Qo.AXd(a.Id,a.Provider)}static zXd(a){return Qo.AXd(a.UserId,
a.Provider)}static AXd(a,b){return b+a}}Object(m.a)(Qo,"UserPermissionsCache",null,[1384]);class Ht{constructor(a,b,c,f){this.Eqa=a;this.$a=b;this.b3h=c;this.$2h=f}eub(a,b,c,f){var l=this.Eqa.sya;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new Ee.QueryStringBuilder(l);l.yi("oid","3");l.yi("bdqs",c);(c=this.mAi(f))&&2<=c.length&&(f=c[1],l.yi("w",c[0]),l.yi("h",f));l.yi("uid",a);l.yi("p",b);l.yi("usid",this.b3h);l.yi("WacUserType",this.$2h);return l.toString()}mAi(a){switch(a){case 1:return["48",
"48"];case 2:return["64","64"];case 3:return["96","96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get B0c(){return this.$a.ka("IsUserProfilePictureResolutionEnabled")}}Object(m.a)(Ht,"UserProfilePictureUtils",null,[1382,1383]);var It=d(573);class hv{get name(){return"Common.App.People"}Zb(a){a.register(Mw,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().oa(()=>
new Mw(u.AFrameworkApplication.Ke,()=>u.AFrameworkApplication.gh,u.AFrameworkApplication.fa,new Fr.a));a.register(Qo,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(Et,"Common.App.People.ShowSharingUiPostMessageHandler").ma().oa(()=>new Et(Pq.a.$u(a.Ja("Postmessage.IHostPostmessenger"))));a.register(iq,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().oa(()=>new iq(a.resolve("Common.App.People.PeopleRequestHandler"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),It.a,gm.a.instance));a.register(fv,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().oa(()=>new fv(u.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(Ht,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().oa(()=>
new Ht(a.resolve("Common.App.People.PeopleRequestHandler"),u.AFrameworkApplication.fa,u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.userType));a.register(At,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().oa(()=>new At(a.ub("Common.IColorTable")));a.register(Wq,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().oa(()=>new Wq(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),gb.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(gq,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().oa(()=>new gq(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),Pq.a.$u(a.Ja("Common.ILokiTokenManager")),u.AFrameworkApplication.fa,a.Ja("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.gf(Object(F.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){const a=Db.a.instance.resolve("Common.App.People.IPeopleManager");Db.a.instance.resolve("Common.App.People.IExternalPeopleAPI");u.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new Dt(a,u.AFrameworkApplication.Ta)).i4k()}dispose(){}static main(){z.a.instance.Dc(new hv)}}Object(m.a)(hv,"PeoplePackage",null,[2,3]);var jq={};jq.WPb=function(){function a(){return H()&&(fc()||3<=(hb()?Kc("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(Ld){Ld=(new RegExp(Ld+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Oe=-1;null!=Ld&&2<=Ld.length&&(Oe=parseFloat(Ld[1]),isNaN(Oe)&&(Oe=-1));return Oe}function l(){xm||(xm=!0,Nk=f("Windows Phone"));return 8<=Nk}function x(){return"function"==typeof navigator.msLaunchUri&&!c()&&!Zb()&&!U()}function H(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function U(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ja(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function ya(){return ja()?8==window.document.documentMode:!1}function Va(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function hb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function yb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Zb(){var Ld=window.navigator.userAgent.toLowerCase();
return 0<=Ld.indexOf("android")&&0<=Ld.indexOf("chrome")}function fc(){return 3<=(Va()?Kc("firefox/"):0)}function Kc(Ld){var Oe=window.navigator.userAgent.toLowerCase(),yf=Oe.indexOf(Ld);return 0<=yf?parseInt(Oe.substring(yf+Ld.length,Oe.length)):0}function Lc(Ld,Oe,yf,le,Fg){if(le&&null!=Oe)Oe();else if(x())navigator.msLaunchUri(Ld,Oe,yf);else if(!(yb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&H())||U())ae(Ld,Oe,
yf);else if(yb()&&Fg)a:{try{window.open(Ld,"_self")}catch($h){null!=yf&&yf();break a}null!=Oe&&Oe()}else Gc(Ld,Oe,yf)}function Gc(Ld,Oe,yf){var le=document.getElementById("OICLinkTag");null==le&&(le=document.createElement("a"),le.id="OICLinkTag",le.style.visibility="hidden",le.href="",0==(vh.Options&pi.SupportsTopTargetNavigation)||vh.NoBrowserModalDialogs?le.target="_blank":le.target="_top",document.body.appendChild(le),null!=le.addEventListener&&le.addEventListener("click",function(Fg){null!=Fg.stopPropagation&&
Fg.stopPropagation()},!1));try{le.href=Ld,le.click()}catch(Fg){null!=yf&&yf();return}null!=Oe&&Oe()}function ae(Ld,Oe,yf){var le=document.getElementById("OICFrame");null==le&&(le=document.createElement("iframe"),le.className="ObjectInDialog",le.style.visibility="hidden",le.src="about:blank",document.body.appendChild(le),le.id="OICFrame");try{le.contentWindow.location.href=Ld}catch(Fg){null!=yf&&yf();return}null!=Oe&&Oe()}function we(Ld){return 0!=(Ld.Options&pi.SkipProtocolHandler)||ya()}function $d(Ld){return Ld===
Ok.ReadOnly||Ld===Ok.ReadWrite}function Te(Ld,Oe,yf,le){var Fg;try{var $h=new ActiveXObject("SharePoint.OpenDocuments.4");return(Fg=$h.ViewDocument3(window.self,Ld,Oe,le))?(Mk(qi.O14ActiveX),Hg.None):Hg.Failed}catch(ji){}if(pi.O14Only===(yf&pi.O14Only))return vh.DescriptiveUnattemptedEnums?Hg.O14AttemptFailure:Hg.Unattempted;try{return $h=new ActiveXObject("SharePoint.OpenDocuments.3"),(Fg=$h.ViewDocument3(window.self,Ld,Oe,le))?(Mk(qi.O12ActiveX),Hg.None):Hg.Failed}catch(ji){}if(pi.O12UpOnly===(yf&
pi.O12UpOnly))return vh.DescriptiveUnattemptedEnums?Hg.O12UpOnlyFail:Hg.Unattempted;try{return $h=new ActiveXObject("SharePoint.OpenDocuments.2"),(Fg=$d(Oe)?$h.ViewDocument2(window.self,Ld,le):$h.EditDocument2(window.self,Ld,le))?(Mk(qi.O11ActiveX),Hg.None):Hg.Failed}catch(ji){}return vh.DescriptiveUnattemptedEnums?Hg.ActiveXUnattempted:Hg.Unattempted}function Ze(Ld,Oe,yf,le,Fg){Ld==hg.Visio&&yf==Ok.ReadWrite&&(yf=Ok.WriteOnly);le=le||c()&&!l();if(!le){le="";if(Ld==hg.PowerPoint){Ld=le;le=vh.DocumentExtension;
yf=$d(yf);var $h=new Set([".pot",".potm",".potx"]),ji=new Set([".pps",".ppsm",".ppsx"]);yf=yf&&$h.has(le)?"nft|ofc|":yf&&ji.has(le)?"ofv|ofs|t|":!yf&&ji.has(le)?"ofe|ofs|t|":yf?"ofv|ofc|":"ofe|";yf=Ld+yf}else yf=$d(yf)?le+"ofv|ofc|":le+"ofe|";Fg+=gg(yf+"u|")}Fg+=gg(Oe);vh.NewTelemetryDataIsEnabled&&(Oe=vh.SessionOrigin?"|or|"+vh.SessionOrigin:"",Oe+=vh.ClickTime?"|ct|"+vh.ClickTime:"",Oe+=vh.CorrelationId?"|cid|"+vh.CorrelationId:"",Fg+=gg(Oe));Oe=window.location.href;yf=Oe.toLowerCase().indexOf("&wdlor=");
-1!=yf?(yf+=7,Ld=Oe.indexOf("&",yf),Oe=-1==Ld?Oe.substr(yf):Oe.substring(yf,Ld)):Oe=void 0;if(null!=Oe&&"undefined"!=typeof Oe){yf="";try{yf=decodeURIComponent(Oe)}catch(Zn){}0<yf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(yf)&&(Fg=Fg+"|f|"+yf)}return Fg}function Vf(Ld,Oe,yf,le,Fg,$h){var ji=fj(Ld);if(null==ji)return Cj(vh.DescriptiveUnattemptedEnums?Hg.ProtocolHandlerIsNull:Hg.Unattempted,vh.Application),!1;Ld=Ze(Ld,Oe,yf,le,ji);Lc(Ld,Qg,Rg,Fg,$h);return!0}function gg(Ld){if(H()&&
yb()){var Oe="";try{Oe=decodeURI(Ld)}catch(yf){}if(Oe==Ld)return encodeURI(Ld)}return Ld}function Qg(){Mk(qi.ProtocolHandler)}function Rg(){vh.Options|=pi.SkipProtocolHandler;Gi(vh,Wj,sk)}function Wf(){null!=kl&&kl(qi.RoamingProtocolHandler)}function rg(){null!=vj&&vj(Hg.ControlNeeded)}function Sg(){var Ld=document.getElementById("npSharePointPlugin");if(null==Ld){Ld="application/x-sharepoint";H()&&3<=(hb()?Kc("version/"):0)&&Gh("application/x-sharepoint-webkit",!0)&&(Ld="application/x-sharepoint-webkit");
if(!Gh(Ld,!0))if(H()&&Gh("application/officelive",!0))Ld="application/officelive";else return null;var Oe=document.createElement("object");Oe.id="npSharePointPlugin";Oe.type=Ld;Oe.style.width="0px";Oe.style.height="0px";Oe.style.setProperty("visibility","hidden","");document.body.appendChild(Oe);Ld=document.getElementById("npSharePointPlugin")}return Ld}function Gh(Ld,Oe){var yf=window.navigator.mimeTypes;if(null==yf)return!1;Ld=yf[Ld];return!Ld||Oe&&!Ld.enabledPlugin?!1:!0}function Zi(Ld){try{if(null!=
new ActiveXObject(Ld))return!0}catch(Oe){}return!1}function Ei(Ld){switch(Ld){case hg.OneNote:return"OneNote.Notebook";default:return""}}function fj(Ld){if(Ld!=hg.OneNote&&c()&&!l())return"office:";switch(Ld){case hg.Excel:return"ms-excel:";case hg.OneNote:return"onenote:";case hg.PowerPoint:return"ms-powerpoint:";case hg.Visio:return"ms-visio:";case hg.Word:return"ms-word:";case hg.Project:return"ms-project:";case hg.Publisher:return"ms-publisher:";case hg.Infopath:return"ms-infopath:";case hg.Access:return"ms-access:";
default:return""}}function Fi(Ld){switch(Ld){case hg.Excel:return"root\\office15\\excel.exe";case hg.PowerPoint:return"root\\office15\\powerpnt.exe";case hg.Visio:return"root\\office15\\visio.exe";case hg.Word:return"root\\office15\\winword.exe";case hg.Project:return"root\\office15\\winproj.exe";case hg.Publisher:return"root\\office15\\mspub.exe";case hg.Infopath:return"root\\office15\\infopath.exe";case hg.Access:return"root\\office15\\msaccess.exe";default:return null}}function Gi(Ld,Oe,yf){vh=
Ld;Wj=Oe;sk=yf;if(Ld.DocumentUrl){var le=yf=Oe=Ld.DocumentUrl;try{le=decodeURIComponent(Ld.DocumentUrl)}catch(zo){}try{yf=encodeURI(Ld.DocumentUrl)}catch(zo){}Oe=Oe+""+Ld.CorrelationIdForWinClient;le+=Ld.CorrelationIdForWinClient;yf+=Ld.CorrelationIdForWinClient;Ld.Mode===Ok.ReadWrite&&pi.CheckoutRequired===(Ld.Options&pi.CheckoutRequired)&&(Ld.Mode=Ok.ForceCheckout);pi.HostIsEditOnly===(Ld.Options&pi.HostIsEditOnly)&&(Ld.Mode=Ok.WriteOnly);if(we(Ld)?0:H()&&(Ld.Application==hg.OneNote||Gh("application/x-sharepoint-protocolhandler",
!1)||Gh("application/x-sharepoint-webkit-protocolhandler",!1))||x()||Zb()||!(a()||fc()||"ActiveXObject"in window&&!c()||yb())||15<=Bk())Vf(Ld.Application,Ld.EncodeUrl?yf:Oe,Ld.Mode,Ld.Application==hg.OneNote,Ld.SilentExternalHandler,Ld.NavigateUsingWindowOpen);else{var Fg;if(Fg=ya())a:{var $h=Ld.EncodeUrl?Oe:le,ji=Ld.Mode,Zn=Ei(Ld.Application);try{Fg=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,$h,ji,Zn);break a}catch(zo){}Fg=!1}if(Fg)Mk(qi.O15ActiveX);else{if(a()||
fc()){var Ck=Ld.EncodeUrl?Oe:le;le=Ld.Mode;Fg=Ei(Ld.Application);$h=Sg();if(null==$h)Ck=vh.DescriptiveUnattemptedEnums?Hg.PluginIsNull:Hg.Unattempted;else{ji=!1;try{ji=$h.ViewDocument3(window.self,Ck,le,Fg)}catch(zo){}if(!ji)try{ji=$d(le)?$h.ViewDocument2(window.self,Ck,Fg):$h.EditDocument2(window.self,Ck,Fg)}catch(zo){}ji?(Mk(qi.NpapiPlugin),Ck=Hg.None):Ck=Hg.Failed}}else{try{Ck=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ck&&Ck.SaveSSOCreds()}catch(zo){}Ck=Te(Ld.EncodeUrl?Oe:le,Ld.Mode,Ld.Options,
Ei(Ld.Application))}if(Ck!=Hg.None){if(le=Ld.CouldUseRoamingApps)ll||(ll=!0,Xl=f("Windows NT")),le=6.1<=Xl&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ja()||fc()||yb());if(le&&Ld.Application!=hg.OneNote){if(!jq.WPb.wLl()){Cj(Hg.ControlNeeded,vh.Application);return}if(Ld.RoamingAppsLauncher){"undefined"==typeof Ld.RoamingAppsLauncher||null==Ld.RoamingAppsLauncher?Cj(vh.DescriptiveUnattemptedEnums?Hg.RoamingLauncherIsNull:Hg.Unattempted,vh.Application):"undefined"==typeof Ld.RoamingBitsUrl||
null==Ld.RoamingBitsUrl?jq.WPb.LLl(Ld.DocumentUrl,Ld.RoamingAppsLauncher,Ld.Application,Ld.ApplicationParameters,Wj,sk):jq.WPb.vLh(Ld.DocumentUrl,Ld.RoamingAppsLauncher,Ld.RoamingApplicationExe,Ld.ApplicationParameters,Ld.RoamingPlatform,Ld.RoamingBitsUrl,Wj,sk);return}if(!Ld.ContinueIfLauncherIsNull){Cj(Hg.LauncherNeeded,vh.Application);return}}pi.NoProtocolHandlerFallback==(Ld.Options&pi.NoProtocolHandlerFallback)||we(Ld)||ja()||H()&&!(vh.DescriptiveUnattemptedEnums?Ck>=Hg.O14Unattempted&&Ck<=Hg.DocumentUrlIsNull:
Ck==Hg.Unattempted)?Cj(Ck,vh.Application):Vf(Ld.Application,Ld.EncodeUrl?yf:Oe,Ld.Mode,Ld.Application==hg.OneNote,Ld.SilentExternalHandler,Ld.NavigateUsingWindowOpen)}}}}else Cj(vh.DescriptiveUnattemptedEnums?Hg.DocumentUrlIsNull:Hg.Unattempted,vh.Application)}function Mk(Ld){null!=Wj&&Wj(Ld)}function Cj(Ld,Oe){"undefined"==typeof Oe&&(Oe=null);null!=sk&&sk(Ld,Oe)}function Bk(){var Ld=0;if(a()||fc()||yb()){var Oe=Sg();try{null!=Oe&&(Ld=Oe.GetOfficeVersion())}catch(yf){}}else Zi("SharePoint.OpenDocuments.5")?
Ld=15:Zi("SharePoint.OpenDocuments.4")?Ld=14:Zi("SharePoint.OpenDocuments.3")?Ld=12:Zi("SharePoint.OpenDocuments.2")&&(Ld=11);return Ld}function Il(){return H()&&(Gh("application/x-sharepoint",!0)||Gh("application/x-sharepoint-webkit",!0))}var lk="",Jl="",Vj="",Wj,sk,kl,vj,vh,ll,Xl,xm,Nk,Ok={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},pi={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
Hg={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},qi={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},hg={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Ok,OpenDocumentOptions:pi,OpenDocumentFailureType:Hg,OpenDocumentControl:qi,OfficeApplication:hg,EditDocumentInClient:Gi,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=hg.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Bk,IsO14MacPluginInstalled:Il,OfferOfficeInDialog:function(){return b()&&11>=Bk()},OfferOfficeNoIntrusive:function(){return b()&&15>Bk()},OfferMacOffice:function(){return H()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!Il()},InstallRoamingControl:function(){Va()?window.InstallTrigger.install({Office:{URL:Jl}}):ae(Vj,null,null)},CanUseRoamingControl:function(){if(x())return!0;if(yb())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Va()){var Ld=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Ld);var Oe=document.createEvent("Events");Oe.initEvent("RoamingOfficeInstalled",!0,!1);Ld.dispatchEvent(Oe);
return!!Ld.getAttribute("installed")}if(ja())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(yf){}return!1},InitUrls:function(Ld,Oe,yf){lk=Ld;Jl=yf;Vj=Oe},LaunchRoamingApps:function(Ld,Oe,yf,le,Fg,$h){jq.WPb.vLh(Ld,Oe,Fi(yf),le,"x86",lk,Fg,$h)},LaunchRoamingApps2:function(Ld,Oe,yf,le,Fg,$h,ji,Zn){var Ck="";null!=le&&(Ck+=" "+le);null!=Ld&&(Ck+=' "'+Ld+'"');if(x()||yb())kl=ji,vj=Zn,ji='office: "'+($h+'" "')+(yf+'" "ROAMING"'),ji+=' "'+Oe+'"',ji+=' "'+Fg+'"',ji+=
" "+Ck,Lc(ji,Wf,rg,!1,!1);else if(Va())Ld=document.createElement("RoamingExtensionElement"),Ld.setAttribute("cabUrl",$h),Ld.setAttribute("app",yf),Ld.setAttribute("licensingEntitlements",Oe),Ld.setAttribute("platform",Fg),Ld.setAttribute("args",Ck),document.documentElement.appendChild(Ld),Oe=document.createEvent("Events"),Oe.initEvent("RoamingOfficeLaunch",!0,!1),Ld.dispatchEvent(Oe),null!=ji&&ji(qi.RoamingFFExtension);else if(ja()){if(Ld=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Ld)try{Ld.HrConfigureSingle($h,yf,Oe,Fg,Ck),null!=ji&&ji(qi.RoamingActiveX)}catch(zo){}}else null!=Zn&&Zn(Hg.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:Gc,OpenDocumentWithProtocolHandler:Vf,OpenDocumentWithProtocolHandlerNoCallBack:function(Ld,Oe,yf,le){var Fg=fj(Ld);if(null==Fg)return Cj(vh.DescriptiveUnattemptedEnums?Hg.ProtocolHandlerNoCallbackIsNull:Hg.Unattempted,vh.Application),!1;Ld=Ze(Ld,Oe,yf,le,Fg);Lc(Ld,null,null,!1,!1);return!0}}}();jq.ClientUtils=
jq.WPb;class Jt{constructor(a,b,c){this.Ca=a;this.iUh=b;this.DG=c}wb(){this.Ca.ya(G.a.tryMacOffice,de.a.frame,Object(F.a)(this,this.Qyk,"onTryMacOffice"));this.Ca.ya(G.a.XDh,de.a.frame,Object(F.a)(this,this.$6g,"onTryMacOfficeFromViewer"));this.Ca.ya(G.a.WDh,de.a.frame,Object(F.a)(this,this.$6g,"onTryMacOfficeFromViewer"))}Qyk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?Od.a.vn(bg.a.dEa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===
a&&Od.a.vn(bg.a.dEa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Zog();return 32}$6g(a,b,c){if(1===c)return 32;switch(a){case G.a.XDh:Od.a.vn(bg.a.dEa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case G.a.WDh:Od.a.vn(bg.a.dEa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Zog(){Od.a.vn(Jt.fjk,"_blank",void 0,"LaunchMacTrialWindow")}get Yqc(){return this.iUh&&B.a.vk&&!B.a.Zke&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get auh(){const a=
this.Yqc;a||u.AFrameworkApplication.jj.G9k();return a}get cil(){return this.Yqc}static get fjk(){return bg.a.JW("522401")}}Object(m.a)(Jt,"MacOfficeOffer",null,[1372]);class Xq{constructor(a,b,c){this.Ca=a;this.lUh=b;this.oxd=null;(this.dFc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.oxd=f});this.DG=c}wb(){this.Ca.ya(G.a.tryOffice,
de.a.frame,Object(F.a)(this,this.Ryk,"onTryOffice"));this.Ca.ya(G.a.t3e,de.a.frame,Object(F.a)(this,this.t3e,"tryOfficeThroughTellMe"));this.Ca.ya(G.a.eEh,de.a.frame,Object(F.a)(this,this.fEh,"tryOfficeThroughViewer"));this.Ca.ya(G.a.dEh,de.a.frame,Object(F.a)(this,this.fEh,"tryOfficeThroughViewer"))}Ryk(a,b,c,f,l){if(this.dFc&&1===c)return this.isFreemiumUpsellEnabled&&this.Zqc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?Od.a.vn(bg.a.dEa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===a?Od.a.vn(bg.a.dEa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.wne()):this.wne());return 32}t3e(a,b,c,f,l){if(this.dFc&&1===c)return this.isFreemiumUpsellEnabled&&this.Zqc?32:8;2===c&&(l?(a=l.SourceControlId,Od.a.vn(bg.a.JW("862405")+this.Qej(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Od.a.vn(bg.a.JW("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}fEh(a,b,c){if(this.dFc&&1===c)return this.isFreemiumUpsellEnabled&&
this.Zqc?32:8;if(2===c)switch(a){case G.a.eEh:Od.a.vn(bg.a.dEa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case G.a.dEh:Od.a.vn(bg.a.dEa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get K0g(){return this.Zqc}get Mpk(){return this.Zqc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get Zqc(){return this.lUh&&!B.a.vk}get isFreemiumUpsellEnabled(){let a=!1;this.oxd&&(a=this.oxd.isFreemiumUpsellEnabled());return a}wne(a=null){let b=0;a&&(b=a);Od.a.vn(Xq.Hbj(b),"_blank",void 0,"LaunchOfficeOffer")}Qej(a){let b=
0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static Hbj(a){if(B.a.Ni)switch(a){case 1:return bg.a.JW("393806");case 2:return bg.a.JW("393810");case 3:return bg.a.JW("393809");case 5:return bg.a.JW("393805")}else if(B.a.RI)switch(a){case 1:return bg.a.JW("521979");case 3:return bg.a.JW("521980");case 5:return bg.a.JW("521978");case 2:return bg.a.JW("522490")}else{if(2===a)return bg.a.JW("517778");
if(1===a)return bg.a.dEa(30)}return bg.a.JW("522402")}}Object(m.a)(Xq,"OfficeTrialExperience",null,[1371]);class Sw{Zb(a){a.register(Xq,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().oa(()=>new Xq(u.AFrameworkApplication.Ta,u.AFrameworkApplication.Gke,u.AFrameworkApplication.lcid));a.register(Jt,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().oa(()=>new Jt(u.AFrameworkApplication.Ta,u.AFrameworkApplication.Vjg,u.AFrameworkApplication.lcid))}}
Object(m.a)(Sw,"OpenInClientConfiguration",null,[3]);var rn=d(174),lf=d(49);class xs{constructor(a,b,c){this.JX=this.fu=this.K=null;this.mf=a;this.YF=b;this.mBe=c}aKf(a,b,c){if(!this.mf)return null;if(!this.K){this.K=lf.a.Ie();this.K.id=this.YF;this.K.className="HTMLSpinnerIndicator";const f=lf.a.Ie();f.className="HtmlspinnerOverlay";this.fu=lf.a.Ie();this.fu.className="HtmlspinnerInner";const l=lf.a.Qn();l.className="BootSpinner";this.fu.appendChild(l);this.mBe&&(this.JX=lf.a.Qn(),this.JX.id="htmlspinner_label",
this.fu.appendChild(this.JX));this.K.appendChild(f);this.K.appendChild(this.fu);this.mf.appendChild(this.K)}this.mBe&&(this.JX.innerText=a||ResourceStrings.l_Loading);this.ZPd(b,c);return this.K}hPb(a){this.JX&&(this.JX.innerText=a)}ZPd(a,b){this.K.style.left=lf.a.Pc(a);this.K.style.top=lf.a.Pc(b);this.fu.style.bottom=this.mBe?lf.a.Pc(this.mf.clientHeight/2+16):lf.a.Pc(this.mf.clientHeight/2+24)}}Object(m.a)(xs,"HtmlSpinnerIndicator",null,[]);class vy extends xs{constructor(a,b,c){super(a,b,!1);this.oBe=
c}aKf(a,b,c){if(!this.mf)return null;if(!this.K){this.K=lf.a.Ie();this.K.id=this.YF;this.K.className="HTMLProgressIndicator";const f=lf.a.Ie();f.className="HtmlprogressOverlay";this.fu=lf.a.Ie();this.fu.className="HtmlprogressInner";if(this.oBe){const l=lf.a.RA();l.src=rn.a.XK(Mf.a.Rna);l.width=Mf.a.SIb;l.height=Mf.a.Nid;this.fu.appendChild(l)}this.JX=lf.a.Qn();this.fu.appendChild(this.JX);this.K.appendChild(f);this.K.appendChild(this.fu);this.mf.appendChild(this.K)}this.JX.innerText=a||ResourceStrings.l_Loading;
this.ZPd(b,c);return this.K}ZPd(a,b){this.K.style.left=lf.a.Pc(a);this.K.style.top=lf.a.Pc(b);this.K.style.display=mf.a.Wk;this.fu.style.position=mf.a.Xoa;a=this.fu.clientWidth;this.fu.style.top=lf.a.Pc(this.mf.clientHeight/2-this.fu.clientHeight/2);u.AFrameworkApplication.isRtl?(this.fu.style.right=lf.a.Pc(this.mf.clientWidth/2-a/2),this.fu.style.direction=mf.a.P0a):(this.fu.style.left=lf.a.Pc(this.mf.clientWidth/2-a/2),this.fu.style.direction=mf.a.Yyh);this.K.style.display=mf.a.Gf}}Object(m.a)(vy,
"HtmlProgressIndicator",xs,[]);class wy{constructor(a,b){this.xJ=this.LO=this.K=null;this.Eb=!0;this.Vzg=a;this.fJ=b}SMb(a,b,c,f,l){u.AFrameworkApplication.nAb()||(this.K=this.Vzg.aKf(a,c,f),b?(this.LO&&(window.clearTimeout(this.LO),this.LO=null),this.xJ&&(window.clearTimeout(this.xJ),this.xJ=null),this.CYe(l)):this.LO||this.xJ||(this.LO=window.setTimeout(()=>{this.bZe(l)},200)))}hWc(){this.LO&&(window.clearTimeout(this.LO),this.LO=null);this.xJ&&(window.clearTimeout(this.xJ),this.xJ=null);this.K&&
(this.K.style.display=mf.a.Gf,this.K.style.opacity="0")}hPb(a){this.Vzg.hPb(a)}CYe(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=mf.a.Dz,this.Eb&&(this.K.style.display=mf.a.Wk),xa.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Stc(a)))}bZe(a){this.LO=null;this.K&&(this.K.style.visibility=mf.a.Dz,this.Eb&&(this.K.style.display=mf.a.Wk),this.K.style.opacity="0.0",this.xJ||(this.xJ=window.setTimeout(()=>{this.aZe(a)},1800)))}aZe(a){this.xJ=null;
this.K&&(this.K.style.opacity="1.0",this.Eb&&(this.K.style.display=mf.a.Wk),xa.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Stc(a)))}Stc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.fJ.W5(a):null:null}get visible(){return this.Eb}set visible(a){this.Eb=a;this.K&&(this.K.style.display=a?mf.a.Wk:mf.a.Gf)}}Object(m.a)(wy,"HtmlProgressIndicatorView",null,[1318]);class xy{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=
null}}Object(m.a)(xy,"UploadConvertedFileToHostParams",null,[]);var iv=d(1009),Ro=d(75);const ys=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},Kt=a=>a.qc.keyCode===A.a.tq||a.qc.keyCode===A.a.pP?(a.Ec.click(),!0):!1,zs=(a,b,c,f,l,x,H)=>{const U=document.createElement("a");U.className="ProtocolLaunchingDialogButtonAnchor";U.className+=" OICDialog";U.id=a;U.setAttribute(Cc.a.ef,Cc.a.yu);U.style.padding=
"0";U.style.margin="0";f&&Hr(l,b,c,f,U);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;U.appendChild(a);U.tabIndex=0;x&&Dd.a.instance.pb(ta.a.click,U,x);H&&y.KeyInputManager.instance.pb(ta.a.Il,U,H);return U},Hr=(a,b,c,f,l)=>{var x=document.createElement("img");x.alt=a;x.className=Ro.getImageClassWithCluster(c,f);x.src=b;x.setAttribute(Cc.a.ef,Cc.a.nN);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(x);
x=document.createElement("span");x.className="ProtocolLaunchingDialogIconContainer";x.appendChild(a);l.appendChild(x)};class Fh{static get rg(){return Zh.a.sC(Fh.so,CommonUIStrings.l_OICLaunchDialogTitle)}}Fh.so="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(Fh,"OICLaunchDialogHtml",null,[]);class k extends Zh.a{constructor(a){super();this.Xmb=this.p2a=null;this.oNa=!1;this.Uw=a;this.rg=Fh.rg;this.xd=5;this.hg="OICLaunchDialog";this.showDialog("",Object(F.a)(this,this.Spk,"oicLaunchDialogResultHandler"));this.pqh();this.c6("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.Aa.hb.Esa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.HR(this.p2a);ia.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}fxa(){this.p2a=zs("BtnRichClient",this.Uw.Jub,this.Uw.Y$a,this.Uw.pde,CommonUIStrings.l_OICLaunchRichClient,Object(F.a)(this,this.z5g,"onRichClientButtonClick"),Kt);document.getElementById("OICLaunchRichClient").appendChild(this.p2a);ys(this.p2a);this.Xmb=zs("BtnReturn",this.Uw.Jub,this.Uw.Y$a,this.Uw.udg,CommonUIStrings.l_OICReturnToOnlineClient,Object(F.a)(this,this.x5g,"onReturnButtonClick"),
Kt);document.getElementById("OICReturnToApp").appendChild(this.Xmb);ys(this.Xmb)}x5g(){this.hide();this.Uw.y_a();return!0}z5g(){ia.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.Ta.processAction(G.a.Zib,2);return!0}Spk(){this.Uw.y_a()}dispose(){this.oNa||(this.p2a&&(Dd.a.instance.yb(ta.a.click,this.p2a,Object(F.a)(this,this.z5g,"onRichClientButtonClick")),y.KeyInputManager.instance.yb(ta.a.Il,this.p2a,Kt)),this.Xmb&&(Dd.a.instance.yb(ta.a.click,
this.Xmb,Object(F.a)(this,this.x5g,"onReturnButtonClick")),y.KeyInputManager.instance.yb(ta.a.Il,this.Xmb,Kt)),super.dispose(),this.oNa=!0)}}Object(m.a)(k,"OICLaunchDialog",Zh.a,[]);class C{static get rg(){return Zh.a.sC(C.so,CommonUIStrings.l_OICDialogTitle)}}C.so="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(C,"ProtocolLaunchingDialogV2Html",null,[]);var W=d(197);class na extends Zh.a{constructor(a){super();this.Wmb=this.Xza=null;this.oNa=!1;this.UMa=null;this.Uw=a;this.rg=C.rg;this.xd=5;this.hg="ProtocolLaunchingDialog";this.vxc="OICRetryDialog";u.AFrameworkApplication.ye.Mta&&u.AFrameworkApplication.ye.x_a();u.AFrameworkApplication.ye.Db(new af.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(F.a)(this,this.Imc,"protocolLaunchingDialogResultHandler"));this.pqh();
this.c6("Issues");this.oXf();ia.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}fxa(){const a=document.getElementById("Issues");if(a){Hr("",this.Uw.Jub,this.Uw.Y$a,this.Uw.pde,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.Uw.t7g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);ys(a);a.style.display="none"}u.AFrameworkApplication.Aa.hb.c9f?
(this.Wmb=zs("GiveFeedback",this.Uw.Jub,this.Uw.Y$a,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(F.a)(this,this.Wed,"onGiveFeedbackClick"),Object(F.a)(this,this.D3g,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.Wmb),ys(this.Wmb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.Aa.hb.Esa||u.AFrameworkApplication.JMi?document.getElementById("ButtonEdit").style.display="none":(this.Xza=
zs("Edit",this.Uw.Jub,this.Uw.Y$a,"",2===u.AFrameworkApplication.Aa.hb.Uk?4===u.AFrameworkApplication.Aa.hb.Esa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.Aa.hb.Esa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(F.a)(this,this.R2g,"onEditClick"),Object(F.a)(this,this.V2g,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Xza),ys(this.Xza));0===u.AFrameworkApplication.Aa.hb.Esa&&
!u.AFrameworkApplication.Gke&&a&&(a.style.display="none")}pXf(){return this.UMa?(this.HR(this.UMa),!0):!1}oXf(){return this.Xza?(this.HR(this.Xza),!0):!1}V2g(a){return this.LGe(a,0)}D3g(a){return this.LGe(a,2)}w5g(a){return this.LGe(a,1)}LGe(a,b){let c=!1;if(a.qc.keyCode===A.a.tq||a.qc.keyCode===A.a.pP)a.Ec.click(),c=!0;else if(a.qc.keyCode===Sys.UI.Key.down||a.qc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.oXf();break;case 0:c=this.pXf()}return c}R2g(){this.hide();4===u.AFrameworkApplication.Aa.hb.Esa?
(ia.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Uw.y_a()):(ia.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Uw.m7b());return!0}Wed(){ia.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}Xfd(){ia.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.Ta.processAction(G.a.Zib,2);return!0}Imc(){this.Uw.y_a()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.UMa=zs("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(F.a)(this,this.Xfd,"onRetryOICClick"),Object(F.a)(this,this.w5g,"onRetryOICKeyUp")),a.appendChild(this.UMa),ys(this.UMa),this.Xza||this.pXf())}}dispose(){this.oNa||(this.Xza&&(Dd.a.instance.yb(ta.a.click,this.Xza,Object(F.a)(this,
this.R2g,"onEditClick")),y.KeyInputManager.instance.yb(ta.a.Il,this.Xza,Object(F.a)(this,this.V2g,"onEditKeyUp"))),this.Wmb&&(Dd.a.instance.yb(ta.a.click,this.Wmb,Object(F.a)(this,this.Wed,"onGiveFeedbackClick")),y.KeyInputManager.instance.yb(ta.a.Il,this.Wmb,Object(F.a)(this,this.D3g,"onGiveFeedbackKeyUp"))),this.UMa&&(Dd.a.instance.yb(ta.a.click,this.UMa,Object(F.a)(this,this.Xfd,"onRetryOICClick")),y.KeyInputManager.instance.yb(ta.a.Il,this.UMa,Object(F.a)(this,this.w5g,"onRetryOICKeyUp"))),super.dispose(),
this.oNa=!0)}}Object(m.a)(na,"ProtocolLaunchingDialog",Zh.a,[]);class Ga extends jj.StandardDialog{constructor(a){super();this.Uw=a;this.hg="ProtocolLaunchingDialog";u.AFrameworkApplication.ye.Mta&&u.AFrameworkApplication.ye.x_a();u.AFrameworkApplication.Aa.hb.c9f&&this.uOd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(F.a)(this,this.Wed,"onGiveFeedbackClick"));Ga.Rag?(this.xd=12,this.Xe(1,CommonUIStrings.l_CloseFile),this.Xe(2,CommonUIStrings.l_OICDialogContinueHere),this.Xe(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.xd=4,this.Xe(1,CommonUIStrings.l_OICDialogContinueHere),this.Xe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.cGb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Uw.t7g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(F.a)(this,this.Imc,"protocolLaunchingDialogResultHandler"),null)}Wed(a){ia.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.g3g(a)}Xfd(){ia.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.Ta.processAction(G.a.Zib,
2)}Imc(a){Ga.Rag?3===a?this.ylh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.ylh():(1===a||0===a)&&this.continueEditing()}closeDocument(){ia.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.Ta.La(G.a.close,2,zh.a)}ylh(){ia.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(F.a)(this,this.Xfd,"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.Aa.hb.Esa||u.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===u.AFrameworkApplication.Aa.mode?(ia.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Uw.y_a()):(ia.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Uw.m7b())}static get Rag(){return u.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===u.AFrameworkApplication.Ta.processAction(G.a.close,1)}}Object(m.a)(Ga,"StandardProtocolLaunchingDialog",jj.StandardDialog,[]);var bb=d(667);class vb{}Object(m.a)(vb,"EditDocumentInClientParams",null,[]);
class Xb{static tQf(a,b,c,f,l,x,H=!1,U=!1,ja="",ya=!1,Va=!1,hb=!1,yb="",Zb="",fc="",Kc=!1,Lc=""){const Gc=new vb;Gc.DocumentUrl=a;Gc.DocumentExtension=Lc;Gc.Mode=b;Gc.Options=c;Gc.Application=f;Gc.SilentExternalHandler=H;Gc.EncodeUrl=U;Gc.CorrelationIdForWinClient=ja;Gc.NavigateUsingWindowOpen=ya;Gc.DescriptiveUnattemptedEnums=Va;Gc.NoBrowserModalDialogs=hb;Gc.SessionOrigin=yb;Gc.CorrelationId=Zb;Gc.ClickTime=fc;Gc.NewTelemetryDataIsEnabled=Kc;MSOJS.ClientUtils.EditDocumentInClient(Gc,l,x)}}Object(m.a)(Xb,
"ClientUtils",null,[]);var Fc=d(567),ad=d(528),wd=d(130);class se{constructor(a){this.VAa=this.ORb=this.UQb=null;this.CSb=!1;this.Yzd=this.LFd=this.Pjf=null;this.Awc=this.Ppa=this.DDc="";this.application=this.Py=0;this.$rl=this.h0e=!1;this.OGl=a&&u.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");u.AFrameworkApplication.Ta.dT(G.a.Zib)||u.AFrameworkApplication.Ta.ya(G.a.Zib,de.a.frame,Object(F.a)(this,this.l3k,"retryOpenInClientAction"));this.vwh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("SilentExternalHandler")}get t7g(){return this.Py}ael(a,
b="",c=""){this.Ppa=c||Ug.a.create().toString();this.DDc=b||Fc.a.g4f();this.Awc=a}l3k(a,b,c){return b.contextId!==de.a.frame?2:1===c?32:this.Zib()}get options(){let a=0;u.AFrameworkApplication.requiresCheckout&&(a|=1);u.AFrameworkApplication.z7g&&(a|=4);this.Yrl()&&(a|=64);return a}Yrl(){return!(2===this.application&&u.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get Jub(){return u.AFrameworkApplication.rm}get Y$a(){return u.AFrameworkApplication.PN}get udg(){return""}get pde(){return""}get Zrl(){return u.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get Tul(){return this.Pjf||
(this.Pjf=Db.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.h0e||this.vTi()}y_a(){this.$rl||this.ATf()}UQk(a){return this.OGl&&B.a.Ni?(new k(this),32):this.Dtb(a)}Dtb(a){const b=({i1a:a}=this.VYj(a)).returnValue;ia.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,x,H=""){this.UQb=a;this.Yzd=H;this.ORb=b;this.VAa=x;this.application=c;this.Py=f;return u.AFrameworkApplication.TPf?(this.Vog(),32):u.AFrameworkApplication.PQ&&!u.AFrameworkApplication.rcg?
(u.AFrameworkApplication.$vh(),8):this.izf(l)}get Rpk(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}Zib(){this.Rpk&&this.t1j();return this.Dtb(this.CSb)}Noh(){const a=new ad.a(jf.a.openInClient);a.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();a.Values[bb.a.QLf]=u.AFrameworkApplication.userSessionId;return this.VAa.value.send(a)?32:8}t1j(){kf.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Oj.a,{inStaging:!0}))}o8k(a){const b=new ad.a(jf.a.lJl);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[bb.a.QLf]=u.AFrameworkApplication.userSessionId;b.Values[Pj.a.kJl]=a;this.VAa.value.send(b)}VYj(a){this.CSb=a;this.o8k(5===this.Py?se.Jzk:se.Pzk);return 5===this.Py?this.UYj():this.WYj()}UYj(){this.$og();return{returnValue:32,i1a:"HostEditUrl,"}}WYj(){let a;var b=a="";u.AFrameworkApplication.ttf&&(b="|f|"+u.AFrameworkApplication.userSessionId);
const c=u.AFrameworkApplication.fa.ka("IsAssignmentMode")&&u.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.oac||B.a.NFa,f=u.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=u.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(u.AFrameworkApplication.Ta.Cdd){var x=u.AFrameworkApplication.Ta.J6b(3588168074);x&&this.ael(x.epochClickTime,x.sessionOrigin,x.correlationId);this.Jqg()}if(u.AFrameworkApplication.ebh){a+="NewOrder,";
x=8;this.VAa&&this.VAa.value&&this.VAa.value.isEnabled()&&u.AFrameworkApplication.Duc&&(a+="Post,",x=this.Noh());if(32===x)return{returnValue:x,i1a:a};ia.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.Eu.qxa?(ia.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.Eu.qxa),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.QO(!0,u.AFrameworkApplication.Eu.qxa),i1a:a}):this.UQb?(ia.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId),a+="DocUrl,",Xb.tQf(this.UQb,this.Py,this.options,this.application,Object(F.a)(this,this.U2g,"onEditInClientSuccess"),Object(F.a)(this,this.T2g,"onEditInClientFailure"),this.vwh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.DDc,this.Ppa,this.Awc,u.AFrameworkApplication.Ta.Cdd,this.Yzd),{returnValue:32,i1a:a}):{returnValue:8,i1a:a}}a+="OldOrder,";if(!this.UQb&&u.AFrameworkApplication.Eu.qxa)return this.VAa&&
this.VAa.value&&this.VAa.value.isEnabled()&&u.AFrameworkApplication.Duc?(a+="Post,",b=this.Noh()):(ia.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(ia.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.Eu.qxa),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.QO(!0,u.AFrameworkApplication.Eu.qxa),i1a:a}):{returnValue:b,i1a:a};ia.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);
a+="DocUrl,";Xb.tQf(this.UQb,this.Py,this.options,this.application,Object(F.a)(this,this.U2g,"onEditInClientSuccess"),Object(F.a)(this,this.T2g,"onEditInClientFailure"),this.vwh,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.DDc,this.Ppa,this.Awc,u.AFrameworkApplication.Ta.Cdd,this.Yzd);return{returnValue:32,i1a:a}}v0k(a){u.AFrameworkApplication.jj.setDw(8981,a)}U2g(a){this.v0k(a);ia.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.Zrl||this.$og(),this.Jqg()):this.h0e||this.closeApplication()}T2g(a,b=0){ia.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.ORb&&!this.CSb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.h0e=!0));this.Tul.Mpk?(ia.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),iv.a.instance.gFi(this.CSb?Object(F.a)(this,
this.T0g,"oicErrorDialogHandlerCloseForced"):Object(F.a)(this,this.U0g,"oicErrorDialogHandlerNoCloseForced"),c?Object(F.a)(this,this.c4g,"onLaunchDownload"):null,this.zOf(!1)?Object(F.a)(this,this.nAj,"iHaveOfficeButtonHandler"):null,f,b)):(ia.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),iv.a.instance.eFi(this.CSb?Object(F.a)(this,this.T0g,"oicErrorDialogHandlerCloseForced"):Object(F.a)(this,this.U0g,"oicErrorDialogHandlerNoCloseForced"),c?Object(F.a)(this,this.c4g,
"onLaunchDownload"):null,f))}}Jqg(){try{const a=[Object.assign(new wd.a,{name:"CorrelationId",string:this.Ppa}),Object.assign(new wd.a,{name:"SessionOrigin",string:this.DDc}),Object.assign(new wd.a,{name:"ClickTime",string:this.Awc}),Object.assign(new wd.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Gp.a("OpenInClientCompleted",!0,0,a)}catch(a){ia.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}$og(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.GC&&
u.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?new Ga(this):new na(this)}T0g(){this.closeApplication()}U0g(){this.y_a()}c4g(){this.Vog()}nAj(){return this.zOf(!0)}zOf(a){const b=(B.a.HUa||B.a.vo)&&!!u.AFrameworkApplication.kNc;b&&a&&(Od.a.vn(u.AFrameworkApplication.kNc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}se.Pzk="OpenInDesktop";se.Jzk="OpenInBrowser";Object(m.a)(se,"AOpenInClientOperation",null,[]);class Re extends se{constructor(a,b,c=!1){super(c);
this.VSh=a;this.USh=b}get udg(){return this.USh}get pde(){return this.VSh}vTi(){u.AFrameworkApplication.Ta.La(G.a.close,2,zh.a)}ATf(){}izf(a){return this.UQk(a)}Vog(){ia.ULS.shipAssertTag(5566817,211,!!this.ORb);u.AFrameworkApplication.Kda?u.AFrameworkApplication.Aa.QO(!0,this.ORb):Od.a.vn(this.ORb,void 0,void 0,"LaunchDownload")}m7b(){u.AFrameworkApplication.Aa.hb.m7b()}}Object(m.a)(Re,"OpenInClientOperation",se,[]);class Sf extends Re{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");
if(!a)throw Error.argumentNull("pathManager");this.tHg=b;this.qe=a;this.Wn=c;this.ia=f}get Jub(){return this.qe.qk(this.Y$a+".png")}get Y$a(){return"prt2"}izf(a){return this.tHg?this.tHg(a):this.Dtb(a)}ATf(){xa.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.La(K.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}Dtb(a){this.Wn.j$b=!0;return super.Dtb(a)}}Object(m.a)(Sf,"OpenInPowerPointOperation",Re,[]);class oh{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te){this.Szg=null;this.vE=x;this.ia=a;this.Ea=b;this.pa=c;this.qe=f;this.sHg=new Sf(this.qe,Object(F.a)(this,this.Mhi,"beginSaveBeforeOpenInClient"),hb,a);H.execute(Ze=>{this.Szg=new mc.a(()=>Ze)});this.cwg=l;this.Ou=U;this.$ik=ja;this.ua=ya;this.fc=Va;this.Ha=yb;this.Xa=Zb;this.Uea=fc;this.Rb=Kc;this.Rd=Lc;this.Mm=Gc;this.Kv=ae;this.Heb=we;this.q$=$d;this.GO=Te}wb(){this.ia.ya(K.a.openInClient,rc.a.application,Object(F.a)(this,this.v7g,"openExternal"));
this.ia.ya(G.a.iJe,rc.a.application,Object(F.a)(this,this.v7g,"openExternal"));this.ia.ya(K.a.convertAndEdit,rc.a.application,Object(F.a)(this,this.gAi,"convertBinaryFormat"));this.ia.ya(K.a.repair,rc.a.application,Object(F.a)(this,this.S_k,"repairCorruptedFile"));this.ia.ya(K.a.Doc,rc.a.application,Object(F.a)(this,this.Doc,"replaceOriginalFile"));this.ia.ya(K.a.VKb,rc.a.application,Object(F.a)(this,this.VKb,"saveRepairedFile"));this.ia.ya(K.a.V2b,rc.a.application,Object(F.a)(this,this.V2b,"editAnyway"));
this.ia.ya(K.a.Z6b,rc.a.application,Object(F.a)(this,this.Z6b,"goToEditMode"));this.ia.je(K.a.openInClient,12288)}Mhi(a){if(this.Mm.isPaused)return this.Ea.Ed(),this.FTe(a),32;this.pa.Qh();this.Ea.Ed();if(1===this.Rb.mode&&this.Ha.ylg)return this.nWf(a),32;this.vE.u3(a,!0,()=>{this.FTe(a)},()=>{this.FTe(a);return!0},3);this.Ou.show(!1,"OpenInClient");return 32}FTe(a){this.Ou.hide();this.nWf(a)}nWf(a){Tc.a.ztd();this.sHg.Dtb(a)}v7g(a,b,c){if(b.contextId!==rc.a.application)return 2;b=!(!this.qe.documentUrl&&
!this.cwg.qxa&&!u.AFrameworkApplication.Duc);if(1===c)return b?32:8;if(!b)return 8;this.m3j();if(this.fc.$c(this.$ik.Ef))return 16;a=a===G.a.iJe?5:2;1===this.Rb.mode&&this.Ha.ylg&&(a=1);return this.sHg.begin(this.qe.documentUrl,u.AFrameworkApplication.xRa,3,a,this.Ha.BQj,this.Szg,Ud.a("OpenPPTTemplateInDesktopAppAsNFT")?ha.a.fT(this.cwg.Xw):"")}m3j(){try{let a="";const b=this.ua.ak;b&&(a=b.toString());xa.a.J(509372432,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",this.ua.currentSlideIndex,
a)}catch(a){xa.a.J(509372431,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}gAi(a,b,c){xa.a.J(509372430,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==rc.a.application)return 2;if(1===c)return 32;const f=Object.assign(new xy,{PodEndpointUrl:this.Ha.podsWebServiceBase,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string});this.Uea.Yud(f,Object(F.a)(this,this.$yk,"onUploadConvertedFileToHostSucceeded"),l=>{this.Zyk(l,
f.PodSessionID)});this.Ou.iZe(!0,ResourceStrings.L_FileConverting,a);return 32}$yk(a){xa.a.J(509372429,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.Ou.hide();if(this.Rb)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;u.AFrameworkApplication.fa&&(b=u.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=u.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){xa.a.J(509372426,801,
50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[Pj.a.PJb]="1";l[Pj.a.documentUrl]=a.EditUrl;l[Pj.a.mode]="edit";l[Pj.a.reason]=Fu.a.convert;u.AFrameworkApplication.kT().execute(x=>{x.sendMessage(jf.a.lDa,l)})}else this.Rb.QO(!0,a.EditUrl)}else xa.a.J(509372427,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else xa.a.J(509372428,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}Zyk(a,
b){a=df.a.YK(a.error.Im);xa.a.J(509372425,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.Ou.hide();a=Object.assign(new Ml.a,{Code:a,Source:5});this.Rd.zs(a,b,c=>{c.jC=1;c.tCa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}S_k(a,b,c){if(b.contextId!==rc.a.application)return 2;if(1===c)return 32;xa.a.J(509372424,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.U_k();
return 32}U_k(){const a=new Date;xa.a.J(509372423,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=Tc.a.yk("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.GO.Lsb(()=>{xa.a.J(509372422,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},
()=>{xa.a.J(509372421,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});this.Heb.Bjh(b,()=>{xa.a.J(509372420,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.Gxl()},c=>{xa.a.J(509372419,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-
+a,c);b.finish();this.yKk(c,this.Xa.podSessionId);return!0})}Gxl(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Xa.podSessionId;a.fromInlineDocumentRepair=!0;this.Kv.jVe();a=this.ia.La(K.a.UJb,2,a);xa.a.J(509372418,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}yKk(a,b){a=Object.assign(new Ml.a,{Code:a,Source:5});this.Rd.zs(a,b,c=>{c.jC=1;c.tCa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;
return!1})}V2b(a,b,c,f,l){if(b.contextId!==rc.a.application)return 2;if(1===c)return 32;xa.a.J(509372417,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.Kv.Dwb();0!==a&&(xa.a.J(509372416,801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.JKf());if(20===l)this.Kv.mDl();else return xa.a.J(509372387,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}VKb(a,b,c,f,l){if(b.contextId!==
rc.a.application)return xa.a.J(509372386,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,1);xa.a.J(509372385,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.T6f(1,l);return 32}T6f(a,b){xa.a.J(509372384,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.Ha.podsWebServiceBase,this.Xa.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const l=new Date;u.AFrameworkApplication.Ke.mj(c,1,"",f,!1,0,x=>{this.GHe(x,l,b)},x=>{this.FHe(x,a,b)},null,null)}GHe(a,b,c){xa.a.J(509372383,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Sd).downloadUrl;ha.a.Wa(a)?(xa.a.J(509372382,
801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.nxh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.La(c,2,b))}FHe(a,b,c){a=a.data?a.data.oe:-1;a===dl.a.qhi&&0<b--?(xa.a.J(509372381,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.T6f(b,c)):(xa.a.J(509372380,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",
a,c),this.nxh())}nxh(){const a=Object.assign(new Ml.a,{Code:20,Source:6});this.Rd.zs(a,this.Xa.podSessionId,b=>{b.jC=1;b.tCa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}Doc(a,b,c){if(b.contextId!==rc.a.application)return xa.a.J(509372379,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=
u.AFrameworkApplication.fa.Ga("DocumentPermissions")||"",b=this.Xa.i8g&&-1<a.indexOf("W"),xa.a.J(509372378,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",this.Xa.i8g,a),b?32:8;xa.a.J(509372377,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Xa.Kk=this.q$.j9a(this.Xa.presentationId.string);a=Object.assign(new Ni.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,
PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Xa.Kk,UrlOverrides:this.Ha.Hfa,IsCreateNewSession:this.Ha.HQ,UseSharedHostFile:this.Ha.APb});this.q$.SIc(a,()=>{this.Wsk()},Object(F.a)(this,this.cHb,"onEnsureHostSessionFailed"),0,!0);return 32}Wsk(){xa.a.J(509372376,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.Kv.v1k();this.Xa.J1k();0!==this.Kv.Dwb()&&this.Kv.kVe(!1)}cHb(){xa.a.J(509372375,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");
this.Kv.jVe();0!==this.Kv.Dwb()&&this.Kv.kVe(!0);return!1}Z6b(a,b,c){if(b.contextId!==rc.a.application)return xa.a.J(509372374,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return 32;a=new Date;this.JKf();xa.a.J(509372373,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}JKf(){this.Xa.Kk=this.q$.j9a(this.Xa.presentationId.string);const a=
Object.assign(new Ni.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Xa.Kk,UrlOverrides:this.Ha.Hfa,IsCreateNewSession:this.Ha.HQ,UseSharedHostFile:this.Ha.APb});this.q$.SIc(a,()=>{this.Xsk()},null,15,!0);this.Kv.kVe(!1)}Xsk(){xa.a.J(509372372,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(m.a)(oh,"PowerPointAppFrameCommandUIActor",
null,[]);var ph=d(504);class Yi{constructor(a,b,c){this.Wsg=a;this.i0=b;this.ZCb=c}show(a,b){this.ZCb?(b=new ph.a(b),b.message=ResourceStrings.l_Saving,b.Oig=!0,b.PMb=a,this.i0.dKa(b)):this.iZe(a,ResourceStrings.l_Saving,b)}iZe(a,b,c){this.ZCb?(c=new ph.a(c),c.message=b,c.PMb=a,this.i0.dKa(c)):this.Wsg.SMb(b,a,0,0,c)}hide(){this.ZCb?this.i0.dKa(Object.assign(new ph.a(null),{Nig:!0})):this.Wsg.hWc()}}Object(m.a)(Yi,"SaveBlockingUI",null,[1251]);var Oh=d(240);class qk{constructor(a,b,c,f,l,x,H,U,ja){this.jfc=
Oc.App.Vm;this.bGg=ka.a.nil;this.zb=a;this.ua=b;this.Oc=c;this.Qk=f;this.UL=l;this.P$c=x;this.sB=U;this.rt=H;this.bbk=ja.E5k;this.Vbk=ja.pptNotShowSavingStatusOfProofingOnlyRevision;this.Oc.KA(Object(F.a)(this,this.DB,"onSessionEnd"));this.Qk.pPd(Object(F.a)(this,this.FHh,"updateSavingStatus"));this.Qk.Luf(Object(F.a)(this,this.EHh,"updateSavedStatus"));this.rt.PK(Object(F.a)(this,this.mpa,"updateSaveStatusDisplay"));this.kik=new af.a(3,1,ja.D5k,Object(F.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),
90,"28");this.gVa=!1;this.y9c=ja.powerPointTextEditOnlyMode}initialize(){this.mpa(this.rt)}EHh(){this.gVa||this.sB.e4||this.sB.fmg||(this.zb.Db(this.kik),this.gVa=!0)}FHh(a,b){this.sB.e4||this.sB.fmg||(this.Vbk&&qk.zSj(b.node)||this.P$c.updateSaveStatusText(!1),this.jfc=new Date,this.bGg=b?b.revisionId:ka.a.nil)}updateSaveStatusText(){this.gVa=!1;const a=!this.UL.WW(this.ua.presentation);this.P$c.updateSaveStatusText(a);a&&(this.Njh(0,0),this.jfc=Oc.App.Vm);this.y9c&&qk.BDl(a)}mpa(a){this.P$c.mpa(!1,
1===a.mode?1:3)}DB(a,b){this.P$c.updateSaveStatusText(!0);this.Njh(1,b.lG);this.jfc=Oc.App.Vm}Njh(a,b){if(this.jfc!==Oc.App.Vm){var c=+new Date-+this.jfc;c>=this.bbk&&(c=String.format("SavingTime {0};Type {1};Revision {2};",c,a,this.bGg),1===a&&(c+=String.format("CloseReason {0};",b)),xa.a.J(21604228,811,50,c))}}dispose(){this.Oc.paa(Object(F.a)(this,this.DB,"onSessionEnd"));this.Qk.ZQe(Object(F.a)(this,this.FHh,"updateSavingStatus"));this.Qk.Lih(Object(F.a)(this,this.EHh,"updateSavedStatus"));this.rt.yY(Object(F.a)(this,
this.mpa,"updateSaveStatusDisplay"))}static BDl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display="block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static zSj(a){return a.Sa(kb.a.Qid)&&!a.Sa(Oh.a.Ymd)}}Object(m.a)(qk,"SaveStatusManager",null,[106]);class uh{constructor(){this.K=
null;this.mxe=!1}get name(){return"PowerPointWebEditor.Actors"}Zb(a){(new Sw).Zb(a);this.K=a;a.register(oh,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().oa(()=>new oh(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ja("Postmessage.IHostPostmessenger"),
a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(1251,"PowerPointWebEditor.ISaveBlockingUI").ma().oa(()=>new Yi(new wy(new vy(a.resolve("PowerPointWebEditor.IPaneManager").xa,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").ukg));a.register(qk,"PowerPointWebEditor.SaveStatusManager").ma().oa(()=>new qk(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.mxe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").eSj)&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").wb();this.K.resolve("Common.IOfficeTrialExperience").wb();this.K.resolve("Common.IMacOfficeOffer").wb()}dispose(){this.mxe&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){z.a.instance.Dc(new uh)}}Object(m.a)(uh,"PowerPointActorsPackage",null,[2,3]);var nn=d(1035),fp=d(1102);class Sn{constructor(){this.sPa=this.AS=this.LAa=null;this.sof=!1;this.l7e=null;this.m7e=this.LUb=0}get messageId(){return this.LAa}get values(){return this.AS}get userSessionId(){return this.sPa}get shouldRetry(){return this.sof}get xFc(){return this.l7e}get Swa(){return this.LUb}get P3h(){return this.m7e}static gGi(a,
b){var c=jf.a.yJi;const f=new Sn;f.LAa=a;f.AS={};f.sPa=b;f.sof=!0;f.l7e=c;f.LUb=3;f.m7e=1E3;return f}}Object(m.a)(Sn,"PostMessageData",null,[]);class gp{constructor(a,b,c){this.ALd={};this.$a=a;this.mCd=c;this.y0j();this.fTk(b)}y0j(){if(this.$a.ka("DocRebootIsSupported")||this.$a.ka("UiHostSupportsDocRebootFeatures"))this.ALd[fp.a.refresh]=()=>this.b8k(jf.a.lDa)}fTk(a){a.ya(G.a.Kdh,de.a.frame,Object(F.a)(this,this.B7k,"sendActionToHostIfSupported"))}B7k(a,b,c,f,l){if(2!==c)return 32;if(!l)return ia.ULS.sendTraceTag(41972610,
204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.ALd[a]?(ia.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.ALd[a]()):2}b8k(a){const b=Sn.gGi(a,u.AFrameworkApplication.userSessionId);this.mCd.execute(c=>{c.postMessage(b)});return 32}}Object(m.a)(gp,"HostActionExecutionManager",null,[]);var sm=d(118),Um=d(726);class so extends bb.a{constructor(a,b,c,f){super(a,b,c);this.aTb=this.b7=0;this.ldf=
!1;this.cTb=0;this.lCd=this.azc=null;this.mdf=this.ndf=!1;this.Ca=f;this._name="HostIntegrationMessenger";this.create()}Mzj(a){const b=a.message,c=a.Xi.origin;u.AFrameworkApplication.wopiHostOriginFromPostMessage||(u.AFrameworkApplication.wopiHostOriginFromPostMessage=c);switch(b.MessageId){case jf.a.uSd:case jf.a.wSd:this.Gzj(b);break;case jf.a.Jae:case jf.a.Kae:this.Gtd();break;case jf.a.Pce:this.Ozj(b);break;case jf.a.xbb:this.RXj(b);break;case jf.a.Z5e:this.Dhi(a);break;case jf.a.c6e:this.fBl()}}EAl(a){switch(a.MessageId){case jf.a.Lce:u.AFrameworkApplication.Ta.La(G.a.jmd,
2,a.Values[Pj.a.direction]);break;case jf.a.hyb:ia.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");u.AFrameworkApplication.Ta.La(G.a.hyb,2,(new Date).getTime());break;case jf.a.Mce:ia.ULS.sendTraceTag(544221062,204,50,"We received HostBackButtonPressed message in WAC");break;case jf.a.Nce:ia.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");u.AFrameworkApplication.Ta.processAction(G.a.$4i,2);break;case jf.a.e8b:ia.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");
u.AFrameworkApplication.Ta.processAction(G.a.e8b,2);break;case jf.a.Oce:ia.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");u.AFrameworkApplication.Ta.processAction(G.a.loj,2);break;case jf.a.Sce:ia.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received")}}Gtd(){v.FocusManager.instance()&&v.FocusManager.instance().Ae&&v.FocusManager.instance().Ae.name===u.AFrameworkApplication.zhb&&v.FocusManager.instance().X0(v.FocusManager.instance().Ae.name)}Gzj(a){v.FocusManager.instance().HU(u.AFrameworkApplication.zhb,
!1);if(Pj.a.Oqc in a.Values){const b={};b[Pj.a.Oqc]=a.Values[Pj.a.Oqc];ia.ULS.sendTraceTag(38278996,204,50,xd.c(b))}}Ozj(a){if(!bg.a.hT(document.URL,u.AFrameworkApplication.Xcd)&&a.Values){var b=0,c=0;try{b=a.Values[Pj.a.Pzj],c=a.Values[Pj.a.Qzj],Pj.a.wcg in a.Values?this.azc=a.Values[Pj.a.wcg]:Pj.a.xcg in a.Values&&(this.azc=a.Values[Pj.a.xcg]),Pj.a.ycg in a.Values&&(this.lCd=a.Values[Pj.a.ycg])}catch(f){return}this.aTb=b;this.cTb=c;this.b7&&this.vqg()}}RXj(a){ia.ULS.sendTraceTag(37536415,204,50,
"JsApiDiagnostics");var b=a.Values[Pj.a.Lzj];b&&Ci.a.instance.LRk(b);(b=a.Values[Pj.a.rVd])&&Ci.a.instance.yRk(b);(a=a.Values[Pj.a.xbb])&&Ci.a.instance.QRk(a)}Dhi(a){ia.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.iAb=!0;u.AFrameworkApplication.Aa.J1.yGe(a.Xi.qc)}fBl(){ia.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Aa.J1.dIe(null,Sys.EventArgs.Empty)}vqg(){this.A2j();
this.B2j();null!=this.azc&&Ci.a.instance.MRk(this.azc);null!=this.lCd&&Ci.a.instance.NRk(this.lCd)}A2j(){this.b7&&this.aTb&&!this.ldf&&(this.ldf=!0,this.aTb>this.b7||(u.AFrameworkApplication.jj.setDw(10324,this.b7-this.aTb),Ci.a.instance.Nfh(this.aTb)))}B2j(){this.b7&&this.cTb&&!this.ndf&&(this.ndf=!0,this.cTb>this.b7||(u.AFrameworkApplication.jj.setDw(10325,this.b7-this.cTb),Ci.a.instance.rSk(this.cTb)))}t0k(){var a=Od.a.J8f();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.b7||
u.AFrameworkApplication.jj.setDw(11045,this.b7-b)}}create(){u.AFrameworkApplication.thg&&this.disable();this.KLa!==Um.a.aZb&&this.LBa(this.KLa);this.Ca.ra(G.a.BNi,de.a.frame,Object(F.a)(this,this.GNi,"disposeInstance"),96);this.wu(jf.a.uSd);this.wu(jf.a.wSd);this.wu(jf.a.Jae);this.wu(jf.a.Kae);this.wu(jf.a.Pce);this.wu(jf.a.Rce);this.wu(jf.a.AQd);const a=Object(F.a)(this,this.Mzj,"hostMessageHandler");this.g_a(jf.a.uSd,a);this.g_a(jf.a.wSd,a);this.g_a(jf.a.Jae,a);this.g_a(jf.a.Kae,a);this.g_a(jf.a.Pce,
a);u.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.Qrf(jf.a.Z5e),this.Qrf(jf.a.c6e),this.g_a(jf.a.Z5e,a),this.g_a(jf.a.c6e,a));if(u.AFrameworkApplication.fa.ka("PostMessageEmbedded")||u.AFrameworkApplication.fa.ka("IsJsApi")){this.wu(jf.a.hyb);const b=Object(F.a)(this,this.EAl,"uiHostMessageHandler");u.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.wu(jf.a.Lce),this.HB(jf.a.Lce,b));this.HB(jf.a.hyb,b);u.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&
(this.wu(jf.a.Nce),this.HB(jf.a.Nce,b),this.wu(jf.a.Mce),this.HB(jf.a.Mce,b),this.wu(jf.a.e8b),this.HB(jf.a.e8b,b),this.wu(jf.a.Oce),this.HB(jf.a.Oce,b));u.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.wu(jf.a.Sce),this.HB(jf.a.Sce,b))}u.AFrameworkApplication.fa.ka("IsJsApi")&&(this.wu(jf.a.xbb),this.g_a(jf.a.xbb,a))}GNi(a,b,c){if(2!==c)return 32;sm.a.Kx(this);return 32}reportDocumentLoadedTime(a){this.mdf||(this.b7=a,this.t0k(),this.KLa!==Um.a.aZb&&this.sendMessage(jf.a.zdi,
{["DocumentLoadedTime"]:a}),this.vqg(),this.mdf=!0)}}Object(m.a)(so,"HostIntegrationMessenger",bb.a,[729,469,106]);class zp{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){u.AFrameworkApplication.fa.gf(()=>{this.Tde(this.Da)})}Tde(a){u.AFrameworkApplication.EQ=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");u.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Zb(a){this.Da=a;a.register(so,
"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().oa(()=>{u.AFrameworkApplication.fa.Mda||ia.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=u.AFrameworkApplication.Nna?u.AFrameworkApplication.Nna:Um.a.aZb;ia.ULS.sendTraceTag(536987587,204,50,"HostIntegrationMessenger instantiating");return new so(window.parent,b,nn.a.instance,u.AFrameworkApplication.Ta)});a.register(gp,"Common.App.HostActionExecutionManager").ma().oa(()=>
{u.AFrameworkApplication.fa.Mda||ia.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new gp(u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.Ja("Postmessage.IHostPostmessenger"))})}}Object(m.a)(zp,"PostmessengersPackage",null,[2,3]);var or=d(408),tm=d(315),hk=d(273),fg=d(216);class Xv extends fg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(Xv,"PersonaButtonProps",
fg.a,[]);class zF{v1b(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new hk.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.uDi(a,c.ControlList);b.push(c)}}uDi(a,b){const c=Object.assign(new or.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new tm.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new hk.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,
b);this.BFi(a,b.ControlList)}BFi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new Xv,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}Object(m.a)(zF,"PresenceContextMenuSectionBuilder",null,[576]);var wA=d(355);class xA{constructor(a,b,c,f){this.jZ=this.xn=this.Um=this.Af=this.Fpa=null;this.RDc=a;this.p0h=f;this.RDc.wie&&(this.Um=
new af.a(3,2,5E3,Object(F.a)(this,this.Tgi,"authenticationCheckTask"),2),u.AFrameworkApplication.ye.Db(this.Um),this.wb(b,c));this.RDc.H8h(()=>{this.Jjc()});this.RDc.Ttf(()=>{this.Kjc()})}get businessBar(){return this.xn||(this.xn=Db.a.instance.ub("CommonUI.IBusinessBar"))}get XAf(){return this.jZ||(this.jZ=Db.a.instance.ub("CommonUI.IBusinessBarEntryFactory"))}wb(a,b){const c=u.AFrameworkApplication.Ta;c.ra(G.a.Myf,de.a.frame,a,96);c.ra(G.a.Nyf,de.a.frame,b,96);c.ya(G.a.uDf,de.a.frame,ld.ActionManager.uv);
c.ya(G.a.vDf,de.a.frame,ld.ActionManager.uv);c.ya(G.a.yne,de.a.frame,ld.ActionManager.uv)}Jjc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.Ta.processAction(G.a.Myf,2)}Kjc(){this.Vtl();u.AFrameworkApplication.Ta.processAction(G.a.Nyf,2)}Tgi(){this.RDc.authenticationCheck()}Vtl(){this.Af&&(this.Af.hide(),this.Af.dispose(),this.Af=null);this.Fpa&&this.businessBar&&(u.AFrameworkApplication.Ug||this.businessBar.removeEntry(this.Fpa),this.Fpa.dispose(),this.Fpa=
null)}showDialog(a){sm.a.Kx(this.Af);this.Af=new jj.StandardDialog;this.p0h||(this.Af.Ar=!1,this.Af.xd=0);this.Af.Xe(1,CommonUIStrings.l_SignIn);this.Af.fP(CommonUIStrings.l_DefaultDialogTitle,a,Object(F.a)(this,this.j3,"dialogHandler"))}j3(a){1===a?(wA.a.Dhd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),u.AFrameworkApplication.Ta.processAction(G.a.yne,2)):(this.ckl(),u.AFrameworkApplication.Ta.processAction(G.a.vDf,2))}ckl(){this.businessBar&&this.XAf&&(this.Fpa=
this.XAf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Fpa.closeable=!0,this.Fpa.addButton(CommonUIStrings.l_SignIn,xA.Kli,""),this.Fpa.Z2=Object(F.a)(this,this.Lli,"businessBarEntryCloseHandler"),this.businessBar.Zh(this.Fpa,!1))}Lli(){this.QMi();u.AFrameworkApplication.Ta.processAction(G.a.uDf,2)}QMi(){this.Um&&(u.AFrameworkApplication.ye.Lg(this.Um),this.Um=null)}dispose(){this.Um=this.Af=this.Fpa=null}static Kli(){wA.a.Dhd();u.AFrameworkApplication.Ta.processAction(G.a.yne,
2)}}Object(m.a)(xA,"SignOutResponseUI",null,[106]);class Ir{get name(){return"Common.App.UI"}Zb(a){a.register(zF,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){sm.a.Kx(Ir.Yba);Ir.Yba=null}static main(){z.a.instance.Dc(new Ir)}static yDj(a,b,c){Ir.Pjl()&&(Ir.Yba=new xA(wA.a.instance,a,b,c))}static Pjl(){return u.AFrameworkApplication.q_g&&!u.AFrameworkApplication.isEmbedded}}Ir.Yba=null;Object(m.a)(Ir,"CommonAppUIPackage",
null,[2,3]);class yA{constructor(a){this.fBa=this.$Aa=this.kBa=this.jBa=null;this.Tcf=this.Ugf=this.EP=this.Gba=!1;this.kJd=this.lhf=null;this.ehf=0;this.$a=this.jhf=null;this.mha=a;this.lK=3;this.ATb=!0}initialize(a,b,c){this.jBa=this.K9d(a,b);this.kBa=CommonUIStrings.l_SavingStatus;this.$Aa=CommonUIStrings.l_ReadOnlyStatus;this.fBa=CommonUIStrings.l_ReviewModeStatus;this.mha&&this.mha.execute(f=>{f.vGc(Object(F.a)(this,this.vuc,"updateToSavingStatus"))});this.EP=!0;this.$a=c;return!0}mpa(a,b){this.Gba=
a;this.lK=b;this.updateSaveStatusText(this.ATb)}updateSaveStatusText(a){!this.ATb&&a&&(this.jhf=new Date);this.ATb=a;a=null;3===this.lK&&(a=this.ATb?this.jBa:this.kBa);this.iNi(a)}K9d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}vuc(){this.updateSaveStatusText(!1)}Vcj(){switch(this.lK){case 1:return this.$Aa;case 2:return this.fBa;default:return null}}QLj(a){return this.Ugf===
this.Gba&&this.ehf===this.lK&&this.lhf===a}M_d(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.Gba,a,this.Vcj(),this.jhf,this.ATb);this.Tcf=!0;return null});this.kJd=null}iNi(a){this.EP&&Pg.c()&&!this.QLj(a)&&(!this.Tcf&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.M_d(a):Od.a.cSe()?(this.kJd&&ia.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.kJd=window.requestIdleCallback(()=>
{this.M_d(a)})):window.requestAnimationFrame(()=>{this.M_d(a)}),this.Ugf=this.Gba,this.lhf=a,this.ehf=this.lK)}}Object(m.a)(yA,"ReactSaveStatusUIHandler",null,[1370]);class zA{constructor(a,b){this.EQ=null;this.jBa=CommonUIStrings.l_SavedStatus;this.kBa=CommonUIStrings.l_SavingStatus;this.$Aa=CommonUIStrings.l_ReadOnlyStatus;this.fBa=CommonUIStrings.l_ReviewModeStatus;this.zAa=b;this.mha=a;this.lK=3;this.WOa=!0}OJ(){this.mha&&this.mha.execute(a=>{a.vGc(Object(F.a)(this,this.vuc,"updateToSavingStatus"))});
this.zAa.execute(a=>{this.EQ=a})}mpa(a,b){this.lK=b;3===b?this.updateSaveStatusText(this.WOa):2===b?this.D3e(this.fBa):this.D3e(this.$Aa)}vuc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.WOa=a;this.D3e(this.WOa?this.jBa:this.kBa)}D3e(a){this.EQ&&this.EQ.sendMessage(jf.a.CAl,this.azi(a))}azi(a){const b={};b.StatusText=a;return b}}Object(m.a)(zA,"SaveStatusPostMessageHandler",null,[1370]);var ym=d(265);class AA{constructor(a,b,c,f){this.fBa=this.$Aa=this.kBa=this.jBa=null;this.Z3a=0;
this.LP=this.XJd=this.g2a=this.jxd=this.tMd=null;this.af=a;this.fqa=b;this.mha=c;this.Vi=f;this.Wef=!0;this.Gba=!1;this.lK=3;this.WOa=!0}initialize(a,b){if(!this.af)return!1;this.jBa=this.K9d(a,b);this.kBa=CommonUIStrings.l_SavingStatus;this.$Aa=CommonUIStrings.l_ReadOnlyStatus;this.fBa=CommonUIStrings.l_ReviewModeStatus;this.OJ();return!0}K9d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}OJ(){this.fqa&&
this.fqa.execute(a=>{a.T$h(Object(F.a)(this,this.hLf,"createStatusAndModeElements"));a.A$h(Object(F.a)(this,this.jll,"showHideSaveStatusElement"));a.zwl&&this.hLf(null,null)});this.mha&&this.mha.execute(a=>{a.vGc(Object(F.a)(this,this.vuc,"updateToSavingStatus"))})}Dza(){this.LP&&this.af&&this.af.iud(this.LP)}jll(a,b){this.mpa("true"===b,this.lK)}mpa(a,b){this.Gba=a;this.lK=b;this.jxd&&(this.jxd.style.display=this.Gba||3===this.lK||!this.tMd?"none":"");this.g2a&&(this.g2a.style.display=this.Gba||
3===this.lK?"none":"",this.g2a.innerText=1===this.lK?this.$Aa:this.fBa,this.g2a.title=1===this.lK?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.XJd&&(this.XJd.style.display=this.Gba||1===this.lK||!this.tMd&&!this.g2a?"none":"");this.LP&&(this.LP.style.display=this.Gba||1===this.lK?"none":"",this.updateSaveStatusText(this.WOa),this.LP.title=CommonUIStrings.l_SaveStatusTooltip)}hLf(a,b){a=document.getElementById(ym.CuiHelper.Oyj);b&&b.RJl||!a||""===this.jBa||
""===this.kBa||""===this.$Aa||""===this.fBa||(this.tMd=document.getElementById(ym.CuiHelper.ISd),this.jxd=ym.CuiHelper.nLc(a,"BreadcrumbAppModeDash","-"),this.g2a=ym.CuiHelper.nLc(a,"BreadcrumbAppModeStatus",1===this.lK?this.$Aa:this.fBa),this.vGh(this.g2a),this.XJd=ym.CuiHelper.nLc(a,"BreadcrumbSaveStatusDash","-"),this.LP=ym.CuiHelper.nLc(a,"BreadcrumbSaveStatus",this.jBa),this.vGh(this.LP),this.mpa(this.Gba,this.lK))}vuc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.WOa=a;this.qFl(this.WOa?
this.jBa:this.kBa)}qFl(a){!this.LP||3!==this.lK&&2!==this.lK||(this.Wef&&!this.WOa?(this.Z3a=this.LP.offsetWidth<this.Z3a?this.Z3a:this.LP.offsetWidth,this.jCl(this.kBa),this.Wef=!1):this.LP.innerText=a)}vGh(a){a.style.direction=this.Vi?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Vi?"right":"left";a.style.display=this.Gba?"none":"";a.setAttribute("Unselectable","on")}jCl(a){this.LP&&(this.LP.style.width="",this.LP.innerText=a,this.Z3a=this.LP.offsetWidth<this.Z3a?this.Z3a:this.LP.offsetWidth,
a=Ef.a.Vt(this.LP),this.LP.style.width=this.Z3a-Ca.a.uM(a.paddingLeft)-Ca.a.uM(a.paddingRight)+1+"px")}}Object(m.a)(AA,"SaveStatusUIHandler",null,[1370]);class AF{constructor(){this.YJd=this.QId=this.uWb=this.Da=null}get name(){return"Common.App.SaveStatus"}Zb(a){this.Da=a;u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&u.AFrameworkApplication.CQ?this.Da.register(zA,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new zA(this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.Ja("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.Aa.hb.Mmg||(u.AFrameworkApplication.Aa.hb.$N?this.Da.register(yA,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new yA(this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"))):this.Da.register(AA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().oa(()=>new AA(La.EventHandlerManager.instance,this.Da.Ja("Common.App.Header.HeaderEventSource"),
this.Da.Ja("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.fa.gf(Object(F.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){const a=u.AFrameworkApplication.fa,b=!!u.AFrameworkApplication.Aa.hb&&4===u.AFrameworkApplication.Aa.hb.Uk;if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&
u.AFrameworkApplication.CQ?(this.YJd=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.YJd.OJ():u.AFrameworkApplication.Aa.hb.Mmg||a.ka("PreventSaveStatusInitializationWithHiddenHeader")&&u.AFrameworkApplication.hideHeader||(u.AFrameworkApplication.Aa.hb.$N?(this.QId=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.QId.initialize(a.ka("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.fa):(this.uWb=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.uWb.initialize(a.ka("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus")))}dispose(){this.uWb&&this.uWb.Dza()}}Object(m.a)(AF,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2022-09-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1",
"nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURFhIWVJFRVVSTDRCSExHUEdXMzQ3OFoyMy4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},
Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",
RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,
IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2",
"nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURDNVQ1BHVkxLUUpKTk80UDZDMk1TMFlPOC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",
RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2",
"VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied",
"4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3",
"nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},
{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",
IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},
{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",
Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",
RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,
IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},
Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},
Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},
{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},
{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",
EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,
Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},
{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,
Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,
Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},
Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",
EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",
Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-02-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}},{CampaignId:"c855ff69-ff13-48f9-83b8-e76d1b65ee6a",
StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InsertPicture",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"PPTO_Picture_FloodgatePromptTitle",
Question:"PPTO_Picture_FloodgatePromptQuestion",YesLabel:"PPTO_Picture_FloodgatePrompt_YesLabel",NoLabel:"PPTO_Picture_FloodgatePrompt_NoLabel"},Rating:{Question:"PPTO_Picture_FloodgateRatingQuestion",RatingValuesAscending:["PPTO_Picture_FloodgateRating_1","PPTO_Picture_FloodgateRating_2","PPTO_Picture_FloodgateRating_3","PPTO_Picture_FloodgateRating_4","PPTO_Picture_FloodgateRating_5"]},Question:{Question:"PPTO_Picture_FloodgateWhyQuestion"}}}}];var uP=d(668);class BF{yZf(){return null}v4i(){return xd.c(window.PPTCampaignsObj_FromAppPackage)}jae(a){return uP.a.jae(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(m.a)(BF,"PowerPointFeedbackAppData",null,[1250]);class BA{constructor(){this.Da=null}Zb(a){this.Da=a;a.register(1250,"Common.App.IAppSpecificFeedbackData").ma().oa(()=>new BF)}init(){this.Da.ub("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){z.a.instance.Dc(new BA)}}Object(m.a)(BA,"PPTWebEditorFeedbackPackage",null,[2,3]);class CA{get name(){return"Box4.ListEditors"}Zb(){}init(){}dispose(){}static main(){z.a.instance.Dc(new CA)}}
Object(m.a)(CA,"Box4ListEditorsPackage",null,[2,3]);var mj=d(141),Vk=d(125);const DA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class CF{constructor(a){this.nNd=this.UBd=!1;this.dNa=null;this.P8e=!1;this.M6=null;this.Fba=!1;this.gZh=a;qa.a.instance.pb(ta.a.mouseDown,this.p5b(),Object(F.a)(this,this.$rk,"onContextualUIMouseDown"));(a=Db.a.instance.Ja("Common.IActionContextProvider"))&&a.execute(b=>{this.M6=b});u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.Aa.hb.$N?gb.a.get_instance().ek(16,()=>{this.fg?this.initializeContextualUI(this.p5b()):gb.a.get_instance().ek(7,()=>{this.initializeContextualUI(this.p5b())})}):gb.a.get_instance().ek(7,()=>{this.initializeContextualUI(this.p5b())})}get Tka(){return this.Fba}get fg(){return u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.Aa.hb.$N?gb.a.get_instance().isCompleted(16)&&gb.a.get_instance().isCompleted(7):gb.a.get_instance().isCompleted(7)}epi(){if(this.P8e)return!0;
try{return Promise.resolve(null),this.P8e=!0}catch(a){return!1}}U3e(a){if(!this.fg||this.nNd)return this.Foe("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.epi())return this.Foe("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.LNc)return this.Foe("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.nNd=!0;let b=G.a.ve;switch(a){case 1:b=G.a.showContextMenu;break;case 0:b=
G.a.showFloatie;break;case 2:b=G.a.rqd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.nNd=!1;Gp.c(b)},0)});return!1}I8f(a){return mj.UISurfaces.XDa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.U3e(0)||this.I8f(b).then(l=>{if(0>=l.length)return null;this.OWe(l).then(()=>{const x={};x.target=
a;mj.UISurfaces.XDa().then(H=>{appChrome.api.dispatch(H.showFloatie(x,c,void 0,this.v8d(),f));this.Fba=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.processAction(G.a.A1j,2);return null})});return null})}showContextMenu(a,b,c=null,f=null){this.U3e(1)||this.evh(a,b,c,f)}evh(a,b,c=null,f=null){this.OWe(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);mj.UISurfaces.XDa().then(x=>
{appChrome.api.dispatch(x.showContextMenu(l,b,c,void 0,this.v8d()));return null})})}Mya(a,b,c){this.U3e(2)||this.I8f(b).then(f=>{0>=f.length?this.evh(a,c,null):this.OWe(f).then(()=>{const l={};l.target=a;const x={};x.target=a;mj.UISurfaces.XDa().then(H=>{appChrome.api.dispatch(H.showContextualUI(l,x,c,void 0,null,this.v8d()));this.Fba=!0;return null})});return null})}Foe(a){ia.ULS.sendTraceTag(561394519,340,15,a)}J_d(){this.fg&&mj.UISurfaces.isLoaded()&&mj.UISurfaces.XDa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());
return null})}qC(){this.fg&&mj.UISurfaces.isLoaded()&&mj.UISurfaces.XDa().then(a=>{this.Fba=!1;appChrome.api.dispatch(a.hideFloatie());return null})}u2b(){this.fg&&mj.UISurfaces.isLoaded()&&mj.UISurfaces.XDa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.Fba=!1;return null})}initializeContextualUI(a){return mj.UISurfaces.XDa().then(b=>{this.UBd||(b.initializeContextualUI(a),this.UBd=!0);return null})}OWe(a){if(!this.UBd)return this.initializeContextualUI(this.p5b()).then(()=>{this.setActiveFloatieGroups(a);
return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];mj.UISurfaces.XDa().then(f=>{c.push.apply(c,this.gZh.MJb.KUc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}p5b(){if(this.dNa)return this.dNa;this.dNa=DA("div");this.dNa.id="ReactContextualUIDiv";this.dNa.style.position="absolute";this.dNa.style.zIndex=
"1001";document.body.insertBefore(this.dNa,document.body.firstChild);return this.dNa}$rk(a){a.qc&&a.qc.target&&"input"===a.qc.target.tagName.toLowerCase()&&v.FocusManager.instance().iD("ribbon");return!1}v8d(){return this.M6?this.M6.contentType:"Unknown"}}Object(m.a)(CF,"ReactContextualUILauncher",null,[1246]);var nj=d(135);class EA{constructor(a){this.eWb=a}create(a,b){const c=new Sys.StringBuilder;this.z1b(c,a,b);this.RXd(c,a);return c.toString()}Pt(a,b){const c=[];this.xYd(c,a,b);this.SXd(c,a);
return c}z1b(a,b,c){switch(b.errorType){case 0:a.append(this.eWb.build());break;case 1:case 2:a.append(this.PSd(b,c))}}xYd(a,b,c){switch(b.errorType){case 0:a.push(this.eWb.DAf());break;case 1:case 2:a.push(this.Wji(b,c))}}RXd(a,b){P.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(nj.a("btnIgrnoreSpellingError",(2===b.errorType?D.a.kud:D.a.yka).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}SXd(a,
b){if(!P.a.instance.ga(92)){var c=Object.assign(new hk.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:b}));a.push(c)}}PSd(a,b){a=this.Y1i(a.suggestions,b);return 0<a.length?nj.e("msUnknownWord",nj.c(null,a),"Menu16"):nj.e("msUnknownWord",nj.c(null,[nj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}Y1i(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=
0;l<f;++l)a[l]&&c.push(nj.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}Wji(a,b){const c=Object.assign(new hk.a,{Id:"Suggestions",ControlList:[]});this.X1i(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new fg.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}X1i(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const x=Object.assign(new fg.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});
Array.add(c,x)}}}}Object(m.a)(EA,"DefaultProofingContextMenuCreator",null,[]);class FA{constructor(a,b){this.o$e=a;this.Iaf=b;this.gPa=[D.a.kza,D.a.lza,D.a.mza,D.a.ILa,D.a.JLa]}create(a,b){return b?Object(Xa.a)(Po.a,b)?this.Iaf.create(a,b,this.gPa):this.o$e.create(b,this.gPa):""}v1b(a,b){return b?Object(Xa.a)(Po.a,b)?this.Iaf.Pt(a,b,this.gPa):this.o$e.Pt(b,this.gPa):null}}Object(m.a)(FA,"ProofingContextMenuSectionFactory",null,[1470]);class DF{build(){const a=[nj.a("btnDeleteRepeatedWord","2023591105",
Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return nj.e("msRepeatedWord",nj.c(null,a),"Menu16")}DAf(){const a=Object.assign(new hk.a,{ControlList:[]}),b=Object.assign(new fg.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,b);return a}}Object(m.a)(DF,"ProofingRepeatedWordSectionBuilder",null,[1469]);var GA=d(1119);class As{constructor(a,b){this.E2a=a;this.gm=b}get isVisible(){return this.E2a.Tka}get controls(){return null}qC(){this.E2a.qC();return!0}uYe(a,b){this.E2a.showFloatie(Object.assign(new GA.a,
{x:a.x,y:a.y}),this.R4b(b),b,null)}O1f(){return new Sys.UI.Bounds(0,0,0,0)}xsa(){return this.qC()}R4b(){return[]}}Object(m.a)(As,"ReactFloatie",null,[458,459]);class EF{constructor(a){this.kxc=null;this.E2a=a}dispose(){}xsa(){this.E2a.u2b();return!0}showContextMenu(a,b){this.h6(a,b.clientPoint,b.Xf)}h6(a,b,c){this.qqd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);ia.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}qqd(a,b,c,f=null){this.kxc?this.E2a.Mya(Object.assign(new GA.a,{x:b.x,
y:b.y}),this.kxc.R4b(c),c):this.E2a.showContextMenu(Object.assign(new GA.a,{x:b.x,y:b.y}),c,void 0,f);this.kxc=null}rqd(a,b,c,f){this.kxc=Object(oa.a)(As,c);f.Iaa(a,b);return!0}}Object(m.a)(EF,"ReactContextMenuController",null,[1247,106]);var Jr=d(441);class yy{static get rg(){return Zh.a.sC(yy.so,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}yy.so="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(m.a)(yy,"AutoCorrectOptionsDialogHTML",null,[]);class zy{static get rg(){return Zh.a.sC(zy.so,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}zy.so="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(m.a)(zy,"AutoCorrectOptionsDialogHTML2",null,[]);class FF extends Zh.a{constructor(a,b){super();this.WR=a;this.D2=b;this.hg="AutoCorrectOptionsDialog"}trc(){ia.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.rg=this.D2?zy.rg:yy.rg;const a={};a.ReplaceTextAsYouType=this.WR.Kib;a.CapitalizeFirstLetterOfSentences=this.WR.fJc;a.ReplaceOrdianalsWithSuperscript=this.WR.Jld;a.ReplaceHyphensWithDash=this.WR.Coc;a.ReplaceFractionsWithFractionCharacter=this.WR.Hld;this.D2&&
(a.ReplaceQuoteWithSmartQuote=this.WR.KRe);this.Zi(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(F.a)(this,this.A9k,"setAutoCorrectOptionsHandler"),a)}A9k(a,b){P.a.instance.ga(70)&&(1!==a?ia.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.WR.Kib||b.CapitalizeFirstLetterOfSentences!==this.WR.fJc||b.ReplaceOrdianalsWithSuperscript!==this.WR.Jld||b.ReplaceHyphensWithDash!==this.WR.Coc||b.ReplaceFractionsWithFractionCharacter!==
this.WR.Hld||this.D2&&b.ReplaceQuoteWithSmartQuote!==this.WR.KRe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.D2&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.WR.m5k(a),ia.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.D2,["ReplaceQuoteWithSmartQuote"]:this.D2&&b.ReplaceQuoteWithSmartQuote}),
Oc.App.Kb.updateCommandUI(!0)):ia.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(m.a)(FF,"AutoCorrectOptionsDialog",Zh.a,[1249]);class Ay{static get rg(){return Zh.a.sC(Ay.so,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Ay.so="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Ay,"AltTextDialogWithDescriptionHtml",null,[]);class kq extends Zh.a{constructor(a=!1){super(!1,!1,a);this.rg=Ay.rg;this.hg=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}MBi(a){this.Zi(CommonUIStrings.l_AlternativeTextDialogTitle,Object(F.a)(this,this.mQd,"altTextDialogHandler"),this.gSc(a));a=document.getElementById(kq.oQd);a.focus();a.select()}OBi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.gSc(a)};this.Zi(CommonUIStrings.l_AlternativeTextDialogTitle,Object(F.a)(this,this.mQd,
"altTextDialogHandler"),a)}gSc(a){const b={};b[kq.oQd]=this.getAltText(a);b[kq.lQd]=this.Q0f(a)||"";return b}zN(a){return a.Ec.id===kq.lQd?!1:super.zN(a)}}kq.oQd="titleText";kq.lQd="descriptionText";Object(m.a)(kq,"BaseAltTextDialogWithDescription",Zh.a,[]);class Lt extends kq{constructor(a,b=!1){super(b);this.hg=Lt.wAj;b&&u.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.OBi(a):this.MBi(a)}}Lt.wAj="AAltTextDialogWithDescription";Object(m.a)(Lt,"AAltTextDialogWithDescription",kq,[]);
class GF extends Lt{constructor(a,b,c,f,l){super(a);this.uqb=this.iRb=null;this.HD=b;this.cha=c;this.Ak=f;this.fd=l}Q0f(a){this.iRb=a.node;this.uqb=od.TableReader.C7f(a);return od.TableReader.G$d(this.uqb)}getAltText(a){this.iRb=a.node;this.uqb=od.TableReader.C7f(a);return od.TableReader.H$d(this.uqb)}mQd(a){if(1===a){od.TableReader.H$d(this.uqb);od.TableReader.G$d(this.uqb);this.hide();a=this.Ak.me(15);try{a.kd(this.iRb)}finally{a&&a.dispose()}}P.a.instance.ga(50)&&this.cha.rw&&this.cha.YY.hra(this.iRb)}}
Object(m.a)(GF,"TableAltTextDialog",Lt,[]);class HA{constructor(a,b,c){this.HD=a;this.Ak=b;this.fd=c}create(a){return new GF(a,this.HD,Oc.App.Ih,this.Ak,this.fd)}}Object(m.a)(HA,"TableAltTextDialogFactory",null,[]);const vP=()=>{Oc.App.edi=!0;return 32},wP=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Hu:b}=HF(l)).returnValue)return 16;Oc.App.Kb.Mya(a,b);return 32},xP=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Hu:b}=HF(l)).returnValue)return 16;Oc.App.Kb.i6(a,b);return 32},HF=a=>{let b,c;b=null;
c=0;if(!a)return{returnValue:!1,point:b,Hu:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Hu:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Hu:c}};var yP=d(1120);class IF extends Sys.EventArgs{constructor(a,b,c,f,l,x=0,H=0,U=null){super();this.controlId=a;this.commandId=f;this.time=l;this.commandSurface=x;this.Hu=H;this.contentType=U}}Object(m.a)(IF,"CommandClickEventArgs",Sys.EventArgs,[]);class JF{constructor(a,b){this.Cba=a.X6i();
this.oRb=a;this.IMa=b}BTf(a,b,c,f=null,l=null){c&&(this.IMa.xq=c.CommandLocation,this.IMa.sT=c.InvocationMethod,this.IMa.Xra=c.CommandTabName);let x=this.oRb.s1f(parseInt(a),b,c);x.dG&&(x=this.oRb.s1f(x.Wm,b,c));if(void 0!==x.dL&&null!==x.dL)return x.dL;if(x.kce)l=32;else{var H=null;this.Cba&&this.Cba.JLe&&(H=this.Cba.JLe(x,l));x.dX||x.fle?x.$q?l=16:(l=this.IMa.La(x.Wm,x.ele?2:1,x.rd,l),2===l&&(l=32)):x.$q?l=this.IMa.Kid(null,x.Wm,x.rd,U=>{f&&f(U.response)},l):(l=this.IMa.La(x.Wm,2,x.rd,l),f&&f(l));
this.Cba&&this.Cba.fLe&&this.Cba.fLe(x,l,H);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";H=b.ParentMenuId;void 0!==H&&null!==H||!b.MenuId||(H=b.MenuId);let U=b.SqmControlId;void 0!==U&&null!==U||!b.SourceControlId||(U=b.SourceControlId);(void 0!==U&&null!==U||void 0!==H&&null!==H)&&yP.a.uNk(new IF(U,c,H,a,Date.now()))}}x.dX&&32===l&&this.Cba&&this.Cba.oZb&&this.Cba.oZb(x,b);x.fle&&32===l&&this.Cba&&this.Cba.YQd&&this.Cba.YQd(x,b);return 32===
l||1===l}I$b(a,b=null){if(u.AFrameworkApplication.Ug||gm.a.instance.tw)return!1;const c=parseInt(a);b&&b.UILocation&&(this.IMa.xq=b.UILocation);if(!a||c===ld.ActionManager.j3b)return!0;a=this.oRb.vSc(c,b);a.dG&&(a=this.oRb.vSc(a.Wm,b));if(void 0!==a.dL&&null!==a.dL)return a.dL;c===G.a.$5a&&b&&(a.rd=b);return 32===this.IMa.La(a.Wm,1,a.rd)}clearCache(){this.oRb.clearCache()}}Object(m.a)(JF,"GeneralCuiUser",null,[1248,1468]);class KF{constructor(a,b,c,f){this.Fpf=a;this.iia=b;this.Wvc=c;this.L3a=f}d6f(){let a;
a=this.L3a.Xfj(this.Fpf);return{returnValue:this.L3a.bTc(this.Fpf),Ich:a}}srh(a,b){if(this.iia){var c=new J.DictionaryPropertySet;this.Wvc.execute(f=>{f.t3b(a)});c.setValue($a.a.it,a);c.setValue(P.a.instance.ga(20)?ab.a.noProof:Mc.a.Ywa,b);b=new pf.GraphTransaction(15);b.set(Oc.App.lP.fV);this.iia.WU(c);b.dispose()}}}Object(m.a)(KF,"LanguageEditor",null,[357]);var ki=d(211);class Yq{constructor(a=!1,b=0){this.bxd=null;this.MEd=Yq.U6f(Ya.a.Z6i());this.wAc=new yo.a;this.Bqa=[];this.Bpb=new Na.a;this.bmf=
a;this.cmf=0>=b?7:b;this.amf=this.YId=0;this.Ncf=!1;a&&(this.iFj(),u.AFrameworkApplication.pga(()=>{this.H3j()}))}get languages(){return this.MEd}iFj(){for(var a of this.MEd)this.wAc.$(a.LCID,a);a=[];try{var b=ki.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.cmf);for(const l of f){let x;({value:x}=this.wAc.Uf(parseInt(l))).returnValue&&a.push(x)}}}catch(f){ia.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
f.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.Bpb.contains(b)||(this.Bqa.push(c),this.Bpb.add(b));else c=u.AFrameworkApplication.lcid,({value:b}=this.wAc.Uf(c)).returnValue&&(this.Bqa.push(b),this.Bpb.add(c));this.vnh()}vnh(){const a=Pa.toArray(Pa.select(Pa.asEnumerable(this.Bqa),b=>b.LCID)).join(",");ki.a.$J("RecentlyUsedLcids",a,180)}YKe(a,b){if(a&&!(0<a.options.length)){var c=-1,f=Yq.U6f(this.Bqa);this.bmf&&0<f.length&&(c=Yq.xAf(f),c=Yq.Ysf(a,c,b),a.add(Yq.aki(),null));this.bxd||
(this.bxd=Yq.xAf(this.MEd));b=Yq.Ysf(a,this.bxd,b);-1===c&&(c=b);a.selectedIndex=c}}abl(a,b){if(this.bmf&&({value:c}=this.wAc.Uf(a)).returnValue){b=a!==b;if(this.Bpb.contains(a))a=Array.indexOf(this.Bqa,c),0<=a&&(Array.removeAt(this.Bqa,a),this.Bqa.push(c)),b&&this.YId++;else{this.Bpb.add(a);this.Bqa.push(c);if(this.Bqa.length>this.cmf){var c=this.Bqa.shift();this.Bpb.remove(c.LCID)}b&&this.amf++}this.vnh()}}H3j(){const a=this.YId+this.amf;!this.Ncf&&0<a&&(ia.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.YId/a),this.Ncf=!0)}static xAf(a){return Pa.toArray(Pa.select(Pa.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static aki(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static Ysf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static U6f(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(m.a)(Yq,"LanguageListHelper",null,[1467]);var IA=d(241);class Mt extends IA.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(Mt,"NumberButtonProps",IA.a,[]);class Kr{static get Pol(){return Kr.Nof||(Kr.Nof=
Db.a.instance.ub("Box4.ISpacingCommands"))}static get euh(){return!!Kr.Pol}static wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.IJa,Cb.a.view,Kr.IJa);a.je(D.a.IJa,1126)}static IJa(a,b,c,f,l){if(1===c||!Kr.euh)return Kr.euh?32:8;if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np)a=[],a.push(Object.assign(new Mt,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new Mt,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new Mt,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new Mt,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new Mt,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new Mt,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=nj.d(a);else{a=nj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=nj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=nj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=nj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const x=nj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),H=nj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),U=nj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=nj.c("LineSpacing.Menu.Controls",[a,b,c,f,x,H,U]);a=nj.e("msLineSpacing",a,"Menu");a=nj.f([a]);l.PopulationXML=a}return 32}}Kr.Nof=null;Object(m.a)(Kr,"LineSpacingRibbonMenu",null,[]);var zP=d(1118),AP=d(928);const BP=(a,b,c)=>{if(1===
c)return 32;a=Oc.App.Kb.notificationBar.LCa("Automation test",!1);a.image=3;Oc.App.Kb.notificationBar.Zh(a);return 32},DP=(a,b,c,f,l)=>{let x;if(!({xIh:x}=CP(l)).returnValue)return 16;mj.UISurfaces.mL().then(H=>{let U=null;var ja=Object.assign(new zP.a,{label:"OK",onExecute:()=>{U&&H.removeNotification(U)}});ja=Object.assign(new AP.a,{target:"#"+S.AppFrame.Llh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:ja,useTeachingStyles:x});ja=H.callout(ja);U=H.addNotification(ja);
return null},H=>{ia.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null});return 32},CP=a=>{let b;b=!1;if(!a)return{returnValue:!1,xIh:b};b=Boolean.parse(a);return{returnValue:!0,xIh:b}};class JA{constructor(a){this.WH=a}dPb(a){this.WH&&this.WH.sG(a)}}Object(m.a)(JA,"RibbonButtonUpdater",null,[1308]);var LF=d(295);class KA{constructor(){this.X6=this.Da=null}get name(){return"Box4.UI"}Zb(a){this.Da=a;a.register(1246,"Common.IReactContextualUILauncher").ma().oa(()=>
new CF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(1247,"Box4.IContextMenuController").ma().oa(()=>new EF(a.resolve("Common.IReactContextualUILauncher")));a.register(1248,"Box4.IGeneralCuiUser").oa(()=>new JF(a.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.Ta)).ma();a.register(HA,"Box4.UI.TableAltTextDialogFactory").ma().oa(()=>new HA(a.resolve("Box4.ITableEditor"),new LF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(357,"Box4.UI.ILanguageEditor").oa(()=>new KF(qd.a.instance.Pj,a.ub("Box4.ITextFormattingCommands"),a.Ja("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(1249,"Box4.UI.IAutoCorrectOptionsDialog").oa(()=>new FF(a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(Yq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().oa(()=>new Yq(u.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(DF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(EA,"Box4.UI.DefaultProofingContextMenuCreator").ma().oa(()=>new EA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(FA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().oa(()=>new FA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(JA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().oa(()=>new JA(this.Da.resolve("Box4.IAppFrame")))}init(){var a=Oc.App.Kb;const b=a.hb;Ir.yDj(Object(F.a)(b,b.Jjc,"onAuthenticationLost"),Object(F.a)(b,b.Kjc,"onAuthenticationRestored"),a.qpi);Jr.a.wb();a=u.AFrameworkApplication.Ta;a.ya(D.a.eJk,Cb.a.application,vP);a.ra(D.a.tkl,Cb.a.application,wP,96);a.ra(D.a.Ukl,Cb.a.application,xP,96);a=u.AFrameworkApplication.Ta;a.ra(D.a.Kml,Cb.a.application,BP,96);a.ra(D.a.ikl,Cb.a.application,
DP,96);Kr.wb();this.X6=this.Da.ub("Box4.IContextMenuController")}dispose(){this.X6&&(this.X6.dispose(),this.X6=null)}static main(){z.a.instance.Dc(new KA,6)}}Object(m.a)(KA,"Box4UIPackage",null,[2,3]);var MF=d(460),EP=d(878),Bs=d(203),FP=d(544),jv=d(376),Xm=d(316),gj=d(74);class NF{constructor(a){this.qna=a}}Object(m.a)(NF,"ValidParentData",null,[]);var By=d(370),GP=d(811),kv=d(293),OF=d(810),lv=d(605),zm=d(247),PF=d(357),lq=d(227);class QF{constructor(){this.yub=0}}Object(m.a)(QF,"BelowOutlineElementData",
null,[]);var Cs=d(420),HP=d(593),IP=d(477);class RF extends Cs.a{constructor(a,b,c,f){super(4,f);this.XPh=a;this.qwd=b;this.Lxd=c}get NMc(){return this.XPh}get eYb(){return this.qwd}get kSd(){return this.Lxd}Fxb(){var a=this.NMc;if(!a)return ia.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new HP.a(this.NMc.id,this.NMc.io,this.eYb?this.eYb.id:null);""!==a.characterData&&a.characterData&&(a=new IP.DeleteTextUpdateHint(this.NMc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(m.a)(RF,"DeleteParagraphOperation",Cs.a,[]);var JP=d(592),KP=d(476);class LA extends Cs.a{constructor(a,b,c,f,l){super(3,l);this.cHd=a;this.dHd=b;this.$Ub=f}get aJa(){return this.cHd}get SGb(){return this.dHd}get TIa(){return this.$Ub}Fxb(){const a=[];var b=new JP.AddParagraphUpdateHint(this.TIa.id,this.TIa.io,this.aJa?this.aJa.id:null);Array.add(a,b);""!==this.TIa.characterData&&this.TIa.characterData&&(b=new KP.a(this.TIa.id,0,this.TIa.characterData),
Array.add(a,b));return a}}Object(m.a)(LA,"InsertNewParagraphOperation",Cs.a,[]);var LP=d(591);class SF extends Cs.a{constructor(a,b,c,f){super(2,f);this.cHd=a;this.dHd=b;this.wWh=c}get aJa(){return this.cHd}get SGb(){return this.dHd}get QYg(){return this.wWh}Fxb(){const a=[],b=new LP.MergeParagraphUpdateHint(this.aJa.id,this.aJa.io,this.aJa.characterData.length,this.SGb.id,this.SGb.io,this.QYg.id,this.QYg.io);Array.add(a,b);return a}}Object(m.a)(SF,"MergeParagraphOperation",Cs.a,[]);var MP=d(590);
class TF extends Cs.a{constructor(a,b,c,f,l){super(1,l);this.fHd=a;this.M0h=b;this.qwd=c;this.Lxd=f}get bJa(){return this.fHd}get eYb(){return this.qwd}get kSd(){return this.Lxd}get opl(){return this.M0h}Fxb(){const a=[],b=new MP.a(this.bJa.id,this.bJa.io,this.opl,this.eYb.id,this.eYb.io,this.kSd.id,this.kSd.io);Array.add(a,b);return a}}Object(m.a)(TF,"SplitParagraphOperation",Cs.a,[]);var UF=d(319);class Xj{constructor(a,b,c,f,l,x=null){this.ap=this.fd=null;this.Tx=a;this.Zo=b;this.Vg=c;this.vPh=
f;this.tWh=l;this.dqa=x}Q3h(a){P.a.instance.ga(50)&&Oc.App.Ih&&Oc.App.Ih.rw&&Oc.App.Ih.YY.hra(a)}Ijb(a,b,c){Ta.OutlineElementNavigator.wi(a);Sb.ParagraphReader.el(a)?Xj.paragraphEditor.Av.Ijb(a,b,c):od.TableReader.aq(a)&&14===a.ri&&(b=(new kv.a(1,c)).UM,this.Ydl(Object(oa.a)(By.a,a.currentNode),b));Ta.OutlineElementNavigator.Re(a)}Ydl(a,b){a&&Object(Xa.a)(By.a,a)&&(a.$l=b)}get Av(){return jv.a.bxb}get Tf(){return this.fd||(this.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get C6(){return this.ap||
(this.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get eq(){return this.Zo.value}get Sf(){return this.Vg.value}get EB(){return this.Tx.value}get $i(){return fd.a.instance}eYd(){const a=FP.a.instance.createInstance(393229);a.setValue($a.a.GE,Xm.a.first);a.setValue($a.a.eIi,new Date);a.zud();return a}oFi(){const a=new EP.a;a.setValue($a.a.GE,Xm.a.first);return a}pod(a,b,c){const f=a.Fh;if(f){f.id.equals(Xj.B8e)||(Xj.B8e=f.id,Xj.hwc={});var l=Xj.hwc[b];b in Xj.hwc&&
f.L$a(l.id)&&f.ax&&f.ax.I_(l.id)||(l=new lq.a,l.setValue($a.a.author,b),l=f.mKa(l));a.properties.setValue(c,l.id);Xj.hwc[b]=l}}QLb(a,b){a.properties.setValue($a.a.lastModifiedTime,b)}n4e(a,b=null){const c=new pf.GraphTransaction(7);c.kd(a);b||(b=new Date);this.QLb(a,b);this.pod(a,this.NUc(),$a.a.DZb);""===fe.OutlineElementReader.pRc(a,$a.a.PHc)&&this.pod(a,this.NUc(),$a.a.PHc);c.dispose()}NUc(){return Oc.App.I1e.name}C0d(a,b,c=!1){if(P.a.instance.ga(56))fe.OutlineElementReader.ule(a)?(a=fe.OutlineElementReader.isRtl(a),
c?this.Yod(b,a):this.aLa(b,a)):this.xXk(b);else if(P.a.instance.ga(26)||P.a.instance.ga(89))a=fe.OutlineElementReader.isRtl(a),c?this.Yod(b,a):this.aLa(b,a)}mMb(a,b){var c=new tb.GraphIterator;c.set(a);c.rc(11);c=c.Jg(11);fe.OutlineElementReader.vm(c)!==b&&(this.aLa(c,b),P.a.instance.ga(54)?a.anchor.Dr(4):(c=1,b&&(c=3),a.setValue($a.a.Jl,c),a.setValue($a.a.eJ,c)))}aLa(a,b){const c=new pf.GraphTransaction(7);c.kd(a);this.Yod(a,b);if(P.a.instance.ga(26)){var f=new tb.GraphIterator;f.set(a);f.Bb(2)&&
Sb.ParagraphReader.el(f)&&(f=f.currentNode,b?(f.we(dh.a.Akd,!0),Xj.paragraphEditor.ZJ(f,3)):(f.removeProperty(dh.a.Akd),Xj.paragraphEditor.ZJ(f,1)))}f=new tb.GraphIterator;f.set(a);UF.a.instance.yHj(f);if(f.rc(10)){const l=f.Jg(10);f.Bb(1)===a&&this.EB.aLa(l,b)}c.dispose()}Yod(a,b){let c=null,f=null;if(this.Tf.gg&&a.isConnected){c=Sb.ParagraphReader.FTc(a,!0,!0);f=new Ka.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).H8())}b?a.properties.setValue($a.a.rY,!0):P.a.instance.ga(56)?a.properties.setValue($a.a.rY,
!1):(P.a.instance.ga(26)||P.a.instance.ga(89))&&a.properties.removeProperty($a.a.rY);if(this.Tf.gg&&c&&f)if(c.count!==f.count)ia.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}xXk(a){a.properties.removeProperty($a.a.rY)}Hca(a,b=null,c=!1){let f=null,l=null;if(!fe.OutlineElementReader.Yg(a))return ia.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var x=null;let H=null,U=0;b&&(x=b.formatting,H=b.style,U=b.languageId);c||({aJa:f,SGb:l}=this.fZf(a));b=Bs.a.instance.createInstance(393230);b.setValue($a.a.pq,"");a.Cl(b,2);a.Pk(b);Xj.paragraphEditor.joc(b);Xj.paragraphEditor.pjk(b);Xj.paragraphEditor.pPb(b);this.Q3h(b);x&&(b.Ra.first.formatting.om=x);U||(U=u.AFrameworkApplication.lcid);a.currentNode.we($a.a.ajb,a.currentNode.sa($a.a.ajb,U));P.a.instance.ga(54)&&a.currentNode.setValue(ab.a.glc,0);!P.a.instance.ga(71)||P.a.instance.ga(61)||H||
(x=Ab.StyleReader.qL(b))&&(H=x.$G(Ab.StyleReader.Woa));this.vPh.mUi(a);H&&Xj.jP.Eaa(H,b,!0);!c&&f&&(c=new LA(f,l,f,new lv.a(b),b.wRa),a.currentNode.YG().graphTransactionOperations.HZ(c));return b}fZf(a){let b;const c=new tb.GraphIterator;c.Rc(a);b=null;c.Fig?c.currentNode.YG().graphTransactionOperations.Mia(6):(Ta.OutlineElementNavigator.Vwa(c,!0,!1),b=this.ISc(c));c.Rc(a);a=this.SZf(c);return{aJa:b,SGb:a}}SZf(a){const b=new tb.GraphIterator;b.Rc(a);a=null;b.wzb||(Ta.OutlineElementNavigator.FJ(b,
!0,!1),a=this.ISc(b));return a}ISc(a,b=!1){a=Ta.OutlineElementNavigator.wi(a,!0);return a?this.k2f(a,b):(ia.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}k2f(a,b=!1){if(12===a.type)return b?new lv.a(a):new OF.a(a);a.YG().graphTransactionOperations.Mia(5);return new GP.a(a)}gui(a,b){var c=b.currentNode.clone();a.vL(c,null,1);a.Pk(c);c.WZ=b.currentNode;Ta.OutlineElementNavigator.wi(b);b.RW&1&&b.currentNode.O1a(null);c=b.currentNode.clone();c.aV=b.currentNode.aV;a.vL(c,
null,2);a.Pk(c);a.rT(1);c.WZ=b.currentNode;P.a.instance.ga(55)&&c.setValue(ab.a.io,bf.a.$Za());b.IB(11)}joc(a){a.Bb(2)&&a.Mi()}Ejh(a,b){const c=a.currentNode;Ta.OutlineElementNavigator.wi(a);const f=a.currentNode;Ta.OutlineElementNavigator.Re(a);b.ZA(1);Ta.OutlineElementNavigator.wi(b);a.Cl(b.currentNode,2);b.Mi();var l=new tb.GraphIterator;l.Rc(b);if(l.Bb(1)){const x=new tb.GraphIterator;x.Rc(a);const H=new NF(null);if(!this.Lnj(x,l.currentNode,H))return;zm.h(x,null,1,1,l,-1)}b.Mi();l=null;a.JF(1)&&
(l=a.currentNode);for(a.zc();kh.OutlineNavigator.V$(b);)a.vL(b.currentNode,l,1),l=b.currentNode,b.Mi();a.Pk(c);a.Pk(f);a.Mi()}lNb(a,b,c,f,l,x=!1){this.joc(b);const H=b.ri;var U=a.currentNode;let ja=null;var ya=null;let Va=null,hb=!1;Ta.OutlineElementNavigator.wi(a);const yb=a.ri;if(Sb.ParagraphReader.el(a)){var Zb=a.currentNode;(ya=Object(oa.a)(Mb.AParagraphNode,Zb))?ya.Ra&&ya.Ra.length||ia.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",ya):ia.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");ya=new lv.a(ya);(hb=c.Qa===Sb.ParagraphReader.textLength(Zb))&&(Va=this.SZf(b));var fc=b.currentNode;ja=this.Hca(b,void 0,!0);Xj.paragraphEditor.XZe(a,b,c,l,!0,x);P.a.instance.ga(71)&&(f?(l=Ab.StyleReader.bE(Zb))&&Xj.jP.Eaa(l,ja,!0):hb&&(l=Ab.StyleReader.bE(Zb))&&((Zb=l.sa(dh.a.G_g,null))?(l=Ab.StyleReader.qL(ja).$G(Zb),Xj.jP.Eaa(l,ja,!1)):Xj.jP.Eaa(l,ja,!0)));this.C0d(U,fc);this.eq.A0d(U,fc)}Ta.OutlineElementNavigator.Re(a);Ta.OutlineElementNavigator.Re(b);U=fe.OutlineElementReader.isEmpty(a,
!0);fc=fe.OutlineElementReader.isEmpty(b,!0);P.a.instance.ga(27)&&U&&!fc&&(b.RW&1&&(U=new PF.a,U.Rc(b),b.currentNode.O1a(U)),this.pod(b.currentNode,fe.OutlineElementReader.pRc(a.currentNode,$a.a.DZb),$a.a.DZb),this.pod(b.currentNode,fe.OutlineElementReader.pRc(a.currentNode,$a.a.PHc),$a.a.PHc),this.QLb(b.currentNode,fe.OutlineElementReader.pbj(a.currentNode)));Ta.OutlineElementNavigator.wi(a);(U=Object(oa.a)(Mb.AParagraphNode,a.currentNode))?U.Ra&&U.Ra.length||ia.ULS.sendTraceTag(38925762,307,15,
"srcParaNode: {0}. srcParaNode has no characterProperties",U):ia.ULS.sendTraceTag(38925761,307,15,"srcPara is null");U=new lv.a(U);Ta.OutlineElementNavigator.Re(a);(a=ja)?a.Ra&&a.Ra.length||ia.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(ia.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),ia.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:hb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:yb,
["destinationOutlineElementNodeType"]:H,["alwaysMoveEopToDestinationPara"]:x}));hb?(c=new LA(ya,Va,U,new lv.a(a),a.wRa),b.currentNode.YG().graphTransactionOperations.HZ(c)):(c=new TF(ya,c.Qa,U,new lv.a(a),a.wRa),b.currentNode.YG().graphTransactionOperations.HZ(c))}NCf(a,b){Ta.OutlineElementNavigator.wi(a);let c=Sb.ParagraphReader.ps(a.currentNode);const f=a.currentNode;P.a.instance.ga(14)&&(c=b?c&&!this.$i.HBk(f):c&&!this.$i.BBk(f));Ta.OutlineElementNavigator.Re(a);return c}merge(a,b,c,f,l=null,x=
!1,H=!1,U=!1){if(a.currentNode.id===b.currentNode.id)return!1;let ja,ya;var Va=new tb.GraphIterator;Va.Rc(b);ja=this.ISc(Va);Va.Rc(a);ya=this.ISc(Va,!0);if(!this.NCf(b,!0)||!this.NCf(a,!1))return!1;if(this.Sf.Kmc){var hb=Object(oa.a)(Mb.AParagraphNode,a.currentNode);hb=(c||!hb||!hb.characterData.length)&&!rb.ListReader.uk(a)}else hb=this.tWh.XGl(c,a);U||this.eq.merge(a,b,hb,l);Ta.OutlineElementNavigator.wi(a);l=a.currentNode.wRa;Ta.OutlineElementNavigator.wi(b);if(Sb.ParagraphReader.el(b)){if(P.a.instance.ga(50)&&
Oc.App.Ih.rw){U=b.currentNode;hb=a.currentNode;const yb=MF.CoauthLockEditor.getInstance();if(yb.HMb(this.$i.l5b(U))||yb.HMb(this.$i.l5b(hb)))return b.zc(),a.zc(),!1}U=!1;rb.ListReader.nx&&(hb=a.parentNode)&&fe.OutlineElementReader.n9(hb)&&(U=rb.ListReader.JUa(hb));P.a.instance.ga(71)&&(hb=(hb=Sb.ParagraphReader.isEmpty(a)||c)&&!U)&&(hb=Ab.StyleReader.l7f(b))&&Xj.jP.Eaa(hb,a.currentNode,!0);c&&this.dqa.Ilk(b.currentNode,a.currentNode,U,H);c=Xj.paragraphEditor.merge(a,b,c,f,x);f=Va.currentNode;Va=a.currentNode;
a.zc();c&&fe.OutlineElementReader.isEmpty(b,!0)&&this.fDa(b);a=new SF(ya,ja,new OF.a(f),l);Va.YG().graphTransactionOperations.HZ(a);return!0}b.zc();a.zc();return!1}BGj(a){const b=new tb.GraphIterator;b.set(a.node);b.$e();Ta.OutlineElementNavigator.Re(b);const c=this.T8b(b),f=this.T8b(b);this.lNb(b,c,a,!1,!0);fe.OutlineElementReader.isEmpty(b,!1)&&(this.eq.eoa(b),b.Mi());fe.OutlineElementReader.isEmpty(c,!1)&&!fe.OutlineElementReader.Yab(c)&&(this.eq.eoa(c),c.Mi());return f}Gda(a,b,c,f=null,l=!1){if(!this.hpi(a))return null;
const x=a.currentNode,H=rb.ListReader.uk(a);b||l||fe.OutlineElementReader.isEmpty(a,!1);l=this.eq.wjl(H);b=b?a.JF(1):a.currentNode;a.zc();c=this.EB.S8b(a,b,c,f);if(!c)return null;this.C0d(x,c);this.eq.A0d(x,c);l&&this.eq.hxl(a,x);return c}hpi(a){return fe.OutlineElementReader.Yg(a)&&(a=a.parentNode,gj.OutlineReader.n$b(a)||fe.OutlineElementReader.n9(a)||fe.OutlineElementReader.xua(a))?!0:!1}tWk(a){const b=new tb.GraphIterator;b.set(a);b.$e();b.IB(11);let c,f;({aJa:c,SGb:f}=this.fZf(b));let l=-1;12===
a.type&&(l=a.wRa);b.currentNode.YG().graphTransactionOperations.HZ(new RF(this.k2f(a,!0),c,f,l));this.fDa(b)}fDa(a){if(a.NI(1)){const b=new QF,c=new tb.GraphIterator;c.Rc(a);this.P3i(c,b)&&this.Av.SMc(a,-b.yub)}a.Mi();od.TableReader.Cs(a)&&this.tGk(a)}Jee(a,b,c){if(!gj.OutlineReader.Zt(a)&&!fe.OutlineElementReader.Yg(a))return null;const f=this.oFi();0<c&&c<Xm.a.last&&f.setValue($a.a.GE,Math.min(Xm.a.nil,c));a.vL(f,b,1);return f}DGj(a,b){if(!fe.OutlineElementReader.Yg(a)&&!fe.OutlineElementReader.XI(a)||
!gj.OutlineReader.bX(a.parentNode)&&!fe.OutlineElementReader.n9(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.zc();b=this.Jee(a,f,b);a.Pk(c);return b}tGk(a){fe.OutlineElementReader.XI(a)&&(a.NI(1)||a.Mi());this.PWf(a,!1);this.rvf(a)}PWf(a,b){var c,f=null;for(c=a.Bb(1);c;){var l=!1;fe.OutlineElementReader.xua(c)&&!a.NI(1)&&(l=!0);var x=c;c=a.Dj(1);if(l)l=new tb.GraphIterator,l.set(x),l.$e(),l.Mi();else if(fe.OutlineElementReader.xua(x)){if(f){l=new tb.GraphIterator;l.set(f);
var H=new tb.GraphIterator;H.set(x);H.$e();l.Cl(H.currentNode,1);H.Mi();H=fe.OutlineElementReader.E3(x);H===Xm.a.nil&&(H=1);(H=Math.max(0,fe.OutlineElementReader.E3(x)-H))?x.setValue($a.a.GE,Math.min(Xm.a.nil,H)):(l.Pk(x),a.Bb(1),zm.e(l),l.zc());b&&this.PWf(l,!0)}}else f=x}b=null;f=Xm.a.last+1;for(c=a.Bb(1);c;c=a.Dj(1))if(fe.OutlineElementReader.XI(a))x=fe.OutlineElementReader.E3(c),f>x&&(f=x,b=c);else{a.zc();return}if(b){for(c=a.Bb(1);c;c=a.Dj(1))c!==b&&a.currentNode.setValue($a.a.GE,Math.min(Xm.a.nil,
fe.OutlineElementReader.E3(c)-f));f+=fe.OutlineElementReader.E3(a.currentNode);a.currentNode.setValue($a.a.GE,Math.min(Xm.a.nil,f));c=new tb.GraphIterator;c.Rc(a);c.Pk(b);c.Bb(1);zm.e(c)}}Lnj(a,b,c){var f=fe.OutlineElementReader.E3(a.currentNode);if(1===f)return!0;if(fe.OutlineElementReader.XI(a))return!1;if(!a.E8(1)||this.OQj(a,b))return a.currentNode.setValue($a.a.GE,Math.min(Xm.a.nil,1)),!0;if(c.qna&&a.Pk(c.qna)){if(fe.OutlineElementReader.XI(a)&&1===f+fe.OutlineElementReader.E3(a.currentNode))return c.qna=
a.ZA(1),a.zc(),!0;a.zc()}if(c.qna&&a.Pk(c.qna)||!c.qna&&a.Bb(1)){if(a.currentNode!==b&&a.Cf(1)&&fe.OutlineElementReader.XI(a)&&1===f+fe.OutlineElementReader.E3(a.currentNode))return c.qna=null,!0;a.zc()}if(a.NTa(b)&&this.NQj(a,b)){for(c=a.Bb(1);c;c=a.Dj(1))c!==b&&c.setValue($a.a.GE,Math.min(Xm.a.nil,fe.OutlineElementReader.E3(c)+(f-1)));a.currentNode.setValue($a.a.GE,Math.min(Xm.a.nil,1));return!0}if(1>f)return f=this.Jee(a,c.qna,1-f),a.Pk(f),c.qna=null,!0;if(1<f){a.currentNode.setValue($a.a.GE,Math.min(Xm.a.nil,
1));b=null;let l=a.Bb(1);for(;l;){if(fe.OutlineElementReader.XI(a)){l.setValue($a.a.GE,Math.min(Xm.a.nil,f-1+fe.OutlineElementReader.E3(l)));l=a.Dj(1);continue}b||(b=this.DGj(a,f-1));const x=l;l=zm.j(a,b,1);l===b&&(l=a.Dj(1));c.qna===x&&(c.qna=b,b=null)}return!0}return!1}OQj(a,b){return tb.GraphIterator.Yca(()=>{if(1===a.E8(1)){const c=a.Bb(1);a.zc();if(c===b)return!0}return!1})}NQj(a,b){return tb.GraphIterator.Yca(()=>{let c;for(c=a.Bb(1);c;c=a.Dj(1))if(c!==b&&!fe.OutlineElementReader.XI(a))return a.zc(),
!1;return!0})}P3i(a,b){b.yub=0;do{const c=a.currentNode;if(a.Bb(1))b.yub-=fe.OutlineElementReader.E3(c);else{if(gj.OutlineReader.Zt(a)||null===a.currentNode)return!1;if(3!==a.role||!a.pka(1))for(;!a.Dj(1);)if(b.yub+=fe.OutlineElementReader.E3(a.currentNode),gj.OutlineReader.Zt(a)||null===a.currentNode)return!1}}while(fe.OutlineElementReader.XI(a));return!0}T8b(a,b=!1){return this.Iee(a,!1,b)}Iee(a,b,c=!1){const f=new tb.GraphIterator;f.Rc(a);a=new tb.GraphIterator;a.Rc(f);this.Gda(a,b,!1,null,c);
a.currentNode.setValue($a.a.GE,Math.min(Xm.a.nil,fe.OutlineElementReader.E3(f.currentNode)));f.Bb(1)&&zm.h(a,null,1,1,f,-1);return a}rvf(a){if(fe.OutlineElementReader.i1k(a)){1!==fe.OutlineElementReader.E3(a.currentNode)&&a.currentNode.setValue($a.a.GE,Xm.a.first);for(var b=a.Bb(1);b;)if(fe.OutlineElementReader.XI(a)){b=new tb.GraphIterator;b.Rc(a);b.zc();const c=new tb.GraphIterator;c.Rc(a);c.Bb(1);zm.h(b,a.currentNode,1,1,c,-1);b=a.tRa(1)}else this.rvf(a),b=a.Dj(1)}}static get jP(){return Xj.IK||
(Xj.IK=Db.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set jP(a){Xj.IK=a}static get paragraphEditor(){return Xj.Vw||(Xj.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Xj.Vw=a}}Xj.IK=null;Xj.Vw=null;Xj.B8e=null;Xj.hwc=null;Object(m.a)(Xj,"OutlineElementEditor",null,[1346]);var Uw=d(112),Vw=d(412),VF=d(596),mq=d(257);class $n{constructor(a){this.Akf=a}pFi(){const a=Bs.a.instance.createInstance(393228);a.setValue($a.a.GE,Xm.a.first);a.setValue($a.a.yii,0);
a.setValue($a.a.rx,gj.OutlineReader.JMf);(new VF.OutlineIndentInfo(!0)).znh(a);return a}LZ(a,b,c=null){const f=a.currentNode;if(!a.ZA(1))return this.S8b(a,null,b,c);fe.OutlineElementReader.XI(a)&&Ta.OutlineElementNavigator.VEe(a,!0);return fe.OutlineElementReader.Yg(a)?$n.Ph.Gda(a,!1,b,c):(a.Zoc(f),null)}gpi(a){return gj.OutlineReader.Mke(a.currentNode)||fe.OutlineElementReader.Yg(a)||fe.OutlineElementReader.XI(a)||Le.isTableCell(a)}S8b(a,b=null,c=!1,f=null){if(!this.gpi(a))return null;const l=$n.Ph.eYd();
this.Scl(l,a);a.jXc(l,b,1,this.Akf.RYf());a.Pk(l);c&&($n.Ph.Hca(a,f),Ta.OutlineElementNavigator.Re(a));P.a.instance.ga(25)&&$n.Ph.n4e(a.currentNode);return l}Scl(a,b){if(b=this.Ehj(b))switch(b.type){case 11:$n.Ph.C0d(b,a,!0);break;case 8:b=$n.Jk.isRtl(b),$n.Ph.Yod(a,b)}}Ehj(a){return this.Akf.I9d(a)}I7i(a,b){a=$n.Jk.jTc(a);return new Vw.a(a.x+gj.OutlineReader.AMc*(b?-1:1),a.y+gj.OutlineReader.RMf)}Qod(a){if(P.a.instance.ga(17)){var b=new tb.GraphIterator;b.set(a);b.ev();b=this.I7i(b.origin,gj.OutlineReader.vm(a));
mq.c(a,b.x,b.y)}}aLa(a,b){P.a.instance.ga(43)&&Hf.c(a)||a.setValue($a.a.eJ,b?11:9)}static get Jk(){return Uw.PageReader.instance}static get Ph(){return $n.Di||($n.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Ph(a){$n.Di=a}}$n.Di=null;$n.Kf=null;Object(m.a)($n,"OutlineEditor",null,[1399]);const NP=a=>{a.register($n,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().oa(()=>new $n(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(Xj,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().oa(()=>
new Xj(a.ie("Box4.IOutlineEditor"),a.ie("Box4.List.IListEditor"),a.ie("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class MA{get name(){return"Box4.OutlineLevelEditors"}Zb(a){NP(a)}init(){}dispose(){}static main(){z.a.instance.Dc(new MA)}}Object(m.a)(MA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class NA{get name(){return"Box4.TableEditors"}Zb(){}init(){}dispose(){}static main(){z.a.instance.Dc(new NA)}}
Object(m.a)(NA,"Box4TableEditorsPackage",null,[2,3]);class OA{get name(){return"Box4.TextLevelEditors"}Zb(){}init(){}dispose(){}static main(){z.a.instance.Dc(new OA)}}Object(m.a)(OA,"Box4TextLevelEditorsPackage",null,[2,3]);class Lr{constructor(a,b,c){this.hHd=this.H4a=this.eHd=this.G4a=this.cFd=null;this.vG=a;this.zQh=b;this.Tc=c;this.init()}init(){this.zQh.pb(Object(F.a)(this,this.Wrj,"handleEditingViewUpdatesSafe"));this.G4a=new Rd.a;this.eHd=new Rd.a;this.H4a=new Rd.a;this.hHd=new Nj.a}f_a(a){this.G4a.add(a.key,
a)}nQe(a){this.H4a.add(a.key,a)}Wrj(a){try{this.Vrj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),ia.ULS.sendTraceTag(5285580,334,10,a)}}Vrj(a){let b;({fZd:b}=Lr.lzl(this.Tc.Na.mb)).returnValue&&(a=Lr.m6i(a,this.cFd,b),this.QJk(a,b),this.cFd=b)}QJk(a,b){a=this.Q2i(a,b);let c;({notification:c}=Lr.ezl(a)).returnValue&&this.vG.sendNotification(c,!1)}Q2i(a,b){const c=new Rd.a;c.$(1,new Nj.a);c.$(0,new Nj.a);a.forEach(f=>
{3===f?(rd.ImageReader.iH(b.node)||this.n1k(b),this.Lej(c,b)):0===f&&this.M6i(c,b);return!0});return c}n1k(a){this.G4a.forEach((b,c)=>{c.reset(a);return!0})}M6i(a,b){let c=new Rd.a;rd.ImageReader.iH(b.node)||(c=this.J6i(b.Qa));this.K6i(a,this.eHd,c,Lr.uoh(this.cFd,b));this.eHd=c}J6i(a){const b=new Rd.a;this.G4a.forEach((c,f)=>{c=null;({KBa:c}=f.Qtc(a)).returnValue&&b.$(f.key,c);return!0});return b}K6i(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((x,H)=>{const U=
this.G4a.ga(x).e8||H.title;let ja;({value:ja}=c.Uf(x)).returnValue?f&&ja.bQ!==H.bQ&&(U&&a.ga(1).add(U),x=this.G4a.ga(x).e8,x=String.format(l,ja.title,x),ja.description&&(x+=", "+ja.description),a.ga(0).add(x)):U&&a.ga(1).add(U);return!0});c.forEach((x,H)=>{b.Hb(x)||(x=this.G4a.ga(x).e8,x=String.format(l,H.title,x),H.description&&(x+=", "+H.description),a.ga(0).add(x));return!0})}Lej(a,b){b=this.Fkj(b.node);b=this.evi(b);this.Gkj(a,this.hHd,b);this.hHd=b}Fkj(a){const b=new tb.GraphIterator;b.set(a);
if(!b.rc(1))return null;const c=new Nj.a;for(;1!==b.ri;)this.H4a.forEach((f,l)=>{let x;({Itb:x}=l.e3e(b)).returnValue&&c.add(x);return!0}),b.zc();c.reverse();return c}evi(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.a1===a[b+1].a1&&(this.H4a.ga(c.a1),({hvi:c}={returnValue:!1,hvi:null}).returnValue)){a.splice(b,2,c);continue}b++}return new Nj.a(a)}Gkj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.H4a.ga(c.ga(f).a1).$Rc(c.ga(f),
b.ga(f));l&&(c.ga(f).description&&(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let x=this.H4a.ga(c.ga(l).a1).$Rc(c.ga(l),null);x&&(c.ga(l).description&&(x+=", "+c.ga(l).description),a.ga(0).add(x))}for(c=f;c<b.length;c++)(f=this.H4a.ga(b.ga(c).a1).e8)&&a.ga(1).add(f)}static m6i(a,b,c){const f=new Nj.a;(a=a||Lr.r7k(b,c))?(f.add(3),f.add(0)):Lr.uoh(b,c)&&f.add(0);return f}static r7k(a,b){return!a||!a.node.id.equals(b.node.id)}static uoh(a,b){return!a||!a.equals(b)}static lzl(a){let b;
b=null;if(!a||!(nb.SelectionEditor.lx(a)||(a=nb.SelectionEditor.Sl(a,!0,!1),nb.SelectionEditor.lx(a)||a.Ua&&rd.ImageReader.iH(a.Ua.node))))return{returnValue:!1,fZd:b};b=a.Ua;return{returnValue:!!b,fZd:b}}static ezl(a){const b=new Nj.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<
b.length,notification:a}}}Object(m.a)(Lr,"AccessibilityContextManager",null,[1313]);class Ww{constructor(a,b){this.Hff=!1;this.wWb=null;this.xDc=this.bFc=!1;this.Haf=null;this.Zd=a;this.knb=b}get qyj(){return!!this.wWb}pb(a){this.Hff||(this.knb.duf(Object(F.a)(this,this.VGc,"afterEditingViewValidateEventHandler")),this.Hff=!0);this.Haf=a}VGc(a,b){(b.RM||b.RU)&&this.cpk(b.RM,b.RU)}cpk(a,b){this.qyj&&this.Zd.Lg(this.wWb);this.bFc=this.bFc||a;this.xDc=this.xDc||b;this.wWb=new af.a(4,1,Ww.nTi,()=>{this.Haf(this.bFc,
this.xDc);this.reset()},126);this.Zd.Db(this.wWb)}reset(){this.wWb=null;this.xDc=this.bFc=!1}}Ww.nTi=100;Object(m.a)(Ww,"EditingViewOnAfterValidateEventsConsolidator",null,[1314]);class PA{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){Oc.App.cyf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Zb(a){this.Da=a;a.register(Ww,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().oa(()=>
new Ww(u.AFrameworkApplication.ye,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Lr,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().oa(()=>new Lr(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),qd.a.instance))}static main(){z.a.instance.Dc(new PA)}}Object(m.a)(PA,"Box4AccessibilityPackage",null,[2,3]);class QA{constructor(a,b){this.Vmf=a;this.D2=b;this.rmf=
this.omf=this.pmf=this.qmf=this.W8e=this.smf=!0}get Kib(){return this.smf}get fJc(){return this.W8e}get Jld(){return this.qmf}get Coc(){return this.pmf}get Hld(){return this.omf}get KRe(){return this.rmf}aCf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.smf=f;break;case "CapitalizeFirstLetterOfSentences":this.W8e=f;break;case "ReplaceOrdianalsWithSuperscript":this.qmf=f;break;case "ReplaceHyphensWithDash":this.pmf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.omf=f;break;case "ReplaceQuoteWithSmartQuote":this.rmf=this.D2&&f}}}B3i(){this.Vmf.kae("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(F.a)(this,this.Gtk,"onGetRequestFinished"),8);ia.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}m5k(a){this.Vmf.Xrh("saveAutoCorrectOptionsSettings",
a);ia.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.aCf(a)}Gtk(a){a.tm?ia.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.aCf(a),ia.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!pa.a.count(a)))}}Object(m.a)(QA,"AutoCorrectOptionsInfo",null,[1320]);var Cy=d(218);class wj{static get Qyf(){wj.uQb||(wj.uQb=[],
wj.bGb(Ya.a.xe("ar-sa")),wj.bGb(Ya.a.xe("de-de")),wj.bGb(Ya.a.xe("es-es")),wj.uR(Ya.a.xe("en-029"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-au"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-bz"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-ca"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-gb"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-id"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-my"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("en-ph"),Ya.a.xe("en-us")),wj.uR(Ya.a.xe("zh-tw"),Ya.a.xe("en-us")),wj.bGb(Ya.a.xe("fr-fr")),wj.uR(Ya.a.xe("hr-ba"),Ya.a.xe("hr-hr")),
wj.uR(Ya.a.xe("it-ch"),Ya.a.xe("it-it")),wj.uR(Ya.a.xe("nb-no"),Ya.a.xe("nn-no")),wj.bGb(Ya.a.xe("nl-nl")),wj.uR(Ya.a.xe("ro-md"),Ya.a.xe("ro-ro")),wj.uR(Ya.a.xe("ru-md"),Ya.a.xe("ru-ru")),wj.uR(Ya.a.xe("sr-latn-ba"),Ya.a.xe("sr-latn-cs")),wj.uR(Ya.a.xe("sr-latn-me"),Ya.a.xe("sr-latn-cs")),wj.uR(Ya.a.xe("sr-latn-rs"),Ya.a.xe("sr-latn-cs")),wj.bGb(Ya.a.xe("sr-cyrl-cs")),wj.uR(Ya.a.xe("sv-fi"),Ya.a.xe("sv-se")));return wj.uQb}static bGb(a){wj.uQb[a.languageId]=a.LCID}static uR(a,b){wj.uQb[a.LCID]=b.LCID}static y1f(a){var b=
Ya.a.xe(a);if(!b)return 0;b=wj.Qyf[b.LCID]||wj.Qyf[b.languageId]||0;return b===a?0:b}}wj.uQb=null;Object(m.a)(wj,"AutoCorrectListFallback",null,[]);class ao{constructor(a,b,c,f,l){this.Tef=!1;this.whf=0;this.CNa=null;this.r_h=!1;this.qhf=this.gjf=!0;this.kef=null;this.uAc=!0;this.mob=a;this.DNa=b;this.Y3a=c;this.l7=f;this.fh=l;this.nVb=a?a.innerText:Sb.ParagraphReader.text(b)}get jx(){throw Error.notImplemented("The inherit class should have the default value.");}set jx(a){}get H1c(){return this.whf}psh(a){this.whf=
a}get mb(){return this.CNa}set mb(a){this.CNa=a}get Hcg(){return this.mob}get I9f(){return this.DNa}get rA(){return this.Y3a}get vR(){return this.l7}get yGb(){return this.gjf}set yGb(a){this.gjf=a}get xig(){return this.Tef}get wng(){return!1}get Jna(){return this.nVb}invoke(){this.Tef=!0;if(this.mob&&this.mob.parentNode&&!this.jx){var a=this.mob.innerText;if(this.yGb&&ha.a.substring(this.nVb,this.Y3a,this.l7)!==ha.a.substring(a,this.Y3a,this.l7))return 0;this.a8a(this.mob);this.psh(this.mob.innerText.length-
a.length);return 1}this.uAc||Nc.a.instance.Xb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.qhf)return Nc.a.instance.Xb("AbortedAction",{["Reason"]:this.kef}),0;var b=Sb.ParagraphReader.text(this.DNa);a=b.length;var c=this.nVb.length,f=ha.a.substring(this.nVb,this.Y3a,this.l7).trimEnd();b=ha.a.substring(b,this.Y3a,this.l7).trimEnd();f===b&&this.l7>c&&(this.l7=c);if(this.yGb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===ha.a.substr(b,0,c.length))this.l7-=2;else return 0;if(P.a.instance.ga(50)&&
Oc.App.Ih.rw&&MF.CoauthLockEditor.getInstance().HMb(ao.$i.l5b(this.DNa)))return 0;c=new pf.GraphTransaction(15);c.kd(this.DNa);c.jd=this.commandId;this.q8(this.DNa);this.psh(Sb.ParagraphReader.textLength(this.DNa)-a);this.CNa&&!this.r_h&&nb.SelectionEditor.lx(this.CNa)&&(b=this.CNa.Ua,a=b.Qa,f=b.Mb,b=b.node,b===this.DNa&&this.H1c&&(a>=this.l7&&(a+=this.H1c),f>=this.l7&&(f+=this.H1c),this.CNa=Qd.SelectionFactory.f3(b,a,f)));c.dispose();return 2}MIh(){this.uAc=this.sEf()}a8a(){}sEf(){var a=Sb.ParagraphReader.text(this.DNa);
const b=ha.a.substring(this.nVb,this.Y3a,this.l7).trimEnd();a=ha.a.substring(a,this.Y3a,this.l7).trimEnd();return b===a}static get $i(){return fd.a.instance}}Object(m.a)(ao,"AutoCorrectAction",null,[1367]);class bo extends ao{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.Fhf=null;this.cna=l;this.uV=x}get AVa(){return this.Fhf||(this.Fhf=Db.a.instance.ub("Box4.List.IListCommands"))}get eq(){return bo.Zo||(bo.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}get jx(){return!0}get commandId(){return D.a.VRd}set jx(a){super.jx=
a}}bo.Zo=null;Object(m.a)(bo,"RegexCorrectAction",ao,[]);const mv={[0]:{"a)":{autonumberBulletType:2,Ri:[65533,4,41]},"a.":{autonumberBulletType:4,Ri:[65533,4,46]},"A.":{autonumberBulletType:5,Ri:[65533,3,46]},"1)":{autonumberBulletType:7,Ri:[65533,0,41]},"1.":{autonumberBulletType:8,Ri:[65533,0,46]},"i.":{autonumberBulletType:14,Ri:[65533,2,46]},"I.":{autonumberBulletType:15,Ri:[65533,1,46]}},[1]:{"*":{Ri:[8226],font:"Arial"},"-":{Ri:[45],font:"Calibri"},"--":{Ri:[167],font:"Wingdings"},">":{Ri:[216],
font:"Wingdings"},"<>":{Ri:[118],font:"Wingdings"}}};class So extends bo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);So.$Ma=x}get commandId(){return D.a.NRd}q8(a){if(this.AVa){var b=tb.GraphIterator.nb(a);b.$e();Ta.OutlineElementNavigator.Re(b);var c=So.Sf.jw(b),f=this.cna[0];switch(ha.a.charAt(f,0)){case "*":var l=dj.a.wN(1,1);l.Kra="*";break;default:l=dj.a.wN(1,0)}c&&l.Sbe(c)||(c=new pf.GraphTransaction(15),c.Fy(b),b=this.j4i(l.listType,l.listStyle,f),null!=b&&this.AVa.Jli(b)&&(ia.ULS.sendTraceTag(509747285,
393,50,"Found list insert matching string "+f),So.$Ma.replaceTextRange(Wd.a.createTextRange(a,this.rA,this.vR+1),"",!0,!1)),c.dispose())}}j4i(a,b,c){var f;let l=null===(f=null===mv||void 0===mv?void 0:mv[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new J.DictionaryPropertySet;c.setValue(Mc.a.kE,a);c.setValue(Mc.a.dea,b);c.setValue($a.a.Ri,l.Ri);c.setValue($a.a.font,l.font);return c}static get characterPropertiesEditor(){return So.$Ma||(So.$Ma=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return So.Vg||
(So.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static nC(a,b,c,f,l){return new So(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new So(a,Rc.a(a).gb,b,c,f,l)}}So.$Ma=null;So.Vg=null;Object(m.a)(So,"BulletListAction",bo,[]);class ih extends bo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);this.FTb=!1;this.jx=!a;this.$Ma=x;ih.pl=new Yc.a}get jx(){return this.FTb}set jx(a){this.FTb=a}a8a(a){this.MUd(a.innerText,(b,c,f)=>{a.innerText=ha.a.substring(a.innerText,0,b)+f+ha.a.right(a.innerText,c)})}q8(a){this.MUd(Sb.ParagraphReader.text(a).substring(this.rA,
this.vR),(b,c,f)=>{this.$Ma.replaceTextRange(Wd.a.createTextRange(a,this.rA+b,this.rA+c),f,!0,!1)})}MUd(a,b){if(!(2>this.cna.length)&&this.cna[1]){var c=this.cna[1];ih.pl.count||this.bah();ih.pl.Hb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,ih.pl.ga(c)))}}}ih.pl=null;Object(m.a)(ih,"DictionarySequenceReplacerAction",bo,[]);class Xw extends ih{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return D.a.EZb}bah(){ih.pl.$("--","\u2014");ih.pl.$(" -- "," \u2013 ");ih.pl.$(" - "," \u2013 ");
ih.pl.$("-- ","\u2014");ih.pl.$(" --"," \u2013");ih.pl.$(" -"," \u2013")}static nC(a,b,c,f,l){return new Xw(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new Xw(a,Rc.a(a).gb,b,c,f,l)}}Object(m.a)(Xw,"DashAction",ih,[]);class Nt extends ih{constructor(a,b,c,f,l,x,H){super(a,b,c,f,l,x);this.Ca=H}get commandId(){return D.a.PRd}bah(){ih.pl.$(":)","\ud83d\ude0a");ih.pl.$(":-)","\ud83d\ude0a");ih.pl.$(":|","\ud83d\ude10");ih.pl.$(":-|","\ud83d\ude10");ih.pl.$(":(","\ud83d\ude41");ih.pl.$(":-(","\ud83d\ude41");
ih.pl.$(";)","\ud83d\ude09");ih.pl.$(";-)","\ud83d\ude09");ih.pl.$(":D","\ud83d\ude00");ih.pl.$(":-D","\ud83d\ude00");ih.pl.$(":')","\ud83d\ude02");ih.pl.$("=D","\ud83d\ude03");ih.pl.$(":>","\ud83d\ude06");ih.pl.$(":->","\ud83d\ude06");ih.pl.$(":3","\ud83d\ude0a");ih.pl.$(":-3","\ud83d\ude0a");ih.pl.$("B-)","\ud83d\ude0e");ih.pl.$("*-*","\ud83d\ude0d");ih.pl.$(":*","\ud83d\ude19");ih.pl.$(":-*","\ud83d\ude19");ih.pl.$(":X","\ud83d\ude36");ih.pl.$(":-X","\ud83d\ude36");ih.pl.$(":O","\ud83d\ude2e");
ih.pl.$(":-O","\ud83d\ude2e");ih.pl.$(":#","\ud83e\udd10");ih.pl.$(":-#","\ud83e\udd10");ih.pl.$(":P","\ud83d\ude1b");ih.pl.$(":-P","\ud83d\ude1b");ih.pl.$(";P","\ud83d\ude1c");ih.pl.$(";-P","\ud83d\ude1c");ih.pl.$(":-/","\ud83d\ude15");ih.pl.$("$-$","\ud83e\udd11");ih.pl.$(":S","\ud83d\ude16");ih.pl.$(":-S","\ud83d\ude16");ih.pl.$(":[","\ud83d\ude1f");ih.pl.$(":-[","\ud83d\ude1f");ih.pl.$(":\u2019(","\ud83d\ude22");ih.pl.$(":'(","\ud83d\ude22");ih.pl.$("@-@","\ud83d\ude31")}q8(a){this.MUd(Sb.ParagraphReader.text(a).substring(this.rA,
this.vR),(b,c,f)=>{b=Wd.a.createTextRange(a,this.rA+b,this.rA+c);c={};c.MenuItemId=f;this.Ca.mi(b,D.a.lGj,2,!1,null,c,null)})}static nC(a,b,c,f,l,x){return new Nt(null,a,b,c,f,l,x)}static dQ(a,b,c,f,l,x){return new Nt(a,Rc.a(a).gb,b,c,f,l,x)}}Object(m.a)(Nt,"EmojiAction",ih,[]);class Mp{constructor(a,b,c,f){this.sK=a;this.REc=b;this.Agf=f;this.Lz=c}Lkg(){if(!this.Lz)return!1;this.sK=this.sK.trimStart();return this.sK===this.Lz?!0:!1}BXj(){if(!this.sK)return!1;const a=this.sK.lastIndexOf(" ");return-1!==
a&&"."===this.sK.charAt(a-1)&&"."===this.sK.charAt(a-3)?!0:!1}AXj(){if(!this.sK)return!1;const a=this.sK.lastIndexOf(" ");return-1!==a&&"."===this.sK.charAt(this.sK.substring(0,a-1).lastIndexOf(" ")+2)?!0:!1}GQj(){return this.Lkg()&&(1===this.Lz.length&&"."===this.REc||"."===this.sK.charAt(1))?!0:!1}HQj(){return this.Lz?0<="\\/".indexOf(this.REc)||3===this.Lz.length&&0<="\\/".indexOf(this.Lz.charAt(1))?!0:!1:!1}HPj(){return this.Lz?0<=this.Lz.indexOf("@")?!0:!1:!1}ht(){if(!this.Lz)return!1;for(const a of Mp.Aae())if(ha.a.startsWith(this.Lz+
this.REc,a))return!0;return!1}qPj(){return this.Lz?"i"===this.Lz&&0<=Mp.quotes.indexOf(this.REc)?!0:!1:!1}QKj(){if(!this.sK)return!1;const a=ha.a.SFa(this.sK,this.sK.length-1);if(-1!==a&&this.sK.substring(a+1,this.sK.length)===this.Lz){const b=this.sK.charAt(a-1);if(0<=Mp.GUe.indexOf(b)||0<=Mp.quotes.indexOf(b)&&0<=Mp.GUe.indexOf(this.sK.charAt(a-2)))return!0}return!1}Xqi(){return!this.sK||this.BXj()||this.GQj()||this.HQj()||this.AXj()||this.HPj()||this.ht()?!1:this.Lkg()||this.qPj()||this.QKj()?
!0:!1}static Aae(){return Mp.Ehf||(Mp.Ehf="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Mp.GUe=".!?";Mp.quotes="'\"";Mp.Ehf=null;Object(m.a)(Mp,"FirstLetterUpperCaseRules",null,[]);class nq{constructor(a){this.Lz=a}U_i(){if(!this.Lz)return null;for(let a=0;a<nq.U8f().length;a++)if(this.Lz===nq.U8f()[a])return nq.Joj()[a];return null}static U8f(){return nq.ncf||(nq.ncf=["1/2","1/4","3/4"])}static Joj(){return nq.mcf||(nq.mcf=["\u00bd","\u00bc","\u00be"])}}nq.ncf=null;nq.mcf=null;Object(m.a)(nq,
"FractionsCollection",null,[]);class RA extends ao{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.mRb=l;this.uV=x}get jx(){return!0}get commandId(){return D.a.QRd}a8a(a){a.innerText=ha.a.substring(a.innerText,0,this.rA)+this.mRb+ha.a.right(a.innerText,this.vR)}q8(a){this.uV.replaceTextRange(Wd.a.createTextRange(a,this.rA,this.vR),this.mRb,!0,!1)}set jx(a){super.jx=a}static nC(a,b,c,f,l){return new RA(null,a,b,c,f,l)}}Object(m.a)(RA,"FractionsReplaceCorrectAction",ao,[]);class Ds extends bo{constructor(a,
b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return D.a.SRd}q8(a){if(this.AVa){var b=tb.GraphIterator.nb(a);b.$e();Ta.OutlineElementNavigator.Re(b);var c=this.cna[0],f=Ds.wpk(c),l=ha.a.sac(c.charAt(0))?4:2,x=Wd.a.createTextRange(a,this.rA,this.vR+1);this.eq.ZPa(a,b,l,f,x,c,this.AVa)}}static nC(a,b,c,f,l){return new Ds(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new Ds(a,Rc.a(a).gb,b,c,f,l)}static wpk(a){if(!a)return 0;a=ha.a.qg(a);if(!ha.a.oYc(a.charAt(0)))return 0;const b=a.charCodeAt(0)-97+1;let c;
for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(m.a)(Ds,"LetterListAction",bo,[]);class Yw extends bo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return D.a.ZPa}q8(a){if(this.AVa){var b=tb.GraphIterator.nb(a);b.$e();Ta.OutlineElementNavigator.Re(b);var c=this.cna[0],f=parseInt(c);if(!(99999999<=f)){var l=Wd.a.createTextRange(a,this.rA,this.vR+1);this.eq.ZPa(a,b,1,f,l,c,this.AVa)}}}static nC(a,b,c,f,l){return new Yw(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new Yw(a,
Rc.a(a).gb,b,c,f,l)}}Object(m.a)(Yw,"NumberListAction",bo,[]);class Np extends ao{constructor(a,b,c,f,l){super(a,b,c,f,l);Np.uV=l}get jx(){return!0}get commandId(){return D.a.TRd}a8a(){}q8(a){const b=Wd.a.createTextRange(a,this.vR-2,this.vR),c=new pf.GraphTransaction(15);c.kd(a);let f=!1,l=null,x=0;for(;x<a.Ra.length;){var H=a.Ra.ga(x),U=!!H.Lo||H.Vda;let ja=!!H.fieldRangeEnd||H.C_;if(H.cp>=b.Qa){H.cp>b.Qa||!H.formatting?l=f?H.formatting:Np.uV.lga(a,x,b.Qa,l):(l=H.formatting,ja&&(f=!1),U&&(f=!0));
x++;break}H.formatting&&(l=H.formatting);ja&&(f=!1);U&&(f=!0);x++}for(;x<a.Ra.length;){U=a.Ra.ga(x);if(U.cp>=b.Mb){if(U.cp>b.Mb||!U.formatting&&!U.Mj)f||Np.uV.lga(a,x,b.Mb,l);f||Np.mh.KY(l,!0);break}U.formatting&&(f||Np.mh.KY(l,!0),l=U.formatting);H=!!U.Lo||U.Vda;U=!!U.fieldRangeEnd||U.C_;H&&(f=!0);!H&&U&&(f=!1);x++}c.dispose()}set jx(a){super.jx=a}static get mh(){return Np.Kf||(Np.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}static nC(a,b,c,f){return new Np(null,a,b,c,f)}}Np.uV=null;Np.Kf=
null;Object(m.a)(Np,"OrdinalsReplaceCorrectAction",ao,[]);class vl extends bo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);vl.Apb||vl.xql();this.$Ma=x}get commandId(){return D.a.URd}q8(a){if(!a.Vag){var b=this.CNa.Ua.node===a,c=-1,f=3;this.cna[2]&&(c=parseInt(this.cna[2]));this.cna[1]&&(f=parseInt(this.cna[1]));if(!(20<c||100<f)){a.YG().graphTransactionOperations.Mia(7);var l=tb.GraphIterator.nb(a);l.$e();Ta.OutlineElementNavigator.Re(l);vl.Ph.Gda(l,!1,!1);vl.Ph.Hca(l);for(let U=0;U<f;++U){const ja=
[];var x=U%vl.Apb.length,H=0<c?c:vl.Apb[x].length;for(let ya=0;ya<H;++ya)Array.add(ja,vl.Apb[x][ya%vl.Apb[x].length]);x=Wd.a.Lj(l.currentNode,0);H=gc.a.xs(x);2!==Oc.App.mode?vl.mh.e0a(H,1142):vl.mh.Dm(H,ab.a.noProof,!0);this.$Ma.replaceTextRange(x,ja.join(" "),!0,!1);U<f-1&&(Ta.OutlineElementNavigator.Re(l),vl.Ph.Gda(l,!1,!1),vl.Ph.Hca(l))}c=l.currentNode;l=tb.GraphIterator.nb(a);l.$e();Ta.OutlineElementNavigator.Re(l);l.Mi();b&&(this.CNa=Qd.SelectionFactory.Sg(c,Sb.ParagraphReader.textLength(c)))}}}static get Ph(){return vl.Di||
(vl.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get mh(){return vl.Kf||(vl.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}static xql(){vl.Apb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static nC(a,b,c,f,l){return new vl(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new vl(a,Rc.a(a).gb,b,c,f,l)}}vl.Apb=null;vl.Di=null;vl.Kf=null;Object(m.a)(vl,"RandAction",bo,[]);class WF{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.aAj=b;this.Epj=c;this.flags=f}}Object(m.a)(WF,"RegexAutoCorrectEntry",null,[]);class sn extends bo{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return D.a.WRd}q8(a){if(this.AVa){var b=
tb.GraphIterator.nb(a);b.$e();Ta.OutlineElementNavigator.Re(b);var c=this.cna[0],f=ha.a.substring(c,0,c.indexOf("."));f=sn.xpk(f);if(!(0>=f)){var l=ha.a.sac(c.charAt(0))?5:3,x=Wd.a.createTextRange(a,this.rA,this.vR+1);this.eq.ZPa(a,b,l,f,x,c,this.AVa)}}}static nC(a,b,c,f,l){return new sn(null,a,b,c,f,l)}static dQ(a,b,c,f,l){return new sn(a,Rc.a(a).gb,b,c,f,l)}static zSi(){sn.Hqa||(sn.Hqa={},sn.Hqa.M=1E3,sn.Hqa.D=500,sn.Hqa.C=100,sn.Hqa.L=50,sn.Hqa.X=10,sn.Hqa.V=5,sn.Hqa.I=1)}static xpk(a){if(!a)return 0;
sn.zSi();a=ha.a.OB(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=sn.Hqa[ha.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}sn.Hqa=null;Object(m.a)(sn,"RomanListAction",bo,[]);class Zw extends ao{constructor(a,b,c,f,l,x){super(a,b,c,c+1,x);this.uV=x;this.q2h=f;this.W9e=l;this.yGb=!1}get jx(){return!1}get commandId(){return D.a.Vgi}a8a(a){a.innerText=ha.a.substring(a.innerText,0,this.rA)+this.W9e+ha.a.right(a.innerText,this.vR)}q8(a){this.uV.replaceTextRange(Wd.a.createTextRange(a,this.rA,
this.vR),this.q2h,!0,!1);this.uV.replaceTextRange(Wd.a.createTextRange(a,this.rA,this.rA+1),this.W9e,!0,!1)}set jx(a){super.jx=a}static nC(a,b,c,f,l,x){if("'"!==c&&'"'!==c)return null;var H=tb.GraphIterator.nb(a);H.$e();Ta.OutlineElementNavigator.Re(H);if(fe.OutlineElementReader.vm(H.currentNode))return null;f=!b||ha.a.Ime(f)||-1!==Array.indexOf(Zw.Azk,f);H="'"===c;return new Zw(x,a,b,c+"",f?H?"\u2018":"\u201c":H?"\u2019":"\u201d",l)}}Zw.Azk=["[","{","("];Object(m.a)(Zw,"SmartQuoteCorrectAction",
ao,[]);class Es extends ao{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.mRb=l;this.uV=x}get jx(){return Es.FTb}set jx(a){Es.FTb=a}get commandId(){return D.a.YRd}MIh(){this.uAc=this.sEf();this.uAc||(this.qhf=!1,this.kef="MatchTextIsNotTheSame")}a8a(a){a.innerText=ha.a.substring(a.innerText,0,this.rA)+this.mRb+ha.a.right(a.innerText,this.vR)}q8(a){this.uV.replaceTextRange(Wd.a.createTextRange(a,this.rA,this.vR),this.mRb,!0,!1)}static dQ(a,b,c,f,l){const x=Rc.a(a);return new Es(a,x?x.gb:null,b,c,f,
l)}static nC(a,b,c,f,l){return new Es(null,a,b,c,f,l)}}Es.FTb=!1;Object(m.a)(Es,"StringReplaceCorrectAction",ao,[]);class Dy extends ao{constructor(a,b,c,f,l,x,H,U){super(a,b,c,f,l);this.uV=l;this.DD=x;this.hUh=H;this.JD=U}get jx(){return!0}get commandId(){return D.a.$Rd}a8a(a){let b=ha.a.substring(a.innerText,this.rA,this.vR);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=ha.a.substring(a.innerText,0,this.rA)+b+ha.a.right(a.innerText,this.vR)}q8(a){const b=
this.rA,c=this.rA+1,f=a.characterData.substring(b,c).charAt(0);ha.a.sac(f)||(a=Wd.a.createTextRange(a,b,c),this.gLj(a)||this.uV.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}gLj(a){return this.hUh?!!this.DD&&this.DD.tua(a):!1}set jx(a){super.jx=a}static dQ(a,b,c,f){const l=Rc.a(a);return new Dy(a,l?l.gb:null,b,c,f,null,!1,null)}static nC(a,b,c,f,l,x,H){return new Dy(null,a,b,c,f,l,x,H)}}Object(m.a)(Dy,"UpperFirstLetterAutoCorrect",ao,[]);class Mr{constructor(a,b){this.Agf=b;this.Lz=a}cIl(){const a=
Number.parseInvariant(this.Lz.substring(0,this.Lz.length-2));switch(Number.parseInvariant(this.Lz.charAt(this.Lz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}RQj(){var a=Ya.a.xe(this.Agf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.Lz||2>=this.Lz.length)return!1;for(a=0;a<Mr.XUc().length;a++)if(this.Lz.toLowerCase().endsWith(Mr.XUc()[a])){if(RegExp("^\\d+$").test(this.Lz.substr(0,
this.Lz.length-2))){const b=this.cIl();if(this.Lz.toLowerCase().endsWith(Mr.XUc()[a])&&b===Mr.XUc()[a])return!0}break}return!1}static XUc(){return Mr.mkf||(Mr.mkf=["st","nd","rd","th"])}}Mr.mkf=null;Object(m.a)(Mr,"ValidateOrdinalsRule",null,[]);class Ym{constructor(a,b,c,f,l,x,H){this.F4a=[];this.Smb=[];this.tQb=[];this.yxd=[];this.hqa=-1;this.Edf=this.D2=this.Yxc=!1;this.fzc=a;this.fh=b;this.DD=c;this.Ca=f;this.WR=x;this.JD=H;l?(this.Yxc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||l.ka("OneNoteInsertEmojiIsEnabled"),
this.D2=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.Edf=l.ka("HyperlinkUrlValidationIsEnabled"),ia.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.Yxc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.D2})):(ia.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.D2=this.Yxc=!1)}gje(a){return 0<=Ym.ORd.indexOf(a)}qWj(a){return 0<=Ym.ZRd.indexOf(a)}Tjg(a){return a.toLowerCase()===a}sac(a){return a.toUpperCase()===
a}oYc(a){return a.toLowerCase()!==a.toUpperCase()}YMj(a,b,c,f){return(new Mp(a,b,c,f)).Xqi()}Y6i(a){do{if(a.getAttribute("xml:lang"))return Ya.a.xe(a.getAttribute("xml:lang"))||Ya.a.c9b;if(a.getAttribute("lang"))return Ya.a.xe(a.getAttribute("lang"))||Ya.a.c9b;a=a.parentNode}while(a&&1===a.nodeType);return Ya.a.c9b}p6d(a){return Ya.a.xe(gc.a.language(gc.a.xs(a)))||Ya.a.c9b}SPc(a,b){0>b&&(b=0);let c=-1;const f=Ym.ORd.length;for(let l=0;l<f;++l){const x=a.lastIndexOf(ha.a.charAt(Ym.ORd,l),b);x>c&&(c=
x)}a=ha.a.SFa(a,b);a>c&&(c=a);return c}BXi(a){for(let b=0;b<a.length;++b)if(this.oYc(ha.a.charAt(a,b)))return b;return-1}jWf(a,b){if(!a||0>b)return-1;let c=b;c=c?this.SPc(a,c-1):-1;c=c>ha.a.SFa(a,b-1)?c:ha.a.SFa(a,b-1);c++;return c}cWf(a,b,c){if(!P.a.instance.ga(70))return null;this.t3b(b);if(!this.Smb[b])if(b=wj.y1f(b),0<b){if(this.t3b(b),!this.Smb[b])return null}else return null;if(c&&this.tQb[b]&&Array.contains(this.tQb[b],a+c))return null;c=this.Smb[b][ha.a.qg(a)];if("string"!==typeof c||c===
a)return null;if(c){var f=this.BXi(a);if(0>f||this.Tjg(ha.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=ha.a.charAt(a,f);b&&!this.sac(l)&&(b=!1)}return b?ha.a.OB(c):ha.a.OB(ha.a.substring(c,0,1))+ha.a.right(c,1)}return null}JXi(a,b,c,f){bd.a.mark(4666);const l=this.Y6i(b).LCID;let x=0,H=a;const U=b.innerText;if(this.xje(U.substring(U.lastIndexOf(" ",a)+1,a)))return bd.a.mark(4667),null;let ja=null;var ya=!1;do{H=H?this.SPc(U,H-1):-1;if(-1===H&&!c){ya=b;var Va=null;if(!this.gje(U.charAt(0))){do{for(;ya&&
!ya.previousSibling;)ya=ya.parentNode;ya&&(ya=ya.previousSibling,Va=ya.innerText)}while(ya&&!Va);if(ya&&Va&&!this.gje(ha.a.charAt(Va,Va.length-1)))return bd.a.mark(4667),null}ya=!0}Va=ha.a.substring(U,H+1,a);++x;var hb=this.cWf(Va,l,f.toString());if(hb)ja=Es.dQ(b,H+1,a,hb,this.fh);else for(hb=0;hb<this.F4a.length;++hb){const yb=this.F4a[hb];if(!(yb.flags&1&&!(c&&1>H)||yb.flags&4||yb.flags&2&&" "!==f)){const Zb=yb.pattern.exec(Va);if(Zb){ja=yb.aAj(b,H+1,a,Zb,this.fh,this.Ca);break}}}}while(!ya&&!ja&&
x<Ym.dYg&&0<=H);bd.a.mark(4667);return ja}FXi(a,b,c){const f=a.node;let l=Sb.ParagraphReader.text(f);0>b&&(b=a.Qa);a=this.p6d(a).LCID;if(this.xje(l.substring(ha.a.SFa(l,b)+1,b)))return null;var x=-1,H=oc.HyperlinkReader.E5b(f);for(var U=0;U<H.length;U++)if(b>H[U].Mb)x=H[U].Mb;else{if(b>H[U].Qa)return null;break}H=null;U=(U=b)?this.SPc(l,U-1):-1;U<x&&(U=x-1);x=ha.a.substring(l,U+1,b);x=x.trimStart();if(1>U)for(let ja=0;ja<this.F4a.length;++ja){const ya=this.F4a[ja];let Va=l;" "!==c&&(Va=l+c);if(ya.pattern.exec(Va))return null}l=
l.substring(0,b);if(!this.YMj(l,c.toString(),x,a))return null;x.charAt(0).toUpperCase()!==x.charAt(0)&&(H=Dy.nC(f,U+1,b,this.fh,this.DD,P.a.instance.ga(14),this.JD));return H}HVf(a,b,c){a=Qd.SelectionFactory.tj(a,!1);if(!a)return null;a=a.Ye;return nb.SelectionEditor.Tg(a)?this.FXi(a,b,c):null}xje(a){return ha.a.j9(a)}w3d(a,b,c,f){bd.a.mark(4666);const l=a.node,x=this.p6d(a).LCID,H=Sb.ParagraphReader.text(l);0>b&&(b=a.Qa);if(c&&!this.gje(ha.a.charAt(H,b))||this.xje(H.substring(ha.a.SFa(H,b)+1,b)))return bd.a.mark(4667),
null;a=-1;c=oc.HyperlinkReader.E5b(l);for(var U=0;U<c.length;U++)if(b>c[U].Mb)a=c[U].Mb;else{if(b>c[U].Qa)return null;break}c=0;U=b;let ja=null;do{U=U?this.SPc(H,U-1):-1;U<a&&(U=a-1);const Va=ha.a.substring(H,U+1,b);++c;var ya=this.cWf(Va,x,f==A.a.uMa?".":null);if(ya)this.WR.Kib&&(ja=Es.nC(l,U+1,b,ya,this.fh));else for(ya=0;ya<this.F4a.length;++ya){const hb=this.F4a[ya];if(!(hb.flags&1&&!(0>U)||hb.flags&4&&f!==A.a.tq||hb.flags&2&&f!==A.a.pP)){const yb=hb.pattern.exec(Va);if(yb){ja=hb.Epj(l,U+1,b,
yb,this.fh,this.Ca);if(ja.commandId!==D.a.EZb&&!this.WR.Kib||ja.commandId===D.a.EZb&&!this.WR.Coc)ja=null;break}}}}while(0<=U&&U>=a&&!ja&&c<Ym.dYg);bd.a.mark(4667);return ja}GVf(a,b,c){a=Qd.SelectionFactory.tj(a,!1);if(!a)return null;a=a.Ye;return nb.SelectionEditor.Tg(a)?this.w3d(a,b,!1,c):null}NVf(a,b){a=Qd.SelectionFactory.tj(a,!1);if(!a)return null;a=a.Ye;if(!nb.SelectionEditor.Tg(a)||oc.HyperlinkReader.Xka(a,!1))return null;var c=Sb.ParagraphReader.text(a.node);const f=0<b?ha.a.SFa(c,b-1)+1:
ha.a.SFa(c,c.length-1)+1;b=0<b?b:c.length;c=ha.a.substring(c,f,b);return!c||this.Edf&&!oc.HyperlinkReader.Dme(c)||!ha.a.j9(c)&&!ha.a.C9b(c)||!Ym.hyperlinkEditor.mXk(a,f,b)?null:this.fzc.WDi(a.node,f,b)}RVf(a,b){var c=Qd.SelectionFactory.tj(a,!1);if(!c)return null;var f=c.Ye;if(!nb.SelectionEditor.Tg(f))return null;0>b&&(b=f.Qa);var l=Sb.ParagraphReader.text(f.node);c=this.jWf(l,b);const x=Ym.ZRd.length;for(let H=0;H<x;++H){const U=l.lastIndexOf(ha.a.charAt(Ym.ZRd,H),b-1);U>c&&(c=U+1)}l=ha.a.substring(l,
c,b);if(!l)return null;f=this.p6d(f).LCID;return(new Mr(l,f)).RQj()?Np.nC(a,c,b,this.fh):null}FVf(a,b){var c=Qd.SelectionFactory.tj(a,!1);if(!c)return null;c=c.Ye;if(!nb.SelectionEditor.Tg(c))return null;0>b&&(b=c.Qa);var f=Sb.ParagraphReader.text(c.node);c=this.jWf(f,b);f=ha.a.substring(f,c,b);return f?(f=(new nq(f)).U_i())?RA.nC(a,c,b,f,this.fh):null:null}oYi(a,b,c,f,l){var x=Qd.SelectionFactory.tj(a,!1);if(!x)return null;x=x.Ye;if(c>b||!nb.SelectionEditor.Tg(x))return null;0>b&&(b=x.Qa);if(0>b)return null;
x=Sb.ParagraphReader.text(x.node);return Zw.nC(a,c,l,b?x.charAt(b-1):"\x00",this.fh,f)}RBa(a,b,c,f){Array.add(this.F4a,new WF("^"+a+"$",b,c,f))}$De(a){if(this.Smb[this.hqa]){const b=this.Smb[this.hqa];for(let c in a)b[c]=a[c]}else this.Smb[this.hqa]=a}aEe(a){this.tQb[this.hqa]?Array.addRange(this.tQb[this.hqa],a):this.tQb[this.hqa]=a}oSe(){this.hqa=-1}XRd(){this.GRi(this.hqa);this.hqa=-1}D_j(a,b){this.yxd[b]||(this.yxd[b]=!0,this.hqa=b,b=document.createElement("script"),b.type="text/javascript",b.src=
a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}GRi(a){a=wj.y1f(a);0<a&&this.t3b(a)}N_j(){P.a.instance.ga(70)&&(this.t3b(1033),this.RBa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",vl.dQ,vl.nC,5),this.RBa("(\\d+)[\\.|\\)]",Yw.dQ,Yw.nC,3),this.RBa("(L|l|C|c|D|d|M|m){1}\\.",Ds.dQ,Ds.nC,3),this.RBa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",sn.dQ,sn.nC,11),this.RBa("([A-Za-z]){1}[\\.|\\)]",Ds.dQ,Ds.nC,
3),this.RBa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",So.dQ,So.nC,3),this.RBa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Xw.dQ,Xw.nC,0),this.Yxc&&(this.RBa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Nt.dQ,Nt.nC,0),this.RBa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Nt.dQ,Nt.nC,0)))}t3b(a){this.yxd[a]||this.D_j(Cy.a.Uii(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return Ym.zn||(Ym.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}}Ym.ORd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";
Ym.ZRd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Ym.GUe=".!?";Ym.dYg=5;Ym.zn=null;Object(m.a)(Ym,"AutoCorrectRules",null,[1317]);class SA{constructor(a,b,c,f,l,x){this.kqa=this.pF=null;this.mK=a;this.Tc=b;this.ld=c;this.$7e=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.c8e=f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.D2=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.Sba=l;this.Tza=!!x;this.Xs=x;this.pZh=new yo.a;this.Tza&&this.Tc.wF(Object(F.a)(this,
this.rHb,"onSetSelectionFinished"))}Ttc(a,b,c=-1){if(this.Sba.Kib||this.Sba.Coc)if(b=this.mK.NVf(a,c)||this.mK.GVf(a,c,b))this.pF||(this.pF=new Lg),this.pF.ya(b);this.$7e&&this.Sba.fJc&&(b=this.mK.HVf(a,c," "))&&(this.pF||(this.pF=new Lg),0<this.pF.WFa&&(this.pF.fta(0).jx=!0,b.yGb=!1),this.pF.ya(b));this.c8e&&(this.Sba.Jld&&4!==Oc.App.mode&&(b=this.mK.RVf(a,c))&&(this.pF||(this.pF=new Lg),this.pF.ya(b),ia.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.Sba.Hld&&
(a=this.mK.FVf(a,c))&&(this.pF||(this.pF=new Lg),this.pF.ya(a),ia.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}sJf(a,b,c,f,l,x){const H=new Lg;if(0<b){if(!this.$7e&&this.Sba.Kib){var U=this.mK.JXi(c,f,l,x);U&&H.ya(U)}else{if(this.Sba.Kib||this.Sba.Coc)if(U=0," "===x?U=A.a.pP:"."===x&&(U=A.a.uMa),U=this.mK.GVf(a,b,U))U.jx=!0,H.ya(U);this.Sba.fJc&&(U=this.mK.HVf(a,b,x))&&(0<H.WFa&&(U.yGb=!1),H.ya(U))}this.c8e&&(this.Sba.Jld&&4!==Oc.App.mode&&(U=this.mK.RVf(a,b))&&(H.ya(U),
ia.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.Sba.Hld&&(U=this.mK.FVf(a,b))&&(H.ya(U),ia.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===x||'"'===x)&&this.D2&&this.Sba.KRe&&(U=this.mK.oYi(a,b,c,f,x))&&(H.ya(U),ia.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(let ja of this.pZh.values)if((U=ja.sJf(a,b,c,f,l,x))&&!U.isEmpty())for(let ya=0;ya<U.WFa;ya++)H.ya(U.fta(ya));return H}xDe(a,b){return this.mK.NVf(a,
b)}Knh(a){this.pF||(this.pF=new Lg);this.pF.ya(a)}ZHj(a){if(this.pF){var b=!1;for(var c=0;c<this.pF.WFa;c++){var f=this.pF.fta(c);if(!f)return;if(!f.xig){b=!0;break}}if(b){b=this.kqa=null;c=new pf.GraphTransaction(15);c.jd=a;a=!1;for(f=0;f<this.pF.WFa;f++){let l=this.pF.fta(f);if(!l)return;if(l.xig)continue;this.Tza&&l.jx&&l.wng&&(b=l);a||(a=!0,c.kd(l.I9f));l.mb=this.Tc.Na.mb;const x=this.ld.Vp(l.commandId);l.invoke();x.end();this.Tc.setSelection(l.mb)}this.pF=null;this.kqa=b?b.commandId:null;a&&
c.dispose()}}}$Hj(a){this.kqa=null;const b=new pf.GraphTransaction(15);b.kd(a.I9f);b.jd=a.commandId;a.mb=this.Tc.Na.mb;const c=this.ld.Vp(a.commandId);a.invoke();c.end();this.Tc.setSelection(a.mb);this.Tza&&a.jx&&a.wng&&(this.kqa=a.commandId);b.dispose()}aIj(a){this.kqa=null;return a.invoke()}Byj(){return this.Tza&&!!this.kqa}ark(a){if(!this.Tza||!this.kqa)return!1;const b=this.kqa;this.kqa=null;if(!a||!this.Xs.NW||this.Xs.gZd!==b)return!1;this.Xs.undo();return!0}rHb(){this.kqa=null}}Object(m.a)(SA,
"AutoCorrectScheduler",null,[1316]);class Nr extends ao{constructor(a,b,c,f,l,x){super(a,b,c,f,l);this.llf=this.s2=null;this.uV=l;this.fd=x}get b9(){return this.s2||(this.s2=Db.a.instance.ub("Box4.IInternalLinkManager"))}get jah(){return this.llf||(this.llf=Db.a.instance.ub("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get jx(){return!0}get commandId(){return D.a.RRd}q8(a){bd.a.mark(7012);const b=new pf.GraphTransaction(15);b.kd(a);var c=this.rA,f=this.vR,l=Sb.ParagraphReader.text(a),x=l.substring(c,
f);const H=({tjc:U}=ha.a.A_e(x)).returnValue;x!==H&&(c+=U,f=c+H.length);x=Wd.a.createTextRange(a,c,f);var U=l.substring(c,f);Nr.NOj(l,c,f)&&(this.uV.replaceTextRange(Wd.a.createTextRange(a,c-1,f+1),U,!0,!1),--c,--f,x=Wd.a.createTextRange(a,c,f),c=Qd.SelectionFactory.Sg(a,f),qd.a.instance.setSelection(c));c=oc.HyperlinkReader.oEa(U);Nr.hyperlinkEditor.oja(x,c,!1);l=U="";f=!1;this.b9&&({Xgh:U,j0i:l}=this.b9.sDh(c,!0)).returnValue&&(c=U,f=!0,U=oc.HyperlinkReader.tC(x,!1),Nr.hyperlinkEditor.zM(U[0].paragraph,
U[0].hyperlink),""!==l&&(this.uV.replaceTextRange(x,l,!0,!1),x=Wd.a.createTextRange(a,this.rA,this.rA+l.length),a=Qd.SelectionFactory.Sg(a,this.rA+this.rA+l.length),qd.a.instance.setSelection(a)),Nr.hyperlinkEditor.oja(x,c,!1));b.dispose();!f&&this.jah&&this.jah.zNl(x,c);bd.a.mark(7013)}set jx(a){super.jx=a}static get hyperlinkEditor(){return Nr.zn||(Nr.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static NOj(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===
a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Nr.zn=null;Object(m.a)(Nr,"HyperlinkAction",ao,[]);class TA{constructor(a,b){this.fh=a;this.fd=b}WDi(a,b,c){return new Nr(null,a,b,c,this.fh,this.fd)}}Object(m.a)(TA,"Factory",null,[1315]);class UA{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}Zb(a){this.Da=a;a.register(Ym,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().oa(()=>new Ym(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),
fd.a.instance,u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(QA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().oa(()=>new QA(a.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(SA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().oa(()=>
new SA(a.resolve("Box4.IAutoCorrectRules"),qd.a.instance,Nc.a.instance,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(TA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().oa(()=>new TA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").N_j();
const a=u.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").B3i()}dispose(){}static main(){z.a.instance.Dc(new UA)}}Object(m.a)(UA,"Box4AutoCorrectPackage",null,[2,3]);class VA{get name(){return"Box4.Clipboard"}init(){}dispose(){}Zb(){}static main(){z.a.instance.Dc(new VA)}}Object(m.a)(VA,"Box4ClipboardPackage",null,[2,3]);var WA=d(583),$w=d(494),To=d(328);class Or{}Or.fontSize=0;Or.bold=
!1;Or.italic=!1;Or.spacing=0;Object(m.a)(Or,"DefaultTextCharPropertyBag",null,[]);class XA{constructor(a,b,c,f,l,x,H,U){this.g3c=[$a.a.fontColor,kb.a.Mvb];this.i8c=[$a.a.Ri,$a.a.font,kb.a.autonumberBulletType,$a.a.DVa,Mc.a.BVa];this.Pak=[new $w.a(kb.a.jX,kb.a.ux),new $w.a(kb.a.qla,kb.a.aea),new $w.a(kb.a.pla,kb.a.$da)];this.Uva=a;this.nJ=b;this.lfc=c;this.ki=f;this.OWa=l;this.bXa=x;this.Qb=H;this.Fa=U}Rsb(a){return this.cUd(a,-1)}WIc(a){return this.cUd(a,1)}cUd(a,b){return tb.GraphIterator.Yca(()=>
this.bXa?fe.OutlineElementReader.Yg(a)&&!a.E7b(14)&&a.E7b(12)&&!this.BOj(a)&&this.$Cf(a,b):rb.ListReader.uk(a)&&this.$Cf(a,b))}BOj(a){return(a=this.Fa.$m(a.currentNode))?a.h4:!1}$Cf(a,b){return tb.GraphIterator.Yca(()=>{const c=a.currentNode.sa(ab.a.listLevel,Be.a.NEa)+b;if(0>c||c>=To.a.a8||!this.nJ.qQ(a,c))return!1;this.bXa||(Ta.OutlineElementNavigator.wi(a),Ta.OutlineElementNavigator.Re(a));return!0})}Rhb(a,b){this.$7g(a,b)}SMc(a,b){this.$7g(a,b)}$7g(a,b){if(this.cUd(a,b)&&(this.bXa||rb.ListReader.uk(a))){var c=
a.Bb(2);a.zc();(new tb.GraphIterator).Rc(a);const f=a.currentNode.sa(ab.a.listLevel,Be.a.NEa);(0>f||f>=To.a.a8)&&xa.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=To.a.a8)&&xa.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.nJ.qQ(a,f),x=this.nJ.qQ(a,f+b);if(l&&x){a.currentNode.setValue(ab.a.listLevel,f+b);c.setValue(ab.a.listLevel,
f+b);for(b=0;b<c.Ra.length;b++)c.Ra.ga(b).formatting&&c.Ra.ga(b).formatting.Lhe();this.gci(c,l,x);this.Zbi(c,l,x);this.dci(c,l,x);c=a.Bb(4);a.zc();c&&this.Tbi(c,l,x)}}}Zbi(a,b,c){b=c.sa($a.a.fontSize,Or.fontSize)-b.sa($a.a.fontSize,Or.fontSize);a.Sa($a.a.fontSize)&&a.setValue($a.a.fontSize,a.eb($a.a.fontSize)+b);for(c=0;c<a.Ra.length;++c){const f=a.Ra.ga(c);f||xa.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",c);f&&
f.formatting&&f.formatting.Vz&&f.formatting.Vz.Sa($a.a.fontSize)&&this.ki.Pq(f.formatting,f.formatting.Vz.eb($a.a.fontSize)+b)}this.OWa&&this.OWa.Sa($a.a.fontSize)&&(a=this.OWa.fontSize(),this.OWa.Pq(a+b))}gci(a,b,c){if(a.Sa(ab.a.$l)){var f=a.eb(ab.a.$l);let l=b.sa(ab.a.$l,Be.a.leftMargin),x=c.sa(ab.a.$l,Be.a.leftMargin);const H=this.Fa.$m(a);H&&!H.ud&&(l=b.sa(kb.a.e2b,Be.a.leftMargin),x=c.sa(kb.a.e2b,Be.a.leftMargin));f=f+x-l;0>f&&a.setValue(ab.a.eo,a.sa(ab.a.eo,Be.a.indent)+f);this.Uva.Av.Jod(a,
1,f)}this.kPc(a,b,ab.a.eo)&&this.VWc(a,c,ab.a.eo)}dci(a,b,c){for(const f of this.Pak)this.kPc(a,b,f.first,f.second)&&this.VWc(a,c,f.first,f.second)}Tbi(a,b,c){if(this.kPc(a,b,$a.a.Ri,$a.a.font)){if(0===this.lfc.Wwb(a)&&a.sa(kb.a.autonumberBulletType,8)!==b.sa(kb.a.autonumberBulletType,8))return;if(c.sa($a.a.Ri,null))this.lfc.Y_b(a),a.fo.apply(a,this.i8c),this.VWc.apply(this,[a,c].concat(this.i8c));else{const f=this.Qb.Nc(a);f.rc(11);f.Mi()}}for(const f of this.g3c)this.kPc(a,b,f)&&(a.removeProperty(f),
this.VWc(a,c,f))}kPc(a,b,...c){for(const f of c)if(a.Sa(f)||b.Sa(f))if(!a.Sa(f)||!b.Sa(f)||!WA.APropertySet.LZa(f.type,a.Lh(f),b.Lh(f)))return!1;return!0}VWc(a,b,...c){for(const f of c)b.Sa(f)&&a.we(f,b.Lh(f))}}Object(m.a)(XA,"OutlineElementIndentationEditor",null,[1466]);var Ey=d(153);class pp{constructor(a,b){this.ap=this.fd=this.Ht=null;this.Zo=b;pp.Vg=a}get eq(){return this.Zo.value}get insertionPointFormatting(){return this.Ht||(this.Ht=Db.a.instance.ub("Box4.IInsertionPointFormatting"))}get Tf(){return this.fd||
(this.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get C6(){return this.ap||(this.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}t$d(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.B_f():null;if(c&&!c.equals(ka.a.nil)){a=b.Fh;if(!a)return null;c=a.Be(c);if(!c||c&&1!==Ab.StyleReader.Eta(c))return null}else c=gc.a.xs(a),c=gc.a.pwb(c);return c}Eaa(a,b,c){if(Sb.ParagraphReader.$d(b))if(a)if(Ab.StyleReader.G0c(a))if(2!==
Ab.StyleReader.Eta(a))ia.ULS.shipAssertTag(7467991,324,!1);else{var f=Ab.StyleReader.qL(b);if(f){var l=Ab.StyleReader.wQ(a);if(!l)ia.ULS.shipAssertTag(7467993,324,!1);else if(f.$G(l)){l=null;this.Tf.gg&&b.H8();c||(l=this.eq.WQk(l),pp.paragraphEditor.Z_b(b,!0));this.suc(b,f);P.a.instance.ga(61)||(a=f.$G(Ab.StyleReader.wQ(a)));b.properties.setValue(dh.a.paragraphStyle,a.id);b.aV=a;for(c=0;c<b.Ra.length;c++)b.Ra.ga(c).formatting&&b.Ra.ga(c).formatting.Lhe();pp.k2c.I2b(a)&&(l||(l=new tb.GraphIterator,
l.set(b),l.$e(),Ta.OutlineElementNavigator.Re(l)),rb.ListReader.uk(l)||(b.fo(ab.a.$l,ab.a.wxa,ab.a.eo,ab.a.sJa,ab.a.glc,ab.a.D8g),this.PQd(l,a)))}}else ia.ULS.shipAssertTag(7467992,324,!1)}else ia.ULS.shipAssertTag(7467990,324,!1);else ia.ULS.shipAssertTag(7467989,324,!1);else ia.ULS.shipAssertTag(7467988,324,!1)}PQd(){}NJc(a,b=!1){let c;c=Hf.c(a)?Hf.d(a)?Ab.StyleReader.qL(a).$G(Ab.StyleReader.Crd):Ab.StyleReader.qL(a).$G(Ab.StyleReader.Erd):Ab.StyleReader.qL(a).$G(P.a.instance.ga(61)?Ab.StyleReader.zMa:
Ab.StyleReader.Woa);this.Eaa(c,a,b)}oWe(a,b){const c=Ab.StyleReader.qL(b);c&&c.$G(Ab.StyleReader.wQ(a))&&(this.suc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.u_a(),this.insertionPointFormatting.cga(a,b)))}suc(a,b){return(a=pp.Zl.xGb(a))?b.Odl(a):!1}static get paragraphEditor(){return pp.Vw||(pp.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){pp.Vw=a}static get k2c(){return pp.Vg||(pp.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static get Zl(){return Ey.PageNavigator.instance}}
pp.Vw=null;pp.Vg=null;Object(m.a)(pp,"StyleEditor",null,[1465]);class Zq{static Bae(){return Zq.c5j}static TTf(a){return new ka.a(a,1)}static IIf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return Ug.a.Hf(a)}}Zq.c5j=[kb.a.xxa,kb.a.cellId,kb.a.rowId,kb.a.shapeId];Object(m.a)(Zq,"TransformHelper",null,[]);class YA{constructor(a,b){this.e3c=new pp(a,b);this.lA=a;this.nJ=b.value}t$d(a){return this.e3c.t$d(a)}oWe(a,b){this.e3c.oWe(a,b)}Eaa(a,b){const c=new tb.GraphIterator;c.set(b);
c.ev();c.zc();zm.d(a,c.currentNode,[ab.a.listLevel]);zm.d(a,b,[$a.a.Jl,$a.a.eJ,ab.a.eo,ab.a.$l,kb.a.ux,kb.a.jX,kb.a.qla,kb.a.aea,kb.a.pla,kb.a.$da]);if(this.lA.I2b(a)&&!rb.ListReader.uk(c)){a=dj.a.NCa(a,a);const f=dj.a.wN(a.listType,a.listStyle);f.xA=a.xA;a.propertySet.Sa($a.a.Ri)&&f.propertySet.setValue($a.a.Ri,a.propertySet.eb($a.a.Ri));a.propertySet.Sa($a.a.font)&&f.propertySet.setValue($a.a.font,a.propertySet.eb($a.a.font));a.propertySet.Sa(kb.a.autonumberBulletType)&&f.propertySet.setValue(kb.a.autonumberBulletType,
a.propertySet.eb(kb.a.autonumberBulletType));this.nJ.QPa(c,f,!1,!1,0);a=c.Bb(4);zm.b(b,a,Zq.Bae());c.zc()}}NJc(a,b=!1){this.e3c.NJc(a,b)}suc(a,b){return this.e3c.suc(a,b)}}Object(m.a)(YA,"StyleEditor",null,[1465]);class ZA{constructor(a){this.lzg=a;this.lzg.ura(Object(F.a)(this,this.WYa,"onBeforeValidatePersistence"))}dispose(){this.lzg.soc(Object(F.a)(this,this.WYa,"onBeforeValidatePersistence"))}WYa(a,b){10!==b.node.type&&60!==b.node.type||b.node.RGh()}}Object(m.a)(ZA,"LockableGraphNodeEditBehavior",
null,[106]);class $A{constructor(){}mUi(a){const b=a.parentNode.eb(kb.a.shapeId),c=a.parentNode.eb(kb.a.xxa);let f=null,l=null;const x=Object(oa.a)(5,a.currentNode);x&&x.Cs()&&(f=a.parentNode.eb(kb.a.rowId),l=a.parentNode.eb(kb.a.cellId));this.XVe(a.currentNode,b,c,f,l)}XVe(a,b,c,f,l){a.we(kb.a.shapeId,b);a.we(kb.a.xxa,c);l&&(a.we(kb.a.rowId,f),a.we(kb.a.cellId,l))}}Object(m.a)($A,"PptCreateParagraphStrategy",null,[1321]);var OP=d(31);class aB{constructor(a){this.eu=a;this.eu.ura(Object(F.a)(this,
this.WYa,"onBeforeValidatePersistence"))}dispose(){this.eu.soc(Object(F.a)(this,this.WYa,"onBeforeValidatePersistence"))}WYa(a,b){Tc.a.Ib&&(a=Tc.a.Ib,a.Ur&&Tc.a.Ofa(Tc.a.Ib),b.revisionId&&(b=Tc.a.$9a(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?ia.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),OP.Debug.St()):a.PB(ni.a.BY,b.toString())))}}Object(m.a)(aB,"PresentationNodeEditBehavior",null,[106]);class bB{Tpc(a,
b,c){let f;({value:f}=a.Uf(b)).returnValue||(f=new Ka.a,a.$(b,f));f.add(c)}Utd(a,b,c,f){if(a.count)for(let l of a)l&&l!==ka.a.nil&&(a=b.wTc(l,ka.a.nil),a=f.ga(a))&&(b.$(l,a),this.Tpc(c,a,l))}Qtd(a,b,c){a.Hb(b)&&ka.a.WP(a.ga(b),c)&&a.remove(b)}}Object(m.a)(bB,"GraphHotColdHelper",null,[1309]);var Pr=d(206),Fy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(Fy||(Fy={}));Object(m.b)("GraphNodeModificationType",
Fy);class XF{constructor(a,b,c,f,l,x){this.zXa=a;this.Oma=b;this.Lma=c;this.oU=f;this.dR=l;this.Tma=x;this.hgc=ka.a.nil}mG(a){return!!a&&(7===a.type||68===a.type)}Yjc(a,b){this.zXa.$(a.id,b);this.Tma.eFe(b)?this.hgc=a.id:this.dR.Tpc(this.oU,b,a.id)}d5e(a){if(this.hgc&&this.hgc!==ka.a.nil){let b;this.dR.Utd((b=new Ka.a,b.add(this.hgc),b),this.zXa,this.oU,a);this.hgc=ka.a.nil}}pHb(a,b){this.dR.Qtd(this.zXa,a,b)}jua(a){return this.zXa.Hb(a.id)}WW(a){return this.jua(a)||0<this.Oma.count||0<this.Lma.count}}
Object(m.a)(XF,"PresentationHotColdHandler",null,[1344,1311]);class YF extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(m.a)(YF,"RevisionPersistArgs",Sys.EventArgs,[]);var ZF=d(901);class $F{constructor(a,b,c,f,l,x,H){this.wwa=a;this.Lma=b;this.oU=c;this.dR=f;this.Tma=l;this.jc=x;this.Fa=H;this.g9c=new Ka.a;this.NHa=new Ka.a}mG(a){return!!a&&(10===a.type||60===a.type||39===a.type)}Yjc(a,b){let c=a;const f=this.jc.kg(a);60!==a.type&&39!==a.type&&(c=this.Fa.$m(a));
f&&c&&(this.Lma.$(c.id,b),this.wwa.$(f.id,b),this.Tma.eFe(b)?(this.g9c.contains(c.id)||this.g9c.add(c.id),this.NHa.contains(f.id)||this.NHa.add(f.id)):(this.dR.Tpc(this.oU,b,c.id),this.dR.Tpc(this.oU,b,f.id)))}d5e(a){this.dR.Utd(this.g9c,this.Lma,this.oU,a);this.dR.Utd(this.NHa,this.wwa,this.oU,a);this.g9c.clear();this.NHa.clear()}pHb(a,b){this.dR.Qtd(this.Lma,a,b);this.dR.Qtd(this.wwa,a,b)}jua(a){return this.mG(a)&&this.Lma.Hb(a.id)}WW(a){return this.jua(a)}}Object(m.a)($F,"ShapeLevelHotColdHandler",
null,[1344,1311]);class aG{constructor(a,b,c,f,l){this.Oma=a;this.wwa=b;this.oU=c;this.dR=f;this.Tma=l;this.NHa=new Ka.a}mG(a){return!!a&&8===a.type}Yjc(a,b){this.Oma.$(a.id,b);this.Tma.eFe(b)&&!this.NHa.contains(a.id)?this.NHa.add(a.id):this.dR.Tpc(this.oU,b,a.id)}d5e(a){this.dR.Utd(this.NHa,this.Oma,this.oU,a);this.NHa.clear()}pHb(a,b){this.dR.Qtd(this.Oma,a,b)}jua(a){return this.Oma.Hb(a.id)}WW(a){return this.jua(a)||this.sKj(a)}sKj(a){return this.wwa.Hb(a.id)}}Object(m.a)(aG,"SlideHotColdHandler",
null,[1344,1311]);class Gy{constructor(a,b,c,f,l,x,H,U,ja,ya=null,Va=null,hb=null){this.Bl=this.oU=this.Lma=this.wwa=this.Oma=this.zXa=null;this.jc=a;this.Fa=b;this.Oc=c;this.Es=f;this.dR=l;this.eu=x;this.zze=!1;this.i0=H;this.ua=U;this.Tma=ja;this.Es.HGc(Object(F.a)(this,this.Yfd,"onRevisionProcessedOnServerHandler"));this.Es.obi(Object(F.a)(this,this.Xed,"onGraphNodePersistHandler"));this.eu.ura(Object(F.a)(this,this.Xed,"onGraphNodePersistHandler"));this.Oc.KA(Object(F.a)(this,this.DB,"onSessionEnd"));
this.Oc.Z8h(Object(F.a)(this,this.c3g,"onFailoverHandler"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.initialize(ya,Va,hb);this.FWa=new Rd.a}reset(){this.initialize();this.Es.seh(new ZF.a(null));this.IEh()}initialize(a=null,b=null,c=null){a||this.ucj();this.oU=b||new Rd.a;this.Bl=c||this.aka()}c3g(){this.reset()}Yfd(a,b){b&&(a=b.taa)&&this.AIe(a)}Xed(a,b){this.Yjc(b.node,b.revisionId)}Yjc(a,b){if(!this.zze&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.Bl)if(c.mG(a)){c.Yjc(a,
b);this.Es.zNk(new YF(b,a));break}}AIe(a){const b=ka.a.Hf(a.Id),c=this.oU.ga(b);if(c&&c.count){for(let f of c)for(const l of this.Bl)l.pHb(f,b);this.oU.remove(b);this.Es.seh(new ZF.a(a));this.IEh()}}pPi(){const a={},b=Gy.KFj(a);b(0,this.zXa);b(1,this.Oma);b(2,this.wwa);b(3,this.Lma);pa.a.isEmpty(a)||xa.a.J(21112097,811,50,pa.a.toJSON(a))}WW(a){for(const b of this.Bl)if(b.mG(a))return b.WW(a);return!1}jua(a){for(const b of this.Bl)if(b.mG(a))return b.jua(a);return!1}RHh(a){if(0<a.count)for(const b of this.Bl)b.d5e(a)}dispose(){this.Oc.paa(Object(F.a)(this,
this.DB,"onSessionEnd"));this.Oc.$Xk(Object(F.a)(this,this.c3g,"onFailoverHandler"));this.eu.soc(Object(F.a)(this,this.Xed,"onGraphNodePersistHandler"));this.Es.Mih(Object(F.a)(this,this.Yfd,"onRevisionProcessedOnServerHandler"));this.Es.c_k(Object(F.a)(this,this.Xed,"onGraphNodePersistHandler"));this.Oc.Sfa(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.FWa&&0<this.FWa.count&&xa.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.FWa.count))}DB(){this.zze=!0;this.pPi();
this.reset()}Do(){this.ua.presentation.tSe();this.reset();this.zze=!1;this.i0.dKa(new ph.a("SessionRehydrated"))}aka(){return[new $F(this.wwa,this.Lma,this.oU,this.dR,this.Tma,this.jc,this.Fa),new aG(this.Oma,this.wwa,this.oU,this.dR,this.Tma),new XF(this.zXa,this.Oma,this.Lma,this.oU,this.dR,this.Tma)]}ucj(){this.zXa=new Rd.a;this.Oma=new Rd.a;this.wwa=new Rd.a;this.Lma=new Rd.a}A2b(a,b){var c=Object(oa.a)(812,a);c.Ota+=1;({value:c}=this.FWa.Uf(b.id)).returnValue||(c=new Ka.a,this.FWa.add(b.id,c));
c.add(a)}IEh(){if(this.FWa.count&&this.ua.presentation&&this.ua.presentation.Fh){var a=this.ua.presentation.Fh;this.FWa.forEach((b,c)=>{if(!this.jua(Object(oa.a)(9,a.Be(b)))){for(let f of c)if(c=Object(oa.a)(812,f))--c.Ota,this.Gzb(c)&&(this.i0.dKa(new ph.a("SessionRehydrated")),this.Nld(f));this.FWa.remove(b)}return!0})}}Gzb(a){return a?!a.Ota&&!a.Qja:!1}Nld(a){var b=Object(oa.a)(812,a);a&&b&&(b=+new Date-+b.gja,12E4<b&&xa.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static KFj(a){return(b,
c)=>{c=Pr.b(c.values.toArray(),f=>f.toString());c.length&&(a[Fy[b]]=c)}}}Object(m.a)(Gy,"GraphHotColdManager",null,[1310,1311,106,1312]);class cB{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}Zb(a){this.K=a;this.K.register(ZA,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().oa(()=>new ZA(this.K.resolve("Box4.Graph.IGraphInstance").xSa));this.K.register(aB,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().oa(()=>new aB(this.K.resolve("Box4.Graph.IGraphInstance").yd(7)));
this.K.register(XA,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").oa(()=>new XA(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(YA,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().oa(()=>new YA(this.K.resolve("Box4.List.IListReader"),this.K.ie("Box4.List.IListEditor")));this.K.register(bB,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").oa(()=>new bB);this.K.register(Gy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().oa(()=>
new Gy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").xSa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));
this.K.register($A,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().oa(()=>new $A(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){z.a.instance.Dc(new cB)}}Object(m.a)(cB,"PPTWebEditorGraphEditorPackage",null,[2,3]);var PP=d(773),Hy=d(775),QP=d(774),co=d(453);const bG=a=>{a.element.style.top=""};var nv=d(784);class cG{constructor(a,b,c){this.G7=!1;this.iNa=0;this.eha=this.skf=null;this.wS=a;this.u1h=b;this.xn=c;this.zP=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.u2=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.yua)&&!this.xn.ANc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";B.a.eg&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.zP}get visible(){return this.G7}set_visible(a){if(this.G7!==a)return(this.G7=a)?this.KRd():this.n2b(),a}dispose(){this.visible&&this.n2b();Ca.a.rCa(this.htmlElement);this.wS=this.zP=null}nvh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.blh();this.iNa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.Wvf,x=Object(F.a)(this,this.vqk,"onAfterShowEntry");co.WacAirSpace.W_a(c,"Shared_BasicClass");var H=new QP.a(c);H.ZYb(0,1);const U=new Hy.a(c);U.$Yb(c.clientTop-30,c.clientTop);l?(co.WacAirSpace.HYa(H,null,null),co.WacAirSpace.HYa(U,null,x)):(co.WacAirSpace.animate(H,null,null),co.WacAirSpace.animate(U,null,x));for(b+=1;b<
f.length;b++)x=f[b],co.WacAirSpace.W_a(x,"Shared_BasicClass"),H=new Hy.a(x),H.$Yb(x.clientTop-c.clientHeight,x.clientTop),l?co.WacAirSpace.HYa(H,null,null):co.WacAirSpace.animate(H,null,null);a.Hkl();this.set_visible(!0)}Xbg(a){const b=a.htmlElement;if(Ca.a.FUa(b)){this.iNa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.Wvf;var f=Object(F.a)(this,this.qqk,"onAfterHideEntry");co.WacAirSpace.W_a(b,"Shared_BasicClass");var l=new PP.a(b);l.ZYb(1,0);a?co.WacAirSpace.HYa(l,null,f):co.WacAirSpace.animate(l,
null,f);f=!1;for(l=0;l<c.length;l++){if(f){const x=c[l];co.WacAirSpace.W_a(x,"Shared_BasicClass");const H=new Hy.a(x);H.$Yb(x.clientTop,-b.clientHeight);a?co.WacAirSpace.HYa(H,null,bG):co.WacAirSpace.animate(H,null,bG)}f||c[l]!==b||(f=!0)}}}vqk(a){a.element.style.top="";u.AFrameworkApplication.Aa.Oq()}qqk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.Aa.Oq()}KRd(){""===this.wS.style.top.trim()&&(this.wS.style.top=this.wS.offsetTop+
"px");this.htmlElement.style.left=this.wS.style.left;this.htmlElement.style.top=this.wS.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.skf=this.wS.style.top;this.iNa=a.height;this.Rud();u.AFrameworkApplication.Aa.mca(Object(F.a)(this,this.onResize,"onResize"));Id.a.addHandler(this.htmlElement,ta.a.Gnd,Id.a.Tsb);this.eha=Object(F.a)(this,this.lC,"contextMenuHandler");u.AFrameworkApplication.Aa.Qaa.pb(this.htmlElement,
this.eha,null);if(v.FocusManager.SM()){var b=v.FocusManager.instance();a=b.Fc(nv.a.I6a);a.parent=E.AFrame.gj;const c=new eq.DOMFocusListing(()=>this.htmlElement);c.Go(1);c.Go(2);c.Go(8);b.Tia(()=>this.htmlElement,a,c);b=b.uQ(nv.a.I6a);b.xib();b.nX=!0;b.KQa=!0;const f=u.AFrameworkApplication.Aa.Mw;a.Y5a(()=>{f.Ko(nv.a.I6a)});f.uia(nv.a.I6a);(c.Pja||u.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.pI(nv.a.I6a)}}n2b(){this.Ruh()&&(this.wS.style.top=this.skf);this.htmlElement.style.visibility=
"hidden";u.AFrameworkApplication.Aa&&(v.FocusManager.SM()&&v.FocusManager.instance().iKb(nv.a.I6a),this.eha&&(u.AFrameworkApplication.Aa.Qaa.yb(this.htmlElement,this.eha),this.eha=null));Id.a.removeHandler(this.htmlElement,ta.a.Gnd,Id.a.Tsb)}Rud(){if(this.Ruh()&&this.visible){var a=this.wS,b=this.iNa+this.u1h;const c=Ca.a.uM(a.style.top);co.WacAirSpace.W_a(a,"Shared_BasicClass");a=new Hy.a(a);a.$Yb(c,b);co.WacAirSpace.animate(a,null,null)}}Ruh(){return!this.u2&&!this.xn.ANc}onResize(){const a=this.xn.entries.length,
b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=this.xn.entries[f],c.htmlElement&&c.blh();this.iNa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.iNa&&this.Rud()}lC(){return!0}}Object(m.a)(cG,"BusinessBarDom",null,[986,106]);var Ot;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]=
"fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=
17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=
27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=
36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(Ot||(Ot={}));Object(m.b)("BusinessBarId",Ot);class oq{constructor(a,b=0,c=null,f=null){this.Fff=this.aaf=!1;this.spb=null;
this.wP=[];this.Yza=f||new cG(a,b,this);this.eFj(c)}eFj(a){if(a){this.spb={};a=a.ranking;for(let b=0;b<a.length;b++)this.spb[Ot[a[b]]]=b}}dispose(){this.Yza.dispose();sm.a.Xmd(this.wP);this.wP=null}get htmlElement(){return this.Yza.htmlElement}get visible(){return this.Yza.visible}get ANc(){return this.aaf}set ANc(a){this.aaf=a}get hle(){return this.Fff}set hle(a){this.Fff=a}get entries(){return this.wP}set entries(a){this.wP=a}Lda(a){for(let b=0;b<this.wP.length;b++)if(this.wP[b].id===a)return!0;
return!1}Zh(a,b=!1,c=null){a.businessBar=this;let f=this.taj(a.id);b&&!this.spb&&(f=0);f<oq.cgb&&(this.Yza.nvh(a,f),this.wP.length>=oq.cgb&&this.Yza.Xbg(this.wP[oq.cgb-1]),this.Yza.Rud());Array.insert(this.wP,f,a);ia.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Ot[a.id],void 0===a.BCa||null===a.BCa?"":a.BCa);a.errorCode&&u.AFrameworkApplication.vp(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.wP,a);-1!==b&&b<oq.cgb&&(this.wP.length>oq.cgb&&
this.Yza.nvh(this.wP[oq.cgb],oq.cgb),this.Yza.Xbg(a),this.Yza.Rud());Array.remove(this.wP,a);a.businessBar=null;a.dispose()}taj(a){if(!this.spb||0===a)return this.wP.length;a=this.spb[Ot[a]];if(void 0===a||null===a)return this.wP.length;for(let b=0;b<this.wP.length;b++)if(a<this.spb[Ot[this.wP[b].id]])return b;return this.wP.length}}oq.cgb=2;Object(m.a)(oq,"BusinessBar",null,[970,106,971]);class dB{constructor(a){this.nMc=null;this.P0g=a.Ga("OfficeOnlineChromeExtensionId");this.Y0g=a.Ga("ChromeClipboardAccessExtensionId");
this.cKj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.lof=!this.FQj();this.nMc=this.Hya?this.Y0g:this.P0g}wSc(){return this.nMc}lSe(){this.nMc===this.P0g&&this.Njg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.nMc=this.Y0g;this.lof=!0}get Hya(){return this.lof}FQj(){if(this.cKj&&this.Njg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&
"true"===a}return!1}get Njg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){ia.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(m.a)(dB,"ChromeExtensionHelper",null,[369]);class dG{constructor(a=null,b=null,c=null){this.Uaa=a||{};this.lDh=b||[];this.pyl=c||{}}}Object(m.a)(dG,"RibbonTrimmingProperties",
null,[]);var RP=d(457);class eG{create(a,b,c){return new RP.a(a,b,c)}}Object(m.a)(eG,"Factory",null,[984]);class fG{constructor(){u.AFrameworkApplication.Ta.ya(G.a.NAb,de.a.frame,Object(F.a)(this,this.kQk,"reactFileMenuOpenFromTellMe"))}kQk(a,b,c,f,l){if(1===c||!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],Pg.d("setFileMenuSelectedPage")&&("New"===a&&u.AFrameworkApplication.Aa?2===u.AFrameworkApplication.Aa.hb.Uk?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&u.AFrameworkApplication.Aa&&(2===u.AFrameworkApplication.Aa.hb.Uk?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}YYj(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(m.a)(fG,"ReactFileMenu",null,[1211]);class gG{createFileMenu(){const a=
new fG,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(m.a)(gG,"ReactFileMenuFactory",null,[1198]);var Sh=d(532);class hG{constructor(a,b,c,f,l,x,H){this.$Ga=!1;this.eA=null;this.cma=this.Xad=this.cXa=!1;this.ECb="Edit";this.lSg=!1;this.mc=f;this.ia=a;this.Kv=b;this.Rb=l;this.Ik=H;this.Rb.PK(Object(F.a)(this,this.Ycd,"modeSwitched"));this.Ha=c;this.wb()}wb(){this.ia.ya(K.a.nZg,de.a.frame,
Object(F.a)(this,this.tmk,"modeSwitcherHandler"));this.ia.ya(K.a.osc,de.a.frame,Object(F.a)(this,this.osc,"switchToDocumentEditMode"));this.ia.ya(K.a.qsc,de.a.frame,Object(F.a)(this,this.qsc,"switchToEmergencyViewMode"));this.ia.ya(K.a.psc,de.a.frame,Object(F.a)(this,this.psc,"switchToDocumentViewMode"));this.ia.ra(K.a.iOe,de.a.frame,Object(F.a)(this,this.bdh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ra(K.a.jOe,de.a.frame,Object(F.a)(this,this.bdh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ya(K.a.hDa,
rc.a.application,Object(F.a)(this,this.hDa,"displayCallout"));this.ia.ya(G.a.Bzh,de.a.frame,Object(F.a)(this,this.jsl,"switchFromViewModeToEditMode"))}dispose(){this.Rb.yY(Object(F.a)(this,this.Ycd,"modeSwitched"))}Ee(){}tmk(){return 32}psc(a,b,c){if(1===c||"View"===this.y9a())return 32;this.Kv.Hzh();this.Xnd("View");this.Xad=!0;return 32}osc(a,b,c){if(u.AFrameworkApplication.KQ)return 8;a=this.y9a();if(1===c){if("Edit"===a||this.$Ga||this.Xad||this.cXa&&this.mc.getState(1))return 32;ia.ULS.sendTraceTag(512500510,
306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.Kv.Hel();c=this.cXa?this.ia.La(K.a.V2b,2,20):this.ia.processAction(K.a.Z6b,2);this.$Ga=this.cXa=this.Xad=!1;this.Xnd("Edit");return c}jsl(a,b,c){if(u.AFrameworkApplication.KQ)return 8;a=this.y9a();if(1===c){if("Edit"===a||this.$Ga||this.Xad||this.cXa&&this.mc.getState(1))return 32;ia.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");
return 8}if("Edit"===a)return 32;if(2!==c)return ia.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.La(K.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}qsc(a,b,c){if(1===c)return 32;this.$Ga=!0;return this.initialize()}bdh(a,b,c,f,l){b=this.y9a();l[Sh.a.On]=a===K.a.iOe&&"Edit"===b||a===K.a.jOe&&"View"===b?!0:!1;return 32}hDa(a,b,c,f,l){if(!l||!Object(Xa.a)(Ul,l))return 8;this.eA=l;this.initialize();this.Ik&&
!this.lSg&&"View"===this.ECb&&(this.Ik.Q2e(),this.lSg=!0);return this.initialize()}initialize(){if(!Pg.c())return ia.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.ECb=this.Q2f();!this.cma&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.y9a()!==this.ECb&&ia.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",
this.ECb,this.y9a());var a=this.eA?this.eA.A9b||this.eA.F9b:!1,b=this.eA?this.eA.MUa:this.mc.getState(16);this.cXa=this.eA?this.eA.uke:this.mc.getState(524288);var c=this.eA?this.eA.G$a:this.mc.getState(1);const f=this.$Ga||a||this.cXa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.ECb;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.cXa;l.isReviewer=!1;l.isServiceDefaultedToView=this.$Ga||a;l.forceShowNotificationByExternalTrigger=this.eA&&this.eA.jZc?!this.eA.jZc:f;a&&(a={},c={},
c.title=ResourceStrings.L_BizBarTitle_Readonly,this.eA.A9b?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.eA.F9b&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return ia.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),
8;ia.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.eA,l.hasEditPermission,this.ECb,b,this.cXa,!!this.eA&&this.eA.A9b,!!this.eA&&this.eA.F9b,this.$Ga,this.rgg());b=this.L_d(a);this.cma=!0;return b}L_d(a){if(appChrome.api)return appChrome.api.dispatch(a),32;ia.ULS.sendTraceTag(512500503,
306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}rgg(){return!!u.AFrameworkApplication.Aa&&1===u.AFrameworkApplication.Aa.mode}Q2f(){return this.eA?this.$Ga||this.eA.MUa||this.eA.uke||this.eA.A9b||this.eA.F9b||this.eA.jZc?"View":this.eA.G$a?"Edit":"View":this.$Ga||this.rgg()?"View":"Edit"}y9a(){if(Pg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:ia.ULS.sendTraceTag(512500502,
306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Xnd(a){if(Pg.c()&&this.y9a()!==a){var b={};b.activeMode=a;ia.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",a);a=appChrome.actions.updateModeSwitcher(b);this.L_d(a)}}Ycd(a){this.cma&&(1===a.mode?this.Xnd("View"):2===a.mode&&this.Xnd("Edit"))}o_k(){const a={hidden:!1};a.activeMode=
this.Q2f();this.L_d(appChrome.actions.updateModeSwitcher(a))}}Object(m.a)(hG,"ModeSwitcherControlActor",null,[1179]);var iG=d(253);class eB{constructor(a,b,c,f){this.ABa=this.zbf=this.hpb=this.T$e=this.lNa=this.X9e=null;this.kqf=!1;this.xn=a;this.jZ=b;this.Ca=c;this.$a=f}kEk(){this.O_b();this.P_b();this.bsi()}O_b(){const a=Oc.App.Kb.Kd.xi;a&&(this.X9e=this.Sud(this.X9e,1,2===Oc.App.Kb.mode&&a.KYc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get yWj(){if(!Oc.App.KFh)return!1;B.a.$W&&
u.AFrameworkApplication.hk("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");return B.a.Ej}bsi(){this.yWj&&!this.hpb&&(this.hpb=this.jZ.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.hpb.id=15,this.hpb.closeable=!0,this.hpb.addButton(Box4Intl.Box4Strings.L_DownloadNow,S.AppFrame.RBl,""),Gp.a("NewBrowserSuggestionShown"),this.xn.Zh(this.hpb,!1))}P_b(){let a=null;const b=Oc.App.Kb.Kd.ica;if(b){const c=b.Ukc;iG.a.l9b(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===c||20===c?a=B.a.Ni?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=B.a.Ni?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==Oc.App.Kb.mode||iG.a.XVc(b.hYb)||Oc.App.F$b||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.zbf=this.Sud(this.zbf,5,!!a,a)}Iel(a){!!this.ABa===
a||this.kqf||(a?(this.ABa=this.jZ.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.ABa.id=13,this.ABa.closeable=!0,this.ABa.Z2=()=>{this.kqf=!0;this.ABa=null},this.xn.Zh(this.ABa)):(this.xn.removeEntry(this.ABa),this.ABa=null))}svh(a,b,c,f){a=this.jZ.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.Tsf(b,()=>{Od.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.Z2=f);this.xn.Zh(a,!0)}cll(a,b,c){this.svh(a,b,c,null)}xkl(a){a=this.jZ.create(null,
a,null);a.closeable=!0;a.id=24;a.image=1;this.xn.Zh(a,!0)}nll(a){a=this.jZ.create(null,a,null);a.closeable=!0;a.id=20;this.xn.Zh(a)}Dkl(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.lNa||(this.lNa=this.jZ.create(a,b,null),this.lNa.closeable=!0,this.lNa.id=27,this.xn.Zh(this.lNa))}fzj(){this.lNa&&(this.lNa=this.Sud(this.lNa,27,!1,""))}oYe(a){this.T$e=this.Sud(this.T$e,30,!0,a)}Sud(a,b,c,f){c?a?a.message=f:(a=this.jZ.create("",
f,null),a.id=b,a.closeable=!1,this.xn.Zh(a,!1)):a&&(this.xn.removeEntry(a),a=null);return a}}Object(m.a)(eB,"BusinessBarController",null,[1197]);var SP=d(262);class fB extends eB{constructor(a,b,c,f,l,x,H,U,ja){super(a,b,f,x);this.Soe=this.Gzg=!1;this.Hgc=[];this.eGa=0;this.DAe=null;this.HWk=ya=>{xa.a.J(509195598,801,50,"BusinessBarController.removeFilterPrivacyHandler");SP.a.Z$k(this.pek.presentationId.string,this.Kwk,this.Jwk);this.xn.removeEntry(ya)};this.Kwk=()=>{xa.a.J(509195597,801,50,"BusinessBarController.onRemoveFilterPrivacySucceeded")};
this.Jwk=ya=>{xa.a.J(509195596,801,10,"BusinessBarController.onRemoveFilterPrivacyFailed error: {0}",df.a.YK(ya.error.Im))};this.cYj=ya=>{xa.a.J(509182920,801,50,"BusinessBarController.keepFilterPrivacyHandler");this.xn.removeEntry(ya)};this.Moe=c;this.ia=f;this.P9=l;this.Ea=H;this.jA=U.mFa;this.qgc=U.powerPointDragInsertMultipleImageQuantityLimit;this.pek=ja}initialize(){this.Moe.PK(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"))}dispose(){this.Moe.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"))}tv(a,
...b){this.v2b.apply(this,[a,this.P9.RTc(a),this.P9.$$d(a),this.P9.x8d(a)].concat(b))}v2b(a,b,c,f){0===a||this.DAe||(c=this.jZ.create(c,f||"",null),c.closeable=!0,c.errorCode=df.a.Uh(a),c.Z2=Object(F.a)(this,this.aTi,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(F.a)(this,this.Hkd,"refreshActionHandler"),""),b&&(a?c.NOd(ResourceStrings.L_OpenInPowerPoint,Object(F.a)(this,this.Dgd,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,
Object(F.a)(this,this.Dgd,"openInClientActionHandler"),"")),this.DAe=c,this.rYb(c))}bL(a){var b="";let c="",f=null,l="",x=null;var H=!1;let U=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;H=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;H=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;H=!0;break;
case 2:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;H=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;H=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;H=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;H=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;H=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;H=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;H=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;H=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;
c=ResourceStrings.L_BizBarButton_Convert;f=Object(F.a)(this,this.dAi,"convertActionHandler");H=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;H=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;H=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;H=!0;break;case 14:b=u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?
u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";H=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;H=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;H=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,
this.qgc);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,this.qgc);H=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.Rhj();H=!1;a&&(this.eGa=a,a=this.ia.La(K.a.VKb,1,this.eGa),8!==a&&16!==a&&(H=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(F.a)(this,this.V_k,"repairSaveCopyHandler")));32===this.ia.processAction(K.a.Doc,1)&&(H?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,x=Object(F.a)(this,this.Hjh,"replaceOriginalFileHandler")):
(H=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(F.a)(this,this.Hjh,"replaceOriginalFileHandler")));a=H?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;H=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(F.a)(this,this.spj,"goToEditModeHandler");H=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;
a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(F.a)(this,this.fAk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;H=!1;break;case 27:U=!0;a=ResourceStrings.L_BizBarInlineFilterPrivacy;c=ResourceStrings.L_RemoveSetting;f=this.HWk;l=ResourceStrings.L_KeepSetting;x=this.cYj;break;
default:return}b=this.jZ.create(b,a,null);b.image=3;b.closeable=!0;b.Z2=H?Object(F.a)(this,this.kfh,"readOnlyInfoEntryClosedHandler"):Object(F.a)(this,this.Pdg,"infoEntryClosedHandler");U&&(b.WZc=!1);f&&b.addButton(c,f,"");x&&b.NOd(l,x);this.rYb(b);H&&Array.add(this.Hgc,b)}iDa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;
break;default:return}c=this.jZ.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.rYb(c)}yNc(a,b){let c,f=!1,l=!1,x=!1,H=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;
x=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;H=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;
f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;f=!0;b=1;break;default:return}a=this.jZ.create(a,c||"",null);a.closeable=!0;a.Z2=Object(F.a)(this,this.kfh,"readOnlyInfoEntryClosedHandler");a.image=b;f?(xa.a.J(512263711,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(F.a)(this,this.Hkd,"refreshActionHandler"),"")):l?(xa.a.J(512263710,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,
Object(F.a)(this,this.e5k,"saveAsActionHandler"),"")):H?(xa.a.J(512263709,801,15,"DownloadACopy button is show"),a.addButton(ResourceStrings.L_DownloadCopy,Object(F.a)(this,this.JOi,"downloadACopyActionHandler"),"")):x&&(xa.a.J(512263708,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(F.a)(this,this.wPi,"editAnywayActionHandler"),""));this.rYb(a);Array.add(this.Hgc,a)}Lda(a){return this.xn.Lda(a)}Rhj(){let a=0;if(this.$a.ka("IsUIEmbedMode")||this.$a.ka("DisablePrint")||
!this.$a.Ga("DownloadACopyUrl")||"true"===this.$a.Ga("ProtectInClient")||B.a.Ni)return a;let b=!0;this.$a.ka("SaveToAnotherFolderBrsIsEnabled")&&this.$a.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.$a.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.$a.ka("SaveAsToHostBrsIsEnabled")&&this.$a.ka("UserCanWriteRelative")&&this.$a.ka("SupportsEditing")||(f=!1);a=b?G.a.jjb:c?G.a.upc:a;xa.a.J(512263707,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",
b,c,f,a);return a}rYb(a){const b=this.xn.visible;this.xn.Zh(a);b||this.Ea.Cj(Qi.a.hTd,!0)}Hkd(a){xa.a.J(512263706,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(K.a.refresh,2)}Pdg(){this.xn.entries.length||this.Ea.Cj(Qi.a.hTd,!1)}aTi(){this.DAe=null;this.xn.entries.length||this.Ea.Cj(Qi.a.hTd,!1)}kfh(a){Array.remove(this.Hgc,a);this.Pdg(a);xa.a.J(512263705,801,50,"Read-only info entry is closed")}Dgd(){this.ia.La(K.a.openInClient,2,!0)}dAi(){this.ia.La(K.a.convertAndEdit,
2,!1)}V_k(){u.AFrameworkApplication.iG?this.TYe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(K.a.VKb,2,this.eGa)}Hjh(){this.ia.processAction(K.a.Doc,2)}spj(){this.ia.processAction(K.a.Z6b,2)}e5k(){xa.a.J(512263704,801,15,"SaveACopy button is clicked");u.AFrameworkApplication.iG?this.TYe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(G.a.jjb,2,!0)}JOi(){xa.a.J(512263703,801,15,"DownloadACopy button is clicked");u.AFrameworkApplication.iG?this.TYe(CommonUIStrings.l_SensitivityDownloadDocumentError):
this.ia.La(G.a.downloadACopy,2,!0)}TYe(a){xa.a.J(512263702,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new jj.StandardDialog;b.xd=0;b.Gy(df.a.uOi,kj.a.v3(ResourceStrings.l_GenericDialogTitle),kj.a.v3(a),null)}wPi(){xa.a.J(512263701,801,50,"EditAnyway button is clicked");this.ia.La(K.a.V2b,2,20)}fAk(){xa.a.J(512263700,801,50,"Learn More button is clicked");W.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}IUd(){if(this.Moe.E$a&&!this.Soe&&!this.Gzg){this.Soe=
!0;var a=this.jZ.create("",CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.Z2=()=>{this.Gzg=!0;this.Soe=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(F.a)(this,this.Srk,"onCompatWarningButtonClick"),"");this.rYb(a)}}Srk(){W.Redirect.showHelp("PPTODF")}YOf(){for(const a of this.Hgc)this.xn.removeEntry(a);Array.clear(this.Hgc)}Su(a){this.jA&&2===a.mode&&this.YOf()}}Object(m.a)(fB,"BusinessBarController",eB,[1196,1197,106]);class jG{constructor(a,
b){this.jcb=null;this.Iek=b;this.rb=document.createElement("div");this.rb.className="BusinessBarPanel";this.rb.id="BusinessBarPanel";this.vic=document.createElement("div");this.vic.id="BusinessBarPanelWorking";this.rb.insertBefore(this.vic,this.rb.firstChild);a.execute(c=>{this.jcb=c;this.Iek&&this.jcb&&(this.jcb.ANc=!0);this.vic.insertBefore(this.jcb.htmlElement,this.vic.firstChild)});this.rb.style.position=mf.a.dsc}dispose(){}layout(a,b){if(!this.jcb||!this.jcb.visible)return this.Cr(),a;this.sNi(b);
this.rb.style.height=lf.a.Pc(this.jcb.htmlElement.offsetHeight);return a}Cr(){"none"!==this.rb.style.display&&(this.rb.style.display="none")}sNi(a){this.rb.style.display.length&&(this.rb.style.display="");a&&(this.rb.style.direction=mf.a.P0a)}get xa(){return this.rb}get IKl(){return this.vic}get order(){return 2}}Object(m.a)(jG,"BusinessBarPane",null,[1183,718,106]);var ax=d(571);class Uo{}Uo.Value="value";Uo.MinValue="MinValue";Uo.MaxValue="MaxValue";Uo.Text="Text";Object(m.a)(Uo,"SliderCommandProperties",
null,[]);var Op=d(1122);class pq{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(m.a)(pq,"CommonOptionalButtonProperties",null,[]);class ov extends pq{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(m.a)(ov,"OptionalButtonProperties",pq,[]);class kG extends ov{constructor(){super();this.animateTransition=!1}}
Object(m.a)(kG,"AdditionalInkButtonProperties",ov,[]);class Iy extends pq{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(Iy,"OptionalFlyoutAnchorProperties",pq,[]);class lG extends Iy{constructor(){super();this.animateTransition=!1}}Object(m.a)(lG,"AdditionalInkFlyoutAnchorProperties",Iy,[]);class mG{constructor(){this.selected=!1;this.iconColor=
null}}Object(m.a)(mG,"InkControlState",null,[]);class nG{constructor(){this.keytip=this.JEa=this.label=null}}Object(m.a)(nG,"InkFlyoutAnchorResources",null,[]);class Fs{constructor(){this.jBb=[]}ya(a){this.jBb.push(a)}commit(){appChrome.api.dispatch(this.jBb);Array.clear(this.jBb)}}Object(m.a)(Fs,"AppChromeTransaction",null,[]);class he{}he.bB="InkPen1";he.eE="InkPen2";he.dE="InkHighlighter";he.Wta="InkRuler";he.gab="InkColorPicker1";he.Fda="InkColorPicker2";he.Vta="InkColorPicker3";he.Eka="InkColorPickerMRU1";
he.Fka="InkColorPickerMRU2";he.REa="InkColorPickerMRU3";he.UEa="InkThicknessSlider1";he.VEa="InkThicknessSlider2";he.WEa="InkThicknessSlider3";he.SEa="InkDrawWithTouch";he.Y8="InkEraser";he.Z8="InkLasso";he.TEa="InkSelect";he.iXf="label";he.gXf="iconName";he.hXf="keytip";he.xee=4;Object(m.a)(he,"InkRibbonManagerConstants",null,[]);class qq{constructor(a,b,c,f,l){this.rXa=this.tXa=this.sXa=qq.yIc;this.U8=(x,H,U,ja,ya)=>{if(1===U)return this.Ncb?8:32;H=this.dma.ga(he.Wta).selected;x!==K.a.Bnd&&this.KJc(x===
K.a.JKa);U=new Fs;if(this.tXe(this.Tke(ya)))switch(x){case K.a.ynd:case K.a.znd:case K.a.wnd:case K.a.vnd:case K.a.xnd:case K.a.ond:case K.a.pnd:case K.a.qnd:case K.a.snd:case K.a.tnd:case K.a.und:this.YJ(he.SEa,!0,!1,U,!1)}switch(x){case K.a.ynd:this.YJ(he.bB,!0,!0,U,!0);this.ia.La(K.a.bB,2,ya);this.kB=he.bB;break;case K.a.snd:this.YJ(he.bB,!0,!0,U,!0);this.cLb(he.bB,this.IWa,he.Fda,[he.Eka,he.Fka],"#000000",ya,U);this.ia.La(K.a.Eka,2,ya);this.kB=he.bB;break;case K.a.ond:this.YJ(he.bB,!0,!0,U,!0);
this.cLb(he.bB,this.IWa,he.Fda,[he.Eka,he.Fka],"#000000",ya,U);this.ia.La(K.a.gab,2,ya);this.kB=he.bB;break;case K.a.znd:this.YJ(he.eE,!0,!0,U,!0);this.ia.La(K.a.eE,2,ya);this.kB=he.eE;break;case K.a.tnd:this.YJ(he.eE,!0,!0,U,!0);this.cLb(he.eE,this.IWa,he.Fda,[he.Eka,he.Fka],"#e71224",ya,U);this.ia.La(K.a.Fka,2,ya);this.kB=he.eE;break;case K.a.pnd:this.cLb(he.eE,this.IWa,he.Fda,[he.Eka,he.Fka],"#e71224",ya,U);this.YJ(he.eE,!0,!0,U,!0);this.ia.La(K.a.Fda,2,ya);this.kB=he.eE;break;case K.a.wnd:this.YJ(he.dE,
!0,!0,U,!0);this.ia.La(K.a.dE,2,ya);this.kB=he.dE;break;case K.a.und:this.YJ(he.dE,!0,!0,U,!0);this.cLb(he.dE,this.HCb,he.Vta,[he.REa],"#fffc00",ya,U);this.ia.La(K.a.REa,2,ya);this.kB=he.dE;break;case K.a.qnd:this.YJ(he.dE,!0,!0,U,!0);this.cLb(he.dE,this.HCb,he.Vta,[he.REa],"#fffc00",ya,U);this.ia.La(K.a.Vta,2,ya);this.kB=he.dE;break;case K.a.vnd:this.YJ(he.Y8,!0,!1,U,!1);this.ia.La(K.a.Y8,2,ya);break;case K.a.Bnd:this.YJ(he.Wta,!H,!1,U,!1);this.ia.La(K.a.Wta,2,ya);break;case K.a.xnd:this.YJ(he.Z8,
!0,!1,U,!1);this.ia.La(K.a.Z8,2,ya);break;case K.a.JKa:this.YJ(he.TEa,!0,!1,U,!1),this.YJ(he.SEa,!1,!1,U,!1),this.ia.processAction(K.a.TEa,2)}U.commit();this.mak&&ax.ShyRibbon.vQa(1,2);return 32};this.ia=a;this.mak=f;this.la=l;this.dma=new Yc.a;this.Eea=new Yc.a;for(const x of qq.see){a="";switch(x){case he.bB:a="#000000";break;case he.eE:a="#E71224";break;case he.dE:a="#FFFC00"}this.dma.$(x,Object.assign(new mG,{selected:!1,iconColor:a}))}u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb&&
u.AFrameworkApplication.Aa.hb.Np&&this.wb();this.IWa=new Ka.a;this.IWa.add("#FFC114");this.IWa.add("#F6630D");this.IWa.add("#FF0066");this.IWa.add("#5B2D90");this.HCb=new Ka.a;this.HCb.add("#00F900");this.HCb.add("#00FDFF");this.HCb.add("#FF40FF");this.HCb.add("#FF8517");this.kB=he.bB;b.zGc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Ncb=!c||!c.Ic}wb(){this.ia.ra(K.a.uee,Cb.a.application,Object(F.a)(this,this.FQi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.ra(K.a.Beg,Cb.a.application,Object(F.a)(this,
this.svj,"handleRefreshInkUIValues"),4);this.ia.ra(K.a.eXc,Cb.a.application,Object(F.a)(this,this.Ksj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.ra(K.a.ynd,Cb.a.application,this.U8,4);this.ia.ra(K.a.znd,Cb.a.application,this.U8,4);this.ia.ra(K.a.wnd,Cb.a.application,this.U8,4);this.ia.ra(K.a.Bnd,Cb.a.application,this.U8,4);this.ia.ra(K.a.ond,Cb.a.application,this.U8,4);this.ia.ra(K.a.pnd,Cb.a.application,this.U8,4);this.ia.ra(K.a.qnd,Cb.a.application,this.U8,4);this.ia.ra(K.a.snd,Cb.a.application,
this.U8,4);this.ia.ra(K.a.tnd,Cb.a.application,this.U8,4);this.ia.ra(K.a.und,Cb.a.application,this.U8,4);this.ia.ra(K.a.jUe,Cb.a.application,Object(F.a)(this,this.zbe,"handleThicknessSliderChanged"),4);this.ia.ra(K.a.kUe,Cb.a.application,Object(F.a)(this,this.zbe,"handleThicknessSliderChanged"),4);this.ia.ra(K.a.lUe,Cb.a.application,Object(F.a)(this,this.zbe,"handleThicknessSliderChanged"),4);this.ia.ra(K.a.iUe,Cb.a.application,Object(F.a)(this,this.Isj,"handleInkDrawWithTouchSelected"),4);this.ia.ra(K.a.vnd,
Cb.a.application,this.U8,4);this.ia.ra(K.a.xnd,Cb.a.application,this.U8,4);this.ia.ra(K.a.JKa,Cb.a.application,this.U8,4)}Ksj(a,b,c,f,l){if(1===c)return 32;this.Ncb=l;return 32}svj(a,b,c){if(1===c)return 32;a=new Fs;this.OLb(he.UEa,this.sXa,a);this.OLb(he.VEa,this.tXa,a);this.OLb(he.WEa,this.rXa,a);a.commit();this.Eea.count||this.c0j();return 32}Isj(a,b,c,f,l){if(1===c)return this.Ncb?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.dma.ga(he.SEa).selected||a?(this.KJc(!1),this.GOf()):(this.KJc(!1),
a=new Fs,this.YJ(he.SEa,!0,!1,a,!1),this.YJ(this.kB,!0,!0,a,!0),a.commit(),this.ia.La(K.a.ree,2,{enable:!0}));return 32}zbe(a,b,c,f,l){if(1===c)return 32;b=new Fs;this.YJ(he.SEa,!0,!1,b,!1);l&&l&&(l[qq.aol]=Uo.Value);switch(a){case K.a.jUe:this.ia.La(K.a.UEa,2,l);this.sXa=this.l$a(l);this.OLb(he.UEa,this.sXa,b);this.kB=he.bB;break;case K.a.kUe:this.ia.La(K.a.VEa,2,l);this.tXa=this.l$a(l);this.OLb(he.VEa,this.tXa,b);this.kB=he.eE;break;case K.a.lUe:this.ia.La(K.a.WEa,2,l),this.rXa=this.l$a(l),this.OLb(he.WEa,
this.rXa,b),this.kB=he.dE}b.commit();return 32}isEnabled(a){return this.dma.ga(a).selected}FQi(a,b,c){if(1===c)return 32;if(!Pg.c())return xa.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.Eea.count)return 32;this.KJc(!1);this.GOf();this.dma.ga(this.kB).selected=!1;a=new Fs;this.YJ(this.kB,!0,!0,a,!0);this.ia.processAction(K.a.Aeg,2);a.commit();return 32}c0j(){for(const a of qq.see)switch(a){case he.bB:this.bbc(he.bB);break;case he.eE:this.bbc(he.eE);
break;case he.dE:this.bbc(he.dE);break;case he.Y8:this.bbc(he.Y8);break;case he.Z8:this.bbc(he.Z8)}}bbc(a){const b=appChrome.selectors.getInkButtonState(a);this.Eea.$(a,Object.assign(new nG,{label:he.iXf in b?Object(oa.a)(String,b[he.iXf]):"",JEa:he.gXf in b?Object(oa.a)(String,b[he.gXf]):"",keytip:he.hXf in b?Object(oa.a)(String,b[he.hXf]):""}))}KJc(a){const b=new Fs;for(const c of qq.see)if(c!==he.Wta)switch(this.YJ(c,!1,!1,b,!0),c){case he.bB:this.Ctb(he.bB,b,!0,a);break;case he.eE:this.Ctb(he.eE,
b,!0,a);break;case he.dE:this.Ctb(he.dE,b,!0,a);break;case he.Y8:this.Ctb(he.Y8,b,!0,a);break;case he.Z8:this.Ctb(he.Z8,b,!0,a)}b.commit()}VHh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.dma.ga(a).selected=b}YJ(a,b,c,f,l){c?b?(b&&!this.dma.ga(a).selected&&this.awi(a,f,l),this.VHh(a,b,f)):this.Ctb(a,f,l,a!==he.TEa):this.VHh(a,b,f)}Ctb(a,b,c,f){if(this.Eea.Hb(a)){var l=this.Eea.ga(a).JEa,x=this.Eea.ga(a).keytip,H=this.Eea.ga(a).label,U=this.a6d(a);a=appChrome.api.createInkButtonModel(a,U?
U:H,Object.assign(new kG,{iconSet:(new Op.a(l)).iconSet,iconColor:this.dma.ga(a).iconColor,keytip:x,animateTransition:c&&!f}));b.ya(appChrome.actions.addControls([a]))}}awi(a,b,c){if(this.Eea.Hb(a)){var f=this.a6d(a),l=this.Eea.ga(a).JEa,x=this.Eea.ga(a).keytip,H=this.Eea.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,f?f:H,Object.assign(new lG,{iconSet:(new Op.a(l)).iconSet,iconColor:this.dma.ga(a).iconColor,keytip:x,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));
b.ya(appChrome.actions.addControls([a]))}}a6d(a){if(this.la.ka("InkColorLabelEnabled")){var b=void 0;switch(a){case he.bB:case he.eE:var c=appChrome.selectors.getColorPickerState(he.Fda);break;case he.dE:c=appChrome.selectors.getColorPickerState(he.Vta)}c&&(c=this.xJf(Array.isArray(c.colorCells)?c.colorCells:null),b=this.Eea.ga(a).label,b=`${b.split(":")[0]}: ${c[this.dma.ga(a).iconColor].label}`);return b}}Ral(a,b,c){c.ya(appChrome.actions.updateIconColor(a,b));this.Sal(a,c)}Sal(a,b){let c=this.a6d(a);
c&&b.ya(appChrome.actions.setControlLabel(a,c))}Tal(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}OLb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}QFk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.xJf(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.Tal(l,this.ocj(a,c),f)}}pcj(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}xJf(a){const b={};for(const c of a)b[c.id]=c;return b}ocj(a,b){const c=
[];for(let f of b)f in a&&Array.add(c,a[f]);return c}Tke(a){return a&&a.InputMethod?a.InputMethod===he.xee:!1}tXe(a){return!a||B.a.Ni||B.a.p9b}dij(a,b){a&&a.Color&&(b=6===Object(oa.a)(String,a.Color).length?"#"+a.Color:Object(oa.a)(String,a.Color));return b}cLb(a,b,c,f,l,x,H){l=this.dij(x,l);this.dma.ga(a).iconColor=l;this.Ral(a,l,H);this.pcj(b,l);this.QFk(c,f,b,H)}GOf(){const a=new Fs;this.YJ(he.SEa,!1,!1,a,!1);this.ia.La(K.a.ree,2,{enable:!1});a.commit()}AU(a,b){b.JIb===zb.a.ZO&&b.vgb!==zb.a.ZO&&
this.ia.processAction(K.a.zeg,2);b.JIb!==zb.a.sg&&b.vgb===zb.a.sg&&this.ia.processAction(K.a.Deg,2)}l$a(a){return a&&a[Uo.Value]?a[Uo.Value]:qq.yIc}}qq.aol="SliderCommandPropertiesValueKey";qq.yIc=3;qq.see=[he.bB,he.eE,he.SEa,he.Y8,he.dE,he.Wta,he.Z8,he.TEa];Object(m.a)(qq,"InkRibbonManager",null,[1185]);class oG{constructor(a){this.tqe=a}get Hya(){return this.tqe.Hya}wSc(){return this.tqe.wSc()}lSe(){this.tqe.lSe()}}Object(m.a)(oG,"PPTChromeExtensionHelper",null,[1178,369]);var Sa=d(531);class eh{constructor(a,
b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(m.a)(eh,"MenuPopulationProperties",null,[]);class bx{constructor(){this.$wc={};this.Xwc={};this.rpf={};this.Ywc={};this.KBd={};this.LBd={};this.tCd={};this.E4h()}VDa(a){return this.Xwc[a]}M6d(a){return this.Ywc[a]}B$i(a){return this.KBd[a]}getCommandByExternalUxId(a){return this.$wc[a]}F$d(a){return this.rpf[a]}v1f(a){if(a in this.tCd)return this.tCd[a];ia.ULS.sendTraceTag(39946131,
306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}A$i(a){return this.LBd[a]}Prf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.$wc[a.externalUxCommand];if(b){delete this.$wc[b.externalUxCommand];const c=this.Xwc[b.commandId];for(let f=0;f<c.length;f++)if(c[f].externalUxCommand===b.externalUxCommand){Array.remove(c,c[f]);break}}this.$wc[a.externalUxCommand]=a;b=this.Xwc[a.commandId];if(void 0===b||null===
b)b=[],this.Xwc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.Ywc[a.legacyControlId]||(this.Ywc[a.legacyControlId]=new Ka.a),this.Ywc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.rpf[a]=b}addIconToMap(a,b){this.tCd[b]=a}Fi(a){if(a.legacyGroupId){var b=this.KBd[a.legacyGroupId];b||(b=[],this.KBd[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.LBd[a.externalUxGroupId],b||(b=[],this.LBd[a.externalUxGroupId]=b),b.push(a))}E4h(){this.addCommandToMaps(Object.assign(new Sa.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Sa.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Sa.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Sa.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Sa.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Sa.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Sa.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(Object.assign(new Sa.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Sa.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Sa.a("DownloadACopy","3555692408"),
{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Sa.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Sa.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Sa.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Sa.a("HideRibbon","336231556"));this.addCommandToMaps(new Sa.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Sa.a("InsertMoreAddInsFromFooter","1945259303"));
this.addCommandToMaps(new Sa.a("InsertAddInsFromBackstage","1945259303"));this.addCommandToMaps(new Sa.a("InsertAddinTransitionEntry","1095658066"));this.addCommandToMaps(new Sa.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Sa.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Sa.a("ManageAccess","981334692"));this.addCommandToMaps(new Sa.a("MenuClose","336231556"));this.addCommandToMaps(new Sa.a("MenuOpen","336231556"));this.addCommandToMaps(new Sa.a("MenuPopulate",
"336231556"));this.addCommandToMaps(new Sa.a("MoveToFolder","1182470434"));this.addCommandToMaps(new Sa.a("NavigateToCoauthor","4033456482"));this.addCommandToMaps(new Sa.a("New","1056925771"));this.addCommandToMaps(new Sa.a("NewBrowserSuggestionClicked","3734060499"));this.addCommandToMaps(Object.assign(new Sa.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Sa.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new eh("1285265560",
!1)}));this.addCommandToMaps(Object.assign(new Sa.a("Privacy","1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Sa.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Sa.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Sa.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));this.addCommandToMaps(Object.assign(new Sa.a("SaveToSharePoint","3050207199"),
{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Sa.a("SearchHelp","2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Sa.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Sa.a("ShareTopBar","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Sa.a("TabSwitch",
"336231556"));this.addCommandToMaps(Object.assign(new Sa.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));this.addCommandToMaps(Object.assign(new Sa.a("Training","2918242107"),{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Sa.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Sa.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));this.addCommandToMaps(Object.assign(new Sa.a("Zoom","1738002952"),
{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Sa.a("ToggleRibbonUXDialog","1342108365"),{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));this.addCommandToMaps(new Sa.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Sa.a("RibbonModeToggledToMLR","536345575"));this.addCommandToMaps(new Sa.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Sa.a("Workflow","2988588587"));this.addCommandToMaps(new Sa.a("ToggleVNextLook",
"1650341290"));this.addCommandToMaps(Object.assign(new Sa.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(Object.assign(new Sa.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Sa.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Sa.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Sa.a("GetHelpWithDescriptionFromTellMe1",
"2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Sa.a("GetHelpWithDescriptionFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(new Sa.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Sa.a("AnswerForSearchSingleLine","1914896509"));this.addCommandToMaps(new Sa.a("ReuseFileQuickActionForSearch","1914896509"));this.addCommandToMaps(new Sa.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Sa.a("PeopleSuggestion2",
"2133437453"));this.addCommandToMaps(new Sa.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Sa.a("QuickActionOnFile","548581900"));this.addCommandToMaps(new Sa.a("GenerateSlidesFromTellMe","2862675062"));this.addCommandToMaps(new Sa.a("FileSuggestion1","2260671807"));this.addCommandToMaps(new Sa.a("FileSuggestion2","2260671810"));this.addCommandToMaps(new Sa.a("FileSuggestion3","2260671809"));this.addCommandToMaps(new Sa.a("FileSuggestion4","2260671804"));this.addCommandToMaps(new Sa.a("FileSuggestion5",
"2260671803"));this.addCommandToMaps(new Sa.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Sa.a("NotesSuggestion2","1914896509"));this.addCommandToMaps(new Sa.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Sa.a("OnenoteNotesSuggestion1","4083547050"));this.addCommandToMaps(new Sa.a("OnenoteNotesSuggestion2","4083547053"));this.addCommandToMaps(new Sa.a("OnenoteNotesSuggestion3","4083547052"));this.addCommandToMaps(new Sa.a("TellMeFeedback","2230755196"));this.addCommandToMaps(new Sa.a("TemplateForSearch",
"57037313"));this.addCommandToMaps(new Sa.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Sa.a("AddinSuggestion2","981735384"));this.addCommandToMaps(new Sa.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Sa.a("LaunchAddinDialogFromTellMe","1421877154"));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.EMb?(this.addCommandToMaps(new Sa.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new Sa.a("FindParameterized","1914896509")),this.addCommandToMaps(new Sa.a("FindInDocumentSuggestion1",
"1914896509")),this.addCommandToMaps(new Sa.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new Sa.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Sa.a("FindWithMatchesParameterized","1540292897")),this.addCommandToMaps(new Sa.a("FindParameterized","1540292897")),this.addCommandToMaps(new Sa.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new Sa.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new Sa.a("FindInDocumentSuggestion3",
"1540292897")));this.addCommandToMaps(new Sa.a("ImageForSearch","1914896509"));this.addCommandToMaps(new Sa.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Sa.a("SmartLookupFromTellMe","1914896509"));this.addCommandToMaps(new Sa.a("SmartLookupFromTellMeQueryTermAtTop","1914896509"));this.addCommandToMaps(new Sa.a("SmartLookupFromTellMeZeroTerm","3359903192"));this.addCommandToMaps(new Sa.a("ActionAIFromTellMe","1914896509"));!u.AFrameworkApplication.$Ea||u.AFrameworkApplication.Tya||
u.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Sa.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Sa.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(new Sa.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new Sa.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Sa.a("SynonymsParameterized",
"2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Sa.a("TellMeLogMenuClose","4266170064"));this.addCommandToMaps(new Sa.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Sa.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Sa.a("TellMeSearchResultChange","2652476189"));this.addCommandToMaps(new Sa.a("TellMeSuggestion_1","1404166600"));this.addCommandToMaps(new Sa.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Sa.a("TellMeSuggestion_3",
"1404166600"));this.addCommandToMaps(new Sa.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Sa.a("TellMeSuggestion_5","1404166600"));this.addCommandToMaps(new Sa.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Sa.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));this.addCommandToMaps(Object.assign(new Sa.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Sa.a("FileAboutPage",
"336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Sa.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Sa.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Sa.a("FileGetAddinsPage","336231556"),{legacyControlId:"faGetAddinsFromBackstage"}));this.addCommandToMaps(Object.assign(new Sa.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Sa.a("FileNewPage",
"2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Sa.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Sa.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Sa.a("FileSaveAsPage","336231556"),{legacyControlId:"faSaveAs"}));this.addCommandToMaps(Object.assign(new Sa.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Sa.a("FileTransformPage",
"336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Sa.a("NewDocument","1056925771"));this.addCommandToMaps(new Sa.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Sa.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Sa.a("ReplyWithChanges","1197060601"),{legacyControlId:"jbtnShareRWC"}));this.addCommandToMaps(Object.assign(new Sa.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Sa.a("ThirdPartyNotices",
"2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Sa.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Sa.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Sa.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Sa.a("PreviousVersions",
"466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Sa.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Sa.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Sa.a("HostConversation","710925581"),{legacyControlId:"HostConversation"}));this.addCommandToMaps(Object.assign(new Sa.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));
this.addCommandToMaps(Object.assign(new Sa.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Sa.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Sa.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Sa.a("Sensitivity","941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new eh("1145315516",
!0)}));this.addCommandToMaps(Object.assign(new Sa.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel")&&this.addCommandToMaps(Object.assign(new Sa.a("OpenDocumentShortLabelPane","390001269"),{queryCommandId:"888027492"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertAddInFlyout","2749373765"),{populationProps:new eh("1230970894",!1)}));this.addCommandToMaps(Object.assign(new Sa.a("ReloadAddInPicker",
"2502873265"),{populationProps:new eh("1230970894",!1)}));this.addCommandToMaps(new Sa.a("AddInListClicked","2924253939"));this.addCommandToMaps(new Sa.a("PopularAddInsListRefresh","2796553787"));this.addCommandToMaps(new Sa.a("FreemiumUpsellEligible","1274543852"));this.addCommandToMaps(new Sa.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Sa.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));this.addCommandToMaps(new Sa.a("HandleDiscoverPremiumButtonClick","2280081216"));
this.addCommandToMaps(new Sa.a("RequestFontInfo","3169500754"));this.addCommandToMaps(new Sa.a("PinOrUnpinFont","1500655301"));this.addCommandToMaps(new Sa.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Sa.a("ShowAccessibilitySettingsDialog","2236763780"));this.addCommandToMaps(Object.assign(new Sa.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Sa.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",
legacyControlId:"ZoomSlider"}));this.addCommandToMaps(new Sa.a("ZoomToPercentageCompleted","3139946409"));this.addCommandToMaps(Object.assign(new Sa.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new eh("860679239",!1)}));let a;this.addCommandToMaps((a=new Sa.a("InsertLinkFlyout","1052791248"),a.queryCommandId="1052791248",a.populationProps=new eh("276140882",!1),a))}}Object(m.a)(bx,"ReactCommandDefinitionMapping",null,[1529]);class sg{constructor(a){this.externalUxCommandIds=
this.commandId=this.externalUxGroupId=this.legacyGroupId=null;this.legacyGroupId=a}}Object(m.a)(sg,"GroupMetadata",null,[]);class gB extends bx{constructor(a){super();this.C5j="AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.z5j=26;this.y5j="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.B5j=31;this.A5j="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.aik=23;this.$hk="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.Jck="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.Ick="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.C8j=["FormatBackgroundStandardColorsFromCanvas","FormatBackgroundThemeColorsFromCanvas","FormatBackgroundThemeColorsMCUFromCanvas"];this.YTg="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.la=a;this.hOd();this.Z4h();this.I4h();this.H4h();this.L4h();this.O4h();this.Q4h();this.Y4h();this.R4h();this.N4h();this.K4h();this.V4h();this.S4h();this.T4h();this.X4h();this.UOd();this.N5h();this.W4h();this.V5h();this.F4h();this.M4h();this.J4h();this.G4h();this.P4h();this.U4h()}V5h(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}hOd(){this.addCommandToMaps(new Sa.a("AddSection",K.a.d6a.toString()));this.addCommandToMaps(new Sa.a("AlternativeText",
K.a.xrb.toString()));this.addCommandToMaps(new Sa.a("AlignAnchor",K.a.Lvf.toString()));this.addCommandToMaps(Object.assign(new Sa.a("AlwaysUseSubtitles",K.a.ZLa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:K.a.XZa.toString()}));this.addCommandToMaps(new Sa.a("ArrangeAnchor",K.a.Srb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("AudioSettings",K.a.uqd.toString()),{queryCommandId:K.a.yJb.toString()}));this.addCommandToMaps(new Sa.a("LivePollTaskPane",K.a.wqd.toString()));
this.addCommandToMaps(new Sa.a("ArrangeShapeAnchor",K.a.Srb.toString()));this.addCommandToMaps(new Sa.a("BeginEditShapeText",K.a.fsb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("Bold",K.a.jIb.toString()),{queryCommandId:K.a.jJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("BottomOverlaid",K.a.sOb.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:K.a.gib.toString()}));this.addCommandToMaps(new Sa.a("BringToFrontFlyout",
K.a.Tzf.toString()));this.addCommandToMaps(new Sa.a("BringForward",K.a.bringForward.toString()));this.addCommandToMaps(new Sa.a("BringToFront",K.a.bringToFront.toString()));this.addCommandToMaps(Object.assign(new Sa.a("BulletLibrary",K.a.Ona.toString()),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:K.a.kJb.toString(),populationProps:new eh(K.a.emc.toString(),!1)}));this.addCommandToMaps(Object.assign(new Sa.a("CatchUpWithChanges",G.a.gCh.toString()),{legacyControlId:"CatchUpWithChanges",
queryCommandId:G.a.Gdh.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeCaseCapitalizeEachWord",D.a.T6a.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeCaseLower",D.a.btb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeCaseMenuEnabled",K.a.TDf.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeCaseSentence",
D.a.z_b.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeCaseToggle",D.a.A_b.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeCaseUpper",D.a.ctb.toString()),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Sa.a("ChangeLayout",K.a.Yia.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ChangeGraphicContextMenu",
K.a.tUd.toString()),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeGraphicFlyout",K.a.tUd.toString()),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePicture",K.a.oJc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenu",K.a.yUd.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));
this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenuBing",K.a.D_b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenuM365",K.a.etb.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenuIcons",K.a.U6a.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));
this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenuDevice",K.a.oJc.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenuOneDrive",K.a.E_b.toString()),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",queryCommandId:K.a.Vmc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureContextMenuMobileDevice",K.a.G_b.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));
this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyout",K.a.yUd.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyoutBing",K.a.D_b.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyoutM365",K.a.etb.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));
this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyoutIcons",K.a.U6a.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyoutDevice",K.a.oJc.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyoutOneDrive",K.a.E_b.toString()),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",
queryCommandId:K.a.Vmc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ChangePictureFlyoutMobileDevice",K.a.G_b.toString()),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Sa.a("ChangeSmartArtColorAnchor",K.a.XDf.toString()),{populationProps:new eh(K.a.cah.toString(),!1)}));this.addCommandToMaps(new Sa.a("CheckAccessibility",K.a.jLe.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ClearFormatting",K.a.clearFormatting.toString()),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));
this.addCommandToMaps(new Sa.a("ClearTableFormatting",D.a.d7a.toString()));this.addCommandToMaps(Object.assign(new Sa.a("CommentsPane",K.a.j6.toString()),{queryCommandId:K.a.zJb.toString()}));this.addCommandToMaps(new Sa.a("CopyHyperlink",D.a.$Kc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ContextMenu",D.a.Uvf.toString()),{populationProps:new eh(D.a.Yhd.toString(),!1)}));this.addCommandToMaps(Object.assign(new Sa.a("SelectionPane",K.a.k6.toString()),{queryCommandId:K.a.vJb.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("RenderFooterPane",K.a.RY.toString()),{queryCommandId:K.a.Tmc.toString()}));this.addCommandToMaps(new Sa.a("InsertSlideNumber",K.a.lUa.toString()));this.addCommandToMaps(Object.assign(new Sa.a("RenderSelectionPane",K.a.k6.toString()),{queryCommandId:K.a.vJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("CommentsShowMarkUp",K.a.NMb.toString()),{queryCommandId:K.a.Mjd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("CommentsShowAdvancedMarkUp",
K.a.nrc.toString()),{queryCommandId:K.a.bOe.toString()}));this.addCommandToMaps(new Sa.a("Copy",K.a.kIb.toString()));this.addCommandToMaps(new Sa.a("CopyInVersionHistory",K.a.bJh.toString()));this.addCommandToMaps(new Sa.a("ClickVersionHistoryRestore",K.a.c0b.toString()));this.addCommandToMaps(new Sa.a("ClickVersionHistorySaveACopy",K.a.oVd.toString()));this.addCommandToMaps(new Sa.a("ClickVersionHistoryDownloadVersion",K.a.nVd.toString()));this.addCommandToMaps(new Sa.a("Cut",K.a.lIb.toString()));
this.addCommandToMaps(new Sa.a("Delete",K.a.deleteObject.toString()));this.addCommandToMaps(new Sa.a("DeleteAllCommentsInPresentation",K.a.vub.toString()));this.addCommandToMaps(new Sa.a("DeleteAllCommentsInSlide",K.a.nRa.toString()));this.addCommandToMaps(new Sa.a("DeleteAllResolvedComments",K.a.wub.toString()));this.addCommandToMaps(Object.assign(new Sa.a("DeleteComment",K.a.deleteComment.toString()),{queryCommandId:K.a.FLk.toString()}));this.addCommandToMaps(new Sa.a("DeleteRepeatedWord",D.a.bDa.toString()));
this.addCommandToMaps(new Sa.a("DeleteSlide",K.a.xI.toString()));this.addCommandToMaps(Object.assign(new Sa.a("DesignerHome",K.a.prc.toString()),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:K.a.tnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("DesignerNew",K.a.xqd.toString()),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:K.a.tnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("Dictation",D.a.oOb.toString()),{legacyControlId:"btnStartDictation",
queryCommandId:D.a.Zid.toString(),populationProps:new eh(D.a.Plc.toString(),!0)}));this.addCommandToMaps(Object.assign(new Sa.a("DocChat",G.a.hCh.toString()),{legacyControlId:"DocChat",queryCommandId:G.a.adh.toString()}));this.addCommandToMaps(new Sa.a("DoNotCheckThisCritiqueType",D.a.Kub.toString()));this.addCommandToMaps(new Sa.a("Duplicate",K.a.B0d.toString()));this.addCommandToMaps(new Sa.a("DuplicateSlide",K.a.jQ.toString()));this.addCommandToMaps(new Sa.a("EditHyperlink",K.a.insertHyperlink.toString()));
this.addCommandToMaps(Object.assign(new Sa.a("EditInApp",K.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Sa.a("EditInAppWithIcon",K.a.openInClient.toString()),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Sa.a("EditorPane",K.a.mLe.toString()),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:K.a.UNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("EditorPaneSplitButton",K.a.mLe.toString()),
{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:K.a.VNe.toString()}));this.la.cOf&&this.addCommandToMaps(Object.assign(new Sa.a("DexLitePane",K.a.vqd.toString()),{queryCommandId:K.a.ajd.toString()}));this.addCommandToMaps(new Sa.a("Find",K.a.find.toString()));this.addCommandToMaps(new Sa.a("FitToWindow",K.a.hvc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("FixIt",K.a.fixIt.toString()),{legacyControlId:"FixIt",queryCommandId:K.a.vNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("FontColor",
K.a.Exa.toString()),{populationProps:new eh(K.a.rIb.toString(),!1)}));this.addCommandToMaps(Object.assign(new Sa.a("FontPicker",D.a.font.toString()),{legacyControlId:"fontPicker",queryCommandId:D.a.cjd.toString(),populationProps:new eh(D.a.Qlc.toString(),!0)}));this.la.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Sa.a("FontName",K.a.xZa.toString()),{queryCommandId:K.a.Xhb.toString(),populationProps:new eh(K.a.Chb.toString(),!1),commandPreviewId:K.a.tIb.toString(),commandRevertId:K.a.wIb.toString()})),
this.addCommandToMaps(Object.assign(new Sa.a("FontSize",K.a.yZa.toString()),{queryCommandId:K.a.Yhb.toString(),commandPreviewId:K.a.uIb.toString(),commandRevertId:K.a.xIb.toString()}))):(this.addCommandToMaps(Object.assign(new Sa.a("FontName",K.a.xZa.toString()),{queryCommandId:K.a.Xhb.toString(),populationProps:new eh(K.a.Chb.toString(),!1)})),this.addCommandToMaps(Object.assign(new Sa.a("FontSize",K.a.yZa.toString()),{queryCommandId:K.a.Yhb.toString()})));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundApplyToAll",
K.a.DQc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundPicture",K.a.D4d.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundSolidFill",K.a.ata.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new eh(K.a.WKe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundReset",
K.a.EQc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundStandardColors",K.a.ata.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundThemeColors",K.a.ata.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundThemeColorsMCU",
K.a.ata.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(new Sa.a("FormatBackgroundRecentColors",K.a.nid.toString()));this.addCommandToMaps(Object.assign(new Sa.a("FormatPainter",K.a.qSa.toString()),{queryCommandId:K.a.qjd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("HideProofingErrors",K.a.hcg.toString()),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:K.a.ejd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("GiveFeedback",
G.a.ZKb.toString()),{legacyControlId:"btnFeedback"}));this.addCommandToMaps(Object.assign(new Sa.a("GrammarOptions",D.a.AHb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Sa.a("ProofingOptions",D.a.AHb.toString()),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Sa.a("Grow",K.a.Ahb.toString()),{legacyControlId:"PptRibbon.Home.Font.Grow"}));this.addCommandToMaps(Object.assign(new Sa.a("HideSlide",
K.a.Z7b.toString()),{queryCommandId:K.a.Ojd.toString()}));this.la.Ace&&this.addCommandToMaps(new Sa.a("UnhideSlide",K.a.X3e.toString()));this.addCommandToMaps(Object.assign(new Sa.a("Highlight",K.a.oIb.toString()),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));this.addCommandToMaps(new Sa.a("HighlighterColor",D.a.v1.toString()));this.addCommandToMaps(new Sa.a("IgnoreSpellingError",D.a.yka.toString()));this.addCommandToMaps(new Sa.a("Indent",K.a.nIb.toString()));this.addCommandToMaps(new Sa.a("InsertAddIns",
K.a.Byb.toString()));this.addCommandToMaps(new Sa.a("InsertAddInsFromBackstage",K.a.Byb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("InsertAddinTransitionEntry",G.a.Neg.toString()),{legacyControlId:"PptRibbon.InsertTab.InsertAddinTransitionEntry"}));this.addCommandToMaps(new Sa.a("InsertMoreAddInsFromFooter",K.a.Byb.toString()));this.addCommandToMaps(new Sa.a("InsertComment",K.a.iUa.toString()));this.addCommandToMaps(Object.assign(new Sa.a("InsertIcons",K.a.mXc.toString()),{legacyControlId:"InsertIconDialog"}));
this.addCommandToMaps(new Sa.a("InsertLink",K.a.insertHyperlink.toString()));this.addCommandToMaps(new Sa.a("InsertSocialMediaVideo",K.a.efg.toString()));this.addCommandToMaps(new Sa.a("InsertPicturesFlyoutDalle",K.a.zee.toString()));this.addCommandToMaps(new Sa.a("InsertPicturesDalle",K.a.Aee.toString()));this.addCommandToMaps(new Sa.a("InsertLiveFeed",K.a.Weg.toString()));this.addCommandToMaps(Object.assign(new Sa.a("InsertOnlineVideo",K.a.Zta.toString()),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));
this.la.oXc&&this.addCommandToMaps(new Sa.a("InsertVideoFromDevice",K.a.RMb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("InsertPicturesFlyout",K.a.afg.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertPicturesFlyoutBing",K.a.insertOnlinePicture.toString()),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));var a;this.addCommandToMaps((a=new Sa.a("InsertPicturesFlyoutM365",K.a.R8b.toString()),
a.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",a));let b;this.addCommandToMaps((b=new Sa.a("InsertPicturesM365",K.a.sXc.toString()),b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Sa.a("InsertPicturesFlyoutDevice",K.a.insertPicture.toString()),c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",c));let f;this.addCommandToMaps((f=new Sa.a("InsertPicturesFlyoutOneDrive",K.a.Eyb.toString()),f.legacyControlId=
"PptRibbon.InsertTab.Images.FlyPicture.FromHost",f.queryCommandId=K.a.Vmc.toString(),f));let l;this.addCommandToMaps((l=new Sa.a("InsertPicturesFlyoutMobileDevice",K.a.xXc.toString()),l.legacyControlId="InsertPictureFromMobileDevice",l));this.addCommandToMaps(new Sa.a("InsertSlides",K.a.mna.toString()));let x;this.addCommandToMaps((x=new Sa.a("NewSlideSplit",K.a.gIb.toString()),x.populationProps=new eh(K.a.gIb.toString(),!1),x));let H;this.addCommandToMaps((H=new Sa.a("InsertSlideSplit",K.a.gIb.toString()),
H.populationProps=new eh(K.a.gIb.toString(),!1),H));this.addCommandToMaps(new Sa.a("NewDefaultSlide",K.a.z5.toString()));let U;this.addCommandToMaps((U=new Sa.a("ChangeLayoutFlyout",K.a.TKe.toString()),U.populationProps=new eh(K.a.TKe.toString(),!1),U));this.addCommandToMaps(new Sa.a("InsertTextBox",K.a.XEa.toString()));this.addCommandToMaps(new Sa.a("InsertAudio",K.a.Lvh.toString()));let ja;this.addCommandToMaps((ja=new Sa.a("InsertFooterFlyout",K.a.iab.toString()),ja.legacyControlId="PptRibbon.InsertTab.FooterFlyout",
ja));let ya;this.addCommandToMaps((ya=new Sa.a("InsertSymbol",D.a.Urd.toString()),ya.populationProps=new eh(D.a.whb.toString(),!0),ya));this.addCommandToMaps(new Sa.a("InsertTable",D.a.insertTable.toString()));this.addCommandToMaps(new Sa.a("InvokeFilesSerplet",G.a.Nyb.toString()));let Va;this.addCommandToMaps((Va=new Sa.a("Italic",K.a.pIb.toString()),Va.queryCommandId=K.a.nJb.toString(),Va));this.addCommandToMaps(new Sa.a("LeftToRight",K.a.Ylc.toString()));let hb;this.addCommandToMaps((hb=new Sa.a("LineSpacing",
K.a.Bhb.toString()),hb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",hb.populationProps=new eh(K.a.sIb.toString(),!1),hb));let yb;this.addCommandToMaps((yb=new Sa.a("LineSpacingButton1_00",K.a.Gxa.toString()),yb.queryCommandId=K.a.Oxa.toString(),yb.menuItemId="1.00",yb));let Zb;this.addCommandToMaps((Zb=new Sa.a("LineSpacingButton1_50",K.a.Gxa.toString()),Zb.queryCommandId=K.a.Oxa.toString(),Zb.menuItemId="1.50",Zb));let fc;this.addCommandToMaps((fc=new Sa.a("LineSpacingButton2_00",K.a.Gxa.toString()),
fc.queryCommandId=K.a.Oxa.toString(),fc.menuItemId="2.00",fc));let Kc;this.addCommandToMaps((Kc=new Sa.a("LineSpacingButton2_50",K.a.Gxa.toString()),Kc.queryCommandId=K.a.Oxa.toString(),Kc.menuItemId="2.50",Kc));let Lc;this.addCommandToMaps((Lc=new Sa.a("LineSpacingButton3_00",K.a.Gxa.toString()),Lc.queryCommandId=K.a.Oxa.toString(),Lc.menuItemId="3.00",Lc));this.addCommandToMaps(new Sa.a("LineSpacingOptionsForParagraphDialog",K.a.OAb.toString()));this.addCommandToMaps(new Sa.a("MarkActivitiesAsRead",
K.a.DDe.toString()));let Gc;this.addCommandToMaps((Gc=new Sa.a("ModeSwitcherEditing",K.a.osc.toString()),Gc.queryCommandId=K.a.iOe.toString(),Gc.legacyControlId="ModeSwitcherModeEditing",Gc));let ae;this.addCommandToMaps((ae=new Sa.a("ModeSwitcherViewing",K.a.psc.toString()),ae.queryCommandId=K.a.jOe.toString(),ae.legacyControlId="ModeSwitcherModeViewing",ae));this.addCommandToMaps(new Sa.a("ModeSwitcher",K.a.nZg.toString()));this.addCommandToMaps(new Sa.a("MoreSymbols",D.a.pXc.toString()));let we;
this.addCommandToMaps((we=new Sa.a("MoreVariantsAnchor",K.a.oCa.toString()),we.queryCommandId=K.a.Fnc.toString(),we.populationProps=new eh(K.a.bid.toString(),!1),we.previewControlIds=["Variant1","Variant2","Variant3","Variant4"],we));this.addCommandToMaps(new Sa.a("MoveSectionDown",K.a.OEe.toString()));this.addCommandToMaps(new Sa.a("MoveSectionUp",K.a.PEe.toString()));let $d;this.addCommandToMaps(($d=new Sa.a("NewComment",K.a.iUa.toString()),$d.queryCommandId=K.a.WLk.toString(),$d));this.addCommandToMaps(new Sa.a("NewSlide",
K.a.mna.toString()));this.addCommandToMaps(new Sa.a("NewSlideWithoutDialog",K.a.z5.toString()));let Te;this.addCommandToMaps((Te=new Sa.a("NextComment",K.a.rFe.toString()),Te.queryCommandId=K.a.aMk.toString(),Te));this.addCommandToMaps(new Sa.a("NoHighlight",D.a.aja.toString()));let Ze;this.addCommandToMaps((Ze=new Sa.a("Notes",K.a.lLa.toString()),Ze.queryCommandId=K.a.kjd.toString(),Ze));let Vf;this.addCommandToMaps((Vf=new Sa.a("NumberingLibrary",K.a.LJa.toString()),Vf.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",
Vf.queryCommandId=K.a.oJb.toString(),Vf.populationProps=new eh(K.a.fmc.toString(),!1),Vf));this.addCommandToMaps(new Sa.a("OpenHyperlink",D.a.oJa.toString()));this.addCommandToMaps(new Sa.a("OpenPowerPointLanguageDialog",K.a.Egd.toString()));let gg;this.addCommandToMaps((gg=new Sa.a("OpenSetSlideSizeDialog",K.a.jJe.toString()),gg.queryCommandId=K.a.fOe.toString(),gg));this.addCommandToMaps(new Sa.a("OpenVersionHistory",K.a.O7g.toString()));this.addCommandToMaps(new Sa.a("Outdent",K.a.vIb.toString()));
this.addCommandToMaps(new Sa.a("ParagraphOptions",K.a.OAb.toString()));this.addCommandToMaps(new Sa.a("Paste",K.a.MJa.toString()));this.addCommandToMaps(new Sa.a("PasteGalleryIcon",K.a.MJa.toString()));this.addCommandToMaps(new Sa.a("PasteKeepingDestinationTheme",K.a.wJa.toString()));this.addCommandToMaps(new Sa.a("PasteKeepingSourceFormatting",K.a.xJa.toString()));let Qg;this.addCommandToMaps((Qg=new Sa.a("PasteTextOnlyGalleryIcon",K.a.qIb.toString()),Qg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",
Qg));this.addCommandToMaps(new Sa.a("PasteAsImage",K.a.rZa.toString()));let Rg;this.addCommandToMaps((Rg=new Sa.a("PasteSlideKeepDestinationFromClipService",K.a.vlc.toString()),Rg.queryCommandId=K.a.SNe.toString(),Rg));let Wf;this.addCommandToMaps((Wf=new Sa.a("PasteSlideKeepSourceFromClipService",K.a.WHb.toString()),Wf.queryCommandId=K.a.SNe.toString(),Wf));let rg;this.addCommandToMaps((rg=new Sa.a("PasteTextOnly",K.a.qIb.toString()),rg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",rg));let Sg;
this.addCommandToMaps((Sg=new Sa.a("PasteAsPlainText",K.a.J9g.toString()),Sg.queryCommandId=K.a.IOe.toString(),Sg));let Gh;this.addCommandToMaps((Gh=new Sa.a("PasteTextKeepingSourceFormatting",K.a.I9g.toString()),Gh.queryCommandId=K.a.IOe.toString(),Gh));this.addCommandToMaps(new Sa.a("PlayFromBeginning",K.a.nNb.toString()));this.addCommandToMaps(new Sa.a("PlayFromBeginningTopBar",K.a.Elc.toString()));this.addCommandToMaps(new Sa.a("PlayFromCurrentSlide",K.a.Vya.toString()));let Zi;this.addCommandToMaps((Zi=
new Sa.a("PresentLive",K.a.CZa.toString()),Zi.legacyControlId="PresentLive",Zi));let Ei;this.addCommandToMaps((Ei=new Sa.a("PresentLiveTopBar",K.a.ymc.toString()),Ei.legacyControlId="PresentLiveTopBar",Ei));let fj;this.addCommandToMaps((fj=new Sa.a("PresentLiveSetAccessControlAnyone",K.a.DZa.toString()),fj.legacyControlId="PresentLiveSetAccessControlAnyone",fj.queryCommandId=K.a.rJb.toString(),fj));let Fi;this.addCommandToMaps((Fi=new Sa.a("PresentLiveSetAccessControlOrganization",K.a.xmc.toString()),
Fi.legacyControlId="PresentLiveSetAccessControlOrganization",Fi.queryCommandId=K.a.sJb.toString(),Fi));let Gi;this.addCommandToMaps((Gi=new Sa.a("PresentLiveConsumer",K.a.CZa.toString()),Gi.legacyControlId="PresentLiveConsumer",Gi));let Mk;this.addCommandToMaps((Mk=new Sa.a("PresentLiveEnterprise",K.a.CZa.toString()),Mk.legacyControlId="PresentLiveEnterprise",Mk));let Cj;this.addCommandToMaps((Cj=new Sa.a("PresentToTeams",K.a.Mhb.toString()),Cj.legacyControlId="PresentToTeams",Cj));let Bk;this.addCommandToMaps((Bk=
new Sa.a("PresentToTeamsTopBar",K.a.YLe.toString()),Bk.legacyControlId="PresentToTeamsTopBar",Bk));let Il;this.addCommandToMaps((Il=new Sa.a("PreviousComment",K.a.dMe.toString()),Il.queryCommandId=K.a.lMk.toString(),Il));this.addCommandToMaps(new Sa.a("ReadingView",K.a.zkd.toString()));let lk;this.addCommandToMaps((lk=new Sa.a("PictureCrop",K.a.OYd.toString()),lk.queryCommandId=K.a.TNe.toString(),lk));this.addCommandToMaps(new Sa.a("PictureCropAnchor",K.a.MYd.toString()));let Jl;this.addCommandToMaps((Jl=
new Sa.a("PictureCropMoreOptions",K.a.rrc.toString()),Jl.queryCommandId=K.a.AJb.toString(),Jl));this.addCommandToMaps(Object.assign(new Sa.a("FormatPicture",K.a.rrc.toString()),{queryCommandId:K.a.AJb.toString()}));this.addCommandToMaps(new Sa.a("Redo",K.a.gmc.toString()));let Vj;this.addCommandToMaps((Vj=new Sa.a("RehearsalFeedbackSettings",K.a.zqd.toString()),Vj.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",Vj.queryCommandId=K.a.Njd.toString(),Vj));let Wj;this.addCommandToMaps((Wj=
new Sa.a("RehearsePresentation",K.a.Pfa.toString()),Wj.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",Wj));let sk;this.addCommandToMaps((sk=new Sa.a("RehearsePresentationTopBar",K.a.boc.toString()),sk.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachTopBar",sk));let kl;this.addCommandToMaps((kl=new Sa.a("RehearsePresentationDropDown",K.a.aoc.toString()),kl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",kl));this.addCommandToMaps(new Sa.a("RemoveHyperlink",D.a.zM.toString()));
this.addCommandToMaps(new Sa.a("RemoveSection",K.a.OQe.toString()));this.addCommandToMaps(new Sa.a("RenameSection",K.a.zld.toString()));this.addCommandToMaps(new Sa.a("Replace",K.a.h1.toString()));this.addCommandToMaps(new Sa.a("ResetPicture",K.a.Xld.toString()));this.addCommandToMaps(new Sa.a("ResetPictureAndSize",K.a.Skh.toString()));this.addCommandToMaps(new Sa.a("ResetPictureSplitButton",K.a.Tkh.toString()));this.addCommandToMaps(new Sa.a("RightToLeft",K.a.Zlc.toString()));this.addCommandToMaps(new Sa.a("RotateAnchor",
K.a.Zlh.toString()));this.addCommandToMaps(new Sa.a("RotateShapeAnchor",K.a.$lh.toString()));let vj;this.addCommandToMaps((vj=new Sa.a("RotateLeft",K.a.yaa.toString()),vj.commandPreviewId=K.a.aMe.toString(),vj.commandRevertId=K.a.RSe.toString(),vj));let vh;this.addCommandToMaps((vh=new Sa.a("RotateRight",K.a.aTe.toString()),vh.commandPreviewId=K.a.bMe.toString(),vh.commandRevertId=K.a.RSe.toString(),vh));this.addCommandToMaps(new Sa.a("RotateFlipVertical",K.a.hpc.toString()));this.addCommandToMaps(new Sa.a("RotateFlipHorizontal",
K.a.gpc.toString()));this.addCommandToMaps(new Sa.a("SelectHyperlink",D.a.nnd.toString()));this.addCommandToMaps(new Sa.a("SendBackward",K.a.sendBackward.toString()));this.addCommandToMaps(new Sa.a("SendToBack",K.a.sendToBack.toString()));this.addCommandToMaps(new Sa.a("SendToBackFlyout",K.a.Soh.toString()));this.la.cB&&Ud.a("AnimationGalleryActionAIEnabled")&&this.addCommandToMaps(new Sa.a("AnimationGalleryActionAI",K.a.sQd.toString()));this.la.zrb?(this.addCommandToMaps(Object.assign(new Sa.a("SetAnimationDelay",
K.a.jod.toString()),{queryCommandId:K.a.UJa.toString()})),this.addCommandToMaps(Object.assign(new Sa.a("SetAnimationDuration",K.a.kod.toString()),{queryCommandId:K.a.VJa.toString()})),this.addCommandToMaps(Object.assign(new Sa.a("AnimationStart",K.a.fHc.toString()),{queryCommandId:K.a.ZIb.toString()})),this.addCommandToMaps(Object.assign(new Sa.a("SetAnimationDelayMLR",K.a.jod.toString()),{queryCommandId:K.a.UJa.toString()})),this.addCommandToMaps(Object.assign(new Sa.a("SetAnimationDurationMLR",
K.a.kod.toString()),{queryCommandId:K.a.VJa.toString()})),this.addCommandToMaps(Object.assign(new Sa.a("AnimationStartMLR",K.a.fHc.toString()),{queryCommandId:K.a.ZIb.toString()})),a=new Sa.a("AnimationPane",K.a.yvh.toString()),a.queryCommandId=K.a.Lmc.toString(),this.addCommandToMaps(a),this.addCommandToMaps(new Sa.a("MoveEarlier",K.a.yEe.toString())),this.addCommandToMaps(new Sa.a("MoveLater",K.a.zEe.toString()))):(this.addCommandToMaps(new Sa.a("MoveEarlier",K.a.FRe.toString())),this.addCommandToMaps(new Sa.a("MoveLater",
K.a.GRe.toString())));let ll;this.addCommandToMaps((ll=new Sa.a("SetHeight",K.a.eod.toString()),ll.queryCommandId=K.a.Shb.toString(),ll));let Xl;this.addCommandToMaps((Xl=new Sa.a("SetWidth",K.a.fod.toString()),Xl.queryCommandId=K.a.Thb.toString(),Xl));let xm;this.addCommandToMaps((xm=new Sa.a("SetSlideSize",K.a.oqc.toString()),xm.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",xm));let Nk;this.addCommandToMaps((Nk=new Sa.a("SetSlideSize4x3",K.a.jpd.toString()),Nk.queryCommandId=K.a.Qjd.toString(),
Nk));let Ok;this.addCommandToMaps((Ok=new Sa.a("SetSlideSize16x9",K.a.ipd.toString()),Ok.queryCommandId=K.a.Pjd.toString(),Ok));let pi;this.addCommandToMaps((pi=new Sa.a("SetTransitionApplyAll",K.a.Xjb.toString()),pi.queryCommandId=K.a.KJb.toString(),pi));this.addCommandToMaps(Object.assign(new Sa.a("SetTransitionDuration",K.a.Yjb.toString()),{queryCommandId:K.a.Qxa.toString()}));this.addCommandToMaps(new Sa.a("ShapeAlignAnchor",K.a.zsh.toString()));this.addCommandToMaps(new Sa.a("ShapeAlignLeft",
K.a.Cpd.toString()));this.addCommandToMaps(new Sa.a("ShapeAlignRight",K.a.Fqc.toString()));this.addCommandToMaps(new Sa.a("ShapeAlignTop",K.a.Dpd.toString()));this.addCommandToMaps(new Sa.a("ShapeAlignBottom",K.a.Cqc.toString()));this.addCommandToMaps(new Sa.a("ShapeAlignCenter",K.a.Dqc.toString()));this.addCommandToMaps(new Sa.a("ShapeAlignMiddle",K.a.Eqc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShapeAlignToSlide",K.a.ytc.toString()),{queryCommandId:K.a.xJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeAlignToSelectedObjects",
K.a.xtc.toString()),{queryCommandId:K.a.wJb.toString()}));this.addCommandToMaps(new Sa.a("ShareSlide",K.a.Npd.toString()));this.addCommandToMaps(new Sa.a("DistributeShapesVertically",K.a.jDa.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ImmersiveReader",K.a.immersiveReader.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Sa.a("ImmersiveReaderRibbon",K.a.rde.toString()),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(new Sa.a("DistributeShapesHorizontally",
K.a.y2b.toString()));this.addCommandToMaps(new Sa.a("ShareSlide",K.a.Npd.toString()));this.addCommandToMaps(Object.assign(new Sa.a("Shrink",K.a.Dhb.toString()),{legacyControlId:"PptRibbon.Home.Font.Shrink"}));this.addCommandToMaps(Object.assign(new Sa.a("ShowCommentsTopBar",G.a.nOb.toString()),{legacyControlId:"ShowCommentsTopBar",queryCommandId:G.a.JOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowComments",K.a.j6.toString()),{queryCommandId:K.a.zJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowEditTriPaneView",
K.a.jLa.toString()),{queryCommandId:K.a.$Ib.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowHideChanges",K.a.rkb.toString()),{queryCommandId:K.a.cOe.toString()}));let Hg;this.addCommandToMaps((Hg=new Sa.a("ShowHideComments",K.a.j6.toString()),Hg.legacyControlId="PptRibbon.View.ShowHide.CommentsSplitButton",Hg.queryCommandId=K.a.zJb.toString(),Hg));let qi;this.addCommandToMaps((qi=new Sa.a("ShowHideCommentsInReview",K.a.j6.toString()),qi.queryCommandId=K.a.zJb.toString(),qi));let hg;
this.addCommandToMaps((hg=new Sa.a("ShowHideRuler",K.a.Aqd.toString()),hg.legacyControlId="btnShowHideRuler",hg.queryCommandId=K.a.vjd.toString(),hg));this.addCommandToMaps(new Sa.a("ShowRevisionTrackingWithUrlOverrides",K.a.Kqd.toString()));let Ld;this.addCommandToMaps((Ld=new Sa.a("ShowMarkup",K.a.NMb.toString()),Ld.queryCommandId=K.a.Mjd.toString(),Ld));let Oe;this.addCommandToMaps((Oe=new Sa.a("ShowTranslatePane",K.a.Lml.toString()),Oe.legacyControlId="PptRibbon.Review.Show.Translate",Oe));let yf;
this.addCommandToMaps((yf=new Sa.a("ShowSmartLookupPane",G.a.hYc.toString()),yf.legacyControlId="PptRibbon.Review.Show.SmartLookup",yf));this.addCommandToMaps(new Sa.a("SmartLookupContextMenu",G.a.gYc.toString()));this.addCommandToMaps(new Sa.a("SmartLookupSynonyms",G.a.jYc.toString()));let le;this.addCommandToMaps((le=new Sa.a("ShowSorterView",K.a.jga.toString()),le.queryCommandId=K.a.CJb.toString(),le));let Fg;this.addCommandToMaps((Fg=new Sa.a("ShowVersionHistoryDialog",G.a.yrc.toString()),Fg.legacyControlId=
"PptJewel.Info.VersionHistory",Fg));let $h;this.addCommandToMaps(($h=new Sa.a("SpokenLanguage",K.a.xhb.toString()),$h.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",$h.queryCommandId=K.a.xhb.toString(),$h.populationProps=new eh(K.a.xhb.toString(),!0),$h));this.addCommandToMaps(new Sa.a("StandardFontColorPicker",K.a.Exa.toString()));let ji;this.addCommandToMaps((ji=new Sa.a("Strikethrough",K.a.zIb.toString()),ji.legacyControlId="PptRibbon.Home.Font.Strikethrough",ji.queryCommandId=
K.a.pJb.toString(),ji));let Zn;this.addCommandToMaps((Zn=new Sa.a("SubtitleLanguage",K.a.yhb.toString()),Zn.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",Zn.queryCommandId=K.a.yhb.toString(),Zn.populationProps=new eh(K.a.yhb.toString(),!0),Zn));let Ck;this.addCommandToMaps((Ck=new Sa.a("SubtitleSettingsAnchor",K.a.Rjd.toString()),Ck.legacyControlId="PptRibbon.View.Subtitles.SubtitleSettings",Ck));let zo;this.addCommandToMaps((zo=new Sa.a("Subscript",K.a.AIb.toString()),
zo.legacyControlId="PptRibbon.Home.Font.Subscript",zo.queryCommandId=K.a.TZa.toString(),zo));this.addCommandToMaps(new Sa.a("SummarizeSlides",K.a.U0a.toString()));this.addCommandToMaps(new Sa.a("SummarizeSlidesFromTellMe",K.a.U0a.toString()));this.addCommandToMaps(new Sa.a("SummarizeDeck",K.a.Y_e.toString()));this.addCommandToMaps(new Sa.a("SummarizeDeckFromTellMe",K.a.Y_e.toString()));let Gs;this.addCommandToMaps((Gs=new Sa.a("Superscript",K.a.BIb.toString()),Gs.legacyControlId="PptRibbon.Home.Font.Superscript",
Gs.queryCommandId=K.a.UZa.toString(),Gs));this.addCommandToMaps(new Sa.a("TabSwitch",G.a.Olh.toString()));this.addCommandToMaps(new Sa.a("TextAlignmentAnchor",K.a.b8a.toString()));let Pt;this.addCommandToMaps((Pt=new Sa.a("TextAlignmentCenterJustify",K.a.Dxa.toString()),Pt.queryCommandId=K.a.WJa.toString(),Pt));let Hs;this.addCommandToMaps((Hs=new Sa.a("TextAlignmentFullJustify",K.a.zZa.toString()),Hs.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",Hs.queryCommandId=K.a.Zhb.toString(),Hs));
let Qt;this.addCommandToMaps((Qt=new Sa.a("TextAlignmentLeftJustify",K.a.Fxa.toString()),Qt.queryCommandId=K.a.XJa.toString(),Qt));let Rt;this.addCommandToMaps((Rt=new Sa.a("TextAlignmentRightJustify",K.a.Hxa.toString()),Rt.queryCommandId=K.a.ZJa.toString(),Rt));let St;this.addCommandToMaps((St=new Sa.a("TextAnchoringBottom",K.a.Y0.toString()),St.queryCommandId=K.a.$Ja.toString(),St));let Tt;this.addCommandToMaps((Tt=new Sa.a("TextAnchoringMiddle",K.a.Z0.toString()),Tt.queryCommandId=K.a.aKa.toString(),
Tt));let Ut;this.addCommandToMaps((Ut=new Sa.a("TextAnchoringTop",K.a.$0.toString()),Ut.queryCommandId=K.a.bKa.toString(),Ut));this.addCommandToMaps(new Sa.a("ThemeFontColorPicker",K.a.Exa.toString()));this.addCommandToMaps(new Sa.a("ThemeFontColorPickerMCU",K.a.Exa.toString()));let Jy;this.addCommandToMaps((Jy=new Sa.a("TopOverlaid",K.a.tOb.toString()),Jy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",Jy.queryCommandId=K.a.hib.toString(),Jy));let hB;this.addCommandToMaps((hB=
new Sa.a("Underline",K.a.CIb.toString()),hB.queryCommandId=K.a.qJb.toString(),hB));this.addCommandToMaps(new Sa.a("Undo",K.a.mmc.toString()));let iB;this.addCommandToMaps((iB=new Sa.a("UsePresenterView",K.a.z5e.toString()),iB.queryCommandId=K.a.LJb.toString(),iB));this.addCommandToMaps(new Sa.a("Zoom",K.a.lJe.toString()));let Ky;this.addCommandToMaps((Ky=new Sa.a("ToggleUseSubtitles",K.a.ZLa.toString()),Ky.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",Ky.queryCommandId=K.a.XZa.toString(),
Ky));let jB;this.addCommandToMaps((jB=new Sa.a("ToggleShapeAlignToSlide",K.a.ytc.toString()),jB.queryCommandId=K.a.xJb.toString(),jB));let kB;this.addCommandToMaps((kB=new Sa.a("ToggleShapeAlignToSelectedObjects",K.a.xtc.toString()),kB.queryCommandId=K.a.wJb.toString(),kB));let Ly;this.addCommandToMaps((Ly=new Sa.a("ToggleSubtitlesBottomOverlay",K.a.sOb.toString()),Ly.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",Ly.queryCommandId=K.a.gib.toString(),Ly));let My;this.addCommandToMaps((My=
new Sa.a("ToggleSubtitlesTopOverlay",K.a.tOb.toString()),My.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",My.queryCommandId=K.a.hib.toString(),My));let Ny;this.addCommandToMaps((Ny=new Sa.a("ToggleRehearsalVisionEnabled",K.a.pOb.toString()),Ny.legacyControlId="PptRibbon.View.Coach.Menu.Vision",Ny.queryCommandId=K.a.uJb.toString(),Ny));let lB;this.addCommandToMaps((lB=new Sa.a("HostOpenInClient",K.a.openInClient.toString()),lB.legacyControlId="HostOpenInClient",lB));let Oy;
this.addCommandToMaps((Oy=new Sa.a("ToggleSubtitlesBelowSlide",K.a.rOb.toString()),Oy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Oy.queryCommandId=K.a.fib.toString(),Oy));let Py;this.addCommandToMaps((Py=new Sa.a("ToggleSubtitlesAboveSlide",K.a.qOb.toString()),Py.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Py.queryCommandId=K.a.eib.toString(),Py));let Qy;this.addCommandToMaps((Qy=new Sa.a("BelowSlide",K.a.rOb.toString()),Qy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",
Qy.queryCommandId=K.a.fib.toString(),Qy));let Ry;this.addCommandToMaps((Ry=new Sa.a("AboveSlide",K.a.qOb.toString()),Ry.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Ry.queryCommandId=K.a.eib.toString(),Ry));let mB;this.addCommandToMaps((mB=new Sa.a("PreviousVersions",G.a.mrc.toString()),mB.legacyControlId="PptJewel.Info.FileVersion",mB));this.addCommandToMaps(new Sa.a("Present",K.a.IIb.toString()));this.addCommandToMaps(new Sa.a("PresentDropDown",K.a.Lhb.toString()))}P4h(){this.addCommandToMaps(Object.assign(new Sa.a("CenterJustify",
K.a.Dxa.toString()),{queryCommandId:K.a.WJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("FullJustify",K.a.zZa.toString()),{queryCommandId:K.a.Zhb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("LeftJustify",K.a.Fxa.toString()),{queryCommandId:K.a.XJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("RightJustify",K.a.Hxa.toString()),{queryCommandId:K.a.ZJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TextAnchoringAnchor",K.a.vid.toString()),{queryCommandId:K.a.vid.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("AlignBottom",K.a.Y0.toString()),{queryCommandId:K.a.$Ja.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("AlignMiddle",K.a.Z0.toString()),{queryCommandId:K.a.aKa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTop",K.a.$0.toString()),{queryCommandId:K.a.bKa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("UseSubtitles",K.a.ZLa.toString()),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:K.a.XZa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SubtitleSettings",
K.a.Rjd.toString()),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));this.addCommandToMaps(new Sa.a("NewBringForwardAnchorMLR",K.a.Srb.toString()));this.addCommandToMaps(new Sa.a("NewSendBackwardAnchorMLR",K.a.Srb.toString()));this.addCommandToMaps(new Sa.a("PowerPointGroupFlyoutAnchorMLR",K.a.nLe.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SetLockAspectRatio",K.a.$pc.toString()),{queryCommandId:K.a.Ymc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SetTableHeight",
K.a.Hoa.toString()),{queryCommandId:K.a.Enc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SetTableWidth",K.a.dLa.toString()),{queryCommandId:K.a.Wjd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SetTableColumnWidth",K.a.cLa.toString()),{queryCommandId:K.a.DJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SetTableRowHeight",K.a.n0a.toString()),{queryCommandId:K.a.EJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("UpdatePictureCropWidth",K.a.Mud.toString()),
{queryCommandId:K.a.hJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("UpdatePictureCropHeight",K.a.Jud.toString()),{queryCommandId:K.a.fJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("UpdatePictureCropLeft",K.a.Kud.toString()),{queryCommandId:K.a.gJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("UpdatePictureCropTop",K.a.Lud.toString()),{queryCommandId:K.a.bnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("Paste_MLR",K.a.MJa.toString()),{queryCommandId:K.a.rjd.toString()}));
this.addCommandToMaps(new Sa.a("PasteKeepingDestinationThemeMLR",K.a.wJa.toString()));this.addCommandToMaps(new Sa.a("PasteKeepingSourceFormattingMLR",K.a.xJa.toString()));this.addCommandToMaps(new Sa.a("PasteAsImageMLR",K.a.rZa.toString()));this.addCommandToMaps(Object.assign(new Sa.a("TableCellBottomAnchoringMLR",K.a.Y0.toString()),{queryCommandId:K.a.$Ja.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellCenterJustifyMLR",K.a.Dxa.toString()),{queryCommandId:K.a.WJa.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("TableCellLeftJustifyMLR",K.a.Fxa.toString()),{queryCommandId:K.a.XJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellMiddleAnchoringMLR",K.a.Z0.toString()),{queryCommandId:K.a.aKa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellRightJustifyMLR",K.a.Hxa.toString()),{queryCommandId:K.a.ZJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellTopAnchoringMLR",K.a.$0.toString()),{queryCommandId:K.a.bKa.toString()}));
this.addCommandToMaps(new Sa.a("ParagraphOptionsMLR",K.a.OAb.toString()));this.addCommandToMaps(new Sa.a("Delete_MLR",K.a.deleteObject.toString()));this.addCommandToMaps(new Sa.a("SmartArtStylesMLR",K.a.SK.toString()));this.addCommandToMaps(new Sa.a("PictureCropMLR",K.a.NYd.toString()))}UOd(){this.addTabToMap("FormatShape",K.a.lQf.toString());this.addTabToMap("FormatPicture",K.a.z$g.toString());this.addTabToMap("SmartArtDesign",K.a.gxh.toString());this.addTabToMap("Table",K.a.XNe.toString());this.addTabToMap("Graphics",
K.a.ddh.toString());this.addTabToMap("Playback",K.a.Gyf.toString());this.addTabToMap("AudioFormat",K.a.Eyf.toString());this.addTabToMap("Audio",K.a.Hyf.toString());this.addTabToMap("AccessibleAuthoring",K.a.NNd.toString())}W4h(){this.addCommandToMaps(Object.assign(new Sa.a("PptJewelDownloadACopyAsOdp",K.a.K2b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelDownloadACopyAsPdf",K.a.L2b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));
this.addCommandToMaps(Object.assign(new Sa.a("PptJewelDownloadACopy",K.a.downloadACopy.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelDownloadAsImages",K.a.M2b.toString()),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelNew",G.a.NAb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelOpen",G.a.NAb.toString()),{legacyControlId:"PptJewel.Open"}));
this.addCommandToMaps(Object.assign(new Sa.a("New",G.a.NAb.toString()),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Sa.a("Open",G.a.NAb.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelPrintFullSlide",K.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelPrintHandouts",K.a.gMe.toString()),{legacyControlId:"PptJewel.Print.PrintHandouts"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelPrintNotes",
K.a.iMe.toString()),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelPrintToPdf",K.a.print.toString()),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelRename",G.a.SYe.toString()),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelSaveACopy",K.a.hmc.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelSaveAsToHost",
K.a.tLe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelSaveToSharePoint",K.a.uLe.toString()),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelTrustCenter",G.a.XMb.toString()),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Sa.a("PptJewelVersionHistory",G.a.yrc.toString()),{legacyControlId:"PptJewel.Info.VersionHistory"}));
this.addCommandToMaps(Object.assign(new Sa.a("PptJewelPreviousVersions",G.a.mrc.toString()),{legacyControlId:"PptJewel.Info.FileVersion"}))}S4h(){this.addCommandToMaps(Object.assign(new Sa.a("ApplyShapeStyleAnchor",K.a.XQd.toString()),{populationProps:new eh(K.a.aLe.toString(),!1)}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyShapeStylePreviewGallery",K.a.Nrb.toString()),{queryCommandId:K.a.Gjd.toString(),populationProps:new eh(K.a.aLe.toString(),!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Sa.a("ApplyGraphicsStyleAnchor",K.a.NQd.toString()),{populationProps:new eh(K.a.XKe.toString(),!1)}));this.addCommandToMaps(new Sa.a("FontRecentColors",K.a.cmc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("GraphicsStylePreviewGallery",K.a.nZb.toString()),{queryCommandId:K.a.djd.toString(),populationProps:new eh(K.a.XKe.toString(),!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Sa.a("GraphicsFill",K.a.Krb.toString()),{populationProps:new eh(K.a.$Ke.toString(),!1)}));this.addCommandToMaps(new Sa.a("GraphicNoFill",K.a.DQe.toString()));this.addCommandToMaps(new Sa.a("GraphicNoOutline",K.a.EQe.toString()));this.addCommandToMaps(Object.assign(new Sa.a("GraphicsOutline",K.a.Lrb.toString()),{populationProps:new eh(K.a.aid.toString(),!1)}));this.addCommandToMaps(new Sa.a("MoreFillColors",K.a.pEe.toString()));this.addCommandToMaps(new Sa.a("MoreFontColors",
K.a.tZg.toString()));this.addCommandToMaps(new Sa.a("MoreFormatBackgroundColors",K.a.qEe.toString()));this.addCommandToMaps(new Sa.a("MoreOutlineColors",K.a.rEe.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShowHideFormatShapePane",K.a.orc.toString()),{queryCommandId:K.a.aJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("MoreRotationOptions",K.a.orc.toString()),{queryCommandId:K.a.aJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("PictureBorders",K.a.Fia.toString()),
{populationProps:new eh(K.a.aid.toString(),!1)}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeFill",K.a.aCa.toString()),{populationProps:new eh(K.a.$Ke.toString(),!1),commandPreviewId:K.a.KIb.toString(),commandRevertId:K.a.MKb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeFillRecentColors",K.a.zHc.toString()),{commandPreviewId:K.a.KIb.toString(),commandRevertId:K.a.MKb.toString()}));this.addCommandToMaps(new Sa.a("ShapeNoFill",K.a.hld.toString()));this.addCommandToMaps(new Sa.a("ShapeNoOutline",
K.a.ild.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutline",K.a.Fia.toString()),{populationProps:new eh(K.a.aid.toString(),!1)}));this.addCommandToMaps(new Sa.a("ShapeOutlineRecentColors",K.a.AHc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineDashStyle_1",K.a.o6a.toString()),{menuItemId:"ShapeOutlineDashStyle,1"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineDashStyle_2",K.a.o6a.toString()),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineDashStyle_4",
K.a.o6a.toString()),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Sa.a("ShapeOutlineDashStyleAnchor",K.a.BHc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineSketchStyle_1",K.a.p6a.toString()),{menuItemId:"ShapeOutlineSketchStyle,1"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineSketchStyle_2",K.a.p6a.toString()),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineSketchStyle_3",K.a.p6a.toString()),
{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineSketchStyle_4",K.a.p6a.toString()),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Sa.a("ShapeOutlineSketchStyleAnchor",K.a.DHc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_1",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_2",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,2"}));
this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_3",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_4",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,4"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_5",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_6",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,6"}));
this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineEndStyle_7",K.a.Gia.toString()),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Sa.a("ShapeOutlineEndStyleAnchor",K.a.CHc.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineWidth_1",K.a.SPa.toString()),{menuItemId:"ShapeOutlineWidth,1"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineWidth_2",K.a.SPa.toString()),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineWidth_3",
K.a.SPa.toString()),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Sa.a("ShapeOutlineWidth_4",K.a.SPa.toString()),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Sa.a("ShapeOutlineWidthAnchor",K.a.EHc.toString()));this.addCommandToMaps(new Sa.a("StandardGraphicFillColorPicker",K.a.Krb.toString()));this.addCommandToMaps(new Sa.a("StandardGraphicOutlineColorPicker",K.a.Lrb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("StandardShapeFillColorPicker",
K.a.aCa.toString()),{commandPreviewId:K.a.KIb.toString(),commandRevertId:K.a.MKb.toString()}));this.addCommandToMaps(new Sa.a("StandardShapeOutlineColorPicker",K.a.Fia.toString()));this.addCommandToMaps(new Sa.a("ThemeGraphicFillColorPicker",K.a.Krb.toString()));this.addCommandToMaps(new Sa.a("ThemeGraphicFillColorPickerMCU",K.a.Krb.toString()));this.addCommandToMaps(new Sa.a("ThemeGraphicOutlineColorPicker",K.a.Lrb.toString()));this.addCommandToMaps(new Sa.a("ThemeGraphicOutlineColorPickerMCU",K.a.Lrb.toString()));
this.addCommandToMaps(Object.assign(new Sa.a("ThemeShapeFillColorPickerMCU",K.a.aCa.toString()),{commandPreviewId:K.a.KIb.toString(),commandRevertId:K.a.MKb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemeShapeFillColorPicker",K.a.aCa.toString()),{commandPreviewId:K.a.KIb.toString(),commandRevertId:K.a.MKb.toString()}));this.addCommandToMaps(new Sa.a("ThemeShapeOutlineColorPicker",K.a.Fia.toString()));this.addCommandToMaps(new Sa.a("ThemeShapeOutlineColorPickerMCU",K.a.Fia.toString()))}X4h(){this.addCommandToMaps(Object.assign(new Sa.a("Themes",
K.a.gw.toString()),{queryCommandId:K.a.zz.toString(),previewControlIds:"ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesOfficeTheme",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesAtlas",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesMadison",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("ThemesIon",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesOrganic",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesFrame",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesIonBoardroom",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesMesh",
K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesRetrospect",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesSlice",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesSavon",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesBanded",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("ThemesQuotable",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesWoodType",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesBasis",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesIntegral",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesWisp",
K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesDividend",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesCelestial",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesParallax",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesMetropolitan",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("ThemesFacet",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ThemesViewTheme",K.a.gw.toString()),{queryCommandId:K.a.zz.toString()}))}Z4h(){this.addCommandToMaps(Object.assign(new Sa.a("Transitions",K.a.Qj.toString()),{queryCommandId:K.a.zj.toString(),previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionExisting",
K.a.Ioa.toString()),{legacyControlId:"TransitionExisting",queryCommandId:K.a.Vna.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionExistingInMenu",K.a.Dya.toString()),{legacyControlId:"TransitionExistingInMenu",queryCommandId:K.a.Rxa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionNone",K.a.Qj.toString()),{legacyControlId:"TransitionNone",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionMorph",K.a.Qj.toString()),
{legacyControlId:"TransitionMorph",queryCommandId:K.a.zj.toString()}));this.la.cB&&Ud.a("MorphTransitionActionAIEnabled")&&this.addCommandToMaps(Object.assign(new Sa.a("TransitionMorphActionAI",K.a.Qj.toString()),{legacyControlId:"TransitionMorph",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionCut",K.a.Qj.toString()),{legacyControlId:"TransitionCut",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionFade",K.a.Qj.toString()),
{legacyControlId:"TransitionFade",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionPush",K.a.Qj.toString()),{legacyControlId:"TransitionPush",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionWipe",K.a.Qj.toString()),{legacyControlId:"TransitionWipe",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionSplit",K.a.Qj.toString()),{legacyControlId:"TransitionSplit",queryCommandId:K.a.zj.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("TransitionRandomBars",K.a.Qj.toString()),{legacyControlId:"TransitionRandomBars",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionShape",K.a.Qj.toString()),{legacyControlId:"TransitionShape",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionComb",K.a.Qj.toString()),{legacyControlId:"TransitionComb",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionBlinds",
K.a.Qj.toString()),{legacyControlId:"TransitionBlinds",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionBox",K.a.Qj.toString()),{legacyControlId:"TransitionBox",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionCover",K.a.Qj.toString()),{legacyControlId:"TransitionCover",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionCube",K.a.Qj.toString()),{legacyControlId:"TransitionCube",
queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionCurtains",K.a.Qj.toString()),{legacyControlId:"TransitionCurtains",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionDissolve",K.a.Qj.toString()),{legacyControlId:"TransitionDissolve",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionOrbit",K.a.Qj.toString()),{legacyControlId:"TransitionOrbit",queryCommandId:K.a.zj.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("TransitionPageCurl",K.a.Qj.toString()),{legacyControlId:"TransitionPageCurl",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionPeelOff",K.a.Qj.toString()),{legacyControlId:"TransitionPeelOff",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionRandom",K.a.Qj.toString()),{legacyControlId:"TransitionRandom",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionReveal",
K.a.Qj.toString()),{legacyControlId:"TransitionReveal",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionRotate",K.a.Qj.toString()),{legacyControlId:"TransitionRotate",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionUncover",K.a.Qj.toString()),{legacyControlId:"TransitionUncover",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionWheel",K.a.Qj.toString()),{legacyControlId:"TransitionWheel",
queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionRipple",K.a.Qj.toString()),{legacyControlId:"TransitionRipple",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionBox",K.a.Qj.toString()),{legacyControlId:"TransitionBox",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionCube",K.a.Qj.toString()),{legacyControlId:"TransitionCube",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionSwitch",
K.a.Qj.toString()),{legacyControlId:"TransitionSwitch",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionFallOver",K.a.Qj.toString()),{legacyControlId:"TransitionFallOver",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionDrape",K.a.Qj.toString()),{legacyControlId:"TransitionDrape",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionFlip",K.a.Qj.toString()),{legacyControlId:"TransitionFlip",
queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionWind",K.a.Qj.toString()),{legacyControlId:"TransitionWind",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionPrestige",K.a.Qj.toString()),{legacyControlId:"TransitionPrestige",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionFracture",K.a.Qj.toString()),{legacyControlId:"TransitionFracture",queryCommandId:K.a.zj.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("TransitionCrush",K.a.Qj.toString()),{legacyControlId:"TransitionCrush",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionAirplane",K.a.Qj.toString()),{legacyControlId:"TransitionAirplane",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionOrigami",K.a.Qj.toString()),{legacyControlId:"TransitionOrigami",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionChecker",
K.a.Qj.toString()),{legacyControlId:"TransitionChecker",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionVortex",K.a.Qj.toString()),{legacyControlId:"TransitionVortex",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionGlitter",K.a.Qj.toString()),{legacyControlId:"TransitionGlitter",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionPan",K.a.Qj.toString()),{legacyControlId:"TransitionPan",
queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionGalleryIcon",K.a.Qj.toString()),{legacyControlId:"TransitionGalleryIcon",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionConveyor",K.a.Qj.toString()),{legacyControlId:"TransitionConveyor",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionZoom",K.a.Qj.toString()),{legacyControlId:"TransitionZoom",queryCommandId:K.a.zj.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("TransitionFlyThrough",K.a.Qj.toString()),{legacyControlId:"TransitionFlyThrough",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionWindow",K.a.Qj.toString()),{legacyControlId:"TransitionWindow",queryCommandId:K.a.zj.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TransitionDoors",K.a.Qj.toString()),{legacyControlId:"TransitionDoors",queryCommandId:K.a.zj.toString()}))}I4h(){this.addCommandToMaps(Object.assign(new Sa.a("Animations",
K.a.Bz.toString()),{queryCommandId:K.a.Sna.toString(),previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Sa.a("AnimationExisting",K.a.BLb.toString()),{queryCommandId:K.a.Sna.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("AnimationExistingInMenu",K.a.Z_a.toString()),{queryCommandId:K.a.Sna.toString()}));for(const a of this.C5j)this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.Bz.toString()),
{queryCommandId:K.a.Sna.toString()}))}H4h(){this.addCommandToMaps(Object.assign(new Sa.a("AnimationEffectOptions",K.a.qNe.toString()),{populationProps:new eh(K.a.uhb.toString(),!1)}));for(const a of this.y5j)this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.Y_a.toString()),{queryCommandId:K.a.NZa.toString(),menuItemId:a.slice(this.z5j)}));for(const a of this.A5j)this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.X_a.toString()),{queryCommandId:K.a.MZa.toString(),menuItemId:a.slice(this.B5j)}));this.addCommandToMaps(new Sa.a("AnimationEffectOptionsThemeColorPickerMCU",
K.a.vya.toString()));this.addCommandToMaps(new Sa.a("AnimationEffectOptionsThemeColorPicker",K.a.vya.toString()));this.addCommandToMaps(new Sa.a("AnimationEffectOptionsStandardColorPicker",K.a.vya.toString()));this.addCommandToMaps(Object.assign(new Sa.a("AnimationEffectOptionsSequenceAsOneObject",K.a.mod.toString()),{queryCommandId:K.a.Tna.toString(),menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Sa.a("AnimationEffectOptionsSequenceAllAtOnce",K.a.lod.toString()),{queryCommandId:K.a.Tna.toString(),
menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Sa.a("AnimationEffectOptionsSequenceByParagraph",K.a.nod.toString()),{queryCommandId:K.a.Tna.toString(),menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Sa.a("AnimationEffectOptionsSequenceOneByOne",K.a.ood.toString()),{queryCommandId:K.a.Tna.toString(),menuItemId:"OneByOne"}))}L4h(){this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundSolidFillFromCanvas",K.a.FQc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",
populationProps:new eh(K.a.Z$g.toString(),!1)}));for(const a of this.C8j)this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.FQc.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundApplyToAllFromCanvas",K.a.QXf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundResetFromCanvas",K.a.SXf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Sa.a("FormatBackgroundPictureFromCanvas",K.a.RXf.toString()),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}))}Y4h(){this.addCommandToMaps(Object.assign(new Sa.a("TransitionEffectOptions",K.a.iib.toString()),{populationProps:new eh(K.a.hIb.toString(),!1)}));for(const a of this.$hk)this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.vqc.toString()),{queryCommandId:K.a.Xjd.toString(),menuItemId:a.slice(this.aik)}))}R4h(){this.addCommandToMaps(new Sa.a("PictureStyles",
K.a.Pra.toString()));for(const a of this.Jck){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.Pra.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:b}))}}T4h(){this.addCommandToMaps(new Sa.a("ChangeSmartArtLayoutAnchor",G.a.uRa.toString()));for(const a of this.YTg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Sa.a("Change"+a,K.a.J_b.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Sa.a("SmartArtEditText",
K.a.AQf.toString()),{queryCommandId:K.a.$id.toString()}));this.addCommandToMaps(new Sa.a("SmartArtDemote",K.a.imc.toString()));this.addCommandToMaps(new Sa.a("SmartArtPromote",K.a.yIb.toString()));this.addCommandToMaps(new Sa.a("SmartArtResetGraphic",K.a.dya.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtReverse",K.a.PSe.toString()),{queryCommandId:K.a.ujd.toString()}));this.addCommandToMaps(new Sa.a("SmartArtStyles",K.a.SK.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__simple1__simple",
K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__simple2__simple",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__simple3__simple",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__simple4__simple",K.a.SK.toString()),
{queryCommandId:K.a.wc.toString(),menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__simple5__simple",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d1__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d2__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d2,3D"}));
this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d3__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d4__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d5__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d6__3D",
K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d7__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d8__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Sa.a("SmartArtStyle__3d9__3D",K.a.SK.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:"3d9,3D"}))}O4h(){this.addCommandToMaps(new Sa.a("InsertSmartArtAnchor",
K.a.Ehe.toString()));for(const a of this.YTg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.YEa.toString()),{queryCommandId:K.a.wc.toString(),menuItemId:b[1]+","+b[2]}))}}Q4h(){this.addCommandToMaps(new Sa.a("PictureCropToShapeAnchor",K.a.x$g.toString()));for(const a of this.Ick)this.addCommandToMaps(Object.assign(new Sa.a(a,K.a.w$g.toString()),{queryCommandId:K.a.wc.toString()}))}N4h(){this.addCommandToMaps(new Sa.a("InsertShapesAll",K.a.cfg.toString()));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStraightConnector",
K.a.HXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStraightConnectorArrow",K.a.IXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStraightConnectorTwoArrow",K.a.JXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeElbowConnector",K.a.FXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeElbowArrowConnector",
K.a.EXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeElbowDoubleArrowConnector",K.a.GXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCurvedConnector",K.a.CXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCurvedArrowConnector",K.a.BXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCurvedDoubleArrowConnector",
K.a.DXc.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRectangle",K.a.Mge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRoundedRectangle",K.a.Wge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSnipSingleCornerRectangle",K.a.dhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSnipSameSideCornerRectangle",
K.a.che.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSnipDiagonalCornerRectangle",K.a.ahe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSnipRoundSingleCornerRectangle",K.a.bhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRoundSingleCornerRectangle",K.a.Vge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRoundSameSideCornerRectangle",
K.a.Uge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRoundDiagonalCornerRectangle",K.a.Tge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeTextBox",K.a.XEa.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeEllipse",K.a.Cfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeTriangle",
K.a.whe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRightTriangle",K.a.Sge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeParallelogram",K.a.Cge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeTrapezoid",K.a.vhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDiamond",
K.a.qfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSPentagon",K.a.Yge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeHexagon",K.a.Lfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeHeptagon",K.a.Kfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeOctagon",K.a.xge.toString()),
{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDecagon",K.a.mfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDodecagon",K.a.ufe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapePie",K.a.Ege.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeChord",K.a.Yee.toString()),{queryCommandId:K.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeTeardrop",K.a.the.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeFrame",K.a.Hfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeHalfFrame",K.a.Ife.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLShape",K.a.Ofe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDiagonalStripe",
K.a.pfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCross",K.a.dfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapePlaque",K.a.Fge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCan",K.a.Vee.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCube",K.a.efe.toString()),
{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeBevel",K.a.Tee.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDonut",K.a.vfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeNoSymbol",K.a.vge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeBlockArc",K.a.Uee.toString()),{queryCommandId:K.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeFoldedCorner",K.a.Gfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSmileyFace",K.a.$ge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeHeart",K.a.Jfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLightningBolt",K.a.Xfe.toString()),{queryCommandId:K.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeSun",K.a.she.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeMoon",K.a.tge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeCloud",K.a.$ee.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeArc",K.a.Pee.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDoubleBracket",
K.a.xfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDoubleBrace",K.a.wfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLeftBracket",K.a.Sfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRightBracket",K.a.Rge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLeftBrace",
K.a.Rfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRightBrace",K.a.Qge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeRightArrow",K.a.Oge.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLeftArrow",K.a.Pfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeUpArrow",K.a.yhe.toString()),
{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeDownArrow",K.a.zfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLeftRightArrow",K.a.Tfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeUpDownArrow",K.a.Ahe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeQuadArrow",K.a.Kge.toString()),
{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLeftRightUpArrow",K.a.Vfe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeBentArrow",K.a.Qee.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeUTurnArrow",K.a.xhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeLeftUpArrow",K.a.Wfe.toString()),
{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeBentUpArrow",K.a.Ree.toString()),{queryCommandId:K.a.wc.toString()}));let a;this.addCommandToMaps((a=new Sa.a("InsertShapeCurvedRightArrow",K.a.ife.toString()),a.queryCommandId=K.a.wc.toString(),a));let b;this.addCommandToMaps((b=new Sa.a("InsertShapeCurvedLeftArrow",K.a.hfe.toString()),b.queryCommandId=K.a.wc.toString(),b));let c;this.addCommandToMaps((c=new Sa.a("InsertShapeCurvedUpArrow",K.a.jfe.toString()),
c.queryCommandId=K.a.wc.toString(),c));let f;this.addCommandToMaps((f=new Sa.a("InsertShapeCurvedDownArrow",K.a.ffe.toString()),f.queryCommandId=K.a.wc.toString(),f));let l;this.addCommandToMaps((l=new Sa.a("InsertShapeStripedRightArrow",K.a.qhe.toString()),l.queryCommandId=K.a.wc.toString(),l));let x;this.addCommandToMaps((x=new Sa.a("InsertShapeNotchedRightArrow",K.a.wge.toString()),x.queryCommandId=K.a.wc.toString(),x));let H;this.addCommandToMaps((H=new Sa.a("InsertShapePentagon",K.a.Dge.toString()),
H.queryCommandId=K.a.wc.toString(),H));let U;this.addCommandToMaps((U=new Sa.a("InsertShapeChevron",K.a.Xee.toString()),U.queryCommandId=K.a.wc.toString(),U));let ja;this.addCommandToMaps((ja=new Sa.a("InsertShapeRightArrowCallout",K.a.Pge.toString()),ja.queryCommandId=K.a.wc.toString(),ja));let ya;this.addCommandToMaps((ya=new Sa.a("InsertShapeDownArrowCallout",K.a.Afe.toString()),ya.queryCommandId=K.a.wc.toString(),ya));let Va;this.addCommandToMaps((Va=new Sa.a("InsertShapeLeftArrowCallout",K.a.Qfe.toString()),
Va.queryCommandId=K.a.wc.toString(),Va));let hb;this.addCommandToMaps((hb=new Sa.a("InsertShapeUpArrowCallout",K.a.zhe.toString()),hb.queryCommandId=K.a.wc.toString(),hb));let yb;this.addCommandToMaps((yb=new Sa.a("InsertShapeLeftRightArrowCallout",K.a.Ufe.toString()),yb.queryCommandId=K.a.wc.toString(),yb));let Zb;this.addCommandToMaps((Zb=new Sa.a("InsertShapeQuadArrowCallout",K.a.Lge.toString()),Zb.queryCommandId=K.a.wc.toString(),Zb));let fc;this.addCommandToMaps((fc=new Sa.a("InsertShapeCircularArrow",
K.a.Zee.toString()),fc.queryCommandId=K.a.wc.toString(),fc));let Kc;this.addCommandToMaps((Kc=new Sa.a("InsertShapeMathPlus",K.a.rge.toString()),Kc.queryCommandId=K.a.wc.toString(),Kc));let Lc;this.addCommandToMaps((Lc=new Sa.a("InsertShapeMathMinus",K.a.oge.toString()),Lc.queryCommandId=K.a.wc.toString(),Lc));let Gc;this.addCommandToMaps((Gc=new Sa.a("InsertShapeMathMultiply",K.a.pge.toString()),Gc.queryCommandId=K.a.wc.toString(),Gc));let ae;this.addCommandToMaps((ae=new Sa.a("InsertShapeMathDivide",
K.a.mge.toString()),ae.queryCommandId=K.a.wc.toString(),ae));let we;this.addCommandToMaps((we=new Sa.a("InsertShapeMathEqual",K.a.nge.toString()),we.queryCommandId=K.a.wc.toString(),we));let $d;this.addCommandToMaps(($d=new Sa.a("InsertShapeMathNotEqual",K.a.qge.toString()),$d.queryCommandId=K.a.wc.toString(),$d));let Te;this.addCommandToMaps((Te=new Sa.a("InsertShapeProcess",K.a.Ige.toString()),Te.queryCommandId=K.a.wc.toString(),Te));let Ze;this.addCommandToMaps((Ze=new Sa.a("InsertShapeAlternateProcess",
K.a.Oee.toString()),Ze.queryCommandId=K.a.wc.toString(),Ze));let Vf;this.addCommandToMaps((Vf=new Sa.a("InsertShapeDecision",K.a.nfe.toString()),Vf.queryCommandId=K.a.wc.toString(),Vf));let gg;this.addCommandToMaps((gg=new Sa.a("InsertShapeData",K.a.lfe.toString()),gg.queryCommandId=K.a.wc.toString(),gg));let Qg;this.addCommandToMaps((Qg=new Sa.a("InsertShapePredefinedProcess",K.a.Gge.toString()),Qg.queryCommandId=K.a.wc.toString(),Qg));let Rg;this.addCommandToMaps((Rg=new Sa.a("InsertShapeInternalStorage",
K.a.Nfe.toString()),Rg.queryCommandId=K.a.wc.toString(),Rg));let Wf;this.addCommandToMaps((Wf=new Sa.a("InsertShapeDocument",K.a.tfe.toString()),Wf.queryCommandId=K.a.wc.toString(),Wf));let rg;this.addCommandToMaps((rg=new Sa.a("InsertShapeMultidocument",K.a.uge.toString()),rg.queryCommandId=K.a.wc.toString(),rg));let Sg;this.addCommandToMaps((Sg=new Sa.a("InsertShapeTerminator",K.a.uhe.toString()),Sg.queryCommandId=K.a.wc.toString(),Sg));let Gh;this.addCommandToMaps((Gh=new Sa.a("InsertShapePreparation",
K.a.Hge.toString()),Gh.queryCommandId=K.a.wc.toString(),Gh));let Zi;this.addCommandToMaps((Zi=new Sa.a("InsertShapeManualInput",K.a.kge.toString()),Zi.queryCommandId=K.a.wc.toString(),Zi));let Ei;this.addCommandToMaps((Ei=new Sa.a("InsertShapeManualOperation",K.a.lge.toString()),Ei.queryCommandId=K.a.wc.toString(),Ei));let fj;this.addCommandToMaps((fj=new Sa.a("InsertShapeConnector",K.a.cfe.toString()),fj.queryCommandId=K.a.wc.toString(),fj));let Fi;this.addCommandToMaps((Fi=new Sa.a("InsertShapeOffpageConnector",
K.a.yge.toString()),Fi.queryCommandId=K.a.wc.toString(),Fi));let Gi;this.addCommandToMaps((Gi=new Sa.a("InsertShapeCard",K.a.Wee.toString()),Gi.queryCommandId=K.a.wc.toString(),Gi));let Mk;this.addCommandToMaps((Mk=new Sa.a("InsertShapePunchedTape",K.a.Jge.toString()),Mk.queryCommandId=K.a.wc.toString(),Mk));let Cj;this.addCommandToMaps((Cj=new Sa.a("InsertShapeSummingJunction",K.a.rhe.toString()),Cj.queryCommandId=K.a.wc.toString(),Cj));let Bk;this.addCommandToMaps((Bk=new Sa.a("InsertShapeOr",K.a.zge.toString()),
Bk.queryCommandId=K.a.wc.toString(),Bk));let Il;this.addCommandToMaps((Il=new Sa.a("InsertShapeCollate",K.a.bfe.toString()),Il.queryCommandId=K.a.wc.toString(),Il));let lk;this.addCommandToMaps((lk=new Sa.a("InsertShapeSort",K.a.ehe.toString()),lk.queryCommandId=K.a.wc.toString(),lk));let Jl;this.addCommandToMaps((Jl=new Sa.a("InsertShapeExtract",K.a.Ffe.toString()),Jl.queryCommandId=K.a.wc.toString(),Jl));let Vj;this.addCommandToMaps((Vj=new Sa.a("InsertShapeMerge",K.a.sge.toString()),Vj.queryCommandId=
K.a.wc.toString(),Vj));let Wj;this.addCommandToMaps((Wj=new Sa.a("InsertShapeStoredData",K.a.phe.toString()),Wj.queryCommandId=K.a.wc.toString(),Wj));let sk;this.addCommandToMaps((sk=new Sa.a("InsertShapeDelay",K.a.ofe.toString()),sk.queryCommandId=K.a.wc.toString(),sk));let kl;this.addCommandToMaps((kl=new Sa.a("InsertShapeSequentialActionStorage",K.a.Zge.toString()),kl.queryCommandId=K.a.wc.toString(),kl));let vj;this.addCommandToMaps((vj=new Sa.a("InsertShapeMagneticDisk",K.a.jge.toString()),vj.queryCommandId=
K.a.wc.toString(),vj));let vh;this.addCommandToMaps((vh=new Sa.a("InsertShapeDirectAccessStorage",K.a.rfe.toString()),vh.queryCommandId=K.a.wc.toString(),vh));let ll;this.addCommandToMaps((ll=new Sa.a("InsertShapeDisplay",K.a.sfe.toString()),ll.queryCommandId=K.a.wc.toString(),ll));let Xl;this.addCommandToMaps((Xl=new Sa.a("InsertShapeExplosion1",K.a.Dfe.toString()),Xl.queryCommandId=K.a.wc.toString(),Xl));let xm;this.addCommandToMaps((xm=new Sa.a("InsertShapeExplosion2",K.a.Efe.toString()),xm.queryCommandId=
K.a.wc.toString(),xm));let Nk;this.addCommandToMaps((Nk=new Sa.a("InsertShapeStar4",K.a.khe.toString()),Nk.queryCommandId=K.a.wc.toString(),Nk));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar5",K.a.lhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar6",K.a.mhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar7",K.a.nhe.toString()),{queryCommandId:K.a.wc.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar8",K.a.ohe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar10",K.a.fhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar12",K.a.ghe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar16",K.a.hhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar24",
K.a.ihe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeStar32",K.a.jhe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("InsertShapeUpRibbon",K.a.Bhe.toString()),{queryCommandId:K.a.wc.toString()}));let Ok;this.addCommandToMaps((Ok=new Sa.a("InsertShapeDownRibbon",K.a.Bfe.toString()),Ok.queryCommandId=K.a.wc.toString(),Ok));let pi;this.addCommandToMaps((pi=new Sa.a("InsertShapeCurvedUpRibbon",K.a.kfe.toString()),
pi.queryCommandId=K.a.wc.toString(),pi));let Hg;this.addCommandToMaps((Hg=new Sa.a("InsertShapeCurvedDownRibbon",K.a.gfe.toString()),Hg.queryCommandId=K.a.wc.toString(),Hg));let qi;this.addCommandToMaps((qi=new Sa.a("InsertShapeVerticalScroll",K.a.Che.toString()),qi.queryCommandId=K.a.wc.toString(),qi));let hg;this.addCommandToMaps((hg=new Sa.a("InsertShapeHorizontalScroll",K.a.Mfe.toString()),hg.queryCommandId=K.a.wc.toString(),hg));let Ld;this.addCommandToMaps((Ld=new Sa.a("InsertShapeWave",K.a.Dhe.toString()),
Ld.queryCommandId=K.a.wc.toString(),Ld));let Oe;this.addCommandToMaps((Oe=new Sa.a("InsertShapeDoubleWave",K.a.yfe.toString()),Oe.queryCommandId=K.a.wc.toString(),Oe));let yf;this.addCommandToMaps((yf=new Sa.a("InsertShapeRectangularCallout",K.a.Nge.toString()),yf.queryCommandId=K.a.wc.toString(),yf));let le;this.addCommandToMaps((le=new Sa.a("InsertShapeRoundedRectangleCallout",K.a.Xge.toString()),le.queryCommandId=K.a.wc.toString(),le));let Fg;this.addCommandToMaps((Fg=new Sa.a("InsertShapeOvalCallout",
K.a.Bge.toString()),Fg.queryCommandId=K.a.wc.toString(),Fg));let $h;this.addCommandToMaps(($h=new Sa.a("InsertShapeCloudCallout",K.a.afe.toString()),$h.queryCommandId=K.a.wc.toString(),$h));let ji;this.addCommandToMaps((ji=new Sa.a("InsertShapeLineCallout1BorderAccent",K.a.$fe.toString()),ji.queryCommandId=K.a.wc.toString(),ji));let Zn;this.addCommandToMaps((Zn=new Sa.a("InsertShapeLineCallout2BorderAccent",K.a.dge.toString()),Zn.queryCommandId=K.a.wc.toString(),Zn));let Ck;this.addCommandToMaps((Ck=
new Sa.a("InsertShapeLineCallout3BorderAccent",K.a.hge.toString()),Ck.queryCommandId=K.a.wc.toString(),Ck));let zo;this.addCommandToMaps((zo=new Sa.a("InsertShapeLineCallout1Accent",K.a.Zfe.toString()),zo.queryCommandId=K.a.wc.toString(),zo));let Gs;this.addCommandToMaps((Gs=new Sa.a("InsertShapeLineCallout2Accent",K.a.cge.toString()),Gs.queryCommandId=K.a.wc.toString(),Gs));let Pt;this.addCommandToMaps((Pt=new Sa.a("InsertShapeLineCallout3Accent",K.a.gge.toString()),Pt.queryCommandId=K.a.wc.toString(),
Pt));let Hs;this.addCommandToMaps((Hs=new Sa.a("InsertShapeLineCallout1",K.a.Yfe.toString()),Hs.queryCommandId=K.a.wc.toString(),Hs));let Qt;this.addCommandToMaps((Qt=new Sa.a("InsertShapeLineCallout2",K.a.bge.toString()),Qt.queryCommandId=K.a.wc.toString(),Qt));let Rt;this.addCommandToMaps((Rt=new Sa.a("InsertShapeLineCallout3",K.a.fge.toString()),Rt.queryCommandId=K.a.wc.toString(),Rt));let St;this.addCommandToMaps((St=new Sa.a("InsertShapeLineCallout1NoBorder",K.a.age.toString()),St.queryCommandId=
K.a.wc.toString(),St));let Tt;this.addCommandToMaps((Tt=new Sa.a("InsertShapeLineCallout2NoBorder",K.a.ege.toString()),Tt.queryCommandId=K.a.wc.toString(),Tt));let Ut;this.addCommandToMaps((Ut=new Sa.a("InsertShapeLineCallout3NoBorder",K.a.ige.toString()),Ut.queryCommandId=K.a.wc.toString(),Ut));this.addCommandToMaps(new Sa.a("InsertShapeTextBoxBig",K.a.XEa.toString()))}K4h(){this.addCommandToMaps(Object.assign(new Sa.a(he.Z8,K.a.xnd.toString()),{queryCommandId:K.a.BNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.bB,
K.a.ynd.toString()),{queryCommandId:K.a.CNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.eE,K.a.znd.toString()),{queryCommandId:K.a.DNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.dE,K.a.wnd.toString()),{queryCommandId:K.a.ANe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.Wta,K.a.Bnd.toString()),{queryCommandId:K.a.gdh.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.gab,K.a.ond.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.Fda,
K.a.pnd.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.Vta,K.a.qnd.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.Eka,K.a.snd.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.Fka,K.a.tnd.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.REa,K.a.und.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.SEa,
K.a.iUe.toString()),{queryCommandId:K.a.yNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.Y8,K.a.vnd.toString()),{queryCommandId:K.a.zNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.TEa,K.a.JKa.toString()),{queryCommandId:K.a.ENe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.UEa,K.a.jUe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.VEa,K.a.kUe.toString()),{queryCommandId:K.a.wc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a(he.WEa,
K.a.lUe.toString()),{queryCommandId:K.a.wc.toString()}))}V4h(){this.addCommandToMaps(Object.assign(new Sa.a("Select",G.a.uRa.toString()),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Sa.a("SelectTable",D.a.gLb.toString()),{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Sa.a("SelectColumn",D.a.mnd.toString()),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Sa.a("SelectRow",D.a.Dpc.toString()),{legacyControlId:"btnSelectRow"}));
this.addCommandToMaps(Object.assign(new Sa.a("TableDelete",G.a.uRa.toString()),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("PowerPointDeleteTableColumn",K.a.jid.toString()),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("PowerPointDeleteTableRow",K.a.amc.toString()),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("DeleteTable",D.a.o8.toString()),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertRowAbove",
D.a.kUa.toString()),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertRowBelow",D.a.$ta.toString()),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertColumnLeft",D.a.K8b.toString()),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertColumnRight",D.a.L8b.toString()),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(new Sa.a("ApplyTableStyleOptionAnchor",G.a.uRa.toString()));
this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableStyleOptionHeaderRow",D.a.OZ.toString()),{legacyControlId:"buttonFirstRow",queryCommandId:D.a.Una.toString(),menuItemId:"buttonFirstRow"}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableStyleOptionFirstColumn",D.a.OZ.toString()),{legacyControlId:"buttonFirstColumn",queryCommandId:D.a.Una.toString(),menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableStyleOptionTotalRow",D.a.OZ.toString()),{legacyControlId:"buttonLastRow",
queryCommandId:D.a.Una.toString(),menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableStyleOptionLastColumn",D.a.OZ.toString()),{legacyControlId:"buttonLastColumn",queryCommandId:D.a.Una.toString(),menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableStyleOptionBandedRows",D.a.OZ.toString()),{legacyControlId:"buttonBandedRow",queryCommandId:D.a.Una.toString(),menuItemId:"buttonBandedRow"}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableStyleOptionBandedColumns",
D.a.OZ.toString()),{legacyControlId:"buttonBandedColumn",queryCommandId:D.a.Una.toString(),menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Sa.a("PowerPointCellShadingMenuOpen",K.a.N5.toString()),{legacyControlId:"cellShadingColor",populationProps:new eh(K.a.Cah.toString(),!1),menuItemId:"cellShadingColor"}));this.addCommandToMaps(new Sa.a("StandardCellShadingColorPicker",K.a.N5.toString()));this.addCommandToMaps(new Sa.a("ThemeCellShadingColorPicker",K.a.N5.toString()));
this.addCommandToMaps(new Sa.a("ThemeCellShadingColorPickerMCU",K.a.N5.toString()));this.addCommandToMaps(new Sa.a("NoCellShading",K.a.NJa.toString()));this.addCommandToMaps(new Sa.a("CellShadingMoreColors",K.a.zah.toString()));this.addCommandToMaps(new Sa.a("CellShadingRecentColors",K.a.iid.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SetSizeAnchor",K.a.qrc.toString()),{queryCommandId:K.a.tJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("MergeTableCells",K.a.mergeTableCells.toString()),
{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Sa.a("SplitTableCells",K.a.splitTableCells.toString()),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Sa.a("TableAnchor",K.a.ffg.toString()));this.addCommandToMaps(Object.assign(new Sa.a("TableStyles",D.a.NZ.toString()),{legacyControlId:"fsfaMoreTableStyles",queryCommandId:D.a.FJb.toString(),populationProps:new eh(D.a.fIb.toString(),!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));
this.addCommandToMaps(new Sa.a("TableAlignmentAnchor",K.a.pah.toString()));this.addCommandToMaps(Object.assign(new Sa.a("TableCellBottomAnchoring",K.a.Y0.toString()),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:K.a.$Ja.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellCenterJustify",K.a.Dxa.toString()),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:K.a.WJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellLeftJustify",K.a.Fxa.toString()),
{legacyControlId:"btnTableCellLeftJustify",queryCommandId:K.a.XJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellMiddleAnchoring",K.a.Z0.toString()),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:K.a.aKa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellRightJustify",K.a.Hxa.toString()),{legacyControlId:"btnTableCellRightJustify",queryCommandId:K.a.ZJa.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellTopAnchoring",K.a.$0.toString()),
{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:K.a.bKa.toString()}));this.addCommandToMaps(new Sa.a("TableAlternativeText",K.a.xrb.toString()));this.addCommandToMaps(new Sa.a("DistributeRows",K.a.vPf.toString()));this.addCommandToMaps(new Sa.a("DistributeColumns",K.a.uPf.toString()));this.addCommandToMaps(new Sa.a("TableDistribute",K.a.wAh.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SetCellBorderColor",K.a.Zzh.toString()),{populationProps:new eh(K.a.S$g.toString(),!1)}));
this.addCommandToMaps(new Sa.a("CellBorderColorPickerMCU",K.a.Z0a.toString()));this.addCommandToMaps(new Sa.a("CellBorderColorPicker",K.a.Z0a.toString()));this.addCommandToMaps(new Sa.a("StandardCellBorderColorPicker",K.a.Z0a.toString()));this.addCommandToMaps(new Sa.a("CellBorderRecentColors",K.a.sah.toString()));this.addCommandToMaps(new Sa.a("CellBorderMoreColors",K.a.sZg.toString()));this.addCommandToMaps(new Sa.a("TableBorderWidthAnchor",K.a.mAh.toString()));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_1",
K.a.dza.toString()),{queryCommandId:K.a.xOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_2",K.a.dza.toString()),{queryCommandId:K.a.yOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_3",K.a.dza.toString()),{queryCommandId:K.a.zOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_4",K.a.dza.toString()),{queryCommandId:K.a.AOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_5",K.a.dza.toString()),
{queryCommandId:K.a.BOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_6",K.a.dza.toString()),{queryCommandId:K.a.COe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_7",K.a.dza.toString()),{queryCommandId:K.a.DOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_8",K.a.dza.toString()),{queryCommandId:K.a.EOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBorderWidth_9",K.a.dza.toString()),{queryCommandId:K.a.FOe.toString()}));
this.addCommandToMaps(new Sa.a("TableBorderTypeAnchor",K.a.lAh.toString()));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersNoBorder",K.a.Zoa.toString()),{queryCommandId:K.a.tOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersAllBorders",K.a.Zoa.toString()),{queryCommandId:K.a.lOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersOutsideBorders",K.a.Zoa.toString()),{queryCommandId:K.a.uOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersInsideBorders",
K.a.aAh.toString()),{queryCommandId:K.a.pOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersTopBorder",K.a.Zoa.toString()),{queryCommandId:K.a.wOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersBottomBorder",K.a.Zoa.toString()),{queryCommandId:K.a.mOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersLeftBorder",K.a.Zoa.toString()),{queryCommandId:K.a.sOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersRightBorder",
K.a.Zoa.toString()),{queryCommandId:K.a.vOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersInsideHorizontalBorder",K.a.$zh.toString()),{queryCommandId:K.a.qOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersInsideVerticalBorder",K.a.bAh.toString()),{queryCommandId:K.a.rOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersDiagonalUpBorder",K.a.Zoa.toString()),{queryCommandId:K.a.oOe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableBordersDiagonalDownBorder",
K.a.Zoa.toString()),{queryCommandId:K.a.nOe.toString()}));this.addCommandToMaps(new Sa.a("TableCellMarginAnchor",K.a.D0e.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableCellMarginNormal",K.a.xsc.toString()),{queryCommandId:K.a.Ujd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableCellMarginNone",K.a.wsc.toString()),{queryCommandId:K.a.Tjd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableCellMarginNarrow",K.a.vsc.toString()),{queryCommandId:K.a.Sjd.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("ApplyTableCellMarginWide",K.a.Asc.toString()),{queryCommandId:K.a.Vjd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TableCellMarginCustom",K.a.qrc.toString()),{queryCommandId:K.a.tJb.toString()}))}N5h(){this.Fi(Object.assign(new sg("ContextualTabs.Tables.Design.Shading"),{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));
this.Fi(Object.assign(new sg("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Layout.Properties"),{externalUxCommandIds:["AlternativeText"]}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Layout.RowColumn"),
{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.Fi(Object.assign(new sg("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));this.Fi(Object.assign(new sg("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));this.Fi(Object.assign(new sg("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));
this.Fi(Object.assign(new sg("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.Fi(Object.assign(new sg("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.Fi(Object.assign(new sg("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Designer"),{externalUxGroupId:"DesignerHome"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Ideas"),{externalUxGroupId:"Ideas"}));(this.la.cB||this.la.VW)&&this.addCommandToMaps(Object.assign(new Sa.a("ChatPPTPane",
K.a.N_b.toString()),{queryCommandId:K.a.snc.toString()}));this.Fi(Object.assign(new sg("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.Fi(Object.assign(new sg("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.Fi(Object.assign(new sg("PptRibbon.DrawingFormat.ShapeStyles"),{externalUxGroupId:"ShapeStyles"}));this.Fi(Object.assign(new sg("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));this.Fi(Object.assign(new sg("PptRibbon.Home.Delete"),
{externalUxGroupId:"Delete"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Font"),{externalUxGroupId:"Font"}));this.Fi(Object.assign(new sg("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));this.Fi(Object.assign(new sg("PptRibbon.Home.UndoRedo"),
{externalUxGroupId:"Undo"}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.Images"),{externalUxCommandIds:["Picture","OnlinePictures"]}));
this.Fi(Object.assign(new sg("PptRibbon.InsertTab.InsertHyperlink"),{externalUxCommandIds:["InsertLink"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.InsertTables"),{externalUxCommandIds:["TableAnchor"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.Media"),{externalUxCommandIds:["InsertOnlineVideo"]}));
this.Fi(Object.assign(new sg("PptRibbon.InsertTab.Symbols"),{externalUxCommandIds:["InsertSymbol"]}));this.Fi(Object.assign(new sg("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.Fi(Object.assign(new sg("PptRibbon.PictureFormat.Adjust"),{externalUxGroupId:"Adjust"}));this.Fi(Object.assign(new sg("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.Fi(Object.assign(new sg("PptRibbon.PictureFormat.Style"),{externalUxGroupId:"PictureStyles"}));
this.Fi(Object.assign(new sg("PptRibbon.Review.Comments"),{externalUxGroupId:"Comments"}));this.Fi(Object.assign(new sg("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.Fi(Object.assign(new sg("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));this.Fi(Object.assign(new sg("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.Fi(Object.assign(new sg("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));this.Fi(Object.assign(new sg("PptRibbon.SmartArt.Layouts"),
{externalUxGroupId:"SmartArtLayouts"}));this.Fi(Object.assign(new sg("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.Fi(Object.assign(new sg("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.Fi(Object.assign(new sg("PptRibbon.Transition.AllSlides"),{externalUxGroupId:"TransitionAllSlides"}));this.Fi(Object.assign(new sg("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.Fi(Object.assign(new sg("PptRibbon.Transition.Timing"),{externalUxGroupId:"TransitionTiming"}));
this.Fi(Object.assign(new sg("PptRibbon.Review.Proofing"),{externalUxGroupId:"Proofing"}));this.Fi(Object.assign(new sg("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.Fi(Object.assign(new sg("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes","ShowHideComments"]}));this.Fi(Object.assign(new sg("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.Fi(Object.assign(new sg("PptRibbon.View.Zoom"),{externalUxGroupId:"Zoom"}));this.Fi(Object.assign(new sg("PptRibbon.View.Subtitles"),
{externalUxGroupId:"Subtitles"}));this.Fi(Object.assign(new sg("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.Fi(Object.assign(new sg("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.Fi(Object.assign(new sg("PptRibbon.DrawingFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Fi(Object.assign(new sg("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Fi(Object.assign(new sg("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));
this.Fi(Object.assign(new sg("PptRibbon.DrawingFormat.FormatOptions"),{externalUxGroupId:"Properties"}));this.Fi(Object.assign(new sg("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.Fi(Object.assign(new sg("PptRibbon.Graphics.FormatOptions"),{externalUxGroupId:"Properties"}))}F4h(){this.addCommandToMaps(Object.assign(new Sa.a("PptFileMenuEmbed",K.a.pkb.toString()),{legacyControlId:"PptJewel.Share.Embed"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileMenuShare",
G.a.Tsa.toString()),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileMenuTermsOfUse",G.a.BHb.toString()),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileMenuThirdPartyNotices",G.a.WMb.toString()),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileMenuPrivacy",G.a.NIb.toString()),{legacyControlId:"PptJewel.About.Privacy"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileAboutPage",
G.a.ve.toString()),{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileHomePage",G.a.Ulc.toString()),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileAddinPage",G.a.ve.toString()),{legacyControlId:"PptJewel.Addin"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileInfoPage",G.a.ve.toString()),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileNewPage",G.a.Ulc.toString()),{legacyControlId:"PptJewel.New"}));
this.addCommandToMaps(Object.assign(new Sa.a("PptFileOpenPage",G.a.$hd.toString()),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFilePrintPage",G.a.ve.toString()),{legacyControlId:"PptJewel.Print"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileSaveAsPage",G.a.ve.toString()),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Sa.a("PptFileSharePage",G.a.ve.toString()),{legacyControlId:"PptJewel.Share"}))}M4h(){this.addCommandToMaps(new Sa.a("GroupAnchor",
K.a.nLe.toString()));this.addCommandToMaps(new Sa.a("GroupShapes",K.a.oLe.toString()));this.addCommandToMaps(new Sa.a("UngroupShapes",K.a.wLe.toString()))}J4h(){this.addCommandToMaps(new Sa.a("AudioPlay",K.a.NHc.toString()));this.addCommandToMaps(new Sa.a("AudioPause",K.a.zZb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SetAudioOptions",K.a.sph.toString()),{queryCommandId:K.a.Mmc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("PlayAcrossSlides",K.a.playAcrossSlides.toString()),
{queryCommandId:K.a.cnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("LoopUntilStopped",K.a.loopUntilStopped.toString()),{queryCommandId:K.a.Zmc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("HideDuringShow",K.a.hideDuringShow.toString()),{queryCommandId:K.a.Umc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("RewindAfterPlaying",K.a.rewindAfterPlaying.toString()),{queryCommandId:K.a.hnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("PlayInBackground",
K.a.playInBackground.toString()),{queryCommandId:K.a.dnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("NoAudioStyle",K.a.noAudioStyle.toString()),{queryCommandId:K.a.$mc.toString()}));this.addCommandToMaps(new Sa.a("SetVolume",K.a.setVolume.toString()));this.addCommandToMaps(Object.assign(new Sa.a("SetVolumeLow",K.a.xpd.toString()),{queryCommandId:K.a.lnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SetVolumeMedium",K.a.ypd.toString()),{queryCommandId:K.a.mnc.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("SetVolumeHigh",K.a.wpd.toString()),{queryCommandId:K.a.knc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SetVolumeMute",K.a.zpd.toString()),{queryCommandId:K.a.nnc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("StartAudio",K.a.Oxh.toString()),{queryCommandId:K.a.vnc.toString()}))}U4h(){this.addCommandToMaps(Object.assign(new Sa.a("GetSlideInformation",G.a.T7.toString()),{queryCommandId:K.a.BJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("OpenLanguageDialog",
K.a.Egd.toString()),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:K.a.dJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("OpenDocumentLabelPane",G.a.fJe.toString()),{queryCommandId:G.a.iJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("TextForOfficeOnlineInGallatin",G.a.T7.toString()),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Sa.a("GetEnvironmentName",G.a.T7.toString()),{legacyControlId:"EnvironmentLabel",
queryCommandId:G.a.tNe.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("GetSlideScore",G.a.T7.toString()),{legacyControlId:"SlideScoreLabel",queryCommandId:K.a.ydh.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("GetCoAuthStatus",G.a.T7.toString()),{legacyControlId:"CoauthStatusLabel",queryCommandId:K.a.Zch.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("GetDataSyncMode",G.a.T7.toString()),{legacyControlId:"DataSyncModeLabel",queryCommandId:K.a.$ch.toString()}));
this.addCommandToMaps(Object.assign(new Sa.a("GetOfflineStatus",G.a.T7.toString()),{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",queryCommandId:K.a.ndh.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowAddInCommandsLoadStatusCallout",G.a.hYe.toString()),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:G.a.YIb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("OpenFeedbackDialog",G.a.giveFeedback.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));
this.addCommandToMaps(Object.assign(new Sa.a("GiveFeedbackPane",G.a.ZKb.toString()),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));this.addCommandToMaps(Object.assign(new Sa.a("ShowHidePerfStats",K.a.yqd.toString()),{legacyControlId:"PptEditingStatusBar.PerfStats",queryCommandId:K.a.anc.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowHideNotes",K.a.lLa.toString()),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:K.a.kjd.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowEditTriPaneViewInStatusBar",
K.a.jLa.toString()),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:K.a.$Ib.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("ShowSorterViewInStatusBar",K.a.jga.toString()),{legacyControlId:"PptEditingStatusBar-SlideSorterView",queryCommandId:K.a.CJb.toString()}));this.addCommandToMaps(Object.assign(new Sa.a("SwitchToReadingMode",K.a.zkd.toString()),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Sa.a("StartSlideShowFromCurrentSlide",
K.a.Vya.toString()),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Sa.a("ZoomOut",G.a.pub.toString()));this.addCommandToMaps(Object.assign(new Sa.a("OpenZoomConfig",K.a.lJe.toString()),{legacyControlId:"PptEditingStatusBar.ZoomScale",queryCommandId:K.a.NOe.toString()}));this.addCommandToMaps(new Sa.a("ZoomIn",G.a.uyb.toString()));this.addCommandToMaps(Object.assign(new Sa.a("ZoomToFit",K.a.hvc.toString()),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}G4h(){this.addCommandToMaps(new Sa.a("AccessibleAuthoringHelp",
K.a.urf.toString()));this.addCommandToMaps(new Sa.a("AddHiddenSlideTitle",K.a.Hsf.toString()));this.addCommandToMaps(new Sa.a("AddSlideTitle",K.a.addSlideTitle.toString()));this.addCommandToMaps(new Sa.a("EditSlideTitle",K.a.editSlideTitle.toString()));this.addCommandToMaps(new Sa.a("InsertCaptions",K.a.Peg.toString()));this.addCommandToMaps(new Sa.a("InsertCaptionsSplitButton",K.a.Qeg.toString()));this.addCommandToMaps(new Sa.a("LinkText",K.a.wah.toString()));this.addCommandToMaps(new Sa.a("RemoveAllCaptions",
K.a.chh.toString()));this.addCommandToMaps(new Sa.a("SetAsSlideTitle",K.a.setAsSlideTitle.toString()));this.addCommandToMaps(new Sa.a("SlideTitle",K.a.nsf.toString()))}}Object(m.a)(gB,"PPTWebEditReactCommandDefinitionMapping",bx,[]);class Sy{}Sy.Rzh="TabId";Object(m.a)(Sy,"RibbonSQMProperties",null,[]);class nB{constructor(a){this.Ca=a;this.Ca.ya(G.a.Old,de.a.frame,Object(F.a)(this,this.Old,"reportTabSwitch"));this.Ca.ya(G.a.hkh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.jkh,de.a.frame,ld.ActionManager.Mg)}Old(a,
b,c,f,l){this.Ca.processAction(this.fhj(l[Sy.Rzh]),2);return 32}}Object(m.a)(nB,"RibbonSQMInformation",null,[1184]);class Hh{}Hh.VFc="PptRibbon.AddIns";Hh.dW="PptRibbon.Animation";Hh.design="PptRibbon.Design";Hh.aNc="PptRibbon.Developer";Hh.mVc="PptRibbon.Graphics";Hh.help="PptRibbon.Help";Hh.home="PptRibbon.Home";Hh.insert="PptRibbon.InsertTab";Hh.picture="PptRibbon.PictureFormat";Hh.review="PptRibbon.Review";Hh.shape="PptRibbon.DrawingFormat";Hh.slideShow="PptRibbon.SlideShow";Hh.smartArt="PptRibbon.SmartArt";
Hh.vAh="ContextualTabs.Tables.Design";Hh.tableLayout="ContextualTabs.Tables.Layout";Hh.j1a="PptRibbon.Transition";Hh.view="PptRibbon.View";Object(m.a)(Hh,"MLRTabIds",null,[]);class xj{}xj.VFc="AddIns";xj.dW="Animations";xj.design="Design";xj.aNc="Developer";xj.draw="Draw";xj.mVc="Graphics";xj.help="Help";xj.home="Home";xj.insert="Insert";xj.picture="FormatPicture";xj.review="Review";xj.shape="FormatShape";xj.slideShow="SlideShow";xj.smartArt="SmartArtDesign";xj.table="Table";xj.j1a="Transitions";
xj.view="View";Object(m.a)(xj,"SLRTabIds",null,[]);class pG extends nB{constructor(a){super(a)}lVk(){this.Ca.ya(G.a.Ujh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.Vjh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.Wjh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.Xjh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.Zjh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.$jh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.akh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.bkh,de.a.frame,ld.ActionManager.Mg);
this.Ca.ya(K.a.ckh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.dkh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.ekh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.fkh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.gkh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.VRe,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(K.a.ikh,de.a.frame,ld.ActionManager.Mg);this.Ca.ya(G.a.kkh,de.a.frame,ld.ActionManager.Mg)}fhj(a){let b=G.a.jkh,c="PptRibbon.Unknown";switch(a){case Hh.VFc:case xj.VFc:c=Hh.VFc;b=G.a.Ujh;
break;case Hh.dW:case xj.dW:c=Hh.dW;b=K.a.Vjh;break;case Hh.design:case xj.design:c=Hh.design;b=K.a.Wjh;break;case Hh.aNc:case xj.aNc:c=Hh.aNc;b=G.a.Xjh;break;case xj.draw:c=a;b=K.a.Yjh;break;case Hh.mVc:case xj.mVc:c=Hh.mVc;b=K.a.Zjh;break;case Hh.help:case xj.help:c=Hh.help;b=G.a.$jh;break;case Hh.home:case xj.home:c=Hh.home;b=G.a.akh;break;case Hh.insert:case xj.insert:c=Hh.insert;b=G.a.bkh;break;case Hh.picture:case xj.picture:c=Hh.picture;b=K.a.ckh;break;case Hh.review:case xj.review:c=Hh.review;
b=G.a.dkh;break;case Hh.shape:case xj.shape:c=Hh.shape;b=K.a.ekh;break;case Hh.slideShow:case xj.slideShow:c=Hh.slideShow;b=K.a.fkh;break;case Hh.smartArt:case xj.smartArt:c=Hh.smartArt;b=K.a.gkh;break;case Hh.vAh:case Hh.tableLayout:c=a;b=K.a.VRe;break;case xj.table:c=Hh.vAh;b=K.a.VRe;break;case Hh.j1a:case xj.j1a:c=Hh.j1a;b=K.a.ikh;break;case Hh.view:case xj.view:c=Hh.view,b=G.a.kkh}if(a=Tc.a.Ib)a.actionName=c,a.Nj=!0,a.Ur=!1;return b}}Object(m.a)(pG,"PPTWebEditorRibbonSQMInformation",nB,[]);var pv=
d(922);class oB{constructor(){this.bQb=null}Vzl(){this.bQb||(this.bQb=Db.a.instance.ub("Common.App.AccountSwitching.IAccountSwitching"))||ia.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}q2i(){this.Vzl();return this.bQb?this.bQb.getCustomAuthConfig():null}static ALj(){return u.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}Object(m.a)(oB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class pB{constructor(){this.Iac=this.cultureName=null}}Object(m.a)(pB,
"HeaderCultureInfo",null,[]);var Ty=d(671);class qG{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(qG,"SearchInitializationSettings",null,[]);class rG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=
null;this.isShared=!1}}Object(m.a)(rG,"DocumentTitleAppProps",null,[]);class sG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(sG,"DocumentTitleCalloutAppProps",null,[]);class tG{constructor(){this.language=this.culture=this.userID=
this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;
this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(tG,"HeaderAppProps",null,[]);class uG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(uG,"HeaderControls",null,[]);class vG{constructor(){this.command=this.label=
null}}Object(m.a)(vG,"WorkflowButtonAppProps",null,[]);var Uy;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Uy||(Uy={}));Object(m.b)("RenameDisableReason",Uy);class wG{constructor(a=""){this.WTe=this.documentTitleAppProps=this.r6e=null;this.T0h=""!==a?a:rn.a.iP}tgj(a){const b=Db.a.instance.ub("Common.IExternalUICommandDefinitionMapping").VDa(a);
if(b&&0<b.length)return b[0].externalUxCommand;ia.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}wae(){if(!this.r6e){const a=pv.a();if(a){const b=this.tgj(a.command);b&&(this.r6e=Object.assign(new vG,{command:b,label:a.label}))}}return this.r6e}v6i(){return Object.assign(new uG,{workflowButton:this.wae()})}Msk(){gb.a.get_instance().XJ(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;u.AFrameworkApplication.Ta.La(G.a.pgb,
2,a)}Tgj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}s8i(){let a=null,b=null;var c=Db.a.instance.ub("Common.IRenameProps");c?(c=c.D5f(),0!==c&&(a=this.Tgj(c),b=Uy[c])):ia.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new sG,
{breadcrumbBrandName:u.AFrameworkApplication.Eu.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.Eu.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.Eu.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.Eu.breadcrumbFolderUrl,hideDocumentTitleInput:u.AFrameworkApplication.Aa.hb.gzj,isVersionHistoryEnabled:this.gjl(),documentExtension:ha.a.fT(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.Ta.processAction(G.a.pgb,1),onMove:Object(F.a)(this,
this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:u.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}e1f(){if(!this.documentTitleAppProps){const a=u.AFrameworkApplication.Eu.Xw;this.documentTitleAppProps=Object.assign(new rG,{documentTitle:u.AFrameworkApplication.MNc?a:ha.a.XG(a),onFirstRender:Object(F.a)(this,this.Msk,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(F.a)(this,this.s8i,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}gjl(){return!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.mmg}lhl(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.mUj}Sil(){const a=!pv.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.Ubg&&(u.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||u.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));ia.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}Xzi(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});ia.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}zTk(){appChrome.getHeaderApi().then(a=>
{const b=Db.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>ki.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.w6i(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(F.a)(this,this.wae,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(F.a)(this,this.e1f,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Nsk();return null});Ty.a.O_c()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(F.a)(this,this.a6f,"getSearchInitializationSettings"))})}Nsk(){Db.a.instance.Ja("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.mpa(!1,u.AFrameworkApplication.Ta.mode)})}w6i(a){a=
ki.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}klj(){return xk.AppChromeOverrideUtilities.isEnabled?xk.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.T0h+u.AFrameworkApplication.o1+"suiteux-shell"}onFirstRender(){Db.a.instance.Ja("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.xgl.continueWith(Object(F.a)(this,this.Xzi,"continueShellServiceDataAsync"),3)});gb.a.get_instance().XJ(15)}onFullyLoaded(){gb.a.get_instance().XJ(16)}dgj(){a:{try{var a=
Ya.a.xe(u.AFrameworkApplication.lcid);if(a){var b=Object.assign(new pB,{cultureName:a.name,Iac:a.Iac});break a}}catch(c){ia.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+u.AFrameworkApplication.lcid.toString())}b=Object.assign(new pB,{cultureName:"en-us",Iac:"en"})}a=Db.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new tG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.Iac,isConsumer:!u.AFrameworkApplication.evd,
showAppLauncher:pv.f(),showMeControl:pv.e(),hideUserName:u.AFrameworkApplication.uce,defaultDocumentTitleToLeft:u.AFrameworkApplication.AMf,assetsContainerOverride:this.klj(),controls:this.v6i(),documentTitleAppProps:this.e1f(),showDocumentTitleControl:!0,showWorkflowButton:!!this.wae(),showChatControl:this.Sil(),showGoPremiumControl:pv.g(),showDiscoverPremiumButton:pv.d(),enableSearchControl:Ty.a.LTj(),onFlexPaneOpen:Object(F.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(F.a)(a,
a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.lhl(),testTraffic:u.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(F.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(F.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:u.AFrameworkApplication.mhl()});!u.AFrameworkApplication.Ylb||u.AFrameworkApplication.nZe?(b.userDisplayName=u.AFrameworkApplication.userName,b.emailAddress=u.AFrameworkApplication.fa.Ga("UserPrincipalName"),
b.userID=u.AFrameworkApplication.fa.Ga("Puid")||"",b.signOutLink=u.AFrameworkApplication.nZe):u.AFrameworkApplication.signInUrl&&(b.signInLink=u.AFrameworkApplication.signInUrl);Ty.a.O_c()&&(a=this.a6f(),b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=u.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);oB.ALj()&&(a=new oB,b.shellAuthProviderConfigPromise=Object(F.a)(a,a.q2i,"getAccountSwitchingConfig"));
this.zTk();return b}a6f(){if(!this.WTe){const a=new Ty.a;let b=u.AFrameworkApplication.fa.Ga("Microsoft365Ring");b&&b.length||(b="generalAudience");this.WTe=Object.assign(new qG,{loadTellMeResources:a.z0j(),getTokenRequestDictionary:Object(F.a)(a,a.Dmj,"getTokenRequestDict"),userRing:b})}return this.WTe}}Object(m.a)(wG,"ReactSharedHeaderPropsHelper",null,[1101]);var Cg=d(346),TP=d(1226),UP=d(1075);d(923);var xG=d(670);const Vt=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},yG=(a,b,c,f)=>{if(a&&
a.parentNode&&a.parentNode.parentNode){var l=(l=Ef.a.Vt(a))?Ca.a.uM(l.paddingLeft)+Ca.a.uM(l.paddingRight):0;var x=Ef.a.Vt(a.parentNode);x=x?Ca.a.uM(x.paddingLeft)+Ca.a.uM(x.paddingRight):0;let H=0,U=a;for(;U.nextSibling;)U=U.nextSibling,H+=U.offsetWidth;l=l+x+H;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");x=f?c:b;c=f?b:c;f=Od.a.$h(a.parentNode.parentNode);b=x?Od.a.$h(x):new Sys.UI.Bounds(f.x,0,0,0);c=c?Od.a.A9a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===
a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=Od.a.$h(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Vy=a=>{a&&$q(a)&&(a.style.display="",a._isHidden="0")},ml=a=>{a&&!$q(a)&&(a.style.display="none",a._isHidden="1")},$q=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},Is=(a,b,c)=>{if(a&&!$q(a)){var f=Ef.a.Vt(a);f=Ca.a.uM(f.paddingLeft)+Ca.a.uM(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=
Ef.a.Vt(b))&&(l+=Ca.a.uM(f.paddingLeft)+Ca.a.uM(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},Qr=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},VP=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,top:l}=Od.a.l1f(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},rq=(a,b,c)=>!a||!b||$q(a)||$q(b)?!1:Od.a.hpg(Od.a.$h(a),Od.a.$h(b),c),Js=(a,b,c)=>{let f=0;a&&b&&(f=Od.a.Cne(Od.a.$h(a),Od.a.$h(b),c));return f};var Rr=d(364);class Wy{constructor(a,
b,c){this.$ub=this.i3b=this.Zub=this.n8a=this.hOc=this.h3b=this.TG=this.g3b=this.JRa=this.mQ=this.iOc=this.IRa=this.Tca=this.vv=this.eL=this.$S=this.HRa=this.m8a=this.l8a=this.rDa=null;this.fS=a;this.XRb=b;this.Vi=c}N5k(a){this.fS=a;this.XRb=null;this.H3d(this.fS);this.kFh();this.Fnh()}I_a(){this.fS&&this.XRb&&this.XRb.clientHeight&&(this.H3d(this.fS),this.kFh(),this.Fnh(),-1!==this.XRb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.fWf(this.XRb),this.WAl(),this.R5k()))}H3d(a){if(a)for(let c=
0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=Ca.a.Yja(f),x=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.rDa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.l8a=f;else if(f.id===ym.CuiHelper.GSd)this.m8a=f;else if(f.id===ym.CuiHelper.uXf)this.HRa=f;else if(f.id===ym.CuiHelper.HSd)this.$S=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.eL=f;else if(f.id===ym.CuiHelper.ISd)this.vv=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.Tca=f;else{var b;if(b=x)b=f,b=!!b.id&&
(b.id.startsWith(ym.CuiHelper.dXe)||b.id.startsWith(ym.CuiHelper.Mld));b?this.IRa=f:x&&f.id.startsWith(ym.CuiHelper.rnl)?this.iOc=f:-1!==l.indexOf("UsernameNameContainer")?this.mQ=f:-1!==l.indexOf("UsernameNameItem")&&(this.JRa=f)}this.H3d(f)}}kFh(){var a=[this.eL,this.vv,this.mQ],b=[this.l8a,this.m8a,this.HRa,this.$S,this.eL,this.vv,this.Tca,this.IRa,this.iOc,this.mQ];for(const c of b)Vy(c);for(const c of a)Qr(c);if(a=this.eL)a.style.position="static",a.style.left="auto"}Fnh(){this.UWd()?this.P5k():
this.Q5k();var a=this.HRa,b=this.$S;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}P5k(){let a;const b=this.a7d();a=[()=>{Is(this.$S,this.$S,Js(this.rDa,b,this.Vi))},()=>{ml(this.l8a);ml(this.m8a);ml(this.HRa);ml(this.$S)}];Vt(a,()=>rq(this.$S,b,this.Vi));rq(this.TG,this.eL,this.Vi)&&VP(this.eL,this.TG,this.Vi);this.hlh();a=[()=>{Is(this.mQ,this.JRa,Js(this.TG,this.Tca,this.Vi))},()=>{ml(this.IRa)}];this.ilh();$q(this.eL)||$q(this.vv)||yG(this.vv,this.TG,this.Tca,this.Vi)}Q5k(){const a=
!!this.$S,b=!!this.vv;let c=0;if((a||b)&&0<(c=Js(this.rDa,this.eL,this.Vi))){let f=a;b&&(!a||this.vv.offsetWidth>this.$S.offsetWidth)&&(f=!1);Is(f?this.$S:this.vv,f?this.$S:this.vv,f?c:2*c);a&&b&&0<(c=Js(this.rDa,this.eL,this.Vi))&&(f=!f,Is(f?this.$S:this.vv,f?this.$S:this.vv,f?c:2*c))}Vt([()=>{ml(this.l8a);ml(this.m8a);ml(this.HRa);ml(this.$S);Qr(this.vv)},()=>{Is(this.vv,this.vv,2*Js(this.rDa,this.eL,this.Vi))},()=>{ml(this.vv)}],()=>rq(this.rDa,this.eL,this.Vi));this.hlh();this.ilh();$q(this.eL)||
$q(this.vv)||yG(this.vv,this.rDa,this.Tca,this.Vi)}hlh(){const a=$q(this.vv);Vt([()=>{this.zSe()},()=>{ml(this.IRa);Qr(this.vv);Qr(this.mQ);a||Vy(this.vv)},()=>{this.zSe()},()=>{ml(this.iOc);Qr(this.vv);Qr(this.mQ);a||Vy(this.vv)},()=>{this.zSe()}],()=>rq(this.eL,this.Tca,this.Vi))}zSe(){const a=!!this.vv,b=!!this.mQ;let c=0;if((a||b)&&0<(c=Js(this.eL,this.Tca,this.Vi))){const f=!!this.eL&&"absolute"!==this.eL.style.position;let l=a;b&&(!a||this.mQ.offsetWidth>this.vv.offsetWidth)&&(l=!1);Is(l?this.vv:
this.mQ,l?this.vv:this.JRa,l&&f?2*c:c);a&&b?(0<(c=Js(this.eL,this.Tca,this.Vi))&&(l=!l,Is(l?this.vv:this.mQ,l?this.vv:this.JRa,l&&f?2*c:c)),rq(this.eL,this.Tca,this.Vi)&&(ml(this.eL),Qr(this.mQ))):a&&rq(this.eL,this.Tca,this.Vi)&&ml(this.vv)}}ilh(){const a=()=>{Is(this.mQ,this.JRa,Js(this.rDa,this.Tca,this.Vi))};Vt([a,()=>{ml(this.IRa);Qr(this.mQ)},a,()=>{ml(this.iOc);Qr(this.mQ)},a,()=>{ml(this.mQ)}],()=>rq(this.rDa,this.Tca,this.Vi))}UWd(){if(!this.TG)return!1;for(let a=0;a<this.TG.childNodes.length;a++)if(-1!==
Ca.a.Yja(this.TG.childNodes[a]).indexOf("cui-cg"))return!0;return!1}a7d(){if(!this.TG)return null;let a=null;for(let b=this.TG.childNodes.length-1;0<=b;b--){const c=this.TG.childNodes[b];if(-1===Ca.a.Yja(c).indexOf("cui-cg"))break;a=c}return a}fWf(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=Ca.a.Yja(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.g3b=c:-1!==f.indexOf("cui-tts")?this.TG=c:-1!==f.indexOf("cui-TabRowInline")?this.h3b=c:-1!==f.indexOf("cui-separator")?
this.hOc=c:l&&c.id.startsWith(ym.CuiHelper.y7g)?this.n8a=c:l&&c.id.startsWith(ym.CuiHelper.bVf)?this.Zub=c:-1!==f.indexOf("cui-TabRowRight")?this.i3b=c:l&&c.id.startsWith(ym.CuiHelper.lKe)&&(this.$ub=c);this.fWf(c)}}WAl(){var a=[this.TG,this.h3b,this.hOc,this.n8a,this.Zub,this.i3b,this.$ub];for(const b of a)Vy(b);this.kMb(0)}R5k(){let a;a=[()=>{ml(this.hOc);ml(this.n8a)},()=>{this.kMb(1)},()=>{this.kMb(2)},()=>{ml(this.h3b);this.kMb(0)}];Vt(a,()=>rq(this.TG,this.h3b,this.Vi));a=[()=>{ml(this.hOc);
ml(this.n8a)},()=>{ml(this.Zub)},()=>{ml(this.$ub)},()=>{ml(this.i3b)}];Vt(a,()=>rq(this.h3b,this.i3b,this.Vi)||rq(this.TG,this.i3b,this.Vi));a=[()=>{this.kMb(1)},()=>{this.kMb(2)},()=>{ml(this.TG)}];Vt(a,()=>rq(this.g3b,this.TG,this.Vi))}kMb(a){this.TG&&(this.TG.className=Wy.xsl[a],this.TG._scaleStep=a)}}Wy.xsl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(m.a)(Wy,"TopBarScalingManager",null,[]);class zG{constructor(a,b){this.fS=this.xAa=null;this._clientId=a;this.Amf=b}KSi(){if(!Vk.b(this.fS))return this.fS;
this.ORi();this.fS.style.display="block";this.Amf&&this.Amf.mca(Object(F.a)(this,this.onResize,"onResize"));return this.fS}onResize(){this.I_a()}I_a(){this.jRi()?(document.getElementById("application").style.minWidth="0px",(new Wy(this.fS,null,u.AFrameworkApplication.isRtl)).N5k(this.fS)):u.AFrameworkApplication.Aa.hb.$N||xG.a.O5k(this.fS,u.AFrameworkApplication.isRtl)}jRi(){return u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}ORi(){if(Vk.b(this.xAa)){var a;
({T7b:a}=Rr.a.NOb(!u.AFrameworkApplication.CQ)).returnValue&&(this.xAa=DA("div"),this.xAa.className=Rr.a.rUi,this.xAa.id=ym.CuiHelper.p2d,a.appendChild(this.xAa),this.FRi(),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.YUa&&!u.AFrameworkApplication.CQ&&this.IRi(),this.JSi())}}JSi(){Vk.b(this.fS)&&(this.fS=DA("div"),this.fS.className=Rr.a.ywl,this.fS.style.display="none",this.xAa.appendChild(this.fS))}FRi(){Sys.UI.DomElement.addCssClass(this.xAa,Rr.a.sUi);if(u.AFrameworkApplication.isRtl){var a=
this.xAa;if(!Vk.b(a)){var b=a.className;if(Vk.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}IRi(){Sys.UI.DomElement.addCssClass(this.xAa,"FlexBoxLayout")}}Object(m.a)(zG,"HeaderSkeleton",null,[]);var WP=d(1251),qB=d(1202);class rB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(rB,"CommandDefinition",null,[]);class AG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=
null}}Object(m.a)(AG,"CommandDefinitionMapping",null,[]);const XP=a=>Object.assign(new AG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new rB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new rB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(G.a.ve),addCommandToMaps:Object(F.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(F.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(F.a)(a,
a.addTabToMap,"addTabToMap")});var BG=d(936);class CG{}Object(m.a)(CG,"RibbonInitState",null,[]);var YP=d(398),DG=d(512);let Ks;class qp{static oyl(a){u.AFrameworkApplication.Aa.hb.dhg||(a.ShowCommentsTopBar=!0);u.AFrameworkApplication.Aa.hb.Sgg||(a.CatchUpWithChanges=!0)}static hDh(a){for(let b of qp.BSh)a[b]=!0}static pGl(a,b){var c=u.AFrameworkApplication.g8b;if(u.AFrameworkApplication.fa.Cu(c)&&u.AFrameworkApplication.fa.Ga(c)){qp.hDh(b);c=u.AFrameworkApplication.fa.WA("HostDefinedUIControls");
for(let f=0;f<c.length;f++)qp.qGl(a,b,c[f]);qp.jyl(b);qp.iyl(b)}}static qGl(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static jyl(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static Iua(){const a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.eK);return!!a&&"teams"===a.toLowerCase()}static Xil(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",
!1)}static zjl(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static iyl(a){qp.Iua()&&(qp.Xil()&&(a.HostOpenInClient=!1),qp.zjl()&&(a.HostMoreOptions=!0))}}qp.BSh=(Ks=new Ka.a,Ks.add("HostOpenInClient"),Ks.add("HostConversation"),Ks.add("HostClose"),Ks.add("HostDownload"),Ks.add("HostOpenInBrowser"),Ks.add("HostMoreOptions"),
Ks);Object(m.a)(qp,"CommandTrimmer",null,[]);class EG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(m.a)(EG,"ReactAsyncDispatcher",null,[]);class sB{}sB.Zkc="PageId";Object(m.a)(sB,"FileMenuSQMProperties",null,[]);class FG{constructor(a,b){this.vq=null;this.PCc=!1;this.mOa=0;this.Jgf="";this.iyd={};this.gGd=a;this.Nd=b;this.$jf=Object(F.a)(this,this.cIe,"onModalMouseWheel");this.Tff=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.o9;this.u2=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.yua}fHb(){0<this.mOa?this.mOa++:(this.mOa++,u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(F.a)(this,this.Tch,"pushTransientFocusScope"),0)}):this.Tch(),this.showModal())}Tch(){this.Nd&&this.Nd.HU(E.AFrame.ZO,!0)}r4i(){const a=Pg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.Tff&&b.isActive&&1===b.state?"_ShyRibbon":
"")}Jmj(a){var b=0;if(this.u2){if(this.iyd[a])return this.iyd[a];(b=document.getElementById("BusinessBar"))||ia.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.iyd[a]=b}return b}showModal(){if(!this.vq)if(this.vq=this.createElement("div"),this.vq.setAttribute("id","ReactModalDiv"),this.vq.style.position="absolute",this.vq.style.bottom="0px",this.vq.style.left="0px",this.vq.style.right="0px",this.vq.style.backgroundColor=
"white",this.vq.style.opacity="0.0",this.u2){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.vq)}else this.gGd.appendChild(this.vq);a=this.r4i();if(a!==this.Jgf){const b=this.Jmj(a),c=appChrome.selectors.getShyState();this.Tff&&c.isActive&&1===c.state&&Pg.a("getRibbonHeight")?this.vq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Pg.f())):this.vq.style.top=String.format("{0}px",b);this.Jgf=a}this.vq.style.display="block";this.vq.style.visibility="visible";
this.vq.style.zIndex="1000";this.PCc||(window.addEventListener("wheel",this.$jf,!0),this.TZc()?Yd.a.instance.pb(ta.a.CR,this.vq,Object(F.a)(this,this.vfd,"onModalPointerUp")):Yd.a.instance.pb(ta.a.pointerDown,this.vq,Object(F.a)(this,this.ufd,"onModalPointerDown")),this.PCc=!0)}Wuk(){this.mOa--;0<this.mOa||(0>this.mOa?this.mOa=0:this.dcg())}WGe(){this.mOa=0;this.J_d();this.dcg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}ccg(){this.Nd&&this.Nd.Ae&&this.Nd.Ae.name===
E.AFrame.ZO&&!u.AFrameworkApplication.ye.tw&&this.Nd.X0(E.AFrame.ZO,!1);this.vq&&(this.vq.style.zIndex="-1",this.vq.style.visibility="hidden",this.vq.style.display="none");this.PCc&&(window.removeEventListener("wheel",this.$jf,!0),this.TZc()?Yd.a.instance.yb(ta.a.CR,this.vq,Object(F.a)(this,this.vfd,"onModalPointerUp")):Yd.a.instance.yb(ta.a.pointerDown,this.vq,Object(F.a)(this,this.ufd,"onModalPointerDown")),this.PCc=!1)}dcg(){this.TZc()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.ccg()},
0)}):this.ccg()}ufd(){this.u2b();this.$Of();this.WGe();this.TKa();return!0}vfd(){this.u2b();this.$Of();this.WGe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.TKa()},0)});return!0}TKa(){4===u.AFrameworkApplication.Aa.hb.Uk&&u.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?u.AFrameworkApplication.Aa.TKa():this.Nd.tf(E.AFrame.yW)}cIe(a){a.stopPropagation()}u2b(){const a=Db.a.instance.ub("Common.IReactContextualUILauncher");a&&a.u2b()}J_d(){const a=Db.a.instance.ub("Common.IReactContextualUILauncher");
a&&a.J_d()}$Of(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.EFa&&(this.TZc()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}TZc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(m.a)(FG,"ReactModalDiv",null,[]);var Zm=d(533);class GG{constructor(a,b){this.y0h=a;this.NOh=b}}Object(m.a)(GG,"ReactExecuteCommandContext",null,[]);class qv{}
qv.Color="Color";qv.IndexColorSelected="ColorSelected";Object(m.a)(qv,"ColorPickerCommandProperties",null,[]);var eo=d(930);class fo{}fo.SelectedFont="SelectedFont";fo.Formatting="Format";fo.RequestUpdateMru="RequestUpdateMru";fo.FontPickerId="fontPickerId";fo.IsPinned="IsPinned";fo.Trigger="Trigger";Object(m.a)(fo,"FontPickerCommandProperties",null,[]);class Vo{}Vo.Trigger="FontTrigger";Vo.Name="FontName";Vo.Action="FontAction";Vo.Level="FontLevel";Vo.IsPinned="FontIsPinned";Object(m.a)(Vo,"FontPickerLogProperties",
null,[]);class cx{}cx.Rows="Rows";cx.Columns="Columns";Object(m.a)(cx,"InsertTableCommandProperties",null,[]);class $m{}$m.Alt="Alt";$m.Number="Number";$m.UnitType="UnitType";$m.Text="Text";$m.MaxValue="MaxValue";Object(m.a)($m,"SpinnerCommandProperties",null,[]);class HG{constructor(a,b,c,f,l,x,H,U,ja,ya=null,Va=null){this.a4a=null;this.mof=!1;this.zAd=[];this.jxc=-1;this.wEc=!1;this.h1h=0;this.bRb=null;this.xlf=!1;this.JP=a;this.OOa=b;this.GJd=Object(oa.a)(1528,a);this.gm=c;this.Nd=f;l&&(this.a4a=
new FG(l,f));this.UZh=x;this.mRh=H;this.vS=ya;this.Ca=U;this.O3a={};this.$a=ja;this.e7e=Va;ja&&(ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ja.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&Ci.a.instance.gwf.CWR(()=>this.mof=!0);ja&&(a=this.$a.Ga("CommandControlIdPairsForLoggingOverride")||"")&&0<=a.trim().length&&({rv:this.bRb}=xd.d(a));this.bRb||(this.bRb={})}get Ond(){return!!window.appChrome&&!!appChrome.selectors}Mnh(){-1!==this.jxc&&window.clearTimeout(this.jxc);
this.jxc=window.setTimeout(()=>{for(this.jxc=-1;0<this.zAd.length;){if(gm.a.instance.tw){this.Mnh();break}const a=this.zAd.shift();a&&this.executeCommand(a.y0h,a.NOh)}},0)}executeCommand(a,b){if(gm.a.instance.tw){if(this.mof){this.zAd.push(new GG(a,b));this.Mnh();return}ia.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",a,b.modelType,
pa.a.toJSON(b.payload));if(this.$a.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.gm.getCommandByExternalUxId(a),f=b.modelType;this.e7e&&this.e7e.F1j(a,b);c?this.xTi(a,c,f,b):this.yTi(a,f,b);this.gri(b);this.Djk(a,b)}}yTi(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.oTf(c,a);break;case "ButtonModel":this.uTi(c,a)}}KEl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=
b.menuItemId;a.CommandValueId=c.payload.commandValueId;a.TerminalParentControlId=c.payload.terminalParentControlId;this.i7a();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}LEl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=
this.gm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":a=this.gm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.i7a();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}xTi(a,
b,c,f){var l=this.AFk(f,c),x=b.commandId;const H={},U={};switch(c){case "SplitButtonModel":if(this.p7b(f.payload,Object(F.a)(this,this.NFl,"updateSplitButtonMenuState"),l))return;H.MenuItemId=b.menuItemId;this.wWe(f,H);break;case "StatefulSplitButtonModel":if(this.p7b(f.payload,Object(F.a)(this,this.RFl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?H.Color=c:"icon"===l&&(c=this.gm.getCommandByExternalUxId(c))&&(H.MenuItemId=c.menuItemId);
break;case "FileMenu":H.MenuItemId=b.menuItemId;H.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.jsj(x,f.payload,a);break;case "TellMe":x=this.LEl(x,f,H);H.SourceControlId=a;H.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.Ewj(H,f):x=this.KEl(H,b,f,a,x);break;case "CompoundButtonModel":H.MenuItemId=b.menuItemId;H.CommandValueId=f.payload.commandValueId;H.SourceControlId=a;this.wWe(f,H);this.i7a();break;case "ToggleButtonModel":case "InkButtonModel":H.MenuItemId=
b.menuItemId;H.SourceControlId=a;this.wWe(f,H);this.i7a();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":x=this.gm.getCommandByExternalUxId("FontPickerMenuClose").commandId;H[fo.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=da.FontUtils.eG(c),H.CommandValueId=l,l=da.FontUtils.MLc(l)):(c.data?(H.CommandValueId=c.data.fontToApply,H.MenuItemId=c.data.themeIndex,H[fo.Formatting]=
c.data):H.CommandValueId=c.name,l=c);H.SourceControlId=a;H[fo.RequestUpdateMru]=l;U[Vo.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?da.FontUtils.FYc(c)?"*"+c:da.FontUtils.rje(c)?"[EF]":"[MF]":"";U[Vo.IsPinned]=f.payload.isPinned;U[Vo.Level]=f.payload.level;this.noe();break;case "FontPickerFontInfoRequestedPayload":H.CommandValueId=f.payload.font.name;H[fo.Trigger]=f.payload.trigger;U[Vo.Trigger]=f.payload.trigger;U[Vo.Name]=f.payload.nameToLog;this.noe();break;case "FontPickerFontPinningPayload":c=
f.payload.isPinned;H.CommandValueId=f.payload.fontKey;H[fo.IsPinned]=c;U[Vo.Name]=f.payload.nameToLog;U[Vo.Action]=c?"pin":"unpin";U[Vo.Level]=f.payload.level;this.noe();break;default:return}break;case "ComboBoxModel":var ja=f.payload.type;switch(ja){case "MenuOpenPayload":case "MenuPopulatePayload":this.IMb(f.payload.launcherId,l)&&(x={},x[f.payload.launcherId]=c,this.OOa.Klc(x,Pg.g(f.payload)),this.O3a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=
f.payload.newValue;if(!c)return;c.value?(H[eo.a.Value]=c.value,H[eo.a.IsFreeForm]=!0):(H[eo.a.Value]=c.text,H.MenuItemId=c.key,H.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===ja&&(x=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":x=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=pa.a.lL(f.payload);for(ja of c)H[ja]=f.payload[ja];break;default:this.p7b(f.payload,Object(F.a)(this,this.DDl,
"updateFlyoutAnchorMenuState"),l),H.launcherId=f.payload.launcherId}break;case "InkFlyoutAnchorModel":this.p7b(f.payload,Object(F.a)(this,this.XDl,"updateInkFlyoutAnchorMenuState"),l);H.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":H[qv.Color]=f.payload.selectedColorId;break;case "ColorPickerPreviewPayload":x=b.commandPreviewId;H[qv.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":x=b.commandRevertId;break;
default:return}break;case "SpinButtonModel":H[$m.Number]=f.payload.value;H[$m.UnitType]=ye.a.V0b(f.payload.unitType.toLowerCase());H[$m.Text]=f.payload.reservedValue;break;case "SliderModel":H[Uo.Value]=f.payload.value;break;case "InsertTableModel":H[cx.Rows]=f.payload.rows;H[cx.Columns]=f.payload.columns;break;case "CheckboxModel":H[Sh.a.On]=f.payload.checked;H.MenuItemId=b.menuItemId;H.TerminalParentControlId=f.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.p7b(f.payload,
Object(F.a)(this,this.VEl,"updatePreviewGalleryMenuState"),l)){H.launcherId=f.payload.launcherId;break}this.oTf(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":H.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":x={};x[f.payload.launcherId]=c;this.OOa.Klc(x,Pg.g(f.payload));this.O3a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":H.MenuItemId=f.payload.url;this.l2j(f.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":H.MenuItemId=f.payload.assetId;H.SourceControlId=a;u.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(H.IsPremium=f.payload.isPremium||!1);this.m2j(f.payload.pageId);break;case "CoauthorGallery":H.RenderTime=f.triggerTime;break;case "PeopleWell":H.RenderTime=f.triggerTime;break;case "SyncStatus":H.SourceControlId=a;break;case "InputBoxModel":H.Text=f.payload.newValue;break;case "PersonaButtonModel":H.CommandValueId=
f.payload.commandValueId;this.luj(f.payload);break;case "AddInListModel":H.AddInControlId=f.payload.parentControl;H.Href=f.payload.href;H.Type=f.payload.type;break;default:return}x&&!this.isShadowMenuOpen(f.payload)&&(H.CommandValueId||(H.CommandValueId=H.MenuItemId),b.legacyControlId&&(H.LegacyId=b.legacyControlId),H.SourceControlId||(H.SqmControlId=a),this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&H.launcherId&&(b=this.gm.getCommandByExternalUxId(H.launcherId))&&
(H.launcherCommandId=parseInt(b.commandId)),f.payload&&!Vk.b(f.payload.PRIReadinessCheck)&&(H.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.xlf=!0),f.payload&&!Vk.b(f.payload.shouldTakeFocus)&&(H[Zm.a.Haa]=f.payload.shouldTakeFocus),b=this.COd(f,H),Vk.b(f.triggerTime)||(U.TriggerTime=f.triggerTime),f.payload&&!Vk.b(f.payload.userActionKey)&&(U.userActionKey=f.payload.userActionKey),this.dVe(U,f,a,x),this.GJd.executeCommand(x,H,this.getSelectedTabId(),b,!0,()=>{this.HEe(H,a)},U,Pg.g(f.payload)))}dVe(a,
b,c,f){this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&(c=b.payload&&!Vk.b(b.payload.launcherId)?b.payload.launcherId:c,a.ControlId=this.gnh(this.Tdj(c,f),f,!1));this.$a&&this.$a.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.gnh(b.payload.terminalParentControlId,f,!0))}gnh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;ia.ULS.sendTraceTag(510247689,
207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}Tdj(a,b){b=parseInt(b);b=ld.ActionManager.OVd(b)||ld.ActionManager.R5a(b)||"";return!Vk.b(b)&&b in this.bRb?this.bRb[b]:100<a.length?"":a}noe(){this.vS&&this.vS.execute(a=>{a.eoe("ModernFontPickerExperience")})}COd(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=
a.payload.inputMethod,b[Zm.a.Hu]=c);return c}HEe(a,b){const c=Object(oa.a)(E.AFrame,u.AFrameworkApplication.Aa);if(this.Nd&&this.Zth(a)){if(!this.Nd.Ae&&c){let f="null";if(a){const l=a.Value;delete a.Value;f=pa.a.toJSON(a);Vk.b(l)||(a.Value=l)}ia.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",b,f,c.EKa)}this.Nd.lXf()}(this.Nd&&this.Nd.Ae&&this.Nd.Ae.name!==E.AFrame.ZO&&
c&&this.Nd.Ae.name!==c.EKa||this.Zth(a))&&this.gvi(a)}Zth(a){return!!a&&!Vk.b(a[Zm.a.Haa])&&a[Zm.a.Haa]}gvi(a){Zm.a.Hu in a&&1===a[Zm.a.Hu]&&ax.ShyRibbon.vQa(1,0)}Ewj(a,b){Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.i7a();this.JP.Jlc();if(this.UZh&&this.Ca){const c={};c[Sy.Rzh]=b.payload.tabId;this.Ca.La(G.a.Old,2,c,this.J6b(b));Vk.b(b.payload.inputMethod)||(this.Ca.processAction(G.a.hkh,2),this.wEc||this.Fml(b.payload.tabId))}b=
b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.gm.F$d(b);ia.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.vS&&b){const c=b+"TabSwitchActivity";this.vS.execute(f=>{f.eoe(c)})}}p7b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}luj(a){a=a.type;"MenuOpenPayload"===a?u.AFrameworkApplication.szh=!0:"MenuClosePayload"===a&&(u.AFrameworkApplication.szh=!1)}AFk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&
"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.gm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.OOa.VKe(f,b,a.payload))&&c in this.O3a&&delete this.O3a[c],a):!1}DDl(a,b){const c=a.launcherId;this.IMb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.jPb(b,c,Pg.g(a)))}XDl(a,b){const c=a.launcherId;this.IMb(c,b)&&(b=Pg.j("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),
this.jPb(b,c,Pg.g(a)))}VEl(a,b){const c=a.launcherId;this.IMb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.jPb(b,c,Pg.g(a)))}NFl(a,b){const c=a.launcherId;this.IMb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.jPb(b,c,Pg.g(a)))}RFl(a,b){const c=a.launcherId;this.IMb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.jPb(b,c,Pg.g(a)))}getSelectedTabId(){return this.Ond?appChrome.selectors.getSelectedTabId():null}jPb(a,b,c){this.OOa.Klc(a,c);this.O3a[b]=
new Date}IMb(a,b){let c=!0;a in this.O3a&&(c=this.O3a[a].getTime()<this.JP.p1c.getTime());return c&&!b&&this.Ond}oTf(a,b){const c={};var f=a.payload.selectedGalleryId;const l=this.gm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!Vk.b(a.payload.shouldTakeFocus)&&(c[Zm.a.Haa]=a.payload.shouldTakeFocus);this.Sej(a.payload,c);(f=this.J6b(a))||(f={});this.dVe(f,a,b,l.commandId);const x=this.COd(a,
c);this.GJd.executeCommand(l.commandId,c,this.getSelectedTabId(),x,!0,()=>{this.HEe(c,b)},f,Pg.g(a.payload))}}uTi(a,b){const c=this.gm.getCommandByExternalUxId(b);if(c){const f={};f.SourceControlId=b;f.MenuItemId=b;f.SqmControlId=b;a.payload&&!Vk.b(a.payload.shouldTakeFocus)&&(f[Zm.a.Haa]=a.payload.shouldTakeFocus);let l=this.J6b(a);l||(l={});this.dVe(l,a,b,c.commandId);const x=this.COd(a,f);this.GJd.executeCommand(c.commandId,f,this.getSelectedTabId(),x,!1,()=>{this.HEe(f,b)},l,Pg.g(a.payload))}}Sej(a,
b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=a.character)}wWe(a,b){a.payload&&"toggled"in a.payload&&(b[Sh.a.On]=a.payload.toggled)}Djk(a,b){"MenuOpen"===a?!this.a4a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.a4a.fHb():"MenuClose"===a&&this.a4a&&this.a4a.Wuk()}i7a(){this.a4a&&this.a4a.WGe()}J6b(a){let b=null;Vk.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}jsj(a,b,c){if(this.mRh&&this.Ca){const f={};f[sB.Zkc]=c;this.Ca.La(G.a.A0k,2,f)}this.jPb(b.pageControlIdMap,
a,Pg.g(b))}m2j(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.P0k,2);break;case "FileNewPage":this.Ca.processAction(G.a.Q0k,2)}}l2j(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(G.a.I0k,2);break;case "FileOpenPage":this.Ca.processAction(G.a.J0k,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}Fml(a){if(u.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.vS.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",
null)}),this.wEc=!0;else{if(u.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.vS.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.h1h)){this.wEc=!0;return}u.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(G.a.ukb,2)&&(this.wEc=!0)}}gri(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.xlf&&appChrome.PRIToastManager.dismissToast()}}Object(m.a)(HG,"ReactExecuteCommandHandler",null,[]);
class IG{constructor(){this.fileMenu=null}get p5e(){return 0}I_a(){}xsa(){return!1}P1(){return!1}get soh(){return null}b6(){}Xie(){return!1}eQa(){}PRa(){}refresh(){}get controls(){return null}wKc(){}Jlc(){}get xaa(){return null}set xaa(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(m.a)(IG,"ReactRibbonExternal",null,[1181,1516,1517]);var ZP=d(271);class JG{constructor(a,b,c,f){this.Nd=a;this.Ca=b;this.Wqf=c;this.Npb=f}initialize(){this.Ca.ya(G.a.cpc,de.a.frame,Object(F.a)(this,
this.Klh,"ribbonMoveForwardAction"));this.Ca.ya(G.a.bpc,de.a.frame,Object(F.a)(this,this.Jlh,"ribbonMoveBackwardAction"));this.Ca.ya(G.a.umd,de.a.frame,Object(F.a)(this,this.Ilh,"ribbonEscAction"));var a=Rr.a.eee(this.Npb,null,this.Wqf,!1);a.bJ=!0;this.OJb(a,G.a.cpc,G.a.bpc);a.bindAction(y.KeyInputManager.Oa(A.a.T1,0),G.a.umd);a=this.Nd.Fc(E.AFrame.ZO);a.bJ=!0;this.OJb(a,G.a.Asa,G.a.Asa);qa.a.instance.pb(ta.a.mouseDown,this.Wqf,Object(F.a)(this,this.Vwk,"onRibbonMouseDown"));a=ZP.a.instance;Pg.a("enterKeytipMode")&&
a.VLb(this.Npb,()=>{appChrome.api.enterKeytipMode(!1)});Pg.a("exitKeytipMode")&&a.bqc(this.Npb,()=>{appChrome.api.exitKeytipMode();ax.ShyRibbon.vQa(1,0)});u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.o9&&(a=Object(oa.a)(v.FocusManager,this.Nd))&&a.g$h(Object(F.a)(this,this.ntk,"onFocusScopeChanged"))}ntk(a,b){if((a=Object(oa.a)(E.AFrame,u.AFrameworkApplication.Aa))&&b.E_g&&u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.o9){const c=appChrome.selectors.getShyState();c.isActive&&
b.E_g.name===a.EKa&&ax.ShyRibbon.vQa(c.state,1)}}Klh(){return 4}Jlh(){return 4}Ilh(){Pg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.o9&&appChrome.selectors.getShyState().isActive&&ax.ShyRibbon.vQa(1,0),this.Nd.tf(E.AFrame.yW));return 4}OJb(a,b,c){const f=y.KeyInputManager.Oa(A.a.Sq,0),l=y.KeyInputManager.Oa(A.a.Sq,4);a.zp(f);a.zp(l);a.bindAction(f,b);a.bindAction(l,c)}Vwk(a){a.qc&&a.qc.target&&"input"!==a.qc.target.tagName.toLowerCase()&&
a.qc.preventDefault();return!1}dispose(){this.Ca.PJ(G.a.cpc,de.a.frame,Object(F.a)(this,this.Klh,"ribbonMoveForwardAction"));this.Ca.PJ(G.a.bpc,de.a.frame,Object(F.a)(this,this.Jlh,"ribbonMoveBackwardAction"));this.Ca.PJ(G.a.umd,de.a.frame,Object(F.a)(this,this.Ilh,"ribbonEscAction"))}}Object(m.a)(JG,"ReactRibbonFocusManager",null,[106]);class tB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(m.a)(tB,"CommandSqmInfo",null,[]);var dx=d(356),ex;(function(a){a[a.UnspecifiedGallery=
0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(ex||(ex={}));Object(m.b)("GalleryType",ex);class Ao{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(Ao,
"CommonGalleryButtonProps",null,[]);class Xy extends Ao{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(Xy,"AdditionalTableStyleGalleryButtonProps",Ao,[]);class KG extends Xy{constructor(){super()}}Object(m.a)(KG,"AdditionalChangeColorsGalleryButtonProps",Xy,[]);class LG extends Ao{constructor(){super();this.character=null}}Object(m.a)(LG,"AdditionalCharacterCodeGalleryButtonProps",Ao,[]);class MG extends Ao{constructor(){super();this.previewStyleLabel=
this.styleDisplayName=null}}Object(m.a)(MG,"AdditionalFontStyleGalleryButtonProps",Ao,[]);class NG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(NG,"AdditionalGalleryProperties",null,[]);class OG extends Ao{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(OG,"AdditionalIconButtonProperties",
Ao,[]);class PG extends Ao{constructor(){super();this.styleDisplayName=null}}Object(m.a)(PG,"AdditionalInkThicknessGalleryButtonProps",Ao,[]);class QG extends Ao{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(QG,"AdditionalListGallerButtonProps",Ao,[]);class RG extends Ao{constructor(){super();this.text=null}}Object(m.a)(RG,"AdditionalPageNumberGalleryButtonProps",Ao,[]);var Yy=d(669),hm=d(931),SG=d(1121);class uB{}uB.Text="Text";Object(m.a)(uB,"TextBoxCommandProperties",
null,[]);var im=d(304);const $P=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(oa.a)(Object,c[a])){if((a=Object(oa.a)(String,c.value))&&a===b)return!1;a=Object(oa.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:null;let f=null;for(let l=0;l<c.length;l++){const x=Object(oa.a)(Object,c[l]);if(Object(oa.a)(String,x.key)===a){f=x;break}}if(f&&Object(oa.a)(String,f.text)===b)return!1}}return!0},UG=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(Zy(a,
c[Sh.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[Sh.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!$P(a,c[eo.a.Value]))break;(b=c[eo.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[eo.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[eo.a.Value]));
break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[fo.SelectedFont]));break;case "SplitButtonModel":f.push(Zy(a,c[SG.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,c[$m.Number],ye.a.W0b(c[$m.UnitType]),c[$m.Text],c[$m.MaxValue],c[$m.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[qv.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,
c[hm.a.Text]));break;case "CompoundButtonModel":c[Sh.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[Sh.a.Description]));Sh.a.On in c&&f.push(Zy(a,c[Sh.a.On]));break;case "SliderModel":c.snapToStep?f.push(appChrome.actions.updateSliderSelectedValue(a,c[Uo.Value])):f.push(appChrome.actions.updateSliderValue(a,c[Uo.Value],c[Uo.MinValue]||0,c[Uo.MaxValue],c[Uo.Text]));break;case "FlyoutAnchorModel":Yy.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,
!c[Yy.a.ImageIsVisible]));Sh.a.On in c&&f.push(Zy(a,c[Sh.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[uB.Text]))}b=f;var l=Object(oa.a)(String,c[im.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,l));TG(a,c,f);b=f;(l=Object(oa.a)(Object,c[im.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(oa.a)(String,c[im.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));
a=f;(c=Array.isArray(c[im.a.Zfh])?c[im.a.Zfh]:null)&&a.push.apply(a,c);return f}return null},Wt=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),Zy=(a,b)=>appChrome.actions.toggleButton(a,b),TG=(a,b,c)=>{b=Object(oa.a)(String,b[im.a.Icon]);void 0!==b&&null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class VG{constructor(a,b,c,f){this.gm=f;this.Iqa=a;this.FK=b;this.Opb=c;this.aUb={}}KFk(a,b,c,f,l=null){const x=a.ExternalGalleryId||a.ExternalId;var H=a.ExternalId;f.push(x);if(appChrome.selectors.isControlDefined(x))a.GalleryStyle&&
Pg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(x,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(x,Object.assign(new NG,{columns:a.Width,sections:[appChrome.api.gallerySection([],H)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1));if(Pg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){H=[];const ja=[],ya=[],Va={};for(var U of a.GallerySections){H.push(appChrome.api.gallerySection([],U.SectionId,U.Title));0===c&&U.GalleryButtons&&0<U.GalleryButtons.length&&(c=U.GalleryButtons[0].Type);f&&this.b5f(U.GalleryButtons,l,Va);const hb=this.xOd(ja,U.GalleryButtons,Va);ja.push.apply(ja,this.l9d(hb,x,U.SectionId,!1,c,l,!0,Va));ya.push.apply(ya,hb)}b.push(appChrome.actions.setGallerySections(x,H));b.push.apply(b,
ja);b.push.apply(b,this.q7d(x,ex[c],ya,null,5===a.Type,!0,null,Va))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),U=f?this.b5f(a.GalleryItems,l,null):null,b.push.apply(b,this.l9d(this.xOd(b,a.GalleryItems,U),x,H,!1,c,l,!1,U))}Pfj(a,b){const c=[];let f=null,l=!1;if(!a)return null;const x=this.Iqa.Ilc(this.FK,a.commandId,b);c.push(Wt(a.externalUxCommand,!x));if(a.previewControlIds){const ja=[];for(let ya=0;ya<a.previewControlIds.length;ya++){var H={},U=a.previewControlIds[ya];
H.SourceControlId=U;const Va=this.gm.getCommandByExternalUxId(U);this.KTc(Va||a,H);H[hm.a.On]&&(f=H.SourceControlId,H[hm.a.HighlightOn]&&(l=!0));TG(U,H,c);if(H=Object(oa.a)(dx.a,H[hm.a.GalleryButtonProps]))ja.push(H),x&&(U=this.Iqa.Ilc(this.FK,H.Command,b),H.IsDisabled=!U)}0<ja.length&&c.push.apply(c,this.l9d(this.xOd(c,ja),a.externalUxCommand,a.externalUxCommand,!0,ja[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(ia.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",
f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}xOd(a,b,c=null){const f=[],l=[];for(let H=0;H<b.length;H++){const U=b[H],ja=Vk.a(U.ExternalId)?U.Id:U.ExternalId;f.push(ja);const ya=c&&c[ja]?c[ja].result:-1;switch(U.Type){case 1:var x=U;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(ja,Object.assign(new LG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,character:x.Character,style:x.Style,title:x.Alt})));break;case 2:x=U;l.push(appChrome.api.createFontStylesGalleryButtonModel(ja,
Object.assign(new MG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,styleDisplayName:x.LabelText,style:x.Style,title:x.Alt,previewStyleLabel:x.PreviewStyleLabel})));break;case 3:x=U;l.push(appChrome.api.createInkThicknessGalleryButtonModel(ja,Object.assign(new PG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,styleDisplayName:x.LabelText,style:x.Style,title:x.Alt})));break;case 4:x=U;l.push(appChrome.api.createIconGalleryButtonModel(ja,Object.assign(new OG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,icon:[x.Icon],
fullIconStyle:x.FullIconStyle,previewIconStyle:x.PreviewIconStyle,largePreviewIconStyle:x.LargePreviewIconStyle,label:x.LabelText,title:x.Alt})));break;case 5:x=U;l.push(appChrome.api.createListGalleryButtonModel(ja,Object.assign(new QG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,infoAtLevel:x.LevelInfo,ariaLabel:x.Alt})));break;case 6:x=U;l.push(appChrome.api.createTableStyleGalleryButtonModel(ja,Object.assign(new Xy,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,tableCellStyles:x.TableCellStyles,tableStyles:x.TableStyles,
title:x.Alt,columns:x.columns})));break;case 8:x=U;l.push(appChrome.api.createChangeColorsGalleryButtonModel(ja,Object.assign(new KG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,tableCellStyles:x.TableCellStyles,tableStyles:x.TableStyles,title:x.Alt})));break;case 7:x=U,l.push(appChrome.api.createPageNumberGalleryButtonModel(ja,Object.assign(new RG,{disabled:-1!==ya?1>(ya&1):x.IsDisabled,text:x.Text,title:x.Alt})))}this.gm.addCommandToMaps(Object.assign(new Sa.a(ja,U.Command),{queryCommandId:U.QueryCommand,
menuItemId:U.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}l9d(a,b,c,f,l,x=null,H=!1,U=null){const ja=[];f?ja.push(appChrome.actions.populateGalleryItems(b,a)):(this.aUb[b]=!1,H||(f=!0,appChrome.selectors.isControlDefined(b)&&(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),ja.push.apply(ja,this.q7d(b,ex[l],a,null,5===l,f,x,U))),ja.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return ja}o$i(a){return this.q7d(a.ExternalUxId,
a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}q7d(a,b,c,f,l,x=!0,H=null,U=null){const ja=[];if(a in this.aUb){if(this.aUb[a])return delete this.aUb[a],ja;this.aUb[a]=!0}let ya=null,Va=-1;if(c)({EYf:Va,returnValue:ya}=this.Csf(b,c,ja,x,H,U));else if(f)for(const hb of f)(c=({EYf:Va}=this.Csf(b,hb.galleryButtons,ja,x,null,U)).returnValue)&&(ya=c);ja.push(appChrome.actions.updateGallerySelectedId(a,ya));x&&ja.push(Wt(a,!1));l&&0<Va&&ja.push(appChrome.actions.updateListGalleryTextDirection(a,
2===Va));return ja}a5f(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.gm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.KTc(a,f);c.result=a;c.props=f;return c}b5f(a,b=null,c=null){c||(c={});for(const f of a)a=Vk.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.a5f(a,b);return c}Csf(a,b,c,f,l=null,x=null){let H,U=null;H=-1;let ja=!1;for(const Va of b){var ya=this.m$i(a);b=x&&x[Va]&&-1!==x[Va].result?x[Va]:this.a5f(Va,l);const hb=b.result;b=b.props;f&&c.push(Wt(Va,
1>(hb&1)));(ya=UG(Va,ya,b,hb))&&c.push.apply(c,ya);b[hm.a.On]&&(U=Va,b[hm.a.HighlightOn]&&b[hm.a.HighlightOn]&&(ja=!0));void 0!==b[im.a.labelText]&&null!==b[im.a.labelText]&&(ya=this.gm.getCommandByExternalUxId(Va),c.push(appChrome.actions.setControlLabel(ya.externalUxCommand,b[im.a.labelText])));b[hm.a.IsRtl]&&0>H&&(H=b[hm.a.IsRtl])}ja&&(ia.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",U),c.push(appChrome.actions.highlightSelectedFontStyle(U)));return{returnValue:U,
EYf:H}}m$i(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}KTc(a,
b){b.MenuItemId=a.menuItemId;return this.Iqa.Uhd(this.FK,this.Opb,a.commandId,a.queryCommandId,b)}}Object(m.a)(VG,"ReactGalleryPoller",null,[]);var aQ=d(933),bQ=d(586),$y=d(791),cQ=d(793);class vB extends fg.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(vB,"CompoundButtonProps",fg.a,[]);var dQ=d(932),sq=d(585);class WG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(WG,"PopulateFontPickerDataProps",
null,[]);var Sr=d(409);class XG extends pq{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(XG,"OptionalCompoundButtonProperties",pq,[]);class YG extends pq{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=null}}Object(m.a)(YG,"OptionalErrorViewProperties",pq,[]);class ZG extends ov{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(ZG,"OptionalPersonaButtonProperties",
ov,[]);class az extends pq{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(az,"OptionalToggleButtonProperties",pq,[]);var eQ=d(935),fQ=d(934),bz=d(473);class $G{constructor(){this.OGf=this.actions=null;this.yJh=!1}}Object(m.a)($G,"PopulateActions",null,[]);class wB{f7f(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);case "ToggleButtonModel":return this.hgj(a);case "InkButtonModel":return this.ggj(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);
case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}hgj(a){const b={};b[Sh.a.On]=appChrome.selectors.getButtonToggleState(a);return b}ggj(a){const b={};b[Sh.a.On]=Pg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);return b}}Object(m.a)(wB,"ReactStatePropsSelector",null,[]);class cz{constructor(a,b,c,f,l){this.Iqa=a;this.FK=b;this.Opb=
c;this.gm=f;this.zLd={};this.iZh=new wB;this.E4a=l}Cwh(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.zLd}Egj(a,b,c=null){const f=[],l={};if(!this.Cwh(a)){const x=a.populationProps.populateQueryCommandId,H={};H.MenuId=a.externalUxCommand;H.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.Iqa.Uhd(this.FK,this.Opb,x,x,H,this.Caj(c))&1))if("FontPickerModel"===b)this.zLd[x]=!0,f.push(cz.Afj(a,H)),l[a.externalUxCommand]="FontPickerModel";else if(H.MenuItems)switch(this.zLd[x]=
!0,b){case "ComboBoxModel":f.push(cz.yfj(a,H));l[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.u8f(a.externalUxCommand,b,H.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new $G,{actions:f,OGf:l,yJh:this.isShadowMenuOpen(c)})}H3f(a,b,c,f,l,x,H,U,ja=null){let ya=null;const Va=[];Vk.b(a.Title)||(ya=a.Title);for(let hb=0;hb<a.ControlList.length;hb++){const yb=
Object(oa.a)(IA.a,a.ControlList[hb]);if(!yb||yb.ExternalId)x&&this.L5i(yb,x),b.push.apply(b,this.zfj(yb,H,Va,l,c,f,ja))}return U?appChrome.api.menuSection(Va,ya,a.Lang):null}u8f(a,b,c,f,l=null){const x=[],H=[],U=[],ja=[];for(var ya=0;ya<c.MenuSectionList.length;ya++){var Va=Object(oa.a)(hk.a,c.MenuSectionList[ya]);Va&&(Va=this.H3f(Va,x,a,b,ja,f,H,c.UpdateDynamically,l),c.UpdateDynamically&&U.push(Va))}ya=null;c.MenuFooterSection&&(ya=this.H3f(c.MenuFooterSection,x,a,b,ja,f,H,c.UpdateDynamically,l));
c.UpdateDynamically&&x.push(appChrome.actions.updateMenu(a,U,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,ya));0<H.length&&x.splice(0,0,appChrome.actions.addControls(H));0<ja.length&&Pg.d("setStatefulSplitButtonMruBypassControls")&&x.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,ja));return x}L5i(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";
break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(oa.a)($y.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}zfj(a,b,c,f,l,x,H=null){const U=[];switch(a.ControlType){case 1:case 3:f=Object(oa.a)(fg.a,a);this.sFk(f,U,b,c);f.MenuItemsStatefulData&&Pg.d("setStatefulSplitButtonMenuItemsStatefulData")&&U.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,f.MenuItemsStatefulData));
break;case 2:this.gGk(Object(oa.a)(bz.a,a),U,b,c);break;case 6:this.vFk(Object(oa.a)(bQ.a,a),U,b,c);break;case 4:this.ZFk(Object(oa.a)(Xv,a),U,b,c);break;case 7:this.wFk(Object(oa.a)($y.a,a),U,b,c);break;case 12:this.CFk(Object(oa.a)(dQ.a,a),U,c);break;case 13:this.YKe(Object(oa.a)(aQ.a,a),U,c);break;case 9:l=Object(oa.a)(or.a,a);this.FFk(l,U,b,c);"StatefulSplitButtonModel"===x&&f.push(l.ExternalId);break;case 8:this.E4a.KFk(Object(oa.a)(sq.a,a),U,b,c,H)}return U}sFk(a,b,c,f){f.push(a.ExternalId);
appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.cHc()&&((c=this.rta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Op.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,
a.Alt)))):(a.Description||Object(Xa.a)(vB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new XG,{iconSet:(new Op.a(this.rta(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new ov,{iconSet:(new Op.a(this.rta(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,
customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus}))),this.gm.addCommandToMaps(Object.assign(new Sa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&Pg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}vFk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?
(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.cHc()&&((c=this.rta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Op.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new az,{iconSet:(new Op.a(this.rta(a))).iconSet,
keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.gm.addCommandToMaps(Object.assign(new Sa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}YKe(a,b,c){c.push(a.ExternalId);b.push(appChrome.actions.updateAddInListItems(a.ExternalId,a.Items));for(b=0;b<a.Items.length;++b)c=a.Items[b],this.gm.addCommandToMaps(new Sa.a(c.id,c.commandId)),
this.gm.addCommandToMaps(new Sa.a(c.buttonId,c.buttonCommandId))}CFk(a,b,c){c.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):appChrome.api.createErrorViewModel(a.ExternalId,a.Label,a.IconName,Object.assign(new YG,{retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId}))}gGk(a,b,c,f){f.push(a.ExternalId);
appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.cHc()&&((c=this.rta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Op.a(c)).iconSet)),u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new az,{iconSet:(new Op.a(this.rta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new az,{iconSet:(new Op.a(this.rta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),
this.gm.addCommandToMaps(Object.assign(new Sa.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}ZFk(a,b,c,f){f.push(a.ExternalId);f=this.kfj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):Pg.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new ZG,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}FFk(a,b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.cHc()&&((c=this.rta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Op.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&
b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new Iy,{iconSet:(new Op.a(this.rta(a))).iconSet,keytip:a.KeyTip,hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.gm.addCommandToMaps(Object.assign(new Sa.a(a.ExternalId,
a.Command),{queryCommandId:a.QueryCommand,populationProps:new eh(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.u8f(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}wFk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(f=this.iZh.f7f(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,
a.Width)),this.gm.addCommandToMaps(Object.assign(new Sa.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.gm.addCommandToMaps(Object.assign(new Sa.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const l=[];for(let x=0;x<a.Colors.length;x++){const H=a.Colors[x];x<f?c.push(appChrome.api.colorPickerCell(H.Color,
H.DisplayColor,H.Alt)):l.push(appChrome.api.colorPickerCell(H.Color,H.DisplayColor,H.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}rta(a){return a.Image32by32Class?this.gm.v1f(a.Image32by32Class):
a.Image16by16Class?this.gm.v1f(a.Image16by16Class):a.ExternalImageId}kfj(a){return a?Object.assign(new fQ.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new eQ.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}Caj(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}cHc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static Afj(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,f)=>{Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(Sr.a.uVa,!1).then(x=>{let H=b.fonts;x||l.isFreemiumUpsellEnabled()||(H=cb.a.upa(H,U=>U.fontType!==Sr.a.OLe));x=Object.assign(new WG,{commandId:a.externalUxCommand,fonts:H,isSubscriber:x,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
c(x)}).catch(f)})}))}static yfj(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let x=0;x<l.ControlList.length;x++){const H=Object(oa.a)(cQ.a,l.ControlList[x]);H&&c.push(appChrome.api.comboBoxItem(H.MenuItemId,H.LabelText,H.Styles,H.CommandValueId,H.AriaLabel,H.Data,H.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+
f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(m.a)(cz,"ReactPopulateQueryCommandPoller",null,[]);class aH{constructor(a,b,c,f,l){this.gm=c;this.Iqa=a;this.FK=b;this.Opb=f;this.E4a=l}Dgj(a,b,c){const f=[];if(this.VKj(b))a=this.vkj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.KTc(a,c);im.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[im.a.visible]));f.push(Wt(a.externalUxCommand,1>(l&1)));
void 0!==c[im.a.labelText]&&null!==c[im.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[im.a.labelText]));void 0!==b&&null!==b&&(l=UG(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.L6h(a.externalUxCommand,c,f))}return f}X8i(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var x=appChrome.selectors.getSplitButtonState(a);if(x=this.gm.getCommandByExternalUxId(x.command))c=
this.Iqa.Ilc(this.FK,x.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),f.push(Wt(a,!1));return f;default:return null}b=!1;for(x in l)if(l=this.gm.getCommandByExternalUxId(x),Vk.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.Iqa.Ilc(this.FK,l.commandId,c))return f.push(Wt(a,!1)),f;f.push(Wt(a,!b));return f}vkj(a,b,c){switch(b){case "PreviewGalleryModel":return this.E4a.Pfj(a,c);case "GalleryModel":return this.E4a.o$i(c)}return null}VKj(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}KTc(a,b){b.MenuItemId=a.menuItemId;return this.Iqa.Uhd(this.FK,this.Opb,a.commandId,a.queryCommandId,b)}L6h(a,b,c){const f=b[Yy.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Yy.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.mnj(a,b))}mnj(a,b){return appChrome.actions.updatePeopleWell(this.r5i(a),b)}r5i(a){const b=[];var c={};a=this.gm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.Iqa.Uhd(this.FK,this.Opb,
"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(m.a)(aH,"ReactQueryCommandPoller",null,[]);class bH{Uhd(a,b,c,f,l,x){let H=0;a&&(this.Ilc(a,c,l)&&(H|=1),c=new tB,c.CommandLocation=
b,void 0!==x&&null!==x&&(c.InvocationMethod=x),!Vk.b(f)&&a.BTf(f,l,c)&&(H|=2));return H}Ilc(a,b,c=null){return a?a.I$b(b,c):!1}}Object(m.a)(bH,"RootPoller",null,[]);class cH{constructor(a,b,c){this.gm=a;this.FK=b;a=new bH;this.R0h=new wB;this.E4a=new VG(a,this.FK,c,this.gm);this.Vlf=new cz(a,this.FK,c,this.gm,this.E4a);this.Qlf=new aH(a,this.FK,this.gm,c,this.E4a)}dTa(){const a=[];if(!Pg.c())return a;a.push.apply(a,this.knj());var b=this.k8i();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),
Object.keys(b).length){const c=this.l8i();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,!0)),delete b[f];a.push.apply(a,this.KUc(b))}return a}Klc(a,b){Pg.c()&&(a=this.KUc(a,b),appChrome.api.dispatch(a))}VKe(a,b,c=null){if(!Vk.b(a)&&a.populationProps&&!this.Vlf.Cwh(a)){a=this.Vlf.Egj(a,b,c);if(!a.yJh){let f;(f=a.actions).push.apply(f,this.KUc(a.OGf,Pg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}KUc(a,b=0){const c=[],f={};if(Pg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var x of appChrome.selectors.getVisibleControlsInGroup(l))f[x]=!0;for(let H in a)l=H,x=a[H],0===b&&f[l]&&(b=2),c.push.apply(c,this.jnj(l,x,b));return c}jnj(a,b,c=0){const f=[],l=this.gm.getCommandByExternalUxId(a);let x={};appChrome.selectors.isControlDefined(a)&&(x=this.R0h.f7f(a,b));x[Zm.a.Ztd]=c;Vk.b(l)?
(x.ExternalUxId=a,(a=this.Qlf.X8i(a,b,x))&&0<a.length&&f.push.apply(f,a)):(x.MenuItemId=l.menuItemId,x.SourceControlId=a);f.push.apply(f,this.Qlf.Dgj(l,b,x));return f}knj(){const a=[],b=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());
for(let x=0;x<c.length;x++){var l=this.gm.F$d(c[x]);if(l){l=this.FK.I$b(l);let H=!0;b&&(H=0<=Array.indexOf(f,c[x]));b&&H===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[x],l))}}return a}k8i(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.gm.F$d(a);c&&(this.FK.I$b(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}l8i(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.gm.A$i(c))for(const f of a)this.FK.I$b(f.commandId)||
((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),b.push.apply(b,a));return b}}Object(m.a)(cH,"ReactRibbonRootPoller",null,[1527]);class fx{constructor(a,b,c=null){this.FK=this.mUb=this.OOa=null;this.fZh=b;a.Yqb(this);this.xaa=c}get p1c(){this.mUb||(this.mUb=new Date,this.mUb.setTime(0));return this.mUb}set p1c(a){this.mUb=a}get K3k(){return 2}get xaa(){return this.FK}set xaa(a){this.FK=a}get MJb(){this.OOa||(this.OOa=new cH(this.fZh,this.xaa,this.K3k));
return this.OOa}wKc(){const a=document.activeElement;Ca.a.isEditable(a)&&a.blur()}executeCommand(a,b,c,f,l,x,H,U=2){Vk.b(this.xaa)||(l=new tB,l.CommandLocation=U,l.InvocationMethod=f,l.CommandTabName=c,b[Zm.a.Ztd]=U,this.xaa.BTf(a,b,l,x,H),this.D1j(a,b))}dTa(){return Vk.b(this.xaa)?[]:this.MJb.dTa()}Jlc(){const a=this.dTa();0<a.length&&(this.p1c=new Date,appChrome.api.dispatch(a))}kPb(){Pg.c()&&this.MJb.Klc({PeopleWell:"PeopleWell"},18)}D1j(a,b){try{const c=Db.a.instance.ub("Common.ISystemInitiatedFeedback");
if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.eoe("Ribbon"+l)}}catch(c){ia.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(m.a)(fx,"ReactRibbonRoot",null,[1517,1528]);class xB{constructor(){this.Jqa=[]}Yqb(a){a&&!Array.contains(this.Jqa,a)&&Array.add(this.Jqa,a)}Nhh(a){Array.remove(this.Jqa,a)}wKc(){for(const a of this.Jqa)a.wKc()}dispose(){this.Jqa=
null}}Object(m.a)(xB,"RootManagerBase",null,[1137,106]);class Tr extends xB{constructor(){super()}static get instance(){return Tr.Ka||Tr.oFj()}static oFj(){Tr.Ka=new Tr;return Tr.Ka}}Tr.Ka=null;Object(m.a)(Tr,"ReactRootManager",xB,[1136,1137]);class rp{constructor(a,b,c,f,l,x,H,U=null,ja=!0,ya=null,Va=null){this.rSb=this.XEc=this.Pyd=this.JP=null;this.dof=[];this.fDc=null;this.M4a=a;this.gGd=b;this.Npb=c;this.Nd=f;this.Ca=l;this.gm=x;this.JP=ya?ya:new fx(Tr.instance,this.gm);this.J3a=H;this.Umf=new IG;
this.UOa=U;this.LKd=ja;new EG;this.Cbf=Va;gb.a.get_instance().ek(7,Object(F.a)(this,this.Ocl,"setRibbonPostInteractiveReady"));gb.a.get_instance().ek(7,Object(F.a)(this,this.O3j,"logRibbonLoadedActivity"));gb.a.get_instance().ek(19,Object(F.a)(this,this.r1j,"logAppLoadedActivity"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&gb.a.get_instance().ek(7,Object(F.a)(this,this.rVk,"registerSubComponentReporting"));gb.a.get_instance().ek(7,
Object(F.a)(this,this.WMk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.LKd||this.XJ(5);c?c.then(()=>{this.njh()}).catch(()=>ia.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):DG.a.IBh(DG.a.IBh(il.Task.WAA(this.Opg(a),this.Npg(rp.ROh)),()=>this.Npg(rp.$Mh)),()=>this.Opg(b)).continueWith(()=>{this.njh()},11)}dispose(){this.PAl();this.fDc&&this.fDc.dispose();for(const a of this.dof)gb.a.get_instance().Wsi(a);u.AFrameworkApplication.Ta.PJ(G.a.K0k,de.a.frame,
ld.ActionManager.Mg)}Npg(a){return Db.a.instance.resolve("Common.ISharedDependencyLoader").XAb(u.AFrameworkApplication.Aj(a,2))}Opg(a){return""===a?il.Task.Rt(!0):Db.a.instance.resolve("Common.ISharedDependencyLoader").XAb(u.AFrameworkApplication.Aj(a,3))}seg(){(this.UOa||this.J3a)&&appChrome.api.dispatch(this.q8f());this.BWe();Pg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.nga);this.JP.Jlc()}njh(){this.seg();this.LKd&&(appChrome.renderAppChrome(this.M4a,
Pg.e()),this.XJ(10));this.Wrf();this.nIc();this.LKd&&this.XJ(5);this.cXc()}cXc(){this.Nd&&this.Ca&&this.Npb&&(this.fDc=new JG(this.Nd,this.Ca,this.M4a,this.Npb),this.fDc.initialize())}get w3k(){return this.Umf}setCommandDefinitionMapping(){if(Pg.a("setCommandDefinitionMapping")){const a=XP(this.gm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.o9&&Pg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,
b)=>{0===b&&this.cIb()})}Wrf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(oa.a)(fx,this.JP);this.Pyd=new HG(this.JP,a.MJb,this.gm,this.Nd,this.gGd,Db.a.instance.ub("Common.IRibbonSQMInformation"),Db.a.instance.ub("Common.IFileMenuSQMInformation"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,Db.a.instance.Ja("Common.ISystemInitiatedFeedback"),null);this.gii();this.Mqj()}gii(){this.XEc=appChrome.api.bindCommandHandler((a,b)=>{this.Pyd.executeCommand(a,
b)})}PAl(){this.XEc&&(this.XEc(),this.XEc=null)}BWe(){appChrome.api.initializeLogger(new YP.a)}dTa(){return this.JP?this.JP.dTa():[]}cIb(){Nd.a.instance.hG(()=>{let a=null;Nd.a.instance.hG(()=>{a=this.dTa()},"RB:GA");a&&0<a.length&&(this.JP.p1c=new Date,Nd.a.instance.hG(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.rSb&&Nd.a.instance.hG(()=>{},"RB:J")},"RB:PFSU")}kPb(){this.JP.kPb()}$3h(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=
[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}q8f(){var a=u.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));
b.push.apply(b,this.A1f());a=new BG.a(this.gm);this.UOa.Uaa&&(qp.oyl(this.UOa.Uaa),b.push.apply(b,a.f5d(this.UOa.Uaa)));if(this.UOa.lDh)for(const c of this.UOa.lDh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.T0i,c.LE,c.qyl));b.push.apply(b,a.u2i(this.UOa.pyl));return b}A1f(){const a=[];if(this.J3a&&this.J3a.Uaa){const c=this.J3a.Uaa;for(let f in c){var b=c[f];const l=this.gm.M6d(f);if(l)for(let x of l)a.push(appChrome.actions.updateControlHiddenState(x,b))}}return a}dPb(a){a&&this.JP.MJb.Klc(a,
0)}VKe(a){this.JP.MJb.VKe(this.gm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}Ujl(a){gb.a.get_instance().ek(5,null).continueWith(()=>{appChrome.api.dispatch(this.ujj(a))})}jNi(){const a=u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?"ShareMenu":"Share",b=u.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.AFl(a,"Shared"===(b.SharingStatus||"")))}WMk(){u.AFrameworkApplication.fa.gf(()=>{this.jNi()})}AFl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,
b)}ujj(a){return appChrome.actions.updateControlHiddenState(a,!1)}vjj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}XJ(a){gb.a.get_instance().XJ(a);this.dof.push(a)}Ocl(){Pg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new CG,{postRibbonInteractiveReady:!0})))}nIc(){this.J3a&&this.Cbf&&(this.rSb=this.Cbf.createFileMenu(this.J3a,this.JP.xaa),this.Umf.fileMenu=this.rSb)}cZj(){this.rSb&&this.rSb.YYj()}wmd(a,
b,c){if(1===c)return 32;this.gqc(!0);this.cIb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}xmd(a,b,c){if(1===c)return 32;this.gqc(!1);this.Tcl();this.cIb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}Tcl(){ki.a.$J(u.AFrameworkApplication.fa.Ga("IsSimplifiedRibbonOnCookieName"),"true",ki.a.DJ)}gqc(a){ki.a.$J(u.AFrameworkApplication.fa.Ga("ReactRibbonMLRPreferenceCookieName"),a.toString(),ki.a.DJ)}O3j(){if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Oo){const a=
Db.a.instance.Ja("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),u.AFrameworkApplication.JL("d79fg304;61jba833;h856e313;f5i2f477")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.JL("69a7h198;dfd7j584"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>
{b.isFreemiumUpsellEnabled()&&u.AFrameworkApplication.JL("5fjej882;e0jjh200")})}}r1j(){const a=ki.a.B3(u.AFrameworkApplication.fa.Ga("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const b=Db.a.instance.Ja("Common.ISystemInitiatedFeedback");b&&(u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&
a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}rVk(){gb.a.get_instance().ek(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)u.AFrameworkApplication.Ta.dT(l)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):u.AFrameworkApplication.Ta.Jbl(l,this.iFi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}iFi(a){return()=>
{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}Mqj(){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.ZHb.TNd){const a=u.AFrameworkApplication.ZHb.TNd,b=u.AFrameworkApplication.ZHb.Frf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:
a;rp.ymd.Hb(c)?rp.ymd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.Pyd.executeCommand(a,b))}}}rp.ROh="common";rp.$Mh="appChrome";rp.ymd=new WP.a(qB.a.W8f());Object(m.a)(rp,"ReactRibbonUser",null,[1134,1135,106]);class yB{constructor(){this.label=this.value=null}}Object(m.a)(yB,"TextInfoSectionField",null,[]);class dH{constructor(a,b){this.Uaa=b}}Object(m.a)(dH,"ReactRibbonJewelProperties",null,[]);class zB extends rp{constructor(a,
b,c,f,l,x,H,U,ja=null,ya=!0,Va=null,hb=null){super(a,b,f,l,x,H,U,ja,ya,Va,hb);this.Iyc=null;this.Jyc=c;this.Jyc.execute(yb=>{this.Iyc=yb});this.Jyc.execute(yb=>{this.JP.xaa=yb})}dTa(){return this.Iyc?(this.Iyc.clearCache(),super.dTa()):[]}}Object(m.a)(zB,"ReactRibbonUser",rp,[]);var AB=d(893),gx=d(236),BB=d(375),eH=d(714),CB=d(1117);class hx{static get Vmg(){return"teams"===(u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.eK)||"").toLowerCase()}static get Cth(){return hx.Vmg?(xa.a.J(576030427,
811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.jSa,u.AFrameworkApplication.Qtb),u.AFrameworkApplication.jSa&&u.AFrameworkApplication.Qtb):u.AFrameworkApplication.jSa}}Object(m.a)(hx,"CopyLinkHelper",null,[]);class fH{constructor(a,b){this.GCe=null;this.la=a;this.Rfk=b}dispose(){this.GCe&&(ym.CuiHelper.MNi(this.GCe),this.GCe=null)}Kmj(){if(u.AFrameworkApplication.workflowEnabled){let a="";switch(u.AFrameworkApplication.evc){case "Assign":a=CommonUIStrings.l_Assign;
break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new CB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return u.AFrameworkApplication.ple&&u.AFrameworkApplication.m_a||u.AFrameworkApplication.Euc?Object.assign(new CB.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:ym.CuiHelper.Mld}):u.AFrameworkApplication.jSa?Object.assign(new CB.a,{command:"981334692",label:ResourceStrings.L_Share,image:ym.CuiHelper.ggl,id:ym.CuiHelper.dXe}):null}Pil(){if(hx.Vmg&&
!this.Rfk)return!1;const a=this.Kmj();return a&&"981334692"===a.command?this.la.mlg||this.la.gSj:!1}Til(){xa.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.jSa,u.AFrameworkApplication.Qtb);return u.AFrameworkApplication.jSa&&(u.AFrameworkApplication.Qtb||u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}Object(m.a)(fH,"CuiControlUser",null,[106]);var ix=d(276);class gH extends zB{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){super(b,
a.Dja,f,zb.a.waa,l,x,H,null,ya,!0,null,yb);this.Ktg=this.Ebc=this.Tsg=this.qWa=this.Ik=this.BHa=this.la=this.nh=this.ZVa=this.E$c=this.gre=this.Dve=null;this.cEg=!1;this.j8=0;this.ywe=this.U6c=this.a$=!1;this.Mu=this.k9c=this.Jeb=null;this.yBf="hideTellMeWrapper";b=new BB.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.BHa=hb,this.la=Va,this.gre=new fH(this.la,Kc.ka("ShareMenuIsEnabled")),this.Dve=a,this.E$c=ja,this.qWa=H,this.ZVa=U||new eH.a,this.nh=this.ZVa.fYd(2,"ReactRibbonUser"),this.j8=
0,this.Tsg=ya.Uaa,this.a$=!!window.performance&&!!window.performance.now,this.Ik=Zb,this.U6c=fc,this.Jeb=Kc,this.ywe=Lc,this.k9c=Gc,this.Mu=ae,this.i_k(),gb.a.get_instance().ek(10,Object(F.a)(this,this.xEj,"initializeFullPptRibbon"),11),gb.a.get_instance().ek(10,Object(F.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}qeg(){Cg.a.instance.ic("InitRibbon",(new Date).getTime());xa.a.J(512496020,801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.MHk?"2":"1",this.la.Ooa);
this.la.cB&&this.la.ka("ActionAIRibbonLoadOn1stTimeEnabled")&&!this.la.ka("ActionAIRibbonLoadedOn1stTime")&&this.a9k();this.la.podsRibbonEarlyRendererExposureControl&&!this.la.ZMf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(F.a)(this,this.lEj,"initializeEarlyRenderedPptRibbon")):(Cg.a.instance.ic("RenderRibbonStart",Date.now()),this.bcj(gx.a(Db.a.instance)).catch(()=>{xa.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>
{Cg.a.instance.ic("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(gx.a(Db.a.instance));Pg.a("setCookieWithExpirationCallback")&&Pg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>ki.a.$J(a,b,ki.a.DJ)),appChrome.api.setGetCookieValueCallback(a=>ki.a.get(a)));appChrome.setAppSettings(u.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=u.AFrameworkApplication.nga+"exp/";appResourceLoader.init(TP.a.resolveScript,a);
appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.BWe();Ud.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?appChrome.initializeRibbonStore(this.la.Ooa):appChrome.initializeRibbonStore();this.seg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==u.AFrameworkApplication.Aa.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)?this.Cgh():this.qee());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.BHa&&this.BHa.o_k();appChrome.renderAppChrome(this.M4a,Pg.e());this.la.QIa&&Ud.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");gb.a.get_instance().XJ(5);gb.a.get_instance().XJ(10);Ud.a("React.SetRibbonBehaviorAttached")&&gb.a.get_instance().XJ(6);this.Qqg();Cg.a.instance.ic("Stage1Ribbon",AB.a.K2d&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&
null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}Cgh(){gb.a.get_instance().ek(4,()=>{gb.a.get_instance().isCompleted(7)||this.qee()})}a9k(){ki.a.$J("PPTActionAIRibbonLoadedOnIstTime",(!0).toString(),ki.a.DJ)}bcj(a){return Ud.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?this.la.qQk?a(this.la.Ooa?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):this.la.Ooa?a("powerpoint-ribbon-intl").catch(()=>
{}).then(()=>a("powerpoint-ribbon-mlr-intl")).catch(()=>{}).then(()=>a("appChrome")):a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):a("appChrome")}lEj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&Cg.a.instance.ic("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&Cg.a.instance.ic("AppChromeReadyTime",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&Cg.a.instance.ic("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),
this.qee()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)&&this.Cgh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.k9c.kph(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?Cg.a.instance.ic("AppInitStatus_ribbonSkeletonDismissed",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.Qqg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&ia.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.BWe();gb.a.get_instance().XJ(5);gb.a.get_instance().XJ(10);Ud.a("React.SetRibbonBehaviorAttached")&&
gb.a.get_instance().XJ(6);Du.a.dispatch("RibbonVisible")}xEj(){Cg.a.instance.ic("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{Cg.a.instance.ic("RibbonLazyPromiseFulfilled",(new Date).getTime());u.AFrameworkApplication.fa.gf(()=>{this.gre.Til()?gb.a.get_instance().ek(7,()=>{xa.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");appChrome.api.dispatch(this.vjj())}):gb.a.get_instance().ek(7,()=>
{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.UOa&&a.push.apply(a,this.q8f());if(u.AFrameworkApplication.Aa.hb.o9){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new UP.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);this.yVk();this.Jyc.execute(b=>{if(void 0===this.JP.xaa||null===this.JP.xaa)this.JP.xaa=b;this.Wrf()});this.dTk();this.nIc();this.createFileMenu();this.BHa&&(a=this.BHa.initialize(),
xa.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.cXc();gb.a.get_instance().XJ(7);Cg.a.instance.ic("Stage3Ribbon",(new Date).getTime());this.a$&&Cg.a.instance.ic("RibbonInteractivePerfMark",window.performance.now());this.P3j();this.DWk();this.yEj();Ca.a.zI(this.Dve.FF(),"ScrollableRibbon");return null})}P3j(){if(Cg.a.instance.K$a)xa.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};Cg.a.instance.Io("Stage1Ribbon")&&(a.RibbonDisplayed=Cg.a.instance.hh("Stage1Ribbon"));Cg.a.instance.Io("Stage3Ribbon")&&(a.RibbonInteractive=Cg.a.instance.hh("Stage3Ribbon"));Cg.a.instance.Io("InitRibbon")&&(a.InitRibbon=Cg.a.instance.hh("InitRibbon"));Cg.a.instance.Io("InitFullRibbon")&&(a.InitFullRibbon=Cg.a.instance.hh("InitFullRibbon"));Cg.a.instance.Io("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=Cg.a.instance.hh("RibbonLazyPromiseFulfilled"));Cg.a.instance.Io("RenderRibbonStart")&&
(a.RenderRibbonStart=Cg.a.instance.hh("RenderRibbonStart"));Cg.a.instance.Io("AppChromeReadyTime")&&(a.AppChromeReadyTime=Cg.a.instance.hh("AppChromeReadyTime"));Cg.a.instance.Io("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=Cg.a.instance.hh("AppInitStatus_ribbonSkeletonDismissed"));xa.a.J(512496015,809,50,"Ribbon Perf metrics: "+pa.a.toJSON(a))}}Y2j(){if(Cg.a.instance.K$a)xa.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");
else{var a={};Cg.a.instance.Io("Stage2Ribbon")&&(a.RibbonEnabled=Cg.a.instance.hh("Stage2Ribbon"));Cg.a.instance.Io("Stage4Ribbon")&&(a.RibbonFull=Cg.a.instance.hh("Stage4Ribbon"));xa.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+pa.a.toJSON(a))}}yEj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);Cg.a.instance.ic("Stage4Ribbon",(new Date).getTime());this.Y2j();return null})}cIb(){this.Iyc&&gb.a.get_instance().isCompleted(7)&&(bd.a.mark(4893),super.cIb(),bd.a.mark(4894),
this.cEg||(Cg.a.instance.ic("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),Cg.a.instance.ic("Stage2Ribbon",Date.now()),this.cEg=!0))}HH(){this.cIb()}selectRibbonTabById(a){const b=ki.a.B3(ix.a.AZa,!0);this.la.cB&&b&&Ud.a("RemoveContextualFromActionAiRibbonMode")||this.$3h(a)}get soh(){return appChrome.selectors.getSelectedTabId()}NQi(){this.UEb||xa.a.J(509637252,801,10,"Ribbon top bar1 is set to null");this.UEb.classList.remove(this.yBf)}LOf(){this.UEb||
xa.a.J(509637251,801,10,"Ribbon top bar1 is set to null");this.UEb.classList.add(this.yBf)}eNi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();u.AFrameworkApplication.fa.gf(()=>{if(!Ud.a("PPTOHideLegacySharedHeaderBugFix")||!u.AFrameworkApplication.CQ){var b=(new Date).getTime(),c=this.nh.zu("createHeader"),f=u.AFrameworkApplication.Aa.hb.$N,l=document.getElementById("HeaderPlaceholder");this.UEb=(new zG(Mf.a.EPi,this.Dve)).KSi();this.la.cB&&
"SingleLine".match(appChrome.selectors.getRibbonMode())&&this.LOf();if(f)try{xa.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");var x=new wG;appChrome.renderSharedHeader(this.UEb,x.dgj()).then(()=>{this.l1j(b,a);l&&this.eNi()})}catch(H){xa.a.J(512496011,801,10,"Exception while trying to render shared header {0}",H)}else throw xa.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),Error.invalidOperation("Invalid request to render legacy Shared Header");u.AFrameworkApplication.CQ||
(x=Rr.a.eee(S.AppFrame.HEa,null,this.UEb,!0),f&&(x.bJ=!0,this.OJb(x,G.a.cpc,G.a.bpc),x.bindAction(y.KeyInputManager.Oa(A.a.T1,0),G.a.umd)));!l&&AB.a.VUf&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.nh.Fu(c);this.j8|=1;this.Ytc()}})}l1j(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;xa.a.J(512496009,809,50,"Create Header Perf metrics: "+pa.a.toJSON(f))}OJb(a,b,c){const f=y.KeyInputManager.Oa(A.a.Sq,
0),l=y.KeyInputManager.Oa(A.a.Sq,4);a.zp(f);a.zp(l);a.bindAction(f,b);a.bindAction(l,c)}nIc(){const a=()=>{const b=this.nh.zu("createJewel");this.J3a=this.hFj();rp.prototype.nIc.call(this);this.nh.Fu(b);this.j8|=2;this.Ytc()};this.U6c&&this.Jeb?this.Jeb.Qyb(a):u.AFrameworkApplication.fa.gf(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.nh.zu("createFileMenu"),l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var x=[Object.assign(new yB,{label:CommonUIStrings.L_DiagnosticsSessionId,
value:u.AFrameworkApplication.userSessionId}),Object.assign(new yB,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",x))}l.push.apply(l,this.A1f());x=document.createElement("div");document.body.appendChild(x);appChrome.renderFileMenu(x,l);this.k1j(c,a);this.nh.Fu(f);this.j8|=22;this.Ytc()};this.U6c&&this.Jeb?this.Jeb.Qyb(b):u.AFrameworkApplication.fa.gf(b)}k1j(a,b){var c=(new Date).getTime();
const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;xa.a.J(512496008,809,50,"File Menu Perf metrics: "+pa.a.toJSON(f))}dTk(){const a=()=>{const b=this.nh.zu("refreshRibbon");this.Ebc||(this.Ebc={},qp.hDh(this.Ebc),this.E$c.WHh(this.Ebc),this.Ktg=this.G4i(this.Tsg,this.Ebc));const c=new BG.a(this.qWa);appChrome.api.dispatch(c.f5d(this.Ktg));this.nh.Fu(b);this.j8|=4;this.Ytc()};this.U6c&&this.Jeb?this.Jeb.Qyb(a):u.AFrameworkApplication.fa.gf(a)}G4i(a,
b){const c={};for(let l in b){var f=b[l];const x=l;f!==a[x]&&(c[x]=f,xa.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",x,a[x],f))}return c}hFj(){const a={};this.E$c.Zal(a);this.E$c.WHh(a);return new dH(null,a,"jewelPPTEditor")}DWk(){AB.a.K2d&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}Thh(a){gb.a.get_instance().ek(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}i_k(){const a=this.la.ka("ShareMenuIsEnabled"),
b=a?"ShareTopBar":"Share";u.AFrameworkApplication.Qtb?this.Thh(b):u.AFrameworkApplication.fa.gf(()=>{const c=this.nh.zu("createShareAction"),f=this.gre.Pil();f?this.Ujl(b):(this.Thh(b),this.la.fjb&&this.Ik.aaa(this.Ik.Y5,this.Ik.Opd));a&&(f?this.la.fjb&&gb.a.get_instance().ek(7,()=>{this.Ik.baa(this.Ik.Y5,this.Ik.Opd);this.Ik.Z$(this.Ik.Y5,this.Ik.Opd)}):gb.a.get_instance().ek(7,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.nh.Fu(c);this.j8|=8;this.Ytc()})}Ytc(){31===
this.j8&&(this.ZVa.g2c(2),this.j8=0)}qee(){this.k9c.fii();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));gb.a.get_instance().ek(7,()=>{this.k9c.OAl();Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.ywe||appChrome.PRIToastManager.dismissToast()},11)}Qqg(){gb.a.get_instance().XJ(18);Du.a.dispatch("RibbonVisible")}yXg(){return()=>{this.Mu.yGc(()=>{appChrome.PRIToastManager.dismissToast()})}}yVk(){this.ywe&&
(rp.ymd.$("NewDefaultSlide",this.yXg()),rp.ymd.$("ChangeLayoutFlyout",this.yXg()))}}Object(m.a)(gH,"ReactRibbonUser",zB,[1180,1135,106]);class hH{constructor(a,b,c,f,l,x,H){this.uDb=null;this.zb=a;this.VHg=b;this.pa=c;this.pB=f;this.pO=l;this.ia=x;this.Sp=H;this.VHg.jk(Object(F.a)(this,this.Hlh,"ribbonChangeTabHandler"))}dispose(){this.VHg.Cm(Object(F.a)(this,this.Hlh,"ribbonChangeTabHandler"))}get SF(){return this.uDb}set SF(a){this.uDb!==a&&a&&(this.uDb=a,this.pO.J_?this.pO.J_=!1:this.Sp&&this.pO.jVa&&
this.ia.processAction(D.a.Sja,2))}Hlh(a,b){b.node.Sa(kb.a.shapeId)&&(a=b.node.eb(kb.a.shapeId),this.uDb&&this.uDb.id===b.node.id&&a&&(this.zb.Db(new af.a(2,1,0,()=>{const c=this.pa.bij(this.pB.soh,b.node);0<c.length&&this.pB.selectRibbonTabById(c)},90,"10")),this.uDb=null))}}Object(m.a)(hH,"RibbonChangeManager",null,[1182]);class iH{constructor(a,b,c){this.T0i=a;this.LE=b;this.qyl=c}}Object(m.a)(iH,"GallerySectionData",null,[]);let DB,EB,dz,FB,jx,GB,HB,IB,JB;class rv{constructor(a,b,c,f,l,x){this.la=
a;this.T8c=b;this.n8c=c;this.oOg=f;this.iCb=l;this.Ik=x}tpd(a){this.la.bkg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=
!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.nqi,a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=
!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.bkg||(a["PptRibbon.Home.Drawing.AllShapes"]=
!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.jme||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=
!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=
!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=
!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.hme){if(this.la.ime||this.la.sAb||this.la.gme)a["ContextualTabs.Tables.Layout"]=!1;this.la.gme&&(a["ContextualTabs.Tables.Layout.Alignment"]=!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=
!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.ime&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.sAb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=
!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=
!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.kaa&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.FIb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.Fhb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.k0c&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.lme&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.pmc&&
(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=!this.la.ka("InsertSymbolIsEnabled");this.la.dlg||(a["PptRibbon.Home.Font.Shrink"]=
!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.ZRj||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.Nie||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.jDh(a,!0,!0,!0);this.iDh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.Tah||(a["PptRibbon.AudioPlayback"]=!0);this.la.DIb||(a["PptRibbon.AudioFormat"]=!0);if(u.AFrameworkApplication.wsa||!this.la.pptEditInsertAppsForOfficeEnabled||
this.la.o$b)a["PptRibbon.InsertTab.AppForOffice"]=!0,a["PptRibbon.InsertTab.InsertAddinTransitionEntry"]=!0;this.la.kzb||(a["PptRibbon.View.Zoom"]=!0);this.la.sPj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.mgg||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=!0);var b=[];this.la.cMa&&(b=this.la.cMa.split(","));for(const c of b){const f=
c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.lRd||(a.AnimationMore=!0);this.la.pWj?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.vg&&(a["PptRibbon.View.PresentationViews"]=!0);this.oOg?a["PptRibbon.Home.Clipboard.Paste"]=
!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.fkg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.Jke||(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?
a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=this.la.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.JNb&&!u.AFrameworkApplication.wsa)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&this.la.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&this.la.ka("HelpTabShowTrainingIsEnabled"));a.btnWhatsNew=!(b&&this.la.ka("HelpTabWhatsNewIsEnabled"));
a.btnFeedbackPane=!0;this.la.jab&&this.la.rXc&&this.la.rXc.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;
a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=
!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CacheDictateVisibility",!1)||(a["PptRibbon.Home.Dictation"]=!0,a.btnStartDictation=!0);this.iCb&&(a["PptRibbon.Review.Comments.Markers"]=!0);this.la.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.G$g;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.eIk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.la.OJa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=
!this.la.OJa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.OJa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=!this.la.OJa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.OJa;a.FixIt=!this.la.gQc}Fel(a){if(!this.la.ka("HelpTabIsEnabled")||u.AFrameworkApplication.JNb||u.AFrameworkApplication.wsa)a.Help=!0;a.Draw=!this.la.vg}$mj(){const a=new Ka.a;if(this.la.cMa){var b=this.la.cMa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new iH("TransitionMore",
"Transition"+b,!0))}return a.toArray()}Zal(a){a["PptJewel.Menu"]=!0;this.la.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.T8c&&this.T8c.K0g||(a["PptJewel.About.TryOffice"]=!0);this.n8c&&this.n8c.auh||(a["PptJewel.About.TryMacOffice"]=!0);this.la.ka("DocumentNameInJewelInfoMenuIsEnabled")&&u.AFrameworkApplication.Eu.Xw||(a.lblBreadcrumbDocName=!0);this.la.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.JNb&&(a["PptJewel.Help"]=!0)}WHh(a){delete a["PptJewel.Menu"];const b=this.la.Ga(u.AFrameworkApplication.eK);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=
!0;a["PptJewel.Share.Embed"]=!0;var c=this.la.ka("SaveACopyIsEnabledForUiHost");const f=this.la.ka("UiHostSupportsDocRebootFeatures");c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}u.AFrameworkApplication.Xwa||(a["PptJewel.New"]=!0);u.AFrameworkApplication.rPe||(a["PptJewel.Open"]=!0);u.AFrameworkApplication.TE||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);u.AFrameworkApplication.kDh&&(a["PptJewel.Info.OpenInClient"]=
!0,a.btnOpenInClient=!0);u.AFrameworkApplication.m_a||(a["PptJewel.Share.ReplyWithChanges"]=!0);u.AFrameworkApplication.i3d||u.AFrameworkApplication.w5e||(a["PptJewel.Info.FileVersion"]=!0);u.AFrameworkApplication.kAb?(a["PptJewel.Info.FileVersion"]=!0,u.AFrameworkApplication.hk("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),ia.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):u.AFrameworkApplication.H0c()?
this.la.UEk?(a["PptJewel.Info.VersionHistory"]=!0,ia.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):this.la.FMi?this.la.ka("IsAnonymousUserCheckSupportedForVH")&&this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ia.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ia.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):
(a["PptJewel.Info.VersionHistory"]=!0,ia.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);u.AFrameworkApplication.jSa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(u.AFrameworkApplication.yM||!u.AFrameworkApplication.u5e&&!u.AFrameworkApplication.gyb&&!u.AFrameworkApplication.Z2d)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&
a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);u.AFrameworkApplication.lyl&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);this.la.ka("DisablePrint")&&
(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.yM&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);this.la.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=
!0);this.la.ka("SaveAsToHostBrsIsEnabled")&&this.la.ka("UserCanWriteRelative")&&this.la.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=!0);this.la.ka("SaveToAnotherFolderBrsIsEnabled")&&this.la.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.dSj||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=
!0);this.la.llg&&this.la.vg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!this.la.ka("153")||".odp"===this.la.Ga("152").toLowerCase()||u.AFrameworkApplication.yM)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0;this.la.ka("RenameDialogIsEnabled")&&u.AFrameworkApplication.C$b()&&!u.AFrameworkApplication.yM||(a["PptJewel.Rename"]=!0);u.AFrameworkApplication.Goc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!u.AFrameworkApplication.Ncd||!this.la.ka("1072");u.AFrameworkApplication.privacyUrl||!c||u.AFrameworkApplication.Rsc||
this.T8c&&this.T8c.K0g||this.n8c&&this.n8c.auh||this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);u.AFrameworkApplication.privacyUrl||(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;u.AFrameworkApplication.Rsc||(a["PptJewel.About.TermsOfUse"]=!0);this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);u.AFrameworkApplication.Kda||(a["PptJewel.SecondaryMenu"]=!0);c=!this.la.ka("248");a["PptRibbon.Design.Designer.New"]=
c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=c)&&this.Ik&&this.Ik.aaa(this.Ik.Y5,this.Ik.m_d);c=!this.la.ka("822");a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!rv.hTj())||ia.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;ia.ULS.sendTraceTag(512262728,
352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",u.AFrameworkApplication.X9b(),u.AFrameworkApplication.insertOnlinePictureFromHostEnabled,u.AFrameworkApplication.sWc,u.AFrameworkApplication.kAb,u.AFrameworkApplication.sHc,u.AFrameworkApplication.eZb);this.la.ka("671")&&this.jDh(a,this.la.pptInsertOnlinePictureEnabled,
u.AFrameworkApplication.X9b(),this.la.jab);this.iDh(a,this.la.yXc);this.la.ka("670")&&(c=!this.la.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!this.la.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!this.la.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!this.la.ka("619");a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=
!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=this.la.ka("LiveSubtitlesEnabled");this.la.hla&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=
!1,Ud.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.kac&&this.la.Blg&&
(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.EIb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.la.EIb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.la.nWj&&this.la.hla&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=
!1,Ud.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);this.la.ka("WacLabelingPoliciesIsEnabled")&&this.la.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&this.la.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,
this.Ik&&this.Ik.aaa(this.Ik.Y5,this.Ik.Woh));this.la.dictationIsEnabled&&B.a.rzh&&this.la.ka("UserCanUseDictation")?(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.Ik&&this.Ik.aaa(this.Ik.Y5,this.Ik.iOf);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&
a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.G$g;a.FixIt=!this.la.gQc;this.la.Cu("IsPresentToTeamsSupportedHost")&&!this.la.ka("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);this.la.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);
qp.pGl(rv.Jzj,a);if(u.AFrameworkApplication.wsa||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.o$b)a["PptJewel.Addin"]=!0}jDh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=
!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=
!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}iDh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static hTj(){const a=u.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"),b=u.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");
var c=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.eK);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}rv.Jzj={["ellipsisOpenInApp"]:(JB=new Ka.a,JB.add("HostOpenInClient"),JB),["ellipsisOpenInBrowser"]:(IB=new Ka.a,IB.add("HostOpenInBrowser"),IB),["ellipsisDownload"]:(HB=new Ka.a,HB.add("HostDownload"),HB),["conversation"]:(GB=new Ka.a,GB.add("HostConversation"),GB),["close"]:(jx=new Ka.a,jx.add("HostClose"),jx.add("btnjClose"),jx.add("msJewelSecondary"),jx),["copyLink"]:(FB=
new Ka.a,FB.add("CopyLink"),FB),["share"]:(dz=new Ka.a,dz.add("jbtnFileSharing"),dz.add("btnFileSharing"),dz),["docChat"]:(EB=new Ka.a,EB.add("DocChat"),EB),["openInApp"]:(DB=new Ka.a,DB.add("btnOpenInClient"),DB)};Object(m.a)(rv,"RibbonCommandTrimmer",null,[1195]);class KB{constructor(){this.BHa=this.gl=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Zb(a){this.K=a;a.register(gB,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().oa(()=>
new gB(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1178,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().oa(()=>new oG(new dB(u.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mzb;B.a.Tj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").Hya);var c=this.K.resolve("PowerPointWebEditor.IFileInfo").eja;let f=2===c||3===c||0===c;c=1===c;const l=a.resolve("PowerPointWebEditor.IApplicationSettings").fjb?
a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;f=f&&!c;a.register(rv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().oa(()=>new rv(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f,l));a.register(1179,"PowerPointWebEditor.IModeSwitcherControlActor").ma().oa(()=>new hG(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),gb.a.get_instance(),l));a.register(1180,"PowerPointWebEditor.IRibbonUser").ma().oa(()=>{const x=a.resolve("PowerPointWebEditor.IApplicationSettings"),H=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var U={};H.tpd(U);var ja={};H.Fel(ja);U=new dG(U,H.$mj(),ja);ja=new gG;const ya=a.resolve("Common.IAppSettingsManager"),Va=new gH(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").xa,
a.resolve("PowerPoint.IPathManager"),a.Ja("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.ub("PowerPointWebEditor.Core.IBundleMetricRecorder"),H,U,x,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),ja,l,ya.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Xa.a)(108,ya)?ya:null,ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1),u.AFrameworkApplication.ZHb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));x.ZMf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Pyb(()=>{Va.qeg()}):Va.qeg();return Va});a.register(1181,"Common.IRibbonExternal").ma().oa(()=>a.resolve("PowerPointWebEditor.IRibbonUser").w3k);a.register(1182,"PowerPointWebEditor.IRibbonChangeManager").ma().oa(()=>new hH(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").yd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(fB,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().oa(()=>new fB(a.resolve("CommonUI.IBusinessBar"),new eG,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IErrorMapping"),u.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.PresentationContext")));a.register(1183,"PowerPointWebEditor.IBusinessBarPane").ma().oa(()=>new jG(a.Ja("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").Lnc));a.register(oq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().oa(()=>new oq(a.resolve("PowerPointWebEditor.IBusinessBarPane").IKl));
a.register(1184,"Common.IRibbonSQMInformation").ma().oa(()=>{const x=new pG(u.AFrameworkApplication.Ta);x.lVk();return x});a.register(1185,"PowerPointWebEditor.IInkRibbonManager").ma().oa(()=>{const x=a.resolve("PowerPointWebEditor.IApplicationSettings");return new qq(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.AFrameworkApplication.Aa.hb.o9,x)})}init(){this.BHa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");
this.K.resolve("PowerPointWebEditor.BusinessBarController").kEk();this.gl=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.gl.initialize();u.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Ja("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");
var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wnc?(c=document.getElementById("BusinessBarRegion"),b.APa(a,c,null)):c?b.APa(a,this.K.resolve("PowerPointWebEditor.AppFrame").X1,c):b.RP(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.gl&&this.gl.dispose();this.BHa&&this.BHa.dispose()}static main(){z.a.instance.Dc(new KB)}}Object(m.a)(KB,"PPTWebEditorRibbonPackage",null,
[2,3]);var kx=d(672);class jH{get name(){return"Box4.Insights"}init(){}dispose(){}Zb(a){a.register(kx.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().oa(()=>new kx.a)}}Object(m.a)(jH,"Box4InsightsPackage",null,[2,3]);class LB{constructor(a,b){this.HGd=0;this.Qha=new Ka.a;this.Ca=a;this.ld=b}get Wc(){return this.ld}get xde(){return 0<this.HGd}D5(a){this.ikg(a)&&this.HGd++;this.xde?this.Wc.enabled=!1:this.Qha.add(this.Wc.Vp(a.actionId))}C5(a){!this.xde&&
0<this.Qha.count&&(this.Qha.ga(this.Qha.count-1),this.yRf(this.Qha.count-1));this.ikg(a)&&this.HGd--;this.xde||(this.Wc.enabled=!0)}yRf(a){if(0<this.Qha.count&&0<=a&&a<this.Qha.count){const b=this.Qha.ga(a);this.Qha.removeAt(a);b.end()}}nui(){let a=this.Qha.count-1;for(;0<=a;){var b=this.Qha.ga(a);(b=this.Ca.dT(b.activityName))&&b.flags[128]&&this.yRf(a);a--}}ikg(a){if(2!==a.behavior)return!0;a=this.Ca.dT(a.actionId);return!!a&&a.flags[32]}}Object(m.a)(LB,"ActivityActionListener",null,[141]);var ez;
(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(ez||(ez={}));Object(m.b)("ActivityAutoEndReason",ez);class MB{constructor(a){this.jia=new ui.a;this.jQb=a}Wgi(){for(let a of this.jia.keys)this.Xgi(a)}HXf(a){if(this.jQb.RHc)for(let b of this.jia.keys){const c=Array.clone(this.jia.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.u4d();this.Efh(b,a,l.uniqueID)}}}Xgi(a){var b=this.jia.ga(a);b=this.mcj(b);for(let c=0;c<b.length;c++){const f=b[c];f.u4d();this.Efh(a,
0,f.uniqueID)}}mcj(a){const b=[];for(let c=0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.cYg&&Array.add(b,f)}return b}Efh(a,b,c){const f={};f.AID=c;f.A=a;f.AE=ez[b];Nc.a.instance.Xb("AutoEnded",f)}wfl(){if(this.jQb.RHc){var a=new af.a(2,2,this.jQb.Ygi,Object(F.a)(this,this.Wgi,"autoEndLongRunningActivities"),67);u.AFrameworkApplication.ye.Db(a)}}register(a){if(this.jQb.RHc){var b=a.activityName;this.jia.Hb(b)&&this.jia.ga(b)||this.jia.$(b,[]);Array.add(this.jia.ga(b),a)}}unregister(a){if(this.jQb.RHc){var b=
a.activityName;this.jia.Hb(b)&&this.jia.ga(b)&&Array.remove(this.jia.ga(b),a)}}}Object(m.a)(MB,"ActivityAutoEndHelper",null,[441]);class Xt{constructor(a){this.s7e=null;this.LAc=0;this.yAd=this.zG=!1;this.RMd=0;this.Ux=new Yc.a;this.Tvb=new Yc.a;this.yMh=a}get XNd(){return this.s7e||(this.s7e=this.yMh())}get properties(){return this.Ux}get cYg(){return this.LAc}get enabled(){return this.zG}get ended(){return this.yAd}get uniqueID(){return this.RMd}AXg(){const a={};a.ID=this.uniqueID;a.A=this.activityName;
a.ST=this.startTime;a.ET=this.endTime;Pa.Ct(this.properties.keys)&&(a.P=Xt.r5f(this.properties));Pa.Ct(this.Tvb.keys)&&(a.FP=Xt.r5f(this.Tvb));return a}static r5f(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(m.a)(Xt,"AActivity",null,[443,444]);class NB extends Xt{constructor(a,b,c,f,l,x,H,U){super(H);this.Gt=0;this.AMh=a;this.WQh=b;this.Sga=c;this.Kj=(new Date).getTime();this.HWh=f;this.Gwd=x;this.LAc=l;this.Gwd.register(this);this.RMd=U()}get activityName(){return this.Sga}get startTime(){return this.Kj}get endTime(){return this.Gt}HRf(a){this.Gt=
(new Date).getTime();this.ended?this.URk():(this.yAd=!0,this.Gt=(new Date).getTime(),this.Gt<this.Kj&&(ia.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.Gt,this.Kj,this.Sga)),this.Gt=this.Kj),this.Gwd.unregister(this),this.HWh&&(!a&&this.XNd&&this.XNd.enabled?this.crb():this.A0b()))}end(){this.HRf(!1)}u4d(){this.HRf(!0)}URk(){const a={};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.WQh("AlreadyEnded",
this.endTime,a)}crb(){this.XNd.crb()}A0b(){this.AMh(this.AXg())}cancel(){this.ended||(this.yAd=!0,this.Gwd.unregister(this))}}Object(m.a)(NB,"ActivityImpl",Xt,[]);class kH extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(m.a)(kH,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Yt{constructor(a,b,c){this.Pa=new wc.a;this.zG=!0;this.settings=a;this.Hwd=b;this.Lwd=c}get enabled(){return this.zG&&this.settings.enabled}set enabled(a){this.zG=a}Vp(a,b=-1){-1===b&&(b=
this.settings.OJi);return this.Hwd(Object(F.a)(this,this.A0b,"completeActivity"),Object(F.a)(this,this.Ffh,"recordEventInternal"),a,this.uIj(a.toString()),b)}Xb(a,b=null){this.Ffh(a,(new Date).getTime(),b);this.Pa.raiseEvent("HHR",Object.assign(new kH,{name:a,properties:b}))}Ffh(a,b,c){this.eig(a)&&(a=this.m6f(a,c,b),ia.ULS.sendTraceTag(6068304,213,100,a))}Xna(a,b=null){this.eig(a.toString())&&(a=this.m6f(a.toString(),b,(new Date).getTime()),ia.ULS.sendTraceTag(6415520,213,100,a))}uIj(a){return this.enabled&&
!this.vIj(a)}eig(a){return this.enabled&&!this.FMj(a)}vIj(a){return this.settings.UMi.contains(a)}FMj(a){return this.settings.VMi.contains(a)}A0b(a){if(this.Lwd.WCf(a.A.toString())){var b=[];Array.add(b,a);a=xd.c(b);ia.ULS.sendTraceTag(5894867,213,100,a)}}m6f(a,b,c){const f={};f.ID=Yt.a5d();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return xd.c(a)}static a5d(){return Yt.H2h++}}Yt.H2h=0;Object(m.a)(Yt,"ActivityManagerImpl",null,[427]);class Wo{constructor(){this.zG=!1;this.r$e=this.b8e=0;this.a8e=
!1;this.X$e=new Oo.a;this.Y$e=new Oo.a}N3b(a){this.zG=Boolean.parse(a[Wo.zMj]||"false");this.X$e=this.e9g(a[Wo.TMi]);this.Y$e=this.e9g(a[Wo.WMi]);this.zUi(a)}get enabled(){return this.zG}get UMi(){return this.X$e}get VMi(){return this.Y$e}zUi(a){this.a8e=Boolean.parse(a[Wo.uJj]||"false");this.b8e=parseInt(a[Wo.Zgi]||"60000");this.r$e=parseInt(a[Wo.PJi]||"5000")}get Ygi(){return this.b8e}get OJi(){return this.r$e}get RHc(){return this.a8e}e9g(a){const b=new Oo.a;for(const c of(a||"").split(","))""!==
c&&b.add(c);return b}}Wo.zMj="ActivityLoggingIsEnabled";Wo.TMi="DisabledClientActivityNames";Wo.WMi="DisabledClientActivityEventNames";Wo.uJj="ActivityAutoEndEnabled";Wo.Zgi="ActivityAutoEndTaskInterval";Wo.PJi="ActivityDefaultMaxDuration";Object(m.a)(Wo,"ActivitySettings",null,[440]);class sv{constructor(a){this.Vzd=new Oo.a;this.rWb=new Yc.a;this.GEc=a;this.xfl()}xfl(){this.GEc.enabled&&(sv.Jpf=new af.a(2,2,this.GEc.interval,Object(F.a)(this,this.iOi,"doThrottle"),65),u.AFrameworkApplication.ye.Db(sv.Jpf))}iOi(){this.O1k()}O1k(){this.rWb=
new Yc.a;this.Vzd=new Oo.a}wIj(a){return this.Vzd.contains(a)}Ayl(a){if(this.rWb.Hb(a)){if(this.rWb.ga(a)>=this.GEc.Ckk)return this.Vzd.add(a),ia.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.rWb).$(a,b.ga(a)+1)}else this.rWb.add(a,1);return!0}WCf(a){return this.GEc.enabled?!this.wIj(a)&&this.Ayl(a):!0}}sv.Jpf=null;Object(m.a)(sv,"ActivityThrottler",null,[439]);class Ur{constructor(){this.zG=!1;this.ief=this.oif=0}N3b(a){this.zG=Boolean.parse(a[Ur.a1d]||
"false");this.oif=parseInt(a[Ur.Dkk]||"600");this.ief=parseInt(a[Ur.lHj]||"600000")}get enabled(){return this.zG}get Ckk(){return this.oif}get interval(){return this.ief}}Ur.a1d="ActivityThrottlerEnabled";Ur.Dkk="ActivityThrottlerMaxActivities";Ur.lHj="ActivityThrottlerInterval";Object(m.a)(Ur,"ActivityThrottlerSettings",null,[424]);class OB{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.RDj()}RDj(){const a=this.Da.resolve("Common.App.Activities.IActivitySettings"),
b=u.AFrameworkApplication.fa.appSettings;a.N3b(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").N3b(b);if(a.enabled){Nc.a.instance=new Yt(this.Da.resolve("Common.App.Activities.IActivitySettings"),(l,x,H,U,ja)=>new NB(l,x,H,U,ja,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.ub("Common.App.Activities.IActivityAggregationManager"),Yt.a5d),this.Da.resolve("Common.App.Activities.IActivityThrottler"));var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),
f=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.wfl();u.AFrameworkApplication.pga(()=>{f.nui();c.HXf(1)});u.AFrameworkApplication.Ta.oaa(f);u.AFrameworkApplication.rGc((l,x)=>{Nc.a.instance.Xna(x.errorCode,{["ErrorCause"]:x.N1d,["ErrorResolution"]:x.O1d});c.HXf(2)})}}dispose(){}Zb(a){this.Da=a;a.register(Wo,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(MB,"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().oa(()=>
new MB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(LB,"Common.App.Activities.ActivityActionListener").oa(()=>new LB(u.AFrameworkApplication.Ta,a.resolve("Common.IActivityManager")));a.register(Ur,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().oa(()=>new Ur);a.register(sv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().oa(()=>new sv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){z.a.instance.Dc(new OB)}}
Object(m.a)(OB,"ActivitiesPackage",null,[2,3]);class lH{constructor(){this.Dpa=new Yc.a}SUe(a,b){this.Dpa.$(a,b)}k5d(a){({value:a}=this.Dpa.Uf(a));return a}}Object(m.a)(lH,"AggregationMethodsForActivityName",null,[]);class PB{constructor(){this.qCc=new ui.a;this.Dpa=new ui.a}SUe(a,b,c){this.Dpa.Hb(a)&&this.Dpa.ga(a)||this.Dpa.$(a,new lH);this.Dpa.ga(a).SUe(b,c)}k5d(a,b){return this.Dpa.Hb(a)&&this.Dpa.ga(a)?this.Dpa.ga(a).k5d(b):null}X5b(a){this.qCc.Hb(a)&&this.qCc.ga(a)||this.qCc.$(a,new Oo.a);return this.qCc.ga(a)}nJi(a,
b){this.X5b(a).add(b)}}Object(m.a)(PB,"ActivityAggregationInfo",null,[466]);class lx extends Xt{constructor(a,b){super(a);this.RMd=(this.zMh=b)?b.W9i():Yt.a5d()}get qia(){return this.zMh}get activityName(){return this.qia.name}get startTime(){return this.qia.startTime}get endTime(){return this.qia.endTime}end(){}cancel(){}u4d(){}HDl(){this.Tvb.$("AM",this.qia.mode.toString());this.Tvb.$("C",this.qia.count.toString());this.Tvb.$("DA",this.qia.nQf.toFixed(2));this.Tvb.$("DV",this.qia.qPi.toFixed(2))}n9d(a){return this.qia.n9d(a)}N9d(){return this.qia.N9d()}crb(){for(let a of this.qia.ria)a.crb()}}
Object(m.a)(lx,"AggregatedActivity",Xt,[]);class mH{constructor(a,b){this.Zwd=0;this.Sga=a;this.Sza=b}Sci(a,b){this.Zwd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.Tci(c)}}Tci(a){const b=Object(oa.a)(lx,a);if(b)if(1===this.Zwd)this.Pci(b);else if(2===this.Zwd){this.Uci(b);for(let c of this.Sza.X5b(this.Sga)){const f=b.qia.ria.ga(0);f.properties.Hb(c)&&a.properties.$(c,f.properties.ga(c))}}}Pci(a){for(let b of this.Sza.X5b(this.Sga))this.rmh(a,b)}Uci(a){for(let b of a.N9d())this.rmh(a,b)}rmh(a,b){const c=
this.Sza.k5d(this.Sga,b);if(c){const f=a.n9d(b);a.properties.$(b,c(f))}}}Object(m.a)(mH,"PropertyAggregationHelper",null,[]);class QB{constructor(a,b,c,f,l){this.Gmb=a;this.Sza=b;this.K9e=l;this.Lwd=f;this.lVh=c}get Lrf(){return this.lVh.value}A0b(a){if(Object(Xa.a)(NB,a))a.A0b();else if(Object(Xa.a)(lx,a)&&this.Lwd.WCf(a.activityName.toString())){a=Object(oa.a)(lx,a);a.HDl();a=a.AXg();var b=[];Array.add(b,a);a=xd.c(b);ia.ULS.sendTraceTag(6907266,213,50,a)}}SYb(a,b){const c=(new Date).getTime();var f=
this.K9e.list.ga(a);const l=({Vci:f}=this.P2i(f)).returnValue;this.K9e.list.$(a,new Ka.a);b&&(f=this.rBi(f,c,this.Gmb.u9f));0<f.count&&(new mH(a,this.Sza)).Sci(f,l)}rBi(a,b,c){const f=new Ka.a;for(let l=0;l<a.count;l++){const x=a.ga(l);x.startTime>b-c?x.crb():f.add(x)}return f}P2i(a){const b=this.Lrf.RBh(a);a=this.Lrf.xvl(a);const c=this.Wci(b,a);return{returnValue:c,Vci:1===c?b:a}}Wci(a,b){return a.count*this.Gmb.lZg<b.count?1:2}get enabled(){return this.Gmb.enabled}crb(){}}Object(m.a)(QB,"ActivityAggregationManager",
null,[445]);class Bo{constructor(a){this.enabled=!1;this.jYg=500;this.SYg=2;this.osd=6E4;this.lZg=5;this.u9f=3E4;this.N3b(a.appSettings)}N3b(a){this.enabled=Boolean.parse(a[Bo.a1d]||"false");this.jYg=parseInt(a[Bo.Skk]||"500");this.SYg=parseInt(a[Bo.emk]||"2");this.osd=parseInt(a[Bo.Jtl]||"60000");this.lZg=parseInt(a[Bo.smk]||"5");this.u9f=parseInt(a[Bo.Bpj]||"30000")}}Bo.a1d="ActivityAggregationEnabled";Bo.Skk="ActivityAggregationMaxInterval";Bo.emk="ActivityAggregationMinChain";Bo.Jtl="ActivityAggregationTaskInterval";
Bo.smk="ActivityAggregationModeFactor";Bo.Bpj="ActivityAggregationGraceWindow";Object(m.a)(Bo,"ActivityAggregationParams",null,[]);class RB{constructor(a,b){this.Sza=a;this.t7e=b}RBh(a,b=1){if(!a||!a.count)return a;const c=new Ka.a;var f=null;for(let l=0;l<a.count;l++){const x=a.ga(l);if(!x)continue;const H=x.activityName;f?f.vXj(x)?f.add(x):(f=f.process(),c.addRange(f),f=this.t7e(H,b),f.add(x)):(f=this.t7e(H,b),f.add(x))}f&&(a=f.process(),c.addRange(a));return c}xvl(a){if(!a||!a.count)return a;const b=
{};var c=null;for(let l=0;l<a.count;l++){const x=a.ga(l);if(x){if(!c){c=new Ka.a;var f=this.Sza.X5b(x.activityName);for(let H of f)c.add(H)}f=this.cgj(x,c);null!==f&&(f in b&&b[f]||(b[f]=new Ka.a),b[f].add(x))}}a=new Ka.a;for(const l of pa.a.lL(b))c=this.RBh(b[l],2),a.addRange(c);return a}cgj(a,b){let c="";for(let f of b)c+=f,c=a.properties.Hb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(m.a)(RB,"ActivityAggregationSchemes",null,[423]);
class nH{constructor(a,b,c,f,l){this.Gt=this.Kj=0;this.Gmb=c;this.Hwd=f;this.Sza=l;this.name=a;this.Py=b;this.ria=new Ka.a}get mode(){return this.Py}get count(){return this.ria.count}get startTime(){return this.Kj}get endTime(){return this.Gt}get nQf(){if(!this.count)return 0;let a=0;for(let b of this.ria)a+=b.endTime-b.startTime;return a/this.count}get qPi(){if(!this.count)return 0;let a=0;const b=this.nQf;for(let c of this.ria){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?
this.Gt=a.endTime>this.endTime?a.endTime:this.endTime:(this.Kj=a.startTime,this.Gt=a.endTime);this.ria.add(a)}vXj(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.Gmb.jYg}process(){if(this.count>=this.Gmb.SYg){const a=new Ka.a,b=this.Hwd(this);a.add(b);return a}return this.ria}n9d(a){const b=new Ka.a;for(let c of this.ria)if(c.properties.Hb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}N9d(){const a=this.Sza.X5b(this.name),b=new Oo.a;for(let c of this.V2i())a.contains(c)||
b.add(c);return b}V2i(){const a=new Oo.a;if(!this.ria)return a;for(let b of this.ria)for(let c of b.properties.keys)a.add(c);return a}W9i(){return this.ria.ga(0).uniqueID}}Object(m.a)(nH,"ActivityCollection",null,[422]);class SB{constructor(){this.x2a=new ui.a}get list(){return this.x2a}add(a){const b=a.activityName;if(this.x2a.Hb(b)&&this.x2a.ga(b)){const c=this.saj(this.x2a.ga(b),a);this.x2a.ga(b).insert(c,a)}else this.x2a.$(b,new Ka.a),this.x2a.ga(b).add(a)}saj(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>
a.ga(c).startTime)return c+1;return 0}}Object(m.a)(SB,"CompletedActivitiesHelper",null,[421]);class TB{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.pga(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Zb(a){this.Da=a;const b=f=>new lx(()=>a.ub("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new nH(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));
a.register(QB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().oa(()=>new QB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.ie("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Bo,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().oa(()=>
new Bo(u.AFrameworkApplication.fa));a.register(PB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().oa(()=>new PB);a.register(RB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().oa(()=>new RB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(SB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().oa(()=>new SB)}static main(){z.a.instance.Dc(new TB)}}
Object(m.a)(TB,"ActivityAggregatorPackage",null,[2,3]);var oH=d(16);class ar{constructor(){this.G3k="getAddinShortcutsPreference";this.H3k="saveAddinShortcutsPreference";this.I3k="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.I2i=6E4;this.Ddd=this.l8=this.NY=null}P5f(a){return String.format(this.I3k,u.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",a,u.AFrameworkApplication.gh)}executeRequest(a,b,c,f,l=null){return ar.yca.Wqb(a,b,l,null,2,c,f,!1,null,this.I2i)}saveSetting(a,
b,c,f,l){return this.wnh(a,b,c,null,f,l)}startBatchUpdateScope(){this.Ddd=[]}saveShortcutInfoArrayBatch(a,b,c){this.w5k(c,a,b)}w5k(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.kOd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;b=new oH.a(c.toString(),a);this.Ddd.push(b)}commitBatchUpdateScope(){return this.irc()?this.y5k().then(()=>{this.usb();return Promise.resolve(!0)}):
this.A5k().then(()=>{this.usb();return Promise.resolve(!0)})}y5k(){return this.getSetting().then(a=>{let b=null;if(a&&!({rv:b}=xd.d(a)).returnValue)return ia.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.Ddd){(a=b[c.key])||(a={});const f=c.value;for(const l of pa.a.lL(f))a[l]=f[l];b[c.key]=a}this.NY=b;try{return localStorage.setItem("AddinShortcutPreferenceData",xd.c(b)),Promise.resolve(!0)}catch(c){return ia.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}A5k(){return this.E8k().then(a=>this.$md(a))}E8k(){return this.T9d().then(a=>{let b=null;a&&(({rv:b}=xd.d(a)).returnValue||ia.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));b||(b={});for(const c of this.Ddd){(a=b[c.key])||(a={});const f=c.value;for(const l of pa.a.lL(f))a[l]=f[l];b[c.key]=a}this.NY=b;return xd.c(b)})}saveShortcutInfoArray(a,
b,c){return this.wnh(0,"","",c,a,b)}wnh(a,b,c,f,l,x){const H=this.irc(),U={};U.action=c;U.addinId=b;U.ownerType=a;U.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),x.toString());0===a&&f?(U.shortcutInfoArray=f,this.kOd(l,x,f)):b&&(U.shortcutInfoArray=b);a={};a[l.toString()]=U;l=new oH.a(x.toString(),a);return H?this.x5k(l):this.z5k(l)}x5k(a){return this.getSetting().then(b=>{let c=null;if(b&&!({rv:c}=xd.d(b)).returnValue)return ia.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.NY=c;try{return localStorage.setItem("AddinShortcutPreferenceData",xd.c(c)),Promise.resolve(!0)}catch(f){return ia.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}z5k(a){return this.D8k(a).then(b=>this.$md(b))}D8k(a){return this.T9d().then(b=>{let c=null;b&&(({rv:c}=xd.d(b)).returnValue||ia.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
c||(c={});c[a.key]=a.value;this.NY=c;return xd.c(c)})}saveSettings(a){this.NY=xd.a(a);this.usb();return this.irc()?this.xnh(a):this.$md(a)}xnh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return ia.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}$md(a){const b={};b.Wac=a;const c=xd.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.P5f(this.H3k),
2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.Tn||l.tm)ia.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var x=l.result;void 0!==x.Wi&&null!==x.Wi&&void 0!==x.Wi.data&&null!==x.Wi.data&&x.Wi.data.oe===dl.a.Uv?f(!0):f(!1)}})}}catch(x){ia.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",x.toString()),f(!1)}})}getSetting(){const a=this.irc();return this.NY?Promise.resolve(xd.c(this.NY)):a?this.Nij():
this.T9d()}irc(){const a=u.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=u.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}Nij(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return ia.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}T9d(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.P5f(this.G3k),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.Tn||c.tm)ia.ULS.sendTraceTag(522739862,
0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.Wi&&f.Wi.data?f.Wi.data.oe!==dl.a.Uv?ia.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.Wi.data.oe):f.Wi.data.Sd?(f=xd.a(f.Wi.data.Sd),f.Wac&&(l=f.Wac)):ia.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):ia.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){ia.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",
c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.irc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=xd.a(f));if(!l)return ia.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const x of pa.a.lL(l)){f=l[x.toString()];for(const H of pa.a.lL(f)){const U=f[H];if(U.addinId===a)delete f[H.toString()];else if(0===U.ownerType&&U.shortcutInfoArray){const ja=U.shortcutInfoArray,ya=new Ka.a;
for(let Va=0;Va<ja.length;++Va)ja[Va].addinId!==a&&ya.add(ja[Va]);U.shortcutInfoArray=ya.toArray()}}pa.a.count(f)||delete f[x]}c.NY=l;c.xWk(a);return b?c.xnh(xd.c(l)):c.$md(xd.c(l))})}usb(){if(this.NY){this.l8=null;const c=this.NY;for(let f in c){var a=f;const l=c[f];for(let x in l){var b=x;const H=l[x];H.shortcutInfoArray&&this.kOd(parseInt(b),parseInt(a),H.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({rv:b}=xd.d(a)).returnValue)return ia.ULS.sendTraceTag(522739868,
0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.NY=b;this.usb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.NY&&(c=this.NY[c])&&(b=c[b])&&b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.NY&&(b=this.NY[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,
b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.usb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.l8)return Promise.resolve(!0);var c=this.l8[a];if(!c)return Promise.resolve(!0);var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let x=0;for(const H of l){if(H.addinId===a&&H.action===b)break;++x}if(x>=l.length)return Promise.resolve(!0);l.splice(x,
1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.usb();return Promise.resolve(!0)})}kOd(a,b,c){this.l8||(this.l8={});for(const f of c){c=f.addinId;const l=f.action;let x=this.l8[c];x||(x={});const H={};H.modifiers=a;H.keyCode=b;x[l]=H;this.l8[c]=x}}xWk(a){a in this.l8&&delete this.l8[a]}isActionCustomized(a,b){return this.l8&&(a=this.l8[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.l8&&(a=this.l8[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.NY}static instance(){ar.SPd||
(ia.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),ar.SPd=new ar,ar.yca=u.AFrameworkApplication.Ke);return ar.SPd}}ar.SPd=null;ar.yca=null;Object(m.a)(ar,"AddinShortcutsPreferenceSettingHelper",null,[]);class pH{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=
this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(pH,"BrowserInfo",null,[]);class qH{constructor(){this.Version=this.Name=null}}Object(m.a)(qH,"PluginInfo",null,[]);class mk{static P2j(){if(u.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=
mk.W0i();try{const b=JSON.stringify(a);ia.ULS.sendTraceTag(6903563,102,50,b)}catch(b){ia.ULS.sendTraceTag(6903564,102,15,b.message)}}else ia.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static rfj(){const a=window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new qH,{Name:f,Version:l}))}return b}static W0i(){const a=new pH,b=new Sys.StringBuilder;mk.VA(c=>{a.DocElemClientHeight=
c},()=>document.documentElement.clientHeight,b);mk.VA(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);mk.VA(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);mk.VA(c=>{a.DocElemOffsetWidth=c},()=>document.documentElement.offsetWidth,b);mk.VA(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);mk.VA(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);mk.VA(c=>{a.ScreenWidth=c},()=>window.screen.width,b);mk.VA(c=>{a.ScreenHeight=c},()=>window.screen.height,
b);mk.VA(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);mk.VA(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);mk.VA(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);mk.VA(c=>{a.ScreenDeviceYdpi=c},()=>window.screen.deviceYDPI,b);mk.VA(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);mk.VA(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);mk.VA(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);mk.VA(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);
mk.VA(c=>{a.WinOrientation=c},()=>window.self.orientation,b);mk.VA(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);mk.VA(c=>{a.SupportsTouch=c},()=>B.a.BLa,b);mk.VA(c=>{a.NavAppName=c},()=>window.navigator.appName,b);mk.VA(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);mk.VA(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);mk.VA(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);mk.VA(c=>{a.NavPlatform=c},()=>window.navigator.platform,
b);mk.VA(c=>{a.NavPlugins=c},mk.rfj,b);mk.VA(c=>{a.CalculatedDevicePixelRatio=c},()=>mk.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static VA(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(m.a)(mk,"BrowserInfoLogger",null,[]);class UB{get name(){return"Common.App.BrowserInfoLogger"}Zb(){}init(){mk.P2j()}dispose(){}static main(){z.a.instance.Dc(new UB)}}
Object(m.a)(UB,"BrowserInfoLoggerPackage",null,[2,3]);class VB{get name(){return"Common.App.DialogWithLinkToResource"}Zb(){}init(){}dispose(){}static main(){z.a.instance.Dc(new VB)}}Object(m.a)(VB,"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var gQ=d(710);class WB{get name(){return"Common.App.EventsCachePackage"}Zb(){}init(){gQ.a.instance.init()}dispose(){}static main(){z.a.instance.Dc(new WB)}}Object(m.a)(WB,"EventsCachePackage",null,[2,3]);class XB{constructor(a,b,c){this.d5a=null;this.Zd=
a;this.Ca=b;this.Vbf=c.create()}$nc(){this.d5a?ia.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ia.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.d5a=new af.a(2,1,3E4,Object(F.a)(this,this.tqd,"showFloatPane"),67),this.Zd.Db(this.d5a))}tqd(){this.d5a=null;ia.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Vbf.display()}Uxa(){this.Ca.ya(G.a.tqd,de.a.frame,Object(F.a)(this,this.Skl,
"showFloatPaneHandler"))}Skl(a,b,c,f,l){return a!==G.a.tqd?2:1===c?32:2===c&&l?(ia.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.$nc():(this.d5a?(ia.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Zd.Lg(this.d5a)):(ia.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Vbf.remove(null)),this.d5a=null),32):8}}Object(m.a)(XB,"FloatPaneActor",null,[414]);class rH{constructor(a,b,c,f,
l){this.sFd=this.ZSb=this.SCc=this.bBa=this.A2=this.aAa=this.Txd=this.zZ=this.uVb=this.yUb=this.zUb=this.eBd=null;this.Zd=b;this.$a=a;this.Ln=c;this.Da=l;this.Vga=f}CJf(){this.zZ=document.createElement("div");this.zZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.zZ.style.width=this.A2.width+"px";(this.sFd=this.dej(this.Vga))?(this.bBa=document.createElement("a"),this.bBa.setAttribute(Cc.a.ef,Cc.a.nN),this.Ln.pb(ta.a.click,this.bBa,Object(F.a)(this,this.h5g,"onRedirectClick")),
this.bBa.href=this.sFd,this.bBa.target="_blank",this.bBa.appendChild(this.A2),this.zZ.appendChild(this.bBa)):this.zZ.appendChild(this.A2);this.aAa=document.createElement("a");this.aAa.setAttribute(Cc.a.ef,Cc.a.yu);this.aAa.className="StandardButton WACFloatPaneCloseButton";this.aAa.title=CommonUIStrings.l_Close;this.aAa.tabIndex=-1;this.Txd=Ro.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Txd.setAttribute(Cc.a.ef,Cc.a.nN);
this.aAa.appendChild(this.Txd);this.Ln.pb(ta.a.click,this.aAa,Object(F.a)(this,this.onClose,"onClose"));this.zZ.appendChild(this.aAa);this.uVb.appendChild(this.zZ)}qk(a){const b=this.$a.ka("O365PromotionHasStarted");switch(a){case 2:return rn.a.XK(String.format("adppt{0}.png",b?"sale":""));case 1:return rn.a.XK(String.format("adxls{0}.png",b?"sale":""));case 3:return rn.a.XK(String.format("addoc{0}.png",b?"sale":""))}return null}dej(a){const b=this.$a.Ga("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,
"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.ZSb=null;this.zZ&&!this.SCc&&(a?ia.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):ia.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.zZ.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.zZ.style.height="0px",this.SCc=new af.a(2,1,1E3,Object(F.a)(this,this.remove,"remove"),67),this.Zd.Db(this.SCc))}remove(){this.zZ&&
this.uVb&&(this.bBa&&this.Ln.yb(ta.a.click,this.bBa,Object(F.a)(this,this.h5g,"onRedirectClick")),this.Ln.yb(ta.a.click,this.aAa,Object(F.a)(this,this.onClose,"onClose")),this.uVb.removeChild(this.zZ),this.zZ=null);this.SCc=null}display(){if(this.eBd=this.Da.ub("Common.IFloatPaneContainer"))if(this.uVb=this.eBd.container){var a=this.qk(this.Vga);a?(ia.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.A2=document.createElement("img"),this.A2.className="WACFloatPaneImage",
this.zUb=Object(F.a)(this,this.Puk,"onLoadImageFinish"),Id.a.addHandler(this.A2,ta.a.load,this.zUb),this.yUb=Object(F.a)(this,this.Ouk,"onLoadImageError"),Id.a.addHandler(this.A2,ta.a.error,this.yUb),this.A2.src=a):ia.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ia.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ia.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Puk(){const a=
this.$a.Bc("O365AdPaneShowingDuration",60);this.CJf();this.zZ.style.display="block";this.zZ.style.height=this.A2.height+"px";this.ZSb=new af.a(2,1,1E3*a,Object(F.a)(this,this.hide,"hide"),67);this.Zd.Db(this.ZSb);this.whh()}Ouk(){ia.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.whh();this.A2=null}whh(){this.zUb&&this.A2&&Id.a.removeHandler(this.A2,ta.a.load,this.zUb);this.zUb=null;this.yUb&&this.A2&&Id.a.removeHandler(this.A2,ta.a.error,this.yUb);
this.yUb=null}h5g(){ia.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.ZSb&&this.Zd.Lg(this.ZSb);this.hide();return!0}dispose(){this.hide()}}Object(m.a)(rH,"FloatPane",null,[438]);class YB{constructor(a,b,c,f,l){this.Zd=b;this.$a=a;this.Ln=c;this.Da=l;this.Vga=f}create(){return new rH(this.$a,this.Zd,this.Ln,this.Vga,this.Da)}}Object(m.a)(YB,"FloatPaneFactory",null,[413]);class ZB{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get Jig(){return u.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&
u.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.Jig&&(ia.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").$nc(),ia.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").Uxa())}Zb(a){this.Da=a;this.Jig&&(this.Da.register(YB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").oa(()=>
new YB(u.AFrameworkApplication.fa,u.AFrameworkApplication.ye,Dd.a.instance,u.AFrameworkApplication.Aa.hb.Uk,this.Da)).ma(),this.Da.register(XB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").oa(()=>new XB(u.AFrameworkApplication.ye,u.AFrameworkApplication.Ta,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){z.a.instance.Dc(new ZB)}}Object(m.a)(ZB,"FloatPanePackage",null,[2,3]);const sH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);
0>a&&(a+=2*Math.PI);return a};class hQ{constructor(a,b,c){this.IP=this.Qnb=this.mqb=null;this.Vza=this.ozd=this.Jpa=0;this.CG=this.Lzc=this.yyc=this.xyc=!1;this.BCd=this.Qdf=this.Sdf=0;this.ONa=a;this.Ca=b;this.GZ=c}Cv(a){return Oc.App.Kb.Kd.isEditingAllowed?""!==this.MSc(a.Ec):!1}Tu(a){if(!this.Cv(a))return!1;this.Vza=this.ONa.GMl();this.Gcl(a);this.Hcl();({Vje:this.Lzc,Eme:this.CG}=this.grh(this.ozd));this.Icl();this.mqb=a.KE;this.IP=new Sys.UI.Point(0,0);({width:this.Sdf,height:this.Qdf}=this.ONa.kSc());
ia.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}Cw(a){this.Qnb=a.KE;this.Rni();var b=this.IP.x,c=this.IP.y;a=this.Sdf;var f=this.Qdf,l=this.Lzc,x=this.CG,H=1;(b||c)&&a&&f&&(l&&x?(H=a+b,l=f+c,b=1/a,c=1/f,x=b>c?b:c,1>H?H=1:1920<H&&(H=1920),1>l?l=1:1280<l&&(l=1280),b=H-a,c=l-f,H=Math.abs(b/a)>Math.abs(c/f)?H/a:l/f,H<x&&(H=x)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),H=b/a):x&&(b=f+c,1>b?b=1:1280<b&&(b=1280),H=b/f));a=H;this.BCd=a;this.ONa.AOl(this.BCd,this.Lzc,this.CG);return!0}ao(){this.lh();
ia.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}ou(){this.ONa.PNl();ia.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}Hcl(){this.ozd=(Math.floor((this.Vza+22)/45)%8+this.Jpa)%8}grh(a){let b,c;if(this.Vza&&90!==this.Vza&&180!==this.Vza&&270!==this.Vza&&360!==this.Vza||this.ROj(a))return{Vje:!0,Eme:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{Vje:b,Eme:c}}Icl(){this.yyc=this.xyc=!1;switch(this.ozd){case 0:this.yyc=this.xyc=!0;break;case 1:case 2:this.yyc=
!0;break;case 7:case 6:this.xyc=!0}}ROj(a){return!(a%2)}MSc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}Gcl(a){switch(this.MSc(a.Ec)){case "WACImageResizeHandleNW":this.Jpa=0;break;case "WACImageResizeHandleN":this.Jpa=1;break;case "WACImageResizeHandleNE":this.Jpa=2;break;case "WACImageResizeHandleE":this.Jpa=
3;break;case "WACImageResizeHandleSE":this.Jpa=4;break;case "WACImageResizeHandleS":this.Jpa=5;break;case "WACImageResizeHandleSW":this.Jpa=6;break;case "WACImageResizeHandleW":this.Jpa=7}}Rni(){var a=1;this.GZ.instance&&(a=this.GZ.instance.i3);const b=(this.Qnb.x-this.mqb.x)/a;a=(this.Qnb.y-this.mqb.y)/a;this.IP.x=this.xyc?-b:b;this.IP.y=this.yyc?-a:a}lh(){const a=new J.DictionaryPropertySet;a.setValue(Mc.a.EBj,100*this.BCd);a.setValue(Mc.a.FBj,!0);if(90===this.Vza||270===this.Vza){let b,c;({Vje:b,
Eme:c}=this.grh(this.Jpa));a.setValue(Mc.a.odg,b);a.setValue(Mc.a.pdg,c)}else a.setValue(Mc.a.odg,this.Lzc),a.setValue(Mc.a.pdg,this.CG);this.Ca.La(D.a.CBj,2,a)}}Object(m.a)(hQ,"ImageResizeDragAdapter",null,[240]);class $B{constructor(a,b){this.Ca=a;this.GZ=b}}Object(m.a)($B,"ImageResizeDragAdapterFactory",null,[363]);class tH{constructor(a,b,c,f,l,x){this.Ppb=this.jDc=this.FCd=this.Qnb=this.mqb=this.kDc=null;this.LBc=this.tFc=0;this.Ux=null;this.oo=!1;this.Ca=a;this.Tc=b;this.Kg=c;this.ONa=f;this.GZ=
l;this.Khf=this.aia=0;this.Vpb=x}Cv(a){return Oc.App.Kb.Kd.isEditingAllowed&&a?(this.kDc=this.Tc.Pj)?!0:!1:!1}Tu(a){if(!this.Cv(a))return!1;this.kDc=this.Tc.Pj;if(this.Ux=rd.ImageReader.eEa(this.kDc))return this.mqb=this.lta(a),this.FCd=Sys.UI.DomElement.getBounds(this.Vpb),this.tFc=0<rd.ImageReader.D2f(this.Ux)?rd.ImageReader.D2f(this.Ux):0,this.LBc=rd.ImageReader.jaj(this.Ux),ia.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;ia.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");
return!1}Cw(a){this.Qnb=this.lta(a);this.Tni();if(this.ONa)return this.ONa.kFl(this.aia,this.Khf),ia.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;ia.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}ao(){var a=this.aia;a%=360;0>a&&(a+=360);this.tFc=this.aia=a;this.setRotation();ia.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}ou(){this.ONa.kFl(this.LBc,0);ia.ULS.sendTraceTag(22052888,322,50,
"Image rotate drag event canceled.")}lta(a){return this.Kg.Xja(a)}Tni(){var a=1;this.GZ&&this.GZ.instance&&(a=this.GZ.instance.i3);var b=new Sys.UI.Point(this.FCd.x+this.Vpb.clientWidth/2*a,this.FCd.y+this.Vpb.clientHeight/2*a);a=sH(this.mqb,b);b=sH(this.Qnb,b);this.aia=Math.round(ye.a.YO(b-a));0<this.tFc&&(this.aia+=this.tFc-this.LBc);this.Khf=this.aia;this.aia+=this.LBc}setRotation(){const a=new J.DictionaryPropertySet;a.setValue(Mc.a.DBj,0);a.setValue(Mc.a.w8b,this.aia);this.Ca.La(D.a.imageRotate,
2,a)}dispose(){ia.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.oo||(this.Ppb&&(this.jDc&&this.Ppb.contains(this.jDc)&&(this.Ppb.removeChild(this.jDc),this.jDc=null),this.Vpb&&this.Vpb.contains(this.Ppb)&&(this.Vpb.removeChild(this.Ppb),this.Ppb=null)),this.oo=!0)}}Object(m.a)(tH,"ImageRotateDragAdapter",null,[411,240,106]);class aC{constructor(a,b,c){this.Ca=a;this.Tc=b;this.GZ=c}create(a,b,c){return new tH(this.Ca,this.Tc,a,b,this.GZ,c)}}Object(m.a)(aC,"ImageRotateDragAdapterFactory",
null,[362]);class bC{constructor(){this.Da=null}get name(){return"Box4.Images"}Zb(a){this.Da=a;this.Da.register($B,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().oa(()=>new $B(u.AFrameworkApplication.Ta,Db.a.instance.Ja("Common.IZoomManager")));this.Da.register(aC,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().oa(()=>new aC(u.AFrameworkApplication.Ta,qd.a.instance,Db.a.instance.Ja("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){z.a.instance.Dc(new bC)}}
Object(m.a)(bC,"Box4ImagesPackage",null,[2,3]);class uH{create(a){return new Eg.a(a)}}Object(m.a)(uH,"Factory",null,[377]);var fz=d(442);class vH{constructor(){this.Ii=null}get key(){return"COMMENTTEXTANCHOR"}get e8(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Ii=Object(oa.a)(Mb.AParagraphNode,a.node)}Qtc(a){a=(a=this.N5i(a))?Object.assign(new fz.a,{a1:this.key,bQ:a}):null;return{returnValue:!!a,KBa:a}}N5i(a){if(!this.Ii.Ra)return null;const b=new Ka.a;for(let c=0;c<this.Ii.Ra.length;c++){const f=
this.Ii.Ra.ga(c);if(f.cp>a)break;if(f.yg)for(let l=0;l<f.yg.length;l++){const x=f.yg.ga(l);x.wk?b.add(x.uI.Bq.toString()):b.remove(x.uI.Bq.toString())}}return 0<b.count?b.ga(0):null}}Object(m.a)(vH,"CommentTextAnchorDetailsProvider",null,[521,519]);class mx{constructor(){this.Ii=null}get e8(){return null}getTitle(){return null}P0f(){return null}reset(a){this.Ii=a.node}Qtc(a){const b=gf.d(this.Ii,a);a=null;if(!b||b.Wq!==this.Wq)return{returnValue:!1,KBa:a};a=Object.assign(new fz.a,{a1:this.key,bQ:b,
title:this.getTitle(b),description:this.P0f(b)});return{returnValue:!0,KBa:a}}}Object(m.a)(mx,"BlobDetailsProvider",null,[521,519]);class wH extends mx{constructor(){super()}get key(){return"EQUATION"}get Wq(){return 11}get e8(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(wH,"EquationDetailsProvider",mx,[]);class xH{constructor(){this.Ddf=null}get key(){return"LINK"}get e8(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.Ddf=oc.HyperlinkReader.E5b(a.node)}Qtc(a){let b;
b=null;for(const c of this.Ddf)if(c.Qa<=a&&a<c.Mb)return b=Object.assign(new fz.a,{a1:this.key,bQ:c.hyperlink}),{returnValue:!0,KBa:b};return{returnValue:!1,KBa:b}}}Object(m.a)(xH,"HyperlinkDetailsProvider",null,[521,519]);class yH extends mx{constructor(){super()}get key(){return"IMAGE"}get Wq(){return 5}get e8(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return rd.ImageReader.QSc(a.properties)}P0f(a){return rd.ImageReader.C7d(a.properties)}}Object(m.a)(yH,"ImageDetailsProvider",
mx,[]);class gz{constructor(){this.description=this.contentId=this.bQ=this.a1=null}}Object(m.a)(gz,"StructuralContentDetails",null,[547]);class zH{get key(){return"IMAGENODE"}get e8(){return Box4Intl.Box4Strings.l_ImageContentTitle}e3e(a){let b;b=null;if(!a||!rd.ImageReader.iH(a.currentNode))return{returnValue:!1,Itb:b};b=Object.assign(new gz,{a1:this.key,contentId:a.currentNode.id,bQ:a.currentNode});return{returnValue:!0,Itb:b}}$Rc(a,b){a=a.bQ;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.bQ.id||(f=String.format(c,rd.ImageReader.QSc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(m.a)(zH,"ImageNodeDetailsProvider",null,[518,519]);let nx,ox;class Vr{constructor(a,b){this.fbf=null;this.Gm=b;this.GId=a;this.bUb=Vr.keys.ga(a);this.gPh=Vr.Nzi.ga(a)}get key(){return this.bUb}get e8(){return this.gPh}reset(a){this.fbf=this.Gm.GF(a.node)}Qtc(a){var b=Vr.OYi(this.fbf||[],c=>this.sLj(a,c));b=this.ICi(b);return{returnValue:!!b,KBa:b}}sLj(a,b){return b.begin<=
a&&a<b.end&&(!b.Gh||this.GId===b.Gh.proofingType)}ICi(a){return a?Object.assign(new fz.a,{a1:this.key,bQ:a.Gh,description:this.h6d()}):null}h6d(){return u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static OYi(a,b){for(const c of a)if(b(c))return c;return null}}Vr.keys=(ox=new Kb.a,ox.add(1,"SPELLINGERROR"),ox.add(2,"GRAMMATICALERROR"),ox.add(3,"ADVANCEDERROR"),ox);Vr.Nzi=(nx=new Kb.a,
nx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),nx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),nx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),nx);Object(m.a)(Vr,"ProofingDetailsProvider",null,[521,519]);class AH{constructor(){this.tableNode=null;this.cKc=this.Gmd=this.columns=this.rows=0}}Object(m.a)(AH,"TableInfo",null,[]);var Hn=d(148),Vd=d(85),tk=d(127);class BH{get key(){return"TABLE"}get e8(){return Box4Intl.Box4Strings.l_TableContentTitle}e3e(a){var b=
null;if(!Le.isTableCell(a))return{returnValue:!1,Itb:b};b=new tb.GraphIterator;b.Rc(a);a=new AH;a.Gmd=tk.c(b)+1;a.cKc=Hn.a(b)+1;Vd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=od.TableReader.Ai(a.tableNode);a.rows=od.TableReader.sk(a.tableNode);b=Object.assign(new gz,{a1:this.key,contentId:a.tableNode.id,bQ:a});return{returnValue:!0,Itb:b}}$Rc(a,b){a=a.bQ;const c=new Nj.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.bQ.cKc===a.cKc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.cKc));b&&b.bQ.Gmd===a.Gmd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.Gmd));return c.toArray().join(" ")}}Object(m.a)(BH,"TableDetailsProvider",null,[518,519]);class cC{constructor(a,b){this.PRh=a;this.Gm=b}cQe(){this.PRh.execute(a=>{a.f_a(new xH);a.f_a(new Vr(1,this.Gm));a.f_a(new Vr(2,this.Gm));a.f_a(new Vr(3,this.Gm));a.f_a(new wH);a.f_a(new yH);a.f_a(new vH);a.nQe(new BH);a.nQe(new zH)})}}
Object(m.a)(cC,"AccessibilityActor",null,[]);class dC{constructor(a,b,c){this.rXb=a;this.ld=b;this.ANh=c}wb(){this.rXb.ra(D.a.yzk,Cb.a.view,Object(F.a)(this,this.zzk,"openAutoCorrectOptionsView"),1028)}zzk(a,b,c){if(1===c)return 32;this.ANh().trc();return 32}}Object(m.a)(dC,"AutoCorrectActor",null,[]);class eC{constructor(a){this.oUh=a}gRj(a){if(!a||!a.mw||1>a.mw.count)return!1;const b=[Hc.a.vIi,Hc.a.uIi];return!!this.IRc(a.mw,1,c=>this.JKc(c,b))}Shg(a){return!a||!a.mw||1>a.mw.count?!1:!!this.IRc(a.mw,
1,b=>this.JKc(b,[Hc.a.CN]))}zOj(a){return!a||!a.mw||1>a.mw.count?!1:!!this.IRc(a.mw,2,b=>this.JKc(b,[Hc.a.Uac]))}el(a){return!a||!a.mw||1>a.mw.count?!1:!!this.IRc(a.mw,1,b=>this.JKc(b,[Hc.a.Bfa]))}sZc(a){if(!a||!a.mw)return!1;a=a.mw;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).Jgi)return!1;return!0}eTi(a,b){return this.Shg(b)||this.zOj(b)?"":a}get q_c(){return this.oUh}IRc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}JKc(a,
b){a=a&&a.Dcg?a.Dcg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(m.a)(eC,"Box4PasteStewardUtils",null,[481]);class CH{constructor(){this.bZ=0;this.SAb=Array(9)}}Object(m.a)(CH,"FullListMetadata",null,[]);class hz{constructor(){this.level=0;this.yMa=null;this.bZ=0;this.WVi=this.Rkc=null;this.VHb=!1}}Object(m.a)(hz,"ListItemMetadata",null,[]);class Zt{constructor(){this.gZ=[]}n0f(){const a=new Zt;for(let b=0;b<this.gZ.length;b++)a.add(this.ga(b));
return a}get count(){return this.gZ.length}ga(a){return this.gZ[a]}$(a,b){return this.gZ[a]=b}add(a){Array.add(this.gZ,a)}clear(){Array.clear(this.gZ)}contains(a){return Array.contains(this.gZ,a)}indexOf(a){return Array.indexOf(this.gZ,a)}insert(a,b){Array.insert(this.gZ,a,b)}remove(a){return Array.remove(this.gZ,a)}removeAt(a){Array.removeAt(this.gZ,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.gZ,a)}reverse(){this.gZ.reverse()}sort(){this.gZ.sort()}toArray(){return Array.clone(this.gZ)}}
Object(m.a)(Zt,"List",null,[]);class DH{constructor(){this.level=0;this.tagName="UL";this.GYa=null;this.ignore=!1;this.Bjc=0;this.listStyle="BulletListStyle1";this.w9=new Zt;this.font=this.levelText=""}}Object(m.a)(DH,"ListLevelMetadata",null,[]);class fC{constructor(){this.Hpg={};this.mMc=-1}}Object(m.a)(fC,"LevelLists",null,[]);class gC{constructor(a){this.nodes=a;this.g3=0;this.lists={};this.w9=[];this.HAb=null;this.sja=[];this.sja[0]=new fC}}Object(m.a)(gC,"WordConverterArguments",null,[]);class EH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(m.a)(EH,"AbsolutePosition",null,[]);class an{constructor(a,b,c,f,l){this.cultureName=this.I5=this.mw=this.BU=null;a&&(this.BU=a);b&&(this.mw=b);this.I5=c?c:new Ka.a;f&&""!==f&&(this.cultureName=f);this.nia=l}}Object(m.a)(an,"GlobalAttributesArgs",null,[]);class $t{constructor(a,b,c="",f=0){this.Zv=!1;this.tdf=this.udf=null;let l=!1;$t.WNj(a)&&(l=!0,this.udf=a);$t.kOj(b)&&(this.tdf=b);this.GSh=c;this.vNh=f;this.Zv=l&&this.i8b?!0:!1}get isValid(){return this.Zv}get Fcg(){return this.udf}get i8b(){return this.tdf}get Dcg(){return this.GSh}get Jgi(){return this.vNh}static WNj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static kOj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(m.a)($t,"HtmlElementInfo",null,[]);class FH{constructor(a){this.next=null;this.data=a}}Object(m.a)(FH,"StackNode",null,[]);class px{constructor(){this.nv=null;this.Xk=0}get count(){return this.Xk}get isEmpty(){return!this.Xk||!this.nv}push(a){a=new FH(a);a.next=this.nv;this.nv=a;this.Xk++}peek(){return this.isEmpty?null:this.nv.data}pop(){if(this.isEmpty)return null;const a=this.nv;this.nv=a.next;
this.Xk--;return a.data}clear(){this.nv=null;this.Xk=0}toArray(){const a=Array(this.count);let b=this.nv;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(m.a)(px,"Stack",null,[]);class qh{constructor(a){this.GSb=this.CBc=null;this.Uxc=!1;this.Ig=a}get cRa(){return this.GSb.peek()}reset(){this.Ig.reset();this.CBc=new px;this.GSb=new px;this.GSb.push(this.Ig.d2b);this.Uxc=!1}ied(){this.Uxc=!1}hD(a){this.Uxc||(this.CBc.push(null),this.Uxc=!0);this.CBc.push(a)}onClose(){for(;;){const a=
this.CBc.pop();if(!a)break;a()}}Wph(){return!1}fpk(){this.Cq(()=>!0)}Cq(a){const b=this.cRa.clone();return a(b)?(this.GSb.push(b),this.Ig.zna(b),this.hD(Object(F.a)(this,this.rtk,"onFormattingEnd")),!0):!1}Wae(a){return a.style?this.Cq(b=>this.Wph(b,a))?1:2:2}rtk(){this.GSb.pop();this.Ig.zna(this.cRa)}U0(){}bed(){return 2}fGe(){return 2}gGe(){return 2}iGe(){return 2}pGe(){return 3}sGe(){}ged(){return 2}tGe(){}uGe(){}vGe(){return 2}ned(){return 2}oed(){return 2}HGe(){return 2}ped(){}MGe(){return 2}qed(){return 2}ted(){return 2}wed(){return 2}yed(){return 2}YGe(){}ZGe(){return 2}Bed(){return 2}Ced(){return 2}Eed(){return 2}Fed(){return 2}Hed(){return 2}Ied(){return 2}Jed(){return 2}Med(){return 2}vHe(){return 2}Ued(){return 2}BHe(){return 2}CHe(){}DHe(){return 2}Zed(){return 2}$ed(){return 2}afd(){return 2}bfd(){return 2}cfd(){return 2}dfd(){return 2}HHe(){return 3}efd(){}JHe(){return 2}ffd(){return 2}LHe(){return 3}gfd(){}NHe(){}hfd(){return 2}UHe(){return 3}ifd(){return 2}kfd(){return 2}mfd(){return 2}nfd(){return 2}YHe(){}ZHe(){return 3}rfd(){return 2}fHb(){return 2}bIe(){}eIe(){return 2}fIe(){return 2}gIe(){return 3}yfd(){return 2}hIe(){return 2}Cfd(){return 2}Ffd(){return 2}iIe(){}Rfd(){return 2}sIe(){return 2}Zfd(){return 2}$fd(){return 2}DIe(){return 3}EIe(){return 2}igd(){return 2}jgd(){return 2}kgd(){return 2}lgd(){return 2}KIe(){return 3}mgd(){return 2}ogd(){return 2}sgd(){return 2}NIe(){return 2}Ekc(){return 2}PIe(){return 2}QIe(){return 2}tgd(){return 2}RIe(){return 2}TIe(){return 3}ugd(){return 2}xgd(){return 2}ygd(){return 2}zgd(){return 2}Bgd(){return 2}static zta(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(ha.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static Djj(a){if(!a||""===a)return-1;const b=ha.a.qg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(ha.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(ha.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static d5f(a){return a&&""!==a?qh.zta(a):null}static Ay(a){let b=null,c=null,f=null,l=null;a&&a.Vf&&(b=qh.pta(a.Vf,"id"),c=qh.pta(a.Vf,"lang"),f=a.Vf.tagName,
a.dei&&(l=Object.assign(new EH,{x:qh.zta(a.Vf.style.left),y:qh.zta(a.Vf.style.top),left:qh.d5f(a.Vf.style.left),top:qh.d5f(a.Vf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new an(new $t(b,f),a.mw,null,c,l)}static pta(a,b){return a[b]}}Object(m.a)(qh,"AHtmlTranslator",null,[548]);class GH extends an{constructor(a,b,c,f=0,l=0,x=null){super(x?x.BU:null,x?x.mw:null,x?x.I5:null,x?x.cultureName:null,x?x.nia:null);this.width=f;this.height=l}}Object(m.a)(GH,"AugmentationSemanticArgs",an,[]);
class HH{constructor(){this.stop=this.color=null}}Object(m.a)(HH,"ColorStopPair",null,[]);class iz{constructor(a,b){this.value=a;this.k0i=b}get tZc(){return this.k0i}}Object(m.a)(iz,"ElementValueWrapper",null,[]);class IH extends iz{constructor(a,b,c){super(a,b);this.Dlg=c}}Object(m.a)(IH,"DimensionWrapper",iz,[]);class hC{constructor(a=0,b=0,c=0,f=0,l="",x="",H="",U="",ja="0pt",ya="0pt",Va="0pt",hb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=x;this.borderBottomColor=H;this.borderLeftColor=U;this.borderTopWidth=ja;this.borderRightWidth=ya;this.borderBottomWidth=Va;this.borderLeftWidth=hb}}Object(m.a)(hC,"TableCellBorderProperties",null,[]);class iC{constructor(a="",b="",c="",f=""){this.fqi=a;this.eqi=b;this.cqi=c;this.dqi=f}}Object(m.a)(iC,"TableCellMarginProperties",null,[]);class bh{static get Ecg(){return bh.ISh}static get csd(){return bh.l1h}static get Zrd(){return bh.j1h}static nae(a,
b,...c){b=bh.C8f(b);let f=!1;b||(b=bh.Rnj.apply(null,[a].concat(c)),f=!!b);return new iz(b,f)}static C8f(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static Rnj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static mfj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(Rf.a.Ifa(b,0,!1));case "in":return Math.round(Rf.a.w_(b,
0,!1));case "cm":return Math.round(Rf.a.w_(ye.a.RDf(b),0,!1));case "mm":return Math.round(Rf.a.w_(ye.a.RDf(.1*b),0,!1));default:return b}}static mmd(a,b,...c){a=bh.nae.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=ha.a.substring(a.value,0,a.value.length-1)):a.tZc?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=ha.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=bh.mfj(c,f)}return new IH(c,a.tZc,b)}static Gxb(a){return bh.mmd(a,
[a.style.width],"width","WIDTH","Width")}static H9a(a){return bh.mmd(a,[a.style.height],"height","HEIGHT","Height")}static o8d(a){return bh.mmd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static p8d(a){return bh.mmd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Xnj(a){a=bh.nae(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in bh.csd&&void 0!==bh.csd[a.value]&&null!==bh.csd[a.value]?bh.csd[a.value]:0}static uVj(a){a=
bh.C8f([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static G3i(a){return bh.nae(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static xAi(a){const b=ha.a.substring(a,0,1),c=ha.a.substring(a,1,2);a=ha.a.substring(a,2,3);return b+b+c+c+a+a}static ija(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=ha.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return ha.a.OB(b)}if(bh.Ecg[ha.a.qg(b)])return bh.Ecg[ha.a.qg(b)];b.startsWith("#")&&(b=ha.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=bh.xAi(b));return 6!==b.length?"":b}static MCk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static qVc(a,b){const c=bh.G3i(a);c&&""!==c&&b.Cq(f=>f.sod(bh.ija(c)))}static p_f(a){a=a.style;if(!a)return null;const b=bh.Zrd[a.borderTopStyle],c=bh.ija(a.borderTopColor),f=a.borderTopWidth,l=bh.Zrd[a.borderRightStyle],x=bh.ija(a.borderRightColor),H=a.borderRightWidth,U=bh.Zrd[a.borderBottomStyle],ja=bh.ija(a.borderBottomColor),ya=a.borderBottomWidth,Va=bh.Zrd[a.borderLeftStyle],hb=bh.ija(a.borderLeftColor);return new hC(b,l,U,Va,
c,x,ja,hb,f,H,ya,a.borderLeftWidth)}static A4i(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new iC(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}bh.ISh=pa.a.QH("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");bh.l1h=pa.a.QH("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);bh.j1h=pa.a.QH("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(m.a)(bh,"DefaultHtmlTranslatorHelper",null,[]);class JH{constructor(){this.direction=null;this.p0b=new Zt}cbg(){return!!this.direction&&0<this.direction.length}}Object(m.a)(JH,"LinearGradient",null,[]);class jC{constructor(){this.gzb=!1}}Object(m.a)(jC,"HtmlTranslatorContext",null,[]);class kC{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,x=!1,H=!0,U=!1,ja=!0,ya=!0,Va=!0,hb=!1,yb=!1,
Zb=!1,fc=!1,Kc=!1,Lc=!1,Gc=!1,ae=null,we=null,$d=null,Te=null,Ze=null,Vf=null,gg=null){this.gzb=!1;this.YXh=a;this.cYh=b;this.VXh=c;this.bYh=f;this.Q_h=l;this.O_h=x;this.J_h=H;this.K_h=U;this.M_h=ja;this.N_h=ya;this.L_h=Va;this.Z_h=hb;this.m0h=yb;this.Y_h=Zb;this.a1h=fc;this.T_h=Kc;this.eTh=Lc;this.PTh=Gc;this.S_h=ae;this.X_h=we;this.P_h=Ze;this.V_h=$d;this.R_h=Te;this.U_h=Vf;this.W_h=gg}get sZa(){return this.YXh}get FDk(){return this.cYh}get q9g(){return this.VXh}get EDk(){return this.bYh}get Jth(){return this.Q_h}get Ith(){return this.O_h}get thl(){return this.J_h}get uhl(){return this.K_h}get whl(){return this.M_h}get yhl(){return this.N_h}get vhl(){return this.L_h}get x0a(){return this.T_h}get ZFj(){return this.eTh}get Nth(){return this.Z_h}get ijl(){return this.m0h}get Ghl(){return this.Y_h}get Orl(){return this.a1h}get BUa(){return this.PTh}get Kth(){return this.S_h||
Object(F.a)(this,this.pmd,"returnFalse")}get Fhl(){return this.X_h||Object(F.a)(this,this.pmd,"returnFalse")}get Ehl(){return this.V_h||Object(F.a)(this,this.OSe,"returnTrue")}get Ahl(){return this.R_h||Object(F.a)(this,this.OSe,"returnTrue")}get zhl(){return this.P_h||Object(F.a)(this,this.pmd,"returnFalse")}get Dhl(){return this.U_h||Object(F.a)(this,this.OSe,"returnTrue")}get Mth(){return this.W_h||Object(F.a)(this,this.pmd,"returnFalse")}OSe(){return!0}pmd(){return!1}}Object(m.a)(kC,"HtmlTranslatorSettings",
null,[578]);class KH extends an{constructor(a,b,c,f,l=null,x=0,H=0,U=null,ja=null){super(l?l.BU:null,l?l.mw:null,l?l.I5:null,l?l.cultureName:null,l?l.nia:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=x;this.maxHeight=H;this.href=U;this.desc=ja}}Object(m.a)(KH,"ImageSemanticArgs",an,[]);class LH{constructor(a,b){this.Nol=a;this.Mol=b}}Object(m.a)(LH,"IndentationProperties",null,[]);class qx extends an{constructor(a,b,c,f=0,l=-1,x=!1,H=!1,U="",ja="",ya=null,Va=-1){super(c?c.BU:
null,c?c.mw:null,c?c.I5:null,c?c.cultureName:null,c?c.nia:null);this.pkf=a;this.vUb=0;this.jLd=b;this.xTb=1===b&&-1===l&&!this.Y2a;this.tFd=f;this.uFd=l;this.RHd=x;this.Y2a=H;this.P3a=U;this.Ynb=ja;this.wwc=ya;this.ewc=Va;this.vnb=-1;this.fFc=!0}get listStyleType(){return this.wPj?this.vUb:this.pkf}get wPj(){return 0!==this.vUb}get eql(){return this.jLd}get listLevel(){return this.uFd}set listLevel(a){this.uFd=a}get listId(){return this.tFd}set listId(a){this.tFd=a}get VHb(){return this.RHd}set VHb(a){this.RHd=
a}get D8a(){return this.Y2a}set D8a(a){this.Y2a=a}get levelText(){return this.P3a}set levelText(a){this.P3a=a}get font(){return this.Ynb}set font(a){this.Ynb=a}get wQa(){return this.wwc}set wQa(a){this.wwc=a}get ssb(){return this.ewc}set ssb(a){this.ewc=a}get Jjg(){return 6<=this.listStyleType}get vJj(){return this.xTb}get JIi(){return this.fFc?this.jLd+this.vnb:this.vnb}clone(){const a=new qx(this.pkf,this.jLd,new an(this.BU,this.mw,this.I5,this.cultureName,this.nia),this.tFd,this.uFd,this.RHd,this.Y2a);
a.vUb=this.vUb;a.xTb=this.xTb;a.vnb=this.vnb;a.fFc=this.fFc;a.P3a=this.P3a;a.Ynb=this.Ynb;a.wwc=this.wwc;a.ewc=this.ewc;return a}Cei(a,b,c){this.vUb=a;0<b?(this.xTb=!1,this.vnb=b,this.fFc=!1):(this.vnb++,this.xTb=!c)}}Object(m.a)(qx,"ListSemanticArgs",an,[]);class jz extends an{constructor(a,b,c,f,l=null,x=0,H=null,U=null,ja=!1,ya=!1,Va=69905,hb=null){super(hb?hb.BU:null,hb?hb.mw:null,hb?hb.I5:null,hb?hb.cultureName:null,hb?hb.nia:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.jAb=ya;this.height=
f;this.FFa=ja;this.Aqc=l;this.verticalAlignment=x;this.s6=H;this.$rd=U;this.iJc=Va}}Object(m.a)(jz,"TableCellSemanticArgs",an,[]);class lC extends an{constructor(a,b=null){super(b?b.BU:null,b?b.mw:null,b?b.I5:null,b?b.cultureName:null,b?b.nia:null);this.height=a}}Object(m.a)(lC,"TableRowSemanticArgs",an,[]);class mC extends an{constructor(a,b,c,f,l,x,H,U,ja,ya=null,Va=-1,hb=null){super(hb?hb.BU:null,hb?hb.mw:null,hb?hb.I5:null,hb?hb.cultureName:null,hb?hb.nia:null);this.EQa=null;this.DY=a;this.Wra=
b;this.width=c;if(l)for(this.EQa=Array(l.length),a=0;a<l.length;++a)this.EQa[a]=l[a];this.Kgg=x;this.C0e=U;this.OJj=H;this.FFa=f;this.Mde=ja;this.Zyh=ya;this.tableLook=Va}}Object(m.a)(mC,"TableSemanticArgs",an,[]);let Wr;class wl extends qh{constructor(a,b=null,c=null,f=null){super(a);this.U3a=null;this.FVh=pa.a.QH("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Jc=b||new kC;this.Ft=c||new jC;this.wFd=f}get Dpg(){return this.FVh}w3f(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.Dpg[ha.a.qg(c)])||(c=qh.pta(a,"type"))&&""!==c&&(c=this.Dpg[c]))return c;if(this.Jc.sZa&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=wl.HUc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=wl.HUc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}p3f(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=Ca.a.F1f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.oRc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=Ca.a.F1f(a,"p"))return wl.Nbj(a)-1}return b}oRc(a,b,c){a=this.Jc.sZa?a.getAttribute(b):qh.pta(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}Kuk(){this.U3a.pop();this.Ig.Cna()}o7b(a,b){this.Cq(l=>l.ZKa(0,0));const c=this.w3f(a.Vf,b?6:2);let f=1;b&&(f=this.oRc(a.Vf,"start",1));b=!1;this.Jc.sZa&&(b=a.Vf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Vf.removeAttribute("data-pasteFromRc"),(B.a.yT||B.a.eg)&&wl.LJc(a.Vf));a=new qx(c,f,qh.Ay(a),0,-1,b,this.Jc.sZa);this.U3a.push(a);this.Ig.Ena(a);this.hD(Object(F.a)(this,this.Kuk,"onListElementClose"));return 1}reset(){super.reset();this.U3a=new px}Wph(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||qh.pta(b,"lang")}catch(U){f=null}f&&""!==f&&(c=a.CVe(f)||c);(f=qh.pta(b,"dir"))&&(c=a.mMb(f)||c);if(f=b.style){if(f.fontWeight){var l=ha.a.OB(f.fontWeight),x=parseInt(l);isNaN(x)?"BOLD"===l?c=a.MH(!0)||c:"NORMAL"===l&&(c=a.MH(!1)||c):c=600<=x?a.MH(!0)||c:a.MH(!1)||c}this.Jc.Ith&&!this.Ft.gzb&&f.fontSize&&(l=qh.Djj(f.fontSize),0<l&&(c=a.zLb(Math.floor(2*l))||c));this.Jc.Ehl(this.Ft)&&(this.Jc.Nth&&b.getAttribute?(l=b.getAttribute("data-indent"))&&0<
l.length&&(l=Rf.a.dK(parseInt(l),0)+"px",c=a.npd(l)||c):f.textIndent&&(c=a.npd(f.textIndent)||c));this.Jc.Ahl(this.Ft)&&f.marginLeft&&(this.Jc.Nth&&b.getAttribute?(l=b.getAttribute("data-margin"))&&0<l.length&&(c=a.aqc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.aqc(f.marginLeft)||c));this.Jc.zhl(this.Ft)&&f.lineHeight&&(c=a.w1(f.lineHeight)||c);if(this.Jc.vhl)if(l=f.fontVariantCaps?ha.a.qg(f.fontVariantCaps):null,x=f.fontVariant?ha.a.qg(f.fontVariant):null,"uppercase"===(f.textTransform?ha.a.qg(f.textTransform):
null))c=a.mpd("uppercase")||c;else if("small-caps"===l||x&&0<=x.indexOf("small-caps"))c=a.mpd("small-caps")||c;this.Jc.Dhl(this.Ft)&&f.textAlign&&(c=a.Wjb(ha.a.qg(f.textAlign))||c);f.fontStyle&&(l=ha.a.OB(f.fontStyle),"ITALIC"===l||"OBLIQUE"===l?c=a.d0a(!0)||c:"NORMAL"===l&&(c=a.d0a(!1)||c));l=wl.Xlj(b);if(f.textDecoration||l){x=ha.a.qg(f.textDecoration||"");l=ha.a.qg(l||"");if(b.parentNode&&b.parentNode.tagName&&"a"===ha.a.qg(b.parentNode.tagName)){var H=(b.querySelector(".TextRun")||b).className;
H&&-1<H.indexOf("Underlined")&&(c=a.LY(!0)||c)}else if(f.tOl||wl.iE(x)||wl.iE(l))c=a.LY(!0)||c;if(f.sOl||wl.Ijg(x)||wl.Ijg(l))c=a.IY(!0)||c}if(f.verticalAlign){l=ha.a.OB(f.verticalAlign);if("SUB"===l||this.Jc.Mth(this.Ft)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.e6(!0)||c;else if("SUPER"===l||this.Jc.Mth(this.Ft)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.KY(!0)||c;this.Jc.Ith&&("SUB"===l||"SUPER"===l)&&b.getAttribute&&(l=parseFloat(b.getAttribute("data-fontsize")),isNaN(l)||
(c=a.sVe(Math.floor(2*l))||c))}this.Jc.yhl&&f.fontFamily&&(this.Jc.BUa?c=this.rVe(a,f.fontFamily,c):this.Jc.Ghl&&b.getAttribute?(l=b.getAttribute("data-usefontface"))&&"true"===l&&(c=this.rVe(a,f.fontFamily,c)):c=this.rVe(a,f.fontFamily,c));l=null;this.Jc.whl&&f.color&&(l=bh.ija(f.color));x=!!l;this.Jc.Fhl(this.Ft)&&b.getAttribute&&(x=b.getAttribute("data-scheme-color"),l=null!==x?x:l,x="inherit"!=f.color&&(""!==l||!this.Ft.gzb||wl.SVj(b)));x&&(c=a.Sr(l)||c);this.Jc.thl&&!this.Ft.gzb&&f.backgroundColor&&
(this.Jc.FDk&&b.tagName&&wl.Ctl.contains(ha.a.OB(b.tagName))||(c=a.Coa(bh.ija(f.backgroundColor))||c));if(this.Jc.uhl&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&(f=wl.Snj(f.backgroundImage))&&0<f.p0b.count){l=f.p0b.ga(0).color;x=!0;for(H=0;H<f.p0b.count&&(x=x&&l===f.p0b.ga(H).color,x);H++);x&&(ia.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.Coa(bh.ija(l))||c)}}this.Jc.Kth(this.Ft)&&b.getAttribute&&(f=b.getAttribute("data-ccp-props"))&&(c=a.Foa(f)||c);
if(b.getAttribute){if(f=b.getAttribute("data-ccp-charstyle"))u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Jc.x0a&&(c=a.cga(f)||c);if(b=b.getAttribute("data-ccp-parastyle"))u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Jc.x0a&&(c=a.Sod(b)||c)}return c}hjl(a){if(this.Jc.ijl)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===
String&&-1<ha.a.OB(a.className).indexOf("MSOCOM"))return!0;if("DIV"===ha.a.OB(a.tagName))break;a=a.parentNode}return!1}rVe(a,b,c){b=this.S1f(b);return a.UKa(b,this.Jc.Orl)||c}U0(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Vf&&this.hjl(b.Vf)&&(a="");this.Ig.U0(a,qh.Ay(b))}bed(a){const b=qh.pta(a.Vf,"href");return b&&""!==b?(this.Ig.cxa(b,qh.Ay(a)),this.hD(Object(F.a)(this.Ig,this.Ig.bxa,"onAnchorEnd")),1):2}ged(){return this.Cq(a=>a.MH(!0))?1:2}ned(){return this.Cq(a=>a.Tae())?1:2}oed(a){this.Ig.uA(qh.Ay(a));
this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}ped(a){this.Ig.Bna(qh.Ay(a))}qed(a){this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}wed(){return this.Cq(a=>a.d0a(!0))?1:2}ted(a){this.Cq(b=>b.Wjb("center"));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}yed(){return this.Cq(a=>a.UKa("consolas"))?1:2}Ced(){return this.Cq(a=>a.IY(!0))?1:2}Bed(a){return this.o7b(a,!1)}Eed(){return this.Cq(a=>a.d0a(!0))?
1:2}Fed(a){return this.o7b(a,!1)}Hed(a){var b=a.Vf.getAttribute("data-render-src");const c=a.Vf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const H=a.Vf.getAttribute("data-render-fallback");let U=0,ja=0;if(a.Vf.currentStyle){var f=a.Vf.currentStyle.width,l=a.Vf.currentStyle.height;f&&-1!==f.indexOf("px")&&(f=parseInt(ha.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(U=f));l&&-1!==l.indexOf("px")&&(l=parseInt(ha.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(ja=l))}a=new GH(b,c,H,U,ja,
qh.Ay(a));this.Ig.eZa(a);return 2}this.Jc.sZa&&(B.a.yT||B.a.eg)&&(b=a.Vf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Jc.sZa&&b&&b.length&&wl.LJc(a.Vf));const x=a.Vf.getAttribute("align");this.Cq(H=>H.Wjb(x));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}Ied(a){this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}Jed(a){this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}Med(){return this.Cq(a=>
a.d0a(!0))?1:2}Ued(a){return this.Cq(b=>{var c=this.S1f(a.Vf.getAttribute("face"));c=b.UKa(c);b=b.Sr(bh.ija(a.Vf.getAttribute("color")));return c||b})?1:2}Zed(a){this.Cq(b=>this.Jc.x0a?b.i0a(1):b.j0a(1));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}$ed(a){this.Cq(b=>this.Jc.x0a?b.i0a(2):b.j0a(2));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}afd(a){this.Cq(b=>this.Jc.x0a?b.i0a(3):b.j0a(3));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,
this.Ig.tA,"onParagraphEnd"));return 1}bfd(a){this.Cq(b=>this.Jc.x0a?b.i0a(4):b.j0a(4));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}cfd(a){this.Cq(b=>this.Jc.x0a?b.i0a(5):b.j0a(5));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}dfd(a){this.Cq(b=>this.Jc.x0a?b.i0a(6):b.j0a(6));this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}efd(a){this.Ig.Bna(qh.Ay(a))}gfd(a){var b=a.Vf;const c=
b.src,f=b.alt,l=b.fNl;let x=0,H=0;b.style&&(x=qh.zta(b.style.width),H=qh.zta(b.style.height));x&&H||(x=b.width,H=b.height);let U=b=0;a.Vf.currentStyle&&(x||H||(x=qh.zta(a.Vf.currentStyle.width),H=qh.zta(a.Vf.currentStyle.height)),b=qh.zta(a.Vf.currentStyle.maxWidth),U=qh.zta(a.Vf.currentStyle.maxHeight));a=new KH(c,f,x,H,qh.Ay(a),b,U,l);this.Ig.Ana(a)}ffd(){return this.Cq(a=>a.d0a(!0))?1:2}hfd(){return this.Cq(a=>a.LY(!0))?1:2}ifd(){return this.Cq(a=>a.UKa("consolas"))?1:2}kfd(a){this.Ig.uA(qh.Ay(a));
this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}mfd(a){this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}nfd(a){let b;const c=this.w3f(a.Vf,0);let f=this.oRc(a.Vf,"value",0);var l=!1;0<this.U3a.count?b=this.U3a.peek():(b=new qx(2,1,qh.Ay(a)),f||(f=1));if(this.Jc.sZa){l=b.listLevel;let ja=b.listId;this.Jc.Jth?(l=this.p3f(a.Vf),l=0>l&&0>b.listLevel&&0<this.U3a.count?b.listLevel=this.U3a.count-1:b.listLevel=0<=l?l:b.listLevel,this.wFd&&this.wFd.b<
l&&(this.wFd.b=l)):0>l&&(l=b.listLevel=this.p3f(a.Vf));1>ja&&(ja=b.listId=this.oRc(a.Vf,"data-listid",0));a.Vf.getAttribute("data-leveltext")&&(b.levelText=a.Vf.getAttribute("data-leveltext"));var x=a.Vf.getAttribute("data-font");x&&(b.font=x);x=!1;u.AFrameworkApplication.fa&&(x=u.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));if(x){var H=a.Vf.getAttribute("data-charcodes");x=[];if(H&&""!==H)if(-1<H.indexOf(",")){H=H.split(",");for(var U=0;U<H.length;U++)Array.add(x,parseInt(H[U]))}else Array.add(x,
parseInt(H));if(x&&0<x.length){H=Array(x.length);for(U=0;U<x.length;U++)H[U]=x[U];b.wQa=H}(x=a.Vf.getAttribute("data-buAutoNum"))&&0<x.length&&(b.ssb=parseInt(x))}(l=0<=l&&0<ja)&&wl.LJc(a.Vf)}b.Cei(c,f,l);this.Ig.gxa(b.clone());this.hD(Object(F.a)(this.Ig,this.Ig.Dna,"onListItemEnd"));return 1}fHb(a){return this.o7b(a,!1)}rfd(a){if(this.Cq(b=>b.ULb(!0))){const b=a.Vf.getAttribute("OuterHtml");this.Ig.hxa(b,qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.lJa,"onMathEnd"))}return 1}yfd(a){return this.o7b(a,
!0)}Cfd(a){this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}Ffd(a){const b=a.Vf.getAttribute("align");this.Cq(c=>c.Wjb(b));if(this.Jc.sZa){const c=a.Vf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&wl.LJc(a.Vf,B.a.yT||B.a.eg)}this.Ig.uA(qh.Ay(a));this.hD(Object(F.a)(this.Ig,this.Ig.tA,"onParagraphEnd"));return 1}Rfd(){this.Cq(a=>a.UKa("consolas"));this.Ig.dZa();this.hD(Object(F.a)(this.Ig,this.Ig.cZa,"onPreFormattedTextEnd"));return 1}Zfd(){return this.Cq(a=>
a.IY(!0))?1:2}$fd(){return this.Cq(a=>a.UKa("consolas"))?1:2}igd(){return this.Cq(a=>a.lZe())?1:2}jgd(a){var b=a.Vf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=bh.MCk(c);if(0<b&&this.Jc.ZFj){for(c=0;c<b;c++)this.Ig.jZa(qh.Ay(a));return 3}return 2}kgd(){return this.Cq(a=>a.IY(!0))?1:2}lgd(){return this.Cq(a=>a.MH(!0))?1:2}mgd(){return this.Cq(a=>a.e6(!0))?1:2}ogd(){return this.Cq(a=>a.KY(!0))?1:2}sgd(a){this.Cq(Va=>Va.clearFormatting()&&Va.nSe());bh.qVc(a.Vf,this);const b=bh.Gxb(a.Vf),
c=bh.p_f(a.Vf),f=bh.o8d(a.Vf),l=bh.p8d(a.Vf),x=!parseInt(qh.pta(a.Vf,"border")),H=bh.uVj(a.Vf);let U=-1,ja="";var ya=-1;a.Vf.attributes.hasOwnProperty("style")&&-1!==(ya=a.Vf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?U=parseInt(a.Vf.attributes.getNamedItem("style").value.substr(ya+17)):a.Vf.attributes.hasOwnProperty(Ba.a.uZd.toString())&&(U=parseInt(a.Vf.attributes.getNamedItem(Ba.a.uZd.toString()).value));ya=-1;a.Vf.attributes.hasOwnProperty("class")&&-1!==(ya=a.Vf.attributes.getNamedItem("class").value.indexOf("Mso"))?
ja=a.Vf.attributes.getNamedItem("class").value.substr(ya).split(" ")[0]:a.Vf.attributes.hasOwnProperty(Ba.a.vZd.toString())&&(ja=a.Vf.attributes.getNamedItem(Ba.a.vZd.toString()).value);this.Ig.pY(new mC(0,0,b.value,b.Dlg,null,x,H,c,new LH(f.value,l.value),ja,U,qh.Ay(a)));this.hD(Object(F.a)(this.Ig,this.Ig.mY,"onTableEnd"));u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}Ekc(a){const b=bh.H9a(a.Vf),c=bh.Gxb(a.Vf);if(!c.value&&
c.tZc&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Jc.q9g))return 3;let f=parseInt(qh.pta(a.Vf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(qh.pta(a.Vf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let x=!1;a.Vf.attributes.hasOwnProperty("style")&&(x=-1!==a.Vf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Vf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));
!x&&a.Vf.attributes.hasOwnProperty("class")&&(x=-1!==a.Vf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let H=69905;if(a.Vf.attributes.hasOwnProperty(Ba.a.tZd.toString())){var U=parseInt(a.Vf.attributes.getNamedItem(Ba.a.tZd.toString()).value);isNaN(U)||(H=U)}U=bh.ija(a.Vf.style.backgroundColor);const ja=bh.Xnj(a.Vf);this.Cq(hb=>hb.ZKa(0,0));bh.qVc(a.Vf,this);const ya=bh.p_f(a.Vf),Va=this.Jc.EDk?bh.A4i(a.Vf):null;a=new jz(f,l,c.value,b.value,U,ja,ya,Va,c.Dlg,x,H,qh.Ay(a));this.Ig.lY(a);
this.hD(Object(F.a)(this.Ig,this.Ig.kY,"onTableCellEnd"));this.fpk();return 1}tgd(a){const b=this.Ekc(a);if(3===b)return b;this.Cq(c=>{const f=c.MH(!0);c=c.Wjb("center");return f||c});bh.qVc(a.Vf,this);return 1}ugd(a){bh.qVc(a.Vf,this);const b=bh.H9a(a.Vf);if(b.tZc&&!b.value&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Jc.q9g))return 3;this.Ig.oY(new lC(b.value,qh.Ay(a)));this.hD(Object(F.a)(this.Ig,this.Ig.nY,"onTableRowEnd"));return 1}xgd(){return this.Cq(a=>
a.UKa("consolas"))?1:2}ygd(){return this.Cq(a=>a.LY(!0))?1:2}zgd(a){return this.o7b(a,!1)}Bgd(){return this.Cq(a=>a.LY(!0))?1:2}Q8i(a){if(!a)return null;a=a.split(",");return this.Jc.BUa&&a[0].startsWith("WordVisi")&&1<a.length?a[1].trim():a[0]}static kyl(a){if(!a)return null;a=ha.a.QQe(a,'"');return a=ha.a.QQe(a,"'")}S1f(a){if(!a)return null;a=this.Q8i(a);return a=wl.kyl(a)}static ztf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.cbg())return!1;a.direction=b;return!0}if((c=
b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.cbg())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:bh.ija(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new HH;f.color=c;f.stop=b;a.p0b.add(f);return!0}static Snj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);
b=b.substr(0,b.lastIndexOf(")"));const c=new JH;for(;0<b.trim().length;){let f=b.indexOf(",");const l=b.indexOf("(");if(0<l&&l<f){const x=b.indexOf(")");if(x<l)return null;f=b.indexOf(",",x)}if(-1===f){if(!wl.ztf(c,b))return null;b=""}else{const x=b.substr(0,f);b=b.substr(f+1);if(!wl.ztf(c,x))return null}}return c}catch(b){return null}}static HUc(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static LJc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin=
"",b&&wl.gFf(a,b))}static gFf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=""),b&&wl.gFf(a,b)),a=a.nextSibling}static Nbj(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static SVj(a){return!(void 0===
a.className||null===a.className)&&a.className.startsWith("TextRun")}static Xlj(a){a=a.style.textDecorationLine;return void 0===a||null===a?null:a}static Ijg(a){return 0<=a.indexOf("line-through")}static iE(a){return 0<=a.indexOf("underline")}}wl.Ctl=(Wr=new Ka.a,Wr.add("TABLE"),Wr.add("THEAD"),Wr.add("TBODY"),Wr.add("TFOOT"),Wr.add("TR"),Wr.add("TH"),Wr.add("TD"),Wr);Object(m.a)(wl,"DefaultHtmlTranslator",qh,[]);var Mm=d(312);class Yj{constructor(a=null){this.yS=a||Mm.a.vae("");this.jBc=Number.parseInvariant((new Date).format("HHmmss"))}get Nb(){return this.yS}process(a,
b){if(a&&a.querySelectorAll){const x=a.querySelectorAll("p");if(x&&0<x.length){for(var c=0,f=!1,l=x[0].parentNode;5>c&&l&&l!==a;){c++;const H=l.id.toLowerCase();if(H&&H.length&&-1!==H.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),
c=l}a=new Xh.a(b,Object(F.a)(this,this.EMe,"processNodesDiscovery"),new gC(x));a.Pl("Word Converter Operation");a.Oi=!b||b.Oi;a.run()}}}EMe(a,b){const c=b.nodes[b.g3];var f=Yj.$7d(c);if(f){let x=f.yMa.replace(RegExp("level[0-9]"),"").trim();x=x&&x.length?x:f.yMa;let H=b.lists[x];H||(H=new CH,H.bZ=this.jBc++);let U=H.SAb[f.level-1];U||(U=new DH,U.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(U.tagName=l)}else U.GYa=
Yj.x1f(c,5),U.GYa&&U.GYa.length||(U.GYa=Yj.B$d(c,5)),U.ignore=!U.GYa||!U.GYa.length,U.tagName=Yj.xSc(U.GYa);f.bZ=H.bZ;U.Bjc++;U.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=Yj.B$d(c,5))?l:U.GYa)&&l.length&&(f.WVi=l,(l=Yj.pbl(c,l,U.listStyle,f.level-1))&&l.length&&(U.listStyle=l));b.w9[b.w9.length]=f;U.w9.contains(f)||U.w9.add(f);if(void 0===H.SAb[f.level-1]||null===H.SAb[f.level-1]||H.SAb[f.level-1]!==U)H.SAb[f.level-1]=U;b.lists[x]&&b.lists[x]===H||(b.lists[x]=H);b.HAb=c}else if((f=b.HAb)&&
Yj.b6b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.g3++;if(b.nodes.length<=b.g3){if(!b.w9.length)return!1;b.g3=0;a.Wg(Object(F.a)(this,this.DMe,"processNodeConvert"))}return!0}DMe(a,b){a=b.w9[b.g3];var c=a.Rkc,f=a.yMa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.yMa;f=b.lists[f];var l=f.SAb[a.level-
1],x=c.parentNode.tagName.toLowerCase();if(!l.ignore&&c.parentNode&&"li"!==x){if(x=Yj.sEi(c,l)){Yj.V_b(c,5);const H=c.ownerDocument.createElement("LI");H.setAttribute("data-aria-level",String.format("{0}",a.level));for(H.setAttribute("data-listid",String.format("{0}",f.bZ));c.firstChild;)H.appendChild(c.firstChild);x.appendChild(H);c.parentNode.removeChild(c);"UL"===l.tagName?this.Nb.b++:this.Nb.c++}}else"li"===x&&(l=l.tagName,c=c.parentNode,a.VHb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc",
"true"),c.setAttribute("data-listid",String.format("{0}",f.bZ)),"UL"===l?this.Nb.b++:this.Nb.c++);b.g3++;return b.g3<b.w9.length}static sEi(a,b){a=Yj.pEi(a,b.tagName);return Yj.YWd(a,b)}static YWd(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static pEi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",
c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?wl.HUc(c,"NumberListStyle"):wl.HUc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static V_b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&Yj.V_b(f,b-1);if(Yj.tje(f)||Yj.S9b(f))a.removeChild(f),c--}}static $7d(a){if(1===a.nodeType){var b=Yj.B6b(a,"mso-list");if(b&&0<b.length)try{var c=
b.split(" ");if(3===c.length){var f=new hz;f.level=Number.parseInvariant(c[1].substr(5));f.yMa=b;f.Rkc=a;f.VHb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+Cc.a.tZb),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new hz,f.level=Number.parseInvariant(b),f.yMa=c+" level"+b,f.Rkc=a,f.VHb=!1,f}return null}static pbl(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===Yj.xSc(b))return c=Yj.k4i(b),
Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?Yj.khj(c,f):1,1!==f&&((c=Yj.UKc(a,l,RegExp("^[ivxlcdm]+"),ha.a.yIf,"NumberListStyle3"))||(c=Yj.UKc(a,l,RegExp("^[IVXLCDM]+"),ha.a.yIf,"NumberListStyle5")))||f&&((c=Yj.UKc(a,l,RegExp("^[a-z]+"),ha.a.xIf,"NumberListStyle2"))||
(c=Yj.UKc(a,l,RegExp("^[A-Z]+"),ha.a.xIf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static k4i(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static khj(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static UKc(a,
b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static xSc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static B$d(a,b){let c=null;var f;let l,x;for(let H=-1;!c&&H<a.childNodes.length;H++){const U=-1===H?a:a.childNodes[H];if(U)if((f=U.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(x=f.indexOf("\x3c!--[endif]--\x3e"),0<=x)){f=f.substring(l,x+14);U.innerHTML=
U.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=H&&1===U.nodeType&&1<b&&(c=Yj.B$d(U,b-1))}return c}static x1f(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];Yj.S9b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=Yj.x1f(l,b-1))}return c}static S9b(a){return 1===a.nodeType&&
(a=Yj.B6b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static tje(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static B6b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static b6b(a){do a=a.previousSibling;while(a&&Yj.D9b(a));return a}static D9b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Yj.rFd,
""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Yj.D9b(a.firstChild):!0}}Yj.rFd=RegExp("[\n|\r]","gi");Object(m.a)(Yj,"WacAndRichClientWordConverter",null,[522]);class MH{constructor(){this.bZ=0;this.tagName="UL";this.m4b=null;this.ignore=!1;this.Bjc=0}}Object(m.a)(MH,"ListMetadata",null,[]);class nl{constructor(a=null){this.jBc=1;this.yS=a||Mm.a.vae("")}get Nb(){return this.yS}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&
0<a.length&&(a=new Xh.a(b,Object(F.a)(this,this.EMe,"processNodesDiscovery"),new gC(a)),a.Pl("Word Converter Operation"),a.Oi=!b||b.Oi,a.run())}EMe(a,b){const c=b.nodes[b.g3];var f=nl.$7d(c);if(f){let l=b.sja[f.level-1];l||(l=new fC,b.sja[f.level-1]=l);b.HAb&&nl.b6b(c)!==b.HAb&&nl.t1k(b);let x=l.Hpg[f.yMa];if(!x)x=new MH,x.bZ=this.jBc++,x.m4b=nl.O6d(c,5),x.ignore=!x.m4b||!x.m4b.length,x.tagName=nl.xSc(x.m4b),l.Hpg[f.yMa]=x,b.lists[x.bZ.toString()]=x;else if(!x.ignore&&1===x.Bjc){const H=nl.O6d(c,
5);x.tagName=x.m4b===H?"UL":"OL"}f.bZ=x.bZ;x.ignore||"OL"===x.tagName&&0<x.Bjc&&l.mMc!==f.bZ?(x.ignore=!0,b.sja[0].mMc=-1,b.sja=b.sja.slice(0,1)):(b.sja.length>f.level&&(b.sja=b.sja.slice(0,f.level)),l.mMc=f.bZ,b.w9[b.w9.length]=f,x.Bjc++);b.HAb=c}else if((f=b.HAb)&&nl.b6b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.g3++;
if(b.nodes.length<=b.g3){if(!b.w9.length)return!1;b.g3=0;a.Wg(Object(F.a)(this,this.DMe,"processNodeConvert"))}return!0}DMe(a,b){var c=b.w9[b.g3];a=c.Rkc;const f=b.lists[c.bZ.toString()];if(!f.ignore&&(c=nl.qej(a,c,f))){nl.V_b(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===f.tagName?this.Nb.b++:this.Nb.c++}b.g3++;return b.g3<b.w9.length}static qej(a,b,c){let f=nl.Ufh(a,b.level,c);const l=V.a.Be(f,
"UniqueListId");if(l&&l!==b.bZ||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;V.a.Qv(f,"UniqueListId",b.bZ);return nl.YWd(f,c)}static YWd(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(V.a.Qv(b,"UniqueListId",V.a.Be(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static Ufh(a,b,c){let f=null,l;1===b?l=nl.b6b(a):(f=nl.Ufh(a,
b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const x=l.tagName.toUpperCase();if("UL"===x||"OL"===x)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static V_b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&nl.V_b(f,b-1);if(nl.tje(f)||nl.S9b(f))a.removeChild(f),c--}}static $7d(a){if(1===a.nodeType){const b=nl.B6b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=
new hz;f.level=Number.parseInvariant(c[1].substr(5));f.yMa=b;f.Rkc=a;return f}}catch(c){}}return null}static xSc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static O6d(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];nl.S9b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&(c=nl.O6d(l,b-1))}return c}static S9b(a){return 1===a.nodeType&&(a=nl.B6b(a,"mso-list"))&&0<a.length&&"ignore"===
a.trim().toLowerCase()?!0:!1}static tje(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static B6b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static b6b(a){do a=a.previousSibling;while(a&&nl.D9b(a));return a}static D9b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(nl.rFd,""),!a.trim().length):1!==a.nodeType||
a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:nl.D9b(a.firstChild):!0}static t1k(a){for(let b=0;b<a.sja.length;b++){const c=a.sja[b];c&&(c.mMc=-1)}}}nl.rFd=RegExp("[\n|\r]","gi");Object(m.a)(nl,"WordConverter",null,[522]);class nC{constructor(a){this.Y2a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get D8a(){return this.Y2a}create(a=null){return this.Y2a?new Yj(a):new nl(a)}}Object(m.a)(nC,"Box4WordConverterFactory",null,[480]);var NH=d(703);class OH{constructor(a,
b,c,f,l){this.$af=0;this.ld=a;this.zd=b;this.Byd=l;this.DZ=c;this.dPa=f}$ri(a,b,c){ia.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.zd.Sy);a.Oi&&this.zd.Tj&&window.chrome&&ia.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.DZ.Wca(!!(b&16));this.dPa.create(a,Object(F.a)(this,this.e6e,"waitingForEnsureAccessOperationResult"),null).Pl("ClipboardPreProcess");this.$af=Date.now()}T1k(){this.DZ.reset()}e6e(a){let b=
!0;const c=this.DZ.sSi,f=null==this.DZ.ZRi;null!=c?(a.G5=c,b=!1):Date.now()-this.$af>this.Byd&&!f&&(ia.ULS.sendTraceTag(18354843,307,50,null),this.ld.Xb(Pd.a.Lja,{["Reason"]:Md.a.P7g}),b=a.G5=!1);return b}}Object(m.a)(OH,"ClipboardOperationClipboardAccessHelper",null,[381]);class kz{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){this.Ca=a;this.ld=b;this.es=c;this.Di=f;this.Tc=l;this.DZ=x;this.sr=H;this.kf=U;this.Rha=ja;this.yK=ya;this.Sha=Va;this.Dpb=hb;this.T4a=yb;this.ik=fc;this.mTb=Zb?Zb.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.HTb=Zb?Zb.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.VTb=Zb?Zb.ka("TextLayoutServiceUseResponse"):!1}get Ph(){return this.Di}get Wc(){return this.ld}vJl(a){a.vpa();return!0}NIf(a,b){a=b.ks;ia.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){B.a.Aua&&u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.If&&b.If.zg&&(c=b.If.zg.Rn);let f=!1;this.mTb&&B.a.Aua&&this.ik.Ild(c,"data-src","data-srcurl");this.HTb&&(f=this.ik.B_b(b.If.zg.Rn,
b.If.Ld,!0));this.VTb&&this.ik.Aud(c,!1);a=this.DZ.copy();this.mTb&&B.a.Aua&&this.ik.Ild(c,"data-srcurl","data-src");this.HTb&&f&&this.ik.B_b(b.If.zg.Rn,b.If.Ld,!1);this.VTb&&this.ik.Aud(c,!0);if(!a)return ia.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Wc.Xb(Pd.a.I8a,{["Reason"]:Md.a.A0e}),b.W0&&b.W0.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}Z0b(a,b){const c=b.If;ia.ULS.shipAssertTag(18130961,307,!!(b.ks&16));b.hnl?this.es.mFf():this.es.fXd(c,a);return!0}IMc(a,
b){var c=b.context,f=b.rd;const l=b.SJ;var x=!1;a=this.Tc.Na.mb.Ye;if(this.sr.um(a)||this.kf.Xl(a)){const H=this.yK.Nc(a.node);let U=H.$e();ia.ULS.shipAssertTag(18130962,307,U);this.Rha.Re(H);this.Sha.Yab(H)&&(x=!0)}f=b.ks&64?new J.DictionaryPropertySet:f||new J.DictionaryPropertySet;f.setValue(Mc.a.Lub,!1);c=this.Ca.mi(c,D.a.$K,2,!0,l,f);8===c&&(ia.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Wc.Xb(Pd.a.Lja,{["Reason"]:Md.a.lNf}),b.W0&&b.W0.fail("DeleteKey failed",!1),b.failed=!0);32===
c&&x&&(b=this.Tc.Na.mb,this.kf.lx(b)&&b.Ua.node===a.node&&!this.sr.textLength(b.Ua.node)&&(b=this.yK.Nc(b.Ua.node),a=this.kf.Bt(b),ia.ULS.shipAssertTag(18130964,307,a),this.Rha.Re(b),this.Sha.pzb(b)||(a=this.Dpb.create(),a.Rc(b),this.Rha.Vwa(a,!1,!1),x=this.Rha.wi(a),this.sr.$d(x)&&(this.Rha.Re(a),this.Ph.merge(a,b,!1,!1),this.Tc.setSelection(this.T4a.Sg(x,this.sr.textLength(x)))))));return!0}}Object(m.a)(kz,"ClipboardOperationCutCopy",null,[515]);class PH{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,
yb,Zb,fc){this.Ca=a;this.ld=b;this.es=c;this.DZ=x;this.Tc=l;this.Di=f;this.sr=H;this.kf=U;this.Rha=ja;this.yK=ya;this.Sha=Va;this.Dpb=hb;this.T4a=yb;this.$a=Zb;this.ik=fc}create(){return new kz(this.Ca,this.ld,this.es,this.Di,this.Tc,this.DZ,this.sr,this.kf,this.Rha,this.yK,this.Sha,this.Dpb,this.T4a,this.$a,this.ik)}}Object(m.a)(PH,"Factory",null,[380]);class QH{zth(){return!0}}Object(m.a)(QH,"ClipboardOperationCutStrategy",null,[373]);var Ls=d(465),oC=d(1221),pC=d(229);class Xo{constructor(a,b,
c,f,l,x=null,H="",U=!0){this.Usa=this.nrd=this.KZa=this.Lld=null;this.W9b=!1;this.Ede=null;this.VFe=0;this.context=a;this.If=a.view;this.ks=b;this.rd=l;this.W0=c;this.SJ=f;this.fLb=this.failed=!1;this.Hgd=null;this.Eab=this.Lzb=!1;this.hnl=Xo.NWd(a);this.browserName=H;this.wIh=U;this.qMa=!1;this.OQa=0;this.wVd=ka.a.create().toString();if(a=Object(Xa.a)(10,l)?l:null){this.KZa=new J.DictionaryPropertySet;this.KZa.$x(a);if(a.sa(Mc.a.vhd,!1)){this.Lzb=!0;this.Eab=a.sa(Mc.a.Eab,!1);this.Hgd=x;for(x=this.If.Lb.Pj;x.hx;)x=
x.getContext(0);if(l=Object(oa.a)(Mb.AParagraphNode,x.node)){c=0;f=Sb.ParagraphReader.textLength(l);switch(x.contextId){case Cb.a.textRange:c=x.Qa;f=x.Mb;break;case Cb.a.endOfParagraph:c=f}this.Lld=gc.a.L9i(x.node,c);ia.ULS.shipAssertTag(6305503,307,!!this.Lld);l=oc.HyperlinkReader.E5b(l);for(const ja of l)ja.Mb<=c||ja.Qa>=f||Xo.hyperlinkEditor.zM(x.node,ja.hyperlink)}}this.fLb=a.sa(Mc.a.fLb,!1);this.qMa=a.sa(Mc.a.qMa,!1)}b&64&&(this.fLb=!0)}static get Wc(){return Nc.a.instance}static get hyperlinkEditor(){return Xo.zn||
(Xo.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static NWd(a){if(a){if(a.hx){for(let b=0;b<a.length;b++)if(Xo.NWd(a.getContext(b)))return!0;return!1}if(Object(Xa.a)(pC.a,a))return Xo.NWd(a.CE);if(Sb.ParagraphReader.$d(a.node)&&a.node.kC)return!0}return!1}}Xo.zn=null;Object(m.a)(Xo,"ClipboardActionArguments",null,[]);var tv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";
a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(tv||(tv={}));Object(m.b)("ClipboardActionFlags",tv);const RH=a=>{a=a.Na.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},SH=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),
b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};class TH extends Ls.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg=!0){super();this.jKd=this.Rba=this.U6=this.ZB=null;this.init(a);this.Pl("ClipboardOperation");this.OEa(ja,b,l,x,H);this.ld=ya;this.kf=Va;this.zd=hb;this.Ak=yb;this.o9e=Zb;this.r9e=fc;this.p9e=Kc;this.s9e=Lc;this.Cwc=Gc;this.Hyd=ae;this.TQb=U;this.KQb=we;this.dPa=$d;this.U2h=Rg;this.JD=Te;this.fd=
Ze;this.Xs=Vf;this.Tba=gg;this.Ft=f;this.wBa=Qg;H&&Object(Xa.a)(10,H)&&(this.Rba=Object(oa.a)(524,H.sa(Mc.a.BQa,null)));this.Rba||(this.Rba=this.wBa.i_e());this.$1a=void 0===c||null===c?"NotAvailable":Object(oC.a)(tv,c);this.Rba.Sdi(this.$1a.split(", "));a=this.Ft;a.view.Mh?(this.Kg=a.view,this.Kg.Lb?(this.jI=0,this.rV=c,this.wqb=Lc.XHb,!Rg||this.wqb&&this.wqb.mb&&this.wqb.length?(Lc=nb.SelectionEditor.lx(this.wqb.mb),Lc=!(this.rV&16&&Lc),Lc=ae.EKj(c,this.Pj)&&Lc,1!==this.behavior&&Lc||(Lc||this.Rba.fail("Clipboard operation disabled for selection",
!0),this.Dp=Lc?32:8,this.GY())):(this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),this.Rba.fail("No selection when one required",!0),this.Dp=8,this.finish())):(this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),this.Rba.fail("No selection manager",!1),this.Dp=8,this.finish())):(this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.Mdd}),this.Rba.fail("Not in interactive view",!0),this.Dp=8,this.finish())}get Pj(){this.jKd||(this.jKd=qd.a.vsb(this.wqb));return this.jKd}f1(){super.f1();this.wqb=null}run(){0===this.jI&&
this.setup();1===this.jI&&this.process();2===this.jI&&this.teardownSync();3===this.jI&&this.teardownAsync();4===this.jI&&this.finish()}setup(){if(this.rV&256&&this.TQb){this.Yw||this.Cwc.$ri(this,this.rV,this.$1a);this.Yw.run();if(this.Yw.inProgress)return;const a=this.Yw.G5;this.FJc();if(!a){this.Rba.fail("No access to system clipboard",!0);this.Dp=8;this.jI=4;this.L1j();return}}else ia.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.rV,this.$1a,this.zd.Sy);
this.rV&32&&!this.kf.PYc(this.Kg.Lb.Pj)?(ia.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.pZd}),this.Rba.fail("Cut not allowed",!0),this.KQb.show(),this.Dp=8,this.jI=4):(this.rV&4096&&(this.Tba.bPe(Object.assign(new Ti,{Lig:!0,p9g:this.$1a})),this.Xs.undo()),this.Hyd.GIk(this.rV),this.ZB=this.Ak.me(15),this.ZB.kd(this.Kg.xg),this.jI=1)}process(){if(!this.Yw){ia.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.rV,this.$1a,
this.zd.Sy);ia.ULS.shipAssertTag(6305507,307,!this.U6);this.U6=new Xo(this.Ft,this.rV,this.Rba,this.SJ,this.qV,void 0,this.zd.Sy,this.U2h);let a;a=this.rV&65536?Object(F.a)(this.o9e,this.o9e.process,"process"):this.rV&64?Object(F.a)(this.r9e,this.r9e.process,"process"):this.rV&1?Object(F.a)(this.s9e,this.s9e.process,"process"):Object(F.a)(this.p9e,this.p9e.process,"process");this.rV&16&&this.Kg.Lb.bpa.x4d();this.dPa.create(this,a,this.U6).Pl("ClipboardAction")}ia.ULS.shipAssertTag(6305536,307,!!this.Yw);
this.Yw.run();this.Yw.inProgress||(this.FJc(),this.jI=this.Oi?2:3)}teardownSync(){this.U6.Lzb&&(this.ZB.jd=D.a.typing);this.U6.W9b&&this.ZB.mcd(this.U6.Ede,this.U6.VFe);this.ZB.dispose();this.Dp=this.U6.failed?8:32;this.jI=4}teardownAsync(){if(this.Yw){if(this.Yw.run(),this.Yw.inProgress)return}else if(this.U6.Lzb&&(this.ZB.jd=D.a.typing),this.ZB.TU(this),this.U6.W9b&&this.ZB.mcd(this.U6.Ede,this.U6.VFe),this.ZB.dispose(),this.JFc)return;this.Dp=this.U6.failed?8:32;this.jI=4}finish(){this.Tba.bPe(Object.assign(new Ti,
{Lig:!1}));this.GY();32===this.response?ia.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.rV,this.$1a,this.zd.Sy):ia.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.rV,this.$1a,this.zd.Sy);this.wBa.uDa(this.Rba)}L1j(){var a=!!(this.rV&1),b=this.Ft.view;if(b){var c=b.Lb;b=this.zd.Sy;u.AFrameworkApplication.Ta.processAction(D.a.cMf,
2);a?ia.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(ia.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=RH(c),1===a.length?ia.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=SH(a),ia.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}
Object(m.a)(TH,"ClipboardOperation",Ls.a,[]);class UH{constructor(a,b){this.Rwc=null;this.es=a;this.wV=b;this.UB=0}process(a,b){this.UB||(this.Rwc=[Object(F.a)(this,this.XAi,"copyGlossarySelection"),Object(F.a)(this.wV,this.wV.tDk,"pasteGlossaryPlaceholder")]);let c=!0;this.UB<this.Rwc.length&&(c=this.Rwc[this.UB++](a,b));return c?this.UB<this.Rwc.length:!1}XAi(a,b){if(!Object(Xa.a)(10,b.rd))return!1;const c=Object(oa.a)(10,b.rd);if(!c.Sa(Mc.a.d9f))return!1;const f=c.eb(Mc.a.d9f),l=b.If,x=l.Lb;this.es.ZGl();
x.Mmd(()=>{x.setSelection(f,void 0,!0);this.es.fXd(l,a)},!0);return!0}}Object(m.a)(UH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[523]);class VH{constructor(a){this.J2a=null;this.YR=a;this.UB=-1}process(a,b){-1===this.UB&&(this.ZIi(a,b),this.UB=0);let c=!1;this.UB<this.J2a.length&&(c=this.J2a[this.UB++](a,b));return c?this.UB<this.J2a.length:!1}ZIi(a,b){B.a.m9||b.ks&512?(this.J2a=[Object(F.a)(this.YR,this.YR.Z0b,"copyInternal")],ia.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Oi&&b.ks&256?(this.J2a=[Object(F.a)(this.YR,this.YR.vJl,"waitBeforeCopy"),Object(F.a)(this.YR,this.YR.NIf,"copyExternal"),Object(F.a)(this.YR,this.YR.Z0b,"copyInternal")],ia.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.J2a=[Object(F.a)(this.YR,this.YR.NIf,"copyExternal"),Object(F.a)(this.YR,this.YR.Z0b,"copyInternal")],ia.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.ks&32&&(a=Object(F.a)(this.YR,this.YR.IMc,"deleteForCut"),this.J2a.push(a),ia.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;ia.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.If)if(b=RH(b.If.Lb),1===b.length)ia.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=SH(b);ia.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",
b.length,c,a)}}}Object(m.a)(VH,"ClipboardOperationCutCopyProcessor",null,[516]);class WH{constructor(a,b,c,f){this.eBc=null;this.es=a;this.Tc=b;this.YR=c;this.wV=f;this.UB=0}process(a,b){this.UB||(this.eBc=[Object(F.a)(this,this.aBi,"copyMovedSelection"),Object(F.a)(this.YR,this.YR.IMc,"deleteForCut"),Object(F.a)(this,this.AZg,"moveIp"),Object(F.a)(this.wV,this.wV.x9g,"pasteInternal"),Object(F.a)(this.wV,this.wV.urh,"setSelectionAfterPaste")]);let c=!0;this.UB<this.eBc.length&&(c=this.eBc[this.UB++](a,
b));return c?this.UB<this.eBc.length:!1}aBi(a,b){b=b.If;this.es.LGl();this.es.fXd(b,a);return!0}AZg(a,b){b=new ib.Selection([b.rd],!0);this.Tc.setSelection(b,a);return!0}}Object(m.a)(WH,"ClipboardOperationMoveProcessor",null,[514]);class XH{constructor(a,b,c,f,l,x){this.QHd=null;this.plf=0;this.ld=f;this.zd=b;this.wV=l;this.pCd=c;this.TQb=u.AFrameworkApplication.mqd()&&!(B.a.wT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.Byd=a.appSettings.ChromeClipboardAccessOperationTimeout;
this.UB=0;this.AOh=x}get XHb(){return this.wV.XHb}process(a,b){if(0===this.UB)return this.BDk(b);if(1===this.UB)return this.prepareForPaste(a,b);if(2===this.UB)return this.UB=3,this.QHd(a,b);3===this.UB&&this.wV.urh(a,b);return!1}BDk(a){this.zd.m9||a.ks&512?(this.QHd=a.ks&2?Object(F.a)(this.wV,this.wV.paste,"paste"):Object(F.a)(this.wV,this.wV.x9g,"pasteInternal"),this.UB=2):(this.TQb?(this.UB=1,this.plf=Date.now()):this.UB=2,this.QHd=Object(F.a)(this.wV,this.wV.paste,"paste"));ia.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.pCd.value.hbh())this.UB=2;else{const c=Date.now()-this.plf;c>this.Byd&&(ia.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.ld.Xb(Pd.a.Lja,{["Reason"]:Md.a.P7g}),b.W0&&b.W0.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.AOh.T1k())}return a}}Object(m.a)(XH,"ClipboardOperationPasteProcessor",null,[513]);class YH{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){this.es=a;this.Ca=
b;this.TQb=c;this.ld=f;this.kf=l;this.zd=x;this.Ak=H;this.EOh=U;this.COh=ja;this.Cwc=ya;this.Hyd=Va;this.KQb=hb;this.dPa=yb;this.JD=Zb;this.fd=fc;this.Xs=Kc;this.Tba=Lc;this.wBa=Gc}create(a,b,c,f,l,x,H,U,ja=!0){const ya=this.EOh.create(f,Object(oa.a)(10,U));var Va=this.COh.create();const hb=new UH(this.es,ya),yb=new WH(this.es,qd.a.instance,Va,ya);Va=new VH(Va);f=new XH(u.AFrameworkApplication.fa,nd.a.instance,f,Nc.a.instance,ya,this.Cwc);return new TH(a,b,c,l,x,H,U,this.TQb,this.Ca,this.ld,this.kf,
this.zd,this.Ak,hb,yb,Va,f,this.Cwc,this.Hyd,this.KQb,this.dPa,this.JD,this.fd,this.Xs,this.Tba,this.wBa,ja)}}Object(m.a)(YH,"Factory",null,[383]);class lz{constructor(a,b){this.v$a=a.KSc(b);this.oXd=a.N6i(b);this.$6a=a.FRc(b);this.fQa=a.sRc(b)}static GW(a){return lz.xr(a)}static xr(a){return new lz(me.a.instance,a)}}Object(m.a)(lz,"CpUsageHelper",null,[]);var Ms=d(177);class ZH{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.ld=a;this.es=b;this.AVb=c;this.fca=f;this.Tc=l;this.Ca=x;this.pCd=H;this.KXb=
ja;this.THd=U;this.$zd=ya;this.Gyd=Va;this.fd=hb}get Kn(){return this.KXb.value}get aba(){return this.fca}get Wc(){return this.ld}get XHb(){return this.THd.XHb}paste(a,b){const c=this.fd.gsb();try{const f=b.If;ia.ULS.shipAssertTag(18131010,307,!!(b.ks&1));Object(Xa.a)(10,b.rd)&&b.rd.setValue(Ms.a.Y2b,f.zg.Rn.clientWidth);this.Gyd.iAl(a,b);let l;if(!({QKc:l}=this.pCd.value.HDh()).returnValue)return b.W0&&b.W0.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.Kn.qw();let x=!0,H=null;const U=
this.$zd.create(l),ja=b.wIh;f.Lb.Mmd(()=>{ja&&2===this.Ca.processAction(D.a.$Ca,2)?x=!1:(H=ja?this.Tc.Na.mb.Ua:b.rd,ia.ULS.shipAssertTag(18158338,307,nb.SelectionEditor.Tg(H)),this.Dqg(H,"paste"))},this.THd.Ukg);if(!x)return!1;f.editingView.disable(!0,25);U.restore();this.AVb.nDk(l,H,a);return!0}finally{c&&c.dispose()}}tDk(a,b){this.Kn.qw();const c=(new LF.a).me(15);c.kd(this.es.G1e);b=Object(oa.a)(10,b.rd).eb(Mc.a.lpj);ia.ULS.shipAssertTag(20492440,307,nb.SelectionEditor.Tg(b));this.AVb.wfg(b,a);
this.es.mFf();c.dispose();return!0}x9g(a){this.Kn.qw();this.Ca.processAction(D.a.$Ca,2);const b=this.Tc.Na.mb.Ua;ia.ULS.shipAssertTag(18158339,307,nb.SelectionEditor.Tg(b));this.Dqg(b,"intPaste");this.AVb.wfg(b,a);return!0}Dqg(a,b){b=lz.GW(b);this.aba.ERk(b,a.node,a.Qa);this.aba.M1j(b.oXd);this.aba.ooe(b.v$a);this.aba.ioe(b.$6a);this.aba.hoe(b.fQa)}urh(a,b){if(!b.wIh)return!1;b.ks&64&&this.es.YGl();if(!b.Usa)return ia.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Wc.Xb(Pd.a.N1,
{["Reason"]:Md.a.Cfg}),b.W0&&b.W0.fail("No selection after paste",!1),b.failed=!0,!1;this.THd.DGl(b);this.Kn.qw();return!1}}Object(m.a)(ZH,"ClipboardOperationPaste",null,[512]);class $H{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.ld=a;this.es=b;this.AVb=c;this.fca=f;this.Tc=l;this.Ca=x;this.KXb=U;this.aYh=H;this.$zd=ja;this.Gyd=ya;this.fd=Va}create(a,b){b=this.aYh.create(this.Tc,b);return new ZH(this.ld,this.es,this.AVb,this.fca,this.Tc,this.Ca,a,b,this.KXb,this.$zd,this.Gyd,this.fd)}}Object(m.a)($H,
"Factory",null,[379]);class aI{constructor(a,b){this.Y0h=a;this.QXh=b}get stylePropertySet(){return this.Y0h}get jCk(){return this.QXh}}Object(m.a)(aI,"ParagraphFormatStore",null,[]);class bI{constructor(a,b,c,f){this.Tc=a;this.sr=b;this.JK=c;this.FUh=f}iAl(a,b){if(b.Lzb&&this.FUh){b=a.G5;var c=this.Tc.Na.mb.Ua.node,f=null;this.sr.$d(c)&&(f=this.JK.bE(c),c=this.sr.yta(c),f=new aI(f,c));b=new Xo(b.context,b.ks,b.W0,b.SJ,b.rd,f);a.G5=b}}}Object(m.a)(bI,"ClipboardOperationPasteOvertypeStrategy",null,
[378]);class rx{constructor(a){this.xFd=null;this.Tc=a;a.Mmd(b=>{this.xFd=b},!1)}get Ukg(){return!1}DGl(a){a=this.RYb(a);this.setSelection(this.Tc,a)}RYb(a){let b=a.Usa;(a.qMa||a.fLb)&&a.nrd&&(b=Qd.SelectionFactory.DN(a.nrd,b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(m.a)(rx,"AClipboardOperationPasteStrategy",null,[545]);class cI extends rx{constructor(a){super(a)}get XHb(){return this.xFd}}Object(m.a)(cI,"ClipboardOperationPasteToLiveSelectionStrategy",rx,[]);class dI extends rx{constructor(a,
b){super(a);this.mNd=null;this.SUb=b;a.Mmd(c=>{this.mNd=c},!0)}get Ukg(){return!0}get XHb(){return this.mNd}RYb(a){let b=super.RYb(a);a.rd.setValue(Mc.a.HDk,b);return b=this.SUb.KMl(this.xFd.mb,this.mNd.mb,b)}}Object(m.a)(dI,"ClipboardOperationPasteToVirtualSelectionStrategy",rx,[]);class eI{constructor(a){this.SUb=null;this.lNd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(Mc.a.qMa,!1)&&this.lNd?new dI(a,this.aJl):new cI(a)}get aJl(){this.SUb||(this.SUb=Db.a.instance.ub("Box4.Actors.IVirtualSelectionMerger"));
return this.SUb}}Object(m.a)(eI,"ClipboardOperationPasteStrategyFactory",null,[382]);class qC{constructor(a,b,c,f,l,x){this.ld=a;this.Tc=b;this.cha=c;this.DD=f;this.gUh=l;this.UUh=x}GIk(a){this.UUh&&(a&1||a&32)&&this.cha.rw&&this.Tc.iYb()}EKj(a,b){return this.gUh?a&1&&this.DD.v7a(b)?(this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),!1):!0:!0}}Object(m.a)(qC,"ClipboardOperationWordStrategy",null,[]);class fI{constructor(a){this.APh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}AAi(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.APh&&c.reverse();var f=b=0,l=0,x=0;for(const U of c){c=U.style;var H=U.selectorText;c=c?c.cssText:null;H=H?H.split(","):null;if(c&&H&&U.type===U.STYLE_RULE){x+=H.length;for(const ja of H){0<=ja.indexOf("#")&&b++;0<=ja.indexOf(".")&&f++;0>ja.indexOf("#")&&0>ja.indexOf(".")&&l++;H=null;try{H=a.querySelectorAll(ja)}catch(ya){ia.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ja,ya.message)}if(H)for(let ya=0;ya<H.length;ya++)H[ya].setAttribute("style",c+(H[ya].getAttribute("style")||""))}}}ia.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",x,b,f,l)}else this.Wqg();else this.Wqg()}Wqg(){ia.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
B.a.Sy)}}Object(m.a)(fI,"ExternalPasteCssConverter",null,[387]);var mz=d(1228);class sx{constructor(a){this.AV=this.ZTb=null;this.oXb=a.currentNode;const b=new tb.GraphIterator;b.Rc(a);this.xHd=new tb.GraphIterator;this.xHd.Rc(a);this.uHd=b.origin;this.yyd=Array(b.depth);this.fnb=Array(b.depth);this.zyd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.fnb[a]=b.role;this.zyd[a]=c;b.zc();this.yyd[a]=b.S4i(c,this.fnb[a])}}em(a,b){this.ZTb=a;this.AV=b}restore(a){const b=new mz.a,c=
new mz.a;this.nlh(a,b,c);return c.value}nlh(a,b,c){b.value=!0;if(this.xHd.isValid)a.Rc(this.xHd),c.value=!1;else{for(let f=this.zyd.length-1;0<=f;--f){const l=this.zyd[f];if(l.anchor&&!l.anchor.YI&&(a.set(l),a.Vaa(this.uHd)||this.uHd.Sje&&a.EEh())){c.value=this.RTf(a,f+1);return}b.value=!1}a.set(this.uHd);c.value=this.RTf(a,0)}}RTf(a,b){let c=!1,f,l;f=this.yyd[b];l=this.fnb[b];const x=a.E8(l);if(f<x)a.Zp(f,l);else if(c=!0,!a.ZA(l))return!0;if(!this.FZg(a,l))return c;for(b+=1;b<this.yyd.length;++b){if(c){if(!a.ZA(this.fnb[b]))return!0}else if(!a.Bb(this.fnb[b]))return!1;
if(!this.FZg(a,this.fnb[b]))break}return c}FZg(a,b){if(this.ZTb&&!this.ZTb(a,this.AV)){const c=new tb.GraphIterator;c.Rc(a);let f=!0;do if(!a.Cf(b)){f=!1;break}while(!this.ZTb(a,this.AV));if(!f){a.Rc(c);do if(!a.JF(b))return a.zc(),!1;while(!this.ZTb(a,this.AV))}}return!0}}Object(m.a)(sx,"NodeReference",null,[]);var tn=d(185);class Dj{constructor(a,b,c,f){this.YWb=this.Zo=this.Vg=this.Vw=this.IK=this.kI=null;this.ZCd=!1;this.KPh=100;this.Dpb=this.WHd=this.ZMa=this.fd=this.JD=this.ap=this.oCh=null;
this.W5k=()=>{this.ZCd&&this.owc&&gm.a.instance.Lg(this.owc);this.owc||(this.owc=new af.a(3,1,this.KPh,()=>{this.NTd();this.ZCd=!1},215));gm.a.instance.Db(this.owc);this.ZCd=!0;return!1};this.Tyb=a;this.k4d=this.Ghb=null;this.Bg=b;this.transaction=c;this.mia=f}get fa(){return u.AFrameworkApplication.fa}get jP(){return this.IK||(this.IK=Db.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.Vw||(this.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}get JJ(){return this.kI||
(this.kI=Db.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get EB(){return Dj.Tx||(Dj.Tx=Db.a.instance.resolve("Box4.IOutlineEditor"))}get Sf(){return this.Vg||(this.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}get eq(){return this.Zo||(this.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}get Drc(){return this.YWb||(this.YWb=Db.a.instance.ub("Box4.List.ISingleLevelListEditor"))}get C6(){return this.ap||(this.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get Gtc(){return this.JD||
(this.JD=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Tf(){return this.fd||(this.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get vUd(){return this.ZMa||(this.ZMa=Db.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get sDk(){return this.Tba||(this.Tba=Db.a.instance.resolve("Box4.IPasteFloatieEventSource"))}get Zsc(){return this.R1h||(this.R1h=Db.a.instance.resolve("Box4.ITextPasteFloatieManager"))}get uhd(){return this.WHd||
(this.WHd=Db.a.instance.ub("Box4.IPastedParagraphSpaceHandler"))}set uhd(a){this.WHd=a}get T9g(){return!1}get Lth(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}uTf(){}C9g(a){var b=void 0===this.Bg.ks||null===this.Bg.ks?"not available":Object(oC.a)(tv,this.Bg.ks);ia.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Bg.ks,b);ia.ULS.shipAssertTag(6305487,307,nb.SelectionEditor.Tg(this.Tyb));if(this.Qdd)return ia.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Bg.Usa=Qd.SelectionFactory.Du(this.Tyb),
a.Wg(Object(F.a)(this,this.tZa,"pasteTeardown")),!0;b=new tb.GraphIterator;b.set(this.Tyb.node);nb.SelectionEditor.Bt(b);Ta.OutlineElementNavigator.Re(b);this.oCh=b.origin;if(this.T9g)return b.IB(10),this.uTf(b,a),a.Wg(Object(F.a)(this,this.gdl,"setSelectionAfterPastingOutlines")),!0;if(Hf.b(b)){if(this.lhg)return this.Bg.Usa=this.ADk(this.Tyb,this.ZHf),a.Wg(Object(F.a)(this,this.tZa,"pasteTeardown")),!0;this.Tyb=this.Omk(b).ga(0)}this.spl(this.Tyb);const c=new tn.a;c.Rc(b);Ta.OutlineElementNavigator.FJ(c,
!1,!1);this.Ghb=new sx(b);this.k4d=new sx(c);a.Wg(Object(F.a)(this,this.qDk,"pasteExecution"));return!0}qDk(a){bd.a.mark(5568);this.tTf(a);let b=Object(F.a)(this,this.plk,"mergeAfterPaste");if(this.Zjg){const c=this.Auh();c&&(b=Object(F.a)(this,this.tZa,"pasteTeardown"));ia.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.Wg(b);return!0}Auh(){return!1}get Zjg(){return this.fa.ka("PptCcpFix2IsEnabled")}get Chl(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}plk(a){bd.a.mark(5569);
var b=new tb.GraphIterator;this.Ghb.restore(b);this.Ghb=null;var c=new tb.GraphIterator;this.k4d.restore(c);this.k4d=null;ia.ULS.shipAssertTag(6305489,307,fe.OutlineElementReader.Yg(b));ia.ULS.shipAssertTag(6305490,307,fe.OutlineElementReader.Yg(c));Ta.OutlineElementNavigator.wi(b);Sb.ParagraphReader.el(b)&&Sb.ParagraphReader.textLength(b.currentNode);Ta.OutlineElementNavigator.Re(b);Ta.OutlineElementNavigator.wi(c);ia.ULS.shipAssertTag(6305491,307,Sb.ParagraphReader.el(c));var f=Sb.ParagraphReader.textLength(c.currentNode);
Ta.OutlineElementNavigator.Re(c);const l=this.Xth;var x=new tn.a;x.Rc(b);Ta.OutlineElementNavigator.FJ(x,!1,!1);var H=x.currentNode===c.currentNode;var U=!!this.Bg&&!!(this.Bg.ks&8192);let ja=!1;!U&&this.Bg.rd&&Object(Xa.a)(J.DictionaryPropertySet,this.Bg.rd)&&2===Oc.App.mode&&(U=(U=this.Bg.rd.Lh(Mc.a.mhb))&&""!==U?!0:!1);if(H)x=tb.GraphIterator.nb(b.currentNode),Sb.ParagraphReader.ps(Ta.OutlineElementNavigator.wi(x))||(b=c),b.currentNode.id!==c.currentNode.id&&(ia.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",rb.ListReader.uk(b),rb.ListReader.uk(c)),x=Dj.Ph.merge(b,c,!0,U),ia.ULS.shipAssertTag(6305492,307,x)),c=b,U=!0;else{var ya=!!(this.Bg.ks&4);H=this.Tf.gg&&this.Tf.Uy&&ya&&this.Bg.Eab;this.uhd&&this.Bg&&2===Oc.App.mode&&!ya&&(this.uhd.uwj(b,!1),this.uhd.uwj(c,!0));Ta.OutlineElementNavigator.wi(x);Sb.ParagraphReader.el(x)&&Sb.ParagraphReader.textLength(x.currentNode);Ta.OutlineElementNavigator.Re(x);this.ffi(x,
b,c);if(this.vUd.x_b||this.Chl)if(ya=new tn.a,ya.Rc(x),Ta.OutlineElementNavigator.FJ(ya,!1,!1),ya.yq.id!==c.yq.id){for(;x.currentNode.id!==c.currentNode.id;)Ta.OutlineElementNavigator.wi(x,!1),Wd.a.create(x.currentNode),x.zc(),Ta.OutlineElementNavigator.FJ(x,!1,!1);x.Rc(b);Ta.OutlineElementNavigator.FJ(x,!1,!1)}else ja=!0;if(this.Bg.Lld&&(ia.ULS.shipAssertTag(6305493,307,this.Bg.Lzb),ya=new tb.GraphIterator,ya.Rc(x),ya=Ta.OutlineElementNavigator.wi(ya))){var Va=this.Bg.Lld.ae(ya.Ra.ga(0));ya.Ra.ga(0).formatting=
Va}rb.ListReader.uk(b)?(Dj.IL.Q$b&&this.Drc&&this.Drc.UMl(b),ya=rb.ListReader.uk(x)?this.Yth:!0):fe.OutlineElementReader.isEmpty(b,!0)?(Dj.Ph.fDa(b),ya=!1):ya=rb.ListReader.nx||!rb.ListReader.uk(x);this.Bg.nrd=null;if(this.Bg.fLb||this.Bg.qMa)this.Bg.nrd=this.rkj(ya?b.currentNode:x.currentNode,ya);if(ya&&(Va=rb.ListReader.uk(b),ia.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Va,rb.ListReader.uk(c)),Dj.Ph.merge(b,x,!0,U,c,void 0,
ja,H),rb.ListReader.uk(b)&&this.Sf.Kmc)){var hb=new tn.a;hb.Rc(b);Ta.OutlineElementNavigator.FJ(hb,!1,!1);if(hb.yq.id!==c.yq.id){var yb=this.Sf.jw(b);this.Sf.ina(b);const Kc=b.currentNode.sa(ab.a.listID,0);b.zc();for(yb.xA=zk.a.Kw;hb.currentNode.id!==c.currentNode.id;){if(!rb.ListReader.uk(hb))({cab:yb}=this.eq.Hrb(yb.propertySet,hb,yb));else if(Va){var Zb=this.Sf.Obj(hb),fc=this.Sf.d8d(b.currentNode,Kc,Zb);fc=fc?dj.a.NCa(fc,null):yb;Zb=dj.a.wN(fc.listType,yb.listStyle,null,0,Zb,"","");Zb.Kpk=b.currentNode;
this.eq.ecl(Zb);this.eq.FVe(hb,!0)}Ta.OutlineElementNavigator.FJ(hb,!1,!1)}}}l?(Va=new tn.a,Va.Rc(c),Ta.OutlineElementNavigator.Vwa(Va,!1,!1),hb=rb.ListReader.uk(Va),yb=rb.ListReader.uk(c),U=Dj.Ph.merge(Va,c,!0,U,void 0,!0,void 0,H),ia.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",hb,yb,U?"True":"False, will cause IP to reset to zero."),c=U?Va:c):(U=!1,ia.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.vUd.x_b&&ja&&(ya?(x=new tb.GraphIterator,x.Rc(b),Ta.OutlineElementNavigator.wi(x)):l?(b=new tb.GraphIterator,b.Rc(x),Ta.OutlineElementNavigator.wi(b)):(b=new tb.GraphIterator,b.Rc(x),b=Ta.OutlineElementNavigator.wi(b),Wd.a.create(b)))}ia.ULS.shipAssertTag(6305494,307,c.isValid);b=Ta.OutlineElementNavigator.wi(c);f=U?Sb.ParagraphReader.textLength(b)-f:0;x=!1;Object(Xa.a)(10,this.Bg.rd)&&(x=this.Bg.rd.sa(Mc.a.EZc,!1));x&&P.a.instance.ga(11)?this.Bg.Usa=Qd.SelectionFactory.f3(b,f-1,f):this.Bg.Usa=
Qd.SelectionFactory.Sg(b,f);P.a.instance.ga(71)&&this.Bg&&this.Bg.Lzb&&Sb.ParagraphReader.$d(b)&&this.Bg.Hgd&&((f=this.Bg.Hgd.stylePropertySet)&&this.jP.Eaa(f,b,!0),(f=this.Bg.Hgd.jCk)&&this.paragraphEditor.sxf(b,f));a.Wg(Object(F.a)(this,this.tZa,"pasteTeardown"));return!0}ffi(a,b,c){var f=!1;this.Tf.gg&&this.Tf.Uy&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){Ta.OutlineElementNavigator.wi(a,!1);f=this.Gtc.kpl(Wd.a.create(a.currentNode));f.t8f();for(let l=0;l<f.length;l++){let x;const H=({ong:x}=
f.getContext(l)).returnValue;x&&Dj.hyperlinkEditor.KGb(H,1)}a.zc();Ta.OutlineElementNavigator.FJ(a,!1,!1)}a.Rc(b);Ta.OutlineElementNavigator.FJ(a,!1,!1)}}rkj(a,b){a=tb.GraphIterator.nb(a);Ta.OutlineElementNavigator.wi(a);return Sb.ParagraphReader.$d(a.currentNode)?(b=b?Sb.ParagraphReader.textLength(a.currentNode):0,Qd.SelectionFactory.Sg(a.currentNode,b)):od.TableReader.qbb(a.currentNode)?Qd.SelectionFactory.wl(a.currentNode):null}gdl(a){const b=tb.GraphIterator.nb(this.oCh);b.ZA(1);this.Bg.Usa=Qd.SelectionFactory.tj(b.currentNode,
!1);a.Wg(Object(F.a)(this,this.tZa,"pasteTeardown"));return!0}tZa(a){var b=void 0===this.Bg.ks||null===this.Bg.ks?"not available":Object(oC.a)(tv,this.Bg.ks);ia.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Bg.ks,b);ia.ULS.shipAssertTag(6305497,307,!!this.Bg.Usa);this.transaction.dispose();b=this.mia.MK;if(!b.Mh||!b.editingView.Wl)return!1;b.editingView.Ttl();return this.fa.ka("IsPasteTextFloatieEnabled")?(a.Wg(this.W5k,"scheduleCallPasteFloatieTask"),!0):!1}NTd(){this.sDk.Eeh(new bj(1,
u.AFrameworkApplication.isRtl));this.Bg&&this.Bg.ks&&(1===this.Bg.ks?this.Zsc.Mua=D.a.Z7:257===this.Bg.ks?this.Zsc.Mua=D.a.paste:8449===this.Bg.ks?this.Zsc.Mua=D.a.L5:4097===this.Bg.ks?this.Zsc.Mua=D.a.reformatPastedContent:12289==this.Bg.ks&&(this.Zsc.Mua=D.a.e_a))}Pgl(a,b){const c=new tb.GraphIterator;c.Rc(a);a=Ta.OutlineElementNavigator.wi(c);b=Sb.ParagraphReader.$d(a)&&b===Sb.ParagraphReader.textLength(a);ia.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}spl(a){ia.ULS.shipAssertTag(6305498,
307,nb.SelectionEditor.Tg(a));const b=tb.GraphIterator.nb(a.node);var c=b.$e();Ta.OutlineElementNavigator.Re(b);ia.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=Dj.Ph.T8b(b,!0);const f=this.Pgl(b,a.Qa);Dj.Ph.lNb(b,c,a,!1,!1,f)}ADk(a,b){ia.ULS.shipAssertTag(6305500,307,a.contextId===Cb.a.Pf);const c=a.node;b=b.replace(ha.a.zAc," ");Dj.characterPropertiesEditor.replaceTextRange(a,b);return Qd.SelectionFactory.Sg(c,
a.Qa+b.length)}Omk(a){a.ev();Dj.Zl.CKa(a);const b=Dj.Jk.z4f(a),c=this.JJ.s1b(a);b?mq.c(a.currentNode,b+1,b+2):this.EB.Qod(c,Oc.App.Kb.Kd.Dn.V6b());this.EB.S8b(a,null,!0);return Qd.SelectionFactory.tj(a.currentNode,!0)}static get Zl(){return Ey.PageNavigator.instance}static get characterPropertiesEditor(){return Dj.fh||(Dj.fh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return Dj.zn||(Dj.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Jk(){return Uw.PageReader.instance}static get Ph(){return Dj.Di||
(Dj.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get IL(){return Dj.AK||(Dj.AK=Db.a.instance.ub("Box4.List.ListSettings"))}static get ze(){return Dj.hd||(Dj.hd=Db.a.instance.ub("Box4.IFeatureHelper"))}}Dj.Tx=null;Dj.hd=null;Dj.Di=null;Dj.fh=null;Dj.zn=null;Dj.AK=null;Object(m.a)(Dj,"APasteExecutionManager",null,[]);var iQ=d(1227);class gI{constructor(){this.ks=0;this.$0b=6;this.M4d=this.L4d=this.aYf=this.K4d=this.J4d=this.I4d=this.H4d=!1;this.aNe=null;this.$Xf=this.d9a=this.J4b=
this.ZXf=this.cYf=!1;this.M9g=this.UHb=0;this.nJe=this.platform=null;this.p3a={}}get MZe(){if(this.M4d)return"Word Online";if(this.K4d)return"Google Docs";if(this.L4d||this.I4d||this.J4d)return"PowerPoint Online";if(this.H4d)return"Excel Online";switch(this.aNe){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}E2j(){ia.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.rki()))}F2j(){const a=
this.p3a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.MZe,f.Browser=iQ.a[this.UHb],f.TagName=b,f.OperationId=this.nJe,ia.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}lCj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.p3a||(this.p3a[a]={}),this.p3a[a][b]=this.Mkj(a,b)+1)}Mkj(a,b){if(!(a&&a.length&&b&&b.length&&this.p3a&&a in this.p3a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.p3a[a])&&b in a?a[b]:0}rki(){const a={};a.ActionIdFlags=
this.ks;a.FoundDataCcpTimestampAttribute=this.H4d;a.FoundDataClipserviceCcpidAttribute=this.I4d;a.FoundDataShapeIdsAttribute=this.J4d;a.FoundGoogleDocsInternalGuidId=this.K4d;a.FoundOneNoteOnlineSequenceClass=this.aYf;a.FoundPowerPointOnlineSequenceClass=this.L4d;a.FoundWordOnlineSequenceClass=this.M4d;a.ProgId=this.aNe;a.SourceApp=this.MZe;a.FoundText=this.cYf;a.FoundEquation=this.ZXf;a.FoundList=this.J4b;a.FoundTable=this.d9a;a.FoundImage=this.$Xf;a.CopySourceBrowser=this.$0b;a.PasteBrowser=this.UHb;
a.IsSameBrowserPaste=this.xTj(this.$0b,this.UHb);a.IsCrossBrowserPaste=this.vLj(this.$0b,this.UHb);a.IsUncategorizedBrowserPaste=this.uWj(this.$0b,this.UHb);a.Platform=this.platform;a.PastedHtmlLength=this.M9g;a.OperationId=this.nJe;return a}xTj(a,b){return 5===a||6===a?!1:a===b}vLj(a,b){return 6===a?!1:a!==b}uWj(a,b){return 5===a&&5===b}}Object(m.a)(gI,"HtmlContentMetadata",null,[]);class nz{constructor(a,b,c=!1){this.Vf=a;this.mw=b;this.dei=c}}Object(m.a)(nz,"TagEventParam",null,[]);class rC{constructor(a,
b=null){this.Lxc=this.Nlf=this.NMd=this.Tqf=null;this.Mc=a;this.yS=b||Mm.a.x2f("");this.Kel()}get Nb(){return this.yS}upk(a,b,c){this.NMd[b]?this.o0g():(this.Nb.e++,(b=this.Lxc[b])&&b(new nz(a,c,!1)),this.Nb.b++)}o0g(){this.Nb.d++}npk(){this.Nb.c++}dpk(a,b,c){if(this.NMd[b])this.o0g();else{if(b=this.Lxc[b])return this.Nb.b++,b(new nz(a,c,!1));this.Nb.f++}return 2}Kel(){this.Tqf=pa.a.QH("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",
!0);this.NMd=pa.a.QH("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.Nlf=pa.a.QH("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Mc,b=this.Mc,c=this.Mc,f=this.Mc,l=this.Mc,x=this.Mc,H=this.Mc,U=this.Mc,
ja=this.Mc,ya=this.Mc,Va=this.Mc,hb=this.Mc,yb=this.Mc,Zb=this.Mc,fc=this.Mc,Kc=this.Mc,Lc=this.Mc,Gc=this.Mc,ae=this.Mc,we=this.Mc;this.Lxc=pa.a.QH("A",Object(F.a)(this.Mc,this.Mc.bed,"onAOpen"),"ABBR",Object(F.a)(this.Mc,this.Mc.fGe,"onAbbrOpen"),"ACRONYM",Object(F.a)(this.Mc,this.Mc.gGe,"onAcronymOpen"),"ADDRESS",Object(F.a)(this.Mc,this.Mc.iGe,"onAddressOpen"),"APPLET",Object(F.a)(this.Mc,this.Mc.pGe,"onAppletOpen"),"AREA",Object(F.a)(this.Mc,this.Mc.sGe,"onAreaTag"),"B",Object(F.a)(this.Mc,this.Mc.ged,
"onBOpen"),"BASE",Object(F.a)(this.Mc,this.Mc.tGe,"onBaseTag"),"BASEFONT",Object(F.a)(this.Mc,this.Mc.uGe,"onBasefontTag"),"BDO",Object(F.a)(this.Mc,this.Mc.vGe,"onBdoOpen"),"BIG",Object(F.a)(this.Mc,this.Mc.ned,"onBigOpen"),"BLOCKQUOTE",Object(F.a)(this.Mc,this.Mc.oed,"onBlockquoteOpen"),"BODY",Object(F.a)(this.Mc,this.Mc.HGe,"onBodyOpen"),"BR",Object(F.a)(this.Mc,this.Mc.ped,"onBrTag"),"BUTTON",Object(F.a)(this.Mc,this.Mc.MGe,"onButtonOpen"),"CAPTION",Object(F.a)(this.Mc,this.Mc.qed,"onCaptionOpen"),
"CENTER",Object(F.a)(this.Mc,this.Mc.ted,"onCenterOpen"),"CITE",Object(F.a)(this.Mc,this.Mc.wed,"onCiteOpen"),"CODE",Object(F.a)(this.Mc,this.Mc.yed,"onCodeOpen"),"COL",Object(F.a)(this.Mc,this.Mc.YGe,"onColTag"),"COLGROUP",Object(F.a)(this.Mc,this.Mc.ZGe,"onColgroupOpen"),"DD",Object(F.a)(this.Mc,this.Mc.Bed,"onDdOpen"),"DEL",Object(F.a)(this.Mc,this.Mc.Ced,"onDelOpen"),"DFN",Object(F.a)(this.Mc,this.Mc.Eed,"onDfnOpen"),"DIR",Object(F.a)(this.Mc,this.Mc.Fed,"onDirOpen"),"DIV",Object(F.a)(this.Mc,
this.Mc.Hed,"onDivOpen"),"DL",Object(F.a)(this.Mc,this.Mc.Ied,"onDlOpen"),"DT",Object(F.a)(this.Mc,this.Mc.Jed,"onDtOpen"),"EM",Object(F.a)(this.Mc,this.Mc.Med,"onEmOpen"),"FIELDSET",Object(F.a)(this.Mc,this.Mc.vHe,"onFieldsetOpen"),"FONT",Object(F.a)(this.Mc,this.Mc.Ued,"onFontOpen"),"FORM",Object(F.a)(this.Mc,this.Mc.BHe,"onFormOpen"),"FRAME",Object(F.a)(this.Mc,this.Mc.CHe,"onFrameTag"),"FRAMESET",Object(F.a)(this.Mc,this.Mc.DHe,"onFramesetOpen"),"H1",Object(F.a)(this.Mc,this.Mc.Zed,"onH1Open"),
"H2",Object(F.a)(this.Mc,this.Mc.$ed,"onH2Open"),"H3",Object(F.a)(this.Mc,this.Mc.afd,"onH3Open"),"H4",Object(F.a)(this.Mc,this.Mc.bfd,"onH4Open"),"H5",Object(F.a)(this.Mc,this.Mc.cfd,"onH5Open"),"H6",Object(F.a)(this.Mc,this.Mc.dfd,"onH6Open"),"HEAD",Object(F.a)(this.Mc,this.Mc.HHe,"onHeadOpen"),"HR",Object(F.a)(this.Mc,this.Mc.efd,"onHrTag"),"HTML",Object(F.a)(this.Mc,this.Mc.JHe,"onHtmlOpen"),"I",Object(F.a)(this.Mc,this.Mc.ffd,"onIOpen"),"IFRAME",Object(F.a)(this.Mc,this.Mc.LHe,"onIframeOpen"),
"IMG",Object(F.a)(this.Mc,this.Mc.gfd,"onImgTag"),"INPUT",Object(F.a)(this.Mc,this.Mc.NHe,"onInputTag"),"INS",Object(F.a)(this.Mc,this.Mc.hfd,"onInsOpen"),"ISINDEX",Object(F.a)(this.Mc,this.Mc.UHe,"onIsindexOpen"),"KBD",Object(F.a)(this.Mc,this.Mc.ifd,"onKbdOpen"),"LABEL",Object(F.a)(this.Mc,this.Mc.kfd,"onLabelOpen"),"LEGEND",Object(F.a)(this.Mc,this.Mc.mfd,"onLegendOpen"),"LI",Object(F.a)(this.Mc,this.Mc.nfd,"onLiOpen"),"LINK",Object(F.a)(this.Mc,this.Mc.YHe,"onLinkTag"),"MAP",Object(F.a)(this.Mc,
this.Mc.ZHe,"onMapOpen"),"MATH",Object(F.a)(this.Mc,this.Mc.rfd,"onMathOpen"),"MENU",Object(F.a)(this.Mc,this.Mc.fHb,"onMenuOpen"),"META",Object(F.a)(this.Mc,this.Mc.bIe,"onMetaTag"),"NOFRAMES",Object(F.a)(this.Mc,this.Mc.eIe,"onNoframesOpen"),"NOSCRIPT",Object(F.a)(this.Mc,this.Mc.fIe,"onNoscriptOpen"),"OBJECT",Object(F.a)(this.Mc,this.Mc.gIe,"onObjectOpen"),"OL",Object(F.a)(this.Mc,this.Mc.yfd,"onOlOpen"),"OPTGROUP",Object(F.a)(this.Mc,this.Mc.hIe,"onOptgroupOpen"),"OPTION",Object(F.a)(this.Mc,
this.Mc.Cfd,"onOptionOpen"),"P",Object(F.a)(this.Mc,this.Mc.Ffd,"onPOpen"),"PARAM",Object(F.a)(this.Mc,this.Mc.iIe,"onParamTag"),"PRE",Object(F.a)(this.Mc,this.Mc.Rfd,"onPreOpen"),"Q",Object(F.a)(this.Mc,this.Mc.sIe,"onQOpen"),"S",Object(F.a)(this.Mc,this.Mc.Zfd,"onSOpen"),"SAMP",Object(F.a)(this.Mc,this.Mc.$fd,"onSampOpen"),"SCRIPT",Object(F.a)(this.Mc,this.Mc.DIe,"onScriptOpen"),"SELECT",Object(F.a)(this.Mc,this.Mc.EIe,"onSelectOpen"),"SMALL",Object(F.a)(a,a.igd,"onSmallOpen"),"SPAN",Object(F.a)(b,
b.jgd,"onSpanOpen"),"STRIKE",Object(F.a)(c,c.kgd,"onStrikeOpen"),"STRONG",Object(F.a)(f,f.lgd,"onStrongOpen"),"STYLE",Object(F.a)(l,l.KIe,"onStyleOpen"),"SUB",Object(F.a)(x,x.mgd,"onSubOpen"),"SUP",Object(F.a)(H,H.ogd,"onSupOpen"),"TABLE",Object(F.a)(U,U.sgd,"onTableOpen"),"TBODY",Object(F.a)(ja,ja.NIe,"onTbodyOpen"),"TD",Object(F.a)(ya,ya.Ekc,"onTdOpen"),"TEXTAREA",Object(F.a)(Va,Va.PIe,"onTextareaOpen"),"TFOOT",Object(F.a)(hb,hb.QIe,"onTfootOpen"),"TH",Object(F.a)(yb,yb.tgd,"onThOpen"),"THEAD",
Object(F.a)(Zb,Zb.RIe,"onTheadOpen"),"TITLE",Object(F.a)(fc,fc.TIe,"onTitleOpen"),"TR",Object(F.a)(Kc,Kc.ugd,"onTrOpen"),"TT",Object(F.a)(Lc,Lc.xgd,"onTtOpen"),"U",Object(F.a)(Gc,Gc.ygd,"onUOpen"),"UL",Object(F.a)(ae,ae.zgd,"onUlOpen"),"VAR",Object(F.a)(we,we.Bgd,"onVarOpen"))}}Object(m.a)(rC,"AHtmlProcessor",null,[]);class sC{constructor(a,b){this.childNodes=a.childNodes;this.mw=b;this.XYd=0;this.MYc=!1}}Object(m.a)(sC,"HtmlProcessorArguments",null,[]);class br extends rC{constructor(a,b=null){super(a,
b);this.TDd=null}get zRj(){null==this.TDd&&(this.TDd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.TDd}process(a,b=null){a&&(this.Mc.reset(),this.$bh(new sC(a,new Zt),b))}$bh(a,b){a.childNodes.length&&(a=new Xh.a(b,Object(F.a)(this,this.NJk,"processChild"),a),a.Pl("HTML Processing Operation"),b||(a.Oi=!0),a.run())}NJk(a,b){const c=b.childNodes[b.XYd];if(3===c.nodeType)return this.Mc.ied(),this.Mc.U0(c.nodeValue,new nz(c,b.mw.n0f())),
br.SOb(b);if(1!==c.nodeType)return br.SOb(b);if(!b.MYc){const l=ha.a.OB(c.tagName);if(!br.vxj(c))if(this.Nlf[l])this.npk();else{br.Rjk(c);this.Mc.ied();var f=c.id;const x=c.tagName,H=b.mw.n0f(),U=c.getAttribute?c.getAttribute("class"):null;f=new $t(f,x,U?U:"",c.attributes?c.attributes.length:0);f.isValid&&H.add(f);if(this.Tqf[l])return this.upk(c,l,H),br.SOb(b);f=!1;switch(this.dpk(c,l,H)){case 1:f=!0;break;case 3:return br.SOb(b)}switch(this.Mc.Wae(c)){case 1:f=!0}b.MYc=f;this.$bh(new sC(c,H),a);
if(!a.Oi)return!0}}if(b.MYc){if(this.zRj&&!this.Lxc[ha.a.OB(c.tagName)])return br.SOb(b);this.Mc.onClose()}return br.SOb(b)}static Rjk(a){3!==a.nodeType&&V.a.Qv(a,"alreadyPasted",!0)}static vxj(a){return 3!==a.nodeType&&V.a.Be(a,"alreadyPasted")}static SOb(a){a.XYd++;a.MYc=!1;return a.XYd<a.childNodes.length}}Object(m.a)(br,"HtmlProcessor",rC,[]);var Xr=d(938);class hI{constructor(a,b=null,c=null,f=null){this.fe=a;this.yS=b||Mm.a.w2f(B.a.G6a,"");this.uq=c;this.Oqa=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):
!1}get Nb(){return this.yS}get Pn(){return this.uq}Ff(a){return a?a+1:1}reset(){this.fe.reset()}ied(){this.fe.ied()}Wae(a){if(a&&this.Pn&&(a.getAttribute&&(a.getAttribute(Xr.a.hMf)&&(this.Pn.H4d=!0),a.getAttribute(Xr.a.iMf)&&(this.Pn.I4d=!0),a.getAttribute(Xr.a.mMf)&&(this.Pn.J4d=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Xr.a.s9f)&&(this.Pn.K4d=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Xr.a.m7g)&&(this.Pn.aYf=!0);b.startsWith(Xr.a.Aah)&&(this.Pn.L4d=
!0);b.startsWith(Xr.a.OJh)&&(this.Pn.M4d=!0);if(b.startsWith(B.a.QZb)&&b.length===B.a.QZb.length+1){const c=parseInt(ha.a.substring(b,b.length-1,b.length));isNaN(c)||(this.Pn.$0b=c)}if(b===Xr.a.b_g||b===Xr.a.c_g)this.Pn.J4b=!0}return this.fe.Wae(a)}onClose(){this.fe.onClose()}U0(a,b){this.Pn&&(this.Pn.cYf=!0);this.Nb.d=this.Ff(this.Nb.d);this.Oqa&&this.zxa(b);this.fe.U0(a,b)}bed(a){this.Nb.e=this.Ff(this.Nb.e);this.Oqa&&this.zxa(a);return this.fe.bed(a)}fGe(a){this.Nb.f=this.Ff(this.Nb.f);return this.fe.fGe(a)}gGe(a){this.Nb.g=
this.Ff(this.Nb.g);return this.fe.gGe(a)}iGe(a){this.Nb.h=this.Ff(this.Nb.h);return this.fe.iGe(a)}pGe(a){this.Nb.i=this.Ff(this.Nb.i);return this.fe.pGe(a)}sGe(a){this.Nb.j=this.Ff(this.Nb.j);this.fe.sGe(a)}ged(a){this.Nb.k=this.Ff(this.Nb.k);return this.fe.ged(a)}tGe(a){this.Nb.l=this.Ff(this.Nb.l);this.fe.tGe(a)}uGe(a){this.Nb.m=this.Ff(this.Nb.m);this.fe.uGe(a)}vGe(a){this.Nb.n=this.Ff(this.Nb.n);return this.fe.vGe(a)}ned(a){this.Nb.o=this.Ff(this.Nb.o);return this.fe.ned(a)}oed(a){this.Nb.p=
this.Ff(this.Nb.p);return this.fe.oed(a)}HGe(a){this.Nb.q=this.Ff(this.Nb.q);return this.fe.HGe(a)}ped(a){this.Nb.r=this.Ff(this.Nb.r);this.fe.ped(a)}MGe(a){this.Nb.s=this.Ff(this.Nb.s);return this.fe.MGe(a)}qed(a){this.Nb.t=this.Ff(this.Nb.t);return this.fe.qed(a)}ted(a){this.Nb.u=this.Ff(this.Nb.u);return this.fe.ted(a)}wed(a){this.Nb.v=this.Ff(this.Nb.v);return this.fe.wed(a)}yed(a){this.Nb.w=this.Ff(this.Nb.w);return this.fe.yed(a)}YGe(a){this.Nb.x=this.Ff(this.Nb.x);this.fe.YGe(a)}ZGe(a){this.Nb.y=
this.Ff(this.Nb.y);return this.fe.ZGe(a)}Bed(a){this.Nb.z=this.Ff(this.Nb.z);return this.fe.Bed(a)}Ced(a){this.Nb.ba=this.Ff(this.Nb.ba);return this.fe.Ced(a)}Eed(a){this.Nb.bb=this.Ff(this.Nb.bb);return this.fe.Eed(a)}Fed(a){this.Nb.bc=this.Ff(this.Nb.bc);return this.fe.Fed(a)}Hed(a){this.Nb.bd=this.Ff(this.Nb.bd);return this.fe.Hed(a)}Ied(a){this.Nb.be=this.Ff(this.Nb.be);return this.fe.Ied(a)}Jed(a){this.Nb.bf=this.Ff(this.Nb.bf);return this.fe.Jed(a)}Med(a){this.Nb.bg=this.Ff(this.Nb.bg);return this.fe.Med(a)}vHe(a){this.Nb.bh=
this.Ff(this.Nb.bh);return this.fe.vHe(a)}Ued(a){this.Nb.bi=this.Ff(this.Nb.bi);return this.fe.Ued(a)}BHe(a){this.Nb.bj=this.Ff(this.Nb.bj);return this.fe.BHe(a)}CHe(a){this.Nb.bk=this.Ff(this.Nb.bk);this.fe.CHe(a)}DHe(a){this.Nb.bl=this.Ff(this.Nb.bl);return this.fe.DHe(a)}Zed(a){this.Nb.bm=this.Ff(this.Nb.bm);return this.fe.Zed(a)}$ed(a){this.Nb.bm=this.Ff(this.Nb.bm);return this.fe.$ed(a)}afd(a){this.Nb.bm=this.Ff(this.Nb.bm);return this.fe.afd(a)}bfd(a){this.Nb.bm=this.Ff(this.Nb.bm);return this.fe.bfd(a)}cfd(a){this.Nb.bm=
this.Ff(this.Nb.bm);return this.fe.cfd(a)}dfd(a){this.Nb.bm=this.Ff(this.Nb.bm);return this.fe.dfd(a)}HHe(a){this.Nb.bn=this.Ff(this.Nb.bn);return this.fe.HHe(a)}efd(a){this.Nb.bo=this.Ff(this.Nb.bo);this.fe.efd(a)}JHe(a){this.Nb.bp=this.Ff(this.Nb.bp);return this.fe.JHe(a)}ffd(a){this.Nb.bq=this.Ff(this.Nb.bq);return this.fe.ffd(a)}LHe(a){this.Nb.br=this.Ff(this.Nb.br);return this.fe.LHe(a)}gfd(a){this.Pn&&(this.Pn.$Xf=!0);this.Oqa&&this.zxa(a);this.Nb.bs=this.Ff(this.Nb.bs);this.fe.gfd(a)}NHe(a){this.Nb.bt=
this.Ff(this.Nb.bt);this.fe.NHe(a)}hfd(a){this.Nb.bu=this.Ff(this.Nb.bu);return this.fe.hfd(a)}UHe(a){this.Nb.bv=this.Ff(this.Nb.bv);return this.fe.UHe(a)}ifd(a){this.Nb.bw=this.Ff(this.Nb.bw);return this.fe.ifd(a)}kfd(a){this.Nb.bx=this.Ff(this.Nb.bx);return this.fe.kfd(a)}mfd(a){this.Nb.by=this.Ff(this.Nb.by);return this.fe.mfd(a)}nfd(a){this.Pn&&(this.Pn.J4b=!0);this.Nb.bz=this.Ff(this.Nb.bz);this.Oqa&&this.zxa(a);return this.fe.nfd(a)}YHe(a){this.Nb.ca=this.Ff(this.Nb.ca);this.fe.YHe(a)}ZHe(a){this.Nb.cb=
this.Ff(this.Nb.cb);return this.fe.ZHe(a)}rfd(a){this.Pn&&(this.Pn.ZXf=!0);this.Nb.cc=this.Ff(this.Nb.cc);return this.fe.rfd(a)}fHb(a){this.Nb.cd=this.Ff(this.Nb.cd);return this.fe.fHb(a)}bIe(a){this.Nb.ce=this.Ff(this.Nb.ce);this.fe.bIe(a)}eIe(a){this.Nb.cf=this.Ff(this.Nb.cf);return this.fe.eIe(a)}fIe(a){this.Nb.cg=this.Ff(this.Nb.cg);return this.fe.fIe(a)}gIe(a){this.Nb.ch=this.Ff(this.Nb.ch);return this.fe.gIe(a)}yfd(a){this.Pn&&(this.Pn.J4b=!0);this.Nb.ci=this.Ff(this.Nb.ci);this.Oqa&&this.zxa(a);
return this.fe.yfd(a)}hIe(a){this.Nb.cj=this.Ff(this.Nb.cj);return this.fe.hIe(a)}Cfd(a){this.Nb.ck=this.Ff(this.Nb.ck);return this.fe.Cfd(a)}Ffd(a){this.Nb.cl=this.Ff(this.Nb.cl);this.Oqa&&this.zxa(a);return this.fe.Ffd(a)}iIe(a){this.Nb.cm=this.Ff(this.Nb.cm);this.fe.iIe(a)}Rfd(a){this.Nb.cn=this.Ff(this.Nb.cn);return this.fe.Rfd(a)}sIe(a){this.Nb.co=this.Ff(this.Nb.co);return this.fe.sIe(a)}Zfd(a){this.Nb.cp=this.Ff(this.Nb.cp);return this.fe.Zfd(a)}$fd(a){this.Nb.cq=this.Ff(this.Nb.cq);return this.fe.$fd(a)}DIe(a){this.Nb.cr=
this.Ff(this.Nb.cr);return this.fe.DIe(a)}EIe(a){this.Nb.cs=this.Ff(this.Nb.cs);return this.fe.EIe(a)}igd(a){this.Nb.ct=this.Ff(this.Nb.ct);return this.fe.igd(a)}jgd(a){this.Nb.cu=this.Ff(this.Nb.cu);this.Oqa&&this.zxa(a);return this.fe.jgd(a)}kgd(a){this.Nb.cv=this.Ff(this.Nb.cv);return this.fe.kgd(a)}lgd(a){this.Nb.cw=this.Ff(this.Nb.cw);return this.fe.lgd(a)}KIe(a){this.Nb.cx=this.Ff(this.Nb.cx);return this.fe.KIe(a)}mgd(a){this.Nb.cy=this.Ff(this.Nb.cy);return this.fe.mgd(a)}ogd(a){this.Nb.cz=
this.Ff(this.Nb.cz);return this.fe.ogd(a)}sgd(a){this.Pn&&(this.Pn.d9a=!0);this.Nb.da=this.Ff(this.Nb.da);this.Oqa&&this.zxa(a);return this.fe.sgd(a)}NIe(a){this.Pn&&(this.Pn.d9a=!0);this.Nb.db=this.Ff(this.Nb.db);this.Oqa&&this.zxa(a);return this.fe.NIe(a)}Ekc(a){this.Pn&&(this.Pn.d9a=!0);this.Nb.dc=this.Ff(this.Nb.dc);this.Oqa&&this.zxa(a);return this.fe.Ekc(a)}PIe(a){this.Nb.dd=this.Ff(this.Nb.dd);return this.fe.PIe(a)}QIe(a){this.Nb.de=this.Ff(this.Nb.de);return this.fe.QIe(a)}tgd(a){this.Pn&&
(this.Pn.d9a=!0);this.Nb.df=this.Ff(this.Nb.df);return this.fe.tgd(a)}RIe(a){this.Pn&&(this.Pn.d9a=!0);this.Nb.dg=this.Ff(this.Nb.dg);return this.fe.RIe(a)}TIe(a){this.Nb.dh=this.Ff(this.Nb.dh);return this.fe.TIe(a)}ugd(a){this.Pn&&(this.Pn.d9a=!0);this.Nb.di=this.Ff(this.Nb.di);return this.fe.ugd(a)}xgd(a){this.Nb.dj=this.Ff(this.Nb.dj);return this.fe.xgd(a)}ygd(a){this.Nb.dk=this.Ff(this.Nb.dk);return this.fe.ygd(a)}zgd(a){this.Pn&&(this.Pn.J4b=!0);this.Nb.dl=this.Ff(this.Nb.dl);return this.fe.zgd(a)}Bgd(a){this.Nb.dm=
this.Ff(this.Nb.dm);return this.fe.Bgd(a)}zxa(a){if((a=a.Vf)&&a.style&&this.Pn){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.Pn.lCj(a.tagName,c)}}}Object(m.a)(hI,"HtmlEventUsageCollector",null,[548]);class iI{constructor(a,b=null,c=null){this.fe=a;this.yS=b||Mm.a.k6f("");this.q1h=c||Mm.a.l6f("")}get Nb(){return this.yS}get M0e(){return this.q1h}pY(a){this.M0e.b++;this.fe.pY(a)}mY(){this.fe.mY()}oY(a){this.M0e.c++;this.fe.oY(a)}nY(){this.fe.nY()}lY(a){this.M0e.d++;this.fe.lY(a)}kY(){this.fe.kY()}reset(){this.fe.reset()}get d2b(){return this.fe.d2b}U0(a,
b){this.Nb.b++;this.fe.U0(a,b)}Bna(a){this.Nb.c++;this.fe.Bna(a)}jZa(a){this.Nb.b++;this.fe.jZa(a)}Ana(a){this.Nb.d++;this.fe.Ana(a)}zna(a){this.Nb.f++;this.fe.zna(a)}cxa(a,b){this.Nb.g++;this.fe.cxa(a,b)}bxa(){this.fe.bxa()}uA(a){this.Nb.h++;this.fe.uA(a)}tA(){this.fe.tA()}dZa(){this.fe.dZa()}cZa(){this.fe.cZa()}hxa(a,b){this.Nb.i++;this.fe.hxa(a,b)}lJa(){this.fe.lJa()}Ena(a){this.Nb.j++;this.fe.Ena(a)}Cna(){this.fe.Cna()}gxa(a){this.Nb.k++;this.fe.gxa(a)}Dna(){this.fe.Dna()}eZa(a){this.Nb.l++;this.fe.eZa(a)}}
Object(m.a)(iI,"SemanticEventUsageCollector",null,[536,507]);class tC{constructor(a){this.wh=a}reset(){this.wh.reset()}get d2b(){return this.wh.d2b}U0(a,b){this.wh.U0(a,b)}Bna(a){this.wh.Bna(a)}jZa(a){this.wh.jZa(a)}Ana(a){this.wh.Ana(a)}zna(a){this.wh.zna(a)}cxa(a,b){this.wh.cxa(a,b)}bxa(){this.wh.bxa()}uA(a){this.wh.uA(a)}tA(){this.wh.tA()}dZa(){this.wh.dZa()}cZa(){this.wh.cZa()}Ena(a){this.wh.Ena(a)}Cna(){this.wh.Cna()}gxa(a){this.wh.gxa(a)}Dna(){this.wh.Dna()}eZa(a){this.wh.eZa(a)}pY(a){this.wh.pY(a)}mY(){this.wh.mY()}oY(a){this.wh.oY(a)}nY(){this.wh.nY()}lY(a){this.wh.lY(a)}kY(){this.wh.kY()}hxa(a,
b){this.wh.hxa(a,b)}lJa(){this.wh.lJa()}}Object(m.a)(tC,"AHtmlNormalizer",null,[536,507]);class uC extends tC{constructor(a){super(a);this.gD=!1}U0(a,b){this.gD?this.jG.zF(()=>{this.XMe(a,b)}):this.XMe(a,b)}XMe(a,b){this.wh.U0(a,b)}Bna(a){this.gD?this.jG.zF(()=>{this.xMe(a)}):this.xMe(a)}xMe(a){this.wh.Bna(a)}Ana(a){this.gD?this.jG.zF(()=>{this.Emc(a)}):this.Emc(a)}Emc(a){this.wh.Ana(a)}zna(a){this.gD?this.jG.zF(()=>{this.wMe(a)}):this.wMe(a)}wMe(a){this.wh.zna(a)}cxa(a,b){this.gD?this.jG.zF(()=>
{this.rMe(a,b)}):this.rMe(a,b)}rMe(a,b){this.wh.cxa(a,b)}bxa(){this.gD?this.jG.zF(Object(F.a)(this,this.qMe,"processAnchorEnd")):this.qMe()}qMe(){this.wh.bxa()}uA(a){this.gD?this.jG.zF(()=>{this.HMe(a)}):this.HMe(a)}HMe(a){this.wh.uA(a)}tA(){this.gD?this.jG.zF(Object(F.a)(this,this.GMe,"processParagraphEnd")):this.GMe()}GMe(){this.wh.tA()}dZa(){this.gD?this.jG.zF(Object(F.a)(this,this.JMe,"processPreFormattedTextStart")):this.JMe()}JMe(){this.wh.dZa()}cZa(){this.gD?this.jG.zF(Object(F.a)(this,this.IMe,
"processPreFormattedTextEnd")):this.IMe()}IMe(){this.wh.cZa()}Ena(a){this.gD?this.jG.zF(()=>{this.BMe(a)}):this.BMe(a)}BMe(a){this.wh.Ena(a)}Cna(){this.gD?this.jG.zF(Object(F.a)(this,this.yMe,"processListEnd")):this.yMe()}yMe(){this.wh.Cna()}gxa(a){this.gD?this.jG.zF(()=>{this.AMe(a)}):this.AMe(a)}AMe(a){this.wh.gxa(a)}Dna(){this.gD?this.jG.zF(Object(F.a)(this,this.zMe,"processListItemEnd")):this.zMe()}zMe(){this.wh.Dna()}pY(a){this.gD?this.jG.zF(()=>{this.WMe(a)}):this.WMe(a)}WMe(a){this.wh.pY(a)}mY(){this.gD?
this.jG.zF(Object(F.a)(this,this.TMe,"processTableEnd")):this.TMe()}TMe(){this.wh.mY()}oY(a){this.gD?this.jG.zF(()=>{this.VMe(a)}):this.VMe(a)}VMe(a){this.wh.oY(a)}nY(){this.gD?this.jG.zF(Object(F.a)(this,this.UMe,"processTableRowEnd")):this.UMe()}UMe(){this.wh.nY()}lY(a){this.gD?this.jG.zF(()=>{this.SMe(a)}):this.SMe(a)}SMe(a){this.wh.lY(a)}kY(){this.gD?this.jG.zF(Object(F.a)(this,this.RMe,"processTableCellEnd")):this.RMe()}RMe(){this.wh.kY()}hxa(a,b){this.gD?this.jG.zF(()=>{this.CMe(a,b)}):this.CMe(a,
b)}CMe(a,b){this.wh.hxa(a,b)}lJa(){this.gD?this.jG.zF(Object(F.a)(this,this.mch,"processMathEnd")):this.mch()}mch(){this.wh.lJa()}}Object(m.a)(uC,"AQueuingHtmlNormalizer",tC,[]);class jI{constructor(a){this.next=null;this.data=a}}Object(m.a)(jI,"QueueNode",null,[]);class vC{constructor(){this.d3a=this.k2a=null;this.Xk=0}get count(){return this.Xk}get isEmpty(){return!this.Xk||!this.k2a||!this.d3a}enqueue(a){a=new jI(a);this.isEmpty?this.d3a=this.k2a=a:this.k2a=this.k2a.next=a;this.Xk++}back(){return this.isEmpty?
null:this.k2a.data}dequeue(){if(this.isEmpty)return null;const a=this.d3a;this.d3a=a.next;this.Xk--;this.d3a||(this.k2a=null);return a.data}clear(){this.d3a=this.k2a=null;this.Xk=0}toArray(){const a=Array(this.count);let b=this.d3a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(m.a)(vC,"Queue",null,[]);class tx{constructor(){this.MId=new vC}zF(a){this.MId.enqueue(a)}flush(a=!1){for(a&&this.vod();!this.MId.isEmpty;)this.MId.dequeue()();a&&this.Uld()}vod(){}Uld(){}}Object(m.a)(tx,
"QueuedEventManager",null,[]);class oz extends tx{constructor(a){super();this.id=void 0;this.bZd=null;this.KZc=!1;this.klc="";this.JZc=this.B_c=!1;this.$Yd=this.kub=null;this.pjc=0;this.Z9b=this.nac=this.ume=!1;this.table=null;this.hFe=0;this.HP=a}get XYb(){return!!this.table}vod(){this.HP.DHb.push(this.HP.currentState);this.HP.currentState=this}Uld(){this.HP.currentState=this.HP.DHb.pop()}}oz.nextId=void 0;Object(m.a)(oz,"ContentState",tx,[]);class kI{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.FFa=a.FFa;this.Aqc=a.Aqc;this.verticalAlignment=a.verticalAlignment;this.s6=a.s6;this.$rd=a.$rd;this.jAb=a.jAb;this.iJc=a.iJc;this.contents=c;this.jpj=b}}Object(m.a)(kI,"TableCell",null,[]);class lI extends tx{constructor(a,b){super();this.HP=a;this.vpf=new Zt;this.xG=new Zt;this.$Fd=[];this.lDc=[];this.Spa=-1;this.fAa=0;this.DTh=b.Kgg;this.CTh=b.OJj;this.i1h=b.C0e;this.O5a=b.width;this.Iff=b.FFa;this.kSh=new an(new $t(b.BU.Fcg,b.BU.i8b),b.mw,
b.I5,b.cultureName,b.nia);this.aTh=b.Mde;this.rEc=b.Zyh;this.o1h=b.tableLook}get wh(){return this.HP.wh}PIk(a){this.Spa++;this.vpf.add(a);this.lDc[this.Spa]=a.height;this.fAa=0}get FIi(){for(;this.fAa>=this.xG.count;)this.xG.add(Array(this.Spa+1));return this.xG.ga(this.fAa)}fOd(a,b,c,f,l,x,H){if(0>this.Spa)return!1;for(;this.$Fd[this.fAa]>=this.Spa;)this.fAa++;a=new kI(a,new an(b,c,f,l,x),H);this.FIi[this.Spa]=a;if(1<a.rowSpan)for(b=this.Spa+a.rowSpan-1,f=this.fAa,c=this.fAa+a.colSpan-1;f<=c;f++)this.$Fd[f]>=
b||(this.$Fd[f]=b);this.fAa+=a.colSpan;this.lDc[this.Spa]<a.height&&(this.lDc[this.Spa]=a.height);return!0}vod(){this.HP.currentState.table=this}Uld(){this.HP.currentState.table=null}fXf(){this.flush(!0);const a=this.Spa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.xG.count);c=!0;var f=0;for(var l=0;l<this.xG.count;l++){var x=this.xG.ga(l),H=!0;for(var U=0;U<a;U++){var ja=x[U];ja&&(H=!1,b[U][l+f]=new jz(ja.colSpan,ja.rowSpan,ja.width,ja.height,void 0,void 0,void 0,void 0,ja.FFa,ja.jAb))}H?
(this.xG.removeAt(l),l--,++f):c=!1}if(!c){(b=this.Iff?this.HP.zCf(b,this.O5a/100):this.HP.zCf(b))&&b.length!==this.xG.count&&(b=null);this.HP.vDa(!0);this.HP.WJc();this.wh.pY(new mC(a,this.xG.count,this.O5a,this.Iff,b,this.DTh,this.CTh,this.i1h,this.aTh,this.rEc,this.o1h,this.kSh));for(b=0;b<a;b++){c=this.vpf.ga(b);this.wh.oY(new lC(this.lDc[b],new an(c.BU,c.mw,c.I5,c.cultureName,c.nia)));for(c=0;c<this.xG.count;c++){f=this.xG.ga(c)[b];var ya=!!this.rEc&&""!==this.rEc&&"Custom"!==this.rEc;l=f?f.colSpan:
0;x=f?f.rowSpan:0;H=f?f.width:0;U=f?f.height:0;ja=f?f.iJc:0;const Va=f?f.FFa:!1,hb=f&&(65536&ja||!ya)?f.Aqc:"",yb=f?f.verticalAlignment:0,Zb=f?f.jAb:!1;ya=f?this.HP.Wdj(f.s6,c,b,this.xG,ya,f.iJc):new hC;const fc=f?f.$rd:new iC,Kc=f?f.jpj:null;this.wh.lY(new jz(l,x,H,U,hb,yb,ya,fc,Va,Zb,ja,new an(Kc?Kc.BU:null,Kc?Kc.mw:null,Kc?Kc.I5:null,Kc?Kc.cultureName:null,Kc?Kc.nia:null)));f&&!f.jAb&&(f.contents.vod(),f.contents.flush(),this.HP.vDa(!1),this.HP.WJc(),f.contents.Uld());this.wh.kY()}this.wh.nY()}this.wh.mY();
this.HP.currentState.Z9b=!1;this.HP.tSf(!1)}}}Object(m.a)(lI,"NormalizedTable",tx,[]);class wC{constructor(a=!1,b=!1){this.aUh=a;this.nI=b}get GOj(){return this.aUh}get YU(){return this.nI}}Object(m.a)(wC,"HtmlNormalizerSettings",null,[595]);class Yr extends uC{constructor(a,b=null){super(a);this.currentState=null;this.DHb=new px;this.lob=b||new wC}reset(){super.reset();this.currentState=new oz(this);this.DHb.clear();this.gD=!1}get jG(){return this.currentState&&this.currentState.XYb?this.currentState.table:
this.currentState}KOc(a=!1){this.currentState.KZc||(this.WJc(),this.wh.uA(this.currentState.bZd),this.currentState.KZc=!0,this.currentState.Z9b=!1);a||!this.currentState.kub||this.currentState.JZc||(this.wh.cxa(this.currentState.kub,this.currentState.$Yd),this.currentState.JZc=!0)}y3b(){this.currentState.JZc&&(this.wh.bxa(),this.currentState.JZc=!1)}tSi(){this.currentState.KZc&&(this.wh.tA(),this.currentState.KZc=!1,this.currentState.klc="")}tSf(a){this.currentState.nac&&(this.currentState.Z9b?a||
(this.wh.uA(null),this.wh.tA(),this.wh.Dna(),this.currentState.nac=!1):(this.wh.Dna(),this.currentState.nac=!1,this.currentState.Z9b=!0))}vDa(a){this.y3b();this.tSi();this.tSf(a)}Xzk(a){this.wh.Ena(new qx(2,1,a));this.currentState.pjc++;this.currentState.ume=!0}WJc(){!this.currentState.nac&&this.currentState.ume&&(this.wh.Cna(),this.currentState.pjc--,this.currentState.ume=!1)}XMe(a,b){a=this.xok(a);if(""!==a)if(this.KOc(),this.currentState.B_c)this.YMe(a,b);else{a=a.split(Yr.uni);for(let c=0;c<a.length-
1;c++)this.YMe(a[c],b),this.wh.jZa(b);this.YMe(a[a.length-1],b)}}CMe(a,b){""!==a&&(this.KOc(),this.wh.hxa(a,b))}xMe(a){this.lob.YU||this.y3b();this.KOc(!0);this.wh.Bna(a)}wMe(a){this.currentState.XYb||this.wh.zna(a)}Emc(a){this.currentState.kub&&(a.href=this.currentState.kub);super.Emc(a)}rMe(a,b){this.y3b();this.currentState.kub=a;this.currentState.$Yd=b}qMe(){this.y3b();this.currentState.kub=null;this.currentState.$Yd=null}HMe(a){this.currentState.bZd=a;this.vDa(!0)}GMe(){this.currentState.bZd=
null;this.vDa(!0)}JMe(){this.currentState.B_c=!0}IMe(){this.currentState.B_c=!1}BMe(a){this.vDa(!1);this.WJc();this.wh.Ena(a);this.currentState.pjc++}yMe(){this.vDa(!1);this.wh.Cna();this.currentState.pjc--}AMe(a){this.vDa(!1);this.currentState.pjc||this.Xzk(a);this.wh.gxa(a);this.currentState.nac=!0;this.currentState.Z9b=!0}zMe(){this.vDa(!1)}pY(a){this.currentState.XYb||(this.gD=!0,this.currentState.table=new lI(this,a))}WMe(){}mY(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.DHb.isEmpty?(this.gD=!1,a.fXf()):this.jG.zF(Object(F.a)(a,a.fXf,"flushTable"))}}TMe(){}oY(a){this.currentState.XYb&&this.currentState.table.PIk(a)}VMe(){}nY(){}UMe(){}lY(a){let b=!1;if(this.currentState.XYb){const c=new oz(this);this.currentState.table.fOd(a,new $t(a.BU.Fcg,a.BU.i8b),a.mw,a.I5,a.cultureName,a.nia,c)?(this.DHb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.hFe++}SMe(){}kY(){0<this.currentState.hFe?this.currentState.hFe--:this.currentState=
this.DHb.pop()}RMe(){}zCf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const x=Array(f+1);for(var H=0;H<x.length;H++)x[H]=!1;H=new Ka.a;for(let ja=0;ja<f;ja++){for(var U=0;U<c;U++)if(a[U][ja]&&0<a[U][ja].width){const ya=Math.min(ja+a[U][ja].colSpan,f);l[ya]=l[ja]+a[U][ja].width*(a[U][ja].FFa?b:1);x[ya]=!0}if(x[ja+1]){U=l[ja+1]-l[ja];if(0>=U)return null;H.add(U)}else l[ja+1]=l[ja]}return H.toArray()}okk(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}Wdj(a,b,c,f,l,x){if(!a)return null;l&&(a=this.okk(a,x));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.s6.borderRightStyle&&(a.borderLeftStyle=l.s6.borderRightStyle,a.borderLeftColor=l.s6.borderRightColor,a.borderLeftWidth=l.s6.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.s6.borderBottomStyle&&(a.borderTopStyle=b.s6.borderBottomStyle,a.borderTopColor=b.s6.borderBottomColor,a.borderTopWidth=b.s6.borderBottomWidth);return a}xok(a){this.currentState.B_c||(a=this.lob.GOj?a.replace(Yr.gAj," "):a.replace(Yr.fAj," "));a.startsWith(" ")&&(this.currentState.klc.endsWith(" ")||""===this.currentState.klc)&&(a=ha.a.substring(a,1,a.length));return a}YMe(a,b){""!==a&&(this.wh.U0(a,b),this.currentState.klc+=a)}}Yr.fAj=RegExp("[ \t\f\u200b\r\n]+","g");Yr.gAj=RegExp("[ \f\u200b\r\n]+",
"g");Yr.uni="\t";Object(m.a)(Yr,"DefaultHtmlNormalizer",uC,[]);class mI extends Yr{constructor(a,b,c){super(a,c);this.adf=!1;this.s3a=b}Emc(a){this.s3a.Ghd&&(u.AFrameworkApplication.PQ?this.adf||(a=new jj.StandardDialog,a.xd=0,a.Xe(1,CommonUIStrings.l_DialogClose),a.Gx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.adf=!0):this.s3a.Ykk?this.s3a.mYg=!0:a.src&&""!==a.src?bg.a.sQ(a.src)===bg.a.sQ(window.location.href)?u.AFrameworkApplication.Ta.processAction(D.a.R9g,
2):a.src.startsWith("data:")&&19922944<a.src.length?u.AFrameworkApplication.Ta.processAction(D.a.P9g,2):a.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.Ta.processAction(D.a.O9g,2):(P.a.instance.ga(1)?this.vDa(!1):P.a.instance.ga(11)&&(this.y3b(),this.KOc(!0)),this.wh.Ana(a)):u.AFrameworkApplication.Ta.processAction(D.a.Q9g,2))}}Object(m.a)(mI,"Box4HtmlNormalizer",Yr,[]);class nI{constructor(a,b,c,f,l,x,H,U,ja,ya){this.htmlProcessor=a;this.ode=b;this.NJh=c;this.S_i=f;this.y7k=l;this.z7k=
x;this.uWc=H;this.$zj=U;this.bAj=ja;this.x_j=ya}}Object(m.a)(nI,"ExecutePasteArguments",null,[]);class oI extends Dj{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){super(b,c,f,Va);this.g7=null;this.Xha=a;this.Pxd=l;this.CCd=x;this.OLd=H;this.xNd=U;this.dTb=ja;this.lob=yb;this.$a=ya;this.wdf=Object.assign(new jC,{gzb:2===this.Bg.OQa||3===this.Bg.OQa});this.NAd=hb;this.MWb=ya.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.G_h=ya.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get Qdd(){return!1}get lhg(){return!ha.a.oul(ha.a.zAc,
this.Xha.innerText)}get ZHf(){return this.Xha.innerText}tTf(a){this.g7=new tb.GraphIterator;this.Ghb.restore(this.g7);ia.ULS.shipAssertTag(6305550,307,fe.OutlineElementReader.Yg(this.g7));this.Bg.W0&&this.Bg.W0.tHc("external");var b=this.Bg.ks&8192?1:0,c=this.CCd.value.create(b,this.g7);const f=this.OLd.value.create(b,this.g7),l=Mm.a.vae(u.AFrameworkApplication.userSessionId),x=Mm.a.n7d(B.a.G6a,this.Bg.wVd),H=Mm.a.k6f(u.AFrameworkApplication.userSessionId),U=Mm.a.l6f(u.AFrameworkApplication.userSessionId),
ja=this.MWb?this.FEj():null,ya=Mm.a.w2f(B.a.G6a,this.Bg.wVd),Va=Mm.a.x2f(u.AFrameworkApplication.userSessionId),hb=this.dTb.Jth?Mm.a.Zbj(u.AFrameworkApplication.userSessionId):null;b=this.Pxd.value.create(b,this.g7,c,f,null,x);b=new iI(b,H,U);b=new mI(b,c,this.lob);b=new wl(b,this.dTb,this.wdf,hb);b=new hI(b,ya,ja,this.$a);b=new br(b,Va);c=new nI(b,c,l,x,H,U,ja,ya,Va,hb);c=new Xh.a(a,Object(F.a)(this,this.RIk,"preprocessStyle"),c);c.Pl("paste and request pictures");c.Oi=!a||a.Oi;c.run()}RIk(a){if(this.G_h){const b=
this.Xha.getElementsByTagName("style");if(b&&0<b.length){ia.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.NAd.AAi(this.Xha,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.Wg(Object(F.a)(this,this.SAi,"convertWordListHtml"));return!0}SAi(a,b){this.xNd.value.create(b.NJh).process(this.Xha,a);a.Wg(Object(F.a)(this,this.bKk,"processHtml"));return!0}bKk(a,b){b.htmlProcessor.process(this.Xha,a);b=b.ode&&
b.ode.Ghd?Object(F.a)(this,this.Sld,"requestImages"):Object(F.a)(this,this.JRf,"endPasteOperation");a.Wg(b);return!0}Sld(a,b){if(b=b.ode){let c=!1,f=!1,l=!1,x=!1,H=-1;const U=new J.DictionaryPropertySet,ja=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Xa.a)(10,this.Bg.rd)){c=this.Bg.rd.sa(ab.a.Zje,!1);const ya=this.Bg.rd.sa(Mc.a.FU,"");l=this.Bg.rd.sa(Mc.a.EZc,!1);x=this.Bg.rd.sa($a.a.YN,!1);ja.test(ya)&&(f=!0);this.Lth&&(H=this.Bg.rd.sa(Ms.a.Y2b,-1))}else this.Bg.ks&256&&this.Xha&&
(c=!0,ja.test(this.Xha.innerHTML)&&(f=!0));U.setValue(ab.a.Zje,c);U.setValue(Mc.a.CWj,f);U.setValue(Mc.a.EZc,l);U.setValue(Ms.a.Y2b,H);U.setValue($a.a.YN,x);b.w0g&&(this.Bg.W9b=!0,this.Bg.Ede=b.XMc,this.Bg.VFe=b.w0g,u.AFrameworkApplication.Ta.processAction(D.a.Sld,2))}a.Wg(Object(F.a)(this,this.JRf,"endPasteOperation"));return!0}JRf(a,b){Mm.a.G4j(b.NJh);Mm.a.H2j(b.bAj);Mm.a.U3j(b.y7k);Mm.a.V3j(b.z7k);Mm.a.$2j(b.x_j);a="Others";b.uWc&&(b.uWc.E2j(),b.uWc.F2j(),a=b.uWc.MZe);Mm.a.G2j(b.$zj,a);Mm.a.v2j(b.S_i,
a);return!1}FEj(){const a=new gI;a.UHb=B.a.G6a;this.Bg&&(a.ks=this.Bg.ks,a.nJe=this.Bg.wVd,this.Bg.rd&&(a.aNe=this.Bg.rd.sa(Mc.a.N9g,"")));this.Xha&&this.Xha.innerHTML&&(a.M9g=this.Xha.innerHTML.length);u.AFrameworkApplication.gd&&(a.platform=u.AFrameworkApplication.gd.Platform);return a}get Yth(){return!0}get Xth(){ia.ULS.shipAssertTag(6305551,307,!!this.g7);if(this.dTb.Kth(this.wdf)){let a=!1;fe.OutlineElementReader.Yg(this.g7)&&(this.g7.a7b(),a=!0);const b=Sb.ParagraphReader.el(this.g7)&&!this.g7.currentNode.sa(Mc.a.cig,
!1);a&&this.g7.zc();return b}return Sb.ParagraphReader.el(this.g7)}}Object(m.a)(oI,"ExternalPasteExecutionManager",Dj,[]);class pI{constructor(a,b,c,f,l,x,H,U){this.Pxd=a;this.CCd=b;this.OLd=c;this.xNd=f;this.dTb=l;this.$a=x;this.NAd=H;this.lob=U}create(a,b,c,f){return new oI(a,b,c,f,this.Pxd,this.CCd,this.OLd,this.xNd,this.dTb,this.$a,Oc.App.Kb.Kd,this.NAd,this.lob)}}Object(m.a)(pI,"Factory",null,[384]);class pz{constructor(a){this.Ika=a.Laj();this.v$a=a.KSc("intCopy");this.Xgd=a.Y8d("intCopy");
this.$6a=a.FRc("intCopy");this.fQa=a.sRc("intCopy")}static GW(){return pz.xr()}static xr(){return new pz(me.a.instance)}}Object(m.a)(pz,"InternalCopyUsageHelper",null,[]);class ux{constructor(a,b,c){this.lN=pz.GW();this.yJc=null;this.Wpd=this.bvd=!1;this.vbf=null;this.source=a;this.target=b;this.LJe=c}get J6(){return this.lN}get fL(){return this.vbf}set fL(a){this.vbf=a}}Object(m.a)(ux,"InternalCopyArguments",null,[]);class qI extends ux{constructor(a,b,c,f){super(a,b,{});this.iLb=[];for(a=0;a<c.length;a++)Array.addRange(this.iLb,
c.ga(a).toArray());this.bsa=0;this.Jpj=f}}Object(m.a)(qI,"BasicInternalCopyArguments",ux,[]);class rI extends Sys.EventArgs{constructor(a){super();this.fL=a}}Object(m.a)(rI,"BeforePasteArguments",Sys.EventArgs,[]);class qz extends ux{constructor(a,b){super(a.source,a.target,a.LJe);this.Bg=a;this.insertAfter=b}get J6(){return this.Bg.J6}get fL(){return this.Bg.fL}set fL(a){this.Bg.fL=a}}Object(m.a)(qz,"CoreInternalCopyArguments",ux,[]);class rz{constructor(a,b,c,f,l=null){this.source=a;this.target=
b;this.insertAfter=c;this.Jgd=f;this.fL=l||{}}}Object(m.a)(rz,"CoreInternalPasteArguments",null,[]);class sI{constructor(a,b,c,f,l,x,H,U,ja){this.QNb=a;this.source=b;this.target=c;this.Jgd=f;this.rowIndex=l;this.dja=x;this.z9g=U;this.If=ja}}Object(m.a)(sI,"CoreInternalTablePasteArguments",null,[]);class sz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.fL=l}}Object(m.a)(sz,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var cr=d(205);class ri{static qr(){ri.PKb=
new Kb.a;ri.PKb.$(88,!0);ri.PKb.$(4,!0)}static dta(a,b,c){const f=[];if(P.a.instance.ga(104)&&a.Hl&&Qd.SelectionFactory.AVj(a))a=tb.GraphIterator.nb(a.mb.jg.Ua.node),a.rc(14),c=Wd.a.create(a.origin),c=ri.JHc(c,!0,!0,null),a.set(c),nb.SelectionEditor.Bt(a),ri.vSa(a,f);else for(let ya=0;ya<a.length&&!(c&&0<f.length);++ya){var l=a.ga(ya),x=ri.DSc(l,!0),H=ri.DSc(l,!1);if(!x||!H)continue;if(x===H&&x.contextId===Cb.a.Pf){l=tb.GraphIterator.nb(x.node);l.rc(11)&&ri.vSa(l,f);continue}var U=void 0;U=l=null;
var ja=-1;let Va;if(x.node===H.node)Va=x.node,H=H.node;else{U=ri.mZf(x.node);l=ri.mZf(H.node);for(ja=0;ja<U.length&&ja<l.length&&U[ja]===l[ja];++ja);U=U[ja-1];--ja;Va=ri.JHc(x,!0,!1,U);H=ri.JHc(H,!1,!0,U)}if(Va===H)l=Va===x.node?x:Wd.a.create(Va),l=ri.JHc(l,!0,!0,null),x=new tn.a,x.set(l),nb.SelectionEditor.Bt(x),ri.vSa(x,f);else{x=new tn.a;x.set(Va);nb.SelectionEditor.Bt(x);Va===U&&x.Gi();for(ri.vSa(x,f);x.parentNode!==U;){for(;x.jp();)ri.vSa(x,f);x.zc()}if(H===U)for(;x.jp();)ri.vSa(x,f);else{x.jp();
for(U=ja+1;U<l.length;++U){for(;x.currentNode!==l[U];)ri.vSa(x,f),x.jp();if(H===l[U])break;x.Gi()}ri.vSa(x,f)}}}if(0>=f.length)return null;if(b)for(b=new tb.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),Ta.OutlineElementNavigator.wi(b),f[a]=Wd.a.create(b.currentNode);return Wa.a.XQa(f)}static DSc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).al)return a.ga(b);if(a.ga(b).hx){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).al)return c.getContext(f)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).al)return a.ga(b);
if(a.ga(b).hx)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).al)return c.getContext(f)}return null}static vSa(a,b){ri.Qkg(a)?ri.rXi(a,b):ri.PKb.Hb(a.role)||(a=a.Pw(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,Wd.a.create(a)))}static mZf(a){const b=[],c=new tb.GraphIterator;c.set(a);nb.SelectionEditor.Bt(c);for(Array.add(b,a);c.zc();)Array.add(b,c.currentNode);b.reverse();return b}static JHc(a,b,c,f){let l=a.node;if(nb.SelectionEditor.gk(a)&&(b&&0<a.Qa||c&&a.Mb<Sb.ParagraphReader.textLength(l))||
nb.SelectionEditor.Xl(a)&&b&&0<Sb.ParagraphReader.textLength(l))return l;a=new tn.a;a.set(l);for(nb.SelectionEditor.Bt(a);!a.fr;){l=a.currentNode;if(f===l||b&&!ri.aNj(a)||c&&!ri.jPj(a))return l;a.zc()}return a.currentNode}static jPj(a){let b=!0;if(a.jp())for(b=!1;ri.PKb.Hb(a.role)||P.a.instance.ga(77)&&16===a.ri&&Le.isGhostCell(a);)if(!a.jp()){b=!0;break}return b}static aNj(a){const b=a.currentNode;let c=!0;if(a.Jta())for(c=!1;ri.PKb.Hb(a.role);)if(!a.Jta()){c=!0;break}a.zc();a.Pk(b);return c}static rXi(a,
b){a=Vl.a.qv(a);for(a.em(ri.gXi,null);a.moveNext();)fe.OutlineElementReader.n9(a.currentNode)&&Array.add(b,Wd.a.create(a.currentNode))}static gXi(a){return ri.Qkg(a)}static Qkg(a){return a.fr||1===a.role||27===a.role}}ri.PKb=null;Object(m.a)(ri,"OutlineElementGeneralizer",null,[]);ri.qr();class tI{constructor(){this.controlCell=this.gp=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(m.a)(tI,"ComplexCellData",null,[]);var vx=d(178);class xC{constructor(a){this.Tm=a;a.b1j()}dispose(){this.Tm.kBl()}static nb(a){return new xC(a.Sj)}}
Object(m.a)(xC,"TempGraphAlgorithmLock",null,[106]);class Ph{constructor(a,b,c){this.kaf=this.kI=null;this.YBc=[];this.Axc=[];this.lEc=[];this.$Qb={};this.gHd={};this.ixd={};this.HD=null;this.s5a=Ph.Imj(a);this.s5a.tkk();this.J1h=xC.nb(this.s5a);Ph.unb=this;this.w7=1;this.Azd=b;this.M2a=c}get Rq(){return this.HD||(this.HD=Db.a.instance.resolve("Box4.ITableEditor"))}get JJ(){return this.kI||(this.kI=Db.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.w7)){var a=new pf.GraphTransaction(7);
a.kd(this.s5a);this.rLk();this.rlk();this.XYi();P.a.instance.ga(63)&&this.Msi();this.ZYi();a.dispose();this.W2()}}Udl(a){this.kaf=a}ZYi(){var a=tb.GraphIterator.nb(this.s5a);if(!a.FEa()){const b=this.JJ.s1b(a);Ph.EB.LZ(a,!0);a=Oc.App.Kb.Kd.Dn;a.lp&&Ph.EB.Qod(b,a.V6b())}}cancel(){if(!(0<--this.w7)){var a=vx.a.Sz(this.s5a);for(a.em(Ph.O8e,null);a.moveNext();)a.iterator.fr||a.iterator.dZ(16,!1);this.W2()}}W2(){this.s5a.lBl();this.J1h.dispose();Ph.unb=null}fpa(a){a.al?(Ph.xWj(a)&&Array.add(this.YBc,a.node),
this.BCh(a.node)):a.hx&&this.Nwl(a)}Nwl(a){for(let b=0;b<a.length;++b)this.fpa(a.getContext(b))}BCh(a){a.anchor.rT(16)}rlk(){for(let b=0;b<this.YBc.length;++b){var a=this.YBc[b];if(!a.anchor||a.anchor.YI)continue;const c=new tb.GraphIterator;c.set(a);if(!nb.SelectionEditor.Bt(c))continue;Ta.OutlineElementNavigator.Re(c);if(this.M2a.Zoi(c)){Ph.Ph.fDa(c);continue}a=new tn.a;a.Rc(c);if(!Ta.OutlineElementNavigator.FJ(a,!1,!1))continue;if(36===a.role)continue;Ta.OutlineElementNavigator.wi(a);if(a.currentNode.SW)continue;
if(od.TableReader.aq(a))continue;Ta.OutlineElementNavigator.Re(a);const f=new tb.GraphIterator;f.Rc(a);f.zc();Ph.Ph.merge(c,a,!1,!1);fe.OutlineElementReader.XI(f)&&!f.FEa()&&a.Mi()}Array.clear(this.YBc)}Msi(){for(let a=0;a<this.lEc.length;++a){const b=this.lEc[a];if(!b.anchor||b.anchor.YI)continue;if(Le.isGhostCellNode(b))continue;const c=new tb.GraphIterator;c.set(b);c.ZA(1);c.Bb(2);od.TableReader.aq(c)&&(c.zc(),Ph.Ph.Gda(c,!1,!0,null))}Array.clear(this.lEc)}A5i(a){const b=a.id.toString();if(this.$Qb[b])return this.$Qb[b];
const c=Array(od.TableReader.Ai(a));for(let f=0;f<od.TableReader.Ai(a);++f)c[f]=0;this.$Qb[b]=c;this.gHd[b]=od.TableReader.sk(a);return c}rLk(){const a=vx.a.Sz(this.s5a);a.em(Ph.O8e,null);var b=a.moveNext();const c=new tb.GraphIterator;let f=0;for(;b;)if(a.iterator.fr)this.zsi(a.iterator),b=a.moveNext();else if(this.M2a.tRj(a.iterator)&&Array.add(this.Axc,a.iterator.currentNode),P.a.instance.ga(63)&&Le.isTableCell(a.iterator)&&Array.add(this.lEc,a.iterator.currentNode),Ph.ipi(a.iterator))switch(a.iterator.ri){case 16:b=
Vd.getContainingTable(a.iterator);if(this.Azd&&!od.TableReader.Ku(b)&&!Le.isGhostCell(a.iterator)){b=this.A5i(b);var l=Hn.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=Vd.getContainingTable(a.iterator);this.Azd&&!od.TableReader.Ku(b)?(this.ixd[b.id.toString()]=!0,c.Rc(a.iterator),b=a.moveNext(),this.Rq.JMc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.kaf?(a.moveNext(),c.Rc(a.iterator),b=a.moveNext(),Ph.Ph.fDa(c)):(a.iterator.dZ(16,!1),b=a.moveNext());break;case 23:c.Rc(a.iterator);
b=a.moveNext();c.Mi();break;case 11:f++;Hf.b(a.iterator)?(a.iterator.dZ(16,!1),b=a.moveNext()):(c.Rc(a.iterator),rb.ListReader.uk(c)&&!this.M2a.FXe(c,f)&&Ph.eq.eoa(c),c.NI(2)?this.M2a.Qhl(c,f)?b=a.moveNext():(c.Rc(a.iterator),b=a.moveNext(),Ph.Ph.fDa(c)):(b=a.moveNext(),Ph.Ph.fDa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(od.TableReader.aq(a.iterator)&&this.Azd){var x=a.currentNode;let H=x.id.toString();const U=this.$Qb[H];let ja=!1;if(U){const ya=this.gHd[H];for(x=
od.TableReader.Ai(x)-1;0<=x;--x)U[x]===ya&&(this.Rq.HMc(a.iterator,x),ja=!0)}od.TableReader.Ai(a.iterator.currentNode)?P.a.instance.ga(30)&&(ja||this.ixd[H])&&od.TableReader.Ole(a.iterator.currentNode)&&(c.Rc(a.iterator),Vd.moveToFirstRow(c),Vd.moveToFirstColumn(c),b=a.moveNext(),Ph.Ph.Ejh(a.iterator,c)):(a.moveNext(),c.Rc(a.iterator),b=a.moveNext(),c.Mi(),l=!1)}l&&(a.iterator.dZ(16,!1),b=a.moveNext())}this.$Qb={};this.gHd={};this.ixd={}}zsi(a){if(a.Gi()){do a.dZ(16,!1);while(a.CEa())}}XYi(){for(let b=
0;b<this.Axc.length;++b){var a=this.Axc[b];if(a.anchor&&!a.anchor.YI){const c=new tb.GraphIterator;c.set(a);kh.OutlineNavigator.V$(c)||(c.currentNode.setValue($a.a.GE,Xm.a.first),P.a.instance.ga(41)&&10===c.ri&&(a=Ph.Ph.Jee(c,null,1),c.Pk(a)),Ph.EB.LZ(c,!0))}}Array.clear(this.Axc)}static get eq(){return Ph.Zo||(Ph.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}static get EB(){return Ph.Tx||(Ph.Tx=Db.a.instance.resolve("Box4.IOutlineEditor"))}static get Ph(){return Ph.Di||(Ph.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get SH(){return Zl.a.instance}static get $i(){return fd.a.instance}static sTc(a,
b){Ph.unb?Ph.unb.w7++:Ph.unb=new Ph(a,b,Db.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Ph.unb}static Imj(a){a=tb.GraphIterator.nb(a);nb.SelectionEditor.Bt(a);a.LKb(b=>b.iac);return a.currentNode}static xWj(a){let b=!1;nb.SelectionEditor.Xl(a)&&(b=!P.a.instance.ga(14)||!Ph.$i.eZc(a));!b&&Sb.ParagraphReader.um(a)&&(b=!P.a.instance.ga(14)||!Ph.$i.l_c(a)&&!a.node.sa(ab.a.jbb,!1));return b}static ipi(a){switch(a.ri){case 12:return a.currentNode.VIc}if(!a.Gi())return Ph.SH.zng(a)?
Ph.SH.TTd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.RW&16||16===a.ri&&Le.isGhostCell(a)||(b=!1)}a.dZ(16,!0)}while(a.CEa());b&&Ph.SH.zng(a)&&(b=Ph.SH.TTd(a.currentNode));return b}static Yoi(a){return a.fr||!!(a.RW&16)}}Ph.O8e=Ph.Yoi;Ph.unb=null;Ph.Pa=new wc.a;Ph.Tx=null;Ph.Zo=null;Ph.Di=null;Object(m.a)(Ph,"GraphStructureNormalizer",null,[]);class au{constructor(){this.$Mb=this.gp=this.fD=null;this.Agb=0;this.response=2}}Object(m.a)(au,"TableGeneralizeData",
null,[]);class fi{static get km(){return Ih.ContextSetEditor.instance}static M5(a,b,c,f,l,x,H){let U=!1;x&&x[fi.IPb]&&x[fi.IPb]&&(U=!0);if(!b.view.Mh)return 2;const ja=b.view;var ya=ja.Lb;if(1===c){if(!ya||!ya.Na.mb)return 8;b=0===H?b.CE:fi.km.N4b(b.CE,H,!0);return u.AFrameworkApplication.Ta.mi(b,a,c,!0,f,l)}x&&x[fi.spa]&&bd.a.mark(x[fi.spa]);const Va=em.SelectionReferenceFactory.instance.gsa(),hb=ya.Na.mb.Ua;ya=new pf.GraphTransaction(15);ya.kd(hb.node);ya.uya();b=0===H?b.CE:fi.km.N4b(b.CE,H);a=
u.AFrameworkApplication.Ta.mi(b,a,c,!0,f,l);32===a&&Va.MU(U);v.FocusManager.instance().tf(ja.DI);ya.dispose();Oc.App.Kb.updateCommandUI();x&&x[fi.rpa]&&bd.a.mark(x[fi.rpa]);return a}static ohb(a,b,c,f,l,x){var H=qd.a.instance;let U,ja=!1;x&&x[fi.IPb]&&x[fi.IPb]&&(ja=!0);if(1===c)return H&&H.Na.mb?(U=ri.dta(H.Na,!1,!0))?u.AFrameworkApplication.Ta.mi(U,a,c,!0,f,l):8:8;x&&x[fi.spa]&&bd.a.mark(x[fi.spa]);const ya=em.SelectionReferenceFactory.instance.gsa(),Va=H.Na.mb.Ua;U=ri.dta(H.Na,!1);if(!U)return 8;
H=new pf.GraphTransaction(15);H.kd(Va.node);H.uya();a=u.AFrameworkApplication.Ta.mi(U,a,c,!0,f,l);32===a&&ya.MU(ja);(b=b.view)&&v.FocusManager.instance().tf(b.DI);H.dispose();Oc.App.Kb.updateCommandUI();x&&x[fi.rpa]&&bd.a.mark(x[fi.rpa]);return a}}fi.spa="PerfMarkStart";fi.rpa="PerfMarkEnd";fi.IPb="CollapseIp";Object(m.a)(fi,"ViewActionHandler",null,[]);var uI=d(560);class vI{constructor(){this.controlCell=null;this.sGf=this.fmh=0;this.yWf=this.zWf=null}}Object(m.a)(vI,"MergedCellInfo",null,[]);var wx=
d(318),wI=d(673),jQ=d(721),In=d(366);class uv extends Ij.a{constructor(a){super(0,0,0);this.d8=a;this.aNa=Array(a)}D5i(a){return this.aNa[a]}Dph(a,b){this.aNa[a]=b}copy(){const a=new uv(this.d8);for(let b=0;b<this.d8;++b)a.aNa[b]=this.aNa[b];return a}zlk(){let a=In.a.Ykb;for(let b=0;b<this.d8;++b)a+=this.aNa[b]+1;return a}static rvi(a,b){const c=new uv(a.d8);for(let f=0;f<c.d8;f++)c.aNa[f]=Math.max(a.aNa[f],b.aNa[f]);return c}}Object(m.a)(uv,"TableRowViewSizeConstraints",Ij.a,[]);class bu extends ch.a{constructor(a,
b,c,f,l,x=null){super(a,b,c);this.j2a=null;this.$yd=0;this.vwc=-1;this.hd=f;this.fd=l;this.nc(this.Md.hp(va.a.tr));this.htmlElement.className="TableRow";Hb.d(this.htmlElement,Ba.a.role,"row");this.sjh();this.waf=x}Ky(){this.gb.Q8g=[];this.htmlElement.style.height=this.dmh;this.sjh()}sjh(){this.hd&&this.hd.jFa(65)&&(this.gb.P0b?Sys.UI.DomElement.addCssClass(this.htmlElement,Bc.T3):Sys.UI.DomElement.removeCssClass(this.htmlElement,Bc.T3))}V9k(a){const b=this.vwc!==a;this.vwc=a;return b}mFl(){this.htmlElement.style.height=
this.emh+"px"}get emh(){let a=0>=this.vwc?bu.eZg:this.vwc;this.gb.Sa(ab.a.su)&&(a=Math.max(a,this.Md.Ld.Pe(this.gb.eb(ab.a.su),1)));return a}get dmh(){return this.gb.Sa(ab.a.su)?this.Md.Ld.Pe(this.gb.eb(ab.a.su),1)+"px":"auto"}JU(a){super.JU(a);var b=od.TableReader.Ai(Vd.getContainingTable(a));let c=0;b=new uv(b);if(a.Bb(1)){do b.Dph(c,a.Xq.pLa.total),c++;while(a.Dj(1))}return b}gK(a){super.gK(a);this.FR.xU(this.htmlElement)}get author(){return this.j2a}o4e(a){let b=!0;if(this.Qc.lp&&this.Qc.sJj){a=
Vl.a.qv(a);for(var c={};a.moveNext();){if(!fe.OutlineElementReader.Yg(a.iterator)||fe.OutlineElementReader.fce(a.iterator))continue;const f=fe.OutlineElementReader.pRc(a.currentNode,$a.a.DZb);f&&(c[f]="")}a=pa.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.j2a=a,this.$yd=c.height,b=!1)}b&&(this.j2a="",this.$yd=-1)}get KWd(){return this.$yd}n_k(){this.waf&&this.waf.xOl(this)}}bu.eZg=20;Object(m.a)(bu,"TableRowViewElement",
ch.a,[442]);class Qh{constructor(a,b){Qh.Tx=a;Qh.Di=b}M1k(a){const b=a.fsd.currentNode;this.IDl(b);let c=this.xBi(b);var f=this.Glj(b,c);let l=f.length;a.OMc=this.dYi(f);a.MMc=this.uXi(f);f=a.OMc.toArray().length;const x=a.MMc.toArray().length;if(0<f||0<x)l-=f,c-=x,this.XFl(a);this.XLb(Object(oa.a)(ug.a,b),l);this.GLb(Object(oa.a)(ug.a,b),c);this.r1k(a)}uXi(a){const b=new Ka.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}dYi(a){const b=
new Ka.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}xBi(a){let b=0;a=tb.GraphIterator.nb(a);Vd.moveToFirstRow(Object(oa.a)(tb.GraphIterator,a));Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,a));let c=Object(oa.a)(124,a.yq),f=!1;for(;c;)!c.isGhostCell||Le.isSkippedCell(Object(oa.a)(ug.a,c))?(b+=c.D$a?c.colSpan:1,f=!0):f||b++,c=Object(oa.a)(124,Vd.moveToNextColumn(Object(oa.a)(tb.GraphIterator,a)));return b}XFl(a){const b=
tb.GraphIterator.nb(a.fsd.yq);let c=0;Vd.moveToFirstRow(Object(oa.a)(tb.GraphIterator,b));var f=b.yq;const l=Rf.a.rf(bu.eZg,1);for(;f;){for(;a.OMc.contains(c);)c++;var x=1,H=a.Mrc?a.Mrc.rowIndex:0,U=a.uxh[H+c];for(U<l&&(U=l);a.OMc.contains(c+x);){var ja=a.uxh[H+c+x];ja<l&&(ja=l);U+=ja;x++}f.setValue(ab.a.su,U);f=x-1;x=0;Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,b));for(H=Object(oa.a)(124,b.yq);H;){U=H.D$a?H.colSpan:1;if(!H.isGhostCell||1<U){0<f&&(H.rowSpan-=f,1>H.rowSpan&&(H.rowSpan=1));
ja=0;for(let ya=1;ya<U;ya++)a.MMc.contains(x+ya)&&ja++;0<ja&&(H.colSpan-=ja,1>H.colSpan&&(H.colSpan=1))}x+=U;H=Object(oa.a)(124,Vd.moveToNextColumn(Object(oa.a)(tb.GraphIterator,b)))}c++;Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,b));b.zc();f=Vd.moveToNextRow(Object(oa.a)(tb.GraphIterator,b))}}IDl(a){const b=new Ka.a;a=tb.GraphIterator.nb(a);Vd.moveToFirstRow(Object(oa.a)(tb.GraphIterator,a));for(var c=a.yq;c;){c=!1;let l=0;Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,a));for(var f=
Object(oa.a)(wx.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.D$a?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.ZUd())):Le.isSkippedCell(Object(oa.a)(ug.a,f))||b.contains(l)&&(c||P.a.instance.ga(77))||(f.isGhostCell=!1,f.ZUd());else{c=!0;f=f.D$a?f.colSpan:1;for(let x=0;x<f;x++)b.contains(l+x)||b.add(l+x)}l++;f=Object(oa.a)(wx.TableCellNode,Vd.moveToNextColumn(Object(oa.a)(tb.GraphIterator,a)))}Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,a));a.zc();c=Vd.moveToNextRow(Object(oa.a)(tb.GraphIterator,
a))}}Glj(a,b){const c=[];let f=0;a=tb.GraphIterator.nb(a);Vd.moveToFirstRow(Object(oa.a)(tb.GraphIterator,a));for(var l=a.yq;l;){l=0;Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,a));for(var x=Object(oa.a)(124,a.yq);x;){if(!x.isGhostCell||Le.isSkippedCell(Object(oa.a)(ug.a,x))){const H=x.D$a?x.colSpan:1;for(x=x.ace?x.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let U=0;U<x;U++){const ja=f+U;ja===c.length&&Array.add(c,Array(b));for(let ya=0;ya<H;ya++)c[ja][l+ya]=0<U||0<ya?2:1}l+=H}x=
Object(oa.a)(124,Vd.moveToNextColumn(Object(oa.a)(tb.GraphIterator,a)))}Vd.moveToFirstColumn(Object(oa.a)(tb.GraphIterator,a));a.zc();l=Vd.moveToNextRow(Object(oa.a)(tb.GraphIterator,a));f++}return c}r1k(a){if(od.TableReader.aq(a.fsd)&&a.Mrc&&a.sxh){var b=Object(oa.a)(126,a.fsd.yq),c=a.sxh,f=Array(b.d8),l=a.Mrc.dja;for(let x=0;x<f.length;x++)for(f[x]=c[l],l++;a.MMc.contains(l-a.Mrc.dja);)f[x]+=c[l],l++;b.HQa=f}}Fza(a){if(P.a.instance.ga(77)||P.a.instance.ga(63))Vd.forEachCellInTable(a,b=>{b.currentNode.PIa=
null;return!0}),Vd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.KEi(b,f,l):c.jSe()}return!0})}KEi(a,b,c){const f=a.currentNode,l=new tb.GraphIterator;l.Rc(a);Vd.forEachCell(l,b,c,(x,H,U)=>{const ja=x.currentNode;if(ja!==f){ja.isGhostCell=!0;let Va=!1;var ya=!0;const hb=Qh.ze;hb&&(Va=hb.isFeatureEnabled(136),hb.Tbb(136));do{x.Bb(1);if(Object(Xa.a)(uI.a,x.currentNode)){if((ya=ya&&fe.OutlineElementReader.isEmpty(x,!1))||!Va)ya=tb.GraphIterator.nb(x.yq),
ya.rc(16),ya=!ya.Cf(1);ya||a.Cl(x.currentNode,1);x.Mi()}ya=!1}while(Va&&x.NI(1))}ja.PIa=Object.assign(new vI,{controlCell:f,fmh:H,sGf:U});1!==H||U||(f.PIa.yWf=ja);H||1!==U||(f.PIa.zWf=ja);ja.jSe();U||(ja.colSpan=c)});f.rowSpan=b;f.colSpan=c}Cee(a){const b=new tb.GraphIterator;b.Rc(a);Vd.returnToContainingRow(b);var c=b.currentNode;b.Bb(1);const f=new tb.GraphIterator;f.Rc(a);Vd.returnToContainingTable(f);a=f.currentNode;this.Fza(f);const l=Bs.a.instance.createInstance(393251);this.U8b(f,l,c,c,!1);
f.Pk(l);c=od.TableReader.Ai(a);for(let x=0;x<c;++x){const H=b.currentNode,U=this.jsa();this.tYb(f,U,H,!1,!0);if(!U.isGhostCell)if(H.isGhostCell){let ja;(ja=H.PIa.controlCell).rowSpan=ja.rowSpan+1}else H.rowSpan=2;b.Cf(1)}this.XLb(a,od.TableReader.sk(a)+1);Vd.returnToContainingTable(f);this.Fza(f);return l}Bee(a){const b=tb.GraphIterator.nb(a.oIh());let c=od.TableReader.Ai(b.currentNode);a=Hn.a(a);const f=a+1;this.Fza(b);b.Bb(1);do{const x=b.Zp(a,1);b.zc();const H=this.jsa();this.J8b(b,H,x,!1,!1);
if(!H.isGhostCell)if(x.isGhostCell){var l=void 0;(l=x.PIa.controlCell).colSpan=l.colSpan+1}else x.colSpan=2}while(b.Dj(1));this.Fza(b);(l=b.currentNode.sa($a.a.Zu,null))&&(l=cb.a.clone(l));this.GLb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue($a.a.Zu,l));this.akc(b.currentNode,f,!1,1,null)}dld(a,b){od.TableReader.Ku(a.currentNode)&&P.a.instance.ga(63)&&this.ihh(a,c=>this.I$i(c,b),(c,f)=>{c.we(ab.a.su,f)},ab.a.complexTable)}Psj(a,b,c,f){let l=b;const x=b.PIa;P.a.instance.ga(77)&&
(a.isGhostCell=!1);if(x)if(Qh.uTc(x,!f))a.isGhostCell=!0;else{const H=Qh.owb(x.controlCell,f);!b.isGhostCell&&c||!c&&Qh.uTc(x,f)===H-1?(l=x.controlCell,!f&&l.ace&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Qh.Bjb(x.controlCell,f,H+1));f&&l.D$a&&(a.colSpan=l.colSpan)}return l}zrj(a,b,c){var f=a.PIa;if(f)if(a.isGhostCell)this.usj(f,b);else if(f=Qh.owb(a,b),1<f){const l=Qh.owb(a,!b),x=new tb.GraphIterator;x.set(a);x.rc(14);a=new tb.GraphIterator;a.Rc(x);const H=b?Vd.moveToNextRow(a):a.Cf(1);Qh.Bjb(H,b,
f-1);Qh.Bjb(H,!b,l);c(a,x)}}usj(a,b){Qh.uTc(a,!b)||Qh.Bjb(a.controlCell,b,Qh.owb(a.controlCell,b)-1)}iPb(a,b){let c=!1;Vd.forEachCellInTable(a,f=>Le.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.we(b,c)}ihh(a,b,c,f){var l=od.TableReader.sk(a.currentNode);const x=od.TableReader.Ai(a.currentNode);if(l&&x){var H=!1,U=!1,ja=Array(l);Vd.forEachCellInTable(a,(Zb,fc,Kc)=>{Kc||(ja[fc]=Array(x));Zb=Zb.currentNode;Zb.isGhostCell?Le.isSkippedCell(Zb)?ja[fc][Kc]=2:ja[fc][Kc]=1:ja[fc][Kc]=0;return!0});var ya=Array(l),
Va=Array(l);for(var hb=0;hb<l;hb++){var yb=!!hb;let Zb=!0;for(let fc=0;fc<x;fc++)if(ja[hb][fc])1===ja[hb][fc]?Zb=!1:hb&&2===ja[hb-1][fc]||(yb=!1);else{Zb=yb=!1;break}ya[hb]=yb;Va[hb]=Zb}for(--l;0<=l;l--)Va[l]?(a.Zp(l,1),this.JMc(a),Array.removeAt(ja,l),H=!0):ya[l]&&b&&(a.Zp(l,1),H=a.W5b(1),hb=b(a.currentNode),yb=b(H),c(H,hb+yb),this.JMc(a),Array.removeAt(ja,l),H=!0);l=ja.length;if(0<l){ya=Array(x);Va=Array(x);for(b=0;b<x;b++){c=!!b;hb=!0;for(yb=0;yb<l;yb++)if(ja[yb][b])1===ja[yb][b]?hb=!1:b&&2===
ja[yb][b-1]||(c=!1);else{hb=c=!1;break}ya[b]=c;Va[b]=hb}b=a.currentNode.sa($a.a.Zu,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=x-1;0<=l;l--)Va[l]?(b&&Array.removeAt(b,l),this.HMc(a,l),U=!0):ya[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.HMc(a,l),U=!0);U&&b&&a.currentNode.setValue($a.a.Zu,b)}(H||U)&&this.iPb(a,f)}}I$i(a,b){let c=tk.b(a);c||(a=a.sc(b))&&(c=ye.a.GH(a.htmlElement.offsetHeight));return c}XLb(a,b){od.TableReader.sk(a)!==b&&a.properties.setValue($a.a.iza,
b)}GLb(a,b){const c=od.TableReader.Ai(a);c!==b&&(b&&c&&a.properties.fo($a.a.Zu,$a.a.$0a),a.properties.setValue($a.a.xga,b))}e3(a,b,c,f=null,l=!1,x=!1){a=this.kLf(a);P.a.instance.ga(71);this.lWf(a,b,c,f,l,x);P.a.instance.ga(71);return a}kLf(a){P.a.instance.ga(63)&&od.TableReader.Cs(a)&&Vd.getContainingTable(a);const b=Bs.a.instance.createInstance(393250);a.Cl(b,2);a.Pk(b);return b}uSk(a,b,c,f,l){a=this.kLf(a);P.a.instance.ga(71);this.lWf(a,b,c,f,!1,l);ia.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}lWf(a,b,c,f=null,l=!1,x=!1){const H=tb.GraphIterator.nb(a);this.SKf(H,b,c,f,l);this.XLb(a,b);this.GLb(a,c);P.a.instance.ga(63);a.setValue($a.a.Xkb,!x)}SKf(a,b,c,f=null,l=!1){for(var x=0;x<b;++x){var H=new jQ.a;a.Cl(H,1);P.a.instance.ga(55)&&H.setValue(ab.a.io,bf.a.$Za())}b=null;x=!0;a.Bb(1);do for(H=0;H<c;++H){const U=this.jsa();a.Cl(U,1);({Znh:b,isFirst:x}=this.kWf(a,U,l,f,b,x));Vd.returnToContainingRow(a)}while(a.Dj(1))}kWf(a,b,c,f,l,x){a.Pk(b);l&&c?Qh.Di.gui(a,l):
(Qh.Tx.LZ(a,!0,f),!x&&c&&(l=new tb.GraphIterator,l.Rc(a)),x=!1);return{Znh:l,isFirst:x}}Nee(a,b,c,f){const l=new tb.GraphIterator;l.Rc(a);var x=l.currentNode;l.Bb(1);let H=tk.c(a);if(b)var U=a.JF(1);else U=a.currentNode,H++;const ja=a.zc();P.a.instance.ga(63);this.Fza(a);let ya=null,Va=null;for(var hb=0;hb<c;++hb){var yb=Bs.a.instance.createInstance(393251);Va||(Va=yb);ya=yb;this.U8b(a,yb,U,x,b)}x=od.TableReader.Ai(a.currentNode);U=!0;do{U?(a.Pk(ya),U=!1):a.Cf(1);for(hb=0;hb<x;++hb){yb=this.jsa();
const Zb=this.tYb(a,yb,l.currentNode,b,!0);this.zwf(a,yb,f(Zb));l.Cf(1)}l.pka(1)}while(a.currentNode!==Va);this.XLb(ja,od.TableReader.sk(ja)+c);this.PHe(ja,b,H,c)}JMc(a){const b=tk.c(a);var c=b+1;a.zc();P.a.instance.ga(63);this.Fza(a);for(--c;c>=b;--c){a.Zp(c,1);let f=a.Bb(1);for(;f;)this.OGe(f,!0),f=a.Dj(1);a.Mi()}this.XLb(a.currentNode,od.TableReader.sk(a.currentNode)-1);this.iHe(a,b,1)}Reg(a,b,c,f,l){P.a.instance.ga(63);this.Fza(a);let x=od.TableReader.Ai(a.currentNode);-1===b&&(b=x);const H=c?
b:b-1;a.Bb(1);do{const U=a.Zp(H,1);a.zc();for(let ja=0;ja<f;++ja){const ya=this.jsa(),Va=this.J8b(a,ya,U,c,!1);this.zwf(a,ya,l(Va))}}while(a.Dj(1));this.gRk(a,x+f,f,b,c);this.akc(a.currentNode,b,c,f,l)}gRk(a,b,c,f,l){let x=a.currentNode.sa($a.a.$0a,null),H=a.currentNode.sa($a.a.Zu,null);x&&(x=cb.a.clone(x));H&&(H=cb.a.clone(H));this.GLb(a.currentNode,b);if(P.a.instance.ga(30)&&x){const U=Array(b);let ja=0;for(;ja<f;++ja)U[ja]=x[ja];for(;ja<f+c;++ja)U[ja]=!1;for(;ja<b;++ja)U[ja]=x[ja-c];a.currentNode.setValue($a.a.$0a,
U)}H&&(b=this.Kvf(a,H,b,f,l,c),a.currentNode.setValue($a.a.Zu,b))}Kvf(a,b,c,f,l,x){a=Array(c);let H=l=0;for(;l<f;++l)a[l]=b[l],H+=a[l];for(;l<c;++l)a[l]=0>l-x?b[0]:b[l-x],H+=a[l];if(P.a.instance.ga(63)&&0<H)for(b=0/H,l=0;l<c;++l)a[l]=Math.max(Rf.a.rf(In.a.asd,0),a[l]*b);return a}akc(){}PHe(){}U8b(a,b,c){a.jXc(b,c,1,Qh.e3a?Qh.e3a():null)}J8b(a,b,c,f){a.Pk(c);f=f?a.W5b(1):c;a.zc();a.jXc(b,f,1,Qh.e3a?Qh.e3a():null);return c}tYb(a,b,c){a.asf(b,1,Qh.e3a?Qh.e3a():null);return c}zwf(a,b,c){Le.isGhostCellNode(b)||
(a.Pk(b),Qh.Tx.LZ(a,!0,c),Vd.returnToContainingRow(a))}HMc(a,b){P.a.instance.ga(63);this.Fza(a);let c=od.TableReader.Ai(a.currentNode);-1===b&&(b=c-1);a.Bb(1);do for(let f=b+1-1;f>=b;--f)a.Zp(f,1),this.OGe(a.currentNode,!1),a.Mi();while(a.Dj(1));this.fRk(a,c-1,b);this.hHe(a,b,1)}fRk(a,b,c){var f=a.currentNode.sa($a.a.$0a,null);let l=a.currentNode.sa($a.a.Zu,null);f&&(f=cb.a.clone(f));l&&(l=cb.a.clone(l));this.GLb(a.currentNode,b);if(f){var x=Array(b);let H=0;for(;H<c;++H)x[H]=f[H];for(;H<b;++H)x[H]=
f[H+1];a.currentNode.setValue($a.a.$0a,x)}if(l){f=Array(b);for(x=0;x<c;++x)f[x]=l[x];for(;x<b;++x)f[x]=l[x+1];a.currentNode.setValue($a.a.Zu,f)}}mergeCells(){}OGe(){}iHe(){}hHe(){}CKi(a){const b=Hn.a(a);a.zc();a.zc();this.HMc(a,b)}jsa(){const a=Bs.a.instance.createInstance(393252);a.setValue($a.a.GE,Xm.a.first);(new VF.OutlineIndentInfo(!0)).znh(a);return a}ZJ(a,b){a.setValue($a.a.Jl,b);a.setValue($a.a.eJ,b)}iFf(){}a0a(a,b,c){const f=od.TableReader.Ai(a);let l=a.sa($a.a.$0a,null);l=l?cb.a.clone(l):
Array(f);let x=a.sa($a.a.Zu,null);x=x?cb.a.clone(x):Array(f);l[b]=!0;x[b]=c;a.setValue($a.a.Zu,x);a.setValue($a.a.$0a,l)}static get mh(){return Qh.Kf||(Qh.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}static get ze(){return Qh.hd||(Qh.hd=Db.a.instance.ub("Box4.IFeatureHelper"))}static B4f(a,b=!0){const c=new wI.a;if(a){let f=null;a=Qd.SelectionFactory.tj(a,b);if(!a)ia.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(gc.a.MHf(a.ga(b))){f=a.ga(b);break}f&&
(a=gc.a.xs(f),a.cache.ht&&(a=a.ae(null),Qh.mh.QJ(a)),c.formatting=a.om,c.languageId=gc.a.language(a),P.a.instance.ga(71)&&(c.style=Ab.StyleReader.bE(f.node)))}return c}static Bjb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static owb(a,b){return b?a.rowSpan:a.colSpan}static uTc(a,b){return b?a.fmh:a.sGf}static M9i(a,b){return b?a.zWf:a.yWf}static bti(a,b,c){let f=a.sa($a.a.Zu,null);f=f?cb.a.clone(f):Array(c);f[b]=0;a.setValue($a.a.Zu,f)}}Qh.Kf=null;Qh.hd=null;Qh.Tx=null;Qh.Di=null;Qh.e3a=null;Object(m.a)(Qh,
"TableEditor",null,[418]);class dr{constructor(a){this.cnb=this.IP=0;nb.SelectionEditor.lx(a)||(a=nb.SelectionEditor.Sl(a,!0,!1));a=a.Ua;const b=new tb.GraphIterator;b.set(a.node);nb.SelectionEditor.Bt(b);nb.SelectionEditor.Tg(a)&&(this.IP=a.Qa,this.cnb=a.MS);nb.SelectionEditor.d9(a)&&b.Jg(12);this.sjf=new sx(b)}restore(){var a=new tb.GraphIterator;this.sjf.em(Object(F.a)(this,this.e7k,"selectableFilter"),null);var b=new mz.a;const c=new mz.a;this.sjf.nlh(a,c,b);if(Sb.ParagraphReader.ps(a.currentNode)){if(!c.value&&
b.value)return Qd.SelectionFactory.tj(a.currentNode,!1);b=Wd.a.Lj(a.currentNode,this.IP);-1!==this.cnb&&(a=Sb.ParagraphReader.ISa(a.currentNode,this.IP),0<this.cnb&&this.cnb<=a&&(b.MS=this.cnb,b.Ora=this.cnb));return Qd.SelectionFactory.Du(b)}return a.currentNode.eB?nb.SelectionEditor.Sl(Qd.SelectionFactory.wl(a.currentNode),!b.value,!1):(a=nb.SelectionEditor.Nja(a,!b.value))?Sb.ParagraphReader.ps(a)?Qd.SelectionFactory.Sg(a,b.value?Sb.ParagraphReader.textLength(a):0):Qd.SelectionFactory.wl(a):null}e7k(a){return a.currentNode.IFa||
a.currentNode.ZI}}Object(m.a)(dr,"IpReference",null,[]);class xI{constructor(){this.tableNode=null;this.columns=this.rows=0;this.kTj=!1}}Object(m.a)(xI,"TableActionData",null,[]);var kQ=d(183);class Ns{constructor(){this.I4b=!1}}Object(m.a)(Ns,"TrackChangeDeletionActionData",null,[]);class Ec{static get qca(){return Ec.gv||(Ec.gv=Db.a.instance.ub("Box4.IAutoCorrectScheduler"))}static get tM(){return Ec.EG||(Ec.EG=Db.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get Asl(){return Ec.tpf||
(Ec.tpf=Db.a.instance.ub("Box4.UI.TableAltTextDialogFactory"))}static get MKi(){return Ec.w$e||(Ec.w$e=Db.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static er(){return Ec.Hm||(Ec.Hm=Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static get Zwb(){return Ec.g3a||(Ec.g3a=a=>Qh.B4f(a))}static set Zwb(a){Ec.g3a=a}static get u9d(){return Ec.CBd||(Ec.CBd=Ec.Mgj)}static set u9d(a){Ec.CBd=a}static get r9d(){return Ec.zBd||(Ec.zBd=Ec.Ggj)}static set r9d(a){Ec.zBd=a}static get s9d(){return Ec.ABd||
(Ec.ABd=Ec.Igj)}static set s9d(a){Ec.ABd=a}static get t9d(){return Ec.BBd||(Ec.BBd=Ec.Kgj)}static set t9d(a){Ec.BBd=a}static get v9d(){return Ec.DBd||(Ec.DBd=Ec.Ogj)}static set v9d(a){Ec.DBd=a}static get Iae(){return Ec.FBd||(Ec.FBd=Ec.Apj)}static set Iae(a){Ec.FBd=a}static get G9d(){return Ec.EBd||(Ec.EBd=Ec.yhj)}static set G9d(a){Ec.EBd=a}static get Zzb(){return Ec.cEd||(Ec.cEd=Ec.qTj)}static set Zzb(a){Ec.cEd=a}static get ze(){return Ec.hd||(Ec.hd=Db.a.instance.ub("Box4.IFeatureHelper"))}static get mh(){return Ec.Kf||
(Ec.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}static get Tf(){return Ec.fd||(Ec.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get C6(){return Ec.ap||(Ec.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get vUd(){return Ec.ZMa||(Ec.ZMa=Db.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get SH(){return Zl.a.instance}static get $i(){return fd.a.instance}static get Sf(){return Ec.Vg||(Ec.Vg=
Db.a.instance.resolve("Box4.List.IListReader"))}static get eq(){return Ec.Zo||(Ec.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}static get Ph(){return Ec.Di||(Ec.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get km(){return Ec.fha||(Ec.fha=Ih.ContextSetEditor.instance)}static set km(a){Ec.fha=a}static get Wc(){return Nc.a.instance}static get Rq(){return Ec.HD||(Ec.HD=Db.a.instance.resolve("Box4.ITableEditor"))}static get Dv(){null==Ec.lF&&(Ec.lF=u.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!P.a.instance.ga(30));return Ec.lF}static wb(a){const b=x=>ri.dta(x.Na,!1),c=(x,H,U,ja,ya)=>{const Va=Oc.App.RLa.FJf(b);ya[Ec.FLf]={};return Va(x,H,U,ja,ya)};Ec.QDj();const f=u.AFrameworkApplication.Ta;a=a.GJf();f.ya(D.a.e3,Cb.a.view,Ec.zHi);f.ya(D.a.e3,Cb.a.Pf,Ec.e3);f.je(D.a.e3,1028);f.ya(D.a.$ta,Cb.a.view,Ec.Mee);f.ya(D.a.$ta,Cb.a.tableRow,Ec.insertRow);f.je(D.a.$ta,1028);f.ya(D.a.kUa,Cb.a.view,Ec.Mee);f.ya(D.a.kUa,Cb.a.tableRow,Ec.insertRow);f.je(D.a.kUa,1028);f.ya(D.a.hUa,Cb.a.view,Ec.M8b);f.ya(D.a.hUa,
Cb.a.tableCell,Ec.insertColumn);f.je(D.a.hUa,4);f.ya(D.a.L8b,Cb.a.view,Ec.M8b);f.je(D.a.L8b,4);f.ya(D.a.hab,Cb.a.view,Ec.M8b);f.ya(D.a.hab,Cb.a.tableCell,Ec.insertColumn);f.je(D.a.hab,4);f.ya(D.a.K8b,Cb.a.view,Ec.M8b);f.je(D.a.K8b,4);f.ya(D.a.ZCa,Cb.a.view,Ec.uNf);f.ya(D.a.ZCa,Cb.a.tableCell,Ec.ZCa);f.je(D.a.ZCa,4);f.ya(D.a.deleteRow,Cb.a.view,Ec.uNf);f.ya(D.a.deleteRow,Cb.a.tableRow,Ec.deleteRow);f.je(D.a.deleteRow,1028);f.ya(D.a.o8,Cb.a.view,Ec.NKi);f.ya(D.a.o8,Cb.a.table,Ec.o8);f.je(D.a.o8,1028);
f.ya(D.a.m7a,Cb.a.table,Ec.m7a);f.ya(D.a.m7a,Cb.a.view,a);f.je(D.a.m7a,4);f.ya(D.a.insertTable,Cb.a.view,Ec.RGj);f.ya(D.a.insertTable,Cb.a.Pf,Ec.insertTable);f.je(D.a.insertTable,1036);f.ya(D.a.mergeCells,Cb.a.view,Ec.ulk);f.ya(D.a.mergeCells,Cb.a.tableCell,Ec.mergeCells);f.je(D.a.mergeCells,4);f.ya(D.a.splitCells,Cb.a.view,Ec.ppl);f.ya(D.a.splitCells,Cb.a.tableCell,Ec.splitCells);f.je(D.a.splitCells,4);f.ra(D.a.JMk,Cb.a.view,Jr.a.d1,96);f.ra(D.a.LMk,Cb.a.view,Jr.a.d1,96);f.ya(D.a.btl,Cb.a.view,Jr.a.dH);
f.ya(D.a.otl,Cb.a.view,Jr.a.dH);f.ya(D.a.MXc,Cb.a.view,Ec.MXc);f.je(D.a.MXc,1124);f.ya(D.a.$Nc,Cb.a.view,Ec.$Nc);f.je(D.a.$Nc,100);f.ya(D.a.gLb,Cb.a.view,Ec.gLb);f.ya(D.a.Dpc,Cb.a.view,Ec.$6k);f.ya(D.a.mnd,Cb.a.view,Ec.mnd);f.ya(D.a.eUe,Cb.a.view,Ec.eUe);f.ya(D.a.vtc,Cb.a.view,a);f.ya(D.a.vtc,Cb.a.table,Ec.vtc);f.je(D.a.vtc,4);f.ya(D.a.Omc,Cb.a.view,a);f.ya(D.a.Omc,Cb.a.table,Ec.Omc);f.je(D.a.Omc,96);P.a.instance.ga(30)&&(f.ya(D.a.G0a,Cb.a.view,Ec.M8b),f.ya(D.a.G0a,Cb.a.Pf,Ec.insertColumn),f.je(D.a.G0a,
4),f.ya(D.a.Orc,Cb.a.Pf,Ec.insertRow),f.ya(D.a.Orc,Cb.a.view,Ec.Mee),f.je(D.a.Orc,4));f.ya(D.a.GJb,Cb.a.view,Ec.GJb);P.a.instance.ga(63)?f.je(D.a.GJb,96):f.je(D.a.GJb,1124);a=[D.a.kog,D.a.iog,D.a.nog,D.a.jog,D.a.oog,D.a.mog,D.a.hog,D.a.X0c,D.a.W0c,D.a.Y0c,D.a.U0c,D.a.T0c,D.a.V0c,D.a.Q0c,D.a.P0c,D.a.R0c];for(var l of a)f.ya(l,Cb.a.view,Ec.Wja),f.ya(l,Cb.a.tableCell,Ec.Yei),f.je(l,4);l=[D.a.MNe,D.a.LNe,D.a.NNe,D.a.JNe,D.a.INe,D.a.KNe,D.a.GNe,D.a.FNe,D.a.HNe];for(const x of l)f.ya(x,Cb.a.view,c),f.ya(x,
Cb.a.paragraph,Ec.ILk),f.je(x,68)}static QDj(){Ec.uD.$(D.a.oog,Ec.uD.$(D.a.X0c,Ec.uD.$(D.a.W0c,Ec.uD.$(D.a.Y0c,Ec.uD.$(D.a.MNe,Ec.uD.$(D.a.LNe,Ec.uD.$(D.a.NNe,Ec.nCh)))))));Ec.uD.$(D.a.mog,Ec.uD.$(D.a.U0c,Ec.uD.$(D.a.T0c,Ec.uD.$(D.a.V0c,Ec.uD.$(D.a.JNe,Ec.uD.$(D.a.INe,Ec.uD.$(D.a.KNe,Ec.bmk)))))));Ec.uD.$(D.a.hog,Ec.uD.$(D.a.Q0c,Ec.uD.$(D.a.P0c,Ec.uD.$(D.a.R0c,Ec.uD.$(D.a.GNe,Ec.uD.$(D.a.FNe,Ec.uD.$(D.a.HNe,Ec.Nii)))))));Ec.TB.$(D.a.kog,Ec.TB.$(D.a.X0c,Ec.TB.$(D.a.U0c,Ec.TB.$(D.a.Q0c,Ec.TB.$(D.a.MNe,
Ec.TB.$(D.a.JNe,Ec.TB.$(D.a.GNe,1)))))));Ec.TB.$(D.a.iog,Ec.TB.$(D.a.W0c,Ec.TB.$(D.a.T0c,Ec.TB.$(D.a.P0c,Ec.TB.$(D.a.LNe,Ec.TB.$(D.a.INe,Ec.TB.$(D.a.FNe,2)))))));Ec.TB.$(D.a.nog,Ec.TB.$(D.a.Y0c,Ec.TB.$(D.a.V0c,Ec.TB.$(D.a.R0c,Ec.TB.$(D.a.NNe,Ec.TB.$(D.a.KNe,Ec.TB.$(D.a.HNe,3)))))));Ec.TB.$(D.a.jog,6)}static $Nc(a,b,c){if(1===c)return 32;if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;a=a.Lb.Pj;a=Ec.km.Q2(a,14);if(!a)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),
8;Ec.Asl.create(a);return 32}static gLb(a,b,c){bd.a.mark(5756);if(!b.view.Mh)return 2;const f=b.view;if(!f.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;a=f.Lb.Pj;a=Ec.km.Q2(a,14);if(!a)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),8;if(2===c){let l=null;b=a.node;c=od.TableReader.Ku(b);const x=Ec.Dv;if(!P.a.instance.ga(104)||c&&!x)l=Qd.SelectionFactory.wl(a.node);else if(P.a.instance.ga(77))c=Qd.SelectionFactory.WLc(b,x),f.Lb.ZLb(c,null);else{a=tb.GraphIterator.nb(b);a.Bb(1);for(b=[cr.TableNodeContext.create(a.currentNode)];a.Cf(1);)c&&
tk.h(a)||Array.add(b,cr.TableNodeContext.create(a.currentNode));l=new ib.Selection(b,!0)}l&&(c=new Xh.a(null,H=>{f.Lb.setSelection(l,H);return!1},null),c.Pl("SelectTable"),c.run())}bd.a.mark(5757);return 32}static $6k(a,b,c){bd.a.mark(5752);if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;b=a.Lb.Na;if(!b)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),2;b=Ec.v9d(b);if(32!==b.response)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),b.response;if(2===c){var f=
b.fD;b=c=f[0].node;var l=tb.GraphIterator.nb(c);l.rc(14);let U=null;var x=Vd.getContainingTable(l);x=od.TableReader.Ku(x);var H=Ec.Dv;H=P.a.instance.ga(104)&&(!x||H);const ja=[];for(let ya=0;ya<f.length;++ya){const Va=l.currentNode===f[ya].node;if(Va||x&&tk.d(l))b=l.currentNode,!H||x&&tk.h(l)||Array.add(ja,cr.TableNodeContext.create(l.currentNode)),Vd.moveToNextRow(l),Va||--ya}f=a.Lb.Na.mb;l=null;H?P.a.instance.ga(77)?(l=new tb.GraphIterator,H=new tb.GraphIterator,f.yf?(l.set(c),H.set(b)):(l.set(b),
H.set(c)),l.rc(14),Vd.moveToFirstColumn(l),H.rc(14),Vd.moveToLastColumn(H),l=x?Qd.SelectionFactory.B1b(l,H):Qd.SelectionFactory.iLf(l,H)):U=new ib.Selection(ja,P.a.instance.ga(63)||f.yf):U=Qd.SelectionFactory.VKf(c,b);U&&(l=new ub.SelectionCollection([U],0));a.Lb.ZLb(l,null)}bd.a.mark(5753);return 32}static mnd(a,b,c){bd.a.mark(5754);if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;b=a.Lb.Na;if(!b)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),2;b=
Ec.t9d(b);if(32!==b.response)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),b.response;if(2===c){c=[];var f=b.fD,l=new tb.GraphIterator;l.set(f[0].node);l.rc(14);b=Vd.getContainingTable(l);var x=Number.MAX_VALUE,H=0;if(f.length===od.TableReader.Ai(Vd.getContainingTable(l)))H=null,P.a.instance.ga(104)&&(H=Qd.SelectionFactory.WLc(b,Ec.Dv))?c=H.toArray():(H=Qd.SelectionFactory.wl(b),Array.add(c,H)),x=0,H=od.TableReader.Ai(b)-1;else{for(l=0;l<f.length;++l){var U=tb.GraphIterator.nb(f[l].node);U.rc(14);
U=Hn.a(U);x=Math.min(x,U);H=Math.max(H,U)}f=tb.GraphIterator.nb(b);Vd.moveToFirstRow(f);Vd.moveToColumnByIndex(f,x);l=new tb.GraphIterator;l.Rc(f);Vd.moveToColumnByIndex(l,H);var ja;U=b.Lp();U=P.a.instance.ga(104)&&(!U||Ec.Dv);do(ja=U?Qd.SelectionFactory.TLc(f,l,!0,!0):Qd.SelectionFactory.VKf(f.currentNode,l.currentNode))&&Array.add(c,ja),ja=!Vd.moveToNextRow(f),Vd.moveToNextRow(l);while(!ja)}f=tb.GraphIterator.nb(b);Vd.moveToCell(f,0,x);x=od.TableReader.sk(b);b=tb.GraphIterator.nb(b);Vd.moveToCell(b,
x-1,H);c=new ub.SelectionCollection(c,c.length-1,0,f,b);a.Lb.ZLb(c,null)}bd.a.mark(5751);return 32}static eUe(a,b,c){bd.a.mark(5750);if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;b=a.Lb.Pj;if(!b)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),2;var f=Ec.km.LA(b);b={};for(var l=0;l<f.length;++l)if(f[l].al){var x=tb.GraphIterator.nb(f[l].node);x.$e();if(!Le.isTableCellOrInside(x))return 8;Vd.returnToCell(x);b[x.currentNode.id.toString()]=x}if(2===c){if(P.a.instance.ga(104)){c=
a.Lb.Na;if(c.mb.jg)return bd.a.mark(5751),32;f=c.mb;x=f.yf?f.Ua:f.Ye;l=f.yf?f.Ye:f.Ua;c=new tb.GraphIterator;c.set(x.node);c.$e();x=new tb.GraphIterator;x.set(l.node);x.$e();l=null;if((l=Vd.returnToLowestCommonTable(c,x))&&!l.Lp()){var H=nb.SelectionEditor.Sl(f,!0,!1);H=cr.TableNodeContext.create(c.currentNode,H.Ua);H=Qd.SelectionFactory.x1b(Qd.SelectionFactory.Du(H));a.Lb.QE(H);bd.a.mark(5751);return 32}}c=[];for(H in b)f=Qd.SelectionFactory.wl(b[H].currentNode),Array.add(c,f);0<c.length&&(H=new ub.SelectionCollection(c,
c.length-1),a.Lb.ZLb(H,null))}bd.a.mark(5751);return 32}static ulj(){return u.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static Yei(a,b,c,f,l){f=Ec.Yci();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(Le.isGhostCellNode(b))return 32;Ec.uD.Hb(a)&&(c=Ec.uD.ga(a),b.we(ab.a.F0e,c));Ec.TB.Hb(a)&&(a=Ec.TB.ga(a),Ec.mxf(b,a));return 32}static mxf(a,b){if(!Le.isGhostCellNode(a)&&(a=tb.GraphIterator.nb(a),kh.OutlineNavigator.V$(a))){do if(a.Bb(2)){const c=a.currentNode;
12===c.type?c.we($a.a.Jl,b):14===c.type?od.TableReader.OXf(c,f=>{Ec.mxf(f,b)}):ia.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",kQ.a[c.type]);a.zc()}while(a.jp())}}static ILk(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[Ec.FLf];if(Ec.uWd in c&&!c[Ec.uWd])return 32;f=Ec.TB.ga(a);a=Ec.uD.ga(a);if(!b||!b.node)return 2;var x=b.node;b=Sb.ParagraphReader.HN(x);x=tb.GraphIterator.nb(x);x.rc(16);x.Jg(16);x=x.currentNode.sa(ab.a.F0e,Ec.nCh);c[Ec.uWd]=l[Sh.a.On]=f===
b&&a===x;return 32}static NKi(a,b,c,f,l){if(!b.view.Mh)return 2;a=b.view;if(!a.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;let x=a.Lb.Pj;x=Ec.km.Q2(x,14);if(!x)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),8;if(1===c)return u.AFrameworkApplication.Ta.mi(x,D.a.o8,c,!0,f,l);bd.a.mark(7117);const H=new dr(nb.SelectionEditor.Sl(Qd.SelectionFactory.Du(x),!0,!1)),U=new pf.GraphTransaction(15);try{U.kd(b.view.xg);const ja=Ph.sTc(x.node,!0);ja.fpa(x);const ya=Object(oa.a)(Ns,l)||new Ns;let Va=u.AFrameworkApplication.Ta.mi(x,
D.a.o8,c,!0,f,Ec.Tf.gg?ya:l);const hb=!Ec.Tf.gg||!Ec.Tf.Uy||ya.I4b;32===Va&&2===c&&hb?(ja.normalize(),a.Lb.setSelection(H.restore()),v.FocusManager.instance().tf(a.DI)):ja.cancel()}finally{U&&U.dispose()}bd.a.mark(7118);return 32}static zHi(a,b,c,f,l){bd.a.mark(4943);let x=null;2===c&&(x=new pf.GraphTransaction(15),x.kd(b.view.xg));a=u.AFrameworkApplication.Ta.mi(b.CE,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Mh)return 2;b=b.view;c=b.Lb.Pj;c=Ec.km.Q2(c,16);f=new tb.GraphIterator;f.set(c.node);f.rc(14);
Vd.moveToNextOrPreviousCell(f,!1);b.Lb.setSelection(Qd.SelectionFactory.tj(f.currentNode,!0))}x&&x.dispose();bd.a.mark(4944);return a}static M8b(a,b,c,f){if(!b.view.Mh)return 2;var l=b.view;if(!l.Lb||!l.Lb.Na.mb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;bd.a.mark(4945);var x=l.Lb.Pj;if(!x)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;l=a===D.a.hUa||a===D.a.G0a;var H=Ec.km.LA(x);if(!H||0>=H.length)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;H=H[0].node;if(!H)return Ec.Wc.Xb(Pd.a.vh,
{["Reason"]:Md.a.noSelection}),8;l=od.TableReader.vm(H)?a===D.a.K8b||l:a===D.a.L8b||l;const U=Ec.r9d(x,l);if(32!==U.response)return U.response;x=U.gp;H=od.TableReader.Ku(x);const ja=a;let ya;ya=l?Object(oa.a)(188,U.fD[U.fD.length-1]):Object(oa.a)(188,U.fD[0]);a!==D.a.G0a&&(a=l?D.a.hUa:D.a.hab);l=null;2===c&&(l=new pf.GraphTransaction(15),l.kd(b.view.xg));a=u.AFrameworkApplication.Ta.mi(ya,a,c,!0,f,U.Agb);l&&l.dispose();2===c&&ia.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
ja,D.a.Wz(ja)||"Unknown",P.a.instance.ga(77),H,a,x.id.toString(),od.TableReader.Ai(x)));bd.a.mark(4946);return a}static Mee(a,b,c,f){if(!b.view.Mh)return 2;const l=a===D.a.Orc,x=a===D.a.kUa;bd.a.mark(4947);var H=b.view;if(!H.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;const U=H.Lb.Pj;if(!U)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;H=Ec.u9d(U,x);if(32!==H.response)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),H.response;const ja=od.TableReader.Ku(H.gp);let ya=null;2===c&&(ya=
new pf.GraphTransaction(15),ya.kd(b.view.xg));b=x?Object(oa.a)(188,H.fD[0]):Object(oa.a)(188,H.fD[H.fD.length-1]);f=u.AFrameworkApplication.Ta.mi(l?U:b,a,c,!1,f,H.Agb);ya&&ya.dispose();2===c&&ia.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",a,D.a.Wz(a)||"Unknown",P.a.instance.ga(77),ja,f,H.gp.id.toString(),od.TableReader.sk(H.gp)));bd.a.mark(4948);return f}static GZg(a){for(Vd.moveToFirstColumn(a);Le.isGhostCell(a)&&
Vd.moveToPreviousRow(a););}static Ymk(a){for(Vd.moveToFirstRow(a);Le.isGhostCell(a)&&Vd.moveToPreviousColumn(a););}static ulk(a,b,c,f){if(P.a.instance.ga(30)||!b.view.Mh)return 2;const l=b.view;if(!l.Lb||!l.Lb.Na.mb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;const x=Ec.Ccj(l.Lb.Pj);if(32!==x.response)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),x.response;let H=null,U=null;2===c&&(H=new dr(l.Lb.Na.mb),H.restore(),U=new pf.GraphTransaction(15),U.kd(b.view.xg));a=u.AFrameworkApplication.Ta.mi(Wd.a.create(x.controlCell),
a,c,!1,f,x);2===c&&32===a&&(b=tb.GraphIterator.nb(x.gp),b.$e()&&Ec.Rq.dld(b,l.Ma),H&&(l.Lb.setSelection(Qd.SelectionFactory.tj(x.controlCell,!0)),v.FocusManager.instance().tf(l.DI)));U&&U.dispose();2===c&&ia.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static Ccj(a){const b=new tI;b.gp=null;b.controlCell=null;if(!a)return b.response=8,b;var c=Ec.km.LA(a);if(1>=c.length)return b.response=2,b;const f=new Ka.a;a={};for(let U=0;U<c.length;++U)if(c[U].al){const ja=
tb.GraphIterator.nb(c[U].node);ja.$e();if(!Le.isTableCellOrInside(ja))return b.response=8,b;var l=Object(oa.a)(Mb.AParagraphNode,ja.currentNode);if(l&&!l.sa(ab.a.Pje,!0))return b.response=8,b;Vd.returnToCell(ja);l=ja.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var x=Vd.getContainingTable(ja),H=Vd.getContainingTableRow(ja).id.toString();if(b.gp)if(b.gp!==x)if(ja.ITa(b.gp))continue;else if(tb.GraphIterator.nb(b.gp).Vaa(x))a={},b.gp=x,b.controlCell=l,a[H]=l.colSpan;else return b.response=
8,b;else a[H]=H in a?a[H]+l.colSpan:l.colSpan;else a={},b.gp=x,b.controlCell=l,a[H]=l.colSpan;for(x=1;x<l.rowSpan;x++)Vd.moveToNextRow(ja),H=Vd.getContainingTableRow(ja).id.toString(),a[H]=H in a?a[H]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=a[c[0]];for(const U of c)if(b.colSpan!==a[U])return b.response=2,b;b.response=32;return b}static ppl(a,b,c,f,l){if(P.a.instance.ga(30)||!b.view.Mh)return 2;const x=b.view;if(!x.Lb||!x.Lb.Na.mb)return Ec.Wc.Xb(Pd.a.vh,
{["Reason"]:Md.a.noSelection}),8;if(nb.SelectionEditor.lx(x.Lb.Na.mb))var H=x.Lb.Na.mb.Ua.node;else{H=x.Lb.Pj;if(!H)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),8;H=Ec.km.LA(H);if(1!==H.length||!Object(Xa.a)(Wd.a,H[0]))return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RHf}),8;H=H[0].node}H=tb.GraphIterator.nb(H);H.$e();if(!Le.isInTableCell(H))return 2;Vd.returnToContainingCell(H);H=H.currentNode;let U=null,ja=null;2===c&&(U=new dr(x.Lb.Na.mb),U.restore(),ja=new pf.GraphTransaction(15),ja.kd(b.view.xg));
b=Wd.a.create(H);a=u.AFrameworkApplication.Ta.mi(b,a,c,!1,f,l);2===c&&32===a&&U&&(x.Lb.setSelection(Qd.SelectionFactory.tj(H,!0)),v.FocusManager.instance().tf(x.DI));ja&&ja.dispose();2===c&&ia.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));return a}static uNf(a,b,c,f,l){if(!b.view.Mh)return 2;const x=a===D.a.deleteRow;x?bd.a.mark(4951):bd.a.mark(4949);const H=b.view;if(!H.Lb||!H.Lb.Na.mb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;var U=H.Lb.Pj;
const ja=Ec.G9d(U,x,H.Lb);if(32!==ja.response)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Psa}),ja.response;const ya=od.TableReader.Ku(ja.gp);var Va=null,hb=null,yb=null;let Zb=!1;var fc=!1;2===c&&(Va=new dr(H.Lb.Na.mb),fc=Va.restore(),yb=tb.GraphIterator.nb(fc.Ua.node),yb.rc(14),Vd.returnToContainingCell(yb),fc=Le.isLastCellInRow(yb),Vd.returnToContainingRow(yb),Zb=tk.j(yb),hb=Ph.sTc(b.view.xg,!0),ya&&(U=Ec.MKi.gTf(U)),hb.fpa(U),yb=new pf.GraphTransaction(15),yb.kd(b.view.xg));b=Object(oa.a)(Ns,l)||
new Ns;f=u.AFrameworkApplication.Ta.mi(Wa.a.XQa(ja.fD),a,c,!1,f,Ec.Tf.gg&&x?b:l);U=!Ec.Tf.gg||!Ec.Tf.Uy||!x||b.I4b;b=l=!1;if(2===c&&32===f&&U){let Kc=tb.GraphIterator.nb(ja.gp);Kc.$e()&&Ec.Rq.dld(Kc,H.Ma)}2===c&&32===f&&P.a.instance.ga(30)&&od.TableReader.Ole(ja.gp)&&U&&tb.GraphIterator.nb(ja.gp).$e()&&(Va=x?new dr(Qd.SelectionFactory.tj(ja.gp,!Zb)):new dr(Qd.SelectionFactory.tj(ja.gp,!fc)),H.Lb.setSelection(nb.SelectionEditor.Sl(Qd.SelectionFactory.wl(ja.gp),!1,!1)),u.AFrameworkApplication.Ta.processAction(D.a.m7a,
2),b=l=!0);if(32===f&&2===c&&U){if(!l&&0>=od.TableReader.Ai(ja.gp)||0>=od.TableReader.sk(ja.gp))l=!0;hb.normalize();if(Va){Va=Va.restore();if(l)Va=b&&!x?Qd.SelectionFactory.tj(Va.Ua.node,!fc):Qd.SelectionFactory.tj(Va.Ua.node,!0);else if(hb=tb.GraphIterator.nb(Va.Ua.node),hb.rc(14),x)Vd.returnToContainingRow(hb),Zb&&!P.a.instance.ga(77)?(hb.$e(),Ta.OutlineElementNavigator.Re(hb),Ec.Ph.Gda(hb,!1,!0)):Ec.GZg(hb),Va=Qd.SelectionFactory.tj(hb.currentNode,!0);else if(Vd.returnToCell(hb),fc&&P.a.instance.ga(30))Vd.moveToLastRow(hb),
Va=Qd.SelectionFactory.tj(hb.currentNode,!1);else if(P.a.instance.ga(63)||P.a.instance.ga(77))Ec.Ymk(hb),Va=Qd.SelectionFactory.tj(hb.currentNode,!0);H.Lb.setSelection(Va);v.FocusManager.instance().tf(H.DI)}}else hb&&hb.cancel();yb&&yb.dispose();2===c&&ia.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,D.a.Wz(a)||"Unknown",P.a.instance.ga(77),ya,f,ja.gp.id.toString()));x?bd.a.mark(4952):bd.a.mark(4950);return f}static Apj(a,
b){Vd.moveToFirstRow(a);const c=Object(oa.a)(wx.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Vd.moveToNextColumn(a);else Vd.moveToPreviousColumn(a)}static Mgj(a){return Ec.O4b(a,!1,!0)}static Ggj(a){return Ec.O4b(a,!0,!0)}static Igj(a,b){let c=Hn.a(a);b&&(c+=a.currentNode.colSpan-1);return c}static Kgj(a){a=qd.a.vsb(a);return Ec.O4b(a,!0,P.a.instance.ga(104)&&Ec.Dv)}static Ogj(a){a=qd.a.vsb(a);return Ec.O4b(a,!1,P.a.instance.ga(104)&&Ec.Dv)}static yhj(a,b){return Ec.O4b(a,!b,!0)}static O4b(a,
b,c){const f=new au;f.gp=null;if(!a)return f.response=8,f;var l={};let x=[],H=!1;a=Ec.km.LA(a);1===a.length&&(H=!0);for(let Va=0;Va<a.length;++Va)if(a[Va].al){const hb=[];let yb=tb.GraphIterator.nb(a[Va].node);yb.$e();if(!Le.isTableCellOrInside(yb))return f.response=8,f;if(b)Vd.returnToCell(yb),c&&1<Le.getColSpan(yb.currentNode)?Le.foreachMergedCells(yb.currentNode,Zb=>{Zb=tb.GraphIterator.nb(Zb);Zb.$e();Vd.moveToFirstRow(Zb);Array.add(hb,Zb)},2):Array.add(hb,yb),Vd.moveToFirstRow(yb);else{Le.isTableCell(yb)||
Vd.returnToCell(yb);var U=yb.currentNode.rowSpan;Vd.returnToContainingRow(yb);if(1<U)for(var ja=1;ja<U;ja++){var ya=tb.GraphIterator.nb(yb.currentNode);ya.$e();Array.add(hb,ya);Vd.moveToNextRow(yb)}Array.add(hb,yb)}for(U=0;U<hb.length;++U)if(yb=hb[U],ja=Vd.getContainingTable(yb),ya=yb.currentNode.id.toString(),!l[ya])if(l[ya]=!0,f.gp)if(f.gp!==ja)if(yb.ITa(f.gp))Ec.GYf(yb,f.gp,b),ya=yb.currentNode.id.toString(),l[ya]||(l[ya]=!0,Array.add(x,yb));else if(l[ya]=!1,tb.GraphIterator.nb(f.gp).Vaa(ja)){const Zb=
[];for(let fc=0;fc<x.length;fc++){const Kc=x[fc];Ec.GYf(Kc,ja,b);ya=Kc.currentNode.id.toString();l[ya]||(l[ya]=!0,Array.add(Zb,Kc))}ya=yb.currentNode.id.toString();l[ya]||(l[ya]=!0,Array.add(Zb,yb));f.gp=ja;Array.clear(x);x=Zb}else return f.response=8,f;else Array.add(x,yb);else f.gp=ja,Array.add(x,yb);Array.clear(hb)}if(!x.length)return f.response=8,f;f.$Mb=x[0].currentNode;b=[];for(l=0;l<x.length;l++){a=x[l];if(!c&&od.TableReader.szb(a))return f.response=8,f;Array.add(b,Wd.a.create(a.currentNode))}f.Agb=
H?1:b.length;f.fD=b;f.response=32;return f}static GYf(a,b,c){do c?Vd.returnToContainingCell(a):Vd.returnToContainingRow(a);while(Vd.getContainingTable(a)!==b);c&&Vd.moveToFirstRow(a)}static MXc(a,b,c,f,l){return 1===c?(a=b.CE)&&nb.SelectionEditor.Tg(a)?u.AFrameworkApplication.Ta.mi(a,D.a.insertTable,c,!0,f,l):2:32}static RGj(a,b,c,f,l){f.hQ=0;f.m8=0;let x=-1,H=null,U=null,ja=null;if(!b.view.Mh)return 2;const ya=b.view;if(!ya.Lb)return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;bd.a.mark(4941);if(2===
c){const Va=ya.Lb.Pj;Va.al&&(ja=new pf.GraphTransaction(15),U=UF.a.instance.Xmj(Va.node),ja.Fy(U),H=new tb.GraphIterator,H.Rc(U),H.zc(),x=H.FSa(U.currentNode))}a=u.AFrameworkApplication.Ta.mi(b.CE,a,c,!0,f,l);32===a&&2===c&&(U.isValid?(Ta.OutlineElementNavigator.FJ(U,!1,!1),Ta.OutlineElementNavigator.wi(U),c=Qd.SelectionFactory.tj(U.currentNode,!0)):(H.Hae(x),Ta.OutlineElementNavigator.wi(H),c=Qd.SelectionFactory.tj(H.currentNode,!0)),ya.Lb.setSelection(c),v.FocusManager.instance().tf(ya.DI));ja&&
ja.dispose();bd.a.mark(4942);return a}static GJb(a,b){if(!b.view.Mh)return 8;a=b.view;if(!a.Lb)return 8;a=Ec.km.LA(a.Lb.Pj);if(0>=a.length)return 8;b=new tb.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.$e(),!od.TableReader.Cs(b))return 8;return 32}static e3(a,b,c){var f=b.contextId===Cb.a.Pf;let l=null,x=null;if(f){l=b;if(oc.HyperlinkReader.Xka(l,!0))return Ec.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.NHf}),8;x=new tb.GraphIterator;x.set(l.node);nb.SelectionEditor.Bt(x);Hf.b(x)&&(Ec.Wc.Xb(Pd.a.Vo,
{["Reason"]:Md.a.EWd}),f=!1);!l.Qa&&x.Fig&&(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.Efg}),f=!1)}if(1===c||!f)return f?32:8;bd.a.mark(4929);b=new pf.GraphTransaction(7);b.Fy(x);Ta.OutlineElementNavigator.Re(x);c=x.currentNode;Ec.Ph.Gda(x,!1,!1);f=Ec.Rq.e3(x,1,2);const H=new tb.GraphIterator;H.set(c);H.$e();Vd.moveToCellContent(x,0,1);Ec.Ph.lNb(H,x,l,!0,!0);Vd.returnToContainingTable(x);Vd.moveToCellContent(x,0,0);x.Mi();zm.i(H,x,null,H.role);Ec.eq.QPa(H,null);Vd.returnToContainingTable(x);Ta.OutlineElementNavigator.Re(x);
H.Bb(1)&&zm.h(x,null,1,1,H,-1);Ec.qca&&Ec.qca.Ttc(c,A.a.Sq);b.dispose();ia.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.Wz(a)||"Unknown",P.a.instance.ga(77),f.id.toString()));bd.a.mark(4930);return 32}static insertColumn(a,b,c,f,l){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?ia.ULS.sendTraceTag(541172701,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):
ia.ULS.sendTraceTag(541172702,324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var x=nb.SelectionEditor.Tg(b)&&a===D.a.G0a||b.contextId===Cb.a.tableCell;f=null;if(x&&(f=new tb.GraphIterator,f.set(b.node),f.rc(14),Le.isTableCellOrInside(f)||(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.O0b}),x=!1),x&&!Ec.Zzb(f,a)&&(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.N0b}),x=!1),x)){Vd.returnToContainingCell(f);var H=P.a.instance.ga(63)?63:255;if(od.TableReader.Ai(Vd.getContainingTable(f))>=H)return Ec.Wc.Xb(Pd.a.Vo,
{["Reason"]:Md.a.eYg}),8}if(1===c||!x)return x?32:8;bd.a.mark(4931);c=a!==D.a.hab;x=new pf.GraphTransaction(15);x.Fy(f);b.node.YG().graphTransactionOperations.Mia(2);H=new tb.GraphIterator;H.set(f.currentNode);H.rc(15);Vd.returnToContainingTable(f);let U=Ec.s9d(H,c);c&&U++;Ec.Rq.Reg(f,U,!c,l?l:1,Ec.Zwb);f.set(b.node);f.rc(16);a===D.a.G0a?(Vd.moveToNextColumn(H),kh.OutlineNavigator.V$(H),Ta.OutlineElementNavigator.Re(f),Ec.Ph.joc(H),Ec.Ph.lNb(f,H,b,!0,!0),Ec.qca&&Ec.qca.Ttc(f.currentNode,A.a.Sq)):
(a=Oc.App.Kb.Kd,b=tb.GraphIterator.nb(b.node),b.$e(),Ec.Iae(b,c),a.Dn.Lb.setSelection(Qd.SelectionFactory.tj(b.currentNode,!0)));x.dispose();bd.a.mark(4932);return 32}static qTj(a){return!(P.a.instance.ga(14)&&od.TableReader.AOj(a))&&!(P.a.instance.ga(30)&&od.TableReader.szb(a))}static insertRow(a,b,c,f,l){const x=a===D.a.Orc;f=a===D.a.kUa;var H=b.node;const U=new tb.GraphIterator;U.set(H);U.$e();let ja=!0;tk.m(H)||od.TableReader.Cs(U)||(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.j0d}),ja=!1);ja&&!Ec.Zzb(U,
a)&&(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.N0b}),ja=!1);if(1===c||!ja)return ja?32:8;bd.a.mark(4933);a=new pf.GraphTransaction(15);a.Fy(U);b.node.YG().graphTransactionOperations.Mia(2);x?(l=new tb.GraphIterator,l.Rc(U),Ta.OutlineElementNavigator.Re(l),Vd.returnToContainingRow(U),Ec.Rq.Nee(U,f,1,Ec.Zwb),Vd.moveToFirstColumn(U),kh.OutlineNavigator.V$(U),Ec.Ph.lNb(l,U,b,!1,!0),Vd.returnToContainingRow(U),Ec.qca&&Ec.qca.Ttc(l.currentNode,A.a.Sq)):Ec.Rq.Nee(U,f,l?l:1,Ec.Zwb);b=Oc.App.Kb.Kd;H=tb.GraphIterator.nb(H);
H.rc(14);tk.l(H)||Vd.returnToContainingRow(H);f?Vd.moveToPreviousRow(H):Vd.moveToNextRow(H);Ec.GZg(H);b.Dn.Lb.setSelection(Qd.SelectionFactory.tj(H.currentNode,!0));a.dispose();bd.a.mark(4934);return 32}static Wja(a,b,c,f,l){b=fi.M5(a,b,c,f,l,{},16);2===c&&Ec.Noa(a)&&ia.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,D.a.Wz(a)||"Unknown",b));return b}static Noa(a){return a===D.a.X0c||a===D.a.W0c||a===D.a.Y0c||a===D.a.U0c||a===D.a.T0c||a===D.a.V0c||a===
D.a.Q0c||a===D.a.P0c||a===D.a.R0c}static ZCa(a,b,c){const f=new tb.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.$e()||(Ec.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.sPc}),l=!1),Le.isTableCellNode(b.node)||(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.O0b}),l=!1));l&&!Ec.Zzb(f,a)&&(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.N0b}),l=!1);if(l&&!Ec.SH.mRd()){a=new tb.GraphIterator;a.Rc(f);do if(!Ec.SH.r_b(a.currentNode)){Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.PKc});l=!1;break}while(Vd.moveToNextRow(a))}if(l&&(a=new tb.GraphIterator,
a.Rc(f),1!==c&&P.a.instance.ga(50)&&Oc.App.Ih.rw)){do for(b=Vl.a.Sz(a.currentNode);b.moveNext();){const x=b.currentNode;Sb.ParagraphReader.$d(x)&&Oc.App.Ih.YY.hra(x)}while(Vd.moveToNextRow(a))}if(1===c)return l?32:8;if(l){bd.a.mark(4935);c=new pf.GraphTransaction(7);try{c.Fy(f),Ec.Rq.CKi(f)}finally{c&&c.dispose()}bd.a.mark(4936);return 32}return 2}static mergeCells(a,b,c,f,l){a=new tb.GraphIterator;if(f=b.isValid){a.set(b.node);a.$e()||(Ec.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.sPc}),f=!1);Le.isTableCellNode(b.node)||
(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.O0b}),f=!1);if(f&&!Ec.SH.mRd()){b=new tb.GraphIterator;b.Rc(a);var x=new tb.GraphIterator;x.Rc(a);for(var H=0;H<l.rowSpan;H++){for(var U=0;U<l.colSpan;U++){if(!Ec.SH.r_b(b.currentNode)){Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.PKc});f=!1;break}b.Cf(1)}if(!f)break;Vd.moveToNextRow(x);b.Rc(x)}}if(f&&1!==c&&P.a.instance.ga(50)&&Oc.App.Ih.rw)for(b=new tb.GraphIterator,b.Rc(a),x=new tb.GraphIterator,x.Rc(a),H=0;H<l.rowSpan;H++){for(U=0;U<l.colSpan;U++)Oc.App.Ih.YY.hra(b.currentNode),
b.Cf(1);if(!f)break;Vd.moveToNextRow(x);b.Rc(x)}}if(1===c)return f?32:8;if(f){c=new pf.GraphTransaction(7);try{c.Fy(a),Ec.Rq.mergeCells(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static splitCells(a,b,c){a=new tb.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.$e()||(Ec.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.sPc}),f=!1),Le.isTableCellNode(b.node)||(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.O0b}),f=!1),f&&1!==c&&P.a.instance.ga(50)&&Oc.App.Ih.rw&&(b=new tb.GraphIterator,b.Rc(a),Oc.App.Ih.YY.hra(b.currentNode)));
if(1===c)return f?32:8;if(f){c=new pf.GraphTransaction(7);try{c.Fy(a)}finally{c&&c.dispose()}return 32}return 2}static o8(a,b,c,f,l){b=b.node;f=!0;od.TableReader.qbb(b)||(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.NKc}),f=!1);Ec.SH.r_b(b)||(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.PKc}),f=!1);f&&(P.a.instance.ga(14)||P.a.instance.ga(63))&&Ec.$i.kme(b)&&(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),f=!1);if(1===c)return f?32:8;if(f){if(P.a.instance.ga(50)&&Oc.App.Ih.rw)for(c=Vl.a.Sz(b);c.moveNext();)f=c.currentNode,12===
f.type&&Oc.App.Ih.YY.hra(f);l=Object(oa.a)(Ns,l);c=new pf.GraphTransaction(7);c.kd(b);f=new tb.GraphIterator;f.set(b);f.$e();f.zc();Ec.Ph.fDa(f);c.dispose();l&&(l.I4b=!0);ia.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,D.a.Wz(a)||"Unknown",P.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!Ec.SH.r_b(b))return 8;f=new tb.GraphIterator;f.set(b);f.$e();let x=tk.m(b);x||Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.UHf});
x&&!Ec.Zzb(f,a)&&(Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.N0b}),x=!1);if(1===c)return x?32:8;if(x){if(P.a.instance.ga(50)&&!Oc.App.Ih.amIAlone)for(a=Vl.a.Sz(b);a.moveNext();)c=a.currentNode,12===c.type&&Oc.App.Ih.YY.hra(c);bd.a.mark(4937);l=Object(oa.a)(Ns,l);a=new pf.GraphTransaction(7);a.kd(b);Ec.Rq.JMc(f);a.dispose();l&&(l.I4b=!0);bd.a.mark(4938);return 32}return 2}static m7a(a,b,c){let f=!1;a=null;b.al&&(a=new tb.GraphIterator,a.set(b.node),(f=od.TableReader.aq(a)&&od.TableReader.Ole(a.currentNode))?
a.$e():Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.THf}));return 1===c?f?32:8:f?(bd.a.mark(4939),b=new tb.GraphIterator,b.Rc(a),Vd.moveToCell(b,0,0),Ta.OutlineElementNavigator.Re(a),c=new pf.GraphTransaction(7),c.Fy(b),Ec.Ph.Ejh(a,b),c.dispose(),bd.a.mark(4940),32):2}static insertTable(a,b,c,f,l){if(!b.al||!nb.SelectionEditor.Tg(b))return 2;if(P.a.instance.ga(14)&&Ec.$i.tua(b))return Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),2;if(Ec.er()&&Ec.er().instance&&Ec.er().instance.XW(b))return 2;var x=new tb.GraphIterator;
x.set(b.node);nb.SelectionEditor.Bt(x);if(Hf.b(x))return Ec.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.EWd}),2;if(1===c)return 32;c=1;x=2;l&&(c=l.rows,x=l.columns);f.hQ=x;f.m8=c;if(nb.SelectionEditor.Tg(b)){f=new pf.GraphTransaction(7);bd.a.mark(4927);f.kd(b.node);b.node.YG().graphTransactionOperations.Mia(2);const U=new wI.a;P.a.instance.ga(50)&&Oc.App.Ih.rw&&Oc.App.Ih.YY.hra(b.node);var H=gc.a.xs(b);P.a.instance.ga(49)&&(H.cache.ht&&(H=H.ae(null),Ec.mh.QJ(H)),U.formatting=H.om);U.languageId=gc.a.language(H);
P.a.instance.ga(71)&&(U.style=Ab.StyleReader.bE(b.node),Ec.Sf.I2b(U.style)&&(H=Ab.StyleReader.qL(b.node)))&&(U.style=H.$G(Ab.StyleReader.zMa));P.a.instance.ga(54)?(H=tb.GraphIterator.nb(b.node),H.rc(11),Ec.tM.K8(H.currentNode)):new kv.a(1,-1);b=Ec.Ph.BGj(b);H=l&&l.kTj?Ec.Rq.e3(b,c,x,U):Ec.Rq.e3(b,c,x,U,!0);l&&(l.tableNode=H);Ta.OutlineElementNavigator.Re(b);P.a.instance.ga(56)&&U.style&&!fe.OutlineElementReader.ule(b.currentNode)&&U.style.sa($a.a.rY,!1)&&Ec.Ph.aLa(b.currentNode,!0);Ec.eq.QPa(b,null,
!0,!1,-1);fe.OutlineElementReader.Yab(b)&&Ec.Ph.Gda(b,!1,!0,U);f.dispose();ia.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,D.a.Wz(a)||"Unknown",P.a.instance.ga(77),H.id.toString(),c,x));bd.a.mark(4928);u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static vtc(a,b,c){if(1===c)return 32;bd.a.mark(5748);a=b.node;b=new pf.GraphTransaction(15);
b.kd(a);a.setValue($a.a.Xkb,!a.sa($a.a.Xkb,!0));b.dispose();bd.a.mark(5749);return 32}static Omc(a,b,c,f,l){l.setValue($a.a.Xkb,!b.node.sa($a.a.Xkb,!0));return 32}}Ec.nCh="top";Ec.bmk="center";Ec.Nii="bottom";Ec.FLf="__cumulative__";Ec.uWd="__consistent__";Ec.TB=new ui.a;Ec.uD=new ui.a;Ec.Di=null;Ec.gv=null;Ec.EG=null;Ec.tpf=null;Ec.w$e=null;Ec.lF=null;Ec.Hm=null;Ec.g3a=null;Ec.Yci=Ec.ulj;Ec.CBd=null;Ec.zBd=null;Ec.ABd=null;Ec.BBd=null;Ec.DBd=null;Ec.FBd=null;Ec.EBd=null;Ec.cEd=null;Ec.hd=null;Ec.Kf=
null;Ec.fd=null;Ec.ap=null;Ec.ZMa=null;Ec.Vg=null;Ec.Zo=null;Ec.fha=null;Ec.HD=null;Object(m.a)(Ec,"TableActor",null,[]);var yI=d(311),lQ=d(822),zI=d(881),mQ=d(406),nQ=d(807);class AI{constructor(a,b,c,f){this.OMc=this.MMc=null;this.Mrc=a;this.fsd=b;this.sxh=c;this.uxh=f}}Object(m.a)(AI,"TableSimplificationInformation",null,[]);var vv=d(421),oQ=d(454),cu=d(255),tq=d(217);class Th{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){this.Vg=this.g3a=this.lN=this.Fp=null;this.FGd=!1;this.ZWh=x;this.EG=
H;this.oob=a;this.HD=b;this.Tx=c;this.Di=f;this.Zo=l;this.$a=U;this.Ak=ya;this.fNd=ja.create(2097162);this.bQe(this.fNd);this.yaf=ja.create(2097162);this.bQe(this.yaf);this.Pqf=ja.create(2097162);this.bQe(this.Pqf);this.h2=this.fNd;this.MLd=Va;this.JD=hb;this.fd=yb;this.HWb=Zb;this.u_h=Zb.substr(0,3);this.dqa=fc}get Sf(){return this.Vg||(this.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}get Rr(){return this.Fp?this.Fp.Rr:0}get s7a(){return this.Fp.mb.s7a}get Hja(){return this.Fp.mb.Hja}get G1e(){return this.h2}get CWd(){return this.Fp.jH&&
!this.FGd}ish(){this.FGd=!0}get p7g(){return!this.Fp.jH}get aba(){return me.a.instance}get yRj(){return this.$a.ka("InternalPasteTableWithReplacingCellIsEnabled")&&P.a.instance.ga(63)||P.a.instance.ga(77)}bQe(a){var b=new oQ.a(-1);this.ZWh.fV.Yqb(b);const c=new tb.GraphIterator;c.set(b);b=this.Ak.me(3);b.Fy(c);c.Cl(a,80);b.dispose()}fXd(a,b=null){a=a.Lb;this.Fp=a.Na.clone();this.FGd=!1;a=tb.GraphIterator.nb(a.ilb);const c=tb.GraphIterator.nb(this.h2),f=this.Ak.me(3);f.Fy(c);a.Bb(82);do a.currentNode.O1a(null);
while(a.Dj(82));a=new Xh.a(b,Object(F.a)(this,this.qti,"clearInternalClipboard"),new qI(a,c,this.Fp,f));a.Pl("InternalCopy");a.Oi=!b||b.Oi;a.run()}qti(a,b){bd.a.mark(5566);b=b.target;if(b.Gi())return b.Mi(),!0;a.Wg(Object(F.a)(this,this.XOc,"executeCopy"));return!0}XOc(a,b){b=new qz(b,null);b=new Xh.a(a,Object(F.a)(this,this.b1b,"coreCopySetup"),b);b.Pl("ExecuteCoreCopyToInternalClipboard");b.run();a.Wg(Object(F.a)(this,this.nyl,"trimNewText"));return!0}b1b(a,b){if(!b.source.Gi())return b.Bg&&(b.Bg.yJc=
null),ia.ULS.shipAssertTag(6305560,307,!1),!1;a.Wg(Object(F.a)(this,this.WIf,"coreCopyIteration"));return!0}WIf(a,b){const c=b.insertAfter,f=b.source,l=b.target,x=f.currentNode;var H=this.p7g;if(!x.Uke)return a.Wg(Object(F.a)(this,this.dLc,"coreCopyIncrement")),!0;b.Bg.Wpd&&(b.Wpd=!0);if(!b.Wpd&&(x.H3b()&&b.J6.Ika.c++,x.H3b()||H&&!x.Nzb(this.Rr)))return a.Wg(Object(F.a)(this,this.dLc,"coreCopyIncrement")),!0;if(!b.Wpd&&H&&!x.Ey)return f.FEa()&&(b.bvd=!0,b=new Xh.a(a,Object(F.a)(this,this.b1b,"coreCopySetup"),
new qz(b,c)),b.Pl("RecursiveCoreCopyToInternalClipboard"),b.run()),a.Wg(Object(F.a)(this,this.dLc,"coreCopyIncrement")),!0;H=l.currentNode.No().zi;H=zm.a(x,H,!0);this.aba.Rnc(b.J6.v$a,H);l.vL(H,c,18===f.parentNode.type?1:f.role);l.Pk(H);b.insertAfter=H;Sb.ParagraphReader.$d(H)&&(this.TJk(a,Object(F.a)(this,this.b1b,"coreCopySetup"),x,H,b),this.SJk(x,H));this.FSf(x,H);f.FEa()&&(ia.ULS.shipAssertTag(6305562,307,!b.bvd),b=new Xh.a(a,Object(F.a)(this,this.b1b,"coreCopySetup"),new qz(b,null)),b.Pl("RecursiveCoreCopyToInternalClipboard"),
b.run());a.Wg(Object(F.a)(this,this.kBi,"coreCopyIterationPostProcessing"));return!0}kBi(a,b){var c=b.source;const f=b.target;var l=f.currentNode,x=c.currentNode;Sb.ParagraphReader.el(f)&&(b.LJe[x.id.toString()]=l);if(P.a.instance.ga(54)&&Sb.ParagraphReader.$d(l)){if(0<Sb.ParagraphReader.w7f(x))if(0<this.EG.G9a(x).UM)x.setValue(ab.a.glc,0);else{var H=this.EG.Iwb(x).UM;Th.paragraphEditor.Av.Hjb(l,H)}if(!this.sab&&this.dqa.ohd){c.zc();if(!od.TableReader.Cs(f)&&c.wzb&&!this.Hja)for(var U of this.dqa.FBk)l.removeProperty(U);
c.Pk(x)}}if(P.a.instance.ga(57)&&Sb.ParagraphReader.$d(l)){H=[];U=[];for(let ja=0;ja<l.wordRunProperties.length;ja++)l.wordRunProperties.EY.$(ja,yI.CharacterPropertiesEditor.ofa),l.wordRunProperties.Afa.$(ja,yI.CharacterPropertiesEditor.nfa),H[ja]=!0,U[ja]=!1;l.we(ab.a.Fdd,H);ia.ULS.shipAssertTag(6305563,307,H.length===l.wordRunProperties.length);ia.ULS.shipAssertTag(6305564,307,P.a.instance.ga(50));ia.ULS.shipAssertTag(6305565,307,!!Oc.App.Ih);P.a.instance.ga(50)&&Oc.App.Ih.rw&&(l.we(Ms.a.Gw,U),
ia.ULS.shipAssertTag(6305566,307,U.length===l.wordRunProperties.length));(this.fd.gg&&this.fd.Uy||P.a.instance.ga(45)&&Oc.App.OD.BOb)&&l.setValue(ab.a.e$b,!0);P.a.instance.ga(14)&&l.fo(ab.a.V2d,ab.a.uBk,ab.a.wBk);P.a.instance.ga(45)&&Sb.ParagraphReader.$d(l)&&l.fo(ab.a.jbb)}this.n7g(f)&&(H=f.currentNode.YG(),l=rd.ImageReader.HTc(f.currentNode.properties,H.zi,!1),H=rd.ImageReader.HTc(f.currentNode.properties,H.zi,!0),U=null,Fb.EmbeddedFileReader.bZc(f)&&(U=Fb.EmbeddedFileReader.sSc(f.currentNode)),
this.X2d(l,x),this.X2d(H,x),this.X2d(U,x));this.p7g&&(this.ESf(f),od.TableReader.aq(f)&&(x=this.Fp.uW(),x.moveNext(),(x=Le.getCellLocation(c,x.current.node))||(x=new nQ.a(0,0)),c=new AI(x,f,od.TableReader.E5i(c),od.TableReader.vhj(c)),this.HD.M1k(c)));fe.OutlineElementReader.Yg(f)&&!f.NI(2)&&(this.Di.Hca(f),f.zc());f.zc();b.Bg&&(b.Bg.yJc=b.insertAfter);a.Wg(Object(F.a)(this,this.dLc,"coreCopyIncrement"));return!0}dLc(a,b){b.bvd&&(b.insertAfter=b.yJc,b.bvd=!1);if(!b.source.CEa()){b.Bg&&(b.Bg.yJc=b.insertAfter);
const c=b.source;11!==c.ri||c.rTc(-1)||this.mKk(a,c.currentNode,b.target.currentNode,b);return!1}a.Wg(Object(F.a)(this,this.WIf,"coreCopyIteration"));return!0}SJk(a,b){a=gf.f(a);gf.f(b);for(b=0;b<a.length;b++)Object(F.a)(this,this.b1b,"coreCopySetup")}nyl(a,b){if(b.bsa>=b.iLb.length)return a.Wg(Object(F.a)(this,this.jBi,"copyTeardown")),!0;a=b.iLb[b.bsa];var c=a.node,f=a.Qa,l=a.Mb;if(!nb.SelectionEditor.Yt(a))if(!b.bsa&&nb.SelectionEditor.Xl(a))l=f=Sb.ParagraphReader.textLength(c);else if(Sb.ParagraphReader.um(a))f=
0,l=Sb.ParagraphReader.textLength(c);else if(nb.SelectionEditor.d9(a)){ia.ULS.shipAssertTag(6305568,307,!b.bsa);var x=tb.GraphIterator.nb(c);f=x.rc(12);ia.ULS.shipAssertTag(6305569,307,f);c=x.origin;l=f=Sb.ParagraphReader.textLength(c)}else{if(gj.OutlineReader.l$b(a))for(a=vx.a.Sz(a.node);a.moveNext();)x=a.currentNode,Sb.ParagraphReader.$d(x)&&Array.add(b.iLb,Wd.a.createTextRange(x,0,Sb.ParagraphReader.textLength(x)));b.bsa++;return!0}x=b.LJe[c.id.toString()];ia.ULS.shipAssertTag(6305570,307,!!x);
if(!x)return ia.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.bsa,["SelectedContextsLength"]:b.iLb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.bsa++,!0;c=gf.f(x);let H,U=!1;for(H=c.length-1;0<=H;H--)if(!c[H].UIc)if(4===c[H].Wq)c[H].He.blob=null,c[H].He.blob=new vv.a(c[H].He,vv.a.BMc),b.J6.Ika.e++;else{c[H].He.blob=null;if(P.a.instance.ga(57)&&-1!==c[H].og){var ja=c[H].He.formatting,ya=void 0,Va=void 0;ja&&-1===ja.og?(Va=c[H].og+1,ya=
c[H].Y$-1,ja.og=c[H].og):(ya=c[H].Y$,Va=c[H].og);for(ja=0;ja<ya;ja++)x.wordRunProperties.removeAt(Va,16);0<ya&&(U=!0)}ya="";cu.f(c[H])?(ya=" ",b.J6.Ika.f++):cu.g(c[H])&&(Va=cu.b(c[H]))&&(ya=cu.a(Va),b.J6.Ika.g++);Va=c[H].He.cp;Va>=f&&Va<l&&(Th.characterPropertiesEditor.replaceTextRange(Wd.a.createTextRange(x,Va,Va+1),ya),l=l-1+ya.length,b.J6.Ika.i++)}U&&x.fv();this.nXk(x);c=Sb.ParagraphReader.textLength(x);l<c&&Th.characterPropertiesEditor.replaceTextRange(Wd.a.createTextRange(x,l,c),"");0<f&&Th.characterPropertiesEditor.replaceTextRange(Wd.a.createTextRange(x,
0,f),"");f=0;l=tb.GraphIterator.nb(x);for(l.Bb(6);!l.fr;)c=l.currentNode,l.Dj(6),rd.ImageReader.iH(c)?rd.ImageReader.qle(c)?(Th.paragraphEditor.rIf(c,Wd.a.Lj(x,f)),f++,b.J6.Ika.d++):(c=tb.GraphIterator.nb(c),c.rc(12),c.Mi(),b.J6.Ika.h++):ia.ULS.shipAssertTag(6305571,307,!1);!Sb.ParagraphReader.textLength(x)&&b.bsa===b.iLb.length-1&&nb.SelectionEditor.Yt(a)&&(a=tb.GraphIterator.nb(x),a.rc(25)&&(Ta.OutlineElementNavigator.Re(a),this.Di.fDa(a),b.bsa&&(this.Fp.mb.Hja=!0)));this.aba.b_a(b.J6.Xgd,b.J6.$6a,
b.J6.fQa,x);b.bsa++;return!0}nXk(a){const b=P.a.instance.ga(14),c=!this.fd.gg&&P.a.instance.ga(45),f=Th.WN,l=a.Ra;if(P.a.instance.ga(57)&&l&&(b||c)){var x=new Ka.a,H=new Ka.a;for(let ja=0;ja<l.length;ja++){const ya=l.ga(ja);if(b){ya.xl&&x.add(ya);if(f){if(ya.Wh){for(var U=0;U<ya.Wh.length;U++)H.add(ya.Wh.ga(U).og);ya.Wh=null}}else ya.fieldRangeEnd&&(H.add(ya.fieldRangeEnd.og),ya.fieldRangeEnd=null),ya.Lo&&(H.add(ya.Lo.og),ya.Lo=null);if(ya.lk){for(U=0;U<ya.lk.length;U++)H.add(ya.lk.ga(U).og);ya.lk=
null}}if(c){if(Oc.App.OD.BOb){ya.formatting&&Th.mh.QJ(ya.formatting);if(ya.hyperlink){for(U=0;U<ya.hyperlink.Y$;U++)H.add(ya.hyperlink.og+U);ya.hyperlink=null}ya.hn=!1}ya.trackedChange=null;ya.$I=!1}}a.oKa(!0,H);for(let ja of x)ja.xl=null;c&&1<l.length&&(a=l.first,a.trackedChange=new lQ.a(a),l.last.$I=!0)}}jBi(a,b){this.h2.O1a(null);b.Jpj.dispose();bd.a.mark(5567);this.rok();this.lN=b.J6;this.kqg("Copy");this.FKj&&ia.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get FKj(){return!tb.GraphIterator.nb(this.h2).Gi()}ZGl(){this.h2=
this.Pqf}YGl(){this.h2=this.fNd}LGl(){this.h2=this.yaf}mFf(){const a=tb.GraphIterator.nb(this.h2);for(;a.Gi();)a.Mi()}kqg(a){const b=this.lN.Ika.b;a+="-"+b;this.lN.Ika.b=a;this.lN.v$a.b=a;this.lN.Xgd.b=a;this.lN.$6a.b=a;this.lN.fQa.b=a;this.aba.R2j(this.lN.Ika);this.aba.ooe(this.lN.v$a);this.aba.Kqg(this.lN.Xgd);this.aba.ioe(this.lN.$6a);this.aba.hoe(this.lN.fQa);this.lN.Ika.b=b;this.lN.v$a.b=b;this.lN.Xgd.b=b;this.lN.$6a.b=b;this.lN.fQa.b=b}u9g(a,b,c,f,l=null,x=null){this.kqg("Paste");b=tb.GraphIterator.nb(b);
const H=tb.GraphIterator.nb(this.h2);var U=null;l&&(U=new Vw.a(gj.OutlineReader.AMc,gj.OutlineReader.RMf),U=l.equals(new Vw.a(-1,-1))?new Vw.a(0,0):l.bV(U));if(this.SXc())if(H.Gi(),rd.ImageReader.iH(H.currentNode))l=H.currentNode,H.zc(),H.vL(this.Di.eYd(),null,1),H.Gi(),H.vL(l,null,2),H.zc(),H.Pk(l),H.Mi(),this.oob.jtk(),this.ish();else if(Fb.EmbeddedFileReader.Jab(H.currentNode)){l=H.currentNode;H.zc();H.vL(this.Di.eYd(),null,1);H.Gi();var ja=this.Di.Hca(H);ja=Wd.a.Lj(ja,0);Th.characterPropertiesEditor.replaceTextRange(ja,
"<<"+Fb.EmbeddedFileReader.tSc(l)+">>");H.zc();H.zc();H.Pk(l);H.Mi();this.ish()}this.yRj&&this.nng(H,b)?(H.currentNode.O1a(null),ia.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.a0k(x,H,b,U,a),ia.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(bd.a.mark(5564),H.currentNode.O1a(null),a={},a[Th.ABj]=f,rb.ListReader.JUa(c)&&this.Sf.Kmc&&(a[zI.a.ufg]=!0),c=new rz(H,b,c,U,a),f=new Xh.a(x,Object(F.a)(this,this.c1b,"corePasteSetup"),
c),f.Pl("ExecuteCorePasteFromInternalClipboard"),f.Oi=!x||x.Oi,this.JJk(c),f.run())}Pmg(a){if(a&&a.isValid){const b=tb.GraphIterator.nb(this.h2);return this.nng(b,a)}return!1}nng(a,b){if(Le.isTableCellOrInside(b)&&1===a.t9a()){a.Bb(1);if(fe.OutlineElementReader.Yg(a)){Ta.OutlineElementNavigator.wi(a);if(od.TableReader.aq(a)){od.TableReader.Ku(a.currentNode)&&ia.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.rc(14)&&!od.TableReader.Ku(Vd.getContainingTable(b)))return ia.ULS.sendTraceTag(19269659,
307,50,"Target table is not a complex table."),!0;ia.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.sab)return!0}Ta.OutlineElementNavigator.Re(a)}a.zc()}return!1}a0k(a,b,c,f,l){c.rc(14);const x=tk.c(c),H=Hn.a(c);c.Jg(14);var U=od.TableReader.sk(c.currentNode);const ja=od.TableReader.Ai(c.currentNode),ya=od.TableReader.sk(b.currentNode),Va=od.TableReader.Ai(b.currentNode);ia.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",
U,ja,ya,Va);this.g3a=Ec.Zwb;if(this.xVj(x+ya,H+Va)){var hb=x+ya-U;0<hb&&(Vd.moveToLastRow(c),ia.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+hb),this.HD.Nee(c,!1,hb,this.g3a),ia.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Jg(14));hb=H+Va-ja;if(0<hb){ia.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+hb);try{this.HD.Reg(c,ja,!1,hb,this.g3a)}catch(yb){throw ia.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",yb.toString()),yb;}ia.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}U=this.F4i(U,ja,ya,Va,x,H);ia.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new Xh.a(this.sab?a:null,Object(F.a)(this,this.GDk,"pasteTableOperationRun"),new sI(null,b,c,f,x,H,U,null,l));a.Pl("ExecuteCorePasteTableInTable");a.Oi=!1;a.run()}}xVj(a,b){if(!this.kkg)return!0;const c={};a>Th.DIc&&(c.rowCount=a,c.c_maxTableRowColCount=Th.DIc);b>Th.DIc&&(c.columnCount=b,c.c_maxTableRowColCount=Th.DIc);const f=a*b;f>Th.JBf&&(c.rowCount=a,c.columnCount=
b,c.cellsCount=f,c.c_maxTableCellCount=Th.JBf);0<tq.a(c).length&&ia.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!tq.a(c).length}GDk(a,b){if(b.QNb){if(b.QNb.inProgress)return!0;Le.isTableCell(b.source)||b.source.Jg(16);this.kkg&&Le.isFirstCellInTable(b.source)&&this.RYb(b.If,b.target.currentNode);if(Le.isLastCellInTable(b.source))return this.tok(Vd.getContainingTable(b.target)),ia.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Le.isTableCell(b.target)||
b.target.Jg(16);const c=!this.sab;Le.isLastCellInRow(b.source)?(Vd.moveToNextRow(b.target),Vd.moveToColumnByIndex(b.target,b.dja),ia.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Vd.moveToNextOrPreviousCell(b.target,!1,c);Vd.moveToNextOrPreviousCell(b.source,!1,c)}else od.TableReader.aq(b.target)||b.target.Jg(14),od.TableReader.aq(b.source)||b.source.Jg(14),Vd.moveToCell(b.target,b.rowIndex,b.dja),Vd.moveToCell(b.source,0,0);for(;b.target.Gi();)b.target.Mi();b.QNb=
new Xh.a(a,b.z9g?b.z9g:Object(F.a)(this,this.c1b,"corePasteSetup"),new rz(b.source,b.target,null,b.Jgd));b.QNb.Pl("ExecuteCorePasteCellContentInCell");b.QNb.Oi=!1;b.QNb.run();return!0}rok(){if(this.sab){for(var a=tb.GraphIterator.nb(this.G1e),b=a.currentNode;14!==a.ri;)if(b=a.Gi(),!b){ia.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.S_g(b)}}tok(a){this.sab&&this.S_g(a)}Jvl(a){const b=tb.GraphIterator.nb(a);this.Tx.S8b(b,
null,!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}S_g(a){if(a&&14===a.type){ia.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=od.TableReader.sk(a),f=od.TableReader.Ai(a),l=tb.GraphIterator.nb(a);Vd.forEachCellInTable(l,(x,H,U)=>{const ja={};x=x.currentNode;if(16===x.type)if(x.isGhostCell)Th.sHf(H,U)in b||(this.Jvl(x),ja.IsGhostCell="->false");else{P.a.instance.ga(77);Th.MSk(a,x,H,U,c,(Va,hb,yb)=>{ja.rowSpan=String.format("{0}:{1}->{2}",Va,hb,yb)});Th.LSk(a,x,U,
H,f,(Va,hb,yb)=>{ja.colSpan=String.format("{0}:{1}->{2}",Va,hb,yb)});const ya=String.format("{0},{1}-{2},{3}",H,U,H+x.rowSpan,U+x.colSpan);for(let Va=0;Va<x.rowSpan;Va++)for(let hb=0;hb<x.colSpan;hb++)if(Va||hb)b[Th.sHf(H+Va,U+hb)]=ya}if(0<tq.a(ja).length){if(void 0===ja.IsGhostCell||null===ja.IsGhostCell){if(void 0===ja.rowSpan||null===ja.rowSpan)ja.rowSpan=x.rowSpan;if(void 0===ja.colSpan||null===ja.colSpan)ja.colSpan=x.colSpan}ia.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",
H,U,ja)}return!0});Th.lPi(b)}}get kkg(){return P.a.instance.ga(77)}get sab(){return!!this.$a&&this.$a.ka("ComplexTableCellPasteWithFormattingIsEnabled")}RYb(a,b){a?(b=tb.GraphIterator.nb(b),b.ZA(1)?(b=b.Bb(2))?(b=Qd.SelectionFactory.Sg(b,0),a.Lb.setSelection(b)):ia.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):ia.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):ia.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}F4i(a,
b,c,f,l,x){const H=[];for(let U=0;U<Math.max(l+c,a);U++){let ja=0,ya=x+f;for(U<l?ja=b:U>=l&&U<Math.min(l+c,a)?ja=x:U>=l+c&&U<a?ja=b:ya=Math.max(x+f,b);ja<ya;ja++)Array.add(H,Array(2)),H[H.length-1][0]=U,H[H.length-1][1]=ja}return H}c1b(a,b){if(!b.source.Gi())return a.Wg(Object(F.a)(this,this.tZa,"pasteTeardown")),!0;a.Wg(Object(F.a)(this,this.XIf,"corePasteIteration"));return!0}j0k(a,b){if(this.sab)if(!b||!a)ia.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});
else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.jkb!==a.jkb&&(b.jkb=a.jkb,c.ShouldRenderCell=b.jkb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",
b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);tq.a(c)}}XIf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.Uke||!l.Psb)return a.Wg(Object(F.a)(this,this.eLc,"corePasteIncrement")),!0;if(this.fd.gg&&fe.OutlineElementReader.Yg(c)){if(!Ta.OutlineElementNavigator.wi(c).Psb)return Ta.OutlineElementNavigator.Re(c),a.Wg(Object(F.a)(this,this.eLc,"corePasteIncrement")),!0;Ta.OutlineElementNavigator.Re(c)}ia.ULS.shipAssertTag(6305608,307,!l.H3b());var x=f.currentNode.No().zi;x=zm.a(l,x,!0);x.Fgb();this.j0k(c,
f);f.vL(x,b.insertAfter,c.role);f.Pk(x);b.insertAfter=x;P.a.instance.ga(50)&&Oc.App.Ih.rw&&Oc.App.Ih.YY.hra(x);this.FSf(l,x);b=new Xh.a(a,Object(F.a)(this,this.c1b,"corePasteSetup"),new rz(c,f,null,b.Jgd,b.fL));b.Pl("RecursiveCorePasteOperation");b.run();a.Wg(Object(F.a)(this,this.oBi,"corePasteIterationPostProcessing"));return!0}sKk(a,b,c){b=gf.f(b);c=gf.f(c);for(let f=b.length-1;0<=f;f--)b[f].FGe(c[f],a,Object(F.a)(this,this.c1b,"corePasteSetup"))}X2d(a,b){a&&(ia.ULS.shipAssertTag(6305610,307,a.Sa(Oh.a.Skc)),
a.Sa(Oh.a.Skc)||a.setValue(Oh.a.Skc,a.sa(Oh.a.E0g,"")),b=(b=mQ.SectionNavigator.b6f(b))?b.fileId:Oc.App.Kb.Kd.ica?Oc.App.Kb.Kd.ica.fileId:null,!a.Sa(Oh.a.fileId)&&b&&a.setValue(Oh.a.fileId,b))}Y2d(a){a&&this.oob.Ebl()}oBi(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;Sb.ParagraphReader.$d(f)&&(this.tKk(a,Object(F.a)(this,this.c1b,"corePasteSetup"),l,f,b),this.sKk(a,l,f));f.o1g();b.fL[zI.a.ufg]&&22===f.type&&f.setValue(ab.a.listID,Number.MAX_VALUE);if(P.a.instance.ga(11)&&Sb.ParagraphReader.$d(f)){var x=
gf.j(f,5);if(0<x.length){for(var H of x)!H.properties.Sa(ab.a.A$g)&&H.properties.Sa(ab.a.y$g)&&H.properties.setValue(ab.a.A$g,H.properties.eb(ab.a.y$g)),rd.ImageReader.mle(H.properties)||this.oob.M5k();f.No().contentReplicator.forceOutbound(null,null,null)}}P.a.instance.ga(25)&&fe.OutlineElementReader.Yg(c)&&this.Di.n4e(c.currentNode);P.a.instance.ga(10)&&gj.OutlineReader.g_c(f)&&(x=mq.b(f),b=b.Jgd,mq.c(f,x.x+b.x,x.y+b.y));if(this.n7g(c)){b=c.currentNode.YG();x=rd.ImageReader.HTc(c.currentNode.properties,
b.zi,!1);H=rd.ImageReader.HTc(c.currentNode.properties,b.zi,!0);let U=null;Fb.EmbeddedFileReader.bZc(c)&&(U=Fb.EmbeddedFileReader.sSc(c.currentNode));this.Y2d(x);this.Y2d(H);this.Y2d(U);if(x||H||U)b.KQj=!0,b.LQj=!0}P.a.instance.ga(24)&&Fb.EmbeddedFileReader.bZc(c)&&(b=c.currentNode,Fb.EmbeddedFileReader.fNj(c)?(c.zc(),x=this.Tx.pFi(),x.setValue($a.a.eJ,Th.Jk.isRtl(b)?11:9),H=mq.b(f),mq.c(x,H.x,H.y),c.vL(x,b,1),c.Pk(b),c.VOf(),this.Tx.LZ(c,!1)):c.Mi(),x=this.Di.Hca(c),x=Wd.a.Lj(x,0),Th.characterPropertiesEditor.replaceTextRange(x,
"<<"+Fb.EmbeddedFileReader.tSc(b)+">>"));this.ESf(c);this.YFl(l,f);c.zc();a.Wg(Object(F.a)(this,this.eLc,"corePasteIncrement"));return!0}n7g(a){return P.a.instance.ga(1)&&rd.ImageReader.T9b(a)||P.a.instance.ga(24)&&Fb.EmbeddedFileReader.bZc(a)}YFl(a,b){if(this.fd.gg&&od.TableReader.qbb(a)){let c=0;const f=od.TableReader.sk(a);for(let l of od.TableReader.VTc(a,0,f-1))l.Htc&&c++;a=this.Ak.me(4);a.kd(b);b.properties.setValue($a.a.iza,f-c);a.dispose()}}eLc(a,b){if(!b.source.CEa())return a.Wg(Object(F.a)(this,
this.tZa,"pasteTeardown")),!0;a.Wg(Object(F.a)(this,this.XIf,"corePasteIteration"));return!0}tZa(){bd.a.mark(5565);return!1}Qdd(){return!tb.GraphIterator.nb(this.h2).Gi()}SXc(){return this.CWd?1===tb.GraphIterator.nb(this.h2).t9a():!1}gHj(){const a=tb.GraphIterator.nb(this.h2);this.SXc()&&a.Gi();return 1===a.t9a()&&(a.Gi(),fe.OutlineElementReader.Yg(a)&&1===a.t9a()&&a.Bb(2))?Sb.ParagraphReader.el(a)&&!Th.SH.VHf(a):!1}d5i(){const a=tb.GraphIterator.nb(this.h2);this.SXc()&&a.Gi();a.Gi();a.Gi();ia.ULS.shipAssertTag(6305614,
307,Sb.ParagraphReader.el(a));return Sb.ParagraphReader.text(a.currentNode)}p0f(a){try{return this.A6i(a)}catch(b){return ia.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}A6i(a){let b=0;if(a&&(b=this.z6i(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.p0f(a.childNodes[c]),0===b);c++);return b}z6i(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.u_h))return b.startsWith(this.HWb)?
this.Rr&&b===this.HWb+this.Rr?3:2:1}return 0}TJk(a,b,c,f,l){l.fL||(l.fL={});Th.Pa.raiseEvent("OnParagraphCopy",new sz(a,b,c,f,l.fL))}mKk(a,b,c,f){f.fL||(f.fL={});Th.Pa.raiseEvent("OnCopyComplete",new sz(a,null,b,c,f.fL))}JJk(a){a.fL||(a.fL={});Th.Pa.raiseEvent("BeforePaste",new rI(a.fL))}tKk(a,b,c,f,l){Th.Pa.raiseEvent("OnParagraphPaste",new sz(a,b,c,f,l.fL))}ESf(a){Le.isTableCell(a)&&(a.Bb(1)||this.Tx.LZ(a,!0),a.zc())}FSf(a,b){this.MLd.isTableCellNode(b)&&(b.width=a.width)}static get mh(){return Th.Kf||
(Th.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Th.fh||(Th.fh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Th.Vw||(Th.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}static get WN(){const a=Db.a.instance.ub("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get SH(){return Zl.a.instance}static get Jk(){return Uw.PageReader.instance}static lPi(a){const b={};for(const c of tq.a(a)){const f=
a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=tq.a(b).length&&ia.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static LSk(a,b,c,f,l,x){b.colSpan>l-c&&(x&&x("A",b.colSpan,l-c),b.colSpan=l-c);a=Th.Wml(a,b,f,c);b.colSpan!==a&&(x&&x("B",b.colSpan,a),b.colSpan=a)}static MSk(a,b,c,f,l,x){b.rowSpan>l-c&&(x&&x("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Th.Xml(a,b,c,f);b.rowSpan!==a&&(x&&x("B",b.rowSpan,a),b.rowSpan=a)}static Wml(a,b,c,f){return Th.owh(a,b.colSpan,(l,x)=>{Vd.moveToCell(l,
c,f+x)})}static Xml(a,b,c,f){return Th.owh(a,b.rowSpan,(l,x)=>{Vd.moveToCell(l,c+x,f)})}static owh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");for(let l=1;l<b;l++){var f=tb.GraphIterator.nb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static sHf(a,b){return a+","+b}}Th.Pa=new wc.a;Th.Kf=null;Th.fh=null;Th.Vw=null;Th.DIc=50;Th.JBf=1225;Th.ABj="PasteConstrainingWidth";Object(m.a)(Th,"InternalClipboard",
null,[]);class BI extends Dj{constructor(a,b,c,f,l,x){super(a,b,c,l);this.es=f;this.mFd=x}get xhl(){return u.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get ph(){return this.mFd.value}get Qdd(){return this.es.Qdd()}get T9g(){const a=this.es;return a.CWd&&!a.SXc()}uTf(a,b){ia.ULS.shipAssertTag(6305616,307,gj.OutlineReader.Zt(a));const c=mq.b(a.currentNode);if(gj.OutlineReader.isEmpty(a)){var f=Wd.a.create(a.currentNode);a.IB(8);u.AFrameworkApplication.Ta.mi(f,D.a.$K,2,!0,null,null)}else a.IB(8);
(f=a.ZA(1))&&a.zc();this.es.u9g(this.Bg.If,a.currentNode,f,-1,c,b)}get lhg(){return this.es.gHj()}get ZHf(){return this.es.d5i()}tTf(a){const b=new tb.GraphIterator;this.Ghb.restore(b);ia.ULS.shipAssertTag(6305618,307,fe.OutlineElementReader.Yg(b));this.Bg.W0&&this.Bg.W0.tHc("internal");let c=-1;if(this.Lth&&Object(Xa.a)(10,this.Bg.rd))c=this.Bg.rd.sa(Ms.a.Y2b,-1);else if(this.xhl){const f=this.q7i(b.currentNode);c=f?f.clientWidth:c}this.es.u9g(this.Bg.If,b.parentNode,b.currentNode,c,null,a);this.Zjg&&
(this.Ghb.restore(b),fe.OutlineElementReader.Yg(b)&&this.es.Pmg(b)&&(a=Ta.OutlineElementNavigator.wi(b)))&&(this.Bg.Usa=Qd.SelectionFactory.Sg(a,0))}q7i(a){return a?(a=a?a.sc(this.ph.Ma):null)?a.htmlElement:null:null}Auh(){const a=new tb.GraphIterator;this.Ghb.restore(a);return this.es.Pmg(a)}get Yth(){return rb.ListReader.nx}get Xth(){return!this.es.Hja&&!this.es.CWd}}Object(m.a)(BI,"InternalPasteExecutionManager",Dj,[]);class CI{constructor(a,b){this.es=a;this.mFd=b}create(a,b,c){return new BI(a,
b,c,this.es,Oc.App.Kb.Kd,this.mFd)}}Object(m.a)(CI,"Factory",null,[385]);var tz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(tz||(tz={}));Object(m.b)("CopySource",tz);class Zr{constructor(a,b,c){this.es=a;this.gef=b;this.ZQh=c}nDk(a,b,c){ia.ULS.shipAssertTag(6305620,307,!!a);ia.ULS.shipAssertTag(6305621,307,nb.SelectionEditor.Tg(b));ia.ULS.shipAssertTag(6305622,
307,!!c);ia.ULS.shipAssertTag(6305623,307,Object(Xa.a)(Xo,c.G5));const f=c.G5;f.OQa=this.es.p0f(a);this.Q2j(a,f);const l=this.fke(a,b,f);if(l||this.wXe(a,b,f)){var x=new pf.GraphTransaction(7);x.kd(b.node);b.node.YG().graphTransactionOperations.Mia(8);l?(ia.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.ks,f.browserName),a=this.gef.create(b,f,x)):(ia.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.ks,f.OQa,f.browserName),Zr.J2j(a),
a=this.ZQh.create(a,b,f,x));c=new Xh.a(c,Object(F.a)(a,a.C9g,"pasteSetup"),null);c.Pl("Paste");c.run()}else f.Usa=Qd.SelectionFactory.Du(b)}fke(a,b,c){return!this.Tkg(c)&&3===c.OQa}wXe(){return!0}Tkg(a){return 1===(a.ks&8192?1:0)}wfg(a,b){ia.ULS.shipAssertTag(6305624,307,nb.SelectionEditor.Tg(a));ia.ULS.shipAssertTag(6305625,307,!!b);ia.ULS.shipAssertTag(6305626,307,Object(Xa.a)(Xo,b.G5));const c=new pf.GraphTransaction(7);c.kd(a.node);a=this.gef.create(a,b.G5,c);b=new Xh.a(b,Object(F.a)(a,a.C9g,
"pasteSetup"),null);b.Pl("InternalPasteAtIp");b.run()}Q2j(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),ia.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",tz[b.OQa],c,f)}}static J2j(a){a&&Zr.q3h.test(a.innerText)&&
ia.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Zr.q3h=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(Zr,"PasteCoordinator",null,[]);class yC{constructor(a,b){this.ik=a;this.W6=b}}Object(m.a)(yC,"PasteFloatieFeatureSetBuilder",null,[]);class go{constructor(a,b){this.ERb=a;this.zOh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get XXf(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get sMc(){return CommonUIStrings.l_ClipboardCut}get sDe(){return CommonUIStrings.l_ClipboardCut_Mac}get cLc(){return CommonUIStrings.l_ClipboardCopy}get rDe(){return CommonUIStrings.l_ClipboardCopy_Mac}get yJa(){return CommonUIStrings.l_ClipboardPaste}get tDe(){return CommonUIStrings.l_ClipboardPaste_Mac}get L5(){return CommonUIStrings.l_ClipboardPasteText}get uDe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get vVd(){return this.zOh}get OFf(){return CommonUIStrings.l_ClipboardExtensionLink}get AQa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}XTf(){ia.ULS.sendTraceTag(8716421,
307,50,null);Od.a.vn(this.vVd,"_blank",void 0,"ClipboardAccessExtensionLink")}m1(a,b){let c=B.a.vk;u.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=B.a.Ni||c);return c?String.format(b,"\u2318"):a}dispose(){this.ERb=null}pPe(a){this.QIf(a)}JZj(a){this.QIf(a)}QIf(a){this.ERb&&this.ERb(a)}}go.id="CopyPasteShortcutDialog";go.oBh="CopyPasteText";Object(m.a)(go,"ACopyPasteShortcutDialog",null,[106]);class DI extends go{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=go.oBh;var f=document.createElement("span");f.innerText=this.XXf;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.m1(this.sMc,this.sDe);const x=document.createElement("span");x.className="UIFontBold";x.innerText=this.m1(this.cLc,this.rDe);const H=document.createElement("span");H.className="UIFontBold";H.innerText=this.m1(this.yJa,this.tDe);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(x);b.appendChild(H);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(B.a.Tj||B.a.eg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.m1(this.L5,this.uDe),b.appendChild(c));a.appendChild(b);this.vVd?(ia.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.OFf,Id.a.addHandler(b,"click",Object(F.a)(this,this.XTf,"extensionLinkHandler")),c.appendChild(b),l=this.AQa.indexOf("{0}"),
-1!==l&&(f=this.AQa.substring(l+3,this.AQa.length),l=document.createTextNode(this.AQa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):ia.ULS.sendTraceTag(8716422,307,50,null);c=new jj.StandardDialog;c.xd=0;c.hg=go.id;c.Gx(this.titleText,null,0,Object(F.a)(this,this.JZj,"legacyCopyPasteShortcutDialogHandler"),a);c.c6(go.oBh)}}Object(m.a)(DI,"CopyPasteShortcutDialog",go,[]);class EI extends go{constructor(a,
b){super(a,b);b={};a=this.cHj;b.extensionStartText=this.qUi;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.Bgl;b.cutText=this.m1(this.sMc,this.sDe);b.copyText=this.m1(this.cLc,this.rDe);b.pasteText=this.m1(this.yJa,this.tDe);4!==u.AFrameworkApplication.Aa.hb.Uk&&(b.pasteTextOnly=this.m1(this.L5,this.uDe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new Zh.a(!1,!1,!0);c.hg="CopyPasteInstallDialog";c.xd=0;c.Xe(1,this.bHj);c.xya(1);c.Zi(a,Object(F.a)(this,
this.pPe,"reactCopyPasteShortcutDialogHandler"),b)}get Bgl(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get bHj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get cHj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get qUi(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(m.a)(EI,"ReactCopyPasteInstallDialog",go,[]);class FI extends go{constructor(a){super(a,null);this.fpg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.eok;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.bJi;b.copyText=this.$Ai;b.pasteText=this.wDk;b.cutShortcutText=this.m1(this.cJi,this.ejk);b.copyShortcutText=this.m1(this.hBi,this.djk);b.pasteShortcutText=this.m1(this.CDk,this.gjk);b.imageSrc=rn.a.XK("NoClipboardAccessDialogImage.svg");b.imageAltText=this.MEa;b.primaryButtonLabel=this.MIb;this.fpg&&(ia.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.tVa,["onExecute"]:()=>{this.GZj()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new Zh.a(!1,!1,!0);c.xd=0;c.hg="CopyPasteNoClipboardAccessDialog";c.Zi(a,Object(F.a)(this,this.pPe,"reactCopyPasteShortcutDialogHandler"),b)}get eok(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get tVa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get MEa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get MIb(){return CommonUIStrings.l_DialogOk}get bJi(){return CommonUIStrings.l_CutString}get cJi(){return CommonUIStrings.l_CutShortcut}get ejk(){return CommonUIStrings.l_CutShortcut_Mac}get $Ai(){return CommonUIStrings.l_CopyString}get hBi(){return CommonUIStrings.l_CopyShortcut}get djk(){return CommonUIStrings.l_CopyShortcut_Mac}get wDk(){return CommonUIStrings.l_PasteString}get CDk(){return CommonUIStrings.l_PasteShortcut}get gjk(){return CommonUIStrings.l_PasteShortcut_Mac}GZj(){ia.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Od.a.vn(this.fpg,"_blank",void 0,"learnMoreLink")}}Object(m.a)(FI,"ReactCopyPasteNoClipboardAccessDialog",go,[]);class GI extends go{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.XXf;a.cutText=this.m1(this.sMc,this.sDe);a.copyText=this.m1(this.cLc,this.rDe);a.pasteText=this.m1(this.yJa,this.tDe);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(B.a.Tj||B.a.eg)&&(a.pasteTextOnly=this.m1(this.L5,this.uDe));this.vVd?(ia.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.OFf,["onExecute"]:f=>{this.XTf(f)}},c=this.AQa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.AQa.substring(0,c),a.suggestionSuffixElement=this.AQa.substring(c+3,this.AQa.length))):ia.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:go.id,["bodyControls"]:a};a=new Zh.a(!1,!1,!0);a.xd=0;a.hg=go.id;a.Zi(this.titleText,Object(F.a)(this,this.pPe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(m.a)(GI,"ReactCopyPasteShortcutDialog",
go,[]);class uq{constructor(){this.iqa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.GC}Utb(a,b,c=!1,f=!1){ia.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.iqa,c));f?new FI(a):this.iqa?c?new EI(a,b):new GI(a,b,u.AFrameworkApplication.fa):new DI(a,b,u.AFrameworkApplication.fa)}static get instance(){return uq.Ka||(uq.Ka=new uq)}}uq.Ka=null;Object(m.a)(uq,"CopyPasteShortcutDialogFactory",null,[546]);class HI{constructor(a,b,c,f,l,
x,H){this.dff=this.nLd=!1;this.lXb=a;this.Lf=b;this.mia=c;this.Nd=f;this.nd=l;this.uf=x;this.zd=H}get KM(){return this.lXb}get pFa(){return this.dff}set pFa(a){this.dff=a;this.uf.BWc=a}Wca(a){this.KM.Wca(a);a||this.NLa(!0)}Z6a(a){this.KM.Z6a(a)}get sSi(){return this.KM.X5}get ZRi(){return this.KM.iy}prepareForPaste(a){this.pFa=!0;this.KM.prepareForPaste(a,!1,this.Q0e)}ida(a,b){this.KM.ida(a,!1,b)}reset(){this.pFa=!1}paste(){var a=this.Lf.Pd;a&&this.Nd.tf(a.DI);var b=this.mia.MK;if(!b.Mh||!b.editingView.Wl)return null;
a=b.editingView;let c=this.nd.qm();this.pFa=!0;b.Kza();b=null;try{a.FIk(),b=c=this.KM.v8a(this.Q0e,c)}catch(f){ia.ULS.shipAssertTag(6305672,307,!1),this.l7b(!0)}this.pFa=!1;return b}copy(){var a=this.Lf.Pd;a&&this.Nd.tf(a.DI);a=this.mia.MK;if(!a.Mh||1!==a.editingView.mode)return!1;this.pFa=!0;let b;try{this.KM.YOc(this.Q0e),b=!0}catch(c){ia.ULS.shipAssertTag(6305673,307,B.a.eg),ia.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",B.a.Sy),b=!1}this.pFa=
!1;return b?!0:!1}NLa(a){if(this.nLd)return!0;var b=this.mia.MK;if(!b.Mh||!b.editingView.Wl)return!1;const c=b.editingView;b=this.nd.qm();this.pFa=!0;const f=new Eg.a(b);let l=!1;try{l=this.KM.NLa(b,()=>{c.Cti()},()=>{c.IKa()})}catch(x){ia.ULS.shipAssertTag(6305674,307,!B.a.Ej)}f.restore();this.pFa=!1;l?this.nLd=!0:(ia.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",B.a.Sy),B.a.Ej||this.l7b(a));return l}l7b(){this.nLd=!1;if(u.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)uq.instance.Utb(null,
null);else{const a=new jj.StandardDialog;a.xd=0;a.fP(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get Q0e(){const a=this.nd.aEa();return a?a.Tl:null}}Object(m.a)(HI,"SystemClipboard",null,[372]);class zC{constructor(a){this.nmb=2147483647;this.VQb=null;this.Om=0;this.kDg=!0;this.cjf=window.navigator.clipboard;this.djf=window.navigator.permissions;this.rS=a}getData(a,b){ia.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.VQb){var c=this.e5i(this.VQb,
a);c?this.VQb[0].getType(c).then(f=>{"image/png"===c?this.rS.U0b([f],l=>{this.MHe(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.$Yi(l):l;ia.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.mX(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.mX(!1,"getDataFailed");b(a,null)}):(this.mX(!1,"unSupportedType"),b(a,null))}else this.mX(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.mX(!1,"getDataFailed"),b(a,null)}}e5i(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}MHe(a,b,c){a&&this.rS.$qc&&(a=String.format('<img src="{0}">',a));ia.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}$Yi(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}s3e(a,b,c){this.VQb=b;a(c)}Ltd(a){try{this.VQb=null,this.cjf.read().then(b=>{let c;this.Om&&(c=Date.now()-this.Om,ia.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.mX(!0,"none");this.s3e(a,b,!0)},()=>{this.mX(!1,"clipboardReadFailed");this.s3e(a,null,!1)}).catch(()=>{this.mX(!1,"clipboardReadFailed");this.s3e(a,null,!1)})}catch(b){this.mX(!1,"clipboardReadNotSupported"),a(!1)}}xEf(a,
b){this.kDg=a?!0:!1;if(this.cjf)if(this.djf)try{this.djf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.Om=Date.now(),this.Ltd(b)):"prompt"===c&&a?this.Ltd(b):(this.mX(!1,"permissionDenied"),b(!1))):(this.mX(!1,"invalidPermissionStatus"),b(!1))},()=>{this.mX(!1,"permissionQueryFailed");a?this.Ltd(b):b(!1)}).catch(()=>{this.mX(!1,"permissionQueryFailed");b(!1)})}catch(c){this.mX(!1,"permissionQueryNotSupported"),b(!1)}else this.mX(!1,"navigatorPermissionNotSupported"),a&&
this.Ltd(b);else this.mX(!1,"navigatorClipboardNotSupported"),b(!1)}mX(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.kDg;"none"!==b&&(c.AsyncAPIFailureReason=b);ia.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(m.a)(zC,"AsyncClipboardAPI",null,[]);class uz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(m.a)(uz,"ExtensionClipboardData",null,[]);class II{constructor(a,b,c,f){this.v2=
this.Nz=this.dhf=this.Lpa=null;this.ywc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.lSh=a.Ga("ChromeClipboardAccessExtensionLink");this.tNa=b;this.ik=c;this.dXh=a.Ga("ChromeClipboardAccessExtensionId");this.rS=f;this.b2=new zC(this.rS);this.jSb=null;this.Zaf=a.ka("EnhancedTextCCPEnabled");this.sef=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}Wca(a){a?this.Nz=!0:(this.v2=
this.Nz=null,chrome.runtime&&chrome.runtime.sendMessage?(this.jSb=this.tNa.wSc(),this.tNa.Hya?this.mEf(!0,null):(this.Nz=!0,ia.ULS.sendTraceTag(19256732,307,50,ka.a.create().toString()))):this.b2?this.itb(!0,null):(this.bLe(),this.Nz=!1))}Z6a(a){this.v2=this.Nz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.jSb=this.tNa.wSc(),this.tNa.Hya?this.mEf(!1,a):(this.Nz=!0,ia.ULS.sendTraceTag(19256732,307,50,ka.a.create().toString()),a(this.X5))):this.b2?this.itb(!1,a):(this.Nz=!1,a(this.X5))}get X5(){return this.Nz}get iy(){return this.v2}NLa(){return!0}YOc(a){ia.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");Od.a.u8a(a,"copy")||ia.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}v8a(a,b){this.Lpa&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Lpa,b=a.body,this.Lpa=null);return b}t7i(a){var b=this.ik.V5f(a.html);if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}G0f(a,b){const c=ka.a.create();this.dhf=c;this.tNa.Hya?
ia.ULS.sendTraceTag(7377737,307,50,c.toString()):ia.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.jSb,f,l=>{c.equals(this.dhf)?this.Lpa=this.Zaf?this.t7i(l):l:ia.ULS.sendTraceTag(7385868,307,50,null);ia.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.hPi(),this.tNa.Hya?ia.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):ia.ULS.sendTraceTag(19256737,307,
10,chrome.runtime.lastError.message));a(l)}):(ia.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},f=(l,x)=>{this.Lpa=x;a(!0)};null!=this.iy&&this.iy?this.b2.getData(b?"image/png":null,f):this.G0f(c,this.Zaf?"getClipboardData":"paste")}ida(a,b,c){a=(f,l)=>{const x=new uz;"image/png"==f?x.img=l:x.html=l;c(x)};null!=this.iy&&this.iy?this.b2.getData(b?"image/png":null,a):this.G0f(c,"getClipboardData")}bLe(){ia.ULS.sendTraceTag(8716423,
307,50,null);uq.instance.Utb(Object(F.a)(this,this.lGk,"popupInstallDialogHandler"),this.ywc?this.lSh+this.jSb:null)}lGk(a){1===a?ia.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.ywc)):0===a&&ia.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.ywc))}iGk(){ia.ULS.sendTraceTag(509666773,307,50,null);uq.instance.Utb(Object(F.a)(this,this.jGk,"popupClipboardAccessDialogHandler"),null,!1,!0)}jGk(){ia.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",
this.ywc))}hPi(){this.tNa.lSe();this.bLe()}Roh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(ia.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}itb(a,b){ia.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.b2.xEf(a,c=>{this.v2=c;this.Nz=this.iy;a&&this.Ckl();b&&b(this.X5)})}Ckl(){null==this.iy||this.iy||this.iGk()}mEf(a,b){const c=ka.a.create();ia.ULS.sendTraceTag(7726105,
307,50,c.toString());this.Roh(this.jSb,f=>{ia.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.Nz=!0:(f?"ping"!==f&&ia.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):ia.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.b2?this.itb(a,b):(a&&this.bLe(),this.Nz=!1));b&&b(this.X5)})}zqg(a,
b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;ia.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}e2j(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.tNa.Hya;this.Roh(this.dXh,b=>{this.zqg(a,!!b)})}else this.zqg(!1,!1)}}Object(m.a)(II,"ChromeSystemClipboardAccessManager",null,[371]);class JI{constructor(a,b,c,f){this.v2=this.Nz=this.CEc=this.Lpa=this.b2=null;this.zd=a;this.$a=b;this.m8e=!this.$a.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.$a.ka("BlockCopyCutOnFirefoxIsEnabled");this.rS=c;this.ik=f;this.SFd=b.Bc("ClipboardDataImageBlobLimitaton",10);B.a.c0e||(this.b2=new zC(this.rS))}Wca(a){this.m8e&&a&&this.zd.eg?(uq.instance.Utb(null,null),this.Nz=!1):(this.Nz=!0,this.v2=!1,this.b2&&(this.v2=this.Nz=null,this.itb(!0,null)))}Z6a(a){this.m8e&&this.zd.eg&&(this.Nz=!1,a(this.X5));this.Nz=!0;this.v2=!1;this.b2?(this.v2=this.Nz=null,this.itb(!1,a)):a(this.X5)}itb(a,b){ia.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");
this.b2.xEf(a,c=>{this.v2=c;this.Nz=this.iy;a&&this.Zjl();b&&b(this.X5)})}Zjl(){null==this.iy||this.iy||this.hGk()}hGk(){uq.instance.Utb(null,null)}get X5(){return this.Nz}get iy(){return this.v2}YOc(a){Od.a.u8a(a,"copy")}v8a(a,b){if(this.Lpa&&null!=this.iy&&this.iy)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.Lpa,b=a.body,this.Lpa=null,b;const c=Date.now(),f=Od.a.u8a(a,"paste");b&&""===b.innerHTML&&(this.a5i(a),b.innerHTML=this.CEc?this.CEc:"",this.CEc="");ia.ULS.sendTraceTag(512356673,
307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}a5i(a){const b=c=>{if(c){c=c.clipboardData;const f=this.ik.C5b(c);this.CEc=f&&""!==f?f:this.ik.e9d(c)}};window.addEventListener("paste",b,!1);Od.a.u8a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.Lpa=l;a(!0)};null!=this.iy&&this.iy?this.b2.getData(b?"image/png":null,c):a(!1)}ida(a,b,c){if(c){var f=(l,x)=>{const H=new uz;"image/png"==l?H.img=x:H.html=x;c(H)};null!=this.iy&&
this.iy?this.b2.getData(null,f):B.a.c0e&&this.b5i(a,b,c)}else ia.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}b5i(a,b,c){ia.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;Ca.a.Au(a.body);try{const f=l=>{const x=new uz;l=l.clipboardData;if(b){var H=null;({v8b:H}=this.ik.Etd(l,this.SFd,this.rS.Fic));H&&0<H.length&&(x.isImageAvailable=!0)}else H=this.ik.getData(l,"ppt/slides"),x.pptSlide=H,H&&""!==H||(l=(H=this.ik.C5b(l))&&
""!==H?H:this.ik.e9d(l),x.html=l);c(x)};a.addEventListener("paste",f,!1);Od.a.u8a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){ia.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}NLa(a,b,c){if(this.zd.wT&&!this.$a.ka("ElectronClipboardAccessFix"))return this.Nz=!1;b();c();a=this.v8a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=Ug.a.create().toString();c();a=this.v8a(a.ownerDocument,a);a=b===a.innerHTML;
this.b2?a&&(this.Nz=!0):this.Nz=a;return a}}Object(m.a)(JI,"DefaultSystemClipboardAccessManager",null,[371]);class KI{constructor(a,b,c,f){this.v2=this.Nz=this.HV=this.qpb=this.u7=this.TAa=this.Bwc=null;this.ik=b;this.rS=c;this.SFd=a.Bc("ClipboardDataImageBlobLimitaton",10);this.JTh=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.uQh=f;this.$_h=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Wca(a){this.$_h&&a&&(this.Nz=!0);this.v2=!1}Z6a(a){a(!0)}get X5(){return this.Nz}get iy(){return this.v2}YOc(a){a&&
Od.a.u8a(a,ta.a.copy)}v8a(a,b){this.TAa&&(b=this.TAa,this.TAa=null);return b}ida(a,b,c){c?c(null):ia.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.Bwc=a;this.qpb=c;$addHandler(this.qpb,ta.a.paste,Object(F.a)(this,this.T4g,"onPasteEvent"));this.HV=this.u7=null;this.JTh&&this.uQh.A3b();if(this.Mtd(this.qpb)){if(this.HV&&0<this.HV.length&&(!this.u7||this.ik.cvd(this.u7))){this.rS.U0b(this.HV,Object(F.a)(this,this.MHe,"onImageConverted"));
this.TAa&&!this.TAa.hasChildNodes()&&ia.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.u7&&this.u7.innerHTML&&((this.TAa=this.Gcg(this.u7.innerHTML))&&!this.TAa.hasChildNodes()&&ia.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Ca.a.Au(this.u7))}this.oWf()}else a&&a(!1)}NLa(a){return this.Nz=a=this.Mtd(a.ownerDocument)}T4g(a){try{a&&a.rawEvent&&((this.u7=a.rawEvent.target)&&this.u7.id&&-1<this.u7.id.indexOf("Paste")?(ia.ULS.sendTraceTag(40690080,
307,15,"The pasted target element of paste event: "+this.u7.id),this.u7=null):this.HV=this.daj(a.rawEvent))}catch(b){ia.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}MHe(a){a&&(this.rS.$qc&&(a=String.format('<img src="{0}">',a)),this.TAa=this.Gcg(a));this.oWf()}oWf(){this.qpb&&($removeHandler(this.qpb,ta.a.paste,Object(F.a)(this,this.T4g,"onPasteEvent")),this.qpb=null);this.Bwc&&(this.Bwc(!1),this.Bwc=null)}daj(a){let b=null;(a=this.ik.V5d(a))&&
({v8b:b}=this.ik.Etd(a,this.SFd,this.rS.Fic));return b}Mtd(a){return Od.a.u8a(a,ta.a.paste)}Gcg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(m.a)(KI,"EdgeSystemClipboardAccessManager",null,[371]);class LI{constructor(a,b,c,f){this.$a=a;this.wOh=b;this.ik=c;this.zd=f}create(){var a=null;a=this.zd.wT&&this.$a.ka("ElectronClipboardAccessFix"),u.AFrameworkApplication.mqd()&&this.zd.Tj&&window.chrome&&!a?(ia.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),
a=new II(this.$a,this.wOh,this.ik,Db.a.instance.resolve("Box4.IProcessImageStrategy")),this.$a.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.e2j()):this.$a.ka("EdgeContextMenuPasteFixIsEnabled")&&this.zd.vo?(ia.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new KI(this.$a,Db.a.instance.resolve("Box4.IClipboardDataHelper"),Db.a.instance.resolve("Box4.IProcessImageStrategy"),Db.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(ia.ULS.sendTraceTag(7377744,
307,50,"DefaultSystemClipboardAccessManager"),a=new JI(this.zd,this.$a,Db.a.instance.resolve("Box4.IProcessImageStrategy"),this.ik));return a}}Object(m.a)(LI,"SystemClipboardAccessManagerFactory",null,[370]);class MI{gTf(a){return a}}Object(m.a)(MI,"DeleteTableSegmentStrategy",null,[374]);var pQ=d(1211),qQ=d(638);class vq{constructor(a,b){this.Yk=new J.DictionaryPropertySet;this.xDd=!1;this.iia=this.Vha=this.B2a=null;this.FV=a;this.ERh=b}get c1a(){return this.iia||(this.iia=Db.a.instance.ub("Box4.ITextFormattingCommands"))}get mh(){return vq.Kf||
(vq.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}u_a(){this.xDd||(this.Yk.xQe(),this.B2a=null,this.XWk())}gBi(a){a=gc.a.xs(a);if(!a.cache.ht){var b=a.Vz;if(b){var c=new J.DictionaryPropertySet;c.$x(b);c.$x(this.Yk);c.Sa(dh.a.V2)&&(this.B2a=a.paragraph.Fh);this.Yk=c}}}Sa(a){return this.Yk.Sa(a)}$be(){return 0<this.Yk.f2}get oab(){return this.Yk}freeze(){this.xDd=!0}F1e(){this.xDd=!1}JI(a,b){return this.oab.sa(a,b)}Pq(a){this.Yk.setValue($a.a.fontSize,this.mh.J0b(a));this.IR()}fontSize(){return this.Yk.sa($a.a.fontSize,
Kd.Font.wI)}Fod(a){this.Yk.setValue($a.a.font,a);this.ERh.Fod(this.Yk,a);this.FV&&this.FV.enabled&&($e.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.FV.cOl(this.Yk,a));this.IR()}fLa(a){this.Yk.setValue(ab.a.hV,a);this.FV&&this.FV.enabled&&($e.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.FV.gOl(this.Yk,a));this.IR()}Sr(a){a=qQ.a.instance.MVd(qd.a.instance.Na.mb.Ua.node,a);this.Yk.setValue($a.a.fontColor,a);this.IR()}nW(){this.Yk.setValue($a.a.fontColor,
Ib.a.auto);this.IR()}fontColor(){return this.Yk.sa($a.a.fontColor,Ib.a.nil)}Coa(a){this.Yk.setValue($a.a.highlight,parseInt(a,16));this.IR()}X_b(){this.Yk.setValue($a.a.highlight,Ib.a.auto);this.IR()}isBold(){return this.Yk.sa($a.a.bold,!1)}MH(a){this.Yk.setValue($a.a.bold,a);this.IR()}isItalic(){return this.Yk.sa($a.a.italic,!1)}setItalic(a){this.Yk.setValue($a.a.italic,a);this.IR()}iE(){return this.Yk.sa($a.a.underline,!1)}LY(a){this.Yk.setValue($a.a.underline,a);this.Yk.setValue($a.a.Ow,a?Kd.Font.eud:
Kd.Font.pV);this.IR()}Ow(){return this.Yk.sa($a.a.Ow,Kd.Font.pV)}Joa(a){a<Kd.Font.eud||a>Kd.Font.pV||(this.Yk.setValue($a.a.underline,a!==Kd.Font.pV),this.Yk.setValue($a.a.Ow,a),this.IR())}isSuperscript(){return this.Yk.sa($a.a.superscript,!1)}KY(a){this.Yk.setValue($a.a.superscript,a);a&&this.isSuperscript()&&this.Yk.setValue($a.a.subscript,!1);this.IR()}QF(){return this.Yk.sa($a.a.subscript,!1)}e6(a){this.Yk.setValue($a.a.subscript,a);a&&this.QF()&&this.Yk.setValue($a.a.superscript,!1);this.IR()}PF(){return this.Yk.sa($a.a.strikethrough,
!1)}IY(a){this.Yk.setValue($a.a.strikethrough,a);this.IR()}A_(){return this.Yk.sa(dh.a.Zs,!1)}Fjb(a){this.Yk.setValue(dh.a.Zs,a);this.IR()}B_f(){return this.Yk.sa(dh.a.V2,null)}cga(a,b){this.Yk.xQe();this.Yk.setValue(dh.a.V2,a.id);this.B2a=b.Fh;this.IR()}WU(a){let b=$a.a.it;if(P.a.instance.ga(13)){const c=pQ.a.Rac(a);switch(c){case 1:b=ab.a.DAb;break;case 2:b=ab.a.EAb}this.Yk.setValue(ab.a.languageHint,c)}this.Yk.setValue(b,a);this.IR()}language(){let a=$a.a.it;if(P.a.instance.ga(13))switch(this.Yk.sa(ab.a.languageHint,
0)){case 1:a=ab.a.DAb;break;case 2:a=ab.a.EAb}return this.Yk.sa(a,0)}Gbl(a){this.Yk.setValue(vq.vFe,a);this.IR()}RUa(){return this.Yk.sa(vq.vFe,!1)}tQj(){return this.Yk.Sa(vq.vFe)}hPj(){return P.a.instance.ga(13)?this.Yk.Sa($a.a.it)||this.Yk.Sa(ab.a.DAb)||this.Yk.Sa(ab.a.EAb):this.Yk.Sa($a.a.it)}IR(){if(B.a.HNb){var a=qd.a.instance.Na.mb.Ua,b=a.node;if(b===this.Vha)this.Vha.Bv(16,!0);else{this.Vha=b;b=this.Vha.W0a();try{this.Vha.gvb(a.Qa).c4=!0}finally{b&&b.dispose()}}}}XWk(){if(B.a.HNb&&this.Vha){var a=
0,b=this.Vha.W0a();try{for(let c=this.Vha.Ra.length-1;0<=c;c--){const f=this.Vha.Ra.ga(c);f.c4&&(f.c4=!1,a++,f.isEmpty&&this.Vha.Ra.removeAt(c))}}finally{b&&b.dispose()}this.Vha=null}}Pzi(a){if(a.Qa!==a.Mb)return!1;a=a.node.Ra.eT(a.Qa);return!!a&&a.c4}xei(a){if(this.c1a){this.freeze();var b=new pf.GraphTransaction(7);b.kd(a.node);this.c1a.MLb(a);this.F1e();this.u_a();b.dispose()}}j6b(a){const b=Sb.ParagraphReader.text(a.node);return a.Qa&&a.Qa!==b.length&&!ha.a.fz(b.charCodeAt(a.Qa))&&vr.a.instance.GSc(b,
a.Qa-1)!==a.Qa&&nb.SelectionEditor.eAb(a)?(a=nb.SelectionEditor.WRa(a,!1))?1<a.length||nb.SelectionEditor.gk(a.Ua)?a:null:null:null}static get vFe(){return P.a.instance.ga(20)?ab.a.noProof:Mc.a.Ywa}}vq.Kf=null;Object(m.a)(vq,"InsertionPointFormatting",null,[478]);class NI{constructor(a){this.Ca=a}get An(){return this.Ca}Jli(a){return 32===this.An.La(D.a.NM,2,a)}numbering(a){return 32===this.An.La(D.a.mP,2,a)}}Object(m.a)(NI,"ListCommands",null,[386]);class AC{constructor(a){this.kf=a}Y6a(a){a=Object(oa.a)(pC.a,
a);return!!a&&!!a.view&&a.view.Mh}bch(){return!0}FMe(){return!0}cch(){}zxh(a){if(a.fr)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}$fj(a){if(!a||!this.kf)return a;const b=new tn.a;b.set(a);if(this.kf.Bt(b)){for(;!b.fr;)b.zc();return b.currentNode}return a}}Object(m.a)(AC,"SimpleProofingWholeDocumentCallBacks",null,[542]);class OI{constructor(a){this.value=a}}Object(m.a)(OI,"RefBool",null,[]);class vz{constructor(){this.SOc=this.EGb=null;this.fFh=new OI(!1)}}Object(m.a)(vz,"FindNextErrorOperationParam",
null,[]);class PI extends AC{constructor(a,b){super(b);this.Gm=a}bch(a,b){return!this.boe(a.node,a.Qa,b)}FMe(a,b){return!this.boe(a,0,b)}cch(a,b){this.boe(a.node,0,b);Object(oa.a)(vz,b)}boe(a,b,c){c=Object(oa.a)(vz,c);if(Sb.ParagraphReader.$d(a)&&!a.SW)if(gc.a.xs(Wd.a.Lj(a,b)).cache.RUa)c.fFh.value=!0;else{const f=u.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.Gm.GF(a);for(let x=0;x<l.length;x++){const H=l[x],U=f&&H.Gh.Yje();if(H.begin>=b&&!U)return c.EGb=H,c.SOc=a,!0}}return!1}}
Object(m.a)(PI,"FindNextErrorCallbackSteps",AC,[]);class QI extends Ls.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){super();this.xpb=this.Ji=this.hAa=null;this.init(a);this.Pl(Va);this.OEa(U,b,f,l,x);this.qV=x;this.Ft=c;this.Tc=ja;this.kf=ya;this.yqa=H;this.jI=0}run(){this.Y6a();0===this.jI&&this.TWe();1===this.jI&&this.PMe();2===this.jI&&this.V0e();3===this.jI&&this.J3d()}Y6a(){this.Tc.Na&&this.Tc.Na.mb?1===this.behavior&&(this.yqa.Y6a(this.Ft)?this.Dp=32:this.Dp=2,this.jI=3):(ia.ULS.sendTraceTag(20321351,
324,15,"No selection for ignore all"),this.Dp=2,this.jI=3)}TWe(){this.Xki();this.qki();this.jI=1}PMe(){this.Yw||new Xh.a(this,Object(F.a)(this,this.UJk,"processCurrentNodeAtBegin"),this.qV);do if(this.Yw.run(),this.Yw.inProgress&&!this.Oi)return;while(this.Yw.inProgress);this.FJc();this.jI=2}V0e(){this.Dp=32;this.jI=3}J3d(){this.GY()}UJk(a,b){b=this.yqa.bch(this.hAa,b);a.Wg(Object(F.a)(this,this.t0i,"fromHereToEnd"));return b}t0i(a,b){if(this.Ji.moveNext())return a=this.Ji.currentNode,12!==a.type||
a===this.hAa.node?!0:this.yqa.FMe(a,b);this.oli();a.Wg(Object(F.a)(this,this.D0i,"fromStartToHere"));return!0}D0i(a,b){if(this.Ji.moveNext()){const c=this.Ji.currentNode;return 12!==c.type?!0:c===this.hAa.node?(a.Wg(Object(F.a)(this,this.VJk,"processCurrentNodeAtEnd")),!0):this.yqa.FMe(c,b)}return!1}VJk(a,b){this.yqa.cch(this.hAa,b);return!1}Xki(){let a=this.Tc.Na.mb;if(a=this.kf.Sl(a,!0,!1))this.hAa=a.Ua;this.hAa&&this.hAa.node&&(this.xpb=this.yqa.$fj(this.hAa.node))}qki(){if(!this.xpb)throw Error.argumentNull("_proofingWholeDocumentRootNode");
const a=new tn.a;a.set(this.hAa.node);a.rc(this.xpb.type);this.Ji=vx.a.d3(a,this.xpb);this.Ji.em(Object(F.a)(this.yqa,this.yqa.zxh,"spellErrorFilter"),null)}oli(){if(!this.xpb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new tn.a;a.set(this.xpb);this.Ji=vx.a.qv(a);this.Ji.em(Object(F.a)(this.yqa,this.yqa.zxh,"spellErrorFilter"),null)}}Object(m.a)(QI,"ProofingWholeDocumentOperation",Ls.a,[]);class BC{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){this.Ca=b;this.Gm=a;this.gVh=
c;this.fh=f;this.Ak=l;this.Tc=x;this.Hm=H;this.kf=U;this.S4a=ja;this.DD=ya;this.ld=Va;this.Uzc=yb.dle;this.Hlf=Zb;this.rP=fc;this.zvc=new Kb.a;this.zvc.$(1,D.a.Axh);this.zvc.$(2,D.a.v9f);this.zvc.$(3,D.a.Nyh);this.RCc=new Kb.a;this.RCc.$(1,D.a.Bxh);this.RCc.$(2,D.a.w9f);this.RCc.$(3,D.a.Oyh)}wb(){const a=this.Ca,b=Object(F.a)(this,this.qBi,"correctError"),c=Object(F.a)(this,this.dvi,"collapseIp");a.ra(D.a.Szk,Cb.a.view,Object(F.a)(this,this.Tzk,"openLanguageDialogView"),1028);a.ya(D.a.bDa,Cb.a.Pf,
Object(F.a)(this,this.bDa,"deleteRepeatedWord"));a.ya(D.a.yka,Cb.a.Pf,Object(F.a)(this,this.yka,"ignoreSpellingError"));a.ya(D.a.kza,Cb.a.Pf,b);a.ya(D.a.lza,Cb.a.Pf,b);a.ya(D.a.mza,Cb.a.Pf,b);a.ya(D.a.ILa,Cb.a.Pf,b);a.ya(D.a.JLa,Cb.a.Pf,b);a.ya(D.a.bDa,Cb.a.view,c);a.ya(D.a.yka,Cb.a.view,c);a.ya(D.a.kza,Cb.a.view,c);a.ya(D.a.lza,Cb.a.view,c);a.ya(D.a.mza,Cb.a.view,c);a.ya(D.a.ILa,Cb.a.view,c);a.ya(D.a.JLa,Cb.a.view,c);a.je(D.a.bDa,1028);a.je(D.a.yka,1028);a.je(D.a.kza,1028);a.je(D.a.lza,1028);a.je(D.a.mza,
1028);a.je(D.a.ILa,1028);a.je(D.a.JLa,1028);a.ya(D.a.ksd,de.a.frame,ld.ActionManager.Mg);this.Uzc&&a.ra(D.a.ZKe,Cb.a.view,Object(F.a)(this,this.ZKe,"populateProofingSecondaryMenu"),1124);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.ra(D.a.Hdd,Cb.a.view,Object(F.a)(this,this.TXi,"findNextProofingError"),1028);this.FUk([D.a.bpl,D.a.Axh,D.a.Bxh,D.a.Cpj,D.a.v9f,D.a.w9f,D.a.mrl,D.a.Nyh,D.a.Oyh])}FUk(a){for(let b=0;b<a.length;b++)this.Ca.ra(a[b],
Cb.a.view,ld.ActionManager.uv,1028)}dvi(a,b,c,f,l){b=this.Tc.Na.mb;if(!b)return this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),2;b=this.kf.Sl(b,!0,!1);return this.Ca.mi(b.Ua,a,c,!1,f,l)}Tzk(a,b,c){if(1===c)return this.Ca.processAction(D.a.WU,1);this.gVh().trc();return 32}m3e(a){return a?a.Gh?!1:(ia.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.ld.Xb(Pd.a.I8a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),bd.a.mark(4671),!0):(ia.ULS.sendTraceTag(7660828,
324,10,"Ignore Spelling Error: No flagged word"),this.ld.Xb(Pd.a.I8a,{["Reason"]:"RequestedErrorRangeNotFound"}),bd.a.mark(4671),!0)}bDa(a,b,c){if(1===c)return 32;bd.a.mark(4670);c=this.Gm.OSa(b);if(this.m3e(c))return 8;b=b.node;const f=this.Ak.me(15);let l=c.begin;" "===Sb.ParagraphReader.text(b).charAt(l-1)&&l--;f.kd(b);const x=this.fh.replaceTextRange(Wd.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Tc.setSelection(Qd.SelectionFactory.Sg(b,x+l));f.dispose();c.Gh.aMa(a);bd.a.mark(4671);
return 32}I3j(a){let b;({value:b}=this.RCc.Uf(a.Gh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}yka(a,b,c){if(1===c)return 32;ia.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");bd.a.mark(4670);c=this.Gm.OSa(b);if(this.m3e(c))return 8;b=b.node;const f=this.Ak.me(15);f.kd(b);this.Gm.qKa(b,[c],!0);b.setValue($a.a.PHf,!0);f.dispose();c.Gh.aMa(a,1);bd.a.mark(4671);ia.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.I3j(c);return 32}E6i(a){switch(a){case D.a.kza:return 0;
case D.a.lza:return 1;case D.a.mza:return 2;case D.a.ILa:return 3;case D.a.JLa:return 4;default:return-1}}c1j(a){let b;({value:b}=this.zvc.Uf(a.Gh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}qBi(a,b,c){var f=!0;this.rP.ga(14)&&(f=!this.DD.tua(b));this.Hm&&this.Hm.instance&&this.Hm.instance.XW(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.processAction(D.a.ksd,2);bd.a.mark(4670);f=this.E6i(a);if(0>f)return 8;c=this.Gm.OSa(b);if(this.m3e(c))return 8;b=b.node;var l=c.Gh.suggestions;if(!l)return this.ld.Xb(Pd.a.I8a,
{["Reason"]:"NoSuggestionsFound"}),bd.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.ld.Xb(Pd.a.I8a,{["Reason"]:"RequestedSuggestionIsNull"}),bd.a.mark(4671),8;this.rP.ga(50)&&Oc.App.Ih.rw&&Oc.App.Ih.YY.hra(b);f=f.replace("  "," \u00a0");l=this.Ak.me(15);l.kd(b);const x=this.fh.replaceTextRange(Wd.a.createTextRange(b,c.begin,c.end),f,!0,!1,D.a.ksd);this.Tc.setSelection(Qd.SelectionFactory.Sg(b,c.begin+f.length+x));l.dispose();c.Gh.aMa(a);bd.a.mark(4671);this.c1j(c);return 32}s6k(a,b,c,f){a.oya();
(a=c.sc(a.Ma))?(f=N.a.Ot(a,u.AFrameworkApplication.isRtl?f.begin:f.end),this.S4a.Iaa(new Sys.UI.Point(f.x,f.y+f.height),b)):ia.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}TXi(a,b,c,f,l){if(!b.view.Mh)return 2;const x=b.view;if(!this.Tc.Na.mb)return this.ld.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),2;if(1===c)return 32;const H=new vz,U=new PI(this.Gm,this.kf);b=new QI(null,a,b,c,f,H,U,this.Ca,this.Tc,this.kf,null);b.Oi=!0;b.run();if(b.isCompleted&&H.EGb){if(b=Qd.SelectionFactory.Sg(H.SOc,
H.EGb.begin),b=Qd.SelectionFactory.DN(b,Wd.a.Lj(H.SOc,H.EGb.end)),!this.Hlf.instance||!this.Hlf.instance.ANl(H.EGb,b,x)){this.Tc.setSelection(b);let ja=0;l&&(ja=l.Hu);x.cqd=!1;gm.a.instance.Db(new af.a(1,1,1,()=>{this.s6k(x,ja,H.SOc,H.EGb)}))}}else{const ja=new jj.StandardDialog;ja.xd=0;Oc.App.UR.Yle?ja.tkb(CommonUIStrings.l_DefaultDialogTitle,H.fFh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ja.tkb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),Oc.App.UR.V6h(()=>{ja.LQ&&(ja.hide(),this.Ca.processAction(a,2))}))}return 32}ZKe(){return 32}}Object(m.a)(BC,"ProofingActor",null,[]);var RI=d(718),rQ=d(1098);class rh{static Uoj(){rh.JM||(rh.JM=Array(rh.qrl),rh.JM[0]=$a.a.fontColor,rh.JM[1]=dh.a.KR,rh.JM[2]=$a.a.it,rh.JM[3]=$a.a.underline,rh.JM[4]=$a.a.Ow,rh.JM[5]=dh.a.Zs,rh.JM[6]=$a.a.font,rh.JM[7]=$a.a.fontSize,rh.JM[8]=$a.a.superscript,rh.JM[9]=$a.a.subscript,rh.JM[10]=$a.a.en,rh.JM[11]=ab.a.noProof,
rh.JM[12]=Mc.a.Ywa,rh.JM[13]=dh.a.capitalization,rh.JM[14]=$a.a.bold,rh.JM[15]=$a.a.italic,rh.JM[16]=$a.a.underline);return rh.JM}static Soj(){rh.eD||(rh.eD=Array(rh.CBk),rh.eD[0]=ab.a.eo,rh.eD[1]=ab.a.sJa,rh.eD[2]=ab.a.$l,rh.eD[3]=ab.a.wxa,rh.eD[4]=ab.a.sY,rh.eD[5]=ab.a.ghb,rh.eD[6]=ab.a.HHb,rh.eD[7]=ab.a.fhb,rh.eD[8]=dh.a.RHb,rh.eD[9]=dh.a.QHb,rh.eD[10]=ab.a.NHb,rh.eD[11]=ab.a.KHb,rh.eD[12]=ab.a.wVa,rh.eD[13]=ab.a.ux,rh.eD[14]=ab.a.jhb,rh.eD[15]=ab.a.ihb,rh.eD[16]=ab.a.flc,rh.eD[17]=ab.a.dlc,rh.eD[18]=
$a.a.Jl,rh.eD[19]=$a.a.eJ,rh.eD[20]=dh.a.Akd,rh.eD[21]=$a.a.rY);return rh.eD}}rh.qrl=17;rh.CBk=22;rh.JM=null;rh.eD=null;Object(m.a)(rh,"StyleConstants",null,[]);class er{static get lLk(){return er.tP||(er.tP=new rQ.a)}static Ble(a,b){if(!a||!a.node||!b)return!1;const c=gc.a.xs(a);if(er.Qig(c?c.Vz:null,b,rh.Uoj()))return ia.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.H8();return er.Qig(a,b,rh.Soj())?(ia.ULS.sendTraceTag(51218399,
324,50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Qig(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Sa(l)?b.Sa(l)?!er.lLk.compare(a,b,l):!0:!1)||f;return f}}er.tP=null;Object(m.a)(er,"StyleUtils",null,[]);class CC{constructor(a,b,c,f,l,x,H,U,ja,ya){this.F3a=this.zNb=null;this.fh=a;this.IK=b;this.JK=c;this.Kf=f;this.fha=l;this.Ht=x;this.DD=H;this.ld=U;this.jPa=ja;this.h3h=ya}get characterPropertiesEditor(){return this.fh}get jP(){return this.IK}get p6(){return this.JK}get km(){return this.fha}get insertionPointFormatting(){return this.Ht}get mh(){return this.Kf}get $i(){return this.DD}get Wc(){return this.ld}get r1e(){return this.jPa}get Vuc(){return this.h3h}get DUa(){null==
this.F3a&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.F3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.F3a}wb(){const a=u.AFrameworkApplication.Ta,b=Oc.App.RLa.uLc(12);P.a.instance.ga(61)&&(a.ya(D.a.q6a,Cb.a.textRange,Object(F.a)(this,this.Vei,"applyStyleToTextRange")),a.ya(D.a.xnc,Cb.a.textRange,Object(F.a)(this,this.DMk,"queryStyleTextRange")),
a.ya(D.a.q6a,Cb.a.Pf,Object(F.a)(this,this.Tei,"applyStyleToIp")),a.ya(D.a.xnc,Cb.a.Pf,Object(F.a)(this,this.BMk,"queryStyleIp")));a.ya(D.a.q6a,Cb.a.paragraph,Object(F.a)(this,this.Uei,"applyStyleToParagraph"));a.ya(D.a.q6a,Cb.a.view,Object(F.a)(this,this.Wei,"applyStyleView"));a.je(D.a.q6a,1036);a.ya(D.a.xnc,Cb.a.view,Object(F.a)(this,this.EMk,"queryStyleView"));a.ya(D.a.xnc,Cb.a.paragraph,Object(F.a)(this,this.CMk,"queryStyleParagraph"));a.je(D.a.xnc,99|(P.a.instance.ga(7)?0:4));a.ya(D.a.Tlc,Cb.a.view,
b);a.ya(D.a.Tlc,Cb.a.paragraph,Object(F.a)(this,this.Tlc,"populateMenuMoreStyles"));a.je(D.a.Tlc,1127);a.ra(D.a.ZQd,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.$Qd,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.aRd,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.bRd,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.cRd,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.dRd,Cb.a.view,Object(F.a)(this,
this.Cra,"applyStyleShortcut"),4);a.ra(D.a.eRd,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.Axf,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.Bxf,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);a.ra(D.a.Cxf,Cb.a.view,Object(F.a)(this,this.Cra,"applyStyleShortcut"),4);this.zNb=Array(10);this.p6.nWe(this.zNb)}Lkj(a){switch(a){case D.a.ZQd:return 0;case D.a.$Qd:return 1;case D.a.aRd:return 2;case D.a.bRd:return 3;case D.a.cRd:return 4;case D.a.dRd:return 5;
case D.a.eRd:return 6;case D.a.Axf:return 7;case D.a.Bxf:return 8;case D.a.Cxf:return 9;default:return-1}}Cra(a,b,c,f){a=this.Lkj(a);return 0>a||a>this.zNb.length?2:(a=this.zNb[a])?u.AFrameworkApplication.Ta.mi(b,D.a.q6a,c,!0,f,a):2}Tlc(a,b,c,f,l){a=!0;b.contextId!==Cb.a.paragraph&&b.contextId!==Cb.a.textRange&&b.contextId!==Cb.a.Pf&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.p6.qL(b.node);c=P.a.instance.ga(61);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np&&(l.MenuItems=
RI.StylePreviewGenerator.R3f(b,c));l.PopulationXML=RI.StylePreviewGenerator.J1i(b,c);return 32}CMk(a,b,c,f,l){a=!0;b.contextId!==Cb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.p6.bE(c);if(!a||!l)return ia.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.O_e.$x(a);this.DUa&&(l.Uje=er.Ble(b,a));return 32}Uei(a,b,c,f,l){if(b.contextId!==Cb.a.paragraph)return 8;if(P.a.instance.ga(14)&&this.$i.AFa(b))return this.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.w$d(l,a);if(!b)return this.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.U3b}),8;if(2!==this.p6.Eta(b))return 2;c=new pf.GraphTransaction(15);c.kd(a);this.insertionPointFormatting.u_a();this.jP.Eaa(b,a,!1);c.dispose();l=ha.a.qN(l);f.hQ=l>>>16^l&65535;return 32}DMk(a,b,c,f,l){a=!0;b.contextId!==Cb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=gc.a.xs(b);a=gc.a.pwb(a);if(this.DUa){if(!l||!c)return ia.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.p6.bE(c);if(!a)return ia.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.Uje=er.Ble(b,a)}else{if(!a)return 2;if(!l)return 8}l.O_e.$x(a);return 32}Vei(a,b,c,f,l){if(b.contextId!==Cb.a.textRange||!P.a.instance.ga(61))return 8;if(this.$i.AFa(b))return this.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const x=this.w$d(l,b.node);if(!x)return this.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.U3b}),8;if(1!==this.p6.Eta(x))return 2;
c=this.p6.qL(a);if(!c)return this.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.OUf}),8;if(!c.$G(this.p6.wQ(x)))return this.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.U3b}),8;const H=new pf.GraphTransaction(7);try{H.kd(a),this.jP.suc(a,c),this.r1e.wHc(b,U=>{this.mh.qCa(U);this.mh.cga(U,x)})}finally{H&&H.dispose()}b=ha.a.qN(l);f.hQ=b>>>16^b&65535;return 32}BMk(a,b,c,f,l){a=!0;b.contextId!==Cb.a.Pf&&(a=!1);if(1===c&&!a)return 2;c=this.jP.t$d(b);a=b.node;if(this.DUa){if(!l||!a)return ia.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.p6.bE(a);if(!c)return ia.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.Uje=er.Ble(b,c)}else{if(!c)return 2;if(!l)return 8}l.O_e.$x(c);return 32}Tei(a,b,c,f,l){if(b.contextId!==Cb.a.Pf||!P.a.instance.ga(61))return 8;if(this.$i.AFa(b))return this.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const x=this.w$d(l,b.node);if(!x)return this.Wc.Xb(Pd.a.N1,{["Reason"]:Md.a.U3b}),8;const H=this.p6.Eta(x);if(1!==H&&2!==
H)return 2;(b=this.insertionPointFormatting.j6b(b))?(c=qd.a.TQa(b),a=u.AFrameworkApplication.Ta.mi(c,a,2,!1,f,l)):(a=new pf.GraphTransaction(7),a.kd(c),this.jP.oWe(x,c),a.dispose(),a=32);l=ha.a.qN(l);f.hQ=l>>>16^l&65535;return a}EMk(a,b,c,f,l){if(P.a.instance.ga(61)){const x=this.Vuc.M5(a,b,c,f,l,null,0);if(2!==x)return x}return this.Vuc.M5(a,b,c,f,l,null,12)}Wei(a,b,c,f,l){const x={};x[this.Vuc.spa]=6168;x[this.Vuc.rpa]=6169;let H=12;if(P.a.instance.ga(61)){if(!b.view.Mh)return 2;var U=b.view.Lb,
ja=U?U.Pj:null;if(!ja)return this.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;if(P.a.instance.ga(11)&&this.km.asa(rd.ImageReader.Yyb,ja))return this.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.M0b}),8;if(P.a.instance.ga(14)&&this.$i.JYc(ja))return this.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),8;ja=this.p6.zxb();if(l&&ja){var ya=ja.$G(l);ya&&(ja=this.p6.W7d(ya,ja),ya=this.p6.Eta(ya),ja&&(U=U.Na.ga(0),U.Cca&&U.Ua.contextId===Cb.a.textRange||2===U.length&&U.Ua.contextId===Cb.a.textRange&&U.Ye.contextId===Cb.a.endOfParagraph)&&
(ya=1,l=ja.eb(dh.a.SHb)),1===ya?H=0:3===ya&&(H=14))}}return this.Vuc.M5(a,b,c,f,l,x,H)}w$d(a,b){if(a&&b&&Sb.ParagraphReader.$d(b))b=this.p6.qL(b);else return null;return b.$G(a)}}Object(m.a)(CC,"StyleActor",null,[]);const SI=a=>a.contextId===Cb.a.Y3d;class Ig{static get km(){return Ih.ContextSetEditor.instance}static get $i(){return fd.a.instance}static get Wc(){return Nc.a.instance}static get ze(){return Ig.hd||(Ig.hd=Db.a.instance.resolve("Box4.IFeatureHelper"))}static er(){return Ig.Hm||(Ig.Hm=
Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static get tM(){return Ig.EG||(Ig.EG=Db.a.instance.resolve("Box4.IParagraphIndentationReader"))}static y$b(a){return u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.QJa||a===D.a.A_a||a===D.a.P5||a===D.a.DKa)}static U7(a,b,c,f,l){var x=!0;if(!b.view.Mh)return 2;var H=b.view,U=H.Lb;U&&U.Na.mb||(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),x=!1);if(P.a.instance.ga(11)&&(Ig.km.asa(rd.ImageReader.U9b,H.Lb.Pj)&&(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.BWd}),
x=!1),Ig.km.asa(rd.ImageReader.Yyb,H.Lb.Pj)))return Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.M0b}),8;P.a.instance.ga(14)&&Ig.$i.JYc(H.Lb.Pj)&&(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),x=!1);Ig.km.asa(rd.ImageReader.Gje,H.Lb.Pj)&&(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.KHf}),x=!1);Ig.km.asa(cu.c,H.Lb.Pj)&&(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.LHf}),x=!1);Ig.km.asa(SI,H.Lb.Pj)&&(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.JHf}),x=!1);Ig.er()&&Ig.er().instance&&Ig.er().instance.XW(H.Lb.Pj)&&(Ig.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.externalSelection}),
x=!1);a!==D.a.w1||P.a.instance.ga(54)||P.a.instance.ga(84)||(x=!1);var ja=null;U&&U.Na.mb&&(ja=U.Na.mb);a===D.a.Tol&&ja&&ja.Cca&&Sb.ParagraphReader.YW(ja.Ua.node)&&!rb.ListReader.nx&&(x=!1);if(1===c||!x||!ja)return x?32:8;x=a===D.a.nla||a===D.a.Xia||a===D.a.toa||a===D.a.PDa;H=a===D.a.UKk||a===D.a.QKi||a===D.a.rhh;const ya=a===D.a.Ujb||a===D.a.Vjb||a===D.a.w1,Va=new pf.GraphTransaction(15);Va.kd(ja.Ua.node);ja=new Ka.a;let hb=!1;if(x||H||ya)bd.a.mark(7121),b=Ig.km.Z0i(b.CE);else{bd.a.mark(7119);b=
ri.dta(U.Na,!0);if(!b)return Ig.Wc.Xb(Pd.a.Lja,{["Reason"]:Md.a.rPc}),Va.dispose(),8;U=a===D.a.nCj||a===D.a.oCj;b.hx&&U&&(hb=Ig.Yxj(ja,b))}b.hx&&1<b.length&&Ig.Zxj(b)&&(l||(l={}),l.InContextSet=!0);u.AFrameworkApplication.Ta.mi(b,a,c,!0,f,l);hb&&Ig.sok(ja,b,l);Va.dispose();Oc.App.Kb.updateCommandUI();x||H||ya?bd.a.mark(7122):bd.a.mark(7120);return 32}static Yxj(a,b){if(!b.hx)return!1;let c=!1,f=!1;for(let x=0;x<b.length;x++)if(b.getContext(x).al){var l=b.getContext(x).node;if(l)if(l=Ig.tM.Rwb(l),
2===l.specialIndentType)c=!0,a.add(x);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static sok(a,b,c){if(b.hx)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.al)continue;f=f.node;const x=Ig.tM.Rwb(f);2!==x.specialIndentType||bf.a.$y(c.value,x.QN)||f.setValue(ab.a.$l,x.QN-x.kNb)}}static phl(a,b){let c=!0;b.contextId!==Cb.a.paragraph?c=!1:P.a.instance.ga(14)&&Ig.$i.AFa(b)?(Ig.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),c=!1):Ig.er()&&Ig.er().instance&&Ig.er().instance.XW(b)&&
(Ig.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,tF:c?32:8}}static Eth(a,b){let c=!0;b.contextId!==Cb.a.image&&b.contextId!==Cb.a.embeddedFile&&(c=!1);P.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,tF:c?32:8}}static Zxj(a){if(!a.hx)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).al){var c=a.getContext(f).node;if(c)if(c=Sb.ParagraphReader.HN(c),!f)b=c;else if(c!==b)return!0}return!1}}Ig.hd=null;Ig.Hm=null;Ig.EG=null;Object(m.a)(Ig,"FormattingActionHelper",
null,[]);class Os extends Ls.a{constructor(a,b,c,f,l,x,H,U){super();this.Pnf=this.ZB=null;this.init(a);this.Pl("FormattingViewOperation");this.OEa(u.AFrameworkApplication.Ta,b,f,l,x);this.Ft=c;this.FMa=0;this.WB=!0;this.xRh=H;this.Hm=U}get Lsa(){return this.Hm.instance}run(){const a=this.Ft.view;var b=null;a.Mh&&(b=a.Lb);if(b){var c=b.Na.mb;!c||P.a.instance.ga(14)&&Os.$i.Gle(c)?(Os.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),this.WB=!1):this.Lsa&&this.Lsa.ozb(c)&&(Os.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.externalSelection}),
this.WB=!1)}else Os.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),this.WB=!1;1!==this.behavior&&this.WB||(this.WB&&(c=b.Na.mb,1===b.Na.length&&1===c.length&&nb.SelectionEditor.gk(c.Ua)&&gf.b(c.Ua)&&(Os.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.LKc}),this.WB=!1)),(c=this.WB)&&this.actionId===D.a.WU&&((c=Pa.AT(b.Na.mb,gc.a.MHf))||Os.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.i0d})),this.Dp=c?32:8,this.FMa=3);0===this.FMa&&(bd.a.mark(5730),this.Pnf=em.SelectionReferenceFactory.instance.gsa(),c=b.Na.mb.Ua,this.ZB=new pf.GraphTransaction(15),
this.ZB.kd(c.node),this.FMa=1);if(1===this.FMa){this.Yw||this.Ejb(this.Ft.CE);if(1===this.Qna())return;this.FMa=2}if(2===this.FMa){if(this.actionId===D.a.WU)if(b=b.Pj,b.hx)for(c=0;c<b.length;c++){let f=b.getContext(c);this.AEh(f)}else this.AEh(b);b=this.actionId===D.a.v1||this.actionId===D.a.aja||this.actionId===D.a.clearFormatting||this.actionId===D.a.nW;Ig.y$b(this.actionId)||this.Pnf.MU(b);(b=Object(oa.a)(139,this.rd))&&!b.Haa||v.FocusManager.instance().tf(a.DI);this.ZB.dispose();this.ZB=null;
Ig.y$b(this.actionId)||Oc.App.Kb.updateCommandUI();bd.a.mark(5731);this.FMa=3;this.Dp=32}3===this.FMa&&(this.xRh.process(this.actionId,this.Ft,this.behavior,this.response),this.GY())}AEh(a){(nb.SelectionEditor.Yt(a)||nb.SelectionEditor.Xl(a))&&Oc.App.UR.NR(a.node)}static get $i(){return fd.a.instance}static get Wc(){return Nc.a.instance}}Object(m.a)(Os,"FormattingViewOperation",Ls.a,[]);var sQ=d(480),tQ=d(414);class Fd{constructor(a,b,c,f,l){this.EAa=new Ma.ScriptSharpLegacyMap;this.Gel=x=>{x=oc.HyperlinkReader.W$i(x,
this.BD);for(let H of x)(x=H.paragraph)&&x.Ra&&(x=x.Ra.eT(H.Qa))&&x.formatting&&Fd.mh.clh(x.formatting)};this.JRh=a;this.bbf=b;this.aw=c;this.BD=f;if(!l)throw Error.argumentNull("interactiveViewManager");Fd.Lf=l;this.wob=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("FontPreviewEnabled")}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.cMk,"queryNonParagraphFormatting");P.a.instance.ga(105)&&(Fd.ze?Fd.ze.jFa(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(D.a.font,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Pq,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.bH,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.NH,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Sr,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.nW,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.v1,Cb.a.endOfParagraph,
Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.aja,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.bold,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.setItalic,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.underline,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Joa,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.superscript,Cb.a.endOfParagraph,
Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.subscript,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.strikethrough,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.Zs,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.WU,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP")),a.ya(D.a.clearFormatting,Cb.a.endOfParagraph,Object(F.a)(this,this.VP,"applyFormattingEOP"))):Oc.App.Kbb&&(a.ya(D.a.font,
Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.Pq,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.Sr,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.nW,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),rb.ListReader.nx&&(a.ya(D.a.bold,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.setItalic,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),
a.ya(D.a.superscript,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.subscript,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.strikethrough,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.Zs,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP"))),P.a.instance.ga(94)||P.a.instance.ga(96))&&(a.ya(D.a.bH,Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")),a.ya(D.a.NH,
Cb.a.endOfParagraph,Object(F.a)(this,this.oca,"applyListFormattingEOP")));const c=Oc.App.RLa.FJf(f=>ri.dta(f.Na,!0));a.ra(D.a.$sd,Cb.a.textRange,Object(F.a)(this,this.$sd,"toggleChangeCase"),1028);P.a.instance.ga(77)||a.ya(D.a.Mxa,Cb.a.table,Object(F.a)(this,this.KMk,"queryTableFormatting"));a.ya(D.a.bJb,Cb.a.view,Object(F.a)(this,this.Ych,"queryCharacterFormatting"));a.ya(D.a.xNe,Cb.a.view,Object(F.a)(this,this.Ych,"queryCharacterFormatting"));a.ya(D.a.Mxa,Cb.a.view,c);a.ya(D.a.Mxa,Cb.a.paragraph,
Object(F.a)(this,this.Mxa,"queryParagraphFormatting"));a.ya(D.a.Mxa,Cb.a.image,Object(F.a)(this,this.VLk,"queryImageFormatting"));a.ya(D.a.Mxa,Cb.a.unsupportedObject,b);a.je(D.a.bJb,99|(P.a.instance.ga(7)?0:1028));a.je(D.a.xNe,1127);a.je(D.a.Mxa,97|(P.a.instance.ga(7)?0:1028));u.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(D.a.eJb,Cb.a.view,c),a.ya(D.a.eJb,Cb.a.paragraph,Object(F.a)(this,this.eJb,"queryParagraphIndentation")),a.je(D.a.eJb,97|(P.a.instance.ga(7)?0:1028)));this.bC(a,D.a.font);
this.bC(a,D.a.Pq);this.wob&&(this.bC(a,D.a.QJa),this.bC(a,D.a.A_a),this.bC(a,D.a.P5),this.bC(a,D.a.DKa));if(P.a.instance.ga(94)||P.a.instance.ga(96))this.bC(a,D.a.bH),this.bC(a,D.a.NH);a.MBa(D.a.yXf,Cb.a.view,Object(F.a)(this,this.LQd,"applyCharacterFormattingViewAsync"));a.je(D.a.yXf,1092);this.bC(a,D.a.Sr);this.bC(a,D.a.nW);this.bC(a,D.a.v1);this.bC(a,D.a.z_b);this.bC(a,D.a.btb);this.bC(a,D.a.ctb);this.bC(a,D.a.T6a);this.bC(a,D.a.A_b);this.bC(a,D.a.aja);this.bC(a,D.a.bold);a.wjb(D.a.bold,Object(F.a)(this,
this.g9a,"generateActionArguments"));this.bC(a,D.a.setItalic);a.wjb(D.a.setItalic,Object(F.a)(this,this.g9a,"generateActionArguments"));this.bC(a,D.a.underline);a.wjb(D.a.underline,Object(F.a)(this,this.g9a,"generateActionArguments"));this.bC(a,D.a.Joa);this.bC(a,D.a.superscript);a.wjb(D.a.superscript,Object(F.a)(this,this.g9a,"generateActionArguments"));this.bC(a,D.a.subscript);a.wjb(D.a.subscript,Object(F.a)(this,this.g9a,"generateActionArguments"));this.bC(a,D.a.strikethrough);a.wjb(D.a.strikethrough,
Object(F.a)(this,this.g9a,"generateActionArguments"));this.bC(a,D.a.Zs);a.wjb(D.a.Zs,Object(F.a)(this,this.g9a,"generateActionArguments"));a.ra(D.a.oab,Cb.a.textRange,Object(F.a)(this,this.vHc,"applyCharacterFormatting"),96);a.MBa(D.a.WU,Cb.a.view,Object(F.a)(this,this.LQd,"applyCharacterFormattingViewAsync"));a.ya(D.a.WU,Cb.a.paragraph,Object(F.a)(this,this.SQd,"applyParagraphFormatting"));a.ya(D.a.WU,Cb.a.textRange,Object(F.a)(this,this.vHc,"applyCharacterFormatting"));a.ya(D.a.WU,Cb.a.Pf,Object(F.a)(this,
this.MQd,"applyFormattingIp"));a.ya(D.a.clearFormatting,Cb.a.view,Object(F.a)(this,this.nti,"clearFormattingView"));a.ya(D.a.clearFormatting,Cb.a.paragraph,Object(F.a)(this,this.mti,"clearFormattingParagraph"));a.ya(D.a.clearFormatting,Cb.a.textRange,Object(F.a)(this,this.vHc,"applyCharacterFormatting"));a.ya(D.a.clearFormatting,Cb.a.Pf,Object(F.a)(this,this.MQd,"applyFormattingIp"));a.je(D.a.clearFormatting,1028);a.ya(D.a.b7a,Cb.a.textRange,Object(F.a)(this,this.b7a,"clearFormattingParagraphLevel"));
a.ya(D.a.b7a,Cb.a.Pf,Object(F.a)(this,this.b7a,"clearFormattingParagraphLevel"));a.ya(D.a.cVd,Cb.a.view,Object(F.a)(this,this.cVd,"clearFormattingMultiParagraphLevel"));a.ya(D.a.eLa,Cb.a.view,Ig.U7);a.ya(D.a.eLa,Cb.a.paragraph,Object(F.a)(this,this.SQd,"applyParagraphFormatting"));a.ya(D.a.eLa,Cb.a.image,Object(F.a)(this,this.Fxf,"applyTextDirectionToImage"));a.ya(D.a.eLa,Cb.a.unsupportedObject,Object(F.a)(this,this.Gxf,"applyTextDirectionToNonParagraph"));a.je(D.a.eLa,1028);a.ya(D.a.o0a,Cb.a.view,
Ig.U7);a.ya(D.a.o0a,Cb.a.paragraph,Object(F.a)(this,this.SQd,"applyParagraphFormatting"));a.ya(D.a.o0a,Cb.a.image,Object(F.a)(this,this.Fxf,"applyTextDirectionToImage"));a.ya(D.a.o0a,Cb.a.unsupportedObject,Object(F.a)(this,this.Gxf,"applyTextDirectionToNonParagraph"));a.je(D.a.o0a,1028)}bC(a,b){a.MBa(b,Cb.a.view,Object(F.a)(this,this.LQd,"applyCharacterFormattingViewAsync"));a.ya(b,Cb.a.textRange,Object(F.a)(this,this.vHc,"applyCharacterFormatting"));a.ya(b,Cb.a.Pf,Object(F.a)(this,this.MQd,"applyFormattingIp"));
a.je(b,1028)}g9a(){return new Q(2)}$sd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Qa,b.Mb-b.Qa);return Fd.dme(a,0,a.length)?this.lJc(b,D.a.btb):Fd.ZUj(a)?this.lJc(b,D.a.T6a):this.lJc(b,D.a.ctb)}Ych(a,b,c,f,l){f=!0;b.contextId!==Cb.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===D.a.xNe)a=l.formatting,l=l.oOl;else{if(!b.view||!b.view.Mh)return 2;b=b.view;if(!b.Lb||!b.Lb.Na.mb)return 8;a=l;l=b.Lb.Na}this.Gwi(l,a);return 32}Gwi(a,b){for(let l of a){a=l.Hl;for(let x of l){let H=null;if(x.contextId===
Cb.a.textRange){if(gf.b(x))continue;H=[];var c=x.node.Ra;if(c){var f=c.length-1;const U=x.Qa,ja=x.Mb;let ya=!1;for(let Va=0;Va<f;Va++){const hb=c.ga(Va).cp,yb=c.ga(Va+1).cp;if(c.ga(Va).formatting&&Math.max(hb,U)<Math.min(yb,ja))ya=!0,Array.add(H,c.ga(Va).formatting);else if(ya)break}c.ga(f).formatting&&x.Mb>c.ga(f).cp&&Array.add(H,c.ga(f).formatting)}}else if(x.contextId===Cb.a.paragraph){if(H=[],c=x.node.Ra)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(H,c.ga(f).formatting)}else if(x.contextId===
Cb.a.endOfParagraph)H=[gc.a.xs(x)];else if(x.contextId===Cb.a.Pf){this.CLk(x,b);return}if(H&&0<H.length)for(const U of H)if(gc.a.qud(b,U.cache,x,a))return}}}CLk(a,b){var c=gc.a.xs(a);if(c){c=c.cache;var f=Fd.insertionPointFormatting.JI($a.a.bold,c.isBold);b.bold=f?1:0;f=Fd.insertionPointFormatting.JI($a.a.italic,c.isItalic);b.italic=f?1:0;f=Fd.insertionPointFormatting.JI($a.a.underline,c.iE);b.underline=f?1:0;b.Ow=Fd.insertionPointFormatting.JI($a.a.Ow,c.Ow);f=Fd.insertionPointFormatting.JI($a.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=Fd.insertionPointFormatting.JI($a.a.subscript,c.QF);b.subscript=f?1:0;f=Fd.insertionPointFormatting.JI($a.a.strikethrough,c.PF);b.strikethrough=f?1:0;f=Fd.insertionPointFormatting.JI(dh.a.Zs,c.A_);b.Zs=f?1:0;b.fontName=Kd.Font.cEa(Fd.insertionPointFormatting.JI($a.a.font,c.GN));b.cpa=c.hV;b.fontSize=this.aw.E9a(Fd.insertionPointFormatting.JI($a.a.fontSize,c.fontSize),a.node);b.fontColor=Fd.insertionPointFormatting.JI($a.a.fontColor,c.fontColor);b.highlight=Fd.insertionPointFormatting.JI($a.a.highlight,
c.highlight)}}LQd(a,b,c,f,l,x){return new Os(a,b,c,f,l,x,this.JRh,Fd.er())}vHc(a,b,c,f,l){f=!0;let x=b;b.contextId!==Cb.a.textRange&&b.contextId!==Cb.a.Pf?f=!1:(P.a.instance.ga(14)&&Fd.$i.tua(x)&&(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),f=!1),Fd.er()&&Fd.er().instance&&Fd.er().instance.XW(x)&&(f=!1),f&&nb.SelectionEditor.gk(b)&&gf.b(x)&&(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.LKc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===Cb.a.Pf)return 2;this.aw.Luh(a)&&(b=nb.SelectionEditor.KOb(x),nb.SelectionEditor.Tg(b)||
(x=b));b=x.node;Ig.y$b(a)&&(b.Yoa=!0);a==D.a.Sr&&P.a.instance.ga(119)&&u.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.Gel(x);Fd.r1e.wHc(x,H=>{this.Aph(H,a,l,x.Mb)});Ig.y$b(a)&&(b.Yoa=!1);this.lKj(a)&&this.lJc(x,a);return 32}ETc(a){if(!this.wob||!a||!a.paragraph)return null;const b=Fd.Lf.Pd;if(!b)return null;a=Object(oa.a)(456,a.paragraph.mg(b.Ma));return a?(a=Object(oa.a)(477,a))?a:null:null}VVc(a){return this.wob&&!!a&&!!a.Hi}Sph(a,b,c){if(a&&a.rd){var f=b.cache,
l=a.rd,x=-1;if("string"===typeof l)this.wob&&c===D.a.P5&&this.O6a(b,f.GN,$a.a.font),a=l;else if(this.wob&&c===D.a.P5&&(this.O6a(b,f.GN,$a.a.font),this.O6a(b,f.hV,ab.a.hV)),a=l.fontName,x=l.cpa,Kd.Font.PUa()){this.wob&&c===D.a.P5&&(this.O6a(b,f.isBold,$a.a.bold),this.O6a(b,f.isItalic,$a.a.italic));const H=1===l.bold;l=1===l.italic;if(H||l)Fd.mh.MH(b,H),Fd.mh.setItalic(b,l)}a=a.substr(0,31);Fd.mh.UU(b,a);P.a.instance.ga(53)&&(c===D.a.P5&&this.O6a(b,f.hV,ab.a.hV),Fd.mh.fLa(b,x))}}O6a(a,b,c){this.EAa.Hb(a.He.cp)||
this.EAa.$(a.He.cp,new Ma.ScriptSharpLegacyMap);this.EAa.ga(a.He.cp).Hb(c)||this.EAa.ga(a.He.cp).$(c,b)}e5b(a,b){if(!this.EAa.Hb(a.He.cp))return null;const c=this.EAa.ga(a.He.cp).ga(b);this.EAa.ga(a.He.cp).remove(b);this.EAa.ga(a.He.cp).count||this.EAa.remove(a.He.cp);return c}Aph(a,b,c,f){var l=a.cache,x=Object(oa.a)(139,c);switch(b){case D.a.bold:2===c.value&&(c.value=l.isBold?0:1);Fd.mh.MH(a,1===c.value);break;case D.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);Fd.mh.setItalic(a,1===c.value);
break;case D.a.underline:2===c.value&&(c.value=l.iE?0:1);Fd.mh.LY(a,1===c.value);break;case D.a.Joa:Fd.mh.Joa(a,c);break;case D.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);Fd.mh.KY(a,1===c.value);break;case D.a.subscript:2===c.value&&(c.value=l.QF?0:1);Fd.mh.e6(a,1===c.value);break;case D.a.strikethrough:2===c.value&&(c.value=l.PF?0:1);Fd.mh.IY(a,1===c.value);break;case D.a.Zs:2===c.value&&(c.value=l.A_?0:1);Fd.mh.Fjb(a,1===c.value);break;case D.a.font:this.Sph(x,a,D.a.font);break;case D.a.P5:c=
this.ETc(a);this.VVc(c)&&(this.Sph(x,a,D.a.P5),c.gK(null));break;case D.a.DKa:c=this.ETc(a);this.VVc(c)&&(x=this.e5b(a,$a.a.font))&&(l=this.e5b(a,$a.a.bold),f=this.e5b(a,$a.a.italic),l&&Fd.mh.MH(a,l),f&&Fd.mh.setItalic(a,f),x=x.substr(0,31),Fd.mh.UU(a,x),l=this.e5b(a,ab.a.hV),P.a.instance.ga(53)&&l&&Fd.mh.fLa(a,l),c.gK(null));break;case D.a.Sr:Fd.mh.Sr(a,c,null);break;case D.a.nW:Fd.mh.nW(a);break;case D.a.v1:Fd.mh.Coa(a,c);break;case D.a.aja:Fd.mh.X_b(a);break;case D.a.Pq:Fd.mh.Pq(a,x.rd);break;
case D.a.QJa:c=this.ETc(a);this.VVc(c)&&(this.O6a(a,l.fontSize,$a.a.fontSize),Fd.mh.Pq(a,x.rd),c.gK(null));break;case D.a.A_a:c=this.ETc(a);this.VVc(c)&&(l=this.e5b(a,$a.a.fontSize))&&(Fd.mh.Pq(a,l),c.gK(null));break;case D.a.bH:Fd.mh.oVc(a);break;case D.a.NH:Fd.mh.Pqd(a);break;case D.a.WU:l=P.a.instance.ga(20)?ab.a.noProof:Mc.a.Ywa;Fd.mh.Zpc(a,c.eb($a.a.it),f,c.sa(l,!1));break;case D.a.oab:Fd.mh.MLb(a);break;case D.a.clearFormatting:Fd.mh.qCa(a);break;case D.a.btb:case D.a.ctb:case D.a.z_b:case D.a.T6a:case D.a.A_b:l.LTa&&
2===l.capitalization&&Fd.mh.YUd(a)}}b7a(a,b,c){a=!0;b.contextId!==Cb.a.textRange&&b.contextId!==Cb.a.Pf?a=!1:(P.a.instance.ga(14)&&Fd.$i.tua(b)&&(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),a=!1),a&&nb.SelectionEditor.gk(b)&&gf.b(b)&&(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.LKc}),a=!1));if(1===c||!a)return a?32:8;Fd.paragraphEditor.Z_b(b.node,!1);return 32}cVd(a,b,c,f,l){a={};a[fi.spa]=6168;a[fi.rpa]=6169;const x=b.view;var H=null;x.lp&&(H=x);var U=!0;let ja=32;H&&(H=H.Lb.Na.mb)&&P.a.instance.ga(14)&&(Fd.$i.Gle(H)?
(Fd.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),ja=8,U=!1):1===c&&(ja=32,U=!1));U&&P.a.instance.ga(54)&&(U=new pf.GraphTransaction(1===c?3:15),U.kd(x.root),ja=fi.M5(D.a.b7a,b,c,f,l,a,12),U.dispose());return ja}MQd(a,b,c,f,l){var x=!0,H=32;b.contextId!==Cb.a.Pf?x=!1:P.a.instance.ga(14)&&Fd.$i.tua(b)&&(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),x=!1);if(1===c||!x)return x?32:8;c=b.node;x=null;if(P.a.instance.ga(54)&&P.a.instance.ga(61)&&a===D.a.clearFormatting){Fd.eq.rtb(c);Fd.paragraphEditor.HFf(c);const U=Ab.StyleReader.qL(c).$G(Ab.StyleReader.zMa);
Fd.jP.Eaa(U,c,!0)}if(a!==D.a.clearFormatting||P.a.instance.ga(49))x=Fd.insertionPointFormatting.j6b(b);if(x)H=qd.a.TQa(x),H=u.AFrameworkApplication.Ta.mi(H,a,2,!1,f,l);else switch(f=Object(oa.a)(139,l),b=gc.a.xs(b).cache,a){case D.a.font:f&&f.rd&&(l=f.rd,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.cpa),Fd.insertionPointFormatting.Fod(b),P.a.instance.ga(53)&&Fd.insertionPointFormatting.fLa(f));break;case D.a.Sr:Fd.insertionPointFormatting.Sr(l);break;case D.a.nW:Fd.insertionPointFormatting.nW();
break;case D.a.v1:Fd.insertionPointFormatting.Coa(l);break;case D.a.aja:Fd.insertionPointFormatting.X_b();break;case D.a.Pq:Fd.insertionPointFormatting.Pq(f.rd);break;case D.a.bH:l=Fd.insertionPointFormatting.JI($a.a.fontSize,b.fontSize);Fd.insertionPointFormatting.Pq(Fd.mh.bH(l));break;case D.a.NH:l=Fd.insertionPointFormatting.JI($a.a.fontSize,b.fontSize);Fd.insertionPointFormatting.Pq(Fd.mh.NH(l));break;case D.a.bold:Fd.insertionPointFormatting.MH(!Fd.insertionPointFormatting.JI($a.a.bold,b.isBold));
break;case D.a.setItalic:Fd.insertionPointFormatting.setItalic(!Fd.insertionPointFormatting.JI($a.a.italic,b.isItalic));break;case D.a.underline:Fd.insertionPointFormatting.LY(!Fd.insertionPointFormatting.JI($a.a.underline,b.iE));break;case D.a.Joa:Fd.insertionPointFormatting.Joa(l);break;case D.a.superscript:Fd.insertionPointFormatting.KY(!Fd.insertionPointFormatting.JI($a.a.superscript,b.isSuperscript));break;case D.a.subscript:Fd.insertionPointFormatting.e6(!Fd.insertionPointFormatting.JI($a.a.subscript,
b.QF));break;case D.a.strikethrough:Fd.insertionPointFormatting.IY(!Fd.insertionPointFormatting.JI($a.a.strikethrough,b.PF));break;case D.a.Zs:Fd.insertionPointFormatting.Fjb(!Fd.insertionPointFormatting.JI(dh.a.Zs,b.A_));break;case D.a.clearFormatting:Fd.insertionPointFormatting.u_a();P.a.instance.ga(54)||(Fd.eq.rtb(c),Fd.paragraphEditor.Z_b(c,!0),P.a.instance.ga(71)&&Fd.jP.NJc(c));break;case D.a.WU:l.Sa($a.a.it)&&Fd.insertionPointFormatting.WU(l.eb($a.a.it)),b=P.a.instance.ga(20)?ab.a.noProof:Mc.a.Ywa,
l.Sa(b)&&Fd.insertionPointFormatting.Gbl(l.eb(b))}Ig.y$b(a)||Oc.App.Kb.updateCommandUI();return H}tXk(a,b){D.a.clearFormatting===b&&Ta.OutlineElementNavigator.UA(a).properties.removeProperty($a.a.rY)}VP(a,b,c,f,l){f=Fd.Wc.Vp(D.a.O$k);var x=!0;b.contextId!==Cb.a.endOfParagraph&&(x=!1);if(1===c||!x)return x?32:8;c=b.node;b=tb.GraphIterator.nb(b.node);b.$e();x=b.pka(4);if((b=!!x&&Fd.Sf.Qda(x))&&!Oc.App.Kbb)return 8;const H=!Sb.ParagraphReader.textLength(c);f.properties.$("Action",a.toString());f.properties.$("ListContext",
b.toString());f.properties.$("IsEmptyParagraph",H.toString());ia.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,H);this.bbf.qzh(b)?this.VGh(a,l,x):(b=c.Ra.last,this.tXk(c,a),x=b.formatting,c=Fd.characterPropertiesEditor.v1d(c),this.bbf.vkg(x)&&(c.ae(c.He),this.Aph(c,a,l,b.cp)));f.end();return 32}VGh(a,b,c){const f=Object(oa.a)(139,b);switch(a){case D.a.Sr:Fd.cea.Sr(c,b);break;case D.a.Pq:Fd.cea.Pq(c,f.rd);break;case D.a.nW:Fd.cea.nW(c);break;
case D.a.bH:Fd.cea.bH(c);break;case D.a.NH:Fd.cea.NH(c);break;case D.a.font:Fd.cea.nal(c,f.rd);break;case D.a.bold:a=this.BKb(b,$a.a.bold,c);Fd.cea.MH(c,a);break;case D.a.setItalic:a=this.BKb(b,$a.a.italic,c);Fd.cea.setItalic(c,a);break;case D.a.subscript:a=this.BKb(b,$a.a.subscript,c);Fd.cea.e6(c,a);break;case D.a.superscript:a=this.BKb(b,$a.a.superscript,c);Fd.cea.KY(c,a);break;case D.a.strikethrough:a=this.BKb(b,$a.a.strikethrough,c);Fd.cea.IY(c,a);break;case D.a.Zs:a=this.BKb(b,dh.a.Zs,c),Fd.cea.Fjb(c,
a)}}BKb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}oca(a,b,c,f,l){f=!0;const x=tb.GraphIterator.nb(b.node);x.$e();b.contextId===Cb.a.endOfParagraph&&x.pka(4)||(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.Pne}),f=!1);b=x.currentNode;if(!Fd.Sf.Qda(b))return 8;if(1===c||!f)return f?32:8;this.VGh(a,l,b);return 32}Mxa(a,b,c,f,l){a=!0;b.contextId!==Cb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.Jl?l.Jl!==Sb.ParagraphReader.HN(c)&&(l.Jl=0):l.Jl=Sb.ParagraphReader.HN(c);P.a.instance.ga(54)&&
(P.a.instance.ga(59)||P.a.instance.ga(34))&&(a=Fd.tM.Rwb(c),l.aB?(!l.RMl&&this.$xj(l.aB,a)&&2===l.aB.specialIndentType&&(l.aB.specialIndentType=0),l.aB.RWc===a.RWc&&bf.a.$y(l.aB.QN,a.QN)||(l.aB.QN=Number.MAX_VALUE),l.aB.TWc===a.TWc&&bf.a.$y(l.aB.wyb,a.wyb)||(l.aB.wyb=Number.MAX_VALUE)):l.aB=a,b=Fd.km.zyf(b.CE),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=sQ.WordSectionNavigator.instance.bFe(b),void 0!==b&&null!==b&&(b=Fd.n6e.xta(b)-(Fd.n6e.o8d(b)+Fd.n6e.p8d(b)+Oc.App.fKl),a.SWc=b-a.QN,
a.QWc=b-a.wyb,l.aB.QWc=Math.min(l.aB.QWc,a.QWc),l.aB.SWc=Math.min(l.aB.SWc,a.SWc)))));if(P.a.instance.ga(54)&&P.a.instance.ga(59)||P.a.instance.ga(84))b=Fd.$Zj.LW(c),l.spacing?(l.spacing.beforeSpacing=Fd.lvf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=Fd.lvf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.unit===b.lineSpacing.unit&&bf.a.$y(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.unit=0,l.spacing.lineSpacing.value=0)):l.spacing=b;b=
new tb.GraphIterator;b.set(c);b.rc(11);if(c=b.Jg(11))l.isRtl=fe.OutlineElementReader.vm(c);c=Fd.Sf.jw(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=Fd.$6i(l.listType,b);l.IT=16===l.listType?null:c;return 32}$xj(a,b){return this.Txf(a,b)||this.Txf(b,a)}Txf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}cMk(a,b,c,f,l){a=Ta.OutlineElementNavigator.UA(b.node);l.isRtl=fe.OutlineElementReader.vm(a);return 32}Gxf(a,b,c){if(a===D.a.o0a)a=!0;else if(a===D.a.eLa)a=
!1;else return 2;a&&this.Aoe(b);if(1===c)return 32;b=Ta.OutlineElementNavigator.UA(b.node);Fd.Ph.aLa(b,a);return 32}VLk(a,b,c,f,l){a=b.node;b=Ta.OutlineElementNavigator.UA(a);l.isRtl=fe.OutlineElementReader.isRtl(b);l.Jl=rd.ImageReader.HN(a);return 32}KMk(a,b,c,f,l){a=b.node;b=Ta.OutlineElementNavigator.UA(a);l.isRtl=fe.OutlineElementReader.isRtl(b);l.Jl=od.TableReader.HN(a);if(-1===l.Jl||0===l.Jl)l.Jl=l.isRtl?3:1;return 32}Fxf(a,b,c){if(!({tF:c}=Ig.Eth(c,b)).returnValue)return c;c=b.node;switch(a){case D.a.eLa:case D.a.o0a:c=
Ta.OutlineElementNavigator.UA(c);let f=!0;a===D.a.eLa&&(f=!1);Fd.Ph.aLa(c,f);f&&this.Aoe(b)}return 32}SQd(a,b,c,f,l){let x;if(!({tF:x}=Ig.phl(c,b)).returnValue)return x;const H=b.node;switch(a){case D.a.eLa:Fd.Ph.mMb(H,!1);break;case D.a.o0a:this.Aoe(b);Fd.Ph.mMb(H,!0);break;case D.a.WU:x=u.AFrameworkApplication.Ta.mi(b.CE,a,c,!0,f,l),32===x&&Sb.ParagraphReader.um(b)&&Fd.Gmc&&Fd.Gmc.NR(H)}return 32}nti(a,b,c,f,l){const x={};x[fi.spa]=6168;x[fi.rpa]=6169;var H=b.view;const U=new pf.GraphTransaction(1===
c?3:15);U.kd(H.root);let ja=fi.M5(a,b,c,f,l,x,0),ya=null;H.lp&&(ya=H);H=!0;let Va=null;ya&&(Va=ya.Lb.Na.mb)&&P.a.instance.ga(14)&&(Fd.$i.Gle(Va)?(Fd.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),ja=8,H=!1):1===c&&(ja=32,H=!1));H&&this.dVj(Va)&&(ja=P.a.instance.ga(54)?fi.M5(D.a.b7a,b,c,f,l,x,12):fi.M5(a,b,c,f,l,x,12));U.dispose();return ja}mti(a,b,c){a=!0;b.contextId!==Cb.a.paragraph&&b.contextId!==Cb.a.Pf?a=!1:P.a.instance.ga(14)&&Fd.$i.AFa(b)&&(Fd.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),a=!1);if(1===c||!a)return a?
32:8;b=b.node;c=new pf.GraphTransaction(15);c.kd(b);Fd.eq.rtb(b);Fd.paragraphEditor.Z_b(b,!0);Fd.jP.NJc(b);c.dispose();return 2}eJb(a,b,c,f,l){a=b.contextId===Cb.a.paragraph;if(1===c&&!a)return 8;l.aB||(b=b.node,c=Fd.tM.Rwb(b),l.aB=c,c=new tb.GraphIterator,c.set(b),c.rc(11),b=c.Jg(11),l.isRtl=b?fe.OutlineElementReader.vm(b):!1);return 32}dVj(a){return!a||nb.SelectionEditor.lx(a)||1===a.length&&nb.SelectionEditor.gk(a.Ua)&&!nb.SelectionEditor.mzb(a.Ua)?!1:!0}Aoe(a){Fd.jnf.Hb(a.contextId)||(ia.ULS.sendTraceTag(42276747,
340,50,"RTL Usage : {0}",a.contextId),Fd.jnf.$(a.contextId,!0))}lKj(a){return a===D.a.z_b||a===D.a.btb||a===D.a.ctb||a===D.a.T6a||a===D.a.A_b}lJc(a,b){const c=a.node;b=Fd.uul(c.characterData.substr(a.Qa,a.Mb-a.Qa),b);c.characterData=c.characterData.substr(0,a.Qa)+b+c.characterData.substr(a.Mb);return 32}static get mh(){return Fd.Kf||(Fd.Kf=Db.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Fd.fh||(Fd.fh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Fd.Vw||
(Fd.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}static get $Zj(){return Fd.cOa||(Fd.cOa=Db.a.instance.resolve("Box4.ILineSpacingHelper"))}static get jP(){return Fd.IK||(Fd.IK=Db.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Ph(){return Fd.Di||(Fd.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return Fd.Ht||(Fd.Ht=Db.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get cea(){return Fd.Tob||(Fd.Tob=Db.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get tM(){return Fd.EG||
(Fd.EG=Db.a.instance.resolve("Box4.IParagraphIndentationReader"))}static er(){return Fd.Hm||(Fd.Hm=Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static get km(){return Ih.ContextSetEditor.instance}static get $i(){return fd.a.instance}static get Wc(){return Nc.a.instance}static get ze(){return Fd.hd||(Fd.hd=Db.a.instance.ub("Box4.IFeatureHelper"))}static get Gmc(){return Oc.App.UR}static get Tf(){return Fd.fd||(Fd.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get C6(){return Fd.ap||
(Fd.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get r1e(){return Fd.jPa||(Fd.jPa=Db.a.instance.resolve("Box4.TextFormattingHelper"))}static get Sf(){return Fd.Vg||(Fd.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static get eq(){return Fd.Zo||(Fd.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}static get n6e(){return tQ.a.instance}static $6i(a,b){return 42===a?b:a!==b||16===a?16:a}static lvf(a,b){a.nhg||(b.nhg?b=a:b.unit===a.unit&&bf.a.$y(b.value,
a.value)||(b.value=-1));return b}static uul(a,b){switch(b){case D.a.btb:return a.toLowerCase();case D.a.ctb:return a.toUpperCase();case D.a.z_b:case D.a.T6a:return Fd.Dqi(a,b===D.a.T6a);case D.a.A_b:return Fd.fwl(a);default:return a}}static fwl(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static Dqi(a,b){let c,f,l=!0,x=a.length,H=0,U=Fd.dme(a,H,x);for(;0<x;){f=c=!1;var ja=x;let Va;var ya=void 0;for(ya=
0;0<ja&&Fd.qsi(a.charAt(H+ya));ya++,ja--)f=Fd.V_c(a.charAt(H+ya));for(Va=ya;0<ja&&!(c=Fd.V_c(a.charAt(H+ya)))&&" "!==a.charAt(H+ya)&&"/"!==a.charAt(H+ya);ya++,ja--);ja=ya-Va;if(0>=ja)break;H+=Va;ya=a.substr(H,ja);ya=ya===ya.toUpperCase();if(U||!ya)a=l||f||b?a.substr(0,H)+a.charAt(H).toUpperCase()+a.substr(H+1,ja-1).toLowerCase()+a.substr(H+ja):a.substr(0,H)+a.substr(H,ja).toLowerCase()+a.substr(H+ja);x-=ja+Va;H+=ja;if(l=c)H++,x--,U=Fd.dme(a,H,x)}return a}static dme(a,b,c){for(;0<c&&!Fd.V_c(a.charAt(b));){if(a.charAt(b)!==
a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static ZUj(a){for(var b=0;b<a.length&&!Fd.V_c(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static V_c(a){return"."===a||"!"===a||"?"===a?!0:!1}static qsi(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}Fd.Kf=null;Fd.Di=null;Fd.jnf=new ui.a;Fd.Lf=null;Fd.cOa=null;Fd.fh=null;Fd.Vw=null;Fd.IK=null;Fd.Ht=null;Fd.Tob=null;Fd.EG=null;Fd.Hm=null;Fd.hd=null;Fd.fd=null;Fd.ap=null;Fd.jPa=null;Fd.Vg=
null;Fd.Zo=null;Object(m.a)(Fd,"TextFormattingActor",null,[]);class TI{constructor(a){this.Ca=a}get An(){return this.Ca}MLb(a,b=!1){this.An.mi(a,D.a.oab,2,!0,null,b)}WU(a){this.An.La(D.a.WU,2,a)}}Object(m.a)(TI,"TextFormattingCommands",null,[389]);class du{get spa(){return fi.spa}get rpa(){return fi.rpa}get IPb(){return fi.IPb}M5(a,b,c,f,l,x,H){return fi.M5(a,b,c,f,l,x,H)}ohb(a,b,c,f,l,x){return fi.ohb(a,b,c,f,l,x)}static get instance(){du.Ka||(du.Ka=new du);return du.Ka}}du.Ka=null;Object(m.a)(du,
"ViewActionHandlerProxy",null,[476]);class UI{constructor(a){this.Ca=a}get An(){return this.Ca}Kmk(a){if(4===a)a=D.a.leftArrow;else if(2===a)a=D.a.rightArrow;else if(1===a)a=D.a.upArrow;else if(3===a)a=D.a.downArrow;else return;this.An.processAction(a,2)}Ksa(){this.An.processAction(D.a.Ksa,2)}}Object(m.a)(UI,"SelectionCommands",null,[388]);class VI{Sg(a,b){return Qd.SelectionFactory.Sg(a,b)}DN(a,b){return Qd.SelectionFactory.DN(a,b)}Du(a,b=!0){return Qd.SelectionFactory.Du(a,b)}f3(a,b,c){return Qd.SelectionFactory.f3(a,
b,c)}wl(a){return Qd.SelectionFactory.wl(a)}OOb(a,b,c=!1){return Qd.SelectionFactory.OOb(a,b,c)}}Object(m.a)(VI,"SelectionFactoryProxy",null,[375]);var uQ=d(880),xx=d(251),wz=d(1005);class WI extends wz.a{constructor(a,b,c,f,l,x,H=null,U=null){super(a,x,H,U);this.mo=this.Vw=this.s2=null;this.cqa=!1;this.b3a=u.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.f4a=0;this.SLd=new Ka.a;$e.a(8128527,307,fe.OutlineElementReader.Yg(a));this.qF=b;this.qF.jsb(this);this.KCd=c;this.Zo=
f;this.Vg=l;this.uEk=U;this.XHd=rb.ListReader.uk(this.Ab)}get b9(){return this.s2||(this.s2=Db.a.instance.ub("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.Vw||(this.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}get cRa(){return null}get w7a(){return this.XHd&&!this.qF.Mca}get L7a(){return 0<this.f4a}get Av(){return this.KCd}get eq(){return this.Zo}get Sf(){return this.Vg}get gIc(){return this.uEk}U0(a,b){if(!this.iZ.l3e(b)){$e.a(8701077,307,Sb.ParagraphReader.el(this.Ab));var c=
this.Ab.currentNode,f=Wd.a.SQa(c);this.b3a&&this.mo.c9a&&(c=c.Ra.last,this.cqa&&(c.formatting=this.mo.c9a.ae(c),this.cqa=!1),a=this.iZ.lbe(a,b),this.iZ.Foa(this.Ab.currentNode,this.mo.Cfa,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}Bna(){$e.a(8701078,307,Sb.ParagraphReader.el(this.Ab));const a=Wd.a.SQa(this.Ab.currentNode);this.characterPropertiesEditor.hXc(a,b=>new vv.a(b,vv.a.BMc),Mb.AParagraphNode.h_)}jZa(){}zna(){this.b3a&&(this.cqa=!0)}cxa(){$e.a(8701079,307,Sb.ParagraphReader.el(this.Ab))}bxa(){$e.a(8701080,
307,Sb.ParagraphReader.el(this.Ab))}uA(a){this.qF.Mca||(this.b3a?(this.EQd(a),this.mo.xtd(this.Ab.currentNode),a&&"P"===a.BU.i8b&&this.gIc.ZKa(this.Ab.currentNode,this.mo.Vgd),this.iZ.Foa(this.Ab.currentNode,this.mo.Cfa,a)):this.Ihi(a))}tA(){this.qF.Mca||this.o3()}hxa(){}lJa(){}Ena(){$e.a(8701081,307,fe.OutlineElementReader.Yg(this.Ab)||gj.OutlineReader.Zt(this.Ab)||Sb.ParagraphReader.el(this.Ab)&&this.qF.Mca);let a=!1;this.L7a||(a=this.w7a||!0);a||(this.vM+=1);this.f4a++}Cna(){this.f4a--;let a=!1;
this.L7a||(a=this.w7a||!0);a||--this.vM}gxa(a){$e.a(8701082,307,fe.OutlineElementReader.Yg(this.Ab)||gj.OutlineReader.Zt(this.Ab)||Sb.ParagraphReader.el(this.Ab)&&this.qF.Mca);$e.a(8701083,307,0!==a.listStyleType)}Dna(){$e.a(8701084,307,fe.OutlineElementReader.Yg(this.Ab)||Sb.ParagraphReader.el(this.Ab)&&this.qF.Mca);this.qF.Mca||$e.a(8701085,307,this.Ab.NI(2))}pY(a){this.qF.pY(a)}mY(){this.qF.mY()}jtd(a){this.SLd.add(a)}oY(a){this.qF.oY(a)}nY(){this.qF.nY()}lY(a){this.qF.lY(a)}kY(){this.qF.kY()}Ihi(a){this.oGb(!1);
(new tb.GraphIterator).Rc(this.Ab);a=wz.a.Ph.Hca(this.Ab,this.XSa(a));$e.a(8128534,307,a===this.Ab.currentNode);$e.a(8128535,307,Sb.ParagraphReader.$d(a))}o3(){$e.a(8128536,307,Sb.ParagraphReader.el(this.Ab));Ta.OutlineElementNavigator.Re(this.Ab)}reset(){this.b3a&&(super.reset(),this.mo=this.x6d(!0))}EQd(a){this.oGb(!1);(new tb.GraphIterator).Rc(this.Ab);a=wz.a.Ph.Hca(this.Ab,this.XSa(a));$e.a(36577367,307,a===this.Ab.currentNode);$e.a(36577368,307,Sb.ParagraphReader.$d(a));-1!==this.mo.jE&&this.paragraphEditor.ZJ(a,
this.mo.jE);this.mo.lineSpacing&&this.gIc.w1(a,this.mo.lineSpacing);this.mo.kga&&this.gIc.Brh(a,this.mo.kga);this.mo.F1c&&this.gIc.rqh(a,this.mo.F1c);this.cqa=!0;this.mo.paragraph=a}static ZWd(a,b){let c=0;switch(b){case 3:c=ye.a.Tta(a);break;case 7:c=Rf.a.Gfa(a,0);break;case 1:c=ye.a.rUd(a);break;case 5:c=ye.a.Tta(ye.a.Shd(a));break;default:ia.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(m.a)(WI,"TextOnlyBox4PasteSteward",
wz.a,[]);class DC{constructor(a,b,c,f){this.pVb=a;this.Zo=b;this.Vg=c;this.iZ=f}create(a,b,c,f,l=null,x=null){return 1===a?new WI(b,f,this.pVb,this.Zo,this.Vg,l,x,this.iZ):new xx.Box4PasteSteward(b,c,f,this.pVb,this.Zo,this.Vg,l,x,this.iZ)}}Object(m.a)(DC,"Box4PasteStewardFactory",null,[474]);class Wg{static get Yzj(){return Wg.HSh}static get dAj(){return Wg.KSh}static get cAj(){return Wg.JSh}static kKk(a,b){const c=a.currentNode;Vd.forEachCell(a,b.rowSpan,b.colSpan,(f,l,x)=>{const H=f.currentNode;
H!==c&&(H.isGhostCell=!0,Wg.ONf(f),!x&&1<=b.colSpan&&(H.colSpan=b.colSpan),Wg.Yph(f,b.s6,l,x,b.rowSpan,b.colSpan))})}static FKk(a,b){Vd.forEachCell(a,b.rowSpan,b.colSpan,c=>{Wg.Rei(c);Wg.ONf(c)})}static Rei(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.jkb=!0}static ONf(a){a&&(a.Bb(1),Object(Xa.a)(uI.a,a.currentNode)&&a.Mi())}static ifi(a,b,c){0<b&&(a=Object(oa.a)(wx.TableCellNode,a.currentNode))&&(a.width=c?b:Rf.a.rf(b,0))}static uei(a,b,c){if(a=Object(oa.a)(By.a,a.currentNode))0<b&&(a.$l=
Rf.a.Gfa(b,0)),0<c&&(a.sY=Rf.a.Gfa(c,0))}static Jxf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(ab.a.F0e,Wg.dAj[b+""])}static wxf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue($a.a.jJc,parseInt(xx.Box4PasteSteward.y7a(b),16))}static snj(a){const b=new tb.GraphIterator;b.Rc(a);return(a=kh.OutlineNavigator.qmd(b))&&gj.OutlineReader.Zt(b)?a.Lh(ab.a.zR)-a.Lh(ab.a.marginLeft)-a.Lh(ab.a.marginRight):0}static ZSj(a){return!(void 0===a||null===a||1===a)}static J9k(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=ye.a.Rhd(.25);break;case "initial":case "medium":b=ye.a.Rhd(.5);break;case "thick":b=ye.a.Rhd(1);break;default:b=Wg.Akj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static XUe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,Wg.cAj[b+""])}static I9k(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(xx.Box4PasteSteward.y7a(b),16))}static Akj(a,b,c){let f=0;const l=({unit:a}=xx.Box4PasteSteward.ehd(a)).returnValue;
switch(a){case 5:f=ye.a.Rhd(l);break;case 1:f=ye.a.kqi(l);break;case 3:f=ye.a.Edg(l);break;case 7:f=Rf.a.OEk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static Bkj(a,b){let c=0;const f=({unit:a}=xx.Box4PasteSteward.ehd(a)).returnValue;switch(a){case 5:c=ye.a.GH(f);break;case 1:c=ye.a.lqi(f);break;case 3:c=ye.a.OW(f);break;case 7:c=Rf.a.rf(f,b)}return c}static qod(a,b,c,f,l,x,H){if(l&&(!H||16===l.ri||H||14!==l.ri)&&12!==c){if(H)switch(f){case 7:f=ab.a.iAh;var U=ab.a.kAh;var ja=ab.a.jAh;
var ya=0;break;case 6:f=ab.a.fAh;U=ab.a.hAh;ja=ab.a.gAh;ya=1;break;case 0:f=ab.a.Wzh;U=ab.a.Yzh;ja=ab.a.Xzh;ya=0;break;case 5:f=ab.a.cAh;U=ab.a.eAh;ja=ab.a.dAh;ya=1;break;default:return}else switch(f){case 7:f=ab.a.Xsl;U=ab.a.Zsl;ja=ab.a.Ysl;ya=0;break;case 6:f=ab.a.Usl;U=ab.a.Wsl;ja=ab.a.Vsl;ya=1;break;case 0:f=ab.a.Osl;U=ab.a.Qsl;ja=ab.a.Psl;ya=0;break;case 5:f=ab.a.Rsl;U=ab.a.Tsl;ja=ab.a.Ssl;ya=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(Wg.ZSj(c)?(Wg.I9k(f,a,l),Wg.XUe(U,
c,l),Wg.J9k(ja,b,c,ya,l)):x||H||l.currentNode.properties.setValue(U,"nil"))}}static Yph(a,b,c,f,l,x){f||(Wg.qxf(b,a,!1,!1),Wg.VQd(b,a,!0,!1));f===x-1&&Wg.VQd(b,a,!0,!1);c||Wg.Hxf(b,a,!0,!1);c===l-1&&Wg.kxf(b,a,!0,!1)}static ixf(a,b,c,f){a&&(Wg.Hxf(a,b,c,f),Wg.VQd(a,b,c,f),Wg.kxf(a,b,c,f),Wg.qxf(a,b,c,f))}static Hxf(a,b,c,f){Wg.qod(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static VQd(a,b,c,f){Wg.qod(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static kxf(a,b,
c,f){Wg.qod(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static qxf(a,b,c,f){Wg.qod(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static rod(a,b,c){if(c&&16===c.ri&&""!==a){switch(b){case 3:b=ab.a.SNb;var f=0;break;case 2:b=ab.a.RNb;f=1;break;case 0:b=ab.a.ONb;f=0;break;case 1:b=ab.a.PNb;f=1;break;default:return}(a=Wg.Bkj(a,f))&&c.currentNode.properties.setValue(b,a)}}static eei(a,b){b&&(Wg.dfi(b,a),Wg.Lei(b,a),Wg.fei(b,a),Wg.zei(b,a))}static dfi(a,b){Wg.rod(a.fqi,
3,b)}static Lei(a,b){Wg.rod(a.eqi,2,b)}static fei(a,b){Wg.rod(a.cqi,0,b)}static zei(a,b){Wg.rod(a.dqi,1,b)}}Wg.Cnk=8;Wg.cKi="Table Grid";Wg.HSh=pa.a.QH("MsoNormalTable","Normal Table","MsoTableGrid",Wg.cKi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1",
"MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4",
"Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1",
"Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4",
"Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5",
"MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6",
"MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2",
"List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6",
"List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2",
"MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4",
"List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5",
"List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");Wg.KSh=pa.a.QH("0","center","1","top","2","center","3","bottom");Wg.JSh=pa.a.QH("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(m.a)(Wg,"Box4TableStewardHelper",null,[]);class yx{constructor(a,b,c,f=!1,l=!1,x=!1){this.Vv=null;this.g4a=0;this.Ab=a;this.eq=b;this.Rq=c;this.tqb=f;this.zVb=l;this.UHd=
x}jsb(a){this.Vv=a}get Mca(){return 0<this.g4a}pY(a){$e.a(7869459,307,!!this.Vv);$e.a(7869460,307,fe.OutlineElementReader.Yg(this.Ab)||gj.OutlineReader.Zt(this.Ab));$e.c(38563978,307,50,"Table pasting started");this.Vv.oGb(!0);const b=new tb.GraphIterator;b.Rc(this.Ab);Object(oa.a)(String,Wg.Yzj[a.Zyh]);const c=this.Rq.uSk(this.Ab,a.DY,a.Wra,this.Vv.XSa(a),a.Kgg);if(this.tqb&&($e.c(23938568,307,50,a.EQa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.C0e&&Wg.ixf(a.C0e,this.Ab,
!1,!0),Wg.uei(this.Ab,a.Mde.Nol,a.Mde.Mol),a.EQa)){var f=0;const U=Array(a.EQa.length);var l=0;a.FFa&&P.a.instance.ga(63)&&(l=(l=ye.a.MEh(Wg.snj(this.Ab)))?l:1);for(var x=0;x<a.EQa.length;x++)U[x]=0<l?l/100*a.EQa[x]:Rf.a.rf(a.EQa[x],0),f+=U[x];l=c.eb($a.a.Zu);var H=new tb.GraphIterator;H.Rc(this.Ab);a=0;if(Le.isInTableCell(H)){if(l=Vd.returnToContainingCell(H))a=l.width;x=Hn.a(H);H=Vd.returnToContainingTable(H);if(-1!==x&&x<=H.HQa.length){let ja=0;for(let ya=x;ya<x+l.colSpan&&ya<H.HQa.length;ya++)ja+=
H.HQa[ya];a=Math.min(a,ja);a===ja&&(a-=Rf.a.rf(Wg.Cnk,0))}}else if(l)for(x=0;x<l.length;x++)a+=l[x];if(0<a&&f>a&&f)for(f=a/f,a=0;a<U.length;a++)U[a]*=f;c.setValue($a.a.Zu,U)}this.Vv.yHc(b,!1);this.g4a++;P.a.instance.ga(63)&&rb.ListReader.uk(b)&&this.Vv.jtd(b.currentNode);$e.a(7869461,307,od.TableReader.aq(this.Ab))}mY(){$e.a(7869462,307,!!this.Vv);$e.a(7869463,307,tk.l(this.Ab));$e.c(38563979,307,50,"Table pasting finished");Ta.OutlineElementNavigator.Re(this.Ab);this.g4a--}oY(a){$e.a(7869464,307,
!!this.Vv);od.TableReader.aq(this.Ab)?Vd.moveToFirstRow(this.Ab):tk.l(this.Ab)&&Vd.moveToNextRow(this.Ab);this.tqb&&a.height&&this.Ab.currentNode.setValue(ab.a.su,Rf.a.rf(a.height,1));$e.a(7869465,307,tk.l(this.Ab))}nY(){$e.a(7869466,307,!!this.Vv);$e.a(7869467,307,Le.isTableCell(this.Ab));Vd.returnToContainingRow(this.Ab)}lY(a){$e.a(7869468,307,!!this.Vv);$e.a(7869469,307,!this.Vv.vM);tk.l(this.Ab)?Vd.moveToFirstColumn(this.Ab):Le.isTableCell(this.Ab)?Vd.moveToNextColumn(this.Ab):$e.a(7869471,307,
!1);u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");if(this.zVb){if(!this.Ab.currentNode)return;var b=Object(oa.a)(wx.TableCellNode,this.Ab.currentNode);$e.a(50689760,307,!b&&16!==this.Ab.currentNode.type||!!b&&16===this.Ab.currentNode.type);if(!b)return;let c=new tb.GraphIterator;c.Rc(this.Ab);if(!a.colSpan||!a.rowSpan)return;if(a.jAb){Wg.FKk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=Vd.returnToContainingTable(c);if(!f)return;f.setValue(ab.a.complexTable,
!0);c.Rc(this.Ab);Wg.kKk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.tqb&&(Wg.wxf(this.Ab,a.Aqc),Wg.Jxf(this.Ab,a.verticalAlignment),this.UHd&&Wg.eei(this.Ab,a.$rd));this.zVb&&Wg.ixf(a.s6,this.Ab,!a.colSpan&&!a.rowSpan,!1);this.tqb&&(this.zVb||(b=new tb.GraphIterator,b.Rc(this.Ab),Vd.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{Wg.wxf(c,a.Aqc);Wg.Jxf(c,a.verticalAlignment);Wg.Yph(c,a.s6,f,l,a.rowSpan,a.colSpan)})),Wg.ifi(this.Ab,a.width,a.FFa));$e.a(7869472,307,gj.OutlineReader.Zt(this.Ab))}kY(){$e.a(7869473,
307,!!this.Vv);$e.a(7869474,307,fe.OutlineElementReader.Yg(this.Ab)||Le.isTableCell(this.Ab));Vd.returnToCell(this.Ab);$e.a(7869475,307,0>=this.Vv.vM);this.Vv.fVd()}static get Ph(){return yx.Di||(yx.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}}yx.Di=null;Object(m.a)(yx,"Box4TableSteward",null,[506,507]);class eu{constructor(a,b,c){this.Vv=null;this.g4a=0;this.Ab=a;this.eq=b;this.Rq=c}jsb(a){this.Vv=a}get Mca(){return 0<this.g4a}pY(){this.Mca&&($e.a(8787101,307,Sb.ParagraphReader.el(this.Ab)),
Ta.OutlineElementNavigator.Re(this.Ab));$e.a(8701086,307,!!this.Vv);$e.a(8701087,307,fe.OutlineElementReader.Yg(this.Ab)||gj.OutlineReader.Zt(this.Ab));this.g4a++}mY(){$e.a(8701088,307,!!this.Vv);Ta.OutlineElementNavigator.Re(this.Ab);this.g4a--;if(this.Mca){this.Vv.oGb(!0);const a=eu.Ph.Hca(this.Ab);$e.a(8787102,307,a===this.Ab.currentNode);$e.a(8787103,307,Sb.ParagraphReader.el(this.Ab))}}oY(a){$e.a(8701089,307,!!this.Vv);this.Vv.oGb(!0);const b=new tb.GraphIterator;b.Rc(this.Ab);this.Vv.yHc(b,
!1);P.a.instance.ga(63)&&rb.ListReader.uk(b)&&this.Vv.jtd(b.currentNode);a=eu.Ph.Hca(this.Ab,this.Vv.XSa(a));$e.a(8701090,307,a===this.Ab.currentNode);$e.a(8701091,307,Sb.ParagraphReader.el(this.Ab))}nY(){$e.a(8701120,307,!!this.Vv);$e.a(8701121,307,Sb.ParagraphReader.el(this.Ab));Ta.OutlineElementNavigator.Re(this.Ab)}lY(){$e.a(8701122,307,!!this.Vv);$e.a(8701123,307,Sb.ParagraphReader.el(this.Ab));$e.a(8701124,307,!this.Vv.vM);var a=this.Ab.currentNode;Sb.ParagraphReader.textLength(a)&&(a=Wd.a.SQa(a),
this.Vv.characterPropertiesEditor.replaceTextRange(a,", "))}kY(){$e.a(8701125,307,!!this.Vv);$e.a(8701126,307,Sb.ParagraphReader.el(this.Ab));$e.a(8701127,307,0>=this.Vv.vM);this.Vv.fVd()}static get Ph(){return eu.Di||(eu.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}}eu.Di=null;Object(m.a)(eu,"TextOnlyBox4TableSteward",null,[506,507]);class EC{constructor(a,b,c=!1,f=!1,l=!1){this.Zo=a;this.HD=b;this.tqb=c;this.zVb=f;this.UHd=l}create(a,b){return 1===a?new eu(b,this.Zo,this.HD):new yx(b,
this.Zo,this.HD,this.tqb,this.zVb,this.UHd)}}Object(m.a)(EC,"Box4TableStewardFactory",null,[475]);class XI{create(){return new tn.a}}Object(m.a)(XI,"Factory",null,[376]);var FC=d(1078);class YI{constructor(){this.thd=null;this.cKe=0}}Object(m.a)(YI,"PasteFloatieAnchorData",null,[]);class ZI extends As{constructor(a,b){super(a,b)}R4b(){return["PasteText"]}}Object(m.a)(ZI,"PasteTextFloatie",As,[]);class $I{constructor(a,b,c,f,l,x,H,U){this.JFg=0;this.Axe=this.VCb=this.kbd=!1;this.X6j=100;this.Dmi=61;
this.vni="PasteTextControl";this.Vkl=(ja,ya)=>{this.showFloatie(ya)};this.ZMi=(ja,ya)=>{this.qC(ya)};this.XTi=()=>{this.ITf()};this.u2g=()=>{FC.a.instance.keyCode===A.a.cba&&this.ITf()};this.k1=()=>{!this.VCb&&this.a0.Tka&&this.kJi()};this.iY=()=>{this.z_()||this.qC(new zc(!0))};this.a0=b;this.qWa=a;this.hA=c;this.Bhk=f;this.wze=l;this.pa=x;this.N9c=H;this.Vb=U}get Mua(){return this.JFg}set Mua(a){this.JFg=a}vVk(){this.wze.O$h(this.Vkl);this.wze.W9h(this.ZMi);this.wze.b$h(this.XTi)}wVk(){this.kbd||
(this.pa.wF(this.iY),this.Vb.wq.mca(this.k1),this.N9c.tPd(this.u2g),this.kbd=!0)}FBl(){this.kbd&&(this.pa.jRe(this.iY),this.Vb.wq.tKa(this.k1),this.N9c.PYk(this.u2g),this.kbd=!1)}D5(a){2===a.behavior&&(a=a.actionId,a!==D.a.bold&&a!==D.a.centerJustify&&a!==D.a.Sr&&a!==D.a.v1&&a!==D.a.aja&&a!==D.a.setItalic&&a!==D.a.leftJustify&&a!==D.a.Pq&&a!==D.a.NH&&a!==D.a.bH&&a!==D.a.strikethrough&&a!==D.a.rightJustify&&a!==D.a.fullJustify&&a!==D.a.underline&&a!==D.a.By&&a!==D.a.oC&&a!==D.a.NM&&a!==D.a.mP&&a!==
D.a.subscript&&a!==D.a.superscript&&a!==D.a.font&&a!==D.a.paste&&a!==D.a.L5||this.qC(new zc(!0)))}C5(){}showFloatie(a){if((this.VCb||!this.a0.Tka)&&a){this.oyg||(this.oyg=new ZI(this.a0,this.qWa));var b=a.location?a.location:this.Lwb();b&&(this.oyg.uYe(b,a.Hu),this.wVk(),this.VCb=!1)}}qC(a){this.VCb&&!this.a0.Tka||!a||(this.a0.qC(),this.VCb=!0,a.n3d&&(this.Mua=null,this.FBl()))}Lwb(){var a=this.cfj();if(!a||!a.thd)return null;const b=this.hA.Pd;if(!b)return null;a=this.Y$i(a,b);if(!a)return null;
u.AFrameworkApplication.isRtl&&(a.x-=this.O1f().width);return new Sys.UI.Point(a.x+a.width,a.y+a.height)}cfj(){if(!this.pa||!this.pa.Na||!this.pa.Na.mb)return null;var a=this.pa.Na.mb.Ua;const b=!a.Qa&&!a.Mb;let c=a.node;if(c&&b){do c=this.Rfj(c);while(c&&c instanceof Mb.AParagraphNode&&!c.characterData.trim().length)}let f="";const l=c;l&&(f=l.characterData.length===a.Qa||b?l.characterData.trimEnd():l.characterData.substring(0,a.Qa).trimEnd());a=l?f.length:a.Qa;return Object.assign(new YI,{thd:l?
l:c,cKe:a})}Rfj(a){const b=new tb.GraphIterator;if(!a.anchor)return null;b.set(a);if(!b.$e())return null;b.Jg(11);return b.Jta()?b.Bb(2):null}O1f(){const a=document.getElementById(this.vni);if(!a)return null;const b=a.style.visibility,c=a.style.display;a.style.visibility="hidden";a.style.display="";const f=Od.a.$h(a);a.style.display=c;a.style.visibility=b;return f}Y$i(a,b){b=a.thd.mg(b.Ma);if(!b)return null;let c=null;if(a.thd instanceof Mb.AParagraphNode){if(!b)return null;try{c=this.Bhk.jW(a.cKe,
b,0<a.cKe,!1,!1,!1),c.height+=this.Dmi}catch(f){c=null}}c||(c=b.getBounds());return c}ITf(){if(this.a0.Tka){var a=document.getElementById("PasteTextFloatie");a&&(a.getAttribute(Cc.a.s6a)||"")===Cc.a.Iia&&a.click()}}z_(){return this.Xz()&&(nb.SelectionEditor.Yt(this.pa.Na.mb.Ua)||this.pa.Na.mb.Ua.contextId===Cb.a.paragraph||this.pa.Na.mb.Ua.contextId===Cb.a.endOfParagraph)}Xz(){if(!this.pa.Na||!this.pa.Na.mb)return!1;const a=this.pa.Na.mb;return!!a&&a.Ua.contextId!==Cb.a.outline&&a.Ua.contextId!==
Cb.a.notes}kJi(){if(!this.Axe){const a=new af.a(3,1,this.X6j,()=>{this.CDl();this.Axe=!1},215);gm.a.instance.Db(a);this.Axe=!0}}CDl(){!this.VCb&&this.a0.Tka&&(this.qC(new zc(!1)),this.showFloatie(new bj(1,u.AFrameworkApplication.isRtl)))}}Object(m.a)($I,"TextPasteFloatieManager",null,[368,141]);class aJ{Zb(a){a.register(DC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().oa(()=>new DC(jv.a.bxb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),
a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(eC,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().oa(()=>new eC(u.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(NH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().oa(()=>new NH.ClipboardActor(a.ie("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),Nc.a.instance,a.resolve("Box4.IClipboardDataHelper"),qd.a.instance,u.AFrameworkApplication.Ta,
a.resolve("Box4.IUndoManager"),u.AFrameworkApplication.fa));u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a.register(368,"Box4.ITextPasteFloatieManager").ma().oa(()=>new $I(a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Common.IReactContextualUILauncher"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.ITextMetricsAdapter"),a.resolve("Box4.IPasteFloatieEventHandler"),qd.a.instance,a.resolve("Common.PressOnlyKeyEvent"),Oc.App.Kb.Kd));a.register(369,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().oa(()=>
new dB(u.AFrameworkApplication.fa));a.register(370,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().oa(()=>new LI(u.AFrameworkApplication.fa,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),nd.a.instance));a.register(371,"Box4.Clipboard.ISystemClipboardAccessManager").ma().oa(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(372,"Box4.Actors.ISystemClipboard").ma().oa(()=>new HI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),
sa.InteractiveViewManager.instance,Oc.App.Kb.Kd,v.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),nd.a.instance));a.register(373,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new QH);a.register(374,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>new MI);a.register(375,"Box4.ISelectionFactory").ma().oa(()=>new VI);a.register(376,"Box4.IRenderOrderGraphIteratorFactory").ma().oa(()=>new XI);a.register(377,"Common.IDomElementContentStateFactory").ma().oa(()=>
new uH);a.register(378,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().oa(()=>new bI(qd.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),P.a.instance.ga(71)));a.register(yC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().oa(()=>new yC(a.resolve("Box4.IClipboardDataHelper"),Oc.App.OD.QS));a.register(379,"Box4.Actors.IClipboardOperationPasteFactory").ma().oa(()=>new $H(Nc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),
me.a.instance,qd.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.ie("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(380,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new PH(u.AFrameworkApplication.Ta,Nc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
qd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),yj.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper")));a.register(381,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().oa(()=>new OH(Nc.a.instance,
nd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),u.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(382,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().oa(()=>new eI(u.AFrameworkApplication.fa));a.register(383,"Box4.Actors.IClipboardOperationFactory").ma().oa(()=>new YH(a.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.mqd()&&!(B.a.wT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),
Nc.a.instance,yj.a.instance,nd.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(384,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().oa(()=>new pI(a.ie("Box4.Actors.IBox4PasteStewardFactory"),a.ie("Box4.Actors.IBox4ImageStewardFactory"),a.ie("Box4.Actors.IBox4TableStewardFactory"),a.ie("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),
a.resolve("HtmlImport.IHtmlNormalizerSettings")));a.register(Th,"Box4.Actors.InternalClipboard").ma().oa(()=>new Th(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Oc.App.lP,a.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),
a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").Xoh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(385,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().oa(()=>new CI(a.resolve("Box4.Actors.InternalClipboard"),new mc.a(()=>Oc.App.Kb.Kd.Dn)));a.register(386,"Box4.List.IListCommands").ma().oa(()=>new NI(u.AFrameworkApplication.Ta));a.register(Zr,"Box4.Actors.PasteCoordinator").ma().oa(()=>
new Zr(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));P.a.instance.ga(78)||a.register(EC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>new EC(Db.a.instance.resolve("Box4.List.IListEditor"),Db.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(qC,"Box4.Actors.ClipboardOperationWordStrategy").ma().oa(()=>new qC(Nc.a.instance,qd.a.instance,Oc.App.Ih,fd.a.instance,P.a.instance.ga(14),P.a.instance.ga(50)));a.register(nC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().oa(()=>new nC(u.AFrameworkApplication.fa));a.register(387,"Box4.Actors.IExternalPasteCssConverter").ma().oa(()=>new fI(u.AFrameworkApplication.fa));
a.register(388,"Box4.ISelectionCommands").ma().oa(()=>new UI(u.AFrameworkApplication.Ta));a.register(389,"Box4.ITextFormattingCommands").ma().oa(()=>new TI(u.AFrameworkApplication.Ta));a.register(cC,"Box4.Actors.AccessibilityActor").ma().oa(()=>new cC(a.Ja("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(vq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().oa(()=>new vq(a.ub("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));
a.register(BC,"Box4.Actors.ProofingActor").ma().oa(()=>new BC(Db.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.Ta,()=>Db.a.instance.resolve("Box4.UI.ILanguageDialog"),Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Db.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),qd.a.instance,Db.a.instance.Ja("Box4.IExternalSelectionManager"),yj.a.instance,Db.a.instance.resolve("Box4.ISelectionContextMenuProvider"),fd.a.instance,Nc.a.instance,Db.a.instance.resolve("Box4.IContextMenuController"),
Db.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Db.a.instance.Ja("Box4.Actors.IProofingErrorPresenter"),P.a.instance));a.register(CC,"Box4.Actors.StyleActor").ma().oa(()=>new CC(Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Db.a.instance.resolve("Box4.Styles.IStyleEditor"),uQ.a.instance,Db.a.instance.resolve("Box4.IFormattingEditor"),Ih.ContextSetEditor.instance,Db.a.instance.resolve("Box4.IInsertionPointFormatting"),fd.a.instance,Nc.a.instance,Db.a.instance.resolve("Box4.TextFormattingHelper"),
du.instance));a.register(Fd,"Box4.Actors.TextFormattingActor").ma().oa(()=>new Fd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),sa.InteractiveViewManager.instance));a.register(dC,"Box4.Actors.AutoCorrectActor").ma().oa(()=>new dC(u.AFrameworkApplication.Ta,Nc.a.instance,()=>Db.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(m.a)(aJ,
"Box4ActorsComponentConfiguration",null,[3]);const wQ=(a,b,c)=>Oc.App.D_d?8:2===c?(a=new jj.StandardDialog,a.xd=4,a.xya(1),a.Xe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Xe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.dml(vQ),32):2,vQ=a=>{1===a&&u.AFrameworkApplication.Ta.processAction(D.a.o0d,2)},bJ=(a,b,c)=>{if(Oc.App.D_d)return 8;if(1===c)return b.node.Sa($a.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===Cb.a.view&&b.view.Lb&&(b=b.view.Lb.Pj),Fb.EmbeddedFileReader.pMj(b))){a=
Fb.EmbeddedFileReader.X6d(b.node);ki.a.afl();try{xQ(a)}catch(f){ia.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},xQ=a=>{if(1!==Oc.App.mode||!u.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||u.AFrameworkApplication.fa.ka("IsTeamsSession")&&B.a.wT)window.open(a);else{var b=(new Ee.QueryStringBuilder(a)).Pej(),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const H=c.response;let U=b;U||(U="GetImage",
H.type&&-1!=H.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(ja=>{-1!=H.type.indexOf(ja)&&(U="GetImage."+ja)}));U=decodeURIComponent(escape(U));if(B.a.yT)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(H,U):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(H),x=document.createElement("a");x.href=l;x.download=U;document.body.appendChild(x);x.click();setTimeout(()=>{document.body.removeChild(x);f.revokeObjectURL(l)},0)}}catch(H){window.open(a)}};
c.send()}};var yQ=d(556),wq=d(1229),wv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(wv||(wv={}));Object(m.b)("ColorMenuControls",wv);class zx{constructor(a){this.PUb=this.QUb=null;this.Lwc={};this.z2=a}Z8b(){this.PUb=this.QUb=null}KYf(a,b){if(this.PUb)return this.PUb;if(!a)return null;const c=Object.assign(new tm.a,{Id:String.format("menu{0}Color",this.z2),ExternalId:String.format("{0}Color",
this.z2)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.s4h());Array.add(c.MenuSectionList,this.B4h());Array.add(c.MenuSectionList,this.T7h(a,b));Array.add(c.MenuSectionList,this.B7h());return this.PUb=c}uCi(a,b){if(this.QUb)return this.QUb;a=this.KYf(a,b);return this.QUb=nj.l(a)}ZFc(a,b){wv[a]in this.Lwc||(this.Lwc[wv[a]]=b)}X7h(a){a.Zrf(Object(F.a)(this,this.Z8b,"invalidateMenu"),1)}s4h(){if(!({actionId:b}=this.Btd(1)).returnValue)return null;const a=Object.assign(new hk.a,{Id:String.format("{0}Color",
this.z2),ControlsId:String.format("{0}.Color.Menu.Controls",this.z2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new fg.a,{Command:b.toString(),LabelText:ha.a.ue(Box4Intl.Box4Strings.L_Automatic),Image16by16:u.AFrameworkApplication.rm,Image16by16Class:Ro.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(a.ControlList,b);return a}B4h(){if(!({actionId:b}=this.Btd(2)).returnValue)return null;const a=Object.assign(new hk.a,{Id:String.format("{0}Color",
this.z2),ControlsId:String.format("{0}.Color.Menu.Controls",this.z2),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new fg.a,{Command:b.toString(),LabelText:ha.a.ue(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:u.AFrameworkApplication.rm,Image16by16Class:Ro.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(a.ControlList,b);return a}T7h(a,b){if(!({actionId:f}=this.Btd(3)).returnValue)return null;const c=Object.assign(new hk.a,{Id:"Colors",
ControlsId:String.format("{0}.Color.Menu.Controls",this.z2),ControlList:[]});var f=Object.assign(new $y.a,{Id:String.format("Theme{0}ColorPicker",this.z2),ExternalId:String.format("Theme{0}ColorPicker",this.z2),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.z2),McuLayout:!0,Command:f.toString(),Width:10});f.Colors=zx.mmj(a,b);Array.add(c.ControlList,f);return c}B7h(){if(!({actionId:b}=this.Btd(4)).returnValue)return null;const a=Object.assign(new hk.a,{Id:String.format("{0}Colors",this.z2),
ControlsId:String.format("{0}.Color.Menu.Controls",this.z2),Title:ha.a.ue(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new $y.a,{Id:String.format("Standard{0}ColorPicker",this.z2),ExternalId:String.format("Standard{0}ColorPicker",this.z2),Command:b.toString(),Width:10,Colors:[]});b.Colors=zx.qkj();Array.add(a.ControlList,b);return a}Btd(a){a=wv[a];return a in this.Lwc?{returnValue:!0,actionId:this.Lwc[a]}:{returnValue:!1,actionId:0}}static qkj(){const a=[];a.push(Object.assign(new wq.a,
{Color:"0000C0",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new wq.a,{Color:"0000FF",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new wq.a,{Color:"00C0FF",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));a.push(Object.assign(new wq.a,{Color:"00FFFF",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new wq.a,{Color:"50D092",
Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new wq.a,{Color:"50B000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new wq.a,{Color:"F0B000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));a.push(Object.assign(new wq.a,{Color:"C07000",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new wq.a,{Color:"602000",
Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new wq.a,{Color:"A03070",Alt:ha.a.ue(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static mmj(a,b){const c=a.properties.sa(ab.a.themeColors,null);a=a.properties.eb(ab.a.HBh).split(" ");const f=Array(10);f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=Box4Intl.Box4Strings.l_ThemeLabel5;
f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let U=0;6>U;U++)for(let ja=0;10>ja;ja++){var x=10*U+ja,H=c[x];x=x+1<<24;H=H&4278190080|(H&255)<<16|H&65280|(H&16711680)>>>16;const ya=zx.vwl(f,U,ja,b[a[ja]],c[ja]);l.push(Object.assign(new wq.a,{Color:ha.a.hw(x,8),DisplayColor:"#"+ha.a.hw(H,6),Alt:ha.a.ue(ya)}))}return l}static vwl(a,
b,c,f,l){if(b){var x=l&255,H=(l&65280)>>>8;l=(l&16711680)>>>16;x=Math.floor((Math.min(Math.min(x,H),l)+Math.max(Math.max(x,H),l))/2);--b;x?255===x?(x=!0,b=[242,217,191,166,127][b]):204<x?(x=!1,b=[229,191,127,64,25][b]):51>x?(x=!0,b=[25,64,127,191,229][b]):(H=[51,102,153],l=[191,127],b=(x=b<H.length)?H[b]:l[b-H.length]):(x=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(x?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*
b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(m.a)(zx,"ColorMenu",null,[419]);class fr{constructor(a){this.Kwc=null;this.rWh=a}get xXf(){this.Kwc||(this.Kwc=new zx(fr.lvi),this.PEj(this.Kwc));return this.Kwc}PEj(a){a.ZFc(1,D.a.nW);a.ZFc(3,D.a.Sr);a.ZFc(4,D.a.Sr);a.ZFc(5,D.a.Sr);a.X7h(this.rWh)}wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.dIb,Cb.a.view,Object(F.a)(this,this.dIb,"populateFontColor"));a.je(D.a.dIb,1127)}dIb(a,b,c,f,l){if(1===c)return 32;
if(2===c&&!l)return 8;a=fr.Jk.Cej(b);if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np){b=this.xXf.KYf(a,Oc.App.xGf);if(!b)return 8;l.MenuItems=b}a=this.xXf.uCi(a,Oc.App.xGf);if(!a)return 8;l.PopulationXML=a;return 32}static b$i(){return new fr(yQ.a.instance)}static get instance(){return fr.Lt||(fr.Lt=fr.b$i())}static get Jk(){return Uw.PageReader.instance}}fr.lvi="Font";fr.Lt=null;Object(m.a)(fr,"FontColorActor",null,[]);class uf{constructor(a){this.rha=this.ap=this.s2=null;this.CTb=
!1;this.Kg=sa.InteractiveViewManager.instance.Pd;this.Rj=a;uf.CS&&nb.SelectionEditor.gk(a)&&(a=nb.SelectionEditor.Mtc(this.Rj),nb.SelectionEditor.gk(a)?this.Rj=a:ia.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=nb.SelectionEditor.KOb(this.Rj);nb.SelectionEditor.gk(a)&&(this.Rj=a)}get b9(){return this.s2||(this.s2=Db.a.instance.ub("Box4.IInternalLinkManager"))}get C6(){return this.ap||(this.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get Oeg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}KTf(a,
b,c){if(b!==this.Rj.Mb||a!==this.Rj.Qa)a=Qd.SelectionFactory.f3(c,a,b),this.Kg.Lb.setSelection(a),this.Rj=nb.SelectionEditor.KOb(a.Ua.clone())}U0f(a){let b,c,f,l;l=oc.HyperlinkReader.i6b(this.Rj);c=this.Rj.Qa;f=this.Rj.Mb;b="";if(!l.length)return this.rha=a.substring(this.Rj.Qa,this.Rj.Mb),{returnValue:!0,Lnd:b,bPc:c,cPc:f,yWc:l};if(l[0].hyperlink){let x,H=0,U=Math.max(0,a.length-1),ja=0;for(let ya=0;ya<l.length;ya++)l[ya].Qa>=H&&({Qa:x,Mb:H}=uf.Wt.n_(this.Rj,l[ya]),U=Math.min(x,U),ja=Math.max(H,
ja));c=Math.min(U,c);f=Math.max(ja,f);this.rha=a.substring(c,f);c===U&&(b=l[0].hyperlink.url);return{returnValue:!0,Lnd:b,bPc:c,cPc:f,yWc:l}}return{returnValue:!1,Lnd:b,bPc:c,cPc:f,yWc:l}}nXc(a,b){if(this.Kg.uo){var c=uf.Rta?oc.HyperlinkReader.i6b(this.Rj):oc.HyperlinkReader.tC(this.Rj,!0);var f=this.Kg.Lb.Na.mb;if(f){f=f.Ua;Sb.ParagraphReader.um(f)&&(f=Wd.a.createTextRange(f.node,0,Sb.ParagraphReader.textLength(f.node)));if(uf.CS&&nb.SelectionEditor.gk(f)){var l=nb.SelectionEditor.Mtc(f);nb.SelectionEditor.gk(l)?
f=l:ia.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=nb.SelectionEditor.KOb(f);nb.SelectionEditor.gk(l)&&(f=l);0===a||P.a.instance.ga(22)&&32!==u.AFrameworkApplication.Ta.mi(f,D.a.insertHyperlink,1,!0,null,null)||this.UOj(c)||!this.Rj.equals(f)?this.Kg.QR():(bd.a.mark(5562),P.a.instance.ga(50)&&Oc.App.Ih&&Oc.App.Ih.rw&&this.Kg.Lb.iYb(),a=new pf.GraphTransaction(15),a.kd(this.Rj.node),this.Rj.node.YG().graphTransactionOperations.Mia(4),
f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),bd.a.mark(5563),this.W2())}else ia.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}UOj(a){return uf.Rta?!1:1<a.length||1===a.length&&(a[0].Qa>this.Rj.Qa||a[0].Mb<this.Rj.Mb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=oc.HyperlinkReader.oEa(b);var l="";this.b9&&({Xgh:l}=this.b9.sDh(b,!1)).returnValue&&(b=l)}this.CTb||(a=uf.hyperlinkEditor.f0k(a));
if((!c.length||uf.Rta)&&b)(f=0<c.length)&&uf.Wt.fKb(this.Rj,c),c=!0,uf.ePj&&(c=Sb.ParagraphReader.text(this.Rj.node).substring(this.Rj.Qa,this.Rj.Mb)!==a),c&&uf.characterPropertiesEditor.replaceTextRange(this.Rj,a,!0),c=Wd.a.createTextRange(this.Rj.node,this.Rj.Qa,this.Rj.Qa+a.length),uf.hyperlinkEditor.oja(c,b,f,!1),f=Qd.SelectionFactory.Sg(this.Rj.node,this.Rj.Qa+a.length);else if(0<c.length){l=c[0];let x;const H=({Qa:c,Mb:x}=uf.Wt.n_(this.Rj,l)).returnValue;if(b)if(l.hyperlink.PTa){if(b!==l.hyperlink.url)if(uf.Tf.AOb){let U=
Wd.a.createTextRange(this.Rj.node,c,c+a.length);uf.hyperlinkEditor.BPi(U,l.hyperlink,b)}else uf.Wt.JGh(b,H);a!==this.rha&&(uf.Wt.cFe()&&uf.Wt.fKb(this.Rj,H),uf.characterPropertiesEditor.replaceTextRange(Wd.a.createTextRange(this.Rj.node,c,x),a,!0),f=Wd.a.createTextRange(this.Rj.node,c,c+a.length),uf.Wt.cFe()&&uf.hyperlinkEditor.oja(f,b,!1),f=Qd.SelectionFactory.Sg(this.Rj.node,c+a.length))}else uf.Wt.fKb(this.Rj,H),uf.characterPropertiesEditor.replaceTextRange(Wd.a.createTextRange(this.Rj.node,c,
x),a,!0),f=Wd.a.createTextRange(this.Rj.node,c,c+a.length),uf.hyperlinkEditor.oja(f,b,!1),f=Qd.SelectionFactory.Sg(this.Rj.node,c+a.length);else uf.hyperlinkEditor.zM(l.paragraph,l.hyperlink)}f&&this.Kg.Lb.setSelection(f)}static get hyperlinkEditor(){return uf.zn||(uf.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return uf.fh||(uf.fh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Tf(){return uf.fd||(uf.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Wt(){return uf.BD||
(uf.BD=Db.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Rta(){null==uf.W1a&&(uf.W1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return uf.W1a}static get ePj(){null==uf.FDd&&(uf.FDd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return uf.FDd}static get Nab(){null==uf.G3a&&(uf.G3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return uf.G3a}static get CS(){null==
uf.XM&&(uf.XM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return uf.XM}}uf.zn=null;uf.fh=null;uf.fd=null;uf.BD=null;uf.W1a=null;uf.FDd=null;uf.G3a=null;uf.XM=null;uf.source="Source";uf.NGf="CommandingInterface";uf.$7a="DisplayText";uf.url="Url";uf.id="InsertLinkDialog";Object(m.a)(uf,"AInsertLinkDialog",null,[106]);class Ax{static get rg(){return Zh.a.sC(Ax.so,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}
Ax.so="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(m.a)(Ax,"InsertLinkDialogHtml",null,[]);class cJ extends uf{constructor(a,b){super(a,b);this.Af=
new Zh.a;this.Af.hg=uf.id;var c=this.rha="";const f=Sb.ParagraphReader.text(this.Rj.node);let l=this.Rj.Qa,x=this.Rj.Mb,H;uf.Rta?{Lnd:c,bPc:l,cPc:x,yWc:H}=this.U0f(f):(H=oc.HyperlinkReader.tC(this.Rj,!0),1===H.length&&H[0].Qa<=this.Rj.Qa&&H[0].Mb>=this.Rj.Mb&&H[0].hyperlink?(this.rha=uf.Wt.PSc(a,H[0],f),c=H[0].hyperlink.url):H.length||(this.rha=f.substring(this.Rj.Qa,this.Rj.Mb)));(b=Object(oa.a)(Object,b))&&(b[uf.source]&&b[uf.source]===uf.NGf||b[uf.url]&&b[uf.$7a])?this.insertLink(b[uf.$7a],b[uf.url],
H):(uf.Rta&&H[0]&&this.KTf(l,x,H[0].paragraph),this.Af.rg=Ax.rg,""===c.trim()&&this.Af.Xe(1,this.Oeg),c={["txtLink"]:c,["txtDisplay"]:this.rha},this.Af.fNc=Object(F.a)(this,this.zN,"dialogDefaultEnterKeyHandler"),this.Af.eNc=Object(F.a)(this,this.zN,"dialogDefaultEnterKeyHandler"),this.Af.Zi(this.titleText,Object(F.a)(this,this.nXc,"insertLinkDialogHandler"),c),uf.Nab&&(c=document.getElementById("txtLink"),Id.a.addHandler(c,ta.a.input,Object(F.a)(this,this.kJa,"onLinkChanged")),Id.a.addHandler(c,
ta.a.change,Object(F.a)(this,this.kJa,"onLinkChanged"))),document.getElementById("txtLink").focus(),uf.CS?0<gf.h(Wd.a.QQa(l,x,!1,this.Rj.node)).length&&(this.CTb=!0,document.getElementById("txtDisplay").disabled=!0):1>=H.length&&uf.Wt.zWd(a,H[0],1===H.length)&&(this.CTb=!0,document.getElementById("txtDisplay").disabled=!0))}kJa(){if(this.Af){const a=document.getElementById("txtLink");this.Af.jD(1,!a||!a.value.length||oc.HyperlinkReader.Dme(a.value))}}zN(a){return this.Af?uf.Nab?this.Af.b_f(this.Af.Bnb)?
this.Af.zN(a):!1:this.Af.zN(a):!1}W2(){if(uf.Nab){const a=document.getElementById("txtLink");a&&(Id.a.removeHandler(a,ta.a.change,Object(F.a)(this,this.kJa,"onLinkChanged")),Id.a.removeHandler(a,ta.a.input,Object(F.a)(this,this.kJa,"onLinkChanged")))}this.Af&&(this.Af=null)}}Object(m.a)(cJ,"InsertLinkDialog",uf,[]);class dJ extends uf{constructor(a,b,c){super(a,b);const f=new Zh.a(!1,!1,!0),l={};l.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.textDisplayInitialFocus=c;c=this.rha="";const x=Sb.ParagraphReader.text(this.Rj.node);let H=this.Rj.Qa,U=this.Rj.Mb,ja;uf.Rta?{Lnd:c,bPc:H,cPc:U,yWc:ja}=this.U0f(x):(ja=oc.HyperlinkReader.tC(this.Rj,!0),1===ja.length&&ja[0].Qa<=this.Rj.Qa&&ja[0].Mb>=this.Rj.Mb&&ja[0].hyperlink?(this.rha=uf.Wt.PSc(a,ja[0],x),c=ja[0].hyperlink.url):ja.length||(this.rha=x.substring(this.Rj.Qa,this.Rj.Mb)));(b=Object(oa.a)(Object,b))&&(b[uf.source]&&b[uf.source]===uf.NGf||b[uf.url]&&b[uf.$7a])?this.insertLink(b[uf.$7a],
b[uf.url],ja):(uf.Rta&&ja[0]&&this.KTf(H,U,ja[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.Oeg),f.Xe(1,b),l.txtLink=c,l.txtDisplay=this.rha,uf.CS?0<gf.h(Wd.a.QQa(H,U,!1,this.Rj.node)).length&&(this.CTb=!0,l.textDisplayDisabled=!0):1>=ja.length&&uf.Wt.zWd(a,ja[0],1===ja.length)&&(this.CTb=!0,l.textDisplayDisabled=!0),a={["id"]:uf.id,["bodyControls"]:l},f.Zi(this.titleText,Object(F.a)(this,this.nXc,"insertLinkDialogHandler"),a))}W2(){}}Object(m.a)(dJ,"ReactInsertLinkDialog",uf,
[]);class fu{constructor(){this.iqa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.GC}dKf(a,b,c){this.iqa?new dJ(a,b,c):new cJ(a,b)}static get instance(){return fu.Ka||(fu.Ka=new fu)}}fu.Ka=null;Object(m.a)(fu,"InsertLinkDialogFactory",null,[485]);class Wk extends Zh.a{constructor(a){super();this.HK=a;this.Kg=sa.InteractiveViewManager.instance.Pd;this.wDc=this.Kg.Lb.Na.mb;this.L3d=a[0].Qa;this.fne=a[a.length-1].Mb;this.hg="InsertMultiParagraphLinkDialog";a=this.yDl();this.showDialog("",
a)}showDialog(a,b){ia.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.rg=Ax.rg;""===b.trim()&&this.Xe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.Zi(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(F.a)(this,this.nXc,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Wk.Nab&&(a=document.getElementById("txtLink"),Id.a.addHandler(a,ta.a.input,Object(F.a)(this,
this.kJa,"onLinkChanged")),Id.a.addHandler(a,ta.a.change,Object(F.a)(this,this.kJa,"onLinkChanged")))}hide(){if(Wk.Nab){const a=document.getElementById("txtLink");a&&(Id.a.removeHandler(a,ta.a.change,Object(F.a)(this,this.kJa,"onLinkChanged")),Id.a.removeHandler(a,ta.a.input,Object(F.a)(this,this.kJa,"onLinkChanged")))}super.hide()}kJa(){const a=document.getElementById("txtLink");this.jD(1,!a||!a.value.length||oc.HyperlinkReader.Dme(a.value))}zN(a){return Wk.Nab?this.b_f(this.Bnb)?super.zN(a):!1:
super.zN(a)}yDl(){let a;let b;a="";const c=this.HK.length,f=oc.HyperlinkReader.tC(this.HK[0],!1);0<f.length&&({Qa:l,Mb:b}=Wk.Wt.n_(this.HK[0],f[0]),l<=this.HK[0].Qa&&(a=f[0].hyperlink.url),this.L3d=Math.min(this.L3d,l));var l=oc.HyperlinkReader.tC(this.HK[c-1],!1);0<l.length&&({Qa:l,Mb:b}=Wk.Wt.n_(this.HK[c-1],l[l.length-1]),this.fne=Math.max(this.fne,b));this.Kyl(this.L3d,this.fne);return a}Kyl(a,b){const c=this.HK.length;if(a!==this.HK[0].Qa||b!==this.HK[c-1].Mb){a=Wd.a.Lj(this.HK[0].node,a);a=
Qd.SelectionFactory.Du(a);b=Wd.a.Lj(this.HK[c-1].node,b);b=Qd.SelectionFactory.DN(a,b);a=this.S7f(b.Ua.clone());const f=this.S7f(b.Ye.clone());a&&f&&(this.HK[0]=a,this.HK[c-1]=f,this.Kg.Lb.setSelection(b),this.wDc=b)}}nXc(a,b){if(this.Kg.uo){var c=this.Kg.Lb.Na.mb;if(c)if(c.equals(this.wDc)&&0!==a){a=new pf.GraphTransaction(15);a.kd(this.HK[0].node);for(c=0;c<this.HK.length;c++)this.HK[c].node.YG().graphTransactionOperations.Mia(4);b=b.txtLink.trim();this.xKi();this.qGj(b);this.hide();a.dispose()}else this.Kg.QR()}}qGj(a){if(a){a=
oc.HyperlinkReader.oEa(a);for(let c=0;c<this.HK.length;c++){var b=this.HK[c];if(Wk.CS&&nb.SelectionEditor.gk(b)&&(b=nb.SelectionEditor.Mtc(b),!nb.SelectionEditor.gk(b)))continue;b=Wd.a.createTextRange(this.HK[c].node,b.Qa,b.Mb);Wk.hyperlinkEditor.oja(b,a,!1)}}}S7f(a){return Sb.ParagraphReader.um(a)&&!nb.SelectionEditor.UW(a)&&Sb.ParagraphReader.textLength(a.node)?Wd.a.createTextRange(a.node,0,Sb.ParagraphReader.textLength(a.node)):nb.SelectionEditor.gk(a)?a:null}xKi(){let a=!1;for(const b of this.HK){const c=
oc.HyperlinkReader.tC(b,!1);c&&(a=Wk.Wt.fKb(b,c)||a)}}static get Wt(){return Wk.BD||(Wk.BD=Db.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Tf(){return Wk.fd||(Wk.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Wk.zn||(Wk.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static get CS(){null==Wk.XM&&(Wk.XM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Wk.XM}static get Nab(){null==
Wk.G3a&&(Wk.G3a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Wk.G3a}}Wk.BD=null;Wk.fd=null;Wk.zn=null;Wk.XM=null;Wk.G3a=null;Object(m.a)(Wk,"InsertMultiParagraphLinkDialog",Zh.a,[]);class Me{static get $i(){return fd.a.instance}static get hyperlinkEditor(){return Me.zn||(Me.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Wt(){return Me.BD||(Me.BD=Db.a.instance.resolve("Box4.IHyperlinkStrategy"))}static er(){return Me.Hm||(Me.Hm=
Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static get Tf(){return Me.fd||(Me.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Gtc(){return Me.JD||(Me.JD=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get JPb(){null==Me.owd&&(Me.owd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return Me.owd}static get Rta(){null==Me.W1a&&(Me.W1a=u.AFrameworkApplication.fa?
u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return Me.W1a}static get kjc(){null==Me.X1a&&(Me.X1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Me.X1a}static get CS(){null==Me.XM&&(Me.XM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Me.XM}static wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.insertHyperlink,Cb.a.view,Me.iyb);a.ya(D.a.insertHyperlink,
Cb.a.Pf,Me.insertLink);a.ya(D.a.insertHyperlink,Cb.a.textRange,Me.insertLink);a.je(D.a.insertHyperlink,1028);a.ya(D.a.zM,Cb.a.view,Me.iyb);a.ya(D.a.zM,Cb.a.Pf,Me.Bhh);a.ya(D.a.zM,Cb.a.textRange,Me.Bhh);a.je(D.a.zM,1028);a.ya(D.a.nnd,Cb.a.view,Me.iyb);a.ya(D.a.nnd,Cb.a.Pf,Me.loh);a.ya(D.a.nnd,Cb.a.textRange,Me.loh);a.ya(D.a.oJa,Cb.a.view,Me.iyb);a.ya(D.a.oJa,Cb.a.Pf,Me.N7g);a.ya(D.a.oJa,Cb.a.textRange,Me.N7g);a.ya(D.a.oJa,Cb.a.image,Me.hJe);a.ya(D.a.oJa,Cb.a.v4b,Me.hJe);a.ya(D.a.n8b,Cb.a.view,Me.iyb);
a.ya(D.a.n8b,Cb.a.Pf,Me.linkText);a.ya(D.a.n8b,Cb.a.textRange,Me.linkText);a.je(D.a.n8b,1028);Me.JPb&&a.ya(D.a.oJa,Cb.a.anchoredObject,Me.hJe);a.ya(D.a.$Kc,Cb.a.view,Me.iyb)}static iyb(a,b,c,f,l){if(Me.kjc)return Me.lAj(a,b,c,f,l);if(!b.view.Mh)return 2;var x=b.view.Lb;if(!x||!x.Na||!x.Na.length)return 8;var H=x.Na.mb;let U=H.Ua.clone();if(2===H.length){if(H=H.ga(1),!nb.SelectionEditor.gk(U)||!nb.SelectionEditor.Xl(H)||U.node!==H.node)return 8}else if(2<H.length)return 8;if(x.Na.jH)return 8;Sb.ParagraphReader.um(U)&&
!nb.SelectionEditor.UW(U)&&(x=U.node,U=Wd.a.createTextRange(x,0,Sb.ParagraphReader.textLength(x)));return a===D.a.$Kc?Me.OIf(b,U,c,f,l):u.AFrameworkApplication.Ta.mi(U,a,c,!0,f,l)}static lAj(a,b,c,f,l){if(!b.view.Mh)return 2;var x=b.view.Lb;if(!x||!x.Na||!x.Na.length||x.Na.jH)return 8;var H=x.Na.mb;if(x=Me.S$b(H))H=Me.R$d(H.Ua.clone(),!0);else{let U=H.ga(0).clone(),ja=1;for(;ja<H.length&&(!Sb.ParagraphReader.textLength(U.node)||nb.SelectionEditor.Xl(U)||Me.CS&&gf.m(U));)U=H.ga(ja).clone(),ja++;H=
Me.R$d(U,!1)}return Me.CS&&nb.SelectionEditor.gk(H)&&gf.m(H)||!nb.SelectionEditor.gk(H)&&!x?8:a===D.a.$Kc?Me.OIf(b,H,c,f,l):u.AFrameworkApplication.Ta.mi(H,a,c,!0,f,l)}static S$b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return nb.SelectionEditor.gk(b)&&nb.SelectionEditor.Xl(a)&&b.node===a.node?!0:!1}return!1}static rHf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=Me.R$d(a.ga(f).clone(),!1);if(nb.SelectionEditor.gk(l))Me.CS&&gf.m(l)||Array.add(c,
l);else if(!nb.SelectionEditor.Xl(l)&&!Sb.ParagraphReader.um(l))return{returnValue:!1,TWd:b}}b=cb.a.lOb(c);return{returnValue:!Me.CS||0<b.length?!0:!1,TWd:b}}static Veg(a,b,c,f){if(Me.kjc)return Me.vGj(a,b,c,f);if(!Me.aUd()||!Me.ZIc(a)||qd.a.instance.Na.jH)return 8;if(Me.JPb&&nb.SelectionEditor.rFa(a))return 2;let l;if(!({hyperlink:l}=Me.nVa(a,!0)).returnValue||Me.KKc())return 8;if(1===b)return 32;if(!l&&nb.SelectionEditor.Tg(a)&&nb.SelectionEditor.eAb(a)&&(b=nb.SelectionEditor.WRa(a,!1))&&(qd.a.instance.setSelection(b),
a=b.Ua,Me.KKc()))return 8;fu.instance.dKf(a,c,f);return 32}static vGj(a,b,c,f){var l=qd.a.instance.Na.mb;const x=Me.S$b(l);if(x)a=[a];else if(!({TWd:a}=Me.rHf(l)).returnValue)return 8;if(!Me.aUd())return 8;for(l=0;l<a.length;l++)if(!Me.ZIc(a[l]))return 8;if(qd.a.instance.Na.jH)return 8;l=Array(a.length);let H=null;for(let U=0;U<a.length;U++)if(l[U]=a[U],!({hyperlink:H}=Me.nVa(l[U],!0)).returnValue||Me.KKc())return 8;if(f&&!Me.eXj(l[0]))return 8;if(1===b)return 32;if(!H&&1===l.length&&x&&nb.SelectionEditor.Tg(l[0])&&
nb.SelectionEditor.eAb(l[0])&&(b=nb.SelectionEditor.WRa(l[0],!1))&&(qd.a.instance.setSelection(b),l[0]=b.Ua,Me.KKc()))return 8;x?fu.instance.dKf(l[0],c,f):new Wk(l,c);return 32}static insertLink(a,b,c,f,l){return Me.Veg(b,c,l,!1)}static linkText(a,b,c,f,l){return Me.Veg(b,c,l,!0)}static Bhh(a,b,c){if(Me.kjc)return Me.bXk(a,b,c);if(!Me.ZIc(b)||Me.JPb&&nb.SelectionEditor.rFa(b))return 2;let f;if(!({hyperlink:f}=Me.nVa(b,!1)).returnValue)return 2;if(2===c){c=new pf.GraphTransaction(15);try{c.jd=a,c.kd(f.paragraph),
Me.Rta?Me.Qhh(b):Me.Wt.zM(b,f)}finally{c&&c.dispose()}}return 32}static bXk(a,b,c){var f=qd.a.instance.Na.mb;if(Me.S$b(f))b=[b];else if(!({TWd:b}=Me.rHf(f)).returnValue)return 8;if(!Me.aUd())return 8;for(f=0;f<b.length;f++)if(!Me.ZIc(b[f]))return 8;if(1===c&&!Me.nVa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!Me.nVa(b[c],!0).returnValue)return 2;c=new pf.GraphTransaction(15);try{let l=b[0];c.jd=a;c.kd(l.node);for(a=0;a<b.length;a++)Me.Qhh(b[a])}finally{c&&c.dispose()}}return 32}static Qhh(a){const b=
oc.HyperlinkReader.i6b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Qa>=c){const l=({Mb:c}=Me.Wt.n_(a,b[f])).returnValue;Me.Wt.fKb(a,l)}}static loh(a,b,c){if(Me.JPb&&rd.ImageReader.Zyb(b)||!({hyperlink:a}=Me.nVa(b,!1)).returnValue)return 2;2===c&&({Qa:b,Mb:c}=Me.Wt.n_(b,a),qd.a.instance.setSelection(Qd.SelectionFactory.f3(a.paragraph,b,c)));return 32}static N7g(a,b,c){let f;if(Me.JPb&&({hyperlink:f}=Me.SWj(b)).returnValue)ia.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=Me.nVa(b,!1)).returnValue)return 2;2===c&&Oc.App.D4b(f.hyperlink.url);return 32}static hJe(a,b,c){a=rd.ImageReader.n_(b.node);if(!a)return 2;2===c&&Oc.App.D4b(a);return 32}static OIf(a,b,c,f,l){if(Me.JPb&&rd.ImageReader.Zyb(b))return 2;const x=sa.InteractiveViewManager.instance.editingView;if(!x.Wl)return 2;let H;if(!({hyperlink:H}=Me.nVa(b,!1)).returnValue)return 2;if(1===c)return 32;({Qa:b,Mb:c}=Me.Wt.n_(b,H));qd.a.instance.setSelection(Qd.SelectionFactory.f3(H.paragraph,
b,c));var U=x.ownerDocument;c=x.Rn;b=new Eg.a(c);Ca.a.Au(c);U=U.createElement("span");c.appendChild(U);U.innerText=H.hyperlink.url;x.IKa();x.kdl();a=u.AFrameworkApplication.Ta.mi(a,D.a.copy,2,!0,f,l);b.restore();return a}static nVa(a,b){let c;c=null;if(nb.SelectionEditor.gk(a)){var f=gf.h(a);const l=cb.a.all(f,x=>6===x.Wq);if(0<f.length&&(!Me.CS||!l))return{returnValue:!1,hyperlink:c}}if(Me.Rta)return Me.OWj(a,b);f=oc.HyperlinkReader.tC(a,!0);return 1===f.length&&f[0].Qa<=a.Qa&&f[0].Mb>=a.Mb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static SWj(a){let b;b=null;return rd.ImageReader.Zyb(a)&&(b=oc.HyperlinkReader.RSc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static OWj(a,b){let c;c=null;const f=oc.HyperlinkReader.i6b(a);return f.length?f[0].hyperlink?(c=f[0],a.Qa<f[0].Qa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static eXj(a){if(nb.SelectionEditor.gk(a)){var b=
gf.h(a),c=cb.a.all(b,f=>6===f.Wq);if(0<b.length&&!c)return!1}b=oc.HyperlinkReader.tC(a,!0);if(!(1===b.length&&b[0].Qa<=a.Qa&&b[0].Mb>=a.Mb&&b[0].hyperlink))return!1;c=Sb.ParagraphReader.text(a.node);a=Me.Wt.PSc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static KKc(){if(Me.Tf.gg)for(let a=0;a<null.count;++a)if(2===null.ga(a).oMl.changeType)return!0;return!1}static aUd(){return Me.Tf.gg?!0:!P.a.instance.ga(45)||!Oc.App.OD.BOb}static ZIc(a){return P.a.instance.ga(14)&&
Me.$i.v7a(a)||Me.er()&&Me.er().instance&&Me.er().instance.XW(a)?!1:!0}static R$d(a,b){return Sb.ParagraphReader.um(a)&&!nb.SelectionEditor.UW(a)&&(Sb.ParagraphReader.textLength(a.node)||b)?Wd.a.createTextRange(a.node,0,Sb.ParagraphReader.textLength(a.node)):a}}Me.zn=null;Me.BD=null;Me.Hm=null;Me.fd=null;Me.JD=null;Me.owd=null;Me.W1a=null;Me.X1a=null;Me.XM=null;Object(m.a)(Me,"HyperlinkActor",null,[]);class Xg{static get Av(){return jv.a.bxb}static get km(){return Ih.ContextSetEditor.instance}static get $i(){return fd.a.instance}static get Wc(){return Nc.a.instance}static er(){return Xg.Hm||
(Xg.Hm=Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return Xg.Vw||(Xg.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}static get J5(){return Xg.sr||(Xg.sr=Db.a.instance.resolve("Box4.IParagraphReader"))}static get tM(){return Xg.EG||(Xg.EG=Db.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get DBk(){return Xg.paragraphEditor.Av}static get Sf(){return Xg.Vg||(Xg.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static wb(){const a=u.AFrameworkApplication.Ta;
a.ya(D.a.By,Cb.a.view,Xg.uxf);a.ya(D.a.By,Cb.a.outlineElement,Xg.txf);a.je(D.a.By,1028);a.ya(D.a.oC,Cb.a.view,Xg.uxf);a.ya(D.a.oC,Cb.a.outlineElement,Xg.txf);a.je(D.a.oC,1028)}static uxf(a,b,c,f,l){var x=b.view;if(!x.Mh)return 2;const H=x.Lb;if(!H)return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.pna}),8;var U=H.Pj;if(!U)return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.noSelection}),8;if(P.a.instance.ga(62)&&1===c)return 32;if(P.a.instance.ga(11)&&Xg.km.asa(Xg.qQd,U))return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.M0b}),
8;if(P.a.instance.ga(14)&&Xg.$i.JYc(U))return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),8;if(Xg.er()&&Xg.er().instance&&Xg.er().instance.XW(U))return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.externalSelection}),8;U={};U[fi.spa]=5794;U[fi.rpa]=5795;let ja=2;if(u.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){x=Xg.aDf(a===D.a.By,b,!0);if(1===c)return x?32:8;x&&(ja=fi.ohb(a,b,c,f,l,U))}else ja=fi.ohb(a,b,1,f,l,U),1!==c&&32===ja?(x.Lb.FIe(),x=new pf.GraphTransaction(15),x.kd(b.view.xg),ja=Xg.aDf(a===
D.a.By,b,!1)?fi.ohb(a,b,c,f,l,U):8,x.dispose()):1!==c&&8===ja&&(x.Lb.FIe(),Xg.kwi(a,b,H));return ja}static aDf(a,b,c){b=b.view.Lb;if(!b||!b.Na.mb)return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Mdd}),!1;if(b.Na.jH)return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.SHf}),!1;b=ri.dta(b.Na,!1);if(!b)return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.rPc}),!1;let f=!1;for(let l=0;l<b.length;l++){const x=b.getContext(l),H=new tb.GraphIterator;H.set(x.node);nb.SelectionEditor.Bt(H);if(!fe.OutlineElementReader.Yg(H))if(c)continue;
else return Xg.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Qca}),!1;if(a?!Xg.Av.Rsb(H):!Xg.Av.WIc(H))if(c)continue;else return Xg.Wc.Xb(Pd.a.D2b,{["Reason"]:Md.a.zDf}),!1;f=!0}return c?f:!0}static txf(a,b,c,f,l){if(b.contextId!==Cb.a.outlineElement)return 2;if(P.a.instance.ga(14))if(f=b.clone().SZe(),od.TableReader.Qmg(f)){if(Xg.$i.Rmg(f))return Xg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),8}else if(Xg.$i.AFa(f))return Xg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),2;f=new tb.GraphIterator;f.set(b.node);nb.SelectionEditor.Bt(f);
if(!fe.OutlineElementReader.Yg(f))return 2;switch(a){case D.a.By:b=Xg.Av.Rsb(f);break;case D.a.oC:b=Xg.Av.WIc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===D.a.oC&&l&&l.sa(Mc.a.Ryf,!1)&&(c|=2);switch(a){case D.a.By:Xg.Av.Rhb(f,-1,c);break;case D.a.oC:Xg.Av.SMc(f,1)}return 32}static kwi(a,b,c){const f=new pf.GraphTransaction(15);try{f.kd(b.view.xg);b=!0;var l=ri.dta(c.Na,!1);for(let x=0;x<l.length;x++){const H=l.getContext(x);let U=new tb.GraphIterator;U.set(H.node);nb.SelectionEditor.Bt(U);
if(!fe.OutlineElementReader.Yg(U))b=!1;else if(a===D.a.By?Xg.Av.Rsb(U):Xg.Av.WIc(U))switch(b=!1,a){case D.a.By:Xg.Av.Rhb(U,-1,0);break;case D.a.oC:Xg.Av.SMc(U,1)}}if(b){const x=c.Na.mb;for(c=0;c<x.length;c++){const H=x.ga(c);if(H.al){const U=Xg.tM.Rwb(H.node),ja=U.kNb;if(a===D.a.By?U.QN>ja:U.QN<18*ja){let ya=new tb.GraphIterator;ya.set(H.node);l=ja;l=a===D.a.By?U.QN>=2.5*ja?U.QN-2*ja:ja:U.QN<16*ja?U.QN+2*ja:18*ja;Xg.DBk.Ijb(ya,1,l)}}}}}finally{f&&f.dispose()}}}Xg.Hm=null;Xg.Vw=null;Xg.sr=null;Xg.EG=
null;Xg.Vg=null;Xg.qQd=rd.ImageReader.Yyb;Object(m.a)(Xg,"IndentationActor",null,[]);class tg{static get lde(){return tg.oob||(tg.oob=Db.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return tg.Vw||(tg.Vw=Db.a.instance.resolve("Box4.IParagraphEditor"))}static get Rq(){return tg.HD||(tg.HD=Db.a.instance.resolve("Box4.ITableEditor"))}static get $i(){return fd.a.instance}static get Wc(){return Nc.a.instance}static er(){return tg.Hm||(tg.Hm=Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static wb(){const a=
u.AFrameworkApplication.Ta;P.a.instance.ga(77)||(a.ya(D.a.leftJustify,Cb.a.table,tg.fRd),a.ya(D.a.centerJustify,Cb.a.table,tg.fRd),a.ya(D.a.rightJustify,Cb.a.table,tg.fRd));a.ya(D.a.leftJustify,Cb.a.view,Ig.U7);a.ya(D.a.leftJustify,Cb.a.paragraph,tg.Eia);a.ya(D.a.leftJustify,Cb.a.image,tg.$Ba);a.ya(D.a.leftJustify,Cb.a.embeddedFile,tg.$Ba);a.je(D.a.leftJustify,1028);a.ya(D.a.centerJustify,Cb.a.view,Ig.U7);a.ya(D.a.centerJustify,Cb.a.paragraph,tg.Eia);a.ya(D.a.centerJustify,Cb.a.image,tg.$Ba);a.ya(D.a.centerJustify,
Cb.a.embeddedFile,tg.$Ba);a.je(D.a.centerJustify,1028);a.ya(D.a.rightJustify,Cb.a.view,Ig.U7);a.ya(D.a.rightJustify,Cb.a.paragraph,tg.Eia);a.ya(D.a.rightJustify,Cb.a.image,tg.$Ba);a.ya(D.a.rightJustify,Cb.a.embeddedFile,tg.$Ba);a.je(D.a.rightJustify,1028);P.a.instance.ga(54)&&(a.ya(D.a.fullJustify,Cb.a.view,Ig.U7),a.ya(D.a.fullJustify,Cb.a.paragraph,tg.Eia),a.je(D.a.fullJustify,1028),a.ya(D.a.z2b,Cb.a.view,Ig.U7),a.ya(D.a.z2b,Cb.a.paragraph,tg.Eia),a.je(D.a.z2b,1028),a.ya(D.a.Cac,Cb.a.view,Ig.U7),
a.ya(D.a.Cac,Cb.a.paragraph,tg.Eia),a.je(D.a.Cac,1028),a.ya(D.a.uqc,Cb.a.view,Ig.U7),a.ya(D.a.uqc,Cb.a.paragraph,tg.Eia),a.je(D.a.uqc,1028));a.ya(D.a.nla,Cb.a.view,Ig.U7);a.ya(D.a.nla,Cb.a.paragraph,tg.Eia);a.ya(D.a.nla,Cb.a.image,tg.$Ba);a.je(D.a.nla,1028);a.ya(D.a.Xia,Cb.a.view,Ig.U7);a.ya(D.a.Xia,Cb.a.paragraph,tg.Eia);a.ya(D.a.Xia,Cb.a.image,tg.$Ba);a.je(D.a.Xia,1028);a.ya(D.a.toa,Cb.a.view,Ig.U7);a.ya(D.a.toa,Cb.a.paragraph,tg.Eia);a.ya(D.a.toa,Cb.a.image,tg.$Ba);a.je(D.a.toa,1028);P.a.instance.ga(54)&&
(a.ya(D.a.PDa,Cb.a.view,Ig.U7),a.ya(D.a.PDa,Cb.a.paragraph,tg.Eia),a.je(D.a.PDa,1028))}static fRd(a,b,c){let f=!0;if(!b)return 8;od.TableReader.Qmg(b)?P.a.instance.ga(14)&&tg.$i.Rmg(b)?(tg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),f=!1):tg.er()&&tg.er().instance&&tg.er().instance.XW(b)&&(tg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.externalSelection}),f=!1):(tg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.j0d}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case D.a.leftJustify:tg.Rq.ZJ(b,1);break;case D.a.centerJustify:tg.Rq.ZJ(b,
2);break;case D.a.rightJustify:tg.Rq.ZJ(b,3)}return 32}static $Ba(a,b,c){if(!({tF:c}=Ig.Eth(c,b)).returnValue)return c;b=b.node;switch(a){case D.a.leftJustify:case D.a.nla:tg.lde.ZJ(b,1);break;case D.a.centerJustify:case D.a.Xia:tg.lde.ZJ(b,2);break;case D.a.rightJustify:case D.a.toa:tg.lde.ZJ(b,3)}return 32}static Eia(a,b,c,f,l){f=!0;b.contextId!==Cb.a.paragraph?f=!1:P.a.instance.ga(14)&&tg.$i.AFa(b)?(tg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),f=!1):tg.er()&&tg.er().instance&&tg.er().instance.XW(b)&&
(tg.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=Sb.ParagraphReader.HN(b);switch(a){case D.a.leftJustify:case D.a.nla:tg.paragraphEditor.ZJ(b,1===c&&tg.s0c(l)?6:1);break;case D.a.centerJustify:case D.a.Xia:tg.paragraphEditor.ZJ(b,2===c&&tg.s0c(l)?1:2);break;case D.a.rightJustify:case D.a.toa:tg.paragraphEditor.ZJ(b,3===c&&tg.s0c(l)?1:3);break;case D.a.fullJustify:case D.a.PDa:tg.paragraphEditor.ZJ(b,6===c&&tg.s0c(l)?1:6);break;case D.a.Cac:tg.paragraphEditor.ZJ(b,
11);break;case D.a.z2b:tg.paragraphEditor.ZJ(b,7);break;case D.a.uqc:tg.paragraphEditor.ZJ(b,13)}return 32}static s0c(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&P.a.instance.ga(110)}}tg.oob=null;tg.HD=null;tg.Vw=null;tg.Hm=null;Object(m.a)(tg,"JustificationActor",null,[]);class gu{wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.activateRibbonTab,Cb.a.view,Object(F.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.je(D.a.activateRibbonTab,
5);a.ya(D.a.$ng,Cb.a.view,Object(F.a)(this,this.dZj,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}dZj(){u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Oc.App.OD.QS.Zng();return 32}static get instance(){return gu.Ka||(gu.Ka=gu.uC())}static uC(){return new gu}}gu.Ka=null;Object(m.a)(gu,"RibbonActor",null,[]);class Jn{constructor(a,b,c){this.Wpf=!1;this.Ca=a;this.$a=b;this.Qyc=c}wb(){this.Ca.ra(G.a.OM,Cb.a.view,Object(F.a)(this,this.Hwl,
"touchStartHandler"),4);this.Ca&&this.$a&&(this.$a.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.ra(D.a.vCh,Cb.a.view,Object(F.a)(this,this.fKk,"processImageOnTouchSelection"),4),this.Ca.ra(D.a.wCh,Cb.a.view,Object(F.a)(this,this.eKk,"processImageOnClickSelection"),4)),this.$a.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.ra(G.a.gql,Cb.a.application,Object(F.a)(this,this.HKk,"processStartPinchToZoom"),4),this.Ca.ra(G.a.aRi,Cb.a.application,Object(F.a)(this,this.YJk,"processEndPinchToZoom"),
4)))}Hwl(a,b,c){if(2!==c)return 2;this.Wpf||(this.Wpf=!0);u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");B.a.Tj&&u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}fKk(a,b,c,f,l){if(2!==c)return 2;this.ich(l,!0);return 32}eKk(a,b,c,f,l){if(2!==c)return 2;this.ich(l,!1);return 32}ich(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,Jn.GBj)){for(a=a.firstChild;a;)this.cci(a,b),a=a.nextSibling;break}a=a.nextSibling}}cci(a,b){if(Sys.UI.DomElement.containsCssClass(a,Jn.ndg)){b&&!Sys.UI.DomElement.containsCssClass(a,Jn.IWc)?Sys.UI.DomElement.addCssClass(a,Jn.IWc):!b&&Sys.UI.DomElement.containsCssClass(a,Jn.IWc)&&Sys.UI.DomElement.removeCssClass(a,Jn.IWc);const c="WACImageResizeHandleTouch"+this.D$i(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}MSc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==Jn.ndg)return c}return""}D$i(a){a=this.MSc(a);return""!==a?ha.a.substring(a,20,a.length):""}HKk(a,b,c){if(2!==c)return 2;if(!this.Qyc)return 8;this.Qyc.kzj();return 32}YJk(a,b,c){if(2!==c)return 2;if(!this.Qyc)return 8;this.Qyc.P2k();return 32}static Smj(){return new Jn(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.fa,ig.GrippersManager.instance)}static get instance(){return Jn.Lt||(Jn.Lt=Jn.Smj())}}Jn.ndg="WACImageResizeHandles";Jn.IWc="WACImageResizeHandlesTouch";Jn.GBj="WACImgSelection";Jn.Lt=null;Object(m.a)(Jn,"TouchInputActor",null,[]);class gr{constructor(a){this.Xs=null;this.EZ=a}get Kn(){return this.Xs||(this.Xs=this.EZ())}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.undoRedo,"undoRedo");a.ra(D.a.undo,Cb.a.view,b,1028);a.ra(D.a.redo,Cb.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Mh)return gr.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.Mdd}),8;f=a===D.a.undo?this.Kn.NW:this.Kn.vka;if(1===c)return f?32:8;if(!f)return ia.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===D.a.undo?"undo":"redo"),gr.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.TAl}),2;c=new pf.GraphTransaction(3);c.kd(b.xg);c.yjb();a=a===D.a.undo?this.Kn.undo():this.Kn.redo();c.dispose();l&&ig.GrippersManager.instance.H1a(l.Hu);if(a)return 32;gr.Wc.Xb(Pd.a.D2b,{["Reason"]:Md.a.K_g});
return 8}static get instance(){return gr.Ka||(gr.Ka=gr.uC())}static uC(){const a=Db.a.instance;return new gr(()=>a.resolve("Box4.IUndoManager"),a.ie("Box4.ICoauthCashTelemetry"))}static get Wc(){return Nc.a.instance}}gr.Ka=null;Object(m.a)(gr,"UndoActor",null,[]);class GC{constructor(){this.Da=null}get name(){return"Box4.Actors"}Zb(a){this.Da=a;(new aJ).Zb(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").wb();u.AFrameworkApplication.Ta.ya(D.a.NOi,Cb.a.embeddedFile,wQ);u.AFrameworkApplication.Ta.ya(D.a.o0d,
Cb.a.embeddedFile,bJ);u.AFrameworkApplication.Ta.ya(D.a.o0d,Cb.a.u4b,bJ);fr.instance.wb();Me.wb();Xg.wb();tg.wb();Jn.instance.wb();this.Da.resolve("Box4.ISelectAllHandlers").wb();P.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").wb();gu.instance.wb();const a=this.Da.ub("Box4.IFeatureHelper");a?a.Fpj.continueWith(()=>{this.Hgh()}):this.Hgh();Ec.wb(Oc.App.RLa);this.Da.resolve("Box4.Actors.TextFormattingActor").wb();gr.instance.wb();this.Da.resolve("Box4.Actors.AccessibilityActor").cQe();
this.Da.resolve("Box4.IClipboardCommands");u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&this.Da.resolve("Box4.ITextPasteFloatieManager").vVk();Oc.App.Kb.updateCommandUI()}Hgh(){P.a.instance.ga(71)&&this.Da.resolve("Box4.Actors.StyleActor").wb()}dispose(){}static main(){z.a.instance.Dc(new GC)}}Object(m.a)(GC,"Box4ActorsPackage",null,[2,3]);class Nm{constructor(a,b){this.o7=this.zVh=null;this.BVh=a;this.Ynb=b}get Hid(){return this.levelText}get Tac(){return this.zVh}get levelText(){return this.BVh}get listStyle(){return 6}get jE(){return"left"}get jna(){return this.o7}get font(){return this.Ynb}}
Object(m.a)(Nm,"ListMarkerBullet",null,[412]);class Qf{static get eq(){return Qf.Zo||(Qf.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}static get Sf(){return Qf.Vg||(Qf.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return Qf.Ht||(Qf.Ht=Db.a.instance.resolve("Box4.IInsertionPointFormatting"))}static er(){return Qf.Hm||(Qf.Hm=Db.a.instance.Ja("Box4.IExternalSelectionManager"))}static get km(){return Ih.ContextSetEditor.instance}static get $i(){return fd.a.instance}static get Wc(){return Nc.a.instance}static get IL(){return Qf.AK||
(Qf.AK=Db.a.instance.ub("Box4.List.ListSettings"))}static get Drc(){return Qf.YWb||(Qf.YWb=Db.a.instance.ub("Box4.List.ISingleLevelListEditor"))}static wb(){const a=u.AFrameworkApplication.Ta;a.ya(D.a.NM,Cb.a.view,Qf.mZb);a.ya(D.a.NM,Cb.a.outlineElement,Qf.Hrb);a.je(D.a.NM,1036);a.ya(D.a.mP,Cb.a.view,Qf.mZb);a.ya(D.a.mP,Cb.a.outlineElement,Qf.Hrb);a.je(D.a.mP,1036);Qf.Sf.Mbb&&(a.ya(D.a.MYa,Cb.a.view,Qf.mZb),a.ya(D.a.MYa,Cb.a.outlineElement,Qf.Hrb),a.je(D.a.MYa,1036));a.ya(D.a.rxf,Cb.a.view,ld.ActionManager.Mg);
a.ya(D.a.nFf,Cb.a.view,ld.ActionManager.Mg);a.ya(D.a.joinList,Cb.a.view,ld.ActionManager.Mg);a.ya(D.a.KQd,Cb.a.view,ld.ActionManager.Mg);a.ya(D.a.RQd,Cb.a.view,ld.ActionManager.Mg);a.ya(D.a.zzh,Cb.a.view,ld.ActionManager.Mg);a.ya(D.a.Azh,Cb.a.view,ld.ActionManager.Mg);a.ya(D.a.R3e,Cb.a.view,ld.ActionManager.Mg)}static mZb(a,b,c,f,l){if(!b.view.Mh)return 2;const x=Qf.Wc.Vp(D.a.mZb);f.hQ=42;f.m8=42;const H={};H[fi.spa]=5796;H[fi.rpa]=5797;var U=b.view;if(P.a.instance.ga(11)){if(Qf.km.asa(Qf.iBj,U.Lb.Pj))return Qf.Wc.Xb(Pd.a.vh,
{["Reason"]:Md.a.BWd}),x.end(),8;if(Qf.km.asa(Qf.qQd,U.Lb.Pj))return Qf.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.M0b}),x.end(),8}if(P.a.instance.ga(14)&&Qf.$i.JYc(U.Lb.Pj))return Qf.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.RD}),x.end(),8;if(Qf.er()&&Qf.er().instance&&Qf.er().instance.XW(b))return Qf.Wc.Xb(Pd.a.vh,{["Reason"]:Md.a.externalSelection}),x.end(),8;if(1===c)return x.end(),32;l||(l=new J.DictionaryPropertySet);let ja=null;var ya=2;if(2===c){ja=new pf.GraphTransaction(15);ja.kd(b.view.xg);Qf.cac=!1;const hb=
ri.dta(U.Lb.Na,!1);if(!hb)return ja.dispose(),Qf.Wc.Xb(Pd.a.Lja,{["Reason"]:Md.a.rPc}),x.end(),8;u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<hb.length&&l.setValue(Mc.a.d_g,null);const yb=l.sa(Mc.a.JT,-1),Zb=l.sa(Mc.a.kE,-1);Qf.IL.Q$b&&Qf.Drc&&Qf.Drc.pMl(hb);if(Qf.Sf.yzh){var Va=Qf.Ngl(yb,Zb,hb);Va&&(l.setValue(Mc.a.kE,16),l.setValue(Mc.a.dea,0));if(!nb.SelectionEditor.Tg(U.Lb.Pj)&&!Va&&a!==D.a.MYa&&0<hb.length&&yb){U=new tb.GraphIterator;
Va=Array(hb.length);for(let fc=0;fc<hb.length;fc++)U.set(hb.getContext(fc).node),Va[fc]=Qf.Sf.jw(U);Qf.Mgl(Va,l)&&(ya=new J.DictionaryPropertySet,ya.setValue(Mc.a.kE,16),ya.setValue(Mc.a.dea,0),ya=fi.M5(a,b,c,f,ya,H,11),u.AFrameworkApplication.Ta.processAction(D.a.Azh,2),ia.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Qf.cac=!0)}}U=new tb.GraphIterator;U.set(hb.getContext(0).node);U=Qf.Sf.jw(U);Qf.Z2j(yb,Zb,U,hb.length)}P.a.instance.ga(63)||P.a.instance.ga(77)?
ya=fi.M5(a,b,c,f,l,H,11):P.a.instance.ga(30)&&(ya=fi.ohb(a,b,c,f,l,H));32===ya&&l.sa(Mc.a.Ryf,!1)&&(P.a.instance.ga(62)?ya=fi.M5(D.a.oC,b,c,f,l,H,11):P.a.instance.ga(29)?ya=fi.ohb(D.a.oC,b,c,f,l,H):P.a.instance.ga(76));ja&&ja.dispose();x.end();return ya}static Mgl(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.sa(Mc.a.JT,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.sa(Mc.a.JT,-3),a=b.sa(Mc.a.kE,
42)!==c.listType||0<a),f||a)?!0:!1}static Z2j(a,b,c,f){0>=f||Qf.cac||(a?c?(c=c.listType,-1===a&&b===c?(u.AFrameworkApplication.Ta.processAction(D.a.R3e,2),ia.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(u.AFrameworkApplication.Ta.processAction(0===b?D.a.RQd:D.a.KQd,2),ia.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(u.AFrameworkApplication.Ta.processAction(0===b?D.a.RQd:D.a.KQd,2),ia.ULS.sendTraceTag(39715534,
393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet")):(u.AFrameworkApplication.Ta.processAction(D.a.R3e,2),ia.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Ngl(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new tb.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=Qf.Sf.jw(a));l--);return f&&b===f.listType?!0:!1}static Hrb(a,b,c,f,l){if(b.contextId!==Cb.a.outlineElement)return 2;if(P.a.instance.ga(14)){var x=
b.clone().SZe();if(Qf.$i.AFa(x))return Qf.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.RD}),2}const H=new tb.GraphIterator;H.set(b.node);nb.SelectionEditor.Bt(H);if(!fe.OutlineElementReader.Yg(H))return 2;if(1===c)switch(a){case D.a.NM:return 32;case D.a.mP:return 32;case D.a.MYa:return 32;default:return 2}x=Qf.Sf.jw(H);let U=l;if(!U)return 8;!rb.ListReader.nx&&a===D.a.mP&&H.Jta()&&(H.NI(4)||U.setValue(Mc.a.BVa,1),H.jp());Qf.Sf.Mbb?(a===D.a.mP||a===D.a.NM?(U=Qf.eq.HSf(a,U),b=dj.a.wN(U.eb(Mc.a.kE),U.eb(Mc.a.dea))):
b=a===D.a.MYa?dj.a.wN(0,1):null,Qf.RQ(a,U),Qf.obl(b,U)):(U=Qf.eq.HSf(a,U),b=dj.a.wN(U.eb(Mc.a.kE),U.eb(Mc.a.dea)));rb.ListReader.nx||(b.xA=U.sa($a.a.DVa,zk.a.Kw));Qf.ucl(U,H);if(!({cab:b}=Qf.eq.Hrb(U,H,b,!1)).returnValue)return Qf.Wc.Xb(Pd.a.Vo,{["Reason"]:Md.a.Pne}),2;2===c&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.sa(Mc.a.kE,-1),b&&-1!==a&&((l=l.sa(ab.a.R_,"Invalid MultiLevel Type"),x)?0!==b.listType&&1!==b.listType||
Qf.cac||(u.AFrameworkApplication.Ta.processAction(D.a.zzh,2),ia.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(u.AFrameworkApplication.Ta.processAction(D.a.nFf,2),ia.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||Qf.cac||(u.AFrameworkApplication.Ta.processAction(D.a.rxf,2),ia.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",
a?"Bullet":"Numbering",l))),l=v.FocusManager.instance(),l.Ae.name===S.AppFrame.vmd&&l.iD(E.AFrame.yW));f.hQ=b.listType;f.m8=b.listStyle;return 32}static ucl(a,b){var c=new tb.GraphIterator;c.Rc(b);(b=c.Bb(2))&&Sb.ParagraphReader.$d(b)&&(c=qd.a.instance.Na.mb)&&c.Ua&&c.Ua.node===b&&nb.SelectionEditor.U_c(c)&&(Qf.oal(a),Qf.mal(a))}static obl(a,b){b.Sa(ab.a.R_)&&a.nbl(b.eb(ab.a.R_));a.JT=b.sa(Mc.a.JT,-1);a.ame?(b=Qf.Pbj(a,b),Qf.rcl(a,b)):Qf.w$k(a)}static w$k(a){if(a.f_c)a.PVc&&-1===a.JT||(a.levelText=
"%1.",a.propertySet.Sa($a.a.Ri)||a.Aya(0,1));else if(1===a.listType)a.PVc&&-1===a.JT||(a.font=zk.a.BJi,a.levelText=zk.a.defaultBullet,a.propertySet.Sa($a.a.Ri)||a.Aya(1,6));else return;a.jE="left"}static rcl(a,b){1===a.R_?Qf.Cbl(a,b):Qf.Cal(a,b)}static Cbl(a,b){a.jna=b.jna}static Cal(a,b){a.levelText=b.levelText;a.f_c?a.Aya(0,b.listStyle):(a.font=b.font,a.Aya(1,1));a.jE=b.jE}static Pbj(a,b){let c=null;2===a.R_?c=a.f_c?Db.a.instance.ub("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Db.a.instance.ub("Box4.ListMarkerGallery.ListMarkerBulletLoader"):
1===a.R_&&(c=Db.a.instance.ub("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.ypg.value;a=a.JT+"";a in f||(f=c.p_j);return a in f||!b.Sa($a.a.font)?f[a]:new Nm(ha.a.fromCharCode(parseInt(a)),b.sa($a.a.font,""))}static mal(a){Qf.insertionPointFormatting.Sa($a.a.fontColor)&&a.setValue($a.a.fontColor,Qf.insertionPointFormatting.fontColor())}static oal(a){Qf.insertionPointFormatting.Sa($a.a.fontSize)&&a.setValue($a.a.fontSize,Qf.insertionPointFormatting.fontSize())}static RQ(a,b){ia.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===D.a.NM?0:a===D.a.mP?1:a===D.a.MYa?2:-1,b.sa(Mc.a.JT,-1))}}Qf.iBj=rd.ImageReader.U9b;Qf.qQd=rd.ImageReader.Yyb;Qf.Zo=null;Qf.Vg=null;Qf.Ht=null;Qf.Hm=null;Qf.AK=null;Qf.YWb=null;Qf.cac=!1;Object(m.a)(Qf,"ListActor",null,[]);var eJ=d(1203);class hu{constructor(){this.CVh=new mc.a(Object(F.a)(this,this.WXd,"createListMarkerDictionary"));this.DVh={}}get ypg(){return this.CVh}get p_j(){return this.DVh}}Object(m.a)(hu,"AListMarkerGalleryLoader",null,[490]);var fJ=
d(1230);class xz extends dx.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(m.a)(xz,"ListGalleryButtonProps",dx.a,[]);class Ps{constructor(a,b,c,f){this.uUb=null;this.PAf="BulletLibraryGallery";this.Epk="NumberingLibraryGallery";this.jnk="MultilevelGallery";this.V3a=a;this.EVh=b;switch(a){case 0:this.uUb="BulletStyle";break;case 1:this.uUb="NumberingStyle";break;case 2:this.uUb="MultilevelStyle";break;default:this.uUb="BulletStyle"}this.CUh=f}get q_j(){return this.EVh}Usf(a){let b;
var c=1;switch(this.V3a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new hk.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var x=0===this.V3a?"Size40by40":"Size48by48";c=Object.assign(new sq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.p7d(this.V3a),Type:c,Width:6,ElementDimensions:x,GalleryItems:[]});l=this.q_j.ypg.value;x=tq.a(l);const H=Math.min(18,x.length);for(let U=0;U<H;U++){const ja=l[x[U]];this.CUh&&a&&((1===this.V3a||2===this.V3a)&&!ja.Tac||0===this.V3a&&ja.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.o7d(this.uUb+
b+"_"+U,ja,this.V3a))}Array.add(f.ControlList,c);return f}p7d(a){switch(a){case 0:return this.PAf;case 1:return this.Epk;case 2:return this.jnk;default:return this.PAf}}X1f(a){const b={},c=da.FontUtils.jja(a.font);b.fontFamily=da.FontUtils.erb(c,a.font,!0,!1,!1);return b}o7d(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=ha.a.hw(b.levelText.charCodeAt(0),4),f=Ps.mJj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let x,H;switch(c){case 0:c=
D.a.NM;x=D.a.mdh;H=Object.assign(new fJ.a,{Character:b.levelText,Style:this.X1f(b)});break;case 1:c=D.a.mP;x=D.a.ZLk;H=Object.assign(new xz,{LevelInfo:b.Tac});break;case 2:c=D.a.MYa;x=D.a.YLk;H=Object.assign(new xz,{LevelInfo:b.Tac});b.jna&&(f=b.jna.description,l=!0);break;default:c=D.a.NM,x=D.a.mdh,H=Object.assign(new fJ.a,{Character:b.levelText,Style:this.X1f(b)})}H.Id=a;H.Command=c.toString();H.QueryCommand=x.toString();H.Alt=f;H.InnerHTML=ha.a.ue(this.n_j(b));H.ShouldSetTitle=l.toString();return H}n_j(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.b8d(a),this.a8d(a))}b8d(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.Hid===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Ps.Afg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=da.FontUtils.jja(a.font);b.append(da.FontUtils.erb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}a8d(a){return a.Hid}static mJj(a){for(let b=0;b<Ps.jyf.length;b++)if(a===Ps.jyf[b])return!0;return!1}}Ps.Afg="EXYdHRyjlYTe8nDSGfyW";
Ps.jyf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(m.a)(Ps,"ListMarkerGalleryUtility",null,[]);class HC extends hu{constructor(){super();new eJ.a(qB.a.to())}WXd(){const a={};a["0"]=new Nm(Box4Intl.Box4Strings.L_ListStyleNone,Ps.Afg);a["1"]=new Nm(String.fromCharCode(61623),"Symbol");a["2"]=new Nm(String.fromCharCode(111),"Courier New");a["3"]=new Nm(String.fromCharCode(61607),"Wingdings");a["4"]=new Nm(String.fromCharCode(9643),"Courier New");a["5"]=new Nm(String.fromCharCode(61611),
"Wingdings");a["6"]=new Nm(String.fromCharCode(61614),"Symbol");a["7"]=new Nm(String.fromCharCode(61483),"Symbol");a["8"]=new Nm(String.fromCharCode(61485),"Symbol");a["9"]=new Nm(String.fromCharCode(9830),"Courier New");a["10"]=new Nm(String.fromCharCode(61664),"Symbol");a["11"]=new Nm(String.fromCharCode(61558),"Wingdings");a["12"]=new Nm(String.fromCharCode(61656),"Wingdings");a["13"]=new Nm(String.fromCharCode(61514),"Wingdings");a["14"]=new Nm(String.fromCharCode(61516),"Wingdings");a["15"]=
new Nm(String.fromCharCode(61692),"Wingdings");a["16"]=new Nm(String.fromCharCode(61691),"Wingdings");a["17"]=new Nm(String.fromCharCode(61553),"Wingdings");return a}}Object(m.a)(HC,"ListMarkerBulletLoader",hu,[]);class Xk{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(Xk,"InfoAtLevel",null,[]);class iu{constructor(a){this.o7=a}get font(){return"Calibri"}get listStyle(){return 42}get jE(){return"left"}get jna(){return this.o7}get Hid(){return this.o7?this.gJk():this.iJk()}get Tac(){return this.o7?
this.hJk():null}get levelText(){return""}Q9i(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}gJk(){let a="";for(let b=0;3>b;b++)a+=this.lEa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',iu.n6d(),a)}hJk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Xk,{textAtLevel:this.h5f(b),styleAtLevel:this.Nkj(b)}));return a}iJk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
iu.o6d(),Box4Intl.Box4Strings.L_ListStyleNone)}h5f(a){a=this.o7.kpg[a];for(let b=0;9>b;b++)a=ha.a.replaceAll(a,"%"+(b+1),this.Q9i(this.o7.M1c[b]));return a}Nkj(a){const b={};b.fontFamily=6===this.o7.M1c[a]?this.o7.vXf[a]:this.font;return b}lEa(a){const b=this.h5f(a),c=new Sys.StringBuilder;6===this.o7.M1c[a]&&c.append(String.format("font-family:{0};",this.o7.vXf[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static n6d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static o6d(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(iu,"ListMarkerMultilevel",null,[412]);class yz{constructor(a,b,c,f,l){this.kpg=a;this.M1c=b;this.YXj=f;this.vXf=c;this.description=l}}Object(m.a)(yz,"MultilevelDefInfo",null,[]);class gJ{QCi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),x=Array(9);for(let H=0;9>H;H++)b+="%"+(H+1)+".",c[H]=b,f[H]=1,l[H]="left";return new yz(c,f,x,l,a)}bFi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new yz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}hCi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let x=0;9>x;x++)l[x]=String.fromCharCode(a[x]),c[x]=6,f[x]="left";return new yz(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(m.a)(gJ,"MultilevelDefInfoAdaptor",null,[]);class IC extends hu{constructor(){super()}WXd(){const a=new gJ,b={};b["0"]=new iu(null);b["1"]=new iu(a.QCi());b["2"]=new iu(a.bFi());b["3"]=new iu(a.hCi());return b}}Object(m.a)(IC,"ListMarkerMultilevelLoader",hu,[]);
class bn{constructor(a,b){this.o7=null;this.P3a=a;this.AAc=b}get font(){return"Calibri"}get listStyle(){return this.AAc}get jE(){switch(this.AAc){case 3:case 5:return"right";default:return"left"}}get jna(){return this.o7}get Hid(){switch(this.AAc){case 1:return this.RJa("1","2","3");case 2:return this.RJa("a","b","c");case 3:return this.RJa("i","ii","iii");case 4:return this.RJa("A","B","C");case 5:return this.RJa("I","II","III");case 0:return this.jJk();default:return this.RJa("1","2","3")}}get Tac(){const a=
[],b={};b.fontFamily=da.FontUtils.jja(this.font);switch(this.AAc){case 1:return a.push(Object.assign(new Xk,{textAtLevel:this.IN("1"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("2"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Xk,{textAtLevel:this.IN("a"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("b"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Xk,{textAtLevel:this.IN("i"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("ii"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Xk,{textAtLevel:this.IN("A"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("B"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Xk,
{textAtLevel:this.IN("I"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("II"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Xk,{textAtLevel:this.IN("1"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("2"),styleAtLevel:b})),a.push(Object.assign(new Xk,{textAtLevel:this.IN("3"),styleAtLevel:b})),a}}get levelText(){return this.P3a}RJa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
bn.n6d(),this.lEa(a),this.lEa(b),this.lEa(c))}jJk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',bn.o6d(),Box4Intl.Box4Strings.L_ListStyleNone)}lEa(a){a=this.IN(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}IN(a){return ha.a.replaceAll(this.P3a,"%1",a)}static n6d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static o6d(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(bn,"ListMarkerNumbering",null,[412]);class JC extends hu{constructor(){super();new eJ.a(qB.a.to())}WXd(){const a={};a["0"]=new bn(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new bn("%1.",5);a["2"]=new bn("%1.",4);a["3"]=new bn("%1.",1);a["4"]=new bn("%1.",2);a["5"]=new bn("%1.",3);a["6"]=new bn("%1)",5);a["7"]=new bn("%1)",4);a["8"]=new bn("%1)",1);a["9"]=new bn("%1)",
2);a["10"]=new bn("%1)",3);a["11"]=new bn("(%1)",5);a["12"]=new bn("(%1)",4);a["13"]=new bn("(%1)",1);a["14"]=new bn("(%1)",2);a["15"]=new bn("(%1)",3);return a}}Object(m.a)(JC,"ListMarkerNumberingLoader",hu,[]);class KC{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){Qf.wb()}dispose(){}Zb(a){this.Da=a;this.Da.register(HC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().oa(()=>new HC);this.Da.register(JC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().oa(()=>new JC);
this.Da.register(IC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().oa(()=>new IC)}static main(){z.a.instance.Dc(new KC)}}Object(m.a)(KC,"Box4ListMarkerPackage",null,[2,3]);class LC{constructor(a){this.dxd=a}Ohg(a){if(!this.dxd)return!0;a=bg.a.NSc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.dxd.length;b++)if(a.endsWith(this.dxd[b]))return!0;return!1}}Object(m.a)(LC,"DomainAllowListManager",null,[]);class hJ{constructor(a,b){this.mZd=null;this.sMd=a;this.url=b}get r5e(){return bg.a.boa(this.url)}get NB(){return this.sMd}b2e(){const a=
{},b=this.NB;a.a=this.r5e;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.mZd;return a}round(a){return Math.round(1E3*a)/1E3}}Object(m.a)(hJ,"PerformanceTimingEntry",null,[]);const iJ=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var ai=d(288);class $r{constructor(a,b=null,c=null){this.oi=a;this.q5e=this;this.TRh=b||(()=>window.location.href);this.cAd=new LC(c)}run(){if($r.jCa(window.performance))try{const l=
this.TRh();if($r.h2h.exec(l)&&this.cAd.Ohg(l)){var a=new hJ(window.performance.timing,l);Ci.a.instance.vRk(a.NB.fetchStart);Ci.a.instance.xRk(a.NB.navigationStart);Ci.a.instance.CYa(ai.a.W_i,"connectStart","requestStart");Ci.a.instance.CYa(ai.a.b0i,"requestStart","responseStart");Ci.a.instance.CYa(ai.a.d0i,"responseStart","responseEnd");this.q5e.Qbb(1,a.b2e());this.oi.ic(ai.a.MDa,a.NB.fetchStart);this.oi.ic(ai.a.$_i,a.NB.domainLookupStart);this.oi.ic(ai.a.dYf,a.NB.domainLookupEnd);this.oi.ic(ai.a.Y_i,
a.NB.connectStart);this.oi.ic(ai.a.e0i,a.NB.secureConnectionStart);this.oi.ic(ai.a.X_i,a.NB.connectEnd);this.oi.ic(ai.a.fYf,a.NB.requestStart);this.oi.ic(ai.a.MQc,a.NB.responseStart);this.oi.ic(ai.a.eYf,a.NB.responseEnd-a.NB.responseStart);this.oi.ic(ai.a.c0i,a.NB.responseStart-a.NB.requestStart);var b=0,c=0,f=0;({transferSize:b,c1d:c,xZd:f}=this.Fzl(l)).returnValue&&(this.oi.ic(ai.a.f0i,b),this.oi.ic(ai.a.Z_i,f),this.oi.ic(ai.a.a0i,c));this.oi.ic(ai.a.L4b,a.NB.navigationStart)}}catch(l){ia.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}Fzl(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,c1d:c,xZd:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,c1d:c,xZd:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,c1d:c,xZd:f}}Qbb(a,b){ia.ULS.sendTraceTag(4551815,306,50,iJ(a,b))}static get instance(){return $r.Ka||($r.Ka=new $r(Cg.a.instance,null,u.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.fa.WA("ResourceLoggerDomainAllowList"):null))}static jCa(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}$r.Ka=null;$r.h2h=RegExp("^https?://.*","i");Object(m.a)($r,"PerformanceTimingLogger",
null,[410]);class Qs{constructor(a,b){this.mZd=null;this.sMd=a;this.behavior=b;this.url=this.NB.name}get r5e(){return 2===this.behavior?this.url:bg.a.boa(this.url)}get NB(){return this.sMd}b2e(){const a={},b=this.NB;a.a=this.r5e;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(Qs.mxb(b,"decodedBodySize"));a.p=this.round(Qs.mxb(b,"encodedBodySize"));a.q=this.round(Qs.mxb(b,"transferSize"));a.n=this.mZd;return a}round(a){return Math.round(1E3*a)/1E3}static mxb(a,b){return a[b]}}Object(m.a)(Qs,"ResourceTimingEntry",null,[437]);class jJ{constructor(a,b=null,c=100){this.M7e=a;this.YDc=b;this.Fmb={};this.dOh=
c}wyl(a){var b=a.name.toLowerCase();const c=bg.a.S8d(b);this.B2k(c,b)&&(c in this.Fmb?ia.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.ZVj(a),b.encodedsize=Qs.mxb(a,"encodedBodySize"),b.decodedsize=Qs.mxb(a,"decodedBodySize"),this.Fmb[c]=b))}B2k(a,b){if(this.M7e)return Array.contains(this.M7e,a);if(this.YDc)for(a=bg.a.YD(b),b=0;b<this.YDc.length;b++)if(this.YDc[b]&&a.endsWith(this.YDc[b]))return!0;
return!1}ZVj(a){try{const b=Qs.mxb(a,"transferSize");if(void 0!==b&&null!==b)return!b;ia.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.dOh}catch(b){ia.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}jSk(){if(pa.a.Wa(this.Fmb))ia.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var a=u.AFrameworkApplication.cT?u.AFrameworkApplication.cT.split(";"):[],b=Object.assign(new Oj.a,{extendedProperties:Yn.a.Rz()});b.extendedProperties.set("Flights",xd.c(a));this.W2j(b,this.Fmb,kf.Health.instance)}}j5d(a){let b=0,c=0,f=0,l=0;const x=this.Fmb;for(let U in x){var H=x[U];U.endsWith(".js")&&(H=Object(oa.a)(Object,H),H.responseend<a&&(b+=1,c+=H.decodedsize,l+=H.encodedsize,f+=H.iscached?0:H.encodedsize))}a={};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=f;a.encodedBytes=l;
return a}W2j(a,b,c){if(b){var f=0,l=0,x=0,H=0,U=0,ja=0,ya=0,Va=0,hb=0,yb=0,Zb=0;for(let Kc in b){var fc=b[Kc];try{const Lc=Object(oa.a)(Object,fc);if(!Lc)continue;const Gc=Lc.iscached?Boolean.parse(Lc.iscached.toString()):!1,ae=Lc.fetchstart?this.parseFloat(Lc.fetchstart.toString()):0,we=(Lc.responseend?this.parseFloat(Lc.responseend.toString()):0)-ae,$d=Lc.encodedsize?this.parseFloat(Lc.encodedsize.toString()):0,Te=Lc.decodedsize?this.parseFloat(Lc.decodedsize.toString()):0;f+=we;H+=$d;ya+=Te;yb++;
Gc?(x+=we,ja+=$d,hb+=Te,Zb++):(l+=we,U+=$d,Va+=Te)}catch(Lc){ia.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Lc.message)}}a.extendedProperties.set("StaticResources",xd.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",x.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
H.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",U.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ja.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",ya.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Va.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",hb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",yb.toString());
a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Zb.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(m.a)(jJ,"AppStaticResourceManager",null,[]);class kJ extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(m.a)(kJ,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class xv{constructor(a,
b,c=null,f=null,l=100){this.uEd=!1;this.Um=null;this.pRb=0;this.Pa=new wc.a;this.Mmb=null;this.Fha=!1;this.Opf=0;this.Zd=a;this.n$e=0;this.q5e=this;this.cAd=new LC(c);this.FD=b;f&&(this.Mmb=new jJ(null,f,l))}get dAf(){try{return!(void 0===this.FD||null===this.FD)&&!(void 0===this.FD.getEntriesByType||null===this.FD.getEntriesByType)}catch(a){return ia.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get zJi(){return this.n$e}get isActive(){return this.Fha}get T1e(){return this.Opf}Wtf(a){this.Pa.addHandler(xv.K1d,
a)}cih(a){this.Pa.removeHandler(xv.K1d,a)}Zb(a,b){const c=this.T1e!==a;this.Opf=a;this.isActive&&this.Zd&&c&&(this.Lg(),this.Db());this.n$e=b}activate(){!this.isActive&&this.dAf&&(this.Db(),this.Fha=!0)}deactivate(a){this.isActive&&(this.Lg(),a&&this.flush(),this.Fha=!1)}flush(){if(this.isActive&&this.dAf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.pRb&&ia.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
a.length-this.pRb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.pRb=0);const c=[];for(let f=this.pRb;f<a.length;f++)this.cAd.Ohg(a[f].name)&&(this.Mmb&&this.Mmb.wyl(a[f]),c.push(new Qs(a[f],this.zJi)));b||(this.pRb=a.length);this.Pa.raiseEvent(xv.K1d,new kJ(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.q5e.Qbb(0,c[a].b2e());0<c.length&&ia.ULS.sendTraceTag(19506834,
306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){ia.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}Qbb(a,b){ia.ULS.sendTraceTag(4310804,306,50,iJ(a,b))}qRk(){this.Mmb.jSk()}j5d(a){return this.Mmb.j5d(a)}Db(){this.Zd&&0<this.T1e&&(this.Um=new af.a(3,2,1E3*this.T1e,()=>{this.flush()},5),this.Zd.Db(this.Um),this.uEd=!0)}Lg(){this.uEd&&(this.Zd.Lg(this.Um),this.Um=null,this.uEd=!1)}}xv.K1d="EntriesAvailable";
Object(m.a)(xv,"ResourceTimingLogger",null,[361,410]);class MC{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");$r.instance.run()}dispose(){}Zb(a){this.Da=a;let b=null;if(u.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=u.AFrameworkApplication.fa.WA("ResourceLoggerDomainAllowList")}catch(l){ia.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=
[];c.push(bg.a.YD(rn.a.iP).toLowerCase());c.push(bg.a.YD(rn.a.wMb).toLowerCase());const f=u.AFrameworkApplication.fa.Bc("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(361,"Common.NetworkTiming.IResourceTimingLogger").ma().oa(()=>new xv(u.AFrameworkApplication.ye,window.performance,b,c,f))}static main(){z.a.instance.Dc(new MC)}}Object(m.a)(MC,"ResourceTimingPackage",null,[2,3]);class yv{}yv.visible="visible";yv.hidden="hidden";Object(m.a)(yv,"PlatformVisibilityState",null,[]);var zz=
d(198);class lJ extends Sys.EventArgs{constructor(a,b){super();this.Phf={};this.gXh=a;this.PWh=b}get oldState(){return this.gXh}get newState(){return this.PWh}Mib(a,b){this.Phf[a]=b}toString(){return xd.c(this.Phf)}}Object(m.a)(lJ,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class NC{constructor(a,b,c,f){this.Mpf=this.qPa=null;this.oof=!0;this.Pa=new wc.a;this.Zd=a;this.yBd=b;this.u$e=c;this.m3h=f;this.Eff=!1;u.AFrameworkApplication.fa&&(this.Eff=u.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),
this.oof=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.O7e=0;this.Lpf=new Date;this.yBd()===yv.hidden&&this.jJf();$addHandler(window,"focus",Object(F.a)(this,this.W4g,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(F.a)(this,this.Nfd,"onPlatformBlurHandler"));$addHandler(document,"freeze",Object(F.a)(this,this.X4g,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(F.a)(this,this.Y4g,"onPlatformVisibilityChangeHandler"));
this.oof&&($addHandler(document,"pageshow",Object(F.a)(this,this.Nfd,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(F.a)(this,this.Nfd,"onPlatformBlurHandler")))}get m6a(){return this.O7e}get isVisible(){return 2!==this.m6a}FGc(a){this.Pa.addHandler("VST",a)}mZk(a){this.Pa.removeHandler("VST",a)}Nfd(a){this.FOb(a.type,this.pae())}W4g(a){this.FOb(a.type,0)}X4g(a){3!==this.m6a&&(this.DFf(),this.FOb(a.type,2),this.FOb(a.type,3),u.AFrameworkApplication.Xg.nkk())}pae(){return this.yBd()===
yv.hidden?2:document.hasFocus()?0:1}FOb(a,b){const c=this.m6a;this.O7e=b;if(c!==this.m6a){3===c&&this.Eff&&this.a6k();const f=new Date,l=new lJ(c,this.m6a);l.Mib("FromState",bm[c]);l.Mib("ToState",bm[b]);l.Mib("OriginatingEvent",a);l.Mib("TimeInState",(+f-+this.Lpf).toString());this.Lpf=f;this.m3h.arg(l);this.Pa.raiseEvent("VST",l)}}Y4g(a){this.yBd()===yv.hidden?this.qPa?this.Zd.V5(this.qPa,this.u$e):this.jJf():(this.DFf(),this.FOb(a?a.type:"",this.pae()))}dispose(){$removeHandler(window,"focus",
Object(F.a)(this,this.W4g,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(F.a)(this,this.Nfd,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(F.a)(this,this.X4g,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(F.a)(this,this.Y4g,"onPlatformVisibilityChangeHandler"))}DFf(){this.qPa&&(this.Zd.Lg(this.qPa),this.qPa=null)}jJf(){this.qPa=new af.a(4,1,this.u$e,Object(F.a)(this,this.dxj,"handleVisibilityUpdate"),157);this.Zd.Db(this.qPa)}dxj(){this.qPa=
null;this.FOb("TaskItem",this.pae())}r4j(a){ia.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.irg,+new Date-+this.Mpf,zz.SessionStatusManager.instance.uka)}a6k(){this.Mpf=new Date;this.Zd.Db(this.C1b(0,"Realtime"));this.Zd.Db(this.C1b(1,"AboveNormal"));this.Zd.Db(this.C1b(2,"Normal"));this.Zd.Db(this.C1b(3,"Background"));this.Zd.Db(this.C1b(4,"Low"))}C1b(a,b){return new af.a(a,1,0,Object(F.a)(this,this.r4j,"logTimeToExecuteTask"),0,b)}}Object(m.a)(NC,
"VisibilityManager",null,[494,106]);class zQ{arg(){}}Object(m.a)(zQ,"NullVisibilityManagerTelemetry",null,[409]);class Az{constructor(){this.Pa=new wc.a}arg(a){ia.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new Az}}Object(m.a)(Az,"VisibilityManagerTelemetry",null,[409]);class OC{constructor(){this.Da=null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Da.ub("Common.App.VisibilityManagement.VisibilityManager");
a&&a.dispose()}Zb(a){this.Da=a;this.Da.register(Az,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").oa(()=>Az.create()).ma();this.Da.register(NC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").oa(()=>new NC(u.AFrameworkApplication.ye,()=>window.document.visibilityState,6E4*u.AFrameworkApplication.fa.Bc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){z.a.instance.Dc(new OC)}}
Object(m.a)(OC,"VisibilityManagerPackage",null,[2,3]);var AQ=d(1218);class mJ{constructor(a,b){this.r4c=new Rd.a;this.u4c=new Rd.a;this.RHa=b;this.mWa=a}Kp(a){!a||this.r4c.Hb(a.id)||this.u4c.Hb(a.id)||this.mWa.Kp(a)}tgh(a){this.PTk(a)}ugh(a){this.RTk(a)}PTk(a){var b=null;this.RHa&&a&&(this.Kp(a),b=b||Object(F.a)(this,this.oHe,"onDragOver"),this.r4c.$(a.id,b),this.mWa.pb(ta.a.drop,a,b))}RTk(a){var b=null;this.RHa&&a&&(this.Kp(a),b=b||Object(F.a)(this,this.pHe,"onDrop"),this.u4c.$(a.id,b),this.mWa.pb(ta.a.h8a,
a,b))}yb(a){this.RHa&&a&&(this.mWa.Zq(a),this.r4c.ga(a.id)&&this.mWa.yb(ta.a.h8a,a,this.r4c.ga(a.id)),this.u4c.ga(a.id)&&this.mWa.yb(ta.a.drop,a,this.u4c.ga(a.id)))}mAj(){this.mWa&&this.mWa.dispose()}pHe(a){a=a.qc;a.preventDefault();a.stopPropagation();return!0}oHe(a){a=a.qc;a.preventDefault();a.stopPropagation();return!0}}Object(m.a)(mJ,"PPTDragDropInputHelper",null,[345]);class PC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Zb(a){if(!a)throw Error.argumentNull("container");
this.K=a;this.K.register(345,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().oa(()=>new mJ(AQ.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").FQd;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").tgh(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ugh(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").tgh(this.K.resolve("PowerPointWebEditor.AppFrame").X1),
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ugh(this.K.resolve("PowerPointWebEditor.AppFrame").X1))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").yb(this.K.resolve("PowerPointWebEditor.AppFrame").FQd);this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").mAj()}static main(){z.a.instance.Dc(new PC)}}Object(m.a)(PC,"PPTWebEditorDragDropPackage",null,[2,3]);class nJ{constructor(a){this.zYh=a}uXe(){return Math.random()<this.zYh}}
Object(m.a)(nJ,"RandomSampler",null,[1531]);class oJ{constructor(a){this.ISb=null;this.i0h=a}SYb(a,b){if("ForceSample"===b||this.i0h())this.ISb||(this.ISb=[]),Array.add(this.ISb,a)}getData(){return this.ISb}reset(){this.ISb=null}}Object(m.a)(oJ,"SampleDataAggregator",null,[1524]);var pJ=d(534);class qJ{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(m.a)(qJ,"PPTEventTimingData",null,[]);class xq{constructor(){this.kAe=!1;this.f$={};this.Gek=a=>{window.requestAnimationFrame(a)};
this.fCb=[];this.f$.ArrowDown=!0;this.f$.ArrowLeft=!0;this.f$.ArrowRight=!0;this.f$.ArrowUp=!0;this.f$.Backspace=!0;this.f$.Delete=!0;this.f$.End=!0;this.f$.Enter=!0;this.f$.Home=!0;this.f$.PageDown=!0;this.f$.PageUp=!0;this.f$.Tab=!0}Wqc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.f$}Fki(a){const b={};b.key=this.Wqc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();
return b}myh(a){const b=new qJ;b.metadata=this.Fki(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=xq.DQa?(!xq.DQa.amIAlone).toString():"null";this.fCb.push(b);this.dVk()}Dyh(a){if(this.fCb.length)for(const b of this.fCb)if(b.timeStamp===a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}dVk(){this.kAe||(this.Gek(()=>{this.kAe=!1;window.dispatchEvent(pJ.a.instance.create(ta.a.gQd,this.fCb.slice(0,this.fCb.length)));this.fCb=[]}),this.kAe=!0)}keyPressedEventHandlerStart(a){xq.gZc(a)&&
!this.Wqc(a)&&this.myh(a)}keyPressedEventHandlerEnd(a){xq.gZc(a)&&!this.Wqc(a)&&this.Dyh(a)}keyDownEventHandlerStart(a){xq.gZc(a)&&this.Wqc(a)&&this.myh(a)}keyDownEventHandlerEnd(a){xq.gZc(a)&&this.Wqc(a)&&this.Dyh(a)}static get DQa(){return xq.nGf||(xq.nGf=Db.a.instance.ub("PowerPointWebEditor.ICoauthStateGetter"))}static gZc(a){return!!a&&a.timeStamp<window.performance.now()}}xq.nGf=null;Object(m.a)(xq,"PPTEventTimingMeter",null,[340]);class as{constructor(){this.Jdc=[];this.IDb=this.M7c=this.yHa=
this.o$c=null;this.n$c=0;this.r7c=!1}start(a){if(!this.r7c){Array.clear(this.Jdc);for(let b=0;b<as.K4b.length;++b)this.Jdc.push(0);this.o$c=window.setInterval(Object(F.a)(this,this.Ojh,"reportMeasuredFrames"),1E3*a);this.n$c=window.performance.now();this.S4e(null);$addHandler(window,"visibilitychange",Object(F.a)(this,this.S4e,"updateMeasureCurrentFrameLoop"));this.r7c=!0}}stop(){this.r7c&&($removeHandler(window,"visibilitychange",Object(F.a)(this,this.S4e,"updateMeasureCurrentFrameLoop")),null!=
this.o$c&&(window.clearInterval(this.o$c),this.o$c=null),null!=this.yHa&&(window.cancelAnimationFrame(this.yHa),this.yHa=null),this.Ojh(),this.r7c=!1)}Ojh(){if(null!=this.IDb){var a={};for(var b=0;b<as.K4b.length;++b)a[as.K4b[b].toString()]=this.Jdc[b],this.Jdc[b]=0;b=window.performance.now();var c={};c.intervalStart=this.n$c;c.duration=b-this.n$c;c.maxFrameLengthMs=this.IDb;c.frameData=a;window.dispatchEvent(pJ.a.instance.create(ta.a.URe,c));this.IDb=null;this.n$c=b}}S4e(){as.jRj&&null==this.yHa?
(this.M7c=null,this.yHa=window.requestAnimationFrame(Object(F.a)(this,this.yYg,"measureCurrentFrame"))):null!=this.yHa&&(window.cancelAnimationFrame(this.yHa),this.yHa=null)}yYg(a){if(null!=this.M7c){const b=a-this.M7c;if(null==this.IDb||this.IDb<b)this.IDb=b;for(let c=0;c<as.K4b.length;++c)if(b<as.K4b[c]){++this.Jdc[c];break}}this.M7c=a;this.yHa=window.requestAnimationFrame(Object(F.a)(this,this.yYg,"measureCurrentFrame"))}static get jRj(){return"visible"===window.document.visibilityState}}as.K4b=
[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(m.a)(as,"PPTFrameTimingMeter",null,[341]);class QC{constructor(){this.Rgc=this.Hbc=null;this.XBg=this.IBg=!1}Zb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&(u.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!B.a.Ej&&(a.register(340,"Common.IEventTimingMeter").ma().oa(()=>new xq),this.IBg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&
(a.register(341,"Common.IFrameTimingMeter").ma().oa(()=>new as),this.XBg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.IBg){var a=new nJ(u.AFrameworkApplication.fa.Bc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new oJ(Object(F.a)(a,a.uXe,"shouldBeInSample"));const b=Jq.a.GW(16,1,a);this.Hbc=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};Id.a.addHandler(window.self,ta.a.gQd,this.Hbc)}this.XBg&&(this.Rgc=b=>{b&&(b=b.rawEvent)&&xa.a.J(39706653,
306,50,xd.c(b.detail))},Id.a.addHandler(window.self,ta.a.URe,this.Rgc))}dispose(){this.Hbc&&(Id.a.removeHandler(window.self,ta.a.gQd,this.Hbc),this.Hbc=null);this.Rgc&&(Id.a.removeHandler(window.self,ta.a.URe,this.Rgc),this.Rgc=null)}static main(){z.a.instance.Dc(new QC)}}Object(m.a)(QC,"PPTEventTimingMeterPackage",null,[2,3]);var RC=d(455);class rJ{constructor(a){this.xif=new Rd.a(null);this.uRh=a}ga(a){let b;({value:b}=this.xif.Uf(a)).returnValue||(b=this.uRh(a),this.xif.$(a,b));return b}}Object(m.a)(rJ,
"MemoizedLookup",null,[1555]);var BQ=d(839),CQ=d(711);class SC{constructor(a){this.fDk=0;this.PO=a}}Object(m.a)(SC,"GraphMergerResponse",null,[]);var DQ=d(322);class TC extends rf.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=this.Source=0}Zk(){return 33}static construct(a,b,c,f,l,x,H,U,ja){const ya=new TC;ya.BaseRevisions=a;ya.TheirRevisions=
b;ya.YourRevisions=c;ya.IgnoreConflictsInLastServerRevision=f;ya.MergeHint=l;ya.ObjectSpaceId=x?L.a(x):null;ya.RequestId=H?L.a(H):null;ya.Source=U;ya.Reason=ja;return ya}}Object(m.a)(TC,"CreateGraphMergeReplayRequest",rf.a,[]);d(832);class Bz{Sa(a){return a.Sa(void 0)}q5f(a,b){return a.sa(b,null)}OTc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Nj.a(a)}t5f(a,b){return a.sa(b,"")}Yqh(a,b,c){a.setValue(b,c)}}Object(m.a)(Bz,"MergeableObjectUtilities",null,[365]);class EQ{constructor(a,b=null,
c=null){this.ZFd=b||new Bz;c||Object(F.a)(this,this.cOi,"doParagraphMergeNoOP")}cOi(a,b){return{UNl:a,TNl:b}}}Object(m.a)(EQ,"GraphMergeSelectionRecordUpdater",null,[]);class sJ{constructor(){this.source=0;this.Ru=this.SPb=this.ULa=null;this.Oic=0;this.CWc=!1;this.r_e=0}}Object(m.a)(sJ,"InputState",null,[]);class tJ{constructor(){this.timeout=this.succeeded=this.crash=!1;this.PO=null}}Object(m.a)(tJ,"OutputState",null,[]);class uJ{constructor(){this.XQc=this.iqd=this.grc=!1;this.f1a=this.bBl=this.eWi=
this.cEe=this.nFh=this.$Uf=this.fzf=this.yKc=null}}Object(m.a)(uJ,"RuntimeState",null,[]);class vJ{constructor(){this.input=new sJ;this.runtime=new uJ;this.output=new tJ}}Object(m.a)(vJ,"MergeState",null,[]);var cd=d(1100);class Bx{constructor(a,b,c){this.RYh=a;this.hXh=b;this.QWh=c;this.iDd=new mc.a(Object(F.a)(this,this.nri,"checkIfDifferent"))}get WIb(){return this.RYh}get oldValue(){return this.hXh}get newValue(){return this.QWh}get c9(){return!!this.newValue&&!this.oldValue}get isDeleted(){return!this.newValue&&
!!this.oldValue}get zab(){return this.c9||this.isDeleted||this.iDd.value}nri(){return this.c9||this.isDeleted?!0:!cd.a.Xxf(this.WIb,this.oldValue,this.newValue)}}Object(m.a)(Bx,"PropertyDiff",null,[]);class Cx{constructor(a,b){this.eXh=a;this.NWh=b;this.iDd=new mc.a(()=>this.VYc(null));this.TYh=new mc.a(Object(F.a)(this,this.kTi,"evaluatePropertyDiffs"))}get TGb(){return this.eXh}get y5(){return this.NWh}get c9(){return!!this.y5&&!this.TGb}get isDeleted(){return!this.y5&&!!this.TGb}get zab(){return this.c9||
this.isDeleted||this.iDd.value}get JZa(){return this.TYh.value}VYc(a){let b=!1;this.JZa.forEach((c,f)=>{b=f.zab&&(!a||7!==a.ga(c));return!b});return b}kTi(){const a=new Rd.a;var b=this.y5,c=this.TGb;if(this.c9){c=b.$z();for(var f=0;f<c.length;f++){var l=c[f];a.$(cd.a.vb(l),new Bx(l,null,b.tta(l)))}}else if(this.isDeleted)for(b=c.$z(),f=0;f<b.length;f++)l=b[f],a.$(cd.a.vb(l),new Bx(l,c.tta(l),null));else{f=c.$z();for(l=0;l<f.length;l++){var x=f[l];a.$(cd.a.vb(x),new Bx(x,c.tta(x),b.Sa(x)?b.tta(x):
null))}f=b.$z();for(l=0;l<f.length;l++)x=f[l],c.Sa(x)||a.$(cd.a.vb(x),new Bx(x,null,b.tta(x)))}return a}}Object(m.a)(Cx,"MergeableObjectDiff",null,[]);class Dx{constructor(a,b){this.t5=b?a.h7a():a;this.NEc=new Na.a}wel(a){this.NEc=a}OYg(a){(new Cx(this.t5,a)).JZa.forEach((b,c)=>{c.zab&&!this.NEc.contains(b)&&(this.NEc.add(b),c.isDeleted?(c=this.t5,c.Sa(cd.a.bta(b))&&c.removeProperty(cd.a.bta(b))):this.t5.XKa(cd.a.bta(b),c.newValue));return!0})}}Object(m.a)(Dx,"PartialMergeResult",null,[]);class wJ extends rf.a{constructor(){super();
this.Location=null}Zk(){return 34}static construct(a){const b=new wJ;b.Location=a;return b}}Object(m.a)(wJ,"PlayGraphMergeReplayRequest",rf.a,[]);class zv{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.Tpe=new BQ.a;this.nfk=a;this.wbk=b;this.qXa=c(this.N5b());this.b9j=f;this.c9j=l;this.z$c=x;this.s8c=H;this.Hyg=U;this.Z8j=Va;this.$8j=ja;this.a9j=ya}kL(){return(new Date).getTime()}Nkb(a,...b){return String.format.apply(null,[a].concat(b))}fvl(a){throw jb.a.invalidOperation(a);}n9i(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",
a.name,a.message,a.stack)}Ktj(a,b,c,f){f.$(a,new Dx(b,!1));ia.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.Ue);return!0}hFl(a,b){const c=new no.a;c.id=Dm.a.Vfa;c.XKa(kb.a.tmd,5===b?2:4);a.ltf(c);a.Wsd().Bya(c.id,4)}C7k(a){var b=!a.output.succeeded&&(this.$8j||a.output.crash),c=!!a.input.ULa&&0<a.input.ULa.length;if(c=this.a9j&&c&&(this.Z8j||b)){b=c?ka.a.create():ka.a.nil;c=c?String.format(" [Merge Request Id: {0}]",
b):"";zv.d3j(a,c);var f,l;({vhi:x,Zul:f,ZKl:l}=this.AGi(a,Object(F.a)(this,this.XKf,"createSerializedRevisionFrom")));c=zv.t$i(a);b=TC.construct(x._list,f._list,l._list,a.input.CWc,a.input.Oic,a.input.Ru,b,a.input.source,c);var x=a.output.PO;3===c&&0<x.length&&(b.MergedRevision=this.XKf(a.output.PO.last()));a=new DQ.a;a.JH=b;a.status=1;b=this.Tpe.$4b(0,null);b.HZ(a);b.gDa()}}XKf(a){const b=a.iW,c=Oc.App.Kb.Kd.xi;return new CQ.a(a,b,c.zi,null,c.eoc,c.contextId,b?b.id:ka.a.nil,this.z$c,!1,!0)}Icd(a,
b,c,f,l,x,H){c=this.LEi(a,b,f,l,x,H);f=0;const U=c.runtime.iqd;try{if(U){const ja=a.length?a.getItemAt(a.length-1):null,ya=b.length?b.getItemAt(b.length-1):null;ia.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",a.length,ja?ja.id:ka.a.nil,ja?ja.iW?ja.iW.id:ka.a.nil:
ka.a.nil,b.length,ya?ya.id:ka.a.nil,ya?ya.iW?ya.iW.id:ka.a.nil:ka.a.nil,l,x,this.s8c,this.Hyg,H)}for(a=!0;f<this.qXa.length&&a;f++)a=(0,this.qXa[f])(c);return new SC(c.output.PO)}catch(ja){const ya=!c.output.timeout;c.output.crash=ya;const Va=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",ya?"Crashed":"Timed Out",this.n9i(ja),!!c.output.PO);ya?ia.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Va):ia.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",
Va);if(c.output.PO)return new SC(c.output.PO);throw ja;}finally{c.output.succeeded?U&&ia.ULS.sendTraceTag(18613138,808,50,this.w5b(c,f,"Succeeded")):c.output.timeout?ia.ULS.sendTraceTag(18641178,808,15,this.w5b(c,f,"Timeout")):c.output.crash?c.output.PO?ia.ULS.sendTraceTag(18613142,808,15,this.w5b(c,f,"Crash - Rejection")):ia.ULS.sendTraceTag(18613144,808,15,this.w5b(c,f,"Crash - Failed")):U&&ia.ULS.sendTraceTag(18613140,808,50,this.w5b(c,f,"Rejection")),this.C7k(c)}}w5b(a,b,c){const f=a.output.PO,
l=f&&f.length?f.getItemAt(f.length-1):null;return this.Nkb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.kL()-a.input.r_e,b,f?f.length:0,l?l.id:ka.a.nil,l?l.iW?l.iW.id:ka.a.nil:ka.a.nil,a.input.source)}LEi(a,b,c,f,l,x){const H=new vJ,U=H.input;U.ULa=a;U.SPb=b;U.Ru=c;U.Oic=f;U.CWc=l;U.r_e=this.kL();U.source=x;a=H.runtime;a.XQc=this.Hyg;a.grc=!0;a.iqd=!0;let ja="";a.f1a=ya=>{if(this.s8c){var Va=this.kL()-U.r_e,hb=
Va>this.s8c;ja+=this.Nkb(" ({0}: {1})",ya,Va);hb&&(H.output.timeout=!0,ya=this.Nkb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.s8c,ya,Va,ja),this.fvl(ya))}};return H}N5b(){return[Object(F.a)(this,this.tAk,"otherAuthorsHaveChangesToMerge"),Object(F.a)(this,this.JOj,"isInputValid"),Object(F.a)(this,this.XEj,"initializeOutputMergeState"),Object(F.a)(this,this.qFj,"initializeRuntimeMergeState"),Object(F.a)(this,this.Gzl,"tryObjectMerge"),Object(F.a)(this,
this.r6h,"addMergeResultsToOutput")]}tAk(a){const b=a.input.ULa;a=a.output;return b?b.length?!0:(ia.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.PO=b,a.succeeded=!0,!1):(ia.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.PO=b,a.succeeded=!0,!1)}JOj(a){var b=a.input;const c=b.ULa,f=b.SPb,l=b.Ru,x=b.Oic;b=b.CWc;a=a.output;if(!f||!f.length)return a.PO=c,!1;let H=!0;if(2!==
x&&1!==x)return a.PO=c,!1;l&&l!==ka.a.nil||(H=!1);c.length<(b?2:1)&&(ia.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),H=!1);H||(a.PO=2===x?c:f);return H}qFj(a){var b=a.input,c=b.ULa,f=b.SPb;const l=b.Oic;let x,H;({Yul:x,YKl:H,yKc:b}=this.rbj(a,c,f,b.CWc));if(!b)return ia.ULS.sendTraceTag(18613185,808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
x.id,H.id),this.Pqg(x,c.length,"TheirChanges"),this.Pqg(H,f.length,"YourChanges"),a.output.PO=2===l?c:f,!1;a.runtime.yKc=b;({$Al:c,cWi:f}=this.ULi(l,x,H));({aBl:b,dWi:c,whi:f}=zv.adj(a,c,f,b));a.runtime.fzf=f;a.runtime.nFh=b;a.runtime.$Uf=c;a.runtime.cEe=new Rd.a;return!0}Pqg(a,b,c){const f=new Nj.a;for(;a;)f.add(a),a=a.iW;const l=new Sys.StringBuilder;l.append(this.Nkb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",c,b,f.length));let x=f.length,H=0;f.forEach(U=>({Ncg:x,hrg:H}=this.q7h(l,
U,f,x,H)).returnValue);ia.ULS.sendTraceTag(18613187,808,50,l.toString())}q7h(a,b,c,f,l){a.append(this.Nkb(" [{0} {1} {2}]",f,b.fla?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,Ncg:f,hrg:l}):{returnValue:!0,Ncg:f,hrg:l}}rbj(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.TRc(c);a.runtime.f1a("GetCommonBase");return{Yul:b,YKl:c,yKc:f}}ULi(a,b,c){2===a?(a=b,b=c):a=c;return{$Al:b,cWi:a}}XEj(a){const b=a.input,c=b.ULa,f=b.SPb;a.output.PO=
(2===b.Oic?c:f).Mfl();a.runtime.f1a("InitializeOutputMergeState");return!0}r6h(a){var b=a.input.Ru;const c=a.runtime.cEe,f=a.output.PO;b=this.MEi(a,f.getItemAt(f.length-1),b,ka.a.create());this.XWi(a,b,c);this.hFl(b,a.input.source);f.add(b);return a.output.succeeded=!0}MEi(a,b,c,f){a.runtime.iqd&&ia.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",c,f);a=this.nfk(f);a.Khi(b,c);return a}XWi(a,b,c){a.runtime.iqd&&ia.ULS.sendTraceTag(18613191,
808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{Dm.a.Vfa.equals(f)||b.ltf(l.t5);return!0})}Gzl(a){const b=a.runtime,c=b.fzf,f=b.nFh,l=b.$Uf,x=b.cEe;let H=!0;const U=a.runtime.grc;let ja=0,ya=0,Va=0;f.forEach((hb,yb)=>{U&&ia.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",hb,yb.Ue);ya++;50===ya&&(ja++,a.runtime.f1a(this.Nkb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",ja,Va)),ya=0);if(zv.inl(yb.Ue))return!0;var Zb=l.get(hb);
if(!Zb)return x.Hb(hb)?x.ga(hb).OYg(yb):x.$(hb,new Dx(yb,!1)),!0;if(!c.ga(hb))return H=this.Ktj(hb,Zb,yb,x);const fc=x.wTc(hb,new Dx(c.ga(hb),!0));({U$:Zb,returnValue:H}=this.c9j.merge(a,this.b9j,this.wbk,fc,Zb,yb));Va++;H&&(a.runtime.f1a(this.Nkb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",hb,yb.Ue,Va,ja)),Zb&&(x.Hb(Zb.t5.id)?x.ga(Zb.t5.id).OYg(Zb.t5):x.$(Zb.t5.id,Zb)));return H});U&&ia.ULS.sendTraceTag(18613199,808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",
f.count,Va);return H}AGi(a,b){const c=new Nj.a,f=new Nj.a,l=new Nj.a;var x=a.runtime.yKc;const H=x?x.id:ka.a.nil;this.Rne(x).forEach(U=>{c.add(b(U));return!0});x=a.input.ULa.getItemAt(a.input.ULa.length-1);this.Rne(x,H).forEach(U=>{f.add(b(U));return!0});a=a.input.SPb.getItemAt(a.input.SPb.length-1);this.Rne(a,H).forEach(U=>{l.add(b(U));return!0});return{vhi:c,Zul:f,ZKl:l}}Rne(a,b=null){const c=new Nj.a;b||(b=ka.a.nil);for(;a&&!b.equals(a.id);)c.add(a),a=a.iW;c.reverse();return c}wb(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static d3j(a,
b){ia.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static t$i(a){return a.output.crash?2:a.output.succeeded?3:1}static adj(a,b,c,f){let l;({result:l}=b.Kcd(f));a.runtime.f1a("GetUnfavoredChanges");let x;new Rd.a;({result:x}=c.Kcd(f));5===a.input.source&&(a.runtime.eWi=RC.a.C5f(c.Wsd()),a.runtime.bBl=RC.a.C5f(b.Wsd()));b=x;a.runtime.f1a("GetFavoredChanges");f=new rJ(Object(F.a)(f,f.Xwb,"getMergeableObject"));a.runtime.f1a("GetModifiedObjects");
return{aBl:l,dWi:b,whi:f}}static inl(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(m.a)(zv,"GraphMerger",null,[392,339]);class xJ{get YCa(){return 8}get gKa(){return[]}get AMa(){return[cd.a.vb(kb.a.HM),cd.a.vb(kb.a.Lsc)]}get rMa(){return[]}get yQa(){return[cd.a.vb($a.a.SA)]}get iRa(){return[]}mG(a){return 1074135126===a.Ue}o1a(){return!0}get XCa(){return[cd.a.vb(kb.a.cid),cd.a.vb(kb.a.sid)]}get y0a(){return!0}}Object(m.a)(xJ,"CommentContentNodeComplexMerge",
null,[364]);class yJ{get YCa(){return 8}get gKa(){return[]}get AMa(){return[cd.a.vb(kb.a.Btb),cd.a.vb(kb.a.bWd),cd.a.vb(kb.a.ztb),cd.a.vb(kb.a.v0b),cd.a.vb(kb.a.VLe),cd.a.vb(kb.a.ULe),cd.a.vb(kb.a.HM),cd.a.vb(kb.a.Lsc),cd.a.vb(kb.a.qVd)]}get rMa(){return[cd.a.vb(kb.a.Aca),cd.a.vb(kb.a.Zra),cd.a.vb(kb.a.SVd),cd.a.vb(kb.a.w0b),cd.a.vb(kb.a.pKc),cd.a.vb(kb.a.reactions)]}get yQa(){return[]}get iRa(){return[]}mG(a){return 1074135127===a.Ue}o1a(){return!0}get XCa(){return[cd.a.vb(kb.a.cid),cd.a.vb(kb.a.sid),
cd.a.vb(kb.a.commentId),cd.a.vb(kb.a.yxa),cd.a.vb(ab.a.TVd),cd.a.vb(kb.a.UVd),cd.a.vb(kb.a.w0b),cd.a.vb(kb.a.pKc),cd.a.vb(kb.a.reactions)]}get y0a(){return!0}}Object(m.a)(yJ,"CommentNodeComplexMerge",null,[364]);class zJ{constructor(a){this.kad=a}get YCa(){return 8}get gKa(){return[]}get AMa(){return this.kad.AMa}get rMa(){return[]}get yQa(){return[cd.a.vb($a.a.SA)]}get iRa(){return[]}mG(a){return 393326===a.Ue}o1a(){return!0}get XCa(){const a=new Ka.a;Pr.a(a,this.kad.gKa);Pr.a(a,this.kad.XCa);Pr.a(a,
this.kad.rMa);Pr.a(a,[cd.a.vb(kb.a.Jzb),cd.a.vb(kb.a.Pdd)]);return a.toArray()}get y0a(){return!0}}Object(m.a)(zJ,"NotesContentNodeComplexMerge",null,[364]);class AJ{get YCa(){return 8}get gKa(){return[cd.a.vb(kb.a.sOi),cd.a.vb(kb.a.mOi),cd.a.vb(kb.a.B8b),cd.a.vb(kb.a.ugl)]}get AMa(){return[cd.a.vb(kb.a.rrb),cd.a.vb(kb.a.srb),cd.a.vb(kb.a.Frb),cd.a.vb(kb.a.Grb),cd.a.vb(kb.a.dDa),cd.a.vb(kb.a.XEe),cd.a.vb(kb.a.xEe),cd.a.vb(kb.a.YEe),cd.a.vb(kb.a.rKb),cd.a.vb(kb.a.tKb),cd.a.vb(kb.a.pyb),cd.a.vb(kb.a.Aub),
cd.a.vb(kb.a.bIb)]}get rMa(){return[]}get yQa(){return[cd.a.vb($a.a.u7a),cd.a.vb(ab.a.appsNode)]}get iRa(){return[]}mG(a){return 393271===a.Ue}get XCa(){return[cd.a.vb(kb.a.presentationId),cd.a.vb(kb.a.slideWidth),cd.a.vb(kb.a.slideHeight),cd.a.vb(kb.a.zY),cd.a.vb(kb.a.qaa),cd.a.vb(kb.a.E$a),cd.a.vb(kb.a.YFb),cd.a.vb(kb.a.M0),cd.a.vb(kb.a.LGb),cd.a.vb(kb.a.qfa),cd.a.vb(kb.a.embeddedFonts),cd.a.vb(kb.a.PJa)]}get y0a(){return!0}o1a(){return!0}}Object(m.a)(AJ,"PresentationNodeComplexMerge",null,[364]);
class BJ{get YCa(){return 8}get gKa(){return[cd.a.vb(kb.a.fKa),cd.a.vb(kb.a.NKb)]}get AMa(){return[cd.a.vb($a.a.font),cd.a.vb(kb.a.zC),cd.a.vb(kb.a.eJc),cd.a.vb(kb.a.qhb),cd.a.vb(kb.a.HM),cd.a.vb(kb.a.K0a),cd.a.vb(kb.a.un),cd.a.vb(kb.a.uZa),cd.a.vb(kb.a.ryb),cd.a.vb(kb.a.Aka),cd.a.vb(kb.a.A0a),cd.a.vb(kb.a.l1),cd.a.vb(kb.a.qpa),cd.a.vb(kb.a.o2b),cd.a.vb(kb.a.Qvb),cd.a.vb(kb.a.dya),cd.a.vb(kb.a.Sya),cd.a.vb(kb.a.Roa),cd.a.vb(kb.a.Rya),cd.a.vb(kb.a.mediaType),cd.a.vb(kb.a.qhb),cd.a.vb(kb.a.uAb),cd.a.vb(kb.a.a8g),
cd.a.vb(kb.a.c8g),cd.a.vb(kb.a.Gya),cd.a.vb(kb.a.Loa),cd.a.vb(kb.a.Ksh),cd.a.vb(kb.a.Mpd),cd.a.vb($a.a.Jl),cd.a.vb($a.a.eJ),cd.a.vb(kb.a.lBh),cd.a.vb(kb.a.mBh),cd.a.vb(kb.a.ZNb),cd.a.vb(kb.a.PLa),cd.a.vb(kb.a.Paa),cd.a.vb(kb.a.Ysc),cd.a.vb(kb.a.WO),cd.a.vb(kb.a.outlineWidth),cd.a.vb(Oh.a.Ymd),cd.a.vb(kb.a.Qid),cd.a.vb(Wl.a.o9b),cd.a.vb(kb.a.tN),cd.a.vb(kb.a.aQ),cd.a.vb(kb.a.Lsc),cd.a.vb(kb.a.gNb),cd.a.vb(kb.a.C0a),cd.a.vb(kb.a.gtb),cd.a.vb(kb.a.BAb),cd.a.vb(kb.a.oN),cd.a.vb(kb.a.cxh),cd.a.vb(kb.a.syb)]}get rMa(){return[cd.a.vb(kb.a.alt),
cd.a.vb(kb.a.wrb),cd.a.vb(kb.a.X$),cd.a.vb(kb.a.Wje),cd.a.vb(kb.a.Fme),cd.a.vb(kb.a.Gka),cd.a.vb(kb.a.shapeType),cd.a.vb(kb.a.$Nb),cd.a.vb(kb.a.rotation),cd.a.vb(kb.a.jpc),cd.a.vb(kb.a.Sca),cd.a.vb(kb.a.Rca),cd.a.vb($a.a.rx),cd.a.vb($a.a.HC),cd.a.vb($a.a.wy),cd.a.vb($a.a.yy),cd.a.vb(kb.a.RPb),cd.a.vb(kb.a.Zxb),cd.a.vb(kb.a.v6e),cd.a.vb(kb.a.w6e),cd.a.vb(kb.a.R2),cd.a.vb(kb.a.kP),cd.a.vb(kb.a.Oia),cd.a.vb(kb.a.Nia),cd.a.vb(kb.a.Qia),cd.a.vb(kb.a.Pia),cd.a.vb(kb.a.CZe),cd.a.vb(kb.a.Jpd),cd.a.vb(kb.a.Wfa),
cd.a.vb(kb.a.Lpd),cd.a.vb(kb.a.Nua),cd.a.vb(kb.a.TGc)]}get yQa(){return[cd.a.vb($a.a.SA)]}get iRa(){return[]}mG(a){return 1074135132===a.Ue}o1a(){return!0}get XCa(){return[cd.a.vb(kb.a.cid),cd.a.vb(kb.a.sid),cd.a.vb(kb.a.shapeId),cd.a.vb(kb.a.QUa),cd.a.vb(kb.a.nZa),cd.a.vb(kb.a.VIa),cd.a.vb(kb.a.uLj),cd.a.vb(kb.a.CL),cd.a.vb(kb.a.isResizable),cd.a.vb(kb.a.isEditable),cd.a.vb(kb.a.Fua),cd.a.vb(kb.a.SI),cd.a.vb(kb.a.Hj),cd.a.vb(kb.a.OU),cd.a.vb(kb.a.BRa),cd.a.vb(kb.a.CRa),cd.a.vb(kb.a.C$a),cd.a.vb(kb.a.T$b),
cd.a.vb(kb.a.hasText),cd.a.vb(kb.a.tT),cd.a.vb(kb.a.hr),cd.a.vb(kb.a.isConnected),cd.a.vb(kb.a.Jf),cd.a.vb(kb.a.qFa),cd.a.vb(kb.a.Dq),cd.a.vb(kb.a.az),cd.a.vb(kb.a.Mp),cd.a.vb(kb.a.Sda),cd.a.vb(kb.a.fl),cd.a.vb(kb.a.zT),cd.a.vb(kb.a.Fj),cd.a.vb(kb.a.Rf),cd.a.vb(kb.a.L_),cd.a.vb(kb.a.aq),cd.a.vb(kb.a.px),cd.a.vb(kb.a.Jra),cd.a.vb(kb.a.dHc),cd.a.vb(kb.a.htb),cd.a.vb($a.a.YN),cd.a.vb(ab.a.Q_),cd.a.vb(kb.a.B8b),cd.a.vb(kb.a.DQf),cd.a.vb(kb.a.L0d),cd.a.vb(kb.a.M_k),cd.a.vb(kb.a.Ald),cd.a.vb(kb.a.ih),cd.a.vb(kb.a.Kdd),
cd.a.vb(kb.a.Pbe),cd.a.vb(kb.a.Ebe),cd.a.vb(kb.a.RK),cd.a.vb(kb.a.gua),cd.a.vb(kb.a.MZb),cd.a.vb(kb.a.MQ),cd.a.vb(kb.a.XOb),cd.a.vb(kb.a.embeddedFonts),cd.a.vb(kb.a.gFa),cd.a.vb(kb.a.Xsc),cd.a.vb(kb.a.XJh),cd.a.vb(kb.a.Fch),cd.a.vb(kb.a.B1c),cd.a.vb(kb.a.Kpd),cd.a.vb(kb.a.pfa),cd.a.vb(kb.a.koa),cd.a.vb(kb.a.U3),cd.a.vb(kb.a.GGb),cd.a.vb(kb.a.HGb),cd.a.vb(kb.a.IGb),cd.a.vb(kb.a.ona),cd.a.vb(kb.a.X3)]}get y0a(){return!0}}Object(m.a)(BJ,"ShapeNodeComplexMerge",null,[364]);class Ex{constructor(a,b){this.agk=
a;this.Ngk=b}get YCa(){return this.Ngk}get gKa(){return[]}get AMa(){return[]}get rMa(){return[]}get yQa(){return[]}get iRa(){return[]}mG(a){return this.agk(a)}o1a(){return!1}get XCa(){return[]}get y0a(){return!1}}Object(m.a)(Ex,"SimpleStrategyComplexMerge",null,[364]);class CJ{get YCa(){return 8}get gKa(){return[]}get AMa(){return[cd.a.vb(kb.a.backgroundColor),cd.a.vb(kb.a.Csa),cd.a.vb(kb.a.J1e),cd.a.vb(kb.a.eba),cd.a.vb(kb.a.Pna),cd.a.vb(kb.a.raa),cd.a.vb(kb.a.Bz),cd.a.vb(kb.a.Ara),cd.a.vb(kb.a.tN),
cd.a.vb(kb.a.aQ),cd.a.vb(kb.a.HM),cd.a.vb(kb.a.Uya)]}get rMa(){return[cd.a.vb(kb.a.j1a),cd.a.vb(kb.a.hj),cd.a.vb(kb.a.Cn),cd.a.vb(kb.a.ke),cd.a.vb(kb.a.dW),cd.a.vb(kb.a.VQc),cd.a.vb(kb.a.tQd)]}get yQa(){return[cd.a.vb($a.a.SA),cd.a.vb(kb.a.notesContentNode),cd.a.vb(ab.a.commentContentNode)]}get iRa(){return[]}mG(a){return 393227===a.Ue}o1a(){return!0}get XCa(){return[cd.a.vb(kb.a.cid),cd.a.vb(kb.a.sid),cd.a.vb(kb.a.HS),cd.a.vb(kb.a.Fwh),cd.a.vb($a.a.en),cd.a.vb(kb.a.kVa),cd.a.vb(kb.a.zda),cd.a.vb(kb.a.EEa),
cd.a.vb(kb.a.O$a),cd.a.vb(kb.a.title),cd.a.vb(kb.a.zY),cd.a.vb(kb.a.qaa),cd.a.vb(kb.a.B8b),cd.a.vb(kb.a.N$a),cd.a.vb(kb.a.F$a),cd.a.vb(kb.a.ih),cd.a.vb(kb.a.koa)]}get y0a(){return!0}}Object(m.a)(CJ,"SlideNodeComplexMerge",null,[364]);class DJ{constructor(a,b){this.Twg=a;this.c7j=b}ga(a){return this.Twg.wTc(a,this.c7j)}get S1d(){return this.Twg}}Object(m.a)(DJ,"PropertyMergeStrategies",null,[]);const UC=(a,b,c,f,l)=>{if(b){f=f||new Bz;if(!a){a=b=b.h7a();const x=a.$z();for(let H=0;H<x.length;H++){const U=
x[H];if(ba.a.mYf(U)===ba.a.string){const ja=f.t5f(a,U);f.Yqh(a,U,ja?"Redacted: "+ja.length:"null")}}}ia.ULS.sendTraceTag(18613206,l,50,c,b.Vsd())}else ia.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class EJ{constructor(a,b,c){this.Otg=new Na.a;this.v8c=a;this.Pva=b;this.qXa=c(this.N5b());this.vbk=new mc.a(Object(F.a)(this,this.S1d,"evalPropertyMergeStrategies"))}f2j(a){if(!a.wJh){a.wJh=!0;var b=a.Lcd.runtime.XQc,c=a.Slk;UC(b,a.A6a.value.TGb,"Base",c,808);UC(b,a.A6a.value.y5,"Favored",
c,808);UC(b,a.GZb.value.y5,"Conflict",c,808)}}Bzl(a,b,c,f){this.hea(a,c);const l=a.U$;if(2===f||7===f||a.Qic.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:x}=a.A6a.value.JZa.Uf(c)).returnValue&&x.zab)return 4!==f;f=0}if(0===f){if(!b.isDeleted)return l.XKa(cd.a.bta(c),b.newValue),!0;f=6}if(8===f){let H=a.EKc.value;b=!0;if(({value:x}=H.JZa.Uf(c)).returnValue&&H.zab){var x=this.v8c.Eij(a.Lcd.input.source,x);void 0!==x&&null!==x?l.XKa(cd.a.bta(c),x):(b=!1,f=6)}if(b)return!0}return 9===
f&&(b=!0,({value:x}=a.EKc.value.JZa.Uf(c)).returnValue&&(x=this.v8c.x8f(a.Lcd.input.source,x),void 0!==x&&null!==x?l.XKa(cd.a.bta(c),x):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty(cd.a.bta(c)),!0):1===f?this.Pva.o1a(a,c):!1}yYa(a){return a}N5b(){return[Object(F.a)(this,this.Kzl,"tryPreProcessFavoredRevision"),Object(F.a)(this,this.iui,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.Azl,"tryMergeNodeInternal")]}get Uid(){return this.vbk.value}zzl(a){const b=a.A6a.value;ia.ULS.sendTraceTag(18659235,
808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.y5.id,b.y5.Ue);for(let c=0;c<this.qXa.length;c++)if(!(0,this.qXa[c])(a))return ia.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",b.y5.id,b.y5.Ue,c),this.f2j(a),a.U$=null,!1;ia.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.y5.id,b.y5.Ue);return!0}Kzl(a){const b=a.A6a.value;if(!b.zab)return!0;
const c=this.Uid;let f=!0;b.JZa.forEach((l,x)=>{if(!x.zab||a.Qic.contains(l))return!0;x=c.ga(l);if(5===x)return ia.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",b.TGb.Ue,l,x),f=!1;6===x&&a.eNe.add(l);return!0});return f}iui(a){a.U$=a.A6a.value.y5.h7a();const b=a.eNe,c=a.U$;b&&b.forEach(f=>{c.removeProperty(cd.a.bta(f));return!0});return!0}Azl(a){const b=a.GZb.value,c=
b.TGb.Ue,f=this.Uid;let l=!0;b.JZa.forEach((x,H)=>{if(this.Pva.y0a&&!this.Uid.S1d.Hb(x)){var U=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",x,c);ia.ULS.sendTraceTag(18970259,808,50,U)}U=f.ga(x);l=this.Bzl(a,H,x,U);l||(a.U$=null,ia.ULS.sendTraceTag(18659271,808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,x,U));return l});return l}baj(){return[cd.a.vb($a.a.QRf),cd.a.vb($a.a.lastModifiedTime),cd.a.vb($a.a.GE),cd.a.vb($a.a.ajb),
cd.a.vb($a.a.Flh),cd.a.vb(dh.a.xjc),cd.a.vb(ab.a.Xwi),cd.a.vb(ab.a.CQf),cd.a.vb(Ms.a.Gw)]}S1d(){var a=this.baj(),b=this.Pva.gKa,c=this.Pva.AMa,f=this.Pva.rMa,l=this.Pva.iRa,x=this.Pva.yQa;const H=this.Pva.XCa,U=new Rd.a(0);for(let ja=0;ja<a.length;ja++)U.$(a[ja],this.yYa(7));for(a=0;a<b.length;a++)U.$(b[a],this.yYa(8));for(b=0;b<c.length;b++)U.$(c[b],this.yYa(7));for(c=0;c<f.length;c++)U.$(f[c],this.yYa(9));for(f=0;f<l.length;f++)U.$(l[f],this.yYa(1));for(l=0;l<x.length;l++)U.$(x[l],this.yYa(9)),
this.Otg.add(x[l]);for(x=0;x<H.length;x++)U.$(H[x],this.yYa(this.Pva.YCa));return new DJ(U,this.yYa(this.Pva.YCa))}hea(a,b){this.Otg.contains(b)&&(a=a.U$,ia.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Ue,b))}}Object(m.a)(EJ,"GraphNodeComplexMerge",null,[416]);class FJ{constructor(a,b){this.Bl=a;this.P5c=b;this.C6j=this.NDi()}NDi(){const a=[];this.Bl.forEach(b=>{a.push(new EJ(this.P5c,b,c=>c))});return a}MDi(a){for(let b=0;b<this.Bl.length;b++)if(this.Bl[b].mG(a))return this.C6j[b];
return null}}Object(m.a)(FJ,"GraphNodeComplexMergeFactory",null,[337]);class GJ{Eij(a,b){this.XIh(a);return 5===a?b.newValue:b.oldValue}x8f(a,b){this.XIh(a);return 5===a?b.oldValue:b.newValue}XIh(a){1!==a&&5!==a&&ia.ULS.sendTraceTag(18613264,808,15,"Unexpected merge source: {0}",a)}}Object(m.a)(GJ,"GraphNodeComplexMergeHelper",null,[366]);class HJ{constructor(a,b,c,f,l,x){this.eNe=this.Qic=null;this.bac=this.wJh=!1;this.U$=null;this.grc=a.runtime.grc;this.Lcd=a;this.Slk=b;this.A6a=c;this.GZb=f;this.EKc=
l;this.C9f=x}}Object(m.a)(HJ,"GraphNodeComplexMergeState",null,[]);class IJ{constructor(a){this.qXa=a(this.N5b())}N5b(){return[Object(F.a)(this,this.bnl,"simpleMerge"),Object(F.a)(this,this.nwi,"complexMerge")]}Hfl(a,b,c,f,l,x){a=new HJ(a,c,new mc.a(()=>new Cx(f.t5,l)),new mc.a(()=>new Cx(f.t5,x)),new mc.a(()=>new Cx(x,l)),b.MDi(l));a.Qic=f.NEc;a.eNe=new Nj.a;return a}merge(a,b,c,f,l,x){a=this.Hfl(a,b,c,f,l,x);b=!0;for(c=0;c<this.qXa.length&&b;c++)b=(0,this.qXa[c])(a);(b=a.bac&&a.U$?new Dx(a.U$,!1):
null)&&b.wel(a.Qic);return{returnValue:a.bac,U$:b}}bnl(a){var b=a.C9f.Uid;return a.GZb.value.VYc(b)&&a.EKc.value.VYc(b)?a.A6a.value.VYc(b)?!0:(b=a.GZb.value.y5,a.bac=!0,a.U$=b.h7a(),!1):(a.bac=!0,!1)}nwi(a){const b=a.GZb.value.y5;a.grc&&ia.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Ue);const c=a.C9f.zzl(a);a.bac=c;ia.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":
"Failed",b.id,b.Ue,!!a.U$);return c}}Object(m.a)(IJ,"GraphNodeMerge",null,[338]);class ju{constructor(a){this.v8c=a}VNi(a){const b=a.EKc.value,c=a.U$;a=a.Lcd.input.source;for(const l of ju.Vmd)if(({value:f}=b.JZa.Uf(l)).returnValue){var f=this.v8c.x8f(a,f);void 0!==f&&null!==f?c.XKa(cd.a.bta(l),f):c.removeProperty(cd.a.bta(l))}}get gKa(){return[cd.a.vb(kb.a.zT),cd.a.vb(kb.a.eje),cd.a.vb(kb.a.fje),cd.a.vb(kb.a.Gie)]}get AMa(){return[]}get rMa(){return[]}get yQa(){return[]}get iRa(){return ju.Vmd}get XCa(){return[]}get y0a(){return!1}get YCa(){return 9}mG(a){return 393230===
a.Ue}o1a(a,b){return 0<=Array.indexOf(ju.Vmd,b)?(this.VNi(a),ju.Vmd.forEach(c=>{a.Qic.add(c)}),!0):!1}}ju.Vmd=[cd.a.vb($a.a.pq),cd.a.vb($a.a.flb),cd.a.vb($a.a.$sc),cd.a.vb($a.a.wLa),cd.a.vb($a.a.Zwa),cd.a.vb(ab.a.IZa)];Object(m.a)(ju,"ParagraphNodeComplexMerge",null,[364]);class VC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Zb(a){this.K=a;a.register(GJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();
const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(337,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().oa(()=>{const c=new BJ;return new FJ([new AJ,new CJ,c,new ju(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new xJ,new yJ,new zJ(c),new Ex(f=>Array.contains(b,f.Ue),9),new Ex(f=>131140===f.Ue,6),new Ex(f=>131164===f.Ue,8),new Ex(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(Bz,
"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(338,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().oa(()=>new IJ(c=>c));a.register(339,"Box4.IBrowserGraphMerger").ma().oa(()=>new zv(c=>new RC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new t.a(c,
f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").gVc,a.resolve("PowerPointWebEditor.IApplicationSettings").Tig,a.resolve("PowerPointWebEditor.IApplicationSettings").NNj,a.resolve("PowerPointWebEditor.IApplicationSettings").LNj,a.resolve("PowerPointWebEditor.IApplicationSettings").MNj))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");Oc.App.SLa.hii(a)}dispose(){}static main(){z.a.instance.Dc(new VC)}}Object(m.a)(VC,"PPTWebEditorGraphMergePackage",null,[2,3]);class JJ{constructor(a,
b){this.Bl=a;this.qR=b}B1i(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.Bl)if(f.wJj(a)){c=f;const l=this.qR.Ci("UserAction",f.name);b=f.y1i(a);l.stop();break}b||xa.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}A1i(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.B1i(c))&&b.appendChild(a);return b}}Object(m.a)(JJ,"HtmlExportProcessor",null,[334]);class WC{constructor(){this.iDc=
null}get rootNode(){return this.iDc}clone(){return Object.assign(new WC,{iDc:this.rootNode})}}Object(m.a)(WC,"HtmlExportContext",null,[]);class KJ{z1i(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new WC,{iDc:f}));return c}}Object(m.a)(KJ,"HtmlExportUtils",null,[336]);class LJ{constructor(a){this.Yre=null;this.Iq=a}get kPi(){return this.Yre=this.Yre||document.createElement("div")}C1i(a,b){if(!a||!a.rootNode||!b)return null;b.hCa(this.kPi);const c=this.Iq.me(3);try{c.kd(a.rootNode),
c.gLa(b.Ma),b.Zx(a.rootNode),b.Kza()}finally{c&&c.dispose()}a=b.PTf;b.detach();return a}}Object(m.a)(LJ,"HtmlGenerator",null,[335]);class XC{constructor(a,b,c){this.u9j=a;this.v9j=b;this.Qb=c}get name(){return"PPTTableHtmlExportHandler"}wJj(a){return 14===a.rootNode.type?!0:10===a.rootNode.type?(a=Object(oa.a)(4,a.rootNode),!!a&&a.ud):!1}y1i(a){return this.v9j.C1i(this.Dlj(a),this.u9j)}Dlj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Qb.Nc(a.rootNode);a.Bb(1);b.iDc=a.Bb(2);return b}return a}}
Object(m.a)(XC,"PPTTableHtmlExportHandler",null,[358]);class YC extends vf.a{constructor(a,b){super(new xf.a,a,b)}get PTf(){return this.BBh}}Object(m.a)(YC,"AHtmlExportView",vf.a,[407,408,162,106]);class ZC{}ZC.jUi="ExportedPPTTable";Object(m.a)(ZC,"HtmlExportConstants",null,[]);class $C extends YC{constructor(a,b){super(a,b)}get PTf(){const a=this.BBh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],ZC.jUi),a[0]):null}get Wl(){return!0}get KF(){return 480}}Object(m.a)($C,
"PPTTableHtmlExportView",YC,[]);class aD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Zb(a){this.K=a;this.K.register(334,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().oa(()=>new JJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(335,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().oa(()=>new LJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));
this.K.register(336,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().oa(()=>new KJ);this.Zxi()}init(){}dispose(){}Zxi(){this.K.register($C,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().oa(()=>new $C(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));this.K.register(XC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().oa(()=>new XC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){z.a.instance.Dc(new aD)}}Object(m.a)(aD,"HtmlExportPackage",null,[2,3]);class Cz extends Zh.a{constructor(a,b){super();this.lxc=0;this.LEd=null;this.so="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.Dgf=a;this.Cgf=b;this.hg="LanguageDialog"}trc(){this.rg=this.U4d();this.lxc=({Ich:a}=this.Dgf.d6f()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.Zi(Box4Intl.Box4Strings.l_Language,Object(F.a)(this,this.cbl,"setLanguageHandler"),a);this.LEd=document.getElementById("LanguageList");this.Cgf.YKe(this.LEd,this.lxc)}U4d(){return Zh.a.sC(this.so,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}cbl(a,
b){if(P.a.instance.ga(70)){var c=Nc.a.instance.Vp(D.a.bbl);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.LEd.value),this.Dgf.srh(b,a),c.properties.$("PreviousLCID",this.lxc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.Cgf.abl(b,this.lxc)),Oc.App.Kb.updateCommandUI(!0));c.end()}}}Object(m.a)(Cz,"LanguageDialog",Zh.a,[395]);class MJ{constructor(){this.KXj=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(F.a)(this,this.TXj,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){xa.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}Z4k(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}TXj(a,b){b=b.toLowerCase();for(const c of this.KXj)if(b===c)return;xa.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(m.a)(MJ,"JSanityHelper",null,[332]);class bD extends Cz{constructor(a,
b,c){super(a,c);this.h8j=b}U4d(){return this.h8j.qUa?Zh.a.sC(this.so,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.U4d()}}Object(m.a)(bD,"PPTLanguageDialog",Cz,[]);class NJ{constructor(a,b,c,f){this.Nfk=a;this.b7j=b;this.Dak=c;this.bG=f}getInstance(a){return new bD((a?this.Nfk:this.b7j)(),this.bG,this.Dak)}}Object(m.a)(NJ,"PPTLanguageDialogFactory",null,[330]);var Pk=d(116);class OJ{constructor(){this.n0e="rect,circle,ellipse,line,polyline,polygon,path";
this.Qrd=[];this.sga=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.JKe=96}sAl(a,b=null){try{const c=this.J9d(a);if(!c)return null;const f=b?Ib.a.vI(b.sD):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const x=c[b];x.setAttribute(Pk.a.j3d,f);x.setAttribute(Pk.a.tVf,l)}return a}catch(c){return xa.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}JEh(a,b=null){try{const c=this.J9d(a);if(!c)return null;const f=b?Ib.a.vI(b.sD):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const x=c[b];x.setAttribute(Pk.a.zrd,f);x.setAttribute(Pk.a.Kyh,l)}return a}catch(c){return xa.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}tAl(a,b){try{const f=this.J9d(a);if(!f)return null;var c=this.Khj(b);let l="";for(const x of c)l+=
x+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const x=f[c];x.setAttribute(Pk.a.Jyh,l);x.setAttribute(Pk.a.C_e,"miter");x.setAttribute(Pk.a.lrl,"4");switch(b){case 8:x.setAttribute(Pk.a.B_e,"round");break;case 2:case 0:x.setAttribute(Pk.a.B_e,"butt");break;default:x.setAttribute(Pk.a.B_e,"round")}}return a}catch(f){return xa.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}KEh(a,b,c,f){try{if(!a)return null;
this.Grh(c,b*this.JKe*f/ye.a.sDa,a);return a}catch(l){return xa.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}Mhj(){if(!this.Qrd||1>this.Qrd.length)this.Qrd=this.n0e.split(",");return this.Qrd}J9d(a){if(!a)return null;a=a.querySelectorAll(this.n0e);return 1>a.length?null:a}Grh(a,b,c){if(c){var f=c.getAttribute(Pk.a.DOb)?c.getAttribute(Pk.a.DOb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.Mhj())if(l===a){c.setAttribute(Pk.a.D_e,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.Grh(f,b,c.children[l])}}Khj(a){switch(a){case 0:return this.sga[0];case 1:return this.sga[1];case 2:return this.sga[2];case 3:return this.sga[3];case 4:return this.sga[4];
case 5:return this.sga[5];case 6:return this.sga[6];case 7:return this.sga[7];case 8:return this.sga[8];case 9:return this.sga[9];case 10:return this.sga[10];default:return xa.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.sga[0]}}}Object(m.a)(OJ,"SVGIconLocalEditor",null,[333]);class PJ{constructor(a,b){this.USg=b;this.Rd=a}OF(a,b){if(!a)return!1;const c=a.G3(f=>!f.fl).length;return!this.Zgl(a.r2b,c+b)}nG(a){const b=a.le+1;this.Rd.cH(222,c=>{c.jC=1;c.ZRa=[b.toString(),
this.USg.toString()];return!1})}Zgl(a,b){if(!a&&b<this.USg)return!1;xa.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(m.a)(PJ,"ShapeCountValidator",null,[331]);class cD{constructor(a,b,c,f,l,x){this.Kak=a;this.Ea=b;this.mVg=c;this.Jb=f;this.uJ=l;this.Fa=x}get Lb(){return this.Kak.value}d6f(){let a,b=0;a=!0;const c=this.Lb.Wd();1===c.length&&c[0].D_c&&(b=this.Fa.VSa(c[0]),a=!this.Fa.F8d(c[0]));return{returnValue:b,Ich:a}}srh(a,b){const c=this.Lb.Wd();if(1===c.length&&c[0].D_c&&
this.mVg){var f=new J.DictionaryPropertySet;f.setValue($a.a.it,a);f.setValue(Mc.a.Ywa,b);a=this.Jb.Ad(15);try{a.nc(c[0]);c[0].$sa();const l=Object(oa.a)(4,c[0]);l&&this.uJ&&this.uJ.WEl(l,b);this.mVg.WU(f);this.Ea.Ed()}finally{a&&a.dispose()}}}}Object(m.a)(cD,"ShapeLanguageEditor",null,[357]);class dD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Zb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(Cz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").oa(()=>
new bD(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(330,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().oa(()=>new NJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(cD,"PowerPointWebEditor.ShapeLanguageEditor").ma().oa(()=>
new cD(this.K.ie("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.ub("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(331,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().oa(()=>new PJ(Db.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.od.powerPointEditServerEditableShapeCountThreshold));
this.K.register(332,"PowerPointWebEditor.IJSanityHelper").ma().oa(()=>new MJ);this.K.register(333,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().oa(()=>new OJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){z.a.instance.Dc(new dD)}}Object(m.a)(dD,"PPTWebEditorShapeEditPackage",null,[2,3]);var eD=d(284);class Rs{static get l_(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():ia.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ia.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get K9b(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get i9(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(m.a)(Rs,
"FullscreenUtils",null,[]);class QJ{get l_(){return Rs.l_}requestFullscreen(a){Rs.requestFullscreen(a)}exitFullscreen(){Rs.exitFullscreen()}get K9b(){return Rs.K9b}get i9(){return Rs.i9}get UCf(){return this.K9b&&!B.a.mx}}Object(m.a)(QJ,"FullscreenUtilsProxy",null,[322]);class RJ{Aaj(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(m.a)(RJ,"InkButtonHelper",null,[327]);class SJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(m.a)(SJ,"FlyoutMenuExtraProps",null,[]);class Fx{}Fx.rmi="_136_16_N_20";Fx.smi="none";Object(m.a)(Fx,"InkButtonConstants",null,[]);class Dz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(m.a)(Dz,"InkButtonProps",null,[]);class fD{constructor(){this.onInkMenuActivity=null}}Object(m.a)(fD,"IInkButtonSettings",null,
[]);class TJ extends fD{constructor(){super()}}Object(m.a)(TJ,"InkButtonSettings",fD,[]);class UJ{constructor(){this.color=this.item=null}}Object(m.a)(UJ,"InkManagerActivity",null,[]);class Ez{constructor(){this.uxe=!1;this.vBe=this.VBe=0;this.Ore=""}get f4(){return this.uxe}set f4(a){this.uxe=a}get startingSlideIndex(){return this.VBe}set startingSlideIndex(a){this.VBe=a}get Qya(){return this.vBe}set Qya(a){this.vBe=a}get NOf(){return this.Ore}set NOf(a){this.Ore=a}get IVk(){const a={};a.IsStartRehearsal=
this.uxe;a.StartingSlideIndex=this.VBe;a.SlideCount=this.vBe;a.DisabledRehearsalRealtimeFeaturesStr=this.Ore;return JSON.stringify(a)}}Object(m.a)(Ez,"RehearsalContext",null,[325]);class Fz extends Zh.a{constructor(a,b,c){super(!1,!0);this.mze=50001;this.kb=a;this.qe=b;this.To=new Ez;this.Xa=c;this.kb.Aia(Object(F.a)(this,this.yfa,"onSlideshowExitHandler"));this.kb.MYb(Object(F.a)(this,this.ufa,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.iHa=!1}dispose(){super.dispose();this.iHa||
this.kb.restoreFocus()}pu(){super.pu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.mze);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}AA(){super.AA();var a=document.getElementById(this.Nh("WACDialogPanel"));a.style.minWidth=lf.a.Pc(300);a.style.width=lf.a.Pc(300);a=document.getElementById(this.Nh("WACDialogButtonPanel"));var b=document.getElementById(this.Nh("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.Nh("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.Nh("WACDialogPanel"))){b=lf.a.Ie();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=lf.a.Eca();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){xa.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.qe.qk("SubtitleProactive_clearly.png");const b=this.qe.qk("SubtitleProactive_network.png"),c=this.qe.qk("SubtitleProactive_noNoise.png");this.rg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.Zi("",Object(F.a)(this,this.tfa,"onClickHandler"),a);this.kb.setVisibility(!0)}X7(){super.X7()}tsa(){super.tsa()}Bib(){}ufa(){this.kb.Cib(Object(F.a)(this,this.ufa,"onGetCurrentPositionHandler"));this.open()}yfa(){this.iHa=!0;this.kb.Rfa(Object(F.a)(this,
this.yfa,"onSlideshowExitHandler"));this.kb.Cib(Object(F.a)(this,this.ufa,"onGetCurrentPositionHandler"));this.hide()}tfa(a){0===a&&(a=Date.now(),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,3,a,this.To))}static Tog(a,b,c){new Fz(a,b,c)}}Object(m.a)(Fz,"SlideshowSubtitleProactiveDialog",Zh.a,[]);var Jh=d(675);class VJ{constructor(){this.buttonIdDictionary=null}}Object(m.a)(VJ,"SlideshowToolbarSettings",null,[]);class Gx extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(m.a)(Gx,"ReadOutEventArgs",Sys.EventArgs,[]);class gD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.GCb=this.To=this.Hc=this.nea=this.pe=this.p5c=this.LBe=this.ej=null;this.qU=this.UXa=this.WXa=this.uCb=this.DWa=this.yve=0;this.YL=!1;this.Zue=!0;this.E6c=this.gR=this.CCe=this.kqe=!1;this.kb=c;this.mf=H;this.gu=U;this.Xa=ya;this.ia=a;this.Ha=b;this.gDe=l;this.Ub=x;this.R9j=Db.a.instance.Ja("PowerPointWebEditor.IInkButtonHelper");this.qe=f;this.du=Va}init(a,b){xa.a.J(512495955,830,
50,"ReactSlideshowToolbar.Init");this.Zue=!0;this.kqe=!1;var c={};c[Jh.a.MicButton]=this.Ha.isMicButtonInSlideShowToolbarEnabled;c[Jh.a.PrevButton]=!0;c[Jh.a.NextButton]=!0;c[Jh.a.GridButton]=!0;c[Jh.a.InkButton]=!0;c[Jh.a.SubtitlesButton]=!0;c[Jh.a.LiveButton]=!0;c[Jh.a.MoreButton]=!0;c[Jh.a.ExitButton]=!0;c[Jh.a.CoachButton]=this.Ha.isCoachButtonInSlideShowToolbarEnabled;this.LBe=new VJ;this.LBe.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.pe=document.createElement("div");
this.pe.id="slideshow-toolbar";this.pe.className="ReactSlideshowToolbar";this.Ha.pptEditorVoiceUXEnabled&&(this.p5c=document.getElementById("slideshowfooterContainerElement"),this.pe.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");c.id="slideshow-toolbar-accessibility";c.style.position="absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Ha.pptEditorVoiceUXEnabled?
this.p5c.appendChild(this.pe):this.mf.appendChild(this.pe);this.ej=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.LBe,this.pe);if(!this.ej){xa.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const f=df.a.Uh(359);u.AFrameworkApplication.vp(f);kf.Health.instance.recordQosError(df.a.lja(f),["SlideShowACE"],!1,!0,!0,!1,null)}this.ej.renderToolbar();this.pe.appendChild(c);this.pe.tabIndex=0}this.nea||(this.nea=document.createElement("div"),this.nea.id=
"SlideshowToolbarCalloutMenuContainer",this.nea.className="SlideshowToolbarCalloutMenuContainer",this.gu()&&(this.nea.style.direction=mf.a.P0a),this.mf.appendChild(this.nea));this.Hc=a;this.To=b;this.ej.registerButtonCallback(Jh.a.MicButton,()=>{this.dvk()});this.ej.registerButtonCallback(Jh.a.CoachButton,()=>{this.Irk()});this.Hc.Kh||this.Ub&&this.Ub.instance&&this.Ub.instance.dr?(this.gR=!0,this.ej.setToolbarButtonToggleState(Jh.a.MicButton,this.gR),this.ej.showToolbarButton(Jh.a.MicButton)):(this.gR=
!1,this.ej.setToolbarButtonToggleState(Jh.a.MicButton,this.gR),this.ej.hideToolbarButton(Jh.a.MicButton));this.ej.registerButtonCallback(Jh.a.PrevButton,f=>{this.mHb(f)});this.ej.registerButtonCallback(Jh.a.NextButton,f=>{this.hHb(f)});this.ej.registerButtonCallback(Jh.a.GridButton,f=>{this.eHb(f)});this.ej.showToolbarButton(Jh.a.GridButton);this.Hc.tvb&&!this.To.f4&&(this.ej.registerButtonCallback(Jh.a.SubtitlesButton,f=>{this.vgd(f)}),this.ej.setToolbarButtonToggleState(Jh.a.SubtitlesButton,this.Hc.Kh),
this.ej.showToolbarButton(Jh.a.SubtitlesButton));this.ej.registerButtonCallback(Jh.a.ExitButton,f=>{this.dHb(f)});this.Ha.isInkingInSlideShowEnabled&&this.Ha.isInkUIInSlideShowEnabled&&(a=Dz.create(),a.icon=Fx.rmi,a.selectedColor=Fx.smi,this.ej.updateElementProps(Jh.a.InkButton,a),this.ej.registerButtonCallback(Jh.a.InkButton,()=>{this.ZCj()}),this.ej.showToolbarButton(Jh.a.InkButton));this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&!this.To.f4&&(this.ej.registerButtonCallback(Jh.a.LiveButton,()=>
{this.Muk()}),this.ej.updateFlyoutButtonCallback(Jh.a.LiveButton,this.Ub.instance.dr),this.ej.setToolbarButtonToggleState(Jh.a.LiveButton,this.Ub.instance.dr),this.ej.showToolbarButton(Jh.a.LiveButton),this.Ub.instance.yuf(Object(F.a)(this,this.gkc,"onLiveSessionStarted")),this.Ub.instance.wuf(Object(F.a)(this,this.fkc,"onLiveSessionEnded")),this.Ub.instance.uuf(Object(F.a)(this,this.ekc,"onLiveRelaunchPausedSession")),this.Ub.instance.N9h(Object(F.a)(this,this.h4g,"onLiveCalloutMenuDefintionChanged")));
this.bPb();this.Ovb();this.kb.Aia(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.oPd(Object(F.a)(this,this.Ggb,"onBrowserEventHandler"));this.kb.xGc(Object(F.a)(this,this.exa,"onGetCurrentSlideDimensionsHandler"));this.kb.CGc(Object(F.a)(this,this.oxa,"onSpecialKeyHandler"));this.kb.qPd(Object(F.a)(this,this.Hgb,"onContextMenuHandler"));this.kb.sPd(Object(F.a)(this,this.Ned,"onEnterEndOfShowHandler"));this.kb.uPd(Object(F.a)(this,this.lfd,"onLeaveEndOfShowHandler"));Id.a.addHandler(this.pe,ta.a.mq,
Object(F.a)(this,this.Pgb,"onMouseOverHandler"));Id.a.addHandler(this.pe,ta.a.Ns,Object(F.a)(this,this.ikc,"onMouseOutHandler"));Id.a.addHandler(this.nea,ta.a.click,Object(F.a)(this,this.tfa,"onClickHandler"));Id.a.addHandler(this.pe,ta.a.Yf,Object(F.a)(this,this.jJa,"onKeyDownHandler"))}Hll(){window.clearTimeout(this.yve);this.yve=window.setTimeout(Object(F.a)(this,this.mzj,"hideMouse"),3E3);this.kb.hga(!0)}mzj(){this.YL||(window.clearTimeout(this.yve),this.kb.hga(!1))}jD(a,b){b?this.ej.showToolbarButton(a):
this.ej.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.ej.setToolbarButtonToggleState(a,b)}show(){if(this.gu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.WXa+this.qU-16-this.ej.getToolbarWidth()).toString()+"px";a.style.left=b}}this.ej.showToolbar();this.ej.enterFocusTrapZone();window.clearTimeout(this.DWa);window.clearTimeout(this.uCb);this.Zue?(this.DWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),2E3),this.Zue=!1,this.kqe=!0):this.DWa=window.setTimeout(Object(F.a)(this,
this.hide,"hide"),3E3);this.kb.hga(!0)}kwh(){if(this.gu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.WXa+this.qU-16-this.ej.getToolbarWidth()).toString()+"px";a.style.left=b}}this.ej.showToolbar();this.ej.enterFocusTrapZone();window.clearTimeout(this.DWa);window.clearTimeout(this.uCb);this.uCb=window.setTimeout(Object(F.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.YL){const a=document.getElementById("slideshow-toolbar");a&&!this.ej.isAnyToolbarElementFocused()&&document.activeElement===
a&&this.p1a(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.DWa);window.clearTimeout(this.uCb);this.ej.hideToolbar();this.kb.hga(!1);this.pe.style.display===mf.a.Gf&&this.kb.restoreFocus()}}Ovb(){this.YL||(this.kqe&&this.p1a(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.DWa),window.clearTimeout(this.uCb),this.ej.forceHideToolbar(),this.kb.hga(!1),this.pe.style.display===mf.a.Gf&&this.kb.restoreFocus())}remove(){this.ej.closeToolbar();this.nea.style.visibility=
mf.a.Qs;this.E6c=!1;this.kb.Rfa(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.YQe(Object(F.a)(this,this.Ggb,"onBrowserEventHandler"));this.kb.pld(Object(F.a)(this,this.exa,"onGetCurrentSlideDimensionsHandler"));this.kb.tld(Object(F.a)(this,this.oxa,"onSpecialKeyHandler"));this.kb.$Qe(Object(F.a)(this,this.Hgb,"onContextMenuHandler"));this.kb.aRe(Object(F.a)(this,this.Ned,"onEnterEndOfShowHandler"));this.kb.cRe(Object(F.a)(this,this.lfd,"onLeaveEndOfShowHandler"));Id.a.removeHandler(this.pe,
ta.a.mq,Object(F.a)(this,this.Pgb,"onMouseOverHandler"));Id.a.removeHandler(this.pe,ta.a.Ns,Object(F.a)(this,this.ikc,"onMouseOutHandler"));Id.a.removeHandler(this.nea,ta.a.click,Object(F.a)(this,this.tfa,"onClickHandler"));Id.a.removeHandler(this.pe,ta.a.Yf,Object(F.a)(this,this.jJa,"onKeyDownHandler"));this.pe&&(this.mf.contains(this.pe)||this.p5c&&this.p5c.contains(this.pe))&&(this.YL=!1);this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.Ub.instance.Aih(Object(F.a)(this,this.gkc,"onLiveSessionStarted")),
this.Ub.instance.zih(Object(F.a)(this,this.fkc,"onLiveSessionEnded")),this.Ub.instance.xih(Object(F.a)(this,this.ekc,"onLiveRelaunchPausedSession")),this.Ub.instance.xYk(Object(F.a)(this,this.h4g,"onLiveCalloutMenuDefintionChanged")))}xna(){this.remove()}p1a(a){ha.a.Wa(a)?xa.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.gDe.Leh(new Gx(a))}exa(a,b){try{this.WXa=b.Jwh;this.UXa=b.Gwh;this.qU=b.slideWidth;if("NaN"===this.WXa.toString()||
"NaN"===this.UXa.toString()){xa.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=df.a.Uh(359);u.AFrameworkApplication.vp(c);kf.Health.instance.recordQosError(df.a.lja(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Ub.instance&&this.Ub.instance.dr&&!this.E6c?26:0;if(this.Ha.pptEditorVoiceUXEnabled){const f=document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.gu()?(this.WXa+this.qU-16-this.ej.getToolbarWidth()).toString()+
"px":(this.WXa+2).toString()+"px";f.style.left=l;if(this.Hc.Kh&&"AboveSlide"===this.Hc.Tv)f.style.bottom="0px";else{const H=Ca.a.RUc();a=0;const U=document.getElementById("AppHeaderPanel");U&&(a=U.clientHeight);f.style.bottom=this.du.i9?(H-this.UXa-c).toString()+"px":(H-this.UXa-a-c).toString()+"px"}f.style.top="auto";const x=document.getElementById("ReactToolbarInnerContainer");x&&(x.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.gu()?(this.WXa+
this.qU-16-this.ej.getToolbarWidth()).toString()+"px":(this.WXa+2).toString()+"px";f.style.left=l;const x=this.Ub.instance&&this.Ub.instance.dr?(this.UXa+c).toString()+"px":this.UXa.toString()+"px";"AboveSlide"===this.Hc.Tv?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=x,f.style.bottom="auto");f.style.top=x}}}this.show()}catch(c){xa.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}Ned(){this.E6c=!0}lfd(){this.E6c=!1}jJa(a){this.ej.isAnyCalloutMenuOpen()||(this.YL=!1);try{this.pe.style.display===mf.a.Wk&&(a.keyCode===A.a.smb||a.keyCode===A.a.SB||a.keyCode===A.a.U1?this.kb.prev():a.keyCode===A.a.Qza||a.keyCode===A.a.RB||a.keyCode===A.a.S1?this.kb.next():a.keyCode===A.a.VR?this.gu()?this.kb.next():this.kb.prev():a.keyCode===A.a.oP?this.gu()?this.kb.prev():this.kb.next():a.keyCode===A.a.tMa?(this.CCe=!0,this.Ovb()):a.shiftKey&&a.keyCode===A.a.xpa||a.keyCode===A.a.ZPb?this.Ovb():
this.kb.EUe(a))}catch(b){xa.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}oxa(a,b){this.ej.isAnyCalloutMenuOpen()||(this.YL=!1);if(b.key===A.a.ZPb||b.shiftKey&&b.key===A.a.xpa)a="off",this.pe.style.display===mf.a.Gf?(this.kwh(),a="on"):this.Ovb(),xa.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}Hgb(){if(this.CCe)this.CCe=!1;else{var a="off";this.pe.style.display===mf.a.Gf?(this.kwh(),
a="on"):this.ej.isAnyCalloutMenuOpen()||this.Ovb();xa.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}Ggb(a,b){this.Hll();b.clientY<this.UXa+8+20&&b.clientY>this.UXa-20-8&&this.show()}Pgb(a){(a=a.target)&&this.pe.contains(a)&&(this.YL=!0)}ikc(a){a.target&&(this.ej.isAnyCalloutMenuOpen()?this.nea.style.visibility=mf.a.Dz:(this.YL=!1,this.show()));this.ej.isAnyCalloutMenuOpen()||this.ej.enterFocusTrapZone()}tfa(a){this.YL=
!1;window.clearTimeout(this.DWa);window.clearTimeout(this.uCb);this.nea.style.visibility=mf.a.Qs;this.DWa=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.ej.enterFocusTrapZone()}mHb(){xa.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.kb.prev()}hHb(){xa.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.kb.next()}dHb(){xa.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.ej.closeToolbar();
this.kb.exit()}i2e(a){const b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr;var c=this.Hc.mUf&&5!==a&&!b;5!==a&&(this.Hc.Kh&&(ki.a.$J("PPTCaptionDiscoverabiltyDoNotShowAgain","true",ki.a.DJ)||xa.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Hc.Kh=!this.Hc.Kh);this.ej.setToolbarButtonToggleState(Jh.a.SubtitlesButton,this.Hc.Kh);xa.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Kh);this.Hc.Kh&&c&&Fz.Tog(this.kb,this.qe,this.Xa);c||(c=Date.now(),b?this.gR||this.Ub.instance.xvb()?this.kb.toggleTranscriberUIVisibility(null):(this.Ub.instance.F$f(),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,a,c,this.To)):this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,a,c,this.To));this.gR=this.Hc.Kh||b;this.Dud();this.bPb()}Dud(){this.ej.setToolbarButtonToggleState(Jh.a.MicButton,
this.gR);this.gR?this.ej.showToolbarButton(Jh.a.MicButton):this.ej.hideToolbarButton(Jh.a.MicButton)}bPb(){const a=this.Hc.Kh,b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr,c=this.To.f4,f=32!==this.ia.processAction(K.a.Pfa,1);a||b||c||f?this.ej.hideToolbarButton(Jh.a.CoachButton):this.ej.showToolbarButton(Jh.a.CoachButton)}dvk(){xa.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.gR=!this.gR;this.ej.setToolbarButtonToggleState(Jh.a.MicButton,this.gR);this.kb.setMicrophoneState(!this.gR);
if(this.Ub&&this.Ub.instance&&this.Ub.instance.dr&&this.gR&&!this.Ub.instance.xvb()){this.Ub.instance.F$f();const a=this.Hc.Kh;this.Ub.instance.$ca=!this.Hc.Kh;this.Hc.Kh=!0;this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,5,Date.now(),this.To);this.Hc.Kh=a}}Irk(){xa.a.J(512495941,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.La(K.a.Pfa,2,{entryPoint:2})?this.Ha.pptEditorRehearsalSpeechClientEnabled||(this.To.f4=
!0):xa.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}vgd(){xa.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.i2e(3)}eHb(){xa.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.La(K.a.MMb,2,null)}Muk(){this.Ub&&this.Ub.instance&&(xa.a.J(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ub.instance.dr),this.Ub.instance.dr||(this.Ub.instance.Trc(3,u.AFrameworkApplication.userSessionId,
this.Ha.podsWebServiceBase,this.Xa.podSessionId,u.AFrameworkApplication.gh),this.Ub.instance.$ca=!this.Hc.Kh,this.Hc.tvb&&!this.Hc.Kh&&(xa.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Kh=!0,this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,5,Date.now(),this.To),this.Hc.Kh=!1,this.gR=!0,this.Dud()),this.YL=!1,this.ej.setToolbarButtonToggleState(Jh.a.LiveButton,!0)));this.bPb()}gkc(){this.ej.setToolbarButtonToggleState(Jh.a.LiveButton,
!0);this.Cud(!1,!1);this.gR=!0;this.Dud();this.bPb();this.e_g()}fkc(){this.ej.setToolbarButtonToggleState(Jh.a.LiveButton,!1);this.Cud(!1,!0);this.Ub&&this.Ub.instance&&this.Ub.instance.$ca&&!this.Hc.Kh&&(xa.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,5,Date.now(),this.To));this.Ub.instance.$ca=!1;this.Hc.Kh||(this.gR=!1,this.Dud());this.bPb()}ekc(){this.Ub&&
this.Ub.instance&&(this.YL=!0,this.show(),this.nea.style.visibility=mf.a.Dz,this.Cud(!0,!1),this.e_g());this.bPb()}e_g(){this.Ha.xid&&!this.Ub.instance.xvb()&&(this.gR=!1,this.ej.setToolbarButtonToggleState(Jh.a.MicButton,this.gR),this.Hc.Kh=!1,this.ej.setToolbarButtonToggleState(Jh.a.SubtitlesButton,this.Hc.Kh))}h4g(){this.Cud(!1,!1)}Cud(a,b){if(this.Ub&&this.Ub.instance){const c=new SJ;c.menuDefinition=b?null:this.Ub.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.ej.updateElementProps(Jh.a.LiveButton,
c);this.ej.updateFlyoutButtonCallback(Jh.a.LiveButton,!b)}}ZCj(){this.R9j.execute(Object(F.a)(this,this.YCj,"initInkButton"));const a=new UJ;a.item="Init";this.kb.iLe(a);this.ej.registerButtonCallback(Jh.a.InkButton,()=>{})}YCj(a){const b=new TJ;b.onInkMenuActivity=c=>{this.kuk(c)};this.GCb=a.Aaj(b);a=Dz.create();a.icon=this.GCb.getIcon();a.menuDefinition=this.GCb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.ej.updateElementProps(Jh.a.InkButton,a)}kuk(a){this.kb.iLe(a);
a=Dz.create();a.selectedColor=this.GCb.getSelectedColor();a.icon=this.GCb.getIcon();a.menuDefinition=this.GCb.getControlsInMenu();this.ej.updateElementProps(Jh.a.InkButton,a);Ud.a("DismissToolbarOnSelection")&&this.Ovb()}}Object(m.a)(gD,"ReactSlideshowToolbar",null,[393,394]);class hD{constructor(a,b){this.hi=a;this.Fdc=document.createElement("div");this.Fdc.id="slideshowfooterContainerElement";this.Fdc.className="slideshowFooterContainer";this.ia=b}init(){xa.a.J(595198370,830,50,"SlideShowFooterContainer.Init");
this.hi&&this.hi.appendChild(this.Fdc)}remove(){this.hi&&this.hi.contains(this.Fdc)&&this.hi.removeChild(this.Fdc)}wb(){this.ia.ya(K.a.rvh,rc.a.application,Object(F.a)(this,this.Zkl,"showFooterElements"));this.ia.ya(K.a.Zbg,rc.a.application,Object(F.a)(this,this.izj,"hideFooterElements"))}Zkl(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display="flex");return 32}izj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=
mf.a.Gf);return 32}}Object(m.a)(hD,"SlideShowFooterContainer",null,[632]);class WJ{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(m.a)(WJ,"IVoiceActorSettings",null,[]);class XJ{constructor(){this.qic=this.hi=this.Xfb=null}init(){xa.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.Xfb=document.createElement("div");this.Xfb.id="voiceNotificationContainerElement";this.Xfb.className="voiceNotificationContainer";(this.hi=document.getElementById("slideshowfooterContainerElement"))&&
this.hi.insertBefore(this.Xfb,this.hi.firstChild);const a=new WJ;a.baseZIndex=50002;a.hostElement=this.Xfb;this.qic=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.hi&&this.hi.contains(this.Xfb)&&this.hi.removeChild(this.Xfb)}show(a,b){this.qic&&this.qic.showNotification(a,b)}hide(){this.qic&&this.qic.hideNotification()}}Object(m.a)(XJ,"SlideShowVoiceNotification",null,[328]);class iD extends Zh.a{constructor(a,b){super(!1,!0);this.vhc=null;this.Icb=this.jWa=0;this.mze=50001;this.oDb=
null;this.kb=a;this.Zbk=b;this.kb.Aia(Object(F.a)(this,this.yfa,"onSlideshowExitHandler"));this.kb.MYb(Object(F.a)(this,this.ufa,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.iHa=!1}get Vqd(){if(void 0===this.vhc||null===this.vhc)this.vhc=document.getElementById("GotoDlgInput");return this.vhc}THl(){if(!RegExp("^[0-9]+$").test(this.Vqd.value))return this.Vqd.value=this.jWa.toString(),!1;this.Icb=Number.parseInvariant(this.Vqd.value);this.Icb=Math.min(this.Icb,this.Zbk);this.Icb=
Math.max(this.Icb,1);return!0}dispose(){super.dispose();this.vhc=null;this.iHa||this.kb.restoreFocus()}pu(){super.pu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.mze);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}AA(){super.AA();const a=document.getElementById(this.Nh("WACDialogPanel"));a.style.minWidth=lf.a.Pc(300);a.style.width=lf.a.Pc(300)}open(){xa.a.J(24133980,830,50,"SlideshowGoToDialog: Open");
this.rg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.jWa.toString()};this.Zi(ResourceStrings.L_GoTo,Object(F.a)(this,this.tfa,"onClickHandler"),a);this.kb.setVisibility(!0);this.Vqd.focus()}X7(){super.X7();this.oDb=Object(F.a)(this,this.jJa,"onKeyDownHandler");u.AFrameworkApplication.Aa.qG.Pkd(ta.a.Yf,window.document,this.oDb,null)}tsa(){super.tsa();void 0!==
this.oDb&&null!==this.oDb&&u.AFrameworkApplication.Aa.qG.c4e(ta.a.Yf,window.document,this.oDb);this.oDb=null}Bib(){}ufa(a,b){this.kb.Cib(Object(F.a)(this,this.ufa,"onGetCurrentPositionHandler"));this.jWa=b.slideIndex+1;this.open()}yfa(){this.iHa=!0;this.kb.Rfa(Object(F.a)(this,this.yfa,"onSlideshowExitHandler"));this.kb.Cib(Object(F.a)(this,this.ufa,"onGetCurrentPositionHandler"));this.hide()}jJa(a){a=a.qc.keyCode;return a===A.a.tq?(this.THl()&&(this.tTa(this.Icb),this.hide()),!0):a===A.a.$Pb||a===
A.a.uMa||a===A.a.JIh||a===A.a.ivd?!0:!1}tfa(a){1===a&&this.tTa(this.Icb)}tTa(a){this.kb.tTa(a-1)}static gZj(a,b){1>=b||void 0!==xi.a.$w&&null!==xi.a.$w||new iD(a,b)}}Object(m.a)(iD,"SlideshowGoToDialog",Zh.a,[]);class jD{constructor(a,b,c,f,l,x,H,U,ja){this.O4=this.K=null;this.KCb=!1;this.x4=[];this.nWa=this.pE=this.Kdc=null;this.kb=a;this.Tb=b;this.Ava=c;this.ia=f;this.he=l;this.mf=x;this.gu=H;this.du=U;this.Ub=ja}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",
this.K.className="SlideshowContextMenuContainer");this.O4=document.createElement("div");this.O4.className="SlideshowContextMenu cui-menu";this.O4.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.gu();let c=this.ZK(ResourceStrings.L_Next,Object(F.a)(this,this.hHb,"onNextClickHandler"),b);Array.add(this.x4,c);a.appendChild(c);c=this.ZK(ResourceStrings.L_Previous,Object(F.a)(this,this.mHb,"onPrevClickHandler"),b);Array.add(this.x4,
c);a.appendChild(c);c=this.ZK(ResourceStrings.l_GotoCell,Object(F.a)(this,this.Vtk,"onGoToClickHandler"),b);Array.add(this.x4,c);a.appendChild(c);c=this.ZK(ResourceStrings.L_GridView_SeeAllSlides,Object(F.a)(this,this.eHb,"onGridViewClickHandler"),b);Array.add(this.x4,c);a.appendChild(c);this.du.UCf&&(this.Kdc=this.ZK(this.du.i9?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(F.a)(this,this.iJa,"onFullscreenClickHandler"),b),Array.add(this.x4,this.Kdc),a.appendChild(this.Kdc),
this.du.l_&&!this.pE&&(this.pE=Object(F.a)(this,this.Xjc,"onFullscreenChangeHandler"),$addHandler(this.mf,this.du.l_,this.pE)));c=this.ZK(ResourceStrings.L_EndShow,Object(F.a)(this,this.dHb,"onExitClickHandler"),b);Array.add(this.x4,c);a.appendChild(c);this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.nWa=this.ZK(ResourceStrings.l_EndLivePresentation,Object(F.a)(this,this.Usk,"onEndLivePresentationClickHandler"),b),Array.add(this.x4,this.nWa));this.O4.appendChild(a);this.K.appendChild(this.O4);
this.mf.appendChild(this.K);this.Ava.addHandler(this.K,ta.a.click,Object(F.a)(this,this.tfa,"onClickHandler"));this.Ava.addHandler(this.K,ta.a.contextMenu,Object(F.a)(this,this.H3g,"onHostContextMenuHandler"));this.Ava.addHandler(this.O4,ta.a.mq,Object(F.a)(this,this.Pgb,"onMouseOverHandler"));this.kb.qPd(Object(F.a)(this,this.Hgb,"onContextMenuHandler"));this.kb.Aia(Object(F.a)(this,this.xna,"onExitHandler"))}show(){if(this.Ub&&this.Ub.instance&&this.Ub.instance.dr&&this.nWa&&!this.nWa.parentNode){const a=
this.O4.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.nWa)}this.KCb||(this.Ava.addHandler(window.document,ta.a.Yf,Object(F.a)(this,this.jJa,"onKeyDownHandler")),this.Ava.addHandler(window.document,ta.a.Il,Object(F.a)(this,this.dkc,"onKeyUpHandler")),this.KCb=!0);this.K.style.visibility=mf.a.Dz}hide(){this.Ava.removeHandler(window.document,ta.a.Yf,Object(F.a)(this,this.jJa,"onKeyDownHandler"));this.Ava.removeHandler(window.document,ta.a.Il,
Object(F.a)(this,this.dkc,"onKeyUpHandler"));this.KCb=!1;this.K.style.visibility=mf.a.Qs;if(this.nWa&&this.nWa.parentNode){const a=this.O4.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.nWa)}}remove(){this.K&&(this.Ava.removeHandler(this.K,ta.a.click,Object(F.a)(this,this.tfa,"onClickHandler")),this.Ava.removeHandler(this.K,ta.a.contextMenu,Object(F.a)(this,this.H3g,"onHostContextMenuHandler")),this.mf.contains(this.K)&&this.mf.removeChild(this.K));
this.K=null;Array.clear(this.x4)}xna(){this.kb.Rfa(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.$Qe(Object(F.a)(this,this.Hgb,"onContextMenuHandler"));this.Kdc&&($removeHandler(this.mf,this.du.l_,this.pE),this.pE=null);this.remove()}tfa(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.kb.restoreFocus())}Hgb(a,b){this.s7g(b.clientX,b.clientY)}H3g(a){this.s7g(a.clientX,a.clientY)}Pgb(a){(a=a.target)&&"li"===a.tagName.toLowerCase()&&(this.CQe(document.activeElement),this.HR(a))}jJa(a){const b=
a.keyCode,c=a.shiftKey;b===A.a.Sq||b===A.a.K6?this.g_g(!!(1^c)):b===A.a.cZ&&this.g_g(!!(0^c));a.preventDefault()}dkc(a){var b=a.keyCode;b===A.a.tq||b===A.a.pP?(b=document.activeElement,Array.contains(this.x4,b)&&b.click()):b===A.a.T1&&this.kb.exit();a.preventDefault()}s7g(a,b){this.setPosition(a,b);this.lti();this.show();this.O4.focus();this.he.Keh(new Gx(ResourceStrings.L_ControlMenu))}setPosition(a,b){if(this.O4){var c=this.O4.offsetWidth,f=this.O4.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&
(a-=c);b+f>l&&(b-=f);this.O4.style.top=lf.a.Pc(b);this.O4.style.left=lf.a.Pc(a)}}ZK(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.Ava.addHandler(f,ta.a.click,b);return f}mHb(){xa.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.kb.prev();this.hide();this.kb.restoreFocus()}hHb(){xa.a.J(24133959,830,50,"SlideshowContextMenu.OnNextClickHandler");this.kb.next();this.hide();
this.kb.restoreFocus()}Vtk(){xa.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();iD.gZj(this.kb,this.Tb.pj())}eHb(){xa.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.La(K.a.MMb,2,null)}iJa(){xa.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.kb.f2e();this.hide();this.kb.restoreFocus()}Xjc(){this.Kdc.innerText=this.du.i9?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}dHb(){xa.a.J(24133963,
830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.kb.exit()}Usk(){xa.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.kb.restoreFocus();this.Ub&&this.Ub.instance&&this.Ub.instance.dr&&this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.p3b(4)},()=>{})}g_g(a){const b=document.activeElement,c=Array.indexOf(this.x4,b);a=this.x4[((-1===c?a?0:-1:a?c+1:c-1)+this.x4.length)%this.x4.length];void 0!==a&&null!==a&&(this.CQe(b),this.HR(a))}lti(){this.x4.forEach(a=>
{this.CQe(a)})}HR(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.he.Keh(new Gx(a.innerText)))}CQe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(m.a)(jD,"SlideshowContextMenu",null,[394]);var FQ=d(1E3),Hx=d(260);class YJ{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we){this.va=new wc.a;this.pE=null;this.JBe=this.KBe=this.Gad=this.zhc=-1;this.ntg=this.ptg=this.otg=this.qDb=
null;this.Cbc="";this.Xbd=this.Lad=-1;this.YFg=new Date(0);this.KFg="";this.gwg=null;this.pyg=this.mdb=this.Cue=this.Dwe=!1;this.THa=this.To=this.Hc=null;this.Ecc=-1;this.zxg=this.Rxg=!1;this.du=a;this.kb=b;this.yea=c;this.Tb=ja;this.la=H;this.I6j=f;this.vi=l;this.Ds=x;this.rt=U;this.Xa=ya;this.pz=Va;this.Rd=hb;this.vwa=yb;this.Oc=Zb;this.dcd=fc;this.Hwa=Kc;this.lu=this.rt.FF();this.mUg=this.la.pptEditorHermesSlideShowStartTimeout;this.kDe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Oc.KA(Object(F.a)(this,
this.DB,"onSessionEnd"));this.pz.zPd(Object(F.a)(this,this.lHb,"onPodSessionUnavailable"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.pz.frb(Object(F.a)(this,this.vfa,"onPodSessionRefreshed")),this.pz.Guf(Object(F.a)(this,this.Pfd,"onPodSessionRefreshedFromBrowser")));this.ia=Lc;this.Ub=Gc;this.Ead=ae;this.Ll=we;a=document.createElement("div");a.id="HiddenFocusTrapAnchor";u.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||
u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.lu.insertBefore(a,this.lu.firstChild)}dispose(){this.Oc.paa(Object(F.a)(this,this.DB,"onSessionEnd"));this.pz.rZk(Object(F.a)(this,this.lHb,"onPodSessionUnavailable"));this.Oc.Sfa(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&
(this.pz.Fib(Object(F.a)(this,this.vfa,"onPodSessionRefreshed")),this.pz.Fih(Object(F.a)(this,this.Pfd,"onPodSessionRefreshedFromBrowser")))}ADj(a,b,c,f){this.gwg=b;"Legacy"==this.kb.N8()&&this.kb.init(a,b,c,this.Xa.podSessionId);this.Hc=f;this.To=new Ez}N8(){return this.kb.N8()}W$b(){return!ha.a.Wa(this.Cbc)}get Bce(){return this.mdb}set Bce(a){this.mdb=a}Bbl(){this.zxg=!0}jrd(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){kf.Health.instance.addQosPillar("Present");this.W$b()&&xa.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");
u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.THa=Db.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.THa.Ndb&&(this.Ecc=b,this.ia.processAction(K.a.Iqd,2,null),this.THa.u$h(Object(F.a)(this,this.kwk,"onPresenterViewSyncMessageReceivedHandler")));const Zb=c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.zhc=ya;this.Gad=Date.now();const fc=document.createElement("div");fc.id="startingSlideshowHiddenDiv";fc.style.position="position: absolute";
fc.style.left="-10000px";fc.style.top="auto";fc.style.width="1px";fc.style.height="1px";fc.style.overflow="hidden";fc.tabIndex=-1;fc.setAttribute("aria-live","assertive");this.lu.insertBefore(fc,this.lu.firstChild);fc.innerText=ResourceStrings.l_StartingSlideShow;const Kc=U+ya.toString();this.Cbc=Kc;this.vwa&&this.vwa.nqc(!0);this.la.AUj&&this.dcd&&this.dcd.nqc(!0);this.To&&(this.To.f4=c,this.To.startingSlideIndex=b,this.To.Qya=this.Tb.pj(),this.To.NOf=this.la.JVk);this.la.pptEditorVoiceUXEnabled&&
this.Ead&&this.Ead.init();this.la.pptEditorVoiceUXEnabled&&this.Ll&&this.Ll.execute(Gc=>{Gc.init()});this.yea.execute(Gc=>{Gc.init(this.Hc,this.To)});this.otg=this.lu.style.top;this.lu.style.top=lf.a.Pc(0);this.la.TUa&&(this.ptg=this.lu.style.width,this.ntg=this.lu.style.height,this.lu.style.width="100%",this.lu.style.height="100%");this.kb.show();this.Wog();this.la.Owh&&Rr.a.NOb(!1);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.THa&&this.THa.Ndb&&this.kb.GPa(Object(F.a)(this,this.egd,
"onSlideChangedHandler"));this.kb.Aia(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.quf(Object(F.a)(this,this.iJa,"onFullscreenClickHandler"));this.kb.BGc(Object(F.a)(this,this.s6g,"onSlideshowReadyHandler"));this.kb.nuf(Object(F.a)(this,this.Ped,"onErrorHandler"));this.kb.CGc(Object(F.a)(this,this.oxa,"onSpecialKeyHandler"));this.kb.vPd(Object(F.a)(this,this.Ofd,"onPodSessionExpiredHandler"));this.kb.tuf(Object(F.a)(this,this.pfd,"onLogEndOfTranscriptionSessionHandler"));this.kb.suf(Object(F.a)(this,
this.ofd,"onLiveSubtitlesDockedViewHandler"));this.kb.Kuf(Object(F.a)(this,this.Fkd,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.pz.frb(Object(F.a)(this,this.vfa,"onPodSessionRefreshed")),this.pz.Guf(Object(F.a)(this,this.Pfd,"onPodSessionRefreshedFromBrowser")));this.o$h(Object(F.a)(this,this.jfd,"onKeydownHandler"));c=Date.now();let Lc=!this.la.$kg||Va;Lc||(Lc=this.vi.bSc().NN());this.Rxg=Lc;ya=Date.now();xa.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",
ya-c,Lc?"True":"False",Va?"True":"False");this.KBe=Date.now();this.vi.bSc().forceOutbound(()=>{xa.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.vi.flush(()=>{this.JBe=Date.now();xa.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.JBe-this.KBe);this.Cbc===Kc&&Lc&&(Va&&hb&&(xa.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=hb.pk,x=hb.podSessionId),this.Zxh(a,b,f,l,x,H,U,ja,yb,Zb),xa.a.J(512495811,
830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},Gc=>{xa.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Gc.ServerError);return!1})},(Gc,ae)=>{xa.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",ae)},null);this.Cbc!==Kc||Lc||(this.Zxh(a,b,f,l,x,H,U,ja,yb,Zb),xa.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}Zxh(a,b,c,f,l,x,H,U,ja,ya=!1){const Va=
Ug.a.create().toString();this.la.ajg&&this.XDk(c,l,H,Va);const hb={};hb.SlideShowKind=this.kb.N8();hb.IsFrameNull=this.kb?"false":"true";hb.slideshowClickTimeMs=this.zhc;void 0!==window.performance.timing&&null!==window.performance.timing&&(hb.slideshowClickTimePerformanceAPI=this.zhc-window.performance.timing.navigationStart);xa.a.J(590976135,830,15,JSON.stringify(hb));this.kb.jrd(a,b,f,l,x,H,U,Va,this.zhc);0<this.mUg&&(this.Lad=window.setTimeout(Object(F.a)(this,this.pyk,"onStartSlideshowTimeoutHandler"),
this.mUg));this.Ub&&this.Ub.instance&&this.Ub.instance.hgd(a,b,c,f,l,x,H,u.AFrameworkApplication.gh,ja);this.Hc&&this.Hc.C5k();ya&&(this.Hc.Kh=!1);Ud.a("PresenterCoachTabFix")&&this.kb.Qoh()}oxa(a,b){if(b.key===A.a.T1)xa.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.yea.execute(c=>{c.remove()}),this.kb.exit();else if(b.key===A.a.XPb)this.ia.La(K.a.btd,2,null);else if(b.key===A.a.iwd&&this.la.hla&&this.Hc&&this.Hc.BDa&&this.To&&this.Tb&&!this.To.f4&&this.la.kWj&&this.Hc.oUf)try{this.Hc.Kh&&
(ki.a.$J("PPTCaptionDiscoverabiltyDoNotShowAgain","true",ki.a.DJ)||xa.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));this.Hc.Kh=!this.Hc.Kh;xa.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Hc.Kh);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Hc.Kh?"prt2_SubtitleSlideShowToggleHover_40x40x32":
"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr;if(f)this.kb.toggleTranscriberUIVisibility(null);else{let l=Date.now();this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,4,l,this.To)}this.yea.execute(l=>{l.setToolbarButtonToggleState(Jh.a.SubtitlesButton,this.Hc.Kh);l.jD(Jh.a.CoachButton,!this.Hc.Kh&&!f)})}catch(c){xa.a.J(512495776,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",
c)}else if(b.key===A.a.tvc&&this.Ub&&this.Ub.instance&&this.Ub.instance.BDa&&this.Ub.instance.TUi&&this.To&&!this.To.f4)try{if(this.Ub.instance.dr)this.Ub.instance.showWelcomeScreen();else{this.Ub.instance.$ca=!this.Hc.Kh;if(this.Hc.tvb&&!this.Hc.Kh){this.Hc.Kh=!0;let c=Date.now();this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,5,c,this.To);this.Hc.Kh=!1}this.Ub.instance.Trc(4,u.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,
this.Xa.podSessionId,u.AFrameworkApplication.gh)}}catch(c){xa.a.J(512495775,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",c)}}kwk(a,b){b&&(a=b.slideIndex,a!==this.Ecc&&(this.Ecc=a,this.kb.tTa(a)))}lZa(){xa.a.J(512495774,830,50,"OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.Dwe=!0}XDk(a,b,c,f){xa.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",
a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.gwg;this.Ds.mj(a,2,null,b,!1,2,()=>{xa.a.J(512495772,830,50,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{xa.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,Hx.a("14"))}Aia(a){this.va.addHandler("OnExitSlideshow",
a)}Rfa(a){this.va.removeHandler("OnExitSlideshow",a)}GPa(a){this.va.addHandler("OnPositionChangeEventId",a)}Dib(a){this.va.removeHandler("OnPositionChangeEventId",a)}o$h(a){this.qDb||(this.qDb=a,Id.a.addHandler(window.document.body,"keydown",this.qDb))}bRe(){this.qDb&&(Id.a.removeHandler(window.document.body,"keydown",this.qDb),this.qDb=null)}Xjc(){if(this.du.i9)xa.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.ZEf();this.kb.hRe(Object(F.a)(this,
this.lZa,"onVisibilityChangeHandler"));xa.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");var a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.eK);a=!!a&&"teams"===a.toLowerCase();this.Dwe||this.Cue||!document.hasFocus()||a||(xa.a.J(512495768,830,50,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.yea.execute(b=>{b.remove()}),this.kb.exit());this.Dwe=!1}this.Cue=!1}egd(a,b){b&&this.Ecc!==b.slideIndex&&(this.Ecc=b.slideIndex,
this.THa.n8k(b))}xna(a,b){xa.a.J(512495767,830,50,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.BFf();var c=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.Cbc="";this.vwa&&this.vwa.nqc(!1);this.dcd&&this.dcd.nqc(!1);this.Hc&&this.Hc.V2k();this.kb.Rfa(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.tih(Object(F.a)(this,
this.iJa,"onFullscreenClickHandler"));this.kb.rld(Object(F.a)(this,this.s6g,"onSlideshowReadyHandler"));this.kb.qih(Object(F.a)(this,this.Ped,"onErrorHandler"));this.kb.tld(Object(F.a)(this,this.oxa,"onSpecialKeyHandler"));this.kb.hRe(Object(F.a)(this,this.lZa,"onVisibilityChangeHandler"));this.kb.dRe(Object(F.a)(this,this.Ofd,"onPodSessionExpiredHandler"));this.kb.vih(Object(F.a)(this,this.pfd,"onLogEndOfTranscriptionSessionHandler"));this.kb.uih(Object(F.a)(this,this.ofd,"onLiveSubtitlesDockedViewHandler"));
this.kb.Kih(Object(F.a)(this,this.Fkd,"recordQosErrorHandler"));this.bRe(Object(F.a)(this,this.jfd,"onKeydownHandler"));(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.pz.Fib(Object(F.a)(this,this.vfa,"onPodSessionRefreshed")),this.pz.Fih(Object(F.a)(this,this.Pfd,"onPodSessionRefreshedFromBrowser")));this.la.Owh&&(Rr.a.NOb(!0),this.du.i9||xG.a.I_a(u.AFrameworkApplication.isRtl));this.ZEf();Rs.exitFullscreen();
this.lu.style.top=this.otg;this.la.TUa&&(this.lu.style.width=this.ptg,this.lu.style.height=this.ntg);this.rt.Oq();this.va.raiseEvent("OnExitSlideshow",b,a);this.Ub&&this.Ub.instance&&this.Ub.instance.ayk();this.To&&this.To.f4&&b.summary&&this.ia.La(K.a.oLa,2,b.summary);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.THa&&this.THa.Ndb&&this.ia.processAction(K.a.ZJc,2,null);this.To&&(this.To.f4=!1);this.la.pptEditorVoiceUXEnabled&&this.Ll&&this.Ll.instance&&this.Ll.instance.remove();
this.la.pptEditorVoiceUXEnabled&&this.Ead&&this.Ead.remove();this.yxl()}yxl(){u.AFrameworkApplication.fa.ka("798")&&Db.a.instance.Ja("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{xa.a.J(512495766,830,15,"Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}iJa(){this.Cue=!0;this.du.i9?Rs.exitFullscreen():this.Wog()}Wog(){this.du.K9b&&(this.du.l_&&!this.pE&&(this.pE=Object(F.a)(this,this.Xjc,"onFullscreenChangeHandler"),$addHandler(this.lu,this.du.l_,
this.pE)),this.du.requestFullscreen(this.lu),this.kb.Duf(Object(F.a)(this,this.lZa,"onVisibilityChangeHandler")))}s6g(){this.BFf();var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1!==this.Gad){b=Date.now();xa.a.J(23098073,830,15,"slideshow ready in {0} ms",b-this.Gad);a={};a.SlideshowClickTimeMs=this.zhc;a.SlideshowStartTimeMs=
this.Gad;a.SlideshowStartFlushTimeMs=this.KBe;a.SlideshowFinishFlushTimeMs=this.JBe;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.la.$kg;a.NoBlockingOutBound=!this.Rxg;xa.a.J(512495765,830,50,JSON.stringify(a));this.yea.execute(()=>{this.la.f$b&&this.kb.getCurrentSlideDimensions()});!this.la.vg||!this.la.Sah&&this.la.f$b||this.I6j.init(this.Hc,this.To);b=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.ADa;a=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.dSa||
this.Ub.instance.dr);if((this.la.hla||this.la.kac)&&this.Hc&&this.To&&this.Tb&&(this.Hc.Kh||this.To.f4||b||a)&&this.Hc.oUf){const c=Date.now();let f=2;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np&&(f=1);const l=this.Hc.Kh;b||a?(this.Hc.Kh||(f=5),this.Ub.instance.$ca=!this.Hc.Kh,this.Hc.Kh=!0):this.Ub&&this.Ub.instance&&(this.Ub.instance.$ca=!1);this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,f,c,this.To);this.Hc.Kh=
l}b&&(this.Ub.instance.ADa=!1);this.bRe(Object(F.a)(this,this.jfd,"onKeydownHandler"));this.kb.hga(!1);this.kb.setOsfLocalStorage()}}jfd(a){27===a.keyCode&&(xa.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.bRe(Object(F.a)(this,this.jfd,"onKeydownHandler")),this.yea.execute(b=>{b.remove()}),this.kb.exit())}pfd(a,b){a={};try{const c=pa.a.lL(b.Mx);for(const f of c)try{a[f]=b.Mx[f]}catch(l){xa.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",
f,l)}}catch(c){xa.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}xa.a.J(512495761,830,15,JSON.stringify(a));try{!(this.To&&this.To.f4||!this.la.RHk||this.pyg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(xa.a.J(512495760,830,50,"Floodgate survey triggered for transcription."),this.pyg=!0,this.Hwa.continueWith(()=>{this.Hwa.result.logActivity("TranscriptionUsed",
"PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){xa.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",c)}}ofd(a,b){this.la.f$b||((a=document.getElementById("slideshow-toolbar"))?b.Z$b?"BelowSlide"===b.Tv?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.Tv?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom=
"6px",a.style.top="auto"):xa.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}Ofd(a,b){xa.a.J(512495757,830,50,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Xa.podSessionId)xa.a.J(512495756,830,15,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",
this.Xa.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.YFg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);const f=new Date,l=f>c;xa.a.J(512495755,830,50,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(xa.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",
b.code),this.Rd.zs(Object.assign(new Ml.a,{Code:223,Source:4}),b.podSessionId),0<this.kDe)){xa.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.kDe);this.YFg=new Date;this.KFg=b.podSessionId;this.Xbd=window.setTimeout(Object(F.a)(this,this.NVk,"rehydrationTimeout"),this.kDe);return}}else if(this.KFg===b.podSessionId){xa.a.J(512495752,830,50,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
b.podSessionId);return}}u.AFrameworkApplication.vp(df.a.Uh(359));kf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(xa.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.yea.execute(f=>{f.remove()}),this.kb.exit())}}Ped(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,
b.code,b.sessionId,b.correlationId,b.message,b.Vy,b.$Ij.toString());xa.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",a);u.AFrameworkApplication.vp(df.a.Uh(359));kf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(xa.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.yea.execute(c=>{c.remove()}),this.kb.exit())}ZEf(){this.pE&&(xa.a.J(512495748,
830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.lu,this.du.l_,this.pE),this.pE=null)}pyk(){xa.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");u.AFrameworkApplication.vp(df.a.Uh(360));kf.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.yea.execute(a=>{a.remove()});this.kb.exit()}NVk(){xa.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");u.AFrameworkApplication.vp(df.a.Uh(371));kf.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",
["SlideShowACE"],!1,!0,!0,!0,null);this.yea.execute(a=>{a.remove()});this.kb.exit()}Fkd(a,b){a=0<b.durationMs?Object.assign(new Oj.a,{durationMs:b.durationMs}):null;kf.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}vfa(a,b){xa.a.J(512495745,830,50,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);
this.mdb=!1;this.GFf();this.W$b()||"Legacy"!=this.kb.N8()?(xa.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.gY,this.Xa.pk),this.kb.refreshPodSession(b.gY,this.Xa.pk)):xa.a.J(512495744,830,50,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}Pfd(a,b){xa.a.J(512495714,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration);this.mdb=!1;this.GFf();this.W$b()||"Legacy"!=this.kb.N8()?(xa.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.gY,this.Xa.pk),this.kb.refreshPodSession(b.gY,this.Xa.pk)):xa.a.J(512495713,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}Do(){this.mdb=!1;xa.a.J(512495711,830,50,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}DB(){this.mdb=!0;xa.a.J(512495710,830,50,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}lHb(){this.mdb=!0;xa.a.J(512495709,830,50,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}BFf(){-1!==
this.Lad&&(window.clearTimeout(this.Lad),this.Lad=-1)}GFf(){-1!==this.Xbd&&(window.clearTimeout(this.Xbd),this.Xbd=-1)}}Object(m.a)(YJ,"SlideshowManager",null,[329]);class kD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.Mva=this.Odc=this.yfb=this.gCb=this.Ucb=this.oWa=this.QDb=this.wEb=this.To=this.Hc=this.pe=null;this.Rdc=0;this.YL=!1;this.pE=null;this.kb=c;this.qe=f;this.gDe=l;this.mf=H;this.gu=U;this.Xa=ya;this.du=Va;this.ia=a;this.Ha=b;this.jye=null;this.Nze=ja;this.Ub=x}init(a,b){this.pe=document.createElement("div");
this.pe.id="slideshow-toolbar";this.pe.className="SlideshowToolbar";this.mf.appendChild(this.pe);this.Hc=a;this.To=b;this.gu()?(this.wEb=this.esa("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.QDb=this.esa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.wEb=this.esa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.QDb=this.esa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.pe.appendChild(this.wEb);this.pe.appendChild(this.QDb);Id.a.addHandler(this.wEb,ta.a.click,Object(F.a)(this,this.mHb,"onPrevClickHandler"));Id.a.addHandler(this.QDb,ta.a.click,Object(F.a)(this,this.hHb,"onNextClickHandler"));this.Odc=this.esa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.pe.appendChild(this.Odc);
Id.a.addHandler(this.Odc,ta.a.click,Object(F.a)(this,this.eHb,"onGridViewClickHandler"));this.Ucb=this.oWa=null;this.du.UCf&&(this.oWa=this.esa("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.Ucb=this.esa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.du.i9,this.oWa.style.display=a?mf.a.Gf:mf.a.Wk,this.Ucb.style.display=a?mf.a.Wk:mf.a.Gf,this.pe.appendChild(this.oWa),
this.pe.appendChild(this.Ucb),Id.a.addHandler(this.oWa,ta.a.click,Object(F.a)(this,this.iJa,"onFullscreenClickHandler")),Id.a.addHandler(this.Ucb,ta.a.click,Object(F.a)(this,this.iJa,"onFullscreenClickHandler")),this.du.l_&&!this.pE&&(this.pE=Object(F.a)(this,this.Xjc,"onFullscreenChangeHandler"),$addHandler(this.mf,this.du.l_,this.pE)));this.yfb=null;this.Hc.tvb&&!this.To.f4&&(this.yfb=this.esa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.pe.appendChild(this.yfb),Id.a.addHandler(this.yfb,ta.a.click,Object(F.a)(this,this.vgd,"onTranscribeHandler")));this.gCb=this.esa("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.pe.appendChild(this.gCb);Id.a.addHandler(this.gCb,ta.a.click,Object(F.a)(this,this.dHb,"onExitClickHandler"));this.Mva=null;this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&!this.To.f4&&(this.Ub.instance.yuf(Object(F.a)(this,this.gkc,"onLiveSessionStarted")),
this.Ub.instance.wuf(Object(F.a)(this,this.fkc,"onLiveSessionEnded")),this.Ub.instance.M9h(Object(F.a)(this,this.g4g,"onLiveCalloutDismissed")),this.Ub.instance.uuf(Object(F.a)(this,this.ekc,"onLiveRelaunchPausedSession")),this.Ub.instance.F8a?this.kKf():this.Ub.instance.E$h(Object(F.a)(this,this.i4g,"onLivePresenterResourcesLoaded")));this.YL=!1;this.hide();this.kb.Aia(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.oPd(Object(F.a)(this,this.Ggb,"onBrowserEventHandler"));Id.a.addHandler(this.pe,
ta.a.mq,Object(F.a)(this,this.Pgb,"onMouseOverHandler"));Id.a.addHandler(this.pe,ta.a.Ns,Object(F.a)(this,this.ikc,"onMouseOutHandler"))}show(){this.pe.style.display=mf.a.Wk;window.clearTimeout(this.Rdc);this.Rdc=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3);this.kb.hga(!0)}hide(){this.YL||(window.clearTimeout(this.Rdc),this.pe.style.display=mf.a.Gf,this.kb.hga(!1))}remove(){this.pe&&this.mf.contains(this.pe)&&(this.mf.removeChild(this.pe),this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&
(this.Ub.instance.Aih(Object(F.a)(this,this.gkc,"onLiveSessionStarted")),this.Ub.instance.zih(Object(F.a)(this,this.fkc,"onLiveSessionEnded")),this.Ub.instance.wYk(Object(F.a)(this,this.g4g,"onLiveCalloutDismissed")),this.Ub.instance.aZk(Object(F.a)(this,this.i4g,"onLivePresenterResourcesLoaded")),this.Ub.instance.xih(Object(F.a)(this,this.ekc,"onLiveRelaunchPausedSession"))),this.YL=!1)}jD(){}setToolbarButtonToggleState(){}xna(){this.kb.Rfa(Object(F.a)(this,this.xna,"onExitHandler"));this.kb.YQe(Object(F.a)(this,
this.Ggb,"onBrowserEventHandler"));Id.a.removeHandler(this.pe,ta.a.mq,Object(F.a)(this,this.Pgb,"onMouseOverHandler"));Id.a.removeHandler(this.pe,ta.a.Ns,Object(F.a)(this,this.ikc,"onMouseOutHandler"));Id.a.removeHandler(this.wEb,ta.a.click,Object(F.a)(this,this.mHb,"onPrevClickHandler"));Id.a.removeHandler(this.QDb,ta.a.click,Object(F.a)(this,this.hHb,"onNextClickHandler"));Id.a.removeHandler(this.gCb,ta.a.click,Object(F.a)(this,this.dHb,"onExitClickHandler"));this.Mva&&Id.a.removeHandler(this.Mva,
ta.a.click,Object(F.a)(this,this.f4g,"onLiveBroadcastHandler"));this.yfb&&Id.a.removeHandler(this.yfb,ta.a.click,Object(F.a)(this,this.vgd,"onTranscribeHandler"));this.oWa&&(Id.a.removeHandler(this.oWa,ta.a.click,Object(F.a)(this,this.iJa,"onFullscreenClickHandler")),Id.a.removeHandler(this.Ucb,ta.a.click,Object(F.a)(this,this.iJa,"onFullscreenClickHandler")),$removeHandler(this.mf,this.du.l_,this.pE),this.pE=null);this.Odc&&Id.a.removeHandler(this.Odc,ta.a.click,Object(F.a)(this,this.eHb,"onGridViewClickHandler"));
this.remove()}Ggb(){this.show()}Xjc(){const a=this.du.i9;this.oWa.style.display=a?mf.a.Gf:mf.a.Wk;this.Ucb.style.display=a?mf.a.Wk:mf.a.Gf}Pgb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.YL=!0}ikc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Hc.Kh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Ub&&!this.Ub.instance.dr&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.w2d()||(this.YL=!1);this.w2d()||this.kb.restoreFocus()}mHb(){xa.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.p1a(this.wEb.title);this.kb.prev();this.kb.restoreFocus()}hHb(){xa.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.p1a(this.QDb.title);this.kb.next();this.kb.restoreFocus()}dHb(){xa.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");
this.p1a(this.gCb.title);this.kb.exit()}iJa(){xa.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.kb.f2e()}f4g(){this.Ub&&this.Ub.instance&&(this.p1a(this.Mva.title),xa.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ub.instance.dr),this.Ub.instance.dr?(this.kb.pausePresentation(),this.Ub.instance.showCallout(this.Mva)):(this.Ub.instance.Trc(3,u.AFrameworkApplication.userSessionId,this.Nze,this.Xa.podSessionId,u.AFrameworkApplication.gh),this.Ub.instance.$ca=
!this.Hc.Kh,this.Hc.tvb&&!this.Hc.Kh&&(xa.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Hc.Kh=!0,this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,5,Date.now(),this.To),this.Hc.Kh=!1)),this.O4e())}i2e(a,b){this.p1a(this.yfb.title);const c=!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.dr,f=this.Hc.mUf&&5!==a&&!c;5!==a&&(this.Hc.Kh=!this.Hc.Kh);xa.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Hc.Kh);b&&(this.Hc.Kh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&Fz.Tog(this.kb,this.qe,this.Xa)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.kb.toggleTranscriberUIVisibility(null):this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,a,b,this.To))}vgd(a){this.i2e(3,a.target)}eHb(){xa.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.La(K.a.MMb,2,null)}kKf(){this.Mva||
(this.Mva=this.esa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.pe.insertBefore(this.Mva,this.gCb),Id.a.addHandler(this.Mva,ta.a.click,Object(F.a)(this,this.f4g,"onLiveBroadcastHandler")))}esa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=Ro.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Hc.Kh?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.qe.qk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=Ro.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Ub&&this.Ub.instance&&this.Ub.instance.dr?"Hover_40x40x32":"_40x40x32"),"prt2",this.qe.qk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.jye=a.children[0]),l;a=Ro.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.qe.qk("prt2.png"),null,null,!0,null);l.appendChild(a);
l.title=f;return l}p1a(a){ha.a.Wa(a)?xa.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.gDe.Leh(new Gx(a))}w2d(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.hVi}O4e(){this.Ub&&this.Ub.instance&&this.jye&&(this.jye.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Ub.instance.dr?"Hover_40x40x32":"_40x40x32"))}i4g(){this.kKf()}gkc(){this.O4e()}fkc(){this.Ub&&this.Ub.instance&&this.Ub.instance.$ca&&!this.Hc.Kh&&(xa.a.J(41682899,
830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.pk,u.AFrameworkApplication.gh,5,Date.now(),this.To));this.Ub.instance.$ca=!1;this.O4e()}ekc(){this.Ub&&this.Ub.instance&&(this.YL=!0,this.show(),this.kb.pausePresentation(),this.Ub.instance.showCallout(this.Mva))}g4g(){this.YL=this.w2d();this.YL||(window.clearTimeout(this.Rdc),this.Rdc=window.setTimeout(Object(F.a)(this,this.hide,"hide"),3E3))}}Object(m.a)(kD,
"SlideshowToolbar",null,[393,394]);class ku{constructor(a){this.wCb=this.J0=this.OFb=null;this.cCe="BelowSlide";this.Wcb=this.oxg=!1;this.udc=!0;this.d5c=-1;this.Pxg=this.hdc=this.zue=!1;this.gAe=this.eCe=this.gCe=this.fCe=null;this.la=a;u.AFrameworkApplication.fa.gf(Object(F.a)(this,this.Pm,"onFullAppSettingsReady"));a=xd.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.Hsg=a.Ring||"Unknown";this.etg=u.AFrameworkApplication.buildVersion||"Unknown";this.mGg=this.la.HJa||
"Unknown";this.TWg=a.Host||"Unknown";this.SWg=a.WACDatacenter||"Unknown";this.fUg=this.K7i();this.aic=this.N7i();this.WVg=this.PUc();this.mCb=ku.x5e;switch(this.la.axl){case "ByUIHostName":a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.eK);this.Wcb=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.Wcb=u.AFrameworkApplication.isEmbedded;break;default:this.Wcb=u.AFrameworkApplication.fa.ka("IsUIEmbedMode")}xa.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.mCb,this.cCe)}Pm(){this.OFb=this.getUserId();this.J0=u.AFrameworkApplication.fa.Ga("TenantId");this.wCb=this.la.hostAuthType||u.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown"}getUserId(){let a=u.AFrameworkApplication.fa.Ga("PptEditingUserId");ha.a.Wa(a)&&(a=u.AFrameworkApplication.fa.Ga("LoggableUserId"),xa.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",ha.a.Wa(a)));return a}get P3b(){return this.oxg}set P3b(a){xa.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
a);this.oxg=a}get Kh(){return this.la.hla&&this.P3b&&this.mCb&&!this.Wcb}set Kh(a){this.mCb!==a&&(this.mCb=a,ku.x5e=this.mCb)}get O3b(){return this.la.hla&&this.hdc}set O3b(a){this.hdc!==a&&(this.hdc=a)}get HUf(){return this.Pxg}get oUf(){return!this.Wcb}get zvb(){return this.zue}set zvb(a){this.zue!==a&&(this.zue=a)}get tvb(){return this.la.hla&&this.P3b&&this.la.hWj&&!this.Wcb}get mUf(){const a=ki.a.get("PPTLiveSubtitleEnabled");return this.la.hla&&this.la.mWj&&ha.a.Wa(a)&&!this.Wcb}get a0e(){if(!this.eCe){const b=
new Ka.a;var a=this.la.Hah;if(!ha.a.Wa(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.eCe=ku.Qvf(b)}return this.eCe}get $_e(){if(!this.gAe){const b=new Ka.a;var a=this.la.Hah;if(!ha.a.Wa(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.gAe=ku.Qvf(b)}return this.gAe}get DNb(){this.fCe||(this.fCe=ha.a.Wa(this.la.Iah)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.Iah,!0));return this.fCe}get LZe(){this.gCe||(this.gCe=ku.fdi(this.DNb));
return this.gCe}C5k(){this.d5c=this.mCb?1:0}V2k(){-1!==this.d5c&&(this.Kh=1===this.d5c?!0:!1,this.d5c=-1)}K7i(){try{const a=Ya.a.xe(u.AFrameworkApplication.lcid);if(!a)return xa.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.a0e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.$_e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
this.hdc=!0;return"en-us"}catch(a){xa.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}this.hdc=!0;return"en-us"}N7i(){try{const a=Ya.a.xe(u.AFrameworkApplication.lcid);if(!a||ha.a.Wa(a.name))return xa.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),
"en";const b=a.name.toLowerCase();if(!ha.a.Wa(b)&&this.DNb[b])return b;const c=Ya.a.xe(a.languageId);if(!c||ha.a.Wa(c.name))return xa.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en";let f=c.name.toLowerCase();this.DNb[f]||(xa.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,f,u.AFrameworkApplication.lcid),f="en");return f}catch(a){xa.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}return"en"}PUc(){try{if(ha.a.Wa(this.aic))return xa.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",u.AFrameworkApplication.lcid),"en-us";const a=this.DNb[this.aic.toLowerCase()];
if(!ha.a.Wa(a))return a}catch(a){xa.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.aic,u.AFrameworkApplication.lcid,a)}return"en-us"}h5i(a){if(ha.a.Wa(a))return xa.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return xa.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.DNb;var f=this.LZe;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;xa.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get Toa(){return this.fUg}set Toa(a){this.fUg=a;this.Pxg=!0}get userId(){return this.OFb}set userId(a){this.OFb=a}get locale(){return this.mGg}set locale(a){this.mGg=a}get audienceGroup(){return this.Hsg}set audienceGroup(a){this.Hsg=
a}get buildVersion(){return this.etg}set buildVersion(a){this.etg=a}get identityProvider(){return this.wCb}set identityProvider(a){this.wCb=a}get wacHost(){return this.TWg}set wacHost(a){this.TWg=a}get wacDatacenter(){return this.SWg}set wacDatacenter(a){this.SWg=a}get tenantId(){return this.J0}set tenantId(a){this.J0=a}get xza(){return this.aic}set xza(a){this.aic=a}get ylb(){return this.WVg}set ylb(a){this.WVg=a}get Tv(){return this.cCe}set Tv(a){this.cCe=a}get Drl(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.Tv;a.SpeechLanguage=this.Toa;a.TranslationLanguages=this.ylb;a.FUseSubtitles=this.Kh;return JSON.stringify(a)}get BDa(){return this.udc}set BDa(a){this.udc=a}get $Ui(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.xza)}static get x5e(){const a=
ki.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set x5e(a){ki.a.$J("PPTLiveSubtitleEnabled",a.toString(),ki.a.DJ)||xa.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static Qvf(a){const b={},c=new Ka.a;for(let f of a)try{const l=Ya.a.xe(f).displayName;c.add(l);b[l]=f}catch(l){xa.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));
a=new Ka.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static fdi(a){const b=pa.a.lL(a);a={};const c=new Ka.a;for(var f of b)try{const l=Ya.a.xe(f).displayName;ha.a.Wa(l)?xa.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",f,u.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){xa.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
f,l)}c.Sc((l,x)=>l.localeCompare(x));f=new Ka.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(m.a)(ku,"SubtitleContext",null,[324]);const lD=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=ZJ(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=ZJ(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},ZJ=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class $J{constructor(a){this.Po=a}uji(){return lD()}tji(){let a=!1;const b=this.uji();if(b&&!this.Po.bO(1))try{const c=document.createElement("canvas"),
f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}xa.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.Po.Sy,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(m.a)($J,"WebGLHelperProxy",null,[323]);var aK=d(644),GQ=d(727);class mD{constructor(){this.la=this.rb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Zb(a){this.K=
a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.rb=b.FF();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(322,"PowerPointWebEditor.IFullscreenHelper").ma().oa(()=>new QJ);this.K.register(323,"PowerPointWebEditor.IWebGLHelper").ma().oa(()=>new $J(this.K.resolve("Common.IBrowserUtils")));this.K.register(324,"PowerPointWebEditor.ISubtitleContext").ma().oa(()=>new ku(this.la));this.K.register(325,"PowerPointWebEditor.IRehearsalContext").ma().oa(()=>
new Ez);this.qbc({["Type"]:"CheckBrowserStart"});a={};var c=this.$Jj(a);const f=lD()&&this.la.$Ua&&c&&this.ZJj(),l=this.la.$Ua&&this.YJj(),x=!f&&l;this.qbc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:x});if(this.la.ka("DefaultToModernSlideShow")&&(f||l)){this.K.register(326,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new GQ.SlideShowCoreFrame(this.rb,this.la,
this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw,this.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ja("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),x,this.K.resolve("PowerPoint.IPathManager"),this.K.Ja("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,u.AFrameworkApplication.Ke));const ya={};ya.loadScriptStart=Date.now();a=eD.a.create(u.AFrameworkApplication.Aj("powerpoint-slideshow-strings",3));cl.a.ey(a);Promise.all([new Promise((Va,hb)=>{const yb=document.createElement("script");yb.async=!1;yb.src=u.AFrameworkApplication.Aj(String.format("slideshowcore{0}.js",".min"),5);yb.addEventListener("load",()=>{xa.a.J(509636759,830,50,"Loaded slideshowcore");Va(yb)});yb.addEventListener("error",
()=>{xa.a.J(509636758,830,50,"Failed to load slideshowcore");hb(yb)});document.head.appendChild(yb)}),new Promise((Va,hb)=>{const yb=document.createElement("script");yb.async=!1;yb.src=u.AFrameworkApplication.Aj(String.format("podsproxy{0}.js",".min"),5);yb.addEventListener("load",()=>{xa.a.J(509636757,830,50,"Loaded podsproxy");Va(yb)});yb.addEventListener("error",()=>{xa.a.J(509636756,830,50,"Failed to load podsproxy");hb(yb)});document.head.appendChild(yb)}),new Promise((Va,hb)=>{const yb=document.createElement("script");
yb.async=!1;yb.src=u.AFrameworkApplication.Aj(String.format("pptspeechclient{0}.js",".min"),5);yb.addEventListener("load",()=>{xa.a.J(509636755,830,50,"Loaded pptspeechclient");Va(yb)});yb.addEventListener("error",()=>{xa.a.J(509636754,830,50,"Failed to load pptspeechclient");hb(yb)});document.head.appendChild(yb)})]).then(()=>{ya.loadScriptEnd=Date.now();const Va={Type:"LoadedJS"};pa.a.forEach(ya,(hb,yb)=>{Va[hb]=yb},null);this.qbc(Va);this.K.resolve("PowerPointWebEditor.ISlideshowManager").zxg||
(xa.a.J(509636753,830,50,"Initializing SlideShowCoreFrame on package registration"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(u.AFrameworkApplication.buildVersion,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").pk,u.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.K.resolve("PowerPointWebEditor.ISlideshowManager").Bbl());return null}).catch(Va=>
{this.qbc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});xa.a.J(512309318,830,10,"LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Va)})}else this.la.ka("DefaultToModernSlideShow")?this.qbc({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):xa.a.J(512309319,830,50,"PptDefaultToModernSlideShow is disabled"),this.K.register(326,"PowerPointWebEditor.ISlideshowFrame").ma().oa(()=>new FQ.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.rb,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ja("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw));this.K.register(hD,"PowerPointWebEditor.SlideShowFooterContainer").oa(()=>new hD(this.rb,u.AFrameworkApplication.Ta));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").wb();
let H;if(!this.la.f$b||this.la.Sah)this.K.register(kD,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new kD(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ja("PowerPointLive.ILivePresenter"),this.rb,()=>u.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=gx.a(this.K);c=new Ka.a;c.add(a("slideshowToolbar"));this.la.BHk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Va=>xa.a.J(50907106,830,10,"Failed to load the resources for the slideshowToolbar feature: {0}",Va)).then(()=>this.iyk()).catch(Va=>xa.a.J(50907136,830,10,"Failed to load the React slideshowToolbar: {0}",Va));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Va=>
xa.a.J(51218050,830,10,"Failed to load the resources for the ink button feature: {0}",Va)).then(()=>this.luk()).catch(Va=>xa.a.J(51218052,830,10,"Failed to load the React ink button: {0}",Va)),this.K.register(327,"PowerPointWebEditor.IInkButtonHelper").ma().oa(()=>new RJ));if(this.la.pptEditorVoiceUXEnabled){const Va=this;a("voiceUI").catch(hb=>xa.a.J(595198419,830,10,"Failed to load the resources for the voice UI feature: {0}",hb)).then(()=>Va.jyk()).catch(hb=>xa.a.J(595198417,830,10,"Failed to load the voice UI script: {0}",
hb));this.K.register(328,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().oa(()=>new XJ)}const ya=this;this.K.register(gD,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().oa(()=>new gD(u.AFrameworkApplication.Ta,ya.la,ya.K.resolve("PowerPointWebEditor.ISlideshowFrame"),ya.K.resolve("PowerPoint.IPathManager"),ya.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),ya.K.Ja("PowerPointLive.ILivePresenter"),ya.rb,()=>u.AFrameworkApplication.isRtl,
ya.la.podsWebServiceBase,ya.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ya.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}H=this.K.Ja("PowerPointWebEditor.ISlideshowToolbar");const U=this;this.K.register(jD,"PowerPointWebEditor.SlideshowContextMenu").oa(()=>new jD(U.K.resolve("PowerPointWebEditor.ISlideshowFrame"),U.K.resolve("PowerPointWebEditor.IPresentationReader"),U.K.resolve("PowerPointWebEditor.IInputHandlerManager"),u.AFrameworkApplication.Ta,U.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
U.rb,()=>u.AFrameworkApplication.isRtl,U.K.resolve("PowerPointWebEditor.IFullscreenHelper"),U.K.Ja("PowerPointLive.ILivePresenter")));const ja=this;this.K.register(329,"PowerPointWebEditor.ISlideshowManager").ma().oa(()=>new YJ(ja.K.resolve("PowerPointWebEditor.IFullscreenHelper"),ja.K.resolve("PowerPointWebEditor.ISlideshowFrame"),H,ja.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),ja.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.AFrameworkApplication.Ke,ja.la,b,ja.K.resolve("PowerPointWebEditor.IPresentationReader"),
ja.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ja.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ja.K.resolve("PowerPointWebEditor.IErrorHandler"),Db.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ja.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),Pq.a.$u(Db.a.instance.Ja("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.Ta,Db.a.instance.Ja("PowerPointLive.ILivePresenter"),ja.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),
ja.K.Ja("PowerPointWebEditor.ISlideShowVoiceNotification")))}qbc(a){xa.a.J(594583632,830,15,JSON.stringify(a))}ZJj(){const a=this.la.Ga("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ga("SessionStartInfoJson").toString());xa.a.J(512309317,830,50,"IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||
"",10)<parseInt(c.split(":")[1],10))return xa.a.J(512309316,830,50,"IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}YJj(){const a=this.la.Ga("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ga("SessionStartInfoJson").toString());xa.a.J(512309315,830,50,"IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&
parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return xa.a.J(512309314,830,50,"IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}$Jj(a){return aK.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").gf(Object(F.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){gb.a.get_instance().ek(10,null).continueWith(()=>{if(!this.la.HQ&&this.la.Oah&&this.la.UIk)try{Pq.a.$u(Db.a.instance.Ja("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen",
"PresentTeachingUIEnabled")}),xa.a.J(512495957,830,50,"Present Teaching UI triggered")}catch(a){xa.a.J(512495956,830,10,"Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}iyk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}luk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}jyk(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){z.a.instance.Dc(new mD)}}Object(m.a)(mD,"PPTWebEditorSlideShowPackage",
null,[2,3]);var HQ=d(776);class bK{constructor(){this.Tcc=null}zkl(a,b){mj.UISurfaces.mL().then(c=>{this.Tcc=a.mNi(c,a.vFi(b),b,this.Tcc)});xa.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}yWk(a){mj.UISurfaces.mL().then(b=>{this.Tcc=a.nWk(b,this.Tcc)});xa.a.J(523871965,843,50,"{0} Toast is removed",this.Tcc)}}Object(m.a)(bK,"DeferredNotificationCalloutVisibilityManager",null,[]);var cK=d(1024);const IQ=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=
a;a={};a.telemetryGroup=b;return a},JQ=(a,b,c,f)=>{const l=new jj.StandardDialog;l.xd=0;if(u.AFrameworkApplication.TE){const x=IQ(b);l.uOd(ResourceStrings.L_GiveFeedback,void 0,void 0,x)}l.Gx(c,f,0,a?x=>{1===x?(xa.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):xa.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class nD{constructor(a,b,c,f,l,x,H){this.H9={};this.xwa=new Rd.a;this.P9c=this.hAe=null;this.q8c=this.vye=0;this.qxg=!1;this.c8j=Ud.a("PartialDoc.SkipCheckGraphForPresentationDeferred");
this.ead={};if(!H)throw Error.argumentNull("coreEventSource");this.iM=a;this.Gq=c;this.iM.jk(Object(F.a)(this,this.Q5g,"onShapeNodePropertyChanged"));this.iM.Bia(Object(F.a)(this,this.wkc,"onShapeNodeLoaded"));this.iM.zia(Object(F.a)(this,this.P5g,"onShapeNodeConnected"));this.Nug=new bK;this.Og=l;b.ePd(Object(F.a)(this,this.VGe,"onClientError"));b.CPd(Object(F.a)(this,this.GIe,"onServerError"));u.AFrameworkApplication.rGc(Object(F.a)(this,this.sHe,"onErrorDialogDisplayed"));this.awg=f;this.Ula=x;
this.ai=H;this.ai.fC(Object(F.a)(this,this.E5g,"onSessionRehydratedHandler"))}Htf(a,b){this.xwa.Hb(a)||this.xwa.$(a,new Na.a);const c=this.xwa.ga(a);c.add(b);this.xwa.$(a,c)}shh(a,b){if(this.xwa.Hb(a)){var c=this.xwa.ga(a);c.remove(b);this.xwa.$(a,c);this.Nbe(a)||this.xwa.remove(a);tq.a(this.H9).length||xa.a.J(520927263,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else xa.a.J(524321747,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",
a,b)}Nbe(a){return this.xwa.Hb(a)&&0<this.xwa.ga(a).count}kEf(a){if(a.slideId&&a.slideId.sid&&a.a2c){var b=a.a2c;a.X3?(this.qxg||(this.qxg=!0,xa.a.J(555836314,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Ula)),b in this.H9||(this.H9[b]=new Date),this.Htf(a.slideId.sid.toString(),b)):b in this.H9&&(delete this.H9[b],this.shh(a.slideId.sid.toString(),b),xa.a.J(520927262,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}wkc(a,
b){(a=Object(oa.a)(4,b.node))?this.kEf(a):xa.a.J(557126034,843,10,"IDeferrable object is null")}P5g(a,b){(a=Object(oa.a)(4,b.node))?this.kEf(a):xa.a.J(557126035,843,10,"IDeferrable object is null")}Q5g(a,b){var c=Object(oa.a)(4,b.node);if(!c)xa.a.J(557126873,843,10,"IDeferrable object is null");else if((b.property===kb.a.X3||this.Ula&&c.a2c in this.H9&&!c.X3)&&c.slideId)if(b=c.a2c,a=c.slideId.sid.toString(),c.X3)b in this.H9?xa.a.J(557164308,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",
b,this.Ula):(xa.a.J(527720478,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.Ula),this.H9[b]=new Date,this.Htf(a,b));else{if(c=this.H9[b])c=(new Date).getTime()-c.getTime(),xa.a.J(557164309,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Ula),delete this.H9[b],this.shh(a,b),this.q8c=c>this.q8c?c:this.q8c;this.awg&&!this.hasDeferredContent()&&(xa.a.J(520471008,843,50,"All deferred blobs loaded"),this.qra("AllDeferredBlobsLoaded","true"),this.P9c&&
(xa.a.J(520471007,843,50,"Previously called user requested actions triggered"),this.qra("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.P9c(),this.Nug.yWk(this.hAe),this.hAe=this.P9c=null))}}E5g(){xa.a.J(520722338,843,50,"Session rehydrated with {0} currently deferred blobs",tq.a(this.H9).length)}lYe(a,b,c){this.awg?(this.hAe=b,this.P9c=c,this.Nug.zkl(b,this.Og)):(c=Object(Xa.a)(cK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,
b=Object(Xa.a)(cK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,JQ(null,a.toString(),c,b));xa.a.J(526989469,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}qra(a,b){this.ead[a]&&xa.a.J(522269249,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.ead[a]);this.ead[a]=b}VGe(a,b){this.Xna("ClientError",b)}GIe(a,b){this.Xna("ServerError",b)}sHe(a,b){(a=Object(oa.a)(HQ.a,b))&&
this.Xna("Crash",a.errorCode)}Xna(a,b){this.hasDeferredContent()&&xa.a.J(556364418,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.Ula)}dispose(){this.iM.Cm(Object(F.a)(this,this.Q5g,"onShapeNodePropertyChanged"));this.iM.k_a(Object(F.a)(this,this.wkc,"onShapeNodeLoaded"));this.iM.joa(Object(F.a)(this,this.P5g,"onShapeNodeConnected"));this.ai.Sfa(Object(F.a)(this,this.E5g,"onSessionRehydratedHandler"));this.log()}hasDeferredContent(){const a=
tq.a(this.H9),b=(!this.c8j||this.Ula)&&0<a.length||0<this.Gq.R7a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.Gq.R7a.toString();c.FForceShowDeferralUI=this.Ula.toString();xa.a.J(521175389,843,50,JSON.stringify(c));this.vye=Math.max(this.Gq.R7a,this.vye)}return b}Cxj(a){return cb.a.any(a,b=>b.hasDeferredContent)?(xa.a.J(556312344,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Ula),!0):!1}Mbe(a,b){return cb.a.any(a,
c=>c.X3)?(xa.a.J(556312348,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Ula),!0):!1}log(){const a=tq.a(this.H9),b={};b.MaxDeferredTime=this.q8c.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.vye.toString();b.FForceShowDeferralUI=this.Ula.toString();xa.a.J(556364419,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.ead))}}Object(m.a)(nD,"DeferredContentManager",null,[356]);class oD{constructor(){this.yw=
this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Zb(a){this.K=a;this.K.register(nD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().oa(()=>new nD(this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),0<this.K.resolve("Common.IAppSettingsManager").Bc("ForceShowDeferralUIMS",
0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.yw=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.yw&&this.yw.dispose()}static main(){z.a.instance.Dc(new oD)}}Object(m.a)(oD,"PPTWebEditorPartialDocPackage",null,[2,3]);class Av{constructor(a,b){this.shapeNode=a;this.position=b}}Object(m.a)(Av,"MoveShapeData",null,[]);class dK{constructor(a,b){this.BO=null;this.pp=a;this.ia=b}start(){this.BO=[];for(let a=0;a<this.pp.length;++a)Array.add(this.BO,
new hd.a(this.pp[a].x,this.pp[a].y)),this.pp[a].SD(!1)}VTd(a,b){if(1!==a||this.pp.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.lMj(b[a]))return!1;return!0}lMj(a){for(let b=0;b<this.pp.length;b++)if(a.gb.equals(this.pp[b].gb))return!0;return!1}perform(a){for(let c=0;c<this.pp.length;c++){var b=new hd.a(this.pp[c].x,this.pp[c].y);b=hd.a.add(b,a);this.pp[c].setPosition(b.x,b.y,!0)}}end(){this.BO&&xa.a.J(17597603,815,50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",
this.pp.length,this.pp[0].x-this.BO[0].x,this.pp[0].y-this.BO[0].y);const a=[];for(let b=0;b<this.pp.length;++b){const c=this.pp[b].HRc();Array.add(a,new Av(this.pp[b].shapeNode,c));this.pp[b].Uz(!1)}this.ia.La(K.a.RIa,2,a)}}Object(m.a)(dK,"ShapeMoveAction",null,[1034]);class Gz{constructor(a,b,c=null,f=null){this.B1=a;this.l1=b;this.N2b=c;this.wZg=f}}Object(m.a)(Gz,"ResizeShapeData",null,[]);class eK{constructor(a,b){this.iGa=this.ABb=this.UBe=null;this.cG=a;this.ia=b}start(){this.UBe=[];this.ABb=
[];this.iGa=[];for(const c of this.cG){c.BL=!0;c.SD(!1);Array.add(this.UBe,c.SYa);Array.add(this.ABb,new Oi.a);var a=c.lwb(),b=hd.a.nm(a.rk(te.a.Qu),a.rk(te.a.DE));a=hd.a.nm(a.rk(te.a.Qu),a.rk(te.a.PH));Array.add(this.iGa,a?b/a:1);c.shapeNode.Jf&&c.shapeNode.isEditable&&(b=c,b.Ok&&(b.Ok.visible=!0))}}VTd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].Al||!b[a].gb.equals(this.cG[a].gb))return!1;return!0}perform(a,b){for(let f=0;f<this.cG.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.fDl(c,
l,f));let x;(x=this.ABb[f]).right=x.right+c;let H;(H=this.ABb[f]).bottom=H.bottom+l;this.cG[f].setOffsets(Oi.a.add(this.UBe[f],this.ABb[f]),!0);this.cG[f].shapeNode.Jf&&this.cG[f].shapeNode.isEditable&&(c=this.cG[f],c.rce(),c.kWc())}}fDl(a,b,c){if(!this.cG[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.iGa[c]:b=a/this.iGa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.cG.length;b++)this.cG[b].Al||(this.cG[b].shapeNode.Jf&&this.cG[b].shapeNode.isEditable||(this.cG[b].BL=
!1),this.cG[b].Uz(!1),Array.add(a,new Gz(this.cG[b].shapeNode,this.ABb[b])));this.ia.La(K.a.Sib,2,a);this.cG=null}}Object(m.a)(eK,"ShapeResizeAction",null,[1034]);class Yo{constructor(a,b){this.shapeNode=a;this.OZd=b%Yo.Lkc}}Yo.Lkc=360;Object(m.a)(Yo,"ShapeRotateData",null,[]);class fK{constructor(a,b){this.Itg=null;this.bpe=0;this.Yd=a;this.ia=b}start(){this.Yd.SD(!1);this.Itg=this.Yd.lwb().Wf()}VTd(a,b){return 3===a&&!this.Yd.Al&&this.Yd.gb.equals(b[0].gb)}perform(a){this.bpe=(this.Yd.rotation+
a)%Yo.Lkc;this.Yd.setRotation(this.bpe,this.Itg)}end(){if(!this.Yd.Al){this.Yd.Uz(!1);var a=new Yo(this.Yd.shapeNode,this.bpe);this.ia.La(K.a.fpc,2,a)}}}Object(m.a)(fK,"ShapeRotateAction",null,[1034]);class sp{constructor(a){this.EIa=this.SQ=null;this.ia=a}uuc(){this.EIa&&Tc.a.otb(this.EIa);this.EIa=Tc.a.Faa(Object(F.a)(this,this.xRf,"endAction"),sp.xni)}m1d(a,b){this.SQ&&!this.SQ.VTd(a,b)&&(this.SQ.end(),this.SQ=null);if(!this.SQ){this.SQ=this.r2i(a,b);if(!this.SQ)throw Error.invalidOperation("Could not create keyboard action");
this.SQ.start()}this.uuc();return this.SQ}xRf(){this.SQ&&(this.SQ.end(),this.SQ=null);this.EIa=null}move(a,b){a=this.m1d(1,a);b=this.AOf(b);a.perform(b)}resize(a,b){a=this.m1d(2,a);b=this.AOf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.m1d(3,a);c=c?sp.mni:sp.lni;a.perform(b?c:-1*c)}AOf(a){let b=0,c=0;a.equals(te.a.north)?c=-1*sp.EIc:a.equals(te.a.east)?b=sp.EIc:a.equals(te.a.south)?c=sp.EIc:a.equals(te.a.west)&&(b=-1*sp.EIc);return new hd.a(b,c)}r2i(a,b){return b?1===a?new dK(b,this.ia):2===a?new eK(b,
this.ia):3===a&&(1<b.length&&xa.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new fK(b[0],this.ia):null:null}}sp.xni=1E3;sp.EIc=1;sp.lni=15;sp.mni=1;Object(m.a)(sp,"ShapeKeyboardDragManager",null,[1002]);var Kg=d(155),Ss=d(514);const un=a=>{a&&Tc.a.Ib&&(Tc.a.Ib.L9f=a.Jf,Tc.a.Ib.ezh=a.Ng)};var yq=d(248),gK=d(498),Ix=d(327);class pD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,
Zb,fc,Kc,Lc,Gc,ae,we){if(!Kc)throw Error.argumentNull("ISessionInfoOwner is null");if(!Lc)throw Error.argumentNull("IPPTUnitConversion is null");if(!Gc)throw Error.argumentNull("IZoomContext is null");fc||xa.a.J(509650844,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.hf=b;this.jq=c;this.Ea=f;this.ob=l;this.jad=x;this.Jb=H;this.Fb=U;this.Fa=ja;this.he=ya;this.Es=yb;this.kA=Va;this.J$c=hb;this.Ha=Zb;this.ffc=new Ma.ScriptSharpLegacyMap;this.uYa=fc;this.Xa=Kc;this.Pi=
Lc;this.fj=Gc;this.Bi=ae;this.vva=we}wb(){this.ia.ra(K.a.c7a,rc.a.application,Object(F.a)(this,this.Erj,"handleDeleteSelectedShapes"),4);this.ia.ra(K.a.j2b,rc.a.application,Object(F.a)(this,this.Frj,"handleDeleteShapes"),4);this.ia.ra(K.a.RIa,rc.a.application,Object(F.a)(this,this.Atj,"handleMoveShapes"),4);this.ia.ra(K.a.Sib,rc.a.application,Object(F.a)(this,this.Ivj,"handleResizeShapes"),4);this.ia.ra(K.a.fpc,rc.a.application,Object(F.a)(this,this.tbe,"handleRotateShape"),4);this.ia.ra(K.a.amh,
rc.a.application,Object(F.a)(this,this.ube,"handleRotateShapes"),4);this.ia.ra(K.a.Zlh,rc.a.application,Object(F.a)(this,this.hag,"handleRotateShapeAnchor"),4);this.ia.ra(K.a.$lh,rc.a.application,Object(F.a)(this,this.hag,"handleRotateShapeAnchor"),4);this.ia.ra(K.a.yaa,rc.a.application,Object(F.a)(this,this.iag,"handleRotateShapeByDirection"),4);this.ia.ra(K.a.aTe,rc.a.application,Object(F.a)(this,this.iag,"handleRotateShapeByDirection"),4);Ud.a("FlipInMultiSelectEnabledV2")?(this.ia.ra(K.a.hpc,
rc.a.application,Object(F.a)(this,this.o$f,"handleFlipShape"),4),this.ia.ra(K.a.gpc,rc.a.application,Object(F.a)(this,this.o$f,"handleFlipShape"),4)):(this.ia.ra(K.a.hpc,rc.a.application,Object(F.a)(this,this.p$f,"handleFlipShapeForSingleSelection"),4),this.ia.ra(K.a.gpc,rc.a.application,Object(F.a)(this,this.p$f,"handleFlipShapeForSingleSelection"),4));this.ia.ra(K.a.o7a,rc.a.application,Object(F.a)(this,this.lrj,"handleCommitKeyboardShapeManipulation"),4);this.ia.ra(K.a.bjc,Cb.a.view,Object(F.a)(this,
this.vVc,"handleMoveShapesKeyboard"),4);this.ia.ra(K.a.cjc,Cb.a.view,Object(F.a)(this,this.vVc,"handleMoveShapesKeyboard"),4);this.ia.ra(K.a.djc,Cb.a.view,Object(F.a)(this,this.vVc,"handleMoveShapesKeyboard"),4);this.ia.ra(K.a.ejc,Cb.a.view,Object(F.a)(this,this.vVc,"handleMoveShapesKeyboard"),4);this.ia.ra(K.a.Qoc,Cb.a.view,Object(F.a)(this,this.DVc,"handleResizeShapesKeyboard"),4);this.ia.ra(K.a.Roc,Cb.a.view,Object(F.a)(this,this.DVc,"handleResizeShapesKeyboard"),4);this.ia.ra(K.a.Soc,Cb.a.view,
Object(F.a)(this,this.DVc,"handleResizeShapesKeyboard"),4);this.ia.ra(K.a.Toc,Cb.a.view,Object(F.a)(this,this.DVc,"handleResizeShapesKeyboard"),4);this.ia.ra(K.a.ZSe,Cb.a.view,Object(F.a)(this,this.EVc,"handleRotateShapeKeyboard"),4);this.ia.ra(K.a.Emd,Cb.a.view,Object(F.a)(this,this.EVc,"handleRotateShapeKeyboard"),4);this.ia.ra(K.a.Dmd,Cb.a.view,Object(F.a)(this,this.EVc,"handleRotateShapeKeyboard"),4);this.ia.ra(K.a.ipc,Cb.a.view,Object(F.a)(this,this.EVc,"handleRotateShapeKeyboard"),4);this.ia.ra(K.a.aOe,
rc.a.application,Object(F.a)(this,this.gbe,"handleIsDirectManipulationEnabled"),97);this.ia.ra(K.a.aMe,rc.a.application,Object(F.a)(this,this.X$f,"handlePreviewRotate"),4);this.ia.ra(K.a.bMe,rc.a.application,Object(F.a)(this,this.X$f,"handlePreviewRotate"),4);this.ia.ra(K.a.RSe,rc.a.application,Object(F.a)(this,this.Lvj,"handleRevertPreviewRotate"),4)}Ee(){const a=this.Ea.Fc(zb.a.sg);a.bindAction(y.KeyInputManager.Oa(A.a.K6,4),K.a.Qoc);a.bindAction(y.KeyInputManager.Oa(A.a.dba,4),K.a.Roc);a.bindAction(y.KeyInputManager.Oa(A.a.Mga,
4),K.a.Soc);a.bindAction(y.KeyInputManager.Oa(A.a.cZ,4),K.a.Toc);a.bindAction(y.KeyInputManager.Oa(A.a.dba,5),K.a.Dmd);a.bindAction(y.KeyInputManager.Oa(A.a.Mga,5),K.a.ipc);a.bindAction(y.KeyInputManager.Oa(A.a.dba,1),K.a.ZSe);a.bindAction(y.KeyInputManager.Oa(A.a.Mga,1),K.a.Emd);a.bindAction(y.KeyInputManager.Oa(A.a.ppa,0),K.a.c7a);a.bindAction(y.KeyInputManager.Oa(A.a.TH,0),K.a.c7a);this.Ea.Fc(zb.a.gj).bindAction(y.KeyInputManager.Oa(A.a.dba,1),G.a.ve)}Atj(a,b,c,f,l){if(!l||!Object(Xa.a)(Array,
l)||1>l.length)return 8;for(const H of l)if(b=H.shapeNode,this.SRa(b),b.get_smartArtModelId()&&(b=this.Fa.yr(b)),!this.XCf(b)||this.hf.$c(H.shapeNode))return 16;if(1===c)return 32;if(Tc.a.Ib){Tc.a.Ib.Nj=!0;for(var x of l)if((c=x.shapeNode)&&(c.Jf||c.Ng)){un(c);break}}x=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{x.nc(l[0].shapeNode);x.jd=a;const H=this.Fb.Ld;for(const U of l){const ja=new hd.a(H.rf(U.position.x,0),H.rf(U.position.y,1));mq.c(U.shapeNode.get_smartArtModelId()?this.Fa.yr(U.shapeNode):
U.shapeNode,ja.x,ja.y)}}finally{x&&x.dispose()}return 32}Ivj(a,b,c,f,l){if(!l||!Object(Xa.a)(Array,l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.v_b(l[b].B1))return xa.a.J(509650842,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].B1.get_shapeId()),16;if(this.hf.$c(l[b].B1))return 16}if(1===c)return 32;if(Tc.a.Ib){Tc.a.Ib.Nj=!0;for(var x of l)if((c=x.B1)&&(c.Jf||c.Ng)){un(c);break}}x=this.Jb.Ad(15,void 0,()=>{this.ob.ij();
const H=this.Ea.Ae;!H||H.name!==zb.a.sg&&H.name!==zb.a.Az||this.Ea.Ed()});try{for(x.nc(l[0].B1),x.jd=a,a=0;a<l.length;a++)l[a].B1.Jsh=l[a].l1}finally{x&&x.dispose()}if(this.ob.FL()&&(a=this.ob.rEa(),(a=this.$k(a))&&Object(Xa.a)(Ss.a,a.Ok)&&Object(oa.a)(Ss.a,a.Ok).clearChildSelection(),this.uYa&&this.Ha.hol))for(const H of l)this.j8k(H);return 32}j8k(a){const b=a.B1;if(b&&b.Rf&&!b.Ng){var c=Tc.a.Ib?Tc.a.Ib.actionId:Ug.a.create().toString(),f=u.AFrameworkApplication.userSessionId,l=this.Xa.podSessionId,
x=this.$nl,H=this.vkb,U=H/x,ja=Rf.a.tY(this.Pi.DM(a.l1.left,U),0),ya=Rf.a.tY(this.Pi.DM(a.l1.top,U),1),Va=Rf.a.tY(this.Pi.DM(a.l1.right,U),0);a=Rf.a.tY(this.Pi.DM(a.l1.bottom,U),1);U=Math.abs(b.get_widthPersisted()+Va-ja);var hb=Math.abs(b.get_heightPersisted()+a-ya);Va=Ke.o(b.slideCid,b.slideSid);a=Ke.b(b.get_shapeId(),null);var yb=Ke.f(Va,a);ja=Ke.m((b.get_xPersisted()+ja).toString(),(b.get_yPersisted()+ya).toString());ja=Ke.n(U,hb,ja);ja=Ke.c(yb,ja);ya=null;this.Bi&&this.Bi.highContrastColors&&
(ya=Ke.k(Ke.j(this.Bi.highContrastColors.foregroundTextColor),Ke.j(this.Bi.highContrastColors.backgroundColor),Ke.j(this.Bi.highContrastColors.linkColor)));f=Ke.d(Va,a,1,b.ih,0,0,c,f,this.Bi.isInHighContrastMode,ya,this.Ha.Loh&&this.vva?this.vva.abj():null);l=Ke.e(f,[],l);l.editOps.push(ja);l=Ke.q(null,l,null,null,this.Xa.pk);f=Tc.a.$Y();Tc.a.Ib&&f&&(Tc.a.Ib.Va("editOpCorrelationId",c),Tc.a.Ib.Va("editOpRequestStartTick",f.toString()));this.uYa.Lx(l);xa.a.J(509650841,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",
c,b.slideSid,b.slideCid,b.get_shapeId(),x,H,this.Ha.Loh)}}get $nl(){let a=this.fj.KG;this.jq&&this.jq.Ba&&this.jq.Ba.Rw&&null!=this.jq.Ba.Rw.Zr&&(a=this.jq.Ba.Rw.Zr);a||(xa.a.J(509650840,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get vkb(){let a=1;if(this.jq&&this.jq.Ba){const b=Object(oa.a)(573,this.jq.Ba.mg(this.Fb.Ma));b?a=b.qT:xa.a.J(509650839,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else xa.a.J(509650838,
815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(xa.a.J(509650837,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}iag(a,b,c,f,l){return 1===c?32:Kg.a("Rotate",a,()=>{xa.a.J(509650836,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const x=this.ob.tg();if(!x)return xa.a.J(509650835,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.J$c&&1===x.length&&
this.SRa(x[0]);switch(a){case K.a.yaa:xa.a.J(509650834,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");if(Ud.a("FixUndoRotateMultipleShapes")){var H={};H.selectedNodes=x;H.rotateLeft=!0;this.ube(a,b,c,f,H)}else for(H of x)l=new Yo(H,Math.round(H.get_shapeRotation()+270)),this.tbe(a,b,c,f,l);break;case K.a.aTe:xa.a.J(509650833,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");if(Ud.a("FixUndoRotateMultipleShapes"))H={},H.selectedNodes=x,H.rotateRight=!0,
this.ube(a,b,c,f,H);else for(const U of x)l=new Yo(U,Math.round(U.get_shapeRotation()+90)),this.tbe(a,b,c,f,l);break;default:return 8}return 32})}ube(a,b,c,f,l){if(!l)return 8;b=l.selectedNodes;f=l.rotateData?l.rotateData:[];for(const x of b){const H=this.Ssb(x);if(1===c)return H?32:8;if(!H||this.hf.$c(x))return 16}if(l.rotateLeft||l.rotateRight)for(const x of b)Tc.a.Ib&&(Tc.a.Ib.Nj=!0,x&&(x.Jf||x.Ng)&&un(x)),c=new Yo(x,Math.round(x.get_shapeRotation()+(l.rotateLeft?270:90))),f.push(c);l=this.Jb.Ad(15,
void 0,()=>{this.ob.ij();const x=this.Ea.Ae;!x||x.name!==zb.a.sg&&x.name!==zb.a.Az||this.Ea.Ed()});try{for(l.nc(b[0]),l.jd=a,a=0;a<b.length;a++)b[a].set_shapeRotation(f[a].OZd)}finally{l&&l.dispose()}return 32}tbe(a,b,c,f,l){if(!l||!Object(Xa.a)(Yo,l))return 8;b=l.shapeNode;f=this.Ssb(b);if(1===c)return f?32:8;if(!f||this.hf.$c(b))return 16;Tc.a.Ib&&(Tc.a.Ib.Nj=!0,b&&(b.Jf||b.Ng)&&un(b));c=this.Jb.Ad(15,void 0,()=>{this.ob.ij();const x=this.Ea.Ae;!x||x.name!==zb.a.sg&&x.name!==zb.a.Az||this.Ea.Ed()});
try{c.nc(b),c.jd=a,b.set_shapeRotation(l.OZd)}finally{c&&c.dispose()}return 32}hag(){const a=this.ob.tg();return 0<a.length&&this.pTj(a)?32:8}X$f(a,b,c){return this.Ha.qmc?1===c?32:Kg.a("HandlePreviewRotate:",a,()=>{var f=this.ob.tg();for(const l of f){if(!l){xa.a.J(509650831,822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.ud)continue;this.ffc.Hb(l.get_shapeId())?this.ffc.$(l.get_shapeId(),l.get_shapeRotation()):this.ffc.add(l.get_shapeId(),l.get_shapeRotation());
f=this.$k(l);if(!f){xa.a.J(509650830,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const x=f.lwb().Wf();switch(a){case K.a.aMe:f.setRotation((l.get_shapeRotation()+270)%Yo.Lkc,x);break;case K.a.bMe:f.setRotation((l.get_shapeRotation()+90)%Yo.Lkc,x)}}return 32}):2}Lvj(a,b,c){if(!this.Ha.qmc)return 2;if(1===c)return 32;a=this.ob.tg();for(const f of a)if(!f)xa.a.J(509650829,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());
else if(!f.ud)if(a=this.$k(f))if(b=a.lwb().Wf(),this.ffc.Hb(f.get_shapeId()))a.setRotation(this.ffc.ga(f.get_shapeId()),b);else return xa.a.J(509650827,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",f.get_shapeId()),8;else xa.a.J(509650828,822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}Erj(a,b,c,f,l){b=this.ob.tg();if(1===b.length&&this.ob.Xz())return 16;f=1===b.length&&!!b[0]&&b[0].pab();
f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Tc.a.Ib){Tc.a.Ib.actionName="ClearPlaceholders";Tc.a.Ib.Nj=!0;for(const x of b)if(x.Jf||x.Ng){un(x);break}}if(this.ob.FL()&&Ud.a("EnableSmartArtSubShapeDeletion")&&this.cbe(b[0],a,l))return 32;c=null;if(l=this.Fa.D9a(b))Ud.a("SmartArtSubNodeEditing")?c=this.Fa.yr(l):(this.ob.Kld(l),b=this.ob.tg());return this.j2b(a,b,this.ob.tk(),c)?32:16}Frj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");
l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Tc.a.Ib&&(Tc.a.Ib.actionName="DeleteShapes",Tc.a.Ib.Nj=!0);return l.length&&this.j2b(a,l,Object(oa.a)(116,b.xC(l[0].slideId)))?32:16}j2b(a,b,c,f=null){if(!c||!b.length||this.hf.AC(b))return!1;let l=!1;for(var x of b)if(x.gFa){l=!0;break}x=this.Jb.Ad(15,void 0,()=>{this.ob.Qh()});try{f?x.kd(f):x.kd(c);x.jd=a;x.Vy[yq.a.Qxb]=l;for(const H of b)if(H&&H.Ng){const U=this.Fa.ys(H);if(U){const ja=Kj.c(U,this.Fb.Ma);
ja&&(ja.Ok.visible=!1)}}f?f.Vhh(b):c.LU(b)}finally{x&&x.dispose()}for(const H of b)this.Es.Aeh(new gK.a(H));return!0}p$f(a,b,c){b=this.ob.tg();const f=0<b.length?b[0]:null,l=1===b.length&&this.ZTd(f);if(1===c)return l?32:8;if(!l||this.hf.$c(f))return 16;this.SRa(f);for(const x of b)if(x.Jf||x.Ng){un(x);break}return Kg.a("Rotate",a,()=>{let x,H;switch(a){case K.a.gpc:H=f.get_isVerticallyFlipped();x=!f.get_isHorizontallyFlipped();break;case K.a.hpc:H=!f.get_isVerticallyFlipped();x=f.get_isHorizontallyFlipped();
break;default:return 8}const U=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{U.nc(f),U.jd=a,f.set_isVerticallyFlipped(H),f.set_isHorizontallyFlipped(x)}finally{U&&U.dispose()}return 32})}o$f(a,b,c){const f=this.ob.tg();b=!0;if(!f||f&&!f.length)b=!1;for(const H of f)if(b=this.ZTd(H),!b)break;if(1===c)return b?32:8;if(!b)return xa.a.J(509650822,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const H of f){if(this.hf.$c(H))return 16;
this.SRa(H)}for(const H of f)if(H.Jf||H.Ng){un(H);break}const l=a===K.a.gpc,x=a===K.a.hpc;return l||x?Kg.a("Rotate",a,()=>{const H=Array(f.length),U=Array(f.length);for(var ja=0;ja<f.length;ja++)U[ja]=!!(x^f[ja].get_isVerticallyFlipped()),H[ja]=!!(l^f[ja].get_isHorizontallyFlipped());ja=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{ja.nc(f[0]);ja.jd=a;for(let ya=0;ya<f.length;ya++)f[ya].set_isVerticallyFlipped(U[ya]),f[ya].set_isHorizontallyFlipped(H[ya])}finally{ja&&ja.dispose()}return 32}):
(xa.a.J(509650821,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}lrj(){this.jad.xRf();return 32}vVc(a,b,c){const f=Kj.b(b);if(!f)return 16;b=this.ob.tg();if(!b.length)return 16;let l=!0;const x=[];for(const H of b)if(H.get_smartArtModelId()){x.push(this.Fa.yr(H));break}else x.push(H);for(const H of x)if(!this.XCf(H)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=Kj.d(x,f.Ma);if(this.hf.AC(b))return 16;switch(a){case K.a.bjc:a=te.a.south;break;case K.a.cjc:a=te.a.west;
break;case K.a.djc:a=te.a.east;break;case K.a.ejc:a=te.a.north;break;default:return 8}this.jad.move(c,a);this.kA&&this.ob.FL()&&(a=this.ob.rEa(),this.he.jib(new Ix.a(a)));Tc.a.Ib&&(Tc.a.Ib.Nj=!0,Tc.a.Ib.sF=new Date);return 32}DVc(a,b,c){const f=Kj.b(b);b=this.ob.tg();const l=[];for(var x of b){if(x.get_smartArtModelId()){this.ob.Kld(x);Array.add(l,this.Fa.yr(x));break}!x.isResizable||x.SI||x.ud||Array.add(l,x)}x=Kj.d(l,f.Ma);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.hf.AC(l))return 16;
switch(a){case K.a.Qoc:a=te.a.south;break;case K.a.Roc:a=te.a.west;break;case K.a.Soc:a=te.a.east;break;case K.a.Toc:a=te.a.north;break;default:return 8}this.jad.resize(x,a);this.kA&&this.ob.FL()&&(a=this.ob.rEa(),this.he.jib(new Ix.a(a)));Tc.a.Ib&&(Tc.a.Ib.Nj=!0,Tc.a.Ib.sF=new Date);return 32}EVc(a,b,c){var f=this.ob.tg();const l=0<f.length?f[0]:null,x=1===f.length&&this.Ssb(l);if(1===c)return x?32:8;if(!x||this.hf.$c(l))return 16;b=Kj.b(b);f=Kj.d(f,b.Ma);c=a===K.a.Emd||a===K.a.ipc;a=a===K.a.Dmd||
a===K.a.ipc;0<f.length&&f[0].shapeNode.Jf&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.mg(b.Ma))&&b.kWc();this.jad.rotate(f,c,a);Tc.a.Ib&&(Tc.a.Ib.Nj=!0,Tc.a.Ib.sF=new Date);return 32}gbe(a,b,c,f,l){return l&&Object(Xa.a)(9,l)?this.hf.$c(l)?16:32:8}pTj(a){for(const b of a)if(!this.Ssb(b)&&!this.ZTd(b))return!1;return!0}XCf(a){return!!a&&a.WI&&a.eB&&!a.SI}v_b(a){return!!a&&a.isResizable&&a.eB&&!a.SI}Ssb(a){return!!a&&a.CL&&!a.SI}ZTd(a){return!!a&&a.eNj&&!a.SI}$k(a){return a?Object(oa.a)(117,a.sc(this.Fb.Ma)):
null}SRa(a){a&&a.gy&&(a=this.$k(a))&&a.q1(!1)}cbe(a,b,c){return(a=this.$k(a))&&Object(Xa.a)(Ss.a,a.Ok)&&(a=Object(oa.a)(Ss.a,a.Ok))?a.Ahd(K.a.Wz(b),c):!1}}Object(m.a)(pD,"ShapeManipulationActor",null,[]);var Bv=d(423),Ri=d(68);class qD extends Bv.DragSelectionDragAdapter{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){super(a,b,c);this.pa=f;this.Ea=l;this.la=U;this.Fa=x;this.Mik=H;this.ZC=ja;this.Qb=ya;this.fq=Va;this.Wea=hb;this.yc=yb;this.lwc=this.mwc=null}get NIc(){return this.mwc}get MIc(){return this.lwc}Tu(a){for(var b=
this.k3e(),c=a.Ec,f=c,l=this.ZC.HI(f);!l&&f;){l=this.ZC.HI(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||xa.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.gb;c=this.Qb.Nc(l);if(b===l||c.$e()&&c.M1a()===b){l=super.Tu(a);if(!l)return l;this.Fa.Z3(b)&&(c=this.yc.JN(Object(oa.a)(4,b)))&&c.Lp()&&(c=
this.Wea.x3d(a.clientPoint,c,null,null))&&(f=c.sc(this.If.Ma),this.If.E6(a.clientPoint,f,c,this.If,a.shiftKey));null!==this.fq&&(a=this.Fa.ud(b),this.fq.wya(Ri.a.Oaa),a&&(this.mwc=this.Wea.h8d(b),this.lwc=this.Wea.y3f(b)));return l}return!1}ou(a){super.ou(a);this.kSf();null!==this.fq&&this.fq.Zxa();this.NIc&&(this.mwc=null);this.MIc&&(this.lwc=null)}ao(a){super.ao(a);this.kSf();null!==this.fq&&this.fq.Zxa();this.NIc&&(this.mwc=null);this.MIc&&(this.lwc=null)}JGb(a,b,c){({Yr:b,graphNode:c}=super.JGb(a,
b,c));if(this.la.Wlg&&(a=this.k3e())){const f=this.Z5i(c);f&&f===a||(c=a,b=c.sc(this.If.Ma))}return{Yr:b,graphNode:c}}Vtc(a){let b=super.Vtc(a);if(!b&&this.la.Wlg){let c=this.k3e();if(c&&this.Fa.ud(c.node)){const f=this.pa.Zm();this.Wea.BYc(a.clientPoint,f)&&(c=this.Wea.x3d(a.clientPoint,f,this.NIc,this.MIc))}c&&(b=c.sc(this.If.Ma))}return b}Z5i(a){return a?this.Fa.$m(a):null}k3e(){const a=this.Mik.g6f(this.If.Ma);return!a||a.jH?null:this.pa.Jp()}kSf(){(this.pa.gH()||this.pa.Bs())&&this.Ea.Ed()}}
Object(m.a)(qD,"PPTDragSelectionDragAdapter",Bv.DragSelectionDragAdapter,[1001,240]);class hK{constructor(a,b,c){this.Te=a;this.J9=b;this.yc=c}BYc(a,b){if(!a||!b)return!1;b=b.sc(this.Te);return b?(b=Od.a.$h(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}x3d(a,b,c=null,f=null){return(a=this.PVf(a,b,c,f))?a.Xy():null}PVf(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.y3f(b),c=this.h8d(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.sc(this.Te);
if(!l)return null;var x=Od.a.$h(l.htmlElement);if(!x)return null;l=a.x-x.x;x=a.y-x.y;var H=0;for(a=0;a<c.length&&!(H+=c[a],H>=x);a++);for(H=x=0;H<f.length&&!(x+=f[H],x>=l);H++);a=Math.min(a,c.length-1);H=Math.min(H,f.length-1);return 0>a||a>=c.length||0>H||H>=f.length?null:b.qf(a,H)}h8d(a){if(a){a=this.yc.oka(a);if(!a||!a.length)return null;const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].sc(this.Te);if(!b)return null;b=Od.a.$h(b.htmlElement);f[l]=b.height}return f}return null}y3f(a){if(a){a=
Hn.b(Object(oa.a)(ug.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.J9.Pe(a[f],0);return c}return null}}Object(m.a)(hK,"PptTableDragSelectionHelper",null,[321]);var bs=d(649),Hz=d(340);class iK{constructor(a,b,c,f,l,x,H){this.ta=this.Km=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");
if(!x)throw Error.argumentNull("insertShapeOverlayViewElement");if(!H)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Kc=b;this.Pi=c;this.Fb=f;this.NWa=l;this.Hea=x;this.ua=H}Cv(a){try{return a?a.sA===Sys.UI.MouseButton.rightButton?!1:2===this.NWa.dfg?!0:!1:(xa.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),!1)}catch(b){throw xa.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}Tu(a){try{if(!a)return xa.a.J(512336008,822,
10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Cv(a))return!1;this.Hea.nl(Ri.a.rNb);this.Km=bs.a(a.clientPoint,this.Kc.Ic);const b=new Oi.a;b.left=this.Km.x;b.top=this.Km.y;b.bottom=this.Km.y+5;b.right=this.Km.x+5;a={};a.offsets=b;a.insertShapeActionId=this.Hea.Fyb;a.insertLocalShape=!0;if(32!=this.ia.La(K.a.AXc,2,a))return!1;this.ta=a.node;return!0}catch(b){throw xa.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}Cw(a){try{if(!a)return xa.a.J(512336006,
822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Fb.isActive)return!1;const b=bs.a(a.clientPoint,this.Kc.Ic),c=bs.b(this.Xsd(Math.min(this.Km.y,b.y)-this.Km.y),this.Xsd(Math.max(this.Km.y,b.y)-this.Km.y-5),this.Xsd(Math.min(this.Km.x,b.x)-this.Km.x),this.Xsd(Math.max(this.Km.x,b.x)-this.Km.x-5));Object(oa.a)(Hz.a,this.ta.sc(0)).setOffsets(c,!0);return!0}catch(b){throw xa.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}ao(a){try{if(a)if(this.Km){var b=
bs.a(a.clientPoint,this.Kc.Ic),c=bs.b(Math.min(this.Km.y,b.y),Math.max(this.Km.y,b.y),Math.min(this.Km.x,b.x),Math.max(this.Km.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.Hea.Fyb;a.insertLocalShape=!1;this.mNf();this.ia.La(K.a.AXc,2,a);this.UK()}else xa.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else xa.a.J(512336004,822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw xa.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",
f),f;}}ou(){this.UK()}dispose(){this.UK()}Xsd(a){return this.Pi.GM(a,this.Kc.Ic.qT)}UK(){this.Km=null;this.ta&&(this.mNf(),this.NWa.g2e(0),this.ta=null)}mNf(){this.ua.Ba.LU([this.ta])}}Object(m.a)(iK,"ShapeDrawDragAdapter",null,[240,106]);class Jx{constructor(a,b){this.mwg=null;this.XBb=-1;this.yze=a;this.U7j=b}Tu(a){return this.Q2g(a)?(this.yze.whd(),!0):!1}Cw(a){if(!a)return!1;this.U7j?(this.mwg=a,this.X5k()):this.nHe(a);return!0}ao(a){this.qDh()&&this.dQf(0);this.N2g(a);this.yze.Xoc()}ou(){this.qDh();
this.L2g();this.yze.Xoc()}X5k(){-1===this.XBb&&(this.XBb=window.requestAnimationFrame(Object(F.a)(this,this.dQf,"dragMoveTask")))}qDh(){return-1!==this.XBb?(window.cancelAnimationFrame(this.XBb),this.XBb=-1,!0):!1}dQf(){this.nHe(this.mwg);this.XBb=-1}}Object(m.a)(Jx,"ShapeDragAdapter",null,[240]);class jK extends Jx{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){super(Zb,Kc);this.Ycc=0;this.Vcc=this.pp=this.BO=this.jwg=null;this.hHa=!1;this.Fb=a;this.ia=b;this.b0=c;this.Mq=f;this.Mv=l;
this.QC=x;this.ob=H;this.oE=U;this.ZC=ja;this.Fa=ya;this.yc=Va;this.he=hb;this.Bhc=yb;this.fq=fc;this.kA=Lc;this.Sp=Gc}Cv(a){return this.TI(a).returnValue}TI(a){let b;var c=[];b=!1;if(!a||a.sA!==Sys.UI.MouseButton.leftButton||this.QC.J_)return{returnValue:!1,Zic:c,Dac:b};const f=Object(oa.a)(574,this.ZC.HI(a.Ec));if(!f||!f.oje(a.Ec))return{returnValue:!1,Zic:c,Dac:b};if((b=f.isSelected)||f.shapeNode.Ng){c=[];a=Object(oa.a)(117,this.ZC.HI(a.Ec));a.shapeNode.Jf&&this.ob.yNf(a.shapeNode);a=this.ob.tg();
for(const l of a)if(l.get_smartArtModelId()){c.push(this.Fa.yr(l));break}else c.push(l);c=Kj.d(c,this.Fb.Ma);for(const l of c)if(!this.Yhg(l))return{returnValue:!1,Zic:c,Dac:b}}else{if(!this.Yhg(f))return{returnValue:!1,Zic:c,Dac:b};Array.add(c,f)}return{returnValue:!0,Zic:c,Dac:b}}Yhg(a){return a&&a.gb&&a.gb.WI&&a.gb.eB&&!a.shapeNode.SI&&32===this.ia.La(K.a.aOe,1,a.gb)?!0:!1}Q2g(a){var b;let c;if(!({Zic:b,Dac:c}=this.TI(a)).returnValue)return!1;this.ia.processAction(K.a.o7a,2);this.jwg=hd.a.uSa(a.clientPoint);
this.Vcc=Object(oa.a)(574,this.ZC.HI(a.Ec));null!==this.b0&&this.b0.nl(3);if(!this.Vcc||!b||!b.length)return!1;null!==this.fq&&this.fq.wya(Ri.a.Zya);this.Vcc.shapeNode.gy||(this.ob.ij(),this.oE.Ed());for(a=0;a<b.length;++a)this.$Fc(b[a]);c||(this.ob.setSelection(Qd.SelectionFactory.wl(this.pp[0].gb)),this.Mv.qw());for(b=0;b<this.pp.length;++b)this.pp[b].SD(!0);this.hHa=1<this.pp.length?!1:!0;this.Ycc=Date.now();this.kA&&this.ob.FL()&&this.he.jPe();this.Sp&&this.ia.processAction(D.a.Sja,2);return!0}$Fc(a){this.pp||
(this.pp=[]);this.BO||(this.BO=[]);Array.add(this.pp,a);Array.add(this.BO,new hd.a(a.x,a.y))}nHe(a){if(a){var b=this.oTc(hd.a.uSa(a.clientPoint),this.jwg);a=null;var c=this.hHa&&!this.Vcc.shapeNode.gy;for(let f=0;f<this.pp.length;++f)a=hd.a.add(this.BO[f],b),this.pp[f].setPosition(a.x,a.y,!c);b=this.Bhc.J5g(!1,this.hHa,this.pp[0],null);c&&!b&&a&&this.pp[0].setPosition(a.x,a.y,!0)}}oTc(a,b){a=hd.a.bV(a,b);return new hd.a(this.Mq.Qm(a.x),this.Mq.Qm(a.y))}N2g(a){const b=[];for(var c=0;c<this.pp.length;++c){var f=
this.pp[c].HRc();Array.add(b,new Av(this.pp[c].shapeNode,f));this.pp[c].Uz(!1);if(f=this.yc.JN(this.pp[c].shapeNode))f=f.Lp(),xa.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.Vcc.shapeNode.gy||(c={},a&&a.qc&&a.qc.rawEvent&&(c[ni.a.zDa]=a.qc.rawEvent.timeStamp),this.ia.La(K.a.RIa,2,b,c));1===b.length&&(xa.a.J(512497683,815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.pp[0].shapeNode?this.pp[0].shapeNode.Er:"",(Date.now()-this.Ycc).toString()),this.kA&&
this.ob.FL()&&(a=this.ob.rEa(),this.he.jib(new Ix.a(a))));this.k3()}L2g(){if(this.pp){for(let a=0;a<this.pp.length;++a)this.pp[a].setPosition(this.BO[a].x,this.BO[a].y,!0),this.pp[a].Uz(!0);this.k3()}}k3(){this.Bhc.N5g(this.hHa);null!==this.b0&&this.b0.i1();this.Fb.QR();this.BO=this.pp=null;null!==this.fq&&this.fq.Zxa()}}Object(m.a)(jK,"ShapeMoveDragAdapter",Jx,[]);class rD{constructor(a){this.j4c=this.l0=this.L0=this.Rfc=this.v0=null;this.Yd=a}Qbl(a,b,c,f,l){this.v0=a;this.Rfc=b;this.L0=c;this.l0=
f;this.j4c=l}}Object(m.a)(rD,"ResizeShapesCalculationData",null,[]);var sD=d(626);class Yk{static HTd(a,b,c,f,l){return f?Yk.rCf(a,c):Yk.ioi(a,b,c,l)}static rCf(a,b){const c=new Oi.a;if(a.equals(te.a.Qu)||a.Fzb(te.a.Qu))c.left=b.x,c.top=b.y;else if(a.equals(te.a.VE)||a.Fzb(te.a.VE))c.right=b.x,c.bottom=b.y;return c}static ioi(a,b,c,f){b=a.t9b()?Yk.Zni(a,b,c,f):Yk.koi(a,b,c);c=new Oi.a;if(a.Fzb(te.a.north)||a.equals(te.a.north))c.top=-1*b.y;if(a.Fzb(te.a.east)||a.equals(te.a.east))c.right=b.x;if(a.Fzb(te.a.south)||
a.equals(te.a.south))c.bottom=b.y;if(a.Fzb(te.a.west)||a.equals(te.a.west))c.left=-1*b.x;return c}static Zni(a,b,c,f){var l=b.rk(a),x=b.rk(a.T8a()),H=b.rk(a.DZi());a=b.rk(a.EZi());var U=new hd.a(l._x+c.x,l._y+c.y);const ja=sD.b(x,H,U);b=sD.b(x,a,U);c=Yk.OUd(x,H,ja);l=Yk.OUd(x,a,b);b=hd.a.nm(b,U);U=hd.a.nm(ja,U);H=hd.a.nm(x,H);x=hd.a.nm(x,a);f?(x||(xa.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),x=1),H||(xa.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),H=1),f=H/x,!U||b/U>f?(b<Yk.U2&&
(b=Yk.U2),U=b/f,U<Yk.U2&&(U=Yk.U2,b=U*f)):(U<Yk.U2&&(U=Yk.U2),b=U*f,b<Yk.U2&&(b=Yk.U2,U=b/f))):(b<Yk.U2&&(b=Yk.U2),U<Yk.U2&&(U=Yk.U2));return new hd.a(b*c-H,U*l-x)}static koi(a,b,c){var f=a.qTc();a=a.Ywb();f=b.rk(f);var l=b.rk(a);b=b.rk(a.T8a());a=hd.a.S9a(f,l);a.nM(c.x,c.y);c=sD.b(b,f,a);a=hd.a.nm(b,c);l=hd.a.nm(f,b);a<Yk.U2&&(a=Yk.U2);f=a*Yk.OUd(b,f,c)-l;return new hd.a(f,f)}static OUd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Yk.U2=6;Object(m.a)(Yk,
"ResizeHelper",null,[]);class Ts extends Jx{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){super(Va,Zb);this.Bla=this.s0=this.oHa=this.Rpe=this.Spe=this.Yd=this.cG=null;this.hHa=!1;this.lR=this.aR=null;this.Fb=a;this.ia=b;this.QC=c;this.NXa=f;this.oE=l;this.ZC=x;this.Pi=H;this.he=U;this.Fa=ja;this.Bhc=ya;this.kA=fc;this.fq=hb;this.Le=yb;this.Sp=Kc}Cv(a){if(!a||a.sA===Sys.UI.MouseButton.rightButton)return!1;this.lR=[];this.Yd=Object(oa.a)(117,this.ZC.HI(a.Ec));if(!this.Yd||!this.Yd.cE(a.Ec))return!1;
a=this.Yd.shapeNode;if(!a||!a.isResizable||this.QC.J_)return!1;this.cG=[];if(a.az)Array.add(this.cG,this.Yd);else{var b=this.NXa.Wd();(b=this.Fa.D9a(b))&&this.NXa.Kld(b);a.Jf&&this.NXa.yNf(a);b=this.NXa.tg();this.cG=Kj.d(b,this.Fb.Ma)}if(this.Fa.Z3(this.Yd.shapeNode))Array.add(this.lR,new rD(this.Yd));else for(const c of this.cG){if(!this.hUj(c))return this.lR=null,!1;c.shapeNode.isResizable&&!c.shapeNode.ud&&Array.add(this.lR,new rD(c))}return!0}hUj(a){return 32!==this.ia.La(K.a.aOe,1,a.gb)||this.QC.J_||
!a.BQ?!1:!0}Q2g(a){if(!a||!this.Cv(a))return!1;this.NXa.ij();this.oE.Ed();this.ia.processAction(K.a.o7a,2);this.Bla=this.Yd.b5b();if(!this.Yd.cE(a.Ec))return!1;null!==this.fq&&this.fq.wya(Ri.a.rNb);this.aR=this.o5f(this.Yd.cE(a.Ec),this.Yd,this.Bla,!1);this.oHa=this.dsa(a.clientPoint);({width:this.Spe,height:this.Rpe}=this.BCf(this.Bla,this.Yd.shapeNode.L_));this.s0=new hd.a(0,0);for(const c of this.lR){var b=c.Yd.b5b();a=c.Yd;let f,l;({width:f,height:l}=this.BCf(b,this.Yd.shapeNode.L_));const x=
this.o5f(this.aR,a,b,!0);c.Qbl(b,a.SYa,f,l,x);a.BL=!0;a.SD(!0);b=Kj.c(a.shapeNode,this.Fb.Ma);a.shapeNode.Jf&&b.Ok&&(b.Ok.visible=!0)}this.hHa=this.Fa.Z3(this.Yd.shapeNode)?!0:1<this.cG.length?!1:!0;this.kA&&this.NXa.FL()&&this.he.jPe();this.Sp&&this.ia.processAction(D.a.Sja,2);return!0}nHe(a){if(a){var b=this.dsa(a.clientPoint),c=hd.a.bV(b,this.oHa);this.s0=hd.a.add(this.s0,this.p5f(c,this.Bla,!1));var f=null;c=this.hHa&&!this.Yd.shapeNode.gy;for(const l of this.lR){let x=new hd.a(l.L0/this.Spe*
this.s0.x,l.l0/this.Rpe*this.s0.y);new Oi.a;if(l.Yd.shapeNode.az){this.Yd.shapeNode.az&&(x=this.s0);if(!l.j4c)continue;f=Yk.rCf(l.j4c,x)}else f=Yk.HTd(l.j4c,l.v0,this.p5f(x,l.v0,!0),l.Yd.shapeNode.az,l.Yd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Oi.a.add(l.Rfc,this.XWf(f,l.v0));l.Yd.setOffsets(f,!c);l.Yd.shapeNode.Jf&&l.Yd.shapeNode.isEditable&&l.Yd.rce()}this.oHa=b;a=this.Bhc.J5g(!0,this.hHa,this.Yd,this.aR);c&&!a&&f&&this.Yd.setOffsets(f,!0)}}XWf(a,b){if(this.Fa.Z3(this.Yd.shapeNode))return a;
const c=new Oi.a;c.left=b.mZc?a.right:a.left;c.right=b.mZc?a.left:a.right;c.top=b.Iab?a.bottom:a.top;c.bottom=b.Iab?a.top:a.bottom;return c}N2g(a){const b=[];for(var c=0;c<this.lR.length;c++){let f=Oi.a.bV(this.lR[c].Yd.SYa,this.lR[c].Rfc);f=this.XWf(f,this.lR[c].v0);Array.add(b,new Gz(this.lR[c].Yd.shapeNode,f,this.aR,this.s0));this.lR[c].Yd.shapeNode.Jf&&this.lR[c].Yd.shapeNode.isEditable||(this.lR[c].Yd.BL=!1);this.lR[c].Yd.Uz(!1)}this.Yd.shapeNode.gy?Oc.App.Kb.updateCommandUI():(c={},a&&a.qc&&
a.qc.rawEvent&&(c[ni.a.zDa]=a.qc.rawEvent.timeStamp),this.Fa.Z3(this.Yd.shapeNode)?(this.Yd.wDa(),this.ia.La(K.a.alh,2,b,c)):this.ia.La(K.a.Sib,2,b,c));this.kA&&this.NXa.FL()&&(a=this.NXa.rEa(),this.he.jib(new Ix.a(a)));this.UK()}L2g(){if(this.lR){for(const a of this.lR)a.Yd.setOffsets(a.Rfc,!0),a.Yd.BL=!1,a.Yd.Uz(!0);this.UK()}}UK(){this.Bhc.N5g(this.hHa);this.Bla=this.Rpe=this.Spe=this.Yd=this.cG=this.lR=this.aR=this.s0=this.oHa=null;null!==this.fq&&this.fq.Zxa()}BCf(a,b){let c;var f=b?this.I5d(a):
a;c=hd.a.nm(f.ga(0),f.ga(1));f=hd.a.nm(f.ga(0),f.ga(3));b||(a=ye.a.YO(hd.a.MG(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(xa.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Yd.shapeNode.Er),c=1),f||(xa.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Yd.shapeNode.Er),f=1));return{width:c,height:f}}o5f(a,b,c,f){if(b.shapeNode.az){if(this.Yd.shapeNode.az)return a;if(a.equals(te.a.DE)||a.equals(te.a.PH))return null;if(a.equals(te.a.Qu)||
a.equals(te.a.VE))return c.ga(0).x>c.ga(1).x?a.T8a():a;if(b.shapeNode.L_){f=ye.a.YO(hd.a.MG(c.ga(0),c.ga(1)));if(a.equals(te.a.north)||a.equals(te.a.south))return Math.abs(f-90)<Ts.yfc||Math.abs(f-270)<Ts.yfc?c.ga(0).y<c.ga(1).y?a:a.T8a():null;if(a.equals(te.a.east)||a.equals(te.a.west))if(Math.abs(f-180)<Ts.yfc||360-f<Ts.yfc||f<Ts.yfc)return c.ga(0).x<c.ga(1).x?a:a.T8a()}return null}c=hd.a.MG(c.ga(0),c.ga(1));c=Math.floor((c+Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.qTc().qTc():a.Ywb().Ywb();
return a}p5f(a,b,c){if(this.Yd.shapeNode.az||this.Fa.Z3(this.Yd.shapeNode))return a;var f=hd.a.MG(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=hd.a.MG(f,b);return c?new hd.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new hd.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}dsa(a){var b=this.Yd.X2(this.Pi.Qm(a.x)),c=this.Yd.X2(this.Pi.Qm(a.y));if(this.Fa.Z3(this.Yd.shapeNode)){c=this.aR;this.aR.t9b()||(c=c.Ywb());
b=this.Le.$h(this.Yd.aQa);b.x+=Mf.a.Epd;b.y+=Mf.a.Epd;b.width-=2*Mf.a.Epd;b.height-=2*Mf.a.Epd;var f=ei.a.fda(b);b=f.rk(c);f=f.rk(c.T8a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Yd.X2(this.Pi.Qm(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Yd.X2(this.Pi.Qm(c))}return new hd.a(b,c)}I5d(a){const b=hd.a.S9a(a.ga(0),a.ga(3));a=hd.a.S9a(a.ga(1),a.ga(2));return new ei.a(new hd.a(b.x,b.y),new hd.a(a.x,b.y),new hd.a(a.x,a.y),new hd.a(b.x,a.y))}}Ts.yfc=3;Object(m.a)(Ts,"ShapeResizeDragAdapter",
Jx,[]);var kK=d(194);class Iz{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.Oxe=this.jze=null;this.Qfc=0;this.RAe=this.lhc=null;this.d4c=0;this.rHg=8;this.KQg=4;this.x5j="AngleUIRendered";this.tE=this.Yd=null;this.Fb=a;this.ia=b;this.QC=f;this.b0=c;this.pa=l;this.oE=x;this.ZC=H;this.Pi=U;this.jc=ja;this.qe=ya;this.fq=Va;this.Sp=hb;this.SGa=yb}Cv(a){if(!a||a.sA!==Sys.UI.MouseButton.leftButton||this.QC.J_)return!1;this.Yd=Object(oa.a)(117,this.ZC.HI(a.Ec));return this.Yd&&this.Yd.tle(a.Ec)?(this.tE=
this.Yd.shapeNode)&&this.tE.CL&&this.Yd.BQ?!0:!1:!1}Tu(a){if(!a||!this.Cv(a))return!1;this.pa.ij();this.oE.Ed();this.ia.processAction(K.a.o7a,2);null!==this.fq&&this.fq.wya(lf.a.fQ(this.qe.qk("rotatehandlecursor.cur"),Ri.a.Pyh));this.Qfc=this.tE.get_shapeRotation();this.lhc=this.Yd.b5b().Wf();this.RAe=this.Yd.lwb().Wf();this.jze=this.dsa(a.clientPoint);this.Yd.ela=!0;this.SGa&&this.bWe(!0);this.Yd.SD(!0);this.Sp&&this.ia.processAction(D.a.Sja,2);return!0}Cw(a){if(!a)return!1;this.Oxe=this.dsa(a.clientPoint);
if(!this.Oxe)return!1;this.d4c=ye.a.YO(hd.a.MG(this.Oxe,this.lhc))-ye.a.YO(hd.a.MG(this.jze,this.lhc));let b=this.Qfc+this.d4c;this.SGa&&(b=this.mxh(b));this.Yd.setRotation(Math.round(b),this.RAe);this.SGa&&(a=this.dsa(a.clientPoint,!1),this.jFl(a,Math.round(b)));return!0}mxh(a){return this.Shi(a)?10*Math.round(a/10):a}Shi(a){0>a&&(a=(a+360)%360);return(a+this.KQg/2)%90<=this.KQg?!0:!1}jFl(a,b){var c=this.jc.kg(this.Yd.gb);c=Kj.e(c,this.Fb.Ma);c.kpc.LB(2);c.kpc.setPosition(a.x+this.rHg,a.y+this.rHg);
c.kpc.xa.style.position="absolute";0>b&&(b+=360);c.kpc.xa.innerText=(b%360).toString()+"\u00b0"}bWe(a){const b=this.jc.kg(this.Yd.gb);Kj.e(b,this.Fb.Ma).kpc.Qd(a)}ao(a){this.SGa&&this.bWe(!1);this.Yd.ela=!1;this.Yd.Uz(!1);var b=this.Qfc+this.d4c;this.SGa&&(b=this.mxh(b));b=new Yo(this.tE,Math.round(b));const c={};a&&a.qc&&a.qc.rawEvent&&(c[ni.a.zDa]=a.qc.rawEvent.timeStamp);this.SGa&&(c[this.x5j]=1);this.ia.La(K.a.fpc,2,b,c);this.k3()}ou(){this.lhc&&(this.Yd.setRotation(this.Qfc,this.RAe),this.SGa&&
this.bWe(!1),this.Yd.ela=!1,this.Yd.Uz(!0),this.k3())}dsa(a,b=!0){var c=this.jc.kg(this.Yd.gb);return(c=Kj.e(c,this.Fb.Ma).JB)?(a=hd.a.uSa(kK.a.LSa(a,c)),b?new hd.a(this.Yd.X2(this.Pi.Qm(a.x)),this.Yd.X2(this.Pi.Qm(a.y))):a):null}k3(){null!==this.b0&&this.b0.i1();null!==this.fq&&this.fq.Zxa();this.Fb.QR();this.jze=null;this.Qfc=0;this.lhc=null;this.d4c=0;this.Yd=this.tE=null}static getInstance(a){return Iz.uC(a)}static uC(a){return new Iz(a,Db.a.instance.resolve("Common.IActionManagerExtended"),Db.a.instance.resolve("Common.ICursorPinningTool"),
Db.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),Db.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Db.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),Db.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),Db.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Db.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Db.a.instance.resolve("PowerPoint.IPathManager"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?
Db.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ILe)}}Object(m.a)(Iz,"ShapeRotateDragAdapter",null,[240]);var tD=d(330);class lK{constructor(a,b,c,f,l){this.Km=this.Mr=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");
if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Kc=b;this.Fb=c;this.NWa=f}lSi(){if(this.Mr)return this.Mr;this.Mr=new mo.a;this.Mr.ur("MarqueeDiv");this.Mr.Yj(0);this.Mr.xa.style.borderStyle="solid";this.Mr.xa.style.borderWidth="thin";this.Mr.xa.style.borderColor="black";this.Mr.xa.style.opacity="0.5";this.Mr.Qd(!1);return this.Mr}GEh(a,b){this.Mr&&this.Mr.lh(a,b)}FEh(a,b){this.Mr&&this.Mr.setPosition(a,
b)}UK(){this.Km=null;this.Mr&&(this.Mr.Qd(!1),this.Mr.zq())}JRd(a){const b=this.Kc.Ic;if(!b||!b.te||!b.te.xa)return xa.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),!1;b.te.xa.appendChild(a.xa);a.LB(2+tD.a.jba);a.Qd(!0);return!0}Cv(a){try{return a?a.sA===Sys.UI.MouseButton.rightButton?!1:1===this.NWa.dfg?!0:!1:(xa.a.J(512497681,822,10,"Event argument is null in isDragPossible"),!1)}catch(b){throw xa.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",
b),b;}}Tu(a){try{if(!a)return xa.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Cv(a))return!1;this.Km=bs.a(a.clientPoint,this.Kc.Ic);const b=this.lSi();if(!this.JRd(b))return!1;this.FEh(this.Km.x,this.Km.y);this.GEh(0,0);return!0}catch(b){throw xa.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}Cw(a){try{if(!a)return xa.a.J(512497677,822,10,"Event argument is null in OnDragMove"),!1;if(!this.Fb.isActive)return!1;const b=bs.a(a.clientPoint,this.Kc.Ic),
c=Math.min(this.Km.x,b.x),f=Math.min(this.Km.y,b.y),l=Math.max(this.Km.x,b.x),x=Math.max(this.Km.y,b.y);this.FEh(c,f);this.GEh(l-c,x-f);return!0}catch(b){throw xa.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",b),b;}}ao(a){try{if(a)if(this.Km){var b=bs.a(a.clientPoint,this.Kc.Ic),c=bs.b(Math.min(this.Km.y,b.y),Math.max(this.Km.y,b.y),Math.min(this.Km.x,b.x),Math.max(this.Km.x,b.x));this.ia.La(K.a.KXc,2,c);Ud.a("TelemetryForClickAndDragOperation")&&xa.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");
this.UK()}else xa.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else xa.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw xa.a.J(512497672,822,10,"Exception {0} occured in OnDragEnd",f),f;}}ou(){this.UK()}dispose(){this.UK();this.Mr=null}}Object(m.a)(lK,"TextboxDrawDragAdapter",null,[240,106]);class Us{constructor(a,b,c){this.Y8c=0;this.BO=null;this.wbc=!1;this.cze=this.s4c=null;this.VDb=new hd.a(0,0);this.Jma=1;this.fj=a;this.Kc=b;this.N7j=c;
this.N7j.aW(Object(F.a)(this,this.hZa,"onSlideNavigation"))}Qsb(a){return a?!0:!1}hZa(){this.Jma=1;this.VDb=new hd.a(0,0);this.setTransform(new hd.a(0,0))}Ezb(a){if(!a)return!1;a=this.m8f(a.qc);return!!a&&1<a.length}UIe(a){if(!a)return!1;this.Y8c=this.fj.PU;if(!this.Ezb(a))return!1;this.BO=this.ITc(a.qc);return!1}Hkc(a){if(!a)return!1;this.Ezb(a)?(a=this.ITc(a.qc),this.BO||(this.BO=a),this.Wvd(this.xoi(this.BO,a))):this.Lyk(a);return!0}Lyk(a){a&&(a=this.ITc(a.qc),this.wbc?(a=this.kCf(this.s4c,a),
this.setTransform(a)):(this.wbc=!0,this.s4c=a))}ao(a){if(this.wbc&&a){a=this.ITc(a.qc);var b=this.kCf(this.s4c,a);a=b.x+this.VDb.x;b=b.y+this.VDb.y;this.wbc=!1;this.VDb=new hd.a(a,b)}}kCf(a,b){return!a||1>a.length||!b||1>b.length?new hd.a(0,0):new hd.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Kc&&this.Kc.Ic&&this.Kc.Ic.CU){var b=this.Kc.Ic.CU;this.cze||(this.cze=b.style.cssText);b.style.cssText=this.cze+"  width:100%;height:100%; transform:translate("+(a.x+this.VDb.x+"px,"+(a.y+this.VDb.y)+
"px) scale("+this.Jma+","+this.Jma+")")}}Vcl(){this.setTransform(new hd.a(0,0))}vHb(a){if(!a)return!1;this.ao(a);this.Dwl();return!1}Wvd(a){this.Y8c&&(a*=this.Y8c,a<Us.WYg?a=Us.WYg:a>Us.qYg&&(a=Us.qYg),this.fj.Ska=!1,this.Jma=this.fj.PU=a,this.Vcl())}jCf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}xoi(a,b){a=this.jCf(a);b=this.jCf(b);return-1!==a&&-1!==b&&a?b/a:0}m8f(a){let b=null;if(!a)return null;a=a.rawEvent?a.rawEvent:
a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}ITc(a){let b=null;a=this.m8f(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new hd.a(c.screenX,c.screenY));return b}Dwl(){this.Y8c=0;this.BO=null;this.wbc=!1;this.s4c=null}}Us.WYg=1;Us.qYg=5;Object(m.a)(Us,"ZoomSettingTouchAdapter",null,[633]);var KQ=d(424);class mK{constructor(a,b,c,f,l,x){this.tye=!1;this.Km=null;this.pxe=!1;this.Fb=a;this.CJ=b;this.ob=c;this.Kc=f;this.Ea=l;this.ua=x;this.Mr=new mo.a;this.Mr.ur("Marquee");
this.Mr.Yj(0);this.Mr.xa.style.backgroundColor="darkgrey";this.Mr.xa.style.opacity="0.5";this.Mr.Qd(!1)}JRd(){this.Mr&&(this.Kc.Ic.te.xa.appendChild(this.Mr.xa),this.tye=!0)}UK(){this.Km=null;this.Mr&&(this.Mr.Qd(!1),this.Mr.zq(),this.tye=!1);this.pxe=!1}Cv(a){if(!a||a.sA===Sys.UI.MouseButton.rightButton)return!1;a=new KQ.a(a,this.Fb);return this.Fb.V$b(a)}Tu(a){if(!a||!this.Fb.isActive||!this.Cv(a))return!1;this.CJ.Heh(new Bp(!0));a.ctrlKey||a.shiftKey?xa.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",
a.ctrlKey,a.shiftKey):this.ob.Qh();this.Ea.Ed();this.pxe=a.shiftKey?!0:!1;this.Km=this.dsa(a.clientPoint);this.tye||this.JRd();this.Mr.setPosition(this.Km.x,this.Km.y);this.Mr.lh(0,0);this.Mr.LB(1+tD.a.jba);this.Mr.Qd(!0);return!0}Cw(a){if(!a||!this.Fb.isActive)return!1;var b=this.dsa(a.clientPoint);a=Math.min(this.Km.x,b.x);const c=Math.min(this.Km.y,b.y),f=Math.max(this.Km.x,b.x);b=Math.max(this.Km.y,b.y);this.Mr.setPosition(a,c);this.Mr.lh(f-a,b-c);return!0}ao(a){if(a){var b=this.dsa(a.clientPoint);
a=Math.min(this.Km.x,b.x);var c=Math.min(this.Km.y,b.y),f=Math.max(this.Km.x,b.x);b=Math.max(this.Km.y,b.y);var l=this.ua.Ba,x=l?l.Ek():[];l=[];var H=[],U=this.ob.Wd();for(const ja of x)(x=Object(oa.a)(117,ja.sc(this.Fb.Ma)))&&x.BQ&&(x.$p?x.Fqd():(x=x.qae(!1),x.hc>=a&&x.kc>=c&&x.$b<=f&&x.Yb<=b&&(this.pxe?Array.contains(U,ja)?H.push(ja):l.push(ja):Array.contains(U,ja)||l.push(ja))));0<l.length&&this.ob.P_a(l,!1);0<H.length&&this.ob.psa(H);this.UK()}}ou(){this.Km&&this.UK()}dsa(a){const b=this.Kc.Ic.JB;
return b?hd.a.uSa(kK.a.LSa(a,b)):hd.a.uSa(a)}dispose(){this.Km&&this.UK();this.Mr=null}}Object(m.a)(mK,"MarqueeSelectDragAdapter",null,[240,106]);class nK{constructor(a){this.xX=null;this.Yji(a);this.Lbe=!1}Yji(a){null!==a&&(this.xX=lf.a.Ie(),this.xX.style.position=Ri.a.absolute,this.xX.style.top="0px",this.xX.style.left="0px",a.appendChild(this.xX))}wya(a){null!==a&&null!==this.xX&&null!==this.xX.parentNode&&(this.xX.style.cursor=a,this.xX.style.zIndex=String(Ri.a.$Kl),this.xX.style.height="100%",
this.xX.style.width="100%",this.Lbe=!0)}Zxa(){if(null!==this.xX||this.Lbe)this.xX.style.height="0px",this.xX.style.width="0px",this.xX.style.cursor=Ri.a.Pyh,this.xX.style.zIndex="-1",this.Lbe=!1}}Object(m.a)(nK,"CursorContainerManager",null,[320]);class uD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Zb(a){this.K=a;a.register(320,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().oa(()=>new nK(a.resolve("PowerPointWebEditor.AppFrame").X1));
a.register(pD,"PowerPointWebEditor.ShapeManipulationActor").ma().oa(()=>new pD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new sp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").$Se,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(qD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().oa(()=>new qD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),sa.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),
a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(321,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().oa(()=>new hK(a.resolve("Box4.IPageView").Ma,a.resolve("Box4.IPageView").Ld,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||this.QCj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&
this.HDj();this.DCj()}HDj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").OTk(new Us(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}QCj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");
const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),x=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),H=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),U=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja=this.K.resolve("PowerPointWebEditor.ISlideReader"),ya=this.K.resolve("PowerPointWebEditor.IShapeReader"),
Va=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),hb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),yb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),Zb=this.K.resolve("PowerPoint.IPathManager"),fc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Kc=!!window.requestAnimationFrame&&!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").YJb(2,
this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").YJb(1,new jK(a,b,l,U,this.K.resolve("Box4.IUndoManager"),c,f,x,H,ya,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Va,hb,yb,fc,Kc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Ts(a,b,c,f,x,H,U,
Va,ya,hb,yb,fc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Kc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Iz(a,b,l,c,f,x,H,U,ja,Zb,fc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ILe),new mK(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));c=new iK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));
this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").wgh(c);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Gyb&&(a=new lK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").wgh(a));xa.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}DCj(){const a=
this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.Ee();a.wb()}dispose(){}static main(){z.a.instance.Dc(new uD)}}Object(m.a)(uD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var LQ=d(1149),Kx=d(1205),hr=d(115);class Lx{constructor(a,b,c,f,l,x,H,U){this.Wxe=null;this.Kxe=new Date;this.SQ=a;this.zbk=b;this.Thk=c;this.i6j=f;this.ibk=l;this.CHa=x;H.Db(new af.a(U,2,this.i6j,Object(F.a)(this,this.BEf,"checkTask"),90,"61"))}BEf(){this.Nzl()}Nzl(){var a=new Date;const b=+new Date-+this.Wxe>
this.Thk;if(!(this.Kxe<this.Wxe)||b){if(+a-+this.Kxe<this.zbk)return;this.SQ()}a=+new Date-+a;a>this.ibk&&xa.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.CHa)}qsd(){this.Wxe=new Date}msd(){this.Kxe=new Date}}Object(m.a)(Lx,"PrefetchThrottler",null,[]);class Pp{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc){this.Wmd=250;this.Ydc=this.ucc=null;this.Aec=this.jec=!1;this.GEb=[];this.Smi=5;this.HBf=10;
this.HEb=[];this.Tmi=5;this.yXa=!1;this.tWg=this.gJ=this.G2c=null;this.z7c=!1;this.aAe=[];this.Vb=a;this.ua=b;this.sH=c;this.wj=f;this.Iqe=l;this.lz=Lc;this.Wma=x;this.Ha=H;this.zb=U;this.jc=ja;this.Gv=ya;this.jM=Va;this.qd=hb;this.mgk=yb;this.Oc=Zb;this.Qk=fc;this.ly=Kc;this.cgk=this.Ha.nSj;this.kek=u.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.jek=u.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");!B.a.Ni||this.Ha.oSj?this.setEnabled(this.Ha.bLj,this.Ha.uOj):
this.setEnabled(!1,!1);this.H9c=this.Ha.prefetchSlideForwardMax;this.G9c=this.Ha.prefetchSlideBackwardMax;this.m7j=u.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.N4k=u.AFrameworkApplication.fa.Bc("SlidePrefetchLookaheadCount",0);this.xH=!1;this.Oc.KA(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.KPa(Object(F.a)(this,this.S0,"onSessionRehydrating"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));u.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&
(this.Wmd=125);this.ly&&this.ly.bFa(()=>{this.iql()})}iql(){this.tWg=new af.a(2,1,this.Wmd,Object(F.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.z7c=!1;const a=this.kek?2:3;this.ucc=new Lx(Object(F.a)(this,this.Lzl,"tryPrefetchContentModel"),this.Wmd,Pp.O4k,Pp.$mh,Pp.Umh,"content model",this.zb,a);this.qd.irb(Object(F.a)(this,this.mZa,"onVisibleThumbnailsChanged"));this.Qk.rI(Object(F.a)(this,this.AB,"onActiveSlideChanged"));this.Ydc=new Lx(Object(F.a)(this,this.Ozl,
"tryPrefetchImages"),this.Wmd,Pp.M4k,Pp.$mh,Pp.Umh,"image",this.zb,3);this.jM&&(this.jM.Bia(Object(F.a)(this,this.Upg,"loadedHandler")),this.jM.jk(Object(F.a)(this,this.Kch,"propertyChangedHandler")))}get Ef(){this.G2c&&this.G2c.isConnected||(this.G2c=this.Vb.Ef);return this.G2c}get Ba(){this.gJ||(this.gJ=this.ua.Ba);return this.gJ}setEnabled(a,b){this.jec=a;this.Aec=b}fed(){this.GEb=[];this.HEb=[];this.yXa=!1}dispose(){this.qd.Yih(Object(F.a)(this,this.mZa,"onVisibleThumbnailsChanged"));this.Qk.U5(Object(F.a)(this,
this.AB,"onActiveSlideChanged"));this.Oc.paa(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.vld(Object(F.a)(this,this.S0,"onSessionRehydrating"));this.Oc.Sfa(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.jM&&(this.jM.k_a(Object(F.a)(this,this.Upg,"loadedHandler")),this.jM.Cm(Object(F.a)(this,this.Kch,"propertyChangedHandler")))}qM(){this.xH=!0}S0(){this.fed()}Do(){this.xH=!1}Lzl(){this.jec&&this.fuh()&&this.oIk()}oIk(){var a=this.lae();const b=this.yXa?null:Pr.b(a,c=>c?c.Cb:null);(a=
this.q$g(0,a))?(a=a.Cb,this.ucc&&this.ucc.qsd(),this.Gv.prefetchSlide(a,b,()=>{this.yXa=!0}),this.uLk(a)):this.yXa||this.Gv.prefetchSlide(M.a.empty,b,()=>{this.yXa=!0})}AB(){this.gJ=null;this.yXa=!1}mZa(){this.dyl();this.yXa=!1}Upg(a,b){(a=Object(oa.a)(116,b.node))&&a.fE&&this.Rjc(a)}Kch(a,b){a=b.property;b.node&&a===kb.a.cid&&(this.yXa=!1)}Rjc(a){if(a.isConnected){var b=Object(oa.a)(116,a);b&&(b.CFa=!0,this.zb.Db(new af.a(2,1,0,Object(F.a)(this.Ydc,this.Ydc.BEf,"checkTask"),90,"60")),u.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&
(Array.clear(this.aAe),this.WOd(b.CWf),this.WOd(b.JBh),this.WOd(b.qFh),b=new af.a(3,1,0,Object(F.a)(this,this.Mzl,"tryPrefetchFonts"),90,"114"),b.customData=this.aAe,this.zb.Db(b)))}this.ucc&&(this.ucc.msd(),this.GEb=[]);a.sza=!0;this.Wma.l1a()}uLk(a){this.GEb.length>=this.HBf&&(this.GEb=[]);Array.add(this.GEb,a)}WOd(a){if(!ha.a.Wa(a)){a=a.split(",");for(const b of a)this.aAe.push(b)}}q$g(a,b=null){const c=this.Ba;if(!c||!c.isConnected)return null;b||(b=this.lae());return this.Gdj(c,a,b)}Gdj(a,b,
c){for(const f of c)if(f)if(c=f.Cb,this.uyj(c))xa.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.jil(f,b)){const l=a.Cb;a=this.jc.r6b(a);const x=this.jc.r6b(f);xa.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,x,x-a,l,a,b);return f}return null}uyj(a){let b=0;for(const c of this.GEb)a.equals(c)&&(b+=1);
if(b>=this.Smi)return!0;b=0;for(const c of this.HEb)a.equals(c)&&(b+=1);return b>=this.Tmi}jil(a,b){if(!a)return!1;const c=a.Cb;if(M.a.ix(c))return!1;const f=!!a&&a.fE;if(0===b)return!f;if(!f||!a.CFa)return!1;b=a.bUa(new hr.a(a.oq,a.Vk));if(null===b)return xa.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.sH.GWc.lmd(l).data)return!0;return a.CFa=!1}Ozl(){if(this.Aec&&this.fuh()){const b=this.q$g(1);if(b){var a=b.Cb;this.Ydc.qsd();
this.wWi(b);this.vLk(a)}}}Mzl(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.lz.POi(b)}fuh(){return this.xH||!this.cgk&&2===this.wj.Kca||!this.Ef||this.Iqe.jua(this.Ef)||!this.Ba||this.Ba.AL?!1:!0}vLk(a){this.HEb.length>=this.HBf&&(this.HEb=[]);Array.add(this.HEb,a)}wWi(a){if(a){var b=a.bUa(new hr.a(a.oq,a.Vk));b&&0<b.length?this.sH.Dvb(b,!0,()=>{this.Ydc.msd();this.HEb=[];a.CFa=!1},u.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):a.CFa=!1}}dyl(){this.z7c||
(this.zb.Db(this.tWg),this.z7c=!0)}updateSlidePrefetchRange(){this.z7c=!1;this.Gv.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.Wma.tpa,null)}Mnj(){return Pr.b(this.lae(),a=>a?a.Cb:null)}lae(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.jc.r6b(a);var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.m7j)for(var x of this.Wma.tpa.S3)x!==a&&x<c&&(Array.add(l,b[x]),f[x]=!0);if(this.jek&&!f.length)for(x=1;x<=
this.N4k;x++){const H=this.Wma.tpa.lastIndex+x;H!==a&&H<c&&(Array.add(l,b[H]),f[H]=!0)}if(0<=a){a=this.mgk.C6f(a,b.length,this.H9c,this.G9c);for(const H of a)if(void 0===f[H]||null===f[H])f[H]=!0,Array.add(l,b[H])}return l}}Pp.$mh=1E3;Pp.O4k=2E3;Pp.M4k=6E4;Pp.Umh=500;Object(m.a)(Pp,"PrefetchManager",null,[319,106]);class vD{constructor(a,b,c,f){this.vi=b;this.vE=c;this.pa=f;this.Oc=a;this.Oc.JPa(Object(F.a)(this,this.Vgb,"onSessionEnding"))}Vgb(a,b){if(this.pa.Xz()){a=this.pa.Wd();if(!a.length){const c=
this.pa.e6f();c&&a.push(c)}for(const c of a)this.vi.j7a(c)}this.vE.G_i(b.lG)}dispose(){this.Oc.kRe(Object(F.a)(this,this.Vgb,"onSessionEnding"))}}Object(m.a)(vD,"SessionCleanupHandler",null,[106]);var oK=d(436),MQ=d(952);class wD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.kEd=this.Yzc=this.rBe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ha=a;this.ehc=a.sessionTimeoutInMs;this.zb=b;this.nE=c;this.pa=f;this.yWa=l;this.LC=x;this.Rd=H;this.ua=
U;this.fc=ja;this.Mm=ya;this.SSg=Va;this.So=hb;this.fug=yb;this.dhc=0}get jda(){return this.yWa.instance}get e4(){return u.AFrameworkApplication.Ug}get fmg(){return 1===this.dhc}get fAb(){return this.Yzc}get Z_c(){return this.kEd}get lG(){return this.dhc}set lG(a){this.dhc=a}get cDf(){return this.Ha.podsSeamlessFailoverEnabled&&!!this.So.instance}start(){if(!this.e4){var a=new af.a(4,2,3E4,Object(F.a)(this,this.CXg,"manageLifetime$p"),90,"56");this.zb.Db(a)}}Ejk(){this.CXg(null)}CXg(){if(!this.rBe){var a=
+new Date-+Tc.a.Mac;a>this.ehc&&this.gUi(a);u.AFrameworkApplication.Yz&&u.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ha.wopiTokenRefreshMaxDurationInMs&&this.LC.YPk()}}gUi(a){this.e4||(this.bGf(2),this.cDf?this.fug.instance&&this.fug.instance.B$a&&(xa.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),kf.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.SSg.Iml()):this.SSg.Hml(),this.LC.$Ok(),xa.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.ehc,this.cDf,!!this.So.instance,this.Ha.podsSeamlessFailoverEnabled))}closeSession(a=1){this.bGf(a)}bGf(a){0===a&&xa.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.e4)try{this.Yzc=!0,xa.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
oK.a[a]),this.dhc=a,this.pa.setSelection(null),u.AFrameworkApplication.Ug=!0,this.nE.V9a().Oed=!0,this.Rd.disabled=!0,xi.a.$w&&4!==a&&xi.a.$w.hide(),this.LC.WOe(new MQ.a(a)),this.jda&&0<this.jda.FDa.count&&this.jda.foc(this.nE.fTa().presentationId,"instanceId",!0,!1),this.Ha.podsSeamlessFailoverEnabled&&this.So.instance&&(1===a?this.So.instance.JNd("abortedOnExitApp"):this.So.instance.JNd("SessionClose_"+a)),this.zb.stop(),this.Mm.isPaused||this.Mm.pause(),4!==a&&2!==a&&this.fc.blockContent(this.ua.presentation,
"CloseSession",!0),this.LC.qkd(new ln.a(a))}finally{this.kEd=this.Yzc=!1}}onl(){this.rBe=!0}e3k(){this.rBe=!1}markSessionClosingAtForceSave(a){xa.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",oK.a[a]);this.kEd=this.Yzc=!0;this.dhc=a}}Object(m.a)(wD,"SessionLifetimeManager",null,[1049]);var qg=d(426);class pK{constructor(){this.trigger=null;this.Taa=this.Gkb=this.T0a=0;this.jXd={}}}Object(m.a)(pK,"SuggestionsInfo",null,[]);class qK{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(m.a)(qK,"StartRtcConnectionRequest",null,[]);class rK{constructor(){this.SessionID=null}}Object(m.a)(rK,"StopRtcConnectionRequest",null,[]);var NQ=d(286);class sK{constructor(a,b){this.slideId=a;this.imageId=NQ.a.FLc(b)}}Object(m.a)(sK,"ThumbnailImageId",null,[]);var Vs=d(297);const tK=a=>{let b,c,f;var l;let x,H;b=null;f=c=0;x=l=null;H=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&
8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new Vs.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new M.a(l),x=a[6],H=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,cV:c,Taa:f,slideID:l,trigger:x,Gkb:H}):{returnValue:!1,correlationID:b,cV:c,Taa:f,slideID:l,trigger:x,Gkb:H}},OQ=a=>{const b=new Ka.a;try{const c=xd.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){xa.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};
var Jz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(Jz||(Jz={}));Object(m.b)("CoauthorStatus",Jz);class uK extends Sys.EventArgs{constructor(a){super();this.Dia=a}}Object(m.a)(uK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class vK extends Sys.EventArgs{constructor(a){super();this.GPc=a}}Object(m.a)(vK,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class wK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.iVc=a;this.uPc=b;this.JNj=c;this.confidence=
f;this.imageDescription=l}}Object(m.a)(wK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class xK extends Sys.EventArgs{constructor(a){super();this.b$b=a}}Object(m.a)(xK,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class yK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(yK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class zK extends Sys.EventArgs{constructor(a){super();this.G3d=a}}Object(m.a)(zK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class AK extends Sys.EventArgs{constructor(){super()}}
Object(m.a)(AK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class BK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(BK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class xD extends Sys.EventArgs{constructor(a,b=null){super();this.Ugk=a;this.Q7j=b}get Nzh(){return this.Ugk}get wUi(){return this.Q7j}}Object(m.a)(xD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class CK extends Sys.EventArgs{constructor(a){super();this.YIk=a}}Object(m.a)(CK,"PresentationLastModifiedTimeReceivedEventArgs",
Sys.EventArgs,[]);var PQ=d(877);class DK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(m.a)(DK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class Kz extends Sys.EventArgs{constructor(a,b,c,f,l,x,H){super();this.Dde=!1;this.hsc=null;this.correlationId=a;this.T0a=b;this.Taa=c;this.trigger=l;this.slideId=x;this.kDa=H;this.yLa=f}}Object(m.a)(Kz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Mx extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=
a;this.slideId=b;this.kDa=c}}Object(m.a)(Mx,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class EK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.SY=c;this.shapeId=b;this.kDa=f}}Object(m.a)(EK,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class FK extends Sys.EventArgs{constructor(a,b,c,f,l,x){super();this.correlationId=a;this.Xda=b;this.slideId=c;this.shapeId=f;this.uKa=l;this.kDa=x}}Object(m.a)(FK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class Lz extends Sys.EventArgs{constructor(a){super();
this.sle=!1;this.sle=a}}Object(m.a)(Lz,"ToggleChatPPTPaneEventArgs",Sys.EventArgs,[]);class GK extends Sys.EventArgs{constructor(a){super();this.IRj=a}}Object(m.a)(GK,"PictureRenderSuccessEventArgs",Sys.EventArgs,[]);var QQ=d(381);class yD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg){this.ute=this.nte=!1;this.CFg=null;this.eHg={};this.Wma=b;this.gl=gg;this.Gq=l;this.I3c=x;this.Vb=U;this.ua=ja;this.Gv=ya;this.F9c=Va;this.Rd=hb;this.LC=yb;this.he=Zb;this.M3c=fc;this.Lu=
Kc;this.Xa=a;this.GO=Lc;this.kEb=Gc;this.Oc=ae;this.n4c=c;this.Ha=we;this.au=$d;this.zb=Te;this.Kv=Ze;this.mc=Vf;this.NCg=this.Ha.vg&&this.Ha.pptNoRtcConnectWhenReadOnlyEnabled;this.Oc.JPa(Object(F.a)(this,this.DB,"onSessionEnd"));this.Oc.KA(Object(F.a)(this,this.$3d,"flushOnSessionEnd"));this.n4c.ruf(Object(F.a)(this,this.y4g,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.ruf(Object(F.a)(this,this.y4g,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ha.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
this.Oc.fC(Object(F.a)(this,this.eaa,"onPodSessionRehydrated"));this.NCg&&this.Oc.O7(Object(F.a)(this,this.Dw,"onUnifiedAppStateChanged"))}y4g(a,b){this.Isk(b,this.I3c)}Isk(a,b){let c=!1;const f=[],l=[],x=new pK;for(const Gc of a.items){const ae=new Date,we=this.au.oFa;var H=void 0,U=void 0,ja=void 0,ya=void 0,Va=void 0,hb=void 0;if(Gc.Key===qg.a.qbh)b.P7d(qg.a.qbh)>Gc.TimeStamp||(xa.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var yb=void 0;yb=null;(U=Gc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&
5===U.length?(yb=new Vs.a,yb.Sid=Number.parseInvariant(U[3]),yb.Cid=Number.parseInvariant(U[4]),yb=new M.a(yb),U={returnValue:!0,slideId:yb}):U={returnValue:!1,slideId:yb};if(({slideId:U}=U).returnValue)U=qg.a.W$d(U.sid,U.cid),b.P7d(U)>=Gc.TimeStamp||(U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),Array.add(f,new PQ.a(U,0<U.SnapshotTimeStamp?U.SnapshotTimeStamp:Gc.TimeStamp)));else if(Gc.Key.startsWith(qg.a.KQf))U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),this.Gq.aHh(U),
xa.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",U);else if(Gc.Key===qg.a.dQi)U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),xa.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",Gc.LastRequestCorrelationID,Gc.TimeStamp,U.length),this.Gq.uGh(U);else if(Gc.Key===qg.a.Nui)U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),
xa.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",Gc.LastRequestCorrelationID,Gc.TimeStamp,Jz[U]),this.Gq.juc(U);else if(Gc.Key===qg.a.Ozi)xa.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",Gc.LastEditorID,Gc.LastRequestCorrelationID,Gc.TimeStamp,
Gc.Value,!1),this.LC.ANk(),this.Gv.DF(this.Vb.xi),(this.Ha.cB||this.Ha.VW)&&Object(Ud.a)("showChatPPTPane")&&this.he.mPe(new Lz(!1));else{if(yb=Gc.Key.startsWith(qg.a.CNf)){a:{yb=void 0;U=Gc.Value;try{const $d=U?U.split(","):[];if(3!==$d.length){yb=M.a.UE(0,0);xa.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",U);var Zb={returnValue:!1,slideId:yb};break a}const Te=Number.parseInvariant($d[0]),Ze=Number.parseInvariant($d[1]),
Vf=$d[2];yb=M.a.UE(Number.parseInvariant($d[0]),Number.parseInvariant($d[1]));xa.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",Te,Ze,Vf)}catch($d){xa.a.J(23089481,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",U,$d.toString());yb=M.a.UE(0,0);Zb={returnValue:!1,slideId:yb};break a}Zb={returnValue:!0,slideId:yb}}yb=({slideId:U}=
Zb).returnValue}if(yb)xa.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",Gc.Value),this.he.ENk(new DK(U));else{if(yb=Gc.Key.startsWith(qg.a.hzh)){{var fc=void 0;let $d;U=null;H=0;fc=$d=null;(yb=Gc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===yb.length?(U=yb[1],H=Number.parseInvariant(yb[2]),fc=Object.assign(new Vs.a,{Sid:Number.parseInvariant(yb[3]),Cid:Number.parseInvariant(yb[4])}),
$d=new M.a(fc),fc=yb[6],H={returnValue:!0,correlationID:U,cV:H,slideID:$d,trigger:fc}):H={returnValue:!1,correlationID:U,cV:H,slideID:$d,trigger:fc}}yb=({correlationID:H,cV:x.T0a,slideID:U,trigger:x.trigger}=H).returnValue}if(yb)xa.a.J(512497792,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",H),U=new Kz(H,x.T0a,x.T0a,0,x.trigger,U,Gc.Value),U.hsc=new Ka.a,this.QMe(U);else if(this.Ha.designerIncrementalRenderEnabled&&Gc.Key.startsWith(qg.a.Fde)&&
({correlationID:H,cV:x.T0a,Taa:x.Taa,slideID:U,trigger:x.trigger,Gkb:x.Gkb}=tK(Gc.Key)).returnValue)xa.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",H,x.Gkb,x.T0a,x.Taa),U=new Kz(H,x.T0a,x.Taa,x.Gkb,x.trigger,U,Gc.Value),H in x.jXd||(x.jXd[H]=this.flj(H,a.items)),U.hsc=x.jXd[H],U.Dde=!0,this.QMe(U);else{if(yb=Gc.Key.startsWith(qg.a.MWf))U=
H=null,(yb=Gc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===yb.length?(H=yb[1],U=Object.assign(new Vs.a,{Sid:Number.parseInvariant(yb[2]),Cid:Number.parseInvariant(yb[3])}),U=new M.a(U),H={returnValue:!0,correlationID:H,slideID:U}):H={returnValue:!1,correlationID:H,slideID:U},yb=({correlationID:H,slideID:U}=H).returnValue;if(yb)xa.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",
H),this.QMe(new Mx(H,U,Gc.Value));else{if(yb=Gc.Key.startsWith(qg.a.lfg))hb=null,ja=0,yb=null,H=U=0,(ya=Gc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===ya.length?(hb=ya[1],ja=Number.parseInvariant(ya[2]),H=Object.assign(new Vs.a,{Sid:Number.parseInvariant(ya[3]),Cid:Number.parseInvariant(ya[4])}),yb=new M.a(H),U=Number.parseInvariant(ya[5]),H=Number.parseInvariant(ya[6]),ja={returnValue:!0,correlationID:hb,Xda:ja,slideID:yb,shapeId:U,uKa:H}):ja={returnValue:!1,
correlationID:hb,Xda:ja,slideID:yb,shapeId:U,uKa:H},yb=({correlationID:H,Xda:ja,slideID:U,shapeId:ya,uKa:hb}=ja).returnValue;if(yb)xa.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",H),this.he.ROk(new FK(H,ja,U,ya,hb,Gc.Value));else if(Gc.Key===qg.a.RKl)this.hxj();else if(Gc.Key===qg.a.TUf&&this.CFg!==Gc.Value)this.hsj(Gc);else if(Gc.Key===qg.a.Ozh)!ha.a.Wa(Gc.Value)&&ha.a.Kzb(Gc.Value)?(U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),
xa.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",U,this.Xa.Kk,this.Xa.podSessionId),240===U?this.GO.Qfa(1):(432!==U||this.ute||this.jPf(),this.kEb.Meh(new xD(U)))):(U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),xa.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",
U.Code,!!U.ExtraErrorParam,this.Xa.Kk,this.Xa.podSessionId),240===U.Code?this.GO.Qfa(1):(432!==U.Code||this.ute||this.jPf(),this.kEb.Meh(new xD(U.Code,U.ExtraErrorParam))));else if(Gc.Key===qg.a.Qog)this.ctj(Gc);else if(Gc.Key===qg.a.Uzj)xa.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",this.Xa.Kk),this.GO.Qfa(1);else if(Gc.Key===qg.a.ZIk)U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),this.Vb.Ef.TLe=
U,this.Lu.KOk(new CK(U));else if(Gc.Key.startsWith(qg.a.dHf)){xa.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",Gc.Key);a:{U=Gc.Key;try{const $d=U.match(RegExp("\\d+","g"));if($d&&0<$d.length&&!($d.length%2)){yb=[];for(fc=0;fc<$d.length;fc+=2)yb.push(Object.assign(new Vs.a,{Sid:Number.parseInvariant($d[fc]),Cid:Number.parseInvariant($d[fc+1])}));var Kc=yb;break a}}catch($d){xa.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",
U,$d)}Kc=null}(U=Kc)&&0<U.length&&this.LC.vNk(new yK(U))}else if(Gc.Key.startsWith(qg.a.mdg))this.Esj(Gc);else if(Gc.Key===qg.a.rVf)this.M3c.NNk(new vK(Gc.Value));else{if(yb=Gc.Key.startsWith(qg.a.Pcg)){a:{Va=Gc.Key;yb=null;U=0;ya="";try{const $d=Va.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));if($d&&5===$d.length){const Te=Object.assign(new Vs.a,{Sid:Number.parseInvariant($d[1]),Cid:Number.parseInvariant($d[2])});yb=new M.a(Te);U=Number.parseInvariant($d[3]);ya=$d[4];var Lc={returnValue:!0,
slideID:yb,shapeId:U,nodeId:ya};break a}}catch($d){xa.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Va,$d.toString())}Lc={returnValue:!1,slideID:yb,shapeId:U,nodeId:ya}}yb=({slideID:U,shapeId:ya,nodeId:Va}=Lc).returnValue}if(yb)xa.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.he.YNk(new EK(U,ya,Va,Gc.Value));else if(Gc.Key===
qg.a.eYi)this.kEb.ONk(new zK(Gc.Value));else{if(yb=Gc.Key.startsWith(qg.a.OBh))yb=null,(U=Gc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===U.length?(yb=new Vs.a,yb.Sid=Number.parseInvariant(U[1]),yb.Cid=Number.parseInvariant(U[2]),yb=new M.a(yb),U={returnValue:!0,slideId:yb}):U={returnValue:!1,slideId:yb},yb=({slideId:U}=U).returnValue;if(yb)U=new sK(U,Gc.Value),U.imageId&&l.push(U);else if(Gc.Key===qg.a.oOi)this.Kv.A4e(parseInt(Gc.Value));else if(Gc.Key===qg.a.gxf)this.M3c.mNk(new uK(Gc.Value));
else if(Gc.Key===qg.a.Xjg)this.M3c.fOk(new xK("true"===Gc.Value.toLowerCase()));else if(Gc.Key===qg.a.Y3k)this.Gq.imh=Gc.Value,this.Gq.b5g();else if(Gc.Key===qg.a.W3k)try{this.Gq.Vpd=Boolean.parse(Gc.Value)}catch($d){xa.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",$d)}else if(Gc.Key===qg.a.Hog)U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),xa.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",
U.toString()),this.LC.kOk(new AK(U));else if(Gc.Key===qg.a.qfh)U=Sys.Serialization.JavaScriptSerializer.deserialize(Gc.Value),xa.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",U.toString()),this.LC.MOk(new BK(U));else if(Gc.Key===qg.a.YBj)try{this.Gq.Uie=Boolean.parse(Gc.Value),xa.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.Gq.Uie)}catch($d){xa.a.J(512497751,
817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",$d)}else if(Gc.Key===qg.a.Szj)this.Gq.Olc=Gc.Value,xa.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.Gq.Olc);else if(Gc.Key===qg.a.aLl)xa.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.Gq.kKh=!0;else if(Gc.Key===qg.a.$0j)xa.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",
Gc.Value),this.Gq.i4=Gc.Value;else if(Gc.Key===qg.a.a1j)xa.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",Gc.Value),this.Gq.$pg=Boolean.parse(Gc.Value);else if(Gc.Key===qg.a.VMf)try{this.Gq.R7a=Number.parseInvariant(Gc.Value),xa.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.Gq.R7a)}catch($d){xa.a.J(512497745,843,15,"Can't parse the notification message: {0}",$d)}else if(Gc.Key===
qg.a.Ovf){let $d;try{$d=Boolean.parse(Gc.Value),this.Gq.minorVersionLimitReached=$d}catch(Te){$d=this.Gq.minorVersionLimitReached=!1}$d&&!this.nte&&(this.wNi(),this.nte=!0);xa.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",Gc.Value,this.nte)}else xa.a.J(512497743,817,50,"Notification key ignored {0}",Gc.Key)}}}}}}}xa.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",
Gc.Key,Tc.a.nf(ae),(+new Date-+ae).toString());we&&!this.au.oFa&&xa.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",Gc.Key);x.trigger===QQ.a.insertPicture&&this.uKk(new GK(!0))}this.VCl(c,f,b,l)}flj(a,b){const c=new Ka.a;b=Mj.e(b,f=>f.Key.startsWith(qg.a.Fde));for(const f of b)b=tK(f.Key),b.returnValue&&b.correlationID===a&&(1===b.cV?c.add(b.Gkb):1<b.cV&&c.addRange(OQ(f.Value)));return c}wNi(){this.gl.bL(24);xa.a.J(512497740,
809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}jPf(){this.ute=!0;this.gl.bL(25);xa.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}uKk(a){this.he.GOk(a)}QMe(a){let b;b=Object(Xa.a)(Mx,a)?()=>{this.he.raiseFixItSuggestionUpdatedEvent(Object(oa.a)(Mx,a))}:()=>{this.he.raiseDesignerSuggestionsUpdatedEvent(Object(oa.a)(Kz,a))};if(this.au.oFa&&
this.Ha.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new af.a(2,1,0,()=>{b()},90,Object(Xa.a)(Mx,a)?"114":"92");this.zb.Db(c)}else b()}VCl(a,b,c,f){a&&(this.Wma.eqj(),this.F9c.instance&&this.F9c.instance.fed());b.forEach(l=>{const x=l.Z2b.Id;c.TCl(qg.a.W$d(x.Sid,x.Cid),l.bga)});this.Wma.isj(b,f)}hxj(){xa.a.J(512497738,817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Vb.xi&&this.Vb.xi.contentReplicator&&(this.Vb.xi.contentReplicator.enabled=
0);this.Rd.cH(158,a=>{a.jC=1;return!1})}hsj(a){xa.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.LC.MNk(new Aj(!1,!0));let b=null;this.F9c.instance&&(b=this.F9c.instance.Mnj());this.Gv.syncCurrentSlideIdAndPrefetchRange(this.ua.Ba,b,null,null);this.CFg=a.Value}ctj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Xa.podSessionId!==a)if(this.Ha.ignorePodSessionRefreshedFromPops)xa.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");
else{const b=this.Xa.podSessionId;this.Xa.podSessionId=a;this.kEb.ieh(new Pn.a(b,a))}else xa.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}Esj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)xa.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=ka.a.Hf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);
this.M3c.ZNk(new wK(c,f,l,parseFloat(b[4]),b[5]))}}else xa.a.J(512497734,817,15,"Response data is null")}catch(b){xa.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}RZi(){let a=0;const b=[],c=(new Date).getTime(),f=this.eHg;for(let x in f){var l=x;0<c-f[x]&&(a++,delete this.eHg[l])}(0<a||0<b.length)&&xa.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,cb.a.join(b,","))}$3d(){this.RZi()}iyh(){if(this.NCg&&!this.mc.zL)xa.a.J(512497730,
801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=Db.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Ug.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",this.Ha.podsWebServiceBase),f=Object.assign(new qK,{BaseDocQueryStringWithoutVersion:u.AFrameworkApplication.gh,SerializedUser:this.Ha.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
l["X-CorrelationID"]=b;a=xd.c(f);u.AFrameworkApplication.Ke.ZV(c,2,a,l,[ee.a.K5],0,x=>{this.Uqg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",x.data.yI,x.data.Xt,x.data.pv,x.data.Sd))},x=>{const H=Db.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");this.Uqg(10,H.cka(x))},null,void 0,void 0,void 0,void 0,Hx.a("3"))}}Byh(){var a=Db.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=Ug.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",
this.Ha.podsWebServiceBase),f={};f.PodSID=a;f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new rK,{SessionID:a});a=xd.c(a);u.AFrameworkApplication.Ke.ZV(c,2,a,f,[ee.a.K5],0,()=>{xa.a.J(38904456,801,50,"StopServerRtcConnection - request succeeded")},l=>{const x=Db.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");xa.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",x.cka(l))},null,void 0,void 0,void 0,void 0,
Hx.a("9"))}Uqg(a,b){xa.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}eaa(){this.iyh()}Dw(a,b){b.bke&&!this.mc.zL&&(xa.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.Byh())}DB(){this.Byh()}}Object(m.a)(yD,"CoauthNotificationManager",null,[]);class HK{constructor(a,b){this.JOh=a;this.y9e=b}get coauthoringStartTime(){return this.JOh}get oGf(){return this.y9e}b$k(a){this.y9e=a}}Object(m.a)(HK,"CoauthoringDurationRecord",null,[]);var RQ=d(950);class IK extends Sys.EventArgs{constructor(a,
b,c=!1){super();this.iyf=a;this.gpg=b;this.ZMj=c}}Object(m.a)(IK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Mz{constructor(a,b,c){this.Yma=this.ceb=null;this.rcb=[];this.$tg=new ik.a;this.VGg=new ik.a;this.Lye=null;this.jxg=!1;this.Dye=0;this.yxg=this.R4c=!1;this.u9c="";this.imh=null;this.minorVersionLimitReached=this.kKh=this.clg=this.Vpd=this.GUf=!1;this.mye=null;this.$pg=!1;this.R7a=0;this.C_c=!1;this.qGa=a;this.Oc=b;this.S3c=0;this.Pcb=[];this.Oc.APd(Object(F.a)(this,this.Rgb,"onPopSessionClosed"));
this.Jak=c}get bD(){return this.ceb}set bD(a){this.ceb!==a&&(this.ceb&&0<this.ceb.length&&2===this.S3c&&xa.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.ceb,a)),this.ceb=a)}get userName(){return this.Yma}get Uie(){return this.R4c}set Uie(a){(this.R4c=a)&&!this.yxg&&kf.Health.instance&&(this.yxg=!0,kf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.R4c.toString()))}get Olc(){return this.u9c}set Olc(a){a!==this.u9c&&(this.u9c=a,xa.a.J(509670558,804,50,
"CoauthStateCache - PopsHostProtocol:{0}",this.u9c))}get i4(){return this.mye}set i4(a){this.mye=a;(a=this.Jak.value.instance)?(a.IVd=this.mye,xa.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",a.IVd)):xa.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.qGa.mOk()}get g_(){const a=[];Array.addRange(a,this.Pcb);return a}get jHl(){return this.g_.length?this.g_.length:1}get amIAlone(){return 2!==this.Kca}get rw(){return this.$pg}get Kca(){return this.S3c}set Kca(a){this.S3c!==
a&&(xa.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.S3c=a)}get yCa(){return this.$tg.task}get bdd(){return this.VGg.task}get cQc(){return this.Lye}set cQc(a){this.Lye||(this.Lye=a,this.VGg.Gg(a.getTime()))}uGh(a){let b;({ERd:a,leaving:b}=this.sDl(a)).returnValue&&(a=new IK(a,b,!this.C_c),this.IRk(),this.qGa.INk(a))}IRk(){const a=[],b=this.g_;for(const c of b)Array.add(a,c.ID)}juc(a){const b=this.Kca;2===a&&(this.cQc=new Date);0!==b||this.jxg||(xa.a.J(509670553,
804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.jxg=!0,this.$tg.Gg(1===a?1:0));this.Kca=a;b!==this.Kca&&(this.qGa.tNk(new RQ.a(this.Kca)),this.GCl(this.Kca))}GCl(a){var b=new Date;2===a?(b=new HK(b,new Date(9999,12,31)),Array.add(this.rcb,b)):(a=this.rcb.length,0<a&&this.rcb[a-1].b$k(b))}aHh(a){this.bD=a;xa.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.bD,this.g_.length);this.qGa.sNk()}Hlb(a){let b;a&&(a=a.toLowerCase());b=null;
for(let c=0;c<this.Pcb.length;c++){const f=this.Pcb[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}sDl(a){let b,c;const f=[];b=[];c=[];let l=!1;const x=a?a.length:0;for(let H=0;H<x;H++){const U=a[H];U&&U.ID&&(U.ID=U.ID.toLowerCase());let ja;({editor:ja}=this.Hlb(U.ID)).returnValue?(l=l||!Mz.gQi(U,ja),Array.remove(this.Pcb,ja)):(U.ID!==this.ceb?Array.add(b,U):this.Yma=U.Name,l=!0);Array.add(f,U)}Array.addRange(c,this.Pcb);l=l||0<c.length;this.Pcb=f;this.Dye=Math.max(this.Dye,this.Pcb.length);
kf.Health.instance&&kf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.Dye.toString());return{returnValue:l,ERd:b,leaving:c}}JRc(a,b){let c=0;const f=this.rcb.length;if(0<f&&a<this.rcb[f-1].oGf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const x=Math.max(this.rcb[l].coauthoringStartTime.getTime(),a),H=Math.min(this.rcb[l].oGf.getTime(),b);x<H&&(c+=H-x)}}return c}b5g(){this.clg=!0;this.qGa.JOk()}Rgb(){this.Olc=""}static gQi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===
b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(m.a)(Mz,"CoauthStateCache",null,[1047,1048]);var lu=d(377);class xl{constructor(){this.KeyRoot=null;this.TimeStamp=0}}Object(m.a)(xl,"KeyRootSubscription",null,[]);class Cv{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.Uhc=lu.a.empty;this.Js=[];this.yva=[];this.Bxg=this.ate=!1;this.n4c=a;this.S5c=b;this.Ze=c;this.f3c=ya.gji;this.Wma=f;this.I3c=l;this.wj=x;this.Sik=H.LXd(1E3,Object(F.a)(this,this.RSi,"ensureVisibleThumbnailsSubscriptionImpl"));
this.Oc=U;this.qd=ja;this.Xa=ya;Va.cOd(this);this.a$c=hb;this.Rec=yb;this.xH=!1;this.a$c&&this.Oc.F9h(Object(F.a)(this,this.Uqk,"onBackendChanged"));this.Oc.KA(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"))}lxa(){this.xH=!1;this.I3c.reset();this.yeg()}yeg(){Array.clear(this.Js);this.Uhc=lu.a.empty;this.Ksd=this.Wma.tpa;this.qd.irb(()=>{this.Ksd=this.Wma.tpa});const a=new xl;a.KeyRoot=qg.a.XZf(this.f3c);a.TimeStamp=0;this.Js.push(a);var b=new xl;
b.KeyRoot=qg.a.pbh;b.TimeStamp=0;this.Js.push(b);b=new xl;b.KeyRoot=qg.a.Mui;this.Js.push(b);var c=new xl;c.KeyRoot=qg.a.hzh;this.Js.push(c);c=new xl;c.KeyRoot=qg.a.Fde;this.Js.push(c);c=new xl;c.KeyRoot=qg.a.lfg;this.Js.push(c);c=new xl;c.KeyRoot=qg.a.CNf;this.Js.push(c);c=new xl;c.KeyRoot=qg.a.TUf;this.Js.push(c);c=new xl;c.KeyRoot=qg.a.Ozh;this.Js.push(c);const f=new xl;f.KeyRoot=qg.a.Qog;this.Js.push(f);const l=new xl;l.KeyRoot=qg.a.Wzj;this.Js.push(l);var x=new xl;x.KeyRoot=qg.a.dHf;this.Js.push(x);
x=new xl;x.KeyRoot=qg.a.mdg;this.Js.push(x);x=Object.assign(new xl,{KeyRoot:qg.a.rVf,TimeStamp:0});this.Js.push(x);x=new xl;x.KeyRoot=qg.a.Pcg;this.Js.push(x);this.Rec&&(x=new xl,x.KeyRoot=qg.a.OBh,this.Js.push(x));x=new xl;x.KeyRoot=qg.a.gxf;this.Js.push(x);x=new xl;x.KeyRoot=qg.a.Xjg;this.Js.push(x);x=new xl;x.KeyRoot=qg.a.Hog;this.Js.push(x);x=new xl;x.KeyRoot=qg.a.qfh;this.Js.push(x);x=new xl;x.KeyRoot=qg.a.MWf;this.Js.push(x);x=new xl;x.KeyRoot=qg.a.Ovf;this.Js.push(x);const H=new xl;H.KeyRoot=
qg.a.VMf;this.Js.push(H);this.n4c.qqc(this.Js);this.S5c&&(Array.clear(this.yva),this.yva.push(b),this.yva.push(a),this.yva.push(c),this.yva.push(f),this.yva.push(l),this.yva.push(x),this.Ze.wA?(this.S5c.qqc(this.yva),this.ate=!0):this.Ze.Lga?(this.Oc.BPd(Object(F.a)(this,this.bZa,"onPopSessionInitialized")),this.Bxg=!0):this.Ze.Nlc.task.continueWith(()=>{this.Ze.wA&&this.S5c.qqc(this.yva)}))}bZa(){this.ate||(this.S5c.qqc(this.yva),this.ate=!0)}get Ksd(){return this.Uhc}set Ksd(a){lu.a.equals(this.Uhc,
a)||(lu.a.equals(a,lu.a.empty)?this.Uhc=lu.a.empty:this.Uhc=lu.a.Vvb(a.DW,a.lastIndex),this.Sik.perform())}Uqk(a,b){this.xH||(a=b.nAk)&&0<a.length&&(xa.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",a,this.Xa.THc),this.lxa())}qM(){this.xH=!0}Do(){this.lxa()}RSi(){const a=this.Js;var b=this.I3c;const c=[];var f=null;for(const x of this.Ksd.S3){var l=qg.a.xmj(x);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new xl,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);
if(l=this.Wma.e$a(x))l=b.P7d(qg.a.W$d(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=l)}f&&c.push(f);Mj.d(a,Object(F.a)(this,this.yVi,"fNeedResetBrowserKeySubscription"),x=>{x.TimeStamp=0},1);b=Mj.e(a,x=>x.KeyRoot.startsWith(qg.a.PBh));f=Mj.a(c,b,Cv.Xme);Mj.a(b,f,Cv.Xme);if(b.length||c.length)Mj.a(a,b,Cv.Xme),Array.addRange(a,c),this.n4c.qqc(a)}yVi(a){return a.KeyRoot.startsWith(qg.a.XZf(this.f3c))&&!this.wj.bD?(xa.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),
!0):!1}dispose(){this.Oc.paa(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.Sfa(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.Bxg&&this.Oc.iRe(Object(F.a)(this,this.bZa,"onPopSessionInitialized"))}static Xme(a,b){return a.KeyRoot===b.KeyRoot}}Object(m.a)(Cv,"CoauthSubscriptionManager",null,[1018,106,1017]);class JK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(m.a)(JK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class KK{constructor(a,b,c,f,l,x){this.id=Ug.a.create();
this.s3c=a;this.Qf=b;this.Xa=c;this.Ha=l;this.Rd=f;this.WX=x}Cvj(a,b){this.WX&&!this.s3c.cX&&this.WX.ZMc(a.AY);a&&a.telemetry&&0<a.telemetry.length&&this.Qf.EYa(a.telemetry);Tc.a.AF(this.Qf,()=>{this.s3c.u5g(this.id,a.result,a.AY,b)})}Bvj(a,b,c){if(!this.s3c.cX&&(this.WX&&this.WX.ZMc(a.AY),a&&a.error&&this.Ha.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Im===df.a.Uh(223))){xa.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",
this.Xa.podSessionId||"NULL");this.Rd.zs(Object.assign(new Ml.a,{Code:223,Source:6}),c);return}Tc.a.AF(this.Qf,()=>{this.s3c.u5g(this.id,null,a.AY,b)})}}Object(m.a)(KK,"LongPollingResponseHandler",null,[]);var SQ=d(876);class zD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.qHa=this.mHa=null;this.OFg=Ug.a.nil;this.qFb=this.uWa=0;this.Sug=[10,100,1E3,1E4];this.kXa=null;this.KX=[];this.u4=Va?"GetPopWacUpdates":"GetUpdates";this.c5=a;this.Xa=c;this.Ze=f;this.Oc=l;this.O9=x;this.Rd=H;this.mc=U;this.WX=ja;
this.Oc.KA(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.KPa(Object(F.a)(this,this.S0,"onSessionRehydrating"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.Ze.Lga&&Va&&(this.Oc.BPd(Object(F.a)(this,this.bZa,"onPopSessionInitialized")),this.Oc.APd(Object(F.a)(this,this.Rgb,"onPopSessionClosed")));this.yCe=a.uvl;this.c7c=a.bRj;this.nEb=a.R$g;this.pDb=[];b.V9a().cOd(this);this.iik=ya;this.rUh=Va;this.Gla=!1;this.hEb=Va?3E4:6E4}qM(){this.close("SessionClosed")}S0(){this.kXa&&
this.kXa.ytd()}Do(){this.hKa("SessionRehydrated")}u5g(a,b,c,f){this.mHa=null;const l=+new Date-+this.qHa;if(this.Gla)xa.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",this.u4);else if(a.equals(this.OFg))if(this.c5.clientIgnoreClosePopsErrorCodeEnable&&this.cX&&this.Gla)xa.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.u4);else if(a=this.Ze.Yda,f&&f.length&&a!==
f)xa.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",this.u4,b?"Success":"Failure",this.Xa.Kk,this.Ze.Yda,f,this.qFb,this.yCe),this.qFb++,this.zUf(l,this.qFb)||this.xpc(this.yCe);else if(this.qFb=0,b){this.qHa=new Date;this.uWa=0;this.Ze.pne=this.qHa;this.Ze.one=f;xa.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",
this.u4,l,Tc.a.nf(new Date),this.cX?this.Xa.Kk:"Not Applicable");c=0;f={};for(const x of b.Items)x.TimeStamp>c&&(c=x.TimeStamp),f[x.LastRequestCorrelationID]=x.LastRequestCorrelationID in f?String.format("{0},{1}",f[x.LastRequestCorrelationID].toString(),x.Key):x.Key,Mj.d(this.pDb,H=>x.Key.startsWith(H.KeyRoot),H=>{x.TimeStamp>H.TimeStamp&&(H.TimeStamp=x.TimeStamp)},1);this.xpc(this.yCe);0<Object.keys(f).length&&Tc.a.zk("RequestCorrelationIDsAndKeyRoots",gl.c(f));c=new Date;Tc.a.AF(Tc.a.Ib,()=>{const x=
Object.assign(new JK,{items:b.Items});for(const H of this.KX)try{H(this,x)}catch(U){xa.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",this.u4,U.toString(),U.stack)}});Tc.a.zk("ProcessItemStartTime",Tc.a.nf(c));Tc.a.zk("ProcessItemDurationInMS",(+new Date-+c).toString());Tc.a.Ib.finish()}else xa.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",
this.u4,l,c?c.status:3,c?c.oe:-1,this.Xa.podSessionId,this.cX?this.Xa.Kk:"Not Applicable"),this.zUf(l,this.uWa)||(f=3<=this.uWa?this.Sug[3]:this.Sug[this.uWa],this.uWa++,this.xpc(f),Tc.a.zk("FailureCountSinceLastSuccess",this.uWa.toString()),Tc.a.zk("NextDelayInMS",f.toString()),c&&(Tc.a.zk("RequestStatus",Ql.a[c.status]),Tc.a.zk("HttpStatus",c.oe.toString()),Tc.a.zk("Duration",(+c.pv-+c.Xt).toString())),Tc.a.Ib.finish());else xa.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",
this.u4)}zUf(a,b){return this.cX&&(a>=this.nEb||b>this.c5.getHostSessionInfoMaxRetryCount)?(xa.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",this.u4,b,this.Xa.Kk,this.Ze.wA),!0):!1}close(a){xa.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.u4,a);this.Gla=!0;this.kXa&&this.kXa.ytd()}xpc(a){const b=Tc.a.yk(this.u4,2);b.Va("DelayInMS",a.toString());this.c7c?Tc.a.Faa(()=>
{Tc.a.AF(b,Object(F.a)(this,this.i$g,"performCall"))},a,0):window.setTimeout(()=>{Tc.a.AF(b,Object(F.a)(this,this.i$g,"performCall"))},a)}i$g(){if(!this.enabled||u.AFrameworkApplication.Ug||this.mHa&&+new Date-+this.mHa<this.hEb||this.cX&&!this.mc.zL||this.O9.$Zc)xa.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",
this.u4,this.enabled,u.AFrameworkApplication.Ug,this.mHa?Tc.a.nf(this.mHa):"null",Tc.a.nf(new Date),this.hEb,this.O9.$Zc,!this.mc.Gn,!this.mc.zL);else{var a=Ug.a.create().toString();xa.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",this.u4,this.mHa?Tc.a.nf(this.mHa):"null",Tc.a.nf(new Date),this.hEb,this.cX?this.Xa.Kk:"Not Applicable",a);if(!this.cX){var b=Mj.e(this.pDb,x=>x.KeyRoot===
qg.a.pbh);b&&b.length&&xa.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.mHa=new Date;b=Tc.a.Ib;var c=new KK(this,b,this.Xa,this.Rd,this.c5,this.cX?null:this.WX);this.OFg=c.id;this.kXa=new SQ.a;var f=this.cX?this.Xa.Kk:"",l=this.cX?"":this.Xa.podSessionId;b.Va(ni.a.Rtb,a);this.iik(f,this.Xa.presentationId.string,this.pDb,x=>{c.Cvj(x,f)},x=>{c.Bvj(x,f,l)},this.kXa,{["X-CorrelationId"]:a},null,this.hEb)}}get enabled(){return 0<this.pDb.length&&!this.Gla}get cX(){return this.rUh}gsc(){this.Ze.Lga||
this.Ze.Nlc.task.continueWith(()=>{this.pIe()})}bZa(){this.hKa("PopSessionInitialized")}Rgb(){this.close("PopsUninitialized")}pIe(){this.Ze.wA?this.hKa("PopSessionInitialized"):this.close("PopsUninitialized");this.gsc()}qqc(a){a||(a=[]);xa.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.u4,a.length);for(const b of a);this.pDb=a;this.qHa=new Date;this.qFb=this.uWa=0;this.cX&&!this.Ze.Lga&&this.gsc();this.xpc(0)}ruf(a){Array.add(this.KX,a)}lxa(){this.hKa("AppListener:OnReboot")}hKa(a){xa.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.u4,a,this.cX?this.Xa.Kk:"Not Applicable");this.cX&&"PopSessionInitialized"===a&&this.S1k();this.Gla=!1;this.mHa=null;this.qHa=new Date;this.qFb=this.uWa=0;this.kXa&&this.kXa.ytd();this.xpc(0)}S1k(){for(const a of this.pDb)a.TimeStamp=0}dispose(){this.Oc.paa(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.vld(Object(F.a)(this,this.S0,"onSessionRehydrating"));this.Oc.Sfa(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.cX&&
this.Ze.Lga&&(this.Oc.Gih(Object(F.a)(this,this.Rgb,"onPopSessionClosed")),this.Oc.iRe(Object(F.a)(this,this.bZa,"onPopSessionInitialized")))}}Object(m.a)(zD,"DocNotifyClient",null,[304,106,305,1017]);class AD{constructor(){this.r1c=0}}Object(m.a)(AD,"TimeStampData",null,[]);class LK{constructor(){this.vGa={}}reset(){this.vGa={}}copy(a){this.reset();a=a.vGa;for(let f in a){var b=f,c=a[f];const l=new AD;l.r1c=c.r1c;this.vGa[b]=l}}TCl(a,b){var c=a in this.vGa?this.vGa[a]:new AD;this.vGa[a]=c;c=this.vGa;
for(let l in c){var f=c[l];l.startsWith(a)&&(f.r1c=b)}}P7d(a){return a in this.vGa?this.vGa[a].r1c:0}}Object(m.a)(LK,"HermesContentTimeStampManager",null,[306]);var Nx=d(303);class Ox{constructor(a,b,c,f=null){this.kke=a;this.lfa=b;this.$ic=c;this.Ba=f}}Object(m.a)(Ox,"SlideMoveData",null,[]);var TQ=d(647),Qj=d(301);class MK{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){this.Wcc=this.rva=null;this.XT=0;this.WF=null;this.nve=0;this.t3c=null;this.Vve=this.H7c=this.BAg=this.DAg=0;this.gJ=this.lIa=this.zX=
null;this.Kma=this.P7c=0;this.kq=a;this.Ea=b;this.ia=c;this.Vb=f;this.ua=l;this.au=x;this.oc=H;this.mc=U;this.gu=ja;this.w0=this.kq.EU;this.Hva=ya;this.pa=Va;this.Iq=hb;this.kn=yb;this.Tua=Zb}TDj(){this.XT=-1;this.rva=document.createElement("div");this.rva.style.visibility=mf.a.Qs;this.rva.className=Qj.a.$Oi;this.w0.appendChild(this.rva);this.nve=this.Kma=this.P7c=0;if(this.Tua){this.Wcc=document.createElement("div");this.Wcc.className=Qj.a.fpj;const a=document.createElement("span");a.className=Qj.a.gpj;
this.Wcc.appendChild(a)}}dispose(){this.w0.removeChild(this.rva);this.au.$E(this.w0,this);this.rva=this.WF=null}Cv(a){return a?this.TI(a).returnValue:!1}TI(a){var b=null;if(3===a.Xf||a.sA!==Sys.UI.MouseButton.leftButton||!this.w0.contains(a.Ec)||!this.mc.Gn)return{returnValue:!1,Rub:b,R3:null};var c=a.clientPoint.y-this.o2e+this.w0.scrollTop;b=a.clientPoint.x-this.w0.offsetLeft;this.gu&&(b-=this.w0.offsetWidth-this.w0.clientWidth);b=this.vmj(b,c);if(!b||!b.VN)return{returnValue:!1,Rub:b,R3:null};
if(this.Tua){a=this.pa.Qe();if(1>a.length)return{returnValue:!1,Rub:b,R3:null};for(var f of a)if(f.SN||32!==this.ia.La(K.a.dOe,1,f.Cb))return{returnValue:!1,Rub:b,R3:null};f=this.kq.ZY-this.pa.Qe().length+1;this.BAg=Math.min(this.l_f(c),f);this.DAg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,M.a.ix(c)||32!==this.ia.La(K.a.dOe,1,c))return{returnValue:!1,Rub:b,R3:null};return{returnValue:!0,Rub:b,R3:null}}Tu(a){if(!a)return!1;this.rva||this.TDj();this.t3c=TQ.a(0,0);if(!({Rub:this.zX,R3:H}=this.TI(a)).returnValue)return!1;
if(this.kn){var b=!1,c=this.zX.slideId,f=this.pa.Qe();for(var l of f)if(l.Cb.equals(c)){b=!0;break}if(b){if(this.gJ=this.ua.Ba,1<f.length&&!this.Tua)return!1}else this.pa.Qh(),this.gJ=this.zX.Fd,this.pa.JR(this.zX.Fd)}if(this.Tua){this.THh();var x=this.zX.nyb;var H=x.cloneNode(!0);b=H.getElementsByTagName("img")[0];this.$ph(b,Qj.a.Dae,Qj.a.Cae,Qj.a.AWf,Qj.a.AWf);H.className=Qj.a.b9f;c=this.pa.Qe();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.zX.slideIndex!==c[l].slideIndex){f++;x=this.kq.jT(c[l].slideIndex).nyb;
x=(x=x.getElementsByTagName("img"))&&0<x.length?x[0].cloneNode(!0):b.cloneNode(!0);const U=Qj.a.Cae*f;this.$ph(x,Qj.a.Dae-f,Qj.a.Cae-1,U,U);H.appendChild(x);if(3===f)break}H.appendChild(this.Wcc);this.Wcc.firstChild.innerText=this.pa.Qe().length.toString()}this.WF?this.kq.EU.replaceChild(H,this.WF):this.kq.EU.appendChild(H);this.WF=H}else b=this.zX.nyb,this.WF?(b=this.WF.getElementsByTagName("img"),H=H.cloneNode(!0),H.style.zIndex=String(Qj.a.Dae),this.WF.replaceChild(H,b[0]),this.WF.style.zIndex=
String(Qj.a.dpj)):(this.WF=b.cloneNode(!0),this.kq.EU.appendChild(this.WF),this.WF.className=Qj.a.b9f);this.nve=parseInt(Ef.a.Vt(this.WF).height);lf.a.Boa(this.WF,Qj.a.C8g+Qj.a.Y7g+Qj.a.Keg,this.gu);this.WF.style.visibility=mf.a.Dz;this.WF.style.cursor=mf.a.$rc;u.AFrameworkApplication.hk("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");xa.a.J(512497671,819,50,"PPT drag slide start.");this.Cw(a);return!0}THh(){this.H7c=this.BAg;this.Vve=this.DAg;let a=0;for(let b=0;b<
this.kq.ZY;b++){const c=this.kq.jT(b);c.isSelected?c.tuc(-2):(a===this.zX.slideIndex&&(a+=1),c.tuc(a),a++)}}$ph(a,b,c,f,l){a.className=Qj.a.cpj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}Cw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.o2e+this.w0.scrollTop,f=this.nve/2;if(this.Hva){if(B.a.yT&&!a.qc.rawEvent.buttons)return xa.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),
!1;this.WF.style.top=Math.min(c-f,this.Tua?Nx.a.kV+(this.kq.ZY-this.pa.Qe().length)*this.kq.zsa:Nx.a.kV+this.kq.ZY*this.kq.zsa)+"px"}else{a=this.W6b(this.kq.ZY)+this.kq.zsa/2;if(this.AVi(b.x)||c>a)return this.Dqh(),!0;this.WF.style.top=c-f+"px"}this.Zph(!0);this.Rqi(b.y);this.C$k(Math.min(this.l_f(c),this.Tua?this.kq.ZY-this.pa.Qe().length+1:this.kq.ZY));this.rva.style.visibility=this.x_c(b)&&!this.Tua?mf.a.Dz:mf.a.Qs;if(this.Tua&&0<=this.XT)if(this.x_c(b)){this.WF.style.visibility=mf.a.Dz;if(this.H7c===
this.XT)return!0;b=this.H7c<this.XT?0>this.XT-1?0:this.XT-1:0>this.XT?0:this.XT;c=0;for(f=0;f<this.kq.ZY;f++)a=this.kq.jT(f),a.isSelected||(c<b?a.tuc(c):a.tuc(c+1),c++);this.H7c=this.XT;this.Vve=b}else this.THh(),this.WF.style.visibility=mf.a.Qs;return!0}ao(a){if(!this.ua.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.Tua){if(a=this.pa.Qe(),0<a.length&&0<=this.XT&&this.x_c(b)){b=[];for(const c of a)c&&b.push(Object(oa.a)(115,c));this.nvl(b,this.Qjj(this.Vve));
xa.a.J(512497669,819,50,"PPT drag slide succeed.")}}else 0<=this.XT&&this.zX&&this.x_c(b)&&this.zX.slideIndex!==this.XT&&this.zX.slideIndex+1!==this.XT&&(this.hvl(this.zX.slideIndex,this.XT),xa.a.J(512497668,819,50,"PPT drag slide succeed."));this.UK()}Qjj(a){let b=0;for(let c=0;c<this.kq.ZY;c++)if(!this.kq.jT(c).isSelected&&(b++,a===b))return c+1;return 0}x_c(a){a=a.x>=this.w0.offsetLeft&&a.x<=this.w0.offsetLeft+this.w0.offsetWidth;return!this.Hva||a}ou(){this.UK()}vmj(a,b){if(!this.kq.zsa)return null;
var c=Math.floor((b-Nx.a.kV)/this.kq.zsa);if(0<=c&&c<=this.kq.ZY-1){c=this.kq.jT(c);if(!c)return null;const f=c.llb;a=this.gu?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}AVi(a){return this.gu?this.t3c.width-Qj.a.eQf>a||this.t3c.width<a:0>a||Qj.a.eQf<a}Rqi(a){const b=a-this.o2e,c=this.t3c.height;if(Qj.a.Uyf>b)this.Kma=-Qj.a.Tyf;else if(Qj.a.Wyf>
b)this.Kma=-Qj.a.Vyf;else if(Qj.a.Yyf>b)this.Kma=-Qj.a.Xyf;else if(c-Qj.a.Uyf<a)this.Kma=Qj.a.Tyf;else if(c-Qj.a.Wyf<a)this.Kma=Qj.a.Vyf;else if(c-Qj.a.Yyf<a)this.Kma=Qj.a.Xyf;else{this.Kma=0;return}this.h$g()}h$g(){if(0!==this.Kma){const a=this.P7c,b=(new Date).getTime();0<a&&(this.w0.scrollTop=Math.max(0,this.w0.scrollTop+Math.floor((b-a)*this.Kma/1E3)));this.P7c=b;window.setTimeout(Object(F.a)(this,this.h$g,"performAutoScrolling"),Qj.a.chi)}else this.P7c=0}W6b(a){return this.kq.zsa*a+Nx.a.kV*(this.Hva?
.75:1)}l_f(a){a+=this.kq.zsa/2;a-=Nx.a.kV;a=Math.floor(a/this.kq.zsa);return this.Hva?Math.max(0,a):a}C$k(a){this.XT!==a&&(this.XT=a,0>this.XT||(this.rva.style.top=lf.a.Pc(this.W6b(a))))}Dqh(){this.Zph(!1)}Zph(a){this.WF.style.cursor=a?mf.a.$rc:mf.a.orl}hvl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.lIa=cb.a.clone(this.ua.presentation.bK))&&!(b>this.lIa.length||a>=this.lIa.length)){var f=null;a=c.h$d(a);b&&(f=c.h$d(b-1));b=new Ox(!1,[a],f);this.ia.La(K.a.fjc,
2,b)}}nvl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.lIa=cb.a.clone(this.ua.presentation.bK))||b>this.lIa.length||!this.WPj(a,b)||(b=b?c.h$d(b-1):null,a=new Ox(!1,a,b,this.gJ),this.ia.La(K.a.fjc,2,a))}WPj(a,b){const c=Object.assign(new Ka.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);c.Sc((l,x)=>l-x);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}UK(){this.XBl();this.Dqh();this.WF.style.visibility=
mf.a.Qs;this.WF.style.top="0px";this.WF.style.cursor=mf.a.DA;this.rva.style.visibility=mf.a.Qs;if(this.Tua){const a=this.Iq.me(3);try{const b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.kd(b);a.gLa(this.kq.Ma);const c=b.slides||[];for(const f of c){const l=Object(oa.a)(116,f);l&&l.anchor.fk(this.kq.Ma,16)}}finally{a&&a.dispose()}this.kq.K_a()}this.Kma=0;this.zX&&(this.zX=null);this.Ea.Ae&&this.Ea.Ae.name===zb.a.XE||this.Ea.tf(zb.a.XE)}XBl(){this.kn?this.gJ&&(this.Vb.Ba=
this.oc.zl(this.gJ.Cb)):this.zX&&(this.Vb.Ba=this.zX.Fd)}get o2e(){let a=this.w0,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(m.a)(MK,"ThumbnailNavPaneDragAdapter",null,[314,240,106]);class BD{}BD.U3h=[K.a.print,K.a.find,K.a.h1,K.a.i8a,K.a.qid,K.a.pid,K.a.bringForward,K.a.bringToFront,K.a.sendBackward,K.a.sendToBack,K.a.fja,K.a.Lsd,K.a.Msd,K.a.h1a,K.a.g1a,K.a.nlb,K.a.mlb,K.a.D0a,K.a.cNb,K.a.WOb,K.a.Bpc,K.a.k6,K.a.RY,K.a.lUa,K.a.wkb,K.a.xkb,K.a.ykb,K.a.zkb,K.a.Qoc,K.a.Roc,K.a.Soc,K.a.Toc,
K.a.Dmd,K.a.ipc,K.a.ZSe,K.a.Emd,K.a.c7a,K.a.qSa,K.a.Rja,K.a.k0a,K.a.l0a,K.a.m0a,K.a.Jqc,K.a.vMb,K.a.aMb,K.a.sMb,K.a.Tjb,K.a.fkb,K.a.xI,K.a.jQ,K.a.z5,K.a.ogb,K.a.lgb,K.a.ngb,K.a.mgb,K.a.FZa,K.a.EZa,K.a.Ynk,K.a.lJk,K.a.avi,K.a.bvi,K.a.CEe,K.a.DEe,K.a.EEe,K.a.FEe,K.a.Bzk,K.a.Hvi,K.a.deleteComment,K.a.iUa,K.a.lXc,K.a.o0k,K.a.Znk,K.a.mJk,K.a.ltc,K.a.etc,K.a.gtc,K.a.ftc,K.a.jtc,K.a.itc];Object(m.a)(BD,"ActionHandledList",null,[]);class Ws{constructor(a,b,c,f){this.F0=new ui.a;this.hBe=new ui.a;this.ia=
a;this.Ha=b;this.pa=c;this.Og=f;this.vDj();this.wDj()}Msj(a,b,c=null){this.Ha.remapShapeEditCommandEnabled&&((this.pa.gH()||this.pa.Bs())&&this.F0.Hb(a)?a=this.F0.ga(a):this.pa.Xz()&&this.hBe.Hb(a)&&(a=this.hBe.ga(a)));if(this.Ha.podsTableRTTEnabled&&this.Ha.podsTableCellLockEnabled&&Array.contains(Ws.z4k,a)&&(this.pa.k9()||this.pa.FPj()))return 32;if(!Array.contains(BD.U3h,a))return this.ia.La(a,2,b,c);const f=this.ia.xq,l=this.ia.sT;let x=this.ia.La(a,1,b);32===x&&(this.Ha.pptDragCancelFix&&(this.ia.xq=
f,this.ia.sT=l),x=this.ia.La(a,2,b,c));return x}qhl(a){return this.Og.pvb!==a&&this.Og.qvb!==a}Hvb(a,b,c){return b&&b.name===zb.a.sg&&!this.pa.Bs()&&1===this.pa.Wd().length&&this.pa.Xz()&&this.qhl(c)?a.Hvb(a.Fc(b.parent),c):a.Hvb(b,c)}vDj(){this.F0.$(D.a.upArrow,K.a.zkb);this.F0.$(D.a.downArrow,K.a.wkb);this.F0.$(D.a.leftArrow,K.a.xkb);this.F0.$(D.a.rightArrow,K.a.ykb);this.F0.$(D.a.xMb,K.a.Toc);this.F0.$(D.a.gkb,K.a.Qoc);this.F0.$(D.a.t0a,K.a.Roc);this.F0.$(D.a.u0a,K.a.Soc);this.F0.$(D.a.Ksa,K.a.Bpc);
this.F0.$(D.a.JYa,K.a.nlb);this.F0.$(D.a.IYa,K.a.mlb);this.F0.$(K.a.fja,K.a.fsb);for(const a of Ws.R4k)this.F0.$(a,G.a.ve)}wDj(){for(const a of Ws.S4k)this.hBe.$(a,G.a.ve)}}Ws.R4k=[D.a.QCa,D.a.RCa,D.a.O1b,D.a.gub,D.a.$Qa,D.a.aRa,D.a.G7a,D.a.ZQa,D.a.kgb,D.a.YRa,D.a.A8a,D.a.jgb,D.a.XRa,D.a.z8a];Ws.S4k=[K.a.i8a,K.a.qSa,K.a.Rja,K.a.WOb];Ws.z4k=[D.a.backspace,D.a.$K,K.a.c7a];Object(m.a)(Ws,"ProcessInputStrategy",null,[311]);class NK{get lKc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,
8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(m.a)(NK,"PPTColorTable",null,[303]);var UQ=d(951);class OK{constructor(){this.L$c={}}D6d(a){return a&&a in this.L$c?this.L$c[a]:null}BAf(a,b){a&&b&&a!==b&&(a in this.L$c||(this.L$c[a]=b))}}Object(m.a)(OK,"PresenceEmailConverter",null,[1016]);var PK=d(895),Px;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=
3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";
a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";
a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=
30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=
39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Px||(Px={}));Object(m.b)("EntryName",Px);class QK{constructor(a,b,c,f){this.So=null;this.cAe=this.j9c=0;this.vxe=this.qBg=this.Pwe=this.l7c=!1;this.vpe=this.wpe=this.xve=this.Ope=this.Xue=0;this.w3c=this.$se=null;this.L9c=new ik.a;this.NQg=new ik.a;this.wIg=new ik.a;this.Qte=this.Vte=!1;this.Yfc=a;this.HAe=b;this.wj=c;f.execute(l=>{this.So=l});this.UX={};il.Task.WAA(this.wj.yCa,this.L9c.task,this.NQg.task).continueWith(()=>
{try{this.Cph(),this.COc(this.UX),0<pa.a.count(this.UX)&&ia.ULS.sendTraceTag(51242144,814,15,pa.a.toJSON(this.UX)),this.Vte=!0}catch(l){ia.ULS.sendTraceTag(51242145,814,10,l.toString())}});il.Task.WAA(this.wj.yCa,this.wIg.task).continueWith(()=>{try{this.Cph(),this.COc(this.UX),0<pa.a.count(this.UX)&&ia.ULS.sendTraceTag(594879178,814,15,pa.a.toJSON(this.UX)),this.Qte=!0}catch(l){ia.ULS.sendTraceTag(594879177,814,10,l.toString())}});this.i4c={};this.cve={}}$Ri(a){this.XFc(a,8,"g_hermesPresenceJS");
this.XFc(a,20,"g_hermesPresence1JS");this.XFc(a,18,"g_JquerySignalRMergeJS");this.XFc(a,19,"g_JquerySignalRMergeJSEnd")}XFc(a,b,c){b=Px[b];b in a||(c=this.Saj(c),0<c&&this.tia(a,b,c))}Saj(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.dXf();this.UZi();this.cFh();this.UX=this.cve=this.i4c=null}jSi(){this.lra(25)}iSi(){this.lra(12)}w3j(){this.lra(15);0<this.appInitChromeReady&&this.lra(16)}dSi(a){try{this.j9c||(this.j9c=a,this.Zh(17,this.j9c),this.Zh(13,this.s2f(this.B2I,this.j9c)),
this.wIg.PM(!0))}catch(b){ia.ULS.sendTraceTag(594879176,814,10,b.toString())}}Y1j(a,b){this.Zh(6,a);this.Zh(5,b)}eSi(){this.cAe||(this.cAe=Date.now(),this.Zh(31,this.cAe),this.dXf())}fSi(){this.lra(28)}gSi(){this.lra(27)}hSi(){this.lra(40)}pCk(a){const b=[];for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}kSi(a){a&&(a=this.pCk(a),this.Zh(38,a.length),this.Zh(37,0<a.length),this.lra(39));this.NQg.Gg(!0)}p2j(a){try{this.L9c.task.isCompleted||pa.a.Wa(a)||(this.lra(34),this.L9c.PM(!0))}catch(b){ia.ULS.sendTraceTag(51242146,
814,10,b.toString())}}q2j(a){if(!(pa.a.Wa(a)||"presenceUpdateNotificationReceived"in this.UX)){var b=Date.now();this.Zh(33,b);this.xve=this.s2f(this.B2I,b);this.Zh(32,this.xve);this.Zh(30,pa.a.count(a));this.So&&this.Zh(29,this.So.SUf)}}GVi(){return!this.L9c.task.isCompleted&&(!this.So||!this.So.SUf)&&!this.xve}o2j(){this.lra(35);this.wj.cQc&&this.Zh(36,this.wj.cQc.getTime())}ySi(){this.HAe&&!this.l7c&&(this.l7c=!0,this.HAe.Wtf(Object(F.a)(this,this.rkc,"onResourceTimingEntriesAvailable")))}rkc(a,
b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=bg.a.boa(f.url);!this.Pwe&&l.endsWith("rtc2/signalr/negotiate")?(this.Pwe=!0,this.mGc(a,"Negotiate",f.NB)):l.endsWith("rtc2/signalr/connect")?(this.qBg=!0,this.mGc(a,"Connect",f.NB)):!this.vxe&&l.endsWith("rtc2/signalr/start")?(this.vxe=!0,this.mGc(a,"Start",f.NB)):l.endsWith("rtc2/findsession")&&(this.mGc(a,this.Xue.toString()+"_FindSession",f.NB),this.Xue++)}if(this.Pwe||this.qBg||this.vxe||0<this.Xue)this.cFh(),this.cXf(a)}catch(c){ia.ULS.sendTraceTag(51242147,
814,10,c.toString())}}mGc(a,b,c){this.tia(a,b+"FS",c.fetchStart);this.tia(a,b+"RS",c.responseStart);this.tia(a,b+"RE",c.responseEnd)}cFh(){this.l7c&&(this.l7c=!1,this.HAe.cih(Object(F.a)(this,this.rkc,"onResourceTimingEntriesAvailable")))}lra(a){this.Zh(a,Date.now())}Zh(a,b){this.t5h(Px[a],b)}t5h(a,b){this.tia(this.i4c,a,b);this.tia(this.UX,a,b)}tia(a,b,c){b in a||(a[b]=c)}COc(a){this.$Ri(a);this.tia(a,"B2I",this.B2I);null!=this.fHasTabSwitch&&this.tia(a,"fHasTabSwitch",this.fHasTabSwitch);null!=
this.w3c&&this.tia(a,"firstCoauthoringStatus",this.w3c);this.appInitInteractivityReady&&this.tia(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.tia(a,"appInitChromeReady",this.appInitChromeReady)}Cph(){null==this.w3c&&(this.w3c=this.wj.yCa.result)}dXf(){this.cXf({})}cXf(a){try{this.COc(this.i4c),pa.a.forEach(this.i4c,(b,c)=>{b in this.cve||(this.cve[b]=c,a[b]=c)},null),0<pa.a.count(a)&&ia.ULS.sendTraceTag(41239941,828,50,pa.a.toJSON(a))}catch(b){ia.ULS.sendTraceTag(51242176,
814,10,b.toString())}}UZi(){ia.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.Vte,this.Qte);if(!this.Vte||!this.Qte)try{this.COc(this.UX),0<pa.a.count(this.UX)&&ia.ULS.sendTraceTag(51242178,814,50,pa.a.toJSON(this.UX))}catch(a){ia.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.Ope&&Cg.a.instance.Io(ai.a.contentEditable)&&(this.Ope=Cg.a.instance.hh(ai.a.contentEditable));return this.Ope}get appInitInteractivityReady(){!this.wpe&&
Cg.a.instance.Io("AppInitStatus_interactivityReady")&&(this.wpe=Cg.a.instance.hh("AppInitStatus_interactivityReady"));return this.wpe}get appInitChromeReady(){!this.vpe&&Cg.a.instance.Io("AppInitStatus_chromeReady")&&(this.vpe=Cg.a.instance.hh("AppInitStatus_chromeReady"));return this.vpe}get fHasTabSwitch(){null==this.$se&&Cg.a.instance.Io(ai.a.Bvd)&&(this.$se=Cg.a.instance.hh(ai.a.Bvd));return this.$se}s2f(a,b){return this.Yfc?this.Yfc.H4f(new Date(a),new Date(b)):-1}}Object(m.a)(QK,"PresencePerfLogger",
null,[308,106]);class RK{constructor(a,b,c){this.fSg=this.bdc=this.B4c=this.Yma=null;this.tse=!1;this.WAe=null;this.ji=a;this.c5=b;this.Gq=c}NUc(){this.hvb();return this.Yma}I8i(){this.hvb();return this.B4c}getFindSessionResponse(){return this.ji?this.ji.FindSessionResponse:null}n1f(){this.hvb();return this.bdc}Dhj(){this.hvb();return this.fSg}Bhj(){this.hvb();return this.WAe}Vpd(){this.hvb();return this.tse}u3j(){if(this.ji){const a=!!this.ji.PresenceException,b=!isNaN(this.ji.PresenceDownloadEditorTableHttpStatus)&&
200!==this.ji.PresenceDownloadEditorTableHttpStatus||!isNaN(this.ji.PresenceFindSessionHttpStatus)&&200!==this.ji.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.c5.presenceEarlyFindSessionEnabled;c.EditorCount=this.B4c?this.B4c.length:0;c.ShouldConnectToRtcByDefault=this.tse;c.EditorTableHttpStatus=this.ji.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.ji.PresenceFindSessionHttpStatus;c.CachedException=this.ji.PresenceException;c.IsFindSessionResponseEmpty=!this.ji.FindSessionResponse;
c.IsEditorTableResponseEmpty=!this.ji.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.WAe;xa.a.J(41501202,804,a||b?15:50,pa.a.toJSON(c))}}hvb(){if(this.ji&&!this.Yma)try{if(this.ji.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.ji.CoauthHandlerResponse);this.B4c=a.EditorTable;this.Yma=a.UserName;this.bdc=a.Email;this.fSg=a.RtcEndpointUrl;this.tse=a.FConnectByDefault;this.WAe=a.RtcBootToken;this.Gq.b5g()}}catch(a){xa.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+
a)}}}Object(m.a)(RK,"PresencePrepCacheParser",null,[317]);class CD{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=u.AFrameworkApplication.userSessionId;this.Kmd=u.AFrameworkApplication.Kmd;this.yca=u.AFrameworkApplication.Ke;this.Lw=b;this.dph=c;this.hmh=f}}Object(m.a)(CD,"RtcParams",null,[]);class SK{constructor(a,b,c){this.a5j=a;this.TAe=b;this.o2c=c}jti(a,b,c){Ca.a.Au(a);Ca.a.Au(b);Ca.a.Au(c)}$Pd(a,b,c,f){return f=!a&&0>b?f+
Math.abs(b):this.a5j?(c-b)/4:(c-b)/2}aQd(a,b,c){if(!this.o2c||!b)return c;if(0<=b.className.indexOf(Hc.a.CN))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.pUc(b,ca.a.K1c),l=this.pUc(b,ca.a.tQc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const x=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,x.y+=c,x.height-=2*c,x;a=this.Ajj(b,a);if(isNaN(a)||!a)return c;c=(a-f)/2;x.y+=c;x.height-=2*c;return x}hkj(a,b){if(!this.o2c)return 0;a=this.pUc(a,ca.a.K1c);b=
Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}Ajj(a,b){let c=Object(oa.a)(1012,b);b||(c=Object(oa.a)(1012,this.TAe.f6b(a)));if(c&&this.TAe.IKj(c))return this.pUc(a,ca.a.tQc);b=0;const f=a.getClientRects();f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.TAe.Cga(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}pUc(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=V.a.Be(c,b),c=0<=c.className.indexOf(Hc.a.Uac)?
c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(SK,"PptMeasureBoundsUsingSpansStrategy",null,[312]);class DD{constructor(){this.sIa=null}get Fic(){return this.sIa?this.sIa.Fic:0}get $qc(){return this.sIa?this.sIa.$qc:!1}get Zpd(){return this.sIa?this.sIa.Zpd:!1}U0b(a,b){b&&(this.sIa?this.sIa.U0b(a,b):b(null))}eii(a){this.sIa=a}}Object(m.a)(DD,"PPTProcessImageStrategyProxy",null,[1009,1010]);class ED{constructor(a,b){this.NXh=a;this.Fkf=b}get hBk(){return this.NXh}get CJe(){return this.Fkf}Xbl(a){this.Fkf=
a}}Object(m.a)(ED,"PageHiddenRecord",null,[]);class TK{constructor(){this.tma=[];xa.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.Xwe=window.document.hidden){const a=new ED(new Date,new Date(9999,12,31));this.tma.push(a)}Db.a.instance.ub("Common.ITaskManager").Db(new af.a(4,2,9E5,Object(F.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(F.a)(this,this.onVisibilityChange,"onVisibilityChange"))}H4f(a,b){const c=this.tma.length;
let f=0;if(0<c&&a<this.tma[c-1].CJe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const x=Math.max(this.tma[l].hBk.getTime(),a),H=Math.min(this.tma[l].CJe.getTime(),b);x<H&&(f+=H-x)}}return f}onVisibilityChange(){xa.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.$Rk()}$Rk(){var a=window.document.hidden,b=new Date;this.Xwe!==a&&((this.Xwe=a)?(b=new ED(b,new Date(9999,12,31)),this.tma.push(b)):(a=this.tma.length,0<a&&this.tma[a-1].Xbl(b)))}maintainPageHiddenRecords(){const a=
new Date;for(;0<this.tma.length&&9E5<+a-+this.tma[0].CJe;)Array.removeAt(this.tma,0)}}Object(m.a)(TK,"PageHiddenMeter",null,[302]);class FD{W5(a){let b=K.a.Wz(a);return b||(b=D.a.Wz(a))?b:(b=G.a.Wz(a))?b:""}}Object(m.a)(FD,"ActionNameResolver",null,[1011]);class GD{constructor(){this.va=new wc.a}sNk(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}tNk(a){this.va.raiseEvent("CSC",a)}INk(a){this.va.raiseEvent("ETC",a)}Reh(a){this.va.raiseEvent("TLSC",a)}IPk(a){this.va.raiseEvent("TCVEL",a)}JOk(){this.va.raiseEvent("PRTCC",
null)}mOk(){this.va.raiseEvent("LCK",null)}fPd(a){this.va.addHandler("CSC",a)}UQe(a){this.va.removeHandler("CSC",a)}gPd(a){this.va.addHandler("ETC",a)}bih(a){this.va.removeHandler("ETC",a)}mbi(a){this.va.addHandler("TLSC",a)}b_k(a){this.va.removeHandler("TLSC",a)}ebi(a){this.va.addHandler("TCVEL",a)}dai(a){this.va.addHandler("PRTCC",a)}Hih(a){this.va.removeHandler("PRTCC",a)}s9h(a){this.va.addHandler("LCK",a)}}Object(m.a)(GD,"CoauthEventSource",null,[1006,1007,1008]);class HD{constructor(){this.va=
new wc.a}yPk(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}ZNk(a){this.va.raiseEvent("OnImageDescriptionReady",a)}NNk(a){this.va.raiseEvent("FRHRE",a)}mNk(a){this.va.raiseEvent("APIRE",a)}fOk(a){this.va.raiseEvent("IMARE",a)}N$h(a){this.va.addHandler("OnShowHideAltTextPane",a)}fZk(a){this.va.removeHandler("OnShowHideAltTextPane",a)}k$h(a){this.va.addHandler("OnImageDescriptionReady",a)}MYk(a){this.va.removeHandler("OnImageDescriptionReady",a)}d$h(a){this.va.addHandler("FRHRE",
a)}HYk(a){this.va.removeHandler("FRHRE",a)}D9h(a){this.va.addHandler("APIRE",a)}rYk(a){this.va.removeHandler("APIRE",a)}n$h(a){this.va.addHandler("IMARE",a)}OYk(a){this.va.removeHandler("IMARE",a)}}Object(m.a)(HD,"CoreExtEventSource",null,[1003,1004,1005]);var UK=d(1030);class ID extends UK.a{constructor(a,b,c,f,l,x,H){super(f,c,a,x,H);this.h3c=new Rd.a(0);this.ZVa=b;this.nye=l}lDj(a,b){let c;(c=this.h3c).$(b,c.ga(b)+1);this.SRf(a.name,Object(F.a)(this,this.$dg,"initPackageCallback"),a)}mDj(a,b){let c;
(c=this.h3c).$(b,c.ga(b)+1);this.TRf(a.name,Object(F.a)(this,this.$dg,"initPackageCallback"),1,a)}$dg(a){a.kDj()}Xuh(a,b){return!!a&&!!b&&a.context.UAf!==b.context.UAf}xHe(a,b){if(b>=this.nye){const c=new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,bf.a.CY(a[f].duration,0)));ia.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),bf.a.CY(b,0))}}onIdle(a){const b=[];this.h3c.forEach((c,f)=>{0<f&&(b.push(c),this.h3c.$(c,
0),this.ZVa.g2c(c));return!0});ia.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),bf.a.CY(a,0))}}Object(m.a)(ID,"DelayLoadedPackageInitializer",UK.a,[]);class Qx{constructor(a,b,c,f,l,x,H,U,ja){this.qBe=this.pBe=null;this.Ha=a;this.kJ=b;this.Gq=c;this.wj=f;this.ia=l;this.lH=x;this.Rb=H;this.qe=ja;this.ggk=U;this.kJ.gPd(Object(F.a)(this,this.UQf,"editorTableUpdate"))}dispose(){this.kJ.bih(Object(F.a)(this,this.UQf,"editorTableUpdate"))}UQf(){const a=this.wj.g_;this.uSf();this.Gq.C_c&&(xa.a.J(512496593,
814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.wj.bD,a.length),this.ia.processAction(G.a.k7a,2))}uSf(){if(!this.Gq.C_c&&this.wj.bD){xa.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Rb)throw Error.create("Presence is being loaded before the app frame");this.Ixl()}catch(a){xa.a.J(512496591,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}Ixl(){xa.a.J(512496590,
814,50,"App::EnsurePresence: trigger download js");if(this.Ha.euc)Db.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.presence",null,()=>d.e(11).then(d.bind(null,1244)));else{const a=Kx.a.create("pptedit.presence",this.NFi(),()=>d.e(11).then(d.bind(null,1244)));cl.a.ey(a)}}NFi(){this.twh.DS((a,b)=>{this.ggk.Lle=b.succeeded});return[this.twh]}get $ml(){this.qBe||(this.qBe=this.J3f());return this.qBe}get twh(){this.pBe||(this.pBe=this.KGi());return this.pBe}KGi(){return this.Gcj()}Gcj(){return eD.a.create(this.J3f(),
null,null,Oc.App.nmg)}J3f(){return this.Ha.podsUseVersionLessJqueryAndSignalR?this.qe.Wnj("jquery.signalr.merge.1.1"+Qx.sTd):u.AFrameworkApplication.Aj("jquery.signalr.merge.1.1",2)}}Qx.sTd=".min.js";Object(m.a)(Qx,"PresenceLoader",null,[]);class VK{constructor(a,b,c,f,l,x,H,U,ja){this.WGa=this.XGa=!1;this.Pla=this.Hla=null;this.Ha=a;this.ly=b;this.AX=c;this.Fa=f;this.cdb=l;this.ive=x;this.zb=H;this.JC=U;this.iz=ja;this.H4=this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.cdb.Emg}Rkd(a){if(this.H4&&
a&&!a.Al&&a.Tzb)if(a.tme)a.tme=!1;else if(this.Fa.cZc(a.shapeNode)){var b=this.Fa.JUc(a.shapeNode);b.length&&(this.iz&&this.iz.isEnabled||this.iz&&this.iz.isEnabled?(this.Hla=this.Pla=null,this.WGa=this.XGa=!1,this.iz&&this.iz.isEnabled&&this.iz.WS&&(this.iz.mab(c=>{xa.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.Pla=c;this.GNc(a,b)}),this.iz.WS.nab(()=>{xa.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.XGa=!0;this.GNc(a,b)})),this.JC&&this.JC.isEnabled&&this.JC.WS&&
(this.JC.mab(c=>{xa.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.Hla=c;this.GNc(a,b)}),this.JC.WS.nab(()=>{xa.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.WGa=!0;this.GNc(a,b)}))):this.oEh(a,b,null,null))}}hFa(a){return a?!0:!1}GNc(a,b){(this.hFa(this.Hla)&&this.hFa(this.Pla)||this.hFa(this.Hla)&&this.XGa||this.WGa&&this.hFa(this.Pla)||this.WGa&&this.XGa)&&this.oEh(a,b,this.Hla,this.Pla)}oEh(a,b,c,f){a&&!a.Al&&b&&b.length&&(xa.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),
Promise.all(this.ive.BJh(b,c,Object(F.a)(this.JC,this.JC.createFontUrl,"createFontUrl"),f,Object(F.a)(this.iz,this.iz.createFontUrl,"createFontUrl"),this.AX.LIh,Object(F.a)(this.AX,this.AX.createFontUrl,"createFontUrl"))).then(()=>{xa.a.J(41521288,801,50,"WebFontsLoadCompleted");this.ly.bFa(()=>{this.zb.Db(new af.a(2,1,0,()=>{a&&!a.Al&&(xa.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.wDa(),a.tme=!0,a.FA())},90,"109"))})},l=>{xa.a.J(41494541,801,10,"WebFontsLoad failed: {0}",
l.toString());a&&!a.Al&&a.shapeNode&&(a.shapeNode.STa=!0)}))}}Object(m.a)(VK,"RemoveShapeFidelityViewForEmbeddedFontController",null,[316]);class WK{constructor(a,b,c,f,l,x,H,U,ja){this.WGa=this.XGa=!1;this.Pla=this.Hla=null;this.uma=new Ka.a;this.Xua=a;this.jn=b;this.AX=c;this.Fa=f;this.cdb=l;this.ive=x;this.zb=H;this.JC=U;this.iz=ja}FWk(a){window.self.Promise&&this.cdb.Emg?this.zb.Db(new af.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){xa.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",
b),this.JOb(a)}},90,"102")):this.JOb(a)}JOb(a){if(a&&a.length){for(var b of a)b.Al||(b.Tzb=!0,b.FA()),this.jn.Oqh();b=0;Cg.a.instance.Io(ai.a.cQ)&&(b=(new Date).getTime()-Cg.a.instance.hh(ai.a.cQ));xa.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.uma.count,b);if(0<this.uma.count){const c=new Map;c.set("PendingFontsCount",this.uma.count.toString());c.set("FidelityViewDuration",b.toString());kf.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",
["MissingFont"],!1,!1,!0,!1,Object.assign(new Oj.a,{extendedProperties:c}))}a.length=0;xa.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){xa.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.Al&&b.dB&&b.wDa();b=new Date;for(const c of a)if(!c.Al){const f=this.Fa.n$a(c.shapeNode);for(const l of f)this.uma.contains(l)||this.uma.add(l)}xa.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.uma.count){if(!this.iz||
!this.iz.isEnabled)if(!Ud.a("EnableRemoveFidelityCloudServiceCheck")||!this.JC||!this.JC.isEnabled){this.qhh(a,this.uma,null,null);return}this.Hla=this.Pla=null;this.WGa=this.XGa=!1;this.iz&&this.iz.isEnabled&&(this.iz.mab(c=>{xa.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.Pla=c;this.HNc(a,this.uma)}),this.iz.WS&&this.iz.WS.nab(()=>{xa.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.XGa=!0;this.HNc(a,this.uma)}));this.JC&&this.JC.isEnabled&&(this.JC.mab(c=>{xa.a.J(40429075,
801,50,"CloudFontListDownloadAndParseCompleted");this.Hla=c;this.HNc(a,this.uma)}),this.JC.WS&&this.JC.WS.nab(()=>{xa.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.WGa=!0;this.HNc(a,this.uma)}))}else xa.a.J(40429071,801,50,"No unsupported fonts"),this.JOb(a)}hFa(a){return a?!0:!1}HNc(a,b){(this.hFa(this.Hla)&&this.hFa(this.Pla)||this.hFa(this.Hla)&&(this.XGa||Ud.a("FidelityCustomServiceDisableCheck")&&!this.iz.isEnabled)||this.WGa&&this.hFa(this.Pla)||this.WGa&&this.XGa)&&this.qhh(a,b,this.Hla,
this.Pla)}qhh(a,b,c,f){b&&b.count?(xa.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.ive.BJh(b.toArray(),c,Object(F.a)(this.JC,this.JC.createFontUrl,"createFontUrl"),f,Object(F.a)(this.iz,this.iz.createFontUrl,"createFontUrl"),this.AX.LIh,Object(F.a)(this.AX,this.AX.createFontUrl,"createFontUrl"))).then(l=>{xa.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let x=0;x<l.length;x++)if(l[x])for(let H=0;H<l[x].length;H++)if(l[x][H]){xa.a.J(40429081,801,50,"Status {0}",
l[x][H].status);const U=l[x][H].family;ha.a.Wa(U)||l[x][H].status!==zg.loaded||-1===U.lastIndexOf("_")||b.remove(U.substring(0,U.lastIndexOf("_")))}this.JOb(a)},l=>{xa.a.J(41521304,801,10,"WebFontsLoad failed: {0}",l.toString());this.zb.Db(new af.a(2,1,this.Xua.pptWaitForWebFontsLoadingTimeoutMs,()=>{xa.a.J(40429073,801,50,"Check removing Fidelity View");this.JOb(a)},90,"103"))})):this.JOb(a)}}Object(m.a)(WK,"RemoveShapeFidelityViewOnBootController",null,[315]);class XK{constructor(a){this.ia=a}Hml(){this.iwh(ResourceStrings.l_SessionTimeoutErrorMessage)}Iml(){this.iwh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}iwh(a){const b=
new jj.StandardDialog;b.xd=4;b.hg="PPTTimeoutDialog";b.Xe(1,ResourceStrings.L_Refresh);b.Xe(2,ResourceStrings.L_Close);b.fP(ResourceStrings.l_GenericDialogTitle,a,Object(F.a)(this,this.Z8k,"sessionTimeoutDialogHandler"))}Z8k(a,b){1===a?(xa.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.ril()?(xa.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(K.a.refreshPage,2)):this.ia.La(K.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):
(xa.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(K.a.Nvb,2))}ril(){const a=u.AFrameworkApplication.im,b=u.AFrameworkApplication.oia;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(m.a)(XK,"SessionTimeoutIndicator",null,[309]);class YK{constructor(){this.q7c=!1;this.tIg=[]}get Lle(){return this.q7c}set Lle(a){if(!this.q7c&&(this.q7c=a)){for(const b of this.tIg)b();Array.clear(this.tIg)}}}Object(m.a)(YK,"SignalRLoadCompletedListener",null,[310]);class Nz{constructor(a,
b,c,f,l,x,H){this.RTg=this.vEg=!1;this.efa=this.CBe=null;this.uHg=this.txe=!1;this.STg=this.TTg=this.XHg=this.YHg=0;this.ia=a;this.d7j=b;this.Rp=f;this.PBe=x;this.Lc=l;this.Vj=H;this.Lc.$tf(Object(F.a)(this,this.Juk,"onLazySorterViewActorActionRegistrationHandler"))}wb(){this.Vj||(this.ia.ya(K.a.jga,Cb.a.application,Object(F.a)(this,this.wml,"showStatusBarSorterView")),this.ia.ya(K.a.vtb,Cb.a.application,Object(F.a)(this,this.Fui,"closeStatusBarSorterView")))}wml(a,b,c,f,l){if(2!==c)return 32;if(this.txe)return this.PBe.instance.jga(a,
b,c,f,l);this.Lc.$tf(Object(F.a)(this,this.rxh,"sorterViewEventHandler"));this.t0j();this.vEg||(this.Xne(),this.uHg=!0);return 32}Fui(a,b,c,f,l){if(2!==c)return 32;this.Lc.kYk(Object(F.a)(this,this.rxh,"sorterViewEventHandler"));(this.efa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.efa);return this.txe?this.PBe.instance.vtb(a,b,c,f,l):32}Xne(){this.RTg||(this.RTg=!0,this.CBe=this.s0j(),this.CBe.DS(Object(F.a)(this,this.cyk,
"onSlideSorterGridLoaded")),cl.a.ey(this.CBe),this.YHg=Date.now())}cyk(){this.vEg=!0;this.Rp&&this.Rp.R5("SlideSoterGridDownloadFinished");this.XHg=Date.now();const a=Cg.a.instance;a&&(a.ic("SlideSorterOnDemandLoad",this.uHg),a.ic("SlideSorterPkgST",this.YHg),a.ic("SlideSorterPkgET",this.XHg))}t0j(){this.ia.processAction(K.a.j0b,2);this.efa=lf.a.Ie();this.efa.id="SlideSorterViewLoadingElementId";this.efa.className="sorterview-ui-loading-element-class";const a=lf.a.Ie();a.className="sorterview-ui-loading-textmessage-class";
a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=lf.a.Ie();b.className="sorterview-ui-loading-spinner-class";const c=lf.a.Ie();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.efa.appendChild(b);this.efa.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.efa);this.TTg=Date.now()}rxh(){(this.efa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.efa);this.STg=
Date.now();this.PBe.instance.jga(K.a.jga,null,2,null,null);const a=Cg.a.instance;a&&(a.ic("SlideSorterLoadingExpST",this.TTg),a.ic("SlideSorterLoadingExpET",this.STg))}Juk(){this.txe=!0}s0j(){var a=u.AFrameworkApplication.Aj("slidegrid"+Nz.sTd,5);a=this.d7j.$tb(a);return Kx.a.create("pptedit.sorterGrid",this.Vj?null:[a],()=>d.e(16).then(d.bind(null,1249)))}dispose(){}}Nz.sTd=".min.js";Object(m.a)(Nz,"SorterViewActorMain",null,[106,318]);class Dv{constructor(a){this.njf=a}onBlur(a,b){this.roe("OnBlur",
a,b);(a=sa.InteractiveViewManager.instance.Pd)&&v.FocusManager.SM()&&a.endEditing(!1,20)}setFocus(a,b){this.roe("SetFocus",a,b);const c=this.njf();c&&!c.isActive&&(a.name!==S.AppFrame.Syj&&a.name!==S.AppFrame.t_i||b.name!==E.AFrame.yW||(c.cqd=!1),c.QSi())}onFocus(a,b){this.roe("OnFocus",a,b);if(v.FocusManager.SM()&&(b=this.njf())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";B.a.Ni&&(a.startsWith(xi.a.p2b)&&(ig.GrippersManager.instance.Y7b=!0),a.startsWith(xi.a.p2b)||a===E.AFrame.hgb||a===E.AFrame.Jzh)&&
(c=!1);c&&this.PSi(b,a)}}PSi(a,b){const c=a.editingView,f=v.FocusManager.instance();f.yde=!0;a.QR();1===c.mode&&3!==u.AFrameworkApplication.Ta.mode&&b===E.AFrame.hgb&&(a.Lb.bpa.x4d(),c.pjb());f.yde=!1}roe(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);gm.a.instance.tw&&ia.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static DHf(a){const b=
new Dv(()=>a),c=a.DI,f=v.FocusManager.instance();f.Fc(c).OBa(Object(F.a)(b,b.onBlur,"onBlur"));f.Fc(c).M7(Object(F.a)(b,b.setFocus,"setFocus"));f.Fc(c).kca(Object(F.a)(b,b.onFocus,"onFocus"))}}Object(m.a)(Dv,"InteractiveViewFocusScopeActions",null,[]);class JD extends Dv{constructor(a){super(()=>a);this.Fb=a}nBk(){this.Fb.isActive||this.Fb.uSi()}static Hyi(a,b){const c=new JD(a);a=a.DI;b.Fc(a).OBa(Object(F.a)(c,c.onBlur,"onBlur"));b.Fc(a).M7(Object(F.a)(c,c.nBk,"pageViewSetFocus"));b.Fc(a).kca(Object(F.a)(c,
c.onFocus,"onFocus"))}}Object(m.a)(JD,"PageViewInteractiveViewFocusScopeActions",Dv,[]);class Oz{constructor(){this.Ha=this.K=null;this.bEg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Zb(a){this.K=a;this.Ha=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ha.ggg&&a.register(302,"PowerPointWebEditor.IPageHiddenMeter").ma().oa(()=>new TK);Oz.dyi(this.K);a.register(GD,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().oa(()=>
new GD);a.register(HD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().oa(()=>new HD);a.register(303,"Common.IColorTable").ma().oa(()=>new NK);a.register(Mz,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().oa(()=>new Mz(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new mc.a(()=>Db.a.instance.Ja("Common.IRenameProps"))));a.register(304,"PowerPointWebEditor.IDocNotifyClient").ma().oa(()=>new zD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ha.vg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,x,H)=>{a.resolve("PowerPointWebEditor.IPPTWebService").gae(c,f,l,x,H)},!1));a.register(305,"PowerPointWebEditor.IPodsDocNotifyClient").ma().oa(()=>new zD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,x,H,U,ja,ya)=>{a.resolve("PowerPointWebEditor.IPopWebService").LTc(b,c,f,l,x,H,U,ja,ya)},!0));a.register(306,"PowerPointWebEditor.IContentTimeStampManager").ma().oa(()=>new LK);a.register(Cv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().oa(()=>new Cv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ha.vg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ha.OPe,this.Ha.podsPushThumbnailImageIds));a.register(yD,"PowerPointWebEditor.CoauthNotificationManager").ma().oa(()=>new yD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ha.vg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ja("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ha,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Qx,"PowerPointWebEditor.PresenceLoader").ma().oa(()=>new Qx(this.Ha,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(OK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(307,"PowerpointPresence.IPresenceColorProvider").ma().oa(()=>new UQ.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").qlg,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(308,"PowerpointPresence.IPresencePerfLogger").ma().oa(()=>new QK(a.ub("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(CD,"PowerpointPresence.RtcParams").ma().oa(()=>new CD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").bD,a.resolve("PowerPointWebEditor.IApplicationContext").h7f(),a.Ja("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").Bc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(309,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().oa(()=>
new XK(a.resolve("Common.IActionManager")));a.register(310,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().oa(()=>new YK);a.register(wD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().oa(()=>new wD(this.Ha,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ja("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ja("PowerPointWebEditor.ICommentSessionManager")));a.register(vD,"PowerPointWebEditor.SessionCleanupHandler").ma().oa(()=>new vD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(311,"Common.IProcessInputStrategy").ma().oa(()=>new Ws(a.resolve("Common.IActionManager"),this.Ha,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Ha.Jn||a.register(PK.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().oa(()=>
new PK.a);a.register(312,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().oa(()=>new SK(this.Ha.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ha.flg));a.register(313,"Box4.TextMetricsApi.ITextMetricsHelper").ma().oa(()=>new fa);a.register(314,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().oa(()=>new MK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),u.AFrameworkApplication.isRtl,this.Ha.olg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ha.FC,this.Ha.ble));a.register(315,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().oa(()=>
new WK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(316,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().oa(()=>
new VK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(FD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().oa(()=>
new FD);a.register(DD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().oa(()=>new DD);a.register(ID,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().oa(()=>{let b=2;const c=Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:xa.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new ID(Db.a.instance.resolve("Common.ITaskManager"),
Db.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),Db.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(317,"PowerpointPresence.IPresencePrepCacheParser").ma().oa(()=>new RK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(318,"PowerPointWebEditor.ISorterViewActorMain").oa(()=>new Nz(u.AFrameworkApplication.Ta,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").Ome,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ja("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Jn)).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&Cg.a.instance.ic("FirstExtJsExecTime",a);a=new BB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Kka&&this.W1g();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").bFa(()=>{this.K.resolve("Common.ITaskManager").Db(new af.a(0,1,0,Object(F.a)(this,this.irk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ha.ggg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");JD.Hyi(b,this.K.resolve("Common.IFocusManager"));b.gDi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").hsk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}W1g(){const a=new BB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.bEg=!0;Ud.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").L_a(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}ezj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}nei(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.DQd("WACDocumentPanelContent","Horizontal"),this.DQd("EditingThumbnailsPanel","Horizontal"),this.DQd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}DQd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}Qhe(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new pf.GraphTransaction(2);
try{b.kd(a),a.Hda(16)}finally{b&&b.dispose()}}}cbc(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.DS(()=>{c&&c.R5(b+"DownloadFinished")});cl.a.ey(a)}J_j(){if(this.Ha.euc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1240)));else{const a=Kx.a.create("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1240)));this.cbc(a,"comment")}}I_j(){if(this.Ha.euc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1237)));else{const a=Kx.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1237)));this.cbc(a,"chronosslim")}}irk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.bEg||this.W1g();this.ezj();this.nei();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ha.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca(this.K.resolve("PowerPointWebEditor.PresenceLoader").$ml,(f,l)=>{Oc.App.nmg()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").Lle=l.succeeded)},null);const b=()=>{xa.a.J(512360582,809,50,"Start to download chronos.js file");this.J_j();this.I_j();this.Ha.Rwh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").Xne()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Vfg(()=>{b()})};(new ks.a(this.Ha.Hfa)).tTj?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").Qpg().continueWith(()=>{this.Qhe()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").R2e();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.R5("ChronosStartDownloadTime");try{if(this.Ha.wacAirSpaceResourceLink){const f=rn.a.y0b("wacairspaceanimationlibrary.js"),l=eD.a.create(f,null,null);cl.a.ey(l)}}catch(f){xa.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ha.vg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").AEj();
u.AFrameworkApplication.fa.gf(()=>{LQ.a.instance.jsi()});MSOJS.ClientUtils.InitUrls(u.AFrameworkApplication.E3k,u.AFrameworkApplication.C3k,u.AFrameworkApplication.D3k)}static main(){u.AFrameworkApplication.Ug&&B.a.eg?xa.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):z.a.instance.Dc(new Oz)}static dyi(a){a.register(319,"PowerPointWebEditor.IPrefetchManager").ma().oa(()=>new Pp(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").yd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(m.a)(Oz,"CoreExtPackage",null,[2,3]);class ZK{constructor(){this.b4c=this.mf=this.Zc=this.rb=null;this.va=new wc.a;this.Eb=!1}init(a,b){this.mf=a;this.Zc=b;this.MA()}dispose(){this.rb&&(this.visible=!1,this.Zc.yb(ta.a.click,
this.rb,Object(F.a)(this,this.dJa,"onBackgroundClick")),this.mf&&this.rb&&(this.mf.removeChild(this.rb),this.rb=null),this.va&&(this.va.dispose(),this.va=null))}MA(){this.rb=document.createElement("div");this.rb.className="EditingNotesDefaultView";u.AFrameworkApplication.isRtl&&(this.rb.style.direction=mf.a.P0a);this.mf.appendChild(this.rb);this.b4c=document.createElement("p");this.b4c.className="EditingNotesDefaultViewContent";this.b4c.innerText=ResourceStrings.l_ClickToAddNotes;this.rb.appendChild(this.b4c);
this.Zc.pb(ta.a.click,this.rb,Object(F.a)(this,this.dJa,"onBackgroundClick"))}dJa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}guf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Eb}set visible(a){this.Eb=a;this.rb.style.display=a?Ri.a.block:Ri.a.none}get xa(){return this.rb}}Object(m.a)(ZK,"NotesPromptView",null,[1110,1111,106]);class $K{constructor(a){this.Z9c=this.mf=this.rb=null;this.b6c=this.Eb=!1;this.aak=a}init(a,b){b.Izb&&(this.mf=a,this.rb=document.createElement("div"),
this.rb.className="EditingNotesReadOnlyView",this.aak&&(this.rb.style.direction=mf.a.P0a),this.mf.appendChild(this.rb),this.Z9c=document.createElement("div"),this.Z9c.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.Pdd,b=jSanity.sanitize(a),this.Z9c.appendChild(b),this.rb.appendChild(this.Z9c),this.b6c=!0)}dispose(){this.b6c&&(this.visible=!1,this.mf&&this.rb&&(this.mf.removeChild(this.rb),this.rb=null),this.b6c=!1)}get visible(){return this.Eb}set visible(a){this.b6c&&(this.Eb=a,
this.rb.style.display=a?Ri.a.block:Ri.a.none)}get xa(){return this.rb}}Object(m.a)($K,"NotesReadOnlyView",null,[1108,106]);var Pz=d(490),KD=d(643);class ir extends Pz.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we){super(a,b);this.RDb=this.ig=this.sh=this.deb=null;this.UWa=!1;this.Jva=Oc.App.Vm;this.DHa=Object(oa.a)(1105,b);this.rb=this.Md.container;this.nc(this.rb);this.Zc=c;this.Ea=f;this.Seb=l;this.DEb=ya;this.Yl=x;this.vi=H;this.Mv=U;this.uJ=ja;this.ob=Va;this.Vbb=hb;this.Y9=
Object(oa.a)(355,a);this.Ndc=yb;this.mc=Zb;this.Tze=fc;this.bwa=Kc;this.BJ=Lc;this.qe=Gc;this.x9c=ae;this.Sp=we;this.t5c=this.qe.qk("formatpaintertext.cur");this.Sp&&this.BJ.JPd(Object(F.a)(this,this.Gkc,"onTextFPActiveChanged"));this.sh||this.MA()}dispose(){this.Zc.yb(ta.a.click,this.rb.parentNode,Object(F.a)(this,this.dJa,"onBackgroundClick"));this.Sp&&this.BJ.pRe(Object(F.a)(this,this.Gkc,"onTextFPActiveChanged"));this.Seb&&(this.Seb.dispose(),this.Seb=null);this.DEb&&(this.DEb.dispose(),this.DEb=
null);super.dispose()}Ky(a){super.Ky(a);this.luc()}Yaa(a){this.UD(this.ig,a,-1)}I6(){this.Gqd()}MA(){this.x9c&&(this.RDb=this.Md.createElement("div"),this.RDb.className="NotesResizeHandle",Rc.c(this.RDb,!0),Sys.UI.DomElement.addCssClass(this.RDb,"NotesResizeHandle"),this.htmlElement.appendChild(this.RDb),this.Xo(this.RDb));this.deb=this.Md.createElement("div");this.deb.className="NotesContentContainer";this.deb.id="NotesContentContainer";this.Xo(this.deb);this.htmlElement.appendChild(this.deb);this.sh=
this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.sh,"NotesView");Sys.UI.DomElement.addCssClass(this.sh,"NotesEditViewVisible");this.deb.appendChild(this.sh);this.Xo(this.sh);this.ig=this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.ig,"NotesViewContent");this.sh.appendChild(this.ig);this.Xo(this.ig);u.AFrameworkApplication.isRtl&&(this.sh.style.direction=mf.a.P0a);this.Zc.pb(ta.a.click,this.rb.parentNode,Object(F.a)(this,this.dJa,"onBackgroundClick"));this.Seb.init(this.rb.parentNode,
this.Zc);this.DEb.init(this.rb.parentNode,this.DHa);this.Gqd();this.Seb.guf(Object(F.a)(this,this.lsk,"onDefaultViewClick"))}Gqd(){if(this.DHa.Izb)this.kLa(!1),this.RYe(!1),this.eml();else{var a=this.Yl.Cke(this.DHa);a=this.UWa||!a;this.kLa(a);this.RYe(!a);this.Sp&&this.lD(ir.wea)}}Gkc(a,b){ir.wea=b.LQc;this.lD(ir.wea)}lD(a){const b=this.rb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.rb.style.cursor=lf.a.fQ(this.t5c,Ri.a.DA),this.ig.style.cursor=lf.a.fQ(this.t5c,Ri.a.DA),
a=0;a<b.length;a++)if(b[a].style.cursor!==lf.a.fQ(this.t5c,Ri.a.DA))b[a].style.cursor=lf.a.fQ(this.t5c,Ri.a.Oaa);else break;else for(this.rb.style.cursor=Ri.a.DA,this.ig.style.cursor=Ri.a.DA,a=0;a<b.length;a++)b[a].style.cursor=Ri.a.Oaa}luc(){this.htmlElement.style.zIndex="0";const a=this.Yl.bTa(this.DHa,this.Md.Ld),b=this.Yl.G5b(this.DHa,this.Md.Ld);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);ir.TVe(this.sh,b);ir.TVe(this.Seb.xa,b);ir.TVe(this.DEb.xa,
b);this.bwa.Pjb(new hd.a(a.x,a.y),u.AFrameworkApplication.isRtl,this.sh,!0)}bhb(){this.UWa=!0;this.xU();this.startEditing()}chb(){this.UWa=!1;this.xU();this.endEditing()}sL(){return this.UWa}startEditing(){this.$wa.Izb?this.ob.ij():(this.Gqd(),this.okg()||(this.Jva=this.$wa.RFa,this.uJ.Lqh(this.DHa,!1),this.uJ.WKk(this.DHa)))}endEditing(){if(!this.$wa.Izb&&(this.Vbb.setVisibility(!1),this.Gqd(),!this.okg())){this.$_g.endEditing(!0,14);this.Ndc.w1d(this.Y9);var a=this.Tze.nua(this.$wa,this.Jva),b=
!!this.$wa&&this.$wa.isConnected;a&&(b&&this.$wa.gpd(),this.vi.j7a(this.$wa),this.Mv.XUd());this.uJ.Lqh(this.DHa,b&&this.$wa.hZc)}}lsk(a,b){this.dJa(b)}dJa(){this.Ea.Cj(Qi.a.T2,!0);this.kLa(!0);this.RYe(!1);this.$_g.QR();this.eZe();this.Jva=this.$wa.RFa;return!0}okg(){return!this.mc.Gn}get xa(){return this.htmlElement}get $wa(){return this.DHa}get $_g(){return this.Qc}eZe(){this.$aa(!0)}eml(){this.DEb.visible=!0}RYe(a){this.Seb.visible=a}kLa(a){KD.b(a,this.deb,"NotesContentContainerHidden","NotesContentContainerVisible")}$aa(a){KD.b(a,
this.sh,"NotesEditViewHidden","NotesEditViewVisible")}static TVe(a,b){a&&(a.style.paddingTop=lf.a.Pc(b[0]),a.style.paddingRight=lf.a.Pc(b[1]),a.style.paddingBottom=lf.a.Pc(b[2]),a.style.paddingLeft=lf.a.Pc(b[3]))}static xQj(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}ir.wea=0;Object(m.a)(ir,"NotesViewElement",Pz.a,[1109,1032]);var cs=d(385),VQ=d(613),WQ=d(835),aL=d(488),Qz=d(487);class bL extends Qz.a{constructor(a,b){super(a,b);this.uea=[];this.Xcc=0}YJb(a,...b){Array.addRange(this.uea,
b);this.Xcc=a}Ync(){if(this.uea)for(const a of this.uea)this.Qt.Xnc(this.container,a,this.Xcc);this.Qt.NJ(this.container,this.l3)}guc(){this.Qt.$E(this.container,this.l3);for(const a of this.uea)this.Qt.$E(this.container,a)}}Object(m.a)(bL,"NotesViewDomManager",Qz.a,[]);var Rz=d(554);class cL extends Rz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.pa=b}bub(){return[Object(F.a)(this,this.ukc,"onSetup"),Object(F.a)(this,this.Sjc,"onEnsurePageViewElementsCreated"),Object(F.a)(this,this.Tjc,
"onEnsureSelectedContentViewElementsCreated"),Object(F.a)(this,this.hkc,"onMainLoop"),Object(F.a)(this,this.svk,"onNotesContentSelect"),Object(F.a)(this,this.Ojc,"onCommit"),Object(F.a)(this,this.Fkc,"onTearDown")]}svk(a,b){this.dga(b);a=Object(oa.a)(1105,this.yh.xg);if(!a)return!0;a=Object(oa.a)(1109,a.sc(this.yh.Ma));if(!a)return!0;this.pa.Zka()?a.sL()||a.bhb():a.sL()&&a.chb();return!0}}Object(m.a)(cL,"NotesViewSelectionChangedHandler",Rz.ViewSelectionChangedHandler,[]);class LD extends Bv.DragSelectionDragAdapter{constructor(a,
b,c,f,l,x){super(a,b,c);this.fq=f;this.Woe=x;this.Yl=l}Tu(a){if(this.Woe){var b=this.Vtc(a);const c=b?b.gb:null;if(c){const f=this.Yl.wFa(c)?Object(oa.a)(1105,c):this.Yl.gxb(c);if(f&&this.Yl.Cke(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.If.q1a(a.clientPoint,b,c,this.If,!1))&&oc.HyperlinkReader.Xka(b,!0))return!1}a=super.Tu(a);null!==this.fq&&a&&this.fq.wya(Ri.a.Oaa);return a}ou(a){super.ou(a);null!==this.fq&&this.fq.Zxa()}ao(a){super.ao(a);null!==this.fq&&this.fq.Zxa()}TI(a){return this.If.isActive?
super.TI(a):!1}static H5b(a){return new LD(a,Db.a.instance.resolve("Common.IActionManagerExtended"),Db.a.instance.resolve("Common.IActivityManager"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Db.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Db.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(m.a)(LD,
"NotesDragSelectionDragAdapter",Bv.DragSelectionDragAdapter,[]);var Sz=d(234);class MD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.NHg=this.Kfc=this.ewg=this.bze=this.pHa=0;this.C$=this.Scc=this.M8c=null;this.acc=this.stg=this.t8c=0;this.Tre=!1;this.Y9=a;this.b0=b;this.Pi=c;this.Rb=f;this.mA=l;this.Fg=x;this.oc=H;this.Kc=U;this.Jb=ja;ya.EPa(Object(F.a)(this,this.mkc,"onOutboundReplication"));this.ia=Va}Cv(a){return a&&a.sA!==Sys.UI.MouseButton.rightButton?ir.xQj(a.Ec):!1}Tu(a){if(!this.Cv(a))return!1;
this.Tre=!0;this.M8c=this.mA.xa;if(!this.M8c)return!1;this.C$=this.Kc.Ic;if(this.C$&&(this.Scc=this.Fg.xa))this.ewg=this.Scc.clientHeight;else return!1;this.t8c=Math.floor(.75*(this.M8c.clientHeight+this.Scc.clientHeight));this.bze=this.M8c.clientHeight;this.Kfc=this.pHa=a.clientPoint.y;this.NHg=this.C$.qT;this.b0.nl(7);this.Y9.endEditing(!0,14);return!0}Cw(a){if(!a)return!1;this.pHa=a.clientPoint.y;a=this.tCf(this.pHa);this.mA.qfa=a;this.Rb.Oq();a=this.ewg+this.bze-a;this.Scc.style.height=a+"px";
this.C$.Wbl(a-1);this.C$.cel(this.NHg);return!0}ao(a){this.b0.i1();this.Y9.QR();this.acc=this.tCf(a?a.clientPoint.y:this.pHa);this.ia.La(K.a.OVe,2,this.acc)}ou(){this.Tre&&(this.Tre=!1,this.ao(null))}mkc(){this.acc!==this.stg&&2===Oc.App.Kb.mode&&(this.stg=this.acc,this.BAk(this.acc))}BAk(a){const b=this.oc.Ym,c=this.Jb.Ad(4);try{c.nc(b),b.LGb=4320,b.qfa=this.eoi(a)}finally{c&&c.dispose()}}tCf(a){a=this.bze+this.Pi.Qm(this.Kfc-a);0<this.t8c&&a>this.t8c?a=this.t8c:a<Sz.a.DRa&&a>Mf.a.ZNc?a=Sz.a.DRa:
a<Mf.a.ZNc&&(a=Mf.a.xQf);return a}eoi(a){return this.Pi.KKe(a,1)}static H5b(a){return new MD(a,Db.a.instance.resolve("Common.CursorManager"),Db.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Db.a.instance.resolve("Box4.IAppFrame"),Db.a.instance.resolve("PowerPointWebEditor.INotesPane"),Db.a.instance.resolve("PowerPointWebEditor.ISlidePane"),Db.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Db.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Db.a.instance.resolve("Common.Transaction.ITransactionFactory"),
Db.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Db.a.instance.resolve("Common.IActionManagerExtended"))}}Object(m.a)(MD,"NotesResizeDragAdapter",null,[240]);class dL extends cs.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){super(Qi.a.T2,a,b,c,f,l,H,U,hb);this.Uwe=!1;this.HIa=x;this.mc=ja;this.Zf=ya;this.pO=Va;this.Woe=yb;this.Sp=Zb}get BQd(){return u.AFrameworkApplication.fa}Zx(a,b=null){this.Sp&&this.Zf.pb(ta.a.EJ,this.container,Object(F.a)(this,this.ddd,"mouseUpHandlerFilter"));
super.Zx(a,b);(a=Object(oa.a)(1105,a))&&a.Izb&&this.zg&&this.zg.Rn&&this.zg.Rn.setAttribute("aria-readonly","true")}detach(){this.Sp&&this.uo&&this.Zf.yb(ta.a.EJ,this.container,Object(F.a)(this,this.ddd,"mouseUpHandlerFilter"));super.detach()}UZb(a,b){return new bL(a,b)}Eda(a){a=super.Eda(a);a.l3=LD.H5b(this);a.YJb(1,MD.H5b(this));return a}ixa(a){this.pAc=a.Xf;if(!this.Nnc||this.isActive||!this.Woe||(a.qc.type===ta.a.mouseDown||a.qc.type===ta.a.jQa)&&a.sA!==Sys.UI.MouseButton.leftButton)return!1;
var b=a.Ec;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;cs.a.f8&&(c=cs.a.f8.xsa());Oc.App.OD.QS&&Oc.App.OD.QS.USe(f=>{f&&(c=!0)});b=!Ud.a("DeprecateIE.NotesView")&&c&&B.a.$W;a=new VQ.a(a,this,!0,b);this.vKk(a);return!1}vKk(a){this.PLe();this.d6(B.a.eg||B.a.HUa);this.Ip.raiseEvent(cs.a.RXc,new WQ.a(a.graphNode));this.yQc(a.graphNode);this.O5e();const b=[Object(F.a)(this,this.AFe,"noneClickHandler"),Object(F.a)(this,this.Qok,"notesSnapToContentClickHandler"),Object(F.a)(this,
this.Lok,"notesDefaultClickHandler")];for(const c of b)if(c(a).O3){this.Uwe=!0;break}}ddd(){return this.Uwe&&this.pO.jVa?(this.Ca.processAction(D.a.Rja,2),!0):this.Uwe=!1}Lok(a){const b=cs.a.Wc.Vp(D.a.stb);b.properties.$(Uc.a.source,"DefaultClickHandler");this.E6(a.eV,a.Yr,a.graphNode,a.Qc,a.Xi.shiftKey,a.Xi.ctrlKey,a.Xi.Xf);b.end();a.Pvb&&this.d6(!0);this.editingView.Gbb(a.Xi.shiftKey,a.eV,a.Xi.Xf);return ii.a.Vl(!0)}Qok(a){if(!a.Yr){const b=a.Yr,c=a.graphNode,f=cs.a.Wc.Vp(D.a.stb);f.properties.$(Uc.a.source,
"SnapToContentClickHandler");this.E6(a.eV,b,c,this,a.Xi.shiftKey,a.Xi.ctrlKey,a.Xi.Xf);f.end();a.Pvb&&this.d6(!0);this.editingView.Gbb(a.Xi.shiftKey,a.eV,a.Xi.Xf);return ii.a.Vl(!0)}return ii.a.notHandled}una(){super.una();this.zg&&this.zg.Rn&&(this.BQd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.zg.Upc(Cc.a.IHc):this.zg.QUe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Cc.a.IHc),this.zg.Rn.setAttribute(Cc.a.ns,ResourceStrings.l_NotesPane))}Prd(){this.jF.Pd===this&&
this.suspend()}imd(){this.jF.Pd===this&&this.resume()}dUc(){return new cL(this,Db.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}GRc(){return[Object(F.a)(this,this.AFe,"noneClickHandler"),Object(F.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(F.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(F.a)(this,this.defaultClickHandler,"defaultClickHandler")]}nSc(){return[Object(F.a)(this,this.AFe,"noneClickHandler"),Object(F.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}AFe(a){return this.Jzb(a)||this.yQj()?ii.a.Vl(!0):ii.a.notHandled}aSc(){return[Object(F.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(F.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(F.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}Mya(a){this.Jzb(a)||super.Mya(a)}noContextMenuHandler(a){return this.Jzb(a)?to.a.Vl(null):to.a.notHandled}Jzb(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.Izb}yQj(){return!this.mc.Gn}c$a(){return aL.a.iEe}get KF(){return super.KF|96}get CMb(){return!0}L6(a,b,c=null){this.HIa.eY(this)&&super.L6(a,b,c)}}Object(m.a)(dL,"NotesView",cs.a,[301,1106,408,162,106,355,798,993,994,995]);var eL=d(489),Tz=d(210);class ND{constructor(a,b,c,f){this.iHg=null;this.Rva=a;this.ua=b;this.Nq=c;this.pve=f}REj(){this.iHg=new eL.a(Tz.App.T5a.Ook,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.Rva.hCa(this.iHg.Nza);Dv.DHf(this.Rva);
this.tyf(this.ua.Ba);this.Nq.F8h(Object(F.a)(this,this.F1g,"onAttachNotesView"))}F1g(a,b){this.rSi();this.tyf(b.Fd)}tyf(a){this.ua.presentation&&a&&a.isConnected&&(a=this.pve.G1f(a,27),this.Rva.Zx(a))}rSi(){this.Rva.uo&&(this.Rva.editingView.disable(!0,14),this.Rva.detach())}dispose(){this.Nq.OXk(Object(F.a)(this,this.F1g,"onAttachNotesView"))}}Object(m.a)(ND,"NotesViewHelper",null,[106]);class OD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Zb(a){this.K=a;this.K.register(301,
"PowerPointWebEditor.INotesView").ma().oa(()=>new dL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ja("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(ND,"PowerPointWebEditor.Notes.NotesViewHelper").ma().oa(()=>new ND(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new Di.a((a,b)=>Object(Xa.a)(301,a)?new ir(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new ZK,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new $K(u.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").uah,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").REj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){z.a.instance.Dc(new OD)}}Object(m.a)(OD,"PPTWebEditorNotesPackage",null,[2,3]);class PD extends Bv.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.fq=f}Tu(a){a=super.Tu(a);null!==this.fq&&a&&this.fq.wya(Ri.a.Oaa);return a}ou(a){super.ou(a);null!==this.fq&&this.fq.Zxa()}ao(a){super.ao(a);null!==this.fq&&this.fq.Zxa()}TI(a){return this.If.isActive?super.TI(a):!1}static H5b(a){return new PD(a,Db.a.instance.resolve("Common.IActionManagerExtended"),Db.a.instance.resolve("Common.IActivityManager"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Db.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(m.a)(PD,"SmartArtTextViewDragSelectionDragAdapter",Bv.DragSelectionDragAdapter,[]);class fL extends Qz.a{constructor(a,b){super(a,b);this.uea=[];this.Xcc=0}YJb(a,...b){Array.addRange(this.uea,b);this.Xcc=a}Ync(){if(this.uea)for(const a of this.uea)this.Qt.Xnc(this.container,a,this.Xcc);this.Qt.NJ(this.container,this.l3)}guc(){this.Qt.$E(this.container,this.l3);for(const a of this.uea)this.Qt.$E(this.container,a)}}Object(m.a)(fL,"SmartArtTextViewDomManager",Qz.a,[]);class gL extends Rz.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.pa=b;this.Te=c;this.JO=f}bub(){return[Object(F.a)(this,this.ukc,"onSetup"),Object(F.a)(this,this.Sjc,"onEnsurePageViewElementsCreated"),Object(F.a)(this,this.Tjc,"onEnsureSelectedContentViewElementsCreated"),Object(F.a)(this,this.hkc,"onMainLoop"),Object(F.a)(this,this.lyk,"onSmartArtContentSelect"),Object(F.a)(this,this.Ojc,"onCommit"),Object(F.a)(this,this.Fkc,"onTearDown")]}lyk(a,b){this.dga(b);b=Object(oa.a)(4,this.yh.xg);if(!b)return!1;a=Object(oa.a)(1113,b.sc(this.yh.Ma));
b=Object(oa.a)(117,b.sc(this.Te));if(!a)return!1;this.pa.dVa()?a.sL()||(a.bhb(),this.JO.xp(!0),b&&b.bhb()):a.sL()&&(a.chb(),this.JO.xp(!1),b&&b.chb());return!0}}Object(m.a)(gL,"SmartArtTextViewSelectionChangedHandler",Rz.ViewSelectionChangedHandler,[]);class hL extends cs.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){super(zb.a.MR,a,c,f,l,H,ja,ya,Va);this.HIa=U;this.pa=b;this.Iq=x;this.Te=hb;this.JO=yb;this.Ea=Zb;this.Ld.y5e=!0;this.Ld.B4d=!1}get BQd(){return u.AFrameworkApplication.fa}UZb(a,b){return new fL(a,
b)}Eda(a){a=super.Eda(a);a.l3=PD.H5b(this);return a}una(){super.una();this.zg&&this.zg.Rn&&(this.BQd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.zg.Upc(Cc.a.IHc):this.zg.QUe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Cc.a.IHc),this.zg.Rn.setAttribute(Cc.a.ns,ResourceStrings.l_SmartArtTextPane))}Prd(){this.jF.Pd===this&&this.suspend()}imd(){this.jF.Pd===this&&this.resume()}dUc(){return new gL(this,
Db.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Te,this.JO)}jtb(){this.jF.Pd===this&&this.pa.LUd();return!1}GRc(){return[Object(F.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(F.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(F.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(F.a)(this,this.defaultClickHandler,"defaultClickHandler")]}nSc(){return[Object(F.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}aSc(){return[Object(F.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(F.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Ea.Cj(zb.a.MR,!0);return a}c$a(){return aL.a.iEe}get KF(){let a=super.KF;return a=Ud.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get CMb(){return!0}L6(a,b,c=null){this.HIa.eY(this)&&super.L6(a,b,c)}jdl(a){const b=this.Iq.me(2);try{b.kd(a);let c=null;c=Qd.SelectionFactory.tj(a,!0);
this.setSelection(c)}finally{b&&b.dispose()}}}Object(m.a)(hL,"SmartArtTextView",cs.a,[299,1106,408,162,106,355,798,993,994,995]);class iL extends Pz.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){super(a,b);this.ig=this.sh=null;this.UWa=!1;this.Jva=Oc.App.Vm;this.Had=b;this.rb=this.Md.container;this.nc(this.rb);this.Zc=c;this.Ea=f;this.ia=l;this.vi=x;this.Mv=H;this.uJ=U;this.Vbb=ja;this.Y9=a;this.Ndc=ya;this.qd=Va;this.MA()}dispose(){this.Zc.yb(ta.a.click,this.rb.parentNode,Object(F.a)(this,this.dJa,"onBackgroundClick"));
this.qd.TZk(Object(F.a)(this,this.w6g,"onSmartArtTextPaneWidthChanged"));super.dispose()}Ky(a){super.Ky(a)}Yaa(a){this.UD(this.ig,a,-1)}I6(){this.kLa(!0)}MA(){this.sh=this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.sh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.sh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.sh);this.Xo(this.sh);this.ig=this.Md.createElement("div");Sys.UI.DomElement.addCssClass(this.ig,"SmartArtTextViewContent");this.ig.style.width=lf.a.Pc(Mf.a.Irc-
2*Mf.a.eNb-2*Mf.a.EZe-Mf.a.dxh);this.sh.appendChild(this.ig);this.Xo(this.ig);u.AFrameworkApplication.isRtl&&(this.sh.style.direction=mf.a.P0a);this.kLa(!0);this.Zc.pb(ta.a.click,this.rb.parentNode,Object(F.a)(this,this.dJa,"onBackgroundClick"));this.qd.Zai(Object(F.a)(this,this.w6g,"onSmartArtTextPaneWidthChanged"))}bhb(){this.UWa=!0;this.xU();this.startEditing()}chb(){this.UWa=!1;this.xU();this.endEditing()}sL(){return this.UWa}startEditing(){this.kLa(!0);this.Jva=this.F0a.RFa;this.uJ.cqc(this.Had,
!1);this.uJ.Oid(this.Had)}endEditing(){this.Vbb.setVisibility(!1);this.kLa(!0);this.fxh.endEditing(!0,14);this.Ndc.w1d(this.Y9);const a=new lw.a(this.F0a,this.Jva);this.ia.La(K.a.Whb,2,a);const b=!!this.F0a&&this.F0a.isConnected;a.nua&&(b&&this.F0a.gpd(),this.vi.j7a(this.F0a),this.Mv.XUd());this.uJ.cqc(this.Had,b&&this.F0a.hZc)}dJa(){this.Ea.Cj(zb.a.MR,!0);this.fxh.QR();this.kLa(!0);this.Jva=this.F0a.RFa;return!0}get xa(){return this.htmlElement}get F0a(){return this.Had}get fxh(){return this.Qc}kLa(a){KD.b(a,
this.sh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}w6g(a,b){this.ig.style.width=lf.a.Pc(lf.a.Fn(b.width))}}Object(m.a)(iL,"SmartArtTextViewElement",Pz.a,[1113,1032]);class jL{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.aUg=this.gcb=null;this.JO=a;this.pIa=b;this.qd=c;this.Ea=f;this.Mv=l;this.iM=x;this.pa=H;this.Fb=Object(oa.a)(355,U);this.Nq=ja;this.Og=ya;this.mc=Va;this.o0=hb}uFj(){this.aUg=new eL.a(this.JO.zQf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.pIa.hCa(this.aUg.Nza);Dv.DHf(this.pIa);this.qd.Qai(Object(F.a)(this,this.d6g,"onSingleSmartArtShapeViewElementSelected"));this.qd.Rai(Object(F.a)(this,this.e6g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.qd.Yai(Object(F.a)(this,this.v6g,"onSmartArtShapeViewElementDeselected"));this.qd.OYb(Object(F.a)(this,this.fgd,"onSlideHtmlUpdated"));this.qd.N8h(Object(F.a)(this,this.u6g,"onSmartArtCommentsVisibilityChanged"));this.iM.N7(Object(F.a)(this,this.vkc,"onShapeDisconneted"));
this.Nq.zGc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Nq.sGc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Fb.IPa((a,b)=>{this.fgd(a,b)})}Eua(){return!this.mc.Gn}$Ye(a){if(this.o0){if(this.Eua()||a.ona)return}else if(this.Eua())return;a&&a.Rf&&!a.get_smartArtModelId()&&a.isConnected?(xa.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.BZe||(this.gcb!==a&&(this.gcb=a,this.E1d(),this.uyf(a)),this.JO.$4e(a),this.JO.xp(!0))):xa.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}sml(a){this.Eua()||(a&&a.Rf&&!a.get_smartArtModelId()&&a.isConnected?(xa.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.BZe||(this.gcb!==a&&(this.gcb=a,this.E1d(),this.uyf(a)),this.Ea.Cj(zb.a.MR,!0),this.Mv.qw(),this.pIa.jdl(a),this.JO.$4e(a),this.JO.xp(!0))):xa.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}bPf(){this.JO.isVisible&&
(xa.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.JO.xp(!1))}d6g(a,b){this.Eua()||this.$Ye(b.shapeNode)}e6g(a,b){this.Eua()||this.sml(b.shapeNode)}v6g(){this.Eua()||this.bPf()}fgd(){if(!this.Eua()&&this.pa.FL()){const a=this.pa.rEa();xa.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.JO.$4e(a)}}AU(a,b){this.Eua()||(a=b.vgb,a===zb.a.MR?this.Og.pI(zb.a.MR):this.Og.H9b(a)&&this.Og.Ko(zb.a.MR))}uyf(a){a&&a.isConnected&&this.pIa.Zx(a)}E1d(){this.pIa.uo&&
(this.pIa.editingView.disable(!0,14),this.pIa.detach())}vkc(a,b){this.Eua()||b.node!==this.gcb||(this.gcb=null,this.E1d(),this.JO.xp(!1))}u6g(a,b){this.Eua()||((a=b.Sfl)?a.Rf&&this.$Ye(a):(a=this.pa.rEa())?this.gcb!==a&&this.$Ye(a):this.bPf())}dispose(){this.qd.LZk(Object(F.a)(this,this.d6g,"onSingleSmartArtShapeViewElementSelected"));this.qd.MZk(Object(F.a)(this,this.e6g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.qd.SZk(Object(F.a)(this,this.v6g,"onSmartArtShapeViewElementDeselected"));
this.qd.TXk(Object(F.a)(this,this.u6g,"onSmartArtCommentsVisibilityChanged"));this.iM.sKa(Object(F.a)(this,this.vkc,"onShapeDisconneted"));this.Nq.eRe(Object(F.a)(this,this.AU,"onFocusChanged"));this.Nq.mld(Object(F.a)(this,this.AU,"onFocusChanged"));this.qd.Xih(Object(F.a)(this,this.fgd,"onSlideHtmlUpdated"));this.Fb.toc((a,b)=>{this.fgd(a,b)})}}Object(m.a)(jL,"SmartArtTextViewHelper",null,[300,106]);class QD{constructor(){this.K=null;this.kA=!1}get name(){return"PowerPointWebEditor.SmartArt"}Zb(a){this.K=
a;this.K.register(299,"PowerPointWebEditor.ISmartArtTextView").ma().oa(()=>new hL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Ja("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(300,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().oa(()=>new jL(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").ska))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.gf(()=>{if(this.kA=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new Di.a((b,c)=>Object(Xa.a)(299,b)?(c=Object(oa.a)(4,c))&&c.Rf?new iL(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").uFj()})}dispose(){this.kA&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){z.a.instance.Dc(new QD)}}Object(m.a)(QD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class kL{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(m.a)(kL,"CT_WebTextListStyle",null,[]);var Zo=d(343);class lL{constructor(a){this.Dla=a}NZ(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,x=!!(f&64)&&!!c.lastRowField,H=!!(f&128)&&!!c.firstColField,U=!!(f&256)&&
!!c.lastColField,ja=l&&H&&!!c.nwCellField,ya=l&&U&&!!c.neCellField,Va=x&&H&&!!c.swCellField,hb=x&&U&&!!c.seCellField,yb=!!(f&512)&&!!c.band1HField,Zb=!!(f&512)&&!!c.band2HField,fc=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var Kc=!b.re,Lc=b.$f===a.DY,Gc=!b.ge;a=b.Of===a.Wra;var ae=1===b.re%2===l;b=1===b.ge%2===H;var we=!(l&&Kc)&&!(x&&Lc),$d=!(H&&Gc)&&!(U&&a);c.wholeTblField&&this.apply(c.wholeTblField);we&&(yb&&ae||Zb&&!ae)&&(ae?this.apply(c.band1HField):this.apply(c.band2HField));
$d&&(fc&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&U&&this.apply(c.lastColField);Gc&&H&&this.apply(c.firstColField);Lc&&x&&(this.apply(c.lastRowField),a&&hb&&this.apply(c.seCellField),Gc&&Va&&this.apply(c.swCellField));Kc&&l&&(this.apply(c.firstRowField),a&&ya&&this.apply(c.neCellField),Gc&&ja&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=gl.a(b);pe.Box4ColorHelper.rab(a)||(Zo.g(this.Dla),this.Dla.solidFillField=new Vu.a,pe.Box4ColorHelper.sei(this.Dla.solidFillField,
a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.Dla;0===b||1===b?(f.latinField=We.dub(b,0),f.eaField=We.dub(b,1),f.csField=We.dub(b,2)):xa.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.Dla.latinField=b.latinField),null!==b.eaField&&(this.Dla.eaField=b.eaField),null!==b.csField&&(this.Dla.csField=b.csField));if(0===a||1===a)this.Dla.bFieldSpecified=
!0,this.Dla.bField=0===a;if(0===c||1===c)this.Dla.iFieldSpecified=!0,this.Dla.iField=0===c}}}Object(m.a)(lL,"CellTextStylePartApplier",null,[]);class Xs{constructor(a){this.AVg=a}get value(){return this.AVg.valField/1E5}set value(a){this.AVg.valField=Math.floor(1E5*a)}get type(){return Xs.n_b}}Xs.n_b="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(Xs,"LineSpacingPercent",null,[1206,1207]);class jr{constructor(a){this.BVg=a}get value(){return this.BVg.valField/
100}set value(a){this.BVg.valField=Math.floor(100*a)}get type(){return jr.n_b}}jr.n_b="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(jr,"LineSpacingPoint",null,[1206,1207]);class XQ{constructor(){this.valField=0}}Object(m.a)(XQ,"CT_TextSpacingPoint",null,[]);class Ys{constructor(a){this.sqe=a}get lineSpacing(){return this.sqe}get value(){return this.sqe.value}set value(a){this.sqe.value=a}static r1b(a){if(a.__type===Xs.n_b)return new Ys(new Xs(a));if(a.__type===
jr.n_b)return new Ys(new jr(a));xa.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(m.a)(Ys,"LineSpacingWrapper",null,[]);const mL=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},nL=
(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},YQ=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Rx{constructor(){this.ftb=Array(Rx.rCh);this.IJe=Array(Rx.rCh)}}Rx.rCh=9;Object(m.a)(Rx,"TextListStyleCache",null,[]);class oL{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(m.a)(oL,"NumberingData",null,[]);class Ev{}Ev.YSd="\u2022";Ev.Fli="p";Ev.Gli="n";Object(m.a)(Ev,"ListFormats",null,[]);class pL{constructor(a,b,c,f){this.FWg=this.GWg=Oc.App.Vm;this.rtg=null;this.jc=a;this.Yl=b;this.dM=c;this.lA=f}get caches(){return this.rtg||
(this.rtg={})}r_f(a,b,c){const f=c-1;let l=a.Q_;var x;const H=!!l&&!ka.a.nil.equals(l[f]);if(H&&(x=this.caches[l[f].toString()]))return x=x.clone(),b=ka.a.create(),a.Fh.HE(x,b),x;if(!H)if(l)l=Array.clone(l);else for(l=Array(9),x=0;x<l.length;x++)l[x]=ka.a.nil;const U=H?l[f]:ka.a.create();x=this.pwi(a,b,c);l[f]=U;this.caches[U.toString()]=x;H||(a.Q_=l);a.Fh.HE(x,U);H&&(x=x.clone(),a.Fh.HE(x,ka.a.create()));return x}pwi(a,b,c){const f=Rn.a.instance.createInstance(131073);if(b){var l=b.g_f(a.rowIndex,
a.pi,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?mL(b,c):null)||new vs;if(l){var x=c-1;c=l.ftb[x];x=l.IJe[x];if(c||x){l=b.defRPrField||new wm;if(x){const H=xd.a(xd.c(x));x=H;b.algnFieldSpecified&&(x.algnFieldSpecified=!0,x.algnField=b.algnField);b.indentFieldSpecified&&(x.indentFieldSpecified=!0,x.indentField=b.indentField);b.lvlFieldSpecified&&(x.lvlFieldSpecified=!0,x.lvlField=b.lvlField);b.marLFieldSpecified&&(x.marLFieldSpecified=!0,x.marLField=b.marLField);b.marRFieldSpecified&&(x.marRFieldSpecified=
!0,x.marRField=b.marRField);b.rtlFieldSpecified&&(x.rtlFieldSpecified=!0,x.rtlField=b.rtlField);b.buAutoNumField&&(x.buAutoNumField=b.buAutoNumField);b.buCharField&&(x.buCharField=b.buCharField);b.buClrField&&(x.buClrField=b.buClrField);b.buClrTxField&&(x.buClrTxField=b.buClrTxField);b.buFontField&&(x.buFontField=b.buFontField);b.buFontTxField&&(x.buFontTxField=b.buFontTxField);b.buNoneField&&(x.buNoneField=b.buNoneField);b.buSzPctField&&(x.buSzPctField=b.buSzPctField);b.buSzPtsField&&(x.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(x.buSzTxField=b.buSzTxField);b.defRPrField&&(x.defRPrField=b.defRPrField);b.lnSpcField&&(x.lnSpcField=b.lnSpcField);b.spcAftField&&(x.spcAftField=b.spcAftField);b.spcBefField&&(x.spcBefField=b.spcBefField);b=H}c&&(c=xd.a(xd.c(c)),nL(c,l),b.defRPrField=c)}}a=Object(oa.a)(115,this.jc.kg(a));this.xwi(f,b,a?a.ke:null)}f.we(kb.a.C8b,!0);return f}xwi(a,b,c){this.wwi(a,b);if(b){if(b.algnFieldSpecified){var f=YQ(b.algnField);a.setValue($a.a.Jl,f);a.setValue($a.a.eJ,f)}b.marLFieldSpecified&&
a.we(ab.a.$l,ye.a.bvb(b.marLField));b.marRFieldSpecified&&a.we(ab.a.sY,ye.a.bvb(b.marRField));b.indentFieldSpecified&&a.we(ab.a.eo,ye.a.bvb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(ab.a.uub,ye.a.bvb(b.defTabSzField));b.spcAftField&&(f=Ys.r1b(b.spcAftField.itemField),Object(Xa.a)(Xs,f.lineSpacing)?a.setValue(kb.a.pla,2):Object(Xa.a)(jr,f.lineSpacing)&&a.setValue(kb.a.pla,4),a.setValue(kb.a.$da,f.value));b.spcBefField&&(f=Ys.r1b(b.spcBefField.itemField),Object(Xa.a)(Xs,f.lineSpacing)?a.setValue(kb.a.qla,
2):Object(Xa.a)(jr,f.lineSpacing)&&a.setValue(kb.a.qla,4),a.setValue(kb.a.aea,f.value));b.lnSpcField&&(f=Ys.r1b(b.lnSpcField.itemField),Object(Xa.a)(Xs,f.lineSpacing)?a.setValue(kb.a.jX,2):Object(Xa.a)(jr,f.lineSpacing)&&a.setValue(kb.a.jX,4),a.setValue(kb.a.ux,f.value))}else xa.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Xi.qwi(a,b.defRPrField,c)}p1k(a){if(a=a.Q_)for(let b=0;b<a.length;b++){const c=a[b];c&&!ka.a.nil.equals(c)&&
delete this.caches[c.toString()]}}wwi(a,b){var c=this.jw(b);a.$x(c.propertySet);b.marLFieldSpecified&&a.setValue(ab.a.$l,ye.a.bvb(b.marLField));b.indentFieldSpecified&&a.setValue(ab.a.eo,ye.a.bvb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue($a.a.fontSize,Xi.wIf(b.defRPrField.szField));b.spcAftField&&(c=Ys.r1b(b.spcAftField.itemField),Object(Xa.a)(jr,c.lineSpacing)&&(a.setValue(kb.a.pla,4),a.setValue(kb.a.$da,c.value)));b.spcBefField&&(b=Ys.r1b(b.spcBefField.itemField),
Object(Xa.a)(jr,b.lineSpacing)&&(a.setValue(kb.a.qla,4),a.setValue(kb.a.aea,b.value)))}jw(a){let b;({Loe:b,T4j:c}=this.e8d(a));var c=dj.a.wN(b,c);0===b&&(c.xA=c.hX=a.buAutoNumField.startAtField);return c}e8d(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Ev.Fli:case Ev.Gli:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{Loe:b,T4j:c}}validate(a){if(Object(oa.a)(ug.a,a)&&(this.Yl.wFa(a)||gj.OutlineReader.bX(a))&&a.isConnected){this.GWg=new Date;var b=Array(To.a.a8);for(var c=0;c<To.a.a8;++c)b[c]=new oL;c=-1;var f=0,l=!1;a=Vl.a.Sz(a);for(a.em(Object(F.a)(this,this.s_j,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.WXc(b,0),this.Ohe(b,0,0));if(11!==a.iterator.currentNode.type)continue;const x=a.iterator,H=this.nda(x);let U=b[H].nextListId,
ja=null;if(rb.ListReader.uk(x)){this.lA.ina(x);ja=this.lA.Y7d(x);const ya=this.E3i(x);x.zc();if(!ja){Nc.a.instance.Xb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===ja.listType){if(ja.xA!==zk.a.Kw&&b[H].restartInfo!==ja.xA||ja.listStyle!==b[H].listStyle||ya!==b[H].autonumberBulletType)l=!0,b[H].restartInfo=b[H].nextNumber=ja.xA===zk.a.Kw?1:ja.xA,U=b[H].nextListId=0,b[H].listStyle=ja.listStyle,b[H].autonumberBulletType=ya;ja.hX=b[H].nextNumber;c!==H||l?(ja.Eja=b[H].nextNumber,
l=!1):ja.Eja=zk.a.Kw;this.dM.isEmpty(x,!1)?l=!0:b[H].nextNumber++}else 1!==ja.listType&&Nc.a.instance.Xb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});U||(U=b[H].nextListId=++f);x.currentNode.listID=U}c=H;ja?(0===ja.listType?this.WXc(b,H+1):this.WXc(b,H),this.Ohe(b,H+1,U)):(this.WXc(b,H),this.Ohe(b,H,0))}this.FWg=new Date;xa.a.J(22344988,820,50,"ListCore::Validate {0}",+this.FWg-+this.GWg)}}nda(a){this.dM.Yg(a)||Nc.a.instance.Xb("PossibleListLevelIncorrect",{["Reason"]:Md.a.Qca});
return a.currentNode.sa(ab.a.listLevel,Be.a.NEa)}Jbj(a){this.dM.Yg(a)||Nc.a.instance.Xb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Md.a.Qca});return a.currentNode.listID}s_j(a){return this.dM.Yg(a)||od.TableReader.aq(a)||tk.l(a)||Le.isTableCell(a)}WXc(a,b){for(;b<To.a.a8;++b)a[b].nextNumber=a[b].restartInfo=1}Ohe(a,b,c){for(;b<To.a.a8;++b)a[b].nextListId=c}E3i(a){return a.currentNode.sa(kb.a.autonumberBulletType,8)}}Object(m.a)(pL,"ListCore",null,[295]);class Qp{constructor(a,b,c=null){this.Sf=
a;this.Di=b;this.Jt=null;this.Tob=c}get uil(){return!1}WQk(a){return a}RLb(a){let b,c,f;b=rb.ListReader.D8a;c=a.propertySet.sa(ab.a.listID,0);f=a.propertySet.sa(ab.a.listLevel,-1);if(P.a.instance.ga(85)||b&&0<c&&0<=f)this.Jt=a;else{let l=1;const x=a.listStyle;b&&42!==x&&0<x&&(l=x);this.Jt=dj.a.wN(a.listType,l,null,c,f,void 0,"")}}ecl(a){a&&(this.Jt=a)}A0d(){}createList(a){const b=Nc.a.instance.Vp(D.a.createList);fe.OutlineElementReader.Yg(a)||Nc.a.instance.Xb("PossiblyIncorrectListCreation",{["Reason"]:Md.a.Qca});
rb.ListReader.uk(a)&&Nc.a.instance.Xb("PossiblyIncorrectListCreation",{["Reason"]:Md.a.ozi});const c=this.vEi();a.Cl(c,4);a.Pk(c);b.end();return c}vEi(){return Bs.a.instance.createInstance(393234)}eoa(a){const b=Nc.a.instance.Vp(D.a.eoa);fe.OutlineElementReader.Yg(a)||Nc.a.instance.Xb("PossiblyIncorrectListRemoval",{["Reason"]:Md.a.Qca});rb.ListReader.uk(a)&&this.hXk(a);b.end()}hXk(a){this.Sf.ina(a);a.Mi()}Hrb(a,b,c,f=!1){const l=Nc.a.instance.Vp(D.a.gei);if(!this.PCf(b,c))return{returnValue:!1,cab:c};
this.irh(a,c,f);f=a.Sa(Mc.a.d_g);var x=a.sa(Mc.a.Rgg,!1);let H=!1;1===c.R_&&c.ame&&!c.JT&&(H=!0);const U=c.propertySet.sa(ab.a.Yac,null);U&&U===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?H=c.ame&&!c.JT:0===c.listType&&(H=0===c.listStyle));x?H&&(c.Aya(16,0),a.setValue(Mc.a.kE,16),a.setValue(Mc.a.dea,0)):(x=this.Sf.jw(b),this.Huh(c,x,f,H,a)&&(l.properties.$("ToggledOff","true"),c.Aya(16,0),this.qbl(a)),0===c.listType&&a.Sa(Mc.a.BVa)&&(c.xA=a.eb(Mc.a.BVa),a.removeProperty(Mc.a.BVa)));if(f&&
(l.properties.$("MultipleOESelection","true"),({cab:c}=this.yuh(b,c)).returnValue))return l.end(),{returnValue:!1,cab:c};this.Obi(b,c,a);a.setValue(Mc.a.Rgg,!0);l.end();return{returnValue:!0,cab:c}}Huh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.xA===zk.a.Kw;a=a.listStyle===b.listStyle&&a.xA===b.xA;this.Sf.Mbb&&(a=a&&!c);return f&&(l||a)}return!1}qbl(a){a.setValue(Mc.a.kE,16);a.setValue(Mc.a.dea,0)}irh(){}PCf(){return!0}yuh(a,b){return{returnValue:16!==b.listType&&
fe.OutlineElementReader.isEmpty(a,!0),cab:b}}rtb(a){const b=Nc.a.instance.Vp(D.a.rtb);Sb.ParagraphReader.$d(a)||Nc.a.instance.Xb("ClearingListFromNonParagraph",{["Reason"]:Md.a.i0d});const c=new tb.GraphIterator;c.set(a);c.$e();c.IB(12);Ta.OutlineElementNavigator.Re(c);this.QPa(c,null);b.end()}PQd(){}merge(a,b,c){const f=Nc.a.instance.Vp(D.a.r_j);fe.OutlineElementReader.Yg(b)||Nc.a.instance.Xb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});fe.OutlineElementReader.Yg(a)||Nc.a.instance.Xb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(rb.ListReader.uk(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=rb.ListReader.D8a;c&&this.uil&&rb.ListReader.uk(a)&&this.eoa(a);if(!rb.ListReader.uk(a)||c&&l)c&&(u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.X7d(b),this.Sf.yzh&&c.propertySet.we($a.a.DVa,zk.a.Kw),1===c.R_&&c.CEf(),this.QPa(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
Qp.IL.E_c&&this.Ppi(b,a);this.eoa(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}Ppi(a,b){a=Sb.ParagraphReader.Jwb(a.currentNode);b=this.Sf.u3f(b);this.Nod(b,a,null)}X7d(a){return this.Sf.jw(a)}Nod(a,b,c){if(a){b=Wd.a.create(b);b=gc.a.xs(b);this.g0a(a,$a.a.fontColor,c,b);this.g0a(a,$a.a.fontSize,c,b);if(this.Tob){let f,l;({value:f}=this.getPropertyValue($a.a.font,c,b,"")).returnValue&&this.Tob.UU(a,f);({value:l}=this.getPropertyValue(ab.a.hV,c,b,-1)).returnValue&&this.Tob.fLa(a,
l)}else this.g0a(a,$a.a.font,c,b),this.g0a(a,ab.a.hV,c,b);u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");Qp.IL.E_c&&(this.g0a(a,$a.a.bold,c,b),this.g0a(a,$a.a.italic,c,b),this.g0a(a,$a.a.superscript,c,b),this.g0a(a,$a.a.subscript,c,b))}}Wqh(){}g0a(a,b,c,f){c&&c.Sa(b)?a.setValue(b,c.eb(b)):f&&f.cache&&(c=f.cache,c.Sa(b)&&a.setValue(b,c.eb(b)))}getPropertyValue(a,b,c,f){if(b&&b.Sa(a))return f=b.eb(a),{returnValue:!0,value:f};if(!c||
!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Sa(a)?(f=b.eb(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}HSf(a,b){b.Sa(Mc.a.kE)||(a===D.a.NM?b.setValue(Mc.a.kE,1):a===D.a.mP&&b.setValue(Mc.a.kE,0));b.Sa(Mc.a.dea)||b.setValue(Mc.a.dea,0);return b}ZPa(a,b,c,f,l,x,H){a=Nc.a.instance.Vp(D.a.ZPa);const U=this.Sf.jw(b);c=dj.a.wN(0,c);c.xA=f;c.Kra=x;U&&c.Sbe(U)&&c.xA===U.hX||(f=new pf.GraphTransaction(15),f.Fy(b),b=this.cej(c),null!=b&&H.numbering(b)&&(ia.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+x),Qp.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}cej(a){var b;let c=null===(b=null===mv||void 0===mv?void 0:mv[a.listType])||void 0===b?void 0:b[a.Kra];if(null==c)return null;b=new J.DictionaryPropertySet;b.setValue(Mc.a.kE,a.listType);b.setValue(Mc.a.dea,a.listStyle);b.setValue(Mc.a.BVa,a.xA);b.setValue($a.a.Ri,c.Ri);this.B9k(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return Qp.fh||(Qp.fh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get IL(){return Qp.AK||
(Qp.AK=Db.a.instance.ub("Box4.List.ListSettings"))}}Qp.fh=null;Qp.AK=null;Object(m.a)(Qp,"ListEditor",null,[294]);class Kn{}Kn.BDe=80640;Kn.CDe=0;Kn.Ide=80640;Kn.Jde=-80640;Object(m.a)(Kn,"ParagraphConstants",null,[]);var Yl=d(186);class qL extends Qp{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){super(a,b);this.g3c=[$a.a.Ri,$a.a.font];this.i8c=[$a.a.Ri,$a.a.font,$a.a.fontColor,kb.a.autonumberBulletType,kb.a.Mvb];this.peb=c;this.lfc=f;this.$Cb=l.Gkg;this.dM=x;this.Yl=H;this.uH=ja;this.qA=ya;this.ki=
Va;this.Uva=hb;this.Jec=l.Oke;this.Fdb=l.Ikg;this.VL=yb;this.Qb=Zb;this.Fa=fc;this.Gva=l.pptCopyPasteListMarkerEnabled;this.Iec=l.pptCopyPasteMarginAndIndentationEnabled;this.wDg=l.pptCopyPasteTextWithSpacingFromExternal}RLb(a){super.RLb(a);this.Fdb&&this.aLc(a.propertySet,this.Jt.propertySet)}FVe(a){if(this.$Cb&&this.Jt&&this.Jt.propertySet){const b=this.Jt.propertySet.sa(ab.a.listLevel,-1);-1!==b&&this.GVe(a,b)}this.Gva&&this.Jt&&(this.Jt.Uvb=!0);this.wDg&&this.Jqh(a);this.QQd(a,this.Jt);this.Jt=
null}vqh(a,b,c){b=this.Di.T8b(a);this.Di.lNb(a,b,c,!1,!0)}PCf(a,b){if(!a||!b)return!1;if(a.Bb(4)){var c=this.Sf.Y7d(a);this.peb.Re(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Bb(2);const f=c.sa(ab.a.eo,Be.a.indent),l=c.sa(ab.a.$l,Be.a.leftMargin);this.peb.Re(a);a=f;let x=l;({indent:a,margin:x}=this.ETd(Xi.Kzf(Sb.ParagraphReader.Mja(c,$a.a.fontSize,0)),b.listType,f,l,a,x));return!!(this.IPj(x)&this.DOj(a))}H2f(a,b,c,f){if(!a)return xa.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{Dne:c,Hde:f};b&&(c=b.sa(kb.a.e2b,Be.a.leftMargin),f=b.sa(kb.a.HZd,Be.a.indent),(a=this.Fa.$m(a))&&a.ud&&(c=b.sa(ab.a.$l,Be.a.leftMargin),f=b.sa(ab.a.eo,Be.a.indent)));return{Dne:c,Hde:f}}hCf(a,b,c,f){if(!a||!this.dM.Yg(b))return xa.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{p3d:c,o3d:f};var l=this.qQ(b,this.uH.nda(b));if(l){const x=a.sa(ab.a.$l,Be.a.leftMargin),H=a.sa(ab.a.eo,Be.a.indent);c=x;f=H;let U=Be.a.leftMargin,
ja=Be.a.indent;({Dne:U,Hde:ja}=this.H2f(a,l,U,ja));l=dj.a.NCa(l,null).listType;const ya=x+(0<=H?0:H),Va=U+(0<=ja?0:ja),hb=b.Bb(4);let yb=16;hb&&(yb=this.lfc.Wwb(hb),b.zc());ja&&ya===Va&&l===yb?(c=U,f=ja):({indent:f,margin:c}=this.ETd(this.E9a(a),yb,H,x,f,c),c=Math.max(Math.min(c,Kn.BDe),Kn.CDe),f=Math.max(Math.min(f,Kn.Ide),Kn.Jde))}return{p3d:c,o3d:f}}H7i(a,b){if(!a||!this.dM.Yg(b))return xa.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
Be.a.leftMargin;let c=Be.a.leftMargin,f=Be.a.indent;({p3d:c,o3d:f}=this.hCf(a,b,c,f));0<c&&xa.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}E7i(a,b){if(!a||!this.dM.Yg(b))return xa.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),Be.a.indent;let c=Be.a.leftMargin,f=Be.a.indent;({p3d:c,o3d:f}=this.hCf(a,b,c,f));0<f&&xa.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}yuh(a,b){return{returnValue:!1,
cab:b}}Huh(a,b,c,f,l){return f?!0:!b||l&&l.Sa($a.a.Ri)?!1:a.listType===b.listType}IPj(a){return a<Kn.BDe&&a>=Kn.CDe}DOj(a){return a<Kn.Ide&&a>=Kn.Jde}B9k(a,b){a.setValue(kb.a.autonumberBulletType,b)}wjl(a){return a}A0d(a,b){a.Sa(ab.a.listLevel)&&b.we(ab.a.listLevel,a.Lh(ab.a.listLevel))}Wbj(a,b){return Object(Xa.a)(Yl.TableCellNode,a)?this.uH.r_f(a,this.qA.yUc(a),b):this.Odj(a,b)}Odj(a,b){--b;const c=a.sa(ab.a.Q_,[]);return 0>b||b>=c.length?(xa.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",
b),Nc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Fh.Be(c[b])}Nod(){}GVe(a,b){if(this.dM.Yg(a)&&0<=b&&b<To.a.a8){const c=a.currentNode,f=a.Bb(2);c&&c.setValue(ab.a.listLevel,b);f&&(f.setValue(ab.a.listLevel,b),a.zc())}}Hbl(a,b){if(this.dM.Yg(a)&&b&&b.propertySet){var c=a.Bb(4);c&&(b.Sxb&&b.v9&&(this.Fdb?(this.aLc(b.propertySet,c),this.Gva&&b.propertySet.Sa(kb.a.autonumberBulletType)&&c.setValue(kb.a.autonumberBulletType,b.propertySet.eb(kb.a.autonumberBulletType))):
c.setValue($a.a.Ri,b.v9)),a.zc())}}Wqh(a){if(this.dM.Yg(a)){if(this.$Cb&&this.Jt&&this.Jt.propertySet){const b=this.Jt.propertySet.sa(ab.a.listLevel,-1);-1!==b&&this.GVe(a,b);this.Hbl(a,this.Jt)}this.Iec&&this.hbl(a);this.Gva&&(this.Jt&&this.Jt.propertySet?this.ENj(this.Jt)||(xa.a.J(512496285,820,50,"Copied from external, such as website."),this.HVe(a)):(xa.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.HVe(a)));this.wDg&&this.Jqh(a);this.Jt=null}else xa.a.J(512496288,820,10,
"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}Jqh(a){const b=this.uH.nda(a),c=this.qQ(a,b),f=a.Bb(2);c&&f&&0<=b&&b<To.a.a8&&(this.Jt&&this.Jt.propertySet&&this.Jt.propertySet.Sa(kb.a.ux)||(xa.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(kb.a.ux,c.sa(kb.a.LJi,Be.a.lineSpacing)),f.setValue(kb.a.jX,c.sa(kb.a.MJi,2))),this.Jt&&this.Jt.propertySet&&this.Jt.propertySet.Sa(kb.a.aea)||(xa.a.J(512496283,820,50,"Get master defined line-spacing before"),
f.setValue(kb.a.aea,c.sa(kb.a.$Ji,Be.a.npg)),f.setValue(kb.a.qla,c.sa(kb.a.aKi,4))),this.Jt&&this.Jt.propertySet&&this.Jt.propertySet.Sa(kb.a.$da)||(xa.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(kb.a.$da,c.sa(kb.a.YJi,Be.a.mpg)),f.setValue(kb.a.pla,c.sa(kb.a.ZJi,4))));a.zc()}ENj(a){if(a.propertySet.Sa($a.a.Ri)){const b=a.propertySet.eb($a.a.Ri).length;if(1===b&&a.propertySet.Sa($a.a.font)||3===b&&a.propertySet.Sa(kb.a.autonumberBulletType))return!0}return!1}hbl(a){var b=
this.uH.nda(a);const c=this.qQ(a,b),f=a.Bb(2);c&&f&&0<=b&&b<To.a.a8&&(this.Jt&&this.Jt.propertySet&&this.Jt.propertySet.Sa(ab.a.$l)||(xa.a.J(512496281,820,50,"Get master defined indent-left."),c.Sa(kb.a.e2b)&&f.setValue(ab.a.$l,c.eb(kb.a.e2b)),(b=this.Fa.$m(f))&&b.ud&&f.setValue(ab.a.$l,c.sa(ab.a.$l,Be.a.leftMargin))),this.Jt&&this.Jt.propertySet&&this.Jt.propertySet.Sa(ab.a.eo)||(xa.a.J(512496280,820,50,"Get master defined firstline indent."),c.Sa(kb.a.HZd)&&f.setValue(ab.a.eo,c.eb(kb.a.HZd)),(b=
this.Fa.$m(f))&&b.ud&&f.setValue(ab.a.eo,c.sa(ab.a.eo,Be.a.leftMargin))));a.zc()}HVe(a){const b=this.uH.nda(a),c=this.qQ(a,b),f=a.Bb(4);c&&f&&0<=b&&b<To.a.a8&&(xa.a.J(512496279,820,50,"Get master defined list marker"),c.Sa($a.a.Ri)?(f.setValue($a.a.Ri,c.eb($a.a.Ri)),c.Sa($a.a.font)?f.setValue($a.a.font,c.eb($a.a.font)):c.Sa(kb.a.autonumberBulletType)&&f.setValue(kb.a.autonumberBulletType,c.eb(kb.a.autonumberBulletType))):(f.setValue($a.a.font,El.OAf),f.setValue($a.a.Ri,[El.YSd])));a.zc()}NZc(a){return a?
16!==this.uH.e8d(a).Loe:!1}rtb(){xa.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");Nc.a.instance.Xb("FormattingNotCleared",{["Reason"]:Md.a.yfg})}jWk(a){if(this.dM.Yg(a)){var b=a.Bb(4);b&&(1===this.lfc.Wwb(b)&&b.removeProperty(kb.a.autonumberBulletType),a.zc())}}ccl(a){this.dM.Yg(a)&&(a=a.currentNode)&&a.setValue(kb.a.TQj,!0)}merge(a,b,c,f){const l=this.uH.nda(b),x=this.qQ(a,this.uH.nda(a)),H=this.qQ(b,l);x&&a&&(a.Bb(2),a.currentNode&&(a.currentNode.Sa(ab.a.$l)&&
x.Sa(ab.a.$l)&&!WA.APropertySet.LZa(ab.a.$l.type,a.currentNode.Lh(ab.a.$l),x.Lh(ab.a.$l))&&x.we(ab.a.$l,a.currentNode.Lh(ab.a.$l)),a.currentNode.Sa(ab.a.eo)&&x.Sa(ab.a.eo)&&!WA.APropertySet.LZa(ab.a.eo.type,a.currentNode.Lh(ab.a.eo),x.Lh(ab.a.eo))&&x.we(ab.a.eo,a.currentNode.Lh(ab.a.eo))),a.zc());super.merge(a,b,c);c&&this.$Cb&&(this.GVe(a,l),this.ccl(a),this.jWk(a));this.$bi(b,H,x);if(f&&(a.Bb(2),c=a.currentNode.sa(kb.a.fKa,""),a.zc(),c.length))for(a=this.Qb.s7d(b);a.Cf(1)&&a.currentNode!==f.currentNode;)a.Bb(2),
a.currentNode.setValue(kb.a.fKa,c),a.zc();return!0}Obi(a,b,c){const f=Tc.a.Ib;f&&(f.Nj=!0);this.QQd(a,b,c)}hxl(a,b){var c=tb.GraphIterator.nb(b);this.Sf.ina(c);b=c.currentNode;c.zc();c=this.createList(a);a.zc();c.z7a(b,kb.a.shapeId,kb.a.xxa)}QPa(a,b){this.QQd(a,b)}qvf(a,b,c){this.dM.Yg(a)||Nc.a.instance.Xb("PossibleIndentNotAdjusted",{["Reason"]:Md.a.Qca});const f=a.Bb(2),l=f.sa(ab.a.eo,Be.a.indent),x=f.sa(ab.a.$l,Be.a.leftMargin);this.peb.Re(a);if(16===b)this.Uva.Av.Hjb(f,0),0>l&&(Nc.a.instance.Xb("UnexpectedlyChangingLeftIdent",
{["Reason"]:"NegativeLeftIndent"}),this.Di.Ijb(a,1,Math.max(x+l,0)));else{var H=this.qQ(a,this.uH.nda(a));H||(H=new J.DictionaryPropertySet,xa.a.J(512496273,820,50,"listStyle is null"));var U=Be.a.indent;let ja=Be.a.leftMargin;c?{Dne:ja,Hde:U}=this.H2f(f,H,ja,U):(U=H.sa(ab.a.eo,Be.a.indent),ja=H.sa(ab.a.$l,Be.a.leftMargin));H=dj.a.NCa(H,null).listType;const ya=ja+(0<=U?0:U);U&&x+(0<=l?0:l)===ya&&H===b?(this.Uva.Av.Hjb(f,U),this.Di.Ijb(a,1,ja)):(U=l,H=x,{indent:U,margin:H}=this.ETd(this.E9a(f),b,l,
x,U,H),0<this.uH.nda(a)&&c&&(H+=ja),H=Math.max(Math.min(H,Kn.BDe),Kn.CDe),U=Math.max(Math.min(U,Kn.Ide),Kn.Jde),this.Uva.Av.Hjb(f,U),this.Di.Ijb(a,1,H))}}E9a(a){if(!a)return 0;a=this.Yl.Nka(a)?this.Yl.Ylj(this.Yl.gxb(a)):Sb.ParagraphReader.Mja(a,$a.a.fontSize,0);return Xi.Kzf(a)}ETd(a,b,c,f,l,x){let H=(b=1===b)?.3125:.375;0<a&&(H=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);
a=-1*ye.a.Tta(H);0>=c&&a<c?(x=a-c,l=c+x,x=f-x):0<c&&(l=a,x=f-a);return{indent:l,margin:x}}$bi(a,b,c){if(b&&c){Ta.OutlineElementNavigator.wi(a);var f=a.yq;if(Sb.ParagraphReader.el(a)){b=b.sa($a.a.fontSize,Or.fontSize);c=c.sa($a.a.fontSize,Or.fontSize);for(let l=0;l<f.Ra.length;++l){const x=f.Ra.ga(l);x&&x.formatting&&x.formatting.Vz&&x.formatting.Vz.Sa($a.a.fontSize)&&x.formatting.Vz.eb($a.a.fontSize)===b&&this.ki.Pq(x.formatting,c)}}Ta.OutlineElementNavigator.Re(a)}}X7d(a){if(this.Gva){if(a=this.Sf.jw(a))a.Uvb=
!0;return a}return super.X7d(a)}QQd(a,b,c=null){if(this.dM.Yg(a)){this.fci(b,c,a);var f=a.Bb(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?dj.a.NCa(f,f).Y_b():f=this.createList(a);a.zc();const l=a.Bb(2);a.zc();this.Jec&&l.sa(Mc.a.r$b,!1)||this.Gva&&b.Uvb?f.z7a(b.propertySet,kb.a.shapeId,kb.a.xxa,ab.a.listLevel,$a.a.Ri,Mc.a.kE):f.z7a(b.propertySet,kb.a.shapeId,kb.a.xxa,ab.a.listLevel,kb.a.vFa);c&&c.Sa(kb.a.autonumberBulletType)&&f.setValue(kb.a.autonumberBulletType,c.eb(kb.a.autonumberBulletType));
this.Gva&&b.Uvb&&b.Sxb&&(3===b.v9.length&&b.propertySet.Sa(kb.a.autonumberBulletType)?(f.setValue($a.a.Ri,b.v9),f.setValue(kb.a.autonumberBulletType,b.propertySet.eb(kb.a.autonumberBulletType)),xa.a.J(512496267,826,50,"Support CCP customized number list")):1===b.v9.length&&b.H$a?(f.setValue($a.a.Ri,b.v9),f.setValue($a.a.font,b.font),xa.a.J(512496266,826,50,"Support CCP customized bullet")):(xa.a.J(512496265,826,50,"Set list use dst master liststyle."),this.HVe(a)))}else return;else a.Mi();b&&b.iYf||
(this.Jec?(c=this.Sf.jw(a),this.qvf(a,c?c.listType:16,b?b.Uvb:!1)):this.qvf(a,b?b.listType:16,b?b.Uvb:!1))}else xa.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),Nc.a.instance.Xb("FailedToApplyListProperties",{["Reason"]:Md.a.Qca})}fci(a,b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.VL.$x(b,a.propertySet,this.g3c),c=this.qQ(c,this.uH.nda(c))||new J.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(Mc.a.dea,6),b.Sa($a.a.Ri)||(a.propertySet.setValue($a.a.font,
El.OAf),a.propertySet.setValue($a.a.Ri,[El.YSd]),c.Sa($a.a.Ri)&&(b=c.eb($a.a.Ri)[0],b!==El.lZd&&b!==El.ZIa&&this.VL.$x(c,a.propertySet,this.g3c)))))}qQ(a,b){this.dM.Yg(a)||Nc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:Md.a.Qca});a=this.Wlj(a);return a?this.Wbj(a,1+b):(xa.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),Nc.a.instance.Xb("PossibleLossOfListStyle",{["Reason"]:Md.a.IHf}),null)}Wlj(a){a=tb.GraphIterator.UG(a);a.D6(gj.OutlineReader.n$b);const b=a.Pw(16);
return b?b:a.M1a()}Wwb(a){return this.uH.e8d(a).Loe}irh(a,b,c){c||0!==b.listType||(b.xA=a.sa($a.a.DVa,zk.a.Kw))}aLc(a,b){this.VL.eBi(a,b,this.i8c)}}Object(m.a)(qL,"ListEditor",Qp,[293,294]);class Zs{constructor(a,b){this.ZZb=a;this.wsb=b}}Object(m.a)(Zs,"BulletMarker",null,[]);class $s{constructor(a,b){this.RAf=a;this.D0g=b}}Object(m.a)($s,"ListMarkerPreview",null,[]);class at{constructor(a,b,c){this.t0g=a;this.z0g=b;this.bSd=c}}Object(m.a)(at,"NumberingMarker",null,[]);class rL{constructor(a,b){this.Qb=
a;this.CFb=b;this.Qak=new mc.a(Object(F.a)(this,this.qEi,"createListBulletDictionary"));this.Vak=new mc.a(Object(F.a)(this,this.wEi,"createListNumberingDictionary"));this.Uak=new mc.a(Object(F.a)(this,this.uEi,"createListMarkerPreviewDictionary"));this.Sak=new mc.a(Object(F.a)(this,this.tEi,"createListMarkerAltTextDictionary"))}qEi(){const a=new Rd.a;a.$(3,new Zs(8226,"Arial"));a.$(4,new Zs(111,"Courier New"));a.$(5,new Zs(167,"Wingdings"));a.$(6,new Zs(113,"Wingdings"));a.$(7,new Zs(118,"Wingdings"));
a.$(8,new Zs(216,"Wingdings"));a.$(9,new Zs(252,"Wingdings"));return a}wEi(){const a=new Rd.a;a.$(11,new at(0,".",8));a.$(12,new at(0,")",7));a.$(13,new at(1,".",15));a.$(14,new at(3,".",5));a.$(15,new at(4,")",2));a.$(16,new at(4,".",4));a.$(17,new at(2,".",14));return a}uEi(){const a=new Rd.a;a.$(1,new $s("\u2022",["1.","2.","3."]));a.$(2,new $s("o",["1)","2)","3)"]));a.$(3,new $s("\uf0a7",["I.","II.","III."]));a.$(4,new $s("\uf071",["A.","B.","C."]));a.$(5,new $s("\uf076",["a)","b)","c)"]));a.$(6,
new $s("\uf0d8",["a.","b.","c."]));a.$(7,new $s("\uf0fc",["i.","ii.","iii."]));return a}tEi(){const a=new Rd.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);
a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);return a}get zVa(){return this.Qak.value}get Ydd(){return this.Vak.value}get L1c(){return this.Uak.value}get vpg(){return this.Sak.value}Mxf(a,b){const c=this.Qb.Nc(a);c.set(a);
for(a=c.Bb(1);a;){var f=c.Bb(4);if(f){if(1===b){if(1!==f.sa(Mc.a.kE,16))return!1}else if(2===b){if(0!==f.sa(Mc.a.kE,16))return!1}else if(a=f.sa($a.a.Ri,null),this.CFb.qYc(b)){f=f.sa($a.a.font,"");const l=this.zVa.ga(b);if(!a||1!==a.length||l.ZZb!==a[0]||l.wsb!==f)return!1}else if(this.CFb.rYc(b)){if(f=this.Ydd.ga(b),!a||3!==a.length||f.t0g!==a[1]||f.z0g!==ha.a.fromCharCode(a[2]))return!1}else return!1;c.zc()}else if(0!==b)return!1;a=c.Cf(1)}return!0}qYc(a){return this.CFb.qYc(a)}rYc(a){return this.CFb.rYc(a)}L6b(a){return this.CFb.L6b(a)}BUc(a){return this.CFb.BUc(a)}}
Object(m.a)(rL,"PptListMarkersLoader",null,[297,296]);class sL{XGl(a,b){if(!a)return!1;b.Bb(2);a=b.currentNode.sa(Mc.a.r$b,!1);b.zc();return!a}}Object(m.a)(sL,"PptMergeListEditorInOutlineElementStrategy",null,[298]);class Uz{constructor(){this.Eli=[0,3,4,5,6,7,8,9];this.Dpk=[0,11,12,13,14,15,16,17]}qYc(a){return 3<=a&&9>=a}rYc(a){return 11<=a&&17>=a}L6b(a){return Uz.P7f(a,this.Eli,1)}BUc(a){return Uz.P7f(a,this.Dpk,2)}static P7f(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(m.a)(Uz,"TextBulletTypeHelper",
null,[296]);class RD{get name(){return"PowerPointWebEditor.ListEditor"}Zb(a){a.register(293,"PowerPointWebEditor.IPptListEditor").ma().oa(()=>new qL(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),
a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(294,"Box4.List.IListEditor").ma().oa(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(295,"PowerPointWebEditor.IPptListCore").ma().oa(()=>new pL(a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(296,"PowerPointWebEditor.ITextBulletTypeHelper").ma().oa(()=>new Uz);a.register(297,"PowerPointWebEditor.IPptListMarkersLoader").ma().oa(()=>new rL(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(298,"Box4.IMergeListEditorInOutlineElementStrategy").ma().oa(()=>new sL)}init(){}dispose(){}static main(){z.a.instance.Dc(new RD)}}
Object(m.a)(RD,"PPTWebEditorListEditorPackage",null,[2,3]);var ZQ=d(882);class tL{sk(a){return od.TableReader.sk(a)}Ai(a){return od.TableReader.Ai(a)}VTc(a,b,c){return od.TableReader.VTc(a,b,c)}Ku(a){return od.TableReader.Ku(a)}qbb(a){return od.TableReader.qbb(a)}Cs(a){return od.TableReader.Cs(a)}HN(a){return od.TableReader.HN(a)}}Object(m.a)(tL,"TableReaderProxy",null,[1131]);class uL{Gjg(){return tk.j(void 0)}whj(a){return tk.c(a)}}Object(m.a)(uL,"TableRowReaderProxy",null,[1130]);class vL extends ch.a{constructor(a,
b,c,f,l){super(a,b);this.YUh=l;this.JK=f;a=l&&this.gb.sa(ab.a.skippedCell,!1);b=this.Md.hp(va.a.td);this.nc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.JK.nr?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.OOf()}JU(){return Ij.a.vjc}Ky(){this.YUh&&this.gb.sa(ab.a.skippedCell,!1)&&this.wdl()}wdl(){this.JK.nr&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft=
"",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(m.a)(vL,"GhostTableCellViewElement",ch.a,[1193,456,351,106]);class wL{constructor(a,b,c){this.MLd=a;this.JK=b;this.Cnb=c}create(a,b){return Le.isGhostCellNode(b.node)?Le.shouldRenderGhostCellNode(b.node)?new vL(a,b,this.MLd,this.JK,P.a.instance.ga(63),P.a.instance.ga(77)):null:this.Cnb.create(a,b)}}Object(m.a)(wL,"GhostTableCellViewElementFactory",null,[1112]);class xL{constructor(a,b,c){this.yc=a;this.Wea=b;
this.nMg=c;this.VF=null;this.rCb=this.sCb=-1}Xdl(a,b=null){this.Zdl(a);this.VF&&this.tal(b)}Dti(){this.VF=null;this.rCb=this.sCb=-1}J_f(a,b,c){if(!a||!this.VF)return{row:b,column:c};var f=this.Wea.PVf(a,this.VF,this.nMg.NIc,this.nMg.MIc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.pi;l===b||this.Wea.BYc(a,this.VF)||(l=b);var x=0,H=this.yc.Ai(this.VF)-1;let U=0,ja=this.yc.sk(this.VF)-1;this.Wea.BYc(a,this.VF)&&b>=U&&b<=ja&&c>=x&&c<=H&&(a=(x=(x=this.VF.qf(b,c))?x.Xy():null)?x.rowSpan:0,H=x?x.colSpan:
0,x=c,H=c+H-1,U=b,ja=b+a-1);l>=U&&l<=ja&&f>=x&&f<=H&&(b=l,c=f);return{row:b,column:c}}ynk(a){a=this.B7f(a);return!!a&&14===a.type&&a.Lp()}lci(a,b,c,f,l,x){if(!this.VF||!a||14!==a.type||this.VF!==a||!b)return{rYf:c,gYf:f,aCh:l,YBh:x};this.VF.qf(c,f).isControllingCell&&({rowIndex:c,dja:f}=this.j$i(c,f));if(this.VF.qf(l,x).isControllingCell||!this.Wea.BYc(b,this.VF))({row:l,column:x}=this.J_f(b,l,x));xa.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{rYf:c,gYf:f,aCh:l,YBh:x}}Zdl(a){(a=
this.B7f(a))&&14===a.type&&(this.VF=a)}B7f(a){return 1074135132===a.Ue&&a.ud?this.yc.JN(a):this.yc.G6b(a)}tal(a){this.VF&&a&&({row:this.sCb,column:this.rCb}=this.J_f(a,this.sCb,this.rCb))}j$i(a,b){if(!this.VF)return{rowIndex:a,dja:b};let c=null;0<=a&&a<this.yc.sk(this.VF)&&0<=b&&b<this.yc.Ai(this.VF)&&(c=this.VF.qf(a,b));this.CNj(c)&&(a=this.sCb,b=this.rCb);return{rowIndex:a,dja:b}}CNj(a){if(!this.VF)return!1;let b=0;var c=this.yc.Ai(this.VF)-1;let f=0;var l=this.yc.sk(this.VF)-1;if(a){l=a.rowIndex;
c=a.pi;const x=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+x-1}return this.sCb>=f&&this.sCb<=l&&this.rCb>=b&&this.rCb<=c}}Object(m.a)(xL,"PptTableDragSelectionCellExtendStrategy",null,[280]);var yL=d(830),cn=d(242);class zL{constructor(){this.aWc=this.colSpan=this.Hmd=0}}Object(m.a)(zL,"HeightInfo",null,[]);class AL{constructor(){this.uQa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.Sag=this.wbg=this.kjg=this.mjg=this.ljg=!1}}Object(m.a)(AL,"TableCellInfo",null,
[]);class BL{constructor(){this.nOh=[]}get cells(){return this.nOh}fOd(a){this.cells.push(a)}}Object(m.a)(BL,"TableRowInfo",null,[]);class CL{constructor(){this.uQa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.yig=this.Fjg=this.Eig=!1}}Object(m.a)(CL,"UpdateInfo",null,[]);var $Q=d(1069),DL=d(558);class Fv extends DL.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){super(a,b,hb);this.VNa=!1;this.z3a=this.dnf=this.IJd=this.y3a=this.sGa=null;this.fGd=0;this.jqi=1;this.hqi=16;
this.Zpi=256;this.bqi=4096;this.iqi=65536;this.uzc=this.Nzc=this.Xzc=this.fAc=!1;this.p8e=this.Spf=this.gDc=this.yAc=this.$ga=0;this.Ire=this.Jre=null;this.k1h=Object(oa.a)(124,b);this.Kba=c;this.$ba=Zb;this.hd=Va;this.SV=yb;this.JK=ya;this.nEc=U;this.Sha=ja;this.Rha=H;this.sr=x;this.B6c=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Md.hp(va.a.td);this.nc(a);this.mZ=this.Md.hp(va.a.div);a.appendChild(this.mZ);this.mZ.className="TableCellContent";
this.Xo(this.mZ)}g5b(){return this.mZ.offsetHeight+this.mZ.offsetTop}puc(a,b,c,f){a=this.VNa?a:a+c;this.sGa||(this.sGa=this.rLc());this.sGa.style.left=a-2.5+"px";this.sGa.style.top=b+"px";this.sGa.style.height=f+"px"}PKf(){const a=this.Md.hp(va.a.div);Rc.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}rLc(){const a=this.PKf();a.className="TableColumnResizeHandle";return a}nYd(){const a=this.Md.hp(va.a.div);Rc.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
a.className=tf.a.RVk;return a}ICl(a,b,c,f){f?(a=this.VNa?a:a+b,this.y3a||(this.y3a=this.vCi()),b=this.y3a.style,b.top=c+"px",b.left=a+"px"):this.y3a&&(this.aFf(this.y3a,!1),this.y3a=null);return this.y3a}vCi(){const a=this.nYd(),b=this.Md.hp(va.a.div);Rc.c(b,!0);b.className=tf.a.vee;a.appendChild(b);return a}lFl(a,b,c,f){this.ASi();const l=this.IJd.style;l.top=c+"px";l.left=f+"px";c=this.dnf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}ASi(){if(!this.IJd){const a=this.nYd(),b=this.Md.hp(va.a.div);
Rc.c(b,!0);b.className=tf.a.Heg;a.appendChild(b);this.IJd=a;this.dnf=b}}pFl(a,b,c){c?(this.z3a||(this.z3a=this.nGi()),c=this.z3a.style,c.top=a+b-10+"px",this.VNa?c.right="-15px":c.left="-15px"):this.z3a&&(this.aFf(this.z3a,!0),this.z3a=null);return this.z3a}nGi(){const a=this.nYd(),b=this.Md.hp(va.a.div);Rc.c(b,!0);b.className=tf.a.wee;a.appendChild(b);return a}khh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}aFf(a,b){b?cn.a.Ssi(a):cn.a.Osi(a);this.htmlElement.removeChild(a)}rjg(a){a=
a?D.a.$ta:u.AFrameworkApplication.isRtl?D.a.hab:D.a.hUa;return 8!==u.AFrameworkApplication.Ta.mi(Wd.a.create(this.gb),a,1,!0,new $Q.a,null)}JU(a){super.JU(a);const b=super.JU(a);this.fGd=this.xlj(a);if(this.$ba.nx&&!this.Qc.Wl){var c=ke.a.nb(a.W1,a.currentNode);c.$e();this.Rha.Re(c);a=this.nEc.getContainingTable(a);this.Sha.Yg(c)&&a&&!this.sr.CCa(a)&&(c=c.Xq)&&c.htmlElement&&this.Kba.mJf(c.htmlElement,a,this.Ma)}return new Ij.a(b.ena+this.yAc+In.a.Ykb,Math.max(b.minWidth,this.fGd),b.fna+this.gDc+
In.a.Ykb)}xlj(a){return od.TableReader.szb(a)?(a=this.$ba.Lke?this.gb.sa(dh.a.oUd,1):1,a*In.a.E0e+(a-1)*(this.yAc+this.gDc+In.a.Ykb)):In.a.E0e}I6(a){this.mZ.style.paddingLeft=a.ena-In.a.Ykb+"px";this.mZ.style.paddingRight=a.fna-In.a.Ykb+"px";this.$ba.d_c&&this.$ba.Lke&&(this.mZ.style.minWidth=this.fGd+"px")}Yaa(a){this.UD(this.mZ,a,1)}Ky(){this.dGh();this.zph();var a=tb.GraphIterator.nb(this.gb);a.rc(14);const b=Vd.getContainingTable(a),c=Le.isFirstCellInColumn(a);a=Le.isFirstCellInRow(a);let f="";
c&&Fv.Tmg(b,32)&&(f="columnheader");a&&!c&&Fv.Tmg(b,128)&&(f="rowheader");""!==f?Hb.d(this.htmlElement,Ba.a.role,f):this.htmlElement.removeAttribute(Cc.a.ef);this.hd&&this.hd.jFa(65)&&(this.gb.P0b?Sys.UI.DomElement.addCssClass(this.htmlElement,Bc.T3):Sys.UI.DomElement.removeCssClass(this.htmlElement,Bc.T3));this.JK.nr&&(this.htmlElement.style.border="",this.o1k(),this.T9k(b),this.htmlElement.style.verticalAlign=this.JK.nr.C4i(this.gb));this.Rcl();this.$ba.d_c&&this.$ba.Lke&&(this.gb.Sa(dh.a.PDf)?
this.nrh():this.htmlElement.removeAttribute("rowspan"),this.gb.Sa(dh.a.oUd)?this.Eph():this.htmlElement.removeAttribute("colspan"));this.Qc.Wl&&this.$ba.vVj&&(this.htmlElement.style.width=this.Md.Ld.Pe(this.k1h.width,0)+"px")}Rcl(){if(this.$ba.$Rj||this.$ba.EXj)this.gb.ace?this.nrh():this.htmlElement.removeAttribute("rowspan"),this.gb.D$a?this.Eph():this.htmlElement.removeAttribute("colspan")}dGh(){let a=null;if(this.hd&&this.hd.jFa(65)){var b=tb.GraphIterator.nb(this.gb);b.rc(15);b=b.Pw(15);if(b.Htc){Sys.UI.DomElement.addCssClass(this.htmlElement,
Bc.BAh);return}if(b.ktd){Sys.UI.DomElement.addCssClass(this.htmlElement,Bc.EAh);return}}this.gb.Sa($a.a.jJc)?(a=Ib.a.vI(this.gb.sa($a.a.jJc,Ib.a.nil)),this.$ga|=this.iqi):this.$ba.YUj&&this.JK.nr&&(a=this.JK.nr.w_f(this.gb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>Ib.a.u5i(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.hd&&this.hd.jFa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
Bc.BAh),Sys.UI.DomElement.removeCssClass(this.htmlElement,Bc.EAh))}nrh(){Hb.d(this.htmlElement,Ba.a.rowSpan,this.$ba.d_c?this.gb.sa(dh.a.PDf,1):this.gb.rowSpan)}Eph(){Hb.d(this.htmlElement,Ba.a.colSpan,this.$ba.d_c?this.gb.sa(dh.a.oUd,1):this.gb.colSpan)}o1k(){this.uzc=this.Xzc=this.Nzc=this.fAc=!1}T9k(a){this.JK.nr&&(this.Xal(),this.htmlElement.style.border="0px none",this.DLb(this.gb,a,7),this.DLb(this.gb,a,5),this.DLb(this.gb,a,0),this.DLb(this.gb,a,6),this.B6c&&(this.DLb(this.gb,a,2),this.DLb(this.gb,
a,1)),Hb.d(this.htmlElement,Ba.a.tZd,this.$ga),this.u_k())}zph(){var a=new tb.GraphIterator;a.set(this.gb);a.rc(14);a.Jg(14);a=a.currentNode;this.yAc=In.a.xUc(this.gb,a,ab.a.PNb,this.JK.nr,ab.a.ytl,0);this.gDc=In.a.xUc(this.gb,a,ab.a.RNb,this.JK.nr,ab.a.ztl,0);this.Spf=In.a.xUc(this.gb,a,ab.a.SNb,this.JK.nr,ab.a.Atl,1);this.p8e=In.a.xUc(this.gb,a,ab.a.ONb,this.JK.nr,ab.a.utl,1);this.mZ.style.paddingLeft=this.yAc+"px";this.mZ.style.paddingRight=this.gDc+"px";this.mZ.style.paddingTop=this.Spf+"px";
this.mZ.style.paddingBottom=this.p8e+"px"}Xal(){var a=tb.GraphIterator.nb(this.gb);a.rc(14);a=this.nEc.getContainingTable(a);this.VNa=od.TableReader.vm(a)}DLb(a,b,c){this.SV&&this.SV.kKj(b);a=this.JK.nr.N8i(a,c);b=a.Mii;const f=a.Ppj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,f),c){case 7:this.htmlElement.style.borderTop=b;this.BZc(b)&&(this.fAc=!0);a.lNc&&(this.$ga|=this.jqi);break;case 5:this.uph(5,b);this.BZc(b)&&(this.Nzc=!0);a.lNc&&(this.$ga|=this.bqi);break;case 0:this.htmlElement.style.borderBottom=
b;this.BZc(b)&&(this.uzc=!0);a.lNc&&(this.$ga|=this.Zpi);break;case 6:this.uph(6,b);this.BZc(b)&&(this.Xzc=!0);a.lNc&&(this.$ga|=this.hqi);break;case 2:this.Jre=b;break;case 1:this.Ire=b}}BZc(a){return!a||a.startsWith("0px none")?!1:!0}uph(a,b){if(5===a&&!this.VNa||6===a&&this.VNa)this.htmlElement.style.borderLeft=b;if(5===a&&this.VNa||6===a&&!this.VNa)this.htmlElement.style.borderRight=b}u_k(){if(this.Wil()){var a=tb.GraphIterator.nb(this.gb);if(a.rc(14)){var b=Le.isFirstCellInRow(a),c=Le.isLastCellInRow(a);
this.fAc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.fAc=!0);this.uzc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.uzc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.Pw(14);a=!od.TableReader.vm(a);this.Nzc||(this.htmlElement.style.borderLeft=a?b:c,this.Nzc=!0);this.Xzc||(this.htmlElement.style.borderRight=a?c:b,this.Xzc=!0)}}}Wil(){const a=this.Qc;return a.Mh&&a.features.djl?!0:!1}get hja(){return this.mZ}gK(a){super.gK(a);
this.xU()}xU(){if(!this.Md.Wl&&this.eB){const a=Object(oa.a)(1127,this.FR);a&&a.PXg(this.mZ)}}get ytb(){return this.sGa}static Tmg(a,b){return null!==a&&a.Sa(ab.a.tableLook)?!!(a.properties.eb(ab.a.tableLook)&b):!1}}Object(m.a)(Fv,"TableCellViewElement",DL.a,[1226,456,351,106]);class jm extends ch.a{constructor(a,b,c,f=null){super(a,b);this.$R=null;this.cwc=!0;this.Fm=[];this.hv=[];this.$Ec=this.AG=null;this.A9e=this.cnf=0;jm.CVa=c;this.SV=f;b=this.Md.hp(va.a.div);b.className="TableContainer";this.$j=
this.Md.hp(va.a.table);b.appendChild(this.$j);this.$j.className="Table";Sys.UI.DomElement.addCssClass(this.$j,jm.Yrd);this.Mqf=a;this.uBa=this.Md.hp(va.a.div);this.uBa.id=ka.a.create().toString();this.uBa.className=jm.ctl;this.uBa.setAttribute(Cc.a.QK,Cc.a.gC);b.insertBefore(this.uBa,this.$j);Rc.c(this.uBa,!0);a.Wl&&Hb.d(this.$j,Ba.a.border,this.gb.sa($a.a.Xkb,!0)?"1":"0");this.nc(b);a.Wl||(this.$R=this.Md.hp(va.a.Vui),this.$j.appendChild(this.$R));this.xS=this.Md.hp(va.a.UAh);this.$j.appendChild(this.xS);
this.Xo(this.$j)}get G1(){return this.xS}get table(){return this.$j}get nKc(){return this.$R}Ky(a){this.$j.style.borderCollapse="collapse";if(Ab.StyleReader.nr)Sys.UI.DomElement.removeCssClass(this.$j,jm.Yrd),Sys.UI.DomElement.removeCssClass(this.$j,jm.H0e);else{var b=this.gb.sa($a.a.Xkb,!0);b&&!this.cwc?(Sys.UI.DomElement.removeCssClass(this.$j,jm.H0e),Sys.UI.DomElement.addCssClass(this.$j,jm.Yrd),this.cwc=!0):!b&&this.cwc&&(Sys.UI.DomElement.removeCssClass(this.$j,jm.Yrd),Sys.UI.DomElement.addCssClass(this.$j,
jm.H0e),this.cwc=!1)}P.a.instance.ga(71)&&Ab.StyleReader.nr&&(Hb.d(this.$j,Ba.a.vZd,"Custom"),Hb.d(this.$j,Ba.a.uZd,0));var c=this.$R?od.TableReader.Ai(this.gb):0;b=this.$R?c-this.$R.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Md.hp(va.a.col);this.$R.appendChild(l)}for(f=0;f>b;--f)this.$R.removeChild(this.$R.firstChild);f=Hn.b(this.gb);var x=0;this.SV&&(x=this.SV.y9d(this.gb));l=Array(c);var H=!0;b=0;for(var U=0;U<c;++U){let ja=this.L8(U);0<=f[U]?(l[U]=Math.max(ja,this.Md.Ld.Pe(f[U],0)-x),
this.$R.childNodes[U].style.width=l[U]+"px",b+=l[U]):(l[U]=-1,H=!1,this.$R.childNodes[U].style.width="",b+=ja)}if(P.a.instance.ga(63)||P.a.instance.ga(77))H?Sys.UI.DomElement.addCssClass(this.$j,jm.UJh):Sys.UI.DomElement.removeCssClass(this.$j,jm.UJh);if(this.Fm.length===c)for(x=this.DRc(),H=0;H<c;++H)U=this.L8(H),this.Fm[H].childNodes[x].style.width=0<=f[H]?Math.max(U,l[H])+"px":U+"px";c=od.TableReader.vm(this.gb);if(this.gb.Sa($a.a.Jl))switch(od.TableReader.HN(this.gb)){case 1:this.$j.style.marginLeft=
"";this.$j.style.marginRight="auto";break;case 2:this.$j.style.marginLeft="auto";this.$j.style.marginRight="auto";break;case 3:this.$j.style.marginLeft="auto";this.$j.style.marginRight="";break;case 14:this.$j.style.marginLeft=c?"auto":"";this.$j.style.marginRight=c?"":"auto";break;case 15:this.$j.style.marginLeft=c?"":"auto";this.$j.style.marginRight=c?"auto":"";break;default:this.$j.style.marginLeft="",this.$j.style.marginRight=""}else this.$j.style.marginLeft="",this.$j.style.marginRight="",P.a.instance.ga(63)&&
this.gb.Sa(ab.a.$l)&&(f=({unit:a}=od.TableReader.bka(a)).returnValue,a=(new kv.a(a,f)).EPb+"px",c?this.$j.style.marginRight=a:this.$j.style.marginLeft=a);(P.a.instance.ga(71)||P.a.instance.ga(77))&&this.Vdl(Ab.StyleReader.nr,this.gb,this.$j);this.gb.properties.sa($a.a.ehg,!1)?(Sys.UI.DomElement.addCssClass(this.$j,jm.BHf),Hb.d(this.$j,Ba.a.Qfi,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.$j,jm.BHf),this.$j.removeAttribute(Cc.a.Fra));(a=od.TableReader.H$d(this.gb))&&this.$j.setAttribute("title",
a);(a=od.TableReader.G$d(this.gb))?this.Mqf.Wl&&1===this.Mqf.mode?this.$j.removeAttribute(Cc.a.Fra):(this.uBa.innerText=a,this.$j.setAttribute(Cc.a.Fra,this.uBa.id)):(this.uBa.innerText="",this.$j.removeAttribute(Cc.a.Fra));nd.a.instance.Tj&&!P.a.instance.ga(30)&&(this.$j.style.width="0px");P.a.instance.ga(30)&&(this.$j.style.minWidth=b+"px");this.X9k();this.$dl()}X9k(){if(this.SV){const a=this.SV.CNl(this.gb);""!==a&&(this.$j.style["border-spacing"]=a);this.Jie&&(this.$j.style.borderCollapse="separate")}}get Jie(){return!!this.SV&&
this.SV.kKj(this.gb)}P5d(a){return this.SV?this.SV.OMl(this.gb,a):0}$dl(){this.$j.style.borderTop="";this.$j.style.borderBottom="";this.$j.style.borderLeft="";this.$j.style.borderRight=""}L8(a){return(Ab.StyleReader.nr?Ab.StyleReader.nr.L8(this.gb,a):In.a.asd)+(this.SV?this.SV.y9d(this.gb):0)}Vdl(a,b,c){a&&(c.style.background=a.Elj(b))}Yaa(a){this.UD(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.$j&&(this.ioc(this.htmlElement,this.$j),this.htmlElement.appendChild(this.$j));
this.UD(this.xS,a,1);let b=!1;this.xS.firstChild!==this.AG&&(this.AG=this.xS.firstChild,b=!0);P.a.instance.ga(30)&&od.TableReader.Ku(a.currentNode)||!this.$R||(u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.Fm&&this.Fm.length?this.Fm[0].parentNode:null)!==(this.AG?this.AG.firstChild:null)&&(a=!0),this.fjh(b||a)):this.l_k(b),cn.a.Dv||this.wRe(b))}DRc(){let a=1;(P.a.instance.ga(63)||P.a.instance.ga(30))&&od.TableReader.Ku(this.gb)&&(a=0);return a}dispose(){P.a.instance.ga(50)&&
Oc.App.Ih&&Oc.App.Ih.rw&&this.ghh();this.hv=this.Fm=this.$j=this.xS=this.$R=this.uBa=this.AG=null;super.dispose()}JU(a){var b=Hn.b(this.gb),c=null;if(a.Bb(1)){do{var f=a.Xq.pLa;c=c?uv.rvi(c,f):f.copy()}while(a.Dj(1))}c||(c=new uv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.Dph(f,Math.max(c.D5i(f),this.Md.Ld.Pe(b[f],0)));b=In.a.Ykb;c=new Ij.a(b,Math.max(0,c.zlk()-2*b),b);b=new tb.GraphIterator;b.set(this.gb);f=!1;b.rc(16)&&(f=!0);c=f?new Ij.a(0,c.total,0):new Ij.a(c.ena,c.minWidth,c.fna);a.Bb(88)&&
(c=Ij.a.max(c,a.Xq.pLa),a.zc());return c}zHj(){this.ghh();this.Fm=[];this.hv=[]}ghh(){if(this.hv)for(var a=0;a<this.hv.length;++a)V.a.nKa(this.hv[a]),Ca.a.$O(this.hv[a]);if(this.Fm)for(a=0;a<this.Fm.length;++a)V.a.nKa(this.Fm[a]),this.hv&&this.hv[a]&&this.hv[a].parentNode&&Ca.a.$O(this.Fm[a])}fjh(a){if(this.Fm&&this.AG&&this.AG.firstChild){var b=B.a.mx||B.a.vo?"":" 16 20",c=String.format("url('{0}'){1}, pointer",Cy.a.box4Image("ColumnSelect.cur"),b);b=Hn.b(this.gb);var f=b.length,l=this.AG.firstChild;
if(a){a=Math.min(f,this.Fm.length);for(var x=0;x<a;x++)l.insertBefore(this.Fm[x],l.firstChild)}if(f>this.Fm.length)for(a=this.Fm.length;a<f;a++){x=this.Md.createElement("div");x.className="TableColumnHandleAnchor";Rc.c(x,!0);Array.add(this.Fm,x);var H=this.Md.createElement("div");H.className=cn.a.G0e;H.style.cursor=c;x.appendChild(H);H=this.Md.createElement("div");H.className="TableColumnWidthSpacer";x.appendChild(H);l.insertBefore(this.Fm[a],l.firstChild)}if(f<this.Fm.length){for(c=f;c<this.Fm.length;c++)V.a.nKa(this.Fm[c]),
Ca.a.$O(this.Fm[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.Fm[l]);this.Fm=c}c=this.DRc();l=0;for(a=0;a<f;a++)x=this.L8(a),x=Math.max(x,this.Md.Ld.Pe(b[a],0)),this.Fm[a].childNodes[c].style.width=x+"px",this.Fm[a].style.left=l+"px",this.Fm[a].setAttribute("ColumnIndex",a.toString()),l+=x}}l_k(a){var b=B.a.mx||B.a.vo?"":" 16 20";b=String.format("url('{0}'){1}, pointer",Cy.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.AG.firstChild;var c=Math.min(this.AG.childNodes.length,this.Fm.length);for(var f=
0;f<c;++f)a.insertBefore(this.Fm[f],a.firstChild),a=a.nextSibling}a=this.AG.childNodes.length;if(a>this.Fm.length){c=this.AG.firstChild;for(f=0;f<this.Fm.length;++f)c.insertBefore(this.Fm[f],c.firstChild),c=c.nextSibling;for(f=this.Fm.length;f<a;++f){const x=this.Md.createElement("div");x.className="TableColumnHandleAnchor";Rc.c(x,!0);Array.add(this.Fm,x);var l=this.Md.createElement("div");l.className=cn.a.G0e;l.style.cursor=b;x.appendChild(l);l=this.Md.createElement("div");l.className="TableColumnWidthSpacer";
x.appendChild(l);c.insertBefore(x,c.firstChild);c=c.nextSibling}}else if(a<this.Fm.length){for(b=a;b<this.Fm.length;++b)V.a.nKa(this.Fm[b]),Ca.a.$O(this.Fm[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Fm[c]);this.Fm=b;b=this.AG.firstChild;for(a=0;a<this.Fm.length;++a)b.insertBefore(this.Fm[a],b.firstChild),b=b.nextSibling}b=this.DRc();a=Hn.b(this.gb);for(c=0;c<this.Fm.length;++c)f=this.L8(c),this.Fm[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Md.Ld.Pe(a[c],0))+"px":f+"px"}wRe(a){if(!this.hv.length){a=
this.Md.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Md.createElement("div");b.className=cn.a.esd+" Last";a.appendChild(b);Array.add(this.hv,a);Rc.c(a,!0);a=!0}if(a){a=Math.min(this.hv.length,this.AG.childNodes.length);for(b=1;b<a;++b){var c=this.AG.childNodes[b];c.insertBefore(this.hv[b],c.firstChild)}(a=this.AG.lastChild)?a.insertBefore(this.hv[0],a.firstChild):ia.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.AG.childNodes.length;
if(a>this.hv.length){for(b=1;b<this.hv.length;++b)c=this.AG.childNodes[b],c.insertBefore(this.hv[b],c.firstChild);for(b=this.hv.length;b<a;++b){c=this.Md.createElement("div");c.className=cn.a.esd;Rc.c(c,!0);Array.add(this.hv,c);let f=this.AG.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.AG.lastChild;a.insertBefore(this.hv[0],a.firstChild)}else if(a<this.hv.length){for(b=a;b<this.hv.length;++b)V.a.nKa(this.hv[b]),Ca.a.$O(this.hv[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.hv[c]);this.hv=b;for(a=
1;a<this.hv.length;++a)b=this.AG.childNodes[a],b.insertBefore(this.hv[a],b.firstChild);(a=this.AG.lastChild)?a.insertBefore(this.hv[0],a.firstChild):ia.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}fUe(a,b){let c=-1;if(od.TableReader.vm(this.gb))if(b<=Sys.UI.DomElement.getLocation(this.xS.firstChild.lastChild).x)c=this.xS.firstChild.childNodes.length-1;else for(var f=0;f<this.xS.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.xS.firstChild.childNodes[f]);
if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.xS.firstChild.firstChild).x)c=0;else for(f=this.xS.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.xS.firstChild.childNodes[f]),b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=tb.GraphIterator.nb(this.gb);const x=new tb.GraphIterator;b=new pf.GraphTransaction(2);b.Fy(l);Vd.moveToFirstRow(l);Vd.moveToColumnByIndex(l,a);x.Rc(l);Vd.moveToColumnByIndex(x,c);do(a=Qd.SelectionFactory.TLc(l,x))&&Array.add(f,a),
Vd.moveToNextRow(x);while(Vd.moveToNextRow(l));a=new ub.SelectionCollection(f,f.length-1,0);this.Qc.Lb.QE(a);b.dispose()}sqc(a,b){const c=this.DRc();this.Fm&&a<this.Fm.length&&this.Fm[a]&&(this.Fm[a].childNodes[c].style.width=Math.max(this.L8(a),b)+"px");this.$R.childNodes[a].style.width=Math.max(1,b)+"px"}c7i(a){return this.xS.firstChild.childNodes[a]?this.xS.firstChild.childNodes[a].offsetWidth:(ia.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.xS.childNodes.length,this.xS.firstChild.childNodes.length),0)}KRc(a){a=parseInt(this.$R.childNodes[a].style.width);return isNaN(a)?In.a.E0e:a}I6(a){super.I6(a);P.a.instance.ga(63)&&this.nFl();this.m5e()}m5e(){this.$Ec||(this.$Ec=new af.a(3,1,0,Object(F.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),u.AFrameworkApplication.ye.Db(this.$Ec))}updateTableDOMElements(){this.$Ec=null;this.G1&&(P.a.instance.ga(63)?this.PKk(this.RQk()):cn.a.Dv&&this.MMe(this.B9d()),u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.fjh(!1))}xud(){this.E_k()}D4i(a){return a.offsetWidth+this.P5d(0)/2}B9d(){const a=this.iTa(),b=a.length,c=[];let f=0,l=!1;const x=od.TableReader.Ku(this.gb);for(let U=0;U<b;U++){const ja=a[U];if(x){let Va;({Jmd:Va}=this.Ftd(ja)).returnValue&&(l=tk.f(Va.gb))}const ya=ja.childNodes;for(let Va=0;Va<ya.length;Va++){var H=ya[Va];if(void 0!==H.colSpan&&null!==H.colSpan&&void 0!==H.rowSpan&&null!==H.rowSpan){let hb;({qUd:hb}=this.c3e(H)).returnValue&&(H=Object.assign(new CL,{uQa:hb,left:H.offsetLeft,
top:this.Jie?ja.offsetTop:f,width:this.D4i(H),height:H.offsetHeight,Eig:!U,Fjg:U+H.rowSpan===b,yig:!l&&!Va}),c.push(H))}}f+=ja.offsetHeight}return c}nFl(){if(this.G1){var a=new tb.GraphIterator;a.set(this.gb);if(od.TableReader.WHf(a)&&this.$R){a=this.$R.childNodes.length;var b=Array(a),c=[],f=this.iTa(),l=f.length,x=0;for(let H=0;H<l;H++){let U=0;const ja=f[H],ya=ja.childNodes;let Va=0;for(let hb=0;hb<a;hb++){let yb;if(b[hb]){let Zb;(Zb=b[hb]).aWc=Zb.aWc-x;let fc;(fc=b[hb]).Hmd=fc.Hmd-1;yb=b[hb].colSpan;
1===b[hb].Hmd&&(U=Math.max(U,b[hb].aWc),b[hb]=null)}else{const Zb=ya[Va];Va++;if(!Zb)continue;let fc=0,Kc;({qUd:Kc}=this.c3e(Zb)).returnValue&&(fc=Kc.g5b());yb=Zb.colSpan;1<Zb.rowSpan?b[hb]=Object.assign(new zL,{colSpan:Zb.colSpan,aWc:fc,Hmd:Zb.rowSpan}):U=Math.max(U,fc)}hb+=yb-1}({Jmd:x}=this.Ftd(ja)).returnValue?(x.V9k(U)&&c.push(x),x=x.emh):x=0}for(const H of c)H.mFl()}}}E_k(){const a=this.iTa();if(Oc.App.instance.ZYc&&a.length&&!(a.length<=this.cnf&&a[0].childNodes.length===this.A9e)){this.cnf=
a.length;this.A9e=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!Ca.a.gda(a[c].firstChild,"DragHandle")&&({Jmd:b}=this.Ftd(a[c])).returnValue&&b.n_k()}}Vgg(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}MMe(a){if(a)for(const b of a)b.uQa.puc(b.left,b.top,b.width,b.height,b.Eig,b.Fjg,b.yig)}iTa(){return this.G1.children}c3e(a){let b;b=null;a&&(a=Rc.a(a),b=Object(oa.a)(Fv,a));return{returnValue:!!b,qUd:b}}Ftd(a){let b;b=null;a&&(a=Rc.a(a),b=Object(oa.a)(bu,a));return{returnValue:!!b,
Jmd:b}}RQk(){let a=0;const b=od.TableReader.Ku(this.gb),c=this.Jie,f=this.iTa(),l=[];let x=!1;for(let U=0,ja=f.length;U<ja;U++){const ya=f[U];if(!ya)continue;if(b){let Zb;({Jmd:Zb}=this.Ftd(ya)).returnValue&&(x=tk.f(Zb.gb))}const Va=new BL,hb=!U,yb=ya.childNodes;for(let Zb=0,fc=yb.length;Zb<fc;Zb++){var H=yb[Zb];let Kc;if(({qUd:Kc}=this.c3e(H)).returnValue){const Lc=H.offsetTop,Gc=H.rowSpan,ae=!Zb;H=Object.assign(new AL,{uQa:Kc,left:H.offsetLeft,offsetTop:Lc,top:c?Lc:a,width:H.offsetWidth,height:H.offsetHeight,
rowSpan:Gc,ljg:hb,mjg:U+Gc===ja,kjg:!x&&ae,wbg:!ae&&this.Vgg(H,tf.a.wee),Sag:!hb&&this.Vgg(H,tf.a.vee)});Va.fOd(H)}}a+=ya.offsetHeight;l.push(Va)}return l}PKk(a){if(a.length){var b=this.P5d(1)/2,c=this.P5d(0)/2,f=a[0].cells[0].uQa,l=f.rjg(!1);f=f.rjg(!0);var x=[];for(var H of a[0].cells){var U=H.uQa.ICl(H.left,H.width+c,H.offsetTop,l);U&&x.push(U)}cn.a.xTk(x);l=[];for(H=0;H<a.length;H++)x=a[H].cells[0],(U=x.uQa.pFl(x.height+b,x.offsetTop,f))&&l.push(U),1<x.rowSpan&&(H+=x.rowSpan-1);cn.a.mVk(l);for(const ja of a)for(const ya of ja.cells)a=
ya.uQa,f=ya.width,l=ya.height,a.lFl(f,l+b,ya.offsetTop,ya.left),a.puc(ya.left,ya.top,f+c,l,ya.ljg,ya.mjg,ya.kjg),ya.wbg&&a.khh(tf.a.wee),ya.Sag&&a.khh(tf.a.vee)}}}jm.Yrd="Border";jm.H0e="NoBorder";jm.BHf="Conflict";jm.UJh="TableWordWrap";jm.ctl="WACAltTextDescribedBy";jm.CVa=null;Object(m.a)(jm,"TableViewElement",ch.a,[1119,456,351,106]);class Gv extends bu{constructor(a,b,c){super(a,b,c,null,null)}lMb(a){this.htmlElement.style.height=a+"px"}get dmh(){return this.Md.Ld.Pe(this.gb.sa(kb.a.su,0),1)+
"px"}static G8f(a){a=Rc.a(a);let b=null;a&&(b=Object(oa.a)(Gv,a));return b}}Object(m.a)(Gv,"TableRowViewElement",bu,[]);class Sx{constructor(a,b,c=!1){this.Mii=a;this.Ppj=b;this.lNc=c}}Object(m.a)(Sx,"TableBorderProperty",null,[]);var yl=d(500);class Rp{constructor(a,b,c,f,l){this.J9=a;this.jc=c;this.Qb=b;this.zFb=f;this.J$j=l}Dfj(a){switch(a){case 0:a=ab.a.ONb;break;case 1:a=ab.a.PNb;break;case 2:a=ab.a.RNb;break;case 3:a=ab.a.SNb;break;default:a=null}return{returnValue:!!a,Pjk:a}}jta(a,b){let c=
0;if(!a)return c;let f;({Pjk:f}=this.Dfj(b)).returnValue&&(c=3===b||0===b?a.sa(f,.1):a.sa(f,Rp.bHk));return c}pCf(a){return.0555555555555556+this.jta(a,1)+this.jta(a,2)}FTd(a,b){const c=od.TableReader.sk(a);if(0>b||b>=c)return.0555555555555556;a=this.Qb.Nc(a).Zp(b,1);return this.PIc(a)}PIc(a){let b=.0555555555555556;a=this.Qb.Nc(a);a.Bb(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.jta(c,0)+this.jta(c,3))}while(a.Cf(1));return b}Hsb(a,b){var c=od.TableReader.Ai(a);if(0>b||b>=c)return.0555555555555556;
c=.0555555555555556;a=this.Qb.Nc(a);a.Bb(1);do{const f=a.Zp(b,1);c=Math.max(c,this.pCf(f));a.zc()}while(a.Cf(1));return c}Y6d(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:yl.a.tub}I$d(a,b){let c=b;if(this.J$j&&b&&b.cellShading){let f;({ola:f}=this.h3e(a,b.cellShading)).returnValue&&(b=Object(oa.a)(115,this.jc.kg(b)),c=this.zFb.glh(a,b?b.ke:null,f))}return c}a5b(a,b){let c=yl.a.rub;const f=Rp.eTa(b);
f.returnValue&&(a=this.I$d(b,a),a.Sa(f.gQa)&&(c=a.eb(f.gQa)));return c}T4d(a,b,c){if(c&&c.sD===Ib.a.auto)return Pk.a.none;a=this.r7i(a);b=this.H5d(b);c=c.jV();return String.format("{0} {1}px {2}",a,b,c)}H5d(a){a=this.J9.Pe(a,0);B.a.Lua&&0<a&&1>a&&(a=1);return a}bsb(a,b,c=!1){let f=Ib.a.kRa.jV();if(a.solidFillField){var l=pe.Box4ColorHelper.TJ(pe.Box4ColorHelper.Soa(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.jV()}else if(a.gradFillField){a=Zo.f(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=
l.color.g=l.color.b=255;f=a.jV()}return f}ppj(a){const b=a.currentNode.pi;a.zc();const c=a.JF(1);a.Zp(b,1);return c?a.currentNode:null}upj(a){return a.JF(1)}h3e(a,b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,ola:a}}r7i(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static eTa(a){let b,c;switch(a){case 7:a=
kb.a.fza;b=kb.a.DLa;c=kb.a.Hsl;break;case 0:a=kb.a.vga;b=kb.a.tga;c=kb.a.Csl;break;case 5:a=kb.a.eza;b=kb.a.CLa;c=kb.a.Fsl;break;case 6:a=kb.a.wga;b=kb.a.uga;c=kb.a.Gsl;break;case 2:a=kb.a.Wkb;b=kb.a.Ukb;c=kb.a.Esl;break;case 1:a=kb.a.Vkb;b=kb.a.Tkb;c=kb.a.Dsl;break;default:c=b=a=null}return{returnValue:!!a,gQa:a,F6a:b,lsb:c}}}Rp.bHk=.2;Object(m.a)(Rp,"TableStyleReaderHelper",null,[285]);class SD{constructor(a,b,c=-1){this.$X=a;this.Etg=b;this.yAg=c}}Object(m.a)(SD,"TableStyle",null,[]);var kr=d(331);
class Vz{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te){this.$X=new Rd.a;this.dbd=new Rd.a;this.cbd=new Rd.a;this.Zad=new Rd.a;this.N0e=[];this.Qb=a;this.uH=c;this.jc=b;this.Tk=f;this.J9=l;this.I0=x;this.yIa=H;this.oc=U;this.iCe=ja;this.mhk=ya;this.hhk=Va;this.Zgk=hb;this.yc=yb;this.iYa=Zb;this.yJ=fc;this.Po=Kc;this.Nq=Lc;this.xdb=Gc;this.t7c=ae;this.cDb=we;this.fHa=$d;this.fXa=Te;this.yIa.zia(Object(F.a)(this,this.rgd,"onTableConnectedOrDisconnected"));this.yIa.N7(Object(F.a)(this,
this.rgd,"onTableConnectedOrDisconnected"));this.yIa.jk(Object(F.a)(this,this.M6g,"onTablePropertyChanged"));this.Nq.s$h(Object(F.a)(this,this.M4g,"onPageViewBeforeValidate"))}dispose(){this.yIa.joa(Object(F.a)(this,this.rgd,"onTableConnectedOrDisconnected"));this.yIa.sKa(Object(F.a)(this,this.rgd,"onTableConnectedOrDisconnected"));this.yIa.Cm(Object(F.a)(this,this.M6g,"onTablePropertyChanged"));this.Nq.TYk(Object(F.a)(this,this.M4g,"onPageViewBeforeValidate"))}v_f(a){if(!a||!a.length)return null;
const b=this.BRc(Object(oa.a)(ug.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.BRc(Object(oa.a)(ug.a,a[c]));if(!f||f.sD!==b.sD)return null}return b}u$d(a){let b=null;if(a=this.H6b(a))b=new lq.a,b.we(kb.a.tableStyle,new SD(a,Number.MAX_VALUE));return b}yUc(a){if(14!==a.type){a=this.Qb.Nc(a);a.rc(14);var b=a.Jg(14)}else b=a;a=b.id;this.cbd.Hb(a)||(b=this.v$d(b),this.cbd.$(a,this.hhk(b)));return this.cbd.ga(a)}Xbj(a){return(a=this.oc.t6b(Object(oa.a)(115,this.jc.kg(a))))?a.TableListStyle:
null}v$d(a){const b=Object(oa.a)(115,this.jc.kg(a));return this.iCe(()=>a.DY,()=>a.d8,()=>a.tableLook,()=>this.Xbj(a),()=>b?b.ke:null,()=>this.H6b(a))}rgd(a,b){this.Mfg(b.node)}M6g(a,b){a=b.property;b=b.node;if(a===kb.a.jza||a===kb.a.Bsc||a===$a.a.iza||a===$a.a.xga||a===$a.a.SA){if(a===$a.a.iza||a===$a.a.SA)b.Csc=!1;a!==kb.a.jza&&a!==kb.a.Bsc||this.Mfg(b);this.Y8b(b)}}pkk(a){Array.contains(this.N0e,a)||(this.Y8b(a),this.N0e.push(a))}M4g(){Array.clear(this.N0e)}NHj(a){this.Zad.remove(a.id)}Mfg(a){a=
a.id;this.$X.remove(a);this.dbd.remove(a);this.cbd.remove(a)}wUc(a){const b=a.id;this.Zad.Hb(b)||this.Zad.$(b,this.Zgk(this.v$d(a)));return this.Zad.ga(b)}H6b(a){const b=a.id;if(this.$X.Hb(b))return this.$X.ga(b);var c=a.sa(kb.a.jza,null);if(!c)return null;let f=null;const l=Zq.TTf(c);l&&a.Fh&&(f=a.Fh.Be(l));a=null;if(f)a=di.a.HSa(f,kb.a.tableStyle);else if(c=this.I0.D7f("{"+c.toString()+"}"))a=c.$X;a&&this.$X.$(b,a);return a}m8d(a){return a.tableLook}L8(a,b){a=this.Tk.Hsb(a,b);return this.J9.Pe(a,
0)}C4i(a){if(a.Sa(kb.a.kP))switch(a.sa(kb.a.kP,0)){case 2:return"bottom";case 1:return"middle"}return"top"}w_f(a){var b=null;if(!a)return null;if(a.cellShading){var c=Zo.a(a.cellShading);Zo.e(c)||(b=c)}b||(b=this.Ita(a,kb.a.cellShading,yl.a.tub));c=Object(oa.a)(115,this.jc.kg(a));b=this.Tk.bsb(b,c?c.ke:null,this.xdb);a.rowIndex||1!==a.pi||xa.a.J(9242778,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}BRc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=Zo.a(a.cellShading);
Zo.e(f)||(b=f)}b||(b=this.Ita(a,kb.a.cellShading,yl.a.tub));a=(a=Object(oa.a)(115,this.jc.kg(a)))?a.ke:null;(b=b.solidFillField)&&(c=pe.Box4ColorHelper.UDa(b,a));return c}j$a(a){var b=null;var c=Object(oa.a)(5,a);c&&(a=c.sa(ab.a.listLevel,Be.a.NEa),c=this.Qb.Nc(c),c.rc(7)&&od.TableReader.Cs(c)&&(c=Object(oa.a)(Yl.TableCellNode,c.Jg(16))))&&(this.jbh(c),b=1+a,b=this.uH.r_f(c,this.yUc(c),b));return{tableStyle:b,q7a:null}}Elj(a){let b=di.a.ui(a,kb.a.cellShading,yl.a.tub);if(Zo.e(b)){const c=this.H6b(a);
c&&(b=this.Tk.Y6d(c))}a=Object(oa.a)(115,this.jc.kg(a));return this.Tk.bsb(b,a?a.ke:null)}x7i(a){return!Ud.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?yl.a.rub:yl.a.EJi}N8i(a,b){if(this.t7c&&this.Po.yT&&!this.PJj(a,b))return new Sx("","");var c=Object(oa.a)(123,a);if(({gQa:x,F6a:H,lsb:U}=Rp.eTa(b)).returnValue)if(this.fXa&&Ud.a("TableBordersLocalRenderingFix")){var f=this.Ita(c,x,this.x7i(b),!0);var l=this.Ita(c,U,yl.a.qub,!0);var x=c.sa(x,f);f={};if(Ud.a("FixClearTableBorder")){let ja=this.Qb.Nc(c);
ja.rc(14);if(ja.Jg(14).Sa(kb.a.jza)){f.Color="##T,0,0,0";f=pe.Box4ColorHelper.oV(f);f=this.Ita(c,H,f,!0);var H=di.a.ui(c,H,f);H=pe.Box4ColorHelper.Soa(H);a=this.jc.kg(a);a=(a=pe.Box4ColorHelper.TJ(H,a?a.ke:null))?pe.Box4ColorHelper.epa(a):null}else f.Color="#000000",a=pe.Box4ColorHelper.oV(f),a=pe.Box4ColorHelper.cta(a)}else f.Color="##T,0,0,0",f=pe.Box4ColorHelper.oV(f),f=this.Ita(c,H,f,!0),H=di.a.ui(c,H,f),H=pe.Box4ColorHelper.Soa(H),a=this.jc.kg(a),a=(a=pe.Box4ColorHelper.TJ(H,a?a.ke:null))?pe.Box4ColorHelper.epa(a):
null;l=c.sa(U,l)}else l=this.Tk.I$d(b,c),x=l.Sa(x)?l.eb(x):this.Ita(c,x,yl.a.rub,!0),a=this.o_f(l,c,H),l=l.Sa(U)?l.eb(U):this.Ita(c,U,yl.a.qub,!0);else x=yl.a.rub,a=yl.a.zMc,l=yl.a.qub;5!==b||a.sD===Ib.a.auto||c.rowIndex||1!==c.pi||xa.a.J(9242780,822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.sD,a.alpha);var U=!1;a.sD!==Ib.a.auto||7!==b&&5!==b||(f=this.Qb.Nc(c),f.rc(14),7===b?(H=kb.a.tga,f=this.Tk.ppj(f)):(H=kb.a.uga,f=this.Tk.upj(f)),f&&(c=this.Tk.I$d(b,c),this.o_f(c,f,H).sD===Ib.a.auto&&
(l=yl.a.qub,x=yl.a.Opj,a=yl.a.Npj,U=!0)));c=this.Tk.T4d(l,x,a);return U&&7===b?new Sx(c,"Top"):U&&5===b?new Sx(c,"Left"):new Sx(c,"")}qSc(a,b){switch(b){case 7:b=kb.a.fza;break;case 6:b=kb.a.wga;break;case 0:b=kb.a.vga;break;case 5:b=kb.a.eza;break;default:b=null}const c=this.Ita(a,b,yl.a.rub,!0);return a.sa(b,c)}PJj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Qb.Nc(a);if(!c.rc(14))return!0;var f=c.Pw(14);if(!f.Lp())return!0;const l=a.rowSpan,x=a.colSpan;if(1===l&&1===x)return!0;
f=this.yc.Blj(f);const H=new kr.a;H.re=this.iYa.whj(c);H.$f=H.re+l;H.ge=this.yJ.LRc(Object(oa.a)(123,a));H.Of=H.ge+x;switch(b){default:xa.a.J(560562957,822,15," Unknown position type: {0} ",b);break;case 5:if(!H.ge||1===l)break;if(4!==(f.vs(H.re,H.ge-1)&4)||8!==(f.vs(H.$f-1,H.ge-1)&8))break;for(a=H.re+1;a<H.$f;++a)if(4===(f.vs(a,H.ge-1)&4))return!1;break;case 6:if(H.Of===f.xR||1===l)break;if(4!==(f.vs(H.re,H.Of)&4)||8!==(f.vs(H.$f-1,H.Of)&8))break;for(a=H.re+1;a<H.$f;++a)if(4===(f.vs(a,H.Of)&4))return!1;
break;case 7:if(!H.re||1===x)break;if(1!==(f.vs(H.re-1,H.ge)&1)||2!==(f.vs(H.re-1,H.Of-1)&2))break;for(a=H.ge+1;a<H.Of;++a)if(1===(f.vs(H.re-1,a)&1))return!1;break;case 0:if(H.$f!==f.UO&&1!==x&&1===(f.vs(H.$f,H.ge)&1)&&2===(f.vs(H.$f,H.Of-1)&2))for(a=H.ge+1;a<H.Of;++a)if(1===(f.vs(H.$f,a)&1))return!1}return!0}o_f(a,b,c){if(this.fXa){const f=pe.Box4ColorHelper.oV({Color:"##T,0,0,0"});a=di.a.ui(a,c,f);a=pe.Box4ColorHelper.Soa(a);b=this.jc.kg(b);b=(b=pe.Box4ColorHelper.TJ(a,b?b.ke:null))?pe.Box4ColorHelper.epa(b):
null}else a.Sa(c)?(b=a.Lh(c),b=Object(Xa.a)(Ib.a,b)?b:new Ib.a(a.eb(c))):b=this.Ita(b,c,yl.a.zMc,!0);this.xdb&&(b=new Ib.a(0,b.alpha));return b}Y8b(a){const b=this.fHa?this.Qb.g8d(a):this.Qb.Nc(a);let c=Object(oa.a)(153,b.Gi());for(a=Object(oa.a)(173,a);c;)c.Fmd=!1,c=Object(oa.a)(153,b.jp());this.NHj(a);this.fHa?this.wHj(a):a.Hda(4)}wHj(a){if(a&&a.isConnected)for(a=this.Qb.g8d(a),a=Vl.a.qv(a);a.moveNext();)a.currentNode.anchor.Dr(4)}BJl(a){a&&(this.yUc(a),this.H6b(a),this.wUc(a))}Ita(a,b,c,f=!1){if(!a)return c;
var l=this.Qb.Nc(a);l.rc(14);l=l.Jg(14);var x=l.id;if(this.cDb&&f){if(!l.Sa(kb.a.jza))return c;x=a.rowIndex;a=a.pi;return(a=this.wUc(l).Z3i(l,x,a))&&a.Sa(b)?a.Lh(b):c}this.jbh(a);f=a.aV;if(!f){if(!l.Sa(kb.a.jza))return c;f=a.rowIndex;let H=a.pi;const U=a.rowSpan,ja=a.colSpan;this.dbd.Hb(x)||this.dbd.$(x,this.mhk(this.v$d(l)));f=this.dbd.ga(x).M5d(f,H,U,ja);a.aV=f}return f&&f.Sa(b)?f.Lh(b):c}Qni(a){const b=this.Qb.SSa();b.set(a);let c=0,f=Object(oa.a)(153,b.Bb(1));for(;f;)f.rowIndex=c,c++,f=Object(oa.a)(153,
b.jp());a.Csc=!0}OIk(a){let b=0;const c=a.rowIndex,f=this.Qb.SSa();f.set(a);let l=Object(oa.a)(123,f.Bb(1));for(;l;)l.rowIndex=c,l.pi=b,l.aV=null,this.uH.p1k(l),l.aSf(),l=Object(oa.a)(123,f.jp()),b++;a.Fmd=!0}jbh(a){var b=this.Qb.Nc(a);b.rc(14);a=Object(oa.a)(153,b.Jg(15));(b=Object(oa.a)(173,b.Jg(14)))&&!b.Csc&&this.Qni(b);a&&!a.Fmd&&this.OIk(a)}}Object(m.a)(Vz,"TableStyleReader",null,[1121,1122,1123]);class Kl extends jm{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){super(a,b,c);this.G7c=
this.ty=this.XEb=this.jva=this.mH=null;this.Ihc=l;this.Tk=x;this.Po=H;this.Le=U;this.C0=[];this.oc=f;this.Geb=hb;this.mc=yb;this.jc=Zb;this.fj=fc;this.hDb=ya.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.rwe=ya.pptComplexTableLayoutSyncEnabled;this.o0=ya.ska;this.jPg=Va;this.yc=Kc;this.Qb=Lc;this.xxe=ya.kaa;this.v7c=ya.AAh;if(Gc)this.ty=Gc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Qc.lp){if(this.mH=ja?ja(a):null)this.mH.aFh(),this.Dk&&this.Dk.SU&&(this.mH.iii(this,
this.Dk.SU,this.table),this.mH.Ox(!this.mc.Gn));Ud.a("DeprecateIE.TableViewElement.ctor")||!this.Po.Sab&&!this.Po.Vab||(this.htmlElement.style.backgroundColor="rgba(0,0,0,0)")}this.Dk&&(this.Dk.Z9h(Object(F.a)(this,this.L5g,"onShapeEnterTextEditing")),this.Dk.Puf(Object(F.a)(this,this.U5g,"onShapeSelectionChanged")),this.Dk.a$h(Object(F.a)(this,this.M5g,"onShapeExitTextEditing")),this.Dk.B9h(Object(F.a)(this,this.k1g,"onAfterDraw")),this.Dk.kai(Object(F.a)(this,this.f5g,"onReadModeChanged")),this.Dk.X9h(Object(F.a)(this,
this.I2g,"onDisplayOnActiveSlide")))}get tsi(){return this.mH}I2g(){this.z0e()}get Dk(){if(this.jva)return this.jva;if(this.Qc.lp){const a=ke.a.nb(this.Qc.Ma,this.gb);a.$e();a.z_a();this.jva=Object(oa.a)(117,a.gRa)}return this.jva}f9d(){if(!this.v7c)return 1;var a=this.jc.kg(this.gb);if(!a)return 1;var b=a.sc(this.Ma);if(!b)return 1;b=b.Bca?b.Bca.xa.style.visibility===Ri.a.visible:!1;var c=new hr.a(a.oq,a.Vk);if(!this.ty)return 1;b=this.ty.q6b(c,b).dP;c=this.fj.KG;a=this.oc.kUc(a)*c;return b/a}Enh(a){if(1!==
a&&this.v7c){var b=this.yc.oka(this.gb);for(var c of b)b=this.Md.Ld.Pe(c.sa(kb.a.su,0),1)*a,c.sc(this.Ma).htmlElement.style.height=b+"px";c=Hn.b(this.gb);for(b=0;b<c.length;b++){const f=this.Md.Ld.Pe(c[b],0)*a;this.nKc.childNodes[b].style.width=f+"px"}}}Ky(a){super.Ky(a);this.Enh(this.f9d());this.iCh(this.Geb.hzb?!!this.Dk&&this.Dk.sL()&&(this.Dk.dB||this.Dk.Un):!!this.Dk&&this.Dk.Un)}JU(){const a=this.Ihc,b=Hn.b(this.gb),c=od.TableReader.Ai(this.gb);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.L8(this.gb,
l),this.Md.Ld.Pe(b[l],0));return new Ij.a(0,f,0)}I6(a){super.I6(a);if(this.Qc.lp&&(a=this.jPg.fUc(this.gb,this.Ma))&&0!==a.YXc){const b=this.gb;if(b.ZN)return;this.rwe?a.TGh(b):a.YXc&2?a.TGh(b):a.hEl(b,c=>{c&&this.z0e()})}this.z0e()}z0e(){this.mH&&this.Dk&&this.Dk.Un&&this.y0e()}Nrh(a,b){Object(oa.a)(Vz,Ab.StyleReader.nr);if(1!==b)for(var c=0;c<this.G1.childNodes.length;c++){var f=this.G1.childNodes[c];if(!f||"TR"!==f.tagName.toUpperCase())continue;const x=f.offsetHeight*b;var l=this.Tk.FTd(this.gb,
c);l=this.Md.Ld.Pe(l,1);f.style.height=(x<l?0:x)+"px"}if(1!==a)for(b=0;b<this.nKc.childNodes.length;b++)c=lf.a.Fn(this.nKc.childNodes[b].style.width),f=this.Tk.Hsb(this.gb,b),f=this.Md.Ld.Pe(f,0),this.sqc(b,Math.max(c*a,f))}ohj(a){a>this.G1.childNodes.length&&Error.argumentOutOfRange("rowIdx");const b=this.G1.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return lf.a.Fn(b.style.height)}E6b(){return ei.a.fda(this.Le.$h(this.table))}get mPj(){const a=
this.jPg.fUc(this.gb,this.Ma);return!a||0===a.YXc}T5f(){const a=[0];for(let b=1;b<=this.G1.childNodes.length;++b)a[b]=a[b-1]+this.G1.childNodes[b-1].offsetHeight;return a}P_f(){const a=[0];for(let b=1;b<=this.nKc.childNodes.length;++b)a[b]=a[b-1]+this.KRc(b-1);return a}wRe(a){if(14!==this.gb.type)xa.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.gb.type);else if(this.gb.sa(kb.a.complexTable,!0))xa.a.J(512497118,808,50,"Disable column resizing for table with merged cells");
else{super.wRe(a);a=new tb.GraphIterator;a.set(this.gb);Vd.moveToFirstRow(a);Vd.moveToFirstColumn(a);let b=1;const c=this.Md.Ld.Pe(this.Tk.a5b(a.currentNode,6),0);for(;!Le.isLastCellInRow(a);){Vd.moveToNextColumn(a);const f=this.hv[b++],l=lf.a.Pc(-1*c);od.TableReader.vm(this.gb)?f.style.marginRight=l:f.style.marginLeft=l}this.hv.length!==b&&xa.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.hv.length,b)}}Yaa(a){super.Yaa(a);this.Qc.Wl||this.G_k();
this.gb.sa(kb.a.complexTable,!0)||cn.a.Dv||this.F_k()}dispose(){super.dispose();this.mH&&(this.mH.dispose(),this.mH=null);this.Dk&&(this.Dk.FYk(Object(F.a)(this,this.L5g,"onShapeEnterTextEditing")),this.Dk.Oih(Object(F.a)(this,this.U5g,"onShapeSelectionChanged")),this.Dk.GYk(Object(F.a)(this,this.M5g,"onShapeExitTextEditing")),this.Dk.pYk(Object(F.a)(this,this.k1g,"onAfterDraw")),this.Dk.uZk(Object(F.a)(this,this.f5g,"onReadModeChanged")),this.Dk.DYk(Object(F.a)(this,this.I2g,"onDisplayOnActiveSlide")));
this.jva=null}k1g(){this.Dk.cO&&this.y0e(!0)}oqi(){if(this.xxe){var a=this.gb,b=a.i$a();if(a.Csc)for(const c of b){a=c;if(!a)continue;a=a.sc(this.Ma);if(!a)continue;b=this.Ihc.qSc(c,7);const f=this.Ihc.qSc(c,6),l=this.Ihc.qSc(c,0),x=this.Ihc.qSc(c,5);0===b&&a.Lkd("Top");0===f&&a.Lkd("Right");0===l&&a.Lkd("Bottom");0===x&&a.Lkd("Left")}}}U5g(a,b){this.iCh(b.isSelected);a=this.table;this.oqi();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):
Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}f5g(a,b){this.mH&&this.mH.Ox(b.LSj)}iCh(a){if(this.mH)if(this.o0){const b=this.Qb.Nc(this.gb);b.$e();b.z_a().eb(kb.a.isResizable)?this.mH.visible=a:this.mH.visible=!1}else this.mH.visible=a;this.Dk&&this.Dk.Pd&&this.Dk.shapeNode&&this.Dk.shapeNode.MQ&&(this.Dk.Pd.visible=a)}F_k(){if(!this.C0.length){var a=this.WQa();Sys.UI.DomElement.addCssClass(a,"First");this.C0.push(a);a=this.pGi();Sys.UI.DomElement.addCssClass(Kl.n2f(a),
"Last");this.C0.push(a)}var b=this.iTa();a=b.length;var c=a+1-this.C0.length;if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.WQa();this.C0.splice(this.C0.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.eKb(this.C0[f+1]);this.C0.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.C0[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.C0[a],b.firstChild);this.bci()}}bci(){const a=new tb.GraphIterator;a.set(this.gb);Vd.moveToFirstRow(a);Vd.moveToFirstColumn(a);let b=1;for(;b<this.C0.length;){var c=
this.Md.Ld.Pe(this.Tk.a5b(a.currentNode,5),0),f=this.Md.Ld.Pe(this.Tk.a5b(a.currentNode,0),1);let l=this.C0[b];Kl.FVj(l)&&(l=Kl.n2f(l));c=lf.a.Pc(-1*c);f=lf.a.Pc(-1*f-(b===this.C0.length-1?4:0));od.TableReader.vm(this.gb)?l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;Vd.moveToNextRow(a);b++}}G_k(){if(!this.XEb){const a=String.format("url('{0}'), pointer",Cy.a.box4Image("RowSelect.cur"));this.XEb=this.Md.createElement("div");this.XEb.className=Jk.a.qtl;Rc.c(this.XEb,!0);const b=this.Md.createElement("div");
b.className=Jk.a.I0e;b.style.cursor=a;this.XEb.appendChild(b);this.table.appendChild(this.XEb)}}qhj(){return this.iTa()}WQa(){const a=this.Md.createElement("div");a.className="TableRowResizeHandle";a.style.width="100%";Rc.c(a,!0);return a}pGi(){const a=this.Md.createElement("div");a.className="TableRowResizeAnchor";const b=this.WQa();a.appendChild(b);Rc.c(a,!0);return a}eKb(a){V.a.nKa(a);Ca.a.$O(a)}tlj(a){var b=this.jc.kg(this.gb);let c=this.fj.KG;b&&b.Rw&&null!=b.Rw.Zr&&(c=b.Rw.Zr);b=this.oc.kUc(this.jc.kg(this.gb))*
c;a=a.copy();a.move(-a.hc,-a.kc);a.scale(1/b,1/b);return a}L5g(){this.table.clientWidth&&this.y0e(!0);!this.Geb.hzb&&this.mH&&(this.mH.visible=!0,this.Dk&&this.Dk.Pd&&(this.Dk.Pd.visible=!0));this.Dk&&this.Dk.sL()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}M5g(){this.mH&&(this.mH.visible=!1);this.Dk&&this.Dk.Pd&&(this.Dk.Pd.visible=!1)}y0e(a=!1){var b=this.E6b();let c=Oi.a.Vvd;this.G7c&&(c=ei.a.Q5b(b,this.G7c));const f=
hd.a.x6e;a=!!this.Dk&&(!this.G7c||!f.equals(hd.a.x6e)||!c.equals(Oi.a.Vvd)||a);this.G7c=b;if(a&&(a=this.Dk.i4e,b=ei.a.Q5b(this.tlj(b),a),this.Dk.setOffsets(b,!0),!Ud.a("DeprecateIE.TableViewElement.SynchronizeViews")&&this.Po.Sab&&0<this.G1.childNodes.length))for(b=this.G1.childNodes[0].offsetWidth,a=0;a<this.C0.length;a++)this.C0[a].style.width=b+"px";this.mH&&this.mH.Rl();this.hDb||this.m5e()}B9d(){return this.hDb?null:super.B9d()}MMe(a){if(this.hDb){var b=this.yc.sk(this.gb);a=Object(oa.a)(tb.GraphIterator,
this.Qb.Nc(this.gb));Vd.forEachCellInTable(a,(c,f,l)=>{c=c.currentNode;const x=c.sc(this.Ma);x&&x.puc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.MMe(a)}udj(a){let b=-1;var c=od.TableReader.Ai(this.gb),f=Hn.b(this.gb);const l=Array(c);for(let x=0;x<c;x++)l[x]=Math.floor(this.Md.Ld.Pe(f[x],0));if(od.TableReader.vm(this.gb))if(a<=Sys.UI.DomElement.getLocation(this.G1.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.G1.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=
l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=Sys.UI.DomElement.getLocation(this.G1.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.G1.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}poh(a,b,c=!0){const f=tb.GraphIterator.nb(this.gb),l=new tb.GraphIterator,x=new pf.GraphTransaction(2);x.Fy(f);Vd.moveToFirstRow(f);c?(Vd.moveToRowByIndex(f,a),Vd.moveToFirstColumn(f)):Vd.moveToColumnByIndex(f,a);l.Rc(f);c?(Vd.moveToRowByIndex(l,
b),Vd.moveToLastColumn(l)):(Vd.moveToColumnByIndex(l,b),Vd.moveToLastRow(l));a=Qd.SelectionFactory.B1b(f,l);this.Qc.Lb.QE(a);x.dispose()}static shj(a){return Kl.thj(a,cn.a.Dv)}static thj(a,b){return b?Kl.rhj(a):Kl.uhj(a)}static uhj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Kl.Bje(a)||Kl.mke(a)||(b=b.previousSibling);break}b=b.parentNode}return Gv.G8f(b)}static rhj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Kl.mke(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=
a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Kl.Bje(a)||(b=b.previousSibling);break}b=b.parentNode}return b?Gv.G8f(b):null}static g4(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static fVa(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeHandle")}static FVj(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static Hua(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static fac(a){return Sys.UI.DomElement.containsCssClass(a,
Jk.a.I0e)}static Alj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;a=a.parentNode}return null}static Bje(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static mke(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static zig(a){return Sys.UI.DomElement.containsCssClass(a,"FirstLeft")}static n2f(a){return a.firstChild}}Object(m.a)(Kl,"TableViewElement",jm,[1117,1118,1119,456,351,106]);class EL extends yL.a{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){super(a,b);this.nBf="ShowDashedLine";
this.rma=this.ee=this.Yd=this.JHg=this.DHg=this.RHg=this.oeb=this.ize=this.hze=this.pe=this.LHg=null;this.ARg=this.zRg=this.Z4=this.Y4=this.Veb=this.Zea=0;this.G$=c;this.Gdb=f;this.Ks=l;this.yc=x;this.pa=H;this.qA=U;this.ia=ja;this.Sp=Va;this.Cec=this.wwe=!1;this.pak=ya}get wSe(){this.wEf();return this.pe.offsetLeft}set wSe(a){this.wEf();this.pe.style.left=lf.a.Pc(a)}get zoom(){return 1}Tu(a){const b=super.Tu(a);if(b&&this.iN){this.ATd(a.Ec);Sys.UI.DomElement.addCssClass(this.pe,this.nBf);if(this.Eba=
Kl.zig(a.Ec))this.ni=0,this.nF=this.ul.KRc(this.ni);this.Yd=this.ul.Dk;this.ee=this.yc.G6b(this.Yd.gb);this.Cec=!1;this.rXe()&&this.C5i(a)}else b&&!this.iN&&(a=a.Ec,Kl.Hua(a)&&(xa.a.J(512497184,816,50,"Drag from table column handle"),this.ni=parseInt(a.parentNode.getAttribute("columnindex").toString())));b&&this.Sp&&this.ia.processAction(D.a.Sja,2);return b}Cw(a){this.iN?(a=this.qCf(a.clientPoint.x),this.wSe=this.LHg+(a-this.nF)*(this.Eba?-1:1)):(a=this.ul.udj(a.clientPoint.x),this.ul.poh(this.ni,
a,!1));return!0}ao(a){if(this.iN){const f=this.G$.Ci("UserAction","PPTColumnResize");a&&xa.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.ul.gb.sa(kb.a.iGb,""),this.ul.gb.Lp()));const l=new pf.GraphTransaction(15);l.kd(this.ul.gb);const x=this.ul.gb.sa($a.a.Zu,null);var b=this.qCf(a.clientPoint.x),c=this.ul.Md.Ld;const H=c.rf(b,0);(this.Eba||this.ni===this.xG-1)&&this.Ks.a0a(this.ul.gb,this.ni,H);if(this.Eba&&b!==this.nF&&(b=this.nF-b)){this.Yd.setPosition(this.Yd.x+
b,this.Yd.y,!0);b=c.rf(this.Yd.x,0);c=c.rf(this.Yd.y,1);const U=this.ul.Dk.shapeNode;U.wy=b;U.yy=c}!this.Eba&&this.ni<this.xG-1&&this.pWe(H,x);this.Dtc();l.dispose();Oc.App.Kb.updateCommandUI();this.end();this.ee?this.Ks.d_a(this.ee):xa.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");f&&f.stop();a&&xa.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.ul.gb.sa(kb.a.iGb,""),this.ul.gb.Lp(),
this.Eba))}else a&&Oc.App.Kb.i6(a.clientPoint,a.Xf),super.ao(a)}ou(a){super.ou(a);this.iN&&this.Dtc()}y7f(){return null}wEf(){if(!this.pe)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!cn.a.g4(this.pe))throw Error.invalidOperation("Element is not the table column resize handle");}ATd(a){this.pe=a;this.LHg=this.wSe;this.hze=this.pe.style.marginLeft;this.ize=this.pe.style.marginRight;this.oeb=this.pe.style.height;this.RHg=this.pe.style.top;this.DHg=
this.pe.style.bottom;this.JHg=this.pe.style.left;this.pe.style.marginLeft=this.pe.style.marginRight="auto";this.pe.style.top="0";this.pe.style.height="auto";this.pe.style.bottom="0";this.Gdb&&(a=cn.a.I6b(a))&&(this.pe.style.top=-a.offsetTop+"px",this.pe.style.bottom=-(this.ul.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}Dtc(){this.pe&&(Sys.UI.DomElement.removeCssClass(this.pe,this.nBf),this.pe.style.marginLeft=this.hze,this.pe.style.marginRight=this.ize,this.hze=this.ize="auto",this.pe.style.left=
this.pak?this.JHg:"auto",this.pe.style.top=this.RHg,this.pe.style.height=this.oeb,this.pe.style.bottom=this.DHg,this.pe=null)}C5i(a){this.Cec=this.wwe=!1;a=a.Ec;if(cn.a.g4(a)){var b=null,c=null;({Ibb:b,bjb:c}=this.B5i(a,b,c)).returnValue&&this.n6i(b,c)&&this.A9d()&&this.ee&&(a=this.yc.Ai(this.ee),b=this.yc.sk(this.ee),0<=this.Zea&&this.Zea<b&&0<=this.Veb&&this.Veb<b&&0<=this.Y4&&this.Y4<a&&0<=this.Z4&&this.Z4<a&&(this.Cec=!0))}}B5i(a,b,c){if(!cn.a.g4(a)||!this.ee)return{returnValue:!1,Ibb:b,bjb:c};
var f=cn.a.I6b(a);f=Rc.a(f);this.rma=Object(oa.a)(Yl.TableCellNode,f.gb);if(!this.rma)return{returnValue:!1,Ibb:b,bjb:c};f=this.cTc(this.rma);if(0>f||f>=this.yc.Ai(this.ee))return{returnValue:!1,Ibb:b,bjb:c};const l=this.rma.rowIndex;if(0>l||l>=this.yc.sk(this.ee))return{returnValue:!1,Ibb:b,bjb:c};if(Kl.zig(a))return{returnValue:!1,Ibb:null,bjb:c};b=this.ee.qf(l,f);if(f===this.yc.Ai(this.ee)-1)return{returnValue:!1,Ibb:b,bjb:null};c=this.ee.qf(l,f+1);return{returnValue:!0,Ibb:b,bjb:c}}n6i(a,b){if(!this.ee||
!a||!b)return!1;this.Zea=a.rowIndex;if(0>this.Zea||this.Zea>=this.yc.sk(this.ee))return!1;this.Veb=this.Zea;this.Y4=this.q5b(a);if(0>this.Y4||this.Y4>=this.yc.Ai(this.ee))return!1;this.Z4=this.cTc(b);if(0>this.Z4||this.Z4>=this.yc.Ai(this.ee))return!1;var c=this.l2i(a,b);a=c?this.O3i(a,b):!1;if(c=c&&a)this.wwe=this.XLj(b.pi);return c}XLj(a){let b=!0;if(0<this.Zea)for(var c=this.Zea-1;0<=c;){var f=this.ee.qf(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.Veb<this.ee.DY-1)for(c=this.Zea+1;c<=this.ee.DY-
1;){if((f=this.ee.qf(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}A9d(){if(!this.ee)return!1;const a=this.yc.Ai(this.ee);if(0>this.Y4||this.Y4>=a||0>this.Z4||this.Z4>=a||0>this.ni||this.ni>=a||0>this.ni+1||this.ni+1>=a)return!1;this.zRg=this.tae(this.ee,this.Y4,this.ni)-this.y8d(this.ee,this.Y4);this.ARg=this.tae(this.ee,this.Z4,this.ni+1)-this.y8d(this.ee,this.Z4);return!0}tae(a,b,c){if(b>c)return this.tae(a,c,b);if(!a||0>b||b>=this.yc.Ai(a)||0>c||c>=this.yc.Ai(a))return-1;a=a.Y5d;let f=0;for(;b<=
c;b++)f+=a[b];return Math.floor(this.ul.Md.Ld.Pe(f,0))}y8d(a,b){return Ab.StyleReader.nr?Ab.StyleReader.nr.L8(a,b):In.a.asd}hEa(a,b){return this.ul.Md.Ld.rf(this.y8d(a,b),0)}l2i(a,b){if(!a||!b)return!1;a=a.i5b();const c=b.pi;for(b=b.i5b();b&&(!b.isGhostCell||this.q5b(b)===c);)this.Zea--,this.Y4=Math.max(this.Y4,this.q5b(a)),this.Z4=Math.min(this.Z4,this.cTc(b)),a=a.i5b(),b=b.i5b();return!0}O3i(a,b){if(!a||!b)return!1;a=a.zRc();const c=b.pi;for(b=b.zRc();b&&(!a.isGhostCell||this.q5b(b)===c);)this.Veb++,
this.Y4=Math.max(this.Y4,this.q5b(a)),this.Z4=Math.min(this.Z4,this.cTc(b)),a=a.zRc(),b=b.zRc();return!0}q5b(a){return a?(a=a.Xy())?a.pi:-1:-1}cTc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.Xy());a=null;b&&(a=b.M7d(2));return a?a.pi:-1}qCf(a){this.rXe()&&this.Cec?(a=this.ul.gb.rTj?Math.floor((this.r7-a)/this.zoom)+this.nF:Math.floor((a-this.r7)/this.zoom)+this.nF,a=Math.min(a,this.nF+this.ARg),a=Math.max(a,this.nF-this.zRg)):a=this.GTd(a);return a}pWe(a,b){if(this.rXe()&&this.Cec){if(!this.pa.gH()){var c=
Qd.SelectionFactory.Sg(Object(oa.a)(ug.a,this.rma.n4b),0);this.pa.setSelection(c)}let f=c=-1,l=-1;({$Pf:c,sPf:f,tPf:l}=this.x8i(a-b[this.ni],b,c,f,l));this.wwe&&(c===this.ni&&Math.abs(f)>=this.hEa(this.ee,c)||c===this.ni+1&&c<this.yc.Ai(this.ee)-1&&Math.abs(l)>=this.hEa(this.ee,c+1)||c===this.ni+1&&c===this.yc.Ai(this.ee)-1)?(xa.a.J(512497182,815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),
c.toString(),f.toString(),l.toString()),a=b[this.ni]+b[this.ni+1],c===this.ni?(f=Math.max(f,this.hEa(this.ee,c)),l=a-f):c===this.ni+1&&(l=Math.max(l,this.hEa(this.ee,c)),f=a-l),this.Ks.a0a(this.ee,this.ni,f),this.Ks.a0a(this.ee,this.ni+1,l)):(c>this.Y4&&Math.abs(f)<this.hEa(this.ee,c)?(xa.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),f.toString(),l.toString()),
this.fgb(c,this.ni+1)):c<this.Z4&&Math.abs(l)<this.hEa(this.ee,c+1)?(xa.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),c.toString(),f.toString(),l.toString()),this.fgb(c+1,this.ni+1)):(xa.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.ni.toString(),
c.toString(),f.toString(),l.toString()),this.ipl(c,f,l)),this.Ks.RQe(this.ee),a=tb.GraphIterator.nb(this.ee),this.Ks.q4e(a),this.ee.Hda(511),this.qA.Y8b(this.ee))}else this.Ks.a0a(this.ee,this.ni,a),this.Ks.a0a(this.ee,this.ni+1,b[this.ni]+b[this.ni+1]-a)}x8i(a,b,c,f,l){if(!a)return c=this.ni,f=b[this.ni],{$Pf:c,sPf:f,tPf:0};f=0;if(0<a){for(c=this.ni;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.ni+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{$Pf:c,sPf:f,tPf:l}}fgb(a,b){if(b!==a){var c=this.p6i(b-
1);for(let f=this.Zea;f<=this.Veb;f++){const l=this.ee.qf(f,b),x=this.ee.qf(f,a);this.BEe(c[f],l,x)}}}BEe(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.pi-b.pi,x=a.colSpan+b.colSpan-l;zm.c(Object(oa.a)(ug.a,b),Object(oa.a)(ug.a,c),this.Ks.pUd);zm.c(Object(oa.a)(ug.a,b),Object(oa.a)(ug.a,c),[kb.a.fKa]);var H=tb.GraphIterator.nb(c);H.$e();var U=new tb.GraphIterator;U.set(Object(oa.a)(ug.a,b));U.Bb(1)&&zm.h(H,null,1,1,U,-1);c.isGhostCell=b.isGhostCell;this.R3d(H);b.fo(kb.a.rowSpan,kb.a.colSpan);
b.isGhostCell=!0;c.isGhostCell||(c.colSpan=x,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}R3d(a){const b=a.currentNode.eb(kb.a.rowId),c=a.currentNode.eb(kb.a.cellId);for(a=Vl.a.qv(a);a.moveNext();){const f=a.currentNode.sa(kb.a.cellId,null);a.currentNode.sa(kb.a.rowId,null)&&a.currentNode.setValue(kb.a.rowId,b);f&&a.currentNode.setValue(kb.a.cellId,c)}}ipl(a,b,c){var f=tb.GraphIterator.nb(this.ee);Vd.moveToFirstRow(f);f.Zp(a,1);this.Ks.Bee(f);if(f=this.ee.sa($a.a.Zu,null))f=cb.a.clone(f),
b<this.hEa(this.ee,a)?(b=this.hEa(this.ee,a),c=f[a]-b):(c=Math.max(c,this.hEa(this.ee,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.ee.setValue($a.a.Zu,f);b=this.ni+1;a+=1;a<=b&&(b+=1);this.fgb(a,b)}p6i(a){const b=Array(this.yc.sk(this.ee));for(let c=this.Zea;c<=this.Veb;c++){const f=this.ee.qf(c,a);b[c]=f.Xy()}return b}rXe(){return!!this.ee&&this.ee.Lp()&&!this.Eba&&this.ni<this.xG-1}}Object(m.a)(EL,"PowerPointColumnDragAdapter",yL.a,[]);class TD{constructor(a,b){this.Ex=this.l5=null;this.Kfc=this.jeb=0;
this.MEb=!1;this.Y9=a;this.b0=b}Cv(a){if(3===a.Xf)return!1;a=a.Ec;return Kl.fVa(a)||Kl.fac(a)}ou(){if(this.MEb){const a=new pf.GraphTransaction(3);a.kd(this.l5.gb);this.l5.source.Bv(4,!0);a.dispose()}this.end()}end(){this.Y9.QR()}dispose(){this.l5=null}}Object(m.a)(TD,"CommonRowHandleDragAdapter",null,[240,106]);class FL extends TD{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){super(a,b);this.Lwe=this.RCb=!1;this.GHg=this.pHa=0;this.rma=this.ee=this.Yd=this.lwa=this.KHg=this.IHg=this.EHg=this.HHg=
this.FHg=null;this.QHg=this.Te=this.yRg=this.xRg=this.X4=this.W4=this.XHa=this.A0=this.nA=0;this.G$=f;this.Mq=c;this.Tk=l;this.Gdb=x;this.Ks=H;this.yc=U;this.pa=ja;this.qA=ya;this.dhk=Va;this.ia=yb;this.Sp=Zb;this.gYa=null;this.Dec=this.C6c=this.m6c=!1;this.lr=hb}Tu(a){if(!this.Cv(a))return!1;const b=a.Ec;if(Kl.fac(b)){xa.a.J(512497178,816,50,"drag from table row handle");this.MEb=!1;var c=Kl.Alj(b);if(!c)return!1;this.ee=Rc.a(c).gb;this.Ex=this.ee.sc(this.Te);if(!this.Ex)return xa.a.J(512497177,
816,10,"OnDragStart : m_tableViewElement is null"),!1;this.QHg=this.lr.C8d(this.Ex,a.clientPoint);this.b0.Hhd(b);return!0}this.l5=Kl.shj(b);if(!this.l5)return!1;c=Object(oa.a)(153,this.l5.gb);this.Te=this.l5.Ma;this.ee=c?c.getContainingTable():null;if(!this.ee)return!1;this.Ex=this.ee.sc(this.Te);this.gYa=this.dhk.h8d(this.ee);if(!this.Ex||!this.gYa)return!1;this.RCb=Kl.Bje(b);this.Lwe=Kl.mke(b);this.jeb=this.l5.htmlElement.offsetHeight;this.Kfc=this.pHa=a.clientPoint.y;this.b0.nl(21);this.Y9.endEditing(!0,
14);this.Yd=this.Ex.Dk;this.C6c=this.m6c=this.Dec=!1;this.MEb=!0;this.sXe()&&this.Ahj(b);this.ATd(b);this.Sp&&this.ia.processAction(D.a.Sja,2);return!0}Cw(a){this.MEb?(this.pHa=a.clientPoint.y,a=(this.uCf(this.pHa)-this.jeb)*(this.RCb?-1:1)+this.GHg,this.lwa.style.top=a+"px"):(a=this.lr.C8d(this.Ex,a.clientPoint),this.Ex.poh(this.QHg,a));return!0}ao(a){let b=null;a&&(b=this.G$.Ci("UserAction","PPTRowResize"),xa.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.Ex.gb.sa(kb.a.iGb,
""),this.Ex.gb.Lp())));if(this.MEb){var c=this.uCf(a?a.clientPoint.y:this.pHa),f=new pf.GraphTransaction(15);if(this.sXe()&&this.Dec&&this.C6c)bd.a.mark(11077),f.kd(this.ee),this.pWe(c);else{this.l5.lMb(c);var l=this.l5.htmlElement.offsetHeight;bd.a.mark(11077);var x=this.l5.gb;f.kd(x);c=this.Y9.Ld;x.setValue(kb.a.su,c.rf(l,1));this.RCb&&l!==this.jeb&&(l=this.jeb-l)&&(this.Yd.setPosition(this.Yd.x,this.Yd.y+l,!0),l=c.rf(this.Yd.x,0),c=c.rf(this.Yd.y,1),x=this.Ex.Dk.shapeNode,x.wy=l,x.yy=c)}this.Dtc();
f.dispose();Oc.App.Kb.updateCommandUI();bd.a.mark(11078);this.end();this.ee?this.Ks.d_a(this.ee):xa.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&xa.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",this.Ex.gb.sa(kb.a.iGb,""),this.Ex.gb.Lp()))}else a&&Oc.App.Kb.i6(a.clientPoint,a.Xf),this.b0.i1()}ou(a){a.S2e?(super.ou(a),this.MEb&&this.Dtc()):this.ao(null)}end(){this.b0.i1();super.end()}uCf(a){a=this.jeb+
this.Mq.Qm(a-this.Kfc)*(this.RCb?-1:1);if(this.sXe()&&this.Dec&&this.C6c)a=Math.min(a,this.jeb+this.yRg),a=Math.max(a,this.jeb-this.xRg);else{var b=this.Tk.PIc(this.l5.gb);b=this.l5.Md.Ld.Pe(b,1);a=Math.max(b,a)}return a}ATd(a){this.lwa=a;Sys.UI.DomElement.addCssClass(this.lwa,"ShowDashedLine");this.GHg=a.offsetTop;this.KHg=a.style.marginTop;this.IHg=a.style.width;this.FHg=a.style.left;this.HHg=a.style.top;this.EHg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left=
"0";a.style.bottom="auto";if(this.Gdb){const b=cn.a.I6b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.l5.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}Dtc(){Sys.UI.DomElement.removeCssClass(this.lwa,"ShowDashedLine");this.lwa.style.marginTop=this.KHg;this.lwa.style.width=this.IHg;this.lwa.style.left=this.FHg;this.lwa.style.right="auto";this.lwa.style.top=this.HHg;this.lwa.style.bottom=this.EHg}Ahj(a){this.Dec=this.m6c=!1;if(this.ee&&Kl.fVa(a)){var b=null,c=null;({Q5a:b,E6a:c}=
this.zhj(a,b,c)).returnValue&&this.o6i(b,c)&&this.A9d()&&(a=this.yc.Ai(this.ee),b=this.yc.sk(this.ee),0<=this.A0&&this.A0<a&&0<=this.XHa&&this.XHa<a&&0<=this.W4&&this.W4<b&&0<=this.X4&&this.X4<b&&(this.Dec=!0),this.C6c=0<this.A0||this.XHa<a-1?!0:!1)}}zhj(a,b,c){if(!Kl.fVa(a)||!this.ee)return{returnValue:!1,Q5a:b,E6a:c};a=cn.a.I6b(a);a=Rc.a(a);this.rma=Object(oa.a)(Yl.TableCellNode,a.gb);if(!this.rma)return{returnValue:!1,Q5a:b,E6a:c};a=this.nA=this.rma.rowIndex-1;if(0>a||a>=this.yc.sk(this.ee))return{returnValue:!1,
Q5a:b,E6a:c};const f=this.rma.pi;if(0>f||f>=this.yc.Ai(this.ee))return{returnValue:!1,Q5a:b,E6a:c};if(this.RCb)return{returnValue:!1,Q5a:null,E6a:c};b=this.ee.qf(a,f);if(this.Lwe)return{returnValue:!1,Q5a:b,E6a:null};c=this.ee.qf(a+1,f);return{returnValue:!0,Q5a:b,E6a:c}}o6i(a,b){if(!this.ee||!a||!b)return!1;this.A0=a.pi;if(0>this.A0||this.A0>=this.yc.Ai(this.ee))return!1;this.XHa=this.A0;var c=a.Xy();this.W4=c?c.rowIndex:-1;if(0>this.W4||this.W4>=this.yc.sk(this.ee))return!1;this.X4=this.N7d(b);
if(0>this.X4||this.X4>=this.yc.sk(this.ee))return!1;a=(c=this.vbj(a,b))?this.hhj(a,b):!1;if(a=c&&a)this.m6c=this.YLj(b.rowIndex);return a}A9d(){if(!this.ee)return!1;const a=this.yc.sk(this.ee);if(0>this.W4||this.W4>=a||0>this.X4||this.X4>=a)return!1;this.xRg=this.w7d(this.ee,this.W4,this.nA)-this.WSa(this.ee,this.W4);this.yRg=this.w7d(this.ee,this.X4,this.nA+1)-this.WSa(this.ee,this.X4);return!0}vbj(a,b){if(!a||!b)return!1;a=a.s9a();const c=b.rowIndex;for(b=b.s9a();b&&a;){var f=b.Xy();if(b.isGhostCell&&
f&&f.rowIndex!==c)break;this.A0--;if(f=a.Xy())this.W4=Math.max(this.W4,f.rowIndex);this.X4=Math.min(this.X4,this.N7d(b));a=a.s9a();b=b.s9a()}return!0}hhj(a,b){if(!a||!b)return!1;a=a.m_();const c=b.rowIndex;for(b=b.m_();b&&(!b.isGhostCell||b.Xy().rowIndex===c);)this.XHa++,this.W4=Math.max(this.W4,a.Xy().rowIndex),this.X4=Math.min(this.X4,this.N7d(b)),a=a.m_(),b=b.m_();return!0}YLj(a){let b=!0,c;if(0<this.A0)for((c=this.ee.qf(a,this.A0))&&(c=c.s9a());c;){if(!c.isGhostCell){b=!1;break}c=c.s9a()}if(this.XHa<
this.ee.d8-1)for((c=this.ee.qf(a,this.XHa))&&(c=c.m_());c;){if(!c.isGhostCell){b=!1;break}c=c.m_()}return b}N7d(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.Xy());return b&&(b=b.M7d(1))?b.rowIndex:-1}w7d(a,b,c){if(b>c)return this.w7d(a,c,b);if(!a||0>b||b>=this.yc.sk(a)||0>c||c>=this.yc.sk(a))return-1;for(a=0;b<=c;b++)a+=this.gYa[b];return Math.floor(a)}WSa(a,b){a=this.Tk.FTd(a,b);return Math.floor(this.Y9.Ld.Pe(a,1))}pWe(a){if(!this.pa.gH()){var b=this.rma.i5b().Xy().n4b;b=Qd.SelectionFactory.Sg(Object(oa.a)(ug.a,
b),0);this.pa.setSelection(b)}let c=b=-1;var f=-1;({aQf:b,qPf:c,rPf:f}=this.y8i(a-this.gYa[this.nA],this.gYa,b,c,f));if(this.m6c&&(b===this.nA&&Math.abs(c)>=this.WSa(this.ee,this.nA)||b===this.nA+1&&b<this.yc.sk(this.ee)&&Math.abs(f)>=this.WSa(this.ee,this.nA+1)||b===this.nA+1&&b===this.yc.sk(this.ee)-1)){xa.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.nA.toString(),b.toString(),c.toString(),
f.toString());f=tb.GraphIterator.nb(this.ee);this.jjc(f,this.nA);a=f.currentNode;var l=this.gYa[this.nA];const H=a.sc(this.Te);Vd.moveToNextRow(f);f=f.currentNode;var x=this.gYa[this.nA+1];const U=f.sc(this.Te);x=l+x;l=this.Y9.Ld;b===this.nA+1&&(c+=this.gYa[this.nA]);H.lMb(Math.floor(c));b=H.htmlElement.offsetHeight;a.setValue(kb.a.su,l.rf(b,1));b=x-b;b=Math.max(b,this.WSa(this.ee,this.nA+1));U.lMb(Math.floor(b));f.setValue(kb.a.su,l.rf(U.htmlElement.offsetHeight,1))}else b>this.W4&&Math.abs(c)<this.WSa(this.ee,
b)?(xa.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.nA.toString(),b.toString(),c.toString(),f.toString()),this.fgb(b,this.nA+1)):b<this.X4&&Math.abs(f)<this.WSa(this.ee,b+1)?(xa.a.J(512497170,815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.nA.toString(),b.toString(),c.toString(),f.toString()),
this.fgb(b+1,this.nA+1)):(xa.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.nA.toString(),b.toString(),c.toString(),f.toString()),this.jpl(b,c,f)),this.Ks.RQe(this.ee),b=tb.GraphIterator.nb(this.ee),this.Ks.q4e(b),this.ee.Hda(511),this.qA.Y8b(this.ee)}y8i(a,b,c,f,l){if(!a)return c=this.nA,f=b[this.nA],{aQf:c,qPf:f,rPf:0};f=0;if(0<a){for(c=this.nA;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=
this.nA+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{aQf:c,qPf:f,rPf:l}}fgb(a,b){if(b!==a){var c=this.q6i(b-1);b=this.ee.qf(b,this.A0);a=this.ee.qf(a,this.A0);for(let f=this.A0;f<=this.XHa;f++)this.BEe(c[f],b,a),b=b.m_(),a=a.m_()}}BEe(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,x=a.rowSpan+b.rowSpan-l;zm.c(Object(oa.a)(ug.a,b),Object(oa.a)(ug.a,c),this.Ks.pUd);zm.c(Object(oa.a)(ug.a,b),Object(oa.a)(ug.a,c),[kb.a.fKa]);var H=tb.GraphIterator.nb(c);H.$e();var U=new tb.GraphIterator;
U.set(Object(oa.a)(ug.a,b));U.Bb(1)&&zm.h(H,null,1,1,U,-1);c.isGhostCell=b.isGhostCell;this.R3d(H);b.fo(kb.a.rowSpan,kb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=x);a.pi===H.yq.pi&&(a.rowSpan=l)}}R3d(a){const b=a.currentNode.eb(kb.a.rowId),c=a.currentNode.eb(kb.a.cellId);for(a=Vl.a.qv(a);a.moveNext();){const f=a.currentNode.sa(kb.a.cellId,null);a.currentNode.sa(kb.a.rowId,null)&&a.currentNode.setValue(kb.a.rowId,b);f&&a.currentNode.setValue(kb.a.cellId,c)}}jpl(a,b,c){var f=
tb.GraphIterator.nb(this.ee);this.jjc(f,a);const l=f.currentNode;f=this.Ks.Cee(f);const x=this.Y9.Ld,H=l.sc(this.Te);H.lMb(Math.floor(b));l.setValue(kb.a.su,x.rf(H.htmlElement.offsetHeight,1));c=Math.max(c,this.WSa(this.ee,a+1));f.setValue(kb.a.su,x.rf(Math.floor(c),1));b=this.nA+1;a+=1;a<=b&&(b+=1);this.fgb(a,b)}jjc(a,b){if(!(14!==a.ri||0>b||b>=this.yc.sk(a.currentNode)))for(Vd.moveToFirstRow(a);0<b--;)Vd.moveToNextRow(a)}q6i(a){a=this.ee.qf(a,this.A0);const b=Array(this.yc.Ai(this.ee));for(let c=
this.A0;c<=this.XHa;c++)b[c]=a.Xy(),a=a.m_();return b}sXe(){return!!this.ee&&this.ee.Lp()&&!this.RCb&&!this.Lwe}}Object(m.a)(FL,"PowerpointRowHandleDragAdapter",TD,[]);class UD{constructor(a,b,c,f){this.qA=f;this.QGa=a;this.QGa.jk(Object(F.a)(this,this.kh,"onPropertyChanged"))}kh(a,b){a=b.property;(b=Object(oa.a)(123,b.node))&&(a===kb.a.colSpan||a===kb.a.rowSpan)&&(b=b.getContainingTable())&&(this.qA.pkk(b),b.VY=null)}dispose(){this.QGa.Cm(Object(F.a)(this,this.kh,"onPropertyChanged"))}}Object(m.a)(UD,
"TableCellNodeBehavior",null,[106]);class GL extends qc.a{constructor(a,b){super(a,b,"TableCellSelected")}PXg(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.Q_a)?Sys.UI.DomElement.addCssClass(a,this.Q_a):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.Q_a)&&Sys.UI.DomElement.removeCssClass(a,this.Q_a)}}Object(m.a)(GL,"TableCellSelectionBehavior",qc.a,[1127,479]);class HL extends Sys.EventArgs{constructor(a){super();this.m1h=a}get tableCellNode(){return this.atl.tableCellNode}get atl(){return this.m1h}}
Object(m.a)(HL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class VD extends Sys.EventArgs{constructor(a){super();this.PIi=a}}Object(m.a)(VD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Sp=d(189);class bt extends Fv{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){super(a,b,f,l,Db.a.instance.resolve("Box4.ITableCellReader"),Db.a.instance.resolve("Box4.IParagraphReader"),Db.a.instance.resolve("Box4.IOutlineElementNavigator"),Db.a.instance.resolve("Box4.ITableNavigator"),Db.a.instance.resolve("Box4.IOutlineElementReader"),
Db.a.instance.resolve("Box4.Styles.IStyleReader"),Db.a.instance.ub("Box4.IFeatureHelper"),new GL(a,b),Db.a.instance.ub("Box4.Styles.ITableCellspacingReader"),Db.a.instance.resolve("Box4.TableCellViewElementSettings"));this.fye=this.gye=this.Uad=this.$ad=this.xFb=this.Bh=this.Cfb=this.nO=this.wO=this.B0=null;this.gma=!1;this.Lla=null;this.nj=Object(oa.a)(123,b);this.Fa=c;this.qA=x;this.Tk=H;this.Lc=U;this.qGa=ja;this.yc=ya;this.Gdb=Va;this.hDb=hb;this.o0=yb;this.u7c=Zb;this.pec=Ud.a("PPTOEnableTableDiagonalBorders");
this.pa=fc;this.jva=this.i0f();(this.Gdb||this.hDb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}I6(){}Ky(a){super.Ky(a);this.Gdb&&!this.Md.Wl&&this.U9k()}TDa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}Rkg(){const a=this.pa.W2i(),b=this.nj.getContainingTable();return b?Array.contains(a,b):!1}ZSk(a){switch(a){case "Top":this.Bh.style.top="-0.5px";this.Bh.style.borderTopWidth="1px";break;case "Right":this.Bh.style.right=
"-0.5px";this.Bh.style.borderRightWidth="1px";break;case "Bottom":this.Bh.style.bottom="-0.5px";this.Bh.style.borderBottomWidth="1px";break;case "Left":this.Bh.style.left="-0.5px",this.Bh.style.borderLeftWidth="1px"}}YSk(a){switch(a){case "Top":this.Bh.style.top="0px";this.Bh.style.borderTopWidth="0px";break;case "Right":this.Bh.style.right="0px";this.Bh.style.borderRightWidth="0px";break;case "Bottom":this.Bh.style.bottom="0px";this.Bh.style.borderBottomWidth="0px";break;case "Left":this.Bh.style.left=
"0px",this.Bh.style.borderLeftWidth="0px"}}Lkd(a){this.Bh&&(this.Rkg()?this.ZSk(a):this.YSk(a))}S9k(a,b,c){const f=!Ud.a("TableBorderOutsideBorderHalfClippingDisabled");this.F1d();var l=tb.GraphIterator.nb(this.gb);l.rc(14);var x=l.Jg(14);l=this.yc.sk(x);x=this.yc.Ai(x);c=c?c.jV():"";switch(a){case "Top":b=this.Md.Ld.Pe(b,1);!this.nj.rowIndex&&f?(this.Bh.style.top="0px",this.Bh.style.borderTopWidth=b/2+"px"):(this.Bh.style.top=-b/2+"px",this.Bh.style.borderTopWidth=b+"px");this.Bh.style.borderTopColor=
c;break;case "Bottom":b=this.Md.Ld.Pe(b,1);this.nj.rowIndex+this.nj.rowSpan===l&&f?(this.Bh.style.bottom="0px",this.Bh.style.borderBottomWidth=b/2+"px"):(this.Bh.style.bottom=-b/2+"px",this.Bh.style.borderBottomWidth=b+"px");this.Bh.style.borderBottomColor=c;break;case "Left":b=this.Md.Ld.Pe(b,0);!this.nj.pi&&f?(this.Bh.style.left="0px",this.Bh.style.borderLeftWidth=b/2+"px"):(this.Bh.style.left=-b/2+"px",this.Bh.style.borderLeftWidth=b+"px");this.Bh.style.borderLeftColor=c;break;case "Right":b=this.Md.Ld.Pe(b,
0);this.nj.pi+this.nj.colSpan===x&&f?(this.Bh.style.right="0px",this.Bh.style.borderRightWidth=b/2+"px"):(this.Bh.style.right=-b/2+"px",this.Bh.style.borderRightWidth=b+"px");this.Bh.style.borderRightColor=c;break;case "DiagonalUp":this.pec&&(b=this.Md.Ld.Pe(b,0),this.jQf(a,b,c));break;case "DiagonalDown":this.pec&&(b=this.Md.Ld.Pe(b,0),this.iQf(a,b,c))}this.fsh()}jQf(a,b,c){this.cSf();this.gye||(this.gye=this.JJf());this.Mph(this.gye,a,b,c)}iQf(a,b,c){this.cSf();this.fye||(this.fye=this.JJf());this.Mph(this.fye,
a,b,c)}JJf(){const a=new om.a;this.$ad.appendChild(a.xa);this.Xo(a.xa);return a}Mph(a,b,c,f){b=this.OCi(b);a.r1(b);a.Yu(f);a.mr(c)}OCi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.O5d(),this.Q5d());case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.Q5d(),this.O5d())}xa.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}cSf(){this.F1d();this.xFb||(this.xFb=this.Md.hp(va.a.div),this.xFb.className="PPTTableDiagonalBorder",this.Cfb.appendChild(this.xFb),
this.Xo(this.xFb));this.Uad||(this.Uad=new Km.a,this.$ad=this.Uad.xa,this.xFb.appendChild(this.$ad),this.Xo(this.$ad));this.Uad.Eya(String.format("0 0 {0} {1}",this.Q5d(),this.O5d()))}F1d(){this.Cfb||(this.Cfb=this.Md.hp(va.a.div),this.Cfb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.Cfb,this.htmlElement.firstChild),this.Xo(this.Cfb));this.Bh||(this.Bh=this.Md.hp(va.a.div),this.Bh.className="PPTTableBorder",this.Cfb.appendChild(this.Bh),this.Xo(this.Bh))}fsh(){this.u7c&&
Ud.a("MergeDifferentBordersFixEnabled")?this.Bh.style.zIndex=this.rAb(this.nj)?"1":(this.vUa(this.nj.fza)||this.vUa(this.nj.vga))&&(this.vUa(this.nj.eza)||this.vUa(this.nj.wga))?"3":"2":this.Bh.style.zIndex=(this.vUa(this.nj.fza)||this.vUa(this.nj.vga))&&(this.vUa(this.nj.eza)||this.vUa(this.nj.wga))?"1":"0"}rAb(a){return 1<a.rowSpan||1<a.colSpan}LLj(a){return"DiagonalUp"===a||"DiagonalDown"===a}RKa(a,b,c,f){const l=this.u7c&&Ud.a("MergeDifferentBordersFixEnabled")&&this.rAb(this.nj);this.u7c&&!this.LLj(a)&&
this.Rkg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.ZIj()&&(b=0);this.Bh.style.borderTopWidth=b+"px";this.Bh.style.borderTopColor=c;this.Bh.style.borderTopStyle=f;this.Bh.style.top=-b/2+"px";break;case "Right":l&&!this.YIj()&&(b=0);this.Bh.style.borderRightWidth=b+"px";this.Bh.style.borderRightColor=c;this.Bh.style.borderRightStyle=f;this.Bh.style.right=-b/2+"px";break;case "Bottom":l&&!this.SIj()&&(b=0);this.Bh.style.borderBottomWidth=b+"px";this.Bh.style.borderBottomColor=
c;this.Bh.style.borderBottomStyle=f;this.Bh.style.bottom=-b/2+"px";break;case "Left":l&&!this.UIj()&&(b=0);this.Bh.style.borderLeftWidth=b+"px";this.Bh.style.borderLeftColor=c;this.Bh.style.borderLeftStyle=f;this.Bh.style.left=-b/2+"px";break;case "DiagonalUp":this.pec&&this.jQf(a,b,c);break;case "DiagonalDown":this.pec&&this.iQf(a,b,c)}}Q5d(){var a=0;for(let b=0;b<this.nj.colSpan;b++)a+=this.nj.getContainingTable().Y5d[this.nj.pi+b];a=this.Md.Ld.Pe(a,0);return Math.round(100*a)/100}O5d(){var a=this.yc.VTc(this.nj.getContainingTable(),
this.nj.rowIndex,this.nj.rowIndex+this.nj.rowSpan-1);let b=0;for(let c of a)Object(Xa.a)(153,c)?b+=c.sa(kb.a.su,0):xa.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",c));this.nj.marginTop+this.nj.marginBottom>b&&xa.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.nj.marginTop,this.nj.marginBottom));b=Math.max(b,this.nj.marginTop+this.nj.marginBottom);
a=this.Md.Ld.Pe(b,1);return Math.round(100*a)/100}ZIj(){if(!this.nj.rowIndex)return!0;const a=this.nj.getContainingTable();if(!a)return!0;const b=this.nj.rowIndex-1;var c=this.nj.pi;const f=c+this.nj.colSpan-1;for(;c<=f;c++){const l=a.qf(b,c);if(l&&(l.isGhostCell||this.rAb(l)))return!0}return!1}UIj(){if(!this.nj.pi)return!0;const a=this.nj.getContainingTable();if(!a)return!0;const b=this.nj.pi-1;var c=this.nj.rowIndex;const f=c+this.nj.rowSpan-1;for(;c<=f;c++){const l=a.qf(c,b);if(l&&(l.isGhostCell||
this.rAb(l)))return!0}return!1}YIj(){const a=this.nj.getContainingTable();if(!a||this.nj.pi+this.nj.colSpan===this.yc.Ai(a))return!0;const b=this.nj.pi+this.nj.colSpan;var c=this.nj.rowIndex;const f=c+this.nj.rowSpan-1;for(;c<=f;c++){const l=a.qf(c,b);if(l&&(l.isGhostCell||this.rAb(l)))return!0}return!1}SIj(){const a=this.nj.getContainingTable();if(!a||this.nj.rowIndex+this.nj.rowSpan===this.yc.sk(a))return!0;const b=this.nj.rowIndex+this.nj.rowSpan;var c=this.nj.pi;const f=c+this.nj.colSpan-1;for(;c<=
f;c++){const l=a.qf(b,c);if(l&&(l.isGhostCell||this.rAb(l)))return!0}return!1}U9k(){var a=!Ud.a("TableBorderOutsideBorderHalfClippingDisabled");this.F1d();if(a){a=tb.GraphIterator.nb(this.gb);a.rc(14);var b=a.Jg(14);a=this.yc.sk(b);b=this.yc.Ai(b);var c=this.TDa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.RKa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.nj.pi?this.Bh.style.left=-c/2+"px":(this.Bh.style.left="0px",this.Bh.style.borderLeftWidth=
c/2+"px");c=this.TDa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.RKa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);this.nj.pi+this.nj.colSpan===b?(this.Bh.style.right="0px",this.Bh.style.borderRightWidth=c/2+"px"):this.Bh.style.right=-c/2+"px";b=this.TDa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.RKa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);
this.nj.rowIndex?this.Bh.style.top=-b/2+"px":(this.Bh.style.top="0px",this.Bh.style.borderTopWidth=b/2+"px");b=this.TDa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);this.RKa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.nj.rowIndex+this.nj.rowSpan===a?(this.Bh.style.bottom="0px",this.Bh.style.borderBottomWidth=b/2+"px"):this.Bh.style.bottom=-b/2+"px"}else a=this.TDa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),
this.RKa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.TDa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),this.RKa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.TDa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.RKa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.TDa(this.htmlElement.style.borderBottom,
this.htmlElement.style.borderBottomWidth),this.RKa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.hQf();this.u7c&&this.fsh();this.htmlElement.style.border=""}hQf(){this.pec&&(this.Jre&&this.Lph("DiagonalUp",this.Jre),this.Ire&&this.Lph("DiagonalDown",this.Ire))}vUa(a){return!!a}Lph(a,b){const c=b.split(" ");if(3!==c.length)xa.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",
b));else{var f=c[0];b=this.TDa(b,c[1]);this.RKa(a,b,c[2],f)}}puc(a,b,c,f,l,x,H){if(!this.o0||this.Fa.$m(this.nj).eb(kb.a.isResizable))this.hDb?this.fFl(l,x,H):this.eFl(a,b,c,f,l,x,H)}fFl(a,b,c){this.sGa||(this.sGa=this.rLc(),this.Xo(this.sGa));this.B0||(this.B0=this.WQa(),this.Xo(this.B0));a?Sys.UI.DomElement.addCssClass(this.B0,"First"):Sys.UI.DomElement.removeCssClass(this.B0,"First");b^!!this.wO&&(b?(this.wO=this.WQa(),this.Xo(this.wO)):(this.eKb(this.wO),this.wO=null));this.wO&&Sys.UI.DomElement.addCssClass(this.wO,
"Last");c^!!this.nO&&(c?(this.nO=this.rLc(),this.Xo(this.nO)):(this.eKb(this.nO),this.nO=null));this.nO&&Sys.UI.DomElement.addCssClass(this.nO,"FirstLeft")}eFl(a,b,c,f,l,x,H){super.puc(a,b,c,f,l,x,H);this.ytb&&this.Xo(this.ytb);this.B0||(this.B0=this.WQa(),this.Xo(this.B0));this.B0.style.left=a+"px";this.B0.style.top=b+"px";this.B0.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.B0,"First"):Sys.UI.DomElement.removeCssClass(this.B0,"First");x^!!this.wO&&(x?(this.wO=this.WQa(),this.Xo(this.wO)):
(this.eKb(this.wO),this.wO=null));this.wO&&(this.wO.style.bottom="0",this.wO.style.left=a+"px",this.wO.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.wO,"Last"));H^!!this.nO&&(H?(this.nO=this.rLc(),this.Xo(this.nO)):(this.eKb(this.nO),this.nO=null));this.nO&&(this.nO.style.left="0",this.nO.style.top=b+"px",this.nO.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.nO,"FirstLeft"));this.Gdb&&(this.B0.style.left="0",this.B0.style.top="0",this.ytb&&(this.ytb.style.left=c+"px",this.ytb.style.top=
"0",this.ytb.style.height=f+"px"),this.wO&&(this.wO.style.left="0"),this.nO&&(this.nO.style.top="0"))}zph(){var a=this.Md.Ld,b=a.Pe(this.Tk.jta(this.gb,3),1);this.hja.style.paddingTop=b+"px";b=a.Pe(this.Tk.jta(this.gb,0),1);this.hja.style.paddingBottom=b+"px";b=a.Pe(this.Tk.jta(this.gb,1),0);this.hja.style.paddingLeft=b+"px";a=a.Pe(this.Tk.jta(this.gb,2),0);this.hja.style.paddingRight=a+"px"}W9k(a,b){const c=this.Md.Ld;switch(b){case K.a.zsc:a=c.w_(a.marginTop,1);this.hja.style.paddingTop=a+"px";
break;case K.a.tsc:a=c.w_(a.marginBottom,1);this.hja.style.paddingBottom=a+"px";break;case K.a.usc:a=c.w_(a.marginLeft,0);this.hja.style.paddingLeft=a+"px";break;case K.a.ysc:a=c.w_(a.marginRight,0),this.hja.style.paddingRight=a+"px"}}JU(){var a=this.Tk.jta(this.gb,1),b=this.Tk.jta(this.gb,2);const c=this.Tk.a5b(this.gb,5),f=this.Tk.a5b(this.gb,6);var l=this.Md.Ld;a=l.Pe(a+c,0);b=l.Pe(b+f,0);l=l.Pe(this.Tk.pCf(this.gb),0);return new Ij.a(a,l,b)}dGh(){this.htmlElement.style.background=this.qA.w_f(this.gb)}xU(){if(!this.Bh)super.xU();
else if(!this.Md.Wl&&this.eB){const a=Object(oa.a)(1127,this.FR);a&&a.PXg(this.Bh)}}WQa(){const a=this.PKf();a.className="TableRowResizeHandle";return a}eKb(a){V.a.nKa(a);Ca.a.$O(a)}get tableCellNode(){return this.nj}get U1c(){return this.Lla}get Dk(){this.jva||(this.jva=this.i0f());return this.jva}set Dk(a){this.jva=a}get $p(){return this.gma}pMb(a){this.gma=a;this.tableCellNode.bzb=a}lock(a){this.$p&&this.Lla===a||(this.Dk.Rrd(),this.Lla=a,this.pMb(!0),this.Lc.Dy(new Sp.a(7)),this.qGa.Reh(new VD(a)),
this.qGa.IPk(new HL(this)))}unlock(){this.$p&&(this.Lla=null,this.pMb(!1),this.Lc.Dy(new Sp.a(7)),this.qGa.Reh(new VD(null)))}i0f(){let a=null;const b=this.Fa.$m(this.nj);b&&(a=Object(oa.a)(117,b.mg(this.Ma)));return a}}Object(m.a)(bt,"TableCellViewElement",Fv,[1128,456,351,106]);var Wz=d(300),aR=d(502);class km extends Qh{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){super(a,b);Qh.e3a=()=>Zq.TTf(Ug.a.create());this.Tk=c;this.Ml=f;this.yJ=x;this.iYa=l;this.yc=H;this.k5=U;this.fYa=ja;this.cDb=ya;this.Te=Va;
this.B6c=Ud.a("PPTOEnableTableDiagonalBorders")}iFf(a,b){Qh.bti(a,b,od.TableReader.Ai(a))}SKf(a,b,c,f=null,l=!1){const x=a.parentNode.eb(kb.a.shapeId);a.currentNode.setValue(kb.a.shapeId,x);for(var H=0;H<b;++H){var U=new aR.a;a.Cl(U,1);U.setValue(kb.a.shapeId,x);U.setValue(kb.a.rowId,Ug.a.create())}b=null;H=!0;a.Bb(1);do{U=a.currentNode.eb(kb.a.rowId);for(let ja=0;ja<c;++ja){const ya=this.jsa();a.Cl(ya,1);ya.setValue(kb.a.shapeId,x);ya.setValue(kb.a.rowId,U);ya.setValue(kb.a.cellId,Ug.a.create());
({Znh:b,isFirst:H}=this.kWf(a,ya,l,f,b,H));Vd.returnToContainingRow(a)}}while(a.Dj(1))}d_a(a){if(this.B6c&&a&&(a=this.yc.HF(a)))for(const b of a)b&&!b.isGhostCell&&(a=Object(oa.a)(bt,b.sc(this.Te)))&&a.hQf()}xSe(a,b,c,f,l){var x=this.yJ.MRc(a);for(var H=0;H<x.length;H++){const U=this.Tk.Hsb(a,H);x[H]=Math.max(U,x[H]*b)}a.setValue($a.a.Zu,x);if(1!==c)for((new tb.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){x=l.rf(f.ohj(c),1);H=this.Tk.FTd(a,c);x<=H&&(x=0);b.setValue(kb.a.su,x);if(b.Gjg())break;
else b=b.UIa;c++}this.d_a(a)}R9k(a,b){a=this.yc.HF(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].$oa=b}}Q9k(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let x=0;x<l.length;x++){var c=l.ga(x).iterator;c.rc(16);c.Jg(16);c=c.yq;const H=c.cellShading;H.anchorField=b;c.cellShading=H;c.$oa=b}}}U8b(a,b,c,f,l){super.U8b(a,b,c,f,l);c=[];Array.add(c,kb.a.su);zm.b(f,b,c);c=a.currentNode.eb(kb.a.shapeId);const x=a.yq.eb(kb.a.sid);a=a.yq.eb(kb.a.cid);const H=
Zq.IIf(Ug.a.create());b.setValue(kb.a.sid,x);b.setValue(kb.a.cid,a);b.setValue(kb.a.shapeId,c);b.setValue(kb.a.rowId,H);this.oFl(f,b,l)}J8b(a,b,c,f,l){super.J8b(a,b,c,f,l);return this.sed(a.currentNode,b,c,f,!1,!1)}tYb(a,b,c,f,l){super.tYb(a,b,c,f,l);return this.sed(a.currentNode,b,c,f,l,!1)}get pUd(){if(!km.Aaa){km.Aaa=[];let a,b,c;for(const f of km.c3c)if(this.B6c||2!==f&&1!==f)({gQa:b,F6a:a,lsb:c}=Rp.eTa(f)),Array.add(km.Aaa,b),Array.add(km.Aaa,a),Array.add(km.Aaa,c);Array.add(km.Aaa,$a.a.GE);
Array.add(km.Aaa,kb.a.cellShading);Array.add(km.Aaa,ab.a.PNb);Array.add(km.Aaa,ab.a.RNb);Array.add(km.Aaa,ab.a.SNb);Array.add(km.Aaa,ab.a.ONb);Array.add(km.Aaa,kb.a.kP)}return km.Aaa}sed(a,b,c,f,l,x){c=x?this.Osj(b,c,l):this.Psj(b,c,f,l);zm.c(c,b,this.pUd);f=a.eb(kb.a.cid);x=a.eb(kb.a.shapeId);const H=c.eb(kb.a.cellId),U=a.eb(kb.a.rowId);b.setValue(kb.a.sid,a.eb(kb.a.sid));b.setValue(kb.a.cid,f);b.setValue(kb.a.shapeId,x);b.setValue(kb.a.rowId,U);l?b.setValue(kb.a.cellId,H):b.setValue(kb.a.cellId,
b.id.Bq);return c}Kvf(a,b,c,f,l,x){a=a.currentNode;const H=Array(c);let U=0,ja=0,ya=0;for(;U<f;U++)H[U]=b[U],ja+=H[U];for(l=l?b[f]:b[f-1];U<f+x;U++)H[U]=l,ya+=H[U];for(;U<c;U++)H[U]=b[U-x],ja+=H[U];b=ja/(ya+ja);for(U=0;U<c;U++)H[U]=Math.max(H[U]*b,this.Tk.Hsb(a,U));return H}akc(a,b,c,f,l){super.akc(a,b,c,f,l);var x=a.eb(kb.a.Zkb);l=Array(x.length+f);let H=0;for(;H<b;H++)l[H]=x[H];for(;H<b+f;H++)l[H]=km.UEi();for(;H<l.length;H++)l[H]=x[H-f];a.setValue(kb.a.Zkb,l);x=c?l[b+f]:l[b-1];a=Object(oa.a)(Wz.TableNode,
a);this.HCl(a,x,l.slice(b,f+b),b,c);if(this.cDb)for(l=this.fYa.create(a),f=b+f,x=(!c||!b)&&b<this.yc.Ai(a)-1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.k5.U3d(a,l,c,0,this.yc.sk(a),x)}PHe(a,b,c,f){super.PHe(a,b,c,f);if(this.cDb){a=Object(oa.a)(173,a);const l=this.fYa.create(a);f=c+f;const x=(!b||!c)&&c<this.yc.sk(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.k5.S3d(a,l,b,0,this.yc.Ai(a),x)}}iHe(a,b,c){super.iHe(a,b,c);this.iPb(a,kb.a.complexTable);this.cDb&&(a=Object(oa.a)(173,a.currentNode),c=this.fYa.create(a),
this.k5.S3d(a,c,b,0,this.yc.Ai(a),!0))}hHe(a,b,c){super.hHe(a,b,c);const f=a.currentNode.eb(kb.a.Zkb),l=Array(f.length-c);let x=0;for(;x<b;x++)l[x]=f[x];for(;x<l.length;x++)l[x]=f[x+c];a.currentNode.setValue(kb.a.Zkb,l);this.iPb(a,kb.a.complexTable);this.cDb&&(a=Object(oa.a)(173,a.currentNode),c=this.fYa.create(a),this.k5.U3d(a,c,b,0,this.yc.sk(a),!0))}oFl(a,b,c){b.setValue(kb.a.DSk,a.eb(kb.a.rowId));b.setValue(kb.a.insertBefore,c)}HCl(a,b,c,f,l){a=a.firstRow;do for(let x=0;x<c.length;++x){const H=
tb.GraphIterator.nb(a),U=H.Zp(f+x,1);U.setValue(kb.a.CSk,b);U.setValue(kb.a.insertBefore,l);U.setValue(kb.a.cellId,c[x]);km.Zqh(H,kb.a.cellId,c[x])}while(a=a.UIa)}jsa(){const a=super.jsa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}OGe(a,b){this.zrj(a,b,c=>{c.currentNode.isGhostCell=!1;Qh.Tx.S8b(c,null,!0);const f=c.currentNode.eb(kb.a.rowId),l=c.currentNode.eb(kb.a.cellId);for(c=Vl.a.qv(c);c.moveNext();){const x=c.currentNode.sa(kb.a.cellId,null);c.currentNode.sa(kb.a.rowId,null)&&c.currentNode.setValue(kb.a.rowId,
f);x&&c.currentNode.setValue(kb.a.cellId,l)}})}dld(a){od.TableReader.Ku(a.currentNode)&&this.ihh(a,b=>b.Lh(kb.a.su),(b,c)=>{b.we(kb.a.su,c)},kb.a.complexTable)}RQe(a){a&&(a=tb.GraphIterator.nb(a),this.dld(a,0))}Hoa(a,b){if(a)for(a=this.Ml.fsa(a),a.em(c=>15===c.ri,null);a.moveNext();){const c=Object(oa.a)(153,a.iterator.currentNode),f=this.iYa.H9a(c);c.setValue(kb.a.su,f*b)}}dLa(a,b){if(a&&14===a.type){const c=this.yJ.MRc(a);for(let f=0;f<c.length;f++){const l=this.Tk.Hsb(a,f);c[f]=Math.max(l,c[f]*
b)}a.setValue($a.a.Zu,c)}}Krh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(kb.a.su,ye.a.OW(b))}Jrh(a,b,c){if(a&&b&&0<b.length){const f=this.yJ.MRc(a);for(let l=0;l<b.length;l++)f[b[l]]=ye.a.OW(c);a.setValue($a.a.Zu,f)}}Cee(a){const b=new tb.GraphIterator;b.Rc(a);var c=b.currentNode;b.Bb(1);const f=a.zc();this.Fza(a);const l=Bs.a.instance.createInstance(393251);this.U8b(a,l,c,c,!1);a.Pk(l);c=this.yc.Ai(f);for(let x=0;x<c;++x){const H=this.jsa();super.tYb(a,H,b.currentNode,!1,!0);this.sed(l,H,
b.currentNode,!1,!0,!0);b.Cf(1)}this.XLb(f,this.yc.sk(f)+1);return a.currentNode}Bee(a){const b=tb.GraphIterator.nb(a.oIh());let c=this.yc.Ai(b.currentNode);var f=this.yJ.LRc(Object(oa.a)(123,a.currentNode));a=f+1;this.Fza(b);b.Bb(1);do{const l=b.Zp(f,1);b.zc();const x=this.jsa();super.J8b(b,x,l,!1,!1);this.sed(b.currentNode,x,l,!1,!1,!0)}while(b.Dj(1));(f=b.currentNode.sa($a.a.Zu,null))&&(f=cb.a.clone(f));this.GLb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue($a.a.Zu,f));this.akc(b.currentNode,
a,!1,1,null)}q4e(a){this.iPb(a,kb.a.complexTable)}Osj(a,b,c){let f=b;const l=b.PIa;if(l)if(b.isGhostCell)Qh.uTc(l,!c)||Qh.Bjb(l.controlCell,c,Qh.owb(l.controlCell,c)+1);else{let x=Qh.owb(b,c);1<x&&(f=Qh.M9i(l,!c));Qh.Bjb(b,c,x+1)}else Qh.Bjb(b,c,2);a.isGhostCell=!0;return f}static Zqh(a,b,c){a.currentNode.we(b,c);let f=a.Gi();if(f){for(;f;)km.Zqh(a,b,c),f=a.jp();a.zc()}}static UEi(){return Zq.IIf(Ug.a.create())}}km.Aaa=null;km.c3c=[5,6,7,0,2,1];Object(m.a)(km,"TableEditor",Qh,[1126]);const IL=(a,
b,c,f,l)=>{const x=l.DY,H=l.Wra;var U=l.tableLook;const ja=0<(U&32);l=0<(U&128);const ya=0<(U&64),Va=0<(U&256),hb=ja?1:0,yb=l?1:0;U=a?a===x-c?ya?3:(a-hb)%2+hb:(a-hb)%2+hb:0;x-c||(U=ja?0:ya?3:(a-hb)%2+hb);a=b?b===H-f?Va?3:(b-yb)%2+yb:(b-yb)%2+yb:0;H-f||(a=l?0:Va?3:(b-yb)%2+yb);return{dCf:U,bCf:a}};class WD{constructor(a){this.H0=a;this.j8c=Array(4);for(a=0;4>a;a++)this.j8c[a]=Array(4)}g_f(a,b,c,f){let l,x;({dCf:l,bCf:x}=IL(a,b,c,f,this.H0));if(!this.j8c[l][x]){c=Object.assign(new kr.a,{ge:b,Of:b+f,
re:a,$f:a+c});a=this.j8c[l];b=x;f=this.H0;var H=f.tableStyle,U=new wm;U.latinField=We.dub(1,0);U.eaField=We.dub(1,1);U.csField=We.dub(1,2);U.solidFillField=Object.assign(new Vu.a,{schemeClrField:Object.assign(new lh.a,{valField:1})});H&&(new lL(U)).NZ(f,c);c=U;H=f.w_j;f=new Rx;H=H||new kL;for(U=1;9>=U;U++){var ja=mL(H,U);const ya=U-1;f.IJe[ya]=ja?xd.a(xd.c(ja)):new vs;ja=f.IJe[ya].defRPrField;f.ftb[ya]=ja?xd.a(xd.c(ja)):new wm}for(H=1;9>=H;H++)nL(f.ftb[H-1],c);a[b]=f}return this.j8c[l][x]}K0f(a,b,
c,f,l){let x=Ib.a.kRa;a&&(b=this.g_f(b,c,f,l))&&b.ftb&&0<b.ftb.length&&(b=b.ftb[0])&&(x=pe.Box4ColorHelper.AKb(b,a));return x}}Object(m.a)(WD,"TableListStyleCache",null,[1125]);class XD{constructor(a,b,c,f){this.QGa=a;this.NUg=b;this.QGa.jk(Object(F.a)(this,this.kh,"onPropertyChanged"));this.QGa.zia(Object(F.a)(this,this.onConnected,"onConnected"));this.Te=c;this.Ewe=f}onConnected(a,b){a=Object(oa.a)(173,b.node);this.NUg.bIh(a)}kh(a,b){a=b.property;b=Object(oa.a)(173,b.node);a===$a.a.Zu?this.NUg.bIh(b):
a===$a.a.iza||a===$a.a.xga||a===$a.a.SA?b.VY=null:!this.Ewe||a!==kb.a.QUa&&a!==kb.a.isResizable&&a!==kb.a.CL||b.sc(this.Te).m5e()}dispose(){this.QGa.Cm(Object(F.a)(this,this.kh,"onPropertyChanged"));this.QGa.joa(Object(F.a)(this,this.onConnected,"onConnected"))}}Object(m.a)(XD,"TableNodeBehavior",null,[106]);var bR=d(187);class Hv{constructor(a,b,c,f,l,x,H,U){this.v0=this.aR=this.In=this.oHa=this.s0=this.bbd=this.IGa=null;this.oeb=this.X8c=0;this.MHg=this.Rfc=this.Yd=this.Ex=null;this.pO=a;this.ia=
c;this.Mq=f;this.Ks=l;this.ZC=x;this.G$=b;this.fq=H;this.Sp=U}UK(){this.v0=this.aR=this.In=this.s0=this.oHa=null;null!==this.fq&&this.fq.Zxa()}Cv(a){if(!a||a.sA===Sys.UI.MouseButton.rightButton||this.pO.J_)return!1;this.Yd=(this.Ex=Object(oa.a)(1118,this.ZC.HI(a.Ec)))?this.Ex.Dk:null;if(!this.Yd)return!1;this.IGa=this.Ex.tsi;if(!this.IGa)return!1;this.aR=this.IGa.Ycg(a.Ec);if(!this.aR)return!1;this.Sp&&this.ia.processAction(D.a.Sja,2);return!0}Tu(a){if(!a||!this.Cv(a))return!1;this.bbd=this.Ex=this.ZC.HI(this.IGa.xa);
if(!this.Ex)return xa.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.processAction(K.a.o7a,2);this.IGa.SD(!0);this.Yd.SD(!0);null!==this.fq&&this.fq.wya(Ri.a.rNb);this.v0=this.bbd.E6b();this.X8c=this.Mq.Qm(hd.a.nm(this.v0.ga(0),this.v0.ga(1)));this.oeb=this.Mq.Qm(hd.a.nm(this.v0.ga(0),this.v0.ga(3)));this.oHa=this.GIf(a.clientPoint);this.s0=new hd.a(0,0);this.In=new Oi.a;this.MHg=new hd.a(this.Yd.x+this.X8c,this.Yd.y+this.oeb);return!0}Cw(a){if(!a)return!1;
a=this.GIf(a.clientPoint);var b=hd.a.bV(a,this.oHa);this.s0=hd.a.add(this.s0,b);b=Yk.HTd(this.aR,this.v0,this.s0,!1,!1);this.In=Object.assign(new Oi.a,{bottom:this.Mq.Qm(b.bottom),left:this.Mq.Qm(b.left),right:this.Mq.Qm(b.right),top:this.Mq.Qm(b.top)});let c;({eKh:b,iKh:c}=this.vCf());const f=new bR.a;f.lca(b,c);f.eC(this.In.left,this.In.top);this.IGa.Qq(f);this.oHa=a;return!0}ao(a){let b=null;a&&(b=this.G$.Ci("UserAction","PPTTableResize"),xa.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",
this.Ex.gb.sa(kb.a.iGb,""),od.TableReader.Ku(this.Ex.gb))));this.IGa.Uz(!1);({eKh:l,iKh:x}=this.vCf());this.Ex.Nrh(l,x);this.x0e();const c=new pf.GraphTransaction(15);c.kd(this.Ex.gb);var f=this.Ex.Md.Ld;this.Ks.xSe(Object(oa.a)(Wz.TableNode,this.Ex.gb),l,x,this.bbd,f);if(Hv.cFa(this.aR)||Hv.cFa(this.aR,!0)){var l=this.Ex.Dk.shapeNode;var x=f.rf(this.Yd.x,0);f=f.rf(this.Yd.y,1);l.wy=x;l.yy=f}this.Yd.Uz(!1);c.dispose();this.UK();Oc.App.Kb.updateCommandUI();b&&b.stop();a&&xa.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",
this.Ex.gb.sa(kb.a.iGb,""),od.TableReader.Ku(this.Ex.gb)))}x0e(){var a=Hv.cFa(this.aR),b=Hv.cFa(this.aR,!0);if(a||b){b=this.bbd.E6b();a=this.Mq.Qm(b.$b-b.hc);b=this.Mq.Qm(b.Yb-b.kc);const c=this.MHg;c._x+=this.In.right;c._y+=this.In.bottom;this.Yd.setPosition(c.x-a,c.y-b,!0)}}ou(){this.s0&&(this.IGa.Uz(!0),this.IGa.Qq(null),this.Yd.Uz(!0),this.UK())}vCf(){return{eKh:this.X8c?1+(this.In.right-this.In.left)/this.X8c:1,iKh:this.oeb?1+(this.In.bottom-this.In.top)/this.oeb:1}}GIf(a){a=hd.a.uSa(a);var b=
this.aR;this.aR.t9b()||(b=b.Ywb());const c=this.v0.rk(b);b=this.v0.rk(b.T8a());return a=new hd.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static cFa(a,b=!1){return a.equals(te.a.Qu)?!0:b?a.equals(te.a.north)||a.equals(te.a.DE):a.equals(te.a.west)||a.equals(te.a.PH)}}Object(m.a)(Hv,"TableResizeDragAdapter",null,[240]);class YD{constructor(a,b){this.H0=a;this.zFb=b;this.ji=Array(4);for(a=0;4>a;a++)this.ji[a]=Array(4);this.nDe=Array(16)}M5d(a,b,c,f){let l,
x;({dCf:l,bCf:x}=IL(a,b,c,f,this.H0));this.ji[l][x]||(this.ji[l][x]=this.zFb.b2k(this.H0,a,b,c,f));c=this.ji[l][x].clone();if(a=this.moj(a,b))for(const H of a.$z())c.Sa(H)||c.we(H,a.Lh(H));return c}clear(){for(let a=0;4>a;a++)this.ji[a]=Array(4);this.nDe=Array(16)}moj(a,b){var c=a===this.H0.DY-1;const f=b===this.H0.Wra-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.nDe[l])||(this.nDe[l]=c=this.zFb.w2k(this.H0,a,b));return c}}Object(m.a)(YD,"TableStyleCache",null,[1124]);class JL{constructor(a){this.fXa=
a}b2k(a,b,c,f,l){const x=a.DY;var H=a.Wra,U=a.tableLook;const ja=a.tableStyle;a=a.ke;const ya=new lq.a,Va=0<(U&32),hb=0<(U&128),yb=!b&&Va,Zb=!c&&hb;f=b===x-f&&0<(U&64);l=c===H-l&&0<(U&256);H=!(U&512)&&!yb&&!f;U=!(U&1024)&&!Zb&&!l;this.x2k(ja.wholeTblField,ya);H&&this.fya((Va?1!==(b&1):b&1)?ja.band2HField:ja.band1HField,a,ya);U&&this.fya((hb?1!==(c&1):c&1)?ja.band2VField:ja.band1VField,a,ya);l&&this.fya(ja.lastColField,a,ya);Zb&&this.fya(ja.firstColField,a,ya);f&&(this.fya(ja.lastRowField,a,ya),l&&
this.fya(ja.seCellField,a,ya),Zb&&this.fya(ja.swCellField,a,ya));yb&&(this.fya(ja.firstRowField,a,ya),l&&this.fya(ja.neCellField,a,ya),Zb&&this.fya(ja.nwCellField,a,ya));return ya}w2k(a,b,c){var f=a.DY;const l=a.Wra;var x=a.tableStyle;a=a.ke;const H=new lq.a;if(x&&0<=b&&b<f&&0<=c&&c<l){const U=!c;f=b===f-1;c=c===l-1;(x=x.wholeTblField)&&x.tcStyleField&&(x=x.tcStyleField.tcBdrField)&&(this.v_a(7,b?x.insideHField:x.topField,a,H),this.v_a(0,f?x.bottomField:x.insideHField,a,H),this.v_a(5,U?x.leftField:
x.insideVField,a,H),this.v_a(6,c?x.rightField:x.insideVField,a,H))}return H}glh(a,b,c){const f=new lq.a;this.dlh(a,c,b,f);return f}x2k(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.we(kb.a.cellShading,a.tcStyleField.fillField)}fya(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.we(kb.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.v_a(7,a.topField,b,c),this.v_a(0,a.bottomField,b,c),this.v_a(5,a.leftField,b,c),this.v_a(6,a.rightField,b,c))}v_a(a,b,c,f){b&&b.itemField&&
this.dlh(a,b.itemField,c,f)}dlh(a,b,c,f){let l;({gQa:l,F6a:a}=Rp.eTa(a));b.wFieldSpecified&&f.we(l,ye.a.W0d(b.wField));if(b.solidFillField)if(this.fXa)f.we(a,b.solidFillField);else{if(b=pe.Box4ColorHelper.Tib(b.solidFillField,c))b=pe.Box4ColorHelper.epa(b),f.we(a,b)}else b.noFillField&&(this.fXa&&Ud.a("TableBordersLocalRenderingFix")?(b=pe.Box4ColorHelper.oV({Color:"##T,0,0,0"}),f.we(a,b),f.we(l,0)):f.we(a,Ib.a.kRa))}}Object(m.a)(JL,"TableStyleResolver",null,[286]);var KL=d(329),ZD=d(188);class Tx{constructor(a,
b,c,f=null){this.Qwa=!1;this.iB=this.Zn=this.rb=this.Rtg=this.MWg=null;this.WC=[];this.Hk=this.iA=!1;this.D0=null;this.Ro=this.ydb=!1;this.Ea=b;this.iIg=a;this.Zc=f;this.$T=(this.s6c=c)?10:6;this.bBe=c?2:Mf.a.RE}get visible(){return this.Qwa}set visible(a){this.Qwa!==a&&(this.Qwa=a,this.jrh())}get xa(){return this.rb.viewport.xa}iii(a,b,c){this.MWg=a;this.Rtg=c;this.Jm();this.Zc.pb(ta.a.click,this.xa,Object(F.a)(this,this.n0g,"notifySelectShapeByClick"));b.appendChild(this.rb.viewport);this.MWg.MM(this.xa,
!0);this.ydb=!0;this.setZIndex(2+tD.a.jba+1)}aFh(){this.ydb&&this.rb&&this.Zc.yb(ta.a.click,this.xa,Object(F.a)(this,this.n0g,"notifySelectShapeByClick"));this.ydb=!1}setZIndex(a){this.ydb&&this.rb.LB(a)}Jm(){this.rb||(this.rb=new ZD.a,this.Zn=new om.a,this.Zn.OE(Pk.a.none),this.Zn.Yu(Mf.a.A1),this.Zn.mr(Mf.a.RE),this.rb.nl(Ri.a.DA),this.rb.appendChild(this.Zn),this.iB=new Jm.a,this.y1b(this.iB),this.rb.appendChild(this.iB),this.rb.Qd(!1),this.rb.viewport.xa.setAttribute(Pk.a.$Hb,Pk.a.none))}Rl(){if(this.ydb){var a=
this.yij(this.Rtg);this.iA?(this.D0&&this.D0.El(a),this.Zn.zt(a.points)):(a=a.points,this.Zn.zt(a),a=new ei.a(a[0],a[1],a[2],a[3]));this.uY(a);this.rb.Rl()}}y1b(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new Jm.a;l.xa.id=b;if(B.a.BLa){var c=new KL.a;c.xa.id=b;c.xa.setAttribute("class",Jk.a.gsd);c.setVisibility(!1);c.setPosition(-10,-10);c.lh(20,20);l.appendChild(c)}c=new KL.a;c.xa.id=b;c.xa.setAttribute("class",Jk.a.gsd);b=this.$T/2*-1;c.setPosition(b,b);c.lh(this.$T,this.$T);this.s6c&&
c.mrh(this.$T/2,this.$T/2);c.OE("white");c.Yu(Mf.a.A1);c.mr(this.bBe);c.Frh();l.appendChild(c);l.Yj(1);this.WC[f]=l;a.appendChild(l)}}uY(a){for(let b=0;8>b;++b){const c=this.WC[b];c.nl(Tx.qpc[b]);this.VKa(c,a.rk(new te.a(b)))}}yij(a){return new ei.a(new hd.a(0,0),new hd.a(a.offsetWidth,0),new hd.a(a.offsetWidth,a.offsetHeight),new hd.a(0,a.offsetHeight))}NE(a){this.Ro||((this.iA=a)?(this.Zn.OE(Mf.a.fQf),this.Zn.Yu(Mf.a.A1),this.Zn.mr(Mf.a.RE),this.iB.Qd(!1),this.iIg.endEditing(!0,14)):(this.Zn.OE(Pk.a.none),
this.Zn.Yu(Mf.a.A1),this.Zn.mr(Mf.a.RE),this.iB.Qd(!0),this.Ea.tf(zb.a.sg),this.iIg.QR()))}dispose(){this.Hk||(this.aFh(),this.Zn=this.rb=null,Array.clear(this.WC),this.iB=null,this.ydb=!1,this.Hk=!0)}Ycg(a){if(!this.ydb)return null;for(let b=0;8>b;++b)if(this.WC[b].xa.id===a.id)return new te.a(b);return null}VKa(a,b){a.setPosition(b.x,b.y)}n0g(a){return this.Ycg(a.Ec)?!0:!1}SD(a){this.NE(!0,a)}Uz(){this.NE(!1)}Qq(a){this.D0&&this.D0.clear();this.D0=a;this.Rl()}Ox(a){this.Ro=a;this.jrh()}jrh(){this.rb&&
this.rb.Qd(!this.Ro&&this.Qwa)}static j1b(a){return new Tx(a,Db.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,u.AFrameworkApplication.Aa.Iy)}}Tx.qpc=[Ri.a.I_e,Ri.a.H_e,Ri.a.G_e,Ri.a.F_e,Ri.a.J_e,Ri.a.K_e,Ri.a.L_e,Ri.a.M_e];Object(m.a)(Tx,"DraggablePandoraChromeView",null,[1120]);class LL{}Object(m.a)(LL,"TableStyleCategoryInfo",null,[]);class Nf{static FSi(){if(Nf.ah)return Nf.ah;Nf.ah=new Yc.a;
Nf.ah.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);Nf.ah.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));Nf.ah.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));Nf.ah.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));Nf.ah.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,4));Nf.ah.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));Nf.ah.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));Nf.ah.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);Nf.ah.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));Nf.ah.$("Themed Style 2 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));Nf.ah.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));Nf.ah.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));Nf.ah.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));Nf.ah.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,6));Nf.ah.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));Nf.ah.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));Nf.ah.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));Nf.ah.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,3));Nf.ah.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));Nf.ah.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));Nf.ah.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));Nf.ah.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));Nf.ah.$("Light Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));Nf.ah.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));Nf.ah.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));Nf.ah.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));Nf.ah.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,5));Nf.ah.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));Nf.ah.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));Nf.ah.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));Nf.ah.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,2));Nf.ah.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));Nf.ah.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));Nf.ah.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));Nf.ah.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));Nf.ah.$("Medium Style 1",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));Nf.ah.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));Nf.ah.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));Nf.ah.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));Nf.ah.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,4));Nf.ah.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));Nf.ah.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));Nf.ah.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));Nf.ah.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,1));Nf.ah.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));Nf.ah.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));Nf.ah.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));Nf.ah.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));
Nf.ah.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));Nf.ah.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));Nf.ah.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));Nf.ah.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));Nf.ah.$("Medium Style 3 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));Nf.ah.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));Nf.ah.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));Nf.ah.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));Nf.ah.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleMedium,4));Nf.ah.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));Nf.ah.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));Nf.ah.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));Nf.ah.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,4));Nf.ah.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));Nf.ah.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));Nf.ah.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Nf.ah.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));Nf.ah.$("Dark Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));Nf.ah.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));Nf.ah.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));Nf.ah.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));Nf.ah.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,6));Nf.ah.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Nf.ah.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));Nf.ah.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));Nf.ah.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,4,5));return Nf.ah}static E7f(a){const b=Nf.FSi();return b.Hb(a)?b.ga(a):a}}Nf.ah=null;Object(m.a)(Nf,"TableStyleNameReader",null,[]);class ML{constructor(a){this.ixg=!1;this.zBb=[];this.Fve=new Rd.a(0);this.hqe=[];this.CRg=a}p1d(){this.ixg||(this.ixg=this.tFk())}tFk(){const a=this.CRg.instance?this.CRg.instance.wtl:null;if(a&&a.tblStyleCategoriesField){let b=0;this.zBb=[];this.Fve=new Rd.a(0);this.hqe=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=
a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.hqe,Object.assign(new LL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const x=f.tblStylesField[l],H=new J.DictionaryPropertySet,U=new SD(x,f.idField,l);H.we(kb.a.tableStyle,U);this.zBb.push(H);this.Fve.$(x.styleIdField.toLowerCase(),b++)}}}return!0}return!1}hRc(){return this.zBb}yxb(a){return 0<=a&&a<this.zBb.length?this.zBb[a]:null}Hkj(a,b){let c=null;
for(const f of this.hqe)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.yxb(a):null}Rkj(a){return this.A6b(a).$X.styleIdField}Skj(a){return(a=this.A6b(a).$X.styleNameField)?Ud.a("TableStyleNameLocalization")?Nf.E7f(a):a:""}Kkj(a){return this.A6b(a).Etg}A6b(a){return a.Lh(kb.a.tableStyle)}D7f(a){return(a=this.Ilj(a))?a.Lh(kb.a.tableStyle):null}Ilj(a){this.p1d();return this.zBb[this.Fve.ga(a.toLowerCase())]}}Object(m.a)(ML,"TableStyleGalleryManager",null,[287]);class NL{constructor(a,b,
c,f,l){this.ML=0;f||(f=Object.assign(new kr.a,{re:0,$f:c.UO,ge:0,Of:c.xR}));this.qqe=a;this.Ygk=b;this.Rma=c;this.sE=f;this.dA=new kr.a;this.HO=this.ML=-1;this.i5c=l}get Hlg(){return-1===this.HO||-1===this.ML}moveNext(){this.Hlg&&(this.HO=this.sE.re,this.dA.Of=this.sE.ge);for(;;){this.ML=this.dA.Of;if(this.ML>=this.sE.Of&&(this.ML=this.sE.ge,++this.HO>=this.sE.$f))return this.reset(),!1;this.dA=this.qqe.CI(this.Rma,this.HO,this.ML);if(this.HO===this.sE.re||this.HO===this.dA.re)if(!this.i5c||this.i5c.KNd(this))return!0}}Tmk(){this.Hlg&&
(this.ML=this.sE.ge,this.dA.$f=this.sE.re);for(;;){this.HO=this.dA.$f;if(this.HO>=this.sE.$f&&(this.HO=this.sE.re,++this.ML>=this.sE.Of)){this.reset();break}this.dA=this.qqe.CI(this.Rma,this.HO,this.ML);if(this.ML===this.sE.ge||this.ML===this.dA.ge)if(!this.i5c||this.i5c.KNd(this))break}}moveTo(a,b){this.dA=this.qqe.CI(this.Rma,a,b);if(!this.dA.eVi(this.sE))return this.reset(),!1;this.HO=Math.min(Math.max(a,this.sE.re),this.sE.$f-1);this.ML=Math.min(Math.max(b,this.sE.ge),this.sE.Of-1);return!0}reset(){this.HO=
this.ML=-1}f5b(){return this.Ygk.qf(this.dA.re,this.dA.ge)}}Object(m.a)(NL,"CellIterator",null,[1192]);class OL{constructor(a){this.Kq=a}xDa(a,b,c,f=null){return new NL(this.Kq,a,b,c,f)}}Object(m.a)(OL,"CellIteratorFactory",null,[281]);class $D{constructor(a,b,c){this.Kq=b;this.Rma=c;this.PC=this.Kq.dPc(this.Rma,a.sE);this.y9=Array(this.PC.xR*(this.PC.UO+1));this.HO=this.PC.re;this.scb=this.PC.ge;this.EBb=this.PC.ge-1;this.Lq=0;this.cee(a)}cee(a){const b=a.sE;for(;a.moveNext();){const f=a.dA;for(let l=
f.ge;l<f.Of;l++){var c=this.SDa(f.re,l);this.y9[c]=0!==this.y9[c]?2:l<b.ge&&f.re>b.re?16:l>=b.Of&&f.re>b.re?64:1;c=this.SDa(f.$f,l);this.y9[c]=0!==this.y9[c]?2:l<b.ge&&f.$f<b.$f?16:l>=b.Of&&f.$f<b.$f?64:4}}}SDa(a,b){return this.PC.xR*(a-this.PC.re)+(b-this.PC.ge)}moveNext(){this.scb=this.EBb;do{this.scb++;this.scb>=this.PC.Of&&(this.HO++,this.scb=this.PC.ge);if(this.HO>this.PC.$f)return!1;this.Lq=this.y9[this.SDa(this.HO,this.scb)]}while(0===this.Lq);for(this.EBb=this.scb;this.EBb+1<this.PC.Of&&this.y9[this.SDa(this.HO,
this.EBb+1)]===this.Lq;)this.EBb++;return!0}s5i(){return this.EBb+1}r9a(){return this.Lq}static Qie(a){return!!(a&87)}}Object(m.a)($D,"HorizontalTableBorderIterator",null,[1190,403]);class PL{constructor(a){this.Kq=a}SDi(a,b){return new $D(a,this.Kq,b)}}Object(m.a)(PL,"HorizontalTableBorderIteratorFactory",null,[282]);var Xz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=
4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Xz||(Xz={}));Object(m.b)("LayoutInvalidateTrigger",Xz);class QL{constructor(){this.dja=this.ASd=this.Ctc=
this.KWd=0}get rowSpan(){return this.ASd-this.Ctc}toString(){return String.format("C[{0}][{1}]",this.Ctc,this.dja)}}Object(m.a)(QL,"CellInfo",null,[]);class lr{constructor(){this.sYc=!1;this.Uc=this.QDf=this.telemetry=null;this.Hbb=this.drc=!1;this.isd=null;this.uYg=0;this.tableNode=this.zne=this.Wya=null;this.C2d=!1}}Object(m.a)(lr,"LayoutContext",null,[]);class RL{constructor(){this.Dwh=this.Cvd=0}}Object(m.a)(RL,"LayoutTelemtry",null,[]);class aE{constructor(){this.offset=this.Tic=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",
this.index,this.Tic,this.offset)}}Object(m.a)(aE,"RowSeamInfo",null,[]);class Kh{constructor(a,b,c,f,l,x,H){this.VC=null;this.JCb=[];this.cIa=[];this.GX=0;this.Hk=this.X7c=!1;this.Ceb=null;this.V6c=!1;this.a8c=0;this.Qf=null;this.vz=a;this.zb=f;this.Tk=x;this.Qb=c;this.YX=H;this.X8b(1)}xHj(a,b){if(!this.X7c&&!this.V6c)try{2!==this.GX&&(1===this.GX?this.JCb[0]!==a&&this.X8b(b):(this.JCb[this.JCb.length]=a,this.GX=1,this.a8c=b))}catch(c){this.X8b(0),xa.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",
c.toString())}}X8b(a){this.V6c||2===this.GX||this.X7c||(this.GX=2,this.JCb=[],this.a8c=a)}Ybe(){return 0!==this.GX&&!this.X7c}get YXc(){return this.GX}TGh(a){this.Ybe()&&(a=Object.assign(new lr,{tableNode:a}),this.layout(a))}hEl(a,b){this.Ybe()?this.Ceb||(this.Ceb=new af.a(3,1,0,Object(F.a)(this,this.lEk,"performLayout"),90,"9"),this.Ceb.customData=Object.assign(new lr,{tableNode:a,sYc:!0,zne:b}),this.zb.Db(this.Ceb)):b&&b(!1)}lEk(a){this.layout(Object(oa.a)(lr,a.customData))}layout(a){this.V6c=!0;
const b=new Xh.a(null,Object(F.a)(this,this.LEj,"initializeLayoutState"),a);b.Oi=!a.sYc;b.run()}LEj(a,b){b=Object(oa.a)(lr,b);try{this.bSi();b.Uc=this.Qf;b.telemetry=new RL;this.hIl();if(!this.Ybe())return a.Wg(Object(F.a)(this,this.oza,"tearDownLayout")),!0;this.GX=0;if(!b.tableNode.isConnected)return a.Wg(Object(F.a)(this,this.oza,"tearDownLayout")),!0;const c=Object(oa.a)(1118,b.tableNode.sc(this.vz));if(!c)return a.Wg(Object(F.a)(this,this.oza,"tearDownLayout")),!0;b.isd=c;b.Uc.Va(Kh.lgi,b.sYc.toString());
b.tableNode.Lp()?(b.Uc.Va(Kh.dpg,Xz[this.a8c]),a.Wg(Object(F.a)(this,this.NIk,"prepareTableMetrics"))):(b.Uc.Va(Kh.dpg,"tableComplexityChange"),b.drc=!0,b.Hbb=!0,a.Wg(Object(F.a)(this,this.oza,"tearDownLayout")))}catch(c){b.Uc.Va(Kh.Qac,c.message),a.Wg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}NIk(a,b){b=Object(oa.a)(lr,b);try{b.Wya=new Date,this.YX.mbh(b.tableNode,this.vz),b.Uc.Va(Kh.IIk,(+new Date-+b.Wya).toString()),b.Uc.Va(Kh.Zlk,this.YX.ELj.toString()),a.Wg(Object(F.a)(this,this.oZj,
"layoutBaselineTable"))}catch(c){b.Uc.Va(Kh.Qac,c.message),a.Wg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}oZj(a,b){b=Object(oa.a)(lr,b);try{b.Wya=new Date;b.C2d=!0;b.uYg=Kh.glk;this.VC=[];this.VC[this.VC.length]=Object.assign(new aE,{index:0,Tic:0,offset:0});const c=new ke.a(this.vz);c.set(b.tableNode);if(!c.Bb(1))throw Error.invalidOperation(Kh.UUf);const f=b.tableNode;let l=c.currentNode,x=l,H=0,U=0,ja=0;for(;l;){15===l.type&&(x=l,ja=H=0,l=c.Bb(1));const ya=l;if(!ya)throw xa.a.J(512495690,
808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===ya.rowSpan){const Va=Object(oa.a)(bt,l.sc(this.vz));H=Math.max(H,this.YX.g5b(f,Va.hja,U,ja))}l=c.Dj(1);ja++;if(!l){const Va=Object.assign(new aE,{index:this.VC.length});let hb=x.sa(kb.a.su,0);hb=Math.max(hb,this.Tk.PIc(x));let yb=b.isd.Md.Ld.Pe(hb,1);yb=Math.max(yb,H);Va.offset=yb+this.VC[Va.index-1].offset;Va.Tic=yb;this.VC[this.VC.length]=Va;l=c.Cf(1);U++}}a.Wg(Object(F.a)(this,
this.tZj,"layoutRowSeams"));b.Uc.Va(Kh.rZj,(+new Date-+b.Wya).toString())}catch(c){b.Uc.Va(Kh.Qac,c.message),b.drc=!0,a.Wg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}tZj(a,b){b=Object(oa.a)(lr,b);try{if(1===this.VC.length)throw Error.create(Kh.TVi);let c=b.QDf;if(!c){b.Wya=new Date;c=new ke.a(this.vz);c.set(b.tableNode);if(!c.Bb(1))throw Error.invalidOperation(Kh.UUf);b.QDf=c}const f=b.tableNode;let l=c.currentNode,x=0,H=0,U=0;for(;l&&x<b.uYg;){15===l.type&&(l=c.Bb(1),H=0);const ja=l;if(!ja)throw xa.a.J(512495687,
808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");x++;b.telemetry.Cvd++;1===ja.rowSpan||gj.OutlineReader.isEmpty(c)?b.telemetry.Dwh++:this.vZj(this.lCi(f,ja,U,H),b.Uc);l=c.Dj(1);H++;l||(l=c.Cf(1),U++)}l||(this.ssl(),a.Wg(Object(F.a)(this,this.xZi,"fixupTableMinRowHeight")),b.Uc.Va(Kh.uZj,(+new Date-+b.Wya).toString()))}catch(c){b.Uc.Va(Kh.Qac,c.message),b.drc=!0,a.Wg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}xZi(a,b){b=
Object(oa.a)(lr,b);try{const l=b.isd;b.Wya=new Date;const x=[];var c=new ke.a(this.vz);c.set(b.tableNode);for(var f=c.Bb(1);f;)x[x.length]=c.Xq,f=c.Dj(1);if(this.cIa.length===x.length){c=[];for(f=0;f<x.length;++f)c[f]=0,1<Math.abs(this.cIa[f]-x[f].htmlElement.offsetHeight)&&(c[f]=this.cIa[f]);for(f=0;f<c.length;++f)0<c[f]&&x[f].lMb(c[f]*l.f9d())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.cIa.length,x.length));a.Wg(Object(F.a)(this,this.oza,"tearDownLayout"));b.Uc.Va(Kh.tZi,
(+new Date-+b.Wya).toString());b.Hbb=!0}catch(l){b.Uc.Va(Kh.Qac,l.message),b.drc=!0,a.Wg(Object(F.a)(this,this.oza,"tearDownLayout"))}return!0}oza(a,b){a=Object(oa.a)(lr,b);a.Wya=new Date;a.drc?(this.S2k(a.Uc,a.tableNode,a.isd),a.C2d=!0):a.Uc&&(a.Uc.Va(Kh.xZj,a.telemetry.Cvd.toString()),a.Uc.Va(Kh.wZj,a.telemetry.Dwh.toString()));this.Ceb&&!a.sYc&&this.zb.Lg(this.Ceb);this.V6c=!1;this.Ceb=null;this.a8c=0;a.Uc&&(a.Uc.Va(Kh.Hbb,a.Hbb.toString()),!a.Hbb&&a.Uc&&a.Uc.Va(Kh.tableLayout,this.YX.z0d(a.tableNode)),
a.Uc.Va(Kh.Utl,(+new Date-+a.Wya).toString()),a.Uc.finish());a.Hbb||(this.X7c=!0);this.VC=null;this.JCb=[];this.Qf=null;this.YX.reset();a.zne&&a.zne(a.C2d);return!1}S2k(a,b,c){if(b.isConnected)try{const f=new ke.a(this.vz);f.set(b);let l=f.Bb(1);for(;l;){const x=Object(oa.a)(Gv,f.gRa);if(!x)throw Error.argument("tableRowViewElement");let H=c.Md.Ld.Pe(l.sa(kb.a.su,0),1);const U=c.f9d();H*=U;x.lMb(H);l=f.Dj(1)}}catch(f){a&&a.Va(Kh.R2k,f.message)}}vZj(a,b){if(!a)throw Error.create(Kh.SVi);var c=this.VC[a.Ctc];
const f=this.VC[a.ASd];c=Math.max(this.Pcj(c,f),a.KWd)-(f.offset-c.offset);if(!(0>=c)&&(this.nci(f.index,c),f.offset<=this.VC[f.index-1].offset)){b.Va(Kh.aqi,a.toString());for(a=0;a<=f.index;++a)b.Va(Kh.t6k,this.VC[a].toString());throw Error.create(Kh.UVi);}}ssl(){if(this.VC){this.cIa=[];for(let a=1;a<this.VC.length;++a)this.cIa[this.cIa.length]=this.VC[a].offset-this.VC[a-1].offset}else this.cIa=null}nci(a,b){if(b)for(var c=a,f=0;c<this.VC.length;){b=c===a?b:b+this.VC[c].Tic-this.VC[c].offset+f;
if(0>=b)break;f=this.VC[c].offset;this.VC[c].offset+=b;c++}}Pcj(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.VC[a+1].Tic,a++;return c}lCi(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(oa.a)(bt,b.sc(this.vz)),x=this.Qb.Nc(b);x.rc(14);a=Object.assign(new QL,{KWd:this.YX.g5b(a,l.hja,c,f),Ctc:tk.c(x),dja:f});a.ASd=a.Ctc+b.rowSpan;return a}dispose(){this.Hk||(this.JCb=this.VC=this.cIa=null,this.GX=0,this.Hk=!0)}hIl(){if(this.Hk)throw Error.invalidOperation("table layout service is already disposed");
}bSi(){this.Qf||(this.Qf=Tc.a.yk("TableLayout"))}get Ma(){return this.vz}}Kh.glk=25;Kh.Qac="FailureReason";Kh.R2k="RestoreFailureReason";Kh.tableLayout="Layout";Kh.t6k="SI";Kh.aqi="CI";Kh.lgi="FAsync";Kh.xZj="CellVisited";Kh.wZj="CellSkipped";Kh.Hbb="Succeeded";Kh.rZj="LETD";Kh.uZj="LRST";Kh.tZi="FMTR";Kh.Utl="TDLD";Kh.IIk="PM";Kh.dpg="Trigger";Kh.Zlk="MC";Kh.SVi="CellDisconnected";Kh.TVi="ChildOfTableNotLoaded";Kh.UVi="SeamPositionInvariant";Kh.UUf="NoRowViewElement";Object(m.a)(Kh,"PPTTableLayoutService",
null,[1191,106]);class SL{constructor(a,b,c,f,l){this.Qb=a;this.zb=b;this.bhk=c;this.Tk=f;this.YX=l}create(a,b){return new Kh(a,b,this.Qb,this.zb,this.bhk,this.Tk,this.YX)}}Object(m.a)(SL,"PPTTableLayoutServiceFactory",null,[289]);class TL{constructor(a,b,c,f,l,x,H,U,ja){this.dek=a;this.Po=b;this.Qb=c;this.hYa=f;this.RUg=l;this.Dfb=x;this.bgc=H;this.lq=U;this.p6c=!0;this.rwe=ja;this.Lva=new Yc.a;this.Po.RF&&!this.Po.Tj&&(this.p6c=!1);this.p6c&&(this.hYa.nPd(Object(F.a)(this,this.R1g,"onBeforeTableViewElementDisconnected")),
this.hYa.zia(Object(F.a)(this,this.J6g,"onTableNodeConnected")),this.hYa.jk(Object(F.a)(this,this.L6g,"onTableNodePropertyChanged")),this.hYa.N7(Object(F.a)(this,this.K6g,"onTableNodeDisconnected")),this.RUg.jk(Object(F.a)(this,this.N6g,"onTableRowNodePropertyChanged")),this.Dfb.jk(Object(F.a)(this,this.pgd,"onTableCellNodePropertyChanged")),this.Dfb.vF(Object(F.a)(this,this.I6g,"onTableCellNodeChildTopoChanged")),this.bgc.jk(Object(F.a)(this,this.P4g,"onParagraphNodePropertyChanged")),this.lq.Vai(Object(F.a)(this,
this.h6g,"onSlideInvalidateRenderSize")))}fUc(a,b){if(!this.p6c)return null;var c=a.id.toString();this.Lva.Hb(c)||this.Lva.$(c,new yo.a);c=this.Lva.ga(c);var f=a.Lp();f=this.rwe?f&&od.TableReader.WHf(Object(oa.a)(tb.GraphIterator,this.Qb.Nc(a))):f;if(c.Hb(b))return b=c.ga(b),f||0!==b.YXc||(this.Ahh(a),b=null),b;if(f)c.$(b,this.dek.create(b,a.id));else return null;return c.ga(b)}Myb(a,b,c){a.Lp()?this.Bfg(a.id.toString(),b,c):10===c&&this.Bfg(a.id.toString(),b,c)}Bfg(a,b,c){if(this.Lva.Hb(a))for(let f of this.Lva.ga(a).values)b?
f.xHj(b,c):f.X8b(c)}Jhe(a,b,c){a.isConnected&&(a=this.Qb.Nc(a),a.rc(14)&&this.Myb(a.Pw(14),b,c))}pHj(a){a.isConnected&&(a=this.Qb.Nc(a),a.rc(14)&&this.Myb(a.Pw(14),a.Pw(16),2))}R1g(a,b){b.Yr.Qc.lp&&this.Myb(b.Yr.gb,null,9)}J6g(a,b){this.Myb(b.node,null,8);a=Object(oa.a)(Wz.TableNode,b.node);a=!!a&&a.Lp();xa.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}K6g(a,b){this.Ahh(b.node)}Ahh(a){a=a.id.toString();if(this.Lva.Hb(a)){const b=this.Lva.ga(a);for(let c of b.values)c&&c.dispose();this.Lva.remove(a)}}L6g(a,
b){a=b.property;b.node.isConnected&&(a===$a.a.Zu||a===$a.a.xga||a===$a.a.SA||a===kb.a.Zkb||a===kb.a.cid||a===kb.a.jza||a===kb.a.Bsc?this.Myb(b.node,null,7):a===kb.a.complexTable&&this.Myb(b.node,null,10))}N6g(a,b){a=b.property;b.node.isConnected&&a===kb.a.su&&this.Jhe(b.node,null,4)}pgd(a,b){a=b.property;!b.node.isConnected||a!==kb.a.rowSpan&&a!==kb.a.colSpan||this.Jhe(b.node,null,5)}I6g(a,b){b.node.isConnected&&1===b.TZ&&this.Jhe(b.node,b.node,3)}P4g(a,b){a=Object(oa.a)(5,b.node);b=b.property;a&&
a.isConnected&&a.Sa(kb.a.cellId)&&!a.Hmc&&(b===$a.a.pq||b===$a.a.flb)&&this.pHj(a)}h6g(){for(let a of this.Lva.keys)for(let b of this.Lva.ga(a).values)b.X8b(11)}dispose(){this.p6c&&(this.hYa.XQe(Object(F.a)(this,this.R1g,"onBeforeTableViewElementDisconnected")),this.hYa.joa(Object(F.a)(this,this.J6g,"onTableNodeConnected")),this.hYa.Cm(Object(F.a)(this,this.L6g,"onTableNodePropertyChanged")),this.hYa.sKa(Object(F.a)(this,this.K6g,"onTableNodeDisconnected")),this.RUg.Cm(Object(F.a)(this,this.N6g,"onTableRowNodePropertyChanged")),
this.Dfb.Cm(Object(F.a)(this,this.pgd,"onTableCellNodePropertyChanged")),this.Dfb.bP(Object(F.a)(this,this.I6g,"onTableCellNodeChildTopoChanged")),this.bgc.Cm(Object(F.a)(this,this.P4g,"onParagraphNodePropertyChanged")),this.lq.PZk(Object(F.a)(this,this.h6g,"onSlideInvalidateRenderSize")))}}Object(m.a)(TL,"PPTTableLayoutServiceManager",null,[290,106]);class bE{constructor(a,b,c){this.Kq=b;this.Rma=c;this.PC=this.Kq.dPc(this.Rma,a.sE);this.y9=Array(this.PC.UO*(this.PC.xR+1));this.ML=this.PC.ge;this.dfb=
this.PC.re;this.WEb=this.PC.re-1;this.Lq=0;this.cee(a)}cee(a){const b=a.sE;for(;a.moveNext();){const f=a.dA;for(let l=f.re;l<f.$f;l++){var c=this.SDa(l,f.ge);this.y9[c]=0!==this.y9[c]?32:l<b.re&&f.ge>b.ge?1:l>=b.$f&&f.ge>b.ge?4:16;c=this.SDa(l,f.Of);this.y9[c]=0!==this.y9[c]?32:l<b.re&&f.Of<b.Of?1:l>=b.$f&&f.Of<b.Of?4:64}}}SDa(a,b){return this.PC.UO*(b-this.PC.ge)+(a-this.PC.re)}moveNext(){this.dfb=this.WEb;do{this.dfb++;this.dfb>=this.PC.$f&&(this.ML++,this.dfb=this.PC.re);if(this.ML>this.PC.Of)return!1;
this.Lq=this.y9[this.SDa(this.dfb,this.ML)]}while(0===this.Lq);for(this.WEb=this.dfb;this.WEb+1<this.PC.$f&&this.y9[this.SDa(this.WEb+1,this.ML)]===this.Lq;)this.WEb++;return!0}xhj(){return this.WEb+1}r9a(){return this.Lq}static Qie(a){return!!(a&117)}}Object(m.a)(bE,"VerticalTableBorderIterator",null,[402,403]);class zl{constructor(a,b,c,f,l,x,H){this.Tk=a;this.Kq=b;this.Qb=c;this.qA=f;this.pea=l;this.p9j=x;this.Bik=H}DCl(a,b,c){const f=b.getContainingTable();f&&(this.Gyl(b,f,a,c.Of,c.re),this.Fyl(b,
f,a,c.$f,c.ge))}S3d(a,b,c,f,l,x){if(c&&c!==b.UO)for(;f<l;f++)if(9===(b.vs(c-1,f)&9)&&5===(b.vs(c,f)&5)){var H=this.Kq.CI(b,c-1,f),U=this.Kq.CI(b,c,f);H=a.qf(H.re,H.ge);U=a.qf(U.re,U.ge);x?this.Ptb(U,H,7,0):this.Ptb(H,U,0,7)}}XUe(a,b,c,f,l){l=this.pea.xDa(a,b,c,l);c=f.$3i();if(bE.Qie(c)){let x=this.Bik.THi(l,b);for(;x.moveNext();)0!==(c&x.r9a())&&this.EWe(a,b,x.ML,x.dfb,x.xhj(),f.yxb(x.r9a()),!0)}if($D.Qie(c))for(l=this.p9j.SDi(l,b);l.moveNext();)0!==(c&l.r9a())&&this.yVe(a,b,l.HO,l.scb,l.s5i(),f.yxb(l.r9a()),
!0)}EWe(a,b,c,f,l,x,H=!1){let U=this.qA.wUc(a),ja=null;0<c&&(ja=a.qf(f,c-1));let ya=null;for(c<b.xR&&(ya=a.qf(f,c));f<l;){if(ja){if(6===(b.vs(f,c-1)&6)){var Va=this.Kq.CI(b,f,c-1),hb=a.qf(Va.re,Va.ge);H&&U?U=this.ELb(U,hb,Va.re,Va.ge,6,x):zl.rqc(6,hb,x)}f+1<l&&(ja=a.qf(f+1,c-1))}ya&&(5===(b.vs(f,c)&5)&&(Va=this.Kq.CI(b,f,c),hb=a.qf(Va.re,Va.ge),H&&U?U=this.ELb(U,hb,Va.re,Va.ge,5,x):zl.rqc(5,hb,x)),f+1<l&&(ya=a.qf(f+1,c)));f+=1}}U3d(a,b,c,f,l,x){if(c&&c!==b.xR)for(;f<l;f++)if(6===(b.vs(f,c-1)&6)&&
5===(b.vs(f,c)&5)){var H=this.Kq.CI(b,f,c-1),U=this.Kq.CI(b,f,c);H=a.qf(H.re,H.ge);U=a.qf(U.re,U.ge);x?this.Ptb(U,H,5,6):this.Ptb(H,U,6,5)}}yVe(a,b,c,f,l,x,H=!1){let U=this.qA.wUc(a),ja=null;0<c&&(ja=a.qf(c-1,f));let ya=null;for(c<b.UO&&(ya=a.qf(c,f));f<l;){if(ja){if(9===(b.vs(c-1,f)&9)){var Va=this.Kq.CI(b,c-1,f),hb=a.qf(Va.re,Va.ge);H&&U?U=this.ELb(U,hb,Va.re,Va.ge,0,x):zl.rqc(0,hb,x)}f+1<l&&(ja=a.qf(c-1,f))}ya&&(5===(b.vs(c,f)&5)&&(Va=this.Kq.CI(b,c,f),hb=a.qf(Va.re,Va.ge),H&&U?U=this.ELb(U,hb,
Va.re,Va.ge,7,x):zl.rqc(7,hb,x)),f+1<l&&(ya=a.qf(c,f)));f+=1}}BDh(a,b,c,f){var l=null;if(!({re:f}=zl.PDh(b,c,f)).returnValue)return{returnValue:!1,ola:l};l=6;0<c&&zl.qzb(b,f,c-1)?(b=this.Kq.CI(b,f,c-1),a=this.Qb.Nc(a.qf(b.re,b.ge))):(l=5,b=this.Kq.CI(b,f,c),a=this.Qb.Nc(a.qf(b.re,b.ge)));l=this.l3f(a,l);return{returnValue:!0,ola:l}}xDh(a,b,c,f){const l=zl.IDh(b,c,f);if(!l.returnValue)return{returnValue:!1,ola:null};f=0;0<c&&zl.wbb(b,l.ge,c-1)?(b=this.Kq.CI(b,c-1,l.ge),a=this.Qb.Nc(a.qf(b.re,b.ge))):
(f=7,b=this.Kq.CI(b,c,l.ge),a=this.Qb.Nc(a.qf(b.re,b.ge)));return{returnValue:!0,ola:this.l3f(a,f)}}ELb(a,b,c,f,l,x){const H=b.rowSpan;b=b.colSpan;for(let U=c;U<c+H;U++)for(let ja=f;ja<f+b;ja++)a.ELb(U,ja,l,x);return a}l3f(a,b){a=a.yq;if(!a||!a.cellShading)return null;let c=null;({ola:c}=this.Tk.h3e(b,a.cellShading));return c}Ptb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=di.a.HSa(b,kb.a.cellShading));l&&({ola:b}=this.Tk.h3e(f,l),zl.rqc(c,a,b))}}Gyl(a,b,c,f,l){let x;({re:x}=
zl.PDh(c,f,l)).returnValue&&(l=6,0<f&&zl.qzb(c,x,f-1)?c=this.Kq.CI(c,x,f-1):(l=5,c=this.Kq.CI(c,x,f)),b=b.qf(c.re,c.ge),this.Ptb(a,b,6,l))}Fyl(a,b,c,f,l){let x;({ge:x}=zl.IDh(c,f,l)).returnValue&&(l=0,0<f&&zl.wbb(c,x,f-1)?c=this.Kq.CI(c,f-1,x):(l=7,c=this.Kq.CI(c,f,x)),b=b.qf(c.re,c.ge),this.Ptb(a,b,0,l))}static rqc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static PDh(a,
b,c){let f,l;f=c;l=c+1;if(!zl.wbb(a,b,c))return{returnValue:!1,re:f,$f:l};for(;0<f&&!(0<b&&zl.qzb(a,f,b-1))&&!(b<a.xR&&zl.qzb(a,f,b));f--);for(;l<a.UO&&!(0<b&&zl.qzb(a,l,b-1))&&!(b<a.xR&&zl.qzb(a,l,b));l++);return{returnValue:!0,re:f,$f:l}}static IDh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&zl.wbb(a,f,b-1))&&!(b<a.UO&&zl.wbb(a,f,b));f--);for(;c<a.xR&&!(0<b&&zl.wbb(a,c,b-1))&&!(b<a.UO&&zl.wbb(a,c,b));c++);return{returnValue:!0,ge:f,Of:c}}static wbb(a,b,c){return 0<b&&!(a.vs(c,b-1)&2)||b<a.xR&&!(a.vs(c,
b)&1)?!1:!0}static qzb(a,b,c){return 0<b&&!(a.vs(b-1,c)&8)||b<a.UO&&!(a.vs(b,c)&4)?!1:!0}}Object(m.a)(zl,"TableBorderEditor",null,[1115,1116]);class UL{constructor(a,b,c,f){this.gqe=!1;this.H0=a;this.$gk=b;this.zFb=c;this.xxe=f;this.ji=Array(this.H0.DY);for(a=0;a<this.H0.DY;a++)for(this.ji[a]=Array(this.H0.Wra),b=0;b<this.H0.Wra;b++)this.ji[a][b]=new lq.a}Z3i(a,b,c){this.gqe||(this.$gk.n2k(a,this.H0),this.gqe=!0);if(Ud.a("BugFixCacheInvalidIndex")){if(this.ji&&0<=b&&b<this.ji.length&&this.ji[b]&&
0<=c&&c<this.ji[b].length)return this.ji[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.ji,b,c);this.ji&&(a+=String.format(" m_cache.Length : {0} ",this.ji.length),a=this.ji[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.ji[b].length):a+" m_cache[ row ] is null ");xa.a.J(559724692,822,15,a);return null}return this.ji[b][c]}ELb(a,b,c,f){var l=this.zFb.glh(c,this.H0.ke,f);a=this.ji[a][b];for(var x of l.$z())a.we(x,l.Lh(x));
this.xxe&&Ud.a("TableBordersLocalRenderingFix")&&({gQa:l,F6a:c,lsb:x}=Rp.eTa(c),f.wFieldSpecified&&(f.noFillField?a.we(l,0):a.we(l,ye.a.W0d(f.wField))),f.solidFillField&&a.we(c,f.solidFillField),f.prstDashField&&a.we(x,f.prstDashField))}dispose(){this.ji=null;this.gqe=!1}}Object(m.a)(UL,"TableBorderStyleCache",null,[1114,106]);class cE{constructor(a){this.uze=a?1:0}KNd(a){const b=a.dA;a=a.sE;return b.ge%2===this.uze&&a.svb(b)}}Object(m.a)(cE,"BandedColumnFilter",null,[1189]);class dE{constructor(a){this.uze=
a?1:0}KNd(a){const b=a.dA;a=a.sE;return b.re%2===this.uze&&a.svb(b)}}Object(m.a)(dE,"BandedRowFilter",null,[1189]);class VL{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}$3i(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}yxb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;
case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(m.a)(VL,"TableBorderSet",null,[]);class XL{constructor(a,b){this.k5=a;this.fhk=b}n2k(a,b){const c=b.DY,f=b.Wra;var l=b.tableLook;b=b.tableStyle;const x=this.fhk.create(a),H=!!(l&32)&&!!b.firstRowField,U=!!(l&64)&&!!b.lastRowField,ja=!!(l&128)&&!!b.firstColField,ya=!!(l&256)&&!!b.lastColField,Va=H&&ja&&!!b.nwCellField,
hb=H&&ya&&!!b.neCellField,yb=U&&ja&&!!b.swCellField,Zb=U&&ya&&!!b.seCellField;var fc=!(l&512)&&!!b.band1HField,Kc=!(l&512)&&!!b.band2HField,Lc=!(l&1024)&&!!b.band1VField;const Gc=!(l&1024)&&!!b.band2VField;l=new kr.a;b.wholeTblField&&(l.re=0,l.$f=c,l.ge=0,l.Of=f,this.apply(a,x,b.wholeTblField,l));l.re=H?1:0;l.$f=c-(U?1:0);l.ge=0;l.Of=f;fc&&(fc=new dE(H),this.apply(a,x,b.band1HField,l,fc));Kc&&(Kc=new dE(!H),this.apply(a,x,b.band2HField,l,Kc));l.re=0;l.$f=c;l.ge=ja?1:0;l.Of=f-(ya?1:0);Lc&&(Lc=new cE(ja),
this.apply(a,x,b.band1VField,l,Lc));Gc&&(Lc=new cE(!Gc),this.apply(a,x,b.band2VField,l,Lc));ya&&(l.re=0,l.$f=c,l.ge=f-1,l.Of=f,this.apply(a,x,b.lastColField,l));ja&&(l.re=0,l.$f=c,l.ge=0,l.Of=1,this.apply(a,x,b.firstColField,l));U&&(l.re=c-1,l.$f=c,l.ge=0,l.Of=f,this.apply(a,x,b.lastRowField,l),Zb&&(l.ge=f-1,l.Of=f,this.apply(a,x,b.seCellField,l)),yb&&(l.ge=0,l.Of=1,this.apply(a,x,b.swCellField,l)));H&&(l.re=0,l.$f=1,l.ge=0,l.Of=f,this.apply(a,x,b.firstRowField,l),hb&&(l.ge=f-1,l.Of=f,this.apply(a,
x,b.neCellField,l)),Va&&(l.ge=0,l.Of=1,this.apply(a,x,b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.bSa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const x=new VL;c.topField&&c.topField.itemField&&(x.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(x.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(x.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(x.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(x.right=
c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(x.insideVer=c.insideVField.itemField);this.k5.XUe(a,b,f,x,l)}}}Object(m.a)(XL,"TableBorderStyleResolver",null,[284]);class Iv{constructor(){}Gpi(a,b){const c=new kr.a;if(a.bSa())return c;const f=Iv.$Vf(b,a,a.re,!0),l=Iv.$Vf(b,a,a.$f-1,!1),x=Iv.BVf(b,a,a.ge,!0);a=Iv.BVf(b,a,a.Of-1,!1);c.re=f;c.$f=l+1;c.ge=x;c.Of=a+1;return c}jKj(a,b){for(var c=a.re;c<a.$f;++c)if(!(b.vs(c,a.ge)&1&&b.vs(c,a.Of-1)&2))return!1;for(c=a.ge;c<a.Of;++c)if(!(b.vs(a.re,
c)&4&&b.vs(a.$f-1,c)&8))return!1;return!0}t_f(a){let b;b=null;const c=new kr.a;if(!(a&&a.Hl&&a.mb&&a.t6))return{returnValue:c,tableNode:b};var f=a.ga(0).jg.Ua,l=Object(oa.a)(Yl.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.pi;var x=Object(oa.a)(Yl.TableCellNode,a.ga(0).jg.Ye.node);var H=0;x&&(H=x.pi+1);if(b.Lp()&&1!==a.length){H=Object(oa.a)(Yl.TableCellNode,a.L0a.currentNode);f=Object(oa.a)(Yl.TableCellNode,a.Gja.currentNode);if(!H||
!f)return{returnValue:c,tableNode:b};l=H.rowIndex;a=H.pi;x=f.rowIndex;H=f.pi;f=Math.min(l,x);x=Math.max(l,x)+1;l=Math.min(a,H);H=Math.max(H,a)+1}else x=f+a.length;c.re=f;c.$f=x;c.ge=l;c.Of=H;return{returnValue:c,tableNode:b}}CI(a,b,c){b=Object.assign(new kr.a,{re:b,$f:b+1,ge:c,Of:c+1});return this.dPc(a,b)}dPc(a,b){const c=new kr.a;let f=b.re,l=b.$f-1;for(var x=b.ge;x<b.Of;x++){for(var H=b.re;0<H&&!(a.vs(H,x)&4);H--);H<f&&(f=H);H=b.$f-1;for(var U=a.UO-1;H<U&&!(a.vs(H,x)&8);H++);H>l&&(l=H)}x=b.ge;
H=b.Of-1;for(U=b.re;U<b.$f;U++){let ja=b.ge;for(;0<ja&&!(a.vs(U,ja)&1);ja--);ja<x&&(x=ja);ja=b.Of-1;for(const ya=a.xR-1;ja<ya&&!(a.vs(U,ja)&2);ja++);ja>H&&(H=ja)}c.re=f;c.ge=x;c.Of=H+1;c.$f=l+1;return c}static $Vf(a,b,c,f){if(f)for(;0<c;c--)for(f=b.ge;f<b.Of;++f){if(a.vs(c,f)&4)return c}else for(f=a.UO-1;c<f;c++)for(let l=b.ge;l<b.Of;++l)if(a.vs(c,l)&8)return c;return c}static BVf(a,b,c,f){if(f)for(;0<c;c--)for(f=b.re;f<b.$f;++f){if(a.vs(f,c)&1)return c}else for(f=a.xR-1;c<f;++c)for(let l=b.re;l<
b.$f;++l)if(a.vs(l,c)&2)return c;return c}}Object(m.a)(Iv,"TableCellSelectionHelper",null,[279]);class YL{constructor(a,b,c){this.WQ=null;this.t4=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.ee=a;this.yc=b;this.YX=c;this.GX=3}M5e(){try{var a=tb.GraphIterator.nb(this.ee);Vd.forEachCellInTable(a,(b,c,f)=>{var l=Object(oa.a)(123,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let x=c;x<b;++x)for(let H=f;H<l;++H)x===c&&(this.WQ[x][H]|=4),x===b-1&&(this.WQ[x][H]|=
8),H===f&&(this.WQ[x][H]|=1),H===l-1&&(this.WQ[x][H]|=2)}return!0})}catch(b){a=this.YX.z0d(this.ee),xa.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.t4)throw Error.invalidOperation("cache disposed");if(0!==this.GX){if(3===(this.GX&3)){const a=this.yc.sk(this.ee),b=this.yc.Ai(this.ee);this.WQ=Array(a);for(let c=0;c<a;++c){this.WQ[c]=Array(b);for(let f=0;f<b;++f)this.WQ[c][f]=0}}1===(this.GX&1)&&this.M5e();this.GX=0}}vs(a,b){try{this.validate();var c=this.WQ[a][b]}catch(f){c=
this.YX.z0d(this.ee),xa.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.UO,this.xR,a,b,c,f.message),c=0}return c}pUa(a){this.GX|=a}dispose(){this.t4=!0;this.WQ=null}get UO(){this.validate();return this.WQ?this.WQ.length:0}get xR(){this.validate();return this.WQ&&this.WQ.length?this.WQ[0].length:0}}Object(m.a)(YL,"TableInfoCache",null,[404,106]);class ZL{constructor(a,b){this.yc=a;this.YX=b}create(a){return new YL(a,this.yc,this.YX)}}Object(m.a)(ZL,
"TableInfoCacheFactory",null,[291]);class Yz{constructor(a,b,c,f,l,x){this.vfk=a;this.u6j=b;this.ihk=c;this.Wak=f;this.Hhk=l;this.nhk=x}get DY(){return this.vfk()}get Wra(){return this.u6j()}get tableLook(){return this.ihk()}get w_j(){return this.Wak()}get ke(){return this.Hhk()}get tableStyle(){return this.nhk()}static lLf(a,b,c,f,l,x){return new Yz(a,b,c,f,l,x)}}Object(m.a)(Yz,"TableListStyleParams",null,[354]);class $L{constructor(a){this.ana=null;this.O6c=!1;this.hCe=this.DBb=null;this.Qb=a}get ELj(){return!!this.DBb}mbh(a,
b){this.hCe=a.id.toString();this.O6c=!this.Qb.s$i(a).currentNode.sc(b).j_c();this.DBb=null;this.O6c&&(a=a.sc(b),this.pSi(),Ca.a.X0b(a.htmlElement,this.ana),this.DBb=this.qYi(this.ana))}g5b(a,b,c,f){if(a.id.toString()!==this.hCe)throw Error.argument("table","Wrong table metrics");if(this.O6c){if(!this.DBb)throw Error.invalidOperation("m_clonedTableNode is null");a=this.DBb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(ia.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",
c.className),c=Ca.a.gda(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){Ca.a.FUa(this.ana)&&this.ana.parentNode.removeChild(this.ana);this.DBb=this.ana=null;this.O6c=!1;this.hCe=null}z0d(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa($a.a.iza,0),a.properties.sa($a.a.xga,0)));const c=this.Qb.Nc(a);Vd.forEachCellInTable(c,(f,l,x)=>{var H=f.currentNode;f=H.rowSpan;H=H.colSpan;(1<f||1<H)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",
l,x,f,H));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}pSi(){this.ana||(this.ana=document.createElement("div"),this.ana.className="TableMetricsWorkingDiv",document.body.appendChild(this.ana));Ca.a.rCa(this.ana)}qYi(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;a=a.nextSibling}return null}}Object(m.a)($L,"TableMetrics",null,[288]);class aM{constructor(a){this.qA=a}o2k(a,b,c){return b&&a&&c&&(a=this.qA.yUc(a).K0f(c,b.rowIndex,b.pi,b.rowSpan,
b.colSpan))&&a!==Ib.a.auto?a.sD:-1}}Object(m.a)(aM,"TableThemeColorHelper",null,[292]);class bM{constructor(a){this.Kq=a}THi(a,b){return new bE(a,this.Kq,b)}}Object(m.a)(bM,"VerticalTableBorderIteratorFactory",null,[283]);class eE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Zb(a){this.K=a;this.K.register(279,"PowerPointWebEditor.ITableCellSelectionHelper").ma().oa(()=>new Iv);a.register(280,"Box4.ITableDragSelectionCellExtendStrategy").ma().oa(()=>new xL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(zl,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().oa(()=>new zl(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(281,"PowerPointWebEditor.ICellIteratorFactory").ma().oa(()=>new OL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(282,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().oa(()=>new PL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(283,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().oa(()=>new bM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(284,"PowerPointWebEditor.ITableBorderStyleResolver").ma().oa(()=>new XL(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(km,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().oa(()=>
new km(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Ma));this.K.register(XD,"PowerPointWebEditor.TableNodeBehavior").ma().oa(()=>new XD(this.K.resolve("Box4.Graph.IGraphInstance").yd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qae));this.K.register(285,"PowerPointWebEditor.ITableStyleReaderHelper").ma().oa(()=>new Rp(this.K.resolve("Box4.IPageView").Ld,
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").k0c));this.K.register(Vz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().oa(()=>new Vz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Ld,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Yz.lLf,b=>new YD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new WD(b),b=>new UL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),
a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").kaa),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jgg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").tVj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").kaa));this.K.register(286,"PowerPointWebEditor.ITableStyleResolver").ma().oa(()=>new JL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").kaa));this.K.register(287,"PowerPointWebEditor.ITableStyleGalleryManager").ma().oa(()=>new ML(this.K.Ja("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(288,"PowerPointWebEditor.ITableMetrics").ma().oa(()=>
new $L(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(289,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().oa(()=>new SL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(290,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().oa(()=>new TL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").yd(14),this.K.resolve("Box4.Graph.IGraphInstance").yd(15),this.K.resolve("Box4.Graph.IGraphInstance").yd(16),this.K.resolve("Box4.Graph.IGraphInstance").yd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(UD,"PowerPointWebEditor.TableCellNodeBehavior").ma().oa(()=>
new UD(this.K.resolve("Box4.Graph.IGraphInstance").yd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(tL,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(uL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();this.K.register(ZQ.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(291,"PowerPointWebEditor.ITableInfoCacheFactory").ma().oa(()=>
new ZL(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(292,"PowerPointWebEditor.ITableThemeColorHelper").ma().oa(()=>new aM(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").YJb(1,
new Hv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a),new FL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new EL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new Di.a((c,f)=>new Kl(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>Tx.j1b(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new Di.a((c,f)=>new Gv(c,f,new qc.a(c,f,qc.a.ptl))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new wL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),
new Di.a((c,f)=>new bt(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ska,this.K.resolve("PowerPointWebEditor.IApplicationSettings").kaa,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));Ab.StyleReader.nr=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){z.a.instance.Dc(new eE)}}
Object(m.a)(eE,"PPTWebEditorTablePackage",null,[2,3]);var cR=d(1231),Uh=d(111);class cM{constructor(){this.podsUrl=this.fileUrl=null}}Object(m.a)(cM,"IFileInfo",null,[]);class dM extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(m.a)(dM,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class eM{constructor(){this.messageType=0;this.data=this.sender=null}}Object(m.a)(eM,"IPresentationMessage",null,[]);class fM{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=
!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(m.a)(fM,"IPresenterViewSettings",null,[]);class gM{constructor(){this.uiHost=this.userSessionId=null}}Object(m.a)(gM,"ISessionInfo",null,[]);var dR=d(535);class hM{constructor(a,b,c){this.$Q="";this.M9=null;this.Ndb=!1;this.vEb=null;this.va=new wc.a;this.ia=a;this.la=b;this.Lc=c;this.EIk()}wb(){this.ia.ra(K.a.LJb,rc.a.application,Object(F.a)(this,this.LJb,"queryUsePresenterView"),96);this.ia.ya(K.a.z5e,rc.a.application,Object(F.a)(this,
this.iwl,"toggleUsePresenterView"));this.ia.ya(K.a.Iqd,Cb.a.application,Object(F.a)(this,this.Iqd,"showPresenterView"));this.ia.ya(K.a.ZJc,rc.a.application,Object(F.a)(this,this.ZJc,"closePresenterView"));this.Ndb=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}LJb(a,b,c,f,l){(a=Object(oa.a)(Uh.a,l))&&a.Mf(this.Ndb);return 32}iwl(a,b,c){if(1===c&&!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return xa.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),
8;2===c&&(this.Ndb=!this.Ndb,this.Lc.Dy(new Sp.a(1)));return 32}Iqd(a,b,c){try{if(!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return xa.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.$Q.length){if(!this.vEb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),x=new cM;x.fileUrl=this.$Q;x.podsUrl=f;const H=new gM;H.userSessionId=u.AFrameworkApplication.userSessionId;H.uiHost="UnifiedApp";
const U=new fM;U.presenterWindowWidth=1024;U.presenterWindowHeight=576;this.vEb=new PresenterView.PresentationProxy(2,l,x,H,U)}this.vEb.startPresentation();this.vEb.subscribe(Object(F.a)(this,this.hwk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return xa.a.J(512496090,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}ZJc(a,b,c){2===c&&(xa.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.vEb.terminatePresentation());return 32}u$h(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",
a)}n8k(a){a=this.cgi(a);this.vEb.sendMessage(a)}cgi(a){const b=new eM;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.stc});return b}hwk(a){try{if(!a||0>=a.length)xa.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||xa.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=
JSON.parse(l).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new dM({["SlideIndex"]:f}))}}}}catch(l){xa.a.J(512496086,830,10,"Exception: {0}",l)}}EIk(){var a=Db.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new cR.a(u.AFrameworkApplication.Ke);this.M9=dR.b(b.DUe(a));this.M9.then(c=>
{try{const f=JSON.parse(c),l=f.downloadUrl;ha.a.Wa(l)?xa.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.$Q=l}catch(f){xa.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(m.a)(hM,"PresenterViewManager",null,[277]);class fE{constructor(){this.rb=this.la=this.K=null;this.QDg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Zb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.rb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").FF()}init(){u.AFrameworkApplication.fa.gf(Object(F.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){try{(this.QDg=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").Sw.loadScript("presenterView").catch(a=>xa.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.jwk()).catch(a=>xa.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){ia.ULS.sendTraceTag(594031830,
811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}jwk(){this.k1b();return null}k1b(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",u.AFrameworkApplication.fa.Ga("PPTPresenterViewCssUrl"));this.rb.appendChild(a);this.K.register(277,"PowerPointWebEditor.PresenterView.IPresenterViewManager").oa(()=>new hM(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();
this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").wb()}dispose(){}static main(){z.a.instance.Dc(new fE)}}Object(m.a)(fE,"PPTWebEditorPresenterViewPackage",null,[2,3]);class iM{constructor(a){this.pea=a}uHi(a,b,c){if(c.bSa())return null;a=this.pea.xDa(a,b,c);for(b=Array(b.UO);a.moveNext();){c=a.f5b();var f=a.dA;b[f.re]||(b[f.re]=[]);f=b[f.re];f[f.length]=cr.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new ib.Selection(b[c],!0));return new ub.SelectionCollection(a,
a.length-1,0)}}Object(m.a)(iM,"PPTSelectionFactory",null,[275]);class jM{constructor(a,b,c,f){this.fxe=this.Rma=this.lqe=null;this.p1h=a;this.mOh=b;this.Kq=c;this.fYa=f}get gqi(){return this.mOh}get Xsb(){this.lqe||(this.lqe=this.Kq.Gpi(this.gqi,this.VY));return this.lqe}get tableNode(){return this.p1h}get VY(){this.Rma||(this.Rma=this.fYa.create(this.tableNode));return this.Rma}get VSj(){this.fxe||(this.fxe=this.Kq.jKj(this.Xsb,this.VY));return this.fxe}}Object(m.a)(jM,"TableCellSelectionInfo",null,
[]);class kM{constructor(a,b){this.fYa=a;this.Kq=b}create(a,b){return new jM(b,a,this.Kq,this.fYa)}}Object(m.a)(kM,"TableCellSelectionInfoFactory",null,[273]);var eR=d(1008);class lM{constructor(a,b,c){this.HUg=a;this.Kq=b;this.wGa=c}F6b(a){let b=null;const c=new Date,f=({tableNode:a}=this.Kq.t_f(a)).returnValue,l=!f.bSa();l&&(b=this.HUg.create(f,a),Tc.a.Ib&&Tc.a.Ib.Va("CellRange",f.toString()));xa.a.J(512495623,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}zjj(a){if(!a)return null;
var b=this.wGa.LA(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].al){var f=Object(oa.a)(5,b[l].node);if(f){f=f.jL();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new kr.a,{re:a.rowIndex,ge:a.pi});b.$f=b.re+1;b.Of=b.ge+1;return this.HUg.create(b,a.getContainingTable())}}Object(m.a)(lM,"TableSelectionAdapter",null,[274]);class gE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Zb(a){this.K=
a;this.K.register(273,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().oa(()=>new kM(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(274,"PowerPointWebEditor.ITableSelectionAdapter").ma().oa(()=>new lM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(275,"PowerPointWebEditor.ISelectionFactory").ma().oa(()=>new iM(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(276,"PowerPointWebEditor.ITableMergeSplitEditor").ma().oa(()=>new eR.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){z.a.instance.Dc(new gE)}}Object(m.a)(gE,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class ol{constructor(a,b,c,f,l,x,H,U){this.vqb=a;this.RLd=b;this.Ca=c;this.PLd=f;this.Ak=l;this.Ht=x;this.fd=H;this.KUh=U}wb(){this.Mkd(Oc.App.RLa.GJf())}Mkd(a){this.Ca.ya(D.a.FJb,Cb.a.view,a);this.Ca.ya(D.a.FJb,Cb.a.table,Object(F.a)(this,this.FJb,"queryTableStyle"));this.Ca.je(D.a.FJb,
103);this.Ca.ya(D.a.NZ,Cb.a.view,Object(F.a)(this,this.K0e,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.NZ,Cb.a.table,Object(F.a)(this,this.NZ,"applyTableStyle"));this.Ca.je(D.a.NZ,6);this.Ca.ya(D.a.q6a,Cb.a.table,Object(F.a)(this,this.NZ,"applyTableStyle"));this.Ca.ya(D.a.OZ,Cb.a.view,Object(F.a)(this,this.K0e,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.OZ,Cb.a.table,Object(F.a)(this,this.OZ,"applyTableStyleOption"));this.Ca.je(D.a.OZ,14);this.Ca.ya(D.a.Una,Cb.a.view,a);this.Ca.ya(D.a.Una,
Cb.a.table,Object(F.a)(this,this.Una,"queryTableStyleOption"));this.Ca.je(D.a.Una,103);this.Ca.ya(D.a.fIb,Cb.a.view,a);this.Ca.ya(D.a.fIb,Cb.a.table,Object(F.a)(this,this.fIb,"populateMenuMoreTableStyles"));this.Ca.je(D.a.fIb,102);this.Ca.ya(D.a.d7a,Cb.a.view,Object(F.a)(this,this.K0e,"tableStyleGenericViewActionHandler"));this.Ca.ya(D.a.d7a,Cb.a.table,Object(F.a)(this,this.d7a,"clearTableFormatting"));this.Ca.je(D.a.d7a,4)}FJb(a,b,c,f,l){if(!({tF:a}=this.Sqc(b,c,l,!0,!0)).returnValue)return a;this.RLd.EDi(l,
b.node);return 32}Una(a,b,c,f,l){return this.Cag(b,c,f,l,!0)}fIb(a,b,c,f,l){if(!({tF:a}=this.Sqc(b,c,l,!1,!0)).returnValue)return a;this.RLd.IEi(l,b.node);ia.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}NZ(a,b,c,f,l){if(!({tF:c}=this.Sqc(b,c,l,!1,!0)).returnValue)return c;const x=b.node;let H=null;(H=a===D.a.NZ?this.RLd.hsd(l[Sh.a.SourceControlId],x):null)?(this.pKe(x,()=>{this.PLd.Ndl(H,x)}),c=32):c=8;a===D.a.NZ&&32===c&&ia.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");
ia.ULS.shipAssertTag(541172699,324,32===c);return c}OZ(a,b,c,f,l){return this.Cag(b,c,f,l,!1)}Cag(a,b,c,f,l){if(!({tF:b}=this.Sqc(a,b,f,l,!0)).returnValue)return b;a=a.node;b=this.vqb.m8d(a);const x=f[Sh.a.On],H=ol.Clj(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np?f.MenuItemId:f[Sh.a.SourceControlId]);l?f[Sh.a.On]=ol.Lil(b,H):(this.Zei(b,H,x,a),c.hQ=H,c.m8=x?0:1,ia.ULS.shipAssertTag(541172700,324,0!==H));return 32}K0e(a,b,c,f,l){return fi.M5(a,b,c,f,l,{},14)}pKe(a,b){const c=this.Ak.me(15);
try{c.kd(a),this.Ht.u_a(),b()}finally{c&&c.dispose()}}Sqc(a,b,c,f,l){return this.GVj(a,b,c,f,l)?{returnValue:f||2===b,tF:32}:{returnValue:!1,tF:8}}GVj(a,b,c,f,l){if(a.contextId!==Cb.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Xa.a)(By.a,a.node)||this.KUh(a.node))return!1;return!0}Zei(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.pKe(f,()=>{this.PLd.rbl(l,f)})}d7a(a,b,c,f,l){if(!({tF:a}=this.Sqc(b,c,l,!1,!1)).returnValue)return a;const x=b.node;this.pKe(x,()=>{this.PLd.Fti(x)});
return 32}static qr(){ol.fPa[ol.RYi]=32;ol.fPa[ol.MYi]=128;ol.fPa[ol.NYj]=64;ol.fPa[ol.FYj]=256;ol.fPa[ol.thi]=512;ol.fPa[ol.shi]=1024}static Lil(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static Clj(a){let b=0;a in ol.fPa&&(b=ol.fPa[a]);return b}}ol.RYi="buttonFirstRow";ol.MYi="buttonFirstColumn";ol.NYj="buttonLastRow";ol.FYj="buttonLastColumn";ol.thi="buttonBandedRow";ol.shi="buttonBandedColumn";ol.fPa={};Object(m.a)(ol,"TableStyleActor",null,[]);ol.qr();class tp{constructor(a){this.I0=a}Ndl(a,
b){a=this.I0.A6b(a);tp.jFf(b);b.setValue(kb.a.jza,Ug.a.Hf(a.$X.styleIdField))}rbl(a,b){b.setValue(kb.a.Bsc,a)}Fti(a){tp.jFf(a);a.removeProperty(kb.a.jza)}static jFf(a){if(a=Object(oa.a)(Wz.TableNode,a)){a=a.i$a();for(const b of a){b.cellShading&&((a=Zo.d(b.cellShading))?(Zo.c(a),b.cellShading=a):xa.a.J(22078240,822,15,"Encountered null cell shading."));for(const c of tp.Lii){let f,l;({gQa:f,F6a:a,lsb:l}=Rp.eTa(c));b.removeProperty(a);b.removeProperty(f);b.removeProperty(l)}tp.gti(Object(oa.a)(ug.a,
b))}}else xa.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static gti(a){const b=new PF.a;b.set(a);for(a=b.Bb(1);a;){for(a=b.Bb(2);a;)12===a.type&&tp.hti(a),a=b.Dj(2);a=b.Dj(1)}}static hti(a){if(a.Ra&&0<a.Ra.length)for(let b=0;b<a.Ra.length;b++)a.Ra.ga(b)&&tp.iti(a.Ra.ga(b))}static iti(a){if(a=a.formatting){const f=a.paragraph.Fh;if(f){var b=a.Vz,c=!1;if(b){for(let l=0;l<tp.zTe.length;l++)b.Sa(tp.zTe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(tp.zTe[l]));c&&(b=f.mKa(b),a.om=
b.id)}}}}}tp.zTe=[$a.a.font,kb.a.latinFont,kb.a.eastAsianFont,kb.a.complexScriptFont,kb.a.NNb,$a.a.fontColor,$a.a.bold,$a.a.italic,kb.a.schemeColor];tp.Lii=[5,6,7,0];Object(m.a)(tp,"PPTTableStyleEditor",null,[353]);class hE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Zb(a){this.K=a}init(){(new ol(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),this.K.resolve("Common.IActionManagerExtended"),new tp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).wb()}dispose(){}static main(){z.a.instance.Dc(new hE)}}Object(m.a)(hE,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class iE{constructor(a,b,c){this.LCe=0;this.uve=!1;this.Qk=a;this.eu=b;this.pa=c;this.Qk.Ytf(Object(F.a)(this,this.jzf,"beforeForceOutboundGraphTransactionInitialize"));this.Qk.SBa(Object(F.a)(this,
this.J9f,"graphTransactionDisposed"));this.eu.ura(Object(F.a)(this,this.WYa,"onBeforeValidatePersistence"))}dispose(){this.Qk.dih(Object(F.a)(this,this.jzf,"beforeForceOutboundGraphTransactionInitialize"));this.Qk.j_a(Object(F.a)(this,this.J9f,"graphTransactionDisposed"));this.eu.soc(Object(F.a)(this,this.WYa,"onBeforeValidatePersistence"))}jzf(){this.LCe++}WYa(){0<this.LCe&&(this.uve=!0)}J9f(){if(!(0<--this.LCe)&&this.uve){this.uve=!1;var a=Tc.a.Ib;if(a){const b=this.pa.Wd();let c=0;for(const f of b)f.EL&&
c++;a.Va("ShapeCount",b.length.toString());a.Va("SupportSVGCount",c.toString())}}}}Object(m.a)(iE,"SVGShapeTelemetry",null,[106]);class jE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Zb(a){this.K=a;this.K.register(iE,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().oa(()=>new iE(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").yd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){z.a.instance.Dc(new jE)}}
Object(m.a)(jE,"PPTWebEditorTelemetryPackage",null,[2,3]);class Zz{}Zz.Jch="faProofing";Object(m.a)(Zz,"ContextMenuControlId",null,[]);class kE{constructor(a,b,c,f,l,x,H){this.hN=b;this.eWb=a;this.Azc=b.RLj;this.Uzc=b.dle;this.WTh=x;this.kzc=f;this.lzc=l;this.MNa=c;this.yP=H;this.INa=new Kb.a;this.INa.$(1,"SpellingIssue_16x16x32");this.INa.$(2,"GrammarIssue_16x16x32");this.INa.$(3,"WritingIssue_16x16x32");this.INa.$(4,null);this.INa.$(0,null)}create(a,b,c){b=Object(oa.a)(Po.a,b);if(!b)return ia.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.a3f(a);this.z1b(f,b,c,a);this.RXd(f,b);this.QFi(f,b,a);return f.toString()}Pt(a,b,c){b=Object(oa.a)(Po.a,b);if(!b)return ia.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.a3f(a);this.xYd(f,b,c,a);this.SXd(f,b);this.RFi(f,b,a);return f}z1b(a,b,c,f=null){0===b.errorType?a.append(this.eWb.build()):1===b.errorType&&(this.URa(b)||a.append(this.PSd(b,c,f)))}xYd(a,b,c,f=null){0===
b.errorType?a.push(this.eWb.DAf()):1===b.errorType&&(this.URa(b)||a.push(this.Vji(b,c,f)))}RXd(a,b){if(!P.a.instance.ga(92)){const c=new Sys.StringBuilder;this.Yvh(b)?c.append(nj.a("btnIgnoreAllSpellingError",(2===b.errorType?D.a.kud:D.a.cde).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.URa(b)||c.append(nj.a("btnIgrnoreSpellingError",this.C2f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.bwh(b)&&(this.hN.kje&&c.append(nj.a("btnDoNotCheckForThisIssue",
"2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(nj.a("btnGrammarOptions","3380187414",ha.a.ue(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}SXd(a,b){if(!P.a.instance.ga(92)){const f=Object.assign(new hk.a,{ControlList:[]});if(this.Yvh(b)){var c=Object.assign(new fg.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":
"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.URa(b)||(c=Object.assign(new fg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.C2f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,c));this.bwh(b)&&(this.hN.kje&&(b=Object.assign(new fg.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new fg.a,{ExternalId:"GrammerSettingsContext",
Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}a3f(a){if(!this.yP)return null;a=this.yP.language(this.yP.xs(a.Ua));return Ya.a.xe(a).name}C2f(a){return 2===a?D.a.kud:this.hN.djg?D.a.EWc:D.a.yka}QFi(a,b,c=null){if(this.yXe(b)){var f=ha.a.ue(b.xN.CategoryTitle);f=nj.j(Zz.Jch,G.a.T7,this.INa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.kzc,this.lzc);f=nj.c("cgProofingOuter",[f]);
a.clear();a.append(nj.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));ia.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}RFi(a,b,c=null){if(this.yXe(b)){var f=ha.a.ue(b.xN.CategoryTitle);c=Object.assign(new or.a,{ExternalId:String.format("{0}_{1}",Zz.Jch,b.proofingType),Command:"798637440",Image16by16Class:this.INa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,
Menu:Object.assign(new tm.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.w3i(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);f=Object.assign(new hk.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);ia.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}PSd(a,b,c=null){const f=this.a9i(a);
var l=[];let x=!1;var H=a.xN.Suggestions;if(H)if(H=H.slice(0,Math.min(3,H.length)),this.Azc&&(x=!cb.a.any(H,U=>!U||!U.Description)),1===H.length&&0===H[0].Action)b=ha.a.ue(H[0].Text),l.push(nj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let U=0,ja=null;x&&(ja="font-weight: bold;");for(const ya of H){if(!ya)continue;H=null;let Va="",hb=ha.a.ue(ya.Text);x&&(H=this.a_f(ya.Description),
Va=this.$Zf(ya.Description));l.push(nj.a("btnCorrectWord"+U,b[U].toString(),hb,null,null,null,null,null,ja,null,H,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,hb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.EIf(a.token)),"ariaDescribedById",Va));U++}}b="Menu16";0<l.length?x&&(b="Menu16DescriptionEnabled"):l=[nj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,
null)];return nj.e("msUnknownWord",nj.c(null,l),b,f,this.Acj(a),c,"ariaLabelledById")}Vji(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.xN.ExplanationTitle:"";f=Object.assign(new hk.a,{Title:f,Lang:c,ControlList:[]});let l=!1;var x=a.xN.Suggestions;if(x)if(x=x.slice(0,Math.min(3,x.length)),this.Azc&&(l=!cb.a.any(x,H=>!H||!H.Description)),1===x.length&&0===x[0].Action)a=x[0],a=Object.assign(new fg.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,
a);else{let H=0;for(const U of x){if(!U)continue;x=null;let ja="";l&&(x=this.a_f(U.Description),ja=this.$Zf(U.Description));if(H>=b.length)break;x?(x=Object.assign(new vB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",H,a.proofingType),Command:b[H].toString(),LabelText:U.Text,Description:x,Lang:c,AriaDescription:ja}),Array.add(f.ControlList,x)):(x=Object.assign(new fg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",H,a.proofingType),Command:b[H].toString(),
LabelText:U.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,x));H++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new fg.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return f}a9i(a){return ha.a.ue(1!==a.proofingType&&0!==a.proofingType?a.xN.ExplanationTitle:"")}Acj(a){return this.yXe(a)?null:this.INa.ga(a.proofingType)}yXe(a){return this.Uzc&&2!==a.errorType&&(1!==a.errorType||!this.URa(a))}Yvh(a){return this.WTh&&
0!==a.errorType&&1===a.proofingType&&!this.URa(a)}w3i(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.EIf(a.token)):""}bwh(a){return this.hN.VUa&&this.Uzc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}URa(a){return 0!==a.errorType&&!!this.MNa&&this.MNa.contains(a.token,a.lcid)}a_f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}$Zf(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
a):""}EIf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(m.a)(kE,"EditorServiceProofingContextMenuCreator",null,[]);class zq{Iaa(a,b){this.ppi&&this.ukl(a,b,zq.EYg,zq.mb)}ukl(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:zq.GPi.show(f,a,b)}}CYg(){switch(zq.EYg){case 5:case 1:return!0;default:return!1}}get ppi(){return 1!==Oc.App.Kb.state}static get GPi(){return zq.Eaf||(zq.Eaf=Db.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static Bcj(a){if(!a)return 0;
if(2===Oc.App.Kb.mode)if(P.a.instance.ga(17)&&1===a.length&&gj.OutlineReader.l$b(a.Ua)&&Oc.App.Kb.Kd.Dn&&Oc.App.Kb.Kd.Dn.lp){if(a=tb.GraphIterator.nb(a.Ua.node),a.ev(),!Hf.b(a))return 5}else{const b=a.Ua.node;let c=tb.GraphIterator.nb(b);c.ev();return cu.e(c.currentNode)?2:u.AFrameworkApplication.Ylb||!Fb.EmbeddedFileReader.Dab(b)||Fb.EmbeddedFileReader.XN(b)?a.Ua.contextId===Cb.a.iFrame||SI(a.Ua)?6:1:3}else return 4;return 0}static get mb(){return qd.a.instance.Na.mb}static get EYg(){return zq.Bcj(zq.mb)}}
zq.Eaf=null;Object(m.a)(zq,"SelectionContextMenuProvider",null,[263]);class mM{constructor(a){this.la=a}b4d(a,b,c,f,l){const x=c?u.AFrameworkApplication.rm:"";c=c?Ro.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,x,c,ha.a.ue(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',
a,b)}bHi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new kx.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=ha.a.ox(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}yri(){var a=(new kx.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}rHi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;
var b=(new kx.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=ha.a.ox(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(m.a)(mM,"ContextMenuHelper",null,[269]);class Ux extends As{constructor(a,b,c,f){super(a,c);this.dug=b;this.fWa=f}R4b(a){let b=null,c=!1;var f=qd.a.instance.Na.mb;f=Db.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").Jbe(f,
a);switch(this.fWa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.dug&&this.dug.Jlg("1898844988"),x=Db.a.instance.resolve("Box4.ISelectionContextMenuProvider").CYg(),H=u.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=H?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting",
"Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:x&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static oEj(a,b,c,f){a.dii(()=>Ux.Uyi(b,c,f))}static Uyi(a,b,c){return new Ux(a,b,c,0)}}Object(m.a)(Ux,"PowerPointReactFloatie",As,[]);class nM{constructor(a,b){this.pwg=b;this.bre=a}dispose(){}HH(){}cNi(){this.bre.xsa()}h6(a,
b,c,f){this.pwg.Hph(f);this.bre.h6(a,b,c)}vkl(a,b,c,f){14===f?this.h6(a,b,c,f):(this.pwg.Hph(f),a=new Ux(Db.a.instance.ub("Common.IReactContextualUILauncher"),Oc.App.OD.QS,Db.a.instance.ub("Common.IExternalUICommandDefinitionMapping"),f),this.bre.rqd(b,c,a,Db.a.instance.ub("Box4.ISelectionContextMenuProvider")))}}Object(m.a)(nM,"ReactContextMenuUser",null,[267]);class oM{constructor(){this.whitelistedControlIds=this.Uaa=this.sG=null;this.pXj=!1;this.dal=this.oga=this.uyh=null}}Object(m.a)(oM,"ReactStatusBarInitOptions",
null,[]);class pM{constructor(){this.whitelistedControlIds=null}}Object(m.a)(pM,"StatusBarProps",null,[]);class Vx{constructor(a,b,c=!0){this.RId=!1;this.Wlf=null;this.G5a=b.sG;this.Zof=b.uyh;c?gb.a.get_instance().ek(7,()=>{this.qIc(a,b)}):this.qIc(a,b)}qIc(a,b){window.setTimeout(()=>{Nd.a.instance.hG(()=>{mj.UISurfaces.wkj().then(c=>{const f=Object.assign(new pM,{whitelistedControlIds:b.whitelistedControlIds});c.initializeNewStatusBar(a,f,this.Zof);this.Wlf=c;this.RId=!0;window.setTimeout(()=>{Nd.a.instance.hG(()=>
{const l=[];if(b.Uaa){const x=b.Uaa;for(let H in x)l.push(appChrome.actions.updateControlHiddenState(H,x[H]));appChrome.api.dispatch(l)}this.HH()},"RSB:I2")},0);return null}).catch(()=>{ia.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(b.oga&&a){Vx.Rcf||(u.AFrameworkApplication.Ta.ya(G.a.wyh,de.a.frame,Object(F.a)(this,this.xyh,"statusBarTabAction")),u.AFrameworkApplication.Ta.ya(G.a.vyh,de.a.frame,Object(F.a)(this,this.xyh,"statusBarTabAction")),
Vx.Rcf=!0);const c=Rr.a.eee(b.oga,b.dal,a,!1);c.bJ=!0;this.OJb(c,G.a.wyh,G.a.vyh)}},0)}HH(){this.RId&&this.G5a&&window.setTimeout(()=>{this.G5a(this.Wlf.selectors.getStatusBarControlsMap(this.Zof),7)},0)}b6(a,b){this.RId&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,b))},0)}OJb(a,b,c){const f=y.KeyInputManager.Oa(A.a.Sq,0),l=y.KeyInputManager.Oa(A.a.Sq,4);a.zp(f);a.zp(l);a.bindAction(f,b);a.bindAction(l,c)}xyh(){return 4}}Vx.Rcf=!1;Object(m.a)(Vx,"ReactStatusBar",
null,[]);class lE{constructor(a,b,c,f,l,x,H){this.Ggc=null;this.Pb=H;this.Ghc=a;this.Ik=f;this.Jek=l;this.Igk=x;this.ZVa=c||new eH.a;this.nh=this.ZVa.fYd(3,"StatusBarUser");a=()=>{this.qIc();this.ZVa.g2c(3)};Ud.a("StatusBarTTVRImprovementEnabled")&&Object(Xa.a)(108,this.Pb)?this.Pb.Qyb(a):this.Pb.gf(a);this.dIg=b;this.dIg.vF(Object(F.a)(this,this.Ckc,"onSlidesTopologyChanged"))}dispose(){this.dIg.bP(Object(F.a)(this,this.Ckc,"onSlidesTopologyChanged"))}qIc(){const a=this.nh.zu("createStatusBar"),
b=new oM;b.Uaa=this.zgj();b.pXj=!1;b.sG=Object(F.a)(this,this.SFl,"updateStatusBarControls");b.uyh="PptEditingStatusBar";Ud.a("ReactStatusBarRTLSupport")&&u.AFrameworkApplication.isRtl&&this.Ghc&&(this.Ghc.style.direction="rtl");this.Ggc=new Vx(this.Ghc,b,!1);this.nh.Fu(a)}HH(){this.Ggc&&this.Ggc.HH()}b6(a,b){this.Ggc&&this.Ggc.b6(this.nxb(a),!b)}nxb(a){const b=this.Jek.M6d(a);return b&&0<b.count?b.ga(0):a}Ckc(a,b){2===b.TZ&&this.HH()}SFl(a){Oc.App.Kb&&Oc.App.Kb.sG(a)}zgj(){const a=this.Igk.Zmj(),
b={};for(const c of Object.keys(a))b[this.nxb(c)]=a[c];u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")&&u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(b[this.nxb("PptEditingStatusBar.GiveFeedbackPane")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.nxb("PptEditingStatusBar.GiveFeedback")]=!0):(b[this.nxb("PptEditingStatusBar.GiveFeedback")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.nxb("PptEditingStatusBar.GiveFeedbackPane")]=!0);return b}}lE.Jyc=null;Object(m.a)(lE,
"ReactStatusBarUser",null,[1135,266]);class qM{constructor(a){this.la=a}Zmj(){const a={};this.la.kzb||(a["PptEditingStatusBar.ZoomScale"]=!0,a["PptEditingStatusBar.FitToWindow"]=!0);this.la.UIb||(a["PptEditingStatusBar.LanguageButton"]=!0);this.la.aua||(a["PptEditingStatusBar.AddInCommandsLoadStatus"]=!0);this.la.officeOnlineInGallatinTextVisible||(a["PptEditingStatusBar.MiddleStatus"]=!0);this.la.avh||(a["PptEditingStatusBar.PerfStats"]=!0);this.la.vg&&(a["PptEditingStatusBar.Reading"]=!0);u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")||
(a["PptEditingStatusBar-SlideSorterView"]=!0);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")||(a["PptEditingStatusBar-PresenterView"]=!0);return a}}Object(m.a)(qM,"StatusBarUserHelper",null,[265]);class mE{constructor(){this.anf=null}get Wlh(){return this.anf||(this.anf=Db.a.instance.ub("Common.IRootManager"))}wb(){}Ee(){}Zng(){}L3k(){this.Wlh&&this.Wlh.wKc()}}Object(m.a)(mE,"ABox4BridgeCommandUi",null,[268,106]);class rM extends mE{constructor(a,b,c,f){super();this.xug=a;this.pB=b;this.ia=
c;this.F$c=f}sG(a){Object(oa.a)(1134,this.pB).dPb(a)}P1(a){return 32===this.ia.La(K.a.P1,2,a)}lFk(){this.xug.clearCache();this.pB.HH()}kPb(){this.pB.kPb()}USe(a){a?a(this.F$c.xsa()):this.F$c.xsa()}Jlg(a){return this.xug.I$b(a)}Zng(){const a=Object(oa.a)(1134,this.pB);a&&a.cZj()}dispose(){}}Object(m.a)(rM,"Box4BridgeCommandUi",mE,[]);var nE=d(1127);class mr{static get f8(){return mr.X6||(mr.X6=Db.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){mr.f8.showContextMenu(a,
b)}static h6(a,b,c){mr.f8.h6(a,b,c)}static qqd(a,b,c,f=null){mr.f8.qqd(a,b,c,f)}}mr.X6=null;Object(m.a)(mr,"BaseContextMenu",null,[]);class up extends bx{constructor(){super();this.hOd();this.UOd()}hOd(){this.addCommandToMaps(Object.assign(new Sa.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignLeft","2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignRight",
"393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",
queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableCenterRight","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));
this.addCommandToMaps(Object.assign(new Sa.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableTopLeft_MLR",
"428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",
queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableBottomLeft_MLR","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));
this.addCommandToMaps(Object.assign(new Sa.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Sa.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Sa.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",populationProps:new eh("681481568",!1),previewControlIds:["buttonStyle0",
"buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Sa.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Sa.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Sa.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));this.addCommandToMaps(Object.assign(new Sa.a("BulletLibrary","3552651681"),
{queryCommandId:"3827179399",populationProps:new eh("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Sa.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Sa.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new eh("462656847",!1)}));this.addCommandToMaps(Object.assign(new Sa.a("ClearFormatting","2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Sa.a("ClearShadingColor",
"3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Sa.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Sa.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Sa.a(up.WAi,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new Sa.a(up.aJi,"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Sa.a("DecreaseIndent","3376107472"),
{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Sa.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Sa.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",
populationProps:new eh("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Sa.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Sa.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new eh("3836866597",!0)}));this.addCommandToMaps(new Sa.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new Sa.a("DictationSettingsHelpShowCommands","2729830074"));
this.addCommandToMaps(Object.assign(new Sa.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Sa.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Sa.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Sa.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Sa.a("FlipHorizontal",
"2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Sa.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Sa.a("FontColor","1970784898"),{legacyControlId:"fontColor",populationProps:new eh("2077552168",!1)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Sa.a("FontName","3430668515"),
{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new eh("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Sa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Sa.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new eh("179506844",
!1)})),this.addCommandToMaps(Object.assign(new Sa.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Sa.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Sa.a("GrammarSettings","3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Sa.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));
this.addCommandToMaps(Object.assign(new Sa.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Sa.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Sa.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Sa.a("IncreaseIndent","4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Sa.a("IndentFirstLine","682091331"),
{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Sa.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Sa.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));this.addCommandToMaps(Object.assign(new Sa.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));
this.addCommandToMaps(Object.assign(new Sa.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertEmoji",
"2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new eh("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Sa.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertPicture",
"2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Sa.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Sa.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new eh("1256496096",
!0),a));let b;this.addCommandToMaps((b=new Sa.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Sa.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new Sa.a("Justify","1733835213"),f.legacyControlId="FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Sa.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",
l));let x;this.addCommandToMaps((x=new Sa.a("LineSpacing","2222099814"),x.legacyControlId="flyLineSpacing",x.populationProps=new eh("2818132660",!0),x));let H;this.addCommandToMaps((H=new Sa.a("LineSpacingOptions","2465215107"),H.legacyControlId="grpParagraphDialogLauncherButton",H));let U;this.addCommandToMaps((U=new Sa.a("LockAspectRatio","3369422509"),U.legacyControlId="toggleBtnLockAspectRatio",U.queryCommandId="4201275867",U));let ja;this.addCommandToMaps((ja=new Sa.a("Margins","1451516907"),
ja.legacyControlId="flyMargins",ja));let ya;this.addCommandToMaps((ya=new Sa.a("MergeCells","4127468093"),ya.legacyControlId="btnMergeTableCells",ya));this.addCommandToMaps(new Sa.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Sa.a("MoreStyles","3340688468"));let Va;this.addCommandToMaps((Va=new Sa.a("MoreSymbols","3574218963"),Va.legacyControlId="btnMoreSymbols",Va));let hb;this.addCommandToMaps((hb=new Sa.a("MultilevelStyle1","3062940477"),hb.queryCommandId="1240192421",hb.menuItemId="MultilevelStyleMultilevelLibrary_1",
hb));let yb;this.addCommandToMaps((yb=new Sa.a("MultilevelStyle2","3062940477"),yb.queryCommandId="1240192421",yb.menuItemId="MultilevelStyleMultilevelLibrary_2",yb));let Zb;this.addCommandToMaps((Zb=new Sa.a("MultilevelStyle3","3062940477"),Zb.queryCommandId="1240192421",Zb.menuItemId="MultilevelStyleMultilevelLibrary_3",Zb));let fc;this.addCommandToMaps((fc=new Sa.a("NoHighlight","562361573"),fc.legacyControlId="noFontBackgroundColor",fc));let Kc;this.addCommandToMaps((Kc=new Sa.a("NumberingLibrary",
"2213049770"),Kc.queryCommandId="3488367157",Kc.populationProps=new eh("3149136033",!1),Kc));let Lc;this.addCommandToMaps((Lc=new Sa.a("Orientation","1451516907"),Lc.legacyControlId="flyOrientation",Lc));let Gc;this.addCommandToMaps((Gc=new Sa.a("ParagraphOptions","2465215107"),Gc.legacyControlId="grpLayoutParagraphDialogLauncherButton",Gc));this.addCommandToMaps(new Sa.a(up.rDk,"237279923"));let ae;this.addCommandToMaps((ae=new Sa.a(up.mDk,"1656143904"),ae.legacyControlId="fseaNewPaste",ae));this.addCommandToMaps(new Sa.a(up.lDk,
"1656143904"));let we;this.addCommandToMaps((we=new Sa.a("PageSize","1451516907"),we.legacyControlId="flySize",we));this.addCommandToMaps(new Sa.a("Photos","2670646631"));let $d;this.addCommandToMaps(($d=new Sa.a("PictureAbsoluteHeight","2808088361"),$d.legacyControlId="spnAbsoluteHeight",$d.queryCommandId="2181343285",$d));let Te;this.addCommandToMaps((Te=new Sa.a("PictureAbsoluteWidth","3108736954"),Te.legacyControlId="spnAbsoluteWidth",Te.queryCommandId="1960824158",Te));this.addCommandToMaps(new Sa.a("Print",
"1588554917"));let Ze;this.addCommandToMaps((Ze=new Sa.a("PrintToWeb","1997662572"),Ze.legacyControlId="jbtnDigitalPrint",Ze));let Vf;this.addCommandToMaps((Vf=new Sa.a("ReadingView","3849298593"),Vf.legacyControlId="btnReadingMode",Vf));let gg;this.addCommandToMaps((gg=new Sa.a("Redo","4183277502"),gg.legacyControlId="btnRedo",gg));let Qg;this.addCommandToMaps((Qg=new Sa.a("ResetPicture","2916220093"),Qg.legacyControlId="btnResetPicture",Qg));let Rg;this.addCommandToMaps((Rg=new Sa.a("RightToLeftTextDirection",
"2632572640"),Rg.legacyControlId="TextDirRTL",Rg.queryCommandId="1154760330",Rg));let Wf;this.addCommandToMaps((Wf=new Sa.a("RotatePictureMenu","2545543284"),Wf.legacyControlId="flyRotate",Wf));let rg;this.addCommandToMaps((rg=new Sa.a("RotateLeft90","2545543284"),rg.legacyControlId="buttonRotateLeft90",rg.menuItemId="buttonRotateLeft90",rg));let Sg;this.addCommandToMaps((Sg=new Sa.a("RotateRight90","2545543284"),Sg.legacyControlId="buttonRotateRight90",Sg.menuItemId="buttonRotateRight90",Sg));let Gh;
this.addCommandToMaps((Gh=new Sa.a("SelectCell","111222446"),Gh.legacyControlId="btnSelectCell",Gh));let Zi;this.addCommandToMaps((Zi=new Sa.a("SelectColumn","2341852628"),Zi.legacyControlId="btnSelectColumn",Zi));let Ei;this.addCommandToMaps((Ei=new Sa.a("SelectRow","3508003794"),Ei.legacyControlId="btnSelectRow",Ei));let fj;this.addCommandToMaps((fj=new Sa.a("SelectTable","2306914518"),fj.legacyControlId="btnSelectTable",fj));let Fi;this.addCommandToMaps((Fi=new Sa.a("ShrinkFontSize","3575191971"),
Fi.legacyControlId="fseaShrinkFontSize",Fi));let Gi;this.addCommandToMaps((Gi=new Sa.a("SetProofingLanguage","510284732"),Gi.legacyControlId="fseaOpenLanguageDialog",Gi));let Mk;this.addCommandToMaps((Mk=new Sa.a("SpacingAfter","2322582597"),Mk.legacyControlId="spnSpacingAfter",Mk.queryCommandId="2340669283",Mk));let Cj;this.addCommandToMaps((Cj=new Sa.a("SpacingBefore","1804274502"),Cj.legacyControlId="spnSpacingBefore",Cj.queryCommandId="26138520",Cj));let Bk;this.addCommandToMaps((Bk=new Sa.a("SpecialIndent",
"2798144440"),Bk.legacyControlId="flySpecialIndent",Bk));let Il;this.addCommandToMaps((Il=new Sa.a("Spelling","2646312425"),Il.legacyControlId="fseaNextSpellingError",Il));let lk;this.addCommandToMaps((lk=new Sa.a("StandardShadingColorPicker","2765388691"),lk.legacyControlId="cellShadingColorTable",lk));this.addCommandToMaps(new Sa.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Sa.a("RecentFontColorPicker","1970784898"));let Jl;this.addCommandToMaps((Jl=new Sa.a("Strikethrough",
"4169095173"),Jl.legacyControlId="fsbcStrikethrough",Jl.queryCommandId="2742230607",Jl));let Vj;this.addCommandToMaps((Vj=new Sa.a("StyleOptionsBandedColumns","1583455318"),Vj.legacyControlId="buttonBandedColumn",Vj.queryCommandId="1762426222",Vj.menuItemId="buttonBandedColumn",Vj));let Wj;this.addCommandToMaps((Wj=new Sa.a("StyleOptionsBandedRows","1583455318"),Wj.legacyControlId="buttonBandedRow",Wj.queryCommandId="1762426222",Wj.menuItemId="buttonBandedRow",Wj));let sk;this.addCommandToMaps((sk=
new Sa.a("StyleOptionsFirstColumn","1583455318"),sk.legacyControlId="buttonFirstColumn",sk.queryCommandId="1762426222",sk.menuItemId="buttonFirstColumn",sk));let kl;this.addCommandToMaps((kl=new Sa.a("StyleOptionsHeaderRow","1583455318"),kl.legacyControlId="buttonFirstRow",kl.queryCommandId="1762426222",kl.menuItemId="buttonFirstRow",kl));let vj;this.addCommandToMaps((vj=new Sa.a("StyleOptionsLastColumn","1583455318"),vj.legacyControlId="buttonLastColumn",vj.queryCommandId="1762426222",vj.menuItemId=
"buttonLastColumn",vj));let vh;this.addCommandToMaps((vh=new Sa.a("StyleOptionsTotalRow","1583455318"),vh.legacyControlId="buttonLastRow",vh.queryCommandId="1762426222",vh.menuItemId="buttonLastRow",vh));let ll;this.addCommandToMaps((ll=new Sa.a("Subscript","1455408143"),ll.legacyControlId="fsbcSubscript",ll.queryCommandId="3960255053",ll));let Xl;this.addCommandToMaps((Xl=new Sa.a("Superscript","1107614"),Xl.legacyControlId="fsbcSuperscript",Xl.queryCommandId="692901994",Xl));let xm;this.addCommandToMaps((xm=
new Sa.a("Table","28738965"),xm.legacyControlId="flyInsertTable",xm));let Nk;this.addCommandToMaps((Nk=new Sa.a("TableStyles","4171428777"),Nk.queryCommandId="2135594455",Nk.populationProps=new eh("3359297384",!1),Nk.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),Nk));this.addCommandToMaps(Object.assign(new Sa.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));
this.addCommandToMaps(Object.assign(new Sa.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Sa.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Sa.a("TextAlignmentLeftJustify","2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));
this.addCommandToMaps(Object.assign(new Sa.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Sa.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Sa.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Sa.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Sa.a("ThemeFontColorPickerMCU","1970784898"));this.addCommandToMaps(new Sa.a("ToggleChangeCase",
"1208649786"));this.addCommandToMaps(Object.assign(new Sa.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Sa.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Sa.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Sa.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Sa.a("EditInClient","3588168074"),{legacyControlId:"btnjEditInClient"}));
this.addCommandToMaps(Object.assign(new Sa.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let Ok;this.addCommandToMaps((Ok=new Sa.a("PrintDocument","1588554917"),Ok.legacyControlId="jbtnDirectPrint",Ok));let pi;this.addCommandToMaps((pi=new Sa.a("PrintToPdf","1588554917"),pi.legacyControlId="jbtnPrintToPdf",pi));let Hg;this.addCommandToMaps((Hg=new Sa.a("ProtectDocument","1642700244"),Hg.legacyControlId="btnProtectDocument",Hg.queryCommandId="3993403020",Hg));let qi;this.addCommandToMaps((qi=
new Sa.a("TransformToWebPage","1997662572"),qi.legacyControlId="jbtnTransformToWeb",qi));let hg;this.addCommandToMaps((hg=new Sa.a("OpenInClientWithIcon","3588168074"),hg.legacyControlId="btnOpenInClient",hg));let Ld;this.addCommandToMaps((Ld=new Sa.a("BulletLibrary_MLR","3552651681"),Ld.queryCommandId="3827179399",Ld.populationProps=new eh("2466004410",!1),Ld));let Oe;this.addCommandToMaps((Oe=new Sa.a("InsertPicture_MLR","2670646631"),Oe.legacyControlId="fseaInsertPicture",Oe));let yf;this.addCommandToMaps((yf=
new Sa.a("NumberingLibrary_MLR","2213049770"),yf.queryCommandId="3488367157",yf.populationProps=new eh("3149136033",!1),yf));let le;this.addCommandToMaps((le=new Sa.a("PasteStandalone","237279923"),le.legacyControlId="fseaPaste",le));let Fg;this.addCommandToMaps((Fg=new Sa.a("Clipboard_MLR","237279923"),Fg.legacyControlId="fseaNewPaste",Fg));let $h;this.addCommandToMaps(($h=new Sa.a("InsertOnlinePictureStandalone","1685987254"),$h.legacyControlId="fseaInsertOnlinePicture",$h));let ji;this.addCommandToMaps((ji=
new Sa.a("InsertPictureFromHostStandalone","720118144"),ji.legacyControlId="fseaInsertOnlinePictureFromHost",ji.queryCommandId="3612507612",ji))}UOd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}up.aJi="Cut";up.WAi="Copy";up.rDk="Paste";up.mDk="PasteAsTextOnly";up.lDk="PasteAsTextOnlyContextMenu";Object(m.a)(up,"Box4ReactCommandDefinitionMapping",bx,[]);class Ej extends mr{constructor(a,b,c){super();this.Glf=b;this.Gm=c;this.wb(a)}wb(a){a.ra(D.a.Yhd,Cb.a.application,
Object(F.a)(this,this.T$g,"populateContextMenu"),96);a.ra(D.a.Y$g,Cb.a.application,Object(F.a)(this,this.T$g,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const x=this.Zfj(a);if(x&&(a=a.Ua.node)&&(a=a.sc(sa.InteractiveViewManager.instance.Pd.Ma))){l=N.a.Ot(a,x.end);if(u.AFrameworkApplication.isRtl&&l.x>b.x||!u.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=N.a.Ot(a,x.end-1);b.x=l.x+(u.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}mr.qqd("mnuSpellingError",
new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}T$g(a,b,c,f,l){if(1===c)return 32;a=l.Hu;l=l.rd;b=Object.assign(new tm.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.JEi(b,a);l.MenuItems=b;return 32}Jbe(a,b){return this.dwh(a)||Ej.eEf(D.a.mergeCells)||Ej.eEf(D.a.splitCells)||this.Cml(a,b)||this.lkl(a,b)||Ej.yll()||Ej.Hvh(a).returnValue}dwh(a){return 2===Oc.App.Kb.mode&&this.UZc(a)}z1b(a,b,c,f=null){if(this.dwh(a)){c=this.Yfj(a);var l=Ya.a.xe(c.lcid);l=l?l.name:"UNKNOWN";
var x=Object(Xa.a)(Po.a,c)?c.typeId:"";ia.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,x,l);f?(a=this.Glf.v1b(a,c))&&f.push.apply(f,a):b.append(this.Glf.create(a,c))}}Yfj(a){return this.Gm.OSa(a.Ua).Gh}UZc(a){return this.Gm.Fpc(a)}X0f(){return null}Zfj(a){return this.UZc(a)?this.Gm.OSa(a.Ua):(a=this.X0f(a))?new Kk.a(a.vN,a.Mb):null}Cml(a,b){if(2!==Oc.App.Kb.mode||!a||!Ej.IQj&&this.Dml(a,b))return!1;a=Wa.a.XQa(a.toArray());
return!!Ej.km.Q2(a,14)}Dml(a,b){return 2===b||3===b&&!this.UZc(a)}lkl(a,b){return 3!==b||this.UZc(a)}static get Sf(){return Ej.Vg||(Ej.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static get km(){return Ih.ContextSetEditor.instance}static get IQj(){return 1===Oc.App.mode}static get mOj(){null==Ej.zDd&&(Ej.zDd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Ej.zDd}static get kjc(){null==Ej.X1a&&(Ej.X1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):
!1);return Ej.X1a}static get CS(){null==Ej.XM&&(Ej.XM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ej.XM}static eEf(a){return 32===u.AFrameworkApplication.Ta.processAction(a,1)}static yll(){return 2===Oc.App.Kb.mode&&!!Oc.App.OD.QS&&Oc.App.OD.QS.Jlg("510284732")}static Hvh(a){let b,c;b=c=!1;if(!a)return{returnValue:!1,RTa:b,k8b:c};if(Ej.kjc)return Ej.mll(a);if(!(a.Cca||Ej.mOj&&2===a.length&&a.Ye.contextId===Cb.a.endOfParagraph))return{returnValue:!1,
RTa:b,k8b:c};a=a.Ua.clone();b=32===u.AFrameworkApplication.Ta.mi(a,D.a.oJa,1,!0,null,null);c=32===u.AFrameworkApplication.Ta.mi(a,D.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,RTa:b,k8b:c}}static mll(a){let b;let c;var f=a.Ua.clone();c=Ej.CS&&gf.m(f);b=!c&&32===u.AFrameworkApplication.Ta.mi(f,D.a.oJa,1,!0,null,null);if(a.Cca||2===a.length&&a.Ye.contextId===Cb.a.endOfParagraph)f=!c&&32===u.AFrameworkApplication.Ta.mi(f,D.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let x=
0;x<l;x++){const H=a.ga(x).clone();if(H.contextId===Cb.a.paragraph||H.contextId===Cb.a.textRange)(c=Ej.CS&&gf.m(H))||(f=32===u.AFrameworkApplication.Ta.mi(H,D.a.insertHyperlink,1,!0,null,null)&&f);else if(H.contextId!==Cb.a.endOfParagraph)return f=b=!1,{returnValue:!1,RTa:b,k8b:f}}}return{returnValue:b||f,RTa:b,k8b:f}}static YDi(a,b){let c=!1,f=!1;({RTa:c,k8b:f}=Ej.Hvh(a)).returnValue&&(c?f?b.push(Ej.u8d(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(Ej.u8d(["OpenHyperlink"])):
f&&b.push(Ej.u8d(["InsertLink"])))}static u8d(a){const b=Object.assign(new hk.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:c}));return b}}Ej.zDd=null;Ej.Vg=null;Ej.X1a=null;Ej.XM=null;Object(m.a)(Ej,"AEditSurfaceContextMenu",mr,[]);class $z extends Ej{constructor(a,b,c,f,l,x,H,U,ja,ya){super(a,c,b,void 0,ya);this.fWa=0;this.cre=f;this.wGa=l;this.la=x;this.W9c=this.la.UIb;this.Zdc=this.la.y8b;this.LUg=this.la.k0c;this.SUg=this.la.lme;this.JXa=this.la.ejb;
this.p7j=this.la.pmc;this.oOg=ya;this.NC=b;this.oQg=H;this.uE=U;this.Tb=ja;this.o9c=this.la.KEk}JEi(a,b){const c=[];switch(this.fWa){case 4:this.kra(c,!0);this.Ssf(c);this.E5h(c);this.W5h(c);this.JXa&&this.e7h(c);this.yYb(c);this.BPa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.kra(c,!1);this.ROd(c,this.fWa);this.yYb(c);this.BPa(c);this.Ztb(c);break;case 6:case 5:this.kra(c,!1);this.ROd(c,this.fWa);this.la.UIb&&this.la.Ish&&this.Qsf(c);this.BPa(c);this.Ztb(c);break;case 2:this.kra(c,
!0);this.iGc(c,!0);this.la.Jn&&this.hGc(c);break;case 1:this.kra(c,!1);this.iGc(c,!1);this.la.izh&&this.F7h(c);this.Ssf(c);this.Isf(c);hx.Cth&&this.ytf(c);this.la.Jn&&this.hGc(c);this.yYb(c);this.BPa(c);this.Ztb(c);break;case 3:this.u4h(c);this.Ztb(c);break;case 19:this.x7h(c);this.iGc(c,!1);this.Isf(c);hx.Cth&&this.ytf(c);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.hGc(c);this.yYb(c);break;case 21:this.l8h(c);break;case 20:this.kra(c,!0);this.iGc(c,!0);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
this.hGc(c);this.yYb(c);break;case 9:this.kra(c,!1);this.BPa(c);break;case 22:this.kra(c,!1);this.ROd(c,this.fWa);this.BPa(c);break;case 10:this.kra(c,!1);this.u6h(c);this.BPa(c);this.Ztb(c);break;case 17:this.p6h(c);break;case 18:this.q6h(c);break;case 0:if(this.Tb.pj()){var f=sa.InteractiveViewManager.instance.Pd.Lb.Na.mb;this.z1b(f,null,b,c);this.kra(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.w7h(c),this.K7h(c));3===b&&this.RPj(f)&&this.i5h(c);this.J6h(c);Ej.YDi(f,c);this.wHi(f,c);this.vHi(f,
c);this.W9c&&this.Qsf(c);this.ECi(c);this.BPa(c);this.Ztb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.fWa=0}Hph(a){this.fWa=a}Pt(){return Object.assign(new hk.a,{ControlList:[]})}Bml(a){if(!this.LUg&&!this.SUg||2!==Oc.App.Kb.mode)return!1;a=Wa.a.XQa(a.toArray());return!!this.wGa.Q2(a,14)}Aml(a){if(!a||!this.p7j||2!==Oc.App.Kb.mode)return!1;a=Wa.a.XQa(a.toArray());return!!this.wGa.Q2(a,14)}kra(a,b){const c=this.Pt();b||(Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"Cut"})),
Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"Copy"})));this.ctf(a,c)}ctf(a,b){const c=Object.assign(new hk.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new sq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);
for(let l=1;5>=l;l++)f.GalleryItems.push(this.ewb(l));a.push(b);a.push(c)}ewb(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;
break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new nE.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}l8h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"CopyInVersionHistory"}));
a.push(b)}x7h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"Copy"}));this.ctf(a,b)}iGc(a,b){const c=this.Pt();Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"DeleteSlide"})));a.push(c)}E5h(a){if(this.o9c){const b=this.Pt();
b.ControlList.push(Object.assign(new fg.a,{ExternalId:"FormatBackgroundFromCanvas"}));a.push(b)}}u4h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}Isf(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"HideSlide"}));this.la.Ace&&Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"UnhideSlide"}));a.push(b)}ytf(a){const b=
this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"ShareSlide"}));a.push(b)}q6h(a){const b=this.c0f();a.push(b)}hGc(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"AddSection"}));a.push(b)}ROd(a,b){const c=this.Pt();7===b?(this.la.OJa?Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"ChangePicture"})),this.la.VXf&&this.F5h(c),this.la.EUa&&Array.add(c.ControlList,
Object.assign(new fg.a,{ExternalId:"AlternativeText"}))):13===b?this.la.OJa&&Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.Gsf(c),this.la.gQc&&this.ysf(c));this.lsf(c);this.Vzf(c);this.Toh(c);a.push(c)}Ssf(a){const b=this.Pt();Array.add(b.ControlList,
Object.assign(new fg.a,{ExternalId:this.la.a_a?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}Qsf(a){const b=this.Pt();this.Zdc&&Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}yYb(a){if(this.Zdc){var b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}Toh(a){Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"SendToBackFlyout"}))}Vzf(a){Array.add(a.ControlList,
Object.assign(new fg.a,{ExternalId:"BringToFrontFlyout"}))}Gsf(a){Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"GroupAnchor"}))}lsf(a){Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"ShowHideFormatShapePane"}))}F5h(a){Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"FormatPicture"}))}ysf(a){Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"FixIt"}))}u6h(a){const b=this.Pt();this.Gsf(b);this.la.gQc&&this.ysf(b);this.lsf(b);this.Vzf(b);this.Toh(b);a.push(b)}BPa(a){const b=
this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"InsertComment"}));a.push(b)}W5h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"DesignerHome"}));a.push(b)}e7h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"ShowHideRuler"}));a.push(b)}fEi(){const a=this.cre.bHi();return Object.assign(new fg.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}w7h(a){const b=this.Pt();Array.add(b.ControlList,this.fEi());a.push(b)}K7h(a){if(!this.cre.yri()){var b=
this.cre.rHi();if(b){var c=this.Pt();Array.add(c.ControlList,Object.assign(new fg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}J6h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"ParagraphOptions"}));a.push(b)}i5h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"Delete"}));a.push(b)}F7h(a){const b=this.Pt();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"SummarizeSlides"}));a.push(b)}ECi(a){var b=Db.a.instance.ub("PowerPointWebEditor.IContextMenuExtensibilityHandler");
b&&(b=b.o1i())&&a.push(b)}wHi(a,b){a&&this.Bml(a)&&(a=this.Pt(),this.LUg&&Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"MergeTableCells"})),this.SUg&&Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"SplitTableCells"})),b.push(a))}vHi(a,b){this.Aml(a)&&(a=this.Pt(),Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"TableDistribute"})),b.push(a))}RPj(a){return this.NC.Fpc(a)}p6h(a){const b=
this.c0f();Array.add(b.ControlList,Object.assign(new fg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}c0f(){const a=this.Pt();Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"MoveSectionUp"}));Array.add(a.ControlList,Object.assign(new fg.a,{ExternalId:"MoveSectionDown"}));return a}Ztb(a){this.oQg&&this.oQg.v1b(this.U4b(),a)}U4b(){return this.uE.instance?
this.uE.instance.U4b():[]}}Object(m.a)($z,"EditSurfaceContextMenu",Ej,[]);class sM{constructor(a,b,c,f,l,x,H,U,ja,ya){this.fhc=null;this.VEb=0;this.KO=b;this.pB=c;this.Jla=f;this.zb=x;this.Q6j=H;this.ia=ja;this.Lc=U;this.Lc.P8h(Object(F.a)(this,this.$1g,"onCUIStatusChanged"));this.Lc.sGc(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lc.zGc(Object(F.a)(this,this.Wgb,"onSetFocus"));this.F$c=ya}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Lc.UXk(Object(F.a)(this,this.$1g,
"onCUIStatusChanged"));this.Lc.mld(Object(F.a)(this,this.AU,"onFocusChanged"));this.Lc.eRe(Object(F.a)(this,this.Wgb,"onSetFocus"))}initialize(){this.wb();this.HH()}AU(){}Wgb(a,b){b.vgb!==zb.a.waa||b.JIb===E.AFrame.hgb||b.JIb.endsWith("/modal")||appChrome.api.enterKeytipMode()}Vxl(a){this.VEb|=a;this.fhc||(this.fhc=new af.a(0,1,0,Object(F.a)(this,this.mel,"setTimeOutWithCurrentActionContext"),90,"11"),this.fhc.customData=new Date,this.zb.Db(this.fhc))}wb(){this.ia.ra(K.a.P1,rc.a.application,Object(F.a)(this,
this.Ntj,"handleOpenMenu"),64)}Ntj(a,b,c,f,l){return this.P1(l)?32:8}mel(a){Tc.a.sTi(Object(F.a)(this,this.HH,"poll"),Object(oa.a)(Date,a.customData));this.fhc=null}$1g(a,b){this.Vxl(b.Eql)}HH(){this.Q6j.clearCache();0!==(this.VEb&1)&&this.pB.HH();0!==(this.VEb&2)&&this.KO.HH();0!==(this.VEb&4)&&this.Jla.HH();this.VEb=0}P1(a){return this.F$c.P1(a)}}Object(m.a)(sM,"CUIManager",null,[264,106]);var oE=d(1232),pE=d(1204),fR=d(1070),qE=d(1091);class ct{constructor(){this.italic=0;this.L0c=!1;this.underline=
0;this.pV=this.bud=!1;this.superscript=0;this.Krd=!1;this.subscript=0;this.Grd=!1;this.strikethrough=0;this.yrd=!1;this.Zs=0;this.SNc=!1;this.fontName=null;this.E4b=this.Isd=this.sQc=this.rQc=!1;this.highlight=0;this.oWc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.Zs=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.Ow=Kd.Font.uHj;this.cpa=-1;this.xSd=this.L0c=this.bud=this.pV=this.Krd=this.Grd=this.yrd=this.SNc=this.rQc=this.sQc=this.Isd=this.E4b=
this.oWc=!1}}Object(m.a)(ct,"FormattingData",null,[]);var rE=d(826),gR=d(792);class Zk{constructor(){this.Wm=this.ahb=0;this.rd=null;this.dG=!1;this.dL=null}}Object(m.a)(Zk,"CuiEnabledInfo",null,[]);class jh{constructor(){this.Wm=this.ahb=0;this.rd=null;this.dG=this.ele=this.fle=this.dX=this.$q=this.kce=!1;this.dL=null}}Object(m.a)(jh,"CuiExecuteInfo",null,[]);class hR{constructor(){this.O_e=new lq.a;this.Uje=!1}}Object(m.a)(hR,"TextRangeStyleData",null,[]);class Dg{constructor(){this.jb=new Rd.a;
this.Xc=new Rd.a;this.kcf=new ct;this.Jkf=new rE.a;this.SBd=this.RBd=!1}initialize(){Dg.Kzh=Dg.yYd();this.jb.$(D.a.undo,Dg.I8b);this.jb.$(D.a.redo,Dg.I8b);this.jb.$(D.a.Hdd,Dg.I8b);this.jb.$(D.a.Y$g,Dg.Fwl);this.jb.$(D.a.openInClient,Dg.Lzk);this.jb.$(G.a.close,Dg.xui);this.jb.$(D.a.$K,Dg.wMi);this.jb.$(D.a.font,Dg.m4d);this.jb.$(D.a.Pq,Object(F.a)(this,this.b5d,"genericFontSizeExecuteBridge"));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.jb.$(D.a.P5,Dg.m4d),this.jb.$(D.a.DKa,Dg.m4d),
this.jb.$(D.a.QJa,Object(F.a)(this,this.b5d,"genericFontSizeExecuteBridge")),this.jb.$(D.a.A_a,Object(F.a)(this,this.p3k,"revertPreviewFontSizeExecuteBridge")));this.jb.$(D.a.bold,Dg.Rvb);this.jb.$(D.a.setItalic,Dg.Rvb);this.jb.$(D.a.underline,Dg.Rvb);this.jb.$(D.a.strikethrough,Dg.Rvb);this.jb.$(D.a.superscript,Dg.Rvb);this.jb.$(D.a.subscript,Dg.Rvb);this.jb.$(D.a.Nmc,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Wmc,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));
this.jb.$(D.a.Gnc,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.wnc,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.ync,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.hOe,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.znc,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.bjd,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.Rmc,Object(F.a)(this,this.Lxa,
"queryFormattingExecuteBridge"));this.jb.$(D.a.cjd,Object(F.a)(this,this.Lxa,"queryFormattingExecuteBridge"));this.jb.$(D.a.wNe,Object(F.a)(this,this.SLk,"queryFormatPainterExecuteBridge"));this.jb.$(D.a.Xmc,Object(F.a)(this,this.mjd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.inc,Object(F.a)(this,this.mjd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.Qmc,Object(F.a)(this,this.mjd,"queryParaFormattingExecuteBridge"));this.jb.$(D.a.Smc,Object(F.a)(this,this.mjd,"queryParaFormattingExecuteBridge"));
this.jb.$(D.a.oC,Dg.iTf);this.jb.$(D.a.By,Dg.iTf);this.jb.$(G.a.LVd,Dg.Pmc);this.jb.$(D.a.OAb,Dg.I8b);this.Xc.$(D.a.dIb,Dg.jNc);this.Xc.$(D.a.eIb,Dg.jNc);this.Xc.$(D.a.Rlc,Dg.jNc);this.Xc.$(D.a.Qlc,Dg.jNc);this.Xc.$(D.a.Nmc,Dg.Xxa);this.Xc.$(D.a.Wmc,Dg.Xxa);this.Xc.$(D.a.Gnc,Dg.Xxa);this.Xc.$(D.a.wnc,Dg.Xxa);this.Xc.$(D.a.ync,Dg.Xxa);this.Xc.$(D.a.hOe,Dg.Xxa);this.Xc.$(D.a.znc,Dg.Xxa);this.Xc.$(D.a.bjd,Dg.Xxa);this.Xc.$(D.a.Rmc,Dg.Xxa);this.Xc.$(D.a.cjd,Dg.Xxa);this.Xc.$(D.a.Xmc,Dg.Ykd);this.Xc.$(D.a.Qmc,
Dg.Ykd);this.Xc.$(D.a.inc,Dg.Ykd);this.Xc.$(D.a.Smc,Dg.Ykd);this.jb.$(D.a.IGf,Object(F.a)(this,this.oGj,"insertHyperLinkBridge"));this.jb.$(D.a.QVd,Object(F.a)(this,this.HGf,"commandingInputMethodExecuteBridge"));this.jb.$(D.a.MGf,Object(F.a)(this,this.HGf,"commandingInputMethodExecuteBridge"));this.jb.$(D.a.JGf,Object(F.a)(this,this.xGj,"insertOnLinePictureExecuteBridge"));this.jb.$(D.a.KGf,Object(F.a)(this,this.NGj,"insertSymbolBridge"));this.jb.$(D.a.LGf,Object(F.a)(this,this.Fvi,"commandingInsertTableExecuteBridge"));
this.jb.$(D.a.Gvi,Object(F.a)(this,this.onk,"navToPageExecuteBridge"));this.jb.$(D.a.GGf,Dg.FGf);this.jb.$(D.a.PVd,Dg.FGf);u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Xc.$(G.a.ZKb,Dg.y6k)}clearCache(){this.kcf=new ct;this.Jkf=new rE.a;this.SBd=this.RBd=!1}s1f(a,b,c){const f=this.jb.ga(a);f?c=f(a,b,c):(c=new jh,c.rd=b);c.ahb=a;c.Wm||(c.Wm=Dg.Ijk(a));Pg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&
this.yvi(a,b)&&(c.rd||(c.rd={}),"object"===typeof c.rd&&(c.rd.MappedCommand=!0));return c}vSc(a,b=null){const c=this.Xc.ga(a);b=c?c(a,b):new Zk;b.ahb=a;b.Wm||(b.Wm=a);return b}Lxa(){const a=new jh;a.kce=this.SBd;this.SBd=!0;a.Wm=D.a.bJb;a.rd=this.kcf;a.dX=!0;return a}mjd(){const a=new jh;a.kce=this.RBd;this.RBd=!0;a.Wm=D.a.Mxa;a.rd=this.Jkf;a.ele=!0;a.dX=!0;return a}b5d(a,b){const c=new jh;c.$q=!0;let f=0;({number:f}=ha.a.NCk(b.CommandValueId||b.Value,u.AFrameworkApplication.numberFormat));if(isNaN(f))return Oc.App.Kb.updateCommandUI(),
c.dL=!1,c;a===D.a.QJa&&(b[Zm.a.Haa]=!1);c.rd=Dg.pXd(Math.floor(2*f),b);return c}p3k(a,b){a=new jh;a.$q=!0;b[Zm.a.Haa]=!1;a.rd=Dg.pXd(0,b);return a}HGf(a){var b={Visible:!0};a===D.a.QVd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new pE.a(b,2);b=new jh;b.rd=a;return b}xGj(a,b){a=new jh;const c=new J.DictionaryPropertySet;b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(Mc.a.FU,b);a.rd=c;return a}oGj(a,
b){a=new jh;b.Source="CommandingInterface";a.rd=b;return a}Fvi(a,b){a=new jh;a.$q=!0;const c=new xI;c.rows=b.Row;c.columns=b.Col;a.rd=c;return a}NGj(a,b){a=new jh;a.$q=!0;b=b.Value;a.rd=new J.DictionaryPropertySet;const c=this.uUc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',c);a.rd=f;return a}onk(a,b){a=new jh;a.rd=b.Value?b.Value:"";return a}SLk(){const a=new jh;a.rd=Db.a.instance.ub("Box4.IFormatPainter");
a.dX=!0;return a}uUc(a){return Dg.Kzh[a.toString()]}yvi(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Xc.ga(a)||!!this.jb.ga(a);return!u.AFrameworkApplication.Ta.dT(a)&&b}static yYd(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static oZb(a,
b){var c=Object(oa.a)(ct,a.rd),f=Object(oa.a)(rE.a,a.rd);let l=!0;switch(a.ahb){default:l=!1;break;case D.a.Xch:b[Sh.a.On]=!0;break;case D.a.Nmc:b[Sh.a.On]=1===c.bold;break;case D.a.Wmc:b[Sh.a.On]=1===c.italic;break;case D.a.Gnc:b[Sh.a.On]=1===c.underline;break;case D.a.hOe:b[SG.a.On]=1===c.subscript;break;case D.a.ync:b[Sh.a.On]=1===c.subscript;break;case D.a.znc:b[Sh.a.On]=1===c.superscript;break;case D.a.wnc:b[Sh.a.On]=1===c.strikethrough||1===c.Zs;break;case D.a.bjd:b[eo.a.IsFreeForm]=!0;b[eo.a.Value]=
void 0!==c.fontName&&null!==c.fontName?gc.a.Z0f(c.fontName,c.cpa):"";break;case D.a.Rmc:a="";-1!==c.fontSize&&(a=ha.a.GQc(c.fontSize/2,0,u.AFrameworkApplication.numberFormat));b[eo.a.IsFreeForm]=!0;b[eo.a.Value]=a;break;case D.a.cjd:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=da.FontUtils.TLk(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===
c.fontName)a=gc.a.Z0f(c.fontName,c.cpa),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=da.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[fo.SelectedFont]=a;break;case D.a.Xmc:b[Sh.a.On]=1===f.Jl;break;case D.a.Qmc:b[Sh.a.On]=2===f.Jl;break;case D.a.inc:b[Sh.a.On]=3===f.Jl;break;case D.a.Smc:b[Sh.a.On]=6===f.Jl;break;case D.a.wNe:if(c=
Object(oa.a)(617,a.rd))b[Sh.a.On]=c.wL;case G.a.LVd:}return l}static iTf(){return new jh}static Pmc(a,b){a=new jh;a.rd=b;a.dX=!0;return a}static I8b(a,b,c){a=new pE.a(b,c.InvocationMethod);b=new jh;b.rd=a;return b}static Fwl(a,b){a=new pE.a(b,3);b=new jh;b.rd=a;return b}static Lzk(a,b,c){a=new jh;fR.a.Zpg(c.CommandLocation)||26===c.CommandLocation||(a.rd=!1);return a}static oNe(){const a=new jh;a.rd=new J.DictionaryPropertySet;a.dX=!0;return a}static wMi(){const a=new jh;a.rd=new J.DictionaryPropertySet;
return a}static xui(){const a=new jh;a.rd=zh.b;return a}static jNc(){const a=new Zk;a.rd=new J.DictionaryPropertySet;return a}static y6k(a,b=null){a=new Zk;a.rd=b;return a}static Rvb(){const a=new jh;a.rd=new Q(2);a.$q=!0;return a}static Ykd(){const a=new Zk;a.Wm=D.a.Mxa;return a}static Xxa(){const a=new Zk;a.Wm=D.a.bJb;return a}static m4d(a,b){const c=new jh;c.$q=!0;var f=b.CommandValueId?b.CommandValueId:b.Value;c.rd=f;if(Kd.Font.PUa()){const x=new ct;var l=b.MenuItemId;l&&(x.cpa=Kd.Font.nmj(l));
(l=Object(oa.a)(gR.a,b[fo.Formatting]))&&(l.isBold||l.isItalic)&&(x.bold=l.isBold?1:0,x.italic=l.isItalic?1:0);x.fontName=f;c.rd=x}Dg.u2j(b);(a=u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===D.a.P5||a===D.a.DKa))&&(b[Zm.a.Haa]=!1);c.rd=Dg.pXd(c.rd,b);a||(da.FontUtils.aGc(f),f=b[fo.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,f)));return c}static u2j(a){void 0!==a[eo.a.IsFreeForm]&&null!==a[eo.a.IsFreeForm]&&a[eo.a.IsFreeForm]?
ia.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&ia.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static FGf(a,b){a=new jh;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.rd=Dg.y7a(b);a.$q=!0;return a}static y7a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,4)+a.substring(0,2)}static Ijk(a){switch(a){case D.a.QVd:return D.a.undo;case D.a.MGf:return D.a.redo;
case D.a.LGf:return D.a.insertTable;case D.a.JGf:return D.a.Z7;case D.a.KGf:return D.a.mUa;case D.a.IGf:return D.a.insertHyperlink;case D.a.GGf:return D.a.Sr;case D.a.PVd:return D.a.v1;default:return a}}static pXd(a,b){const c=new qE.a(a);return u.AFrameworkApplication.Aa.hb.Np?new qE.a(a,b[Zm.a.Haa]):c}}Dg.Kzh={};Object(m.a)(Dg,"CuiActionBridge",null,[]);class tM{constructor(){this.YQd=this.oZb=this.fLe=this.JLe=null}}Object(m.a)(tM,"GeneralCuiUserHooks",null,[]);var iR=d(499);class Jv{constructor(){this.XU=
this.VZa=null;this.menuItemId=0}}Object(m.a)(Jv,"QueryData",null,[]);let sf;class Hd extends Dg{constructor(a,b,c,f,l,x,H,U){super();this.la=a;this.pa=b;this.d5j=c;this.rEb=f;this.yc=l;this.Tb=x;this.Fb=H;this.JWa=U}initialize(){super.initialize();this.pFj();this.HFj();this.IEj();this.tFj();this.YDj();this.EFj();this.$Ej();this.aEj();this.zEj();this.iEj()}vSc(a,b=null){if(u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Xc.ga(a);b=c?c(a,b):new Zk;b.ahb=
a;b.Wm||(b.Wm=a);b&&this.Fb&&1===this.Fb.Fl&&!Hd.Oie(a)&&(b.dL=!1);return b}(b=super.vSc(a))&&this.Fb&&1===this.Fb.Fl&&!Hd.Oie(a)&&(b.dL=!1);return b}pFj(){this.la.fjb&&(this.Xc.$(K.a.Lhb,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge")),this.Xc.$(K.a.IIb,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge")),this.Xc.$(G.a.nOb,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge")),this.Xc.$(K.a.prc,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge")),this.Xc.$(D.a.oOb,Object(F.a)(this,
this.aoa,"remapRumTrackerEnabledBridge")),this.Xc.$(G.a.Tsa,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge")));this.Xc.$(K.a.lLa,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge"));this.Xc.$(K.a.jLa,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge"));this.Xc.$(K.a.jga,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge"));this.Xc.$(K.a.Vya,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge"));this.Xc.$(K.a.hvc,Object(F.a)(this,this.aoa,"remapRumTrackerEnabledBridge"))}HFj(){this.jb.$(K.a.jJb,
Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.nJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.qJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.WJa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.XJa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.ZJa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.Zhb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.bKa,Object(F.a)(this,this.JE,
"remapTextQueryExecute"));this.jb.$(K.a.aKa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.$Ja,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.Xhb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.Yhb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.kJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.oJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.YJa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));
this.jb.$(K.a.$hb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.mJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.lJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.TNe,Hd.jf);this.jb.$(K.a.pJb,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.Oxa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.WNe,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.rjd,Object(F.a)(this,this.JE,"remapTextQueryExecute"));
this.jb.$(K.a.TZa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.jb.$(K.a.UZa,Object(F.a)(this,this.JE,"remapTextQueryExecute"));this.Xc.$(K.a.jJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.nJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.qJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.WJa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.XJa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.ZJa,
Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.Zhb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.bKa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.aKa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.$Ja,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.Xhb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.Yhb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.kJb,Object(F.a)(this,this.Ew,
"remapTextQueryEnabled"));this.Xc.$(K.a.oJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.YJa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.$hb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.mJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.lJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.pJb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.Oxa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));
this.Xc.$(K.a.WNe,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.rjd,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.TZa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.UZa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.jb.$(K.a.jIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.pIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.CIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Dxa,Object(F.a)(this,
this.S0c,"justifyExecuteBridge"));this.jb.$(K.a.Fxa,Object(F.a)(this,this.S0c,"justifyExecuteBridge"));this.jb.$(K.a.Hxa,Object(F.a)(this,this.S0c,"justifyExecuteBridge"));this.jb.$(K.a.zZa,Object(F.a)(this,this.S0c,"justifyExecuteBridge"));this.jb.$(K.a.xZa,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.tIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.wIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.yZa,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.uIb,
Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.xIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Dhb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Ahb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.$0,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Z0,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Y0,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.zIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.rIb,
Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Chb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.dmc,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.sIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.emc,Hd.wpg);this.jb.$(K.a.fmc,Hd.wpg);this.jb.$(K.a.Ona,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.LJa,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.rMb,Object(F.a)(this,this.xpg,"listMarkerGalleryShapeExecuteBridge"));
this.jb.$(K.a.bMb,Object(F.a)(this,this.xpg,"listMarkerGalleryShapeExecuteBridge"));this.jb.$(K.a.Ylc,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Zlc,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Exa,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.oIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.$lc,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.nIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.vIb,Object(F.a)(this,
this.xt,"remapTextExecute"));this.jb.$(K.a.imc,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.yIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.insertHyperlink,Object(F.a)(this,this.XVk,"remapInsertHyperlinkExecute"));this.jb.$(K.a.Gxa,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.Bhb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.AIb,Object(F.a)(this,this.xt,"remapTextExecute"));this.jb.$(K.a.BIb,Object(F.a)(this,this.xt,"remapTextExecute"));
this.Xc.$(K.a.jIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.pIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.CIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Dxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Fxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Hxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.zZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.xZa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));
this.Xc.$(K.a.tIb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.wIb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.yZa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.uIb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.xIb,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.Xc.$(K.a.Dhb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Ahb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.$0,Object(F.a)(this,
this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Z0,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Y0,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.zIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.rIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Chb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.dmc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.sIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Ona,Object(F.a)(this,
this.Ps,"remapTextEnabled"));this.Xc.$(K.a.LJa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Ylc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Zlc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Exa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.oIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.$lc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.nIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.vIb,Object(F.a)(this,
this.Ps,"remapTextEnabled"));this.Xc.$(K.a.imc,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.yIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Gxa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.Bhb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.insertHyperlink,Object(F.a)(this,this.WVk,"remapInsertHyperlinkEnabled"));this.Xc.$(K.a.TZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.UZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));
this.Xc.$(K.a.AIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.BIb,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.TZa,Object(F.a)(this,this.Ps,"remapTextEnabled"));this.Xc.$(K.a.UZa,Object(F.a)(this,this.Ps,"remapTextEnabled"))}IEj(){this.jb.$(K.a.ENe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"));this.jb.$(K.a.yNe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"));this.jb.$(K.a.BNe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"));
this.jb.$(K.a.zNe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"));this.jb.$(K.a.CNe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"));this.jb.$(K.a.DNe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"));this.jb.$(K.a.ANe,Object(F.a)(this,this.Vhb,"queryInkControlToggledExecuteBridge"))}tFj(){this.jb.$(K.a.onc,Hd.jf);this.jb.$(K.a.pnc,Hd.jf);this.jb.$(K.a.rnc,Hd.jf);this.jb.$(K.a.zjd,Hd.jf);this.jb.$(K.a.yjd,Hd.jf);this.jb.$(K.a.Ajd,Hd.jf);this.jb.$(K.a.Bjd,
Hd.jf);this.jb.$(K.a.Djd,Hd.jf);this.jb.$(K.a.xjd,Hd.jf);this.jb.$(K.a.Fjd,Hd.jf);this.jb.$(K.a.Cjd,Hd.jf);this.jb.$(K.a.Ljd,Hd.jf);this.jb.$(K.a.Kjd,Hd.jf);this.jb.$(K.a.Jjd,Hd.jf);this.jb.$(K.a.cib,Hd.jf);this.jb.$(K.a.dib,Hd.jf);this.jb.$(K.a.RZa,Object(F.a)(this,this.gjd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(K.a.SZa,Object(F.a)(this,this.gjd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(K.a.xJb,Hd.jf);this.jb.$(K.a.wJb,Hd.jf);this.jb.$(K.a.qnc,Hd.jf);this.jb.$(K.a.Hjd,Hd.jf);
this.jb.$(K.a.Ijd,Hd.jf);this.Xc.$(K.a.Rjb,Hd.Cy);this.Xc.$(K.a.Sjb,Hd.Cy);this.Xc.$(K.a.$Lb,Hd.Cy);this.Xc.$(K.a.dkb,Hd.Cy);this.Xc.$(K.a.tMb,Hd.Cy);this.Xc.$(K.a.XWe,Hd.Cy);this.jb.$(K.a.Rjb,Object(F.a)(this,this.g_i,"fontNameExecuteBridge"));this.jb.$(K.a.Sjb,Object(F.a)(this,this.b5d,"genericFontSizeExecuteBridge"));this.jb.$(K.a.$Lb,Hd.t0e);this.jb.$(K.a.dkb,Hd.t0e);this.jb.$(K.a.tMb,Hd.t0e);this.Xc.$(K.a.xxf,Hd.r0a);this.Xc.$(K.a.yxf,Hd.r0a);this.Xc.$(K.a.EHc,Hd.r0a);this.Xc.$(K.a.BHc,Hd.r0a);
this.Xc.$(K.a.DHc,Hd.r0a);this.Xc.$(K.a.CHc,Hd.r0a);this.Xc.$(K.a.XQd,Hd.r0a);this.Xc.$(K.a.NQd,Hd.r0a);this.jb.$(K.a.cpd,Hd.opg);this.jb.$(K.a.QZa,Hd.kdh);this.jb.$(K.a.Ejd,Hd.kdh);this.jb.$(K.a.Kna,Hd.opg)}YDj(){this.jb.$(K.a.zj,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.Vna,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.Rxa,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.KJb,Object(F.a)(this,
this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.iib,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.Xjd,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.Qxa,Hd.IU);this.jb.$(K.a.Qj,Object(F.a)(this,this.std,"transitionExecuteBridge"));this.jb.$(K.a.Xjb,Object(F.a)(this,this.std,"transitionExecuteBridge"));this.Xc.$(K.a.Qj,Hd.Cy);this.Xc.$(K.a.Ioa,Hd.Cy);this.Xc.$(K.a.Dya,Hd.Cy);this.Xc.$(K.a.vqc,Hd.Cy);this.Xc.$(K.a.Yjb,
Hd.Cy);this.jb.$(K.a.Sna,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.MZa,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.NZa,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.Tna,Object(F.a)(this,this.Pxa,"queryQueryTransitionResultExecuteBridge"));this.jb.$(K.a.Bz,Object(F.a)(this,this.std,"transitionExecuteBridge"));this.jb.$(K.a.ALb,Object(F.a)(this,this.std,"transitionExecuteBridge"));
this.Xc.$(K.a.Bz,Hd.Cy);this.Xc.$(K.a.vya,Hd.Cy);this.Xc.$(K.a.ALb,Hd.Cy);this.Xc.$(K.a.BLb,Hd.Cy);this.Xc.$(K.a.Z_a,Hd.Cy);this.jb.$(K.a.UJa,Hd.IU);this.Xc.$(K.a.jod,Hd.Cy);this.Xc.$(K.a.X_a,Hd.Cy);this.jb.$(K.a.VJa,Hd.IU);this.Xc.$(K.a.kod,Hd.Cy);this.Xc.$(K.a.Y_a,Hd.Cy);this.Xc.$(K.a.fHc,Hd.Cy);this.jb.$(K.a.ZIb,Hd.jf);this.Xc.$(K.a.lod,Hd.Cy);this.Xc.$(K.a.mod,Hd.Cy);this.Xc.$(K.a.nod,Hd.Cy);this.Xc.$(K.a.ood,Hd.Cy)}EFj(){this.jb.$(D.a.GJb,Dg.oNe);this.jb.$(K.a.XNe,Dg.oNe);this.jb.$(K.a.DJb,Hd.IU);
this.jb.$(K.a.EJb,Hd.IU);this.jb.$(K.a.Enc,Hd.IU);this.jb.$(K.a.Wjd,Hd.IU);this.jb.$(K.a.Bnc,Hd.IU);this.jb.$(K.a.Cnc,Hd.IU);this.jb.$(K.a.Dnc,Hd.IU);this.jb.$(K.a.Anc,Hd.IU);this.jb.$(K.a.amc,Object(F.a)(this,this.Xkd,"remapTableExecute"));this.jb.$(D.a.o8,Object(F.a)(this,this.Xkd,"remapTableExecute"));this.jb.$(D.a.gLb,Object(F.a)(this,this.Xkd,"remapTableExecute"));this.jb.$(D.a.insertTable,Object(F.a)(this,this.Xkd,"remapTableExecute"));this.Xc.$(D.a.insertTable,Object(F.a)(this,this.Bri,"checkInsertTableRibbonEnabledBridge"));
this.Xc.$(D.a.o8,Object(F.a)(this,this.ltb,"checkWholeTableLockEnabledBridge"));this.Xc.$(D.a.NZ,Object(F.a)(this,this.ltb,"checkWholeTableLockEnabledBridge"));this.Xc.$(D.a.OZ,Object(F.a)(this,this.ltb,"checkWholeTableLockEnabledBridge"));this.Xc.$(K.a.tah,Object(F.a)(this,this.ltb,"checkWholeTableLockEnabledBridge"));this.Xc.$(K.a.N5,Object(F.a)(this,this.ltb,"checkWholeTableLockEnabledBridge"));this.Xc.$(K.a.NJa,Object(F.a)(this,this.ltb,"checkWholeTableLockEnabledBridge"));this.jb.$(D.a.NZ,Object(F.a)(this,
this.xQa,"checkSelectionBeforeExecute"));this.jb.$(D.a.OZ,Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(D.a.d7a,Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(K.a.lmc,Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(K.a.kmc,Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(K.a.jmc,Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(K.a.N5,Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(K.a.NJa,
Object(F.a)(this,this.xQa,"checkSelectionBeforeExecute"));this.jb.$(K.a.xOe,Hd.jf);this.jb.$(K.a.yOe,Hd.jf);this.jb.$(K.a.zOe,Hd.jf);this.jb.$(K.a.AOe,Hd.jf);this.jb.$(K.a.BOe,Hd.jf);this.jb.$(K.a.COe,Hd.jf);this.jb.$(K.a.DOe,Hd.jf);this.jb.$(K.a.EOe,Hd.jf);this.jb.$(K.a.FOe,Hd.jf);this.jb.$(K.a.lOe,Hd.jf);this.jb.$(K.a.mOe,Hd.jf);this.jb.$(K.a.nOe,Hd.jf);this.jb.$(K.a.oOe,Hd.jf);this.jb.$(K.a.pOe,Hd.jf);this.jb.$(K.a.qOe,Hd.jf);this.jb.$(K.a.rOe,Hd.jf);this.jb.$(K.a.sOe,Hd.jf);this.jb.$(K.a.tOe,
Hd.jf);this.jb.$(K.a.uOe,Hd.jf);this.jb.$(K.a.vOe,Hd.jf);this.jb.$(K.a.wOe,Hd.jf);this.jb.$(K.a.Ujd,Hd.jf);this.jb.$(K.a.Tjd,Hd.jf);this.jb.$(K.a.Sjd,Hd.jf);this.jb.$(K.a.Vjd,Hd.jf)}$Ej(){this.Xc.$(K.a.ujd,Hd.Cy);this.jb.$(K.a.ujd,Hd.jf);this.Xc.$(K.a.Ehe,Hd.VVk);this.jb.$(K.a.YEa,Object(F.a)(this,this.ihd,"parseSmartArtParametersBridge"));this.jb.$(K.a.I_b,Object(F.a)(this,this.ihd,"parseSmartArtParametersBridge"));this.jb.$(K.a.J_b,Object(F.a)(this,this.ihd,"parseSmartArtParametersBridge"));this.jb.$(K.a.SK,
Object(F.a)(this,this.ihd,"parseSmartArtParametersBridge"));this.Xc.$(K.a.$id,Hd.Cy);this.jb.$(K.a.$id,Hd.jf);this.jb.$(K.a.Pra,Object(F.a)(this,this.zqi,"changePictureStyleExecuteBridge"));this.jb.$(K.a.AJb,Hd.jf);this.jb.$(K.a.fJb,Hd.IU);this.jb.$(K.a.hJb,Hd.IU);this.jb.$(K.a.gJb,Hd.IU);this.jb.$(K.a.bnc,Hd.IU)}aEj(){this.jb.$(K.a.sdh,Dg.oNe);this.jb.$(K.a.Mmc,Hd.jf);this.jb.$(K.a.dnc,Hd.jf);this.jb.$(K.a.$mc,Hd.jf);this.jb.$(K.a.lnc,Hd.jf);this.jb.$(K.a.mnc,Hd.jf);this.jb.$(K.a.knc,Hd.jf);this.jb.$(K.a.nnc,
Hd.jf);this.jb.$(K.a.vnc,Hd.jf);this.jb.$(K.a.cnc,Hd.jf);this.jb.$(K.a.Zmc,Hd.jf);this.jb.$(K.a.Umc,Hd.jf);this.jb.$(K.a.hnc,Hd.jf)}zEj(){this.jb.$(K.a.Yid,Hd.jf);this.jb.$(K.a.ljd,Hd.jf);this.jb.$(K.a.fnc,Object(F.a)(this,this.gjd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(K.a.gnc,Object(F.a)(this,this.gjd,"queryListMarkerQueryDataExecuteBridge"));this.jb.$(K.a.JJb,Hd.jf);this.jb.$(K.a.IJb,Hd.jf);this.jb.$(K.a.HJb,Hd.jf);this.jb.$(K.a.Ojd,Hd.jf);this.jb.$(K.a.IMk,Hd.jf);this.jb.$(K.a.zz,
Hd.sjd);this.jb.$(K.a.Fnc,Hd.sjd);this.jb.$(K.a.Gjd,Hd.sjd);this.jb.$(K.a.djd,Hd.sjd);this.jb.$(K.a.BJb,Object(F.a)(this,this.YVk,"remapRumTrackerExecuteQueryBridge"));this.jb.$(K.a.dJb,Hd.jf);this.jb.$(K.a.wjd,Dg.Pmc);this.jb.$(K.a.kjd,Hd.jf);this.jb.$(K.a.anc,Hd.jf);this.jb.$(K.a.$Ib,Hd.jf);this.jb.$(K.a.uJb,Hd.jf);this.jb.$(K.a.CJb,Hd.jf);this.jb.$(K.a.NOe,Dg.Pmc);this.jb.$(K.a.Qjd,Hd.jf);this.jb.$(K.a.Pjd,Hd.jf);this.jb.$(K.a.fOe,Hd.jf);this.jb.$(K.a.XZa,Hd.jf);this.jb.$(K.a.gib,Hd.jf);this.jb.$(K.a.hib,
Hd.jf);this.jb.$(K.a.fib,Hd.jf);this.jb.$(K.a.eib,Hd.jf);this.jb.$(K.a.rJb,Hd.jf);this.jb.$(K.a.yJb,Hd.jf);this.jb.$(K.a.sJb,Hd.jf);this.jb.$(G.a.YIb,Dg.Pmc);this.Xc.$(K.a.HJe,Hd.Cy);this.jb.$(K.a.gw,Hd.Zqd);this.jb.$(K.a.oCa,Hd.Zqd);this.jb.$(K.a.Nrb,Hd.Zqd);this.jb.$(K.a.nZb,Hd.Zqd);this.Xc.$(K.a.TXf,Hd.H_i);this.jb.$(K.a.wc,Hd.bMk);this.Xc.$(K.a.qjd,Hd.Cy);this.jb.$(K.a.qjd,Hd.jf);this.Xc.$(K.a.qSa,Object(F.a)(this,this.Ew,"remapTextQueryEnabled"));this.jb.$(K.a.cKa,Dg.Pmc);this.jb.$(K.a.cOe,Hd.jf);
this.jb.$(K.a.tnc,Hd.jf);this.jb.$(K.a.UNe,Hd.jf);this.jb.$(K.a.VNe,Hd.jf);this.jb.$(K.a.LJb,Hd.jf);this.jb.$(K.a.vNe,Hd.jf);this.jb.$(D.a.Yhd,Dg.I8b);this.jb.$(D.a.cut,Object(F.a)(this,this.rMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.copy,Object(F.a)(this,this.rMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.paste,Object(F.a)(this,this.rMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.L5,Object(F.a)(this,this.rMc,"cutCopyPasteExecuteBridge"));this.jb.$(D.a.openInClient,Object(F.a)(this,this.Rzk,
"openInPowerPointExecuteBridge"));this.jb.$(D.a.fjd,Hd.jf);this.jb.$(K.a.Ymc,Hd.jf);this.jb.$(K.a.mmc,Object(F.a)(this,this.$gh,"remapUndoRedoExecute"));this.jb.$(K.a.gmc,Object(F.a)(this,this.$gh,"remapUndoRedoExecute"));this.jb.$(K.a.lIb,Object(F.a)(this,this.Wkd,"remapCutCopyPasteExecute"));this.jb.$(K.a.kIb,Object(F.a)(this,this.Wkd,"remapCutCopyPasteExecute"));this.jb.$(K.a.MJa,Object(F.a)(this,this.Wkd,"remapCutCopyPasteExecute"));this.jb.$(K.a.qIb,Object(F.a)(this,this.Wkd,"remapCutCopyPasteExecute"));
this.Xc.$(K.a.mmc,Object(F.a)(this,this.Zgh,"remapUndoRedoEnabled"));this.Xc.$(K.a.gmc,Object(F.a)(this,this.Zgh,"remapUndoRedoEnabled"));this.Xc.$(K.a.lIb,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));this.Xc.$(K.a.kIb,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));this.Xc.$(K.a.MJa,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));this.Xc.$(K.a.qIb,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.cut,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));
this.Xc.$(D.a.paste,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));this.Xc.$(D.a.L5,Object(F.a)(this,this.vib,"remapCutCopyPasteEnabled"));this.jb.$(D.a.v1,Hd.oyf);this.jb.$(D.a.Sr,Hd.oyf);this.jb.$(D.a.NM,Object(F.a)(this,this.Fpg,"listsExecuteBridge"));this.jb.$(D.a.mP,Object(F.a)(this,this.Fpg,"listsExecuteBridge"));this.jb.$(K.a.rkb,Hd.gll);this.jb.$(K.a.Shb,Hd.IU);this.jb.$(K.a.Thb,Hd.IU);this.jb.$(K.a.vJb,Hd.jf);this.jb.$(K.a.aJb,Hd.jf);this.jb.$(K.a.Tmc,Hd.jf);this.jb.$(K.a.tJb,Hd.jf);
this.la.zrb&&this.jb.$(K.a.Lmc,Hd.jf);(this.la.cB||this.la.VW)&&Ud.a("ShowEnabledStateOfChatPPT")&&this.jb.$(K.a.snc,Hd.jf)}iEj(){this.Xc.$(K.a.afg,Object(F.a)(this,this.E2b,"doPresentationCheckEnableRemap"));this.Xc.$(K.a.yUd,Object(F.a)(this,this.E2b,"doPresentationCheckEnableRemap"));this.Xc.$(K.a.tUd,Object(F.a)(this,this.E2b,"doPresentationCheckEnableRemap"));this.Xc.$(K.a.cfg,Object(F.a)(this,this.E2b,"doPresentationCheckEnableRemap"));this.Xc.$(K.a.ffg,Object(F.a)(this,this.E2b,"doPresentationCheckEnableRemap"))}E2b(a){const b=
new Zk;this.Fb&&1===this.Fb.Fl&&!Hd.Oie(a)?b.dL=!1:(b.dG=!0,b.Wm=K.a.b8a);return b}X6i(){const a=new tM;a.oZb=Hd.BGk;a.YQd=Hd.CGk;a.JLe=Object(F.a)(this,this.$Gk,"powerPointPreExecCommand");a.fLe=null;return a}$Gk(a,b){var c=this.pa.Wd();c=1===c.length&&c[0].ud&&this.pa.gH()&&!c[0].MQ;switch(a.Wm){case D.a.font:case D.a.P5:case D.a.DKa:case D.a.bold:case D.a.setItalic:case D.a.underline:case D.a.strikethrough:case D.a.Sr:case D.a.v1:case D.a.aja:case D.a.bH:case D.a.NH:case D.a.QJa:case D.a.A_a:case D.a.oC:case D.a.By:case D.a.NM:case D.a.mP:case D.a.Xia:case D.a.nla:case D.a.toa:case D.a.PDa:case K.a.Kna:case K.a.$0:case K.a.Z0:case K.a.Y0:case D.a.bDa:case D.a.yka:case D.a.kza:case D.a.lza:case D.a.mza:case D.a.ILa:case D.a.JLa:case D.a.OZ:case D.a.NZ:case K.a.N5:case K.a.NJa:case K.a.n0a:case K.a.cLa:case K.a.Hoa:case K.a.dLa:case K.a.crd:case K.a.brd:b||
(b={}),b[ni.a.GFc]=!(this.pa.dVa()||c),b[ni.a.Arf]=!!this.pa.nka()}return null}xpg(a,b,c){const f=new jh;b=b.MenuItemId;f.rd=this.ADe(b,a);b&&xa.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}ADe(a,b){a=a?parseInt(a):-1;switch(b){case K.a.rMb:case D.a.NM:case K.a.fnc:case K.a.RZa:return this.rEb.L6b(a);case K.a.bMb:case D.a.mP:case K.a.gnc:case K.a.SZa:return this.rEb.BUc(a);default:return 18}}g_i(a,b){a=new jh;a.rd=b.CommandValueId;return a}gjd(a,b){const c=
new jh,f=new Jv;f.VZa=new Uh.a;f.menuItemId=this.ADe(b.MenuItemId,a);c.rd=f;c.dX=!0;return c}Pxa(a,b){a=new jh;const c={};c.queryResult=new Uh.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.rd=c;a.dX=!0;return a}std(a,b){a=new jh;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.rd=c;return a}zqi(a,b){a=new jh;a.rd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}Vhb(a){const b=new jh,c={},f=new Uh.a;switch(a){case K.a.ENe:f.Mf(this.JWa.isEnabled(he.TEa));break;case K.a.yNe:f.Mf(this.JWa.isEnabled(he.SEa));break;case K.a.BNe:f.Mf(this.JWa.isEnabled(he.Z8));break;case K.a.zNe:f.Mf(this.JWa.isEnabled(he.Y8));break;case K.a.CNe:f.Mf(this.JWa.isEnabled(he.bB));break;case K.a.DNe:f.Mf(this.JWa.isEnabled(he.eE));break;case K.a.ANe:f.Mf(this.JWa.isEnabled(he.dE));break;case K.a.gdh:f.Mf(this.JWa.isEnabled(he.Wta))}c.queryResult=
f;b.rd=c;b.dX=!0;return b}Fpg(a,b,c){const f=new jh;f.rd=new J.DictionaryPropertySet;b=b.MenuItemId;this.lEl(f.rd,a,this.ADe(b,a));b&&xa.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}Bri(){return Object.assign(new Zk,{rd:new Uh.a,dL:!!this.d5j.Ba})}ltb(){const a=new Zk,b=this.pa.Zm();if(!b)return a;this.yc.sie(b)&&(a.dG=!1,a.dL=!1,a.Wm=ld.ActionManager.j3b);return a}lEl(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===D.a.NM?(l=f=1,this.rEb.qYc(c)&&(b=this.rEb.zVa.ga(c),
a.setValue($a.a.Ri,[b.ZZb]),a.setValue($a.a.font,b.wsb))):b===D.a.mP&&(f=0,l=1,a.setValue($a.a.DVa,1),a.setValue(kb.a.autonumberBulletType,8),this.rEb.rYc(c)&&(b=this.rEb.Ydd.ga(c),a.setValue(kb.a.autonumberBulletType,b.bSd),a.setValue($a.a.Ri,[65533,b.t0g,ha.a.charCodeAt(b.z0g,0)])));a.setValue(Mc.a.kE,f);a.setValue(Mc.a.dea,l)}Ptd(a){let b;if(this.Wth()||this.pa.nka()){if(({De:b}=Hd.Jtd(a,this.pa.Xz())).returnValue)return{returnValue:!0,x5:b}}else if(this.Whl()&&({De:b}=Hd.ZDh(a)).returnValue)return{returnValue:!0,
x5:b};return{returnValue:!1,x5:0}}z3e(a){let b;b=0;a===K.a.mmc?b=K.a.FZa:a===K.a.gmc&&(b=K.a.EZa);return{returnValue:!!b,x5:b}}y3e(a){let b;b=0;this.Wth()?a===K.a.lIb?b=D.a.cut:a===K.a.kIb?b=D.a.copy:a===K.a.MJa?b=D.a.paste:a===K.a.qIb&&(b=D.a.L5):(a===K.a.lIb&&(b=K.a.oub),a===K.a.kIb?b=K.a.a1b:a===K.a.MJa&&(b=K.a.slc));return{returnValue:!!b,x5:b}}mEh(a){switch(a){case D.a.o8:return a=K.a.mIb,{returnValue:!0,De:a};case D.a.gLb:return a=K.a.vLe,{returnValue:!0,De:a};case D.a.insertTable:return a=
K.a.xah,{returnValue:!0,De:a}}a=ld.ActionManager.B5;return{returnValue:!1,De:a}}xt(a){let b=new jh;if(({result:b}=this.Wyb(a)).returnValue)return b;({x5:a}=this.Ptd(a)).returnValue&&(b.dG=!0,b.Wm=a);return b}rth(a){switch(a){case K.a.yZa:case K.a.uIb:case K.a.xIb:case K.a.Ahb:case K.a.Dhb:case K.a.Bhb:if(this.pa.Zka()||this.pa.FL())return Object.assign(new Zk,{dG:!1,dL:!1});break;case K.a.mJb:case K.a.lJb:case K.a.tIb:case K.a.wIb:case K.a.xZa:if(this.pa.Zka())return Object.assign(new Zk,{dG:!1,dL:!1});
break;case K.a.LJa:case K.a.Ona:case K.a.vid:case K.a.Dxa:case K.a.Fxa:case K.a.Hxa:case K.a.zZa:case K.a.vIb:case K.a.nIb:if(this.pa.FL())return Object.assign(new Zk,{dG:!1,dL:!1});break;case K.a.yIb:case K.a.imc:if(this.pa.FL()){var b=this.pa.Na.mb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(ab.a.listLevel,0),a===K.a.yIb&&!b||To.a.Cig(c.node)))return Object.assign(new Zk,{dG:!1,dL:!1})}}return null}Ps(a){let b;new Zk;if(({result:b}=this.iie(a)).returnValue)return this.Ood(b,a);b=this.rth(a);
if(!b){let c;b=new Zk;({x5:c}=this.Ptd(a)).returnValue&&(b.dG=!0,b.Wm=c)}return this.Ood(b,a)}aoa(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Zk,{ahb:a,Wm:K.a.hTe,rd:c})}YVk(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new jh,{Wm:K.a.hTe,rd:c,dX:!0})}JE(a){let b=new jh;if(({result:b}=this.Wyb(a)).returnValue)return b;({x5:a}=this.Ptd(a)).returnValue?(b.dG=!0,b.Wm=a):(b.rd=new Uh.a,b.dX=!0);return b}Ew(a){let b;new Zk;if(({result:b}=
this.iie(a)).returnValue)return this.Ood(b,a);b=this.rth(a);if(!b){let c;b=new Zk;({x5:c}=this.Ptd(a)).returnValue?(b.dG=!0,b.Wm=c):b.rd=new Uh.a}return this.Ood(b,a)}$gh(a){const b=new jh;({x5:a}=this.z3e(a)).returnValue&&(b.dG=!0,b.Wm=a);return b}Zgh(a){const b=new Zk;({x5:a}=this.z3e(a)).returnValue&&(b.dG=!0,b.Wm=a);return b}WVk(){const a=new Zk;a.dG=!0;a.Wm=K.a.pLe;return a}XVk(){const a=new jh;a.dG=!0;a.Wm=K.a.pLe;return a}Wkd(a){let b=new jh;if(({result:b}=this.Wyb(a)).returnValue)return b;
({x5:a}=this.y3e(a)).returnValue&&(b.dG=!0,b.Wm=a);return b}Xkd(a){let b=new jh;if(({result:b}=this.Wyb(a)).returnValue)return b;({De:a}=this.mEh(a)).returnValue&&(b.dG=!0,b.Wm=a);return b}xQa(a,b){let c=new jh;if(({result:c}=this.Wyb(a)).returnValue)return c;if(this.pa.Bs())return c.dG=!0,c.Wm=ld.ActionManager.j3b,c;c.Wm=a;c.rd=b;return c}vib(a){let b=new Zk;if(!this.Tb.pj())return b.dL=!1,b;if(({result:b}=this.iie(a)).returnValue)return b;({x5:a}=this.y3e(a)).returnValue&&(b.dG=!0,b.Wm=a);return b}Wth(){return this.pa.Xz()}Whl(){return this.pa.gH()}ihd(a,
b){const c=new jh;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new iR.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==K.a.YEa&&a!==K.a.J_b||xa.a.J(512493024,801,50,(a===K.a.YEa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.rd=b;return c}S0c(a,b,c){return this.xt(a,b,c)}rMc(a){let b=new jh;if(({result:b}=this.Wyb(a)).returnValue)return b;b.$q=this.la.zYc||this.la.Uhg&&this.la.bMj&&B.a.vo;return b}Rzk(a,b,c){a=new jh;xa.a.J(512493023,
801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}Wyb(a){let b;b=new jh;return this.agg(a)?(b.dG=!1,b.dL=!1,b.Wm=ld.ActionManager.j3b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}iie(a){let b;b=new Zk;return this.agg(a)?(b.dG=!1,b.dL=!1,b.Wm=ld.ActionManager.j3b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}agg(a){return this.nIj(a)}nIj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&Hd.nmi.contains(a)?
this.pa.k9()?!0:!1:!1}Ood(a,b){if(Ud.a("SetMappedCommandActionData")){let c=0;if(({De:c}=Hd.Jtd(b,this.pa.Xz())).returnValue||({De:c}=Hd.ZDh(b)).returnValue||({x5:c}=this.z3e(b)).returnValue||({x5:c}=this.y3e(b)).returnValue||({De:c}=this.mEh(b)).returnValue)a.rd||(a.rd={}),a.rd.MappedCommand=c}return a}static Oie(a){const b=Hd.fkj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static fkj(){Hd.Chc||(Hd.Chc=[K.a.mmc,K.a.gmc,K.a.MJa,K.a.wJa,K.a.xJa,K.a.kIb,K.a.deleteObject,K.a.B0d,K.a.b8a,
K.a.mna,K.a.Z7b,K.a.X3e,K.a.jQ,K.a.print,K.a.sJk,K.a.gMe,K.a.iMe,K.a.hmc,K.a.tLe,K.a.uLe,K.a.downloadACopy,K.a.K2b,K.a.L2b,K.a.M2b,K.a.gw,K.a.ijd,K.a.oCa,K.a.jpd,K.a.ipd,K.a.jJe,K.a.hIb,K.a.KJb,K.a.Qxa,K.a.iib,K.a.zj,K.a.Vna,K.a.Qj,K.a.Xjb,K.a.vqc,K.a.Yjb,K.a.Ioa,K.a.nNb,K.a.Vya,K.a.ZLa,K.a.XZa,K.a.Mhb,K.a.CZa,K.a.xmc,K.a.sJb,K.a.DZa,K.a.rJb,K.a.yJb,K.a.Rjd,K.a.xhb,K.a.yhb,K.a.sOb,K.a.gib,K.a.tOb,K.a.hib,K.a.rOb,K.a.fib,K.a.qOb,K.a.eib,K.a.pOb,K.a.uJb,K.a.Pfa,K.a.aoc,K.a.LJb,K.a.z5e,K.a.rde,G.a.T7,
G.a.Xid,K.a.openInClient,G.a.yrc,G.a.BHb,G.a.NIb,G.a.WMb,G.a.XMb,K.a.jLa,K.a.jga,K.a.Egd,K.a.dJb,K.a.osc,K.a.psc,D.a.Yhd,K.a.zFk,K.a.z5,K.a.TXf,K.a.jQ,K.a.xI,K.a.zld,K.a.OQe,K.a.PEe,K.a.OEe,K.a.f5e,K.a.d6a,K.a.immersiveReader,D.a.copy,D.a.paste,K.a.oub,K.a.a1b,K.a.slc,K.a.FZa,K.a.EZa,K.a.Npd,G.a.Tsa,G.a.renameFile,G.a.xKc,G.a.SYe,K.a.Lhb,K.a.YLe,K.a.Elc,K.a.ymc,K.a.boc,K.a.U0a]);Hd.Chc.push(K.a.oqc);if(u.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=[K.a.gIb,K.a.jjd,K.a.LXc];
let b;(b=Hd.Chc).push.apply(b,a)}return Hd.Chc}static CGk(a,b){const c=a.ahb;let f=!0,l=null;if(null===a||null===a.rd)return!1;a=a.rd;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.Kaa)switch(c){case K.a.Qxa:case K.a.DJb:case K.a.EJb:case K.a.Enc:case K.a.Wjd:case K.a.Bnc:case K.a.Cnc:case K.a.Dnc:case K.a.Anc:case K.a.fJb:case K.a.hJb:case K.a.gJb:case K.a.bnc:case K.a.Shb:case K.a.Thb:case K.a.UJa:case K.a.VJa:a=parseFloat(l.Kaa);0<a||c===K.a.Qxa||c===K.a.fJb||c===K.a.hJb||c===K.a.gJb||
c===K.a.bnc||c===K.a.Shb||c===K.a.Thb||c===K.a.UJa||c===K.a.VJa||0<=a&&(c===K.a.Bnc||c===K.a.Cnc||c===K.a.Dnc||c===K.a.Anc)?(b[$m.Text]=l.Kaa,b[$m.Number]=a):(b[$m.Text]="",b[$m.Number]=Number.NaN);b[$m.UnitType]=c===K.a.Qxa||c===K.a.UJa||c===K.a.VJa?8:3;break;default:f=!1}return f}static BGk(a,b){if(Dg.oZb(a,b))return!0;if(!a||!a.rd)return!1;var c=null;Object(Xa.a)(Uh.a,a.rd)?c=a.rd:Object(Xa.a)(Jv,a.rd)?(c=a.rd,b.SourceControlId=c.XU,c=c.VZa):Object(Xa.a)(Object,a.rd)&&(a=a.rd,a.queryResult&&(c=
a.queryResult));c&&(b[Sh.a.On]=c.Zsd?c.Zsd.value:!1,c.oKc&&(b[eo.a.IsFreeForm]=c.oKc.value),c.QDa&&(b[hm.a.InnerHTML]=c.QDa),c.awb&&(b[hm.a.Alt]=c.awb),c.$Qc&&(b[hm.a.On]=c.$Qc.value),void 0!==c.YZ&&null!==c.YZ&&(b[eo.a.Value]=c.YZ),void 0!==c.tIc&&null!==c.tIc&&(b[oE.a.LabelText]=c.tIc),c.w3&&(b[hm.a.GalleryButtonProps]=c.w3),c.$Af&&(b[oE.a.Image32by32Class]=c.$Af),void 0!==c.f9a&&null!==c.f9a&&(b[im.a.labelText]=c.f9a));return!0}static Cy(){const a=new Zk;a.rd=new Uh.a;return a}static jf(){const a=
new jh;a.rd=new Uh.a;a.dX=!0;return a}static wpg(a,b,c){xa.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new jh;a.rd=b;return a}static t0e(a,b){a=new jh;a.rd=b.Color;return a}static oyf(a,b){a=new jh;a.rd=b.Color;a.$q=!0;return a}static gll(){const a=new jh;a.rd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static sjd(a,b){a=new jh;const c=new Jv;c.VZa=new Uh.a;c.XU=b.SourceControlId;a.rd=c;a.dX=!0;return a}static Zqd(a,b){a=new jh;a.rd=b.SourceControlId;return a}static IU(){const a=
new jh,b={},c=new Uh.a;b.queryResult=c;a.rd=b;a.fle=!0;return a}static r0a(a){const b=new Zk;switch(a){case K.a.xxf:b.Wm=K.a.aCa;break;case K.a.yxf:b.Wm=K.a.Fia;break;case K.a.EHc:b.Wm=K.a.SPa;break;case K.a.BHc:b.Wm=K.a.o6a;break;case K.a.DHc:b.Wm=K.a.p6a;break;case K.a.CHc:b.Wm=K.a.Gia;break;case K.a.XQd:b.Wm=K.a.Nrb;break;case K.a.NQd:b.Wm=K.a.nZb}return b}static H_i(){const a=new Zk;a.Wm=K.a.ata;return a}static bMk(){const a=new jh,b={},c=new Uh.a;c.Mf(!1);b.queryResult=c;a.rd=b;a.dX=!0;return a}static Jtd(a,
b){switch(a){case K.a.jIb:return a=D.a.bold,{returnValue:!0,De:a};case K.a.Dxa:return a=D.a.Xia,{returnValue:!0,De:a};case K.a.xZa:return a=D.a.font,{returnValue:!0,De:a};case K.a.tIb:return a=D.a.P5,{returnValue:!0,De:a};case K.a.wIb:return a=D.a.DKa,{returnValue:!0,De:a};case K.a.Exa:return a=D.a.Sr,{returnValue:!0,De:a};case K.a.oIb:return a=D.a.v1,{returnValue:!0,De:a};case K.a.$lc:return a=D.a.aja,{returnValue:!0,De:a};case K.a.pIb:return a=D.a.setItalic,{returnValue:!0,De:a};case K.a.Fxa:return a=
D.a.nla,{returnValue:!0,De:a};case K.a.rIb:return a=K.a.HJe,{returnValue:!0,De:a};case K.a.Chb:return a=D.a.eIb,{returnValue:!0,De:a};case K.a.yZa:return a=D.a.Pq,{returnValue:!0,De:a};case K.a.uIb:return a=D.a.QJa,{returnValue:!0,De:a};case K.a.xIb:return a=D.a.A_a,{returnValue:!0,De:a};case K.a.Dhb:return a=D.a.NH,{returnValue:!0,De:a};case K.a.Ahb:return a=D.a.bH,{returnValue:!0,De:a};case K.a.zIb:return a=D.a.strikethrough,{returnValue:!0,De:a};case K.a.dmc:return a=K.a.B8g,{returnValue:!0,De:a};
case K.a.sIb:return a=K.a.IJa,{returnValue:!0,De:a};case K.a.Hxa:return a=D.a.toa,{returnValue:!0,De:a};case K.a.zZa:return a=D.a.PDa,{returnValue:!0,De:a};case K.a.CIb:return a=D.a.underline,{returnValue:!0,De:a};case K.a.vIb:return a=D.a.By,{returnValue:!0,De:a};case K.a.nIb:return a=D.a.oC,{returnValue:!0,De:a};case K.a.yIb:return a=D.a.By,{returnValue:!0,De:a};case K.a.imc:return a=D.a.oC,{returnValue:!0,De:a};case K.a.Ona:return a=D.a.NM,{returnValue:!0,De:a};case K.a.LJa:return a=D.a.mP,{returnValue:!0,
De:a};case K.a.Gxa:return a=K.a.Kna,{returnValue:!0,De:a};case K.a.Bhb:return a=K.a.Hne,{returnValue:!0,De:a};case K.a.qSa:return a=D.a.HQc,{returnValue:!0,De:a};case K.a.AIb:return a=D.a.subscript,{returnValue:!0,De:a};case K.a.BIb:return a=D.a.superscript,{returnValue:!0,De:a}}return b?Hd.yzl(a):Hd.YDh(a)}static ZDh(a){switch(a){case K.a.jIb:return a=K.a.k0a,{returnValue:!0,De:a};case K.a.Dxa:return a=K.a.sMb,{returnValue:!0,De:a};case K.a.xZa:return a=K.a.Rjb,{returnValue:!0,De:a};case K.a.yZa:return a=
K.a.Sjb,{returnValue:!0,De:a};case K.a.pIb:return a=K.a.l0a,{returnValue:!0,De:a};case K.a.Fxa:return a=K.a.Tjb,{returnValue:!0,De:a};case K.a.Hxa:return a=K.a.fkb,{returnValue:!0,De:a};case K.a.zZa:return a=K.a.aMb,{returnValue:!0,De:a};case K.a.CIb:return a=K.a.m0a,{returnValue:!0,De:a};case K.a.Ona:return a=K.a.rMb,{returnValue:!0,De:a};case K.a.Ylc:return a=K.a.Iqc,{returnValue:!0,De:a};case K.a.Zlc:return a=K.a.Ipd,{returnValue:!0,De:a};case K.a.Exa:return a=K.a.$Lb,{returnValue:!0,De:a};case K.a.oIb:return a=
K.a.dkb,{returnValue:!0,De:a};case K.a.$lc:return a=K.a.tMb,{returnValue:!0,De:a};case K.a.LJa:return a=K.a.bMb,{returnValue:!0,De:a};case K.a.Chb:return a=K.a.XWe,{returnValue:!0,De:a};case K.a.Dhb:return a=K.a.vMb,{returnValue:!0,De:a};case K.a.Ahb:return a=K.a.Jqc,{returnValue:!0,De:a};case K.a.zIb:return a=K.a.cMb,{returnValue:!0,De:a};case K.a.$0:return a=K.a.fpd,{returnValue:!0,De:a};case K.a.Z0:return a=K.a.epd,{returnValue:!0,De:a};case K.a.Y0:return a=K.a.dpd,{returnValue:!0,De:a};case K.a.dmc:case K.a.rIb:return Hd.Jtd(a,
!0);case K.a.sIb:return Hd.Jtd(a,!0);case K.a.Gxa:return a=K.a.cpd,{returnValue:!0,De:a};case K.a.Bhb:return a=K.a.VWe,{returnValue:!0,De:a};case K.a.AIb:return a=K.a.Mqc,{returnValue:!0,De:a};case K.a.BIb:return a=K.a.Nqc,{returnValue:!0,De:a}}return Hd.YDh(a)}static yzl(a){switch(a){case K.a.jJb:return a=D.a.Nmc,{returnValue:!0,De:a};case K.a.WJa:return a=D.a.Qmc,{returnValue:!0,De:a};case K.a.nJb:return a=D.a.Wmc,{returnValue:!0,De:a};case K.a.mJb:return a=G.a.T7,{returnValue:!0,De:a};case K.a.lJb:return a=
G.a.T7,{returnValue:!0,De:a};case K.a.Xhb:return a=D.a.bjd,{returnValue:!0,De:a};case K.a.Yhb:return a=D.a.Rmc,{returnValue:!0,De:a};case K.a.XJa:return a=D.a.Xmc,{returnValue:!0,De:a};case K.a.ZJa:return a=D.a.inc,{returnValue:!0,De:a};case K.a.Zhb:return a=D.a.Smc,{returnValue:!0,De:a};case K.a.bKa:return a=K.a.JJb,{returnValue:!0,De:a};case K.a.aKa:return a=K.a.IJb,{returnValue:!0,De:a};case K.a.$Ja:return a=K.a.HJb,{returnValue:!0,De:a};case K.a.qJb:return a=D.a.Gnc,{returnValue:!0,De:a};case K.a.kJb:return a=
K.a.Yid,{returnValue:!0,De:a};case K.a.oJb:return a=K.a.ljd,{returnValue:!0,De:a};case K.a.YJa:return a=K.a.fnc,{returnValue:!0,De:a};case K.a.$hb:return a=K.a.gnc,{returnValue:!0,De:a};case K.a.pJb:return a=D.a.wnc,{returnValue:!0,De:a};case K.a.Oxa:return a=K.a.QZa,{returnValue:!0,De:a};case K.a.TZa:return a=D.a.ync,{returnValue:!0,De:a};case K.a.UZa:return a=D.a.znc,{returnValue:!0,De:a}}a=ld.ActionManager.B5;return{returnValue:!1,De:a}}static YDh(a){switch(a){case K.a.jJb:return a=K.a.onc,{returnValue:!0,
De:a};case K.a.WJa:return a=K.a.xjd,{returnValue:!0,De:a};case K.a.nJb:return a=K.a.pnc,{returnValue:!0,De:a};case K.a.Xhb:return a=K.a.Ajd,{returnValue:!0,De:a};case K.a.Yhb:return a=K.a.Bjd,{returnValue:!0,De:a};case K.a.XJa:return a=K.a.Djd,{returnValue:!0,De:a};case K.a.ZJa:return a=K.a.Fjd,{returnValue:!0,De:a};case K.a.Zhb:return a=K.a.Cjd,{returnValue:!0,De:a};case K.a.bKa:return a=K.a.Ljd,{returnValue:!0,De:a};case K.a.aKa:return a=K.a.Kjd,{returnValue:!0,De:a};case K.a.$Ja:return a=K.a.Jjd,
{returnValue:!0,De:a};case K.a.qJb:return a=K.a.rnc,{returnValue:!0,De:a};case K.a.kJb:return a=K.a.cib,{returnValue:!0,De:a};case K.a.mJb:return a=K.a.zjd,{returnValue:!0,De:a};case K.a.lJb:return a=K.a.yjd,{returnValue:!0,De:a};case K.a.oJb:return a=K.a.dib,{returnValue:!0,De:a};case K.a.YJa:return a=K.a.RZa,{returnValue:!0,De:a};case K.a.$hb:return a=K.a.SZa,{returnValue:!0,De:a};case K.a.pJb:return a=K.a.qnc,{returnValue:!0,De:a};case K.a.Oxa:return a=K.a.Ejd,{returnValue:!0,De:a};case K.a.TZa:return a=
K.a.Hjd,{returnValue:!0,De:a};case K.a.UZa:return a=K.a.Ijd,{returnValue:!0,De:a}}a=ld.ActionManager.B5;return{returnValue:!1,De:a}}static VVk(a){const b=new Zk;switch(a){case K.a.Ehe:b.Wm=K.a.YEa}return b}static opg(a,b){a=new jh;if(!b)throw Error.argumentNull();a.rd=Hd.m3f(b.MenuItemId);return a}static kdh(a,b){a=new jh;const c={},f=new Uh.a;f.Mf(!1);c.queryResult=f;c.MenuItemId=Hd.m3f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.rd=c;a.dX=!0;a.ele=!0;return a}static m3f(a){return parseFloat(a)}}
Hd.Chc=null;Hd.nmi=(sf=new Ka.a,sf.add(D.a.cut),sf.add(D.a.paste),sf.add(D.a.L5),sf.add(D.a.o8),sf.add(D.a.v1),sf.add(D.a.PVd),sf.add(D.a.aja),sf.add(D.a.P5),sf.add(D.a.DKa),sf.add(D.a.QJa),sf.add(D.a.A_a),sf.add(K.a.jJb),sf.add(K.a.nJb),sf.add(K.a.qJb),sf.add(K.a.WJa),sf.add(K.a.XJa),sf.add(K.a.ZJa),sf.add(K.a.Zhb),sf.add(K.a.bKa),sf.add(K.a.aKa),sf.add(K.a.$Ja),sf.add(K.a.Xhb),sf.add(K.a.Yhb),sf.add(K.a.kJb),sf.add(K.a.oJb),sf.add(K.a.YJa),sf.add(K.a.$hb),sf.add(K.a.mJb),sf.add(K.a.lJb),sf.add(K.a.pJb),
sf.add(K.a.Oxa),sf.add(K.a.TZa),sf.add(K.a.UZa),sf.add(K.a.tdh),sf.add(K.a.vdh),sf.add(K.a.udh),sf.add(K.a.WNe),sf.add(K.a.rjd),sf.add(K.a.jIb),sf.add(K.a.pIb),sf.add(K.a.CIb),sf.add(K.a.Dxa),sf.add(K.a.Fxa),sf.add(K.a.Hxa),sf.add(K.a.zZa),sf.add(K.a.oIb),sf.add(K.a.$lc),sf.add(K.a.xZa),sf.add(K.a.tIb),sf.add(K.a.wIb),sf.add(K.a.yZa),sf.add(K.a.uIb),sf.add(K.a.xIb),sf.add(K.a.Dhb),sf.add(K.a.Ahb),sf.add(K.a.$0),sf.add(K.a.Z0),sf.add(K.a.Y0),sf.add(K.a.zIb),sf.add(K.a.rIb),sf.add(K.a.Chb),sf.add(K.a.dmc),
sf.add(K.a.sIb),sf.add(K.a.emc),sf.add(K.a.fmc),sf.add(K.a.Ona),sf.add(K.a.LJa),sf.add(K.a.rMb),sf.add(K.a.dkb),sf.add(K.a.tMb),sf.add(K.a.bMb),sf.add(K.a.Ylc),sf.add(K.a.Zlc),sf.add(K.a.Exa),sf.add(K.a.nIb),sf.add(K.a.vIb),sf.add(K.a.insertHyperlink),sf.add(K.a.Gxa),sf.add(K.a.Bhb),sf.add(K.a.AIb),sf.add(K.a.BIb),sf.add(K.a.lIb),sf.add(K.a.MJa),sf.add(K.a.qIb),sf.add(K.a.mIb),sf.add(K.a.jid),sf.add(K.a.amc),sf.add(K.a.lmc),sf.add(K.a.kmc),sf.add(K.a.jmc),sf);Object(m.a)(Hd,"CuiActionBridge",Dg,[]);
class sE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Zb(a){this.K=a;this.K.register(263,"Box4.ISelectionContextMenuProvider").ma().oa(()=>new zq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Mzb;B.a.Tj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").Hya);this.K.register($z,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().oa(()=>new $z(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Ja("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(264,"PowerPointWebEditor.ICUIManager").ma().oa(()=>new sM(a.resolve("PowerPoint.IPathManager"),
a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(Hd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().oa(()=>
new Hd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager")));this.K.register(265,"PowerPointWebEditor.IStatusBarUserHelper").ma().oa(()=>
new qM(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(266,"PowerPointWebEditor.IStatusBarUser").ma().oa(()=>new lE(a.resolve("PowerPointWebEditor.IStatusBarPane").xa,a.resolve("Box4.Graph.IGraphInstance").yd(7),a.ub("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager")));a.register(fx,
"CommandUI.ReactRibbonRoot").ma().oa(()=>new fx(Tr.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(267,"PowerPointWebEditor.IContextMenuUser").ma().oa(()=>new nM(a.resolve("Box4.IContextMenuController"),Object(oa.a)($z,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(268,"Box4.IBox4BridgeCommandUi").ma().oa(()=>new rM(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),
a.resolve("Common.IRibbonExternal")));this.K.register(269,"PowerPointWebEditor.IContextMenuHelper").ma().oa(()=>new mM(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(kE,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().oa(()=>new kE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.ub("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").qk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");
this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").aii(this.K.resolve("Box4.IBox4BridgeCommandUi"))}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){z.a.instance.Dc(new sE)}}Object(m.a)(sE,"PPTWebEditorUIPackage",
null,[2,3]);class uM{constructor(a){this.OOh="FontPicker";this.GDd=null;this.Z1=a;this.jyc=this.Z1.rib(Sr.a.uVa,Object(F.a)(this,this.Bvb,"featureStateChangeCallback"));this.Z1.isFeatureEnabled(Sr.a.uVa,!1).then(b=>{this.GDd=b})}get isLicensed(){return this.GDd}Bvb(a){this.GDd=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.OOh,a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.Z1.dKb(Sr.a.uVa,this.jyc)}}Object(m.a)(uM,"ModernFontPickerFeatureHelper",null,[270,106]);class aA{constructor(a){this.PHa=
null;a?Object.getType(a)===String?this.PHa=aA.deserialize(a):this.PHa=a:(ia.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.PHa=[]);this.ZGa=!1}get isDirty(){return this.ZGa}get Ihd(){return Array.clone(this.PHa)}B5h(a){Array.contains(this.PHa,a)||(Array.add(this.PHa,a),this.ZGa=!0)}JWk(a){Array.contains(this.PHa,a)&&(Array.remove(this.PHa,a),this.ZGa=!0)}serialize(){return JSON.stringify(this.PHa)}u1k(){this.ZGa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return ia.ULS.sendTraceTag(543475147,
3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(m.a)(aA,"PinnedFontStore",null,[]);class vM{constructor(a,b,c,f){this.ia=a;this.la=c;this.aSg=b;this.zb=f;this.S4=null}initialize(){this.ia.ya(G.a.Dlc,de.a.frame,Object(F.a)(this,this.Dlc,"pinOrUnpinFont"));this.ia.ra(G.a.AXf,de.a.frame,Object(F.a)(this,this.z3g,"onFontPickerMenuClose"),96);this.aSg.kae("getPPTPinnedFontsSettings").continueWith(Object(F.a)(this,this.Wwk,"onRoamingSettingLoaded"))}mTj(a){return a.Tn?!1:a.tm?(ia.ULS.sendTraceTag(543273993,
3021,10,"Load setting failed with exception {0}",a.Yi),!1):!0}Wwk(a){this.mTj(a)?this.S4=new aA(a.result||this.e5f()):this.S4=new aA(this.e5f());this.Uch()}Uch(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.Ihd))}get Ihd(){return this.S4?this.S4.Ihd:[]}e5f(){return this.la.Ga("RecommendedFonts")}Dlc(a,b,c,f,l){if(!this.S4)return ia.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.S4.B5h(a):this.S4.JWk(a));
return 32}z3g(){if(!this.S4||!this.S4.isDirty)return 32;const a=af.a.OLc(10,Object(F.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.zb.Db(a);return 32}updatePinnedFonts(){this.S4&&(this.Uch(),this.unh(),this.S4.u1k())}unh(){if(this.S4&&this.S4.isDirty){var a=this.S4.serialize();this.aSg.Oel(a)}}dispose(){this.unh();this.ia.PJ(G.a.Dlc,de.a.frame,Object(F.a)(this,this.Dlc,"pinOrUnpinFont"));this.ia.PJ(G.a.AXf,de.a.frame,Object(F.a)(this,this.z3g,"onFontPickerMenuClose"))}}Object(m.a)(vM,
"FontPinningHandler",null,[271,106]);class Aq{static get Sgd(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}Aq.KDa="fontInfoTaskPane";Aq.eUi="modernfontpicker";Object(m.a)(Aq,"FontInfoPaneConstants",null,[]);class wM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(m.a)(wM,"FontInfoTaskPaneProps",null,[]);var mu=d(648);class bA{constructor(a,b,c,f=null){this.B5a=
this.DV=this.jyc=null;this._state=this.Oob=0;this.kVh=a;this.Z1=b;this.INh=c;this.Nd=f}get An(){return this.kVh.value}initialize(){this.An.ya(G.a.aSe,de.a.frame,Object(F.a)(this,this.aSe,"requestFontInfo"));this.jyc=this.Z1.rib(Sr.a.uVa,Object(F.a)(this,this.Bvb,"featureStateChangeCallback"));this.bkb()}Ql(a=!1){const b=mj.UISurfaces.zr(),c=this.Z1.isFeatureEnabled(Sr.a.uVa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(Aq.KDa,this.Jca(l[1]));a&&this.Wr()})}nHh(a){mj.UISurfaces.zr().then(b=>
{b.updateTaskPane(Aq.KDa,this.Jca(a));return null})}Bvb(a){this.nHh(a.isEnabled)}aSe(a,b,c,f,l){this.DV=l.CommandValueId;this.B5a=l.Trigger;this.Oob=l.InputMethod;this.Ql(2===this._state&&1===this.Oob);return 32}Jca(a){const b=new wM;b.onUpsellButtonClicked=Object(F.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");b.fontName=this.DV;b.isLicensed=a;b.trigger=this.B5a;b.helpArticleUrl=this.Xyi();b.paneId=Aq.KDa;a=this.FDj();a.contentProps=b;return a}FDj(){return Object.assign(new mu.a,{title:Aq.Sgd,
hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(F.a)(this,this.onOpen,"onOpen"),onClose:Object(F.a)(this,this.onClose,"onClose"),onShow:Object(F.a)(this,this.onShow,"onShow"),onHide:Object(F.a)(this,this.onHide,"onHide")})}bkb(){if(this.Nd){var a=this.Nd.Fc(Aq.KDa);a.parent=E.AFrame.gj;a.bJ=!0}}onOpen(){this._state=2;this.Wr()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.Oob=a),this.Wr())}onClose(){this.Oob=this._state=
0;this.blur()}onHide(){this._state=1;this.Oob=0}Wr(){this.Nd&&1===this.Oob&&this.Nd.tf(Aq.KDa)}blur(){this.Nd&&this.Nd.Ae&&this.Nd.Ae.name===Aq.KDa&&this.Nd.tf(this.Nd.n8)}onUpsellButtonClicked(){this.Z1.launchUpsellExperience(Aq.eUi)}dispose(){this.Z1.dKb(Sr.a.uVa,this.jyc)}Xyi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.INh,this.J$i(),"PPWAENDUSER",u.AFrameworkApplication.lcid)}J$i(){switch(this.B5a){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return bA.Gji(this.DV)}static Gji(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=ha.a.charAt(a,c);if(255<a.charCodeAt(c)||ha.a.lgg(f))b+=f}return b}}Object(m.a)(bA,"FontInfoPane",null,[272,106]);class xM extends bA{constructor(a,b,c,f){super(a,b,c.Ga("FontInfoHelpBaseUrl"),f)}Bvb(a){this.nHh(a.isEnabled)}}Object(m.a)(xM,"PPTFontInfoPane",bA,[]);
class tE{constructor(){this.B8c=this.Ddc=this.Edc=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Zb(a){this.K=a;this.K.register(270,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().oa(()=>new uM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(271,"Box4.IFontPinningStore").ma().oa(()=>new vM(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("Common.ITaskManager")));this.K.register(272,"Common.ModernFontPicker.IFontInfoPane").ma().oa(()=>new xM(new mc.a(()=>u.AFrameworkApplication.Ta),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.gf(()=>{this.K.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{a.ka("PPTOModernFontPickerIsEnabled")&&
(this.B8c=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.Ddc=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.Ddc.initialize(),b.isFeatureEnabled(Sr.a.uVa,!1).then(c=>{!u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.Edc=this.K.resolve("Box4.IFontPinningStore"),this.Edc.initialize())}),Oc.App.Kb.updateCommandUI())})})}dispose(){this.Ddc&&(this.Ddc.dispose(),this.Ddc=null);this.Edc&&(this.Edc.dispose(),this.Edc=null);this.B8c&&(this.B8c.dispose(),
this.B8c=null)}static main(){z.a.instance.Dc(new tE)}}Object(m.a)(tE,"PPTModernFontPickerPackage",null,[2,3]);var uE=d(1079);class yM{constructor(a){this.G$=a;this.xfb=this.G$.aGb("UserAction","ImageProcessor");this.V5j=67}Kpg(a,b){if(b)if(a&&this.tWj){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}nwh(a,b,c){c-=this.V5j;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=l)return null;let x=null,H=1,U=0;try{const ja=
Math.ceil(1.37*b);if(c<=ja){const ya=Math.sqrt(c/(1.3*ja));f=Math.floor(a.width*ya);l=Math.floor(a.height*ya)}if(x=this.EPf(a,f,l))if(U=x.length,x.length>=c){const ya=this.B6f(a.width,a.height);ya*Math.floor(a.width)*ya*Math.floor(a.height)>=f*l?x=null:(H++,(x=this.Vml(a))&&x.length>=c&&(x=null))}}catch(ja){x=null,ia.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+ja.message+", Call stack: "+ja.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,H,U,x?x.length:0);ia.ULS.sendTraceTag(20841026,826,50,a);return x}Vml(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.B6f(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.EPf(a,c,f)}catch(x){ia.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+x.message+", Call stack: "+x.stack)}}return b}EPf(a,b,c){if(0>=b||0>=c)return null;let f;this.xfb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var x=l.getContext("2d");f=this.xfb.Vq;
x.drawImage(a,0,0,b,c);x=this.xfb.Vq-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,x,this.xfb.Vq-(f+x));ia.ULS.sendTraceTag(20841028,813,50,a);return l}B6f(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get tWj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(m.a)(yM,"ImageProcessor",null,
[1165]);class vE{constructor(a,b,c,f,l){this.Ca=a;this.TNh=b;this.SNh=c;this.v8e=f;this.XXh=l}get An(){return this.Ca}cji(a){this.An.Kid(a,this.TNh,null,null)}aji(a){this.An.Kid(a,this.SNh,null,null)}Z7(a,b,c){c?this.An.Kid(a,this.v8e,b,null):this.An.La(this.v8e,2,b)}w9g(a,b=!1){const c=new J.DictionaryPropertySet;c.setValue(Mc.a.FU,a);c.setValue(Mc.a.vhd,!0);c.setValue(Mc.a.Eab,b);this.An.La(this.XXh,2,c)}}Object(m.a)(vE,"ClipboardCommands",null,[1142]);class wE{A3b(){}}Object(m.a)(wE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1223]);class Bq{constructor(a,b,c,f,l,x){this.DD=a;this.fh=b;this.gv=c;this.Hm=f;this.ap=l;this.fd=x}uGj(a,b){a=b.view;b=b.CE;if(!b||P.a.instance.ga(14)&&!this.DD.$hg(b,!0)||this.Hm&&this.Hm.instance&&this.Hm.instance.XW(b))return 2;var c=Bq.YU?!Bq.Wt.Xka(b):!0;this.gv&&c&&this.gv.Ttc(b.node,A.a.tq,b.Qa);this.fh.hXc(b,l=>new vv.a(l,vv.a.BMc),Mb.AParagraphNode.h_);if(this.fd.gg&&this.fd.Uy){c=new pf.GraphTransaction(15);try{c.kd(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Mb+1;" "===Sb.ParagraphReader.text(f).charAt(c)&&
(f=Wd.a.createTextRange(f,c,c+1),this.fh.replaceTextRange(f,"\u00a0"));b=Wd.a.Lj(b.node,c);a.Lb.setSelection(Qd.SelectionFactory.Du(b));return 32}static get Wt(){return Bq.BD||(Bq.BD=Db.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get YU(){null==Bq.nI&&(Bq.nI=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Bq.nI}}Bq.BD=null;Bq.nI=null;Object(m.a)(Bq,"InsertLineBreakStrategy",null,[]);class Ln{static get Ph(){return Ln.Di||(Ln.Di=
Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get km(){return Ih.ContextSetEditor.instance}static get C6(){return Ln.ap||(Ln.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Tf(){return Ln.fd||(Ln.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static CGj(a,b,c,f,l){if(l&&l.Sa(Mc.a.targetObject)){var x=b.view.xg.Fh.Be(l.eb(Mc.a.targetObject));x=Wd.a.create(x)}else x=Ln.km.Q2(b.CE,11);if(!x)return 8;a=u.AFrameworkApplication.Ta.mi(x,
a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Mh)return 2;b=b.view;f=b.Lb.Pj;if(f=Ln.km.Q2(f,11)){c=new tn.a;c.set(f.node);c.$e();if(l&&l.Sa(Mc.a.targetObject))for(l=l.Lh(Mc.a.targetObject);!c.currentNode.id.equals(l)&&c.zc()&&(Ta.OutlineElementNavigator.Re(c),11===c.ri););Ta.OutlineElementNavigator.Vwa(c,!1,!1);l=nb.SelectionEditor.Nja(c,!0);l=Sb.ParagraphReader.ps(l)?Qd.SelectionFactory.Sg(l,0):Qd.SelectionFactory.wl(l);b.Lb.setSelection(l)}}return a}static Iee(a,b,c,f,l){a=a===D.a.Q8b;b=b.node;if(l&&
l.Sa(Mc.a.targetObject)&&!b.id.equals(l.Lh(Mc.a.targetObject)))return 2;if(1===c)return 32;c=new tb.GraphIterator;c.set(b);c.rc(10);Ln.Ph.Gda(c,a,!0);Ln.Tf.gg&&Ln.Tf.Uy&&Ta.OutlineElementNavigator.wi(c);return 32}}Ln.Di=null;Ln.ap=null;Ln.fd=null;Object(m.a)(Ln,"InsertOutlineElementStrategy",null,[]);var jR=d(416);class cA{constructor(a,b,c,f,l,x,H,U){this.gv=b;this.PQh=a;this.Ht=l;this.Zo=f;this.Di=c;this.DD=x;this.Tc=H;this.T4a=U}Pnk(a,b,c,f,l){if(!b.view.Mh)return 2;b=b.view;let x=null;b.lp&&(x=
b);const H=b.Lb.Pj;let U=!0,ja=!1,ya=null;if(!H)return 2;const Va=new pf.GraphTransaction(15);Va.kd(b.xg);let hb=null;2===c&&(hb=new tn.a,hb.set(H.node),hb.$e(),ya=new sx(hb),2===Oc.App.mode&&nb.SelectionEditor.Tg(H)&&(hb.IB(11)&&rb.ListReader.uk(hb)&&fe.OutlineElementReader.isEmpty(hb,!1)&&(U=!1),U&&Oc.App.Ih.rw&&fe.OutlineElementReader.BC(hb,H,!1)&&!fe.OutlineElementReader.BC(hb,H,!0)&&(U=!1)),Ta.OutlineElementNavigator.Re(hb),fe.OutlineElementReader.isEmpty(hb,!1)&&(jR.a.VQj(hb)&&(U=!1),1===Oc.App.mode&&
rb.ListReader.uk(hb)&&(ja=!0)));a=u.AFrameworkApplication.Ta.mi(H,a,c,!1,f,l);U&&32===a&&2===c&&(ja||Ta.OutlineElementNavigator.SIa(hb,!1,!nb.SelectionEditor.Tg(H),!1),ja&&ya&&ya.restore(hb),P.a.instance.ga(101)&&this.Ht.freeze(),b.Lb.setSelection(Qd.SelectionFactory.tj(hb.currentNode,!0)),P.a.instance.ga(101)&&this.Ht.F1e(),this.PQh.Kn.qw());x&&(U||x.oya());ig.GrippersManager.instance.H1a(1);Va.dispose();return a}zB(a,b,c){a=!1;if(rd.ImageReader.rFa(b)||rd.ImageReader.Yyb(b))b=this.rAi(b),a=!0;const f=
b;b=nb.SelectionEditor.Tg(b);if(1===c)return 32;const l=f.node,x=new tb.GraphIterator;x.set(l);x.$e();Ta.OutlineElementNavigator.Re(x);c=new pf.GraphTransaction(15);c.Fy(x);b?(b=!0,P.a.instance.ga(101)&&Sb.ParagraphReader.$d(l)&&f.Qa===Sb.ParagraphReader.textLength(l)&&gf.n(f)&&9===Sb.ParagraphReader.ATc(l)&&this.Ht.gBi(f),1===Oc.App.mode&&fe.OutlineElementReader.isEmpty(x,!1)&&rb.ListReader.uk(x)&&(b=!1),this.Zo.vqh(x,b,f,l),this.gv&&this.gv.Ttc(l,A.a.tq,f.Qa),a&&(Ta.OutlineElementNavigator.FJ(x,
!1,!1),a=x.Bb(2),(a=this.T4a.Sg(a,0))&&this.Tc.setSelection(a))):this.Di.Gda(x,!0,!0);c.dispose();Oc.App.Kb&&Oc.App.Kb.updateCommandUI();return 32}rAi(a){if(rd.ImageReader.rFa(a))var b=Wd.a.Lj(a.node,a.Qa);else b=Sb.ParagraphReader.CCa(a.node),a=cA.L6i(a.node.properties.eb(ab.a.runId),b.properties.Lh(ab.a.EY),b.Ra),b=Wd.a.Lj(b,a);return b}static fYi(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static L6i(a,b,c){let f=0;a=cA.fYi(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<c.length;){b=
c.ga(l);if(b.formatting&&b.formatting.og===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(m.a)(cA,"NewLineStrategy",null,[]);class nu{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.Xs=null;this.EZ=a;this.byc=x;this.iBc=new cA(this,b,c,f,l,H,ya,Va);this.cef=new Bq(H,U,b,ja,hb,yb)}get Kn(){return this.Xs||(this.Xs=this.EZ())}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this.iBc,this.iBc.zB,"newLine");a.ra(D.a.enter,Cb.a.view,Object(F.a)(this.byc.value,this.byc.value.VSi,"enterView"),
1124);a.ra(D.a.Qpd,Cb.a.view,Object(F.a)(this.byc.value,this.byc.value.zgl,"shiftEnterView"),1124);a.ya(D.a.zB,Cb.a.view,Object(F.a)(this.iBc,this.iBc.Pnk,"newLineView"));a.ya(D.a.zB,Cb.a.Pf,b);a.ya(D.a.zB,Cb.a.image,b);a.ya(D.a.zB,Cb.a.textRange,b);a.ya(D.a.zB,Cb.a.anchoredObject,b);a.ya(D.a.zB,Cb.a.embeddedFile,b);a.ya(D.a.zB,Cb.a.ink,b);a.ya(D.a.zB,Cb.a.paragraph,b);a.ya(D.a.zB,Cb.a.iFrame,b);a.ya(D.a.zB,Cb.a.unsupportedObject,b);a.je(D.a.zB,1124);a.ra(D.a.O8b,Cb.a.view,Object(F.a)(this.cef,this.cef.uGj,
"insertLineBreakView"),1028);a.ya(D.a.Q8b,Cb.a.view,Ln.CGj);a.ya(D.a.Q8b,Cb.a.outlineElement,Ln.Iee);a.je(D.a.Q8b,1092)}static get instance(){return nu.Ka||(nu.Ka=nu.uC())}static uC(){return new nu(()=>Db.a.instance.resolve("Box4.IUndoManager"),Db.a.instance.ub("Box4.IAutoCorrectScheduler"),Db.a.instance.resolve("Box4.IOutlineElementEditor"),Db.a.instance.resolve("Box4.List.IListEditor"),Db.a.instance.resolve("Box4.IInsertionPointFormatting"),Db.a.instance.ie("Box4.Actors.IEnterViewStrategy"),fd.a.instance,
Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Db.a.instance.Ja("Box4.IExternalSelectionManager"),qd.a.instance,Db.a.instance.resolve("Box4.ISelectionFactory"),Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}nu.Ka=null;Object(m.a)(nu,"EnterActor",null,[]);class zM{qzh(a){return a}vkg(){return!0}}Object(m.a)(zM,"EopFormattingStrategy",null,[1145]);var AM=d(152);class xE{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.DOa=this.yVb=this.dnb=null;this.bLd=0;this.YCd=!1;this.Pa=new wc.a;this.ESb=null;this.IK=a;this.Ht=b;this.Kf=c;this.Vw=f;this.sr=l;this.Zo=x;this.Vg=H;this.fh=U;this.DD=ja;this.hd=ya;this.fd=Va;this.ap=hb;this.jPa=yb}get ZQi(){return P.a.instance.ga(105)?this.hd?this.hd.isFeatureEnabled(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get eda(){return this.ESb||(this.ESb=Db.a.instance.resolve("Box4.IFormatPainterStrategy"))}get wL(){return this.YCd}set wL(a){this.YCd!==
a&&(this.YCd=a,this.Pa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}K8h(a){this.Pa.addHandler("FormatPainterBrushActiveStatusChanged",a)}s$g(a){const b=a.Ua;ia.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.ckg(a);if(this.eda.duh(b.contextId,a))try{this.DOa=this.sr.yta(c)}catch(f){throw ia.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.yVb=Ab.StyleReader.bE(c);c=gc.a.xs(b);c.Vz&&(this.dnb=
Object(oa.a)(lq.a,c.Vz.clone()));this.bLd=a?Cb.a.paragraph:b.contextId;this.eda.pvf(b.node,this.DOa,this.dnb)}oxf(a){const b=P.a.instance.ga(14),c=this.ckg(a);for(let U=0;U<a.length;U++){var f=a.ga(U);if(f.al){var l=void 0;if(f.contextId===Cb.a.Pf||f.contextId===Cb.a.textRange)l=b&&this.DD.tua(f);else if(f.contextId===Cb.a.paragraph)l=b&&this.DD.l_c(f);else if(f.contextId===Cb.a.endOfParagraph)l=b&&this.DD.eZc(f);else{ia.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);
continue}ia.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)ia.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(oa.a)(Mb.AParagraphNode,f.node);var x=!1;l&&(x=f.contextId===Cb.a.textRange&&!!l&&!f.Qa&&f.Mb===this.sr.textLength(l));if(x=this.eda.uth(this.bLd,f.contextId,c,x))try{Sb.ParagraphReader.$d(l)?(this.yVb&&this.IK.Eaa(this.yVb,l,!0),this.Vw.sxf(l,this.DOa)):ia.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
f.node.type)}catch(ja){throw ia.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",ja.message),ja;}var H=f;f.contextId===Cb.a.paragraph?H=Wd.a.createTextRange(l,0,Sb.ParagraphReader.textLength(l)):f.contextId===Cb.a.Pf&&(H=this.Ht.j6b(f),H=qd.a.TQa(H));if(H&&H.contextId===Cb.a.textRange)try{this.rei(H,this.dnb,x?null:this.yVb)}catch(ja){throw ia.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ja.message),ja;}if(f.contextId===Cb.a.paragraph||f.contextId===
Cb.a.endOfParagraph){x=new tb.GraphIterator;x.set(l);x.$e();x.Jg(11);H=rb.ListReader.uk(x);const ja=!Sb.ParagraphReader.textLength(l);ia.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",H,ja);H?(this.Vg.ina(x),f=x.currentNode,this.Vg.Qda(f)&&this.Zo.Nod(f,l,this.dnb)):this.ZQi&&this.qei(f,this.dnb)}}}else ia.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}qei(a,b){b&&(a=this.fh.v1d(a.node),a.ae(a.He),this.pxf(a,
b,null))}rei(a,b,c){if(b||c)0<gf.h(a).length&&ia.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.jPa.wHc(a,f=>{this.pxf(f,b,c)})}pxf(a,b,c){this.Kf.qCa(a);a.Vz&&a.Vz.removeProperty($a.a.highlight);this.Kf.EJc(a);this.$x(a,c);this.$x(a,b)}$x(a,b){if(b){var c=a.paragraph.Fh;if(c){var f=a.Vz;f=f?Object(oa.a)(AM.a,f.clone()):lq.a.ACa(1179725);for(const x of b.$z())if(x!==ab.a.NG&&x!==ab.a.fieldInstruction&&x!==$a.a.ht&&x!==$a.a.E_&&x!==ab.a.wab&&x!==$a.a.it&&x!==ab.a.languageHint&&
x!==ab.a.noProof){if(x===dh.a.V2){var l=b.sa(dh.a.V2,ka.a.nil);if(l!==ka.a.nil&&(l=Object(oa.a)(lq.a,c.Be(l)),l=Ab.StyleReader.tUc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=Ab.StyleReader.qL(a.paragraph).Jkj(l);f.$x(l);continue}}f.setValue(x,b.Lh(x))}f.kbb?b=c.mKa(f):(c.HE(f),b=f);a.om=b.id}}}ckg(a){return!a.Cca&&a.Ye.contextId!==Cb.a.endOfParagraph}reset(){this.DOa=this.yVb=this.dnb=null;this.bLd=Cb.a.none}}Object(m.a)(xE,"FormatPainter",null,[617]);class dA{constructor(a){this.ll=this.transaction=
null;this.If=a;this.Ltb=this.rq=0}}Object(m.a)(dA,"SelectAllArguments",null,[]);class ds{constructor(a,b,c,f,l){this.MXh=a;this.Iha=b;this.Ak=c;this.nDd=f;this.XTb=l}get AJe(){return this.MXh}get Kn(){return this.Iha.value}get K6k(){return this.nDd?this.XTb?Object(F.a)(this,this.aUi,"expandSelectionOneNote"):Object(F.a)(this,this.bUi,"expandSelectionWord"):Object(F.a)(this,this.foh,"selectAllInOutline")}get goh(){return this.XTb?Object(F.a)(this,this.knd,"selectAllOutlines"):null}wb(){const a=u.AFrameworkApplication.Ta;
this.goh&&a.ra(D.a.knd,Cb.a.view,this.goh,2);a.ya(D.a.Iaa,de.a.frame,ds.dvh);a.ya(D.a.Rpd,de.a.frame,ds.dvh);a.ra(D.a.Ksa,Cb.a.view,this.K6k,2);a.ra(D.a.Uvf,Cb.a.view,E.AFrame.ve,100);a.ra(D.a.KEe,Cb.a.view,ds.KEe,4)}aUi(a,b,c){return this.Ksa(b,c,null)}Ksa(a,b,c){if(1===b)return 32;if(!a.view.Mh)return 2;b=a.view;if(!b.Lb)return 8;const f=b.Lb.Na;if(!f||!f.length)return 8;bd.a.mark(5798);Oc.App.Kb.Kd.isEditingAllowed||Oc.App.Kb.Kd.ez?a=nb.SelectionEditor.E8d(f):(v.FocusManager.instance().iD(E.AFrame.yW),
a=Qd.SelectionFactory.dUe(b.xg));if(!a)return 8;this.nDd&&!f.ksa&&ia.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.AJe.bbb(nb.SelectionEditor.A0f(a))?c=c(b):(c=new dA(b),c.ll=a,c=new Xh.a(null,Object(F.a)(this,this.QIb,"processSetSelection"),c),c.Pl("ExpandSelection"),c.run());return c.inProgress?1:32}bUi(a,b,c,f,l){return b.view.lp?this.Ksa(b,c,Object(F.a)(this,this.dyh,"startOperationOfSelectAllInOutline")):this.foh(a,b,c,f,l)}QIb(a,b){return 0===b.rq?(b.transaction=this.Ak.me(2),
b.transaction.kd(b.If.xg),b.rq=1,!0):1===b.rq?(b.If.Lb.ZLb(b.ll,a),b.rq=2,!0):2===b.rq?(b.If.Lb.Na.ksa=b.ll.ksa,this.Kn.qw(),b.transaction.TU(a),b.rq=3,b.transaction.dispose(),bd.a.mark(5799),!0):!1}foh(a,b,c){if(1===c)return 32;if(!b.view.Mh)return 2;a=b.view;return a.Lb&&a.Lb.Na&&a.Lb.Na.mb?this.dyh(a).inProgress?1:32:8}dyh(a){u.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.nDd&&a.lp&&ia.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new Xh.a(null,Object(F.a)(this,this.BKk,"processSelectAllInOutline"),new dA(a));a.Pl("SelectAllInOutline");a.run();return a}BKk(a,b){if(0===b.rq)return b.ll=Qd.SelectionFactory.L6k(b.If.Lb.Na.mb),b.transaction=this.Ak.me(2),b.transaction.kd(b.If.xg),b.rq=1,!0;if(1===b.rq){if(!b.Ltb)return P.a.instance.ga(77)&&P.a.instance.ga(104)&&b.ll.Hl?(b.If.Lb.ZLb(b.ll,a),b.Ltb=b.ll.length):(b.If.Lb.setSelection(b.ll.ga(0),a),++b.Ltb),!0;if(b.Ltb<b.ll.length)return b.If.Lb.stf(b.ll.ga(b.Ltb),a),++b.Ltb,!0;b.rq=
2}return 2===b.rq?(b.If.Lb.Na.ksa=b.ll.ksa,this.Kn.qw(),b.transaction.TU(a),b.rq=3,b.transaction.dispose(),!0):!1}knd(a,b,c){if(1===c)return 32;if(!b.view.Mh)return 2;b=b.view;a=Qd.SelectionFactory.dUe(b.xg);if(!a)return 8;b=new dA(b);b.ll=a;a=new Xh.a(null,Object(F.a)(this,this.QIb,"processSetSelection"),b);a.Pl("ExpandSelection");a.run();return a.inProgress?1:32}static get sjb(){return ds.S4a||(ds.S4a=Db.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static KEe(a,b,c){if(1===c)return 32;
if(!b.view.Mh)return 8;a=b.view;b=Qd.SelectionFactory.tj(a.root.graphNode,!0);if(!b)return 8;a.Lb.setSelection(b);return 32}static dvh(){if(!P.a.instance.ga(75))return 2;var a=Oc.App.Kb.Kd.MK;if(!a.Mh)return 2;if(a.Mh&&1!==Oc.App.Kb.state){bd.a.mark(4668);var b=a.Lb.Na.mb;if(!b&&u.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=nb.SelectionEditor.Ria(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;ds.sjb.Iaa(new Sys.UI.Point(c,f),1);bd.a.mark(4669)}return 32}}ds.S4a=null;Object(m.a)(ds,"SelectAllHandlers",null,[1146]);class BM extends jj.StandardDialog{constructor(a,b,c=null){super();this.xd=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.uOd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.cGb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(m.a)(BM,"ToggleRibbonUXDialog",
jj.StandardDialog,[]);const mR=()=>{const a=u.AFrameworkApplication.Ta;a.ra(G.a.rMk,de.a.frame,kR,101);a.ya(G.a.bwl,de.a.frame,lR)},lR=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==de.a.frame)return 2;ia.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",u.AFrameworkApplication.Aa.hb.Np?"Single Line Ribbon":"Classic Ribbon");new BM(f=>{1===f&&u.AFrameworkApplication.Ta.processAction(G.a.mCh,2)},u.AFrameworkApplication.Aa.hb.Np);return 32},kR=(a,b,c,f,l)=>{l[Sh.a.On]=
u.AFrameworkApplication.Aa.hb.Np;return 32};class yE{constructor(a){this.Kf=a}vVe(a,b){this.Kf.UU(a,b.cache.GN);this.Kf.Pq(a,b.cache.fontSize)}gVe(){}U7d(){return null}LW(){return null}mTa(){return null}K8(){return null}zuh(){return!1}}Object(m.a)(yE,"FormattingStewardBridge",null,[1139]);var CM=d(731),nR=d(684);class DM{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){if(a)if(b)if(c)if(f)if(l)if(x)if(H){if(!U)throw Error.argumentNull("errorHandler");if(!ja)throw Error.argumentNull("sessionInfo");}else throw Error.argumentNull("graphActionBlockingManager");
else throw Error.argumentNull("graphTopologyManager");else throw Error.argumentNull("graphOperationEventSource");else throw Error.argumentNull("pptWorkspace");else throw Error.argumentNull("transactionFactory");else throw Error.argumentNull("pptSelectionManager");else throw Error.argumentNull("actionManager");this.ia=a;this.ob=b;this.Jb=c;this.RX=f;this.Es=l;this.ua=x;this.fc=H;this.Rd=U;this.Fe=ja;this.w2c=ya;this.mic=Va;this.beb=hb}wb(){this.ia.ra(K.a.nsf,rc.a.application,Object(F.a)(this,this.Xpj,
"handleAddEditOrSetAsSlideTitle"),4);this.ia.ra(K.a.editSlideTitle,rc.a.application,Object(F.a)(this,this.h$f,"handleEditSlideTitle"),4);this.ia.ra(K.a.addSlideTitle,rc.a.application,Object(F.a)(this,this.O9f,"handleAddSlideTitle"),4);this.ia.ra(K.a.Hsf,rc.a.application,Object(F.a)(this,this.Zpj,"handleAddHiddenSlideTitle"),4);this.ia.ra(K.a.setAsSlideTitle,rc.a.application,Object(F.a)(this,this.mag,"handleSetAsSlideTitle"),4);this.ia.ra(K.a.wah,rc.a.application,Object(F.a)(this,this.Asj,"handleHyperlinkText"),
4);this.ia.ya(K.a.urf,rc.a.application,Object(F.a)(this,this.Upj,"handleAccessibleAuthoringHelp"));this.ia.ra(K.a.Peg,Cb.a.application,Object(F.a)(this,this.Fag,"handleUploadCaptionsDialog"),4);this.ia.ra(K.a.Qeg,Cb.a.application,Object(F.a)(this,this.Fag,"handleUploadCaptionsDialog"),4);this.ia.ra(K.a.chh,rc.a.application,Object(F.a)(this,this.tvj,"handleRemoveAllCaptions"),4)}Ee(){}vEa(){const a=this.ob.tk();return a?a.vEa():null}onShapeSelected(a,b){this.Es.Tih(Object(F.a)(this,this.onShapeSelected,
"onShapeSelected"));b.shapeNode.h4?32!==this.ia.processAction(K.a.fsb,2)&&xa.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):xa.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")}hoh(){const a=this.vEa();return a?(this.Es.Tuf(Object(F.a)(this,this.onShapeSelected,"onShapeSelected")),this.ob.selectShape(a,!0),!0):!1}Whg(){const a=this.ob.Qe();return!!a&&1===a.length&&!!this.vEa()}fgg(){for(const a of this.ob.Qe())if(a&&
!a.vEa())return!0;return!1}gmg(){var a=this.ob.Wd();if(1!==a.length)return!1;a=a[0];return!a.h4&&!a.Jf&&!a.Ng&&!a.Rf&&a.hasText&&0<a.textLength()}Xpj(a,b,c,f,l){if(1===c)return 32;var x=this.vEa();const H=this.ob.Wd(),U=1===H.length?H[0]:null;0<H.length&&U!==x?this.gmg()?(x=3,a=this.mag(a,b,c,f,l)):(x=4,a=32):this.Whg()?(x=1,a=this.h$f(a,b,c,f,l)):this.fgg()?(x=2,a=this.O9f(a,b,c,f,l)):(xa.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),x=5,a=8);Gp.a("AddEditOrSetAsSlideTitle",
32===a,void 0,[Object.assign(new wd.a,{name:"SubAction",int64:x})]);return a}h$f(a,b,c){return 1===c?this.Whg()?32:2:this.hoh()?32:8}P9f(a,b,c){if(1===b)return this.fgg()?32:2;b=new Date;const f=this.Jb.Ad(15,void 0,void 0,()=>{const l=this.ob.Qe();if(l&&1===l.length){const x=new Date;let H=0;H=window.setInterval(()=>{this.hoh()?window.clearInterval(H):2E3<+new Date-+x&&(xa.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(H))},
100)}});try{xa.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",c);f.nc(this.RX.Ef);f.jd=a;for(const l of this.ob.Qe())l&&!l.vEa()&&(l.xFa=c)}finally{f&&f.dispose()}a=new Date;xa.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",c);if(c=Tc.a.Ib)c.Xm("AddSlideTitleStart",b),c.Xm("AddSlideTitleEnd",a),c.Nj=!1,c.Ur=!0,Tc.a.Ofa(c);return 32}O9f(a,b,c){return this.P9f(a,c,!1)}Zpj(a,b,c){return this.P9f(a,c,!0)}mag(a,b,c){if(1===c)return this.gmg()?
32:2;c=this.ob.tk();const f=this.ob.Wd();if(1!==f.length)return xa.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;b=new Date;const l=this.Jb.Ad(15);try{xa.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,f[0].get_shapeId()),l.nc(c),l.jd=a,c.hLa=f[0].get_shapeId()}finally{l&&l.dispose()}a=new Date;xa.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",c.Cb.cid,f[0].get_shapeId());
if(c=Tc.a.Ib)c.Xm("SetAsSlideTitleStart",b),c.Xm("SetAsSlideTitleEnd",a),c.Nj=!1,c.Ur=!0,Tc.a.Ofa(c);32!==this.ia.processAction(K.a.fsb,2)&&xa.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32}Asj(a,b,c){return this.ob.z_()?this.ia.processAction(D.a.n8b,c):this.ia.processAction(K.a.xrb,c)}Upj(a,b,c){if(1===c)return 32;a={};this.w2c&&(a.query="AssetID="+this.w2c);b={};b.WE=ResourceStrings.L_Help;b.assetId="FA000000012";b.nonPersistedSettings=a;return this.ia.La(K.a.gga,
2,b)}MOj(){if(!this.mic)return!1;const a=this.ob.Wd();return 1!==a.length?!1:a[0].OQ}Fag(a,b,c){const f=this.ua.Ba;if(!f||this.fc.$c(f))return 8;if(1===c)return this.MOj()?32:2;b=Tc.a.yk("Captions::Insert");try{return nR.a.fZe(".vtt",CM.e,()=>CM.d(a,Object(F.a)(this,this.hGj,"insertCaptionsSuccessAfterUpload"),"captions",this.Fe,f),"captions",f,this.ua.presentation,this.fc,this.Rd,b,!1,this.beb,50,10,3),b&&b.Va("CaptionsDialogInitialized","true"),32}catch(l){xa.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}b&&
(b.Va("CaptionsDialogInitialized","false"),b.finish(),b=null);return 8}hGj(a,b,c,f,l,x,H){f.UN(c)&&xa.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+c.gja);f.fK(c);l&&l.Va("CaptionsUploadToRC","true");Object(Ud.a)("FixForInsertMediaSlideNavigationIssue")||(H=this.ua.Ba);if(H&&H.isConnected){x=x.files[0].name;f=c="";var U=x.split(".");2<=U.length&&(f=U[U.length-2]);Ya.a.xe(f)||(c=x.lastIndexOf("."),c=0<=c?x.substring(0,
c):x,f="");x=this.ob.Wd();if(1===x.length){x=x[0];U=this.Jb.Ad(15);try{U.nc(H),U.jd=a,l&&l.Va("InsertCaptionsInProgress","true"),x.$sb=b,x.Ysb=c,x.Zsb=f}finally{U&&U.dispose()}l&&(l.Va("InsertCaptionsSuccessful","true"),l.finish())}}}WSj(){if(!this.mic)return!1;const a=this.ob.Wd();return 1!==a.length?!1:a[0].OQ}tvj(a,b,c){if(1===c)return this.WSj()?32:2;b=this.ob.Wd();if(1!==b.length)return 16;c=b[0];b=new Date;const f=this.Jb.Ad(15);try{xa.a.J(509724635,822,50,"RemoveAllCaptions started"),f.nc(this.RX.Ef),
f.jd=a,c.Vzb=!0}finally{f&&f.dispose()}a=new Date;xa.a.J(509724634,822,50,"RemoveAllCaptions completed");if(c=Tc.a.Ib)c.Xm("RemoveAllCaptionsStart",b),c.Xm("RemoveAllCaptionsEnd",a),c.Nj=!1,c.Ur=!0,Tc.a.Ofa(c);return 32}}Object(m.a)(DM,"AccessibleAuthoringActor",null,[352]);var oR=d(142),pR=d(172),qR=d(181);class EM{constructor(a,b,c,f){this.l6c=!1;this.G9="";this.OCb=!1;this.SXa=null;this.J3c=-1;this.WCb=!1;this.tla=[];this.Pb=b;this.la=c;this.Ibd=f;a&&this.Pb.gf(()=>{a.wF(Object(F.a)(this,this.qxk,
"onSelectionChangeFinished"))})}wb(){}Ee(){}g6b(a,b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}NTc(a){const b=[];for(let c=0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}Z5f(a){const b=[];let c=!1;if(a){switch(this.G9){case "FormatPicture":Array.addRange(b,
this.NTc("PictureStyles"));c=!0;break;case "Table":this.WCb||Array.addRange(b,this.NTc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.NTc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.NTc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.g6b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.g6b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",
0)),Array.addRange(b,this.g6b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.WCb&&(a=0),Array.addRange(b,this.g6b(this.SXa,"DropLabel",a)),a=this.SXa.slice(0,this.SXa.length).reverse(),Array.addRange(b,this.g6b(a,"MoveToOverflow",null)))}else for(const f of this.SXa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}j6d(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.aGa("Error","GetModelType failed for "+
c),null}return b}w6d(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}cPb(a){this.Ibd&&(a=this.j6d(a))&&this.Ibd(a)}aCl(a){if(a.length){if(this.Ibd){var b=this.j6d(a);if(!b)return;var c=this.w6d(this.G9);if(0<c.length&&!this.OCb){for(var f of c)this.tla.push(appChrome.actions.updateGroupHiddenState(f,!0));this.OCb=!0}else if(this.OCb&&!c.length){c=[];f=this.w6d("FormatPicture");for(var l of f)this.tla.push(appChrome.actions.updateGroupHiddenState(l,
!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.j6d(c))for(let x in l)b[x]=l[x];this.OCb=!1}this.Ibd(b)}this.SXa=a;b=[];for(const x of a)appChrome.selectors.isControlDisabled(x)&&b.push(x);0<b.length&&this.aGa("Disabled",b.join(","));0<this.SXa.length&&(this.tla.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.tla.push(appChrome.actions.updateControlsInGroup("Adaptive",this.SXa)),Array.addRange(this.tla,this.Z5f(!0)),this.l6c=!0)}}Jkh(a){""!==this.G9&&
this.G9!==a&&Array.addRange(this.tla,this.Z5f(!1))}l4e(a,b){if(a||this.l6c)if(this.tla.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a)),this.l6c=a,b=this.w6d(b),a&&0<b.length||this.OCb){for(var c of b)this.tla.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.cPb(c));this.OCb=a}}dPf(){0<this.tla.length&&(appChrome.api.dispatch(this.tla),this.tla=
[])}Qri(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.cPb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;a=!1;if("Table"===b&&zj.a.instance.mb){const c=!zj.a.instance.mb.Hl&&!zj.a.instance.mb.m0c;if(a=(""===this.G9||this.G9===b)&&c!==this.WCb)this.WCb=c}a?this.Jkh("TableCellEdit"):this.Jkh(b);this.G9=b;return!0}S6k(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();
for(const f of a)if(this.Qri(c,f)){b=!0;break}return b?this.G9:""}v3i(){switch(this.G9){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Table":return this.WCb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");
case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}qxk(a,b){if(!this.la.Ooa&&"Home"===appChrome.selectors.getSelectedTabId()&&b.ll&&b.ll.mb&&b.ll.length){var c=()=>{const f=this.G9;""===this.S6k()?this.l4e(!1,f):this.WCb||""===f||f!==this.G9?this.aCl(this.v3i()):this.l6c||(this.cPb(this.SXa),this.l4e(!0,this.G9));this.dPf()};-1!==this.J3c&&window.clearTimeout(this.J3c);this.J3c=window.setTimeout(()=>
{this.J3c=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.l4e(!1,this.G9),this.dPf()}aGa(a,b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};oR.a.sendActivityEvent(Object.assign(new qR.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:pR.a.pC(a),durationMs:window.performance.now()}))}}Object(m.a)(EM,"AdaptiveTabGroupUpdaterActor",null,[352]);class FM extends Lt{constructor(a,
b){super(a);this.f2h=b;this.Ft=a}getAltText(a){return(a=this.vQ(a))?a.get_altTitle():""}Q0f(a){return(a=this.vQ(a))?a.get_alt():""}mQd(a,b){if(1===a)if(this.hide(),a=this.vQ(this.Ft)){const c=this.f2h.me(15);c.nc(a);a.C0a=!1;a.set_altTitle(b[kq.oQd]);a.set_alt(b[kq.lQd]);c.dispose()}else xa.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}vQ(a){let b;return(a=(a=Kj.b(a))?a.Lb:null)&&(b=a.Wd())&&1===b.length?b[0]:null}}Object(m.a)(FM,"ShapeAltTextDialog",Lt,[]);class GM{constructor(a,
b,c,f,l,x){this.Jb=l;this.ia=a;this.la=b;this.ob=f;this.xcb=c;this.fc=x}wb(){this.la.mgg&&this.ia.ra(K.a.xrb,Cb.a.view,Object(F.a)(this,this.gdi,"altTextDispatcher"),4)}Ee(){}c3i(a){new FM(a,this.Jb)}gdi(a,b,c){if(a!==K.a.xrb)return 16;a=this.ob.Wd();if(!a||1!==a.length||this.fc.$c(a[0]))return xa.a.J(17876881,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===c)return 32;xa.a.J(17876883,822,50,"Begin setting the alternative text for shape.");
a[0].Fj&&!a[0].get_isSVGBlipFilled()&&this.la.EUa?this.xcb.yPk():this.c3i(b);return 32}}Object(m.a)(GM,"AltTextActor",null,[352]);class HM{constructor(a,b,c,f,l,x,H,U){this.lE=null;this.ia=a;this.ob=b;this.Ea=c;this.Jb=f;this.hcb=l;this.Cva=x;this.mc=U;this.hcb&&this.hcb.execute(ja=>{this.lE=ja})}wb(){this.ia.ra(K.a.NHc,rc.a.application,Object(F.a)(this,this.Eqj,"handleAudioPlay"),96);this.ia.ra(K.a.zZb,rc.a.application,Object(F.a)(this,this.Dqj,"handleAudioPause"),96);this.ia.ra(K.a.Fyf,rc.a.application,
Object(F.a)(this,this.Mgi,"audioPlayPauseCommandHandler"),96);this.ia.ra(K.a.sph,rc.a.application,Object(F.a)(this,this.u7b,"handleSetAudioOptions"),96);this.ia.ra(K.a.Mmc,rc.a.application,Object(F.a)(this,this.Mmc,"queryAudioOptions"),96);this.ia.ra(K.a.playAcrossSlides,rc.a.application,Object(F.a)(this,this.u7b,"handleSetAudioOptions"),96);this.ia.ra(K.a.cnc,rc.a.application,Object(F.a)(this,this.cnc,"queryPlayAcrossSlides"),96);this.ia.ra(K.a.loopUntilStopped,rc.a.application,Object(F.a)(this,
this.u7b,"handleSetAudioOptions"),96);this.ia.ra(K.a.Zmc,rc.a.application,Object(F.a)(this,this.Zmc,"queryLoopUntilStopped"),96);this.ia.ra(K.a.hideDuringShow,rc.a.application,Object(F.a)(this,this.u7b,"handleSetAudioOptions"),96);this.ia.ra(K.a.Umc,rc.a.application,Object(F.a)(this,this.Umc,"queryHideDuringShow"),96);this.ia.ra(K.a.rewindAfterPlaying,rc.a.application,Object(F.a)(this,this.u7b,"handleSetAudioOptions"),96);this.ia.ra(K.a.hnc,rc.a.application,Object(F.a)(this,this.hnc,"queryRewindAfterPlaying"),
96);this.ia.ya(K.a.playInBackground,rc.a.application,Object(F.a)(this,this.nag,"handleSetAudioStyles"));this.ia.ya(K.a.noAudioStyle,rc.a.application,Object(F.a)(this,this.nag,"handleSetAudioStyles"));this.ia.ra(K.a.dnc,rc.a.application,Object(F.a)(this,this.dnc,"queryPlayInBackground"),96);this.ia.ra(K.a.$mc,rc.a.application,Object(F.a)(this,this.$mc,"queryNoAudioStyle"),96);this.ia.ra(K.a.setVolume,rc.a.application,Object(F.a)(this,this.v7b,"handleSetVolume"),96);this.ia.ra(K.a.xpd,rc.a.application,
Object(F.a)(this,this.v7b,"handleSetVolume"),96);this.ia.ra(K.a.lnc,rc.a.application,Object(F.a)(this,this.lnc,"querySetVolumeLow"),96);this.ia.ra(K.a.ypd,rc.a.application,Object(F.a)(this,this.v7b,"handleSetVolume"),96);this.ia.ra(K.a.mnc,rc.a.application,Object(F.a)(this,this.mnc,"querySetVolumeMedium"),96);this.ia.ra(K.a.wpd,rc.a.application,Object(F.a)(this,this.v7b,"handleSetVolume"),96);this.ia.ra(K.a.knc,rc.a.application,Object(F.a)(this,this.knc,"querySetVolumeHigh"),96);this.ia.ra(K.a.zpd,
rc.a.application,Object(F.a)(this,this.v7b,"handleSetVolume"),96);this.ia.ra(K.a.nnc,rc.a.application,Object(F.a)(this,this.nnc,"querySetVolumeMute"),96);this.ia.ra(K.a.Oxh,rc.a.application,Object(F.a)(this,this.xwj,"handleStartAudio"),96);this.ia.ra(K.a.vnc,rc.a.application,Object(F.a)(this,this.vnc,"queryStartAudio"),96)}Ee(){}Eqj(a,b,c,f,l){b=this.ob.Wd();if(1<b.length||!this.lE)return 16;const x=this.lE.hL(b[0]);if(!x||!x.isPlayerReady())return 16;if(1===c)return 32;let H=!1;l&&(H=!!l.ActionFromPlayer);
return Kg.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",H.toString(),a,()=>{x&&!H&&x.startPlaying();const U=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(U);return 32})}Dqj(a,b,c,f,l){const x=this.ob.Wd();if(1<x.length||!this.lE)return 16;if(1===c)return 32;let H=!1;l&&(H=!!l.ActionFromPlayer);return Kg.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",
H.toString(),a,()=>{var U=this.lE.hL(x[0]);U&&!H&&U.pause();U=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(U);return 32})}Mgi(){var a=this.ob.jUc();if(!a||!this.lE)return 2;(a=this.lE.hL(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(K.a.zZb,2):this.ia.processAction(K.a.NHc,2));return 32}u7b(a,b,c,f,l){if(1===c)return 32;
if(!l)return xa.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const x=l.On;return Kg.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const H=this.ob.tg();if(H&&0<H.length){const U=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{U.nc(H[0]);for(const ja of H){if(!ja||!ja.media)continue;const ya=ja.media;switch(a){case K.a.playAcrossSlides:ya.plyAcrssSldsField=x;break;case K.a.loopUntilStopped:ya.repeatField=
x;break;case K.a.hideDuringShow:ya.hideDrngShwField=x;break;case K.a.rewindAfterPlaying:ya.rewindField=x}ja.media=ya;if(this.Cva&&this.lE&&(a===K.a.loopUntilStopped||a===K.a.rewindAfterPlaying)){const Va=this.lE.hL(ja);Va&&(a===K.a.loopUntilStopped?Va.setRepeat(ya.repeatField):a===K.a.rewindAfterPlaying&&Va.setRewind(ya.rewindField))}}}finally{U&&U.dispose()}}return 32})}nag(a,b,c,f,l){return 1===c?32:l?Kg.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const x=this.ob.tg();
if(x&&0<x.length){const H=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{H.nc(x[0]);for(const U of x){if(!U||!U.media||U.Ng)continue;const ja=U.media;switch(a){case K.a.playInBackground:ja.plyAcrssSldsField=!0;ja.repeatField=!0;ja.hideDrngShwField=!0;ja.strtField=0;break;case K.a.noAudioStyle:ja.plyAcrssSldsField=!1,ja.repeatField=!1,ja.hideDrngShwField=!1,ja.strtField=2}U.media=ja}}finally{H&&H.dispose()}}return 32}):(xa.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),
8)}xwj(a,b,c,f,l){if(1===c)return 32;if(!l)return xa.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const x=l.CommandValueId;return Kg.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",x,a,()=>{if(!x||""===x.trim())return 32;const H=this.ob.tg();if(H&&0<H.length){const U=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{U.nc(H[0]);for(const ja of H){if(!ja||!ja.media||ja.Ng)continue;const ya=ja.media;ya.strtField="Automatically"===x?0:
2;ja.media=ya}}finally{U&&U.dispose()}}return 32})}dnc(a,b,c,f,l){return this.Nxa(l,1)}$mc(a,b,c,f,l){return this.Nxa(l,0)}v7b(a,b,c,f,l){return 1===c?32:l?Kg.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const x=this.ob.tg();if(x&&0<x.length){const H=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{H.nc(x[0]);for(const U of x){if(!U||!U.media)continue;const ja=U.media;switch(a){case K.a.zpd:ja.mteField=!0;break;case K.a.xpd:ja.vlmField=.2;ja.mteField=!1;
break;case K.a.ypd:ja.vlmField=.5;ja.mteField=!1;break;case K.a.wpd:ja.vlmField=.8,ja.mteField=!1}this.mc.zL&&(U.media=ja);const ya=l.ActionFromPlayer;if(this.Cva&&this.lE&&!ya){const Va=this.lE.hL(U);Va&&(Va.setMute(ja.mteField),Va.setVolume(ja.vlmField))}}}finally{H&&H.dispose()}}return 32}):(xa.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}lnc(a,b,c,f,l){return this.Nxa(l,2)}mnc(a,b,c,f,l){return this.Nxa(l,3)}knc(a,b,c,f,l){return this.Nxa(l,4)}nnc(a,
b,c,f,l){return this.Nxa(l,5)}vnc(a,b,c,f,l){if(a=Object(oa.a)(Uh.a,l))c=this.ob.tg(),b=this.Ykg(c,2),c=this.Ykg(c,0),b?(a.YZ=ResourceStrings.L_AudioStartWhenClickedOn,a.Qpc()):c&&(a.YZ=ResourceStrings.L_AudioStartAutomatically,a.Qpc());return 32}Mmc(){this.P$b()&&Oc.App.Kb.sG({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}cnc(a,b,c,f,l){return this.Nxa(l,6)}Zmc(a,b,c,f,l){return this.Nxa(l,7)}Umc(a,
b,c,f,l){return this.Nxa(l,9)}hnc(a,b,c,f,l){return this.Nxa(l,8)}HQi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}GQi(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}Ykg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}Nxa(a,b){if(a=Object(oa.a)(Uh.a,a)){const c=this.ob.tg();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.GQi(l);break;case 1:f=
this.HQi(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Mf(f)}}return 32}P$b(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np}}
Object(m.a)(HM,"AudioPlaybackOptionsActor",null,[352]);class IM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(m.a)(IM,"AudioSettingsTaskPaneProps",null,[]);class ou{constructor(){this.text=
this.key=null;this.itemType=0;this.selected=!1}}Object(m.a)(ou,"DropdownOption",null,[]);class JM{constructor(a,b,c,f,l){this.hM=null;this.cHa=this.Eb=!1;a.loadScript("audio-settings-strings").then(()=>{this.cHa=!0;xa.a.J(592447300,833,50,"audio-settings-strings loaded successfully")}).catch(x=>{xa.a.J(592447298,833,10,"Failed to load audio-settings-strings "+x.toString())});this.ia=b;this.oE=f;this.Hc=c;this.iO=l}wb(){this.ia.ya(K.a.uqd,rc.a.application,Object(F.a)(this,this.uqd,"showHideAudioSettingsPane"));
this.ia.ra(K.a.yJb,rc.a.application,Object(F.a)(this,this.yJb,"queryShowHideAudioSettingsPane"),96)}Ee(){}uqd(a,b,c){return b.contextId===rc.a.application&&this.cHa?1===c?32:Kg.a("AudioSettingsPaneToggle",a,()=>{(this.Eb=!this.Eb)?(this.Ql(),this.iO.G8h(Object(F.a)(this,this.G1g,"onAudioDevicesChanged")),xa.a.J(592447296,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.iO.PXk(Object(F.a)(this,this.G1g,"onAudioDevicesChanged")),this.WK(),xa.a.J(592447266,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));
return 32}):2}yJb(a,b,c,f,l){if(!Object(Xa.a)(Uh.a,l))return 8;l.Mf(this.Eb);return 32}Ql(a=!1){a||this.vC();const b=Object.assign(new mu.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.hM,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.oE.X8(zb.a.dCa,zb.a.gj,c,()=>{this.yA(!0)},()=>{this.yA(!1)});mj.UISurfaces.zr().then(f=>{a?this.Eb&&f.updateTaskPane(zb.a.dCa,b):f.showTaskPane(zb.a.dCa,
b);return null}).catch(f=>{xa.a.J(592447264,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}WK(){mj.UISurfaces.zr().then(a=>{a.hideTaskPane(zb.a.dCa,2);return null}).catch(a=>{xa.a.J(592447262,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}vC(){this.hM=Object.assign(new IM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.nkj(),availableSubtitleLanguages:this.$kj(),onMicrophoneUpdated:Object(F.a)(this,this.uEl,"updateMicrophone"),
onSpeakersUpdated:Object(F.a)(this,this.LFl,"updateSpeaker"),onSpokenLanguageUpdated:Object(F.a)(this,this.OFl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(F.a)(this,this.UFl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.iO.enumerateDevices(Object(F.a)(this,this.Ujc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.$Ya,"onDevicesFailure"),Object(F.a)(this,this.kZa,"onUnsupported"))}yA(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");
a&&b&&b.focus()}Ujc(a){if(0!==a.length)if(ha.a.Wa(a[0].label))this.iO.requestPermission(Object(F.a)(this,this.Qwk,"onRequestPermissionSuccess"),Object(F.a)(this,this.$Ya,"onDevicesFailure"),Object(F.a)(this,this.kZa,"onUnsupported")),xa.a.J(592447260,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Ka.a,c=new Ka.a;for(const f of a)ha.a.Wa(f.deviceId)||(a=Object.assign(new ou,{key:f.deviceId,text:ha.a.Wa(f.label)?f.deviceId:f.label}),"audiooutput"===
f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.hM.deviceMicrophones=b.toArray();this.hM.deviceSpeakers=c.toArray();this.hM.disableDeviceDropdown=!1;this.hM.showDeviceErrorMessage=!1;this.Ql(!0)}}Qwk(){this.iO.enumerateDevices(Object(F.a)(this,this.Ujc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.$Ya,"onDevicesFailure"),Object(F.a)(this,this.kZa,"onUnsupported"));xa.a.J(592447258,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}$Ya(a){this.hM.disableDeviceDropdown=
!0;this.hM.showDeviceErrorMessage=!0;this.Ql(!0);xa.a.J(592447256,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}kZa(){this.hM.disableDeviceDropdown=!0;this.Ql(!0);xa.a.J(592447254,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",B.a.Sy)}uEl(a){this.iO.microphoneDeviceId=a.key;xa.a.J(592447252,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}LFl(){xa.a.J(592447250,833,
50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}G1g(a,b){b.llk&&this.iO.enumerateDevices(Object(F.a)(this,this.Ujc,"onEnumerateDevicesSuccess"),Object(F.a)(this,this.$Ya,"onDevicesFailure"),Object(F.a)(this,this.kZa,"onUnsupported"))}nkj(){const a=new Ka.a;for(let b of this.Hc.a0e)a.add(Object.assign(new ou,{key:b,text:Ya.a.xe(b).displayName,selected:this.Hc.Toa.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new ou,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new ou,
{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(let b of this.Hc.$_e)a.add(Object.assign(new ou,{key:b,text:Ya.a.xe(b).displayName,selected:this.Hc.Toa.toLowerCase()===b.toLowerCase()}));return a.toArray()}$kj(){const a=new Ka.a;for(let b of this.Hc.LZe)a.add(Object.assign(new ou,{key:b,text:Ya.a.xe(b).displayName,selected:this.Hc.xza.toLowerCase()===b.toLowerCase()}));return a.toArray()}OFl(a){this.Hc.Toa=a.key;xa.a.J(592447248,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}UFl(a){this.Hc.xza=
a.key;this.Hc.ylb=this.Hc.PUc();xa.a.J(592447246,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(m.a)(JM,"AudioSettingsPaneActor",null,[352]);class KM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(m.a)(KM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Kv{constructor(a,b,
c,f,l,x,H,U,ja,ya){this.BEg=!1;a.loadScript("powerpoint-discoverability-strings").then(()=>{this.BEg=!0;xa.a.J(591971352,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Va=>{xa.a.J(591971350,801,10,"Failed to load powerpoint-discoverability-strings "+Va.toString())});this.ia=b;this.Lc=c;this.oc=f;this.qe=l;this.oE=x;this.Hc=H;this.iO=U;this.Fak=ya;this.zgk=ja;this.kTg=ki.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.tec=!1;this.Lc.g6a(Object(F.a)(this,this.faa,
"onRibbonTabSwitched"))}dispose(){this.Lc.pKb(Object(F.a)(this,this.faa,"onRibbonTabSwitched"))}wb(){this.ia.ya(K.a.jrc,rc.a.application,Object(F.a)(this,this.jrc,"showCaptionDiscoverabilityPane"))}Ee(){}jrc(a,b,c){if(b.contextId!==rc.a.application||!this.BEg)return 2;if(1===c)return 32;if(Kv.ake||Kv.$_d||!this.wVi()||!this.vVi())return 8;this.tec||this.Qqi(a);return 32}Qqi(a){Kg.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.tec=!0;this.iO.enumerateDevices(Object(F.a)(this,
this.Rqk,"onAudioInputAvailable"),Object(F.a)(this,this.$Ya,"onDevicesFailure"),Object(F.a)(this,this.kZa,"onUnsupported"));return 32})}Rqk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.zgk.mbb()){Kv.ake=!0;this.Ql();break}this.tec=!1}}$Ya(a){this.tec=!1;xa.a.J(591538019,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}kZa(){this.tec=!1;xa.a.J(591538017,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",
B.a.Sy)}Ql(){const a=this.vC(),b=Object.assign(new mu.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{xa.a.J(591538015,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{xa.a.J(591738121,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.oE.X8(zb.a.qQa,zb.a.gj,null,()=>{},()=>{});mj.UISurfaces.zr().then(c=>{c.showTaskPane(zb.a.qQa,b);return null}).catch(c=>{xa.a.J(591971348,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",
c.toString())})}Cr(){mj.UISurfaces.zr().then(a=>{a.hideTaskPane(zb.a.qQa,2);return null}).catch(a=>{xa.a.J(591971346,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}vC(){return Object.assign(new KM,{podiumPresentationImageUrl:this.qe.qk("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.kTg,onTurnOnButtonClicked:Object(F.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(F.a)(this,this.onDismissButtonClicked,
"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(F.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){Kg.a("CaptionDiscoverabilityPaneTurnOn",K.a.ZLa,()=>{let a=8;this.Hc.Kh||(a=this.ia.La(K.a.ZLa,2,{}));this.Fak&&8!==a||this.Cr();return a})}onDismissButtonClicked(){this.kTg&&(Kv.$_d=!0,xa.a.J(591738117,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Cr()}onLaunchSlideShowButtonClicked(){Kg.a("CaptionDiscoverabilityPaneLaunchSlideshow",
K.a.nNb,()=>{this.Cr();return this.ia.processAction(K.a.nNb,2)})}faa(a,b){2!==b.Hu&&3!==b.Hu&&4!==b.Hu||!b.W$||"SlideShow"!==b.W$||Kg.a("OnRibbonTabSwitched",K.a.jrc,()=>this.ia.processAction(K.a.jrc,2))}vVi(){let a=0,b=!1,c=!1;for(var f of this.oc.hwb()){if(f.en){b=!0;break}if(f.EEa&&(a+=f.kQ.length,4<=a))break;if(f.O$a){c=!0;break}}f=c||b||4<=a;xa.a.J(591738113,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",
f.toString(),a.toString(),b.toString(),c.toString());return f}wVi(){return!this.Hc.Kh&&this.dVi()}dVi(){const a=Ya.a.xe(u.AFrameworkApplication.lcid);return!a||ha.a.Wa(a.name)?!1:a.name.toLowerCase()===this.Hc.Toa}static get ake(){var a=ki.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set ake(a){ki.a.$J("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),ki.a.DJ)||xa.a.J(591971344,822,
10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get $_d(){const a=ki.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set $_d(a){ki.a.$J("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),ki.a.DJ)||xa.a.J(591971342,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(m.a)(Kv,"CaptionDiscoverabilityPaneActor",null,[352]);var LM=d(729);class dt{constructor(a,b){this.id=a;this.version=
b}}Object(m.a)(dt,"PackageAccessKey",null,[]);const Lv=a=>a?xd.c({["I"]:a.id,["V"]:a.version}):null;var vp=d(332),MM=d(956);class Wx extends MM.a{constructor(a,b,c){super(a,b);this.Gaa=c}}Object(m.a)(Wx,"ClipServiceShapeCopyParams",MM.a,[]);var zE=d(678),AE=d(712),BE=d(445);class Xx{constructor(a,b,c){this.ia=a;this.Ea=b;this.KHa=c}nQ(a){a=Xx.y5b(a);return this.KHa.j9b(this.Ea)&&!!a&&!!a.src}paste(a){u.AFrameworkApplication.PQ?BE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,
null):this.ia.La(K.a.ulc,2,a)}static y5b(a){if(!a||!a.un)return xa.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.un.getElementsByTagName(lf.a.W8);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(m.a)(Xx,"ImagePasteHandler",null,[1202]);var Om=d(434);class CE{constructor(){this.Abh=this.k0d=null}}Object(m.a)(CE,"PasteSlideAsImageData",null,[]);class DE{constructor(){this.pastedContent=this.Axa=null}}Object(m.a)(DE,"PasteSlideAsImageFromRibbonData",
null,[]);var EE=d(682);class FE extends Sys.EventArgs{constructor(a,b,c){super();this.Gp=a;this.Vpi=b;this.Wpi=c}}Object(m.a)(FE,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class NM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(m.a)(NM,"CopiedShape",null,[]);class OM{constructor(){this.Cid=this.Sid=0}}Object(m.a)(OM,"CopiedSlide",null,[]);class GE extends rf.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=
null}Zk(){return 65}}Object(m.a)(GE,"CopyRequest",rf.a,[]);class Yx{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf){this.Pxe=this.Qva=null;this.ia=a;this.jO=f;this.Ea=l;this.fc=x;this.ua=H;this.Jb=U;this.UL=Gc;this.vi=ja;this.Vb=ya;this.wx=Va;this.xGa=hb;this.Fb=yb;this.Wj=Zb;this.la=b;this.pa=fc;this.Gtg=Kc;this.Fck=ae;this.Ge=Lc;this.Tb=we;this.Gck=$d;this.Nr=Te;this.xze=this.la.plg;this.OAe=this.la.Plh;this.Es=Ze;this.Cc=Vf;this.TC=gg;this.Jv=Qg;this.qIg=
Rg;this.LL=Wf;if(!this.TC)throw xa.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");}wb(){this.ia.ra(K.a.gXd,rc.a.application,Object(F.a)(this,this.trj,"handleCopySlidesToClipService"),0);this.ia.ra(K.a.shd,rc.a.application,Object(F.a)(this,this.obe,"handlePasteSlidesFromClipService"),4);this.ia.ra(K.a.vlc,rc.a.application,Object(F.a)(this,this.duj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.ra(K.a.WHb,rc.a.application,
Object(F.a)(this,this.euj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.ra(K.a.SNe,rc.a.application,Object(F.a)(this,this.ojd,"queryPasteOptions"),97);this.ia.ra(K.a.TIf,rc.a.application,Object(F.a)(this,this.srj,"handleCopyShapesToClipService"),0);this.ia.ra(K.a.E9g,rc.a.application,Object(F.a)(this,this.auj,"handlePasteShapesFromClipService"),4);this.ia.ra(K.a.G9g,rc.a.application,Object(F.a)(this,this.nbe,"handlePasteSlideFromDesktop"),4);this.ia.ra(K.a.rhd,rc.a.application,
Object(F.a)(this,this.buj,"handlePasteSlideAsImage"),4);this.ia.ra(K.a.F9g,rc.a.application,Object(F.a)(this,this.cuj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.ra(K.a.dMf,rc.a.application,Object(F.a)(this,this.urj,"handleCutShapes"),4);this.ia.ra(K.a.f2d,rc.a.application,Object(F.a)(this,this.f2d,"expandPasteFloatieMenu"),96);this.ia.ra(K.a.eMf,Cb.a.application,Object(F.a)(this,this.vrj,"handleCutSlides"),4);this.ia.ra(K.a.L9g,Cb.a.application,Object(F.a)(this,this.Utj,"handlePasteCancelledByUser"),
2048)}Ee(){}cuj(a,b,c,f,l){xa.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(oa.a)(DE,l);if(!a||!a.Axa)return xa.a.J(512356639,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.Axa.Wb;b=this.Cc.hP(2,1,"HandlePasteSlideAsImageFromRibbon");this.Cc.Zh("PasteSlideAsImageFromRibbon",c,b);a.Axa.Wb=b;this.TC.paste(a.Axa,a.pastedContent,!0);return 32}buj(a,b,c,f,l){a=Object(oa.a)(CE,l);if(!a||!a.k0d)return xa.a.J(512356638,
826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.TC.rhd(a.k0d,a.Abh);return 32}f2d(a,b,c){if(1===c)return 32;this.Fck.LNk();return 32}ojd(a,b,c,f,l){if(!this.Nr||!this.Nr.khb)return 8;a=this.Nr.khb.zA;l.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[Sh.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[Sh.a.On]=null!=a&&a));return 32}euj(a,b,c,f){if(1===c)return 32;const l=this.Nr.khb;if(!l)return 8;
const x=l.Bu,H=l.wM;if(!x&&!H)return 8;if(null!=l.zA&&l.zA)return 32;l.Wb=this.Cc.hP(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");l.zA=!0;const U=this.Tb.XA(this.Nr.XJe);xa.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(H)return H.skipUndo=!0,H.selectionSlide=U,this.nbe(a,b,c,f,l);x.skipUndo=!0;x.selectionSlide=U;return this.obe(a,b,c,f,l)}duj(a,b,c,f){if(1===c)return 32;const l=this.Nr.khb;if(!l)return 8;const x=l.Bu,H=l.wM;if(!x&&
!H)return 8;if(null!=l.zA&&!l.zA)return 32;l.Wb=this.Cc.hP(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.zA=!1;const U=this.Tb.XA(this.Nr.XJe);xa.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(H)return H.skipUndo=!0,H.selectionSlide=U,this.nbe(a,b,c,f,l);x.skipUndo=!0;x.selectionSlide=U;return this.obe(a,b,c,f,l)}srj(a,b,c,f,l){a=Object(oa.a)(Wx,l);if(!a)return xa.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.Bu;
c=a.Gaa;if(!b||!c||!c.length)return xa.a.J(512356634,307,50,"Copied shapes are empty."),this.Cc.Hg(!1,a.Wb,23),8;if(this.fc.yUa())return this.Cc.Hg(!1,a.Wb,2),16;if(cb.a.any(c,H=>H.X3))return xa.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];for(var x of c)f.push(Object.assign(new NM,{Sid:x.slideSid,Cid:x.slideCid,ShapeId:x.get_shapeId()}));x=Object.assign(new GE,{CcpId:b.Gp,Location:b.location,Shapes:f,CcpCorrelation:a.Wb,PackageAccessKey:Lv(new dt(a.Bu.zy,
b.version))});this.XOc(x,2,a.Wb);return 32}auj(a,b,c,f,l){b=Object(oa.a)(Om.a,l);if(!b)return 8;3!==b.Bu.dataType?this.Cc.KB(2,b.Wb):(this.Cc.KB(7,b.Wb),this.Cc.Hw(5,b.Wb));c=b.Bu;if(!c)return this.Cc.Hg(!1,b.Wb,16),xa.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.Bu.dataType&&this.Cc.Hw(AE.ClipboardHelper.Ygg(c)?2:3,b.Wb);f=this.ua.Ba;if(!f||!f.isConnected)return this.Cc.Hg(!1,b.Wb,3),xa.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",
f?"not null":"null"),16;if(this.fc.$c(f))return this.Cc.Hg(!1,b.Wb,3),xa.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),2;if(!this.Wj.OF(f,c.objectCount))return this.Cc.Hg(!1,b.Wb,8),xa.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.Wj.nG(f),16;this.eOd(c.Gp,b.Wb);Tc.a.Cza("PasteShapesFromClipService",!0);Tc.a.nP(!1,!1);this.Pxe&&this.Pxe===c.Gp||(this.Qva=new Rd.a(0));f.tN=
c.Gp;f.aQ=c.location;f.Y2=c.tD;f.UZ=Yx.W1e(c.Msa);f.zy=Lv(new dt(c.zy,c.version));l=null;this.Cc.H$b(b.Wb)&&(l=Xx.y5b(b));if(this.OAe&&3===b.Bu.dataType)try{let x=0;this.Qva&&this.Qva.Hb(f.Cb)&&(x=this.Qva.ga(f.Cb));this.fc.pSd(f,a,x);xa.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(x){xa.a.J(512356627,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.xGa.hIi(f,c,this.Qva,a,b.Wb,l);this.Pxe=c.Gp;this.Cc.Hg(!0,b.Wb);return 32}urj(a,
b,c,f,l){if(this.fc.yUa())return 16;if(1===c)return 32;Tc.a.nP(!0,!0);const x=this.pa.tg();b=this.pa.tk();var H=f=c=null;let U=[];l=Object(oa.a)(Wx,l);if(!l)return 8;if(l.Bu){var ja=l.Bu;U=l.Gaa;if(!U||!U.length)return 8;c=ja.Gp;H=ja.version;f=ja.location;H=Lv(new dt(ja.zy,H))}else for(ja of x)ja.i0c&&U.push(ja);for(var ya of U)if(ya.Jf||ya.Ng){un(ya);break}ya=this.Jb.Ad(15,void 0,()=>{this.pa.Qh()});try{ya.nc(b),ya.jd=a,this.Gtg.Teh(new FE(c,f,H)),b.Wb=l.Wb,b.LU(U)}finally{ya&&ya.dispose()}for(const Va of U)this.Es.Aeh(new gK.a(Va));
this.jO.ene=c;return 32}vrj(a,b,c,f,l){b=this.pa.Qe();if(!b||!b.length||!this.ua.Ba)return 16;for(var x of b)if(!x||this.fc.$c(x)||!x.isConnected)return 16;if(1===c)return 32;Tc.a.Ib&&(Tc.a.Ib.actionName="CutSlide",Tc.a.Ib.Ur=!1,Tc.a.Ib.Nj=!0,Tc.a.Ib.sF=new Date,Tc.a.Ib.Va("SlideCount",b.length.toString()));f=x=c=null;var H=[];l=Object(oa.a)(zE.a,l);if(!l)return 8;if(l.Bu){f=l.Bu;H=l.Lwh;if(!H||!H.length)return 8;c=f.Gp;H=f.version;x=f.location;f=Lv(new dt(f.zy,H))}H=this.Vb.Ef;if(!H)return 16;const U=
this.Jb.Ad(15,void 0,()=>{this.pa.Qh()});try{this.Gtg.Teh(new FE(c,x,f));U.nc(H);for(const ja of b)ja&&!ja.Cb.equals(this.ua.Ba.Cb)&&H.xI(ja);H.xI(this.ua.Ba);U.jd=a;H.Wb=l.Wb}finally{U&&U.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.fc.fw(H,a);this.Es?this.Es.skd(new EE.a(b)):xa.a.J(512356626,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.jO.ene=c;return 32}XOc(a,b){this.jO.Yqk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",
vp.a.type,LM.a(b))];Tc.a.zk("CcpId",a.CcpId);c=new ti.a(a,()=>{this.gsk(a)},f=>this.fsk(f,a,b),f=>0===f.StatusCode,void 0,c);xa.a.J(512356625,307,50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.vi.Db(c)}gsk(a){this.jO.j1g(!0,a)}fsk(a,b,c){xa.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",LM.a(c),b.CcpId,a.StatusCode));this.jO.j1g(!1,b);return!0}eOd(a,b){const c=Tc.a.Ib;c&&(c.Va("CcpId",a),this.Cc.Zh("CcpId",a,b))}trj(a,b,c,f,l){a=
Object(oa.a)(zE.a,l);if(!a||!a.Bu)return xa.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",a?"not null":"null"),8;xa.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.Bu.Gp);b=a.Lwh;if(!b||!b.length||0>=Mj.e(b,x=>Object(Xa.a)(116,x)).length)return xa.a.J(512356621,307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(cb.a.any(b,x=>x.hasDeferredContent))return xa.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),
8;b=Object.assign(new GE,{CcpId:a.Bu.Gp,Location:a.Bu.location,MultiSlideCopy:!0,Slides:Mj.c(b,x=>Object.assign(new OM,{Sid:x.sid,Cid:x.cid})),CcpCorrelation:a.Wb,PackageAccessKey:Lv(new dt(a.Bu.zy,a.Bu.version))});this.XOc(b,1,a.Wb);return 32}nbe(a,b,c,f,l){if(1===c)return 32;b=Object(oa.a)(Om.a,l);if(!b)return xa.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.wM;if(!c||ha.a.Wa(c.ccpid)||ha.a.Wa(c.data))return xa.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",
c?c.ccpid:"null")),this.Cc.Hg(!1,b.Wb,28),8;Tc.a.Cza("PasteSlideFromDesktop",!0);this.eOd(c.ccpid,b.Wb);this.Cc.Hw(12,b.Wb);f={};f.CcpCorrId=b.Wb;return this.T$f(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.zA?b.zA:!0,c.ccpid,null,null,u.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}obe(a,b,c,f,l){if(1===c)return 32;b=Object(oa.a)(Om.a,l);if(!b)return xa.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Tc.a.Cza("PasteSlidesFromClipService",
!0);c=b.Bu;if(!c)return this.Cc.Hg(!1,b.Wb,16),xa.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.Cc.Hw(AE.ClipboardHelper.Ygg(c)?2:3,b.Wb);this.eOd(c.Gp,b.Wb);f=this.wx.bje(c);return!this.la.klg&&f?(this.Cc.Hg(!1,b.Wb,17),xa.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.T$f(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.zA?b.zA:!0,c.Gp,c.location,c.tD,c.zy,c.version,c.Msa,
null,!1)}T$f(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){this.Cc.KB(19,a.Wb);const fc=this.ua.presentation;if(!fc)return this.Cc.Hg(!1,a.Wb,3),xa.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.fc.$c(fc))return this.Cc.Hg(!1,a.Wb,3),xa.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Kc=this.ua.Ba;if(Kc&&!Kc.isConnected)return this.Cc.Hg(!1,a.Wb,3),xa.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),
16;xa.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),x.toString()));this.xze&&!this.wx.Hgg(a)&&this.Gck.l7h();this.Nr.j1c=Date.now();this.UL.WW(this.Tb.Ym)&&xa.a.J(512356612,307,50,"cross session paste slide happened before last action server result is not returned");Tc.a.nP(!1,!1);let Lc;var Gc=null;Kc=this.la.Wqd&&!ha.a.Wa(yb)&&1!==this.Fb.Fl;if(c)Gc=f,Lc=null;else{Gc=this.ua.presentation;if(!Gc)throw Error.argumentNull("Presentation is null");
Lc=Array.isArray(Gc.dLf(l,a.Wb,Kc))?Gc.dLf(l,a.Wb,Kc):null;f=Gc=this.bfj();this.Nr.position=null;this.Nr.XJe=Gc?Gc.slideIndex:0}l=null;c||(l=()=>{let ae;(ae=this.pa).JR.apply(ae,Lc)});l=this.Jb.Ad(15,void 0,()=>{this.Ea.tf(zb.a.XE)},l);try{if(l.nc(fc),l.jd=c?fc.zbb?K.a.WHb:K.a.vlc:b,Kc?(fc.iua=!0,this.Jv.init(H)):(fc.tN=H,fc.zbb=x,fc.VJe=Gc?Gc.Cb:null,fc.aQ=U,fc.Y2=ja,fc.UZ=Yx.W1e(hb),fc.skipUndo=c,fc.zy=Lv(new dt(ya,Va)),fc.Ozb=null==Zb?!1:Zb,fc.wlc=yb,fc.Wb=a.Wb),!c){U=Gc;for(ja=0;ja<Lc.length;ja++)this.la.Jn?
fc.lab(Lc[ja],U,null,!0):fc.lab(Lc[ja],U,null),U=Lc[ja],Kc&&(Lc[ja].iua=!0,this.Jv.qka.add(Lc[ja].id));this.Vb.Ba=Lc[Lc.length-1];this.Ge.q8a=!0}}finally{l&&l.dispose()}Kc?(this.Jv.lud(!0),this.fc.blockContent(fc,b)):this.fc.fw(fc,b);this.Nr.khb=a;this.Nr.nkb=!0;this.Nr.AJa=null;this.Ge.q8a=!0;this.Nr.S1b=this.Tb.Ym.bK;Kc&&(this.Cc.Zh("DisplayNewPasteProgressUX","true",a.Wb),this.iJi(yb,u.AFrameworkApplication.userSessionId,Gc,c,x,H,hb,Zb,a.Wb));this.Cc.Hg(!0,a.Wb);return 32}iJi(a,b,c,f,l,x,H,U,ja){const ya=
this.Cc.hP(2,0,"DataUploadInit");this.Cc.Hw(13,ya);this.Cc.KB(19,ya);this.Cc.Zh("DataUploadInitOldCcpCorrId",ja,ya);this.Jv.CCl(ya);const Va=(new Date).getTime();this.qIg.uql(a,b,x,()=>{const hb=(new Date).getTime()-Va;xa.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",x,hb);this.Cc.Zh("DataUploadTime",hb.toString(),ya);this.hJi(ya,b,c,f,l,x,H,U)},hb=>{xa.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",
x,dk.a[hb.error.Code],(new Date).getTime()-Va);this.wrj();this.Cc.Hg(!1,ya,30)})}hJi(a,b,c,f,l,x,H,U){const ja=this.ua.presentation;if(ja){this.Jv.$ok();Tc.a.nP(!1,!1);xa.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Jv.qka.toArray().join(",").toString());var ya=this.Jb.Ad(15);try{ya.nc(ja),ya.jd=K.a.WHb,ja.VJe=c?c.Cb:null,ja.T_b=b,ja.xlc=this.Jv.qka.toArray().join(",").toString(),ja.tN=x,ja.UZ=Yx.W1e(H),ja.skipUndo=f,ja.Ozb=null==U?!1:U,ja.zbb=l,ja.Wb=a}finally{ya&&ya.dispose()}this.Cc.Hg(!0,
a)}else xa.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}Utj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return xa.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;xa.a.J(512356578,307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.qIg.Epi(a);this.Cc.Hg(!1,l,31);return 32}wrj(){this.Jv.qDf(!0);this.LL.fga(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,20)}Gol(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}bfj(){const a=this.pa.Qe();return 0<a.length&&(this.Gol(a),a[0])?a[0]:this.ua.Ba}static W1e(a){return JSON.stringify(a)}}Object(m.a)(Yx,"ClipServiceActor",null,[352]);class HE{constructor(){this.actionId=0;this.context=null;this.behavior=0;this.rd=this.SJ=null}}Object(m.a)(HE,"AActionArgs",null,[]);class IE extends HE{constructor(){super()}}Object(m.a)(IE,"ActionArgs$2",HE,[]);class JE extends IE{constructor(){super()}}
Object(m.a)(JE,"ActionArgs$1",IE,[]);var Cq=d(393),pu=d(386);class et{constructor(a,b=!1){this.ohg=!0;this.Wb=null;this.dataType=0;this.tVi=a;this.kua=b}}Object(m.a)(et,"CutCopyParams",null,[]);var Mv=d(444),PM=d(536);class eA{constructor(a,b,c,f){this.ia=a;this.Oak=f;this.KHa=c;this.Ea=b}nQ(a){return this.KHa.j9b(this.Ea)&&!!eA.K1f(a)}paste(a){this.Oak?BE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(xa.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),
this.ia.La(K.a.Bxa,2,a))}static K1f(a){return a&&a.un?(a=a.un.getElementsByTagName(lf.a.VNb))&&a.length?a[0]:null:null}}Object(m.a)(eA,"TablePasteHandler",null,[1202]);class $k{static get EA(){return Db.a.instance.ub("PowerPointWebEditor.ISystemClipboard")}}Object(m.a)($k,"SystemClipboardFactory",null,[]);class QM{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf){this.Qva=this.I7c=null;this.Mwg=0;this.pvj=(rg,Sg,Gh,Zi,Ei)=>{if(1===Gh)return 32;rg=this.uCe.Mua;
Ei&&Ei.SourceControlId&&("PasteTextOnlyFloatie"==Ei.SourceControlId?Ei[Sh.a.On]=rg===D.a.L5||rg===D.a.e_a:"PasteTextKeepingSourceFormatting"==Ei.SourceControlId&&(Ei[Sh.a.On]=rg===D.a.Z7||rg===D.a.paste||rg===D.a.reformatPastedContent));return 32};this.juj=(rg,Sg,Gh)=>{if(2==Gh){rg=this.uCe.Mua;if(rg===D.a.L5||rg===D.a.e_a)return 32;this.ia.processAction(D.a.e_a,Gh)}return 32};this.iuj=(rg,Sg,Gh)=>{if(2==Gh){rg=this.uCe.Mua;if(rg===D.a.Z7||rg===D.a.paste||rg===D.a.reformatPastedContent)return 32;
this.ia.processAction(D.a.reformatPastedContent,Gh)}return 32};if(!Rg)throw Error.argumentNull("DeferredContentManager");if(U.ka("IsPasteTextFloatieEnabled")&&!Wf)throw Error.argumentNull("textPasteFloatieManager");this.ia=a;this.Ea=b;this.pa=c;this.Zg=yb;this.fc=ya;this.Qla=Va;this.TC=hb;this.Vb=f;this.jq=l;this.yw=Rg;this.Jb=x;this.fA=H;this.Jq=ja;this.xGa=Zb;this.Tb=fc;this.Sk=Kc;this.Fb=Lc;this.Lvg=Gc;this.pcb=ae;this.Wj=we;this.QT=$d;this.LWa=Ze;this.zb=Vf;this.X9=gg;this.Cc=Qg;this.la=U;this.uCe=
Wf}wb(){this.la.zYc?(this.ia.ra(K.a.oub,rc.a.application,Object(F.a)(this,this.d$f,"handleCutCopyToSystemClipboardAsync"),4),this.ia.ra(K.a.a1b,rc.a.application,Object(F.a)(this,this.d$f,"handleCutCopyToSystemClipboardAsync"),0),this.ia.ra(K.a.slc,rc.a.application,Object(F.a)(this,this.yVc,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(K.a.wJa,rc.a.application,Object(F.a)(this,this.yVc,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(K.a.xJa,rc.a.application,Object(F.a)(this,this.yVc,"handlePasteFromSystemClipboardAsync"),
4),this.ia.ra(K.a.rZa,rc.a.application,Object(F.a)(this,this.yVc,"handlePasteFromSystemClipboardAsync"),4)):(this.ia.ra(K.a.oub,rc.a.application,Object(F.a)(this,this.c$f,"handleCutCopyToSystemClipboard"),4),this.ia.ra(K.a.a1b,rc.a.application,Object(F.a)(this,this.c$f,"handleCutCopyToSystemClipboard"),0),this.ia.ra(K.a.slc,rc.a.application,Object(F.a)(this,this.xVc,"handlePasteFromSystemClipboard"),4),this.ia.ra(K.a.wJa,rc.a.application,Object(F.a)(this,this.xVc,"handlePasteFromSystemClipboard"),
4),this.ia.ra(K.a.xJa,rc.a.application,Object(F.a)(this,this.xVc,"handlePasteFromSystemClipboard"),4),this.ia.ra(K.a.rZa,rc.a.application,Object(F.a)(this,this.xVc,"handlePasteFromSystemClipboard"),4));this.ia.ra(K.a.SIf,rc.a.application,Object(F.a)(this,this.rrj,"handleCopyShapes"),0);this.ia.ra(K.a.phd,Cb.a.application,Object(F.a)(this,this.$tj,"handlePasteShapes"),4);this.ia.ra(K.a.ulc,rc.a.application,Object(F.a)(this,this.Ztj,"handlePastePicture"),4);this.ia.ra(K.a.Bxa,Cb.a.application,Object(F.a)(this,
this.guj,"handlePasteTable"),4);this.ia.ra(K.a.qhd,rc.a.application,Object(F.a)(this,this.fuj,"handlePasteSlides"),4);this.ia.ra(K.a.$Je,rc.a.application,Object(F.a)(this,this.huj,"handlePasteTextIntoNewShape"),4);this.ia.XV(K.a.rah,rc.a.application,Object(F.a)(this,this.Oqj,"handleBrowserCut"),4);this.ia.XV(K.a.fid,rc.a.application,Object(F.a)(this,this.Nqj,"handleBrowserCopy"),0);this.ia.XV(K.a.hid,rc.a.application,Object(F.a)(this,this.Pqj,"handleBrowserPaste"),4);this.ia.XV(K.a.Bah,rc.a.application,
Object(F.a)(this,this.Xtj,"handlePasteGivenText"),4);this.ia.ra(K.a.r9g,rc.a.application,Object(F.a)(this,this.Wtj,"handlePasteContentFromPandora"),4);this.ia.ra(K.a.vJa,Cb.a.application,Object(F.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.ra(K.a.nhd,Cb.a.application,Object(F.a)(this,this.Ytj,"handlePasteHtmlAsync"),4);this.ia.ra(K.a.eXd,de.a.frame,Object(F.a)(this,this.Vtj,"handlePasteChartAsImage"),4);this.ia.ya(K.a.qZd,de.a.frame,Object(F.a)(this,this.b$f,"handleCutCopyThroughShortcuts"));
this.ia.ya(K.a.VIf,de.a.frame,Object(F.a)(this,this.b$f,"handleCutCopyThroughShortcuts"));this.ia.ra(K.a.K9g,de.a.frame,Object(F.a)(this,this.kuj,"handlePasteThroughShortcuts"),4);this.la.ka("IsPasteTextFloatieEnabled")&&(this.ia.ra(K.a.I9g,de.a.frame,this.iuj,4),this.ia.ra(K.a.J9g,de.a.frame,this.juj,4),this.ia.ra(K.a.IOe,de.a.frame,this.pvj,4))}Ee(){if(Ud.a("ShortcutsFixInMac")&&B.a.L$b){const a=[this.Ea.Fc(Qi.a.PD),this.Ea.Fc(zb.a.sg)];for(const b of a)b.bindAction(y.KeyInputManager.Oa(A.a.Oza,
y.KeyInputManager.Oe),K.a.VIf),b.bindAction(y.KeyInputManager.Oa(A.a.T1a,y.KeyInputManager.Oe),K.a.K9g)}}b$f(a){a=K.a.qZd===a;const b=this.Cc.hP(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.Qla.Bsa(Object.assign(new et(!1,a),{Wb:b}));return 32}kuj(){const a=this.Cc.hP(2,0,"OnBrowserPaste");this.TC.paste(Object.assign(new Om.a(!0),{Wb:a}),null,!1);return 32}d$f(a,b,c,f){let l,x;if(!({tF:l,qMc:x}=this.mIf(c,a)).returnValue)return l;if(!$k.EA)return this.Cc.Hg(!1,x.Wb,1),8;this.Wca(a,b,c,f,!0,x.Wb);
return 32}yVc(a,b,c,f){if(1===c)return this.pa.tUa()?2:a===K.a.wJa?2:a===K.a.xJa?this.Rqc(!1):a===K.a.rZa?this.Rqc(!0):32;const l=this.Cc.hP(2,1,"HandlePasteFromSystemClipboardAsync");if(this.pa.k9())return this.Cc.Hg(!1,l,3),16;if(!$k.EA)return this.Cc.Hg(!1,l,1),8;this.Wca(a,b,c,f,!1,l);Tc.a.nP(!0,!1);return 32}Rqc(a){xa.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.pa.z_()?(xa.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.TC.Mqi(a)?
32:2}xPf(a,b){a===K.a.oub?this.Qla.Bsa(Object.assign(new et(!1,!0),{Wb:b})):a===K.a.a1b?this.Qla.Bsa(Object.assign(new et(!1),{Wb:b})):a===K.a.slc?this.TC.paste(Object.assign(new Om.a(!1),{Wb:b}),null,!1):a===K.a.wJa?this.TC.paste(Object.assign(new Om.a(!1),{Wb:b,zA:!1}),null,!1):a===K.a.xJa?this.TC.paste(Object.assign(new Om.a(!1),{Wb:b,zA:!0}),null,!1):a===K.a.rZa?this.TC.paste(Object.assign(new Om.a(!1),{Wb:b,G8a:!0}),null,!1):(xa.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),
this.Cc.Hg(!1,b,5))}Wca(a,b,c,f,l,x){$k.EA.Wca(l);l=$k.EA.X5;null!=l&&l?this.xPf(a,x):(a=new Xh.a(null,Object(F.a)(this,this.e6e,"waitingForEnsureAccessOperationResult"),Object.assign(new JE,{actionId:a,context:b,behavior:c,SJ:f,rd:x})),a.Pl("ClipboardPreProcess"),this.Mwg=Date.now(),a.run())}e6e(a,b){a=!0;let c=!1;const f=b.rd.toString(),l=$k.EA.X5,x=$k.EA.iy;null!=l?(a=!1,l?this.xPf(b.actionId,f):c=!0):Date.now()-this.Mwg>this.la.MEf&&null!=x&&(xa.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),
a=!1,c=!0);c&&this.Cc.Hg(!1,f,29);return a}c$f(a,b,c){if(!({tF:a,qMc:b}=this.mIf(c,a)).returnValue)return a;this.Qla.Bsa(b);return 32}mIf(a,b){let c;c=32;const f=K.a.oub===b;b=new et(!1,f);const l=!!this.Qla&&this.Qla.nQ(b);if(1===a)return c=this.pa.tUa()?2:l?32:16,{returnValue:!1,tF:c,qMc:b};a=this.Cc.hP(f?1:0,1,"HandleCutCopyToSystemClipboard");this.Cc.Hw(1,a);b.Wb=a;return!l||this.fc.yUa()?(this.Cc.Hg(!1,a,2),{returnValue:!1,tF:16,qMc:b}):{returnValue:!0,tF:c,qMc:b}}xVc(a,b,c){if(1===c)return this.pa.tUa()?
2:a===K.a.wJa?this.Rqc(!1):a===K.a.xJa?this.Rqc(!1):a===K.a.rZa?this.Rqc(!0):32;b=this.Cc.hP(2,1,"HandlePasteFromSystemClipboard");c=this.jq.Ba;if(!c||this.fc.$c(c)||this.pa.k9())return this.Cc.Hg(!1,b,3),16;c=null;let f=!1;a===K.a.wJa?c=!1:a===K.a.xJa?c=!0:a===K.a.rZa&&(f=!0);this.TC.paste(Object.assign(new Om.a(!1),{Wb:b,zA:c,G8a:f}),null,!1);return 32}rrj(a,b,c){if(this.fc.yUa())return 16;if(1===c)return 32;a=this.pa.tg();for(const f of a)if(f.Jf||f.Ng){un(f);break}this.fEl(a);return 32}fEl(a){if(!a||
!a.length)this.Qva=this.I7c=null;else if(!this.I7c||!this.Dfi(this.I7c,a)){const b=[];for(const c of a)b.push(c);this.Qva=new Rd.a(0);this.Qva.$(b[0].slideId,1);this.I7c=b}}Dfi(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}Zij(a,b,c,f){let l;l=b?b.$wb(110,75):this.Tb.Ata(c.clientWidth,c.clientHeight);a=this.Sk.gYd(a.Cb.cid,a.Cb.sid,!0,l._x,l._y,c.width,c.height,a.Ut()+1,c.src,c.alt&&c.alt.length?c.alt:"image",f);b&&(a.vca=b.id);return a}Ztj(a,b,c,
f,l){b=this.jq.Ba;if(!b)return xa.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.fc.$c(b)?16:32;if(!l)return 16;this.Cc.KB(5,l.Wb);if(!this.Wj.OF(b,1))return this.Cc.Hg(!1,l.Wb,8),this.Wj.nG(b),16;Tc.a.Cza("PastePicture",!1);f=Xx.y5b(l);if(!f||!f.src)return this.Cc.Hg(!1,l.Wb,10),8;if((c=b.A3(this.pa.Wd()))&&this.fc.$c(c))return this.Cc.Hg(!1,l.Wb,3),16;const x=this.Zij(b,c,f,l.Wb);f=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.Ea.Ed()},()=>{this.pa.selectShape(x,!0)});try{f.nc(b),
f.jd=a,f.Vy[yq.a.J7b]=!0,c&&b.LU([c]),b.dC(x)}finally{f&&f.dispose()}this.Cc.Hg(!0,l.Wb);return 32}T3i(){if(!this.jq.Ba)return null;const a=this.jq.Ba.Ek();for(const b of a)if(b.YIc)return b;return null}guj(a,b,c,f,l){b=this.jq.Ba;if(!b)return xa.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.fc.$c(b)?32:16;if(!l)return 8;this.Cc.KB(6,l.Wb);if(!this.Wj.OF(b,1))return this.Wj.nG(b),this.Cc.Hg(!1,l.Wb,8),16;const x=this.T3i();if(x){if(this.fc.$c(x))return this.Cc.Hg(!1,l.Wb,
3),16;if(x.SI)return xa.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",x.id),this.Cc.Hg(!1,l.Wb,3),32}f=eA.K1f(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName(lf.a.bsd).length))return this.Cc.Hg(!1,l.Wb,24),8;c=document.createElement("div");if(!c)return this.Cc.Hg(!1,l.Wb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.Cc.Hg(!1,l.Wb,24),8;xa.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",
f.rows.length,c.length);var H=this.S2f();f=H.x-55;H=H.y-37.5;if(x){b=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()},()=>{this.pa.selectShape(x,!0)});try{b.nc(x),b.jd=a,b.Vy[yq.a.K7b]=!0,x.Wb=l.Wb,x.uZa=c}finally{b&&b.dispose()}this.fc.fw(x,a)}else c=b.wFi(f,H,b.Ut()+1,c,l.Wb),c.Wb=l.Wb,this.fA.BW([Object(oa.a)(4,c)],Object(oa.a)(116,b),a);this.Cc.Hg(!0,l.Wb);return 32}Ytj(a,b,c,f,l){if(1===c)return 32;b=l?Object(oa.a)(PM.a,l):null;if(!b)return xa.a.J(512356569,826,50,"Html paste context should not be null."),
8;c=this.jq.Ba;if(!c)return xa.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.fc.$c(c))return this.Cc.Hg(!1,b.Wb,3),16;Tc.a.Cza("PasteHtmlAsync",!0);xa.a.J(512356567,826,50,"Paste html start");return this.CPf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.pa.tUa()?2:32;const x=l?Object(oa.a)(PM.a,l):null;if(!x)return xa.a.J(512356566,826,50,"Html paste context should not be null"),8;b=this.jq.Ba;if(!b)return xa.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.fc.$c(b))return this.Cc.Hg(!1,
x.Wb,3),16;xa.a.J(512356564,826,50,"Paste html start");Tc.a.nP(!1,!1);Tc.a.Cza("PasteHtml",!0);Tc.a.zk(ni.a.xDk,"Image:"+x.Bda.length.toString()+",Table:"+x.alb.length.toString()+",Text:"+(x.XY?x.XY.length.toString():"0"));f=this.pa.Wd();a=Cq.a.Hkh(0<x.Bda.length?!0:!1,!1,0<x.alb.length?!0:!1,!1,this.la.zza,a);if(x.brc)return xa.a.J(512356563,826,50,"Will replace text"),this.Cc.KB(1,x.Wb),a=this.fOi(x,f[0],a),16!==a?this.Cc.Hg(!0,x.Wb):this.Cc.Hg(!1,x.Wb,15),a;xa.a.J(512356562,826,50,"Will paste html into new shapes");
if(x.s_c){if(this.la.ilg){const H=Tc.a.Ib;this.zb.Db(new af.a(2,1,0,()=>{Tc.a.AF(H,()=>{this.ia.La(K.a.nhd,c,x)})},90,"66"));return 64}return this.CPf(x,b,a)}return this.dOi(x,b,f,a)}fOi(a,b,c){if(this.fc.$c(b))return 16;if(a.XY&&0<a.XY.length){xa.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.xGa.ITd([b])));if(this.ing(a.XY))return 16;this.fc.fw(b,c);const f=this.Jb.Ad(15);try{b.Wb=a.Wb,f.nc(b),f.jd=c,b.Eoc=a.XY,Object(Xa.a)(1222,f)&&b.id&&(Object(oa.a)(1222,f).Vy[yq.a.S9g]=b.id.toString())}finally{f&&
f.dispose()}}return 32}dOi(a,b,c,f){const l=[],x=b.Ut();var H=this.S2f(),U=H.x,ja=H.y;H=0;for(var ya=0;ya<a.alb.length;++ya)H=this.Sk.hYd(!0,b.cid,b.sid,!1,U,ja,110,75,x+1,a.alb[ya],a.Wb),l.push(H),H=6;U=a.Bda;ja=1===U.length?0:Cq.a.LS;for(ya=0;ya<U.length;ya++){const Va=this.Sk.gYd(b.cid,b.sid,!1,ja,ja,U[ya].width,U[ya].height,x+1,U[ya].src,U[ya].alt,a.Wb);l.push(Va);ja+=Cq.a.LS;H=0===H?5:20}if(a.XY&&0<a.XY.length)if(xa.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.xGa.ITd(c))),
!this.ing(a.XY))c=this.Sk.iYd(b.cid,b.sid,x+1,a.XY,a.Wb),l.push(c),H=0===H?1:20;else if(!l.length)return this.Cc.KB(1,a.Wb),this.Cc.Hg(!1,a.Wb,7),16;this.Cc.KB(H,a.Wb);if(0<l.length){if(!this.Wj.OF(b,l.length))return this.Wj.nG(b),this.Cc.Hg(!1,a.Wb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.XY,this.X9.Lng(c)?(this.Cc.KB(8,a.Wb),xa.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.fA.BW(l,b,f),this.X9.vzl(c,Object(F.a)(this,this.MIl,
"videoInsertionFail"))):(this.fA.BW(l,b,f),this.fc.fw(b,f))):(this.fA.BW(l,b,f),this.fc.fw(b,f));this.Cc.Hg(!0,a.Wb)}else this.Cc.Hg(!1,a.Wb,9);return 32}MIl(){xa.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}CPf(a,b,c){this.Cc.KB(5,a.Wb);if(cb.a.Wa(a.Bda))return this.Cc.Hg(!1,a.Wb,10),16;if(!b)return 16;var f=Object(oa.a)(573,b.sc(this.Fb.Ma));if(!f)return this.Cc.Hg(!1,a.Wb,3),8;var l=Tc.a.Ib;l&&(l.actionName="SinglePicturePaste",l.Ur=!0,l.Nj=
!0,l.Va("PreloadImageDuration",a.ZJe.toString()));l=a.Bda[0];const x=b.A3(this.pa.Wd());var H=b.Ut();let U,ja;({U2d:ja,mD:U}=this.LWa.qWd(x,l.width,l.height));H=this.Sk.gYd(b.cid,b.sid,!1,U.x,U.y,ja.width,ja.height,H+1,l.src,l.alt,a.Wb);Tc.a.zk("ImageSrcSize",l.src.length.toString());f=this.LWa.BSd(this.Fb.Ld,ja,U,f.qT);H.OU=f;x&&(H.vca=x.id);H.isResizable=!0;H.d$b=!0;H.CL=!0;H.VIa=!0;H.gea=l.src;this.fA.BW([H],b,c,null,x);this.Cc.Hg(!0,a.Wb);return 32}ing(a){return 65535<a.length?(xa.a.J(512356556,
826,50,"Exceed text size limit: {0}",a.length),!0):!1}$tj(a,b,c,f,l){b=this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(oa.a)(Om.a,l);if(!c)return 8;f=c.QW;if(cb.a.Wa(f))return this.Cc.Hg(!1,c.Wb,11),8;this.Cc.KB(2,c.Wb);this.Cc.Hw(2,c.Wb);l=this.jq.Ba;if(!l||this.fc.$c(l))return this.Cc.Hg(!1,c.Wb,3),16;Tc.a.Cza("PasteShape",!1);if(!this.Wj.OF(l,f.length))return this.Wj.nG(l),this.Cc.Hg(!1,c.Wb,8),16;xa.a.J(512356555,826,50,"Start Handle paste shapes");
var x=Pr.b(f,ja=>ja.shapeNode);this.yw.Mbe(x,"HandlePasteShapes");for(var H of f){if(!H||!H.shapeNode.isConnected)return xa.a.J(512356554,826,50,"Paste deleted shapes"),this.Lvg.Arc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.Cc.Hg(!1,c.Wb,12),16;if(this.fc.UN(H.shapeNode))return this.Cc.Hg(!1,c.Wb,3),16;if(!H.shapeNode.get_shapeId())return this.Cc.Hg(!1,c.Wb,12),16}H=[];for(x=0;x<f.length;x++)H.push(f[x].shapeNode);
for(var U of H)if(U.Jf||U.Ng){un(U);break}U=Object(oa.a)(116,b.xC(f[0].shapeNode.slideId));this.xGa.D9g(U,l,H,this.Qva,a,c.Wb);xa.a.J(512356553,826,50,({contentType:a}=this.xGa.JTd(H)).returnValue);this.Cc.KB(a,c.Wb);Tc.a.nP(!0,!0);this.Cc.Hg(!0,c.Wb);return 32}Vtj(a,b,c,f,l){(a=Object(oa.a)(Om.a,l))&&this.TC.oDk(a.Wb);return 32}fuj(a,b,c,f,l){if(1===c)return 32;b=Object(oa.a)(Om.a,l);if(!b)return 8;this.Cc.KB(19,b.Wb);this.Cc.Hw(2,b.Wb);if(cb.a.Wa(b.QW))return this.Cc.Hg(!1,b.Wb,11),8;Tc.a.Cza("PasteSlide",
!0);if(c=Array.isArray(b.QW)?b.QW:null){let H=0;c.forEach(U=>{U.Fd&&U.Fd.hasDeferredContent&&H++});0<H&&xa.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,H)}c=[];for(var x of b.QW){f=Object(oa.a)(Mv.a,x);if(!f)return this.Cc.Hg(!1,b.Wb,11),8;f=f.Fd;if(!f||!f.isConnected)return xa.a.J(512356551,826,50,"Paste deleted slide"),this.Lvg.Arc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.r7g&&
(this.Jq.Yq=null),this.Cc.Hg(!1,b.Wb,13),16;if(this.fc.$c(f))return this.Cc.Hg(!1,b.Wb,3),16;Array.add(c,f)}x=Array.clone(this.pa.Qe());x.sort((H,U)=>H.le-U.le);x=x[x.length-1];if(!x)return xa.a.J(512356550,826,50,"Paste slides with no slide selected"),this.Cc.Hg(!1,b.Wb,13),8;Tc.a.zk("SlideCount",c.length.toString());x=this.fA.nTf(c,a,x,b.Wb,!1);c=!0;for(const H of x)if(!H.aO){c=!1;break}c||this.fc.fw(this.Vb.Ef,a);Tc.a.nP(!0,!0);this.Cc.Hg(!0,b.Wb);return 32}JXe(){return this.pa.Bs()||this.pa.gH()}Xhl(){if(this.pa.Bs())return!0;
if(this.pa.gH()){const a=this.pa.Wd();return 1!==a.length||!a[0].isEditable}return!1}Oqj(a,b,c,f,l,x){const H=this.Cc.hP(1,0,"HandleBrowserCut");this.Cc.KB(1,H);this.JXe()?(a=this.pcb(a,this.ia,b,c,f,l,x,this.Cc,H),a.p7a(16)):(Tc.a.nP(!0,!0),this.Cc.Bic(H),a=this.pcb(a,this.ia,D.a.RZb,c,f,l,x,this.Cc,H),a.WWc());return a}Nqj(a,b,c,f,l,x){const H=this.Cc.hP(0,0,"HandleBrowserCopy");this.Cc.KB(1,H);this.JXe()?(a=this.pcb(a,this.ia,b,c,f,l,x,this.Cc,H),2===f&&this.Qla.Bsa(Object.assign(new et(!0),{ohg:!1,
Wb:H})),a.p7a(32)):(this.Cc.Bic(H),a=this.pcb(a,this.ia,D.a.hIc,c,f,l,x,this.Cc,H),a.WWc());return a}Pqj(a,b,c,f,l,x){const H=this.Cc.hP(2,0,"HandleBrowserPaste"),U=this.JXe();a=this.pcb(a,this.ia,U?b:D.a.Z7,c,f,l,x,this.Cc,H);x=Object(oa.a)(10,x);Tc.a.nP(!0,!1);if(this.pa.k9())return a.p7a(16),this.Cc.Hg(!1,H,3),a;x&&x.Sa(Mc.a.FU)?2===f&&this.Mtd(x,H)?a.p7a(32):U?(2===f&&this.TC.paste(Object.assign(new Om.a(!0),{Skg:!1}),x.eb(Mc.a.FU),!1),a.p7a(32)):a.WWc():(xa.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),
a.p7a(16),this.Cc.Hg(!1,H,14));return a}Xtj(a,b,c,f,l,x){Tc.a.Cza("PasteGivenText",!1);this.Xhl()?(a=this.pcb(a,this.ia,b,c,f,l,x,this.Cc,""),a.p7a(16)):(Tc.a.nP(!0,!0),a=this.pcb(a,this.ia,D.a.mhd,c,f,l,x,this.Cc,""),a.WWc());return a}huj(a,b,c,f,l){if(1===c)return 32;if((b=this.pa.Wd())&&0<b.length)return xa.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",this.xGa.ITd(b)),16;xa.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");
if(!(l&&l.un&&l.un.innerHTML&&l.un.innerHTML.length))return xa.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Tc.a.Cza("PasteTextIntoNewShape",!0);b=this.jq.Ba;if(!b)return xa.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.Wj.OF(b,1))return this.Wj.nG(b),16;l=this.Sk.iYd(b.cid,b.sid,b.Ut()+1,l.un.innerHTML,l.Wb);this.fA.BW([l],b,a);return 32}S2f(){const a=this.Tb.Gu();return new hd.a(Math.floor(a.width/2),Math.floor(a.height/
2))}Wtj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(pu.a.LDf).toString());this.Cc.vAb(a)||(a=this.Cc.hP(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(K.a.fja,2);if(32!==b)return this.Cc.Hg(!1,a,15),xa.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new Om.a(!0),{Wb:a});this.QT.KNj(l)?a.un=l:(lf.a.JJc(this.Zg),this.Zg.contentWindow.document.body.appendChild(l));this.TC.paste(a,null,!1);xa.a.J(512356515,826,50,null);return 32}Mtd(a,b){if(a){if(this.la.Fie){const c=
a.sa(Mc.a.HWc,"");if(c.startsWith("data:image/"))return this.Cc.KB(5,b),this.TC.YJe(c,b)}a=a.eb(Mc.a.FU);ha.a.Wa(a)||(a=this.QT.qZa(a),this.Cc.bel(a,b))}return!1}}Object(m.a)(QM,"ClipboardActor",null,[352]);var wp=d(1132);class RM{constructor(a,b){this.ia=a;this.Gq=b;this.wb()}wb(){this.ia.ra(K.a.Zch,de.a.frame,Object(F.a)(this,this.juc,"updateCoauthStatus"),96)}Ee(){}juc(a,b,c,f,l){if(1===c)return 32;a=this.Gq.Olc;ha.a.Wa(a)&&(a="NotConnected");this.Gq.R7a&&(a=String.format("{0} ~:{1}",a,this.Gq.R7a));
l[wp.a.Value]=a;l[im.a.labelText]=a;l[wp.a.Visible]=!0;return 32}}Object(m.a)(RM,"CoauthActor",null,[352]);var qu=d(245),al=d(350);class SM{constructor(a,b,c,f){this.bHa=!1;a("powerpoint-editor-intl").then(()=>{xa.a.J(51519637,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{xa.a.J(51519639,801,50,"Color Picker Manager script is loaded successfully");this.bHa=!0}).catch(l=>{xa.a.J(51519641,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>
{xa.a.J(51519643,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Ea=c;this.Vb=f}wb(){this.ia.ya(K.a.renderColorPicker,rc.a.application,Object(F.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(K.a.QBa,rc.a.application,Object(F.a)(this,this.QBa,"addRecentColor"))}Ee(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.bHa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.k_k(b,c,a);return 32}QBa(a,b,c,f,l){if(a=qu.a.parse(l.Color)){b=
this.Vb.Ef;if(!b)return xa.a.J(595186576,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.we(kb.a.UIi,a.RGBColor);b.we(kb.a.c8,JSON.stringify(al.g(b.c8,a.RGBColor)))}else return xa.a.J(595186574,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}k_k(a,b,c){let f="#000000",l=100;a&&(f=Ib.a.vI(a.sD),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),
this.Ea.$Wc(zb.a.o0b,zb.a.gj,a));const x=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(x)if(x.addEventListener("onColorChange",ja=>{const ya={};ya.Color=ja;ya.sourceControlId="CustomColors";let Va=8;Kg.a("ColorPicker_ColorApplied",b,()=>Va=this.ia.La(b,2,ya));32===Va?xa.a.J(595186570,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):xa.a.J(595186568,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",
b);this.Ea.Cj(zb.a.o0b,!1)}),x.addEventListener("onCancel",()=>{this.Ea.Cj(zb.a.o0b,!1)}),Kg.a("ColorPicker_DialogInvocation",b,()=>{x.render("colorPickerDiv",f,l,c);return 32}),xa.a.J(595186566,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Ea.Cj(zb.a.o0b,!0),a=this.Ea.Fc(zb.a.o0b)){a.bJ=!0;var H=y.KeyInputManager.Oa(A.a.Sq,0),U=y.KeyInputManager.Oa(A.a.Sq,4);a.zp(H);a.zp(U);a.bindAction(H,G.a.Asa);a.bindAction(U,G.a.Asa)}else xa.a.J(595186564,822,10,"RenderColorPickerDialog: colorPickerScope is null");
else xa.a.J(595186572,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(m.a)(SM,"ColorPickerActor",null,[352]);var rR=d(1044);class TM{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb=!1,yb=!1){this.ia=a;this.Kcc=b;this.ZQ=c;this.Vma=l.htc;this.Jla=f;this.ua=x;this.Fa=H;this.pa=U;this.Ea=ja;this.u0=ya;this.u$j=hb;this.Fb=Va;this.Vj=yb}wb(){this.ia.ya(K.a.RKc,rc.a.application,Object(F.a)(this,this.Mwj,"handleThumbnailPanelContextMenu"));this.ia.ya(K.a.SWd,rc.a.application,Object(F.a)(this,
this.swj,"handleSorterViewThumbnailContextMenu"));this.ia.ya(K.a.hIf,rc.a.application,Object(F.a)(this,this.rwj,"handleSorterViewBlankSpaceMenu"));this.ia.ya(K.a.PWd,rc.a.application,Object(F.a)(this,this.Rvj,"handleSectionContextMenu"));this.ia.ya(K.a.RWd,Cb.a.view,Object(F.a)(this,this.mwj,"handleSlidePanelContextMenu"));this.ia.ya(K.a.QWd,Cb.a.view,Object(F.a)(this,this.Dtj,"handleMultiSelectShapeContextMenu"));this.ia.ya(K.a.kIf,rc.a.application,Object(F.a)(this,this.cxj,"handleVersionHistoryThumbnailContextMenu"));
this.ia.je(K.a.RKc,2048)}Ee(){this.u$j&&B.a.Tj&&(this.Ea.Fc(S.AppFrame.zW).bindAction(y.KeyInputManager.Oa(A.a.tMa,0),D.a.Iaa),this.Ea.Fc(S.AppFrame.sPe).bindAction(y.KeyInputManager.Oa(A.a.tMa,0),D.a.Iaa))}Mwj(a,b,c,f,l){if(1===c)return 32;if(this.ia.aX)return this.u0.show(1,-1),32;this.Kcc.$8a();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,oe.a.YBa))return 16;if(this.ZQ.y_||!l.Ec)return 32;2===l.Xf||3===l.Xf?(a=l.clientPoint.y-mf.a.lej(this.Vma.EU)+this.Vma.EU.scrollTop,a=this.Vma.G2d(a),b=
new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):(a=0>this.Vma.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.Vma.EU),b=new Sys.UI.Point(b.x+Mf.a.csa,b.y+Mf.a.csa));this.Jla.value.h6(Mf.a.Dsa,b,l.Xf,a);return 32}cxj(a,b,c,f,l){if(1===c)return 32;if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,oe.a.YBa))return 16;if(!l.Ec)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.Jla.value.h6(Mf.a.Dsa,a,l.Xf,21);return 32}rwj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,
l.clientPoint.y);b=20;this.Vj&&0===this.Fb.Fl&&(b=2);this.Jla.value.h6(Mf.a.Dsa,a,l.Xf,b);return 32}swj(a,b,c,f,l){if(1===c)return 32;if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,oe.a.YBa))return 16;if(this.ZQ.y_||!l.Ec)return 32;if(2===l.Xf||3===l.Xf||1===l.Xf)b=19,this.Vj&&0===this.Fb.Fl&&(b=1),a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.Jla.value.h6(Mf.a.Dsa,a,l.Xf,b);return 32}Rvj(a,b,c,f,l){if(1===c)return 32;u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
(a=l.contextMenuArgs,b=new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.Jla.value.h6(Mf.a.Dsa,b,a.Xf,17):this.Jla.value.h6(Mf.a.Dsa,b,a.Xf,18));return 32}mwj(a,b,c,f,l){if(1===c)return 32;this.Kcc.$8a();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,oe.a.YBa))return 16;if(this.ZQ.y_||!l.Ec)return 32;if(2===l.Xf||3===l.Xf)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=Kj.b(b);a=Kj.e(this.ua.Ba,a.Ma);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.JB);a=new Sys.UI.Point(a.x+
Mf.a.csa,a.y+Mf.a.csa)}this.Jla.value.h6(Mf.a.Dsa,a,l.Xf,4);return 32}Dtj(a,b,c,f,l){if(1===c||l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,Mf.a.rdi))return 32;this.Kcc.$8a();if(l.Ec&&Sys.UI.DomElement.containsCssClass(l.Ec,oe.a.YBa))return 16;if(this.ZQ.y_||!l.Ec)return 32;b=Kj.b(b);var x;if(!(b&&b.Lb&&(x=this.pa.tg())&&x.length))return 16;a=this.Ndj(x);if(2===l.Xf||3===l.Xf)x=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{x=Kj.c(x[0],b.Ma);if(!x||!x.xa)return 16;x=Od.a.$h(x.xa.xa);b=Od.a.$h(b.container);
c=x.x+Mf.a.csa<b.x?b.x:x.x+Mf.a.csa;x=x.y+Mf.a.csa<b.y?b.y:x.y+Mf.a.csa;c=c>b.x+b.width?b.x+b.width:c;x=x>b.y+b.height?b.y+b.height:x;x=new Sys.UI.Point(c,x)}1===l.Xf||4===a?this.Jla.value.h6(Mf.a.Dsa,x,l.Xf,a):this.Jla.value.vkl(Mf.a.Dsa,x,l.Xf,a);return 32}Ndj(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Fa.yr(b));return 1<a.length?this.Fa.$Gc(a)?11:10:b.az||!b.Fua||b.Jf?5:b.get_isSVGBlipFilled()?13:b.Fj||1===b.mediaType?7:b.Rf?8:b.px?6:b.Dq?22:b.hr?9:b.ud?14:b.Mp?15:b.U3?16:0}}Object(m.a)(TM,
"ContextMenuActor",null,[352]);class UM{constructor(a,b,c,f,l,x,H){this.ia=a;this.pa=b;this.Fa=c;this.Wbb=f;this.T$j=l;this.jwe=x;this.cU=H}wb(){this.ia.ra(K.a.z$g,rc.a.application,Object(F.a)(this,this.GEk,"pictureToolsTabViewHandler"),4);this.ia.ra(K.a.lQf,rc.a.application,Object(F.a)(this,this.fPi,"drawingToolsTabViewHandler"),4);this.ia.ra(K.a.Gyf,rc.a.application,Object(F.a)(this,this.Ngi,"audioPlaybackToolsTabViewHandler"),4);this.ia.ra(K.a.Eyf,rc.a.application,Object(F.a)(this,this.Lgi,"audioFormatToolsTabViewHandler"),
4);this.ia.ra(K.a.Hyf,rc.a.application,Object(F.a)(this,this.Ogi,"audioSettingsTabViewHandler"),4);this.ia.ra(K.a.ddh,rc.a.application,Object(F.a)(this,this.Mpj,"graphicsTabViewHandler"),100);this.ia.ra(K.a.XNe,rc.a.application,Object(F.a)(this,this.Btl,"tableTabViewHandler"),100);this.ia.ra(K.a.sdh,rc.a.application,Object(F.a)(this,this.Kgi,"audioContextualGroupHandler"),100);this.ia.ra(K.a.NNd,rc.a.application,Object(F.a)(this,this.N3h,"accessibleAuthoringViewHandler"),4)}Ee(){}GEk(){return this.QNj()?
32:this.Xkg(this.pa.tg())?32:8}fPi(){const a=this.pa.tg();return a&&a.length?1===a.length?this.Pig(a)?32:16:this.Zci(a)||this.qJj(a)&&this.Pig(a)?32:this.trb(a)||this.NPj(a)?16:32:16}Ngi(){return this.jwe?this.xZc()?32:this.trb(this.pa.tg())?32:8:2}Lgi(){return this.cU?this.xZc()?32:this.trb(this.pa.tg())?32:8:2}Ogi(){return this.cU&&this.jwe?this.xZc()?32:this.trb(this.pa.tg())?32:8:2}Mpj(){return this.T$j?this.RNj()?32:this.Fa.nsc(this.pa.tg())?32:16:2}Btl(){const a=this.pa.Wd();return a&&1===a.length&&
a[0].ud?32:8}Kgi(){return this.cU||this.jwe?this.xZc()?32:this.trb(this.pa.tg())?32:8:2}N3h(){return this.Wbb&&this.Wbb.isVisible?32:2}NPj(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Mp||1===c.mediaType)return!0;c.Fj||(b=!1)}return b}Zci(a){if(!a)return!1;for(const b of a)if(!b.Mp)return!1;return!0}Xkg(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.Fj&&!c.get_isSVGBlipFilled())b=!0;else if(c.Mp)return!1;return b}trb(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1!==b.mediaType)return!1;
return!0}qJj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}Pig(a){if(!a)return!1;for(const b of a)if(b&&(b.qua||b.U3))return!0;return!1}QNj(){return this.Tje(this.pa.tg())&&this.Xkg(this.pa.aP(this.pa.Wd()))}RNj(){return this.Tje(this.pa.tg())&&this.uTj(this.pa.aP(this.pa.Wd()))}xZc(){return this.Tje(this.pa.tg())&&this.trb(this.pa.aP(this.pa.Wd()))}uTj(a){if(!a)return!1;for(const b of a)if(b&&b.Ng&&b.get_isSVGBlipFilled())return!0;return!1}Tje(a){if(!a)return!1;
for(const b of a)if(b&&b.Jf)return!0;return!1}}Object(m.a)(UM,"ContextualTabsActor",null,[352]);class VM{constructor(a,b,c,f){this.NAe=null;this.ia=a;this.ua=b;this.Jb=c;this.exg=f;this.exg.jk(Object(F.a)(this,this.y5g,"onRichApiResponseReceived"))}wb(){this.ia.ra(K.a.Z1d,Cb.a.application,Object(F.a)(this,this.dsj,"handleExecuteAddinBatchOperation"),4)}Ee(){}dispose(){this.exg.Cm(Object(F.a)(this,this.y5g,"onRichApiResponseReceived"))}y5g(a,b){this.NAe&&(a=Object(oa.a)(1221,b.node))&&a.ASe&&this.NAe(a.ASe)}dsj(a,
b,c,f,l){b=this.ua.presentation;if(1===c)return b?32:8;if(!b)return xa.a.J(509364444,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return xa.a.J(509364443,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.NAe=l.promiseToResolve;c=this.Jb.Ad(15,void 0,void 0,void 0,!0);try{c.nc(b),c.jd=a,b.IOd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(m.a)(VM,"ExtensibilityActor",null,[352]);var Zx;(function(a){a[a.height=0]="height";a[a.width=
1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(Zx||(Zx={}));Object(m.b)("FormatPaneProperty",Zx);class fA{constructor(a,b){this.B1=a;this.T$=b}}Object(m.a)(fA,"MarginShapeData",null,[]);class KE{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=this.width=this.height=
this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(m.a)(KE,"FormatShapeTaskPaneProps",null,[]);class WM{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc){this.EIa=this.IXa=this.LX=this.kwa=null;this.RFg=0;this.Eb=!1;this.dIa=null;this.TGa=this.Bva=!1;this.L$j=!0;this.ob=b;this.Rb=c;this.ia=f;this.Ea=l;this.Pg=H;this.qd=U;this.Lc=ja;this.Fb=ya;this.cGa=Va;this.Vb=
hb;this.Pg.rI(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.Pg.SBa(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.Lc.HPa(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.qd.VBa(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.Rb.PK(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"));this.gBg=Zb;this.H4c=fc;this.Fa=yb;this.o0=Kc;this.jn=Lc;Ud.a("FixHeightAndWidthButtonValues")&&this.jn&&this.jn.hPd(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"))}dispose(){this.Pg.U5(Object(F.a)(this,
this.dxa,"onChangeRenderFormatShapePane"));this.Pg.j_a(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.Lc.Eib(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.qd.Gib(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"));this.Rb.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"));Ud.a("FixHeightAndWidthButtonValues")&&this.jn.nld(Object(F.a)(this,this.dxa,"onChangeRenderFormatShapePane"))}wb(){this.ia.ra(K.a.orc,rc.a.application,Object(F.a)(this,this.orc,"showHideFormatShapePane"),
4);this.ia.ra(K.a.eod,rc.a.application,Object(F.a)(this,this.eod,"setAbsoluteHeight"),4);this.ia.ra(K.a.UZe,rc.a.application,Object(F.a)(this,this.UZe,"spinAbsoluteHeight"),4);this.ia.ra(K.a.Shb,rc.a.application,Object(F.a)(this,this.Shb,"queryAbsoluteHeight"),100);this.ia.ra(K.a.fod,rc.a.application,Object(F.a)(this,this.fod,"setAbsoluteWidth"),4);this.ia.ra(K.a.VZe,rc.a.application,Object(F.a)(this,this.VZe,"spinAbsoluteWidth"),4);this.ia.ra(K.a.Thb,rc.a.application,Object(F.a)(this,this.Thb,"queryAbsoluteWidth"),
100);this.ia.ra(K.a.aJb,rc.a.application,Object(F.a)(this,this.aJb,"queryFormatShapePane"),96)}Ee(){}dxa(){this.Eb&&this.Ql(!0)}Su(a){1===a.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Ea.Cj(zb.a.FW,this.Eb))}xNj(a){return this.Vb.isEditingAllowed&&this.L$j&&!this.MXe(a)}aJb(a,b,c,f,l){(a=Object(oa.a)(Uh.a,l))&&a.Mf(this.Eb);return 32}orc(a,b,c){b=this.ob.tg();return 1===c?b.length&&this.xNj(b)?32:8:Kg.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",this.Eb.toString(),a,()=>{(this.Eb=!this.Eb)?
this.Ql():this.Cr();return 32})}eod(a,b,c,f,l){b=this.ob.tg();return 1===c?this.Ath(b)?8:32:Kg.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return xa.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const x=l.Number;void 0===x||null===x||isNaN(x)||this.kxa(x,0);return 32})}UZe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.kxa(0,0),this.n6a());return 32}Shb(a,b,c,f,l){if(!l)return xa.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),
8;if(a=l.queryResult)b=this.vC(),a.Kaa=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.Kaa="");return 32}fod(a,b,c,f,l){b=this.ob.tg();return 1===c?this.Ath(b)?8:32:Kg.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return xa.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const x=l.Number;void 0===x||null===x||isNaN(x)||this.kxa(x,1);return 32})}VZe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.kxa(0,1),this.n6a());return 32}Thb(a,b,c,
f,l){if(!l)return xa.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.vC(),a.Kaa=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.Kaa="");return 32}Ql(a=!1){const b=this.vC(),c=Object.assign(new mu.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0});mj.UISurfaces.zr().then(f=>{a?f.updateTaskPane(zb.a.FW,c):f.showTaskPane(zb.a.FW,
c);return null})}Cr(){mj.UISurfaces.zr().then(a=>{a.hideTaskPane(zb.a.FW,2);return null})}vC(){const a=this.ob.tg();var b=[];for(var c of a)c.Jf?b=Array.isArray(b.concat.apply(b,this.Fa.ex(c)))?b.concat.apply(b,this.Fa.ex(c)):null:b.push(c);if(!(c=this.$k(a[0]))||this.MXe(a))return this.TGa=!0,this.Vph(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.vd;c=this.x7d(f);c=this.VKc(c,1,l);f=this.uae(f);f=this.VKc(f,0,l);this.TGa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());l=0>l&&Ud.a("fixBugOfNegativeAngle")?
l+360:l;b=this.$k(b[0]);let x=0,H=0,U=0,ja=0;b&&(x=b.dUa[0],H=b.dUa[1],U=b.dUa[2],ja=b.dUa[3]);c=this.Vph(c,f,l,x,H,U,ja,this.m8i(a),0);this.ZEl(a,c);return c}m8i(a){let b=[];for(var c of a)c.Jf?b=Array.isArray(b.concat.apply(b,this.Fa.ex(c)))?b.concat.apply(b,this.Fa.ex(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.Ssb(a[f])||(c|=4),this.o0&&!this.v_b(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].tAb){c|=120;break}return c}Ssb(a){return!!a&&a.CL&&!a.SI}v_b(a){return!!a&&a.isResizable&&
!a.SI}Ath(a){if(0>=a.length)return!0;let b=!1;if(this.o0){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.v_b(a[c])){b=!1;break}}return b||this.MXe(a)}MXe(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].ud){b=!0;break}return b}ZEl(a,b){if(this.H4c){var c=[];for(var f of a)f.Jf?c=Array.isArray(c.concat.apply(c,this.Fa.ex(f)))?c.concat.apply(c,this.Fa.ex(f)):null:c.push(f);var l=f=!0,x=!0,H=!0;if(2<=c.length)for(var U=1;U<c.length;U++){var ja=c[U];if(!ja)continue;if(!this.getBounds(ja))continue;
ja=this.$k(ja);let ya=0,Va=0,hb=0,yb=0;ja&&(ya=ja.dUa[0],Va=ja.dUa[1],hb=ja.dUa[2],yb=ja.dUa[3]);f&&b.leftMargin!==ya&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Va&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);x&&b.topMargin!==hb&&(b.topMargin=0,b.emptyValueFields|=32,x=!1);H&&b.bottomMargin!==yb&&(b.bottomMargin=0,b.emptyValueFields|=64,H=!1);if(!(f||l||x||H))break}}if(!(2>a.length))for(l=f=c=!0,x=1;x<a.length;x++)if(H=a[x])if(U=this.getBounds(H))if(ja=this.$k(H).vd,H=this.x7d(U),
H=this.VKc(H,1,ja),U=this.uae(U),U=this.VKc(U,0,ja),ja=a[x].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(H.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(U.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==ja&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}qal(a,b,c,f,l,x,H,U,ja){const ya=new KE,Va=Object(oa.a)(Object,Pg.e().numberFormatInfo);ya.numberFormatInfo=Va;ya.height=a;ya.width=b;ya.rotation=c;ya.leftMargin=
f;ya.rightMargin=l;ya.topMargin=x;ya.bottomMargin=H;ya.disabled=U;ya.onChange=Object(F.a)(this,this.kxa,"onPropertyChange");ya.emptyValueFields=ja;ya.isAspectRatioLocked=this.Bva;ya.isAspectRatioDisabled=this.TGa;ya.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");ya.isAspectRatioFeatureEnabled=this.gBg;ya.isMarginFieldEnabled=this.H4c;return ya}ral(a,b,c,f,l){const x=new KE,H=Object(oa.a)(Object,Pg.e().numberFormatInfo);x.numberFormatInfo=H;x.height=a;x.width=
b;x.rotation=c;x.disabled=f;x.onChange=Object(F.a)(this,this.kxa,"onPropertyChange");x.emptyValueFields=l;x.isAspectRatioLocked=this.Bva;x.isAspectRatioDisabled=this.TGa;x.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");x.isAspectRatioFeatureEnabled=this.gBg;return x}Vph(a,b,c,f,l,x,H,U,ja){return this.H4c?this.qal(a,b,c,f,l,x,H,U,ja):this.ral(a,b,c,U,ja)}kxa(a,b){const c=this.ob.tg();this.RFg!==b&&(this.n6a(),this.RFg=b);switch(b){case 0:case 1:this.resize(a,
c,b);break;case 3:case 4:case 5:case 6:this.sqi(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.Bva=a}iCf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}sqi(a,b,c){let f=[];for(const x of b)x.Jf?f=Array.isArray(f.concat.apply(f,this.Fa.ex(x)))?f.concat.apply(f,this.Fa.ex(x)):null:f.push(x);this.dIa=b=f;let l=!0;this.LX||(this.LX=[],l=!1);Kg.b("FormatShapePaneActor::ChangeMargin Property:",Zx[c]+"; AspectRatioLocked: "+(!this.TGa&&this.Bva),K.a.tqc,()=>{for(let x=0;x<b.length;x++){const H=
b[x],U=this.$k(H);if(!U)continue;l||this.LX.push(new fA(H,new Oi.a));this.LX.length===x&&this.LX.push(new fA(H,new Oi.a));this.LX[x]||(this.LX[x]=new fA(H,new Oi.a));const ja=this.LX[x];ja.T$.left=H.Oia;ja.T$.right=H.Pia;ja.T$.top=H.Qia;ja.T$.bottom=H.Nia;3===c&&(this.LX[x].T$.left=a);4===c&&(this.LX[x].T$.right=a);5===c&&(this.LX[x].T$.top=a);6===c&&(this.LX[x].T$.bottom=a);U.Gza(this.LX[x].T$)}return 32});this.uuc()}resize(a,b,c){this.dIa=b;let f=!0;const l=[],x=[];this.kwa||(this.kwa=[],f=!1);
0===a&&(this.TGa=!0);Kg.b("FormatShapePaneActor::Resize Property:",Zx[c]+"; AspectRatioLocked: "+(!this.TGa&&this.Bva),K.a.Sib,()=>{for(let ya=0;ya<b.length;ya++){var H=b[ya];const Va=this.$k(H);if(this.o0){if(!Va||!this.v_b(H))continue}else if(!Va)continue;var U=this.getBounds(H),ja=this.x7d(U);U=this.uae(U);f||(Array.add(this.kwa,new Gz(H,new Oi.a)),Va.BL=!0,Va.SD(!1));Array.add(l,Va.SYa);Array.add(x,new Oi.a);Va.shapeNode.Jf&&Va.shapeNode.isEditable&&Va.Ok&&(Va.Ok.visible=!0);H=Va.vd;if(0===c){H=
this.zIf(a,1,H);H=Math.round(H-ja);x[ya].bottom=H;let hb;(hb=this.kwa[ya].l1).bottom=hb.bottom+H;if(!this.TGa&&this.Bva){ja=this.iCf(U,ja,0,H);x[ya].right=ja;let yb;(yb=this.kwa[ya].l1).right=yb.right+ja}}else{H=this.zIf(a,0,H);H=Math.round(H-U);x[ya].right=H;let hb;(hb=this.kwa[ya].l1).right=hb.right+H;if(!this.TGa&&this.Bva){ja=this.iCf(U,ja,H,0);x[ya].bottom=ja;let yb;(yb=this.kwa[ya].l1).bottom=yb.bottom+ja}}Va.setOffsets(Oi.a.add(l[ya],x[ya]),!0);Va.shapeNode.Jf&&Va.shapeNode.isEditable&&(Va.rce(),
Va.kWc())}return 32});this.uuc()}rotate(a,b){this.dIa=b;let c=!0;a=Math.round(a);this.IXa||(this.IXa=[],c=!1);Kg.a("FormatShapePaneActor::Rotate",K.a.fpc,()=>{for(let f=0;f<b.length;f++){const l=b[f],x=this.$k(l);if(!x)continue;const H=x.lwb().Wf(),U=a%Yo.Lkc;c||(x.SD(!1),Array.add(this.IXa,new Yo(l,U)));this.IXa[f].OZd=U;x.setRotation(U,H)}return 32});this.uuc()}$k(a){return a?Object(oa.a)(Hz.a,a.mg(this.Fb.Ma)):(xa.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.$k(a);if(!b)return xa.a.J(512500575,
822,10,"shapeViewElement == null"),null;b=b.b5b();a.L_&&(b=this.I5d(b));return b}zIf(a,b,c){return this.cGa.GM(this.Fb.Ld.w_(a,b),c)}VKc(a,b,c){a=this.Fb.Ld.rf(this.cGa.DM(a,c),b);return ye.a.Ov(a)}x7d(a){a=hd.a.nm(a.rk(te.a.Qu),a.rk(te.a.PH));return 1>=a?0:a}uae(a){a=hd.a.nm(a.rk(te.a.Qu),a.rk(te.a.DE));return 1>=a?0:a}n6a(){this.H4c&&this.LX&&(this.ia.La(K.a.tqc,2,this.LX),this.LX=null);if(this.kwa){for(var a=0;a<this.dIa.length;a++){var b=this.$k(this.dIa[a]);b&&!b.Al&&(b.shapeNode.Jf&&b.shapeNode.isEditable||
(b.BL=!1),b.Uz(!1))}this.ia.La(K.a.Sib,2,this.kwa);this.kwa=null}if(this.IXa){a=[];for(b=0;b<this.dIa.length;b++){let c=this.$k(this.dIa[b]);c&&!c.Al&&(c.Uz(!1),Ud.a("FixUndoRotateMultipleShapes")?a.push(this.dIa[b]):this.ia.La(K.a.fpc,2,this.IXa[b]))}Ud.a("FixUndoRotateMultipleShapes")&&(b={},b.selectedNodes=a,b.rotateData=this.IXa,this.ia.La(K.a.amh,2,b));this.IXa=null}this.EIa=this.dIa=null}uuc(){this.EIa&&Tc.a.otb(this.EIa);this.EIa=Tc.a.Faa(Object(F.a)(this,this.n6a,"applyPendingChangesToServerIfRequired"),
1E3)}I5d(a){const b=hd.a.S9a(a.ga(0),a.ga(3));a=hd.a.S9a(a.ga(1),a.ga(2));return new ei.a(new hd.a(b.x,b.y),new hd.a(a.x,b.y),new hd.a(a.x,a.y),new hd.a(b.x,a.y))}}Object(m.a)(WM,"FormatShapePaneActor",null,[106,352]);class gA{constructor(a,b,c,f,l,x,H){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=
null;this.disabled=!1;this.emptyValueFields=0;const U=Object(oa.a)(Object,Pg.e().numberFormatInfo);if(!U)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=U;this.cellHeight=b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=x;this.emptyValueFields=H}}Object(m.a)(gA,"FormatTableTaskPaneProps",null,[]);class XM{constructor(){this.bottomMargin=this.topMargin=
this.rightMargin=this.leftMargin=0;this.tbh=this.wbh=this.vbh=this.ubh=-1}}Object(m.a)(XM,"Margins",null,[]);class YM{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc){this.Bva=this.Eb=!1;this.Fmi=320;this.LXa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!x)throw Error.argumentNull("graphOperationEventHandler");
if(!H)throw Error.argumentNull("viewElementEventHandlers");if(!U)throw Error.argumentNull("viewEventSource");if(!ja)throw Error.argumentNull("pageView");if(!ya)throw Error.argumentNull("unitConversion");if(!Va)throw Error.argumentNull("workspace");if(!yb)throw Error.argumentNull("tableReader");if(!Zb)throw Error.argumentNull("rowReader");if(!fc)throw Error.argumentNull("columnReader");if(!hb)throw Error.argumentNull("dynamicScriptLoader");hb.loadScript("powerpoint-editor-intl").then(()=>{this.LXa=
!0}).catch(Kc=>{xa.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+Kc.toString())});this.ob=a;this.Rb=b;this.ia=c;this.Ea=f;this.Pg=x;this.qd=H;this.Lc=U;this.Pg.rI(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.Pg.SBa(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.Lc.HPa(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.qd.VBa(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.Rb.PK(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"));
this.yJ=fc;this.iYa=Zb;this.yc=yb}dispose(){this.Pg.U5(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.Pg.j_a(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.Lc.Eib(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.qd.Gib(Object(F.a)(this,this.XYa,"onChangeRenderFormatTablePane"));this.Rb.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"))}wb(){this.ia.ra(K.a.qrc,rc.a.application,Object(F.a)(this,this.qrc,"showHideReactFormatTablePane"),4);this.ia.ra(K.a.tJb,
rc.a.application,Object(F.a)(this,this.tJb,"queryReactFormatTablePane"),96)}Ee(){}XYa(){this.Eb&&this.Ql(!0)}Su(a){1===a.mode&&this.Eb&&(this.Eb=!1,this.Cr(),this.Ea.Cj(zb.a.hza,this.Eb))}tJb(a,b,c,f,l){(a=Object(oa.a)(Uh.a,l))&&a.Mf(this.Eb);return 32}qrc(a,b,c){if(!this.LXa)return 8;b=this.ob.tg();if(1===c)return b.length?32:8;this.Eb=!this.Eb;return Kg.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Eb.toString(),a,()=>{this.Eb?this.Ql():this.Cr();return 32})}Ql(a=!1){const b=
this.vC(),c=Object.assign(new mu.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.Fmi,location:2,contentProps:b,onOpen:()=>{xa.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},onClose:()=>{this.Eb=!1;xa.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});mj.UISurfaces.zr().then(f=>{a?f.updateTaskPane(zb.a.hza,c):f.showTaskPane(zb.a.hza,c);return null}).catch(f=>{xa.a.J(512500571,
822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}Cr(){mj.UISurfaces.zr().then(a=>{a.hideTaskPane(zb.a.hza,2);return null}).catch(a=>{xa.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+a.toString())})}vC(){var a=this.ob.Zm();const b=new XM;if(!a)return a=new gA(b,0,0,0,0,!0,255),this.tVe(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.fgj(a,c,f));const l=ye.a.Ov(this.yc.M$d(a)),x=ye.a.Ov(this.yc.O$d(a));
let H=this.ob.xv();H&&H.length||(H=this.yc.HF(a));if(!H||!H.length)return a=new gA(b,c,f,l,x,!0,255),this.tVe(a);this.egj(H,b);a=new gA(b,c,f,l,x,!1,0);this.tVe(a);this.YEl(a);return a}tVe(a){a.onChange=Object(F.a)(this,this.kxa,"onPropertyChange");a.isAspectRatioLocked=this.Bva;a.onToggleAspectRatio=Object(F.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}fgj(a,b,c){let f=this.ob.bUc(),l=this.ob.txb();f&&f.length||(f=this.yc.oka(a));l&&l.length||(l=this.Axb(a));f.length&&(b=ye.a.Ov(this.iYa.b0f(f)));
l.length&&(c=ye.a.Ov(this.yJ.d0f(a,l)));return{cellHeight:b,cellWidth:c}}egj(a,b){let c=!0,f=!0,l=!0,x=!0;for(const H of a)H&&!H.isGhostCell&&({wYc:c,cellMargin:b.leftMargin,Gid:b.ubh}=this.nud(c,b.leftMargin,H.marginLeft,b.ubh),{wYc:f,cellMargin:b.rightMargin,Gid:b.vbh}=this.nud(f,b.rightMargin,H.marginRight,b.vbh),{wYc:l,cellMargin:b.topMargin,Gid:b.wbh}=this.nud(l,b.topMargin,H.marginTop,b.wbh),{wYc:x,cellMargin:b.bottomMargin,Gid:b.tbh}=this.nud(x,b.bottomMargin,H.marginBottom,b.tbh))}nud(a,b,
c,f){a&&(b=ye.a.Ov(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{wYc:a,cellMargin:b,Gid:f}}YEl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}kxa(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.La(K.a.n0a,2,c);break;case 1:this.ia.La(K.a.cLa,2,c);break;case 2:this.ia.La(K.a.Hoa,2,c);break;case 3:this.ia.La(K.a.dLa,
2,c);break;case 4:this.ia.La(K.a.usc,2,c);break;case 5:this.ia.La(K.a.ysc,2,c);break;case 6:this.ia.La(K.a.zsc,2,c);break;case 7:this.ia.La(K.a.tsc,2,c)}}onToggleAspectRatio(a){this.Bva=a;this.ia.La(K.a.$pc,2,null)}Axb(a){let b=null;a&&14===a.type&&(b=this.yc.K$d(a.firstRow));return b}}Object(m.a)(YM,"FormatTablePaneActor",null,[106,352]);class hA{constructor(a,b,c){this.pa=a;this.Fb=b;this.Fa=c}process(a,b,c,f){2===c&&32===f&&b.contextId===Cb.a.view&&Array.contains(hA.H4k,a)&&(a=this.pa.Wd(),0<a.length&&
0<this.Fa.textLength(a[0])&&this.Sqi(a[0]))}Sqi(a){if(!a.X$){var b=Qd.SelectionFactory.wl(a);b=nb.SelectionEditor.g4b(b);var c=nb.SelectionEditor.f4b(b,!1);b=Qd.SelectionFactory.DN(b,c.Ua,!1);if((c=this.pa.Na)&&c.mb&&c.mb.contains(b)&&2===a.Cz){var f=Object(oa.a)(117,a.sc(this.Fb.Ma));if(f){b=a.Cz;c=a.C1;var l=a.D1;a.Cz=1;a.C1=1;a.D1=0;f=f.WRf();f.szf();f.vyf();f.Kza();f.kUf()&&(a.Cz=b,a.C1=c,a.D1=l);f.detach();f.V3e()}}}}}hA.H4k=[D.a.Pq,D.a.bH,D.a.NH];Object(m.a)(hA,"FormattingViewOperationFinishedStageProcessor",
null,[1167]);var sR=d(620);class ZM extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(m.a)(ZM,"SectionNodeChangedArgs",Sys.EventArgs,[]);class $M{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.XQ=null;this.ut=a;this.Jb=b;this.Vb=c;this.pa=f;this.Ea=l;this.la=U;this.kn=this.la.FC;this.Ge=H;this.Mea=this.la.ble;this.Tb=x;this.y7c=this.la.pac;this.fc=ja;this.Lu=ya;this.ua=Va;this.Fb=hb;yb.execute(Zb=>{this.XQ=Zb})}JTi(a,b,c){if(a&&a.length){for(var f of a)if(!f||M.a.ix(f.Cb))return;
f=this.la.Jn?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;var l=this.Jb.Ad(15,void 0,()=>{this.Ea.tf(Qi.a.PD);this.pa.Qh()});try{l.nc(this.ut),this.Mea?this.ut.SEe(a,b,c,f):this.ut.REe(a[0],b,c,f)}finally{l&&l.dispose()}}}rTf(a,b){var c=this.Tb.Ym;if(c&&c.Tp)if(b&&!a||!b&&a===c.Tp.length-1)xa.a.J(509364431,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=Ud.a("FixSectionMoveBug")?c.D6k:c.Tp;var l=Date.now(),
x=this.Jb.Ad(15,void 0,()=>{},()=>{});try{x.nc(this.ut);const H=f[a],U=b?f[a-1]:f[a+1];c.setValue(kb.a.ank,H);c.setValue(kb.a.Gmk,U);if(H&&U){let ja=-1,ya=-1;for(let Va=0;Va<f.length&&!(H===f[Va]&&(ja=Va),U===f[Va]&&(ya=Va),0<=ja&&0<=ya);Va++);Array.removeAt(f,ja);Array.insert(f,ya,H);c.anchor?c.anchor.Skb(f,34,!1):xa.a.J(509364430,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{x&&x.dispose()}this.ua.Tz=b?0<=a-1?a-1:0:a+1;c=Date.now();xa.a.J(509364429,
822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.Lu?this.Lu.fPe():xa.a.J(509364428,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else xa.a.J(509364432,808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}rTi(a,b){if(a){var c=this.Tb.Ym;if(c){var f=c.Tp;f&&f.length||xa.a.J(509364425,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");
c=Date.now();var l=this.Jb.Ad(15,void 0,()=>{},()=>{});try{l.nc(this.ut);l.jd=b;const x=f&&f.length?this.Ge.MW(a.Cb):0;this.ut.d6a(a,x)}finally{l&&l.dispose()}this.fc.fw(this.ut,b);b=Date.now();xa.a.J(509364424,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",a.slideIndex,c,b,b-c);this.Lu?this.Lu.fPe():xa.a.J(509364423,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else xa.a.J(509364426,
808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else xa.a.J(509364427,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}VTi(a){var b=this.Tb.Ym;if(b&&b.Tp){var c=b.Tp;if(!a||a.sectionIndex>=c.length)xa.a.J(509364421,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=b.c6f(a.sectionIndex);c=null;f&&(c=Object(oa.a)(sR.a,b.Yhj(f.LE)));b=Date.now();f=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{});try{f.nc(c),c.title=a.CGl}finally{f&&
f.dispose()}c=Date.now();xa.a.J(509364420,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",a.sectionIndex,b,c,c-b)}}else xa.a.J(509364422,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}OTi(a,b){const c=this.Tb.Ym;if(c&&c.Tp){var f=c.Tp,l=this.ua.ica,x=Date.now(),H=f.length,U=this.Jb.Ad(15,void 0,()=>{},()=>{});try{U.nc(this.ut);U.jd=b;if(a){const ja=this.Tb.rxb(a-1);
let ya=l.BA;if(ja&&ya){const Va=ja.BA?ja.BA:[];for(let hb=0;hb<ya.length;hb++)Array.insert(Va,Va.length,ya[hb]);ya=[];ja.BA=Va}}Array.removeAt(f,a);c.qNf(l)}finally{U&&U.dispose()}this.ua.Tz=0<=a-1?a-1:0;this.fc.fw(this.ut,b);b=Date.now();xa.a.J(509364418,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",a,x,b,b-x,H,f.length);this.Lu?this.Lu.XOk(new ZM(l)):
xa.a.J(509364417,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else xa.a.J(509364419,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}aPc(a,b,c,f){if(!b||!this.y7c&&!c)return null;let l=null;const x=this.Jb.Ad(15,void 0,()=>{Ud.a("FixDocumentFocusIssue")||this.Ea.Ed();this.pa.Qh()},()=>{1!==this.Fb.Fl&&(Ud.a("FixDocumentFocusIssue")?this.Ea.tf(this.Ea.Ae.name):this.Ea.tf(Qi.a.PD))});try{let H;H=this.la.Jn?
!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;let U;U=Ud.a("SlideSorterInsertionAfterFirstSlide")?!!this.Fb&&1===this.Fb.Fl&&-1===this.Vb.Cxa:!!this.Fb&&1===this.Fb.Fl&&!this.Vb.Cxa;const ja=this.ua.ica;if(H&&ja&&(!ja.bK||!ja.bK.length)||U)U&&(this.Vb.Cxa=-1),a=null;x.nc(this.Vb.Ef);x.jd=f;l=Object(oa.a)(116,this.ut.AYb(a,ja,b,c,H));this.kn&&this.pa.JR(l);this.Vb.Ba=l;this.Vb.Ef.removeProperty(kb.a.WJe)}finally{x&&x.dispose()}return l}ITi(a,b,c,f,l,x){if(5!==
f)throw Error.invalidOperation();const H=Object(oa.a)(116,this.ut.vYd(a,b,c));if(!H)return xa.a.J(509364416,822,10,"CreateSlideNodeForInsertion returned null"),null;b=this.la.Jn?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;c=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{this.kn&&this.pa.JR(H);this.Ea.tf(Qi.a.PD)});try{c.nc(this.Vb.Ef),c.jd=x,this.ut.lab(H,a,null,b),l&&(this.Vb.Ba=H)}finally{c&&c.dispose()}return H}CTi(a,b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");
c||(c=a);let f;f=this.la.Jn?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;let l=null;const x=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{1!==this.Fb.Fl&&(this.la.Jn?this.Ea.tf(zb.a.MB):this.Ea.tf(Qi.a.PD))});try{x.nc(this.Vb.Ef),x.jd=b,l=Object(oa.a)(116,this.ut.jQ(Object(oa.a)(115,a),Object(oa.a)(115,c),f,!0)),this.XQ&&this.XQ.YNf([l]),this.kn&&this.pa.JR(l),this.Vb.Ba=l}finally{x&&x.dispose()}return l}nTf(a,b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");
const x=[];a=Array.clone(a);a.sort((ja,ya)=>ya.le-ja.le);c||(c=a[0]);let H;H=this.la.Jn?!0:u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Fb&&1===this.Fb.Fl;const U=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{1!==this.Fb.Fl&&(this.la.Jn?this.Ea.tf(zb.a.MB):this.Ea.tf(Qi.a.PD))});try{U.nc(this.Vb.Ef);U.jd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const ya=Object(oa.a)(116,this.ut.jQ(Object(oa.a)(115,a[b]),Object(oa.a)(115,c),H,l));ha.a.Wa(f)||(ya.Wb=f);Array.add(x,ya)}0<
x.length&&this.XQ&&this.XQ.YNf(x);let ja;(ja=this.pa).JR.apply(ja,x);this.Vb.Ba=x[x.length-1];this.Ge.q8a=!0}finally{U&&U.dispose()}return x}BW(a,b,c,f=null,l=null,x=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let H=null;x&&1!==this.Fb.Fl&&(H=()=>{this.pa.P_a(a,!0)});x=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();
this.Ea.Ed()},H);try{x.nc(b);x.jd=c;this.d8h(x,a);const U=new Sys.StringBuilder;for(c=0;c<a.length;c++){const ja=f?f[c]:null;a[c]&&(b.dC(a[c],ja),a[c].id&&U.append(a[c].id.toString()+";"))}x.Vy[yq.a.S9g]=U.toString();l&&b.LU([l])}finally{x&&x.dispose()}}d8h(a,b){if(1!==b.length||!b[0].ud&&ha.a.Wa(b[0].uZa))for(const c of b){if(c.dbb||c.Fj)a.Vy[yq.a.J7b]=!0;if(c.Mp||2===c.mediaType||1===c.mediaType)a.Vy[yq.a.SVc]=!0;c.hr&&(a.Vy[yq.a.RVc]=!0)}else a.Vy[yq.a.K7b]=!0}x8a(a,b){if(!(1>b.length)){var c=
this.Jb.Ad(15);try{c.nc(b[0]);const f=this.pa.aP(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&c.dispose()}}}Ija(a,b){this.x8a(c=>{(c=Object(oa.a)(4,c))&&a(c)},b)}}Object(m.a)($M,"GraphTransactionHelperProxy",null,[1140]);var LE=d(298),Tp=d(299);class aN{constructor(a,b,c,f){this.npc=a;this.opc=b;this.c1c=c;this.d1c=f}W4e(a,b,c,f){a<this.npc&&(this.npc=a);b<this.opc&&(this.opc=b);a+c>this.c1c&&(this.c1c=a+c);b+f>this.d1c&&(this.d1c=b+f)}}Object(m.a)(aN,"GroupShapeOffset",null,[]);class bN{constructor(a,
b,c,f,l,x,H,U,ja,ya){this.ia=a;this.Jb=b;this.pa=c;this.Fa=f;this.ua=l;this.Sk=x;this.Fb=H;this.Pi=U;this.lJ=ja;this.la=ya}wb(){this.ia.ra(K.a.oLe,rc.a.application,Object(F.a)(this,this.wsj,"handleGroupShapes"),4);this.ia.ra(K.a.wLe,rc.a.application,Object(F.a)(this,this.Rwj,"handleUngroupShapes"),4);this.ia.ra(K.a.nLe,rc.a.application,Object(F.a)(this,this.vsj,"handleGroupFlyoutAnchor"),4)}Ee(){const a=this.lJ.Mo.Fc(zb.a.sg);a.bindAction(y.KeyInputManager.Oa(A.a.XPb,y.KeyInputManager.Oe),K.a.oLe);
a.bindAction(y.KeyInputManager.Oa(A.a.XPb,y.KeyInputManager.Oe|4),K.a.wLe)}TCf(a){let b=1<a.length&&!a[0].Ng&&!a[1].Ng;if(b)for(const c of a)if(this.la.ska){if(c.HGb||c.fl||c.ud){b=!1;break}}else if(c.fl||c.ud){b=!1;break}return b}Vdj(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}wsj(a,b,c){const f=this.pa.Wd();return this.TCf(f)?1===c?32:Kg.a("GroupOperations_GroupShapes",a,()=>{const l=[];for(var x of f)l.push(x.id);x=Object(oa.a)(116,this.ua.Ba);
if(!x)throw Error.argumentNull("ActiveSlide is null");const H=x.Ut(),U=new aN(x.oq,x.Vk,0,0);var ja=0;let ya=ja=0;for(var Va of f)(ja=this.Vdj(Va),Va.az)?(ja=Va.wy,ya=Va.yy,U.W4e(ja,ya,Va.Sca,Va.Rca)):ja?90===ja&&(ja=Va.wy+Va.rx/2-Va.HC/2,ya=Va.yy+Va.HC/2-Va.rx/2,U.W4e(ja,ya,Va.HC,Va.rx)):(ja=Va.wy,ya=Va.yy,U.W4e(ja,ya,Va.rx,Va.HC));const hb=this.Sk.YQa(!1,x.Cb.cid,x.Cb.sid,0,10,U.npc,U.opc,U.c1c-U.npc,U.d1c-U.opc,H+1);xa.a.J(595359714,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",
f.length);this.GGj(hb,x.Cb,U.c1c-U.npc,U.d1c-U.opc);x.dC(hb);Va=this.Jb.Ad(15,void 0,void 0,()=>{this.pa.selectShape(hb,!0)});try{Va.nc(x),Va.jd=a,1<l.length&&(x.S8=l)}finally{Va&&Va.dispose()}return 32}):8}iDf(a){for(const b of a)if(this.la.ska){if(b.Jf&&!b.IGb)return!0}else if(b.Jf)return!0;return!1}Rwj(a,b,c){const f=this.pa.Wd();return this.iDf(f)?1===c?32:Kg.a("GroupOperations_UngroupShapes",a,()=>{const l=[];var x=[];for(const U of f)if(U.Jf){l.push(U.id);const ja=this.Fa.ex(U);for(const ya of ja)x.push(ya);
this.pa.p8(U)}for(var H of x)x=Kj.c(H,this.Fb.Ma),this.pa.p8(H),x.wka(),x.eLb=!0;H=this.ua.Ba;xa.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);x=this.Jb.Ad(15);try{x.nc(H),x.jd=a,H.jpa=l}finally{x&&x.dispose()}return 32}):8}vsj(a,b,c){b=this.pa.Wd();a=this.TCf(b);b=this.iDf(b);return 1===c?a||b?32:8:32}GGj(a,b,c,f){var l=Object(oa.a)(573,Object(oa.a)(116,this.ua.Ba).mg(this.Fb.Ma));const x=this.Fb.Ld,H=Math.round(this.Pi.GM(x.Pe(c,
0),l.qT));l=Math.round(this.Pi.GM(x.Pe(f,1),l.qT));a.setValue($a.a.rx,c);a.setValue($a.a.HC,f);a.setValue(kb.a.RPb,c);a.setValue(kb.a.Zxb,f);a.isEditable=!0;a.Jf=!0;a.setValue(kb.a.RK,4);a.setValue(kb.a.Ald,!0);a.Sca=Rf.a.FJa(H,0);a.Rca=Rf.a.FJa(l,1);a.setValue(kb.a.BRa,0);a.setValue(kb.a.CRa,0);a.setValue(kb.a.QUa,!0);a.setValue(kb.a.isResizable,!0);a.setValue(kb.a.CL,!0);a.YN=!0;a.KUa=!0;a.CL=!0;a.isResizable=!0;a.pG=M.a.UE(b.sid,b.cid);a.Dkb=a.get_shapeId();a.setValue(kb.a.gua,!0);b=Object.assign(new LE.a,
{TopLeft:Object.assign(new Tp.a,{X:0,Y:0}),TopRight:Object.assign(new Tp.a,{X:H,Y:0}),BottomLeft:Object.assign(new Tp.a,{X:0,Y:l}),BottomRight:Object.assign(new Tp.a,{X:H,Y:l})});a.OU=b;this.Fa.EL(a)&&Tc.a.Ib&&(Tc.a.Ib.Nj=!0)}}Object(m.a)(bN,"GroupUngroupShapesActor",null,[352]);class cN{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(m.a)(cN,"FooterPaneInfo",null,[]);var dN=d(618);class ME{constructor(){this.ActiveSlideSid=
this.ActiveSlideCid=0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(m.a)(ME,"PresFooterInfo",null,[]);var eN=d(645);class fN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.$la=null;a("powerpoint-editor-intl").then(()=>{xa.a.J(594321887,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{xa.a.J(594321885,801,50,"Header Footer Pane Manager script is loaded successfully");this.$la=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();
this.qUk()}).catch(Zb=>{xa.a.J(594321883,801,10,"Failed to load headerfooter pane manager "+Zb.toString())})}).catch(Zb=>{xa.a.J(594321881,801,10,"Failed to load powerpoint-editor-intl "+Zb.toString())});this.ob=b;this.Rb=c;this.ia=f;this.Vb=l;this.ua=x;this.Ea=H;this.Fv=U;this.Pg=ja;this.qd=ya;this.Lc=Va;this.Jb=hb;this.Pg.rI(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.hrb(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.SBa(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));
this.Lc.HPa(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.qd.VBa(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Rb.PK(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"));this.mz=null;this.MDb=!1;this.iFb=yb}dispose(){this.Pg.U5(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.xld(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.j_a(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Lc.Eib(Object(F.a)(this,this.HJ,
"onChangeRenderHeaderFooterPane"));this.qd.Gib(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Rb.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"))}Ee(){}wb(){this.ia.ra(K.a.iab,rc.a.application,Object(F.a)(this,this.iab,"insertFooterFlyoutMenu"),4);this.ia.ra(K.a.RY,rc.a.application,Object(F.a)(this,this.RY,"showHideHeaderFooterPane"),4);this.ia.ra(K.a.lUa,rc.a.application,Object(F.a)(this,this.lUa,"insertSlideNumber"),4);this.ia.ra(K.a.Tmc,rc.a.application,Object(F.a)(this,
this.Tmc,"queryHeaderFooterPane"),96)}Tmc(a,b,c,f,l){(a=Object(oa.a)(Uh.a,l))&&a.Mf(this.Fv.isVisible);return 32}iab(){return this.$la&&this.Vb&&this.ua.Ba&&this.Vb.isEditingAllowed?32:8}RY(a,b,c){if(1===c)return this.Fv&&this.ua.Ba?32:8;if(!this.Fv)return 8;this.mz=null;this.Fv.isVisible=!this.Fv.isVisible;this.Fv.isVisible?(Kg.a("FooterPaneOpen",a,()=>{this.xoc();return 32}),this.iFb||(this.Ea.Cj(zb.a.QI,!0),this.$la.focus())):this.Ea.Cj(zb.a.QI,!1);return 32}lUa(a,b,c,f,l){return 1===c?this.ua.Ba?
32:8:Kg.a("FooterPaneInsertSldNumber",a,()=>{const x=this.Slc();this.quc(x.OmitOnTitlePh,x.IsFooterInsert,x.SFooterName,!0);return this.RY(a,b,c,f,l)})}Su(a){1===a.mode&&this.Fv&&this.Fv.isVisible&&(this.mz=null,this.Fv.isVisible=!1,this.Ea.Cj(zb.a.QI,!1))}a9d(a){const b=new Ka.a;a=a.$D();for(const c of a)(a=Sb.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}Slc(){const a=new dN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;
if((b=b.Ek(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.fl&&(5===c.Hj?a.IsSlideNumInsert=!0:6===c.Hj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.DC?this.a9d(c):"",0<b.length?a.SFooterName=b:xa.a.J(594321879,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Vb.Ef.cJa;return a}isMultipleSlidesSelected(){const a=this.ob.Qe();return a&&1<a.length?!0:!1}xoc(){if(this.Fv.isVisible)if(this.ua.Ba){var a=this.Slc(),b=this.isMultipleSlidesSelected();if(!this.mz||a.IsFooterInsert!==this.mz.IsFooterInsert||
a.IsSlideNumInsert!==this.mz.IsSlideNumInsert||a.OmitOnTitlePh!==this.mz.OmitOnTitlePh||a.SFooterName.localeCompare(this.mz.SFooterName)||b!==this.MDb){this.mz=a;this.MDb=b;var c=new cN;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.$la.renderHeaderFooterTaskPane(eN.a.Yce,c)}}else this.Fv.isVisible=!1,this.mz=null}HJ(){this.xoc()}qUk(){this.$la.addCloseHeaderFooterPaneEventListener(()=>
{this.Fv.isVisible=!1;this.mz=null});this.$la.addFocusHeaderFooterPaneListener(()=>{this.Ea.Cj(zb.a.QI,!0)});this.$la.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.H4e(a,b,c,f,l)});this.$la.addUpdateMultiSlideHeaderFooterListener((a,b,c,f)=>{this.T4e(a,b,c,f)})}H4e(a,b,c,f,l){this.ua.Ba&&(l?this.a5e(a,b,c,f):this.quc(a,b,c,f))}T4e(a,b,c,f){this.ua.Ba&&Kg.a("FooterPaneMultiSlide",K.a.RY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.ij()});try{l.nc(this.ua.Ba);const x=this.ob.Qe();if(x&&1<x.length){for(const H of x){const U=
H.z8;U.IsSlideNumInsert=f;U.IsFooterInsert=b;U.OmitOnTitlePh=a;U.SFooterName=c;U.IsToggled=!U.IsToggled;H.z8=U}this.Vb.Ef.cJa=a}}finally{l&&l.dispose()}return 32})}quc(a,b,c,f){let l="FooterPaneSingleSlide";const x=this.ua.Ba,H=x.z8;if(a||b||f)H.OmitOnTitlePh!==a?l+="_OPH":H.IsSlideNumInsert!==f?l+="_ISN":H.IsFooterInsert!==b&&(l+="_IFT");Kg.a(l,K.a.RY,()=>{const U=this.Jb.Ad(15,void 0,()=>{this.ob.ij()});try{U.nc(this.ua.Ba),H.IsSlideNumInsert=f,H.IsFooterInsert=b,H.OmitOnTitlePh=a,H.SFooterName=
c,H.IsToggled=!H.IsToggled,this.Vb.Ef.cJa=a,x.z8=H}finally{U&&U.dispose()}return 32})}a5e(a,b,c,f){Kg.a("FooterPaneAllSlides",K.a.RY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.ij()});try{const x=this.Vb.Ef;l.nc(x);let H=x.PJa;H||(H=new ME);const U=this.ua.Ba;H.ActiveSlideCid=U.cid;H.ActiveSlideSid=U.sid;H.IsSlideNumInsert=f;H.IsFooterInsert=b;H.IsOmitOnTitlePh=a;H.SFooterName=c;H.IsToggled=!H.IsToggled;x.cJa=a;x.PJa=H}finally{l&&l.dispose()}return 32})}}Object(m.a)(fN,"HeaderFooterPaneActor",
null,[352]);class gN{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(m.a)(gN,"FooterPaneInfo",null,[]);class hN{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(m.a)(hN,"HeaderFooterContentProps",null,[]);class iN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.O5c=!1;yb?this.O5c=!0:a("powerpoint-editor-intl").then(()=>
{xa.a.J(590210325,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{xa.a.J(590210323,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{xa.a.J(590210321,801,50,"Header Footer Pane script is loaded successfully");this.O5c=!0}).catch(()=>{xa.a.J(590210319,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{xa.a.J(590210317,801,10,"Failed to load Ribbon script")})}).catch(Zb=>{xa.a.J(590210315,801,10,"Failed to load powerpoint-editor-intl "+
Zb.toString())});this.ob=b;this.Rb=c;this.ia=f;this.Vb=l;this.ua=x;this.Fv=U;this.Pg=ja;this.qd=ya;this.Lc=Va;this.Jb=hb;this.Pg.rI(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.hrb(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.SBa(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Lc.HPa(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.qd.VBa(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Rb.PK(Object(F.a)(this,
this.Su,"onAppFrameModeSwitched"));this.mz=null;this.MDb=!1;this.iFb=yb}dispose(){this.Pg.U5(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.xld(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Pg.j_a(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Lc.Eib(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.qd.Gib(Object(F.a)(this,this.HJ,"onChangeRenderHeaderFooterPane"));this.Rb.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"))}Ee(){}wb(){this.ia.ra(K.a.iab,
rc.a.application,Object(F.a)(this,this.iab,"insertFooterFlyoutMenu"),4);this.ia.ra(K.a.RY,rc.a.application,Object(F.a)(this,this.RY,"showHideHeaderFooterPane"),4);this.ia.ra(K.a.lUa,rc.a.application,Object(F.a)(this,this.lUa,"insertSlideNumber"),4)}iab(){return this.Vb&&this.ua.Ba&&this.Vb.isEditingAllowed?32:8}RY(a,b,c){if(1===c)return this.O5c?32:8;if(!this.Fv)return 8;this.mz=null;this.Fv.isVisible=!this.Fv.isVisible;this.Fv.isVisible?Kg.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.iFb.toString(),
a,()=>{this.xoc();return 32}):this.Cr();return 32}Su(a){1===a.mode&&this.Fv&&this.Fv.isVisible&&(this.mz=null,this.Fv.isVisible=!1,this.Cr())}Ql(a=!1){const b=this.vC(),c=Object.assign(new mu.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Fv.isVisible=!1},isModernPane:!0});this.iFb?mj.UISurfaces.zr().then(f=>{a?f.updateTaskPane(zb.a.QI,c):f.showTaskPane(zb.a.QI,c);return null}):(this.Fv.isVisible=!0,taskPanes.taskPane.renderTaskPane(eN.a.Yce,
c))}Cr(){this.iFb&&mj.UISurfaces.zr().then(a=>{a.hideTaskPane(zb.a.QI,2);return null})}vC(){const a=new gN;a.isFooterInsert=this.mz.IsFooterInsert;a.sFooterName=this.mz.SFooterName;a.isSlideNumInsert=this.mz.IsSlideNumInsert;a.omitOnTitle=this.mz.OmitOnTitlePh;a.isMultipleSlidesSelected=this.MDb;const b=new hN;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(F.a)(this,this.H4e,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(F.a)(this,this.T4e,"updateMultiSlidesFooterInfo");return b}lUa(a,
b,c,f,l){return 1===c?this.O5c?32:8:Kg.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.iFb.toString(),a,()=>{const x=this.Slc();this.quc(x.OmitOnTitlePh,x.IsFooterInsert,x.SFooterName,!0);return this.RY(a,b,c,f,l)})}a9d(a){const b=new Ka.a;a=a.$D();for(const c of a)(a=Sb.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}Slc(){const a=new dN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.Ek(!0))&&0<b.length)for(const c of b)!c.isLocal&&
c.fl&&(5===c.Hj?a.IsSlideNumInsert=!0:6===c.Hj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.DC?this.a9d(c):"",0<b.length?a.SFooterName=b:xa.a.J(590210313,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Vb.Ef.cJa;return a}isMultipleSlidesSelected(){const a=this.ob.Qe();return a&&1<a.length?!0:!1}xoc(a=!1){if(this.Fv.isVisible)if(this.ua.Ba){var b=this.Slc(),c=this.isMultipleSlidesSelected();if(!this.mz||b.IsFooterInsert!==this.mz.IsFooterInsert||b.IsSlideNumInsert!==this.mz.IsSlideNumInsert||b.OmitOnTitlePh!==
this.mz.OmitOnTitlePh||b.SFooterName.localeCompare(this.mz.SFooterName)||c!==this.MDb)this.mz=b,this.MDb=c,this.Ql(a)}else this.Fv.isVisible=!1,this.mz=null}HJ(){this.xoc(!0)}H4e(a,b,c,f,l){this.ua.Ba&&(f?this.a5e(a,b,l,c):this.quc(a,b,l,c))}T4e(a,b,c,f){this.ua.Ba&&Kg.a("FooterPaneMultiSlide",K.a.RY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.ij()});try{l.nc(this.ua.Ba);const x=this.ob.Qe();if(x&&1<x.length){for(const H of x){const U=H.z8;U.IsSlideNumInsert=c;U.IsFooterInsert=b;U.OmitOnTitlePh=
a;U.SFooterName=f;U.IsToggled=!U.IsToggled;H.z8=U}this.Vb.Ef.cJa=a}}finally{l&&l.dispose()}return 32})}quc(a,b,c,f){let l="FooterPaneSingleSlide";const x=this.ua.Ba,H=x.z8;if(a||b||f)H.OmitOnTitlePh!==a?l+="_OPH":H.IsSlideNumInsert!==f?l+="_ISN":H.IsFooterInsert!==b&&(l+="_IFT");Kg.a(l,K.a.RY,()=>{const U=this.Jb.Ad(15,void 0,()=>{this.ob.ij()});try{U.nc(this.ua.Ba),H.IsSlideNumInsert=f,H.IsFooterInsert=b,H.OmitOnTitlePh=a,H.SFooterName=c,H.IsToggled=!H.IsToggled,this.Vb.Ef.cJa=a,x.z8=H}finally{U&&
U.dispose()}return 32})}a5e(a,b,c,f){Kg.a("FooterPaneAllSlides",K.a.RY,()=>{const l=this.Jb.Ad(15,void 0,()=>{this.ob.ij()});try{const x=this.Vb.Ef;l.nc(x);let H=x.PJa;H||(H=new ME);const U=this.ua.Ba;H.ActiveSlideCid=U.cid;H.ActiveSlideSid=U.sid;H.IsSlideNumInsert=f;H.IsFooterInsert=b;H.IsOmitOnTitlePh=a;H.SFooterName=c;H.IsToggled=!H.IsToggled;x.cJa=a;x.PJa=H}finally{l&&l.dispose()}return 32})}}Object(m.a)(iN,"HeaderFooterPaneWacActor",null,[352]);class jN{constructor(a,b,c,f,l){this.Ms=a;this.ia=
b;this.Vb=c;this.ua=f;this.fc=l}wb(){this.ia.ra(K.a.lXc,Cb.a.application,Object(F.a)(this,this.Qsj,"handleInsertContentFromStream"),4)}Ee(){}Qsj(a,b,c,f,l){b=this.ua.Ba;if(this.fc.$c(b))return 16;if(1===c)return 32;Tc.a.zk("SlideCount","1");c=this.Ms.ITi(b,l.streamUrl,l.formatType,l.objectType,l.renderAfterInsert,a);l.renderAfterInsert&&c&&!c.aO&&this.fc.fw(this.Vb.Ef,a);return 32}}Object(m.a)(jN,"InsertContentFromStreamActor",null,[352]);class kN{constructor(a,b){this.Pi=a;this.Tb=b}BSd(a,b,c,f){const l=
H=>this.Pi.GM(a.Pe(Rf.a.rf(H,0),0),f),x=Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new LE.a,{TopLeft:Object.assign(new Tp.a,{X:0,Y:0}),TopRight:Object.assign(new Tp.a,{X:x,Y:0}),BottomLeft:Object.assign(new Tp.a,{X:0,Y:b}),BottomRight:Object.assign(new Tp.a,{X:x,Y:b})})}qWd(a,b,c){var f=a?a.nce:9;const l=Rf.a.Pe(a?a.i6e:6,0,!1);f=Rf.a.Pe(f,1,!1);b=this.Rwi(l,f,b,c);a=a?a.$wb(b.width,b.height,!0):this.Tb.Ata(b.width,b.height);
return{U2d:b,mD:a}}Rwi(a,b,c,f){let l=0,x=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),x=Math.max(f*a,1));return new hr.a(l,x)}}Object(m.a)(kN,"InsertImageHelper",null,[1171]);var be=d(681),iA=d(680);class lN{r6f(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);Ud.a("FixInkDotInsertionAtHighZooms")?(a=f.GM(b,c),c=f.GM(l,c)):(a=Math.round(f.GM(b,c)),c=Math.round(f.GM(l,c)));return{Msh:a,Esh:c}}tJf(a,b,c){return Object.assign(new LE.a,{TopLeft:Object.assign(new Tp.a,
{X:0,Y:0}),TopRight:Object.assign(new Tp.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new Tp.a,{X:0,Y:b*c}),BottomRight:Object.assign(new Tp.a,{X:a*c,Y:b*c})})}tqh(){}Eqh(){}}Object(m.a)(lN,"InsertInkActorHelper",null,[847]);var tR=d(503);class jA{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.W9=yb;this.Ms=a;this.ia=b;this.ua=c;this.fc=f;this.Fb=l;this.Nu=U;this.Sk=ja;this.Wj=ya;this.Fa=Va;this.Pi=hb}dispose(){}wb(){this.ia.ra(K.a.Ueg,Cb.a.application,Object(F.a)(this,this.Rsj,"handleInsertInk"),4)}Ee(){}Rsj(a,
b,c,f,l){if(!l)return 16;b=l.Fd;if(!b)return xa.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;f=b.Cb;if(M.a.ix(f)||this.fc.$c(b))return 16;if(1===c)return 32;c=this.q9a(a);if(!c)return 8;if(!this.Wj.OF(b,1))return this.Wj.nG(b),16;var x=l.tGj;if(!x)return xa.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!x.count)return xa.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Ka.a;for(let Va of x){x=Va.Pii;if(!x)return 16;
var H=b.Rw;H=H&&null!=H.Zr?H.Zr:1;x.right=x.left+(x.right-x.left)/(1/H);x.bottom=x.top+(x.bottom-x.top)/(1/H);var U=x.right-x.left,ja=x.bottom-x.top;U=Math.max(U,1);ja=Math.max(ja,1);var ya=this.Fb.Ld;U=Rf.a.rf(U,0);ja=Rf.a.rf(ja,1);const hb=ya.rf(x.left,0);ya=ya.rf(x.top,1);const yb=b.Ut();x=iA.a.ULc(f,c,H,x,new lN,hb,ya,U,ja,yb,this.Fa,this.Sk,this.Fb,this.ua,this.Pi);x.setValue(kb.a.Gka,Va.json);x.setValue(kb.a.qFa,!0);Tc.a.Ib&&(Tc.a.Ib.actionName=jA.nVc);x.sI=new tR.a([Va.stroke],Va.json,!1);
l.add(x)}this.Ms.BW(l.toArray(),b,a,void 0,void 0,!1);for(let Va of l)this.W9.registerInkWithStrokeCollection(Va.sI.Xya,Va.id);this.Nu.SF=l.ga(l.count-1);return 32}q9a(){return new be.a(4,10,1,1)}}jA.nVc="InsertInk";Object(m.a)(jA,"InsertInkActor",null,[352,106]);class mN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va){this.Kj=null;this.x6c=!1;this.Fb=a;this.Sk=b;this.Ea=c;this.ua=f;this.Tb=l;this.pa=H;this.Nu=U;this.Wj=ja;this.Jb=ya;this.fc=Va;this.la=x;this.KGl=x.insertOnlineVideoUrlPatterns;this.wkh=x.insertOnlineVideoEndpoint;
this.Ds=u.AFrameworkApplication.Ke;this.Evl=3E4}get startTime(){return this.Kj}NUi(a){if(!a)return null;const b=a.trim();this.pOj(b)&&(xa.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.OUi(b));return a}Lng(a){if(!a)return!1;a=a.trim();for(const b of this.KGl)if((new RegExp(b)).test(a))return!0;return!1}kXj(a){if(!a)return!1;a=a.trim();a=bg.a.YD(a).toLowerCase();return!this.la.Hab&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===a||!this.la.qAb&&
("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}vzl(a,b){this.requestVideoData(a,c=>{this.gfg(c)},b)}requestVideoData(a,b,c){this.x6c?xa.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.x6c=!0,c=c||Object(F.a)(this,this.bOi,"doNothingCallback"),this.Kj=new Date,a=ha.a.Ne(a),a=this.wkh+(0<this.wkh.indexOf("?")?"&":"?")+"url="+a,this.Ds.mj(a,1,null,null,!1,2,f=>{b(f);this.x6c=!1},f=>{c(f);this.x6c=!1},null,void 0,void 0,void 0,this.Evl,Hx.a("1")))}gfg(a){var b=
+new Date-+this.startTime;xa.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Tc.a.zk("HubbleCallDuration",b.toString());if((b=this.ua.Ba)&&!this.fc.$c(b)&&this.Wj.OF(b,1))try{const U=b.A3(this.pa.Wd());if(!U||!this.fc.$c(U)){var c=this.d$a(b,U),f=JSON.parse(a.data.Sd),l=f.width,x=f.height;c.RVe(f.embed_url,f.thumbnail_url,f.title,f.description,0<l?l:0,0<x?x:0);var H=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()},()=>{this.pa.selectShape(c,
!0)});try{H.kd(b),this.la.Dxl&&(H.jd=K.a.Zta,H.Vy[yq.a.qDa]=yq.a.online),U&&b.LU([U]),b.dC(c)}finally{H&&H.dispose()}this.fc.fw(b,"InsertOnlineVideo");this.Nu.SF=c;xa.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(U){xa.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",U.message,U.stack)}else this.Wj.nG(b)}bOi(){}d$a(a,b){if(!a)return null;var c=a.Cb;a=a.Ut();let f;const l=Mf.a.dY,x=Mf.a.u5;f=b?b.$wb(Mf.a.dY,
Mf.a.u5):this.Tb.Ata(Mf.a.dY,Mf.a.u5);const H=b?0:0*Cq.a.LS;c=this.Sk.isa(!0,c.cid,c.sid,0,f.x+H,f.y+H,l,x,a+1,!0);b&&(c.vca=b.id);return c}OUi(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return xa.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}pOj(a){return a?RegExp(".*iframe.*").test(a):!1}g1f(a){if(!a)return"NA";let b=a.indexOf(".com/");if(-1===b)return"NA";if(a.startsWith("https://"))a=
a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(m.a)(mN,"InsertOnlineVideoDialogHelper",null,[1141]);var nN=d(1025);class Rj{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg){this.KDb=this.xHa=0;if(!Gc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!Te)throw Error.argumentNull("appFrame");if(!Ze)throw Error.argumentNull("viewEventNotifier");this.Ms=a;this.ia=
b;this.Ea=c;this.pa=f;this.lO=0;this.ua=ja;this.fc=l;this.Fb=x;this.xGa=H;this.Nu=Va;this.lQg=U;this.Pg=ya;this.ut=ja.presentation;this.Sk=hb;this.Wj=yb;this.R6c=Zb;this.PXa=fc;this.Fa=Kc;this.Pi=Lc;this.NWa=Gc;this.Hea=ae;this.Bec=we;this.f6c=$d;this.Rb=Te;this.he=Ze;this.Iqe=Vf;this.WSg=gg;this.Pg.rI(Object(F.a)(this,this.hZa,"onSlideNavigation"));this.lQg.jk(Object(F.a)(this,this.Tgb,"onPresentationPropertyChanged"));this.Bec&&(this.Rb.PK(Object(F.a)(this,this.Su,"onAppFrameModeSwitched")),this.he.g6a(Object(F.a)(this,
this.faa,"onRibbonTabSwitched")),this.he.W8h(Object(F.a)(this,this.$2g,"onEscapeKeyPressed")));Rj.Odd.push(K.a.HXc);Rj.Odd.push(K.a.FXc);this.nCf()}dispose(){this.lQg.Cm(Object(F.a)(this,this.Tgb,"onPresentationPropertyChanged"));this.Pg.U5(Object(F.a)(this,this.hZa,"onSlideNavigation"));this.Bec&&(this.Rb.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched")),this.he.pKb(Object(F.a)(this,this.faa,"onRibbonTabSwitched")),this.he.XXk(Object(F.a)(this,this.$2g,"onEscapeKeyPressed")))}wb(){for(const a of Rj.wul)this.ia.ra(a,
Cb.a.application,Object(F.a)(this,this.B$f,"handleInsertShape"),4);for(const a of Rj.Ndd)this.ia.ra(a,Cb.a.application,Object(F.a)(this,this.B$f,"handleInsertShape"),4);this.ia.ra(K.a.AXc,Cb.a.application,Object(F.a)(this,this.Tsj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.ra(K.a.KXc,Cb.a.application,Object(F.a)(this,this.Usj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.ra(K.a.Api,Cb.a.application,Object(F.a)(this,this.W9f,"handleCancelInsertShape"),4);this.ia.ra(K.a.pDf,Cb.a.application,
Object(F.a)(this,this.W9f,"handleCancelInsertShape"),4);this.ia.ra(K.a.i8a,Cb.a.application,Object(F.a)(this,this.Rrj,"handleDuplicateShape"),4)}Ee(){this.Ea.Fc(zb.a.sg).bindAction(y.KeyInputManager.Oa(A.a.EMa,y.KeyInputManager.Oe),K.a.i8a);this.Ea.Fc(zb.a.lQ).bindAction(y.KeyInputManager.Oa(A.a.EMa,y.KeyInputManager.Oe),K.a.i8a)}nCf(){if(this.ut){var a=Math.min(this.ut.Znl,this.ut.Dnl);a=Math.max(a-50,0);this.xHa=Math.floor(a/(2*Cq.a.LS))-1;this.xHa=Math.max(this.xHa,0);this.KDb=-1*this.xHa}else this.xHa=
1,this.KDb=-1}Tgb(a,b){b.property!==kb.a.slideWidth&&b.property!==kb.a.slideHeight||this.nCf()}hZa(){this.lO=0;this.Bec&&this.Dga(0)}Su(a){1===a.mode&&this.Dga(0)}faa(){this.Dga(0)}$2g(){this.Dga(0)}Dga(a){1===a&&this.Ea.Ed();this.NWa.g2e(a)}B$f(a,b,c,f,l){b=this.ua.Ba;if(!b)return 16;f=b.Cb;if(M.a.ix(f)||this.fc.$c(b))return 16;if(1===c)return 32;c=this.q9a(a);if(!c)return 8;if(!this.Wj.OF(b,1))return this.Wj.nG(b),16;const x=this.R6c&&this.PXa.VI;var H=b.ke.HasDefaultShape,U=b.ke.HasDefaultLine,
ja=95===c.mga||97===c.mga||Array.contains(iA.a.Gne,c.mga);U=U&&ja;H=H&&!ja;ja=!1;l&&(Zm.a.Hu in l?l=l[Zm.a.Hu]:(xa.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),l=0),ja=!Array.contains(Rj.Fok,l));if(ja){if(a===K.a.XEa)return this.Dga(1),this.Hea.instance.Fyb=-1,32;if(x&&!Array.contains(Rj.Odd,a)&&!H&&!U){this.Dga(2);if(null==this.Hea.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.Hea.instance.Fyb=a;return 32}}this.Dga(0);let ya,Va;var hb=this.ut.slideWidth,
yb=this.ut.slideHeight;ja=new hd.a((hb-c.width*ye.a.aD)/2,(yb-c.height*ye.a.aD)/2);l=ja.x+Rf.a.rf(this.lO*Cq.a.LS,0);Va=ja.y+Rf.a.rf(this.lO*Cq.a.LS,1);x?(ja=c.width*ye.a.aD,ya=c.height*ye.a.aD):(ja=Rf.a.rf(Rj.l_b,0),ya=Rf.a.rf(Rj.k_b,1),l=hb/2-Rf.a.rf(Rj.l_b/2-this.lO*Cq.a.LS,0),Va=yb/2-Rf.a.rf(Rj.k_b/2-this.lO*Cq.a.LS,1));this.lO++;this.lO>this.xHa&&(this.lO=this.KDb);hb=b.Ut();yb=Object(oa.a)(573,this.ua.Ba.mg(this.Fb.Ma));Tc.a.Ib&&(U||H)&&Tc.a.Ib.Va(ni.a.N2d,U?"HasDefaultLine":"HasDefaultShape");
!x||a===K.a.XEa||Array.contains(Rj.Odd,a)||H||U?f=this.Sk.YQa(!1,f.cid,f.sid,0,c.shapeType,l,Va,ja,ya,hb+1):(f=iA.a.ULc(f,c,yb.qT,null,new nN.a,l,Va,ja,ya,hb,this.Fa,this.Sk,this.Fb,this.ua,this.Pi),Tc.a.Ib&&(Tc.a.Ib.actionName=Rj.nVc));Ud.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===K.a.XEa&&(this.Rsf(),this.Sdb=f);f.isEditable=!Array.contains(Rj.Ndd,a);this.Ms.BW([f],b,a);this.Nu.SF=f;this.Ktc();return 32}Rsf(){this.Kwe||(this.WSg.ura(this.tnh.bind(this)),this.Pg.HGc(this.yZg.bind(this)),this.Kwe=
!0)}YWk(){this.Kwe&&(this.WSg.soc(this.tnh.bind(this)),this.Pg.Mih(this.yZg.bind(this)),this.Kwe=!1)}tnh(a,b){a=b.node;null!=a&&a==this.Sdb&&(this.Sdb=a,this.HFg=b.revisionId.toString())}yZg(a,b){b.taa&&b.taa.Id&&this.HFg==b.taa.Id&&(null==this.Sdb||this.Iqe.jua(this.Sdb)||setTimeout(()=>{this.ia.La(K.a.dQa,2,new uo.a(this.Sdb,!0,null));this.YWk();this.HFg=this.Sdb=null},0))}Usj(a,b,c,f,l){if(1===c)return 2;this.Dga(0);b=this.ua.Ba;if(!b)return 16;f=b.Cb;if(M.a.ix(f)||this.fc.$c(b))return 16;c=this.q9a(a);
if(!c)return 16;if(!this.Wj.OF(b,1))return this.Wj.nG(b),16;this.lO++;this.lO>this.xHa&&(this.lO=this.KDb);if(!Ud.a("IsAnyOffsetZeroForTextbox")){if(!(l&&l.left&&l.right&&l.bottom&&l.top))return xa.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return xa.a.J(512336011,829,10,"Invalid offsets"),16;const x=this.ua.Ba.Rw.Zr;let H=Rf.a.rf(this.Pi.GM(l.right-l.left,x),0),U=Rf.a.rf(this.Pi.GM(l.bottom-l.top,x),1);U||H||(this.f6c?(H=c.width*ye.a.aD,U=c.height*ye.a.aD):(H=Rf.a.rf(Rj.umi,0),
U=Rf.a.rf(Rj.tmi,1)));H=H?H:Rf.a.rf(Rj.Wmi,0);U=U?U:Rf.a.rf(Rj.Vmi,1);const ja=Rf.a.rf(this.Pi.GM(l.left,x),0);l=Rf.a.rf(this.Pi.GM(l.top,x),1);l=this.Sk.YQa(!1,f.cid,f.sid,0,c.shapeType,ja,l,H,U,b.Ut()+1);if(!l)return xa.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;Ud.a("FixNarratorTextBoxBug")&&(l.setValue(kb.a.RK,c.mga),l.setValue(kb.a.px,!0));Ud.a("MoveCursorToTextboxAfterInsert")&&this.Rsf();l.isEditable=!Array.contains(Rj.Ndd,a);this.Sdb=l;this.Ms.BW([l],
b,a);this.Nu.SF=l;this.Ktc();xa.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");return 32}Tsj(a,b,c,f,l){if(1===c)return xa.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.Dga(0);b=this.ua.Ba;if(!b)return xa.a.J(512349510,829,10,"slideNode is null"),16;c=b.Cb;if(M.a.ix(c))return xa.a.J(512349509,829,10,"slideNode is fake"),16;if(this.fc.$c(b))return xa.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;f=this.q9a(l.insertShapeActionId);if(!f)return xa.a.J(512349507,
829,10,"autoShapeProps is null"),16;if(!this.Wj.OF(b,1))return this.Wj.nG(b),16;var x=l.offsets;if(!x)return xa.a.J(512349788,829,10,"Invalid offsets"),16;const H=this.ua.Ba.mg(this.Fb.Ma);let U=this.Fb.Ld.rf(x.right-x.left,0),ja=this.Fb.Ld.rf(x.bottom-x.top,1);ja||U||(U=f.width*ye.a.aD,ja=f.height*ye.a.aD);const ya=this.Fb.Ld.rf(x.left,0);x=this.Fb.Ld.rf(x.top,1);f.height=ja/ye.a.aD;f.width=U/ye.a.aD;const Va=b.Ut();c=iA.a.ULc(c,f,H.qT,null,new nN.a,ya,x,U,ja,Va,this.Fa,this.Sk,this.Fb,this.ua,this.Pi);
Tc.a.Ib&&(Tc.a.Ib.actionName=Rj.nVc);if(!c)return xa.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(Rj.Ndd,a);l.insertLocalShape?b.dC(c,null):(this.Ms.BW([c],b,a),this.Hea.instance.Fyb=-1,this.Nu.SF=c,this.Ktc());l.node=c;xa.a.J(512349786,829,50,"Successfully inserted the shape at specified location");return 32}W9f(a,b,c){if(1===c)return 32;this.Dga(0);return 32}q9a(a){switch(a){case K.a.XEa:return new be.a(4,16,.5,3);case K.a.KXc:return new be.a(4,
16,.5,3);case K.a.Cfe:return new be.a(34,9,1,1);case K.a.whe:return new be.a(2,17,1,1.16);case K.a.Sge:return new be.a(3,55,1,1);case K.a.Cge:return new be.a(6,56,1,1.33);case K.a.vhe:return new be.a(7,57,1.33,1);case K.a.qfe:return new be.a(5,58,1,1);case K.a.Yge:return new be.a(9,59,1,1.05);case K.a.Lfe:return new be.a(10,60,1,1.16);case K.a.Kfe:return new be.a(11,61,1,1);case K.a.xge:return new be.a(12,62,1,1);case K.a.mfe:return new be.a(13,63,1,1);case K.a.ufe:return new be.a(14,64,1,1);case K.a.Ege:return new be.a(39,
65,1,1);case K.a.Yee:return new be.a(87,66,1,1);case K.a.the:return new be.a(35,67,1,1);case K.a.Hfe:return new be.a(83,68,1,1);case K.a.Ife:return new be.a(84,69,1,1);case K.a.Ofe:return new be.a(85,70,1,1);case K.a.pfe:return new be.a(86,71,1,1);case K.a.dfe:return new be.a(130,72,1,1);case K.a.Fge:return new be.a(33,73,1,1);case K.a.Vee:return new be.a(73,7,1.33,1);case K.a.efe:return new be.a(72,8,1.33,1.33);case K.a.Tee:return new be.a(82,74,1.14,1.14);case K.a.vfe:return new be.a(41,75,1,1);
case K.a.vge:return new be.a(42,76,1,1);case K.a.Uee:return new be.a(40,77,1,1);case K.a.Gfe:return new be.a(81,78,1,1);case K.a.$ge:return new be.a(78,79,1,1);case K.a.Jfe:return new be.a(75,18,1,1);case K.a.Xfe:return new be.a(74,80,1,1);case K.a.she:return new be.a(76,81,1,1);case K.a.tge:return new be.a(77,82,1,.5);case K.a.$ee:return new be.a(120,83,1,1);case K.a.Pee:return new be.a(88,84,1,1);case K.a.xfe:return new be.a(93,85,1,1);case K.a.wfe:return new be.a(94,86,1,1.17);case K.a.Sfe:return new be.a(89,
87,1,.08);case K.a.Rge:return new be.a(90,88,1,.08);case K.a.Rfe:return new be.a(91,89,1,.17);case K.a.Qge:return new be.a(92,90,1,.17);case K.a.rge:return new be.a(175,19,1,1);case K.a.oge:return new be.a(176,20,1,1);case K.a.pge:return new be.a(177,21,1,1);case K.a.mge:return new be.a(178,22,1,1);case K.a.nge:return new be.a(179,23,1,1);case K.a.qge:return new be.a(180,24,1,1);case K.a.HXc:return new be.a(95,12,1,1);case K.a.IXc:return new be.a(95,13,1,1);case K.a.JXc:return new be.a(95,14,1,1);
case K.a.FXc:return new be.a(97,26,1,1);case K.a.EXc:return new be.a(97,155,1,1);case K.a.GXc:return new be.a(97,156,1,1);case K.a.CXc:return new be.a(101,25,1,1);case K.a.BXc:return new be.a(101,153,1,1);case K.a.DXc:return new be.a(101,154,1,1);case K.a.zfe:return new be.a(46,0,1.07,.53);case K.a.Pfe:return new be.a(44,1,.53,1.07);case K.a.Tfe:return new be.a(50,2,.53,1.33);case K.a.Oge:return new be.a(43,3,.53,1.07);case K.a.yhe:return new be.a(45,4,1.07,.53);case K.a.Ahe:return new be.a(51,5,
1.33,.53);case K.a.Vfe:return new be.a(53,27,.93,1.33);case K.a.Qee:return new be.a(62,28,.95,.89);case K.a.xhe:return new be.a(63,29,.96,.97);case K.a.Wfe:return new be.a(52,30,.93,.93);case K.a.Ree:return new be.a(49,31,.8,.93);case K.a.ife:return new be.a(67,32,1.33,.8);case K.a.hfe:return new be.a(68,33,1.33,.8);case K.a.jfe:return new be.a(69,34,.8,1.33);case K.a.ffe:return new be.a(70,46,.8,1.33);case K.a.qhe:return new be.a(47,35,.53,1.07);case K.a.wge:return new be.a(48,36,.53,1.07);case K.a.Dge:return new be.a(36,
37,.53,1.07);case K.a.Xee:return new be.a(37,38,.53,.53);case K.a.Pge:return new be.a(56,39,1,1);case K.a.Afe:return new be.a(58,40,1,1);case K.a.Qfe:return new be.a(55,41,1,1);case K.a.zhe:return new be.a(57,42,1,1);case K.a.Ufe:return new be.a(59,43,.63,1.33);case K.a.Lge:return new be.a(61,44,1.33,1.33);case K.a.Zee:return new be.a(64,45,1.07,1.07);case K.a.Kge:return new be.a(54,47,1.33,1.33);case K.a.Mge:return new be.a(4,10,1,1);case K.a.Wge:return new be.a(25,11,1,1);case K.a.Tge:return new be.a(28,
48,1,1);case K.a.Uge:return new be.a(27,49,1,1);case K.a.Vge:return new be.a(26,50,1,1);case K.a.bhe:return new be.a(29,51,1,1);case K.a.ahe:return new be.a(32,52,1,1);case K.a.che:return new be.a(31,53,1,1);case K.a.dhe:return new be.a(30,54,1,1);case K.a.Nge:return new be.a(116,91,.67,1);case K.a.Xge:return new be.a(117,6,.67,1);case K.a.Bge:return new be.a(118,92,.67,1);case K.a.afe:return new be.a(119,93,.67,1);case K.a.Yfe:return new be.a(104,94,.67,1);case K.a.bge:return new be.a(105,95,.67,
1);case K.a.fge:return new be.a(106,96,.67,1);case K.a.Zfe:return new be.a(107,97,.67,1);case K.a.cge:return new be.a(108,98,.67,1);case K.a.gge:return new be.a(109,99,.67,1);case K.a.$fe:return new be.a(110,100,.67,1);case K.a.dge:return new be.a(111,101,.67,1);case K.a.hge:return new be.a(112,102,.67,1);case K.a.age:return new be.a(113,103,.67,1);case K.a.ege:return new be.a(114,104,.67,1);case K.a.ige:return new be.a(115,105,.67,1);case K.a.Dfe:return new be.a(79,106,1,1);case K.a.Efe:return new be.a(80,
107,1,1);case K.a.khe:return new be.a(15,108,1,1);case K.a.lhe:return new be.a(16,15,1,1);case K.a.mhe:return new be.a(17,109,1,1);case K.a.nhe:return new be.a(18,110,1,1);case K.a.ohe:return new be.a(19,111,1,1);case K.a.fhe:return new be.a(20,112,1,1);case K.a.ghe:return new be.a(21,113,1,1);case K.a.hhe:return new be.a(22,114,1,1);case K.a.ihe:return new be.a(23,115,1,1);case K.a.jhe:return new be.a(24,116,1,1);case K.a.Bhe:return new be.a(122,117,.67,1.33);case K.a.Bfe:return new be.a(121,118,
.67,1.33);case K.a.kfe:return new be.a(124,119,.83,1.33);case K.a.gfe:return new be.a(123,120,.83,1.33);case K.a.Che:return new be.a(126,121,1.25,1.13);case K.a.Mfe:return new be.a(127,122,1.13,1.25);case K.a.Dhe:return new be.a(128,123,1,1);case K.a.yfe:return new be.a(129,124,1,1);case K.a.Ige:return new be.a(131,125,.67,1);case K.a.Oee:return new be.a(158,126,.67,1);case K.a.nfe:return new be.a(132,127,.67,1);case K.a.lfe:return new be.a(133,128,.67,1);case K.a.Gge:return new be.a(134,129,.67,
1);case K.a.Nfe:return new be.a(135,130,.67,.67);case K.a.tfe:return new be.a(136,131,.67,1);case K.a.uge:return new be.a(137,132,.83,1.16);case K.a.uhe:return new be.a(138,133,.33,1);case K.a.Hge:return new be.a(139,134,.67,1.16);case K.a.kge:return new be.a(140,135,.5,1);case K.a.lge:return new be.a(141,136,.67,1);case K.a.cfe:return new be.a(142,137,.5,.5);case K.a.yge:return new be.a(159,138,.67,.67);case K.a.Wee:return new be.a(143,139,.88,1);case K.a.Jge:return new be.a(144,140,.88,1);case K.a.rhe:return new be.a(145,
141,.67,.67);case K.a.zge:return new be.a(146,142,.67,.67);case K.a.bfe:return new be.a(147,143,1,.5);case K.a.ehe:return new be.a(148,144,1,.5);case K.a.Ffe:return new be.a(149,145,.75,.75);case K.a.sge:return new be.a(150,146,.75,.75);case K.a.phe:return new be.a(152,147,.67,1);case K.a.ofe:return new be.a(157,148,.67,.67);case K.a.Zge:return new be.a(153,149,.67,.67);case K.a.jge:return new be.a(154,150,.67,1);case K.a.rfe:return new be.a(155,151,.75,1);case K.a.sfe:return new be.a(156,152,.67,
1);default:return null}}Rrj(a,b,c){b=this.pa.tg();if(!(b&&0<b.length&&Cq.a.g7k(b)))return 16;if(1===c)return 32;c=this.ua.Ba;if(!c)return 16;if(!this.Wj.OF(c,b.length))return this.Wj.nG(c),16;if(this.fc.$c(c))return 16;this.xGa.D9g(c,c,b,null,a);return 32}Ktc(){try{const a=Db.a.instance.Ja("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){xa.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}Rj.l_b=
110;Rj.k_b=75;Rj.umi=19;Rj.tmi=38;Rj.Wmi=4;Rj.Vmi=4;Rj.nVc="InsertShape";Rj.wul=[K.a.rge,K.a.oge,K.a.pge,K.a.mge,K.a.nge,K.a.qge,K.a.XEa,K.a.Cfe,K.a.whe,K.a.Sge,K.a.Cge,K.a.vhe,K.a.qfe,K.a.Yge,K.a.Lfe,K.a.Kfe,K.a.xge,K.a.mfe,K.a.ufe,K.a.Ege,K.a.Yee,K.a.the,K.a.Hfe,K.a.Ife,K.a.Ofe,K.a.pfe,K.a.dfe,K.a.Fge,K.a.Vee,K.a.efe,K.a.Tee,K.a.vfe,K.a.vge,K.a.Uee,K.a.Gfe,K.a.$ge,K.a.Jfe,K.a.Xfe,K.a.she,K.a.tge,K.a.$ee,K.a.Pee,K.a.xfe,K.a.wfe,K.a.Sfe,K.a.Rge,K.a.Rfe,K.a.Qge,K.a.Mge,K.a.Wge,K.a.Tge,K.a.Uge,K.a.Vge,
K.a.bhe,K.a.ahe,K.a.che,K.a.dhe,K.a.Nge,K.a.Xge,K.a.Bge,K.a.afe,K.a.Yfe,K.a.bge,K.a.fge,K.a.Zfe,K.a.cge,K.a.gge,K.a.age,K.a.ege,K.a.ige,K.a.$fe,K.a.dge,K.a.hge,K.a.Dfe,K.a.Efe,K.a.khe,K.a.lhe,K.a.mhe,K.a.nhe,K.a.ohe,K.a.fhe,K.a.ghe,K.a.hhe,K.a.ihe,K.a.jhe,K.a.Bhe,K.a.Bfe,K.a.kfe,K.a.gfe,K.a.Che,K.a.Mfe,K.a.Dhe,K.a.yfe,K.a.Ige,K.a.Oee,K.a.nfe,K.a.lfe,K.a.Gge,K.a.Nfe,K.a.tfe,K.a.uge,K.a.uhe,K.a.Hge,K.a.kge,K.a.lge,K.a.cfe,K.a.yge,K.a.Wee,K.a.Jge,K.a.rhe,K.a.zge,K.a.bfe,K.a.ehe,K.a.Ffe,K.a.sge,K.a.phe,
K.a.ofe,K.a.Zge,K.a.jge,K.a.rfe,K.a.sfe,K.a.Oge,K.a.zfe,K.a.Pfe,K.a.yhe,K.a.Ahe,K.a.Tfe,K.a.Vfe,K.a.Qee,K.a.xhe,K.a.Wfe,K.a.Ree,K.a.ife,K.a.hfe,K.a.ffe,K.a.jfe,K.a.qhe,K.a.wge,K.a.Dge,K.a.Xee,K.a.Pge,K.a.Afe,K.a.Qfe,K.a.zhe,K.a.Ufe,K.a.Lge,K.a.Zee,K.a.Kge];Rj.Ndd=[K.a.HXc,K.a.IXc,K.a.JXc,K.a.CXc,K.a.BXc,K.a.DXc,K.a.FXc,K.a.EXc,K.a.GXc];Rj.Odd=[K.a.IXc,K.a.JXc,K.a.CXc,K.a.BXc,K.a.DXc,K.a.EXc,K.a.GXc];Rj.Fok=[1,5];Object(m.a)(Rj,"InsertShapeActor",null,[352,106]);class oN{constructor(){this.type="LivePollTaskPaneProps";
this.formsUrl=this.onCloseButtonClicked=null}}Object(m.a)(oN,"LivePollTaskPaneProps",null,[]);class pN{constructor(a,b,c,f,l,x,H,U){this.hM=null;this.cHa=this.Eb=!1;a.loadScript("powerpoint-live-strings").then(()=>{this.cHa=!0;xa.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(ja=>{xa.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+ja.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");
if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!x)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!H)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!U)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.G8j=b;this.H8j=c;this.ia=f;this.ua=x;this.hf=l;this.pa=H;this.Wj=U;this.fIg=Object(F.a)(this,
this.Ltl,"taskPaneMessageHandler")}wb(){this.ia.ya(K.a.wqd,rc.a.application,Object(F.a)(this,this.wqd,"showHideLivePollPane"))}Ee(){}wqd(a,b,c){return b.contextId===rc.a.application&&this.cHa?1===c?32:Kg.a("LivePollPaneToggle",a,()=>{(this.Eb=!this.Eb)?(this.Ql(),xa.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.WK(),xa.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}Ql(){this.vC();const a=Object.assign(new mu.a,{title:ResourceStrings.L_LivePollTaskPane,
hideHeader:!1,width:320,location:2,contentProps:this.hM,onOpen:()=>{},onClose:()=>{this.Eb=!1},isModernPane:!0});mj.UISurfaces.zr().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.fIg,!1);return null}).catch(b=>{xa.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}WK(){mj.UISurfaces.zr().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.fIg);return null}).catch(a=>{xa.a.J(512500511,
833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}vC(){this.hM=Object.assign(new oN,{onCloseButtonClicked:Object(F.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.g$i()})}g$i(){return String.format("{0}{1}{2}",this.G8j,"&auth_upn=",u.AFrameworkApplication.fa.Ga("UserPrincipalName"))}onCloseButtonClicked(){this.WK()}Ltl(a){if("data"in a){var b;({rv:b}=xd.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&
(a=String.format("{0}{1}{2}{3}{4}",this.H8j,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",u.AFrameworkApplication.fa.Ga("UserPrincipalName")),this.Ssj(a)))}}Ssj(a){const b=this.ua.Ba;if(b&&!this.hf.$c(b))if(this.Wj.OF(b,1)){var c=b.Cb;b.cFi(c.sid,c.cid,a,b.Ut());b.A3(this.pa.Wd())}else this.Wj.nG(b)}}Object(m.a)(pN,"LivePollPaneActor",null,[352]);var uR=d(961);class $x{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.mA=f;this.Rva=l;this.ia=a;this.fc=b;this.Ea=c;this.lJ=U;this.Vb=x;this.ua=H;this.Kc=ja;
this.Rb=ya;this.vwa=Va;this.Fb=hb}wb(){this.ia.ya(K.a.lLa,rc.a.application,Object(F.a)(this,this.lLa,"showHideNotes"));this.ia.ra(K.a.kjd,rc.a.application,Object(F.a)(this,this.dMk,"queryNotesPaneState"),96);this.ia.ra(K.a.qid,rc.a.application,Object(F.a)(this,this.v8g,"pageScrollNotesPane"),64);this.ia.ra(K.a.pid,rc.a.application,Object(F.a)(this,this.v8g,"pageScrollNotesPane"),64);this.ia.ya(K.a.OVe,rc.a.application,Object(F.a)(this,this.Pok,"notesResize"))}Ee(){const a=this.Ea.Fc(Qi.a.T2);a.bindAction(y.KeyInputManager.Oa(A.a.SB,
0),K.a.qid);a.bindAction(y.KeyInputManager.Oa(A.a.RB,0),K.a.pid)}lLa(a,b,c,f,l){if(this.Fb&&0!==this.Fb.Fl)return 2;a=this.Vb.Ef;if(!this.ua.Ba||!a||this.fc.UN(a))return 16;if(1===c)return 32;l&&Object(Xa.a)(uR.a,l)?l.erc?this.mA.MYe():this.mA.nzj():(this.mA.Iyk(),this.mA.qZb()&&this.Rva.uo?this.Ea.Cj(Qi.a.T2,!0):this.Ea.Cj(Qi.a.T2,!1));this.lJ.yTa();return 32}dMk(a,b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return 8;l.Mf(this.mA.qZb());return 32}v8g(a,b,c){return 1===c?32:this.mA?(a===K.a.pid?this.mA.xa.scrollTop+=
$x.UBf:a===K.a.qid&&(this.mA.xa.scrollTop-=$x.UBf),32):8}Pok(a,b,c,f,l){xa.a.J(37524685,822,50,"Notes Resize Begin");if(!this.mA||!l||"number"!==typeof l)return xa.a.J(37524687,822,50,"Notes Resize Fail"),8;this.mA.qfa=l;this.Kc.Ic.yrh(1);this.Rb.Oq();this.vwa.oIl();xa.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.mA.Nok?"On":"Off",this.mA.qfa);return 32}}$x.UBf=80;Object(m.a)($x,"NotesActor",null,[352]);class qN{constructor(a,b,c,f){this.ia=a;this.Jfc=b;this.la=
c;this.WFg=0;this.KO=f}Ee(){}wb(){this.ia.ra(K.a.ndh,de.a.frame,Object(F.a)(this,this.eMk,"queryOfflineStatusHandler"),2144)}eMk(a,b,c,f,l){if(1===c)return 32;switch(this.Jfc.status){case 0:1===this.WFg&&(l[wp.a.Value]=CommonUIStrings.L_Connected,l[im.a.labelText]=CommonUIStrings.L_Connected,l[wp.a.Visible]=!0,this.hideIcon(),gm.a.instance.Db(new af.a(2,1,this.la.offlineLabelTimeoutInMs,()=>{this.oll();this.KO.b6("GetOfflineStatus",!1);this.KO.HH()},90,"108")));break;case 2:l[wp.a.Value]=CommonUIStrings.L_Disconnected;
l[im.a.labelText]=CommonUIStrings.L_Disconnected;l[wp.a.Visible]=!0;break;case 1:l[wp.a.Value]=CommonUIStrings.L_Reconnecting,l[im.a.labelText]=CommonUIStrings.L_Reconnecting,l[wp.a.Visible]=!0}this.WFg=this.Jfc.status;return 32}hideIcon(){this.fqh(Ri.a.hidden)}oll(){this.fqh(Ri.a.visible)}fqh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(m.a)(qN,"OfflineStatusLabelActor",null,[352]);class rN{constructor(a,b,c,f,l,x,H,U){this.iEg=!1;this.zre=
null;this.ia=a;this.hf=b;this.lJ=c;this.Ea=c.Mo;this.Jb=f;this.pa=l;this.Fa=x;this.jq=H;this.j0=U}wb(){this.ia.ra(K.a.bringForward,rc.a.application,Object(F.a)(this,this.wVc,"handleOrganizeAction"),4);this.ia.ra(K.a.bringToFront,rc.a.application,Object(F.a)(this,this.wVc,"handleOrganizeAction"),4);this.ia.ra(K.a.sendBackward,rc.a.application,Object(F.a)(this,this.wVc,"handleOrganizeAction"),4);this.ia.ra(K.a.sendToBack,rc.a.application,Object(F.a)(this,this.wVc,"handleOrganizeAction"),4);this.ia.ra(K.a.Tzf,
rc.a.application,Object(F.a)(this,this.q$f,"handleFrontBackFlyout"),4);this.ia.ra(K.a.Soh,rc.a.application,Object(F.a)(this,this.q$f,"handleFrontBackFlyout"),4);u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ud.a("DelayRegisterArrangeShapesAction")?this.zre=()=>{this.ia.ra(K.a.Srb,rc.a.application,Object(F.a)(this,this.Q$f,"handleOrganizeShapeAnchor"),4)}:this.ia.ra(K.a.Srb,rc.a.application,Object(F.a)(this,this.Q$f,"handleOrganizeShapeAnchor"),
4)}Ee(){const a=this.lJ.Mo.Fc(zb.a.sg);a.bindAction(y.KeyInputManager.Oa(A.a.Nuc,y.KeyInputManager.Oe),K.a.bringForward);a.bindAction(y.KeyInputManager.Oa(A.a.Nuc,y.KeyInputManager.Oe|4),K.a.bringToFront);a.bindAction(y.KeyInputManager.Oa(A.a.Luc,y.KeyInputManager.Oe),K.a.sendBackward);a.bindAction(y.KeyInputManager.Oa(A.a.Luc,y.KeyInputManager.Oe|4),K.a.sendToBack)}q$f(a,b,c){return 1===c?this.pa.V3()?32:8:32}Q$f(){return this.iEg?32:this.pa.V3()?32:16}wVc(a,b,c){b=this.jq.presentation;if(!b)throw Error.argumentNull("Presentation is null");
let f=this.pa.tg();var l=this.Fa.D9a(f);l&&(this.pa.Kld(l),f=this.pa.tg());if(!this.pa.V3()||this.hf.AC(f))return 16;if(1===c)return 32;switch(a){case K.a.bringForward:c=1;break;case K.a.bringToFront:c=0;break;case K.a.sendBackward:c=3;break;case K.a.sendToBack:c=2;break;default:return 8}Tc.a.Ib&&(Tc.a.Ib.Ur=!1,Tc.a.Ib.Nj=!0);1===f.length?xa.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&xa.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",
f.length);l=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{l.nc(f[0]);l.jd=a;const x=Object(oa.a)(116,b.xC(f[0].slideId));this.mAk(x,f,c)}finally{l&&l.dispose()}return 32}Umk(a,b){const c=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{const f=this.jq.Ba,l=f.wC(a),x=f.wC(b);c.nc(l);this.Vmk(f,l.id,x.id)}finally{c&&c.dispose()}}idl(){this.iEg=!0;Ud.a("DelayRegisterArrangeShapesAction")&&this.zre&&this.zre()}mAk(a,b,c){a&&b&&0<b.length&&xa.a.J(51164099,815,50,"OrganizeShapes has invalid params");
let f=cb.a.clone(a.eb($a.a.SA));const l=[];let x=null;cb.a.upa(b,H=>!H.Ng).length||(x=this.Fa.ys(b[0]))&&(f=cb.a.clone(x.eb($a.a.SA)));for(const H of b)l.push(H.id);a.Q3b(c,f,l)&&(x&&x.anchor?x.anchor.Skb(f,1,!1):a.anchor?a.anchor.Skb(f,1,!1):xa.a.J(51164101,815,50,"slideNode/groupNode should have valid anchor"))}lAk(a,b,c){var f=this.pa.Wd(),l=this.P8i(f,b);a.reverse();b=new Ka.a;f=[];let x=-1,H=!1;for(let ja=0;ja<a.length;ja++){let ya=!1;for(var U of l)if(U.equals(a[ja])){b.add(U);ya=H=!0;break}ya||
f.push(a[ja]);c.equals(a[ja])&&(x=ja)}if(H)if(-1===x)xa.a.J(593514880,815,10,"Invalid param endShapeId"),H=!1;else{c=0;U=a.length;for(l=0;c<x;)a[c++]=f[l++];for(let ja of b)a[c++]=ja;for(;c<U;)a[c++]=f[l++]}a.reverse();return H}P8i(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}Vmk(a,b,c){if(a){var f=cb.a.clone(a.eb($a.a.SA));var l=this.j0.qda(b);var x=this.j0.qda(c);l=this.Fa.ys(l);x=this.Fa.ys(x);l?x===l&&(f=cb.a.clone(l.eb($a.a.SA))):x&&(c=
x.id);this.lAk(f,b,c)&&(xa.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.Skb(f,1,!1):xa.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.Skb(f,1,!1):xa.a.J(51385987,815,10,"slideNode should have valid anchor"))}else xa.a.J(51385955,815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(m.a)(rN,"OrganizeShapesActor",null,[352]);class sN extends Ls.a{constructor(a,b,c,f,l,x,H,U,ja){super();this.Jad=0;this.Qf=f;this.Cc=U;this.Ftg=
ja;this.init(a);this.Pl("PPTClipboardActionOperation");(a=Object(oa.a)(10,H))||(a=new J.DictionaryPropertySet);a.setValue(Wl.a.Wb,ja);this.OEa(b,c,l,x,a)}WWc(){this.Ejb(this.Qf)}p7a(a){this.Dp=a;this.Jad=1}run(){if(0===this.Jad){if(1===this.Qna())return;this.Jad=1}1===this.Jad&&this.GY();this.Cc.UJj(this.Ftg)&&this.Cc.Hg(!0,this.Ftg)}}Object(m.a)(sN,"PPTClipboardActionOperation",Ls.a,[1220,359,360]);var tN=d(372),NE=d(537);class ru{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,
Te,Ze,Vf,gg,Qg,Rg,Wf,rg){this.ia=a;this.pa=b;this.Ea=c;this.lA=f;this.Xdb=l;this.Jb=x;this.ozg=H;this.Qb=U;this.Sea=ja;this.YDb=ya;this.Fa=Va;this.wGa=hb;this.ZL=yb;this.f7c=Zb;this.bXa=fc;this.w6j=Kc;this.Qec=Lc;this.yc=Gc;this.Sp=ae;this.Ks=we;this.VQ=$d;this.Rb=Te;this.Vb=Ze;this.pO=Vf;this.OWa=gg;this.nU=Qg;if(Ud.a("RulerIndentBugFix")){if(!Rg)throw Error.argumentNull("paragraphIndentationReader");if(!Wf)throw Error.argumentNull("paragraphEditor");}this.m$=Rg;this.Uva=Wf;this.JXa=rg}wb(){this.ia.ra(K.a.HJe,
rc.a.application,Object(F.a)(this,this.suj,"handlePopulateFontColorDropdown"),101);this.ia.ra(K.a.B8g,rc.a.application,Object(F.a)(this,this.uuj,"handlePopulateFontSizeDropdown"),100);this.ia.ra(K.a.fja,rc.a.application,Object(F.a)(this,this.nrj,"handleCommitShapeText"),4);this.ia.ra(K.a.Yid,rc.a.application,Object(F.a)(this,this.ldh,"queryListCommonLevel"),96);this.ia.ra(K.a.ljd,rc.a.application,Object(F.a)(this,this.ldh,"queryListCommonLevel"),96);this.ia.ra(K.a.fnc,rc.a.application,Object(F.a)(this,
this.Fdh,"queryTextListMarkerGallery"),96);this.ia.ra(K.a.gnc,rc.a.application,Object(F.a)(this,this.Fdh,"queryTextListMarkerGallery"),96);this.ia.ra(K.a.emc,rc.a.application,Object(F.a)(this,this.W$f,"handlePopulateListMarkerDropdown"),100);this.ia.ra(K.a.fmc,rc.a.application,Object(F.a)(this,this.W$f,"handlePopulateListMarkerDropdown"),100);this.ia.ra(K.a.Hne,Cb.a.view,Object(F.a)(this,this.jtj,"handleLineSpacingMenuOpen"),68);this.ia.ra(K.a.tZg,rc.a.application,Object(F.a)(this,this.stj,"handleMoreFontColors"),
96);this.ia.ra(K.a.cmc,rc.a.application,Object(F.a)(this,this.ttj,"handleMoreFontColorsResponse"),96);this.ia.ya(K.a.QZa,Cb.a.paragraph,Object(F.a)(this,this.QZa,"queryLineSpacing"));this.ia.ya(K.a.QZa,Cb.a.view,this.Sea);this.ia.je(K.a.QZa,96);this.ia.ya(K.a.Kna,Cb.a.paragraph,Object(F.a)(this,this.w1,"setLineSpacing"));this.ia.ya(K.a.Kna,Cb.a.view,this.Sea);this.ia.je(K.a.Kna,68);this.ia.ya(K.a.IJa,rc.a.application,Object(F.a)(this,this.IJa,"populateLineSpacingFlyout"));this.ia.ya(K.a.A8g,rc.a.application,
Object(F.a)(this,this.Rtj,"handlePandoraEscapeKeyPressed"));this.ia.ya(K.a.Vjb,Cb.a.paragraph,Object(F.a)(this,this.zxf,"applySpacingToParagraph"));this.ia.ya(K.a.Vjb,Cb.a.view,this.Sea);this.ia.je(K.a.Vjb,4);this.ia.ya(K.a.Ujb,Cb.a.paragraph,Object(F.a)(this,this.zxf,"applySpacingToParagraph"));this.ia.ya(K.a.Ujb,Cb.a.view,this.Sea);this.ia.je(K.a.Ujb,4);this.ia.ya(K.a.Cka,Cb.a.paragraph,Object(F.a)(this,this.Mrb,"applyIndentationToParagraph"));this.ia.ya(K.a.Cka,Cb.a.view,this.Sea);this.ia.je(K.a.Cka,
4);this.ia.ya(K.a.eMb,Cb.a.paragraph,Object(F.a)(this,this.Mrb,"applyIndentationToParagraph"));this.ia.ya(K.a.eMb,Cb.a.view,this.Sea);this.ia.je(K.a.eMb,4);this.ia.ya(K.a.gMb,Cb.a.paragraph,Object(F.a)(this,this.Mrb,"applyIndentationToParagraph"));this.ia.ya(K.a.gMb,Cb.a.view,this.Sea);this.ia.je(K.a.gMb,4);this.ia.ya(K.a.iMb,Cb.a.paragraph,Object(F.a)(this,this.Mrb,"applyIndentationToParagraph"));this.ia.ya(K.a.iMb,Cb.a.view,this.Sea);this.ia.je(K.a.iMb,4);this.JXa&&(this.ia.ya(K.a.fMb,Cb.a.paragraph,
Object(F.a)(this,this.Mrb,"applyIndentationToParagraph")),this.ia.ya(K.a.fMb,Cb.a.view,this.Sea),this.ia.je(K.a.fMb,4),this.ia.ya(K.a.hMb,Cb.a.paragraph,Object(F.a)(this,this.Mrb,"applyIndentationToParagraph")),this.ia.ya(K.a.hMb,Cb.a.view,this.Sea),this.ia.je(K.a.hMb,4));this.ia.ra(K.a.pah,rc.a.application,Object(F.a)(this,this.Buj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.ra(K.a.vid,rc.a.application,Object(F.a)(this,this.Cuj,"handlePowerPointTextAnchoringAnchor"),4);this.ia.ya(K.a.$0,Cb.a.view,
this.YDb);this.ia.ya(K.a.Z0,Cb.a.view,this.YDb);this.ia.ya(K.a.Y0,Cb.a.view,this.YDb);this.ia.ya(K.a.$0,Cb.a.outline,Object(F.a)(this,this.qbe,"handlePowerPointTextAnchoring"));this.ia.ya(K.a.Z0,Cb.a.outline,Object(F.a)(this,this.qbe,"handlePowerPointTextAnchoring"));this.ia.ya(K.a.Y0,Cb.a.outline,Object(F.a)(this,this.qbe,"handlePowerPointTextAnchoring"));this.ia.je(K.a.$0,4);this.ia.je(K.a.Z0,4);this.ia.je(K.a.Y0,4);this.ia.ya(K.a.JJb,Cb.a.view,this.YDb);this.ia.ya(K.a.JJb,Cb.a.outline,Object(F.a)(this,
this.HOe,"queryTextAnchoring"));this.ia.je(K.a.JJb,96);this.ia.ya(K.a.IJb,Cb.a.view,this.YDb);this.ia.ya(K.a.IJb,Cb.a.outline,Object(F.a)(this,this.HOe,"queryTextAnchoring"));this.ia.je(K.a.IJb,96);this.ia.ya(K.a.HJb,Cb.a.view,this.YDb);this.ia.ya(K.a.HJb,Cb.a.outline,Object(F.a)(this,this.HOe,"queryTextAnchoring"));this.ia.je(K.a.HJb,96);this.Sp&&(this.ia.ra(D.a.HQc,Cb.a.view,Object(F.a)(this,this.psj,"handleFormatPainterPick"),4),this.ia.ra(K.a.F4d,Cb.a.view,Object(F.a)(this,this.oqj,"handleApplyFormatToText"),
4),this.ia.ra(D.a.Sja,Cb.a.view,Object(F.a)(this,this.osj,"handleFormatPainterCancel"),4),this.VQ.K8h(()=>{this.pO.jVa=this.VQ.wL;this.Rb.updateCommandUI()}))}Ee(){var a=this.Ea.Fc(zb.a.lQ);const b=this.Ea.Fc(Qi.a.T2),c=this.Ea.Fc(zb.a.MR),f=y.KeyInputManager.Oa(A.a.T1,0);a.bindAction(y.KeyInputManager.Oa(A.a.ovc,0),K.a.fja);a.bindAction(f,K.a.A8g);c.bindAction(f,K.a.fja);b.bindAction(y.KeyInputManager.Oa(A.a.kwd,2),G.a.ve);a.bindAction(y.KeyInputManager.Oa(A.a.kwd,2),G.a.ve);this.bXa&&(a.bindAction(y.KeyInputManager.Oa(A.a.Mga,
5),K.a.oC),a.bindAction(y.KeyInputManager.Oa(A.a.dba,5),K.a.By));this.Sp&&(a=this.Ea.Fc(Qi.a.PD),a.zp(f),a.bindAction(f,D.a.Sja))}psj(a,b,c){a=this.pa.Jp();b=!1;let f=null,l=this.pa.Na.mb;const x=!!this.pa.Na&&this.pa.Na.Hl;x&&(l=this.pa.Na.ga(0));l&&(f=l.Ua);if(f){switch(f.contextId){case Cb.a.textRange:case Cb.a.paragraph:case Cb.a.endOfParagraph:case Cb.a.Pf:b=!0}b&&nb.SelectionEditor.gk(f)&&gf.b(f)&&(b=!1);f.contextId===Cb.a.outline&&a.ud&&(b=!0);a&&!a.ozh&&(b=!1)}if(1===c||!b)return b?32:8;6!==
this.ia.xq?(this.VQ.wL?xa.a.J(40703699,820,50,"User deactivated the Format Painter button"):(xa.a.J(40703697,820,50,"User activated the Format Painter button"),this.r$g(l,x,a)),this.VQ.wL=!this.VQ.wL):(xa.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.r$g(l,x,a));return 32}r$g(a,b,c){this.VQ.s$g(a);var f=a.Ua;const l=Object(oa.a)(Mb.AParagraphNode,f.node);var x=Object(oa.a)(799,this.Rb.Kd);let H=null;if(l&&x&&(H=x.xi)){x=this.Jb.me(4);const ja=H.zi;x.nc(H);var U=this.Qb.Nc(l);
U.rc(8);const ya=this.yc.Cs(U);let Va=f.Qa,hb=f.Mb-f.Qa;a=!a.Cca&&a.Ye.contextId!==Cb.a.endOfParagraph;b?(Va=0,hb=Sb.ParagraphReader.textLength(l)+1):({selectionStart:Va,xoh:hb}=this.wCf(f,l,U,Va,hb,null,!1),a&&f.contextId===Cb.a.textRange&&hb++);b=this.nU.nEa(ja);f=null;ya&&(U.Jg(16),f=Object(oa.a)(123,U.currentNode));U.IB(8);U=Object(oa.a)(116,U.currentNode);this.nU.e5e(b,!0,l.sa(kb.a.vFa,!1),U,c,f,null,Va,hb);(c=ja.Jmc(b))&&H.WAb(c);x.dispose()}}wCf(a,b,c,f,l,x,H){switch(a.contextId){case Cb.a.Pf:l=
null;H&&(l=this.OWa.j6b(a))?(l=l.Ua,f=l.Qa,l=l.Mb-l.Qa):(f=0<f?f-1:0,l=1);break;case Cb.a.paragraph:f=0;l=Sb.ParagraphReader.textLength(b)+1;break;case Cb.a.endOfParagraph:f=Sb.ParagraphReader.textLength(b),l=1}for(c.IB(11);c.Jta();)c.Bb(2),(a=Object(oa.a)(Mb.AParagraphNode,c.currentNode))&&(f+=Sb.ParagraphReader.textLength(a)+1),c.IB(11);if(H)for(c=1;c<x.length;c++)if((H=Object(oa.a)(Wd.a,x.ga(c)))&&Sb.ParagraphReader.$d(H.node))switch(H.contextId){case Cb.a.textRange:l+=H.Mb-H.Qa;break;case Cb.a.Pf:l+=
1;break;case Cb.a.paragraph:l+=Sb.ParagraphReader.textLength(H.node)+1;break;case Cb.a.endOfParagraph:l+=1}return{selectionStart:f,xoh:l}}oqj(a){if(6===this.ia.xq||this.VQ.wL){xa.a.J(40703703,820,50,"User applied the Format Painter from command location: {0}",this.ia.xq);const H=this.pa.Jp();if(H&&!ru.lUj(H))return 2;var b=this.pa.Na.mb;if(b&&b.Ua){var c=b.Ua;const U=Object(oa.a)(Mb.AParagraphNode,c.node);var f=Object(oa.a)(799,this.Rb.Kd),l=null;if(U&&f&&(l=f.xi)){f=this.Jb.me(15);f.nc(l);f.jd=a;
const ja=this.pa.Na.Hl;a=U.sa(kb.a.vFa,!1);if(ja)for(var x of this.pa.Na)this.VQ.oxf(x);else this.VQ.oxf(b);Tc.a.Ib&&(Tc.a.Ib.Nj=!1,Tc.a.Ib.actionName="FormatPainterApplyToText",Tc.a.Ib.sF=new Date);const ya=this.Qb.Nc(U);ya.rc(8);x=c.Qa;let Va=c.Mb-c.Qa;ja?x=Va=-1:{selectionStart:x,xoh:Va}=this.wCf(c,U,ya,x,Va,b,!0);ya.Jg(8);b=Object(oa.a)(116,ya.currentNode);c=this.pa.xv();l=this.nU.nEa(l.zi);this.nU.e5e(l,!1,a,b,H,null,c,x,Va);6!==this.ia.xq&&(this.VQ.wL=!1);f.dispose()}}}return 32}Rtj(a,b,c,f,
l){this.Sp&&this.ia.La(D.a.Sja,c,l);Ud.a("PandoraEscapeKeyPressed")&&this.ia.La(K.a.fja,c,l);return 32}osj(){this.pO.jVa&&(this.VQ.wL=!1);return 32}Buj(){return this.qRf()}Cuj(){return this.qRf()}qbe(a,b,c){let f=!1;b=this.ozg.$ij(b);var l=this.pa.Zm();if(b&&b.tAb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case K.a.$0:c=0;break;case K.a.Z0:c=1;break;case K.a.Y0:c=2;break;default:return 8}if(l)this.pa.gH()?this.Ks.R9k(l,c):(b=this.Jb.me(15),b.nc(l),b.jd=a,this.Ks.Q9k(this.pa.Na,c),b.dispose());
else{l=this.Jb.me(15);try{l.nc(b),l.jd=a,b.setValue(kb.a.kP,c)}finally{l&&l.dispose()}}return 32}HOe(a,b,c,f,l){c=!1;b=this.ozg.j2f(b);f=this.pa.Na;let x=0;const H=this.pa.Zm();if(b.Sa(kb.a.kP)||H){switch(a){case K.a.JJb:c=H?({txa:x}=this.yc.Dtd(f)).returnValue&&0===x:0===b.eb(kb.a.kP);break;case K.a.IJb:c=H?({txa:x}=this.yc.Dtd(f)).returnValue&&1===x:1===b.eb(kb.a.kP);break;case K.a.HJb:c=H?({txa:x}=this.yc.Dtd(f)).returnValue&&2===x:2===b.eb(kb.a.kP)}l.Mf(c);return 32}return 8}ldh(a,b,c,f,l){if(this.pa.Bs())return l.Mf(!1),
32;b=this.wGa.LA(this.pa.Pj);c=!0;for(const x of b)if((b=x.al?x.node:null)?(c=this.Qb.Nc(b),c.set(b),c.rc(11),c.Jg(11),c=(b=this.lA.jw(c))?a===K.a.Yid?1===b.listType:a===K.a.ljd?0===b.listType:!1:!1):c=!1,!c)break;l.Mf(c);return 32}Fdh(a,b,c,f,l){b=l.VZa;l=l.menuItemId;if(this.pa.Bs())return b.Mf(!1),32;f=this.wGa.LA(this.pa.Pj);c=!0;for(const H of f){if(f=H.al?H.node:null){var x=this.Qb.Nc(f);x.set(f);x.rc(11);x.Jg(11);if(f=this.lA.jw(x)){if(0===l){c=!1;break}a===K.a.fnc?(c=this.ZL.zVa.ga(l).ZZb,
x=this.ZL.zVa.ga(l).wsb,c=f.Sxb&&0<f.v9.length&&f.v9[0]===c&&f.H$a&&f.font===x):a===K.a.gnc?(c=this.ZL.Ydd.ga(l).bSd,c=!!f.propertySet&&f.propertySet.Sa(kb.a.autonumberBulletType)&&f.propertySet.eb(kb.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Mf(c);return 32}uuj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}stj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.renderColorPicker,1,l);u.AFrameworkApplication.Ta.La(D.a.bJb,2,l);a=new Ib.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=K.a.cmc;b.hideAlphaSlider=!0;return this.ia.La(K.a.renderColorPicker,2,b)}ttj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.Sr,c,l);if(!l)return xa.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=qu.a.parse(l.Color))return a=this.ia.La(K.a.Sr,
c,"@"+a.RGBColor),32===a&&this.ia.La(K.a.QBa,c,l),a;xa.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}suj(a,b,c,f,l){if(1===c)return 32;a=(a=this.pa.tk())?a.ke:null;b=K.a.Exa;var x=K.a.cmc;c=this.Vb.Ef.c8;if(!l.MenuId||0>ha.a.qg(l.MenuId).indexOf("floatie")){f=b.toString();x=x.toString();b=Object.assign(new tm.a,{Id:"menuFontColor",MenuSectionList:[]});const H=Ud.a("ColorPickerHighlighterFix")?NE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
al.e(a,H,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.Qec));Array.add(b.MenuSectionList,al.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,al.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",x,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,al.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(Ud.a("ColorPickerHighlighterFix")&&(c=new ct,32===u.AFrameworkApplication.Ta.La(D.a.bJb,2,c)&&c&&!c.E4b))if(c=c.fontColor,-1===c)al.h(b,null,a);else if(c=Ol.i(c)||"",c=qu.a.parse(c))c=pe.Box4ColorHelper.UDa(c.YLa(),a),al.h(b,c,a);l.MenuItems=b}else a=
this.w6j.T_f(a,!this.Qec),l.PopulationXML=a.Dli(b,c,K.a.cmc);return 32}nrj(a,b,c){if(!this.pa.Xz())return 16;if(1===c)return 32;a=this.pa.Wd();if(!a||1!==a.length)return 16;this.pa.selectShape(a[0],!0);this.Ea.Ed();return 32}jtj(){return 32}IJa(a,b,c,f,l){if(1===c)return 32;a=new tm.a;a.MenuSectionList=[];b=Object.assign(new hk.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new bz.a,{Id:"buttonLineSpacing"+ru.Ine[c].replace(".","_"),LabelText:ru.Ine[c].substring(0,3),ExternalId:"LineSpacingButton"+
ru.Ine[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}W$f(a,b,c,f,l){if(1===c)return 32;a=a===K.a.emc?1:a===K.a.fmc?0:14;Tc.a.Ib&&(1===a?Tc.a.Ib.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Tc.a.Ib.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>ha.a.qg(l.MenuId).indexOf("floatie")?l.MenuItems=this.rwi(a):l.PopulationXML=this.swi(a);return 32}QZa(a,b,c,f,l){var x=l.MenuItemId;a=l.queryResult;c=
l.LineSpacingValue;f=l.LineSpacingUnit;let H=!1;b=this.Xdb.LW(b.node);x=bf.a.$y(b.lineSpacing.value,x)&&2===b.lineSpacing.unit;if(-1===c)f=b.lineSpacing.unit,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.unit)c=f=0;0!==f&&(H=x);a.Mf(H);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}w1(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return xa.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Jb.me(15);b=b.node;c.nc(b);c.jd=
a;b.setValue(kb.a.jX,2);a=l;this.f7c&&(a+=this.Fa.w5d(this.Fa.$m(b)));b.setValue(kb.a.ux,a);c.dispose();return 32}zxf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new tN.a(l.unit,l.value);l=c.unit;c=c.value;switch(a){case K.a.Vjb:b.setValue(kb.a.aea,c);b.setValue(kb.a.qla,l);break;case K.a.Ujb:b.setValue(kb.a.$da,c),b.setValue(kb.a.pla,l)}return 32}Mrb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new kv.a(l.unit,l.value)).UM;c=this.m$.K8(b).UM;f=this.m$.mTa(b);switch(a){case K.a.Cka:b.setValue(ab.a.$l,
l);break;case K.a.eMb:b.setValue(ab.a.eo,l);break;case K.a.gMb:b.setValue(ab.a.eo,-l);break;case K.a.iMb:b.setValue(ab.a.eo,0);break;case K.a.fMb:this.JXa&&b.setValue(ab.a.eo,l-c);break;case K.a.hMb:this.JXa&&(this.Uva.Av.Hjb(b,(1===f.specialIndentType?c+f.UM:c-f.UM)-l),this.Uva.Av.Jod(b,1,l))}return 32}swi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=K.a.Ona;l=K.a.YJa;break;case 0:c="NumberingLibrary_";f=K.a.LJa;l=K.a.$hb;break;default:c="BulletsLibrary_",f=K.a.Ona,l=K.a.YJa}for(let x=0;8>x;++x)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+x,f,l,ha.a.ue(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.b8d(a,x),this.a8d(a,x))),this.q3f(a,x),x));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}rwi(a){const b=Object.assign(new tm.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.Usf(a));return b}Usf(a){var b="",c="";let f="",l=K.a.Ona,x=K.a.YJa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=K.a.Ona;x=K.a.YJa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=K.a.LJa,x=K.a.$hb,c="NumberingLibrarySection"}b=Object.assign(new hk.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new sq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.p7d(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let H=0;8>H;++H)c.GalleryItems.push(this.o7d(a,H,f+H,l.toString(),x.toString(),this.q3f(a,H)));Array.add(b.ControlList,c);return b}p7d(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}o7d(a,b,c,f,l,x){a=
Object.assign(new xz,{LevelInfo:this.ybj(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=x;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}ybj(a,b){const c=[],f={};f.fontFamily=da.FontUtils.jja("Calibri");if(!b)return Object.assign(new Xk,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=da.FontUtils.jja(this.s3f(a,b));1===a?(a=this.ZL.L1c.ga(b).RAf,c.push(Object.assign(new Xk,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Xk,{textAtLevel:a,styleAtLevel:f})),
c.push(Object.assign(new Xk,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.ZL.L1c.ga(b).D0g,c.push(Object.assign(new Xk,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Xk,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Xk,{textAtLevel:a[2],styleAtLevel:f})));return c}q3f(a,b){return 1===a?this.ZL.vpg.ga(this.ZL.L6b(b)):0===a?this.ZL.vpg.ga(this.ZL.BUc(b)):""}a8d(a,b){return b?1===a?(a=this.ZL.L1c.ga(b).RAf,this.RJa([a,a,a])):0===a?(a=this.ZL.L1c.ga(b).D0g,this.RJa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}RJa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.lEa(a[0]),this.lEa(a[1]),this.lEa(a[2])):""}lEa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}b8d(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(da.FontUtils.jja(this.s3f(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}s3f(a,b){return 1===a?this.ZL.zVa.ga(this.ZL.L6b(b)).wsb:0===a?"Calibri":""}qRf(){let a=16;if(this.pa.k9())return 16;const b=this.pa.Jp(),c=this.pa.Zm();if(b&&b.tAb||c)a=32;return a}static lUj(a){return!!a&&(a.nzh||a.ud)}}ru.Ine=["1.00","1.50","2.00","2.50","3.00"];Object(m.a)(ru,"PandoraActor",null,[352]);var vR=d(748);class su{constructor(a,b){this.nCd=
this.n3a=null;this.Ca=a;this.zAa=b;if(this.qve=u.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.nCd=vR.a.create();this.vS=Db.a.instance.Ja("Common.ISystemInitiatedFeedback")}get EQ(){return this.n3a}wb(){this.Ca.ra(G.a.close,de.a.frame,Object(F.a)(this,this.closeDocument,"closeDocument"),2176);this.Ca.ra(G.a.Y3b,de.a.frame,Object(F.a)(this,this.Y3b,"fileProperties"),128);this.Ca.ya(G.a.Tsa,de.a.frame,Object(F.a)(this,this.Tsa,"fileSharing"));this.Ca.ra(G.a.copyAndEdit,de.a.frame,
Object(F.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.ra(G.a.wKb,de.a.frame,Object(F.a)(this,this.wKb,"replyWithChanges"),128);this.Ca.ra(G.a.mrc,de.a.frame,Object(F.a)(this,this.UWi,"fileVersion"),128);this.Ca.ya(G.a.downloadACopy,de.a.frame,Object(F.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.ya(G.a.KOi,de.a.frame,ld.ActionManager.Mg);this.Ca.ra(G.a.RRe,de.a.frame,Object(F.a)(this,this.RRe,"reportAbuseLink"),128);this.Ca.ra(G.a.Rqd,de.a.frame,Object(F.a)(this,this.Brc,"signInInternal"),
128);this.Ca.ya(G.a.workflow,de.a.frame,Object(F.a)(this,this.workflow,"workflow"));u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.ra(G.a.Xid,de.a.frame,Object(F.a)(this,this.Xid,"queryBreadcrumbDocName"),96);this.Ca.ra(G.a.mNe,de.a.frame,Object(F.a)(this,this.mNe,"queryCopyAndEditButton"),96);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.ra(G.a.jNe,de.a.frame,Object(F.a)(this,this.jNe,"queryBuildVersion"),2144),this.Ca.ra(G.a.$Ne,
de.a.frame,Object(F.a)(this,this.$Ne,"querySessionId"),2144));this.Ca.ya(G.a.S0b,de.a.frame,Object(F.a)(this,this.S0b,"conversation"));this.zAa.execute(Object(F.a)(this,this.Zjc,"onHostPostmessengerCreated"));ia.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}Zjc(a){this.n3a=a;this.qve&&(this.nCd.instance=a);ia.ULS.sendTraceTag(536987589,306,this.EQ?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.EQ))}closeDocument(a,
b,c,f,l){a=2===c;c=zh.h;l&&(c=l);return b&&a&&!this.ZHc(c)?8:this.wui(a,c)}ZHc(){return!0}wui(a,b){if(u.AFrameworkApplication.Aa.hb.vXe("3033402446"))return ia.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.yoa(a,jf.a.kVf,!0,{});if(u.AFrameworkApplication.Goc&&b&&b===zh.f)return ia.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),u.AFrameworkApplication.Aa.QO(a,u.AFrameworkApplication.Goc);
if(u.AFrameworkApplication.isEmbedded)return a&&ia.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(u.AFrameworkApplication.fGf){if(!a)return 32;ia.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(l){return ia.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=u.AFrameworkApplication.$Jc;if(!c)return a&&ia.ULS.sendTraceTag(6070361,
306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=zh.h);if(b===zh.c||b===zh.h)return u.AFrameworkApplication.Aa.QO(a,c);let f;if(u.AFrameworkApplication.m_a)return a&&ia.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),f=b===zh.d||b===zh.b?this.yoa(a,jf.a.wKb,u.AFrameworkApplication.Euc,{["event_source"]:b}):2,32!==f?(c=b?bg.a.Ki(u.AFrameworkApplication.m_a,zh.e,b):u.AFrameworkApplication.m_a,u.AFrameworkApplication.Aa.QO(a,c)):f;a&&ia.ULS.sendTraceTag(6070363,
306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===zh.b?this.yoa(a,jf.a.kVf,u.AFrameworkApplication.t5e,null):2;return 32!==f?u.AFrameworkApplication.Aa.QO(a,c):f}Brc(a,b,c,f,l){a=this.yoa(2===c,jf.a.Rqd,!0,l);8===a&&(window.top.location=u.AFrameworkApplication.signInUrl,a=32);return a}Y3b(a,b,c){a=this.yoa(2===c,jf.a.Y3b,u.AFrameworkApplication.nIh,null);return 32!==a?u.AFrameworkApplication.Aa.QO(2===c,u.AFrameworkApplication.pVf):a}Tsa(a,b,c,f,l){if(1===c)return zz.SessionStatusManager.instance.uka?
8:32;a=G.a.igl;b=Ug.a.create().toString();f={};f.event_source=l;f[Pj.a.Oqc]=b;var x=l?l.nav:null;x&&(f[Pj.a.lgl]=x);(x=l?l.scenarioId:null)&&(f[Pj.a.mgl]=x);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=G.a.hgl);l&&"ManageAccess"===l.SourceControlId&&(l.mode="manageAccess",a=G.a.jgl);l&&"ShareTopBar"===l.SourceControlId&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1)&&su.Ip.raiseEvent(su.$qi);(x=l?l.mode:null)&&(f[Pj.a.kgl]=x);if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",
!1)){var H=l?l.additionalData:null;H&&(f[Pj.a.Kbi]=H)}2===c&&(H={},H[Pj.a.Oqc]=b,x&&(H.mode=x),ia.ULS.sendTraceTag(38278995,306,50,xd.c(H)));b=this.yoa(2===c,jf.a.wgl,u.AFrameworkApplication.v5e,f);if(32!==b){if(u.AFrameworkApplication.Z3b)return l=l?bg.a.Ki(u.AFrameworkApplication.Z3b,zh.e,l):u.AFrameworkApplication.Z3b,u.AFrameworkApplication.Aa.QO(2===c,l,!0);ia.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}c=
ki.a.B3("PPTIsSimplifiedRibbonOn",!1);ia.ULS.sendTraceTag(509441175,306,15,"ActionName=FileSharing;SimplifiedRibbonMode={0}",c);Gp.c(a);return b}S0b(a,b,c){return this.yoa(2===c,jf.a.S0b,!0,{})}workflow(a,b,c){a=this.yoa(2===c,jf.a.workflow,u.AFrameworkApplication.C5e,{["WorkflowType"]:u.AFrameworkApplication.evc});if(32!==a){if(u.AFrameworkApplication.Qvd)return u.AFrameworkApplication.Aa.QO(2===c,u.AFrameworkApplication.Qvd,!0);ia.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",
{["Result"]:a})}return a}RRe(a,b,c){a=2===c;return b&&a&&!this.ZHc(zh.f)?8:u.AFrameworkApplication.Aa.QO(a,u.AFrameworkApplication.Goc)}copyAndEdit(a,b,c){a={};2===c&&(a=u.AFrameworkApplication.Aa.hb.o0f());a=this.yoa(2===c,jf.a.copyAndEdit,u.AFrameworkApplication.mIh,a);return 32!==a?u.AFrameworkApplication.Aa.QO(2===c,u.AFrameworkApplication.cXd,u.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?u.AFrameworkApplication.iG||u.AFrameworkApplication.KQ||zz.SessionStatusManager.instance.uka?
8:32:u.AFrameworkApplication.Aa.QO(2===c,u.AFrameworkApplication.xRa,!0)}wKb(a,b,c){a=2===c;if(b&&a&&!this.ZHc(zh.d))return 8;b=this.yoa(a,jf.a.wKb,u.AFrameworkApplication.Euc,{["event_source"]:zh.d});return 32!==b?(b=bg.a.Ki(u.AFrameworkApplication.m_a,zh.e,zh.d),u.AFrameworkApplication.Aa.QO(a,b)):b}UWi(a,b,c){a=this.yoa(2===c,jf.a.VWi,u.AFrameworkApplication.w5e,null);return 32!==a?u.AFrameworkApplication.Aa.QO(2===c,u.AFrameworkApplication.i3d):a}Xid(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=
ha.a.XG(u.AFrameworkApplication.Eu.Xw)}return 32}jNe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.WLi}return 32}$Ne(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.XLi}return 32}yoa(a,b,c,f){return this.qve?this.d8k(a,b,c,f):c?a?this.EQ.sendMessage(b,f)?32:8:32:2}d8k(a,b,c,f){return c?a?this.EQ?this.EQ.sendMessage(b,f)?32:8:(ia.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),
this.nCd.execute(()=>{ia.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.EQ.sendMessage(b,f)}),32):32:2}mNe(a,b,c,f,l){if(2===c){if(!l)return 8;u.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}su.Ip=new wc.a;su.$qi="CheckEditorSuggestions";Object(m.a)(su,"WebAppFrameCommandUIActor",null,[]);class uN extends su{constructor(a,b,c,f,l,x,H){super(a,b);this.Ou=c;this.vE=f;this.pa=l;this.Ha=x;this.Xa=
H}wb(){super.wb();this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.ya(K.a.Dah,de.a.frame,Object(F.a)(this,this.ELe,"pptoShowFileVersion"))}ELe(a,b,c){return 1===c&&this.Xa.Oda?2:this.Ca.processAction(G.a.mrc,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.pa.Qh();this.Ou.iZe(!0,ResourceStrings.l_Loading,a);xa.a.J(20187205,801,50,"PPT save and launch workflow");this.vE.u3(!1,!0,()=>{this.Ioi(l)},Object(F.a)(this,this.lya,"saveFailureCallback"));return 32}ZHc(a){return a!==zh.a||u.AFrameworkApplication.isEmbedded||
u.AFrameworkApplication.fGf||u.AFrameworkApplication.$Jc||this.CQj()?!0:(xa.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.La(K.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}CQj(){var a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.eK);a=u.AFrameworkApplication.ubb&&!!a&&"teams"===a.toLowerCase();return Ud.a("ReactDialogsProtocolLaunchingTeamsFix")&&this.Ha.Z0d&&a&&u.AFrameworkApplication.Aa.hb.vXe("3033402446")}Ioi(a){this.Ou.hide();
super.workflow(0,null,2,null,a)}lya(){this.Ou.hide();return!1}}Object(m.a)(uN,"PptWebAppFrameCommandUIActor",su,[]);class vN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Ea=b;this.oc=c}wb(){this.ia.ra(K.a.Gld,rc.a.application,Object(F.a)(this,this.Gld,"replaceFonts"),4)}Ee(){const a=[this.Ea.Fc(Qi.a.PD),this.Ea.Fc(Qi.a.T2),this.Ea.Fc(zb.a.sg),this.Ea.Fc(zb.a.lQ)];
for(const b of a)b.bindAction(y.KeyInputManager.Oa(A.a.YPb,y.KeyInputManager.Oe),K.a.Gld)}Gld(a,b,c){return b.contextId!==rc.a.application?2:1===c?this.oc.pj()?32:8:32}}Object(m.a)(vN,"ReplaceFontsActor",null,[]);class wN extends Sys.EventArgs{constructor(a,b,c){super();this.X0g=a;this.W$=b;this.Hu=c}}Object(m.a)(wN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class xN{constructor(a,b,c,f,l,x,H,U,ja){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("frameContext");
if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");if(!H)throw Error.argumentNull("ribbonExternal");this.Ea=f;this.ia=a;this.lJ=b;this.pB=c;this.wug=l;this.he=x;this.w5j=U;this.VGa=ja}wb(){this.ia.ya(G.a.VSe,de.a.frame,Object(F.a)(this,this.Uwk,"onRibbonFocus"));this.ia.ra(G.a.y3k,de.a.frame,Object(F.a)(this,this.Nvj,"handleRibbonStateChanged"),64);this.ia.ya(G.a.dtd,rc.a.application,Object(F.a)(this,this.dtd,"toggleRibbonState"));this.ia.ya(G.a.Olh,Cb.a.view,
Object(F.a)(this,this.Ovj,"handleRibbonTabSwitched"));this.ia.ya(G.a.wmd,Cb.a.view,Object(F.a)(this,this.wmd,"ribbonModeToggledToMLR"));this.ia.ya(G.a.xmd,Cb.a.view,Object(F.a)(this,this.xmd,"ribbonModeToggledToSLR"));gb.a.get_instance().ek(7,Object(F.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}Ee(){const a=v.FocusManager.instance().Fc(Qi.a.jBf);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.pvc,y.KeyInputManager.Oe),G.a.dtd);E.AFrame.kk(a,y.KeyInputManager.Oa(B.a.vk?A.a.cba:
A.a.pvd,1),G.a.VSe);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.uMa,B.a.vk?2:1),G.a.VSe);this.w5j&&(this.lJ.Abb.Pkd(ta.a.Il,window.document,Object(F.a)(this,this.aBj,"ignoreAltKeyUpOnDocument")),uE.a.instance().tPd(Object(F.a)(this,this.yvk,"onOnlyAltKeyPressed")))}wmd(a,b,c){try{if(1===c)return 32;Ud.a("ReactMLRReuseSLRCookieForMLR")?this.prh(!1):this.gqc(!0);xa.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.VGa&&(this.pB.NQi(),Ud.a("toggleChatPPTPane")&&(this.he.mPe(new Lz(!0)),
this.Itf("ChatPPT-Exit")));this.lJ.yTa()}catch(f){xa.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",f)}return 32}xmd(a,b,c){try{if(1===c)return 32;Ud.a("ReactMLRReuseSLRCookieForMLR")||this.gqc(!1);this.prh(!0);xa.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.VGa&&(this.pB.LOf(),Ud.a("toggleChatPPTPane")&&(this.he.mPe(new Lz(!0)),this.Itf("ChatPPT-Entry")));this.lJ.yTa()}catch(f){xa.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",
f)}return 32}prh(a){ki.a.$J(u.AFrameworkApplication.fa.Ga("IsSimplifiedRibbonOnCookieName"),a.toString(),ki.a.DJ)}gqc(a){ki.a.$J(u.AFrameworkApplication.fa.Ga("ReactRibbonMLRPreferenceCookieName"),a.toString(),ki.a.DJ)}Itf(a){xa.a.J(509616535,811,15,a)}Nvj(a,b,c){if(1===c)return 32;this.lJ.yTa();return 32}dtd(){return 32}Ovj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[Zm.a.Hu]&&(a=l[Zm.a.Hu]),this.he.VOk(new wN(l.OldContextId,l.NewContextId,a)));this.Ea.Ae&&2===l[Zm.a.Hu]&&
this.Ea.Ae.name===zb.a.waa&&(b=b.view)&&!ha.a.Wa(b.DI)&&this.Ea.tf(b.DI);return 32}yvk(){FC.a.instance.keyCode===A.a.sMa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.gag())}aBj(a){return a.qc.keyCode===A.a.sMa}gag(){if(document.activeElement&&document.activeElement.id!==Mf.a.g0b)return this.Ea.kCh(!this.wug.inKeytipMode,!1),32;this.Ea.Ae&&this.Ea.kCh(this.Ea.Ae.name===zb.a.waa||this.wug.inKeytipMode,!0);return 32}Uwk(a,b,c){return 1===c?32:this.gag()}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.Oo&&Pg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)xa.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),this.lJ.yTa()})}}Object(m.a)(xN,"RibbonStateActor",null,[352]);class kA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(m.a)(kA,"SelectSectionAndSlidesData",null,[]);class yN{constructor(a,b,c,f,l,x,H,U,ja,ya){this.MXa=null;if(ja){if(!x)throw Error.argumentNull("SectionActor.workspace");
if(!H)throw Error.argumentNull("SectionActor.presentationReader");if(!U)throw Error.argumentNull("SectionActor.selectionManager");}this.ia=a;this.fA=b;this.ua=c;this.xgc=f;this.Lu=l;this.Vb=x;this.oc=H;this.pa=U;this.d5=ja;this.kn=ya;this.xgc.vF(Object(F.a)(this,this.CB,"onChildTopologyChanged"));this.ua.presentation&&(this.MXa=this.ua.presentation.Tp)}wb(){this.ia.ra(K.a.OQe,Cb.a.application,Object(F.a)(this,this.vvj,"handleRemoveSection"),4);this.ia.ra(K.a.PEe,Cb.a.application,Object(F.a)(this,
this.ytj,"handleMoveSectionUp"),4);this.ia.ra(K.a.OEe,Cb.a.application,Object(F.a)(this,this.xtj,"handleMoveSectionDown"),4);this.ia.ra(K.a.f5e,Cb.a.application,Object(F.a)(this,this.Xwj,"handleUpdateSectionTitle"),4);this.ia.ra(K.a.d6a,Cb.a.application,Object(F.a)(this,this.aqj,"handleAddSection"),4)}Ee(){}Xwj(a,b,c,f,l){if(1===c)return(a=this.ua.presentation)&&a.Tp&&a.Tp.length?32:8;if(!l)return xa.a.J(509368192,822,10,"HandleUpdateSectionTitle with null action data."),8;this.fA.VTi(l);return 32}vvj(a,
b,c){b=this.ua.Tz;const f=this.ua.ica;if(1===c){const l=this.ua.presentation;if(!l||!l.Tp||!l.Tp.length)return 8;if(!b&&1<l.Tp.length)return f&&!f.bK.length?32:8}if(2===c){xa.a.J(509368163,822,50,"HandleRemoveSection called.");try{f&&this.fA.OTi(b,a),this.MXa=this.ua.presentation.Tp,this.ia.La(K.a.Fnd,2,new kA(this.ua.Tz,this.ua.Ba.slideIndex))}catch(l){xa.a.J(509368162,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}ytj(a,b,c){a=this.ua.Tz;if(1===c)return c=this.ua.presentation,
!c||!c.Tp||!c.Tp.length||0>=a?8:32;if(2===c){xa.a.J(509368161,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.fA.rTf(a,!0),this.ia.La(K.a.Fnd,2,new kA(this.ua.Tz,this.ua.Ba.slideIndex)))}catch(f){xa.a.J(509368160,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}xtj(a,b,c){a=this.ua.Tz;if(1===c)return(c=this.ua.presentation)&&c.Tp&&c.Tp.length&&a!==c.Tp.length-1&&-1!==a?32:8;if(2===c){xa.a.J(509368159,822,50,"HandleMoveSectionDown called.");try{-1!==a&&(this.fA.rTf(a,
!1),this.ia.La(K.a.Fnd,2,new kA(this.ua.Tz,this.ua.Ba.slideIndex)))}catch(f){xa.a.J(509368158,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",f)}}return 32}aqj(a,b,c){if(2===c){b=-1;c=this.ua.Tz;xa.a.J(509368157,822,50,"HandleAddSection called.");try{let f;f=this.d5&&0<=this.Vb.Cxa?this.oc.XA(this.Vb.Cxa+1):this.ua.Ba;this.fA.rTi(f,a);b=this.ua.Tz;if(this.d5&&(-1!==this.Vb.Cxa&&(this.Vb.Cxa=-1,this.Vb.Ba=f),this.kn)){const l=this.oc.zSa(b).map(H=>this.oc.XA(H));let x;(x=this.pa).JR.apply(x,
l)}}catch(f){xa.a.J(509368156,822,10,"SectionActor: Exception in HandleAddSection: {0}.",f)}-1!==b&&b!==c&&this.ia.processAction(K.a.P2e,2)}return 32}CB(a,b){try{if(34===b.TZ&&!b.node.isDirty){const c=this.MXa?Array.clone(this.MXa):null;this.MXa=Array.clone(this.ua.presentation.Tp);if(!c&&this.MXa||c.length<this.MXa.length)2===this.MXa.length&&-1===this.ua.Tz&&(this.ua.Tz=1),this.Lu?this.Lu.fPe():xa.a.J(509368155,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(K.a.P2e,
2)}}catch(c){xa.a.J(509368154,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.xgc.bP(Object(F.a)(this,this.CB,"onChildTopologyChanged"))}}Object(m.a)(yN,"SectionActor",null,[352]);var zN=d(631);class AN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae){if(!Gc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.hf=b;this.Ea=c;this.ZQ=f;this.Vb=l;this.ua=x;this.ob=H;this.QC=U;this.Tb=ja;this.UVa=ya;this.Ge=Va;this.kn=hb;this.CJ=yb;this.Fa=Zb;
this.zw=fc;this.P$=Kc;this.Cva=Lc;this.he=Gc;this.p$j=ae}wb(){this.ia.ya(K.a.Lsd,rc.a.application,Object(F.a)(this,this.dLb,"selectNextSlideHandler"));this.ia.ya(K.a.Msd,rc.a.application,Object(F.a)(this,this.dLb,"selectNextSlideHandler"));this.ia.ya(K.a.h1a,rc.a.application,Object(F.a)(this,this.dLb,"selectNextSlideHandler"));this.ia.ya(K.a.g1a,rc.a.application,Object(F.a)(this,this.dLb,"selectNextSlideHandler"));this.ia.ya(K.a.nlb,rc.a.application,Object(F.a)(this,this.dLb,"selectNextSlideHandler"));
this.ia.ya(K.a.mlb,rc.a.application,Object(F.a)(this,this.dLb,"selectNextSlideHandler"));this.kn&&(this.ia.ya(K.a.ltc,rc.a.application,Object(F.a)(this,this.Lxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(K.a.etc,rc.a.application,Object(F.a)(this,this.Lxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(K.a.gtc,rc.a.application,Object(F.a)(this,this.Lxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(K.a.ftc,rc.a.application,Object(F.a)(this,this.Lxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(K.a.jtc,
rc.a.application,Object(F.a)(this,this.Lxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(K.a.itc,rc.a.application,Object(F.a)(this,this.Lxb,"handleKeyboardMultiSelectSlides")),this.ia.ya(K.a.lnd,rc.a.application,Object(F.a)(this,this.N6k,"selectAllSlidesHandler")),this.ia.ya(K.a.K_a,rc.a.application,Object(F.a)(this,this.Qvj,"handleScrollSelectedThumbnailsIntoView")));this.ia.ya(K.a.ljb,rc.a.application,Object(F.a)(this,this.Pvj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(K.a.D0a,rc.a.application,
Object(F.a)(this,this.moh,"selectNextShapeHandler"));this.ia.ya(K.a.cNb,rc.a.application,Object(F.a)(this,this.moh,"selectNextShapeHandler"));this.ia.ya(K.a.WOb,rc.a.application,Object(F.a)(this,this.OBl,"unselectShapesHandler"));this.ia.ya(K.a.Bpc,rc.a.application,Object(F.a)(this,this.M6k,"selectAllShapesHandler"));this.ia.ya(K.a.Dsh,rc.a.application,Object(F.a)(this,this.Qfl,"shapeEscapeKeyPressedHandler"));this.ia.ya(K.a.wkb,rc.a.application,Object(F.a)(this,this.GVc,"handleSlideScopeArrowKeyboard"));
this.ia.ya(K.a.xkb,rc.a.application,Object(F.a)(this,this.GVc,"handleSlideScopeArrowKeyboard"));this.ia.ya(K.a.ykb,rc.a.application,Object(F.a)(this,this.GVc,"handleSlideScopeArrowKeyboard"));this.ia.ya(K.a.zkb,rc.a.application,Object(F.a)(this,this.GVc,"handleSlideScopeArrowKeyboard"));this.ia.ya(K.a.vxh,rc.a.application,Object(F.a)(this,this.twj,"handleSpaceKeyPressed"));this.ia.ya(K.a.C$g,rc.a.application,Object(F.a)(this,this.TEk,"playVideoCommandHandler"))}Ee(){var a=this.Ea.Fc(Qi.a.PD);const b=
this.Ea.Fc(zb.a.sg),c=this.Ea.Fc(zb.a.lQ);a.bindAction(y.KeyInputManager.Oa(A.a.Sq,0),K.a.Lsd);a.bindAction(y.KeyInputManager.Oa(A.a.Sq,4),K.a.Msd);a.bindAction(y.KeyInputManager.Oa(A.a.SB,0),K.a.h1a);a.bindAction(y.KeyInputManager.Oa(A.a.U1,0),K.a.h1a);a.bindAction(y.KeyInputManager.Oa(A.a.RB,0),K.a.g1a);a.bindAction(y.KeyInputManager.Oa(A.a.S1,0),K.a.g1a);a.bindAction(y.KeyInputManager.Oa(A.a.aF,0),K.a.nlb);a.bindAction(y.KeyInputManager.Oa(A.a.Qw,0),K.a.mlb);this.kn&&(a.bindAction(y.KeyInputManager.Oa(A.a.U1,
4),K.a.ltc),a.bindAction(y.KeyInputManager.Oa(A.a.S1,4),K.a.etc),a.bindAction(y.KeyInputManager.Oa(A.a.aF,4),K.a.gtc),a.bindAction(y.KeyInputManager.Oa(A.a.Qw,4),K.a.ftc),a.bindAction(y.KeyInputManager.Oa(A.a.SB,4),K.a.jtc),a.bindAction(y.KeyInputManager.Oa(A.a.RB,4),K.a.itc),a.bindAction(y.KeyInputManager.Oa(A.a.DMa,2),K.a.lnd));b.bindAction(y.KeyInputManager.Oa(A.a.SB,0),K.a.h1a);b.bindAction(y.KeyInputManager.Oa(A.a.RB,0),K.a.g1a);b.bindAction(y.KeyInputManager.Oa(A.a.aF,0),K.a.nlb);b.bindAction(y.KeyInputManager.Oa(A.a.Qw,
0),K.a.mlb);b.bindAction(y.KeyInputManager.Oa(A.a.Sq,0),K.a.D0a);b.bindAction(y.KeyInputManager.Oa(A.a.Sq,4),K.a.cNb);b.bindAction(y.KeyInputManager.Oa(A.a.T1,0),K.a.Dsh);b.bindAction(y.KeyInputManager.Oa(A.a.DMa,2),K.a.Bpc);b.bindAction(y.KeyInputManager.Oa(A.a.K6,0),K.a.wkb);b.bindAction(y.KeyInputManager.Oa(A.a.dba,0),K.a.xkb);b.bindAction(y.KeyInputManager.Oa(A.a.Mga,0),K.a.ykb);b.bindAction(y.KeyInputManager.Oa(A.a.cZ,0),K.a.zkb);a=y.KeyInputManager.Oa(A.a.SB,0);c.zp(a);c.bindAction(a,K.a.h1a);
a=y.KeyInputManager.Oa(A.a.RB,0);c.zp(a);c.bindAction(a,K.a.g1a);b.bindAction(y.KeyInputManager.Oa(A.a.pP,0),K.a.vxh)}dLb(a,b,c){if(this.ZQ.y_||this.hf.$c(this.Vb.Ef))return 16;if(1===c)return 32;if(!this.Vb.Ef||!this.ua.Ba)return 16;32===this.ia.processAction(K.a.hjc,1)&&this.ia.processAction(K.a.gjc,2);b=this.Mdj(this.ua.Ba,a);if(b===this.ua.Ba.le)return 32;if(this.zw&&a!==K.a.nlb&&a!==K.a.mlb&&(a=this.Ge.jT(b),!a||!a.VN))return 16;this.Ea.i8===zb.a.sg&&this.Ea.Ed();return this.Ge.GJ(b)}Mdj(a,b){a=
a.le;const c=this.Tb.pj();switch(b){case K.a.g1a:a=Math.min(a+1,c-1);break;case K.a.Lsd:a=a+1>c-1?0:a+1;break;case K.a.h1a:a=Math.max(a-1,0);break;case K.a.Msd:a=0>a-1?c-1:a-1;break;case K.a.nlb:a=0;break;case K.a.mlb:a=c-1}return a}Lxb(a,b,c){if(this.ZQ.y_||this.hf.$c(this.Vb.Ef)||!this.Vb.Ef||!this.ua.Ba)return 16;if(1===c)return 32;32===this.ia.processAction(K.a.hjc,1)&&this.ia.processAction(K.a.gjc,2);if(1>=this.Tb.pj())return 32;xa.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");
switch(a){case K.a.ltc:case K.a.etc:case K.a.gtc:case K.a.ftc:this.Vwj(a);break;case K.a.jtc:case K.a.itc:this.Qtj(a);break;default:return xa.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}Tjj(a,b){const c=[];var f=this.Tb.pj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Tb.XA(a))&&c.push(f);return c}Vwj(a){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.ob.Qe();b.sort((Va,hb)=>Va.le-hb.le);const c=b[0].le,f=b[b.length-
1].le,l=this.ua.Ba.le,x=this.Tb.pj();var H=[];let U=l,ja=l,ya=l;H=!0;switch(a){case K.a.ltc:1===b.length?ya=U=0<=l-1?l-1:l:l===c?ja=0<=f-1?f-1:f:c?ya=U=c-1:H=!1;break;case K.a.etc:1===b.length?ya=ja=l<x-1?l+1:l:l===c&&f<x-1?ya=ja=f+1:l===c&&f===x-1?H=!1:U=c+1;break;case K.a.gtc:U=0;break;case K.a.ftc:ja=x-1}if(this.zw&&ya!==l&&(a=this.Ge.jT(ya),!a||!a.VN))return;if(H){H=this.Tjj(U,ja);let Va;(Va=this.ob).JR.apply(Va,H);this.Ge.pya(U===l?ja:U)}}Qtj(a){const b=this.ob.Qe();b.sort((ja,ya)=>ja.le-ya.le);
const c=b[0].le,f=b[b.length-1].le,l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");const x=l.le,H=this.Tb.pj();let U=null;if(!(1>=H)){switch(a){case K.a.jtc:if(!x)break;(U=this.Tb.XA(x-1))&&1<b.length&&x===f&&this.Prb(b)&&this.ob.poc(l);break;case K.a.itc:x!==H-1&&(U=this.Tb.XA(x+1))&&1<b.length&&x===c&&this.Prb(b)&&this.ob.poc(l)}if(U){if(this.zw&&(a=U.mg(this.Ge.Ma),!a||!a.VN))return;this.Vb.Ba=U;this.ob.e6a(U);this.Ge.pya(U.le)}}}Prb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=
0;b<a.length-1;b++)if(1!==a[b+1].le-a[b].le)return!1;return!0}Qvj(a,b,c){if(!this.Vb.Ef||!this.ua.Ba||this.hf.$c(this.Vb.Ef))return 16;2===c&&this.Ge.K_a();return 32}Pvj(a,b,c){if(!this.Vb.Ef||!this.ua.Ba||this.hf.$c(this.Vb.Ef))return 16;2===c&&this.Ge.gnd();return 32}GVc(a,b,c){return this.ob.V3()?this.ztj(a,c):this.Wvj(a,c)}Wvj(a,b){if(this.kn&&1!==this.ob.Qe().length)return 8;let c;switch(a){case K.a.wkb:case K.a.ykb:a=K.a.g1a;c="ThumbnailPageDownNavigation";break;case K.a.zkb:case K.a.xkb:a=
K.a.h1a;c="ThumbnailPageUpNavigation";break;default:return xa.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),8}Tc.a.Ib&&(Tc.a.Ib.actionName=c,Tc.a.Ib.Nj=!1,Tc.a.Ib.Ur=!0);return this.ia.processAction(a,b)}ztj(a,b){switch(a){case K.a.wkb:a=K.a.bjc;break;case K.a.xkb:a=K.a.cjc;break;case K.a.ykb:a=K.a.djc;break;case K.a.zkb:a=K.a.ejc;break;default:return xa.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,
b)}moh(a,b,c,f,l){if(this.ZQ.y_)return 16;if(1===c)return 32;b=this.ua.Ba;if(!b)return 16;c=b.Ek();if(!c||!c.length)return 16;this.Ed();f=this.ob.tg();if(this.ob.jLb){if(c=this.ob.jLb.mg(this.Vb.MK.Ma))c.xce(),c.jph(!1);f.length||f.push(this.ob.jLb);this.ob.jLb=null}f&&this.nLa(f,!1);c=null;a===K.a.D0a?c=l?l:b.U9a(f,!1,0):a===K.a.cNb&&(c=b.U9a(f,!0,0));if(!c)return ia.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.p$j){l=
Object(oa.a)(Hz.a,c.mg(this.Vb.MK.Ma));if(c.sFa&&l&&a===K.a.cNb){const x=document.getElementById(zN.a.uJe+l.oT);if(x&&document.activeElement!==x)return l.nLa(),x.focus(),32}if(f.length&&(l=f[0],f=Object(oa.a)(Hz.a,l.mg(this.Vb.MK.Ma)),l.sFa&&f&&a===K.a.D0a&&(a=document.getElementById(zN.a.uJe+f.oT))&&document.activeElement!==a))return a.focus(),32}return this.vch(c,b)}M6k(a,b,c){if(this.ZQ.y_)return 16;if(1===c)return 32;a=this.ua.Ba;if(!a)return 16;b=a.Ek();if(!b.length)return 16;a=[];for(const f of b)(b=
Object(oa.a)(117,f.mg(this.Vb.MK.Ma)))&&b.$p?b.nLa():(b&&b.shapeNode&&b.shapeNode.gy&&b.q1(!1),a.push(f));this.ob.P_a(a,!0);this.CJ.xPk();this.nLa(a,!0);this.Ed();return 32}N6k(a,b,c){if(1===c)return 32;a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;xa.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.ob).JR.apply(f,a);this.Ge.pya(this.Tb.pj()-1);return 32}Qfl(a,b,c){if(1===c)return 32;this.ia.processAction(K.a.uee,2);this.ia.processAction(K.a.WOb,
2);Ud.a("RaiseEscapeKeyPressedEvent")&&this.he.JNk();return 32}OBl(a,b,c){if(!this.ob.gH())return 16;if(1===c)return 32;this.QC.pQa();a=this.ob.Wd();if(b=this.Fa.D9a(a))return a=this.Fa.yr(b),this.vch(a,this.ua.Ba);this.nLa(a,!1);this.ob.Qh();this.Ed();return 32}twj(){this.ia.processAction(K.a.C$g,2);this.Cva&&this.ia.processAction(K.a.Fyf,2);return 32}TEk(){if(!this.ob.ofi()&&!this.ob.pfi())return 2;const a=this.ob.Wd();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.P$.sTa(a[b]);
c&&c.startPlaying()}return 32}vch(a,b){const c=a.mg(this.Vb.MK.Ma);if(c){if(c.$p)return this.ob.Qh(),c.nLa(),c.jph(!0),c.HR(),b=null,c.U1c?b=String.format(ResourceStrings.L_CannotEditHint,c.U1c.userName):xa.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.UVa.pfh(a,b),this.ob.jLb=a,32}else return ia.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),
8;this.ob.selectShape(a,!0);(a=b.mg(this.Vb.MK.Ma))&&a.oya();c&&(c.nLa(),c.HR());return 32}Ed(){this.Vb.MK.lp||this.Ea.Ed()}nLa(a,b){for(const c of a)(a=c.mg(this.Vb.MK.Ma))&&(b?a.nLa():a.xce())}}Object(m.a)(AN,"SelectionActor",null,[352]);class lA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(m.a)(lA,"SelectionPaneShapeNode",null,[]);var wR=d(889);class BN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,
Lc){this.Bfc=this.oR=null;a("powerpoint-editor-intl").then(()=>{xa.a.J(512500438,801,50,"Icons and strings script is loaded successfully");a("selectionPaneManager").then(()=>{xa.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");this.oR=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.oVk();ja.idl()}).catch(Gc=>{xa.a.J(512500436,801,10,"Failed to load selectionPaneManager "+Gc.toString())})}).catch(Gc=>{xa.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+
Gc.toString())});this.ob=b;this.Rb=c;this.ia=f;this.ua=l;this.Ea=x;this.pA=H;this.eTg=U;this.qck=ja;this.Pg=ya;this.qd=Va;this.Lc=hb;this.G$=yb;this.lJ=Zb;this.Fa=fc;this.vz=Kc;this.Jb=Lc;this.srg=!1;this.Pg.rI(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.Pg.SBa(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.Lc.HPa(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.qd.VBa(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.Rb.PK(Object(F.a)(this,
this.Su,"onAppFrameModeSwitched"));this.LVa=!1;this.zQg=null}dispose(){this.Pg.U5(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.Pg.j_a(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.Lc.Eib(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.qd.Gib(Object(F.a)(this,this.YYa,"onChangeRenderSelectionPane"));this.Rb.yY(Object(F.a)(this,this.Su,"onAppFrameModeSwitched"))}Ee(){const a=this.Ea.Fc(zb.a.ME);a.bindAction(y.KeyInputManager.Oa(A.a.S1a,6),K.a.Hpc);a.bindAction(y.KeyInputManager.Oa(A.a.wpa,
6),K.a.PZb)}Hpc(a){return Kg.a("SelectionPaneBringBackward",a,()=>{this.LVa=!0;this.ia.processAction(K.a.sendBackward,2);xa.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}PZb(a){return Kg.a("SelectionPaneBringForward",a,()=>{this.LVa=!0;this.ia.processAction(K.a.bringForward,2);xa.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}wb(){this.ia.ra(K.a.k6,rc.a.application,Object(F.a)(this,this.k6,"showHideSelectionPane"),
4);this.ia.ra(K.a.vJb,rc.a.application,Object(F.a)(this,this.vJb,"querySelectionPane"),96);this.ia.ya(K.a.Hpc,rc.a.application,Object(F.a)(this,this.Hpc,"sendBackwardSelectionPane"));this.ia.ya(K.a.PZb,rc.a.application,Object(F.a)(this,this.PZb,"bringForwardSelectionPane"))}vJb(a,b,c,f,l){(a=Object(oa.a)(Uh.a,l))&&a.Mf(this.pA.isVisible);return 32}k6(a,b,c){return 1===c?this.oR&&this.ua.Ba?32:8:Kg.a("SelectionPaneOpen",a,()=>{this.pA.isVisible=!this.pA.isVisible;this.rjh();this.pA.isVisible?(this.lJ.notesPane&&
this.lJ.notesPane.qZb()&&this.Ea.Ed(),this.Ea.Cj(zb.a.ME,!0),this.oR.focusShowAllButton()):this.Ea.Cj(zb.a.ME,!1);return 32})}Su(a){1===a.mode&&this.pA&&this.pA.isVisible&&(this.pA.isVisible=!1,this.Ea.Cj(zb.a.ME,!1))}dzi(){const a={};this.Bfc=new Ma.ScriptSharpLegacyMap;var b=this.ua.Ba,c=b?b.Ek(!0):null;b=this.ob.tg();const f=new Ka.a;let l=0;if(c){c.reverse();for(const H of c)if(!H.isLocal)if(c=this.i6f(H,b),H.Jf){if(l++,c=this.Fa.ex(H)){c.reverse();for(const U of c){c=this.i6f(U,b);let ja=null;
for(const ya of U.$A){var x=void 0;ya.ShapeId.toString()in a?(x=Object(oa.a)(lA,a[ya.ShapeId.toString()]),this.Bfc.ga(ya.ShapeId).push(U.get_shapeId())):(x=[U.get_shapeId()],this.Bfc.add(ya.ShapeId,x),x=this.xij(ya,b),a[ya.ShapeId.toString()]=x,ja?ja.children.push(x):f.add(x));ja=x}ja.children.push(c)}}}else f.add(c)}0<l&&!this.srg&&(xa.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.srg=!0);return f}i6f(a,b){const c=new lA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=
a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}xij(a,b){const c=new lA;c.shapeId=a.ShapeId;c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.wC(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}rjh(){if(!this.ua.Ba)this.pA.isVisible=!1;else if(this.pA.isVisible){var a=
this.dzi();if(this.Uxf(a?a.toArray():null,this.zQg)){this.zQg=a?a.toArray():null;var b=this.G$.Ci("UserAction","SelectionPane Rendering started");this.oR.renderSelectionPane(wR.a.yoh,a.toArray());a=b.Vq.toString();b.stop();xa.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else xa.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}Uxf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=
a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||f.isFocussedShape!==l.isFocussedShape||this.Uxf(f.children,l.children))return!0}return!1}YYa(){this.rjh();this.LVa&&(this.pA.isVisible?this.Ea.Cj(zb.a.ME,!0):this.Ea.Cj(zb.a.ME,!1));this.LVa=!1}yYe(a,b,c){let f;const l=c.$A.length,x=[];f=!1;for(let H=0;H<l;H++){const U=c.$A[H];U.ShapeId===a&&(2===b?(U.IsHidden=!U.IsHidden,f=U.IsHidden):0===b?f=U.IsHidden=!0:1===
b&&(f=U.IsHidden=!1));x.push(U)}return{returnValue:x,eQj:f}}tqi(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=this.Bfc.ga(a);if(!c||1>=c.length)xa.a.J(512500429,801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.wC(c[0]);if(f){var l=!1;a=({eQj:l}=this.yYe(a,2,f)).returnValue;for(const x of c){const H=(c=b.wC(x))?Object(oa.a)(117,c.sc(this.vz)):null;H&&(l?(H.wka(),this.ob.fX(c)&&this.ob.p8(c)):!l&&H.gMa())}b=this.Jb.Ad(15);try{b.nc(f),
f.$A=a}finally{b&&b.dispose()}}else xa.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}xvh(a){const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.Ek(!0),f=[];for(const l of c)if(l.Jf){const x=this.Fa.ex(l);f=f.concat.apply(f,x)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.ob.ij(),this.ob.psa(c));for(const l of c)!a&&l.isHiddenShape?Object(oa.a)(117,l.sc(this.vz)).gMa():a&&!l.isHiddenShape&&Object(oa.a)(117,l.sc(this.vz)).wka();
f=this.Jb.Ad(15);try{f.nc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.Bfc)if(!b.wC(l.key)){const x=l.value;if(!x||1>=x.length){xa.a.J(512500427,801,10,"There should be atleast 2 child shapes in the nested group");continue}const H=b.wC(x[0]);H?(c=[],c=a?this.yYe(l.key,0,H).returnValue:this.yYe(l.key,1,H).returnValue,H.$A=c):xa.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&
f.dispose()}}}oVk(){this.oR.addCloseSelectionPaneEventListener(()=>{xa.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.pA.isVisible=!1});this.oR.addFocusSelectionPaneListener(()=>{xa.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Ea.Cj(zb.a.ME,!0)});this.oR.addSelectShapeEventListener(a=>{xa.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
(a=b.wC(a))&&(a.isHiddenShape||this.ob.selectShape(a,!0))});this.oR.addSelectMultipleShapesEventListener(a=>{xa.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");Kg.a("SelectionPaneMultiSelect",K.a.k6,()=>{if(!a.length){var c=this.ob.Wd();this.ob.psa(c)}c=0;for(const f of a){const l=b.wC(f);l&&!l.isHiddenShape&&(c?this.ob.selectShape(l,!1):(this.ob.selectShape(l,!0),c++))}return 32})});
this.oR.addToggleVisibilityListener(a=>{xa.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=b.wC(a);b="";if(!c||c.Ng||c.Jf)b="Group";Kg.b("SelectionPaneToggleVisibilty",b,K.a.k6,()=>{c?this.eTg.dwl(a):this.tqi(a);return 32})});this.oR.addShapeRenameListener((a,b)=>{xa.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");
c=c.wC(a);let f="";if(!c||c.Ng||c.Jf)f="Group";Kg.b("SelectionPaneRename",f,K.a.k6,()=>{this.eTg.qdl(a,b);return 32})});this.oR.addShapeReorderListener((a,b)=>{xa.a.J(512500419,822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.wC(a);let l="";if(!f||f.Ng||f.Jf)l="Group";else if(c=c.wC(b),!c||c.Ng||c.Jf)l="Group";Kg.b("SelectionPaneReorder",l,K.a.k6,()=>{this.qck.Umk(a,b);return 32})});this.oR.addShowAllButtonEventListener(()=>
{this.LVa=!0;xa.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");Kg.a("SelectionPaneShowAll",K.a.k6,()=>{this.xvh(!1);return 32})});this.oR.addHideAllButtonEventListener(()=>{this.LVa=!0;xa.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");Kg.a("SelectionPaneHideAll",K.a.k6,()=>{this.xvh(!0);return 32})});this.oR.addBringForwardButtonEventListener(()=>{this.LVa=!0;xa.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");
Kg.a("SelectionPaneBringForward",K.a.k6,()=>{this.ia.processAction(K.a.bringForward,2);return 32})});this.oR.addBringBackwardButtonEventListener(()=>{this.LVa=!0;xa.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");Kg.a("SelectionPaneBringBackward",K.a.k6,()=>{this.ia.processAction(K.a.sendBackward,2);return 32})});xa.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(m.a)(BN,"SelectionPaneActor",null,[352]);class CN{constructor(a,
b,c,f){this.lea=!1;this.kfc="ShapeAlignToSelectedObjects";this.ia=a;this.Fb=c;this.ob=b;this.o0=f}wb(){xa.a.J(50630811,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");this.ia.ra(K.a.Lvf,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.zsh,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.Cpd,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.Fqc,rc.a.application,Object(F.a)(this,
this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.Dpd,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.Cqc,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.Dqc,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.Eqc,rc.a.application,Object(F.a)(this,this.HTa,"handleShapesAlignment"),4);this.ia.ra(K.a.jDa,rc.a.application,Object(F.a)(this,this.pag,"handleShapesDistribution"),4);this.ia.ra(K.a.y2b,
rc.a.application,Object(F.a)(this,this.pag,"handleShapesDistribution"),4);this.ia.ra(K.a.xJb,rc.a.application,Object(F.a)(this,this.xJb,"queryShapeAlignToSlide"),96);this.ia.ya(K.a.ytc,rc.a.application,Object(F.a)(this,this.ytc,"toggleShapeAlignToSlide"));this.ia.ra(K.a.wJb,rc.a.application,Object(F.a)(this,this.wJb,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(K.a.xtc,rc.a.application,Object(F.a)(this,this.xtc,"toggleShapeAlignToSelectedObjects"))}Ee(){}P$b(){return u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.hb.Np?!0:!1}HTa(a,b,c){if(this.o0){b=this.ob.Wd();for(const l of b)if(!l.eb(kb.a.QUa))return 16}const f=this.ob.tg();return f?1===c?f.length?32:8:Kg.a("Align",a,()=>{xa.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],x=1===f.length||this.lea?this.YVf(a):this.XVf(a,f);if(null===x)return xa.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const H of f)l.push(new Av(H,
this.idj(a,H,x)));if(!l[0].shapeNode.Ng)for(const H of l)this.$k(H.shapeNode).setPosition(H.position.x,H.position.y,!0);this.ia.La(K.a.RIa,2,l);return 32}):(xa.a.J(50598726,822,10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}xJb(a,b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return xa.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Mf(this.lea);xa.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");
return 32}ytc(a,b,c,f,l){a=this.ob.tg();if(1===c)return 2>a.length&&(this.lea=!0,this.kfc="ShapeAlignToSlide",xa.a.J(50598736,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),32;if(!l||"object"!==typeof l)return xa.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.RFh(l)&&(this.lea=!0,xa.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}wJb(a,
b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return xa.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),8;l.Mf(!this.lea);xa.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");return 32}xtc(a,b,c,f,l){a=this.ob.tg();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return xa.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.RFh(l)&&
(this.lea=!1,xa.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}idj(a,b,c){let f=null;var l=this.$k(b);b=l.HRc();l=l.us();switch(a){case K.a.Cpd:xa.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");f=new hd.a(b.x-l.hc+c,b.y);break;case K.a.Fqc:xa.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new hd.a(b.x+(c-l.$b),b.y);break;case K.a.Dpd:xa.a.J(50598754,
822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new hd.a(b.x,b.y-l.kc+c);break;case K.a.Cqc:xa.a.J(50598784,822,50,"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new hd.a(b.x,b.y+(c-l.Yb));break;case K.a.Dqc:xa.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");f=new hd.a(b.x+(c-l.Wf().x),b.y);break;case K.a.Eqc:xa.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new hd.a(b.x,b.y+
(c-l.Wf().y))}return f}pag(a,b,c){const f=this.ob.tg();return f?1===c?!f.length||2===f.length&&!this.lea?8:32:Kg.a("Align",a,()=>{xa.a.J(50902275,822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.KZe(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.lea?this.YVf(a):this.XVf(a,f);if(null===l)return xa.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var x=l-this.soi(a,f);l=this.coi(f,x);x=this.goi(a,
f,x,l);this.PNi(a,f,f.length-1,l,x);return 32}):(xa.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),16)}soi(a,b){return a===K.a.jDa?this.toi(b):this.uoi(b)}toi(a){let b=0;for(const c of a)a=this.$k(c),b+=a.us().Yb-a.us().kc;return b}uoi(a){let b=0;for(const c of a)a=this.$k(c),b+=a.us().$b-a.us().hc;return b}goi(a,b,c,f){if(1===b.length||this.lea)return 0<c?f:0;b=this.$k(b[0]);return a===K.a.jDa?b.us().Yb+f:b.us().$b+f}coi(a,b){return(1===a.length||this.lea)&&
0<b?1*b/(a.length+1):1*b/(a.length-1)}PNi(a,b,c,f,l){var x=0;const H=[];1<b.length&&!this.lea?(xa.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),x++,c--):xa.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===K.a.jDa?xa.a.J(50902281,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):xa.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");x<=c;x++){const ja=
b[x];if(!ja)continue;let ya=this.$k(ja);if(ya){var U=ya.HRc();a===K.a.jDa?(U=new hd.a(U.x,l),H.push(new Av(ja,U)),l+=ya.us().Yb-ya.us().kc+f):(U=new hd.a(l,U.y),H.push(new Av(ja,U)),l+=ya.us().$b-ya.us().hc+f)}}if(H[0]&&!H[0].shapeNode.Ng)for(const ja of H)this.$k(ja.shapeNode).setPosition(ja.position.x,ja.position.y,!0);this.ia.La(K.a.RIa,2,H)}YVf(a){const b=Object(oa.a)(573,this.ob.tk().sc(this.Fb.Ma));if(!b)return xa.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",
a),null;switch(a){case K.a.Fqc:case K.a.y2b:return b.JB.clientWidth;case K.a.Cqc:case K.a.jDa:return b.JB.clientHeight;case K.a.Dqc:return b.JB.clientWidth/2;case K.a.Eqc:return b.JB.clientHeight/2;default:return xa.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",a),0}}XVf(a,b){switch(a){case K.a.Cpd:var c=Number.MAX_VALUE;for(const x of b)b=this.$k(x),c=Math.min(b.us().hc,c);return c;case K.a.Fqc:c=-Number.MAX_VALUE;for(const x of b)b=
this.$k(x),c=Math.max(b.us().$b,c);return c;case K.a.Dpd:c=Number.MAX_VALUE;for(const x of b)b=this.$k(x),c=Math.min(b.us().kc,c);return c;case K.a.Cqc:c=-Number.MAX_VALUE;for(const x of b)b=this.$k(x),c=Math.max(b.us().Yb,c);return c;case K.a.Dqc:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.$k(c),f=Math.min(b.us().hc,f),l=Math.max(b.us().$b,l);return f+(l-f)/2;case K.a.Eqc:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.$k(f),c=Math.min(b.us().kc,c),l=Math.max(b.us().Yb,
l);return c+(l-c)/2;case K.a.jDa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.$k(l),c=Math.min(c,b.us().kc),f=Math.max(b.us().Yb,f);return f-c;case K.a.y2b:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const x of b)b=this.$k(x),c=Math.min(c,b.us().hc),f=Math.max(b.us().$b,f);return f-c;default:return xa.a.J(51500960,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}KZe(a,b,
c,f){if(!(c>=f)){var l=this.hDk(a,b,c,f);this.KZe(a,b,c,l-1);this.KZe(a,b,l+1,f)}}hDk(a,b,c,f){if(b===K.a.jDa)return this.jDk(a,c,f);if(b===K.a.y2b)return this.iDk(a,c,f);xa.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}jDk(a,b,c){var f=this.$k(a[c]).us().Wf().y;let l=b-1;for(;b<=c-1;b++)if(this.$k(a[b]).us().Wf().y<f){l++;const x=a[l];a[l]=a[b];a[b]=x}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}iDk(a,b,c){var f=this.$k(a[c]).us().Wf().x;
let l=b-1;for(;b<=c-1;b++)if(this.$k(a[b]).us().Wf().x<f){l++;const x=a[l];a[l]=a[b];a[b]=x}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}RFh(a){const b=a.SourceControlId;return a[Sh.a.On]&&this.kfc!==b?(this.lea="ShapeAlignToSelectedObjects"===this.kfc,this.P$b()&&(a={},a[b]="ToggleButtonModel",a[this.kfc]="ToggleButtonModel",Oc.App.Kb.sG(a)),this.kfc=b,!0):!1}$k(a){return a?Object(oa.a)(117,a.sc(this.Fb.Ma)):null}}Object(m.a)(CN,"ShapeAlignmentActor",null,[352]);var DN=d(501),xR=d(959);class ay{}Object(m.a)(ay,
"CT_NoFillProperties",null,[]);var yR=d(960);class mA{constructor(a,b){this.jul=a;this.Ksc=b}}Object(m.a)(mA,"FormatPainterData",null,[]);var EN=d(730);class li{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te){this.fsl="data:image/svg+xml;charset=utf8,";this.JKe=96;this.ia=a;this.pa=H;this.qe=f;this.Jb=c;this.Ea=b;this.QC=l;this.fc=x;this.zve=ja;this.iJ=U;this.Fxe=Va;this.CEg=(a=!Gc||!Gc.isInHighContrastMode)&&Lc.Aie;this.HX=Lc.powerPointGraphicToolTabIsEnabled;this.lxe=a&&Lc.svgIconLocalEditingIsEnabled;
this.Afb=ya;this.vz=Te;this.Fa=hb;this.VQ=yb;this.nU=Zb;this.Vb=fc;this.ua=Kc;this.yc=ae;this.Sp=Lc.pptTextFormatPainterIsEnabled;this.yyg=Lc.formatPainterApplyRemappedIsEnabled;this.pEg=Lc.a0c;this.Mdb=Lc.dIk;this.cU=Lc.DIb;this.la=Lc;this.fj=we;this.efc=new Ma.ScriptSharpLegacyMap;this.qA=$d}wb(){this.ia.ra(K.a.$Ke,rc.a.application,Object(F.a)(this,this.wuj,"handlePopulateShapeFillMenu"),96);this.ia.ra(K.a.pEe,rc.a.application,Object(F.a)(this,this.rtj,"handleMoreFillColors"),96);this.ia.ra(K.a.rEe,
rc.a.application,Object(F.a)(this,this.wtj,"handleMoreOutlineColors"),96);this.ia.ra(K.a.aCa,rc.a.application,Object(F.a)(this,this.T9f,"handleApplyShapeFillColor"),4);this.ia.ra(K.a.zHc,rc.a.application,Object(F.a)(this,this.vqj,"handleApplyShapeFillCustomColor"),4);this.ia.ra(K.a.Krb,rc.a.application,Object(F.a)(this,this.T9f,"handleApplyShapeFillColor"),4);this.ia.ra(K.a.hld,rc.a.application,Object(F.a)(this,this.$$f,"handleRemoveShapeFill"),4);this.ia.ra(K.a.DQe,rc.a.application,Object(F.a)(this,
this.$$f,"handleRemoveShapeFill"),4);this.ia.ra(K.a.aid,rc.a.application,Object(F.a)(this,this.xuj,"handlePopulateShapeOutlineMenu"),96);this.ia.ra(K.a.Fia,rc.a.application,Object(F.a)(this,this.U9f,"handleApplyShapeOutlineColor"),4);this.ia.ra(K.a.AHc,rc.a.application,Object(F.a)(this,this.wqj,"handleApplyShapeOutlineCustomColor"),4);this.ia.ra(K.a.Lrb,rc.a.application,Object(F.a)(this,this.U9f,"handleApplyShapeOutlineColor"),4);this.ia.ra(K.a.SPa,rc.a.application,Object(F.a)(this,this.Aqj,"handleApplyShapeOutlineWidth"),
4);this.ia.ra(K.a.o6a,rc.a.application,Object(F.a)(this,this.xqj,"handleApplyShapeOutlineDashStyle"),4);this.pEg&&this.ia.ra(K.a.p6a,rc.a.application,Object(F.a)(this,this.zqj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.ra(K.a.Gia,rc.a.application,Object(F.a)(this,this.yqj,"handleApplyShapeOutlineEndStyle"),4);this.ia.ra(K.a.ild,rc.a.application,Object(F.a)(this,this.aag,"handleRemoveShapeOutline"),4);this.ia.ra(K.a.EQe,rc.a.application,Object(F.a)(this,this.aag,"handleRemoveShapeOutline"),4);
this.ia.ra(K.a.qSa,rc.a.application,Object(F.a)(this,this.Nwj,"handleToggleFormatPainterActive"),4);this.ia.ra(K.a.Rja,rc.a.application,Object(F.a)(this,this.mqj,"handleApplyFormat"),4);this.ia.ra(K.a.E4d,rc.a.application,Object(F.a)(this,this.nqj,"handleApplyFormatToShape"),5);this.ia.ra(K.a.qjd,rc.a.application,Object(F.a)(this,this.Ouj,"handleQueryFormatPainter"),97);this.ia.ra(K.a.KIb,rc.a.application,Object(F.a)(this,this.Duj,"handlePreviewShapeFillColor"),4);this.ia.ra(K.a.MKb,rc.a.application,
Object(F.a)(this,this.Mvj,"handleRevertPreviewShapeFillColor"),4)}Ee(){const a=this.Ea.Fc(zb.a.sg);a.bindAction(y.KeyInputManager.Oa(A.a.Oza,6),K.a.qSa);const b=this.Ea.Fc(zb.a.lQ);let c=y.KeyInputManager.Oa(A.a.Oza,6);b.zp(c);this.Sp?b.bindAction(c,D.a.HQc):b.bindAction(c,K.a.qSa);xa.a.J(512500379,815,50,"formatPainterApplyRemapped: {0}",this.yyg);this.yyg||(c=y.KeyInputManager.Oa(A.a.T1a,6),a.bindAction(c,K.a.Rja),b.zp(c),this.Sp?b.bindAction(c,K.a.F4d):b.bindAction(c,K.a.Rja))}Nwb(a,b){const c=
[];if(a)for(const f of a)(f.qua||b&&f.get_isSVGBlipFilled()||f.Fj||this.cU&&1===f.mediaType)&&Array.add(c,f);return c}F9a(a,b){const c=[];if(a)for(const f of a)(f.qua&&!f.az||b&&f.get_isSVGBlipFilled()||this.Mdb&&f.ud)&&Array.add(c,f);return c}wuj(a,b,c,f,l){if(!this.pa.V3()||this.fc.AC(this.pa.Wd()))return 16;if(1===c)return 32;if(!l)return 8;b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.c8;b=(c=this.pa.Jp())?b.xC(c.slideId):null;if(!b)return 16;var x=!!l.MenuId&&
-1!==l.MenuId.indexOf("Graphics");c=x?K.a.Krb:K.a.aCa;f=x?K.a.DQe:K.a.hld;const H=K.a.pEe;if(l.MenuId&&"fill"===l.MenuId){var U=new EN.a(b.ke);x=new Sys.StringBuilder;x.append(String.format(li.LBf,"PptRibbon.Drawing.ShapeFill"));if(!b.ke)return 8;x.append(U.xae(c,a,K.a.zHc));x.append(li.RBf);x.append(String.format(li.PBf,f,u.AFrameworkApplication.rm,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));x.append(li.QBf);x.append(li.Zmi);x.append(String.format(li.Xmi,H,u.AFrameworkApplication.rm,
ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));x.append(li.Ymi);x.append(li.KBf);l.PopulationXML=x.toString()}else{U=Object.assign(new tm.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const ja=x?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",ya=x?"GraphicNoFill":"ShapeNoFill";Array.add(U.MenuSectionList,al.f(b.ke,NE.a.themeColors,"Color.Menu.Controls","themeColor",x?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(U.MenuSectionList,
al.d("Standard Colors","Color.Menu.Controls","standardColor",ja,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(U.MenuSectionList,al.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(U.MenuSectionList,al.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,
"Color.Menu.RemoveColor",ya,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(U.MenuSectionList,al.a("More Fill Color","Color.Menu.Controls",H.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));Ud.a("ColorPickerHighlighterFix")&&(a=this.iij(b.ke),al.h(U,a,b.ke));l.MenuItems=U}return 32}xuj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");
if(!this.pa.V3()||this.fc.AC(this.pa.Wd()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.pa.Jp())?a.xC(c.slideId):null;if(!c||!c.ke)return 8;a=a.c8;var x=this.qe.qk("pegal.png"),H=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=H?K.a.Lrb:K.a.Fia;f=H?K.a.EQe:K.a.ild;const U=K.a.rEe;if(l.MenuId&&"outline"===l.MenuId){var ja=new Sys.StringBuilder;ja.append(String.format(li.LBf,"PptRibbon.Drawing.ShapeOutline"));c=new EN.a(c.ke);ja.append(c.xae(b,a,K.a.AHc));ja.append(li.RBf);ja.append(String.format(li.PBf,
f,u.AFrameworkApplication.rm,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));ja.append(li.QBf);ja.append(li.bni);ja.append(String.format(li.$mi,U,u.AFrameworkApplication.rm,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));ja.append(li.ani);c=this.pa.Wd();a=li.Lhj(c,this.HX);if(!a||!a.length||c&&c.length!==a.length)ja.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
K.a.EHc,K.a.SPa,u.AFrameworkApplication.rm,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,x,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
K.a.BHc,K.a.o6a,u.AFrameworkApplication.rm,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,x,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.pEg&&ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
K.a.DHc,K.a.p6a,u.AFrameworkApplication.rm,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,x,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
K.a.CHc,K.a.Gia,u.AFrameworkApplication.rm,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,x,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),ja.append("</Controls></MenuSection>");
ja.append(li.KBf);l.PopulationXML=ja.toString()}else{x=H?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";ja=H?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const ya=H?"GraphicNoOutline":"ShapeNoOutline";H=Object.assign(new tm.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(H.MenuSectionList,al.f(c.ke,"Theme Colors","Color.Menu.Controls","themeColor",x,b.toString(),1));Array.add(H.MenuSectionList,al.d("Standard Colors","standardColor","Standard Colors",
ja,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(H.MenuSectionList,al.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(H.MenuSectionList,al.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
ya,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(H.MenuSectionList,al.a("More Outline Color","Color.Menu.Controls",U.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));Ud.a("ColorPickerHighlighterFix")&&(a=this.hij(c.ke),al.h(H,a,c.ke));l.MenuItems=H}return 32}Duj(a,b,c,f,l){if(!l)return xa.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.omc)return 2;b=this.pa.tg();const x=this.F9a(b,this.HX);return x&&x.length?this.Mdb&&1===x.length&&x[0].ud?(xa.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):Kg.a("HandlePreviewShapeFillColor:",a,()=>{const H=this.pa.aP(x),U=this.iJ.oV(l),ja=Object.assign(new DN.a,{});ja.solidFillField=U;for(const ya of H)ya?ya.ud||(this.efc.Hb(ya.get_shapeId())?this.efc.$(ya.get_shapeId(),ya.fill):this.efc.add(ya.get_shapeId(),ya.fill),ya.fill=
ja,ya.Wfa=null):xa.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",ya.get_shapeId());return 32}):(xa.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}Mvj(a,b,c,f,l){if(!l)return xa.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.omc)return 2;a=this.pa.tg();a=this.F9a(a,this.HX);if(!a||!a.length)return xa.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.Mdb&&1===a.length&&a[0].ud)return xa.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.pa.aP(a);for(const x of a)if(!x)xa.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",x.get_shapeId());else if(!x.ud)if(this.efc.Hb(x.get_shapeId()))x.fill=this.efc.ga(x.get_shapeId()),x.Wfa=null;else return xa.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}T9f(a,b,c,f,l){var x=this.ua.presentation;if(!x)throw Error.argumentNull("Presentation is null");f=this.pa.tg();b=this.F9a(f,this.HX);const H={type:"ColorPickerPayload",color:""};l&&(H.color=l.Color);if(!(b&&0<b.length||this.pa.FL()&&this.tmg(f[0],a,H))||this.fc.AC(b))return 16;const U=this.pa.Jp();x=U?x.xC(U.slideId):null;if(!x||!x.ke||!x.ke.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.Mdb&&1===b.length&&b[0].ud)return xa.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.La(K.a.N5,c,l);c=li.chd(l);if(!c)return 8;1<f.length?xa.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):xa.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var ja of f)if(ja.Jf||ja.Ng){un(ja);break}if(this.pa.FL()&&this.tmg(f[0],a,H)&&this.cbe(f[0],a,H))return 32;ja=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{ja.nc(b[0]);ja.jd=a;const ya=this.iJ.oV(l),Va=this.pa.aP(b);
for(const hb of Va)if(hb.ud){if(!this.Mdb)continue;xa.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const yb=this.yc.JN(hb);if(!yb){xa.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const Zb=yb.i$a();for(const fc of Zb){const Kc=fc.cellShading;Zo.b(Kc);Kc.solidFillField=ya;fc.cellShading=Kc}}else{const yb=this.BSf(hb);yb&&(this.iJ.LRa(yb),yb.solidFillField=ya,hb.fill=yb,hb.Wfa=null,this.CHh(hb,yb));hb.Loa=JSON.stringify(c);this.xLb(hb)}}finally{ja&&
ja.dispose()}return 32}rtj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.renderColorPicker,1,l);a=this.gij();b={};b.currentColor=a;b.handleCommand=K.a.zHc;return this.ia.La(K.a.renderColorPicker,2,b)}vqj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.aCa,c,l);if(!l)return xa.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.La(K.a.aCa,c,l);32===a&&this.ia.La(K.a.QBa,c,l);return a}wtj(a,b,c,f,l){a=this.pa.tg();a=Ud.a("FixColorPickerPictureBorderColor")?this.Nwb(a,this.HX):
this.F9a(a,this.HX);a=this.pa.aP(a);if(1===c)return this.ia.La(K.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].Nua&&(c=pe.Box4ColorHelper.cta(a[0].Nua));l={};l.currentColor=c;l.handleCommand=K.a.AHc;return this.ia.La(K.a.renderColorPicker,2,l)}$$f(a,b,c,f,l){f=this.pa.tg();b=this.F9a(f,this.HX);const x=!!b&&0<b.length;if(this.fc.AC(b))return 16;if(1===c)return x?32:8;if(!x)return 16;1<f.length?xa.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",f.length):
xa.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.Mdb&&1===b.length&&b[0].ud)return xa.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.La(K.a.NJa,c,l);c=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{c.nc(b[0]);c.jd=a;const H=this.pa.aP(b);for(const U of H)if(U.ud){if(!this.Mdb)continue;xa.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const ja=this.yc.JN(U);if(!ja){xa.a.J(512500353,815,
10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const ya=ja.i$a();for(const Va of ya){const hb=Va.cellShading;Zo.b(hb);hb.noFillField=new ay;Va.cellShading=hb}}else{const ja=this.BSf(U);ja&&(this.iJ.LRa(ja),ja.noFillField=new ay,U.fill=ja,U.Wfa=null,this.CHh(U,ja));U.GWk();this.xLb(U)}}finally{c&&c.dispose()}return 32}U9f(a,b,c,f,l){var x=this.ua.presentation;if(!x)throw Error.argumentNull("Presentation is null");f=this.pa.tg();b=this.Nwb(f,this.HX);if(!(b&&0<b.length)||this.fc.AC(b))return 16;
const H=this.pa.Jp();x=H?x.xC(H.slideId):null;if(!x||!x.ke||!x.ke.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=li.chd(l);if(!c)return 8;1<f.length?xa.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):xa.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var U of f)if(U.Jf||U.Ng){un(U);break}U=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{U.nc(b[0]);
U.jd=a;const ja=this.pa.aP(b);for(const ya of ja){const Va=this.D1d(ya);if(Va){this.iJ.LRa(Va);const hb=this.iJ.oV(l);Va.solidFillField=hb;ya.lineStyle=Va;ya.Nua=null;this.Oud(ya,Va)}ya.Gya=JSON.stringify(c);this.xLb(ya)}}finally{U&&U.dispose()}return 32}wqj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.Fia,c,l);if(!l)return xa.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.La(K.a.Fia,c,l);32===a&&this.ia.La(K.a.QBa,c,l);return a}Aqj(a,b,c,f,l){f=this.pa.tg();
b=this.Nwb(f,this.HX);if(!(b&&0<b.length)||this.fc.AC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.IUc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=li.cnh.length||0>c)return 8;1<f.length?xa.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):xa.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{l.nc(b[0]);
l.jd=a;const x=this.pa.aP(b);for(const H of x){const U=this.D1d(H);U&&(U.wField=li.Y4k[c],U.wFieldSpecified=!0,this.Oud(H,U),this.sSf(U),H.lineStyle=U);H.outlineWidth=li.cnh[c];this.xLb(H)}}finally{l&&l.dispose()}return 32}xLb(a){this.Fa.EL(a)&&Tc.a.Ib&&(Tc.a.Ib.Nj=!0)}BSf(a){if(!this.CEg)return null;let b=a.fill;b||!a.EL&&!a.get_isSVGBlipFilled()||(b=new DN.a);return b}D1d(a){var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.CEg)return null;let c=a.lineStyle;
if(this.lxe&&a.L_c()&&c&&c.wFieldSpecified){b=Object(oa.a)(116,b.xC(a.slideId));var f=this.fj.KG;b&&b.Rw&&null!=b.Rw.Zr&&(f=b.Rw.Zr);b=c.wField/f;f=this.m6b(a);if(!f||!f.aQa||!f.SHc)return c.wField=b,c;var l;(l=f.Ok&&f.Ok.kH&&f.Ok.kH.yL()&&1===f.Ok.kH.xa.childNodes.length?f.Ok.kH.xa.childNodes[0].getAttribute("width"):f.aQa.getAttribute("width"))&&!ha.a.Wa(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.ghi*f.SHc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.EL&&!a.get_isSVGBlipFilled()||
(c=new xR.a);return c}sSf(a){if(a.noFillField||Zo.e(a))a.noFillField=null,a.solidFillField=Object.assign(new Vu.a,{schemeClrField:Object.assign(new lh.a,{valField:1})})}xqj(a,b,c,f,l){f=this.pa.tg();b=this.Nwb(f,this.HX);if(!(b&&0<b.length)||this.fc.AC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.IUc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?xa.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):xa.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{l.nc(b[0]);l.jd=a;const x=this.pa.aP(b);for(const H of x){const U=this.D1d(H);U&&(U.prstDashField=U.prstDashField||new yR.a,U.prstDashField.valField=this.Ofj(c),U.prstDashField.valFieldSpecified=!0,U.custDashField=null,this.Oud(H,U),this.sSf(U),H.lineStyle=U);H.WO=c;this.xLb(H)}}finally{l&&l.dispose()}return 32}Ofj(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}yqj(a,b,c,f,l){f=this.pa.tg();b=li.Fbj(f);if(!(b&&0<b.length)||this.fc.AC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.IUc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=li.Qmh.length)return 8;c=li.Qmh[l];l=li.U4k[l];1<f.length?xa.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):xa.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{f.nc(b[0]);f.jd=a;const x=this.pa.aP(Array.isArray(b)?b:null);for(const H of x)H.rdl(c,l)}finally{f&&f.dispose()}return 32}aag(a,b,c){const f=this.pa.tg();b=this.Nwb(f,this.HX);if(!(b&&0<b.length)||this.fc.AC(b))return 16;if(1===c)return 32;1<f.length?xa.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):xa.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{c.nc(b[0]);c.jd=a;const l=this.pa.aP(b);for(const x of l){const H=x.lineStyle;H&&(this.iJ.LRa(H),H.noFillField=new ay,x.lineStyle=H,x.Nua=null,this.Oud(x,H));x.lXk();this.xLb(x)}}finally{c&&c.dispose()}return 32}zqj(a,b,c,f,l){f=this.pa.tg();b=this.Nwb(f,this.HX);if(!(b&&0<b.length)||li.h7k(f))return 8;if(this.fc.AC(b))return 16;if(1===c)return 32;if(!l)return xa.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.IUc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return xa.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?xa.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):xa.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{l.nc(b[0]);l.jd=a;for(const x of b)x.Vkc=c,
x.setValue(kb.a.T$b,!0)}finally{l&&l.dispose()}return 32}Nwj(a,b,c){b=this.pa.tg();a=this.pa.Jp();if(!(this.QC.isActive||1===b.length&&a&&a.ozh||this.Sp&&this.pa.Zka()))return 16;if(1===c)return 32;if(this.fc.$c(a))return 16;c=32;if(this.QC.isActive)this.QC.pQa();else if(this.Sp)if(this.VQ.wL)this.VQ.wL=!1;else{b=this.pa.Na.mb;var f=null;if(b&&(f=b.Ua)&&(f.contextId===Cb.a.Pf||f.contextId===Cb.a.textRange||f.contextId===Cb.a.endOfParagraph||f.contextId===Cb.a.paragraph))c=this.ia.processAction(D.a.HQc,
2);else if(a.ud&&this.pa.K_(this.pa.Na)){if(b=a.vUc())if(b=b.qf(0,0)){b.pal(this.VQ);var l=b.n4b;f=-1;l&&(f=Sb.ParagraphReader.textLength(Object(oa.a)(ug.a,l))+1);if(l=this.Vb.xi){const x=this.Jb.me(4),H=l.zi;x.nc(l);const U=this.nU.nEa(H),ja=Object(oa.a)(116,this.zve.J6f(b));this.nU.e5e(U,!0,!1,ja,a,b,null,0,f);(a=H.Jmc(U))&&l.WAb(a);x.dispose()}}}else this.QC.v$g(a)}else this.QC.v$g(a);Oc.App.Kb.updateCommandUI();return c}mqj(a,b,c){return this.Sp&&(a=this.pa.Na.mb)&&(a=a.Ua)&&(a.contextId===Cb.a.Pf||
a.contextId===Cb.a.textRange||a.contextId===Cb.a.endOfParagraph||a.contextId===Cb.a.paragraph)?(this.QC.pQa(),this.ia.processAction(K.a.F4d,2)):(a=this.pa.Jp())?this.ia.La(K.a.E4d,c,new mA(this.QC.iul,a)):16}nqj(a,b,c,f,l){if(!l||!Object(Xa.a)(mA,l))return xa.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.Sp&&this.VQ.wL)return this.VQ.wL=!1,16;b=l.Ksc;if(!(this.QC.isActive&&b&&b.nzh))return this.QC.pQa(),16;if(this.fc.$c(b))return 16;if(1===c)return 32;
Tc.a.Ib&&(Tc.a.Ib.Nj=!1,Tc.a.Ib.actionName="FormatPainterApplyToShape",Tc.a.Ib.Ur=!0);c=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{c.nc(l.Ksc),c.jd=a,l.Ksc.Qvb=l.jul.id}finally{c&&c.dispose()}this.QC.pQa();return 32}Ouj(a,b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return 8;l.Mf(this.QC.isActive||(this.Sp?this.VQ.wL:!1));return 32}ULk(a,b,c){return(a=this.m6b(a))&&Object(Xa.a)(Ss.a,a.Ok)&&(a=Object(oa.a)(Ss.a,a.Ok))?a.lNe(K.a.Wz(b),c):!1}cbe(a,b,c){return(a=this.m6b(a))&&Object(Xa.a)(Ss.a,
a.Ok)&&(a=Object(oa.a)(Ss.a,a.Ok))?a.Ahd(K.a.Wz(b),c):!1}IUc(a){return a.split(",")[1]}CHh(a,b){if(this.lxe&&a.L_c()){var c=this.m6b(a),f=this.DIf(c,a);a=b.noFillField?null:this.TJ(b,a);f=this.Afb.sAl(f,a);this.xwf(c,f)}}Oud(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.lxe&&a.L_c()){var f=this.m6b(a),l=this.DIf(f,a);if(null!==l){if(b.noFillField)l=this.Afb.JEh(l);else{if(b.wFieldSpecified){var x=Object(oa.a)(116,c.xC(a.slideId)),H=this.fj.KG;x&&x.Rw&&
null!=x.Rw.Zr&&(H=x.Rw.Zr);l=this.Afb.KEh(l,b.wField,f.vd,H)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.Afb.tAl(l,b.prstDashField.valField));if(b.solidFillField){b=this.TJ(b,a);l=this.Afb.JEh(l,b);if(!l)return;b=l.querySelectorAll(this.Afb.n0e);x=!0;for(H=0;H<b.length;++H){const U=b[H].getAttribute("stroke-width");if(U&&!ha.a.Wa(U.toString())){x=!1;break}}x&&(a=Object(oa.a)(116,c.xC(a.slideId)),c=this.fj.KG,a&&a.Rw&&null!=a.Rw.Zr&&(c=a.Rw.Zr),l=this.Afb.KEh(l,ye.a.QKe/this.JKe,f.vd,
c))}}this.xwf(f,l)}}}TJ(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.xC(b.slideId);return this.iJ.AKb(a,b.ke)}xwf(a,b){if(b&&a&&a.Ok){a.Ok.QZ.Qd(!1);var c=a.Ok.kH.xa.childNodes;for(let f=0;f<c.length;++f)a.Ok.kH.xa.removeChild(c[f]);a.Ok.kH.xa.appendChild(b);(b=a.aQa.getAttribute("transform"))&&a.Ok.kH.xa.setAttribute("transform",b.toString());a.Ok.kH.Qd(!0);Tc.a.Ib&&(Tc.a.Ib.Nj=!0,Tc.a.Ib.sF=new Date)}}tmg(a,b,c){return Ud.a("EnableSmartArtFillColor")&&
this.ULk(a,b,c)}gij(){var a=this.pa.tg();a=this.F9a(a,this.HX);var b=this.pa.aP(a),c=null;a=null;Ud.a("FixColorPickerSelectedColor")&&(a=this.ua.Ba);if(1===b.length){if(b[0].Wfa)c=pe.Box4ColorHelper.cta(b[0].Wfa);else if(b[0].ud&&Ud.a("FixColorPickerSelectedColor")){const f=this.pa.xv();if(!f||!f.length){if(b=this.pa.Zm())b=b.qf(0,0),c=pe.Box4ColorHelper.UDa(b.cellShading.solidFillField,a.ke);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?pe.Box4ColorHelper.UDa(c.cellShading.solidFillField,
a.ke):this.qA.BRc(Object(oa.a)(ug.a,c))}!c&&Ud.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=pe.Box4ColorHelper.UDa(b[0].fill.solidFillField,a.ke))}return c}dwl(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.wC(a).isHiddenShape;this.tdl(a,b)}cwl(a,b){a.isHiddenShape=!b;const c=Object(oa.a)(117,a.sc(this.vz));b?c.gMa():(c.wka(),this.pa.fX(a)&&this.pa.p8(a))}tdl(a,b){const c=this.Jb.Ad(15,void 0,()=>{this.pa.ij()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.wC(a);c.nc(l);this.cwl(l,b)}finally{c&&c.dispose()}}qdl(a,b){const c=this.Jb.Ad(15,void 0,()=>{this.pa.ij()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.wC(a);c.nc(l);l.shapeName=b}finally{c&&c.dispose()}}eij(){var a=this.pa.tg();a=this.F9a(a,this.HX);return this.pa.aP(a)}iij(a){const b=this.eij();return b&&1===b.length?b[0].ud?this.qA.v_f(this.pa.xv()):b[0].fill&&b[0].fill.solidFillField?pe.Box4ColorHelper.UDa(b[0].fill.solidFillField,a):null:
null}hij(a){const b=this.pa.tg();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?pe.Box4ColorHelper.UDa(b[0].lineStyle.solidFillField,a):null}m6b(a){return a?Object(oa.a)(117,a.sc(this.vz)):null}DIf(a,b){try{if(!(a&&a.aQa&&a.Ok&&a.Ok.kH))return null;if(a.Ok.kH.yL()){if(!a.Ok.kH.xa)return null;const l=a.Ok.kH.xa.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.aQa.getAttribute(Pk.a.JWc))return null;let c=a.aQa.getAttribute(Pk.a.JWc).toString();
if(!c.toLowerCase().startsWith(this.fsl))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.Fxe.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.UTa=!0,null)}catch(c){return xa.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static Lhj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static Fbj(a){if(!a)return null;const b=[];for(const c of a)c.az&&
Array.add(b,c);return b}static h7k(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static chd(a){return qu.a.parse(a.Color)}}li.cnh=[.5,1,2.25,4.5];li.Y4k=[6350,12700,28575,57150];li.Qmh=[0,0,2,2,0,1,1];li.U4k=[0,2,0,2,1,0,1];li.LBf='<Menu Id="{0}">';li.RBf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';li.PBf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
li.QBf="</Controls> </MenuSection>";li.Zmi='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';li.Xmi='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';li.Ymi="</Controls> </MenuSection>";li.bni='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';li.$mi='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
li.ani="</Controls> </MenuSection>";li.KBf="</Menu>";Object(m.a)(li,"ShapesFormatActor",null,[352]);var hj=d(230);class si{constructor(a,b,c){this.iad=Array(si.lW);this.g8c=Array(si.lW);this.Yoe=Array(si.lW);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.oJ=a;this.Bm=b;this.Sbd=c;this.gwa={}}dispose(){Array.clear(this.iad);Array.clear(this.g8c);this.Bm=this.oJ=null;const a=pa.a.lL(this.gwa);
a.length&&appChrome.api.unregisterIcons(a);this.gwa=null}get hj(){return this.oJ.MasterId}$5b(a,b,c){const f=Object.assign(new tm.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new hk.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var x=c?"GraphicsStyleSection":"ApplyShapeStyleSection",H=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";x=
Object.assign(new sq.a,{Id:"ControlsShapeStyles",ExternalId:x,ExternalGalleryId:H,Type:4,Width:si.lW,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,x);l=si.lW*(a?si.iBf:si.mBf);c&&(l=si.lW*si.lBf);for(H=0;H<l;++H){const U=c?"ApplyGraphicsStyle"+H:"ApplyShapeStyle"+H;Array.add(x.GalleryItems,c?this.$4d(U,H,a,b,!0):this.$4d(U,H,a,b,!1))}return f}$4d(a,b,c,f,l){if(l){var x=this.oJ?this.oJ.SVGStyles[b]:null;c="SVGStyle";x=x?x.ToolTip:""}else x=this.oJ?this.oJ.ShapeStyles[b]:
null,c=c?"LineStyle":"ShapeStyle",x=x?this.c$d(x.StyleId):"";return Object.assign(new nE.a,{Id:a,ExternalId:a,Icon:si.a6b(c,f,b),PreviewIconStyle:si.Qfj(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:x})}Qkd(a){this.addIconToMap(this.oJ.ShapeStyles,"ShapeStyle");this.addIconToMap(this.oJ.LineStyles,"LineStyle");a&&this.addIconToMap(this.oJ.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.gwa)}Qij(a){if(a<si.lW&&this.iad[a])return this.iad[a];if(a>=
this.oJ.ShapeStyles.length)return"";var b=this.oJ.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.c$d(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.G6d(this.Sbd.resolve(ee.a.Uub,
b.Icon.ImgId,"StyleGallery")),l,f);a<si.lW&&(this.iad[a]=b);return b}Jhj(a){if(a<si.lW&&this.Yoe[a])return this.Yoe[a];if(a>=this.oJ.SVGStyles.length)return"";var b=this.oJ.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),
l=this.U5f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.G6d(this.Sbd.resolve(ee.a.Uub,b.Icon.ImgId,"StyleGallery")),l,f);a<si.lW&&(this.Yoe[a]=b);return b}Dbj(a){if(a<si.lW&&this.g8c[a])return this.g8c[a];if(a>=this.oJ.LineStyles.length)return"";var b=this.oJ.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-
b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.n3f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.G6d(this.Sbd.resolve(ee.a.Uub,b.Icon.ImgId,"StyleGallery")),l,f);a<si.lW&&(this.g8c[a]=b);return b}c$d(a){let b=null;switch(parseInt(String(a/si.lW))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;
break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,EBh:c}=this.R_f(a));return String.format(b,a.toString(),c)}U5f(a){return(a=this.oJ?this.oJ.SVGStyles[a]:null)?a.ToolTip:""}n3f(a){let b=null;switch(parseInt(String(a/si.lW))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;
break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,EBh:c}=this.R_f(a));return String.format(b,a.toString(),c)}G6d(a){return null===a?"":ha.a.h8b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=si.a6b(b,this.hj,f),x={},H={};H.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);H.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);H.position="absolute";x.root=H;c=appChrome.buildImageIconFromUrl(this.Sbd.resolve(ee.a.Uub,c.Icon.ImgId,"StyleGallery"),x);this.gwa[l]=
c}}R_f(a){let b,c;c=b=null;a%=si.lW;switch(a){case 0:b=hj.Color.Ti(this.Bm.Dark1);c=String.format(ResourceStrings.l_DarkFormat,1);break;case 1:b=hj.Color.Ti(this.Bm.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=hj.Color.Ti(this.Bm.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=hj.Color.Ti(this.Bm.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=hj.Color.Ti(this.Bm.Accent4);c=String.format(ResourceStrings.L_AccentFormat,
a);break;case 5:b=hj.Color.Ti(this.Bm.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=hj.Color.Ti(this.Bm.Accent6),c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,EBh:c}}static get lii(){return si.x4k}static get jii(){return si.v4k}static get kii(){return si.w4k}static Qfj(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;
return a}static E5d(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');a*=si.lW;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?K.a.nZb:K.a.Nrb,b?K.a.djd:K.a.Gjd));c.append("</Gallery> </MenuSection>");c.append("</Menu>");
return c.toString()}static a6b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}si.lW=7;si.mBf=6;si.lBf=4;si.iBf=3;si.x4k=si.E5d(si.mBf,!1);si.w4k=si.E5d(si.iBf,!1);si.v4k=si.E5d(si.lBf,!0);Object(m.a)(si,"StyleGalleryBuilder",null,[106]);class FN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.tFb="";this.tCb=[];this.ia=a;this.jq=b;this.hf=c;this.Ea=l;this.Jb=f;this.Mu=x;this.NEb=H;this.pa=U;this.Fa=ja;this.Xa=ya;this.HX=Va;hb.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.Xa.xuf(Object(F.a)(this,
this.bgd,"onSessionInfoChanged"))}wb(){this.ia.ra(K.a.Gjd,rc.a.application,Object(F.a)(this,this.Ruj,"handleQueryShapesStyle"),97);this.ia.ra(K.a.aLe,rc.a.application,Object(F.a)(this,this.yuj,"handlePopulateShapesStyles"),96);this.ia.ra(K.a.Nrb,rc.a.application,Object(F.a)(this,this.Bqj,"handleApplyShapesStyle"),4);this.ia.ra(K.a.djd,rc.a.application,Object(F.a)(this,this.Puj,"handleQueryGraphicsStyle"),97);this.ia.ra(K.a.XKe,rc.a.application,Object(F.a)(this,this.vuj,"handlePopulateGraphicsStyles"),
96);this.ia.ra(K.a.nZb,rc.a.application,Object(F.a)(this,this.pqj,"handleApplyGraphicsStyle"),4)}Ee(){}Puj(a,b,c,f,l){return this.xTf(l,!0)}Ruj(a,b,c,f,l){return this.xTf(l,!1)}xTf(a,b){var c=this.jq.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(!a||!Object(Xa.a)(Jv,a))return 8;var f=a.XU.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.XU.substr(f.length));if(isNaN(f)||0>f)return xa.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",
b?"Graphics":"Shapes"),8;var l=this.pa.tg();if(!l||!l.length)return 16;const x=a.VZa;if(!x)return 8;var H=c.xC(l[0].slideId);if(!H)return 16;c=H.hj;H=this.g2f(H);a.XU.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.tFb=(l=this.UYb(l))?"SGT_Line":"SGT_Shape",x.w3=H?H.$4d(a.XU,f,l,c,b?!0:!1):null):H?(this.UYb(l)?(this.tFb="SGT_Line",x.QDa=H.Dbj(f),x.awb=H.n3f(f)):b?(this.tFb="SGT_SVG",x.QDa=H.Jhj(f),x.awb=H.U5f(f)):(this.tFb="SGT_Shape",x.QDa=H.Qij(f),x.awb=H.c$d(f)),x.VU(!1)):(x.QDa="",
x.awb="");return 32}vuj(a,b,c,f,l){return this.vTf(c,l,!0)}yuj(a,b,c,f,l){return this.pa.tUa()?8:this.vTf(c,l,!1)}vTf(a,b,c){var f=this.jq.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return xa.a.J(509678937,822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.pa.tg();f=a[0]?f.xC(a[0].slideId):null;const l=this.g2f(f);if(b.MenuId&&"style"===b.MenuId)this.UYb(a)?b.PopulationXML=si.kii:b.PopulationXML=c?si.jii:si.lii;
else{this.tFb=(a=this.UYb(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.$5b(a,f.hj,c?!0:!1):null}return 32}pqj(a,b,c,f,l){if(Ud.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.jij().length)return 8}else if(!this.Fa.nsc(this.pa.tg()))return 16;return this.V9f(a,c,l,!0)}jij(){var a=this.pa.Wd();const b=[];let c=!1;for(const f of a){if(!f)return b.length=0,b;f.Ng&&(c=!0)}if(c)for(const f of a)f.Ng&&this.Fa.nsc([f])&&b.push(f);else for(const f of a)if(this.Fa.nsc([f]))b.push(f);
else if(f.Jf){a=this.Fa.ex(f);for(const l of a)this.Fa.nsc([l])&&b.push(l)}return b}Bqj(a,b,c,f,l){return this.Vfl(this.pa.tg())?this.V9f(a,c,l,!1):16}V9f(a,b,c,f){var l=this.jq.presentation;if(!l)throw Error.argumentNull("Presentation is null");const x=this.pa.tg();if(!x||!x.length||this.hf.AC(x))return 16;l=l.xC(x[0].slideId);var H=this.Mu.E3f(l);if(!H)return this.Mu.$pl(l),xa.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;
if(!c)return xa.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.UYb(x)?H.LineStyles.length:H.ShapeStyles.length;H=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(H.length));if(isNaN(c)||0>c||c>=b)return xa.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===x.length?xa.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",
f?"Graphics":"Shapes",f?"SVG":"Shape"):1<x.length&&xa.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":"Shapes",x.length,f?"SVGs":"Shapes");f=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.ij()});try{f.nc(Object(oa.a)(116,l));f.jd=a;const U=this.pa.aP(Array.isArray(x)?x:null);for(const ja of U)ja&&ja.sdl(c,this.tFb)}finally{f&&f.dispose()}return 32}bgd(){for(const a of this.tCb)a.dispose();Array.clear(this.tCb)}g2f(a){const b=this.Mu.E3f(a);if(!b||
!a)return xa.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.tCb)if(c.hj===a.hj)return c;a=new si(b,a.ke,this.NEb);Array.add(this.tCb,a);a.Qkd(this.HX);return a}Vfl(a){if(!a||!a.length||this.Fa.$Gc(a))return!1;for(const b of a)if(b.qua)return!0;return!1}UYb(a){if(!a)return!1;for(const b of a)if(!b.az)return!1;return!0}Do(){this.lxa()}lxa(){this.Mu.clearCache();for(const a of this.tCb)a.dispose();Array.clear(this.tCb)}}
Object(m.a)(FN,"ShapesStyleActor",null,[352,1017]);class Nv{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.zx=this.Om=-1;this.Ms=a;this.ia=b;this.Ea=c;this.hf=f;this.lz=l;this.pa=x;this.ki=H;this.Fa=U;this.r$j=ja;this.w$j=ya;this.fma=Va;this.yc=hb}get Lb(){return this.pa}wb(){this.ia.ra(K.a.k0a,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.l0a,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.m0a,rc.a.application,Object(F.a)(this,
this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.Jqc,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.vMb,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.cMb,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.$Lb,rc.a.application,Object(F.a)(this,this.n7b,"handleFont"),5);this.ia.ra(K.a.Rjb,rc.a.application,Object(F.a)(this,this.n7b,"handleFont"),5);this.ia.ra(K.a.Sjb,rc.a.application,
Object(F.a)(this,this.n7b,"handleFont"),5);this.ia.ra(K.a.XWe,rc.a.application,Object(F.a)(this,this.tuj,"handlePopulateFontNameDropdown"),97);this.ia.ra(K.a.dkb,rc.a.application,Object(F.a)(this,this.n7b,"handleFont"),4);this.ia.ra(K.a.tMb,rc.a.application,Object(F.a)(this,this.n7b,"handleFont"),4);this.ia.ra(K.a.Nqc,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.Mqc,rc.a.application,Object(F.a)(this,this.xTa,"handleFontFormatAction"),4);this.ia.ra(K.a.onc,
rc.a.application,Object(F.a)(this,this.Nxb,"handleQueryFontToggleButton"),97);this.ia.ra(K.a.pnc,rc.a.application,Object(F.a)(this,this.Nxb,"handleQueryFontToggleButton"),97);this.ia.ra(K.a.rnc,rc.a.application,Object(F.a)(this,this.Nxb,"handleQueryFontToggleButton"),97);this.ia.ra(K.a.qnc,rc.a.application,Object(F.a)(this,this.Nxb,"handleQueryFontToggleButton"),97);this.ia.ra(K.a.zjd,rc.a.application,Object(F.a)(this,this.zVc,"handleQueryFont"),100);this.ia.ra(K.a.yjd,rc.a.application,Object(F.a)(this,
this.zVc,"handleQueryFont"),100);this.ia.ra(K.a.Ajd,rc.a.application,Object(F.a)(this,this.zVc,"handleQueryFont"),97);this.ia.ra(K.a.Bjd,rc.a.application,Object(F.a)(this,this.zVc,"handleQueryFont"),97);this.ia.ra(K.a.Ijd,rc.a.application,Object(F.a)(this,this.Nxb,"handleQueryFontToggleButton"),97);this.ia.ra(K.a.Hjd,rc.a.application,Object(F.a)(this,this.Nxb,"handleQueryFontToggleButton"),97)}Ee(){const a=this.Ea.Fc(zb.a.sg);a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_Bold),K.a.k0a);a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_Italic),
K.a.l0a);a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_Underline),K.a.m0a);a.bindAction(y.KeyInputManager.Oa(A.a.uMa,y.KeyInputManager.Oe|4),K.a.Jqc);a.bindAction(y.KeyInputManager.Oa(A.a.ivd,y.KeyInputManager.Oe|4),K.a.vMb)}zVc(a,b,c,f,l){c=this.Lb.tg();if(!c||1>c.length)return 16;f=this.Fa.p_(c);var x=this.Lb.nka();if(1>f.length&&!x)return 16;b=null;this.Om=Date.now();x&&(b=this.yc.h0f(x,new ct),this.zx=Date.now(),xa.a.J(512500294,815,50,"Query table shape font timespan by {0}",(this.zx-
this.Om).toString()));c=x?[c[0]]:f;for(const H of c){switch(a){case K.a.zjd:case K.a.yjd:break;case K.a.Ajd:c=this.lz.K5b(H.ud&&b?b.fontName:H.aOb);if(l.YZ&&l.YZ!==c){l.YZ="";break}l.YZ=c;l.Qpc();break;case K.a.Bjd:c="";H.ud&&b?-1!==b.fontSize&&(c=ha.a.GQc(b.fontSize/2,0,u.AFrameworkApplication.numberFormat)):c=H.Paa?Nv.f0f(H).toString():"";f=parseFloat(c);if(!isNaN(f)&&(x=l.YZ)&&x!==c){x=Math.min(f,parseFloat(x)).toString()+"+";l.YZ=x;break}l.YZ=c;l.Qpc();break;default:return xa.a.J(512500293,820,
10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.YZ&&!l.YZ.length)break}return 32}Nxb(a,b,c,f,l){b=this.Lb.tg();if(!b||1>b.length)return 16;b=this.Fa.p_(b);c=this.Lb.nka();if(1>b.length&&!c)return 16;a=c?this.MMk(c,a,new ct):this.wdh(b,a);l.Mf("select"===a);return"disable"!==a?32:8}n7b(a,b,c,f,l){b=this.Lb.tg();if(!b||1>b.length)return 16;const x=this.Lb.nka();f=this.Fa.p_(b);if(1>f.length&&!x||this.hf.AC(f)||this.hf.AC([x]))return 16;if(1===c)return 32;this.Lb.ij();this.Ea.Ed();switch(a){case K.a.$Lb:const U=
this.Cta(l,!0);if(!U)return 8;1<b.length?xa.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):xa.a.J(512500291,815,50,"Set one shape font color.");for(const hb of b)if(hb.Jf||hb.Ng){un(hb);break}this.Ms.Ija(hb=>{hb.PLa=U},f);break;case K.a.dkb:case K.a.tMb:let ja;if(a===K.a.dkb){if(ja=this.Cta(l,!1),!ja)return 8}else ja="";1<b.length?xa.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):xa.a.J(512500289,815,50,"Set one shape highlight.");this.Ms.Ija(hb=>{hb.highlight=ja},f);break;
case K.a.Rjb:if(!l)return 8;const ya=this.lz.K5b(l);if(ya.length){1<b.length?xa.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):xa.a.J(512500259,815,50,"Set one shape font name.");var H=null;for(const hb of b)if(hb.Jf||hb.Ng)un(hb),hb.Jf&&(H=hb);if(1>this.Q3f(f,a,ya).length)return 16;this.Ms.Ija(hb=>{hb.aOb=ya},f);H&&(H.aOb=ya);this.lz.aGc(l)}break;case K.a.Sjb:l=Object(oa.a)(qE.a,l);if(!l||!l.rd)return 8;const Va=this.ki.J0b(l.rd);if(isNaN(Va))return 8;1<b.length?xa.a.J(512500258,815,
50,"Set {0} shapes font size.",b.length):xa.a.J(512500257,815,50,"Set one shape font size.");l=null;for(H of b)if(H.Jf||H.Ng)un(H),H.Jf&&(l=H);if(1>this.Q3f(f,a,Va*Gf.a.S$a).length)return 16;this.Ms.Ija(hb=>{hb.Prh(Va)},f);l&&l.Prh(Va);break;default:return xa.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}xTa(a,b,c){b=this.Lb.tg();if(!b||1>b.length)return 16;const f=this.Lb.nka(),l=this.Fa.p_(b);if(1>l.length&&!f||this.hf.AC(l)||this.hf.AC([f]))return 16;if(1===c)return 32;
const x="select"!==this.wdh(this.Fa.p_(b),a);this.Lb.ij();this.Ea.Ed();switch(a){case K.a.k0a:1<b.length?xa.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):xa.a.J(512500254,815,50,"Set one shape bold.");f&&Object(Ud.a)("FixTableModifyFontShortcut")&&this.ia.processAction(K.a.bold,2);this.Ms.Ija(U=>{U.isBold=x},l);break;case K.a.l0a:1<b.length?xa.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):xa.a.J(512500252,815,50,"Set one shape italic.");f&&Object(Ud.a)("FixTableModifyFontShortcut")&&
this.ia.processAction(K.a.setItalic,2);this.Ms.Ija(U=>{U.isItalic=x},l);break;case K.a.m0a:1<b.length?xa.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):xa.a.J(512500250,815,50,"Set one shape underline.");f&&Object(Ud.a)("FixTableModifyFontShortcut")&&this.ia.processAction(K.a.underline,2);this.Ms.Ija(U=>{U.iE=x},l);break;case K.a.cMb:1<b.length?xa.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):xa.a.J(512500248,815,50,"Set one shape strikethrough.");this.Ms.Ija(U=>{U.PF=
x},l);break;case K.a.Jqc:case K.a.vMb:const H=a===K.a.vMb?!1:!0;1<b.length?xa.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):xa.a.J(512500246,815,50,"Step one shape font size.");this.Ms.Ija(U=>{U.uAb=H},l);break;case K.a.Nqc:1<b.length?xa.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):xa.a.J(512500244,815,50,"Step one shape superscript.");this.Ms.Ija(U=>{U.oN=x?3E4:0},l);break;case K.a.Mqc:1<b.length?xa.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):xa.a.J(512500242,
815,50,"Step one shape subscript.");this.Ms.Ija(U=>{U.oN=x?-25E3:0},l);break;default:return 8}return 32}tuj(a,b,c,f,l){if(1===c)return 32;Kd.Font.iee(b);l.MenuItems=da.FontUtils.PYf(Nv.hqd,Nv.JQc,this.r$j,this.fma,this.w$j);return 32}wdh(a,b){let c="select";for(const f of a){switch(b){case K.a.onc:case K.a.k0a:c=f.isBold?"select":"normal";break;case K.a.pnc:case K.a.l0a:c=f.isItalic?"select":"normal";break;case K.a.rnc:case K.a.m0a:c=f.iE?"select":"normal";break;case K.a.qnc:case K.a.cMb:c=f.PF?"select":
"normal";break;case K.a.Ijd:case K.a.Nqc:c=0<f.oN?"select":"normal";break;case K.a.Hjd:case K.a.Mqc:c=0>f.oN?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}MMk(a,b,c){this.Om=Date.now();c=this.yc.h0f(a,c);switch(b){case K.a.onc:a=1===c.bold?"select":"normal";break;case K.a.pnc:a=1===c.italic?"select":"normal";break;case K.a.rnc:a=1===c.underline?"select":"normal";break;case K.a.qnc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.zx=Date.now();
xa.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.zx-this.Om).toString());return a}Q3f(a,b,c){const f=[];for(const l of a)switch(b){case K.a.k0a:l.isBold!==c&&Array.add(f,l);break;case K.a.l0a:l.isItalic!==c&&Array.add(f,l);break;case K.a.m0a:l.iE!==c&&Array.add(f,l);break;case K.a.cMb:l.PF!==c&&Array.add(f,l);break;case K.a.Rjb:l.aOb!==c&&Array.add(f,l);break;case K.a.Sjb:Nv.f0f(l)!==c&&Array.add(f,l);break;case K.a.Nqc:0<l.oN!==c&&Array.add(f,l);break;case K.a.Mqc:0>l.oN!==
c&&Array.add(f,l);break;default:xa.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return f}Cta(a,b){if(b)return b=zn.SchemeColor.parse(a),b&&b.Kta?Ol.i(Ol.g(b.ZP)):(xa.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=qu.a.parse(a);return b&&b.RGBColor?b.RGBColor:(xa.a.J(512500238,820,10,"Color '{0}' is incorrect",a),null)}static JQc(a,b){return b}static hqd(){return!1}static f0f(a){const b=a.R2;return bf.a.$y(b,1)?a.Paa:Math.round(a.Paa)*
b}}Object(m.a)(Nv,"ShapesTextFontActor",null,[352]);class GN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.zx=this.Om=-1;this.Ms=a;this.ia=b;this.Ea=c;this.hf=f;this.pa=l;this.Fa=x;this.Xdb=H;this.ZL=U;this.Qb=ja;this.Jb=ya;this.p2c=Va;this.yc=hb;this.lA=yb}get Lb(){return this.pa}wb(){this.ia.ra(K.a.rMb,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.bMb,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.Tjb,rc.a.application,Object(F.a)(this,
this.T8,"handleFormatAction"),4);this.ia.ra(K.a.sMb,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.fkb,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.aMb,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.Iqc,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.Ipd,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.fpd,rc.a.application,Object(F.a)(this,
this.T8,"handleFormatAction"),4);this.ia.ra(K.a.epd,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.dpd,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.cpd,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.VWe,rc.a.application,Object(F.a)(this,this.Y$f,"handleQueryLineSpacing"),4);this.ia.ra(K.a.tqc,rc.a.application,Object(F.a)(this,this.T8,"handleFormatAction"),4);this.ia.ra(K.a.cib,rc.a.application,
Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.dib,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.RZa,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.SZa,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.Djd,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.xjd,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),
97);this.ia.ra(K.a.Fjd,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.Cjd,rc.a.application,Object(F.a)(this,this.zTa,"handleQueryToggleButton"),97);this.ia.ra(K.a.Ljd,rc.a.application,Object(F.a)(this,this.rbe,"handleQueryTextAnchoring"),97);this.ia.ra(K.a.Kjd,rc.a.application,Object(F.a)(this,this.rbe,"handleQueryTextAnchoring"),97);this.ia.ra(K.a.Jjd,rc.a.application,Object(F.a)(this,this.rbe,"handleQueryTextAnchoring"),97);this.ia.ra(K.a.Ejd,rc.a.application,
Object(F.a)(this,this.Y$f,"handleQueryLineSpacing"),97)}Ee(){const a=this.Ea.Fc(zb.a.sg);a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_FullJustify),K.a.aMb);a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_CenterJustify),K.a.sMb);B.a.vk?(a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_LeftJustify_Mac),K.a.Tjb),a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_RightJustify_Mac),K.a.fkb)):(a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_LeftJustify),K.a.Tjb),a.bindAction(y.KeyInputManager.lw(ResourceStrings.l_HK_RightJustify),
K.a.fkb))}zTa(a,b,c,f,l){const x=this.Lb.tg();if(!x||1>x.length)return 16;b=this.Lb.nka();const H=this.Fa.p_(x);if(1>H.length&&!b)return 16;f=c=null;let U=a===K.a.cib?1:a===K.a.dib?2:18;Object(Xa.a)(Uh.a,l)?f=l:Object(Xa.a)(Jv,l)&&(f=l.VZa,U=l.menuItemId);l=b?[x[0]]:H;this.Om=Date.now();for(const ja of l){switch(a){case K.a.cib:c=ja.ud?this.N$d(U,a):this.Z9d(U,ja,a);break;case K.a.dib:c=ja.ud?this.N$d(U,a):this.Z9d(U,ja,a);break;case K.a.RZa:case K.a.SZa:c=ja.ud?this.N$d(U,a):this.Z9d(U,ja,a);break;
case K.a.Djd:c=ja.ud?1===this.yc.URc(b)?"select":"normal":1===ja.Jl?"select":"normal";break;case K.a.xjd:c=ja.ud?2===this.yc.URc(b)?"select":"normal":2===ja.Jl?"select":"normal";break;case K.a.Fjd:c=ja.ud?3===this.yc.URc(b)?"select":"normal":3===ja.Jl?"select":"normal";break;case K.a.Cjd:c=ja.ud?6===this.yc.URc(b)?"select":"normal":4===ja.Jl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Mf("select"===c);this.zx=Date.now();b&&xa.a.J(512500237,815,50,"Query table shape timespan by {0}",
(this.zx-this.Om).toString());return"disable"!==c?32:8}Z9d(a,b,c){return c===K.a.RZa||c===K.a.cib||c===K.a.SZa||c===K.a.dib?this.ZL.Mxf(b,a)?"select":"normal":"normal"}N$d(a,b){var c=!0,f=this.Lb.nka();f=Qd.SelectionFactory.CLc(Object(oa.a)(ug.a,f));for(const l of f){if(c=l.al?l.node:null)if(f=this.Qb.Nc(c),f.set(c),f.rc(11),f.Jg(11),c=this.lA.jw(f)){if(0===a){c=!1;break}if(b===K.a.cib)c=1===c.listType;else if(b===K.a.dib)c=0===c.listType;else if(b===K.a.RZa){f=this.ZL.zVa.ga(a).ZZb;const x=this.ZL.zVa.ga(a).wsb;
c=c.Sxb&&0<c.v9.length&&c.v9[0]===f&&c.H$a&&c.font===x}else b===K.a.SZa?(f=this.ZL.Ydd.ga(a).bSd,c=!!c.propertySet&&c.propertySet.Sa(kb.a.autonumberBulletType)&&c.propertySet.eb(kb.a.autonumberBulletType)===f):c=!1}else c=0===a?b===K.a.RZa||b===K.a.SZa?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}T8(a,b,c,f,l){f=this.Lb.tg();if(!f||1>f.length)return 16;b=this.Fa.p_(f);const x=this.Lb.nka(),H=!!x&&(a===K.a.Iqc||a===K.a.Ipd);if(!b.length&&!x||H||this.hf.AC(b)||this.hf.AC([x]))return 16;
if(1===c)return 32;this.Lb.ij();a!==K.a.tqc&&this.Ea.Ed();switch(a){case K.a.rMb:case K.a.bMb:if(Object.getType(l)!==Number)return 8;this.pdl(f,b,l);break;case K.a.Tjb:case K.a.sMb:case K.a.fkb:case K.a.aMb:var U=this.xNf(b);this.ndl(b,a,l);U&&this.pa.selectShape(U,!1);Tc.a.nP(!0,!1);break;case K.a.Iqc:case K.a.Ipd:l=[];const ja=a===K.a.Iqc?1:2;for(U of b)Array.add(l,U);1<f.length?xa.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):xa.a.J(512500235,815,50,"Set one shape text direction.");
this.Ms.x8a(Va=>{if(Va=Object(oa.a)(4,Va))Va.$Nb=ja},l);break;case K.a.tqc:if(!l||!Object(Xa.a)(Array,l)||1>l.length)return 8;Tc.a.Ib&&(Tc.a.Ib.Nj=!0);b=this.Jb.Ad(15);try{for(b.nc(l[0].B1),b.jd=a,a=0;a<l.length;a++)l[a].B1.Oia=l[a].T$.left,l[a].B1.Pia=l[a].T$.right,l[a].B1.Qia=l[a].T$.top,l[a].B1.Nia=l[a].T$.bottom}finally{b&&b.dispose()}Tc.a.nP(!0,!1);break;case K.a.fpd:case K.a.epd:case K.a.dpd:l=[];let ya=1;switch(a){case K.a.fpd:ya=0;break;case K.a.epd:ya=1;break;case K.a.dpd:ya=2}for(const Va of b)Array.add(l,
Va);xa.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",f.length);this.Ms.x8a(Va=>{if(Va=Object(oa.a)(4,Va))Va.$oa=ya},l);Tc.a.nP(!0,!1);break;case K.a.cpd:if(!l||Object.getType(l)!==Number)return 8;U=this.xNf(b);this.odl(b,l,a);U&&this.pa.selectShape(U,!1);Tc.a.nP(!0,!1);break;default:return 8}return 32}rbe(a,b,c,f,l){b=this.Lb.tg();if(!b||1>b.length)return 16;b=this.Lb.e7d(b);f=b.tAb;c=0;const x=this.Lb.nka();if(!f&&!x)return 16;switch(a){case K.a.Ljd:a=x?({txa:c}=this.yc.d3e(x)).returnValue&&
0===c?"select":"normal":0===b.$oa?"select":"normal";break;case K.a.Kjd:a=x?({txa:c}=this.yc.d3e(x)).returnValue&&1===c?"select":"normal":1===b.$oa?"select":"normal";break;case K.a.Jjd:a=x?({txa:c}=this.yc.d3e(x)).returnValue&&2===c?"select":"normal":2===b.$oa?"select":"normal";break;default:a="disable"}l.Mf("select"===a);return"disable"!==a?32:8}Y$f(a,b,c,f,l){c=this.Lb.tg();if(!c||1>c.length)return 16;b=this.Lb.nka();c=this.Fa.p_(c);if(!c.length&&!b)return 16;this.Om=Date.now();switch(a){case K.a.VWe:break;
case K.a.Ejd:a=new tN.a;a.unit=2;a.value=l.MenuItemId;f=!0;b&&(f=this.vjl(b,l),this.zx=Date.now(),xa.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.zx-this.Om).toString()));for(const x of c){b=this.Fa.Y9d(x);if(!b||!this.Xdb.Sxf(b,a)){f=!1;break}this.p2c&&2===b.unit&&(b.value=Math.max(0,b.value-this.Fa.w5d(x)))}l.queryResult.Mf(f);break;default:return 8}return 32}odl(a,b,c){const f=this.Jb.Ad(15);try{f.nc(a[0]);f.jd=c;for(const l of a)l.$sa();this.ia.La(K.a.Kna,2,b)}finally{f&&f.dispose()}}ndl(a,
b,c){const f=[];let l=0,x=0;switch(b){case K.a.Tjb:l=1;x=D.a.nla;break;case K.a.sMb:l=2;x=D.a.Xia;break;case K.a.fkb:l=3;x=D.a.toa;break;case K.a.aMb:l=4,x=D.a.PDa}a=this.pa.aP(a);for(const H of a)H.Jl!==l&&Array.add(f,H);if(x&&f.length){for(const H of a)if(H.Jf||H.Ng){un(H);break}a=this.Jb.Ad(15);try{a.nc(f[0]);for(const H of f)H.$sa(),H.eel(l);this.ia.La(x,2,c)}finally{a&&a.dispose()}}}pdl(a,b,c){const f=[];let l=1===c||2===c;for(const H of b)this.ZL.Mxf(H,c)||(l=!1,Array.add(f,H));1<a.length?xa.a.J(512500231,
815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):xa.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const H of a)if(H.Jf||H.Ng){un(H);break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const x=this.ZL.zVa.ga(c);0<a.length&&this.Ms.x8a(H=>{H.setValue(kb.a.ZNb,c);x&&(H.setValue(kb.a.mBh,x.wsb),H.setValue(kb.a.lBh,x.ZZb))},a)}vjl(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=Qd.SelectionFactory.CLc(Object(oa.a)(ug.a,a));for(const x of a){if(a=
x.al?x.node:null){a=this.Xdb.LW(a);const H=bf.a.$y(a.lineSpacing.value,f)&&2===a.lineSpacing.unit;if(-1===l)b=a.lineSpacing.unit,l=a.lineSpacing.value;else if(l!==a.lineSpacing.value||b!==a.lineSpacing.unit)l=b=0,c=!1;0!==b&&(c=H)}if(!c)break}return c}xNf(a){return 0<a.length&&a[0].Ng&&(a=this.Fa.ys(a[0]))?(this.pa.p8(a),a):null}}Object(m.a)(GN,"ShapesTextParagraphActor",null,[352]);var zR=d(683);class HN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.ia=a;this.hf=b;this.Jb=c;this.fA=f;this.Ea=
l;this.pa=x;this.Vb=H;this.ua=U;this.Tb=ja;this.Ha=ya;this.Lu=Va;this.Fb=hb;if(!yb)throw Error.argumentNull("GraphOperationEventHandler is null");this.Pg=yb}wb(){this.ia.ra(K.a.deleteObject,Cb.a.application,Object(F.a)(this,this.xrj,"handleDelete"),4);this.Ha.podsEnableSlideScoreCard&&this.ia.ra(K.a.ydh,de.a.frame,Object(F.a)(this,this.GFl,"updateSlideScore"),96);this.ia.ra(K.a.B0d,rc.a.application,Object(F.a)(this,this.Qrj,"handleDuplicate"),4);this.ia.ra(K.a.wsf,rc.a.application,Object(F.a)(this,
this.Ypj,"handleAddFirstSlide"),4);this.Ha.iSj?(this.ia.ra(K.a.xI,Cb.a.application,Object(F.a)(this,this.Hrj,"handleDeleteSlides"),4),this.ia.ra(K.a.jQ,rc.a.application,Object(F.a)(this,this.Trj,"handleDuplicateSlides"),4),this.Ha.Ace?(this.ia.ra(K.a.Z7b,rc.a.application,Object(F.a)(this,this.zsj,"handleHideSlides"),4),this.ia.ra(K.a.X3e,rc.a.application,Object(F.a)(this,this.Swj,"handleUnhideSlides"),4),this.Pg.hrb(Object(F.a)(this,this.bol,"slidesSelectionChangedHandler"))):this.ia.ra(K.a.Z7b,rc.a.application,
Object(F.a)(this,this.dbe,"handleHideSlidesOld"),4),this.ia.ra(K.a.Ojd,Cb.a.application,Object(F.a)(this,this.Uuj,"handleQuerySlidesHidden"),96)):(this.ia.ra(K.a.xI,Cb.a.application,Object(F.a)(this,this.Grj,"handleDeleteSlide"),4),this.ia.ra(K.a.jQ,rc.a.application,Object(F.a)(this,this.Srj,"handleDuplicateSlide"),4),this.ia.ra(K.a.Z7b,rc.a.application,Object(F.a)(this,this.ysj,"handleHideSlide"),4),this.ia.ra(K.a.Ojd,Cb.a.application,Object(F.a)(this,this.Tuj,"handleQuerySlideHidden"),96));this.ia.ra(K.a.WZd,
Cb.a.application,Object(F.a)(this,this.Arj,"handleDeleteFakeSlides"),2048);this.ia.ra(K.a.eFf,Cb.a.application,Object(F.a)(this,this.erj,"handleClearAndResizeSlideCanvas"),2048);this.ia.ya(K.a.Npd,rc.a.application,Object(F.a)(this,this.hwj,"handleShareSlide"));this.ia.ra(K.a.dOe,Cb.a.application,Object(F.a)(this,this.gbe,"handleIsDirectManipulationEnabled"),97)}Ee(){const a=this.Ea.Fc(Qi.a.PD);a.bindAction(y.KeyInputManager.Oa(A.a.ppa,0),K.a.xI);a.bindAction(y.KeyInputManager.Oa(A.a.TH,0),K.a.xI);
a.bindAction(y.KeyInputManager.Oa(A.a.EMa,y.KeyInputManager.Oe),K.a.jQ)}xrj(a,b,c,f,l){if(this.Ea.Ae)if(this.Ea.i8===Qi.a.PD||1===this.Fb.Fl||this.Ha.Jn&&this.Ea.i8===zb.a.MB)a=K.a.xI;else if(this.Ea.i8===zb.a.sg)a=K.a.c7a;else return 8;else return 8;return this.ia.La(a,c,l)}Grj(a,b,c){b=this.ua.Ba;if(!b||this.hf.$c(b)||this.Ha.FC&&1!==this.pa.Qe().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Tc.a.Ib&&(Tc.a.Ib.actionName="DeleteSlide",Tc.a.Ib.Ur=!1,Tc.a.Ib.Nj=!0,Tc.a.Ib.Va("SlideCount",
"1"));c=this.Vb.Ef;if(!c)return 16;const f=this.Jb.Ad(15,void 0,()=>{this.pa.Qh()});try{f.nc(c),f.jd=a,c.xI(b)}finally{f&&f.dispose()}this.hf.fw(c,a);a=[];a.push(b);this.Lu?this.Lu.skd(new EE.a(a)):xa.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}erj(a,b,c){a=this.Tb.XA(this.ua.i1c?this.ua.i1c.slideIndex:0);if(!a)return xa.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(oa.a)(573,a.sc(this.Fb.Ma));if(!a)return xa.a.J(512313373,
822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;xa.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.UVe(!1);a.updateOffSlideView(0,!0);return 32}Arj(a,b,c){b=[];for(const f of this.Tb.hwb())f.SN&&Array.add(b,f);if(!b.length||!this.ua.Ba)return xa.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;xa.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.tNf(b,"DeleteFakeSlide",
a)}Hrj(a,b,c){b=this.pa.Qe();if(!b||!b.length||!this.ua.Ba)return 16;for(const f of b)if(!f||this.hf.$c(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;return this.tNf(b,"DeleteSlide",a)}tNf(a,b,c){Tc.a.Ib&&(Tc.a.Ib.actionName=b,Tc.a.Ib.Ur=!1,Tc.a.Ib.Nj=!0,Tc.a.Ib.Va("SlideCount",a.length.toString()));1<a.length?xa.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):xa.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Vb.Ef;
if(!b)return 16;this.LKi(b,a,c,()=>{this.pa.Qh()});return 32}LKi(a,b,c,f){f=this.Jb.Ad(15,void 0,f);try{f.nc(a);for(const l of b)l&&!l.Cb.equals(this.ua.Ba.Cb)&&a.xI(l);a.xI(this.ua.Ba);f.jd=c}finally{f&&f.dispose()}this.Ha.unblockContentWhenDeletingSlideEnabled||this.hf.fw(a,c);this.Lu?this.Lu.skd(new EE.a(b)):xa.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}Tuj(a,b,c,f,l){a=this.ua.Ba;if(!a)return 16;l.Mf(a.en);return 32}Uuj(a,b,c,f,l){a=this.pa.Qe();
if(!a||!a.length)return 16;a=this.oRd(a);l.Mf(a);return 32}hwj(a,b,c,f,l){a=this.ua.Ba;if(!a||this.hf.$c(a)||1!==this.pa.Qe().length)return 16;if(1===c)return 32;Tc.a.Ib&&(Tc.a.Ib.Ur=!1,Tc.a.Ib.Va("SlideCount","1"));c=a.Cb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=zR.a(c);l.mode="copy";xa.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.La(G.a.Tsa,2,l);return 32}ysj(a,b,c){b=this.ua.Ba;if(!b||this.hf.$c(b)||this.Ha.FC&&1!==this.pa.Qe().length)return 16;if(1===
c)return 32;Tc.a.Ib&&(Tc.a.Ib.Ur=!1,Tc.a.Ib.Va("SlideCount","1"));c=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{1!==this.Fb.Fl&&(this.Ha.Jn?this.Ea.tf(zb.a.MB):this.Ea.tf(Qi.a.PD))});try{c.nc(b),c.jd=a,b.en=!b.en}finally{c&&c.dispose()}return 32}dbe(a,b,c){b=this.pa.Qe();if(!b||!b.length)return 16;for(var f of b)if(!f||this.hf.$c(f))return 8;if(1===c)return 32;xa.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Tc.a.Ib&&(Tc.a.Ib.Ur=!1,Tc.a.Ib.Va("SlideCount",
b.length.toString()));c=!this.oRd(b);f=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{1!==this.Fb.Fl&&(this.Ha.Jn?this.Ea.tf(zb.a.MB):this.Ea.tf(Qi.a.PD))});try{f.nc(this.Vb.Ef);f.jd=a;for(const l of b)l.en=c}finally{f&&f.dispose()}return 32}zsj(a,b,c,f,l){const x=this.pa.Qe();if(!x||!x.length)return 16;for(const H of x)if(!H||this.hf.$c(H))return 8;if(this.oRd(x))return this.JVc(),32;this.dbe(a,b,c,f,l);this.JVc();return 32}Swj(a,b,c,f,l){const x=this.pa.Qe();if(!x||!x.length)return 16;
for(const H of x)if(!H||this.hf.$c(H))return 8;if(1===c)return 32;this.dbe(a,b,c,f,l);this.JVc();return 32}JVc(){var a=this.pa.Qe();if(a&&a.length){for(var b of a)if(!b||this.hf.$c(b))return;if(Pg.c()){b=!0;for(const c of a)if(!c.en){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else xa.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}bol(){this.JVc()}GFl(a,
b,c,f,l){if(1===c)return 32;this.ua.Ba&&(a="Slide Complex: "+this.ua.Ba.sa(kb.a.koa,0).toString(),l[wp.a.Value]=a,l[im.a.labelText]=a,l[wp.a.Visible]=!0);return 32}Qrj(a,b,c,f,l){if(this.Ea.Ae)if(this.Ea.i8===Qi.a.PD)a=K.a.jQ;else if(this.Ea.i8===zb.a.sg)a=K.a.i8a;else return 8;else return 8;return this.ia.La(a,c,l)}Srj(a,b,c){b=this.ua.Ba;if(!b||this.hf.$c(b)||this.Ha.FC&&1!==this.pa.Qe().length)return 16;if(1===c)return 32;Tc.a.zk("SlideCount","1");this.fA.CTi(b,a).aO||this.hf.fw(this.Vb.Ef,a);
return 32}Trj(a,b,c){b=this.pa.Qe();if(!b||!b.length)return 16;for(var f of b)if(!f||this.hf.$c(f))return 16;if(1===c)return 32;1<b.length?xa.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):xa.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Tc.a.zk("SlideCount",b.length.toString());c=this.fA.nTf(b,a,null,null,!0);f=!0;for(const l of c)if(!l.aO){f=!1;break}f||this.hf.fw(this.Vb.Ef,a);return 32}Ypj(){try{xa.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");
const a=this.Tb.FI();a&&0<a.length&&this.fA.aPc(null,a[0].Id,this.Ha.pac?0:a[0].ContentMasters[0].Id,K.a.CGb);return 32}catch(a){return xa.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}gbe(a,b,c,f,l){return l&&Object(Xa.a)(M.a,l)?this.hf.$c(this.Tb.zl(l))?16:32:8}oRd(a){for(const b of a)if(!b.en)return!1;return!0}}Object(m.a)(HN,"SlideActor",null,[352]);var AR=d(1131);const OE=()=>{appChrome.PRIToastManager.dismissToast()};class PE{constructor(a,b,c){this.slideId=a;this.jjk=
b;this.Hzi=c}}Object(m.a)(PE,"NewSlideWithLayoutData",null,[]);class $i{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){this.Kva=0;this.W5c={};this.BSg=this.CSg=0;this.ia=a;this.fc=b;this.Ea=c;this.z$j=$i.aMj(f);this.pa=l;this.Jb=x;this.fA=H;this.Vb=U;this.ua=ja;this.Tb=ya;this.Kre=Va;this.Mu=hb;this.Mu.yGc(Object(F.a)(this,this.x7g,"openIgnoredDialog"));this.Ha=yb;this.NEb=Zb;this.gwa={}}wb(){this.Ha.hSj?this.ia.ra(K.a.Yia,rc.a.application,Object(F.a)(this,this.wag,"handleSlidesChangeLayout"),4):
this.ia.ra(K.a.Yia,rc.a.application,Object(F.a)(this,this.Xqj,"handleChangeLayout"),4);this.ia.ra(K.a.mna,rc.a.application,Object(F.a)(this,this.L$f,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(K.a.z5,rc.a.application,Object(F.a)(this,this.K$f,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(K.a.CGb,rc.a.application,Object(F.a)(this,this.K$f,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(K.a.Bdd,rc.a.application,Object(F.a)(this,this.Itj,"handleNewSlideWithLayout"),4);this.ia.ra(K.a.gIb,rc.a.application,
Object(F.a)(this,this.L$f,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(K.a.LXc,rc.a.application,Object(F.a)(this,this.rvj,"handleReactInsertSlideWithLayout"),4);this.ia.ra(K.a.TKe,rc.a.application,Object(F.a)(this,this.wag,"handleSlidesChangeLayout"),4);this.ia.ra(K.a.zUd,rc.a.application,Object(F.a)(this,this.qvj,"handleReactChangeSlideLayout"),4);this.ia.ra(K.a.jjd,rc.a.application,Object(F.a)(this,this.jjd,"queryNewSlideLayout"),4);this.ia.ra(K.a.kNe,rc.a.application,Object(F.a)(this,this.kNe,
"queryChangeSlideLayout"),4)}Ee(){const a=this.Ea.Fc(Qi.a.PD),b=this.Ea.Fc(Qi.a.T2),c=this.Ea.Fc(zb.a.sg),f=this.Ea.Fc(zb.a.lQ);a.bindAction(y.KeyInputManager.Oa(A.a.tq,0),K.a.z5);a.bindAction(y.KeyInputManager.Oa(A.a.Qga,y.KeyInputManager.Oe),K.a.z5);c.bindAction(y.KeyInputManager.Oa(A.a.Qga,y.KeyInputManager.Oe),K.a.z5);b.bindAction(y.KeyInputManager.Oa(A.a.Qga,y.KeyInputManager.Oe),K.a.z5);f.bindAction(y.KeyInputManager.Oa(A.a.Qga,y.KeyInputManager.Oe),K.a.z5)}frc(){return this.z$j||this.Tb.Obe()}Xqj(a,
b,c){const f=this.ua.Ba;if(!f||this.fc.$c(f)||this.Ha.FC&&1!==this.pa.Qe().length)return 16;a=f.hj;if(!a)return 8;b=this.Tb.FI();if(!this.Ha.cVa){if(!b)return xa.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.amb(b,a))return 8}if(1===c)return 32;if((!this.Ha.cVa||b&&this.amb(b,a))&&this.Mu.OO.Hb(a)&&this.Ane()){this.Kva=0;c=f.Cn;if(!c)return xa.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.Kre.FXd(0,
this.Tb.Gu(),b,this.Mu.OO,a,Object(F.a)(this,this.zUd,"changeSlideLayout"),this.frc(),u.AFrameworkApplication.isRtl).Eqd(c)}else xa.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.Mu.h_e(a),this.Kva=K.a.Yia;return 32}wag(a,b,c,f,l){b=this.pa.Qe();if(!b||!b.length)return 8;f=0;const x=[],H=this.Tb.FI();if(!H)return xa.a.J(512500226,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var U of b){if(this.fc.$c(U)||
!U)return 16;f=U.hj;if(!f)return xa.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;x.push(f);if(!this.Ha.cVa&&!this.amb(H,f))return xa.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),8}if(1===c&&!this.Ha.a_a)return 32;for(const ja of x)if(this.Ha.cVa&&!this.amb(H,f)||!this.Mu.OO.Hb(ja)){xa.a.J(512500195,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.Mu.h_e(f);
if(this.Ha.a_a)return this.Abe(a,c,()=>{this.Mu.yGc(OE)},l);this.Kva=K.a.Yia;return 32}U=this.Kva=0;for(const ja of b)if(U=ja.Cn,!U)return xa.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?xa.a.J(512500193,822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):xa.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(U=0);if(!this.Ane())return xa.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),
Ud.a("RaiseFirstMasterRetrievedEvent")?this.Abe(a,c,()=>{this.Mu.e$h(OE)},l):8;if(this.Ha.a_a){if(1===c)return 32;if(!l)return 8;this.BSg=U;this.Zhd(l,H,f,!0)}else this.Kre.FXd(0,this.Tb.Gu(),H,this.Mu.OO,f,Object(F.a)(this,this.WDf,"changeSlidesLayout"),this.frc(),u.AFrameworkApplication.isRtl).Eqd(U);return 32}zUd(a,b){const c=this.ua.Ba;if(c){var f=()=>{this.Ea.Ed();this.pa.Qh()},l=()=>{this.Ea.tf(Qi.a.PD)};a=parseInt(a);b=parseInt(b);if(a!==c.hj||b!==c.Cn){const x=Tc.a.Ib;Tc.a.Std("ChangeSlideLayout");
Tc.a.Ib&&(Tc.a.Ib.Ur=!0,Tc.a.Ib.Va("SlideCount","1"));f=this.Jb.Ad(15,void 0,f,l);try{f.nc(c),f.jd=K.a.Yia,c.hj=a,c.Cn=b}finally{f&&f.dispose()}this.fc.fw(c,"ChangeSlideLayout");Tc.a.Ib=x}}}WDf(a,b){const c=this.pa.Qe();if(c&&c.length){a=parseInt(a);b=parseInt(b);var f=Tc.a.Ib;Tc.a.Std("ChangeSlidesLayout");Tc.a.Ib.Ur=!0;var l=[];for(var x of c)a===x.hj&&b===x.Cn||l.push(x);if(l.length){Tc.a.zk("SlideCount",l.length.toString());x=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},()=>{this.Ea.tf(Qi.a.PD)});
try{x.nc(this.ua.Ba);x.jd=K.a.Yia;for(const H of l)H.hj=a,H.Cn=b}finally{x&&x.dispose()}for(const H of c)this.fc.fw(H,"ChangeSlidesLayout");Tc.a.Ib=f}}}qvj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let x,H;if(!({masterId:x,layoutId:H}=this.v3e(l.SourceControlId)).returnValue)return 8;xa.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.WDf(x,H)}catch(x){return xa.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",
x),8}return 32}L$f(a,b,c,f,l){f=this.Vb.Ef;if((b=this.ua.Ba)&&this.fc.$c(b)||this.fc.$c(f))return xa.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;f=this.Tb.FI();if(!f||!f.length)return xa.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let x=0;if(b){if(x=b.hj,!x)return xa.a.J(512500185,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else x=f[0].Id;let H=0;({hj:x,Cn:H}=
this.fSc(f,b));if(!this.Ha.cVa&&!this.amb(f,x))return xa.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Tb.pj())return 8;if(!this.Ha.a_a)return 32}if(this.Ha.cVa&&!this.amb(f,x)||!this.Mu.OO.Hb(x)||!this.Ane()){xa.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.Mu.h_e(x);if(this.Ha.a_a)return this.Abe(a,c,()=>{this.Mu.yGc(OE)},l);this.Kva=K.a.mna}else if(this.Kva=
0,this.Ha.a_a){if(1===c)return 32;if(!l)return 8;this.CSg=H;this.Zhd(l,f,x,!1)}else this.Kre.FXd(1,this.Tb.Gu(),f,this.Mu.OO,x,Object(F.a)(this,this.LXc,"insertSlideWithLayout"),this.frc(),u.AFrameworkApplication.isRtl).Eqd(H);return 32}Zhd(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=Ud.a("ReactSlideLayoutSectionsAPIEnabled")?this.$5b(b,c,f):this.vgj(b,c,f));xa.a.J(512500182,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}L9d(){const a=this.Tb.Gu();
if(!a||!a.width||!a.height)return xa.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new hr.a($i.FBf,$i.Lmi);const b=$i.FBf;return new hr.a(b,a.height/a.width*b)}HSc(){const a={},b={},c=this.L9d();b.root=this.pYd(c.width+$i.NBf,c.height+$i.NBf+$i.Emi+$i.Rmi);b.flexContainer={flexDirection:"column"};b.label=$i.VXd();a.galleryButtonInExpanded=b;return a}pYd(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}vgj(a,b,c){this.Qkd();const f=Object.assign(new tm.a,
{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,x=!1;const H=a.length;if(!H||1===H&&a&&a[0]&&!a[0].InContent)return f;for(var U=0;U<H;U++)a[U].Id===b&&(l=U,x=!0);x&&(b=this.I3f(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<H;b++)x&&b===l||(U=this.I3f(a[b],a[b].Id,c,b),Array.add(f.MenuSectionList,U));return f}I3f(a,b,c,f){const l=Object.assign(new hk.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.Mu.OO&&this.Mu.OO.Hb(a.Id)))return l;
var x=this.HSc(),H=c?"ChangeLayout":"NewSlide",U=c?"ChangeLayoutControls":"NewSlideLayoutControls";$i.Fbd++;f=Ud.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+"_"+$i.Fbd.toString();x=Object.assign(new sq.a,{Id:U,ExternalId:H+"_"+f,Type:4,Title:a.Name,GalleryStyle:x,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return l;H=a.length;for(U=0;U<H;U++)f=a[U],!f||!this.frc()&&this.Tb.Aab(f)||Array.add(x.GalleryItems,this.ewb(f,b,c));Array.add(l.ControlList,x);return l}pti(){try{const a=
[],b=this.gwa;for(let c in b)a.push(c);this.gwa={};this.W5c={};appChrome.api.unregisterIcons(a)}catch(a){xa.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",a)}}Qkd(){this.pti();try{const a=this.Tb.FI();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.Mu.OO&&this.Mu.OO.count&&this.Mu.OO.Hb(c.Id)&&this.addIconToMap(this.Mu.OO.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.gwa)}}catch(a){xa.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",
a)}}a6b(a,b){a=String.format("{0}_{1}_{2}",$i.sAj,a,b);a in this.W5c||($i.Fbd++,this.W5c[a]=a+"_"+$i.Fbd.toString());return this.W5c[a]}addIconToMap(a,b){if(this.ua.Ba&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.a6b(b,c.LayoutId),x={},H={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(H.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),u.AFrameworkApplication.isRtl&&Ud.a("ReactSlideLayoutRTLFix")?H.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):H.left=String.format("-{0}px",
c.Icon.Clip.Bounds.Left));H.position="absolute";const U={},ja={},ya=this.L9d();ja.height=ya.height.toString()+"px";ja.width=ya.width.toString()+"px";ja.position="relative";ja.overflow="hidden";ja.display="inline-block";U.root=ja;x.root=H;this.NEb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.NEb.resolve(ee.a.Uub,c.Icon.ImgId,$i.sni),x,U),this.gwa[l]=c)}}$5b(a,b,c){this.Qkd();const f=Object.assign(new tm.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],
UpdateDynamically:!0});var l=Object.assign(new hk.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var x=this.HSc();x=Object.assign(new sq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:x,Width:3,Type:4,GallerySections:[]});
Array.add(l.ControlList,x);l=0;let H=!1;const U=a.length;xa.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",U);if(!U||1===U&&a&&a[0]&&!a[0].InContent)return xa.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,U,1===U&&!!a&&!!a[0]&&a[0].InContent),f;for(var ja=0;ja<U;ja++)a[ja].Id===b&&(l=ja,H=!0);H&&(b=this.$$g(a[l],b,c),x.GallerySections.push(b));for(b=0;b<U;b++)H&&b===l||(ja=this.$$g(a[b],
a[b].Id,c),x.GallerySections.push(ja));return f}$$g(a,b,c){const f=Object.assign(new AR.a,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});if(!(a.InContent&&this.Mu.OO&&this.Mu.OO.Hb(a.Id)))return xa.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.Mu.OO&&this.Mu.OO.Hb(a.Id)),f;a=a.ContentMasters;if(!a)return xa.a.J(512500175,
822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;for(let x=0;x<l;x++){const H=a[x];!H||!this.frc()&&this.Tb.Aab(H)||Array.add(f.GalleryButtons,this.ewb(H,b,c))}return f}YDa(a,b,c){return Ud.a($i.UDf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}ewb(a,b,c){const f=a.Id,l=this.YDa(b.toString(),f.toString(),c),x={},H={},U=this.L9d();H.width=U.width.toString()+"px";H.height=U.height.toString()+"px";
Ud.a("ReactNewSlideLayoutIconBorderFix")||(H.border="#858585 1px solid");x.root=H;return Object.assign(new nE.a,{Id:l,ExternalId:l,Icon:this.a6b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:Ud.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:x,Alt:a.Name})}K$f(a,b,c){if(this.fc.UN(this.Vb.Ef))return 16;b=this.Tb.FI();if(!b)return 8;let f=null;if(this.Ha.FC){var l=this.pa.Qe();1<=l.length&&(l.sort((H,U)=>H.le-U.le),a!==K.a.CGb&&(f=l[l.length-
1]))}else a!==K.a.CGb&&(f=this.ua.Ba);if(this.fc.$c(f))return 16;let x;({hj:l,Cn:x}=this.fSc(b,this.ua.Ba));if(!this.amb(b,l))return 8;if(1===c)return 32;c=this.fA.aPc(Object(oa.a)(116,f),l,x,a);this.Nsf(l,x);c.aO||this.fc.fw(c,a);return 32}Itj(a,b,c,f,l){if(this.fc.UN(this.Vb.Ef))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.jjk;l=l.Hzi;f=null;this.Ha.FC?(c=this.pa.Qe(),1<=c.length&&(c.sort((x,H)=>x.le-H.le),f=c[c.length-1])):f=this.Tb.zl(c);c=this.fA.aPc(f,b,l,a);this.Nsf(b,l);c.aO||
this.fc.fw(c,a);return 32}dispose(){this.Mu.RYk(Object(F.a)(this,this.x7g,"openIgnoredDialog"));this.gwa=null}LXc(a,b){const c=this.ua.Ba;let f=M.a.empty;c&&(f=c.Cb);const l=this.Tb.FI();l&&("0"===a||"0"===b?{hj:a,Cn:b}=this.fSc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.La(K.a.Bdd,2,new PE(f,a,b)))}rvj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.v3e(l.SourceControlId)).returnValue)return 8;f=this.ua.Ba;a=M.a.empty;f&&(a=f.Cb);l=this.Tb.FI();if(!l)return 8;"0"===c||"0"===b?
{hj:c,Cn:b}=this.fSc(l,f):(c=parseInt(c),b=parseInt(b));xa.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.La(K.a.Bdd,2,new PE(a,c,b))}fSc(a,b){let c,f;f=c=0;if(!this.YUi(a))return{hj:c,Cn:f};if(b){c=b.hj;if(!c)return{hj:c,Cn:f};if(!this.Ha.pac||this.uVi(c)){f=b.Cn;if(!f)return{hj:c,Cn:f};if(b.kVa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ha.pac?
0:a[0].ContentMasters[0].Id;return{hj:c,Cn:f}}wTf(a,b,c){if(1===a)return 32;a=this.v3e(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[hm.a.On]=a.layoutId===(c?this.BSg.toString():this.CSg.toString()));return 32}jjd(a,b,c,f,l){return this.wTf(c,l,!1)}kNe(a,b,c,f,l){return this.wTf(c,l,!0)}v3e(a){let b,c;c=b=null;if(!a)return xa.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");
const f=Ud.a($i.UDf),l=f?1:0,x=f?2:1;if(!a||a.length!==(f?3:2))return xa.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[x];return{returnValue:!0,masterId:b,layoutId:c}}YUi(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}x7g(){this.Kva&&(xa.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.Kva===K.a.Yia?
"ChangeLayout":"NewSlide"),this.ia.processAction(this.Kva,2));this.Kva=0}amb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}Nsf(a,b){Tc.a.zk("MainMasterId",a.toString());Tc.a.zk("ContentMasterId",b.toString());const c=this.Tb.FI(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));xa.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",
c.length,f,a,b)}}Ane(){return this.Mu.ryf()}uVi(a){if(0===a)return!1;const b=this.Tb.gwb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}Abe(a,b,c,f){this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},u.AFrameworkApplication.ZHb.handleCommand(ld.ActionManager.R5a(a),b),f||c(),a=2):a=8:a=8;return a}static aMj(a){return a===$i.Omi||a===
$i.Pmi||a===$i.Mmi||a===$i.Qmi||a===$i.Nmi}static VXd(){return{"margin-top":"5px","max-width":"100px","font-size":"10px"}}}$i.Omi=1041;$i.Pmi=1042;$i.Mmi=2052;$i.Qmi=1028;$i.Nmi=3076;$i.sAj="LayoutIcon";$i.UDf="ReactSlideLayoutButtonIdChange";$i.sni="SlideLayoutActor";$i.FBf=145;$i.Lmi=82;$i.NBf=24;$i.Emi=14;$i.Rmi=5;$i.Fbd=1;Object(m.a)($i,"SlideLayoutActor",null,[352,106]);class IN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.aG=this.o$=this.Deb=this.p$=null;this.ia=a;this.ZQ=b;this.Ea=c;this.fc=
f;this.fA=l;this.Vb=x;this.ua=H;this.oc=U;this.Ge=ja;this.Are=ya(500,Object(F.a)(this,this.Bhd,"performKeyboardThumbnailReorder"));this.pa=Va;this.kn=hb;this.Mea=yb}wb(){this.ia.ra(K.a.fjc,Cb.a.application,Object(F.a)(this,this.Btj,"handleMoveSlide"),4);this.ia.ra(K.a.DZg,Cb.a.application,Object(F.a)(this,this.Ctj,"handleMoveSlideById"),4);this.ia.ra(K.a.ogb,rc.a.application,Object(F.a)(this,this.CVc,"handleReorderSlide"),4);this.ia.ra(K.a.lgb,rc.a.application,Object(F.a)(this,this.CVc,"handleReorderSlide"),
4);this.ia.ra(K.a.ngb,rc.a.application,Object(F.a)(this,this.CVc,"handleReorderSlide"),4);this.ia.ra(K.a.mgb,rc.a.application,Object(F.a)(this,this.CVc,"handleReorderSlide"),4);this.ia.ra(K.a.gjc,rc.a.application,Object(F.a)(this,this.mrj,"handleCommitPendingMoveSlideData"),4);this.ia.ra(K.a.hjc,rc.a.application,Object(F.a)(this,this.Luj,"handleQueryCommitMoveSlideDataEnabled"),100)}Ee(){const a=this.Ea.Fc(Qi.a.PD);a.bindAction(y.KeyInputManager.Oa(A.a.U1,y.KeyInputManager.Oe),K.a.ogb);a.bindAction(y.KeyInputManager.Oa(A.a.S1,
y.KeyInputManager.Oe),K.a.lgb);a.bindAction(y.KeyInputManager.Oa(A.a.U1,y.KeyInputManager.Oe|4),K.a.ngb);a.bindAction(y.KeyInputManager.Oa(A.a.S1,y.KeyInputManager.Oe|4),K.a.mgb)}Ctj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.Mea&&(this.kn&&1<this.pa.Qe().length||this.fc.yUa()))return 16;if(1===c)return 32;if(!l)return xa.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.lfa;c=[];for(var x of b)(b=a.xC(x))?c.push(b):xa.a.J(50348435,
822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",x.sid,x.cid);x=l.Ba?a.xC(l.Ba):null;b=a.xC(l.$ic);f=null;0<=l.sectionIndex&&(f=a.c6f(l.sectionIndex));return this.I$f(c,b,x,f,l.kke)}Btj(a,b,c,f,l){return!this.Mea&&(this.kn&&1<this.pa.Qe().length||this.fc.yUa())?16:1===c?32:l?this.I$f(l.lfa,l.$ic,l.Ba,null,l.kke):8}I$f(a,b,c,f,l){if(this.Mea)for(var x of a)if(!x||this.fc.$c(this.oc.zl(x.Cb)))return 16;x=[];for(var H of a){if(!H)continue;const U=this.oc.zl(H.Cb);U?x.push(U):
xa.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",H.Cb.sid,H.Cb.cid)}if(H=Tc.a.Ib)H.Nj=!0,H.sF||(H.sF=new Date),x&&H.Va("SlideCount",a.length.toString());H=null;l||(this.Mea?c&&(H=c):a&&0<a.length&&(H=a[0]),H&&!this.Vb.Ba.Cb.equals(H.Cb)&&(this.Vb.Ba=this.oc.zl(H.Cb)));a=b?this.oc.zl(b.Cb):null;this.fA.JTi(x,a,f);return 32}CVc(a,b,c){if(this.ZQ.y_||!this.ua.Ba||this.fc.$c(this.Vb.Ef)||!this.Mea&&this.kn&&1<this.pa.Qe().length)return 16;if(1===c)return 32;
if(this.Mea){b=this.pa.Qe();if(!b||!b.length)return 16;this.pvl(b,a)}else this.ivl(this.ua.Ba,a);return 32}mrj(a,b,c){if(this.fc.$c(this.Vb.Ef)||!this.tEf())return 16;if(1===c)return 32;this.Bhd();return 32}Luj(){return this.p$?32:16}Prb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}ivl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Ge.ZY;if(!(1>=f)){var l=!1;this.Deb||
(this.Deb=a,this.aG=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.aG[c]&&this.Deb.Cb.equals(this.aG[c].Cb)){a=c;break}if((b!==K.a.ogb&&b!==K.a.ngb||a)&&(b!==K.a.lgb&&b!==K.a.mgb||a!==f-1)){switch(b){case K.a.ogb:b=a-1;break;case K.a.lgb:b=a+1;break;case K.a.ngb:b=0;break;case K.a.mgb:b=f-1;break;default:return}Array.removeAt(this.aG,a);Array.insert(this.aG,b,this.Deb);for(l=0;l<f;l++)this.aG[l]?this.aG[l].le=l:xa.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",
l,f);this.Ge.pya(b);f=new Ox(!0,[this.Deb],0<b?this.aG[b-1]:null);this.xyf(f)}else l&&(this.aG=this.Deb=null)}}pvl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Ge.ZY;if(!(1>=f)&&(a.sort((x,H)=>x.slideIndex-H.slideIndex),this.Prb(a))){var l=!1;this.o$||(this.o$=a,this.aG=c.slides||[],l=!0);a=this.lUc(this.o$[0],this.aG);c=this.lUc(this.o$[this.o$.length-1],this.aG);if((b!==K.a.ogb&&b!==K.a.ngb||a)&&(b!==K.a.lgb&&b!==K.a.mgb||c!==f-1)){l=null;switch(b){case K.a.ogb:l=
0<=a-2?this.aG[a-2]:null;b=a-1;break;case K.a.lgb:b=a+this.o$.length<f?a+this.o$.length:f-1;l=this.aG[b];break;case K.a.ngb:l=null;b=0;break;case K.a.mgb:l=this.aG[f-1];b=f-1;break;default:return}for(a=this.o$.length-1;0<=a;a--)this.tci(this.o$[a],l);for(a=0;a<f;a++)this.aG[a]?this.aG[a].le=a:xa.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.Ge.pya(b);f=new Ox(!0,this.o$,l);this.xyf(f)}else l&&(this.aG=this.o$=null)}}tci(a,b){const c=
this.lUc(a,this.aG);Array.removeAt(this.aG,c);b=this.lUc(b,this.aG)+1;Array.insert(this.aG,b,a)}lUc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Cb.equals(b[c].Cb))return c;return-1}Gfi(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Cb.equals(f.Cb)){a=!0;break}if(!a)return!1}return!0}xyf(a){if(!a)throw Error.argumentNull("moveData");this.Mea?this.Gfi(this.o$,a.lfa)||this.Bhd():this.p$&&this.p$.lfa&&a.lfa&&this.p$.lfa[0]&&a.lfa[0]&&
!this.p$.lfa[0].Cb.equals(a.lfa[0].Cb)&&this.Bhd();this.p$=a;this.Are.perform()}Bhd(){if(this.tEf()){var a=this.p$;this.o$=this.Deb=this.p$=null;Array.clear(this.aG);this.ia.La(K.a.fjc,2,a)}}tEf(){const a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.p$)return!1;let b=!0,c=!this.p$.$ic;for(let f=0;f<this.p$.lfa.length;f++)b=!!a.xC(this.p$.lfa[f].Cb)&&b;c||(c=!!a.xC(this.p$.$ic.Cb));return b&&c}}Object(m.a)(IN,"SlideMoveActor",null,[352]);class by extends dx.a{constructor(){super();
this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(by,"TableGalleryButtonProps",dx.a,[]);class JN extends by{constructor(){super()}get Type(){return 8}}Object(m.a)(JN,"ChangeColorsGalleryButtonProps",by,[]);class KN{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(m.a)(KN,"SmartArtInfo",null,[]);var ft=d(492);class Hi{constructor(a,b,c){this.YF=a;this.Dck=b;this.ifk=c}get id(){return this.YF}get parameter(){return this.Dck}get klh(){return this.ifk}}
Object(m.a)(Hi,"SmartArtColorInfo",null,[]);class LN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb){this.iq=[];this.ia=a;this.fc=b;this.ob=c;this.Jb=f;this.Ea=l;this.ua=x;this.Nu=H;this.Tb=U;this.Fb=ya;this.Wj=Va;this.Fa=hb;this.cGk()}wb(){this.ia.ra(K.a.YEa,Cb.a.view,Object(F.a)(this,this.Vsj,"handleInsertSmartArt"),4);this.ia.ra(K.a.gxh,Cb.a.application,Object(F.a)(this,this.qwj,"handleSmartArtToolsTabViewHandler"),4);this.ia.ra(K.a.J_b,Cb.a.application,Object(F.a)(this,this.brj,"handleChangeSmartArtLayout"),
4);this.ia.ra(K.a.cah,Cb.a.application,Object(F.a)(this,this.zuj,"handlePopulateSmartArtColorStyles"),96);this.ia.ra(K.a.I_b,Cb.a.application,Object(F.a)(this,this.$qj,"handleChangeSmartArtColor"),4);this.ia.ra(K.a.XDf,Cb.a.application,Object(F.a)(this,this.arj,"handleChangeSmartArtColorAnchor"),4);this.ia.ra(K.a.SK,Cb.a.application,Object(F.a)(this,this.crj,"handleChangeSmartArtStyle"),4);this.ia.ra(K.a.dya,Cb.a.application,Object(F.a)(this,this.Gvj,"handleResetSmartArt"),4);this.ia.ra(K.a.PSe,Cb.a.application,
Object(F.a)(this,this.Kvj,"handleReverseSmartArt"),4);this.ia.ra(K.a.ujd,Cb.a.application,Object(F.a)(this,this.Quj,"handleQueryReverseSmartArt"),97);this.ia.ra(K.a.AQf,Cb.a.application,Object(F.a)(this,this.Urj,"handleEditSmartArtText"),4);this.ia.ra(K.a.$id,Cb.a.application,Object(F.a)(this,this.Muj,"handleQueryEditSmartArtText"),96)}Ee(){}Vsj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.fc.$c(b))return 16;if(1===c)return 32;this.hhd(l,a);if(!l)return 8;if((c=b.A3(this.ob.Wd()))&&this.fc.$c(c))return 16;
if(!this.Wj.OF(b,1))return this.Wj.nG(b),16;const x=this.Yjj(b,c,l);l=this.Jb.Ad(15,void 0,()=>{this.ob.ay();this.ob.Qh();this.Ea.Ed()},()=>{this.ob.selectShape(Object(oa.a)(4,x),!0)});try{l.nc(b),l.jd=a,c&&b.LU([c]),b.dC(Object(oa.a)(4,x))}finally{l&&l.dispose()}this.Nu.SF=Object(oa.a)(4,x);return 32}qwj(){return Object(oa.a)(813,this.Bza())?32:16}brj(a,b,c,f,l){b=this.Bza();if(!b||this.fc.$c(b))return 16;if(1===c)return 32;c=this.ob.Wd();for(var x of c){if(x.Rf){b=x;break}if(x.get_smartArtModelId()){b=
this.Fa.yr(x);this.ob.p8(x);this.ob.selectShape(b,!1);break}}this.hhd(l,a);x=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{x.nc(b),x.jd=a,Object(oa.a)(813,b).ensureModelData().get_elementCollection().documentElement.Roa=l}finally{x&&x.dispose()}return 32}zuj(a,b,c,f,l){if(!this.Bza())return 16;a=this.ob.tk();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.mli(a):l.MenuItems=this.bli(a);return 32}$qj(a,b,c,f,l){b=this.Bza();if(!b||this.fc.$c(b))return 16;
if(1===c)return 32;this.hhd(l,a);c=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{c.nc(b),c.jd=a,Object(oa.a)(813,b).ensureModelData().get_elementCollection().documentElement.Rya=l}finally{c&&c.dispose()}return 32}arj(){return this.Bza()?32:16}crj(a,b,c,f,l){b=this.Bza();if(!b||this.fc.$c(b))return 16;if(1===c)return 32;this.hhd(l,a);c=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{c.nc(b),c.jd=a,Object(oa.a)(813,b).ensureModelData().get_elementCollection().documentElement.Sya=
l}finally{c&&c.dispose()}return 32}Gvj(a,b,c){b=Object(oa.a)(813,this.Bza());if(!b||this.fc.$c(Object(oa.a)(4,b)))return 16;if(1===c)return 32;c=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{c.nc(b),c.jd=a,b.dya=!0}finally{c&&c.dispose()}return 32}Kvj(a,b,c){b=this.Bza();if(!b||!b.Ule||this.fc.$c(b))return 16;if(1===c)return 32;c=new KN;c.fReverseEnabled=b.Ule;c.fReverseChecked=!b.Tle;const f=this.Jb.Ad(15,void 0,()=>{this.ob.ij();this.Ea.Ed()});try{f.nc(b),f.jd=a,Object(oa.a)(813,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=
c}finally{f&&f.dispose()}return 32}Quj(a,b,c,f,l){a=this.Bza();a=!!a&&a.Tle;if(!Object(Xa.a)(Uh.a,l))return 8;l.Mf(a);return 32}Urj(a,b,c){a=this.Bza();if(!a||this.fc.$c(a))return 16;if(1===c)return 32;this.ia.La(K.a.dQa,2,new uo.a(a,!0,null));return 32}Muj(a,b,c,f,l){a=this.ob.Xz();if(!Object(Xa.a)(Uh.a,l))return 8;l.Mf(a);return 32}Yjj(a,b,c){if(!a)return null;const f=a.Ut();let l;l=b?b.$wb(Mf.a.dY,Mf.a.u5):this.Tb.Ata(Mf.a.dY,Mf.a.u5);return a.wYd(!0,0,b,c,l.x,l.y,Mf.a.dY,Mf.a.u5,f+1)}Bza(){const a=
this.ob.Wd();for(const b of a){if(b.Rf)return b;if(b.get_smartArtModelId())return this.Fa.yr(b)}return null}cGk(){Array.add(this.iq,new Hi(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.iq,new Hi(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.iq,new Hi(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.iq,new Hi(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.iq,new Hi(4,"colorful2,colorful",
ResourceStrings.L_SmartArtColorful2));Array.add(this.iq,new Hi(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.iq,new Hi(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.iq,new Hi(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.iq,new Hi(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.iq,new Hi(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.iq,new Hi(10,
"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.iq,new Hi(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.iq,new Hi(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.iq,new Hi(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.iq,new Hi(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.iq,new Hi(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));
Array.add(this.iq,new Hi(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.iq,new Hi(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.iq,new Hi(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.iq,new Hi(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.iq,new Hi(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.iq,new Hi(21,"accent3_4,accent3",
ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.iq,new Hi(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.iq,new Hi(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.iq,new Hi(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.iq,new Hi(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.iq,new Hi(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));
Array.add(this.iq,new Hi(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.iq,new Hi(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.iq,new Hi(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.iq,new Hi(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.iq,new Hi(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.iq,new Hi(32,"accent5_5,accent5",
ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.iq,new Hi(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.iq,new Hi(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.iq,new Hi(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.iq,new Hi(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.iq,new Hi(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}bli(a){const b=
Object.assign(new tm.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new hk.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=hj.Color.Ti(a.ke.Light1),l=hj.Color.Ti(a.ke.Dark1),x=hj.Color.Ti(a.ke.Light2),H=hj.Color.Ti(a.ke.Dark2),U=Array(6);U[0]=hj.Color.Ti(a.ke.Accent1);U[1]=hj.Color.Ti(a.ke.Accent2);U[2]=hj.Color.Ti(a.ke.Accent3);U[3]=hj.Color.Ti(a.ke.Accent4);U[4]=hj.Color.Ti(a.ke.Accent5);U[5]=hj.Color.Ti(a.ke.Accent6);a=0;
Array.add(c.ControlList,({r8b:a}=this.Wki(a,f,l,x,H)).returnValue);Array.add(c.ControlList,({r8b:a}=this.Pji(a,f,U)).returnValue);Array.addRange(c.ControlList,({r8b:a}=this.zji(a,f,U)).returnValue);return b}Wki(a,b,c,f,l){const x=Object.assign(new sq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(x.GalleryItems,
this.zic(b,c,a++));Array.add(x.GalleryItems,this.zic(b,l,a++));Array.add(x.GalleryItems,this.zic(l,f,a++));return{returnValue:x,r8b:a}}Pji(a,b,c){const f=Object.assign(new sq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.ocd(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,
this.zDe(c[l],c[l+1],b,a++));return{returnValue:f,r8b:a}}zji(a,b,c){const f=[];for(let H=0;6>H;H++){const U=Object.assign(new sq.a,{Id:"ColorfulGallery"+(H+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(H+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,H+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new hj.Color;l.r=l.g=l.b=255;var x=new hj.Color;l=hj.Color.SZ(c[H],l,.5);x=hj.Color.SZ(c[H],x,.25);Array.add(U.GalleryItems,
this.zic(b,c[H],a++));Array.add(U.GalleryItems,this.zic(c[H],b,a++));Array.add(U.GalleryItems,this.zDe(c[H],l,b,a++));Array.add(U.GalleryItems,this.xjk(x,c[H],l,b,a++));Array.add(U.GalleryItems,this.zDe(c[H],l,b,a++));Array.add(f,U)}return{returnValue:f,r8b:a}}zic(a,b,c){return this.ocd(a,a,a,a,a,a,b,c)}zDe(a,b,c,f){const l=ft.a.SZ(a,b,2/6),x=ft.a.SZ(a,b,.5),H=ft.a.SZ(a,b,4/6),U=ft.a.SZ(a,b,5/6);return this.ocd(a,l,x,H,U,b,c,f)}xjk(a,b,c,f,l){const x=hj.Color.SZ(b,c,.5);return this.ocd(a,b,x,c,x,
b,f,l)}ocd(a,b,c,f,l,x,H,U){U=this.P6f(U);const ja="ChangeSmartArtColor__"+U.parameter.replace(",","__");return Object.assign(new JN,{Id:ja,ExternalId:ja,MenuItemId:U.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:U.klh,TableCellStyles:[this.ZFb(a,H),this.ZFb(b,H),this.ZFb(c,H),this.ZFb(f,H),this.ZFb(l,H),this.ZFb(x,H)]})}ZFb(a,b){const c={};c.backgroundColor=this.AGf(a);c.border=String.format("1px solid {0}",this.AGf(b));return c}AGf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",
a.r,a.g,a.b)}mli(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new hj.Color;c.r=c.g=c.b=255;const f=new hj.Color,l=hj.Color.Ti(a.ke.Light1);var x=hj.Color.Ti(a.ke.Dark1),H=hj.Color.Ti(a.ke.Light2),U=hj.Color.Ti(a.ke.Dark2);const ja=Array(6);ja[0]=hj.Color.Ti(a.ke.Accent1);ja[1]=hj.Color.Ti(a.ke.Accent2);ja[2]=hj.Color.Ti(a.ke.Accent3);ja[3]=hj.Color.Ti(a.ke.Accent4);ja[4]=hj.Color.Ti(a.ke.Accent5);ja[5]=hj.Color.Ti(a.ke.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',
ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.yic(b,l,x,a++);this.yic(b,l,U,a++);this.yic(b,U,H,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.kcd(b,ja[1],ja[2],ja[3],ja[4],ja[5],ja[1],l,a++);for(x=1;5>x;x++)this.vDe(b,
ja[x],ja[x+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(x=0;6>x;x++)H=String.format(ResourceStrings.L_AccentFormat,x+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',x+1,H)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',x+1)),H=hj.Color.SZ(ja[x],c,.5),U=hj.Color.SZ(ja[x],f,.25),this.yic(b,l,ja[x],a++),this.yic(b,ja[x],l,a++),this.vDe(b,ja[x],H,l,a++),this.sjk(b,U,ja[x],H,l,a++),this.vDe(b,ja[x],H,l,a++),b.append("</Gallery>"),
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}yic(a,b,c,f){this.kcd(a,b,b,b,b,b,b,c,f)}vDe(a,b,c,f,l){const x=ft.a.SZ(b,c,2/6),H=ft.a.SZ(b,c,.5),U=ft.a.SZ(b,c,4/6),ja=ft.a.SZ(b,c,5/6);this.kcd(a,b,x,H,U,ja,c,f,l)}sjk(a,b,c,f,l,x){const H=hj.Color.SZ(c,f,.5);this.kcd(a,b,c,H,f,H,c,l,x)}kcd(a,b,c,f,l,x,H,U,ja){ja=this.P6f(ja);a.append('<GalleryButton Id="');a.append(ja.parameter);a.append('" Command="');a.append(K.a.I_b.toString());a.append('" QueryCommand="');a.append(K.a.wc.toString());
a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.$Fb(a,b,U,8,-1);this.$Fb(a,c,U,34,-1);this.$Fb(a,f,U,8,16);this.$Fb(a,l,U,34,16);this.$Fb(a,x,U,8,33);this.$Fb(a,H,U,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(ja.klh);a.append('"/>')}hhd(a,b){a.Uri=b===K.a.I_b?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===K.a.SK?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+
a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}P6f(a){let b;for(let c=0;c<this.iq.length;c++)if(b=this.iq[c],b.id===a)return b;return new Hi(-1,"","")}$Fb(a,b,c,f,l){a.append("&lt;div style=&quot;");b.A2d()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",
b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.A2d()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(m.a)(LN,"SmartArtActor",null,[352]);class cy{constructor(a,b,c,f){this.MBe="BottomOverlaid";this.ia=a;this.Hc=f;this.oc=b;this.Lc=
c;this.NBe="productionSpokenLanguages_"+this.Hc.Toa;this.OBe="productionSubtitleLanguages_"+this.Hc.xza}wb(){xa.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Hc.Kh);this.ia.ra(K.a.XZa,rc.a.application,Object(F.a)(this,this.XZa,"querySubtitleIsEnabled"),96);this.ia.ya(K.a.ZLa,rc.a.application,Object(F.a)(this,this.ZLa,"toggleUseSubtitles"));this.ia.ra(K.a.Rjd,rc.a.application,Object(F.a)(this,this.FMk,"querySubtitleSettingsIsEnabled"),96);this.ia.ra(K.a.yhb,
rc.a.application,Object(F.a)(this,this.yhb,"populateTranscriptionSubtitleLanguage"),96);this.ia.ra(K.a.xhb,rc.a.application,Object(F.a)(this,this.xhb,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(K.a.gwl,rc.a.application,Object(F.a)(this,this.Owj,"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(K.a.hwl,rc.a.application,Object(F.a)(this,this.Pwj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.ra(K.a.LOe,rc.a.application,Object(F.a)(this,this.LOe,"queryToggleTranscriptionSpokenLanguage"),
96);this.ia.ra(K.a.MOe,rc.a.application,Object(F.a)(this,this.MOe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.ra(K.a.gib,rc.a.application,Object(F.a)(this,this.gib,"querySubtitlesBottomOverlay"),96);this.ia.ya(K.a.sOb,rc.a.application,Object(F.a)(this,this.sOb,"toggleSubtitlesBottomOverlay"));this.ia.ra(K.a.hib,rc.a.application,Object(F.a)(this,this.hib,"querySubtitlesTopOverlay"),96);this.ia.ya(K.a.tOb,rc.a.application,Object(F.a)(this,this.tOb,"toggleSubtitlesTopOverlay"));this.ia.ra(K.a.fib,
rc.a.application,Object(F.a)(this,this.fib,"querySubtitlesBelowSlide"),96);this.ia.ya(K.a.rOb,rc.a.application,Object(F.a)(this,this.rOb,"toggleSubtitlesBelowSlide"));this.ia.ra(K.a.eib,rc.a.application,Object(F.a)(this,this.eib,"querySubtitlesAboveSlide"),96);this.ia.ya(K.a.qOb,rc.a.application,Object(F.a)(this,this.qOb,"toggleSubtitlesAboveSlide"))}Ee(){}XZa(a,b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return 8;l.Mf(this.Hc.Kh);return 32}FMk(a,b,c,f,l){return 1===c?this.oc.pj()?32:8:l&&"object"===typeof l?
this.Hc&&this.Hc.P3b?32:(xa.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(xa.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}gib(a,b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return xa.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Mf("BottomOverlay"===this.Hc.Tv);xa.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.Hc.Tv);return 32}hib(a,
b,c,f,l){if(!l||!Object(Xa.a)(Uh.a,l))return 8;l.Mf("TopOverlay"===this.Hc.Tv);xa.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Hc.Tv);return 32}fib(a,b,c,f,l){try{l&&l.Mf("BelowSlide"===this.Hc.Tv)}catch(x){xa.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",x)}return 32}eib(a,b,c,f,l){try{l&&l.Mf("AboveSlide"===this.Hc.Tv)}catch(x){xa.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",x)}return 32}ZLa(a,b,c,f,l){if(1===
c)return this.oc.pj()?32:8;if(!l||"object"!==typeof l)return 8;this.Hc.Kh&&(ki.a.$J("PPTCaptionDiscoverabiltyDoNotShowAgain","true",ki.a.DJ)||xa.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Hc.Kh=!this.Hc.Kh;xa.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Hc.Kh);Oc.App.Kb.sG({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}yhb(a,b,
c,f,l){try{if(1===c)return 32;if(!l)return xa.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.aah(l,!1)}catch(x){xa.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",x)}return 32}xhb(a,b,c,f,l){try{if(1===c)return 32;if(!l)return xa.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.aah(l,!0)}catch(x){xa.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",x)}return 32}Pwj(a,
b,c,f,l){try{if(l){this.Hc.xza=l.MenuItemId;this.Hc.ylb=this.Hc.PUc();const x=l.SourceControlId;this.OBe!==x&&(a={},a[x]="ToggleButtonModel",a[this.OBe]="ToggleButtonModel",Oc.App.Kb.sG(a),this.OBe=x)}}catch(x){xa.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",x)}return 32}MOe(a,b,c,f,l){try{l&&(l[Sh.a.On]=l.MenuItemId.toLowerCase()===this.Hc.xza.toLowerCase())}catch(x){xa.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",x)}return 32}Owj(a,
b,c,f,l){try{if(l){this.Hc.Toa=l.MenuItemId;const x=l.SourceControlId;this.NBe!==x&&(a={},a[x]="ToggleButtonModel",a[this.NBe]="ToggleButtonModel",Oc.App.Kb.sG(a),this.NBe=x)}}catch(x){xa.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",x)}return 32}LOe(a,b,c,f,l){try{l&&(l[Sh.a.On]=l.MenuItemId.toLowerCase()===this.Hc.Toa.toLowerCase())}catch(x){xa.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",x)}return 32}sOb(a,b,c,f,l){if(1===
c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[Sh.a.On]&&(this.Hc.Tv="BottomOverlay",xa.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Qud(l.SourceControlId);return 32}tOb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[Sh.a.On]&&(this.Hc.Tv="TopOverlay",
xa.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Qud(l.SourceControlId);return 32}rOb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return xa.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[Sh.a.On]&&(this.Hc.Tv="BelowSlide",xa.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Qud(l.SourceControlId);return 32}qOb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==
typeof l)return xa.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[Sh.a.On]&&(this.Hc.Tv="AboveSlide",xa.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Qud(l.SourceControlId);return 32}aah(a,b){a.MenuItems=Object.assign(new tm.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Hc.a0e)&&0<b.count&&(b=cy.fLf(b,"productionSpokenLanguages",""),Array.add(a.MenuItems.MenuSectionList,
b)),(b=this.Hc.$_e)&&0<b.count&&(b=cy.fLf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Hc.DNb)&&0<pa.a.count(b)&&(b=cy.mHi(this.Hc.LZe),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=nj.l(a.MenuItems)}Qud(a){if(this.MBe!==a){const b={};b[a]="ToggleButtonModel";b[this.MBe]="ToggleButtonModel";Oc.App.Kb.sG(b);this.MBe=a;this.Lc.Dy(new Sp.a(1))}}static fLf(a,b,c){c=Object.assign(new hk.a,{DisplayMode:"Menu",
Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),x=Object.assign(new bz.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:Ya.a.xe(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Cc.a.Rrb});Array.add(c.ControlList,x)}catch(l){xa.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static mHi(a){const b=Object.assign(new hk.a,{DisplayMode:"Menu",
Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new bz.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:Ya.a.xe(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Cc.a.Rrb});Array.add(b.ControlList,f)}catch(f){xa.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,f)}return b}}Object(m.a)(cy,"SubtitleActor",null,[352]);var BR=d(407);class ho{constructor(a){this.Tx=this.Xs=this.gv=this.mK=this.kI=null;this.EZ=a}get FZb(){return this.mK||(this.mK=Db.a.instance.ub("Box4.IAutoCorrectRules"))}get qca(){return this.gv||(this.gv=Db.a.instance.ub("Box4.IAutoCorrectScheduler"))}get JJ(){return this.kI||(this.kI=Db.a.instance.ub("Box4.Pages.IPageContentEditor"))}get EB(){return this.Tx||(this.Tx=Db.a.instance.ub("Box4.IOutlineEditor"))}get Kn(){return this.Xs||(this.Xs=
this.EZ())}QAb(a,b,c){if(this.EB&&ho.mh){var f=Ih.ContextSetEditor.L7d(b);a=f.node;nb.SelectionEditor.Xl(f)&&(f=Wd.a.Lj(a,Sb.ParagraphReader.textLength(a)));var l=gc.a.language(gc.a.xs(f));f=tb.GraphIterator.nb(c.xg);ho.Zl.CKa(f);var x=a=null;if(f)for(let H=f.Bb(1);H&&!x;H=f.Dj(1))gj.OutlineReader.bX(H)&&(x=H);if(f&&!x){if(!this.JJ||!this.EB)return;a=new pf.GraphTransaction(7);a.Fy(f);x=this.JJ.s1b(f);this.EB.Qod(x,c.V6b());this.EB.LZ(f,!0);l&&(Ta.OutlineElementNavigator.wi(f),f=Wd.a.Lj(f.currentNode,
0),ho.mh.e0a(gc.a.xs(f),l))}l=Qd.SelectionFactory.tj(x,!0);c.Lb.setSelection(l);nb.SelectionEditor.Tg(b)&&(c=tb.GraphIterator.nb(b.node),c.ev(),kh.OutlineNavigator.qmd(c),this.FZb&&this.qca&&gj.OutlineReader.BC(c,b,!0)&&(b=this.FZb.w3d(b,-1,!1,A.a.Sq))&&this.qca.Knh(b));this.Kn&&this.Kn.qw();a&&a.dispose()}}J1d(a,b,c){a=tb.GraphIterator.nb(c.xg);a=BR.a(a);a=Qd.SelectionFactory.tj(a,!1);c.Lb.setSelection(a)}static get mh(){return ho.Kf||(ho.Kf=Db.a.instance.ub("Box4.IFormattingEditor"))}static get instance(){return ho.Ka||
(ho.Ka=ho.uC())}static uC(){return new ho(()=>Db.a.instance.ub("Box4.IUndoManager"))}static get Zl(){return Ey.PageNavigator.instance}}ho.Ka=null;ho.Kf=null;Object(m.a)(ho,"TitleViewEditor",null,[]);class tu{constructor(a,b,c,f=null,l=null,x,H,U=null,ja=null){this.Xs=null;this.Dqf=!1;this.EZ=a;this.KLd=b;this.Hm=c;this.mK=f;this.gv=l;this.hd=U;this.Ak=ja}get Kn(){return this.Xs||(this.Xs=this.EZ())}wb(){const a=u.AFrameworkApplication.Ta,b=Object(F.a)(this,this.zsl,"tabView");a.ra(D.a.tab,Cb.a.view,
b,1124);a.ra(D.a.Qqc,Cb.a.view,b,1124);a.ya(D.a.Jeg,Cb.a.view,ld.ActionManager.Mg)}zsl(a,b,c,f,l){if(1===c)return 32;const x=a===D.a.Qqc;if(!b.view.Mh)return 2;const H=b.view,U=H.Lb;var ja=U.Pj;if(!ja||P.a.instance.ga(14)&&tu.$i.v7a(ja))return 2;if(this.Hm&&this.Hm.instance&&this.Hm.instance.XW(ja))return 4;var ya=null,Va=ld.ActionManager.B5,hb=!1,yb=nb.SelectionEditor.Tg(ja);if(ja.hx){if(U.Na.jH&&(Va=ja.getContext(0),ya=new tb.GraphIterator,ya.set(Va.node),ya.ev(),Va=x?D.a.oUe:D.a.Dnd),Va=this.KLd.wJk(Va,
x?D.a.By:D.a.oC),Va===ld.ActionManager.B5){var Zb=tu.km.Q2(ja,16);if(Zb)x&&(Va=D.a.udd),ya=new tb.GraphIterator,ya.set(Zb.node),ya.$e();else{if(P.a.instance.ga(77))return 2;if(tu.jLj(ja)){if(x)return 2;Va=D.a.QAb}else Va=x?D.a.By:D.a.oC}}}else if(ja.al)ya=new tb.GraphIterator,ya.set(ja.node),nb.SelectionEditor.Bt(ya),gj.OutlineReader.$ka(ja)?Va=x?D.a.oUe:D.a.Dnd:(Va=x?this.KLd.Ipj(ya,ja,Va):this.KLd.Hpj(ya,ja,Va),fe.OutlineElementReader.Yg(ya)&&ja.contextId===Cb.a.Pf&&(hb=fe.OutlineElementReader.BC(ya,
ja,!1)),(Zb=rb.ListReader.uk(ya)&&hb)&&ia.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Va===D.a.oC),Va!==ld.ActionManager.B5||Le.isTableCellOrInside(ya)||Zb||(this.Dqf||(ia.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.Dqf=!0),u.AFrameworkApplication.Ta.processAction(D.a.Jeg,2),u.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.hd&&this.hd.isFeatureEnabled(84)&&
this.hd.isFeatureEnabled(83)));else return 2;if(!x&&Va===ld.ActionManager.B5&&Le.isTableCellOrInside(ya))if(Vd.returnToCell(ya),Le.isLastCellInTable(ya)||od.TableReader.szb(ya)&&Le.isLastCellInTableIgnoringGhostCells(ya)){if(Va=this.SNd(ya,ja),!Va)return 2}else Va=D.a.h_g;if(Va===ld.ActionManager.B5)return 2;switch(Va){case D.a.QAb:ho.instance.QAb(a,ja,b.view);ja=32;break;case D.a.J1d:ho.instance.J1d(a,ja,b.view);ja=32;break;case D.a.h_g:case D.a.udd:hb=Va===D.a.udd;yb&&this.mK&&this.gv&&(yb=this.mK.w3d(ja,
-1,!0,A.a.Sq))&&this.gv.Knh(yb);ja=32;Vd.returnToCell(ya);Vd.moveToNextOrPreviousCell(ya,hb)&&(yb=!0,hb=!1,gj.OutlineReader.QVc(ya)||(kh.OutlineNavigator.UEe(ya,!1),Ta.OutlineElementNavigator.wi(ya),Sb.ParagraphReader.ps(ya.currentNode)&&(yb=!1,Sb.ParagraphReader.textLength(ya.currentNode)||(hb=!0)),hb||Vd.returnToCell(ya)),hb?ya=Qd.SelectionFactory.Sg(ya.currentNode,0):(ya=Qd.SelectionFactory.wl(ya.currentNode),!yb&&nb.SelectionEditor.Xl(ya.Ye)&&(yb=ya.toArray(),Array.removeAt(yb,yb.length-1),ya=
new ib.Selection(yb,ya.yf))),U.setSelection(ya));break;case D.a.oUe:case D.a.Dnd:Va===D.a.Dnd?kh.OutlineNavigator.LZg(ya,!1):kh.OutlineNavigator.LZg(ya,!0);U.setSelection(Qd.SelectionFactory.wl(ya.currentNode));ja=32;break;case D.a.G0a:ja=u.AFrameworkApplication.Ta.mi(b,Va,c,!0,f,l);1===Oc.App.mode&&Vd.moveToNextOrPreviousCell(ya,!1)&&(Vd.returnToCell(ya),ya=Qd.SelectionFactory.tj(ya.currentNode,!0),nb.SelectionEditor.Xl(ya.Ye)&&(yb=ya.toArray(),Array.removeAt(yb,yb.length-1),ya=new ib.Selection(yb,
ya.yf)),U.setSelection(ya));break;default:if(ja=u.AFrameworkApplication.Ta.mi(b,Va,c,!0,f,l),!hb&&yb&&(Va===D.a.By||Va===D.a.oC)){const fc=nb.SelectionEditor.Ria(U.Na.mb).y;Oc.App.jTk(()=>{this.Smk(U,H,fc)})}}32===ja&&b.view.Mh&&this.Kn.qw();return ja}Smk(a,b,c){if(a&&b){var f=a.Na.mb;nb.SelectionEditor.Ria(f).y<c?(b=nb.SelectionEditor.c4b(b,f,!1),b=nb.SelectionEditor.Vsa(b,!1,!1,!1,!0)):b=nb.SelectionEditor.TPc(b,f,!1);a.setSelection(b)}}SNd(){return D.a.$ta}AZg(a,b,c){if(a&&b){var f=a.Na.mb;nb.SelectionEditor.Ria(f).y<
c?(b=nb.SelectionEditor.c4b(b,f,!1),b=nb.SelectionEditor.Vsa(b,!1,!1,!1,!0)):b=nb.SelectionEditor.Vsa(f,!1,!1,!1,!0);a.setSelection(b)}}static get $i(){return fd.a.instance}static get km(){return Ih.ContextSetEditor.instance}static jLj(a){a=tu.km.Q2(a,10);return!!a&&Hf.a(a)}}Object(m.a)(tu,"TabActor",null,[]);class MN extends tu{constructor(a,b,c,f){super(a,b,c);this.la=f}SNd(a,b){return this.la.sAb?super.SNd(a,b):0}}Object(m.a)(MN,"Box4TabActor",tu,[]);class NN{constructor(a,b,c,f){this.Xgk=new MN(a,
b,c,f)}wb(){this.Xgk.wb()}Ee(){}}Object(m.a)(NN,"TabActor",null,[352]);class ON{constructor(a,b,c){this.xAg=b;this.pa=a;this.wGa=c}wJk(a,b){const c=this.pa.Pj;return c&&this.wGa.Q2(c,16)?a:this.BXe(b)?b:G.a.ve}Ipj(a,b,c){(c=Object(oa.a)(5,b.node))&&c.Cs()?c=D.a.udd:(Ta.OutlineElementNavigator.Re(a),c=(nb.SelectionEditor.gk(b)||nb.SelectionEditor.Tg(b)&&fe.OutlineElementReader.BC(a,b,!1))&&this.xAg.Rsb(a)&&this.BXe(D.a.By)?D.a.By:G.a.ve,xa.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",
c===D.a.By?"Promote":"DoNothing"));return c}Hpj(a,b,c){const f=Object(oa.a)(5,a.yq);if(f&&f.Cs())return c;Ta.OutlineElementNavigator.Re(a);c=(nb.SelectionEditor.gk(b)||nb.SelectionEditor.Tg(b)&&fe.OutlineElementReader.BC(a,b,!1))&&this.xAg.WIc(a)&&this.BXe(D.a.oC)?D.a.oC:G.a.ve;xa.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===D.a.By?"Demote":"DoNothing");return c}BXe(a){var b=this.pa.Na.mb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(Sb.ParagraphReader.YW(f.node)){if(b=
f.node.sa(ab.a.listLevel,0),a===D.a.oC&&b>=To.a.a8-1||a===D.a.By&&!b||this.pa.FL()&&To.a.Cig(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(m.a)(ON,"TabActorPromoteDemoteStrategy",null,[1205]);var PN=d(399),CR=d(857),QN=d(963);class Ov extends Zh.a{constructor(a,b,c,f,l,x,H,U,ja){super(void 0,void 0,!0);this.qva=null;this.l7j=b;this.OGg=f;this.MGg=l;this.HGg=x;this.BGg=H;this.Jug=U;this.Iug=ja;this.Kwa=a;this.mcb=c}sqd(){this.hg=this.l7j;const a={};a.bodyControls=this.F5d();this.Zi(this.Kwa,
Object(F.a)(this,this.w_d,"dialogResultHandler"),a)}w_d(a,b){1===a&&this.mcb(parseInt(this.iTa(b)),parseInt(this.F5i(b)));this.dispose()}F5d(){this.qva=Ov.z6d();const a={};this.kyi(a);this.oxi(a);return a}kyi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.OGg,this.HGg),c=[QN.a("None",0,this.OGg,this.HGg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,
["unitType"]:"None",["value"]:this.Jug,["validUnits"]:c,["numberFormatInfo"]:this.qva,["validReservedValues"]:[""]}}oxi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.MGg,this.BGg),c=[QN.a("None",0,this.MGg,this.BGg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.Iug,["validUnits"]:c,["numberFormatInfo"]:this.qva,
["validReservedValues"]:[""]}}iTa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.Jug.toString()}F5i(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.Iug.toString()}static z6d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(m.a)(Ov,"AReactTableSizeDialog",Zh.a,[]);class RN extends Ov{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,
"InsertTableDialog",a,1,1,35,35,2,5)}}Object(m.a)(RN,"ReactInsertTableDialog",Ov,[]);class SN extends Ov{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(m.a)(SN,"ReactSplitTableCellsDialog",Ov,[]);var Pv=d(621),TN=d(954);class xF{constructor(a){this.eGa=a;if(!a)throw Error.argumentNull("m_actionData");}Bs(){return!1}Zm(){return this.eGa.TableNode}xv(){var a;return null!==(a=this.eGa.CellNodes)&&void 0!==a?a:this.Zm().i$a()}OY(a){return a&&
!!a.Ba}}Object(m.a)(xF,"TableActionDataContextHelper",null,[1225]);class yF{constructor(a){this.pa=a;if(!a)throw Error.argumentNull("m_selectionManager");}Bs(){return this.pa.Bs()}Zm(){return this.pa.Zm()}xv(){return this.pa.xv()}OY(a){let b=!1;a&&a.Ba&&(a=this.pa.Jp(),b=!!a&&a.ud);return b}}Object(m.a)(yF,"TableSelectionManagerContextHelper",null,[1225]);class uu{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg){this.PVa={};this.pfc=!1;this.E9c=null;this.Qz=[0,
.25,.5,.75,1,1.5,2.25,3,4.5,6];this.LF=new Ma.ScriptSharpLegacyMap;this.Vb=Zb;this.ua=fc;this.Qb=b;this.ia=a;this.hf=c;this.pa=Kc;this.Ea=f;this.lA=l;this.Fa=x;this.Ks=Va;this.Sk=ya;this.Ha=hb;this.Jb=yb;this.yJ=ja;this.iYa=U;this.yc=H;this.Wj=Lc;this.yFb=Gc;this.MUg=ae;this.pea=we;this.Fb=$d;this.cGa=Te;this.Nu=Ze;this.YX=Vf;this.xCg=gg;this.yH=1;this.Dx=pe.Box4ColorHelper.oV({Color:"##T,1,0,0"});this.pB=Qg;this.qA=Rg}wb(){this.PVa["465284484"]=0;this.PVa["212166888"]=1;this.PVa["530759702"]=2;this.PVa["1915511548"]=
0;this.PVa["2003354004"]=1;this.PVa["2257534378"]=2;Ec.G9d=Object(F.a)(this,this.F9d,"getRowOrColumnsForDelete");Ec.u9d=Object(F.a)(this,this.Lgj,"getRefRowWhenInsertRow");Ec.r9d=Object(F.a)(this,this.Fgj,"getRefCellWhenInsertColumn");Ec.s9d=Object(F.a)(this,this.Hgj,"getRefColumnFromRefCell");Ec.t9d=Object(F.a)(this,this.Jgj,"getRefColumnsWhenSelectColumn");Ec.v9d=Object(F.a)(this,this.Ngj,"getRefRowsWhenSelectRow");Ec.Iae=Object(F.a)(this,this.zpj,"gotoFocusCellAfterInsertColumn");Ec.Zwb=Object(F.a)(this,
this.X3f,"getNewOutlineElementInfoFromCell");Ec.Zzb=a=>this.Ha.Dv||!od.TableReader.szb(a);this.ia.ra(K.a.mIb,rc.a.application,Object(F.a)(this,this.Irj,"handleDeleteTable"),4);this.ia.ra(K.a.amc,Cb.a.view,Object(F.a)(this,this.Krj,"handleDeleteTableRow"),4);this.ia.ra(K.a.jid,Cb.a.view,Object(F.a)(this,this.Jrj,"handleDeleteTableColumn"),4);this.ia.ra(K.a.vLe,rc.a.application,Object(F.a)(this,this.Xvj,"handleSelectTable"),4);this.ia.ra(K.a.kid,rc.a.application,Object(F.a)(this,this.Wsj,"handleInsertTable"),
4);this.ia.ra(K.a.qLe,rc.a.application,Object(F.a)(this,this.Xsj,"handleInsertTableDialog"),4);this.ia.ra(K.a.xah,rc.a.application,Object(F.a)(this,this.Ysj,"handleInsertTableFromRibbon"),4);this.ia.ra(K.a.cHk,rc.a.application,Jr.a.dH,4);this.ia.ra(K.a.dHk,rc.a.application,Jr.a.dH,4);this.ia.ra(K.a.iMk,rc.a.application,Jr.a.d1,96);this.ia.ra(K.a.jMk,rc.a.application,Jr.a.d1,96);this.ia.ra(K.a.vdh,Cb.a.view,Object(F.a)(this,this.GOe,"queryTableCellAnchoring"),96);this.ia.ra(K.a.udh,Cb.a.view,Object(F.a)(this,
this.GOe,"queryTableCellAnchoring"),96);this.ia.ra(K.a.tdh,Cb.a.view,Object(F.a)(this,this.GOe,"queryTableCellAnchoring"),96);this.ia.ya(K.a.lmc,Cb.a.view,Ec.Wja);this.ia.ya(K.a.kmc,Cb.a.view,Ec.Wja);this.ia.ya(K.a.jmc,Cb.a.view,Ec.Wja);this.ia.ya(K.a.lmc,Cb.a.tableCell,Object(F.a)(this,this.ybe,"handleTableCellAnchoring"));this.ia.ya(K.a.kmc,Cb.a.tableCell,Object(F.a)(this,this.ybe,"handleTableCellAnchoring"));this.ia.ya(K.a.jmc,Cb.a.tableCell,Object(F.a)(this,this.ybe,"handleTableCellAnchoring"));
this.ia.je(K.a.lmc,4);this.ia.je(K.a.kmc,4);this.ia.je(K.a.jmc,4);this.ia.ya(K.a.tah,Cb.a.view,Object(F.a)(this,this.Tqj,"handleCellShadingMenuOpen"));this.ia.ra(K.a.Cah,Cb.a.view,Object(F.a)(this,this.puj,"handlePopulateCellShadingColor"),96);this.ia.ya(K.a.N5,Cb.a.view,Ec.Wja);this.ia.ya(K.a.N5,Cb.a.tableCell,Object(F.a)(this,this.Rqj,"handleCellShadingColor"));this.ia.ya(K.a.zah,Cb.a.view,Object(F.a)(this,this.qtj,"handleMoreCellShadingColor"));this.ia.ya(K.a.iid,Cb.a.view,Ec.Wja);this.ia.ya(K.a.iid,
Cb.a.tableCell,Object(F.a)(this,this.Sqj,"handleCellShadingCustomColor"));this.ia.ya(K.a.NJa,Cb.a.view,Ec.Wja);this.ia.ya(K.a.NJa,Cb.a.tableCell,Object(F.a)(this,this.uvj,"handleRemoveCellShading"));this.ia.je(K.a.N5,4);this.ia.je(K.a.NJa,4);this.ia.ra(K.a.Ymc,Cb.a.application,Object(F.a)(this,this.Ymc,"queryLockAspectRatio"),96);this.ia.ra(K.a.$pc,Cb.a.application,Object(F.a)(this,this.$pc,"setLockAspectRatio"),4);this.ia.ra(K.a.EJb,Cb.a.view,Object(F.a)(this,this.EJb,"queryTableRowHeight"),96);
this.ia.ra(K.a.DJb,Cb.a.view,Object(F.a)(this,this.DJb,"queryTableColumnWidth"),96);this.ia.ra(K.a.n0a,Cb.a.view,Object(F.a)(this,this.n0a,"setTableRowHeight"),4);this.ia.ra(K.a.cLa,Cb.a.view,Object(F.a)(this,this.cLa,"setTableColumnWidth"),4);this.ia.ra(K.a.crd,Cb.a.view,Object(F.a)(this,this.n0a,"setTableRowHeight"),4);this.ia.ra(K.a.brd,Cb.a.view,Object(F.a)(this,this.cLa,"setTableColumnWidth"),4);this.ia.ra(K.a.alh,rc.a.application,Object(F.a)(this,this.Hvj,"handleResizeFallbackTable"),4);this.ia.ra(K.a.Enc,
Cb.a.view,Object(F.a)(this,this.Edh,"queryTableSize"),96);this.ia.ra(K.a.Wjd,Cb.a.view,Object(F.a)(this,this.Edh,"queryTableSize"),96);this.ia.ra(K.a.Hoa,Cb.a.view,Object(F.a)(this,this.Lrh,"setTableSize"),4);this.ia.ra(K.a.dLa,Cb.a.view,Object(F.a)(this,this.Lrh,"setTableSize"),4);this.ia.ra(K.a.mergeTableCells,Cb.a.view,Object(F.a)(this,this.ntj,"handleMergeTableCells"),4);this.ia.ra(K.a.splitTableCells,Cb.a.view,Object(F.a)(this,this.wwj,"handleSplitTableCells"),4);this.ia.ra(K.a.vPf,Cb.a.view,
Object(F.a)(this,this.f$f,"handleDistributeRows"),4);this.ia.ra(K.a.uPf,Cb.a.view,Object(F.a)(this,this.Mrj,"handleDistributeColumns"),4);this.ia.ra(K.a.wAh,Cb.a.view,Object(F.a)(this,this.f$f,"handleDistributeRows"),4);this.ia.ra(K.a.S$g,Cb.a.view,Object(F.a)(this,this.ouj,"handlePopulateCellBorderColorMenu"),96);this.ia.ra(K.a.sah,Cb.a.view,Object(F.a)(this,this.Qqj,"handleCellBorderRecentColor"),96);this.ia.ra(K.a.sZg,Cb.a.view,Object(F.a)(this,this.ptj,"handleMoreCellBorderColors"),96);this.ia.ra(K.a.mAh,
Cb.a.view,Object(F.a)(this,this.Hwj,"handleTableBorderWidthAnchor"),4);this.ia.ra(K.a.dza,Cb.a.view,Object(F.a)(this,this.Zvj,"handleSelectTableBorderWidth"),4);this.ia.ra(K.a.Zzh,Cb.a.view,Object(F.a)(this,this.Fwj,"handleTableBorderColorAnchor"),4);this.ia.ra(K.a.Z0a,Cb.a.view,Object(F.a)(this,this.Yvj,"handleSelectTableBorderColor"),4);this.ia.ra(K.a.lAh,Cb.a.view,Object(F.a)(this,this.Gwj,"handleTableBorderTypeAnchor"),4);this.ia.ra(K.a.Zoa,Cb.a.view,Object(F.a)(this,this.FVc,"handleSelectTableBorderType"),
4);this.ia.ra(K.a.aAh,Cb.a.view,Object(F.a)(this,this.Uvj,"handleSelectInsideTableBorderType"),4);this.ia.ra(K.a.$zh,Cb.a.view,Object(F.a)(this,this.kag,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.ra(K.a.bAh,Cb.a.view,Object(F.a)(this,this.lag,"handleSelectInsideVerticalTableBorderType"),4);this.ia.ra(K.a.xOe,Cb.a.view,Object(F.a)(this,this.gvj,"handleQueryTableBorderWidth_1"),96);this.ia.ra(K.a.yOe,Cb.a.view,Object(F.a)(this,this.hvj,"handleQueryTableBorderWidth_2"),96);this.ia.ra(K.a.zOe,
Cb.a.view,Object(F.a)(this,this.ivj,"handleQueryTableBorderWidth_3"),96);this.ia.ra(K.a.AOe,Cb.a.view,Object(F.a)(this,this.jvj,"handleQueryTableBorderWidth_4"),96);this.ia.ra(K.a.BOe,Cb.a.view,Object(F.a)(this,this.kvj,"handleQueryTableBorderWidth_5"),96);this.ia.ra(K.a.COe,Cb.a.view,Object(F.a)(this,this.lvj,"handleQueryTableBorderWidth_6"),96);this.ia.ra(K.a.DOe,Cb.a.view,Object(F.a)(this,this.mvj,"handleQueryTableBorderWidth_7"),96);this.ia.ra(K.a.EOe,Cb.a.view,Object(F.a)(this,this.nvj,"handleQueryTableBorderWidth_8"),
96);this.ia.ra(K.a.FOe,Cb.a.view,Object(F.a)(this,this.ovj,"handleQueryTableBorderWidth_9"),96);this.ia.ra(K.a.sOe,Cb.a.view,Object(F.a)(this,this.bvj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.ra(K.a.vOe,Cb.a.view,Object(F.a)(this,this.evj,"handleQueryTableBorderType_RightBorder"),96);this.ia.ra(K.a.wOe,Cb.a.view,Object(F.a)(this,this.fvj,"handleQueryTableBorderType_TopBorder"),96);this.ia.ra(K.a.mOe,Cb.a.view,Object(F.a)(this,this.Wuj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.ra(K.a.oOe,
Cb.a.view,Object(F.a)(this,this.Yuj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.ra(K.a.nOe,Cb.a.view,Object(F.a)(this,this.Xuj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.ra(K.a.qOe,Cb.a.view,Object(F.a)(this,this.$uj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.ra(K.a.rOe,Cb.a.view,Object(F.a)(this,this.avj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.ra(K.a.pOe,Cb.a.view,Object(F.a)(this,this.Zuj,"handleQueryTableBorderType_InsideBorder"),
96);this.ia.ra(K.a.uOe,Cb.a.view,Object(F.a)(this,this.dvj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.ra(K.a.lOe,Cb.a.view,Object(F.a)(this,this.Vuj,"handleQueryTableBorderType_AllBorder"),96);this.ia.ra(K.a.tOe,Cb.a.view,Object(F.a)(this,this.cvj,"handleQueryTableBorderType_NoBorder"),96)}Ee(){}Era(a){return a.Lp()?Ud.a("TableBordersComplexTableFixEnabled"):!0}OY(){var a=!1;this.ua.Ba&&(a=this.pa.Jp(),a=!!a&&a.ud);return a}Tqj(){return this.OY()?32:8}puj(a,b,c,f,l){if(!this.OY())return 16;
if(1===c)return 32;if(!l)return 8;a=this.ua.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Vb.Ef.c8;b=Object.assign(new tm.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,al.f(a.ke,NE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,al.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,
al.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,al.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",
!0));Ud.a("ColorPickerHighlighterFix")&&(c=this.qA.v_f(this.pa.xv()),al.h(b,c,a.ke));l.MenuItems=b;return 32}qtj(a,b,c,f,l){if(!this.OY())return xa.a.J(512500107,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(K.a.renderColorPicker,1,l);a=this.cij();b={};b.currentColor=a;b.handleCommand=K.a.iid;return this.ia.La(K.a.renderColorPicker,2,b)}Sqj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.N5,c,l);if(!l)return xa.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),
16;a=this.ia.La(K.a.N5,c,l);32===a&&this.ia.La(K.a.QBa,c,l);return a}Rqj(a,b,c,f,l){if(!this.OY())return 16;if(1===c)return 32;if(!l)return 8;b=b.node;l=pe.Box4ColorHelper.oV(l);if(!l)return 8;c=this.Jb.me(15);c.nc(b);c.jd=a;a=b.cellShading;Zo.b(a);a.solidFillField=l;b.cellShading=a;c.dispose();xa.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",PN.a[this.ia.xq]));return 32}uvj(a,b,c){if(!this.OY())return 16;if(1===c)return 32;b=b.node;c=this.Jb.me(15);c.nc(b);c.jd=a;a=
di.a.ui(b,kb.a.cellShading,new CR.a);Zo.b(a);a.noFillField=new ay;b.cellShading=a;c.dispose();return 32}Hwj(){const a=this.pa.Zm();return a&&this.OY()&&this.Ha.FIb&&this.Era(a)?32:8}Zvj(a,b,c,f,l){a=this.pa.Zm();if(!(a&&this.OY()&&this.Era(a)&&this.Ha.FIb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.yH=this.Qz[1];break;case "TableBorderWidth_2":this.yH=this.Qz[2];break;case "TableBorderWidth_3":this.yH=this.Qz[3];break;case "TableBorderWidth_4":this.yH=
this.Qz[4];break;case "TableBorderWidth_5":this.yH=this.Qz[5];break;case "TableBorderWidth_6":this.yH=this.Qz[6];break;case "TableBorderWidth_7":this.yH=this.Qz[7];break;case "TableBorderWidth_8":this.yH=this.Qz[8];break;case "TableBorderWidth_9":this.yH=this.Qz[9]}this.pB.HH();return 32}TJa(a,b){return(a=Object(oa.a)(Uh.a,a))?(this.yH===b?a.Mf(!0):a.Mf(!1),32):8}gvj(a,b,c,f,l){return this.TJa(l,this.Qz[1])}hvj(a,b,c,f,l){return this.TJa(l,this.Qz[2])}ivj(a,b,c,f,l){return this.TJa(l,this.Qz[3])}jvj(a,
b,c,f,l){return this.TJa(l,this.Qz[4])}kvj(a,b,c,f,l){return this.TJa(l,this.Qz[5])}lvj(a,b,c,f,l){return this.TJa(l,this.Qz[6])}mvj(a,b,c,f,l){return this.TJa(l,this.Qz[7])}nvj(a,b,c,f,l){return this.TJa(l,this.Qz[8])}ovj(a,b,c,f,l){return this.TJa(l,this.Qz[9])}Fwj(){const a=this.pa.Zm();return a&&this.OY()&&this.Ha.Fhb&&this.Era(a)?32:8}Yvj(a,b,c,f,l){a=e(this.pa,l);b=a.Zm();if(!(b&&a.OY(this.ua)&&this.Era(b)&&this.Ha.Fhb))return 16;if(1===c)return 32;if(!l)return 8;this.Dx=pe.Box4ColorHelper.oV(l);
this.pB.HH();return 32}ouj(a,b,c,f,l){a=this.pa.Zm();if(!(a&&this.OY()&&this.Era(a)))return 16;if(1===c)return 32;if(!l)return 8;c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Vb.Ef.c8;b=Object.assign(new tm.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,al.f(c.ke,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,al.d("Standard Colors","Color.Menu.Controls",
"standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,al.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));l.MenuItems=b;return 32}Qqj(a,b,c,f,l){if(1===c)return this.ia.La(K.a.Z0a,c,l);if(!l)return xa.a.J(512500100,
822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.La(K.a.Z0a,c,l);32===a&&this.ia.La(K.a.QBa,c,l);return a}ptj(a,b,c,f,l){a=this.pa.Zm();if(!(a&&this.OY()&&this.Ha.Fhb&&this.Era(a)))return xa.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(K.a.renderColorPicker,1,l);c=null;b.al&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=pe.Box4ColorHelper.cta(b.cellShading.solidFillField));b={};b.currentColor=
c;b.handleCommand=K.a.Z0a;return this.ia.La(K.a.renderColorPicker,2,b)}Gwj(){const a=this.pa.Zm();return a&&this.OY()&&this.Ha.kaa&&this.Era(a)?32:8}Uvj(a,b,c,f,l){if(2===c)return this.FVc(a,b,c,f,l);const x=this.kag(a,b,c,f,l);a=this.lag(a,b,c,f,l);return 32===x||32===a?32:8}kag(a,b,c,f,l){if(2===c)return this.FVc(a,b,c,f,l);c=this.pa.Zm();a=!!c&&this.OY()&&this.Ha.kaa&&this.Era(c);if(!a)return 8;if(this.pa.Bs())return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.yc.HF(c));if(!b||!b.length)return 16;
a=!1;c=b[0].rowIndex;for(const x of b)if(c!==x.rowIndex){a=!0;break}return a?32:8}lag(a,b,c,f,l){if(2===c)return this.FVc(a,b,c,f,l);c=this.pa.Zm();a=!!c&&this.OY()&&this.Ha.kaa&&this.Era(c);if(!a)return 8;if(this.pa.Bs())return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.yc.HF(c));if(!b||!b.length)return 16;a=!1;c=b[0].pi;for(const x of b)if(c!==x.pi){a=!0;break}return a?32:8}FVc(a,b,c,f,l){var x;b=e(this.pa,l);if(b.Bs())return 16;const H=b.Zm();if(!H)return 16;if(1===c)return this.Era(H)?
32:8;if(!l)return xa.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),16;let U=b.xv();if(!U)return 16;U.length||(U=this.GDa(this.yc.HF(H)));if(!U||!U.length)return xa.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;c=this.yH;let ja=ye.a.GH(c),ya=null!==(x=l.BorderColor)&&void 0!==x?x:this.Dx;const Va=l.SourceControlId,hb=!!l.DoNotCreateTransaction;if(!Va||!ya)return xa.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),
8;this.LF.Hb(Va)&&this.LF.ga(Va)&&(ja=c=0,ya=qu.a.parse("000000").YLa());return uu.HTi(a,Va,c.toString(),this.HAi(ya),PN.a[this.ia.xq],()=>{let yb;hb||(yb=this.Jb.me(15),yb.nc(H),yb.jd=a);this.WFl(a,Va,H,U,ja,ya);yb&&yb.dispose();return 32})}WFl(a,b,c,f,l,x){switch(b){case "TableBordersTopBorder":this.GTa(c,f,l,x,!1,!1);break;case "TableBordersBottomBorder":this.BTa(c,f,l,x,!1,!1);break;case "TableBordersLeftBorder":this.ETa(c,f,l,x,!1,!1);break;case "TableBordersRightBorder":this.FTa(c,f,l,x,!1,
!1);break;case "TableBordersInsideHorizontalBorder":this.CTa(c,f,l,x,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.DTa(c,f,l,x,!1,!1,!1);break;case "TableBordersInsideBorders":this.CTa(c,f,l,x,!1,!1,!1);this.DTa(c,f,l,x,!1,!1,!1);break;case "TableBordersOutsideBorders":this.GTa(c,f,l,x,!1,!1);this.BTa(c,f,l,x,!1,!1);this.ETa(c,f,l,x,!1,!1);this.FTa(c,f,l,x,!1,!1);break;case "TableBordersNoBorder":l=0;x=qu.a.parse("000000").YLa();this.GTa(c,f,l,x,!1,!1);this.BTa(c,f,l,x,!1,!1);this.ETa(c,
f,l,x,!1,!1);this.FTa(c,f,l,x,!1,!1);this.CTa(c,f,l,x,!1,!1,!1);this.DTa(c,f,l,x,!1,!1,!1);this.Ha.GLe&&(this.S9f(f,l,x),this.R9f(f,l,x));break;case "TableBordersAllBorders":this.GTa(c,f,l,x,!1,!1);this.BTa(c,f,l,x,!1,!1);this.ETa(c,f,l,x,!1,!1);this.FTa(c,f,l,x,!1,!1);this.CTa(c,f,l,x,!1,!1,!1);this.DTa(c,f,l,x,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.S9f(f,l,x);break;case "TableBordersDiagonalDownBorder":this.R9f(f,l,x);break;default:xa.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",
b,a))}}GDa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}bvj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.ETa(a,b,c,this.Dx,!0,!1)?(this.LF.$("TableBordersLeftBorder",!0),l.Mf(!0)):(this.LF.$("TableBordersLeftBorder",!1),l.Mf(!1)),32):8}evj(a,
b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.FTa(a,b,c,this.Dx,!0,!1)?(this.LF.$("TableBordersRightBorder",!0),l.Mf(!0)):(this.LF.$("TableBordersRightBorder",!1),l.Mf(!1)),32):8}fvj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||
(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.GTa(a,b,c,this.Dx,!0,!1)?(this.LF.$("TableBordersTopBorder",!0),l.Mf(!0)):(this.LF.$("TableBordersTopBorder",!1),l.Mf(!1)),32):8}Wuj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),
16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.BTa(a,b,c,this.Dx,!0,!1)?(this.LF.$("TableBordersBottomBorder",!0),l.Mf(!0)):(this.LF.$("TableBordersBottomBorder",!1),l.Mf(!1)),32):8}$uj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.yc.HF(a));if(!b||!b.length)return xa.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.CTa(a,b,c,
this.Dx,!0,!1,!1)?(this.LF.$("TableBordersInsideHorizontalBorder",!0),l.Mf(!0)):(this.LF.$("TableBordersInsideHorizontalBorder",!1),l.Mf(!1)),32):8}avj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.yc.HF(a));if(!b||!b.length)return xa.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.DTa(a,b,c,this.Dx,!0,!1,!1)?(this.LF.$("TableBordersInsideVerticalBorder",
!0),l.Mf(!0)):(this.LF.$("TableBordersInsideVerticalBorder",!1),l.Mf(!1)),32):8}Yuj(a,b,c,f,l){return this.Z$f(l,"TableBordersDiagonalUpBorder")}Xuj(a,b,c,f,l){return this.Z$f(l,"TableBordersDiagonalDownBorder")}Z$f(a,b){if(!this.Ha.GLe)return 8;const c=this.pa.Zm();if(!c||!a)return 16;var f=this.pa.xv();if(!f)return 16;f.length||(f=this.GDa(this.yc.HF(c)));if(!f||!f.length)return xa.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",
b)),16;a=Object(oa.a)(Uh.a,a);if(null===a)return 8;f=this.NJj(b,f,ye.a.GH(this.yH));this.LF.$(b,f);a.Mf(f);return 32}NJj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.Khg(b,c,this.Dx,!1);case "TableBordersDiagonalDownBorder":return this.Jhg(b,c,this.Dx,!1);default:return xa.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}Zuj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.yc.HF(a));if(!b||!b.length)return xa.a.J(512500058,
822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(1<b.length&&this.DTa(a,b,c,this.Dx,!0,!1,!0)&&this.CTa(a,b,c,this.Dx,!0,!1,!0)?(this.LF.$("TableBordersInsideBorders",!0),l.Mf(!0)):(this.LF.$("TableBordersInsideBorders",!1),l.Mf(!1)),32):8}dvj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),
16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.GTa(a,b,c,this.Dx,!0,!1)&&this.FTa(a,b,c,this.Dx,!0,!1)&&this.BTa(a,b,c,this.Dx,!0,!1)&&this.ETa(a,b,c,this.Dx,!0,!1)?(this.LF.$("TableBordersOutsideBorders",!0),l.Mf(!0)):(this.LF.$("TableBordersOutsideBorders",!1),l.Mf(!1)),32):8}Vuj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(this.GTa(a,b,c,this.Dx,!0,!1)&&this.FTa(a,b,c,this.Dx,!0,!1)&&this.BTa(a,b,c,this.Dx,!0,!1)&&this.ETa(a,b,c,this.Dx,!0,!1)&&this.CTa(a,b,c,this.Dx,!0,!1,!0)&&this.DTa(a,b,c,this.Dx,!0,!1,!0)?(this.LF.$("TableBordersAllBorders",!0),l.Mf(!0)):(this.LF.$("TableBordersAllBorders",!1),l.Mf(!1)),32):8}cvj(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.xv();if(!b)return 16;b.length||(b=this.GDa(this.yc.HF(a)));if(!b||!b.length)return xa.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(oa.a)(Uh.a,l);c=ye.a.GH(this.yH);return l?(f=!0,this.Ha.GLe&&(f=this.Khg(b,c,this.Dx,!0)&&this.Jhg(b,c,this.Dx,!0)),f&&this.GTa(a,b,c,this.Dx,!0,!0)&&this.FTa(a,b,c,this.Dx,!0,!0)&&this.BTa(a,b,c,this.Dx,!0,!0)&&this.ETa(a,b,c,this.Dx,!0,!0)&&this.CTa(a,b,c,this.Dx,!0,!0,!0)&&this.DTa(a,b,c,this.Dx,!0,!0,!0)?(this.LF.$("TableBordersNoBorder",!0),l.Mf(!0)):(this.LF.$("TableBordersNoBorder",!1),l.Mf(!1)),32):8}GEa(a,
b){if(!a)return!1;const c=pe.Box4ColorHelper.Soa(a),f=pe.Box4ColorHelper.Soa(b);a=pe.Box4ColorHelper.cta(a);b=pe.Box4ColorHelper.cta(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.sD===b.sD:!1}HAi(a){a=pe.Box4ColorHelper.Soa(a);const b=this.ua.Ba;return(a=pe.Box4ColorHelper.TJ(a,b?b.ke:null))&&pe.Box4ColorHelper.epa(a)?pe.Box4ColorHelper.epa(a).jV():null}Tub(a,b,c,f){if(a=Object(oa.a)(bt,a.sc(this.Fb.Ma))){f=
pe.Box4ColorHelper.Soa(f);var l=this.ua.Ba;f=(f=pe.Box4ColorHelper.TJ(f,l?l.ke:null))?pe.Box4ColorHelper.epa(f):null;a.S9k(b,c,f)}}ov(a,b,c,f){if(a)switch(b){case "Top":a.fza=c;a.DLa=f;this.Tub(a,"Top",c,f);break;case "Right":a.wga=c;a.uga=f;this.Tub(a,"Right",c,f);break;case "Bottom":a.vga=c;a.tga=f;this.Tub(a,"Bottom",c,f);break;case "Left":a.eza=c;a.CLa=f;this.Tub(a,"Left",c,f);break;case "DiagonalUp":a.Wkb=c;a.Ukb=f;this.Tub(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.Vkb=c,a.Tkb=f,this.Tub(a,
"DiagonalDown",c,f)}}GTa(a,b,c,f,l,x){const H=new Ma.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const ya of b)b=ya.pi,U=Math.min(U,b),ja=Math.max(ja,b),H.Hb(b)?H.$(b,Math.min(H.ga(b),ya.rowIndex)):H.$(b,ya.rowIndex);if(l)return this.fWj(a,c,f,U,ja,H,x);this.Cqj(a,c,f,U,ja,H);return!0}Cqj(a,b,c,f,l,x){if(Ud.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=a.qf(x.ga(f),f);this.ov(U,"Top",b,c);let ja=f;const ya=f+U.colSpan;for(;ja<ya;){var H=a.qf(x.ga(f)-1,ja);H?H.isGhostCell?(H=
H.Xy(),H.pi<f?ja+=1:(this.ov(H,"Bottom",b,c),ja+=H.colSpan)):(this.ov(H,"Bottom",b,c),ja+=H.colSpan):ja+=1}f+=U.colSpan}else for(;f<=l;++f)this.ov(a.qf(x.ga(f),f),"Top",b,c),this.ov(a.qf(x.ga(f)-1,f),"Bottom",b,c)}fWj(a,b,c,f,l,x,H){for(;f<=l;){const U=a.qf(x.ga(f),f),ja=U.DLa,ya=ye.a.oM(U.fza),Va=ye.a.oM(b);if(H){if(ya!==this.Qz[0])return!1}else if(ya!==Va||!this.GEa(ja,c))return!1;f+=U.colSpan}return!0}BTa(a,b,c,f,l,x){const H=new Ma.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const ya of b)b=
ya.pi,U=Math.min(U,b),ja=Math.max(ja,b),H.Hb(b)?H.$(b,Math.max(H.ga(b),ya.rowIndex)):H.$(b,ya.rowIndex);if(l)return this.QJj(a,c,f,U,ja,H,x);this.lqj(a,c,f,U,ja,H);return!0}lqj(a,b,c,f,l,x){if(Ud.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=a.qf(x.ga(f),f);this.ov(U,"Bottom",b,c);let ja=f;const ya=f+U.colSpan;for(;ja<ya;){var H=a.qf(x.ga(f)+U.rowSpan,ja);H?H.isGhostCell?(H=H.Xy(),H.pi<f?ja+=1:(this.ov(H,"Top",b,c),ja+=H.colSpan)):(this.ov(H,"Top",b,c),ja+=H.colSpan):ja+=1}f+=U.colSpan}else for(;f<=
l;++f)this.ov(a.qf(x.ga(f),f),"Bottom",b,c),this.ov(a.qf(x.ga(f)+1,f),"Top",b,c)}QJj(a,b,c,f,l,x,H){for(;f<=l;){const U=a.qf(x.ga(f),f),ja=U.tga,ya=ye.a.oM(U.vga),Va=ye.a.oM(b);if(H){if(ya!==this.Qz[0])return!1}else if(ya!==Va||!this.GEa(ja,c))return!1;f+=U.colSpan}return!0}ETa(a,b,c,f,l,x){const H=new Ma.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const ya of b)b=ya.rowIndex,U=Math.min(U,b),ja=Math.max(ja,b),H.Hb(b)?H.$(b,Math.min(H.ga(b),ya.pi)):H.$(b,ya.pi);if(l)return this.oPj(a,c,f,
U,ja,H,x);this.sqj(a,c,f,U,ja,H);return!0}sqj(a,b,c,f,l,x){if(Ud.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=a.qf(f,x.ga(f));this.ov(U,"Left",b,c);let ja=f;const ya=f+U.rowSpan;for(;ja<ya;){var H=a.qf(ja,x.ga(f)-1);H?H.isGhostCell?(H=H.Xy(),H.rowIndex<f?ja+=1:(this.ov(H,"Right",b,c),ja+=H.rowSpan)):(this.ov(H,"Right",b,c),ja+=H.rowSpan):ja+=1}f+=U.rowSpan}else for(;f<=l;++f)this.ov(a.qf(f,x.ga(f)),"Left",b,c),this.ov(a.qf(f,x.ga(f)-1),"Right",b,c)}oPj(a,b,c,f,l,x,H){for(;f<=l;){const U=
a.qf(f,x.ga(f)),ja=U.CLa,ya=ye.a.oM(U.eza),Va=ye.a.oM(b);if(H){if(ya!==this.Qz[0])return!1}else if(ya!==Va||!this.GEa(ja,c))return!1;f+=U.rowSpan}return!0}FTa(a,b,c,f,l,x){const H=new Ma.ScriptSharpLegacyMap;let U=Number.MAX_VALUE,ja=-1;for(const ya of b)b=ya.rowIndex,U=Math.min(U,b),ja=Math.max(ja,b),H.Hb(b)?H.$(b,Math.max(H.ga(b),ya.pi)):H.$(b,ya.pi);if(l)return this.lTj(a,c,f,U,ja,H,x);this.tqj(a,c,f,U,ja,H);return!0}tqj(a,b,c,f,l,x){if(Ud.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const U=
a.qf(f,x.ga(f));this.ov(U,"Right",b,c);let ja=f;const ya=f+U.rowSpan;for(;ja<ya;){var H=a.qf(ja,x.ga(f)+U.colSpan);H?H.isGhostCell?(H=H.Xy(),H.rowIndex<f?ja+=1:(this.ov(H,"Left",b,c),ja+=H.rowSpan)):(this.ov(H,"Left",b,c),ja+=H.rowSpan):ja+=1}f+=U.rowSpan}else for(;f<=l;++f)this.ov(a.qf(f,x.ga(f)),"Right",b,c),this.ov(a.qf(f,x.ga(f)+1),"Left",b,c)}lTj(a,b,c,f,l,x,H){for(;f<=l;){const U=a.qf(f,x.ga(f)),ja=U.uga,ya=ye.a.oM(U.wga),Va=ye.a.oM(b);if(H){if(ya!==this.Qz[0])return!1}else if(ya!==Va||!this.GEa(ja,
c))return!1;f+=U.rowSpan}return!0}DTa(a,b,c,f,l,x,H){b=this.pa.txb();if(!b)return!1;b.length||(b=this.yc.HF(a));if(!b||!b.length)return xa.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const U=new Ma.ScriptSharpLegacyMap,ja=new Ma.ScriptSharpLegacyMap;let ya=Number.MAX_VALUE,Va=-1;for(const hb of b)b=hb.rowIndex,ya=Math.min(ya,b),Va=Math.max(Va,b),U.Hb(b)?U.$(b,Math.min(U.ga(b),hb.pi)):U.$(b,hb.pi),ja.Hb(b)?ja.$(b,Math.max(ja.ga(b),hb.pi)):ja.$(b,hb.pi);
if(l)return this.POj(a,c,f,ya,Va,U,ja,x,H);this.rqj(a,c,f,ya,Va,U,ja);return!0}rqj(a,b,c,f,l,x,H){if(Ud.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(x.Hb(f)&&H.Hb(f))for(var U=x.ga(f),ja=H.ga(f);U<ja;){const Va=a.qf(f,U);if(!Va.isGhostCell&&Va.pi+Va.colSpan<=ja){this.ov(Va,"Right",b,c);let hb=f;const yb=f+Va.rowSpan;for(;hb<yb;){var ya=a.qf(hb,U+Va.colSpan);ya?ya.isGhostCell?(ya=ya.Xy(),ya.rowIndex<f?hb+=1:(this.ov(ya,"Left",b,c),hb+=ya.rowSpan)):(this.ov(ya,"Left",b,c),hb+=ya.rowSpan):
hb+=1}}U+=Va.colSpan}}else for(;f<=l;++f)for(U=x.ga(f),ja=H.ga(f);U<ja;++U)this.ov(a.qf(f,U),"Right",b,c),this.ov(a.qf(f,U+1),"Left",b,c)}POj(a,b,c,f,l,x,H,U,ja){if(Ud.a("TableBordersComplexTableFixEnabled")){for(var ya=!1;f<=l;f++)if(x.Hb(f)&&H.Hb(f))for(var Va=x.ga(f),hb=H.ga(f);Va<hb;){var yb=a.qf(f,Va);if(!yb.isGhostCell&&yb.pi+yb.colSpan<=hb){var Zb=yb.uga;let fc=ye.a.oM(yb.wga),Kc=ye.a.oM(b);ya=!0;if(U){if(fc!==this.Qz[0])return!1}else if(fc!==Kc||!this.GEa(Zb,c))return!1}Va+=yb.colSpan}return ya?
!0:ja}for(ya=f;ya<=l;++ya){hb=x.ga(ya);f=H.ga(ya);if(hb===f)return ja?!0:!1;for(;hb<f;++hb)if(yb=a.qf(ya,hb),Va=yb.uga,yb=ye.a.oM(yb.wga),Zb=ye.a.oM(b),U){if(yb!==this.Qz[0])return!1}else if(yb!==Zb||!this.GEa(Va,c))return!1}return!0}CTa(a,b,c,f,l,x,H){b=this.pa.txb();if(!b)return!1;b.length||(b=this.yc.HF(a));if(!b||!b.length)return xa.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const U=new Ma.ScriptSharpLegacyMap,ja=new Ma.ScriptSharpLegacyMap;
let ya=Number.MAX_VALUE,Va=-1;for(const hb of b)b=hb.pi,ya=Math.min(ya,b),Va=Math.max(Va,b),U.Hb(b)?U.$(b,Math.min(U.ga(b),hb.rowIndex)):U.$(b,hb.rowIndex),ja.Hb(b)?ja.$(b,Math.max(ja.ga(b),hb.rowIndex)):ja.$(b,hb.rowIndex);if(l)return this.OOj(a,c,f,ya,Va,U,ja,x,H);this.qqj(a,c,f,ya,Va,U,ja);return!0}qqj(a,b,c,f,l,x,H){if(Ud.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(x.Hb(f)&&H.Hb(f))for(var U=x.ga(f),ja=H.ga(f);U<ja;){const Va=a.qf(U,f);if(!Va.isGhostCell&&Va.rowIndex+Va.rowSpan<=
ja){this.ov(Va,"Bottom",b,c);let hb=f;const yb=f+Va.colSpan;for(;hb<yb;){var ya=a.qf(U+Va.rowSpan,hb);ya?ya.isGhostCell?(ya=ya.Xy(),ya.pi<f?hb+=1:(this.ov(ya,"Top",b,c),hb+=ya.colSpan)):(this.ov(ya,"Top",b,c),hb+=ya.colSpan):hb+=1}}U+=Va.rowSpan}}else for(;f<=l;++f)for(U=x.ga(f),ja=H.ga(f);U<ja;++U)this.ov(a.qf(U,f),"Bottom",b,c),this.ov(a.qf(U+1,f),"Top",b,c)}OOj(a,b,c,f,l,x,H,U,ja){if(Ud.a("TableBordersComplexTableFixEnabled")){for(var ya=!1;f<=l;f++)if(x.Hb(f)&&H.Hb(f))for(var Va=x.ga(f),hb=H.ga(f);Va<
hb;){var yb=a.qf(Va,f);if(!yb.isGhostCell&&yb.rowIndex+yb.rowSpan<=hb){var Zb=yb.tga;let fc=ye.a.oM(yb.vga),Kc=ye.a.oM(b);ya=!0;if(U){if(fc!==this.Qz[0])return!1}else if(fc!==Kc||!this.GEa(Zb,c))return!1}Va+=yb.rowSpan}return ya?!0:ja}for(ya=f;ya<=l;++ya){hb=x.ga(ya);f=H.ga(ya);if(hb===f)return ja?!0:!1;for(;hb<f;++hb)if(yb=a.qf(hb,ya),Va=yb.tga,yb=ye.a.oM(yb.vga),Zb=ye.a.oM(b),U){if(yb!==this.Qz[0])return!1}else if(yb!==Zb||!this.GEa(Va,c))return!1}return!0}S9f(a,b,c){for(const f of a)this.ov(f,
"DiagonalUp",b,c)}Khg(a,b,c,f){for(const l of a)if(!this.Rlg(ye.a.oM(l.Wkb),ye.a.oM(b),l.Ukb,c,f))return!1;return!0}R9f(a,b,c){for(const f of a)this.ov(f,"DiagonalDown",b,c)}Jhg(a,b,c,f){for(const l of a)if(!this.Rlg(ye.a.oM(l.Vkb),ye.a.oM(b),l.Tkb,c,f))return!1;return!0}Rlg(a,b,c,f,l){if(l){if(a!==this.Qz[0])return!1}else if(a!==b||!this.GEa(c,f))return!1;return!0}GOe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[Sh.a.On]=!1;a=this.PVa[a.toString()];if(!this.pa||!this.pa.Na.mb||this.pa.k9())return 16;
b=0;({txa:b}=this.yc.Dtd(this.pa.Na)).returnValue&&b===a&&(l[Sh.a.On]=!0);return 32}eqc(a,b){a=a.queryResult;null!==a&&(a.Kaa=parseFloat(b.toFixed(2)).toString())}Ymc(a,b,c,f,l){if(!l)return 16;l.Mf(this.pfc);return 32}$pc(a,b,c){if(1===c)return 32;2===c&&(this.pfc=!this.pfc);Oc.App.Kb.sG({SetLockAspectRatio:"CheckboxModel"});return 32}Edh(a,b,c,f,l){if(!l)return 16;b=this.pa.Zm();if(!b)return 8;a=a===K.a.Enc?this.yc.M$d(b):this.yc.O$d(b);this.eqc(l,ye.a.Ov(a));return 32}Lrh(a,b,c,f,l){const x=this.pa.Zm();
return a!==K.a.Hoa&&a!==K.a.dLa||!x?16:1===c?32:Kg.a(String.format("{0}::Entry point:{1}",K.a.Wz(a),this.ia.xq),a,()=>{if(!l)return xa.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var H=ye.a.OW(l.Number);var U=a===K.a.Hoa?this.yc.M$d(x):this.yc.O$d(x);if(H<Pv.a.Scd||U<Pv.a.Scd)return 16;H/=U;U=this.Jb.me(15);try{U.nc(x),U.jd=a,a===K.a.Hoa?(this.Ks.Hoa(x,H),this.pfc&&this.Ks.dLa(x,H)):(this.Ks.dLa(x,H),this.pfc&&this.Ks.Hoa(x,H)),this.Ks.d_a(x)}finally{U&&U.dispose()}return 32})}EJb(a,
b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.bUc();if(!b)return 16;b.length||(b=this.yc.oka(a));if(!b.length)return 16;a=this.iYa.b0f(b);this.eqc(l,ye.a.Ov(a));return 32}n0a(a,b,c,f,l){const x=this.pa.Zm();return x?1===c?32:Kg.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.xq),a,()=>{if(null===l)return xa.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let H=this.pa.bUc();if(!H)return xa.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),
16;H.length||(H=this.yc.oka(x));if(!H.length)return 16;let U=Pv.a.cZg;a!==K.a.crd&&(U=l.Number);const ja=this.Jb.me(15);try{ja.nc(x),ja.jd=a,this.Ks.Krh(H,U)}finally{ja&&ja.dispose()}this.Ks.d_a(x);return 32}):16}DJb(a,b,c,f,l){a=this.pa.Zm();if(!a)return 16;b=this.pa.txb();if(!b)return 16;b.length||(b=this.Axb(a));if(!b.length)return 16;a=this.yJ.d0f(a,b);this.eqc(l,ye.a.Ov(a));return 32}cLa(a,b,c,f,l){const x=this.pa.Zm();return x?1===c?32:Kg.a(String.format("SetTableColumnWidth::Entry point:{0}",
this.ia.xq),a,()=>{if(null===l)return xa.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var H=this.pa.txb();if(!H)return xa.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;H.length||(H=this.Axb(x));if(!H.length)return 16;let U=Pv.a.bZg;a!==K.a.brd&&(U=l.Number);H=this.yJ.c6d(H);const ja=this.Jb.me(15);try{ja.nc(x),ja.jd=a,this.Ks.Jrh(x,H,U)}finally{ja&&ja.dispose()}this.Ks.d_a(x);return 32}):16}f$f(a,b,c,f,l){const x=this.pa.Zm();
return x?1===c?Ud.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:x.Lp()?8:32:Kg.a("HandleDistributeRows:Entry point:"+this.ia.xq,a,()=>{if(2===c){if(null===l)return 16;let ja=this.pa.bUc();if(!ja)return 16;var H=this.pa.xv();if(!H)return 16;ja.length&&1!==H.length||(ja=this.yc.oka(x));if(!ja)return 16;if(!ja.length)return xa.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;H=0;for(var U of ja)U&&(H+=this.iYa.H9a(U));U=this.Ncj(ja,x);const ya=ja.length;H=H<
ya*U?U:H/ya;U=this.Jb.me(15);try{U.nc(x),U.jd=a,this.Ks.Krh(ja,ye.a.Ov(H))}finally{U&&U.dispose()}xa.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",ye.a.Ov(H),this.ia.xq);this.Ks.d_a(x)}return 32}):16}Ncj(a,b){let c=ye.a.OW(Pv.a.cZg);for(const l of a){a=this.yc.h$a(l);for(const x of a)if(x&&(a=x.n4b)&&(a=Sb.ParagraphReader.text(a))&&0<a.length){var f=x.rowIndex;const H=x.pi;if(a=Object(oa.a)(bt,x.sc(this.Fb.Ma)))this.YX.mbh(b,this.Fb.Ma),
f=this.YX.g5b(b,a.hja,f,H),a=a.Md.Ld.rf(f,1),Ud.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<x.rowSpan&&(a/=x.rowSpan),c=Math.max(c,a)}}return c}Mrj(a,b,c,f,l){const x=this.pa.Zm();return x?1===c?Ud.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:x.Lp()?8:32:Kg.a("HandleDistributeColumns:Entry point:"+this.ia.xq,a,()=>{if(2===c){if(null===l)return 16;var H=this.pa.txb();H.length||(H=this.Axb(x));if(!H)return 16;var U=this.pa.xv();if(!U)return 16;H.length&&1!==U.length||(H=this.Axb(x));
if(!H.length)return xa.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;U=0;H=this.yJ.c6d(H);if(!H)return xa.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var ja=x.Y5d;if(!ja)return xa.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let ya=0;ya<H.length;ya++)U+=ja[H[ya]];U/=H.length;if(ye.a.Ov(U)<Pv.a.bZg)return 16;ja=this.Jb.me(15);try{ja.nc(x),ja.jd=a,this.Ks.Jrh(x,H,ye.a.Ov(U))}finally{ja&&
ja.dispose()}xa.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",ye.a.Ov(U),this.ia.xq);this.Ks.d_a(x)}return 32}):16}ybe(a,b,c,f,l){if(!this.Ha.gme||this.pa.k9())return 16;if(1===c)return 32;if(!l)return 8;c=this.PVa[a.toString()];b=b.node;f=this.Jb.me(15);f.nc(b);f.jd=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.$oa=c;f.dispose();return 32}Wsj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.hf.$c(b))return 16;if(!this.Wj.OF(b,1))return this.Wj.nG(b),
16;c=l.Rows;f=l.Columns;l=l.From;var x=b.Cb;x=b.e3(x.sid,x.cid,0,c,f,b.Ut());var H=b.A3(this.pa.Wd());if(H){if(this.hf.$c(H)||this.Fa.SI(H))return 16;this.Sk.P9k(x,H.id);this.hf.fw(H,a)}H=this.Jb.Ad(15,void 0,()=>{this.pa.ay();this.pa.Qh();this.Ea.Ed()});try{H.nc(b),H.jd=a,b.dC(x)}finally{H&&H.dispose()}this.pa.selectShape(x,!0);xa.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Nu.SF=x;return 32}Xsj(){(new RN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.La(K.a.kid,
2,c)})).sqd();return 32}Ysj(a,b,c,f,l){l.From="Ribbon";return this.ia.La(K.a.kid,c,l)}Irj(a,b,c){b=this.ua.Ba;if(!b||this.pa.k9())return 16;const f=this.pa.Jp();if(!f||!f.ud||this.hf.$c(f))return 16;if(1===c)return 32;Tc.a.nP(!0,!0);c=this.Jb.Ad(15,void 0,()=>{this.pa.setSelection(null);this.Ea.Ed()});try{c.nc(b),c.jd=a,this.Sk.rNc(f)}finally{c&&c.dispose()}this.hf.fw(b,a);return 32}Krj(a,b,c,f,l){if(this.pa.Bs())return 16;a=this.F9d(this.pa.Pj,!0,this.pa);return this.WIj(a)?16:32!==a.response?8:
a.fD&&a.fD.length===od.TableReader.sk(a.gp)?this.ia.processAction(K.a.mIb,c):this.ia.mi(b,D.a.deleteRow,c,!1,f,l)}Jrj(a,b,c,f,l){if(this.pa.Bs())return 16;a=this.F9d(this.pa.Pj,!1,this.pa);return this.VIj(a)?16:32!==a.response?8:a.fD&&a.fD.length===od.TableReader.Ai(a.gp)?this.ia.processAction(K.a.mIb,c):this.ia.mi(b,D.a.ZCa,c,!1,f,l)}Xvj(a,b,c,f,l){return 1===c?32:this.ia.mi(b,K.a.fja,c,!1,f,l)}ntj(a,b,c){if(this.pa.Bs()||this.pa.k9()||!this.Ha.k0c)return 16;b=this.pa.Na;if(!b||!b.Hl||1===b.length&&
1===b.ga(0).length)return 16;b=this.yFb.F6b(b);if(!b)return xa.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.VSj)return 16;if(1===c)return 32;Tc.a.Ib&&(Tc.a.Ib.Nj=!0,Tc.a.Ib.sF=new Date);xa.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Jb.me(15);c.nc(f);c.jd=a;a=this.MUg.merge(f,b.Xsb,b.VY);a=cr.TableNodeContext.create(a);a=Qd.SelectionFactory.x1b(Qd.SelectionFactory.Du(a));this.pa.QE(a);c.dispose();xa.a.J(36721630,822,50,"Table merge cells succeeded");
return 32}wwj(a,b,c,f,l){if(this.pa.Bs()||this.pa.k9()||!this.Ha.lme)return 16;f=null;f=this.pa.Na.Hl?this.yFb.F6b(this.pa.Na):this.yFb.zjj(b.view.Lb.Pj);if(!f)return 16;const x=f.tableNode.mg(this.Fb.Ma);if(x&&!x.mPj)return xa.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const H=Object(oa.a)(173,f.tableNode);if(this.yc.sie(H))return 16;const U=f.Xsb;if(!({rows:b,cols:a}=this.gzl(H,U)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const ja=f.VY,ya=new Date;
({rows:c,cols:f}=this.Y4i(H,ja,U,x));const Va=Tc.a.Ib;Va&&(Va.Va("GetClientSplitLimit",(+new Date-+ya).toString()),Va.Ur=!1);const hb=(yb,Zb)=>{this.MUg.lpl(H,U,yb,Zb,ja,x,this.Fb.Ld,Object(F.a)(this,this.X3f,"getNewOutlineElementInfoFromCell"),()=>{})};l&&l.rows&&l.columns&&!Number.isNaN(l.rows)&&!Number.isNaN(l.columns)?(b=Number.parseInt(l.rows),l=Number.parseInt(l.columns),l>f&&(l=f),b>c&&(b=c),hb(b,l)):(new SN((yb,Zb)=>{hb(yb,Zb)},Math.min(b,c),Math.min(a,f))).sqd();return 32}Hvj(a,b,c,f,l){if(!l||
!Object(Xa.a)(Array,l))return 8;if(1!==l.length)return xa.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.hf.$c(l[0].B1))return 16;b=l[0].B1;if(!(b&&b.isConnected&&b.isResizable&&b.ud)||b.SI)return xa.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(oa.a)(117,b.sc(this.Fb.Ma));if(!f)return xa.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",
b.get_shapeId()),8;const x=this.yc.JN(b);if(!x)return xa.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const H=x.sc(this.Fb.Ma);if(!H)return xa.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].N2b)return f&&f.setOffsets(new Oi.a,!0),xa.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let U=c=1;try{f.Ok.Gnh.Gtb.length||
(this.E9c=new Oi.a);f.setOffsets(new Oi.a,!0);var ja=H.E6b();const ya=this.cGa.Qm(ja.$b-ja.hc),Va=this.cGa.Qm(ja.Yb-ja.kc),hb=new hd.a(f.x+ya,f.y+Va),yb=new hd.a(f.aga(l[0].wZg.x),f.aga(l[0].wZg.y)),Zb=Yk.HTd(l[0].N2b,ja,yb,!1,!1);c=ya?1+(Zb.right-Zb.left)/ya:1;U=Va?1+(Zb.bottom-Zb.top)/Va:1;H.Nrh(c,U);const fc=H.E6b();let Kc=ei.a.Q5b(fc,ja);Kc.Ij(1/f.vd);this.E9c&&(Kc=Oi.a.add(Kc,this.E9c));f.setOffsets(Kc,!0);this.E9c=Kc;l[0].l1.Ij(f.vd);this.x0e(l[0].N2b,f,fc,hb,l[0].l1)}catch(ya){return xa.a.J(512500002,
822,50,"Fallback table resize fail: ",ya.toString()),8}ja=this.Jb.me(15);ja.nc(x);ja.jd=a;a=H.Md.Ld;this.Ks.xSe(x,c,U,H,a);if(uu.cFa(l[0].N2b)||uu.cFa(l[0].N2b,!0))l=a.rf(f.x,0),a=a.rf(f.y,1),b.wy=l,b.yy=a;ja.dispose();return 32}gzl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.yc.sk(a))/b.UO)+1),f=Math.max(1,Math.floor((35-this.yc.Ai(a))/b.xR)+1),{returnValue:!0,rows:c,cols:f}}catch(l){xa.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,
rows:c,cols:f}}Y4i(a,b,c,f){a=this.pea.xDa(a,b,c);b=f.T5f();f=f.P_f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const x=a.dA;l=Math.min(l,b[x.$f]-b[x.re]);c=Math.min(c,f[x.Of]-f[x.ge])}return{rows:Math.max(1,Math.floor(l/TN.a)),cols:Math.max(1,Math.floor(c/TN.a))}}X3f(a){const b=Qh.B4f(a,!1);b.style||(b.style=new lq.a);a=Object(oa.a)(tb.GraphIterator,this.Qb.Nc(a));a.ev();if(a.ZA(1)){if(rb.ListReader.uk(a)){const f=this.lA.jw(a),l=dj.a.wN(f.listType,f.listStyle);0===l.listType&&(l.xA=l.hX=f.xA);
f.propertySet.Sa($a.a.Ri)&&l.propertySet.setValue($a.a.Ri,f.propertySet.eb($a.a.Ri));f.propertySet.Sa($a.a.font)&&l.propertySet.setValue($a.a.font,f.propertySet.eb($a.a.font));f.propertySet.Sa(kb.a.autonumberBulletType)&&l.propertySet.setValue(kb.a.autonumberBulletType,f.propertySet.eb(kb.a.autonumberBulletType));b.style.$x(l.propertySet)}var c;(c=b.style).z7a.apply(c,[a.currentNode].concat(Zq.Bae()));if(c=a.ZA(2)){let f;(f=b.style).z7a.apply(f,[c].concat(Zq.Bae()));a.zc()}}return b}Lgj(a,b){const c=
new au;c.response=8;if(!a)return c;let f=null;var l=null,x=!1;const H=Ih.ContextSetEditor.instance.LA(a);a=[];for(var U=0;U<H.length;++U)if(H[U].al){var ja=Object(oa.a)(5,H[U].node);if(!ja||!ja.Cs())return c;ja=ja.jL();f||(f=ja.WRc());l?l!==ja&&(x=!0):l=ja}if(!f)return c;U=f.getContainingTable();if(!U)return c;if(x){b=new Ka.a;if(this.xCg){l=this.yFb.F6b(this.pa.Na).Xsb;if(l.bSa())return c;for(x=l.re;x<l.$f;x++)b.add(x);xa.a.J(5125E5,822,50,"Insert {0} rows",b.count)}else if(b=this.T5i(H),1!==b.count)return c;
l=U.phj(b.ga(0));for(x=0;x<b.count;x++)Array.add(a,Wd.a.create(Object(oa.a)(ug.a,l))),l=l.UIa}else{if(!b)for(b=l.rowSpan;0<--b;)f=f.UIa;Array.add(a,Wd.a.create(Object(oa.a)(ug.a,f)))}c.fD=a;c.$Mb=Object(oa.a)(ug.a,f);c.gp=Object(oa.a)(ug.a,U);c.Agb=a.length;if(this.Ha.Dv||!od.TableReader.Ku(c.gp))c.response=32;return c}Fgj(a,b){const c=new au;c.response=8;if(!a)return c;var f=null,l=null,x=Ih.ContextSetEditor.instance.LA(a);let H=!1;a=[];for(let ja=0;ja<x.length;++ja)if(x[ja].al){var U=Object(oa.a)(5,
x[ja].node);if(!U||!U.Cs())return c;U=U.jL();f||(f=U.j0f());l?l!==U&&(H=!0):l=U}if(!l)return c;f=f.getContainingTable();if(!f)return c;if(H){b=new Ka.a;if(this.xCg){l=this.yFb.F6b(this.pa.Na).Xsb;if(l.bSa())return c;for(x=l.ge;x<l.Of;x++)b.add(x);xa.a.J(512499998,822,50,"Insert {0} columns",b.count)}else if(b=this.R5i(x),1!==b.count)return c;l=f.qf(0,b.ga(0));for(x=0;x<b.count;x++)Array.add(a,Wd.a.create(Object(oa.a)(ug.a,l))),l=l.m_()}else b&&(l=f.qf(0,l.pi+l.colSpan-1)),Array.add(a,Wd.a.create(Object(oa.a)(ug.a,
l)));c.fD=a;c.$Mb=Object(oa.a)(ug.a,l);c.gp=Object(oa.a)(ug.a,f);c.Agb=a.length;if(this.Ha.Dv||!f.Lp())c.response=32;return c}T5i(a){const b=new Ka.a,c=new Ma.ScriptSharpLegacyMap;let f=0;for(let H=0;H<a.length;++H)if(a[H].al){var l=Object(oa.a)(5,a[H].node);if(l&&l.Cs()){f++;var x=l.jL();l=x.rowIndex;for(x=l+x.rowSpan;l<x;l++)if(c.Hb(l)){let U;c.$(U=l,c.ga(U)+1)}else c.add(l,1)}}for(let H of c.keys)c.ga(H)===f&&b.add(H);return b}R5i(a){const b=new Ka.a,c=new Ma.ScriptSharpLegacyMap;let f=0;for(let H=
0;H<a.length;++H)if(a[H].al){var l=Object(oa.a)(5,a[H].node);if(l&&l.Cs()){f++;var x=l.jL();l=x.pi;for(x=l+x.colSpan;l<x;l++)if(c.Hb(l)){let U;c.$(U=l,c.ga(U)+1)}else c.add(l,1)}}for(let H of c.keys)c.ga(H)===f&&b.add(H);return b}Hgj(a){return Hn.a(a)}Jgj(a){const b=new au;b.response=8;if(!a)return b;if(a.Hl){var c=a.L0a;a=a.Gja;if(!c||!a)return b;c=Object(oa.a)(123,c.currentNode);a=Object(oa.a)(123,a.currentNode);if(!c||!a)return b;var f=c.pi;a=a.pi;if(f>a){var l=f;f=a;a=l}}else{c=qd.a.vsb(a);c=
Ih.ContextSetEditor.instance.LA(c);if(!c||1>c.length||!c[0].al)return b;c=Object(oa.a)(5,c[0].node);if(!c||!c.Cs())return b;c=c.jL();a=f=c.pi}l=this.yc.G6b(c);if(!l||14!==l.type||0>f||0>a)return b;const x=[];let H=l.qf(0,f);if(!H)return b;for(;f<=a;)Array.add(x,Wd.a.create(Object(oa.a)(ug.a,H))),H=H.m_(),f++;b.fD=x;b.$Mb=Object(oa.a)(ug.a,c);b.gp=Object(oa.a)(ug.a,l);b.Agb=x.length;if(this.Ha.Dv||!l.Lp())b.response=32;return b}Ngj(a){const b=new au;b.response=8;if(!a)return b;if(a.Hl){var c=a.L0a;
a=a.Gja;if(!c||!a)return b;var f=tk.c(c);a=tk.c(a);c=Object(oa.a)(Yl.TableCellNode,c.currentNode);if(f>a){var l=f;f=a;a=l}}else{a=qd.a.vsb(a);a=Ih.ContextSetEditor.instance.LA(a);if(!a||1>a.length||!a[0].al)return b;a=Object(oa.a)(5,a[0].node);if(!a||!a.Cs())return b;c=a.jL();a=f=c.rowIndex}if(!c)throw xa.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const x=[];
let H=l.qf(f,0).WRc();for(;f<=a;)Array.add(x,Wd.a.create(Object(oa.a)(ug.a,H))),H=H.UIa,f++;b.fD=x;b.$Mb=Object(oa.a)(ug.a,c);b.gp=Object(oa.a)(ug.a,l);b.Agb=x.length;if(this.Ha.Dv||!od.TableReader.Ku(b.gp))b.response=32;return b}zpj(a,b){if(a=Object(oa.a)(Yl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.m_();else a=a.s9a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().qf(b.rowIndex,a.pi),a=a.Xy(),tb.GraphIterator.nb(Object(oa.a)(ug.a,a)))}}F9d(a,b,c){const f=new au;
f.response=8;if(!a||!c||!c.Na)return f;const l=[],x=[];c=c.Na;if(c.Hl){if(c=this.yFb.F6b(c))if(a=c.Xsb,c=c.tableNode.firstRow,b)for(b=0;b<=a.lne;b++){var H=c.rowIndex;H>=a.DWf&&H<=a.lne&&l.push(c);c=c.UIa}else for(b=c.vWf,c=0;c<=a.dne;c++)H=b.pi,H>=a.wWf&&H<=a.dne&&x.push(b),b=b.m_()}else for(a=Ih.ContextSetEditor.instance.LA(a),c=0;c<a.length;++c)if(a[c].al){H=Object(oa.a)(5,a[c].node);if(!H||!H.Cs())return f;var U=H.jL();if(b)for(H=U.rowSpan,U=U.WRc();0<H--;)Array.contains(l,U)||l.push(U),U=U.UIa;
else for(H=U.colSpan,U=U.j0f();0<H--;)Array.contains(x,U)||x.push(U),U=U.m_()}if(!l.length&&!x.length)return f;b=[];for(a=0;a<l.length;a++)Array.add(b,Wd.a.create(Object(oa.a)(ug.a,l[a])));for(a=0;a<x.length;a++)Array.add(b,Wd.a.create(Object(oa.a)(ug.a,x[a])));f.fD=b;f.$Mb=0<l.length?Object(oa.a)(ug.a,l[0]):Object(oa.a)(ug.a,x[0]);f.gp=0<l.length?Object(oa.a)(ug.a,l[0].getContainingTable()):Object(oa.a)(ug.a,x[0].getContainingTable());if(this.Ha.Dv||!Object(oa.a)(173,f.gp).Lp())f.response=32;return f}WIj(a){if(!a.fD)return!1;
for(let c=0;c<a.fD.length;c++){var b=Object(oa.a)(Wd.a,a.fD[c]);if(b&&(b=Object(oa.a)(153,b.node))){b=this.yc.h$a(b);for(const f of b)if(f&&f.bzb)return!0}}return!1}VIj(a){if(!a.fD)return!1;var b=Object(oa.a)(173,a.gp);if(!b)return!1;var c=Object(oa.a)(Wd.a,a.fD[0]);if(!c)return!1;c=Object(oa.a)(123,c.node);if(!c)return!1;c=Object(oa.a)(tb.GraphIterator,this.Qb.Nc(c));c.rc(14);b=this.yc.sk(b);a=a.fD.length;const f=new tb.GraphIterator;f.Rc(c);for(let l=0;l<b;l++){for(let x=0;x<a;x++){const H=Object(oa.a)(123,
c.currentNode);if(H&&H.bzb)return!0;c.Cf(1)}Vd.moveToNextRow(f);c.Rc(f)}return!1}Axb(a){let b=null;a&&14===a.type&&(b=this.yc.K$d(a.firstRow));return b}x0e(a,b,c,f,l){var x=uu.cFa(a);a=uu.cFa(a,!0);if(x||a)x=this.cGa.Qm(c.$b-c.hc),c=this.cGa.Qm(c.Yb-c.kc),f._x+=this.cGa.Qm(l.right),f._y+=this.cGa.Qm(l.bottom),b.setPosition(f.x-x,f.y-c,!0)}cij(){var a=null;const b=this.ua.Ba;var c=this.pa.xv();if(Ud.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.pa.Zm())a=c.qf(0,0),a=pe.Box4ColorHelper.UDa(a.cellShading.solidFillField,
b.ke);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?pe.Box4ColorHelper.UDa(c.cellShading.solidFillField,b.ke):this.qA.BRc(Object(oa.a)(ug.a,c)))}return a}static HTi(a,b,c,f,l,x){const H=Tc.a.yk("HandleSelectTableBorderType");H.Va("CommandId",a.toString());H.Va("BorderType",b);H.Va("BorderWidth",c);H.Va("BorderColor",f);H.Va("CommandLocation",l);try{return x()}finally{H.finish(!0)}}static cFa(a,b=!1){return a.equals(te.a.Qu)?!0:b?a.equals(te.a.north)||a.equals(te.a.DE):a.equals(te.a.west)||
a.equals(te.a.PH)}}Object(m.a)(uu,"TableActor",null,[352]);class Qv{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(m.a)(Qv,"TableCellMargin",null,[]);class Rv{constructor(a,b,c,f,l,x,H,U){this.xIa=null;this.F7c=0;this.bLl=ye.a.Shd(2);this.IMf=Object.assign(new Qv,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.HMf=Object.assign(new Qv,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.GMf=Object.assign(new Qv,{marginTop:.05,
marginBottom:.05,marginLeft:.05,marginRight:.05});this.SMf=Object.assign(new Qv,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.wFh=Object.assign(new Qv,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(x){if(!H)throw xa.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!U)throw xa.a.J(512499989,
822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw xa.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw xa.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");
else throw xa.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw xa.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw xa.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw xa.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ha=b;this.Jb=c;this.ua=f;this.pa=l;this.yc=x;this.S6j=H.LXd(50,Object(F.a)(this,this.n6a,"applyPendingChangesToServerIfRequired"));this.Fb=U}wb(){this.ia.ra(K.a.D0e,Cb.a.view,Object(F.a)(this,
this.w7b,"handleTableCellMargins"),4);this.ia.ra(K.a.xsc,Cb.a.tableCell,Object(F.a)(this,this.w7b,"handleTableCellMargins"),4);this.ia.ra(K.a.Ujd,rc.a.application,Object(F.a)(this,this.BVc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(K.a.wsc,Cb.a.tableCell,Object(F.a)(this,this.w7b,"handleTableCellMargins"),4);this.ia.ra(K.a.Tjd,rc.a.application,Object(F.a)(this,this.BVc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(K.a.vsc,Cb.a.tableCell,Object(F.a)(this,this.w7b,"handleTableCellMargins"),
4);this.ia.ra(K.a.Sjd,rc.a.application,Object(F.a)(this,this.BVc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(K.a.Asc,Cb.a.tableCell,Object(F.a)(this,this.w7b,"handleTableCellMargins"),4);this.ia.ra(K.a.Vjd,rc.a.application,Object(F.a)(this,this.BVc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(K.a.xsc,Cb.a.view,Ec.Wja);this.ia.ya(K.a.wsc,Cb.a.view,Ec.Wja);this.ia.ya(K.a.vsc,Cb.a.view,Ec.Wja);this.ia.ya(K.a.Asc,Cb.a.view,Ec.Wja);this.ia.ra(K.a.usc,Cb.a.view,Object(F.a)(this,this.IVc,
"handleTableCellCustomMargins"),4);this.ia.ra(K.a.Bnc,Cb.a.view,Object(F.a)(this,this.AVc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(K.a.ysc,Cb.a.view,Object(F.a)(this,this.IVc,"handleTableCellCustomMargins"),4);this.ia.ra(K.a.Cnc,Cb.a.view,Object(F.a)(this,this.AVc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(K.a.zsc,Cb.a.view,Object(F.a)(this,this.IVc,"handleTableCellCustomMargins"),4);this.ia.ra(K.a.Dnc,Cb.a.view,Object(F.a)(this,this.AVc,"handleQueryTableCellCustomMargins"),96);
this.ia.ra(K.a.tsc,Cb.a.view,Object(F.a)(this,this.IVc,"handleTableCellCustomMargins"),4);this.ia.ra(K.a.Anc,Cb.a.view,Object(F.a)(this,this.AVc,"handleQueryTableCellCustomMargins"),96)}Ee(){}w7b(a,b,c,f,l){return this.Fth(a)?1===c?32:Kg.a("HandleTableCellMargins:Entry point:"+this.ia.xq,a,()=>{if(!l)return xa.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return xa.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),
16;const x=b.node,H=this.AUi(a);if(!H)return xa.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const U=this.Jb.me(15);U.nc(x);U.jd=a;this.nxf(x,H);U.dispose();xa.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.xq,a);return 32}):(xa.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}BVc(a,b,c,f,l){if(!this.Ha.TNb)return 8;b=Object(oa.a)(Uh.a,l);if(!b)return 16;f=this.pa.Zm();if(!f)return xa.a.J(512499983,
822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.pa.xv();if(!c)return 16;c.length||(c=this.yc.HF(f));if(!c||!c.length)return xa.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case K.a.Ujd:f=this.SRc(c,this.IMf);break;case K.a.Tjd:f=this.SRc(c,this.HMf);break;case K.a.Sjd:f=this.SRc(c,this.GMf);break;case K.a.Vjd:f=this.SRc(c,this.SMf)}b.Mf(f);return 32}SRc(a,b){for(const c of a)if(c&&!c.isGhostCell&&
(ye.a.Ov(c.marginTop)!==b.marginTop||ye.a.Ov(c.marginBottom)!==b.marginBottom||ye.a.Ov(c.marginLeft)!==b.marginLeft||ye.a.Ov(c.marginRight)!==b.marginRight))return!1;return!0}AUi(a){let b=gl.b(this.wFh);switch(a){case K.a.xsc:b=this.IMf;break;case K.a.wsc:b=this.HMf;break;case K.a.vsc:b=this.GMf;break;case K.a.Asc:b=this.SMf}return b}nxf(a,b){0<=b.marginLeft&&(a.marginLeft=ye.a.OW(b.marginLeft));0<=b.marginRight&&(a.marginRight=ye.a.OW(b.marginRight));0<=b.marginTop&&(a.marginTop=ye.a.OW(b.marginTop));
0<=b.marginBottom&&(a.marginBottom=ye.a.OW(b.marginBottom))}sci(a,b){b=Math.max(ye.a.OW(this.bLl+b.marginLeft+b.marginRight),a);bf.a.$y(b,a)||(a={},a.Number=ye.a.Ov(b),this.ia.La(K.a.cLa,2,a))}Fth(a){if(!this.ua.Ba)return!1;const b=this.pa.Jp();return!!b&&b.ud&&(this.Ha.TNb&&Array.contains(Rv.s4k,a)||this.Ha.$kb&&Array.contains(Rv.D4k,a))}AVc(a,b,c,f,l){if(!this.Ha.$kb)return 8;b=this.pa.Zm();if(!b)return xa.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),
16;c=this.pa.xv();if(!c)return xa.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.yc.HF(b));if(!c||!c.length)return xa.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.oij(c,a);this.eqc(l,ye.a.Ov(b));xa.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.xq,a);return 32}oij(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case K.a.Bnc:c=
l.marginLeft;break;case K.a.Cnc:c=l.marginRight;break;case K.a.Dnc:c=l.marginTop;break;case K.a.Anc:c=l.marginBottom}if(0<=f&&f!==c)return-1;f=c}return c}eqc(a,b){a=a.queryResult;null!==a&&(a.Kaa=parseFloat(b.toFixed(2)).toString())}IVc(a,b,c,f,l){return this.Fth(a)?1===c?32:Kg.a("HandleTableCellCustomMargins:Entry point:"+this.ia.xq,a,()=>{if(!l)return xa.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const x=this.pa.Zm();if(!x)return xa.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),
16;let H=this.pa.xv();if(!H)return xa.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;H.length||(H=this.yc.HF(x));this.isk(a,H,l);xa.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.xq,a);return 32}):(xa.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}isk(a,b,c){this.F7c!==a&&(this.n6a(),this.F7c=a);this.xIa||(this.xIa=[]);Kg.a("OnCustomMarginChange:Entry point:"+
this.ia.xq,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const x=Object(oa.a)(bt,f.sc(this.Fb.Ma));if(x){this.xIa[l]||(this.xIa[l]=new $w.a(f,this.vlj(f)));f=this.xIa[l];switch(a){case K.a.usc:f.second.marginLeft=c.Number;break;case K.a.ysc:f.second.marginRight=c.Number;break;case K.a.zsc:f.second.marginTop=c.Number;break;case K.a.tsc:f.second.marginBottom=c.Number}x.W9k(f.second,a)}}return 32});this.S6j.perform()}n6a(){this.Ha.$kb&&this.xIa&&this.xIa.length&&(Kg.a("ApplyPendingChangesToServerIfRequired:Entry point:"+
this.ia.xq,this.F7c,()=>{const a=this.Jb.me(15);try{a.jd=this.F7c;let b=null;for(const c of this.xIa)b||(b=c.first.getContainingTable(),a.nc(b)),this.nxf(c.first,c.second),this.sci(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.xIa=null)}vlj(a){const b=gl.b(this.wFh);b.marginLeft=ye.a.Ov(a.marginLeft);b.marginRight=ye.a.Ov(a.marginRight);b.marginTop=ye.a.Ov(a.marginTop);b.marginBottom=ye.a.Ov(a.marginBottom);return b}}Rv.s4k=[K.a.D0e,K.a.xsc,K.a.wsc,K.a.vsc,K.a.Asc];Rv.D4k=
[K.a.usc,K.a.ysc,K.a.zsc,K.a.tsc];Object(m.a)(Rv,"TableCellMarginActor",null,[352]);class Dq{constructor(a,b,c,f,l,x,H,U){this.Bm=this.Hhc=null;this.KUg=0;this.K5c=!1;this.iye=this.aCe=this.jVg=this.Qsg=this.iVg=this.Psg=null;this.qA=a;this.Tk=b;this.zve=c;this.I0=f;this.iCe=l;this.lhk=x;this.ghk=H;this.fXa=U}xtl(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');this.kee(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',
this.Tk.bsb(this.Tk.Y6d(this.Hhc),this.Bm)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.aCe.M5d(a,b,1,1),l=this.R1f(this.iye,this.Bm,a,b),x=this.Tk.bsb(f.Sa(kb.a.cellShading)?f.Lh(kb.a.cellShading):yl.a.tub,this.Bm),H=new Sys.StringBuilder;for(let U=0;U<Dq.Tbc.length;U++){const ja=Rp.eTa(Dq.c3c[U]),ya=f.sa(ja.F6a,yl.a.zMc),Va=f.sa(ja.lsb,yl.a.qub);H.append(Dq.Tbc[U]);if(ya.sD===Ib.a.auto){const hb=this.Tk.H5d(.0277777777777778);H.append(String.format("inset {0}px transparent",
hb))}else H.append(this.Tk.T4d(Va,.0277777777777778,ya));H.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,x,H));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.K5c&&this.qlh()}return c.toString()}B4i(a,b){const c=[];this.kee(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.aCe.M5d(a,b,1,1),x=this.R1f(this.iye,this.Bm,a,b);f.color=x;const H=this.Tk.bsb(l.Sa(kb.a.cellShading)?l.Lh(kb.a.cellShading):
yl.a.tub,this.Bm);f["background-color"]=H;f.overflow="visible";for(let U=0;U<Dq.Tbc.length;U++){let ja=null,ya=null,Va=null;({gQa:ja,F6a:ya,lsb:Va}=Rp.eTa(Dq.c3c[U]));let hb;if(this.fXa){const Lc=pe.Box4ColorHelper.oV({Color:"##T,0,0,0"}),Gc=di.a.ui(l,ya,Lc),ae=pe.Box4ColorHelper.Soa(Gc),we=pe.Box4ColorHelper.TJ(ae,this.Bm);hb=we?pe.Box4ColorHelper.epa(we):null}else hb=l.sa(ya,yl.a.zMc);const yb=l.sa(Va,yl.a.qub),Zb=Dq.Tbc[U].substring(0,Dq.Tbc[U].length-1),fc=l.sa(ja,yl.a.rub),Kc=this.fXa&&Ud.a("TableBordersLocalRenderingFix");
if(Kc&&!fc||!Kc&&hb.sD===Ib.a.auto){const Lc=this.Tk.H5d(.0277777777777778);f[Zb]=String.format("inset {0}px transparent",Lc)}else f[Zb]=this.Tk.T4d(yb,.0277777777777778,hb)}c.push(f)}}finally{this.K5c&&this.qlh()}return c}zUc(a,b){this.kee(a,b);a={};a.background=this.Tk.bsb(this.Tk.Y6d(this.Hhc),this.Bm);return a}kee(a,b){this.Hhc=this.I0.A6b(a).$X;this.KUg=this.qA.m8d(b);this.Bm=this.zve.J6f(b).ke;this.K5c=this.Ayj(this.Hhc);this.Psg=this.Bm.PresetSchemeColorMapping.Background1;this.iVg=this.Bm.PresetSchemeColorMapping.Text1;
this.Qsg=this.Bm.PresetSchemeColorMapping.Background2;this.jVg=this.Bm.PresetSchemeColorMapping.Text2;this.K5c&&(this.Bm.PresetSchemeColorMapping.Background1=this.Bm.PresetSchemeColorMapping.Light1,this.Bm.PresetSchemeColorMapping.Text1=this.Bm.PresetSchemeColorMapping.Dark1,this.Bm.PresetSchemeColorMapping.Background2=this.Bm.PresetSchemeColorMapping.Light2,this.Bm.PresetSchemeColorMapping.Text2=this.Bm.PresetSchemeColorMapping.Dark2);a=this.iCe(()=>5,()=>5,()=>this.KUg,()=>null,()=>this.Bm,()=>
this.Hhc);this.aCe=this.lhk(a);this.iye=this.ghk(a)}qlh(){this.Bm.PresetSchemeColorMapping.Background1=this.Psg;this.Bm.PresetSchemeColorMapping.Text1=this.iVg;this.Bm.PresetSchemeColorMapping.Background2=this.Qsg;this.Bm.PresetSchemeColorMapping.Text2=this.jVg}Ayj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}R1f(a,b,c,f){let l="black";a&&(l=a.K0f(b,c,f,1,1).jV());
return l}}Dq.Tbc=["border-top:","border-left:","border-bottom:","border-right:"];Dq.c3c=[7,5,0,6];Object(m.a)(Dq,"TableStylePreviewGenerator",null,[1163]);class QE extends by{constructor(){super()}get Type(){return 6}}Object(m.a)(QE,"TableStyleGalleryButtonProps",by,[]);class RE{}RE.Aok=2147483647;Object(m.a)(RE,"TableStyleUtil",null,[]);class $o{constructor(a,b,c,f,l){this.kVd="Clear";this.C8a=null;this.vqb=a;this.zcf=c;this.Acf=f;this.dSh=l;this.QLd=b;this.PN=u.AFrameworkApplication.PN;this.rm=
u.AFrameworkApplication.rm}v3b(){}I5h(a,b){this.v3b();const c=this.hRc(),f=c.length;if(!(0>=f)){var l=RE.Aok,x=null;for(let ya=0;ya<f;ya++){var H=c[ya],U=this.dSh(H);l!==U&&(l=Object.assign(new hk.a,{Id:"msMoreTableStyles"+U,Title:this.Hlj(U),ControlList:[]}),x=Object.assign(new sq.a,{Type:6,Id:"galleryMoreTableStyles"+U,ExternalGalleryId:"TableStylesGallery",Width:$o.czh,ElementDimensions:"Size64by48",GalleryItems:[]}),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np&&this.C8a&&(x.ExternalId=
this.C8a[U.toString()]),Array.add(l.ControlList,x),Array.add(b.MenuSectionList,l),l=U);var ja=this.Acf(H);H=$o.J0e+ya;U=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np;ja=Object.assign(new QE,{Id:H,ExternalId:H,Command:"4171428777",QueryCommand:"2135594455",LabelText:ja?ha.a.ue(ja):"",Alt:U?ja:null,VerticalCenterAlign:"true"});U&&(ja.TableCellStyles=this.A7f(H,a),ja.TableStyles=this.zUc(H,a));x&&x.GalleryItems.push(ja)}}}G5h(a){const b=Object.assign(new hk.a,{Id:"msMoreTableStyleCommands",
DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new fg.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:ha.a.ue(this.kVd),Alt:ha.a.ue(this.kVd),Image16by16:this.rm,Image16by16Class:Ro.getImageClassWithCluster(this.PN,$o.Eti),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}EDi(a,b){this.v3b();const c=a[Sh.a.SourceControlId],f=this.hsd(c,b);if(f){var l=this.vqb.u$d(b);l=l?this.zcf(l):
null;var x=this.Acf(f),H=this.zcf(f);a[hm.a.Alt]=x;a[hm.a.On]=H===l;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np?(b=Object.assign(new QE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.A7f(c,b),TableStyles:this.zUc(c,b),Alt:x}),a[hm.a.GalleryButtonProps]=b):(b=this.QLd.xtl(f,b),a[hm.a.InnerHTML]=b)}else a[hm.a.InnerHTML]=null,a[hm.a.Alt]=null,a[hm.a.On]=!1,a[hm.a.GalleryButtonProps]=null}A7f(a,b){this.v3b();return(a=this.hsd(a,b))?this.QLd.B4i(a,
b):null}zUc(a,b){this.v3b();return(a=this.hsd(a,b))?this.QLd.zUc(a,b):null}IEi(a,b){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Np?a.MenuItems=this.S3f(b):a.PopulationXML=nj.l(this.S3f(b))}S3f(a){const b=Object.assign(new tm.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.I5h(a,b);this.G5h(b);return b}hsd(a,b){return a?a.startsWith($o.J0e)?this.Tkj(parseInt(a.substr($o.J0e.length))):this.k2k(parseInt(a.substr($o.vtl.length)),b):null}}$o.J0e="buttonTableStyleMenu";$o.vtl="buttonTableStyleRibbon";
$o.czh=7;$o.Eti="ClearTableStyle_16x16x32";Object(m.a)($o,"ATableStyleRibbonControl",null,[1164]);class UN extends $o{constructor(a,b,c,f,l){super(a,l,Object(F.a)(f,f.Rkj,"getStyleIdFromStyleContainer"),Object(F.a)(f,f.Skj,"getStyleNameFromStyleContainer"),Object(F.a)(f,f.Kkj,"getStyleCatogeryFromStyleContainer"));this.qA=a;this.I0=f;this.kVd=ResourceStrings.L_ClearTableStyle;this.PN=Mf.a.ylc;this.rm=c.qk(Mf.a.yhd);this.EFk()}Hlj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;
case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}k2k(a,b){let c=null;(b=this.qA.H6b(b))&&(c=this.I0.D7f(b.styleIdField));return c?this.I0.Hkj(c.Etg,c.yAg-c.yAg%$o.czh+a):this.I0.yxb(a)}hRc(){return this.I0.hRc()}Tkj(a){return this.I0.yxb(a)}v3b(){this.I0.p1d()}EFk(){this.C8a={};this.C8a["1"]="TableStylesBestMatch";this.C8a["2"]="TableStylesLight";this.C8a["3"]="TableStylesMedium";this.C8a["4"]=
"TableStylesDark"}}Object(m.a)(UN,"TableStyleRibbonControls",$o,[]);class VN{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc){this.lE=this.kYa=null;this.ia=a;this.hf=b;this.Ha=c;this.Ea=f;this.pa=l;this.Mv=x;this.Yc=H;this.Kbc=U;this.Fb=ja;this.Fa=ya;this.he=Va;this.Wea=yb;this.yc=Zb;this.ffa=fc;this.uYa=Lc;this.kA=hb;Kc.execute(ae=>{this.kYa=ae});this.Ha.YP&&Gc.execute(ae=>{this.lE=ae})}get Jd(){return this.Yc.instance}get xF(){return this.Kbc.value}wb(){this.ia.ra(K.a.mzf,rc.a.application,
Object(F.a)(this,this.Hqj,"handleBeginEditShapeTextByF2"),4);this.ia.ra(K.a.fsb,rc.a.application,Object(F.a)(this,this.Gqj,"handleBeginEditShapeText"),4);this.ia.ra(K.a.dQa,Cb.a.view,Object(F.a)(this,this.Iqj,"handleBeginEditShapeTextForShapeMoniker"),5)}Ee(){const a=this.Ea.Fc(zb.a.sg),b=this.Ea.Fc(Qi.a.T2);a.bindAction(y.KeyInputManager.Oa(A.a.ovc,0),K.a.mzf);a.bindAction(y.KeyInputManager.Oa(A.a.tq,0),K.a.fsb);b.bindAction(y.KeyInputManager.Oa(A.a.ovc,0),K.a.Hhi)}Gqj(a,b,c){if(this.ffa&&this.ffa.isVisible())return xa.a.J(40735957,
820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.ffa.hide(2,!0),32;if(1===c&&this.pa.tUa())return 2;a=this.pa.Jp();if(!a)return 16;b=Object(oa.a)(4,a.U9i(Ud.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Fa.yr(a);else{if(a.Rf&&b)return this.ia.La(K.a.D0a,c,b);if(a.Jf){var f=this.Fa.ex(a);if(0<f.length)return this.ia.La(K.a.D0a,c,f[0])}else if(this.Ha.YP&&1===a.mediaType&&!a.Ng&&this.lE)return(f=this.lE.hL(a))&&f.setFocusOnPlayer(),
32}return this.ia.La(K.a.dQa,c,new uo.a(a,!1))}Hqj(a,b,c){a=this.pa.Jp();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Fa.yr(a));return this.ia.La(K.a.dQa,c,new uo.a(a,!1))}Iqj(a,b,c,f,l){if(!l||!Object(Xa.a)(uo.a,l))return xa.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.pfa||a.Dq)||this.hf.$c(a))return 16;if(1===c)return 32;a.ud&&(c=this.yc.JN(a),c=!!c&&c.Lp(),xa.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(K.a.o7a,
2));if(a.Dq){if(this.xF&&this.Jd)return l=this.xF.b3(a),this.Jd.notifyAgave(l.id,11),32;xa.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.mg(this.Fb.Ma);if(!c)return 16;this.kYa&&this.kYa.R2d(a,!0);this.uYa&&this.Ha.x8k&&this.uYa.ping();Tc.a.Ib&&(Tc.a.Ib.actionName="BeginEditShapeText",(a.Jf||a.Ng)&&un(a));if(this.kA&&a.Rf&&c.sL())Tc.a.zk(ni.a.GFc,"false"),this.he.Feh(new Ix.a(a));else{this.Ea.tf(zb.a.sg,l.rhl);this.Mv.qw();c.eZe();if(a.ud&&l.RJc&&(c=this.yc.JN(a))&&
c.Lp())return(a=this.Wea.x3d(l.RJc.clientPoint,c,null,null))?(c=a.sc(this.Fb.Ma),this.Fb.E6(l.RJc.clientPoint,c,a,this.Fb,!1,!1,0),32):8;a.Ng&&(c=this.Fa.ys(a))&&(c=c.mg(this.Fb.Ma))&&c.Pd&&c.Pd.NLb(!0);this.Fb.d7k(a,l.RJc)}return 32}}Object(m.a)(VN,"TextEditorLaunchingActor",null,[352]);class SE{constructor(a,b,c,f,l,x,H,U){this.ia=a;this.Ea=b;this.Fa=c;this.Ms=f;this.hf=l;this.pa=x;this.OWa=H;this.Hh=U}wb(){this.ia.ya(K.a.TDf,rc.a.application,Object(F.a)(this,this.Vqj,"handleChangeCaseMenu"));this.ia.ya(K.a.pLe,
rc.a.application,Object(F.a)(this,this.Auj,"handlePowerPointInsertHyperlink"));this.ia.ra(K.a.clearFormatting,rc.a.application,Object(F.a)(this,this.frj,"handleClearFormatting"),4)}Ee(){this.Ea.Fc(zb.a.lQ).bindAction(y.KeyInputManager.Oa(A.a.pP,2),K.a.clearFormatting)}Vqj(){var a=this.pa.Na.mb;return a&&(a=a.Ua)&&(a.contextId===Cb.a.Pf||a.contextId===Cb.a.textRange)?32:this.$Ih(!0)?32:8}Auj(a,b,c,f,l){return(a=this.pa.Na.mb)&&this.pa.uNj()?8:!a||this.pa.dVa()&&!SE.S$b(a)?8:this.ia.La(K.a.insertHyperlink,
c,l)}frj(a,b,c){if(!this.$Ih(!1))return 16;a=this.pa.Na.mb;if(!a)return 8;2===c&&this.qCa(a);return 32}qCa(a){xa.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.pa.Wd();let c;if((c=this.ojj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){xa.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");return}if(b.contextId===Cb.a.Pf){this.hei(b,c[0]);return}if(b.contextId===Cb.a.textRange||b.contextId===Cb.a.paragraph){this.jei(a,
c);return}}this.iei(c)}else b.length?this.NKc(b)?xa.a.J(593892317,820,50,"ClearFormatting on table(s)"):xa.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):xa.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}ojj(a){a=this.Fa.p_(a,!1);const b=[];let c=!0;for(const f of a)f.Jf&&(c=!1,1!==a.length&&this.egl(f,a)?b.push.apply(b,this.uhh(f,a,!1)):b.push.apply(b,this.uhh(f,a,!0)));return c?a:b}egl(a,b){for(const c of b)if(c&&!c.Jf&&(b=
c.ys(),!b||a!==b))return!1;return!0}uhh(a,b,c=!1){const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const x=this.Fa.p_(this.pa.aP(b),!1);f.push.apply(f,x)}return f}iei(a){this.Ms.x8a(b=>{this.$Ue(b,0,this.gjj(b))},a)}jei(a,b){const c=a.Ua,f=this.N2f(c,b[0]);if(c.contextId===Cb.a.paragraph||-1!==f){var l=this.jmj(a);this.Ms.x8a(x=>{this.$Ue(x,f,l)},b)}}hei(a,b){const c=this.OWa.j6b(a);if(c){var f=c.Ua,l=this.N2f(a,b)+f.Qa;this.Ms.x8a(x=>{this.$Ue(x,l,f.Mb-f.Qa)},[b])}}$Ue(a,b,c){a.we(kb.a.clearFormatting,
!0);a.we(kb.a.C1e,b);a.we(kb.a.B1e,c)}N2f(a,b){let c=0,f=!1;if(!this.Hh.$d(a.node))return-1;const l=a.node;this.Fa.LJ(b,x=>{x===l?f=!0:f||(c+=this.Hh.textLength(x)+1)});return f?a.contextId===Cb.a.paragraph||a.contextId===Cb.a.Pf?c:c+a.Qa:-1}jmj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===Cb.a.textRange?b+=f.Mb-f.Qa:f.contextId===Cb.a.paragraph?b+=this.Hh.textLength(f.node)+1:f.contextId===Cb.a.endOfParagraph&&b++}return b}gjj(a){let b=0;if(a.DC)return 1;this.Fa.LJ(a,c=>{b+=
this.Hh.textLength(c)+1});return b}NKc(a){for(const b of a)if(b.ud)return!0;return!1}$Ih(a){const b=this.pa.Wd();if(!b||1>b.length)return!1;const c=this.pa.Zm();if(c&&!a&&1===b.length)return!1;a=this.Fa.p_(b);return 1>a.length&&!c||this.hf.AC(a)||this.hf.AC([c])?!1:!0}static S$b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!nb.SelectionEditor.gk(b)||!nb.SelectionEditor.Xl(a)||b.node!==a.node)}return!1}}Object(m.a)(SE,"TextOperationsActor",null,[352]);class TE{ZZd(a,
b,c){return 1===c?32:TE.IKi(b.node)}static IKi(a){const b=new tb.GraphIterator;b.set(a);b.ev();if(Hf.b(b))return 2;a=new pf.GraphTransaction(7);a.Fy(b);b.Mi();a.dispose();return 32}}Object(m.a)(TE,"DeleteOutlineLevelContentStrategy",null,[]);class pl{constructor(){this.WPh=new TE}wb(a){const b=Object(F.a)(this.KMc,this.KMc.$Zd,"deleteView"),c=Object(F.a)(this,this.ZZd,"deleteOutlineLevelContent"),f=Object(F.a)(this.nNf,this.nNf.JKi,"deleteParagraphContent");a.ya(D.a.backspace,Cb.a.Pf,f);a.ya(D.a.backspace,
Cb.a.textRange,f);a.ya(D.a.backspace,Cb.a.endOfParagraph,ld.ActionManager.uv);a.ya(D.a.backspace,Cb.a.outline,c);a.ya(D.a.backspace,Cb.a.view,b);a.je(D.a.backspace,1124);a.ya(D.a.aDa,Cb.a.Pf,ld.ActionManager.uv);a.ya(D.a.aDa,Cb.a.textRange,f);a.ya(D.a.aDa,Cb.a.endOfParagraph,ld.ActionManager.uv);a.ya(D.a.aDa,Cb.a.outline,c);a.ya(D.a.aDa,Cb.a.view,b);a.ra(D.a.fub,Cb.a.view,b,1124);a.ya(D.a.$K,Cb.a.Pf,f);a.ya(D.a.$K,Cb.a.textRange,f);a.ya(D.a.$K,Cb.a.endOfParagraph,ld.ActionManager.uv);a.ya(D.a.$K,
Cb.a.outline,c);a.ya(D.a.$K,Cb.a.view,b);a.je(D.a.$K,1124);a.ra(D.a.N1b,Cb.a.view,b,1124);a.ra(D.a.$Ca,Cb.a.view,pl.$Ca,1028);a.ya(D.a.pRa,Cb.a.view,Object(F.a)(this.KMc,this.KMc.pRa,"deleteFromInputEvent"));a.ya(D.a.pRa,Cb.a.textRange,f);a.je(D.a.pRa,1028)}ZZd(a,b,c,f,l){return this.WPh.ZZd(a,b,c,f,l)}static get Zl(){return Ey.PageNavigator.instance}static get Ph(){return pl.Di||(pl.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get JJ(){return pl.kI||(pl.kI=Db.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get HKi(){return pl.M2a||
(pl.M2a=Db.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get EB(){return pl.Tx||(pl.Tx=Db.a.instance.resolve("Box4.IOutlineEditor"))}static get ze(){return pl.hd||(pl.hd=Db.a.instance.ub("Box4.IFeatureHelper"))}static $Ca(a,b,c,f,l){f=b.view;if(!f.Lb||!f.Lb.Na.mb||nb.SelectionEditor.lx(f.Lb.Na.mb))return 8;if(1===c)return 32;c=f.Lb.Na;const x=c.mb;var H=x.Ua;let U=!1;var ja=null,ya=!1;if(c.jH)if(Hf.a(H))U=!0;else{if(H.contextId===Cb.a.outline&&1===c.length){for(a=tb.GraphIterator.nb(H.node);a.Gi();)a.Mi();
pl.EB.LZ(a,!0);Ta.OutlineElementNavigator.wi(a);a=Qd.SelectionFactory.Sg(a.currentNode,0);f.Lb.setSelection(a);return 32}var Va=H.node;ja=null;if(cu.c(H)){var hb=Va.sc(f.Ma);hb&&(hb=hb.INl)&&0<=hb.width&&0<=hb.height&&(ja=new Vw.a(Rf.a.rf(hb.x,0),Rf.a.rf(hb.y,1)));ja||(ja=mq.b(Va))}else ja=mq.b(H.node);H=tb.GraphIterator.nb(H.node);H.ev();pl.Zl.CKa(H);Va=pl.JJ.s1b(H);mq.c(Va,ja.x,ja.y);pl.EB.LZ(H,!0);ja=Qd.SelectionFactory.tj(Va,!0)}else if(1===c.length){ya=c.last;H=qd.a.TQa(ya);if(pl.ze&&pl.ze.isFeatureEnabled(33)&&
Ih.ContextSetEditor.instance.kZe(H).returnValue)return 2;ya=ya.Ye;ya=!Hf.a(ya)&&!c.Hl&&(nb.SelectionEditor.Xl(ya)||Sb.ParagraphReader.um(ya)||nb.SelectionEditor.UW(ya))}ya&&(ya=nb.SelectionEditor.Sl(x,!1,!1,void 0,pl.HKi.FXe(null,1)),f.Lb.setSelection(ya),u.AFrameworkApplication.Ta.mi(b,D.a.zB,2,!1,null,l),ja=f.Lb.Na.mb,f.Lb.setSelection(x));l||(l=new J.DictionaryPropertySet);l.setValue(Mc.a.Lub,!0);u.AFrameworkApplication.Ta.mi(b,D.a.$K,2,!0,null,l);if(ja&&ja.Ua.isValid)return f.Lb.setSelection(ja),
32;c.jH&&(U||ho.instance.QAb(a,b.CE,f));nb.SelectionEditor.lx(f.Lb.Na.mb)||u.AFrameworkApplication.Ta.mi(b,D.a.zB,2,!1,null,l);return 32}}pl.kI=null;pl.Di=null;pl.M2a=null;pl.Tx=null;pl.hd=null;Object(m.a)(pl,"ADeleteActor",null,[]);class bl{get $i(){return fd.a.instance}JKi(a,b,c,f,l){if(1===c)return 32;f=a===D.a.backspace||a===D.a.pRa;if(bl.er()&&bl.er().instance&&bl.er().instance.XW(b))return 4;c=b.node;var x=b.Qa;b=b.Mb;const H=Sb.ParagraphReader.text(c),U=H.length;let ja=!1;if(x===b){if(f&&!x||
!f&&x===U)return 2;f?(P.a.instance.ga(14)&&({cp:x,returnValue:ja}=this.$i.Rmk(c,x)),ja||(x--,ha.a.ox(H,x)&&x--),a=D.a.gCa):(P.a.instance.ga(14)&&({cp:b,returnValue:ja}=this.$i.Qmk(c,b)),ja||(b++,ha.a.ox(H,b)&&b++),a=D.a.oRa)}x=x===b?Wd.a.Lj(c,x):Wd.a.createTextRange(c,x,b);f=new pf.GraphTransaction(15);f.jd=a;f.kd(c);c=Object(Xa.a)(Ns,l)&&l.I4b;if(bl.Tf.gg&&bl.Tf.Uy&&!c){c=bl.Tf.gsb();try{let ya;if(({type:ya}=null.t8f()).returnValue){const Va=Object(oa.a)(10,l);if(Va&&Va.sa(Ms.a.Ehg,!1)||1===ya)bl.Tf.$9g=
ya}l=0;for(let Va=null.length-1;0<=Va;--Va){let hb;const yb=({ong:hb}=null.getContext(Va)).returnValue;hb?(bl.hyperlinkEditor.KGb(yb,null),l+=0,bl.C6.mXd=b+l):this.oNf(yb)}}finally{c&&c.dispose()}}else this.oNf(x);f.dispose();return 32}static get Tf(){return bl.fd||(bl.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get C6(){return bl.ap||(bl.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Gtc(){return bl.JD||(bl.JD=
Db.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return bl.zn||(bl.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static er(){return bl.Hm||(bl.Hm=Db.a.instance.Ja("Box4.IExternalSelectionManager"))}}bl.fd=null;bl.ap=null;bl.JD=null;bl.zn=null;bl.Hm=null;Object(m.a)(bl,"ADeleteParagraphContentStrategy",null,[]);class Sv extends bl{constructor(){super()}oNf(a){Sv.characterPropertiesEditor.replaceTextRange(a,"")}static get characterPropertiesEditor(){return Sv.Gmh||
(Sv.Gmh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Sv.Gmh=null;Object(m.a)(Sv,"DeleteParagraphContentStrategy",bl,[]);var DR=d(471);class WN{constructor(a,b,c,f){this.T5e=a;this.SJ=c;this.rd=f;this.actionId=b}}Object(m.a)(WN,"DeleteActionData",null,[]);class qf{get dui(){return qf.q9e||(qf.q9e=Db.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}Mwl(a){return!nb.SelectionEditor.gk(a)}zij(a,b,c){if(!a)return null;if(!c)return a;b=nb.SelectionEditor.kSa(a,!1,!b,!0,
!0,!0);return Qd.SelectionFactory.DN(a,b.Ua,!1)}$Zd(a,b,c,f,l){if(1===c)return 32;var x=!1;a===D.a.N1b&&(a=D.a.$K,x=!0);a===D.a.fub&&(a=D.a.backspace,x=!0);a===D.a.aDa&&(b=new pC.a(Oc.App.Kb.Kd.Dn));var H=b;if(!H.view.Mh)return 2;var U=H.view.Lb;ig.GrippersManager.instance.setVisibility(!1);H=a===D.a.$K;U=0<U.Na.length?U.Na.ga(0):null;x=this.zij(U,H,x);return this.wNf(a,b,c,f,l,x,H)}wNf(a,b,c,f,l,x,H){const U=b.view,ja=U.Lb;var ya=l,Va=l;a===D.a.aDa&&(Va=ya=null,x=new ib.Selection(l,!0));if(!x)return 32;
const hb=new WN(b,a,f,Va),yb=this.Xgl(ya,H,ja);ya=!1;if(({zUa:ya}=this.cuh(a,yb,ja)).returnValue)return a=ya?D.a.ZCa:D.a.deleteRow,u.AFrameworkApplication.Ta.mi(b,a,c,!1,f,l);let Zb;H?bd.a.mark(Zb=5009):bd.a.mark(Zb=5011);c=new pf.GraphTransaction(15);c.jd=a;c.kd(U.xg);ya=null;let fc=({I5k:ya}=this.l6i(a,l,ja,x)).returnValue;Va=null;({Qqd:Va}=Ih.ContextSetEditor.instance.kZe(fc)).returnValue&&(fc=Va);if(!fc)return c.dispose(),32;this.zCh(fc);const Kc=this.L2i(x,H);let Lc=null;H?Lc=new dr(x):Kc&&(Lc=
new dr(Kc));Va=!1;if(nb.SelectionEditor.Tg(fc)){if(a===D.a.pRa)return 2;const Gc=Ph.sTc(U.xg,yb);qf.RS.hG(()=>{this.AKi(b,f,l,fc,H,Lc,x,Gc,ja,yb,hb,Kc)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else qf.Tf.gg&&qf.Tf.Uy?(this.Lwl(a,U.xg,fc,H,x,ja,yb,hb,Lc),Va=!0):Va=this.k$g(a,U.xg,fc,ja,yb,hb,Lc,ya);qf.WYi(ja);this.Rkh(fc);c.dispose();bd.a.mark(Zb+1);return a===D.a.aDa?Va?32:8:32}pRa(a,b,c,f,l){return b.view.Mh?this.wNf(a,b,c,f,null,l,!1):2}k$g(a,b,c,f,l,x,H,U){b=Ph.sTc(b,l);this.Mwl(c)&&
b.fpa(c);a=qf.Wc.Vp(a);a.properties.$("CountOfParagraphsDeleted",qf.J5.kXd(c).toString());c=qf.hNi(qf.ahl,Object(F.a)(this,this.$gl,"shouldDispatchNoSpecialize"),c,f,l,b,x,H,U);a.end();return c}Lwl(a,b,c,f,l,x,H,U,ja){var ya=0,Va=null;const hb=Ih.ContextSetEditor.instance.LA(c),yb=hb[hb.length-1];if(yb.contextId===Cb.a.paragraph||yb.contextId===Cb.a.endOfParagraph){var Zb=tb.GraphIterator.nb(yb.node);Zb.$e();Ta.OutlineElementNavigator.Re(Zb);Ta.OutlineElementNavigator.FJ(Zb,!0,!1)&&(Va=Ta.OutlineElementNavigator.wi(Zb))&&
(ya=qf.J5.textLength(Va))}else ya=qf.J5.textLength(yb.node)-yb.Mb;if((Zb=Object(oa.a)(10,U.rd))&&Zb.sa(Ms.a.Ehg,!1))this.j$g(a,b,c,x,H,U,ja,!1);else{Zb=qf.Tf.gsb();try{this.j$g(a,b,c,x,H,U,ja,!0)}finally{Zb&&Zb.dispose()}}if(f){if(c.hx){a=hb.length-1;do l=hb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!qf.J5.$d(l.node))return;switch(yb.contextId){case Cb.a.paragraph:case Cb.a.endOfParagraph:ya=Va&&Va.isConnected?0:ya;break;case Cb.a.Pf:case Cb.a.textRange:break;default:ya=0}ya=Qd.SelectionFactory.Sg(l.node,
qf.J5.textLength(l.node)-ya);l.U5a===ya.Ua.Qa&&(ya.Ua.MS=l.MS)}else{ya=l.Ua.node;if(!qf.J5.$d(ya))return;Va=l.Ua.contextId===Cb.a.paragraph?0:l.Ua.contextId===Cb.a.endOfParagraph?qf.J5.textLength(ya):l.Ua.Qa;ya=Qd.SelectionFactory.Sg(ya,Va)}qd.a.instance.setSelection(ya)}j$g(a,b,c,f,l,x,H,U){this.Y0i(f,c);!({type:ja}=null.t8f()).returnValue||U&&1!==ja||(qf.Tf.$9g=ja);for(c=null.length-1;0<=c;--c){var ja=({ong:U}=null.getContext(c)).returnValue;U?qf.hyperlinkEditor.KGb(ja,2):this.k$g(a,b,ja,f,l,x,
H,null)}}Y0i(a,b){if(Object(Xa.a)(DR.a,b))for(a=ri.dta(a.Na,!0),b=0;b<a.length&&a.getContext(b).contextId!==Cb.a.table;b++);}l6i(a,b,c,f){a===D.a.aDa?(c=Wa.a.XQa(b),a=em.SelectionReferenceFactory.instance.gsa()):(a=null,c=1===c.Na.length?qd.a.TQa(f):c.Pj);return{returnValue:c,I5k:a}}$oi(a){return!a.al||a.contextId!==Cb.a.paragraph||!qf.J5.$d(a.node)||qf.Tf.gg&&qf.Tf.Uy||P.a.instance.ga(14)&&qf.$i.l_c(a)?!1:!0}zCh(a){if(a.hx)for(let b=0;b<a.length;b++)this.zCh(a.getContext(b));else this.$oi(a)&&(a.node.VIc=
!0)}Rkh(a){if(a.hx)for(let b=0;b<a.length;b++)this.Rkh(a.getContext(b));else a.al&&(a=a.node)&&qf.J5.$d(a)&&(a.VIc=!1)}AKi(a,b,c,f,l,x,H,U,ja,ya,Va,hb){const yb=new tb.GraphIterator,Zb=f.node;yb.set(Zb);yb.$e();nb.SelectionEditor.BC(yb.currentNode,f,l)?this.EKi(a,b,c,f,l,x,H,U,ja,Va,hb,yb,Zb):qf.FKi(f,l,x,H,U,ja,ya,Va)}uVc(a,b,c,f){return!a&&rb.ListReader.uk(b)?(f=qf.eoa(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}Gsj(a,b,c,f,l,x){return P.a.instance.ga(65)&&!a&&0<fe.OutlineElementReader.Iwb(b)?
(x=u.AFrameworkApplication.Ta.mi(c,D.a.rhh,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}gxj(a,b,c,f,l,x){return P.a.instance.ga(54)&&!a&&0<fe.OutlineElementReader.G9a(b)?(x=u.AFrameworkApplication.Ta.mi(c,D.a.NWk,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}Iuj(a,b,c,f,l,x){return P.a.instance.ga(80)&&!a&&qf.Av.Rsb(b)?(x=u.AFrameworkApplication.Ta.mi(c,D.a.By,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}dqj(a,b,c,f,l,x,H,U,ja,ya,Va){const hb=
new tn.a;hb.Rc(b);if(Ta.OutlineElementNavigator.SIa(hb,!1,!a,!1)){Va=!0;ya=32;const yb=new tb.GraphIterator;yb.Rc(hb);Ta.OutlineElementNavigator.wi(hb);x&&f&&nb.SelectionEditor.UW(f.Ua)?(c.fpa(l),qf.Ph.tWk(b.currentNode)):hb.currentNode.SW?(P.a.instance.ga(68)&&c.fpa(l),Ta.OutlineElementNavigator.Re(hb),hb.Mi()):P.a.instance.ga(66)&&a&&x?qf.$i.Okg(U)&&!({Jya:Va}=this.fch(a,U,hb.currentNode,f,Va)).returnValue&&(c.fpa(l),qf.eq.eoa(b),b.Mi()):od.TableReader.aq(hb)?(c.fpa(l),this.vNf&&({response:ya,returnValue:Va}=
this.vNf.xMl(a,yb,b,hb,H,ja,ya))):qf.J5.$d(hb.currentNode)&&(({Jya:Va}=this.fch(a,U,hb.currentNode,f,Va)).returnValue||this.pNf&&this.pNf.BKi(a,c,l,b,U,hb));return{returnValue:!0,response:ya,Jya:Va}}return{returnValue:!1,response:ya,Jya:Va}}fch(a,b,c,f,l){return qf.Tf.gg&&qf.Tf.Uy&&(a=(a?b:c).Ra.last,b=u.AFrameworkApplication.userName,!a.Fo||a.Fo.authorName!==b)?(f&&(qd.a.instance.setSelection(f),l=!1),{returnValue:!0,Jya:l}):{returnValue:!1,Jya:l}}Jwj(a,b,c,f,l,x,H,U){return P.a.instance.ga(67)&&
fe.OutlineElementReader.Aig(b,a)?(Le.isInTableCell(b)&&(Vd.returnToContainingCell(b),Le.isEmpty(b)&&c.fpa(f),{ail:a,returnValue:U}=qf.Amk(b,H,a,l,x),a||(U=2)),{returnValue:!0,response:U}):{returnValue:!1,response:U}}Zsj(a,b,c,f,l,x,H,U){fe.OutlineElementReader.Aig(b,a)||({response:H,Jya:U}=qf.UNi(c,f,a,x,l,H,U));return{returnValue:!1,response:H,Jya:U}}EKi(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){let Zb=!1,fc=2;const Kc=qf.J5.isEmpty(hb),Lc=hb.currentNode;Ta.OutlineElementNavigator.Re(hb);({response:fc}=this.uVc(l,
hb,ya,fc)).returnValue||({response:fc}=this.Gsj(l,hb,a,b,c,fc)).returnValue||({response:fc}=this.gxj(l,hb,a,b,c,fc)).returnValue||({response:fc}=this.Iuj(l,hb,a,b,c,fc)).returnValue||({response:fc,Jya:Zb}=this.dqj(l,hb,U,Va,f,Kc,Lc,yb,ja,fc,Zb)).returnValue||({response:fc}=this.Jwj(l,hb,U,f,ja,ya,Lc,fc)).returnValue||({response:fc,Jya:Zb}=this.Zsj(l,hb,b,c,U,H,fc,Zb));qf.Q_g(U,32===fc);Zb&&qf.MU(ja,x)}Xgl(a,b,c){return a&&a.Sa(Mc.a.Lub)?this.dui.zth()||a.eb(Mc.a.Lub)?!a.sa(Mc.a.Lub,!1):this.N0f(!1,
c):this.N0f(b,c)}cuh(){return{returnValue:!1,zUa:!1}}static get characterPropertiesEditor(){return qf.fh||(qf.fh=Db.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Sf(){return qf.Vg||(qf.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}static get J5(){return qf.sr||(qf.sr=Db.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return qf.zn||(qf.zn=Db.a.instance.resolve("Box4.IHyperlinkEditor"))}static get eq(){return qf.Zo||(qf.Zo=Db.a.instance.resolve("Box4.List.IListEditor"))}static get Ph(){return qf.ykf||
(qf.ykf=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}static get SH(){return Zl.a.instance}static get Av(){return jv.a.bxb}static get Tf(){return qf.fd||(qf.fd=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get C6(){return qf.ap||(qf.ap=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Gtc(){return qf.JD||(qf.JD=Db.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Wc(){return Nc.a.instance}static get $i(){return fd.a.instance}static get Wt(){return qf.BD||
(qf.BD=Db.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get RS(){return Nd.a.instance}static WYi(a){if(1===a.Na.length&&(a=a.Na.ga(0),nb.SelectionEditor.lx(a))){var b=a.Ua;a=b.node;b=b.Qa;var c=qf.J5.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&qf.characterPropertiesEditor.replaceTextRange(Wd.a.createTextRange(a,b-1,b),"\u00a0")}}static mhi(a,b){if(!b.hyperlink.tzb){const c=new pf.GraphTransaction(15);try{c.kd(a.node),qf.Wt.zM(a,b)}finally{c&&c.dispose()}}}static eoa(a,
b){a=qf.Sf.jw(a).f_c?D.a.mP:D.a.NM;return u.AFrameworkApplication.Ta.mi(b.T5e,a,2,!1,b.SJ,b.rd)}static UNi(a,b,c,f,l,x,H){if(c=nb.SelectionEditor.kSa(f,!1,!c,!1,!1,!0)){f=Qd.SelectionFactory.DN(f,c.Ua);x=32;for(c=0;c<f.length;++c){l.fpa(f.ga(c));const U=u.AFrameworkApplication.Ta.mi(f.ga(c),D.a.$K,2,!0,a,b);2!==U&&(x=U)}32===x&&(H=!0)}return{response:x,Jya:H}}static hNi(a,b,c,f,l,x,H,U,ja){let ya=!1;a(c)?(ya=qf.O_d(c,!0,f,l,x,H))&&qf.nMa(U,f,ja):b(c)?(ya=qf.O_d(c,!1,f,l,x,H))&&qf.nMa(U,f,ja):(x.normalize(),
qf.nMa(U,f,ja));return ya}static nMa(a,b,c){c&&c.MU()||qf.MU(b,a)}static O_d(a,b,c,f,l,x){f||gj.OutlineReader.$ka(a)||(c=qf.mAl(c))&&l.Udl(c);a=32===u.AFrameworkApplication.Ta.mi(a,x.actionId,2,b,x.SJ,x.rd);qf.Q_g(l,a);return a}static Q_g(a,b){b?a.normalize():a.cancel()}static MU(a,b){b&&(b=b.restore())&&a.setSelection(b)}static FKi(a,b,c,f,l,x,H,U){let ja;!b&&({m8b:ja}=qf.Wt.Wab(a)).returnValue?(c=new dr(f),qf.mhi(a,ja),l.normalize(),qf.MU(x,c)):qf.O_d(a,!1,x,H,l,U)&&(b&&qf.Tf.gg&&qf.Tf.Uy?(b=qf.C6.mXd)?
(x.setSelection(Qd.SelectionFactory.Sg(a.node,b)),qf.C6.mXd=null):qf.MU(x,c):qf.MU(x,c))}static Amk(a,b,c,f,l){let x,H=2;x=!0;if(Le.isEmpty(a)){const U=Vd.getContainingTable(a),ja=od.TableReader.sk(U),ya=od.TableReader.Ai(U);1===ja&&1===ya?(H=u.AFrameworkApplication.Ta.mi(Wd.a.create(U),D.a.m7a,2,!1,l.SJ,l.rd),f.setSelection(Qd.SelectionFactory.Sg(b,0)),x=!1):1===ja?H=u.AFrameworkApplication.Ta.mi(l.T5e,D.a.ZCa,2,!1,l.SJ,l.rd):(b=Le.isEmptyIncludingTheRestOfTheRow(a),Le.isFirstCellInRow(a)&&b?H=u.AFrameworkApplication.Ta.mi(l.T5e,
D.a.deleteRow,2,!1,l.SJ,l.rd):!c&&b&&(H=32,a=nb.SelectionEditor.Wsa(f.Na.mb,!1,!1,!1,!0),f.setSelection(a),x=!1))}return{returnValue:H,ail:x}}static ahl(a){return a.hx||gj.OutlineReader.$ka(a)||qf.J5.um(a)}static mAl(a){return(a=ri.dta(a.Na,!0))&&1===a.length&&(a=a.getContext(0).node,od.TableReader.qbb(a))?a:null}}qf.Vg=null;qf.fh=null;qf.ykf=null;qf.sr=null;qf.zn=null;qf.Zo=null;qf.fd=null;qf.ap=null;qf.JD=null;qf.q9e=null;qf.BD=null;Object(m.a)(qf,"ADeleteViewStrategy",null,[]);class vu{constructor(a,
b){this.Qb=a;this.Hh=b}BKi(a,b,c,f,l,x){l=this.Qb.Nc(l);a&&!this.Hh.isEmpty(l)?(Ta.OutlineElementNavigator.Re(x),b.BCh(x.currentNode),vu.Ph.merge(f,x,!1,!1)):(Ta.OutlineElementNavigator.Re(x),b.fpa(c),vu.Ph.merge(x,f,!1,!1))}static get Ph(){return vu.Di||(vu.Di=Db.a.instance.resolve("Box4.IOutlineElementEditor"))}}vu.Di=null;Object(m.a)(vu,"DeleteParagraphNodeStrategy",null,[1231]);class XN extends qf{constructor(a,b,c,f){super();this.h7j=new vu(c,f);this.la=a;this.THg=b;this.Qb=c}get vNf(){throw Error.notImplemented();
}get pNf(){return this.h7j}L2i(a,b){return nb.SelectionEditor.kSa(a,!0,!b,!1,!1,!0)}$gl(a){return nb.SelectionEditor.gk(a)}N0f(a,b){if(!this.la.hme||!this.la.sAb||!this.la.ime||a)return!1;a=this.Flj(b);return 1===(a&1)&&2!==(a&2)}Flj(a){var b=a.Na;if(!b.length)return 0;a=Object(oa.a)(5,b.ga(0).Ua.node);if(!a||!a.Cs())return 0;a=(a=(a=a.jL())?a.j8f():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var x=ri.DSc(l,!0),H=ri.DSc(l,!1);if(x&&H){if(nb.SelectionEditor.Yt(x)&&
!nb.SelectionEditor.mzb(x)||!Sb.ParagraphReader.Aje(x.node)||x!==H&&nb.SelectionEditor.Yt(H)&&!nb.SelectionEditor.mzb(H)||!Sb.ParagraphReader.iPj(H.node))return 0;if(l=Object(oa.a)(Wa.a,Ih.ContextSetEditor.instance.N4b(Wa.a.XQa(l.toArray()),16,!1)))for(x=0;x<l.length;++x)H=Object(oa.a)(Yl.TableCellNode,l.getContext(x).node),a.Lp()&&H.isControllingCell?this.RHj(H,c):H.isGhostCell||Array.add(c,H)}}}if(!c.length)return 0;b=a.DY;f=a.d8;x=l=0;H=Array(b);const U=Array(f);for(var ja=0;ja<b;++ja)H[ja]=0;
for(ja=0;ja<f;++ja)U[ja]=0;for(ja=0;ja<c.length;++ja){const ya=c[ja].j8f();++H[ya.rowIndex]===f&&++l;++U[ya.pi]===b&&++x}if(0<l&&0<x){if(l===b&&x===f)return 3}else if(l||x){if(0<l){if(!a.Lp())for(a=0;a<f;++a)if(U[a]!==l)return 0;return 1}if(0<x){if(!a.Lp())for(a=0;a<b;++a)if(H[a]!==x)return 0;return 1}}return 0}RHj(a,b){Le.foreachMergedCells(Object(oa.a)(ug.a,a),c=>{Array.add(b,c)})}uVc(a,b,c,f){if(!a&&rb.ListReader.uk(b)){var l=this.Qb.SSa();l.Rc(b);if((l=Object(oa.a)(4,l.Jg(10)))&&l.Rf){if(this.THg.Rsb(b))this.THg.Rhb(b,
-1,0),f=32;else if(b.JF(1)){if(b.Cf(1),({response:f}=super.uVc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.uVc(a,b,c,f)}return{returnValue:!1,response:f}}cuh(a,b,c){if(!(b&&a===D.a.backspace&&c.Na&&c.Na.length&&c.Na.Hl))return{returnValue:!1,zUa:!1};b=c.Zm();if(!b||!b.Lp())return{returnValue:!1,zUa:!1};a=b.DY;b=b.d8;let f=a,l=0,x=b,H=0;c=Ih.ContextSetEditor.instance.LA(c.Pj);for(let ya=0;ya<c.length;ya++){if(!c[ya].al)return a=!1,
{returnValue:!1,zUa:a};var U=Object(oa.a)(5,c[ya].node);if(!U||!U.Cs())return a=!1,{returnValue:!1,zUa:a};var ja=(U=U.jL())?U.Xy():null;if(!ja)return a=!1,{returnValue:!1,zUa:a};U=ja.rowIndex;const Va=ja.pi,hb=ja.rowSpan;ja=ja.colSpan;f=Math.min(f,U);l=Math.max(l,U+hb-1);x=Math.min(x,Va);H=Math.max(H,Va+ja-1)}return l-f+1!==a&&H-x+1!==b?{returnValue:!1,zUa:!1}:{returnValue:!0,zUa:l-f+1===a?!0:!1}}}Object(m.a)(XN,"DeleteViewStrategy",qf,[]);class YN extends pl{constructor(a,b,c,f){super();this.i7j=
new XN(a,b,c,f);this.g7j=new Sv}get KMc(){return this.i7j}get nNf(){return this.g7j}}Object(m.a)(YN,"Box4DeleteActor",pl,[]);class ZN{constructor(a,b,c,f,l){this.ia=a;this.f7j=new YN(b,c,f,l);sa.InteractiveViewManager.instance.editingView.h2b=!0}wb(){this.f7j.wb(this.ia)}Ee(){var a=D.a.backspace;const b=v.FocusManager.instance().Fc(S.AppFrame.zW);b.bindAction(y.KeyInputManager.Oa(A.a.TH,0),a);b.bindAction(y.KeyInputManager.Oa(A.a.TH,4),D.a.backspace);b.bindAction(y.KeyInputManager.Oa(A.a.TH,4|y.KeyInputManager.Oe),
G.a.ve);b.bindAction(y.KeyInputManager.Oa(A.a.TH,y.KeyInputManager.Oe),D.a.fub);b.bindAction(y.KeyInputManager.Oa(A.a.ppa,0),D.a.$K);b.bindAction(y.KeyInputManager.Oa(A.a.ppa,y.KeyInputManager.Oe),D.a.N1b);B.a.vk&&(b.bindAction(y.KeyInputManager.Oa(A.a.TH,3),D.a.backspace),b.bindAction(y.KeyInputManager.Oa(A.a.TH,7),D.a.backspace),b.bindAction(y.KeyInputManager.Oa(A.a.TH,5),D.a.backspace),b.bindAction(y.KeyInputManager.Oa(A.a.TH,1),D.a.fub))}}Object(m.a)(ZN,"DeleteActor",null,[352]);class $N{constructor(a){this.Z5j=
a}wb(){this.Z5j.wb()}Ee(){}}Object(m.a)($N,"EnterActor",null,[352]);class Up{constructor(a,b,c){this.gv=a;this.KXb=b;this.Hm=c}get Kn(){return this.KXb.value}VSi(a,b,c,f,l){var x;if(!({If:c,selected:x,tF:ja}=this.guh(b,c,!1)).returnValue)return ja;bd.a.mark(5013);var H=Up.km.LA(x);for(var U=0;U<H.length;++U){if(!H[U].isValid)continue;let ya=H[U].iterator;ya.ev();if(gj.OutlineReader.Zt(ya))return this.JSf(c,ya);if(Hf.b(ya))return ho.instance.QAb(a,x,c),this.Kn.qw(),bd.a.mark(5014),32}H=this.e9i(x);
if(x.hx||nb.SelectionEditor.gk(x)||Sb.ParagraphReader.um(x)&&!nb.SelectionEditor.UW(x)){if(Up.ze&&Up.ze.isFeatureEnabled(33)&&Ih.ContextSetEditor.instance.kZe(x).returnValue)return 8;var ja=this.KSf(b,c,a,f,l,H)}else if(nb.SelectionEditor.Xl(x))ja=this.ISf(b,c,a,f,l,H);else if(nb.SelectionEditor.Tg(x)){ja=new tb.GraphIterator;ja.set(x.node);ja.rc(10);if(this.Ank()&&(U=oc.HyperlinkReader.tC(x,!1),0<U.length)){if(!U[0].hyperlink)return ia.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
U[0].Qa,U[0].Mb),8;Oc.App.D4b(U[0].hyperlink.url);return 32}Le.isInTableCell(ja)&&!P.a.instance.ga(77)&&(Vd.returnToContainingCell(ja),P.a.instance.ga(30)&&Le.isLastCellInTable(ja)&&!gj.OutlineReader.QVc(ja)&&gj.OutlineReader.BC(ja,x,!0)&&(kh.OutlineNavigator.V$(ja),rb.ListReader.uk(ja)||(H=D.a.$ta),Vd.returnToCell(ja)),Le.isFirstCellInRow(ja)&&(U=new tb.GraphIterator,U.Rc(ja),Vd.returnToContainingRow(U),P.a.instance.ga(30)&&tk.j(U)&&tk.e(U)&&1<od.TableReader.sk(Vd.getContainingTable(U))?H=D.a.deleteRow:
gj.OutlineReader.BC(ja,x,!1)&&(tk.g(U)&&0>=x.MS?(H=D.a.Q8b,Vd.returnToContainingTable(ja),Ta.OutlineElementNavigator.Re(ja),l||(l=new J.DictionaryPropertySet),l.we(Mc.a.targetObject,ja.currentNode.id)):P.a.instance.ga(30)&&(H=D.a.kUa))));ja=this.MSf(b,c,a,f,l,H)}else nb.SelectionEditor.UW(x)&&(ja=u.AFrameworkApplication.Ta.mi(b,D.a.zB,2,!1,f,l));bd.a.mark(5014);return ja}guh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,If:f,selected:l,tF:32};if(!a.view.Mh)return{returnValue:!1,If:f,selected:l,
tF:2};f=a.view;l=f.Lb.Pj;return!l||P.a.instance.ga(14)&&!Up.$i.$hg(l,c)?{returnValue:!1,If:f,selected:l,tF:2}:this.Hm&&this.Hm.instance&&this.Hm.instance.XW(l)?{returnValue:!1,If:f,selected:l,tF:4}:{returnValue:!0,If:f,selected:l,tF:2}}zgl(a,b,c,f,l){let x,H;if(!({If:c,selected:x,tF:H}=this.guh(b,c,!0)).returnValue)return H;const U=Up.km.LA(x);for(let ja=0;ja<U.length;++ja){if(!U[ja].isValid)continue;const ya=U[ja].iterator;ya.ev();if(gj.OutlineReader.Zt(ya))return this.JSf(c,ya)}x.hx||nb.SelectionEditor.gk(x)?
H=this.KSf(b,c,a,f,l,D.a.O8b):nb.SelectionEditor.Xl(x)?H=this.ISf(b,c,a,f,l,D.a.O8b):nb.SelectionEditor.Tg(x)?H=this.MSf(b,c,a,f,l,D.a.O8b):nb.SelectionEditor.UW(x)&&(H=u.AFrameworkApplication.Ta.mi(b,D.a.zB,2,!1,f,l));return H}JSf(a,b){a.Lb.setSelection(Qd.SelectionFactory.tj(b.currentNode,!1));return 32}KSf(a,b,c,f,l,x){const H=new pf.GraphTransaction(15);H.jd=c;H.kd(b.xg);b=new J.DictionaryPropertySet;b.setValue(Mc.a.Lub,!0);b=u.AFrameworkApplication.Ta.mi(a,D.a.$K,2,!0,f,b);32===b&&(b=u.AFrameworkApplication.Ta.mi(a,
x,2,!1,f,l));H.dispose();return b}ISf(a,b,c,f,l,x){const H=new pf.GraphTransaction(15);H.jd=c;H.kd(b.xg);b.Lb.setSelection(nb.SelectionEditor.Sl(b.Lb.Na.ga(0),!1,!1));a=u.AFrameworkApplication.Ta.mi(a,x,2,!1,f,l);H.dispose();return a}MSf(a,b,c,f,l,x){const H=new pf.GraphTransaction(15,c);H.jd=c;H.kd(b.xg);a=u.AFrameworkApplication.Ta.mi(a,x,2,!1,f,l);H.dispose();return a}static get km(){return Ih.ContextSetEditor.instance}static get $i(){return fd.a.instance}static get ze(){return Up.hd||(Up.hd=Db.a.instance.ub("Box4.IFeatureHelper"))}}
Up.hd=null;Object(m.a)(Up,"AEnterViewStrategy",null,[1219]);class gt extends Up{constructor(a,b,c){super(a,b,c)}e9i(a){let b=D.a.zB;if(a&&(a=Up.km.LA(a))&&0<a.length){const c=new tb.GraphIterator;c.set(a[0].node);c.rc(10);(a=c.M1a())&&a.Sa(kb.a.Hj)&&(a=a.eb(kb.a.Hj),0===a||2===a)&&(b=D.a.O8b)}return b}Ank(){return gt.YU?!1:!0}static get YU(){null==gt.nI&&(gt.nI=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return gt.nI}}gt.nI=null;Object(m.a)(gt,
"EnterViewStrategy",Up,[]);class UE{constructor(a){this.F8j=a}Fod(a,b){this.F8j.UU(a,b)}}Object(m.a)(UE,"PPTFontNameFormattingStrategy",null,[1204]);class aO{zth(){return!1}}Object(m.a)(aO,"PptClipboardOperationCutStrategy",null,[373]);class bO{constructor(a,b){this.dM=a;this.pa=b}tRj(a){return 10===a.ri||16===a.ri||60===a.ri}Zoi(a){if(this.dM.Yab(a)&&this.dM.pzb(a))return!1;let b=a=null;this.pa.Na.mb&&(b=this.pa.Na.mb.Ua,a=this.pa.Na.mb.Ye);return this.Jme(b)&&this.Jme(a)}Jme(a){if(a){if(a.contextId===
Cb.a.paragraph)return!0;if(a.contextId===Cb.a.endOfParagraph&&(a=a.node))return ha.a.Wa(a.characterData)}return!1}Qhl(a,b){return this.FXe(a,b)}FXe(a,b){let c=null;this.pa.Na.mb&&(c=this.pa.Na.mb.Ua);return this.Jme(c)?!!a&&this.dM.pzb(a)||1===b:!1}}Object(m.a)(bO,"PptDeleteOutlineElementNodeStrategy",null,[1147]);class cO{constructor(a,b,c){this.Kq=a;this.yJ=b;this.ob=c}gTf(a){if(this.ob.Na&&this.ob.Na.Hl){const f=this.Kq.t_f(this.ob.Na).returnValue;if(!f.bSa()&&a.hx){a=new Wa.a;var b=this.ob.xv();
for(const l of b)if(b=Object(oa.a)(Yl.TableCellNode,l)){var c=tb.GraphIterator.nb(b);if(c.$e()){const x=tk.c(c);c=this.yJ.LRc(Object(oa.a)(123,c.currentNode));f.XUi(x,c)&&a.sia(qd.a.TQa(Qd.SelectionFactory.wl(b)))}}}}return a}}Object(m.a)(cO,"PptDeleteTableSegmentStrategy",null,[374]);class dO{qzh(){return!1}vkg(a){return!!a&&!a.om.equals(ka.a.nil)}}Object(m.a)(dO,"PptEopFormattingStrategy",null,[1145]);class eO{constructor(a,b,c){this.C7c=!1;this.Fa=a;this.nJ=b;this.pa=c}yEh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(kb.a.aea,b.beforeSpacing.value),a.setValue(kb.a.qla,b.beforeSpacing.unit)),b.afterSpacing&&(a.setValue(kb.a.$da,b.afterSpacing.value),a.setValue(kb.a.pla,b.afterSpacing.unit)),b.lineSpacing&&(a.setValue(kb.a.ux,b.lineSpacing.value),a.setValue(kb.a.jX,b.lineSpacing.unit)));return!0}wth(){return!1}juh(){return!1}tth(){return!this.C7c}duh(a,b){return a===Cb.a.paragraph||a===Cb.a.endOfParagraph||b}uth(a,b,c){this.pa.Na&&this.pa.Na.mb&&(c=!this.pa.Na.mb.Cca);return a!==Cb.a.textRange&&(b===
Cb.a.paragraph||c)}pvf(a,b,c){this.C7c=!1;if(a.Cs()&&this.pa.Na.mb){var f=this.pa.Na.mb.Ua;this.pa.Na&&this.pa.Na.Hl&&this.pa.Na.ga(0)&&(f=this.pa.Na.ga(0).Ua);if(f=gc.a.xs(Sb.ParagraphReader.$d(f.node)?f:Qd.SelectionFactory.wl(a).Ua))if(f=f.cache)!c.Sa(kb.a.latinFont)&&f.Sa(kb.a.latinFont)&&c.setValue(kb.a.latinFont,f.GN),!c.Sa($a.a.fontColor)&&f.P3&&c.setValue($a.a.fontColor,f.fontColor),!c.Sa($a.a.fontSize)&&f.Lta&&c.setValue($a.a.fontSize,f.fontSize),!c.Sa($a.a.bold)&&f.KTa&&c.setValue($a.a.bold,
f.isBold)}if(b){if(f=a.qQ(this.nJ)){b.IT||a.sa(kb.a.Gie,!1)||f.sa(kb.a.Gie,!1)||(this.C7c=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Sa(kb.a.aea)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Sa(kb.a.$da)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.unit&&1===l.lineSpacing.value&&!f.Sa(kb.a.ux)&&(l.lineSpacing=null))}this.C7c||(b.IT||(b.IT=dj.a.wN(16,0)),b.IT.iYf=!0)}if((f=a.o6f())&&!f.X$&&(c.Sa($a.a.fontSize)&&(f=this.Fa.WDa(this.Fa.$m(a)),
c.setValue($a.a.fontSize,c.eb($a.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.unit)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Fa.uwb(this.Fa.$m(a))}c.sa($a.a.ht,!1)&&c.setValue($a.a.ht,!1);c.sa($a.a.E_,!1)&&c.setValue($a.a.E_,!1)}}Object(m.a)(eO,"PptFormatPainterStrategy",null,[1148]);class nA{constructor(a,b,c,f,l,x,H){this.ia=a;this.Ea=f;this.pa=b;this.vE=c;this.Ou=l;this.sB=x;this.KXa=!H.vg;this.rxe=H.nlg}wb(){this.ia.ra(G.a.mCh,de.a.frame,Object(F.a)(this,
this.QHk,"pptToggleRibbonUXHandler"),128);this.ia.ya(G.a.Tjh,de.a.frame,ld.ActionManager.Mg);this.ia.ya(G.a.Sjh,de.a.frame,ld.ActionManager.Mg)}Ee(){}QHk(a,b){if(b.contextId!==de.a.frame)return 2;this.pa.Qh();this.Ea.Ed();this.Ou.show(!0,a);this.rxe?(xa.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),u.AFrameworkApplication.Ta.processAction(G.a.Tjh,2)):(xa.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),u.AFrameworkApplication.Ta.processAction(G.a.Sjh,
2));u.AFrameworkApplication.av&&u.AFrameworkApplication.av.y8();this.sB.e4&&2===this.sB.lG?nA.onh(this.ia,this.rxe,ix.a.AZa):this.vE.u3(!1,this.KXa,()=>{nA.onh(this.ia,this.rxe,ix.a.AZa)},null);return 32}static onh(a,b,c){ki.a.$J(c,(!b).toString(),ki.a.DJ);a.processAction(K.a.refresh,2)}}Object(m.a)(nA,"ToggleRibbonUXActor",null,[352]);class fO extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.W3e=b;this.vbb=c}}Object(m.a)(fO,"UndoRedoEventArgs",Sys.EventArgs,[]);class gO{constructor(a,
b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){this.ia=a;this.hf=b;this.pa=c;this.Ea=f;this.Mv=l;this.Z6c=x;this.tdk=H;this.vQg=U;this.uE=ja;this.Efb=ya;this.fJ=Va;this.j9j=hb;this.he=Zb}wb(){this.ia.ra(K.a.FZa,rc.a.application,Object(F.a)(this,this.Eag,"handleUndoRedo"),4);this.ia.ra(K.a.EZa,rc.a.application,Object(F.a)(this,this.Eag,"handleUndoRedo"),4)}Ee(){const a=this.Ea.Fc(zb.a.gj);a.cIc(y.KeyInputManager.Oa(A.a.tmb,y.KeyInputManager.Oe),K.a.FZa,()=>!0);a.bindAction(y.KeyInputManager.Oa(A.a.wvc,y.KeyInputManager.Oe),
K.a.EZa)}Eag(a,b,c,f,l){b=!0;a===K.a.EZa&&(b=!1);if(this.hf.$c(this.vQg)||!this.Igl(b,l))return 16;if(!this.Jgl())return this.Mv.soa(),16;if(1===c)return 32;if(c=!this.Mv.xLj(b))this.pa.ij(),this.y1k();f=this.Mv.dSc(b);(l=this.fJ.W5(f))&&Tc.a.zk("UndoRedoActionName",l);this.Efb.led(!c);this.he.OPk(new fO(a,f,b));(f=this.Mv.r6d(b))&&f.o6!==ka.a.nil&&Tc.a.zk("UndoRedoRevision",Tc.a.$9a(f.o6.toString()).toString());this.j9j.led(f,l,b);if(b?!this.Mv.undo():!this.Mv.redo())return ia.ULS.sendTraceTag(512499928,
801,10,"User perform {0} failed!!",a===K.a.undo?"undo":"redo"),8;c&&this.hf.fw(this.vQg,a);return 32}Igl(a,b){a&&!this.Mv.NW&&b&&ia.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.Mv.Pab());return(a?this.Mv.NW:this.Mv.vka)&&!(this.Ea.Ae&&this.Ea.Ae.name===zb.a.nQd)&&this.Kgl()}Jgl(){return this.Z6c||!this.vOj()}vOj(){return!this.tdk.RDa&&!!this.uE.instance&&this.uE.instance.rSj()}Kgl(){return!this.wOj()}wOj(){const a=this.pa.Jp();return a?a.gy:
!1}y1k(){const a=this.Ea.Ae;!a||a.name!==zb.a.sg&&a.name!==zb.a.rna||this.Ea.Ed()}}Object(m.a)(gO,"UndoRedoActor",null,[352]);class hO{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze,Vf,gg,Qg,Rg,Wf,rg,Sg,Gh,Zi,Ei,fj,Fi){this.KGa=this.Xva=this.w$c=null;this.LDb=0;this.Nzg=this.zwe=!1;if(Zb.Jn&&!Fi)throw Error.argumentNull("sorterViewActorLazy");this.vE=x;this.ia=a;this.GBb=b;this.Ea=c;this.Og=f;this.pa=l;this.hf=H;this.qe=U;this.Vb=ja;this.ua=ya;this.Tb=Va;this.tic=hb;this.Pb=
yb;this.la=Zb;this.Ou=fc;this.Xa=Kc;this.sB=Lc;this.Ge=Gc;this.ZXa=ae;this.bIg=we;this.Gv=$d;this.zb=Te;this.Ds=Ze;this.B7c=Vf;this.jCg=Zb.ajg;this.Lc=gg;this.ucb=Qg;this.So=Rg;this.Hc=Wf;this.Ub=rg;this.Fb=Sg;this.KO=Gh;this.Rb=Zi;this.zH=Ei;this.yw=fj;this.bYa=Fi;this.iri()}wb(){this.ia.ra(K.a.$Ib,rc.a.application,Object(F.a)(this,this.$Ib,"queryEdit"),96);this.ia.ra(K.a.CJb,rc.a.application,Object(F.a)(this,this.CJb,"querySorterView"),96);this.ia.ra(K.a.BJb,rc.a.application,Object(F.a)(this,this.BJb,
"querySlideInformation"),96);this.ia.ya(K.a.zkd,rc.a.application,Object(F.a)(this,this.lsl,"switchToReadingMode"));this.ia.ya(K.a.nNb,rc.a.application,Object(F.a)(this,this.qql,"startSlideShowFromBegnning"));this.ia.ya(K.a.IIb,rc.a.application,Object(F.a)(this,this.IIb,"present"));this.ia.ya(K.a.Lhb,rc.a.application,Object(F.a)(this,this.Lhb,"presentDropDown"));this.ia.ya(K.a.Elc,rc.a.application,Object(F.a)(this,this.Elc,"playFromBeginningTopBar"));this.ia.ya(K.a.Vya,rc.a.application,Object(F.a)(this,
this.Vya,"startSlideShowFromCurrentSlide"));this.ia.ya(K.a.Nvb,rc.a.application,Object(F.a)(this,this.Nvb,"forceClose"));this.ia.ya(K.a.Pfa,rc.a.application,Object(F.a)(this,this.Pfa,"rehearsePresentation"));this.ia.ya(K.a.boc,rc.a.application,Object(F.a)(this,this.boc,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(K.a.tOc,rc.a.application,Object(F.a)(this,this.tOc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(K.a.sOc,rc.a.application,Object(F.a)(this,this.sOc,
"enableLivePresenterKeyboardShortcut")));this.k6h();this.ia.ya(K.a.jLa,rc.a.application,Object(F.a)(this,this.jLa,"showEditTriPaneView"));this.Pb.ka("PPTSorterViewEnabled")&&(this.zwe=this.Pb.ka("FeedbackPaneExperienceIsEnabled")&&this.Pb.ka("HelpTabIsEnabled"),this.ia.ya(K.a.j0b,rc.a.application,Object(F.a)(this,this.j0b,"closeEditTriPaneView")));this.la.yZc&&this.ZXa.ADj(u.AFrameworkApplication.buildVersion,this.Xa.pk,u.AFrameworkApplication.userSessionId,this.Hc)}Ee(){if(this.Pb.ka("SlideShowByShortcutEnabled")){const a=
this.Ea.Fc(E.AFrame.gj);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.qvc,y.KeyInputManager.Oe|4),K.a.Vya);E.AFrame.kk(a,y.KeyInputManager.Oa(A.a.qvc,y.KeyInputManager.Oe),K.a.nNb)}}k6h(){this.ia.ya(K.a.CZa,rc.a.application,Object(F.a)(this,this.CZa,"presentLive"));this.ia.ya(K.a.ymc,rc.a.application,Object(F.a)(this,this.ymc,"presentLiveTopBar"));this.ia.ya(K.a.DZa,rc.a.application,Object(F.a)(this,this.DZa,"presentLiveSetAccessControlAnyone"));this.ia.ya(K.a.xmc,rc.a.application,Object(F.a)(this,this.xmc,
"presentLiveSetAccessControlOrganization"));this.ia.ra(K.a.rJb,rc.a.application,Object(F.a)(this,this.rJb,"queryPresentLiveAccessControlAnyone"),96);this.ia.ra(K.a.sJb,rc.a.application,Object(F.a)(this,this.sJb,"queryPresentLiveAccessControlOrganization"),96);Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.C3("L_PublicLivePresentations",!0).then(b=>{b||(xa.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),
this.ia.PJ(K.a.DZa,Cb.a.application,Object(F.a)(this,this.DZa,"presentLiveSetAccessControlAnyone")),Oc.App.Kb.C1a(K.a.DZa,Object(F.a)(new up,(new up).VDa,"getCommandById")));return null},b=>{xa.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}BJb(a,b,c,f,l){a=(a=this.ua.Ba)?a.le+1:0;a=(b=this.Tb.pj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[wp.a.Value]=a;l[im.a.labelText]=a;return 32}$Ib(a,b,c,f,l){this.Fb&&0!==
this.Fb.Fl?l.Mf(!1):l.Mf(!0);return 32}CJb(a,b,c,f,l){(a=Object(oa.a)(Uh.a,l))&&(1!==this.Fb.Fl?a.Mf(!1):a.Mf(!0));return 32}jLa(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Fb.Fl&&(xa.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Fb.Fl=0,this.Rb&&(this.Rb.slidePane.Ql(),this.la.Jn||this.Rb.thumbnailPane.Ql(),this.Rb.notesPane.Ql(),this.zH&&this.zH.setVisibility(!0)),this.ia.processAction(K.a.ljb,2),this.ia.processAction(K.a.vtb,2),this.KO.b6("PptEditingStatusBar.Notes",!0),
this.KO.b6("PptEditingStatusBar.ZoomScale",!0),this.KO.b6("PptEditingStatusBar.FitToWindow",!0),this.zwe?this.KO.b6("PptEditingStatusBar.GiveFeedbackPane",!0):this.KO.b6("PptEditingStatusBar.GiveFeedback",!0),this.Lc.Dy(new Sp.a(2)),this.Lc.Dy(new Sp.a(1)),this.la.Jn||this.Og.pI(zb.a.XE),this.Og.pI(zb.a.rna),this.Og.pI(zb.a.sg),this.Og.pI(zb.a.lQ))}catch(f){xa.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}j0b(a,b,c){try{if(1===c)return 32;2===c&&(this.Rb&&
(this.Rb.slidePane.Cr(),this.Rb.thumbnailPane.Cr(),this.Rb.notesPane.Cr(),this.zH&&this.zH.setVisibility(!1)),this.KO.b6("PptEditingStatusBar.Notes",!1),this.KO.b6("PptEditingStatusBar.ZoomScale",!1),this.KO.b6("PptEditingStatusBar.FitToWindow",!1),this.zwe?this.KO.b6("PptEditingStatusBar.GiveFeedbackPane",!1):this.KO.b6("PptEditingStatusBar.GiveFeedback",!1),this.Lc.Dy(new Sp.a(2)),this.Lc.Dy(new Sp.a(1)),this.la.Jn||this.Og.Ko(zb.a.XE),this.Og.Ko(zb.a.rna),this.Og.Ko(zb.a.sg),this.Og.Ko(zb.a.lQ),
this.pa.Qh())}catch(f){xa.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",f)}return 32}lsl(a,b,c){if(this.hf.$c(this.Vb.Ef))return 16;if(1===c)return this.ua.Ba?32:16;b=(new Date).getTime();let f=bg.a.Ki(window.document.URL,ee.a.a9g,ee.a.readingView,!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ua.Ba.Cb;f=bg.a.Ki(f,ee.a.qlc,c?c.sid.toString():"",!0);f=this.GBb.instance&&this.GBb.instance.isVisible?bg.a.Ki(f,ee.a.$8g,"1",!0):bg.a.removeParameter(f,
ee.a.$8g,!0);this.hri();f=bg.a.Ki(f,u.AFrameworkApplication.Xcd,b.toString(),!0);this.pa.Qh();this.Ea.Ed();this.Ou.show(!0,a);this.vE.u3(!1,!0,()=>{this.gyh(f)},()=>{xa.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.gyh(f);return!0});return 32}gyh(a){this.tic.openWindow(1,a,!1)||this.Ou.hide()}IIb(a,b,c){return this.Hkb(a,c,null)}Lhb(a,b,c){return this.Hkb(a,c,null)}Elc(a,b,c){return this.Hkb(a,c,null)}qql(a,b,c){return this.Hkb(a,c,null)}Vya(a,b,c){return this.Hkb(a,
c,this.ua.Ba?this.ua.Ba.Cb:null)}Hkb(a,b,c,f=!1,l=!1){if(!this.la.yZc)return this.Ypl(a,b,c);if(this.hf.$c(this.Vb.Ef)||!this.Tb.pj()||this.la.preventDuplicateSlideShowLaunches&&this.ZXa.W$b()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.ZXa.Bce)return 16;if(1===b)return 32;this.la.Qhg&&!Ud.a("DummyChangeGateForTest")&&xa.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.yw.hasDeferredContent()&&xa.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");
this.pql(c,f,l);return 32}pql(a,b,c){this.LDb=(new Date).getTime();this.pa.Qh();this.Ea.tf(zb.a.ND);this.Lc.Ieh();xa.a.J(512499918,830,50,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.ZXa.Bce);const f=a?a.sid:-1;a=(a=a?Object(oa.a)(115,this.Tb.sEa(a.sid)):null)?a.le+1:-1;let l=!1;this.So.instance?l=this.So.instance.k_?!0:!1:xa.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.ZXa.jrd(f,a,b,this.Pb.Ga("361"),this.Xa.pk,this.Xa.podSessionId,
this.Pb.Ga("387"),u.AFrameworkApplication.userSessionId,this.la.qSj,this.LDb,l,this.Xa,c);this.ZXa.Aia(Object(F.a)(this,this.Qed,"onExitSlideshowHandler"));this.sB.onl()}boc(a,b,c,f){return this.Pfa(a,b,c,f,{entryPoint:4})}Pfa(a,b,c,f,l){switch(c){case 2:if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.La(K.a.Wrc,2,b),this.Hc&&(this.Hc.BDa=!1),this.Ub&&this.Ub.instance&&(this.Ub.instance.BDa=
!1));return this.ZXa.W$b()?(this.Hc&&(this.Hc.Kh=!1),32):this.Hkb(a,c,this.ua.Ba.Cb,!0);case 1:if(0<this.Tb.pj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===this.ia.processAction(K.a.oLa,1)&&32===this.ia.processAction(K.a.Wrc,1))return 32;break}else return this.ia.processAction(K.a.oLa,1);else break;default:xa.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}tOc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Hc)return this.Hc.BDa=
!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:xa.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}sOc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Ub&&this.Ub.instance)return this.Ub.instance.BDa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:xa.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}ymc(a,
b,c,f,l){return this.CZa(a,b,c,f,l)}CZa(a,b,c){if(this.Nzg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){xa.a.J(512499913,833,10,"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.F8a?0<this.Tb.pj()?32:8:8;this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&(this.Ub.instance.ADa=!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");return this.Hkb(a,
c,this.ua.Ba.Cb,!1,!0)}DZa(a,b,c){if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.F8a?32:8;this.Ub.instance.dr&&0!==this.Ub.instance.accessControl?this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.p3b(5);this.Ub.instance.accessControl=0;this.Lc.Dy(new Sp.a(1))},()=>{}):(this.Ub.instance.accessControl=0,this.Lc.Dy(new Sp.a(1)));return 32}xmc(a,b,c){if(1===c)return this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.F8a&&this.Ub.instance.vUf?32:
8;this.Ub.instance.dr&&1!==this.Ub.instance.accessControl?this.Ub.instance.showEndSessionDialog(()=>{this.Ub.instance.p3b(5);this.Ub.instance.accessControl=1;this.Lc.Dy(new Sp.a(1))},()=>{}):(this.Ub.instance.accessControl=1,this.Lc.Dy(new Sp.a(1)));return 32}rJb(a,b,c,f,l){try{const x=Object(oa.a)(Uh.a,l);x&&this.Ub.instance&&x.Mf(0===this.Ub.instance.accessControl)}catch(x){xa.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",x)}return 32}sJb(a,
b,c,f,l){try{const x=Object(oa.a)(Uh.a,l);x&&this.Ub.instance&&x.Mf(1===this.Ub.instance.accessControl)}catch(x){xa.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",x)}return 32}Ypl(a,b,c){if(this.hf.$c(this.Vb.Ef))return 16;if(1===b)return this.Tb.pj()?32:16;this.LDb=(new Date).getTime();this.pa.Qh();this.Ea.tf(zb.a.ND);this.Lc.Ieh();this.Ou.show(!0,a);this.vE.u3(!1,!0,()=>{this.nnh(c,this.LDb)},()=>{xa.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");
this.nnh(c,this.LDb);return!0});return 32}Qed(a,b){a=((new Date).getTime()-this.LDb).toString();xa.a.J(512499909,830,50,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",a,this.yw.hasDeferredContent(),this.yw.Nbe(b.slideId.toString()));this.yw.hasDeferredContent()||this.yw.Nbe(b.slideId.toString())?this.yw.qra("DeferredExitSlideshowDuration",a):this.yw.qra("ExitSlideshowDuration",a);this.ZXa.Rfa(Object(F.a)(this,
this.Qed,"onExitSlideshowHandler"));(this.Xva=b)&&!this.Xva.GJj&&!this.Xva.BNj&&0<this.Xva.slideId&&0<=this.Xva.slideIndex&&this.pnk(this.Xva.slideId,this.Xva.slideIndex);this.Ea.Ed();this.jCg?(this.KGa=Tc.a.yk("ExitSlideshow"),this.hf.blockContent(this.Vb.Ef,"ExitSlideshow"),this.bIg.jk(Object(F.a)(this,this.K4g,"onPageManifestNodePropertyChanged")),this.KGa.Va("UnlockPodsSessionStartTime",Tc.a.nf(new Date)),this.unlockPodsSession(c=>{this.KGa&&(this.KGa.Va("UnlockPodsSessionWithMerge",c.toString()),
this.KGa.Va("UnlockPodsSessionEndTime",Tc.a.nf(new Date)));c?this.Gv.y_i():this.FSe()})):this.FSe()}FSe(a=null){a&&(this.w$c=null);this.Xva&&(this.jCg&&(this.bIg.Cm(Object(F.a)(this,this.K4g,"onPageManifestNodePropertyChanged")),this.hf.fK(this.Vb.Ef),this.KGa&&(this.KGa.Va("InboundPresentationEndTime",Tc.a.nf(new Date)),this.KGa.finish(),this.KGa=null)),this.Xva=null,this.sB.e3k())}unlockPodsSession(a){const b=Ug.a.create().toString();xa.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",
b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",u.AFrameworkApplication.fa.appSettings["361"],this.Xa.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Xa.pk;this.Voh(c,f,0,a)}Voh(a,b,c,f){this.Ds.mj(a,2,null,b,!1,2,l=>{this.jBl(l,c,f)},l=>{this.tFh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,Hx.a("2"))}jBl(a,b,c){if(b)xa.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",
b);else{b=!1;try{a.data.Sd&&0<a.data.Sd.length&&(b=JSON.parse(a.data.Sd).FMerged)}catch(f){xa.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",a.toString())}c(b)}}tFh(a,b,c,f,l){f||l(!1);3>f?this.Voh(b,c,f+1,l):xa.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.B7c.cka(a),f)}K4g(a,b){this.w$c||b.property!==kb.a.B8b||(this.w$c=new af.a(2,1,0,Object(F.a)(this,this.FSe,
"resumeEditor"),90,"65"),this.zb.Db(this.w$c))}nnh(a,b){this.Ou.hide();let c=!0,f=!1,l=this.qe.slideShowUrl;l||(l=bg.a.Ki(window.document.URL,ee.a.a9g,ee.a.slideShowView,!0),f=!0);l=bg.a.removeParameter(l,ee.a.aCk);l=a?bg.a.Ki(l,ee.a.qlc,a.sid.toString(),!0):bg.a.removeParameter(l,ee.a.qlc);0<b&&(l=bg.a.Ki(l,u.AFrameworkApplication.Xcd,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);
b=null;try{b=this.tic.kJe(4,l,"SlideShowWindow",a,f,!1)}catch(x){xa.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",x),c=!1}b||(xa.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),c=!1);Tc.a.zk("Window Opened",c.toString());Tc.a.ztd()}Nvb(a,b,c){if(2!==c)return this.ia.processAction(G.a.close,c);a=this.ia.processAction(G.a.close,2);32!==a&&(xa.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location=
"about:blank");return 32}pnk(a,b){xa.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Tb.sEa(a))?this.la.Jn?this.bYa.value.GJ(a.le):this.Ge.GJ(a.le):(xa.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",b),a=this.Tb.pj()-1,b=b>a?a:b,0>b||(this.la.Jn?this.bYa.value.GJ(b):this.Ge.GJ(b)))}hri(){this.ucb.instance&&this.ucb.instance.AUa&&(this.ucb.instance.iMc.rC?this.ucb.instance.endCommentSession(this.ucb.instance.iMc.rC.draftId,
7):this.ucb.instance.endCommentSession("",7),this.ucb.instance.ftf())}iri(){this.la.powerPointLiveBroadcastEnabled&&Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(xa.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.Nzg=!0);return null})})}}Object(m.a)(hO,"ViewSwitchingActor",null,[352]);class iO{constructor(a,b){this.Vqe=null;this.Xa=a;this.$ma=
b;this.hAf();this.Xa.xuf(Object(F.a)(this,this.bgd,"onSessionInfoChanged"))}hAf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Xa.presentationId.string));a.append(String.format("&{0}={1}",ee.a.Q8k,this.Xa.Vub));a.append(String.format("&{0}={1}",ee.a.Lna,"368"in u.AFrameworkApplication.fa.appSettings?void 0===this.Xa.sessionInfo||null===this.Xa.sessionInfo?"undefined":this.Xa.sessionInfo:this.Xa.sessionInfo));this.Xa.pk&&a.append(String.format("&{0}={1}",ee.a.b9g,this.Xa.pk));this.Xa.podSessionId&&
a.append(String.format("&{0}={1}",ee.a.haa,this.Xa.podSessionId));this.Vqe=a.toString()}bgd(){this.hAf()}resolve(a,b,c){if(!b||!b.length)return null;if(b.startsWith("./"+a))return b;const f=Ud.a("FixInvalidOperationErrorInEditImageHandler")?encodeURIComponent(b):b;return c?this.$ma+a+this.Vqe+`&cl=${c}&${ee.a.Y8g}=${f}`:this.$ma+a+this.Vqe+String.format("&{0}={1}",ee.a.Y8g,b)}dispose(){this.Xa.eZk(Object(F.a)(this,this.bgd,"onSessionInfoChanged"))}}Object(m.a)(iO,"ResourceViewElementResolver",null,
[1173,106]);var ER=d(1043),FR=d(955);class jO{constructor(a,b){this.E2c=this.s4=0;this.xFg=null;this.yFg=-1;this.zFg=null;this.fva=a;this.Cc=b}get $ie(){return 0<this.E2c}get Aog(){return this.xFg}Yqk(a){this.E2c++;this.Cc.eyh(a.CcpId,a.CcpCorrelation)}get ene(){return this.zFg}set ene(a){this.zFg=a}j1g(a,b){if(!a){const c=this.Unj(b);c>this.yFg&&(this.yFg=c,this.xFg=b.CcpId)}0<this.E2c?this.E2c--:xa.a.J(20760084,307,15,"ClipServiceManager - bad state");this.Cc.IRf(b.CcpId,a,0)}qLc(a,b,c=!1,f=!1){a=
Object.assign(new FR.a,{sW:32,Gp:Ug.a.create().toString(),version:this.s4++,location:this.fva.ccpInfo,tD:this.fva.pk||vp.a.sJh,dataType:a,objectCount:b,kFa:c,iFa:f,zy:Ug.a.create().toString()});xa.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}Unj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const x=xd.a(c);if(x&&"I"in x&&"V"in x){l=new dt(x.I,parseInt(x.V));var f={returnValue:!0,zy:l};break a}}catch(x){}f={returnValue:!1,
zy:l}}if(({zy:b}=f).returnValue&&b)return b.version;xa.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(m.a)(jO,"ClipServiceManager",null,[1162]);class kO{constructor(a,b,c,f,l,x,H,U,ja){this.Zg=a;this.Ldc=c;this.wFb=f;this.bqe=l;this.Lr=x;this.Cc=H;this.u0=U;this.ia=ja;this.Bl=b;this.mea=this.Zg.contentWindow.document.body;this.Lr.addHandler(this.mea,ta.a.cut,Object(F.a)(this,this.Y1g,"onBrowserCut"));this.Lr.addHandler(this.mea,ta.a.copy,Object(F.a)(this,
this.X1g,"onBrowserCopy"))}get Ic(){return this.Ldc.Ic}dispose(){this.Zg&&this.Zg.contentWindow&&(this.Lr.removeHandler(this.mea,ta.a.cut,Object(F.a)(this,this.Y1g,"onBrowserCut")),this.Lr.removeHandler(this.mea,ta.a.copy,Object(F.a)(this,this.X1g,"onBrowserCopy")));this.Zg=null}Y1g(){if($k.EA&&!$k.EA.v2d){var a=this.Cc.hP(1,0,"OnBrowserCut");this.Bsa(Object.assign(new et(!0,!0),{Wb:a}))}}X1g(){if($k.EA&&!$k.EA.v2d){var a=this.Cc.hP(0,0,"OnBrowserCopy");this.Bsa(Object.assign(new et(!0),{Wb:a}))}}nQ(a){if((u.AFrameworkApplication.yM||
u.AFrameworkApplication.iG)&&!u.AFrameworkApplication.MRa)return!1;for(let b=0;b<this.Bl.length;b++)if(this.Bl[b].nQ(a))return!0;return!1}Bsa(a){if(this.ia.aX)this.u0?(this.u0.show(5,-1),this.Cc.Hg(!1,a.Wb,26)):xa.a.J(509444690,826,10,"m_offlineModalCallout is null");else if(!u.AFrameworkApplication.yM&&!u.AFrameworkApplication.iG||u.AFrameworkApplication.MRa){var b=0,c=!1;for(var f=0;f<this.Bl.length;f++)if(this.Bl[f].nQ(a)){c=!0;this.Bl[f].Bsa(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;
case 1:f=19;break;default:f=0}this.Cc.KB(f,a.Wb);if(c){if(a.ohg&&(this.bqe.O_a(this.Zg),!a.tVi)){if(!this.wFb){this.Cc.Hg(!1,a.Wb,1);return}this.wFb.copy(this.Zg)||0!==b||(b=22)}this.Cc.Hg(0===b,a.Wb,b)}else this.Cc.Hg(!1,a.Wb,20)}else this.Cc.Hg(!1,a.Wb,32)}}Object(m.a)(kO,"CutCopyManager",null,[1158,106]);var GR=d(905);class lO{constructor(a,b,c){this.XX=a;this.XX.jk(Object(F.a)(this,this.kh,"onPropertyChanged"));this.jM=b;this.jM.jk(Object(F.a)(this,this.kh,"onPropertyChanged"));this.Jq=c}kh(a,
b){this.Jq.Yq&&0<this.Jq.Yq.length&&(this.Jq.Yq=cb.a.upa(this.Jq.Yq,c=>!(ka.a.WP(c.id,b.node.id)||Object(Xa.a)(Mv.a,c))));this.Jq.Yq&&!this.Jq.Yq.length&&(this.Jq.Yq=null)}}Object(m.a)(lO,"GraphNodeChangeListener",null,[]);class mO{constructor(a,b){this.Ccc=null;a&&b&&new lO(a,b,this)}get Yq(){return this.Ccc}set Yq(a){const b=this.Ccc&&0<this.Ccc.length?this.Ccc[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.Rvf;this.Ccc=a;c&&(c.Rvf=f,c.QFf=f&&b?b.QFf:GR.a.create().toString())}}Object(m.a)(mO,
"InternalClipboard",null,[1157]);class nO{constructor(a,b,c,f,l,x,H,U,ja,ya){this.Ysg=a;this.ki=b;this.Vea=c;this.JHa=f;this.m$=l;this.Fa=x;this.Wwe=H;this.Pec=U;this.U$j=ja;this.e7c=ya}gVe(a,b,c){this.Ysg.gVe(a,b,c);b=new AM.a;this.Wwe&&c||(b.setValue($a.a.bold,!1),b.setValue($a.a.underline,!1),b.setValue($a.a.Ow,Kd.Font.pV),b.setValue($a.a.strikethrough,!1),b.setValue($a.a.italic,!1),b.setValue($a.a.ht,!1),b.setValue($a.a.E_,!1));this.ki.rWe(a,b)}vVe(a,b,c){const f=b.cache;if(this.e7c){var l=this.D7i(b);
ha.a.Wa(l)||c?f.propertySet.Sa($a.a.font)&&(f.sa(kb.a.QYc,!1)||c)&&this.ki.UU(a,f.GN):this.ki.UU(a,l);f.Lta&&this.ki.Pq(a,f.fontSize)}else this.Ysg.vVe(a,b,c);(!this.Pec||this.Wwe&&c)&&f.P3&&(this.ki.Dm(a,$a.a.fontColor,f.fontColor),this.Pec&&(l=zn.SchemeColor.create(null,f.fontColor),this.ki.Dm(a,kb.a.schemeColor,l.toString())));this.Wwe&&c&&(this.ki.MH(a,f.isBold),this.ki.setItalic(a,f.isItalic),this.ki.IY(a,f.PF),this.ki.Fjb(a,f.A_),this.ki.LY(a,f.iE),this.ki.Joa(a,f.Ow),this.ki.f0a(a,f.ht),this.ki.Jjb(a,
f.E_),this.ki.e6(a,f.QF),this.ki.KY(a,f.isSuperscript),this.ki.zya(a,f.en));this.ki.f0a(a,!1);this.wcl(a,b)}U7d(a){return this.Vea.cTa(a)}LW(a){return this.Vea.LW(a)}mTa(a){return this.JHa.mTa(a)}K8(a){return this.m$.K8(a)}wcl(a,b){b=b.Vz;if(null!==b&&b.Sa(kb.a.fKa)){b=b.eb(kb.a.fKa);var c=a.Vz;null===c?this.ki.Dm(a,kb.a.fKa,b):c.setValue(kb.a.fKa,b)}}zuh(a){return this.U$j&&a&&(a=a.paragraph)&&(a=this.Fa.$m(a))&&a.Rf?!0:!1}D7i(a){if(!this.e7c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;
var f=this.Fa.$m(c);if(!f)return null;a=f.sa(ab.a.Q_,[]);c=c.sa(ab.a.listLevel,Be.a.NEa);a&&0<=c&&c<a.length&&(f=f.Fh)&&(a=f.Be(a[c]))&&(a.Sa(kb.a.IZd)?b=a.eb(kb.a.IZd):a.Sa(kb.a.FZd)?b=a.eb(kb.a.FZd):a.Sa(kb.a.CZd)?b=a.eb(kb.a.CZd):a.Sa(kb.a.MZd)&&(b=a.eb(kb.a.MZd)));return b}}Object(m.a)(nO,"PPTFormattingStewardBridge",null,[1139]);class oO{constructor(a,b,c,f){this.jc=c;this.qA=f}}Object(m.a)(oO,"PPTFormattingStewardHelper",null,[1144]);class pO{constructor(a,b,c,f,l){this.Ack=[ab.a.$l,ab.a.eo];
this.la=a;this.uBb=b;this.Dyg=c;this.nJ=f;this.Qb=l;this.Fdb=a.Ikg;this.Gva=a.pptCopyPasteListMarkerEnabled;this.Iec=a.pptCopyPasteMarginAndIndentationEnabled}l3e(a){return this.uBb.gRj(a)}lbe(a,b){return this.uBb.eTi(a,b)}Foa(a,b,c,f=null,l=null){if(this.Dyg.ohd)if(this.uBb.Shg(c))a.setValue(Mc.a.cig,!0);else if(this.uBb.el(c)){if(this.Iec&&a&&b){var x=this.Qb.Nc(a);x.rc(11);x.Jg(11);c=rb.ListReader.uk(x);const H=this.nJ.H7i(a,x);x=this.nJ.E7i(a,x);c&&(f||(xa.a.J(41219841,826,50,"Default marginLeft for internal"),
b[ab.a.$l.id.toString()]=H),l||(xa.a.J(41219843,826,50,"Default textIndent for internal"),b[ab.a.eo.id.toString()]=x));f&&xa.a.J(41018240,826,50,"Customized marginLeft");l&&xa.a.J(41018242,826,50,"Customized textIndent")}this.Dyg.Foa(a,b)}if(this.la.HZc&&!Sb.ParagraphReader.YW(a))for(const H of this.Ack)void 0===a.Lh(H)&&a.we(H,0)}RLb(a,b,c){if(this.Fdb){var f=b.propertySet.Sa($a.a.Ri)?b.propertySet.eb($a.a.Ri).length:1;if(a=this.nJ.qQ(a,b.propertySet.sa(ab.a.listLevel,0)))if(this.Gva&&(0<c.ssb||
c.wQa&&0<c.wQa.length)){f="";b.H$a&&!b.nbg&&(f=c.font);let l=null;c.wQa&&0<c.wQa.length&&(l=c.wQa,1===c.wQa.length&&xa.a.J(41219847,826,50,"Customized bullet."));let x=-1;0<c.ssb&&(x=c.ssb,xa.a.J(41219849,826,50,"Customized number list."));this.nJ.aLc(a,b.propertySet);l&&b.propertySet.setValue($a.a.Ri,l);ha.a.Wa(f)||b.propertySet.setValue($a.a.font,f);0<x&&b.propertySet.setValue(kb.a.autonumberBulletType,x)}else a.sa($a.a.Ri,[]).length===f&&this.nJ.aLc(a,b.propertySet)}}sZc(a){return this.uBb.sZc(a)}get q_c(){return this.uBb.q_c}w1(a,
b){2===b.unit?(a.setValue(kb.a.jX,2),a.setValue(kb.a.ux,b.value)):xa.a.J(36779851,826,50,"the un-support text spacing unit")}ZKa(a,b){b.beforeSpacing.value&&(a.setValue(kb.a.aea,b.beforeSpacing.value),a.setValue(kb.a.qla,4));b.afterSpacing.value&&(a.setValue(kb.a.$da,b.afterSpacing.value),a.setValue(kb.a.pla,4))}Brh(a,b){const c=(new kv.a(b.unit,b.value)).UM;1===b.specialIndentType?a.setValue(ab.a.eo,c):2===b.specialIndentType?a.setValue(ab.a.eo,-c):0===b.specialIndentType&&a.setValue(ab.a.eo,0)}rqh(a,
b){b=(new kv.a(b.unit,b.value)).UM;a.setValue(ab.a.$l,b)}get Cuh(){return!0}}Object(m.a)(pO,"PPTPasteStewardBridge",null,[569]);class qO extends As{constructor(a,b){super(a,b)}R4b(){return["PasteSlide"]}}Object(m.a)(qO,"PasteSlideReactFloatie",As,[]);class rO{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze){this.Pag=!1;this.nR=[];this.Ygc=[];this.ope=[];this.Vre=0;this.oc=c;this.pa=f;this.Hfb=l;this.Gfb=x;this.Vma=H;this.Zc=U;this.xze=ae;this.qd=a;this.Ghk=b;this.Qk=Va;this.mek=
ja;this.Vb=hb;this.Ea=yb;this.Nr=Zb;this.d9j=fc;this.W8j=Kc;this.fc=Lc;this.XRg=Gc;this.Pb=we;this.N9c=$d;this.Zg=Ze;this.a0=Db.a.instance.ub("Common.IReactContextualUILauncher");this.qWa=Db.a.instance.ub("Common.IExternalUICommandDefinitionMapping")}D5(a){2===a.behavior&&(a=a.actionId,a!==K.a.gw&&a!==K.a.oCa&&a!==K.a.mna&&a!==K.a.z5&&a!==K.a.Yia&&a!==K.a.jQ&&a!==K.a.insertPicture&&a!==K.a.mna&&a!==K.a.ata&&a!==K.a.D4d&&a!==K.a.C4d&&a!==K.a.insertPicture&&a!==K.a.DQc&&a!==K.a.EQc&&a!==K.a.WKe&&a!==
K.a.qhd||this.qC(null,new zc(!0)))}C5(){}l7h(){this.xze&&!this.Pag&&(this.pa.wF(Object(F.a)(this,this.iY,"onSelectionChange")),this.Ghk.yd(7).vF(Object(F.a)(this,this.CB,"onChildTopologyChanged")),this.qd.VBa(Object(F.a)(this,this.qY,"onThumbnailDrawCompleted")),Id.a.addHandler(this.Vma.EU,"scroll",Object(F.a)(this,this.J_a,"scrollHandler")),Id.a.addHandler(this.Zg.contentWindow.document.body,ta.a.Yf,Object(F.a)(this,this.onKeyDown,"onKeyDown")),this.Zc.pb(ta.a.click,this.Vma.EU,Object(F.a)(this,
this.iC,"clickHandler")),u.AFrameworkApplication.Aa.mca(Object(F.a)(this,this.k1,"resizeHandler")),this.mek.h6a(Object(F.a)(this,this.T0,"onSlidePresenceChanged")),this.Qk.Euf(Object(F.a)(this,this.JIe,"onSlidesIdReturned")),this.d9j.HGc(Object(F.a)(this,this.Yfd,"onRevisionProcessedOnServerHandler")),this.W8j.L9h(Object(F.a)(this,this.hrk,"onBlockingHandler")),this.N9c.tPd(Object(F.a)(this,this.zvk,"onOnlyKeyPressed")),this.Pag=!0)}zvk(){if(FC.a.instance.keyCode===A.a.cba){const c=document.getElementById("PasteSlideControl");
if(c){var a=Od.a.$h(c),b=this.XRg.xa.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Sz.a.Z3e?xa.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Cc.a.s6a)||"",Cc.a.Iia===a&&c.click())}else xa.a.J(512497816,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===A.a.T1&&this.qC(null,new zc(!0))}hrk(a,b){1===b.block?this.qC(a,null):2===b.block&&this.qC(a,new zc(!0))}Yfd(a,b){b&&(a=b.taa)&&a.ActionInformation.ActionId!==""+K.a.vlc&&a.ActionInformation.ActionId!==
""+K.a.WHb&&a.ActionInformation.ActionId!==""+K.a.shd&&this.Nr.j1c&&this.Nr.j1c<parseInt(a.ActionInformation.ActionTime)&&this.qC(null,new zc(!0))}T0(a,b){this.bWf(b.slideId.sid,this.nR)&&(this.qC(null,new zc(!0)),this.Nr.nkb=!1)}bWf(a,b){for(const c of b)if(c.sid===a)return!0;return!1}JIe(a,b){if(b&&b.QYa){if(this.ope.length>=b.QYa.length&&!this.a0.Tka&&(this.setSelection(b.QYa),this.nR.length===b.QYa.length)){this.showFloatie({},new bj(1,u.AFrameworkApplication.isRtl));let c;(c=this.pa).e6a.apply(c,
this.nR)}this.Nr.AJa.length||(this.Nr.AJa=b.QYa,Array.clear(this.nR),Array.clear(this.Ygc))}}iY(a,b){if(this.Nr.nkb){for(a=0;a<b.EE.length;a++)if(Object(oa.a)(4,b.EE[a].context.node)){this.qC(null,new zc(!0));return}!this.Ea.Ae||this.Ea.Ae.name!==Qi.a.T2&&this.Ea.Ae.name!==Qi.a.kBf&&this.Ea.Ae.name!==Qi.a.hBf&&this.Ea.Ae.name!==zb.a.ME&&this.Ea.Ae.name!==zb.a.QI&&this.Ea.Ae.name!==zb.a.FW||this.qC(null,new zc(!0))}}k1(){this.a0.Tka&&this.qC(null,new zc(!1))}J_a(){this.sfh()}iC(){this.sfh();return!0}sfh(){if(this.Nr.nkb){const a=
new bj(1,u.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}qY(a,b){a=this.Nr.AJa;this.ope.push(b.Fd);if(!this.a0.Tka&&this.Nr.nkb&&a&&a.length>=this.Ygc.length&&b.succeeded)for(var c of a)if((b=this.oc.zl(new M.a(c)))&&!this.bWf(b.sid,this.Ygc)&&(this.Ygc.push(b),this.Vre++,b=a.length,this.Vre===b)){this.pa.zub();this.setSelection(a);var f=void 0;(f=this.pa).e6a.apply(f,this.nR);if(c=this.R9i())this.Vb.Ba=c;this.Vre=0;c=!0;for(f=0;f<b;f++)(a=this.nR[f].mg(this.Hfb))&&a.Jhb&&a.Jhb.M8()&&0<a.Jhb.M8().length&&
(c=!1);c&&this.showFloatie({},new bj(1,u.AFrameworkApplication.isRtl));break}}R9i(){let a=this.nR.length;if(!a&&(this.setSelection(this.Nr.AJa),a=this.nR.length,!a))return xa.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.nR[0];for(let c=1;c<a;c++)b.slideIndex>this.nR[c].slideIndex&&(b=this.nR[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.nR);for(const b of a)(a=this.oc.zl(new M.a(b)))?this.nR.push(a):xa.a.J(512497813,826,50,"Cannot find the slide")}}qbj(){let a=
this.nR.length;if(!a&&(this.setSelection(this.Nr.AJa),a=this.nR.length,!a))return xa.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;xa.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.nR[0];for(let c=1;c<a;c++)b.slideIndex<this.nR[c].slideIndex&&(b=this.nR[c]);return b}showFloatie(a,b){b.location=this.Lwb();if(b.location){const c=this.fc.$c(this.oc.Ym);if(!c||c&&a)xa.a.J(512497810,826,50,"ShowFloatie number"),this.Pb.ka("ReactSlidePasteFloatieEnabled")&&
(new qO(this.a0,this.qWa)).uYe(b.location,b.Hu),Array.clear(this.ope)}}qC(a,b){this.a0.Tka&&(this.a0.qC(),b&&(this.Nr.nkb=!b.n3d,b.n3d&&this.Nr.khb&&(a=this.Nr.khb.zA,null!=a&&xa.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",a.toString()))),this.Nr.nkb||(this.Nr.j1c=0)))}hwi(a){if(!this.Nr.S1b)return!0;a=a.bK;if(a.length!==this.Nr.S1b.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Nr.S1b[c])||!a[c]&&this.Nr.S1b[c])if(b++,b>this.Ygc.length)return!0;
return!1}CB(a,b){this.a0.Tka&&(a=Object(oa.a)(537,b.node))&&this.hwi(a)&&this.qC(null,null)}Lwb(){var a=this.qbj();if(!a)return xa.a.J(512497808,826,50,null),null;a=a.mg(this.Hfb);if(!a)return xa.a.J(512497807,826,50,null),null;a=Od.a.$h(a.llb);const b=a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Gfb.xa.style.height;var l=this.XRg.xa.style.height;l=parseInt(l.substr(0,l.length-2))+Sz.a.Z3e;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.qC(null,new zc(!1)),
null;this.Nr.position=new Sys.UI.Point(b,c);return this.Nr.position}}Object(m.a)(rO,"PasteFloatieHelper",null,[1143,141]);class VE{constructor(){this.nkb=!1;this.j1c=0;this.khb=null;this.XJe=0;this.yeb=[];this.position=this.S1b=null}get AJa(){return this.yeb}set AJa(a){a?this.yeb=a:Array.clear(this.yeb)}}Object(m.a)(VE,"PasteFromFloatieArgs",null,[]);var HR=d(1041);class sO{j9b(a){a=a.i8;return a===zb.a.sg||a===zb.a.XE||a===zb.a.MB}}Object(m.a)(sO,"PasteHandlerUtil",null,[1160]);class tO{constructor(a,
b,c,f,l,x){this.WT=0;this.ia=a;this.N4=b;this.KHa=c;this.wx=f;this.NCb=l;this.v$j=x}nQ(a){if(!this.KHa.j9b(this.N4.value))return!1;if(this.wx.AJj(a)){a=Array.isArray(a.QW)?a.QW:null;if(this.Dxj(a)&&!this.byj(a))return!1;this.WT=1}else if(this.NCb&&(this.wx.yJj(a)||this.wx.xJj(a))){a=this.wx.bje(a.Bu);if(!this.v$j&&a)return ia.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.WT=0,!1;this.WT=2}else this.WT=0;return 0!==this.WT}paste(a){1===this.WT?
this.ia.La(K.a.phd,2,a):2===this.WT&&this.ia.La(K.a.E9g,2,a)}Dxj(a){for(const b of a)if(!b.isConnected)return!0;return!1}byj(a){for(const b of a)if(a=b.shapeNode,!a.Fj&&!a.ud)return!0;return!1}}Object(m.a)(tO,"ShapePasteHandler",null,[1202]);class uO{constructor(a,b,c){this.WT=0;this.ia=a;this.wx=b;this.SWa=c}nQ(a){this.wx.Hgg(a)?this.WT=1:this.SWa&&this.wx.zJj(a)?this.WT=2:this.WT=this.wx.CJj(a)?3:0;return 0!==this.WT}paste(a){a.zA=null!=a.zA?a.zA:!0;Ud.a("UseClipServiceForDestinationThemePaste")&&
1===this.WT&&!a.zA&&a.Bu&&(this.WT=2);1===this.WT?this.ia.La(K.a.qhd,2,a):2===this.WT?(a.Bu?xa.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.zA):xa.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.La(K.a.shd,2,a)):3===this.WT&&this.ia.La(K.a.G9g,2,a)}}Object(m.a)(uO,"SlidePasteHandler",null,[1202]);class WE{constructor(a,b,c,f){this.Zvg=[lf.a.Zcg,lf.a.VNb,lf.a.GAh,lf.a.bsd];this.ia=a;this.Ea=b;this.KHa=
c;this.wx=f}nQ(a){if(!this.KHa.j9b(this.Ea)||WE.ARj(a)||this.wx.VWj(a))return!1;a.nQ=!this.mzi(a.un);return a.nQ}mzi(a){for(let b=0;b<this.Zvg.length;++b)if(0<a.getElementsByTagName(this.Zvg[b]).length)return!0;return!1}paste(a){xa.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");this.ia.La(K.a.$Je,2,a)}static ARj(a){if(!a||!a.un)return xa.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),!0;a=Hb.b(a.un);return a&&a.length?!1:(xa.a.J(17310406,
826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(m.a)(WE,"TextPasteHandler",null,[1202]);var IR=d(883),JR=d(957),KR=d(443),oA=d(677);class vO{constructor(a,b){this.Axa=a;this.pastedContent=b}}Object(m.a)(vO,"PasteContext",null,[]);class wO{constructor(a){this.Rxe=0;this.FFb=null;this.Jgk=a;this.xfb=this.Jgk.aGb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.xfb.start()}BYb(a){if(a&&0<a.length){this.FFb||(this.FFb={});const b=this.xfb.Vq;this.FFb[a]=
b-this.Rxe;this.Rxe=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.FFb){a=this.FFb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&xa.a.J(20570128,826,50,b);this.reset()}reset(){this.Rxe=0;this.FFb=null}}Object(m.a)(wO,"TimingLogger",null,[]);class Vp{constructor(){this.objectCount=0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=!1;this.selectionSlide=null}static DFi(a){if(!a)return null;
a=a.getData(Vp.$li);return Vp.aeg(Vp.nfh(a))}static EFi(a){return a?Vp.aeg(Vp.nfh(a.pptSlide)):null}static aeg(a){if(!a||0===a.contentType)return xa.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/Vp.Vli:Number.MAX_VALUE;a.skipUndo=!1;xa.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static aXj(a){return!!a&&
0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static nfh(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(Vp.aXj(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){xa.a.J(541405765,826,15,"ReadPicklingData exception occured in parsing")}return null}}Vp.Vli=1048576;Vp.$li="ppt/slides";Object(m.a)(Vp,"PicklingClipboardObject",null,[]);var LR=d(679);class Ah{constructor(a,b,
c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d){this.cxe=!1;this.kQg=0;this.QXa=null;this.qhc=!1;this.Qxe=null;this.Ywe=!1;this.N4=a;this.Zg=b;this.Jq=c;this.oGa=l;this.la=f;this.Bl=x;this.Lr=H;this.mea=this.Zg.contentWindow.document.body;this.Lr.addHandler(this.mea,ta.a.paste,Object(F.a)(this,this.KGe,"onBrowserPaste"));this.Rd=U;this.Po=ja;this.Xdc=yb;this.Xma=new wO(ya);this.Cla=hb;this.fgc=null;this.w7c=f.PVj;this.eEg=this.Po.bO(7);this.wx=Va;this.jO=Zb;this.QT=fc;this.Fa=Lc;this.jc=Kc;this.Cc=
Gc;this.u0=ae;this.ia=we;this.Cye=f.pptEditingImageMaxSizeInBytes;this.EGg=Math.floor(f.pptEditingImageMaxSizeInBytes*Ah.ezf);this.gec=f.Lgg;this.SWa=f.Mie;this.t6c=f.wKj;this.mTg=f.KSj&&this.Po.$W;this.qxe=this.p7c=!1;this.NCb=f.Lie;this.qec=f.Uhg&&this.Po.vo;this.$fk=f.S$i&&this.Po.eg;this.b5j=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&this.Po.Aua;this.I6c=this.la.bNj;this.LL=$d}dispose(){this.Zg&&this.Lr.removeHandler(this.mea,ta.a.paste,Object(F.a)(this,this.KGe,"onBrowserPaste"));this.Xma=
this.Zg=null}oDk(a){a===this.Qxe.Wb&&this.ia.La(K.a.ulc,2,this.Qxe)}KGe(a){const b=this.Cc.hP(2,0,"OnBrowserPaste");this.Xma.start();this.p7c=this.Ywe=!1;if($k&&$k.EA&&!$k.EA.v2d){!this.Po.RF||this.Po.Tj||this.b5j?lf.a.JJc(this.Zg):this.oGa.O_a(this.Zg);var c=this.QT.ida(a);c=this.wx.r_c()?Vp.DFi(c):null;var f=new CE;f.k0d=a;f.Abh=b;null!=this.QXa&&(this.Cc.Zh(Ah.sBf,"menu",b),this.Cc.Zh(Ah.qBf,this.QXa?Ah.dmi:Ah.bmi,b));this.qhc&&(this.Cc.Zh(Ah.sBf,"menu",b),this.Cc.Zh(Ah.qBf,Ah.cmi,b));!this.qhc&&
c&&this.t9g(c,null,b,K.a.rhd,f)?this.QXa=null:(this.s9g(a,b),this.QXa=null,this.qhc=!1)}}s9g(a,b){var c=this.QT.ida(a);const f=this.QT.aUf(c);this.Cc.qWe(f,b);if(!this.zyl(a,b)){var l=Object.assign(new Om.a(!0),{Wb:b,zA:this.QXa}),x=null;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",!1)&&document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")&&(xa.a.J(509669642,826,50,"Getting html from dom event for slide sorter"),
(x=a=this.QT.C5b(c))||(x=c.getData("text/plain")));this.$fk&&(xa.a.J(512356507,826,50,"OnBrowserPaste::Getting html data from Clipboard"),c=this.QT.C5b(c),a=this.QT.qZa(c),c?(this.DEf(a)&&(this.Jq.Yq[0].g7a=a.firstChild.className,l.QW=null),l.un=a):xa.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.Qxe=l;Tc.a.Faa(()=>{this.jGe(void 0,l,x)},0,this.la.dRj?0:2)}}Mqi(a){let b=!1;$k.EA.Z6a(c=>{xa.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",c);null!=c&&c&&(b=
this.Tqi(a))});return b}Tqi(a){const b=Date.now();let c=!1;$k.EA.ida(this.Zg,a,f=>{xa.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-b));if(f){if(!a)f.html&&f.html.length<=Ah.Umi?-1!==f.html.indexOf(Ah.nni)&&(c=!0):f.pptSlide&&f.pptSlide.length&&(c=!0);else if(f.img||f.isImageAvailable)c=!0;c&&(f=[],a?(f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.hni,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.gni,
!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.fni,!1))):(f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.wmi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.pni,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.ymi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.rni,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.xmi,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(Ah.qni,!1))),
appChrome.api.dispatch(f));xa.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",c,Date.now()-b)}else xa.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});return c}t9g(a,b,c,f,l){b||(b=Object.assign(new Om.a(!0),{Wb:c,zA:this.QXa}));b.wM=a;this.Cc.Zh(Ah.objectCount,a.objectCount.toString(),c);this.Cc.Zh(Ah.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),
c);this.Cc.Zh(Ah.ini,(b.wM.packageSize?null==b.wM.packageSize?0:b.wM.packageSize/Ah.ezf:b.wM.dataSize).toString(),b.Wb);return 0!==b.wM.errorInCopying?(xa.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.wM.ccpid,b.wM.objectCount,b.wM.errorInCopying),this.ovh(b.wM.errorInCopying,f,l,b),!0):this.wx.FRj(b.wM.dataSize)?this.Q_d(b):(xa.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.wM.ccpid,
b.wM.dataSize,b.wM.objectCount),this.ovh(1,f,l,b),!0)}ovh(a,b,c,f){switch(a){case 1:this.Cc.Hg(!1,f.Wb,27);this.LL.fga(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,Ah.rBf);break;default:this.Cc.Hg(!1,f.Wb,28),this.LL.fga(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,Ah.rBf)}}rhd(a,
b){xa.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.Cc.hP(2,0,"PasteSlideAsImage");this.Cc.Zh("PasteSlideAsImage",b,c);this.Xma.start();this.p7c=this.Ywe=!1;this.s9g(a,c)}Xri(a){a=a.split("+");const b=this.jc.kg(this.Jq.Yq[0].Fd).Cb;return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}zyl(a,b){let c=!1,f=this.qhc;var l=this.QT.V5d(a.rawEvent,this.Zg.contentWindow);if(l){let x=null;({v8b:x,x0g:l}=this.QT.Etd(l,this.la.clipboardDataImageBlobNumberLimitaton,this.gec?50*Ah.xLh:this.EGg));
this.Xma.BYb("GetBlob");0<l&&(xa.a.J(512356498,826,50,"Blob is too large"),this.Cqd(b),c=!0);x&&1===x.length&&(Tc.a.Faa(()=>{this.Boi(x,b,f)},0),this.mTg&&a.preventDefault(),c=!0)}else this.w7c&&this.eEg&&(this.fgc=this.Cla.czl(a.rawEvent));c&&this.Cc.KB(5,b);return c}Boi(a,b,c){if(c||a&&(this.QT.cvd(this.mea)||this.mTg)){const f=a[0],l=Tc.a.Ib;Tc.a.zk(ni.a.nii,f.size.toString());this.gec&&f.size>=this.EGg?(this.qxe&&xa.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),this.Xdc.Kpg(f,x=>
{Tc.a.AF(l,()=>{x&&this.Uml(x,f.size,b)||(this.p7c=!0,this.jGe(b));this.qxe=!1})}),this.qxe=!0):(new IR.a).JDh(a,x=>{Tc.a.AF(l,()=>{this.qaj(x,b)})})}else this.jGe(b)}qaj(a,b){this.Xma.BYb("GetDataUrl");this.Izl(a,b)||(xa.a.J(512356496,826,15,"Paste image data uri failed"),this.paste(Object.assign(new Om.a(!0),{Wb:b}),null,!1))}jGe(a="",b=null,c=null){this.paste(b||Object.assign(new Om.a(!0),{Wb:a}),c,!1)}zDk(a,b){if($k.EA){xa.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",
a.Wb);var c=Date.now();$k.EA.ida(this.Zg,a.G8a,f=>{a.G8a&&(f.html=null,f.pptSlide=null,f.text=null);this.C1j(f,c);if(f=Vp.EFi(f)){var l=new DE;l.pastedContent=b;l.Axa=a;this.t9g(f,a,a.Wb,K.a.F9g,l)}else this.paste(a,b,!0)})}}C1j(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;xa.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-b,
c,f,l,a)}else xa.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.aX)this.u0.show(5,-1),this.Cc.Hg(!1,a.Wb,26);else if(a.hUf)this.mbe(a,b);else if($k.EA){var f=this.Po.wT&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.zYc&&!f||this.qec?(a.wM=null,this.wx.r_c()&&!c?this.zDk(a,b):(xa.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.qec,this.la.zYc),this.lTe(a,b))):(this.QXa=a.zA,this.qhc=
a.G8a,this.wx.r_c()&&$k.EA.Txl(this.Zg,a.Wb)?(this.Cc.Zh(Ah.IDk,"true",a.Wb),this.Cc.Hg(!0,a.Wb)):(this.QXa=null,({content:b}=$k.EA.paste(this.Zg,this.N4.value,a.Wb,!1)).returnValue?this.mbe(a,b):($k.EA.Wca(!1),b=$k.EA.iy,null==b?(a=new Xh.a(null,Object(F.a)(this,this.MVi,"fWaitForAsyncAPIResult"),Object.assign(new JE,{rd:a.Wb})),a.Pl("ClipboardPreProcessForAsyncAPI"),a.run()):null!=b&&b&&this.lTe(a,null))))}else this.Cc.Hg(!1,a.Wb,1)}MVi(a,b){a=$k.EA.iy;if(null==a)return!0;b=b.rd.toString();a?this.lTe(Object.assign(new Om.a(!1),
{Wb:b}),null):this.Cc.Hg(!1,b,29);return!1}lTe(a,b){this.kQg=Date.now();this.cxe=!1;$k.EA.prepareForPaste(a.G8a,c=>{this.Cc.Zh("isPasteFromAsyncApi",c.toString(),a.Wb);this.cxe=!0});b=new vO(a,b);(new Xh.a(null,Object(F.a)(this,this.prepareForPaste,"prepareForPaste"),b)).run()}YJe(a,b){return a&&0<a.length?(a=Object.assign(new Om.a(!0),{Wb:b,hde:a,pPc:!0}),this.Q_d(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.cxe){let f;({content:f}=$k.EA.paste(this.Zg,this.N4.value,b.Axa.Wb,b.Axa.G8a)).returnValue&&
f?this.mbe(b.Axa,f):c=!0;a=!1}else Date.now()-this.kQg>this.la.MEf&&(xa.a.J(512356491,826,50,null),a=!1,c=!0,$k.EA.reset());c&&this.Cc.Hg(!1,b.Axa.Wb,29);return a}get Bhl(){return this.Po.Ej&&this.la.dKj}mbe(a,b){if(!a.un)if(xa.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.Skg&&this.Bhl)if(this.eil()){b=lf.a.RA();b.src=this.fgc;this.fgc=null;var c=lf.a.Ie();c.appendChild(b);a.un=c}else this.DEf(this.mea)&&(xa.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),
this.Jq.Yq[0].g7a=this.mea.firstChild.className,a.QW=null),xa.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.un=this.mea;else xa.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=lf.a.Ie(),JR.a.Kod(c,b,"PasteManager"),a.un=c;this.QSd(a);b=this.wx.tMj(a.un.firstChild);c=this.wx.wMj(a.un.firstChild);if(b||c)xa.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",
b,c),this.Cc.Hg(!0,a.Wb);else if(this.VYi(a.un),b=a.un.innerHTML.startsWith("<img"),c=a.un.innerHTML.length,a.hUf&&b&&(this.Xma.BYb("ConvertDataUrlToDOMNode"),this.Xma.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.Po.Sy,c,this.Ywe))),!c&&this.p7c)this.Cqd(a.Wb);else{var f=0,l=!1;({uVd:f,y2d:l}=this.xyl(a));1===f?(xa.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.Cc.Hg(!1,a.Wb,25)):!a.QW&&!a.Bu&&c>this.Cye?(Ud.a("PasteManagerOacr73010Fix")?
(this.Zg.contentWindow.document.body.innerText="",a.un.innerText=""):(this.Zg.contentWindow.document.body.innerHTML=null,a.un.innerHTML=null),b?(xa.a.J(512356484,826,50,"Image too large"),this.Cqd(a.Wb)):(xa.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",c)),this.Cc.Hg(!1,a.Wb,7))):(a.Bu?(xa.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.zA),this.Cc.Zh(vp.a.Gp,a.Bu.Gp,a.Wb)):xa.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),
this.Q_d(a))}}QSd(a){a?a.un?a.un.firstChild?a.un.firstChild.getAttribute||xa.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):xa.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):xa.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):xa.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}DEf(a){if(!(this.t6c&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&
a.firstChild.getAttribute(vp.a.type)&&a.firstChild.getAttribute(vp.a.ekb)&&this.Jq.Yq))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(vp.a.sessionId).toString()===this.Jq.Yq[0].sessionId&&b.startsWith("CID")&&b!==this.Jq.Yq[0].g7a&&(Object(Xa.a)(oA.a,this.Jq.Yq[0])&&"shape"===a.firstChild.getAttribute(vp.a.type).toString()&&this.Vri(a.firstChild.getAttribute(vp.a.ekb).toString())||Object(Xa.a)(Mv.a,this.Jq.Yq[0])&&"slide"===a.firstChild.getAttribute(vp.a.type).toString()&&
this.Xri(a.firstChild.getAttribute(vp.a.slideId).toString()))}Vri(a){a=a.split(",");let b=0;if(a.length!==this.Jq.Yq.length)return!1;for(const c of a)for(const f of this.Jq.Yq)if(c===this.Fa.wxb(f.shapeNode).toString()){b++;break}return b===a.length}Q_d(a){let b=!1;for(let c=0;c<this.Bl.length;c++)if(this.Bl[c].nQ(a)){b=!0;this.Bl[c].paste(a);break}b||this.Cc.Hg(!1,a.Wb,19);return b}Uml(a,b,c){if(a){const f=new LR.a("ShrinkImage",!0);a=this.Xdc.nwh(a,b,this.Cye);f.stop();if(a)return this.Xma.BYb("LoadAndShrinkImage"),
this.Xma.flush(String.format("Browser={0}, Length={1}",this.Po.Sy,a.length)),Tc.a.zk(ni.a.JBj,f.Laa.toFixed(0)),Tc.a.zk(ni.a.IBj,f.WNc.toFixed(0)),Tc.a.zk(ni.a.KBj,a.length.toString()),this.YJe(a,c)}return!1}VYi(a){this.I6c&&a&&(a=a.ownerDocument)&&(a=a.getElementById(vp.a.vdg))&&a.parentNode&&a.parentNode.removeChild(a)}xyl(a){let b,c;b=0;c=!1;if(a&&a.un&&a.un.firstChild&&a.un.firstChild.getAttribute){var f=a.un.firstChild;const l=f.getAttribute(vp.a.Gp),x=this.Jq.Yq;if(x&&0<x.length&&x[0]&&Sys.UI.DomElement.containsCssClass(f,
x[0].g7a)){let H=!1;(this.SWa&&Object(Xa.a)(Mv.a,x[0])||this.NCb&&Object(Xa.a)(oA.a,x[0]))&&this.SOj(x)&&(this.AKj(l)?H=!0:(a.r7g=!1,xa.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",a.Wb)),xa.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Wb,H));if(H)xa.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",
a.Wb),this.Jq.Yq=null;else if(xa.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Wb),a.QW=x,!Ud.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,uVd:b,y2d:c}}else xa.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.Wb);f=this.wx.BUi(f,a.Wb);b=f.NQa;c=1===f.dataType;if(this.wx.MWj(f)&&void 0!==f&&null!==f&&32===f.sW)return a.Bu=f,xa.a.J(512356443,826,
50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.zA),{returnValue:!0,uVd:b,y2d:c};xa.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",f?f.toString():"(null)")}xa.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,uVd:b,y2d:c}}Izl(a,b){let c=!1;if(this.Cla.Bmg(a))if(a.length>=this.Cye)this.Cqd(b),c=!0;else{if(a=this.Cla.Nyl(a))this.Xma.BYb("ExtractDataUri"),
this.Xma.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.Po.Sy,a.length));c=this.YJe(a,b)}return c}SOj(a){for(const b of a)if(b.qkg)return!0;return!1}AKj(a){if(this.jO.$ie)return xa.a.J(512356439,826,50,"Cannot predict copy result due to incompletion"),!1;xa.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.jO.Aog);return!!a&&a!==this.jO.Aog}Cqd(a){this.Cc.Hg(!1,a,18);this.Rd.cH(60,null)}eil(){let a=!1;if(this.fgc&&0<this.fgc.length&&this.eEg){const b=this.mea.getElementsByTagName(lf.a.W8);
if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}xa.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}Ah.xLh=1048576;Ah.ezf=.75;Ah.Umi=5E3;Ah.IDk="PasteViaTriggeringEvent";Ah.objectCount="ObjectCount";Ah.isDataCompressed="IsDataCompressed";Ah.ini="PastedObjectDataSize";Ah.qBf="ActionName";Ah.sBf="CcpMethod";Ah.dmi="PasteKeepingSourceFormatting";Ah.bmi="PasteKeepingDestinationTheme";Ah.cmi="PasteAsImage";
Ah.nni='data-clipservice-type="slide"';Ah.wmi="ContextMenu.PasteKeepingDestinationTheme";Ah.pni="ContextMenu.PasteKeepingSourceFormatting";Ah.ymi="PasteKeepingDestinationTheme";Ah.rni="PasteKeepingSourceFormatting";Ah.xmi="PasteKeepingDestinationThemeMLR";Ah.qni="PasteKeepingSourceFormattingMLR";Ah.rBf=20;Ah.hni="PasteAsImageSLR";Ah.gni="PasteAsImageMLR";Ah.fni="ContextMenu.PasteAsImage";Object(m.a)(Ah,"PasteManager",null,[1159,106]);class xO{constructor(a,b){this.Fug=a;this.Ha=b}uql(a,b,c,f,l){this.Fug.E1(this.Ha.usi,
a,b,c,this.Ha.vsi,this.Ha.wsi,this.Ha.xsi,f,l)}Epi(a){this.Fug.Dpi(a)}}Object(m.a)(xO,"PastedDataUploader",null,[1155]);class XE{static create(a){const b=new XE;b.jmg=Pr.b(a,c=>c.isEditable);return b}}Object(m.a)(XE,"ShapeCopyPasteParams",null,[]);class yO{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze){if(!a)throw Error.argumentNull("selectionManager");if(!b)throw Error.argumentNull("clipboardTarget");if(!c)throw Error.argumentNull("lazyFocusManager");if(!l)throw Error.argumentNull("internalClipBoard");
if(!f)throw Error.argumentNull("activeSlideViewManager");if(!x)throw Error.argumentNull("ccpUtils");if(!H)throw Error.argumentNull("clipboardHelper");if(!U)throw Error.argumentNull("clipServiceManager");if(!ja)throw Error.argumentNull("actionManager");if(!ya)throw Error.argumentNull("htmlExportProcessor");if(!Va)throw Error.argumentNull("htmlExportUtils");if(!Lc)throw Error.argumentNull("shapeReader");if(!Gc)throw Error.argumentNull("clipboardTelemetry");if(!we)throw Error.argumentNull("pptFileReaderHelper");
if(!Te)throw Error.argumentNull("systemClipboard");if(!Ze)throw Error.argumentNull("browserHelperManager");if(!ae)throw Error.argumentNull("deferredContentManager");this.pa=a;this.Zg=b;this.N4=c;this.Jq=l;this.Ldc=f;this.Cla=x;this.wx=H;this.jO=U;this.ia=ja;this.s9j=ya;this.t9j=Va;this.hec=hb;this.mec=yb;this.u6c=Zb;this.twe=fc;this.eIa=Kc;this.Fa=Lc;this.Cc=Gc;this.yw=ae;this.sgc=we;this.ZBg=$d;this.wFb=Te;this.oGa=Ze}nQ(a){const b=this.pa.tg();let c=!1;b&&0<b.length&&this.N4.value.i8===zb.a.sg&&
(a.dataType=2,c=a.kua?this.QUi(b):!this.pa.tUa());return c}QUi(a){let b=!0;for(const c of a){if(c.i0c&&!c.isLocal)return!0;c.DC||(b=!1)}return b}Bsa(a){u.AFrameworkApplication.hk("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.pa.tg();if(!b||!b.length)return this.Jq.Yq=null,!1;var c;let f=({contentType:c}=this.Cla.JTd(b)).returnValue;this.Cc.KB(c,a.Wb);a.kua?({ckb:f,returnValue:c}=this.WNi(b,a.Wb,f),f="Cut:"+f):({ckb:f,returnValue:c}=this.TNi(b,
a.Wb,f),f="Copy:"+f);this.yw.Mbe(b,"DoCutCopy")&&(xa.a.J(509210822,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.kua?this.yw.qra("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.yw.qra("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));xa.a.J(509210821,307,50,f);return c}WNi(a,b,c){let f=!0,l=[];for(const x of a)x.i0c&&l.push(x),x.DC||(f=!1);l=f?a:l;b=({ckb:c}=this.YJh(l,l,!0,!0,c,b,f)).returnValue;this.RIf(l);this.mec&&this.UIf(a);return{returnValue:32===
this.ia.La(K.a.dMf,2,b),ckb:c}}TNi(a,b,c){if(this.hec&&this.kLj(this.bjj(),a))return{returnValue:!0,ckb:c};const f=[];for(const l of a)l.i0c&&f.push(l);b=({ckb:c}=this.YJh(a,f,this.hec,!1,c,b)).returnValue;b.Bu&&this.ia.La(K.a.TIf,2,b);this.RIf(a);this.mec&&this.UIf(a);return{returnValue:32===this.ia.processAction(K.a.SIf,2),ckb:c}}kLj(a,b){if(!this.jO.$ie||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}tjl(a){if(!a.length)return!0;
let b=0,c=0;for(let f=0;f<a.length;f++){const l=a[f];if(l.isLocal)return!0;!l.Fj||l.get_isSVGBlipFilled()||l.isGif||b++;l.ud&&c++}return this.u6c?c===a.length:b+c===a.length}Kaj(a){const b=[];for(const c of a)c&&(a=new oA.a(c),a.sessionId=this.eIa,b.push(a));return b}bjj(){const a=[];if(this.Jq.Yq&&this.Jq.Yq.length)for(const b of this.Jq.Yq){const c=Object(oa.a)(oA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}YJh(a,b,c,f,l,x,H=!1){let U=new Wx(null,x,null);this.Jq.Yq=this.Kaj(a);
!c||this.tjl(b)?(c&&(xa.a.J(509210820,307,50,"Clip service shapes cut/copy is throttled"),this.Cc.Zh(pu.a.NFf,"true",x)),this.wx.Rvd(this.Zg,this.Jq.Yq,null,this.eIa,this.s6f(a),null,x)):(this.Cla.pxh(b),c=this.jO.qLc(2,b.length,f,H),c.Cjc=XE.create(b),this.twe&&this.yw.Mbe(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.NQa=1,c.sW=8),this.Cc.Zh(pu.a.Gp,c.Gp,x),l+=String.format(", CcpId={0}",c.Gp),this.wx.Rvd(this.Zg,this.Jq.Yq,c,this.eIa,this.s6f(a),null,x),U=new Wx(c,x,b));return{returnValue:U,
ckb:l}}s6f(a){const b=[];for(const c of a)Array.add(b,this.Fa.wxb(c));return b}RIf(a){for(const b of a)b&&b.Fj&&(a=Kj.c(b,this.Ldc.Ic.Ma))&&!a.Al&&(a=a.aQa)&&(a=this.ZBg?this.pnj(a):a.getAttribute(Pk.a.JWc))&&(this.ZBg?this.eaj(a,b):this.wwf(a.toString(),b))}eaj(a,b){try{fetch(a).then(c=>{c.blob().then(f=>{this.sgc.jfh(f,l=>{this.wwf(l.target.result,b);this.oGa.O_a(this.Zg);this.wFb.copy(this.Zg)})}).catch(f=>{xa.a.J(509207576,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in getting blob from response: {0}",
f.toString())})}).catch(c=>{xa.a.J(509207575,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob from url: {0}",c.toString())})}catch(c){xa.a.J(509210634,826,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob: {0}",c)}}pnj(a){if((a=a.querySelectorAll("image"))&&a.length&&(a=a[0].getAttribute("href")))try{if("blob:"===(new URL(a)).protocol)return a}catch(b){xa.a.J(509207881,826,10,"Exception {0} while converting to URL.",b)}return null}wwf(a,b){let c=
lf.a.RA();c.src=a;b.get_shapeRotation()||this.Cla.Kal(c,b.rx,b.HC);c.className+=this.Jq.Yq[0].g7a;this.Zg.contentWindow.document.body.appendChild(c)}UIf(a){(a=this.t9j.z1i(a,b=>!!b&&b.ud))&&0<a.length&&(a=this.s9j.A1i(a))&&this.Zg.contentWindow.document.body.appendChild(a)}}Object(m.a)(yO,"ShapeCutCopyHandler",null,[1201]);class es{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb){this.Zg=b;this.N4=c;this.Jq=f;this.ua=l;this.ia=x;this.wx=H;this.jO=U;this.v6c=ja;this.twe=ya;this.pa=a;this.eIa=Va;this.Cc=
hb;this.yw=yb}nQ(a){var b=this.N4.value.i8;if(b=!!this.ua.Ba&&!!b&&b===Qi.a.PD||b===zb.a.sg&&!this.pa.Wd().length||b===zb.a.MB)a.dataType=1;return b}Bsa(a){this.Cc.KB(19,a.Wb);return this.$Ii(a)}get Lb(){return this.pa}$Ii(a){var b=this.Lb.Qe();if(!b||!b.length)return this.Jq.Yq=null,ia.ULS.sendTraceTag(512497806,826,10,"Tried to copy slides but no slides were selected."),!1;var c=es.g0f(b,!0);if(!c.length)return a=this.K6f(b).join(","),ia.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",
a),!1;b.length!==c.length&&(b=es.g0f(b,!1),b=this.K6f(b).join(","),ia.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=es.getSlides(this.Jq),l=es.iEi(this.eIa,c);this.Jq.Yq=es.Nvl(l);b=(b=c[0])?b.Cb:null;const x=this.yw.Cxj(c);this.v6c?this.aYe(f,l)?(xa.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.Wb),this.Cc.Zh(pu.a.NFf,"true",a.Wb)):(f=this.jO.qLc(1,c.length,a.kua),c=new zE.a(f,
a.Wb,c),this.Cc.Zh(pu.a.Gp,f.Gp,a.Wb),l=8,x?this.twe&&(f.NQa=1,f.sW=8):a.kua||(l=this.ia.La(K.a.gXd,2,c),f.sW=l),this.wx.Rvd(this.Zg,this.Jq.Yq,f,this.eIa,null,b,a.Wb),!x&&a.kua&&(l=this.ia.La(K.a.eMf,2,c)),xa.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",a.kua,f.sW,f.Gp),a.kua?this.yw.qra("DeferredSlideCutStatus",f.sW.toString()):this.yw.qra("DeferredSlideCopyStatus",f.sW.toString())):(this.wx.Rvd(this.Zg,this.Jq.Yq,null,this.eIa,null,b,a.Wb),xa.a.J(576745568,
307,15,"Clip service has been disabled. CcpCorId: {0}",a.Wb));return!0}K6f(a){return Mj.c(a,b=>b?b.Cb.toString():null)}aYe(a,b){if(!b||!b.length||es.mfi(b))return!0;if(this.jO.$ie){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!es.Efi(a[c],b[c]))return!1;return!0}return!1}static g0f(a,b){const c=new Ka.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.Yq||!a.Yq.length)return b;for(let c=0;c<a.Yq.length;c++)b.push(Object(oa.a)(Mv.a,
a.Yq[c]));return b}static Efi(a,b){return!a&&!b||!!a&&!a.Fd&&!!b&&!b.Fd||!!a&&!!a.Fd&&!!b&&!!b.Fd&&(!a.Fd.id&&!b.Fd.id||!!a.Fd.id&&!!b.Fd.id&&a.Fd.id.equals(b.Fd.id))}static mfi(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].Fd&&!M.a.ix(a[b].Fd.Cb))return!1;return!0}static Nvl(a){const b=[];for(const c of a)b.push(c);return b}static iEi(a,b){const c=[];for(const f of b)c.push(Object.assign(new Mv.a(f),{sessionId:a}));return c}}Object(m.a)(es,"SlideCopyHandler",null,[1201]);class zO{constructor(a,b,c,
f){this.Vla=this.rue=!1;this.lXb=null;this.oGa=a;this.Wgk=b;this.Kcc=c;this.Cc=f}get KM(){this.lXb||(this.lXb=this.Wgk.create());return this.lXb}get v2d(){return this.Vla}Wca(a){this.KM.Wca(a)}Z6a(a){this.KM.Z6a(a)}get X5(){return this.KM.X5}get iy(){return this.KM.iy}prepareForPaste(a,b){this.Vla=!0;this.KM.prepareForPaste(b,a,this.Kcc.uCa.contentWindow.document)}ida(a,b,c){this.Vla=!0;this.KM.ida(a,b,c);this.Vla=!1}reset(){this.Vla=!1}Txl(a,b){if(!this.NLa(a,b))return!1;try{const c=a.contentWindow.document;
let f=c.body;Ca.a.Au(f);this.KM.v8a(c,f);return!0}catch(c){xa.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.tf(zb.a.sg);if(!this.NLa(a,c)&&(null==this.iy||null!=this.iy&&!this.iy))return{returnValue:!1,content:f};b=a.contentWindow.document;let l=b.body;this.Vla=!0;Ca.a.Au(l);let x=!1;try{this.oGa.O_a(a),l=this.KM.v8a(b,l),f=l.innerHTML,x=!0}catch(H){this.l7b(c)}this.Vla=!1;return{returnValue:x,
content:f}}copy(a){a.contentWindow.focus();this.Vla=!0;let b;try{this.KM.YOc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Vla=!1;return b?!0:!1}NLa(a,b){if(this.rue)return!0;this.Vla=!0;let c=!1;try{c=this.KM.NLa(a.contentWindow.document.body,()=>{Ca.a.Au(a.contentWindow.document.body)},()=>{this.oGa.O_a(a)})}catch(f){}this.Vla=!1;c?this.rue=!0:B.a.Ej||null==this.iy||this.iy||this.l7b(b);return c}l7b(a){this.rue=!1;uq.instance.Utb(null,null);this.Cc.Hg(!1,a,29)}}Object(m.a)(zO,"SystemClipboard",
null,[1156]);class AO{constructor(a,b,c,f,l,x,H,U){this.Qwe=!0;this.wyg=!1;l.pptOfflineModeEnabled&&a.tGc(Object(F.a)(this,this.gHb,"onNetworkHealthStateChanged"));this.rt=b;this.ia=c;this.u0=f;this.la=l;this.KO=x;this.UL=H;this.ua=U;this.GG=0;this.Edb=!1;this.q3c=0;this.VFg=new Date}get status(){return this.GG}gHb(a,b){this.Qwe=b.YZc;this.wyg||this.dqh(this.Qwe,"NetworkHealthStateChanged")}KXf(a){this.wyg=!a;this.Qwe&&this.dqh(a,"PodSeamlessFailoverManager")}dqh(a,b){a&&this.Edb&&(this.u0.erc=!1,
this.GG=1,this.KO.HH());const c=!a,f=this.q3c+1;gm.a.instance.Db(new af.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.Mjb(c,f)},90,"107"));this.q3c++;ia.ULS.sendTraceTag(41272025,813,50,gl.c({["Current state"]:this.Edb.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}Mjb(a,b){this.q3c===b&&this.Edb!==a&&(this.u0.erc=a,a&&3!==this.ia.mode||((this.Edb=a)?(this.GG=2,this.KO.HH(),this.UL.WW(this.ua.presentation)&&
this.u0.show(0,-1)):(this.GG=0,this.u0.dismiss(),this.KO.HH()),this.rt.Mjb(a),ia.ULS.sendTraceTag(41272026,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.q3c,Tc.a.nf(this.VFg)),this.VFg=new Date))}}Object(m.a)(AO,"PPTOfflineManager",null,[1175]);class BO{Arc(a,b,c){BE.a(a,b,c)}}Object(m.a)(BO,"WarningDialogProxy",null,[1153]);var MR=d(279);class dy extends Zh.a{constructor(a,b,c,f,l,x,H,U,ja){super();this.P4c=!1;this.icc=null;
this.Wdb=0;this.b8c=this.Zec=this.Z7c=this.W7c=this.H$c=this.f8c=this.p4c=this.Hbd=this.mXa=this.cye=this.uye=this.E0=this.M4=null;this.Pma=a;this.rfc=b;this.oJ=c;this.gbk=f;this.V4j=l;this.b8j=ja;this.Ea=x;this.qTg=U;this.oc=H}dispose(){this.cye=this.uye=this.E0=this.M4=null;super.dispose()}lvh(a){this.IFh();this.Zi(a,Object(F.a)(this,this.WQi,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}koh(a){if(a)for(let b=0;b<this.mXa.length;b++){const c=document.getElementById(this.mXa[b]);if(parseInt(c.getAttribute("LayoutId"))===
a){this.aLb(c);break}}}pu(){super.pu();lf.a.Ie().appendChild(this.kEi());const a=document.getElementById(this.Nh("WACDialogPanel"));a&&a.removeAttribute(Cc.a.Fra)}AA(){super.AA();var a=document.getElementById(this.Nh("WACDialogPanel"));a.style.width=lf.a.Pc(532);a=parseInt(Ef.a.Vt(a).top);this.M4.style.height=lf.a.Pc(Math.min(Math.max(0,xi.a.DU-a-100),398));this.rg=this.M4.parentNode.innerHTML}X7(){super.X7();this.uye=document.getElementById("MasterId");this.cye=document.getElementById("LayoutId");
this.Zec=Object(F.a)(this,this.Bbb,"keyPressHandler");u.AFrameworkApplication.Aa.qG.Pkd(ta.a.Yf,window.document,this.Zec,null);this.W7c=Object(F.a)(this,this.pZj,"layoutClickHandler");this.Z7c=Object(F.a)(this,this.qZj,"layoutDoubleClickHandler");this.b8c=Object(F.a)(this,this.sZj,"layoutOnFocus");for(let a=0;a<this.mXa.length;a++){const b=document.getElementById(this.mXa[a]);this.yn.pb(ta.a.click,b,this.W7c);this.yn.pb(ta.a.doubleClick,b,this.Z7c);Id.a.addHandler(b.firstChild,"focus",this.b8c)}}tsa(){super.tsa();
this.Zec&&u.AFrameworkApplication.Aa.qG.c4e(ta.a.Yf,window.document,this.Zec);this.Zec=null;for(let a=0;a<this.mXa.length;a++){const b=document.getElementById(this.mXa[a]);this.yn.yb(ta.a.click,b,this.W7c);this.yn.yb(ta.a.doubleClick,b,this.Z7c);Id.a.removeHandler(b.firstChild,"focus",this.b8c)}this.b8c=this.Z7c=this.W7c=null}kEi(){if(this.M4)return this.M4;this.M4=lf.a.Ie();this.M4.id="LayoutPickerDiv";this.M4.className="LayoutPicker";this.Wdb=0;this.mXa=[];var a=this.rfc.length;if(!a||1===a&&!this.rfc[0].InContent)return xa.a.J(509654401,
822,10,"Legacy LayoutDialog:: Master not loaded."),this.M4;var b=0;let c=!1;for(var f=0;f<a;f++)this.rfc[f].Id===this.gbk&&(b=f,c=!0);c&&this.hsf(this.rfc[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.hsf(this.rfc[f],1!==a);a=lf.a.cKf();a.id="MasterId";a.type="hidden";b=lf.a.cKf();b.id="LayoutId";b.type="hidden";this.M4.appendChild(a);this.M4.appendChild(b);return this.M4}hsf(a,b){a.InContent&&this.oJ.Hb(a.Id)&&(b&&this.M4.appendChild(this.DEi(a)),this.M4.appendChild(this.ACi(a)))}DEi(a){const b=lf.a.Ie();
b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}ACi(a){const b=a.Id;a=a.ContentMasters;if(!this.oJ.Hb(b))return null;const c=this.oJ.ga(b),f=lf.a.Ie();f.className="LayoutTableContainer";var l=lf.a.jLf();const x=lf.a.tHi();let H=null;f.appendChild(l);l.appendChild(x);l=this.Pma.width;let U=this.Pma.height,ja;l||(l=1);U||(U=1);ja=U/l*145;let ya=0;const Va=a.length;for(var hb=0;hb<Va;hb++)!this.qTg&&this.oc.Aab(a[hb])||ya++;hb=1;for(let Lc=0;Lc<Va;Lc++){var yb=a[Lc];if(!this.qTg&&this.oc.Aab(yb))continue;
1===hb%3&&(H=lf.a.zYd(),x.appendChild(H));var Zb=yb.Id.toString();const Gc=yb.Name,ae=lf.a.VLc();ae.id="Layout"+this.Wdb;ae.setAttribute("LayoutIndex",this.Wdb);ae.setAttribute("MasterId",b);ae.setAttribute("LayoutId",Zb);ae.setAttribute(Cc.a.ef,Cc.a.nN);Array.add(this.mXa,ae.id);var fc=null;if(Zb=!!c.LayoutIcons&&c.LayoutIcons.length>Lc&&!!c.LayoutIcons[Lc].Icon){fc=-1;for(var Kc=0;Kc<c.LayoutIcons.length;Kc++)if(c.LayoutIcons[Kc].LayoutId===yb.Id){fc=Kc;break}-1===fc&&(fc=Lc);fc=c.LayoutIcons[fc].Icon;
Kc=new MR.a(fc.Clip.Bounds.Left,fc.Clip.Bounds.Top,145,ja);yb=lf.a.RA();yb.src=Db.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(ee.a.Uub,fc.ImgId,"LayoutPicker");yb.title=Gc;yb.style.clip=this.zSk(Kc);yb.style.left=lf.a.Pc(-Kc.U1a);yb.style.overflow=mf.a.Qs;yb.style.position=mf.a.Xoa;yb.style.top=lf.a.Pc(-Kc.V1a);yb.style.zIndex="0";l<U&&(yb.style.height=lf.a.Pc(ja));yb.setAttribute(Cc.a.ef,Cc.a.WPa);fc=document.createElement("span");fc.style.width=lf.a.Pc(145);fc.style.height=lf.a.Pc(ja);
fc.setAttribute("Unselectable","on");fc.style.zIndex="0";fc.style.overflow=mf.a.Qs;fc.style.display=mf.a.prl;fc.style.position=mf.a.dsc;fc.appendChild(yb);fc.setAttribute(Cc.a.QK,Cc.a.gC)}yb=lf.a.Ie();yb.id="title_Layout"+this.Wdb;yb.className="LayoutTitle LayoutTitleHighContrast";yb.innerText=Gc;Kc=lf.a.Eca();Kc.setAttribute("tabindex","0");Kc.setAttribute("onclick","return false;");Kc.setAttribute("unselectable","on");Kc.setAttribute(Cc.a.ns,Gc);Kc.setAttribute(Cc.a.ef,Cc.a.WPa);Kc.setAttribute(Cc.a.BRd,
hb);Kc.setAttribute(Cc.a.CRd,ya);Zb&&Kc.appendChild(fc);Kc.appendChild(yb);H.appendChild(ae);ae.appendChild(Kc);this.Wdb++;hb++}Va%3&&(this.Wdb+=3-Va%3);return f}zSk(a){let b;b="rect( "+(lf.a.Pc(a.V1a)+", ");b+=lf.a.Pc(a.dMh)+", ";b+=lf.a.Pc(a.eMh)+", ";return b+=lf.a.Pc(a.U1a)+")"}WQi(a,b){this.P4c&&(Tc.a.otb(this.icc),this.P4c=!1,this.icc=null);1===a&&this.V4j(b.MasterId,b.LayoutId)}sZj(a){a=a.target.parentNode;this.E0&&a.id===this.E0.id||this.aLb(a)}Bbb(a){a=a.qc;var b=this.tdj(a);if(b===A.a.$Pb)return!0;
if(b===A.a.tq)return(a=this.Ea.yl())&&"WACDialogCancelButton"!==a.vj.b_.id?(this.nqa(1),this.hide(),!0):!1;a.preventDefault();if(!this.E0)return a=document.getElementById("Layout0"),this.aLb(a),!0;a=parseInt(this.E0.getAttribute("LayoutIndex"));b=this.tbj(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.aLb(f);break}}return!0}tdj(a){let b=A.a.$Pb;switch(a.keyCode){case A.a.U1:b=A.a.U1;break;case A.a.S1:b=A.a.S1;break;case A.a.VR:b=A.a.VR;break;case A.a.oP:b=
A.a.oP;break;case A.a.tq:b=A.a.tq}this.b8j&&(b===A.a.oP?b=A.a.VR:b===A.a.VR&&(b=A.a.oP));return b}tbj(a){let b=[0];switch(a){case A.a.U1:if(!this.Hbd)for(this.Hbd=Array(3),a=0;3>a;a++)this.Hbd[a]=-3-a;b=this.Hbd;break;case A.a.VR:if(!this.f8c)for(this.f8c=Array(3),a=0;3>a;a++)this.f8c[a]=-1-a;b=this.f8c;break;case A.a.oP:if(!this.H$c)for(this.H$c=Array(3),a=0;3>a;a++)this.H$c[a]=a+1;b=this.H$c;break;case A.a.S1:if(!this.p4c)for(this.p4c=Array(3),a=0;3>a;a++)this.p4c[a]=3-a;b=this.p4c}return b}pZj(a){this.aLb(a.hC);
return!0}qZj(a){a=a.hC;a!==this.E0&&this.aLb(a);this.nqa(1);this.hide();return!0}aLb(a){this.IFh();this.E0=a;const b=this.Ea.yl();b?b.vj.YE(a.firstChild):xa.a.J(509654368,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");Sys.UI.DomElement.addCssClass(this.E0,"Selected");this.XCl();this.P4c=!0;this.icc||(this.icc=Tc.a.Faa(Object(F.a)(this,this.U6k,"selectElement_Finish"),0))}U6k(){this.E0&&this.q6k(this.E0);this.P4c=!1;this.icc=null}IFh(){this.E0&&(Sys.UI.DomElement.removeCssClass(this.E0,
"Selected"),this.E0=null)}q6k(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=lf.a.Q0g(b,a)._y,x=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+c,l=x+l,l>a&&(b.scrollTop=c+(l-a)))}}XCl(){this.uye.value=this.E0.getAttribute("MasterId");this.cye.value=this.E0.getAttribute("LayoutId")}}Object(m.a)(dy,"LayoutPicker",Zh.a,[]);class CO extends dy{constructor(a,b,c,f,l,x,H,U,ja){super(a,b,c,f,l,x,H,U,ja)}dispose(){super.dispose()}Eqd(a){this.lvh(ResourceStrings.l_NewSlideTitle);
this.koh(a)}pu(){this.Xe(1,ResourceStrings.l_AddSlide);super.pu()}}Object(m.a)(CO,"AddSlideDialog",dy,[1217]);class DO extends dy{constructor(a,b,c,f,l,x,H,U,ja){super(a,b,c,f,l,x,H,U,ja)}dispose(){super.dispose()}Eqd(a){this.lvh(ResourceStrings.L_SlideLayoutDialog);this.koh(a)}pu(){this.Xe(1,ResourceStrings.L_ChangeLayout);super.pu()}}Object(m.a)(DO,"ChangeLayoutDialog",dy,[1217]);class EO{constructor(a,b){this.Ea=a;this.oc=b}FXd(a,b,c,f,l,x,H,U){switch(a){case 1:return new CO(b,c,f,l,x,this.Ea,
this.oc,H,U);case 0:return new DO(b,c,f,l,x,this.Ea,this.oc,H,U);default:return null}}}Object(m.a)(EO,"DialogFactory",null,[1200]);class FO{constructor(a,b,c,f,l){this.Sma=null;this.ia=a;this.iM=b;this.lq=c;this.pO=f;this.Sp=l;this.iM.N7(Object(F.a)(this,this.vkc,"onShapeDisconneted"));this.lq.HPd(Object(F.a)(this,this.gZa,"onSlideBackgroundClicked"));this.lq.Eai(Object(F.a)(this,this.Y5g,"onShapeViewElementBackgroundClicked"))}v$g(a){if(!a)throw Error.argumentNull("template");this.Sma=a;xa.a.J(18368227,
822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.pO.J_=!0}oei(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Sma||a.id.equals(this.Sma.id)?b=!0:a.get_isSVGBlipFilled()&&(this.Sma.px||!this.Sma.zua&&!this.Sma.get_isSVGBlipFilled())&&(b=!0);b?this.pQa():(xa.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",this.Sma.get_shapeId(),a.get_shapeId()),this.ia.La(K.a.E4d,2,new mA(this.Sma,a)))}pQa(){this.isActive&&(xa.a.J(18368262,
822,50,"FormatPainter::CancelFormat"),this.Sma=null,this.pO.J_=!1)}dispose(){this.iM.sKa(Object(F.a)(this,this.vkc,"onShapeDisconneted"));this.lq.mRe(Object(F.a)(this,this.gZa,"onSlideBackgroundClicked"));this.lq.EZk(Object(F.a)(this,this.Y5g,"onShapeViewElementBackgroundClicked"))}vkc(a,b){b.node===this.Sma&&this.pQa()}gZa(){const a=this.isActive;this.pQa();this.Sp&&a&&this.ia.processAction(D.a.Sja,2)}Y5g(a,b){this.isActive&&this.oei(b.Jw.shapeNode)}get isActive(){return this.pO.J_}get iul(){return this.Sma}}
Object(m.a)(FO,"FormatPainter",null,[1172,106]);var NR=d(1150),pA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(pA||(pA={}));Object(m.b)("OfflineModalCalloutTrigger",pA);class GO{constructor(a){this.xo=null;this.erc=!1;this.Rb=a;a=document.createElementNS(Pk.a.o0e,"polyline");a.setAttribute(Pk.a.N$g,
"1,1 15,14 30,1");a.setAttribute(Pk.a.zrd,"rgb(234,234,234)");a.setAttribute(Pk.a.D_e,"2");a.setAttribute(Pk.a.j3d,"white");a.setAttribute(Pk.a.C_e,"bevel");this.Upe=new Km.a;this.Upe.lh(32,16);this.Upe.xa.appendChild(a);this.dcc=document.createElement("p");this.dcc.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.dcc.style.width="258px";this.dcc.style.color="black";this.dcc.style.fontSize="14px"}dismiss(){this.xo&&(this.xo.dismiss(),this.xo=null)}show(a,b){ia.ULS.sendTraceTag(512497097,
813,50,"OfflineModalCallout.Show is triggered by {0}",pA[a]);if(this.erc){if(this.xo){if(this.xo.yL)return;this.xo.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");Ud.a("OfflineModalCalloutCrashFix")&&!c?ia.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=Od.a.$h(c),this.xo=NR.a.ZXd(a,c,this.Rb.rrd,2),this.xo.RZ=4,0<b&&(this.xo.R1e=b),this.xo.Ar=!0,this.xo.content=this.dcc,this.xo.CVd=()=>{ia.ULS.sendTraceTag(512497095,
813,50,"The user clicks the button to close the callout.");this.xo&&(this.xo.dispose(),this.xo=null)},this.xo.dgd=()=>{if(this.xo&&this.xo.content){this.xo.content.parentNode.style.width="258px";this.xo.IJ.style.borderColor="rgb(234,234,234)";for(var f=this.xo.dsb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.Upe.xa);this.xo.kWe()}else ia.ULS.sendTraceTag(512497094,813,50,"callout content is empty in OnShowCallback")},this.xo.show(),ia.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}
Object(m.a)(GO,"OfflineModalCallout",null,[1174]);var HO=d(302),qA=d(207);class IO{constructor(a,b,c){this.$g=this.qO=this.xb=null;this.Eb=!0;this.ta=a;this.adb=b;this.aze=a.vvb?a.gea:null;this.Kea=c}dispose(){this.Kea&&this.qO&&($removeHandler(this.qO.xa,"error",Object(F.a)(this,this.O3g,"onImageLoadError")),this.qO.dispose(),this.qO=null);this.xb&&this.xb.zq();this.qO=this.$g=this.xb=null;this.aze&&(this.adb.revokeObjectURL(this.aze),this.aze=null)}Jm(a){this.xb=new ZD.a;this.xb.Aoa(Ri.a.P_e);a.appendChild(this.xb.viewport);
this.qO=new HO.a;this.qO.Yj(0);this.xb.appendChild(this.qO);this.qO.Hw(this.ta.gea);$addHandler(this.qO.xa,"error",Object(F.a)(this,this.O3g,"onImageLoadError"));a=this.ta.fp;const b=ei.a.cCh(a);this.qO.setPosition(a.hc,a.kc);this.qO.lh(b.width,b.height);this.qO.Qd(!0);this.$g=new om.a;this.$g.Yj(1);this.$g.setVisibility(!1);this.$g.xa.setAttribute("class","ShapeMoveHandle");this.$g.Qd(!0);this.$g.zt(a.points);this.$g.JY("cursor: move");this.xb.appendChild(this.$g);this.xb.Rl()}O3g(){xa.a.J(34182307,
826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ta.dbb)}setPosition(a,b){this.xb.setPosition(a,b)}lD(){}Ij(a){this.xb.Ij(a)}Qq(a){this.xb.PE(a,qA.a.tca)}Xu(a){this.xb.PE(a,qA.a.Fsb)}setZIndex(a){this.xb.LB(a)}Ty(){}cE(){return null}GB(){return[]}draw(){}NE(){}Yp(){return this.Eb?this.xb.Yp():null}get visible(){return this.Eb}set visible(a){this.Eb=a;this.xb.Qd(this.Eb)}get qq(){return this.$g}get te(){return this.xb}LN(a){return a.Ec===this.qq.xa}Ox(){}setSelection(){}}Object(m.a)(IO,
"LocalImageView",null,[1216,430,431,106]);class JO{constructor(a,b){this.adb=a;this.G9j=b}create(a){return new IO(a,this.adb,this.G9j)}}Object(m.a)(JO,"Factory",null,[1168]);class KO{constructor(a){this.Eb=!0;this.XVa=this.GWa=this.xb=null;this.Yd=a}dispose(){this.xb&&this.xb.zq();this.GWa=this.XVa=this.xb=null;this.Eb=!1}Jm(a){this.xb=new ZD.a;this.xb.Aoa(Ri.a.P_e);a.appendChild(this.xb.viewport);this.XVa=new om.a;this.xb.appendChild(this.XVa);this.XVa.OE(Pk.a.none);a=this.Yd.shapeNode.fp;this.XVa.Yu(Mf.a.A1);
this.XVa.mr(Mf.a.RE);this.XVa.Goa("2,2");this.XVa.zt(a.points);this.GWa=new HO.a;this.GWa.Yj(0);this.xb.appendChild(this.GWa);this.GWa.Hw(rn.a.XK(Mf.a.Rna));a=ei.a.cCh(a);const b=Mf.a.SIb,c=Mf.a.Nid;this.GWa.setPosition(a.width/2-b/2,a.height/2-c/2);this.GWa.lh(b,c);this.GWa.Qd(!0);this.xb.Rl()}setPosition(a,b){this.xb.setPosition(a,b)}lD(){}Ij(){}Qq(a){this.xb.PE(a,qA.a.tca)}Xu(a){this.xb.PE(a,qA.a.Fsb)}setZIndex(a){this.xb.LB(a)}Ty(){}cE(){return null}GB(){return[]}draw(){}NE(){}Yp(){return this.Eb?
this.xb.Yp():null}get visible(){return this.Eb}set visible(a){this.Eb=a;this.xb.Qd(this.Eb)}get te(){return this.xb}LN(){return!1}Ox(){}setSelection(){}}Object(m.a)(KO,"ShapeProgressIndicatorView",null,[1215,430,431,106]);class LO{create(a){return new KO(a)}}Object(m.a)(LO,"Factory",null,[1169]);var fs=d(325);class YE{constructor(){this.Yy=null;this.Rra=this.rN=this.Sra=0;this.startTime=this.Mid=this.$s=this.KH=this.zC=this.W3b=null}ujc(){return this.rN<this.Yy.uL?Object.assign(new YE,{Yy:this.Yy,
Sra:this.rN,rN:this.rN+Math.min(this.Rra,this.Yy.uL-this.rN),Rra:this.Rra,W3b:this.W3b,zC:this.zC,KH:this.KH,$s:this.$s,Mid:this.Mid}):null}}Object(m.a)(YE,"ChunkUploadingContext",null,[]);var gs=d(505);class Tv{constructor(a,b,c,f){this.xf=this.zJ=this.BH=null;this.Xec=b;this.hcc=c;this.Feb=f;this.zb=a}get r9(){return!!this.BH}E1(a,b,c,f,l,x,H,U=null,ja=null){this.r9?H(new gs.a(Object.assign(new fs.a,{Code:59}))):(ja&&ja.register(Object(F.a)(this,this.abort,"abort")),0<l&&(this.zJ=Object.assign(new af.a(2,
1,l,Object(F.a)(this,this.rM,"onTimeout"),90,"85"),{customData:H}),this.zb.Db(this.zJ)),(this.BH=Object.assign(new YE,{Yy:a,W3b:c,Sra:0,rN:0,Rra:b,zC:f,KH:x,$s:H,Mid:U,startTime:new Date}).ujc())?this.uPb(this.BH):H(new gs.a(Object.assign(new fs.a,{Code:92}))))}uPb(a){this.Xec();if(this.hcc()||!this.r9)this.reset();else{this.Jxa();var b=a.Yy,c=a.zC,f=a.Sra,l=a.rN,x=a.Rra,H=!f&&l===b.uL,U=new FormData;U.append("Type","2");U.append("FileName",a.Yy.fileName);c&&U.append("ImageToken",c);U.append("Content-Range",
"bytes "+f+"-"+(l-1)+"/"+b.uL);xa.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",f,l,x,b.uL);this.xf.onreadystatechange=()=>{this.xf&&4===this.xf.readyState&&this.SGe(a,this.xf.status)};b=H?a.W3b:a.W3b.slice(f,l);U.append("chunk",b);this.xf.send(U)}}SGe(a,b){let c=Object.assign(new fs.a,{Code:94});if(200===b){this.Feb.iuc(this.xf.getResponseHeader(Tv.eUd));b=a.Mid;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.xf.responseText)}catch(l){xa.a.J(34420810,
818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&f.Result){const l=f.Result;a.zC=l.ItemId;const x=a.ujc();a.Sra===l.XOffset&&l.ItemId?x?(b&&b.mwk(100*a.rN/a.Yy.uL,!1),c=null,this.uPb(x)):(b&&b.mwk(100,!0),c=null,xa.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.KH(new mh.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else xa.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",
b,a.zC||"");c&&(this.reset(),a.$s(new gs.a(c)))}Jxa(){this.xf=new XMLHttpRequest;this.xf.open("POST",this.Feb.o$a(),!0);u.AFrameworkApplication.accessToken&&(this.xf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.xf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.H7.toString()));u.AFrameworkApplication.canary&&this.xf.setRequestHeader(Tv.spi,u.AFrameworkApplication.canary)}rM(a){xa.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.zJ=
null;this.abort();(a=a.customData)&&a(new gs.a(Object.assign(new fs.a,{Code:299})))}abort(){if(this.r9){xa.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.xf;this.reset();a&&a.abort()}}reset(){this.zJ&&(this.zb.Lg(this.zJ),this.zJ=null);this.BH=this.xf=null}}Tv.spi="X-Key";Tv.eUd="X-NewKey";Object(m.a)(Tv,"ChunkedPictureUploader",null,[1152]);class MO{constructor(a,b,c,f){this.zb=a;this.l8j=b;this.Xdc=c;this.Bye=f.pptEditingImageMaxSizeInBytes;this.NGg=Math.floor(.75*this.Bye);
this.lbk=52428800;this.oEg=f.Lgg&&f.Fie;this.fec=f.Fie;this.J6c=f.cNj;this.Oec=f.ilg}get Fic(){return this.oEg?this.lbk:this.NGg}get $qc(){return this.fec}get Zpd(){return this.J6c}U0b(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.NGg?this.convertToBase64AndCallback(a,b):this.oEg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.l8j.create();this.fec?c.dzl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.Bye&&(l=null);this.Oec?b(l):
this.zb.Db(new af.a(2,1,0,()=>{b(l)},90,"83"))}):c.JDh(a,b)}shrinkToBase64AndCallback(a,b){this.Xdc.Kpg(a,c=>{const f=this.Xdc.nwh(c,a.size,this.Bye);this.Oec?b(f):this.zb.Db(new af.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(m.a)(MO,"PPTProcessImageStrategy",null,[1010]);var OR=d(1129);class rA{static get rg(){return Zh.a.sC(rA.so,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}rA.so="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(rA,"InsertImageDialogHtml",null,[]);class NO extends Zh.a{constructor(a){super();this.Kl=null;this.dw=[];this.nB=a;this.spf=!1;this.MWa=u.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}sll(a){this.rg=rA.rg;this.Xe(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(F.a)(this,this.rGj,"insertImageDialogHandler"));if(this.Kl=document.getElementById("fileInput"))this.Kl.setAttribute("accept","image/*"),this.MWa&&a&&this.Kl.setAttribute("multiple",
"multiple");a=[];this.Kl&&(Id.a.addHandler(this.Kl,ta.a.Yf,Object(F.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.Kl));var b=this.wRc(1);b&&a.push(b);(b=this.wRc(0))&&a.push(b);this.dw=a;this.qEl()}validate(){const a=this.nB.qvd(this.Kl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.nB.l9i(a);b.style.display="inline-block";return!1}return!0}dispose(){this.Kl&&Id.a.removeHandler(this.Kl,ta.a.Yf,Object(F.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}rGj(a){1===
a&&this.nB.Yvk(this.Kl);this.Kl=null}qEl(){if(0<this.dw.length){const a=new OR.a(this.dw),b=v.FocusManager.instance().yl();b&&(this.dw[0].focus(),b.vj=a,b.nX=!0)}}onKeyDown(a){4!==v.FocusManager.instance().jch(a)&&a.preventDefault()}}Object(m.a)(NO,"InsertImageDialog",Zh.a,[]);class ZE{constructor(){this.FWc=this.file=this.fileName=null;this.FUf=!1;this.QGb=null;this.uL=this.imageHeight=this.imageWidth=0;this.t2d=!1}}Object(m.a)(ZE,"ImageType",null,[]);class OO{constructor(a,b,c,f,l,x,H,U,ja,ya){this.vPb=
0;this.h4c=this.mgc=this.lGg=this.hkb=!1;this.SL=[];this.KWa="image/*";this.ia=a;this.seb=b?b.xa:null;this.FIa=null;this.Rd=c;this.sgc=f;this.YCe=l;this.n9c=U.pptEditingUploadedImageMaxSizeInBytes;this.adb=x;this.k6j=H;this.Jze=U.pptEditingUploadLargeImageMaxSizeInBytes;this.Kck=U.pptEditingUploadLargeImageChunkSizeInBytes;this.Lck=1E3*U.pptEditingUploadLargeImageTimeoutInSeconds;if(this.Pfb=U.JEk)this.KWa=this.Pfb.join(",");this.MWa=U.wGj;this.Feb=ja;this.Fe=ya;this.Qcc=U.EMi}get T1c(){return this.lGg}set T1c(a){this.lGg=
a;this.mgc=0<this.Jze&&this.adb.DQj&&a}get IEk(){return this.mgc}Yvk(a){this.bsf(a);this.seb&&this.YCe.FYd(this.seb,a,Object(F.a)(this,this.ZIe,"onUploadFrameInitialized"),Object(F.a)(this,this.j9d,"getPictureUploadEndPoint"),this.KWa,!1,!1)}YCf(){return!(void 0===window.self.FormData||null===window.self.FormData)}Ech(a){if(this.seb){if(this.Qcc){if(this.YCf()){this.YCe.FYd(this.seb,null,Object(F.a)(this,this.ZIe,"onUploadFrameInitialized"),Object(F.a)(this,this.j9d,"getPictureUploadEndPoint"),this.KWa,
a&&this.MWa,!0);this.h4c=!1;return}xa.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}B.a.Ej||B.a.$zb||B.a.czb&&72>B.a.BJc?(this.YCe.FYd(this.seb,null,Object(F.a)(this,this.ZIe,"onUploadFrameInitialized"),Object(F.a)(this,this.j9d,"getPictureUploadEndPoint"),this.KWa,!1,!1),this.h4c=!1):((new NO(this)).sll(a),this.h4c=!0)}else xa.a.J(18643099,822,15,"PictureUploader initialize failed.")}ZOi(a){this.$ud&&(Array.addRange(this.SL,a),this.fIh())}get $ud(){return 1>
this.SL.length}fIh(){if(!this.$ud){const a=new ZE,b=this.SL[0];b?(a.fileName=this.q2d(b.name),a.t2d=!0,this.lfh(a)):(xa.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.SL.length.toString()),Array.clear(this.SL))}}j9d(){return this.Feb.o$a()}ZIe(a){this.FIa=a;if(!this.h4c){if(this.Qcc&&this.YCf()){a.Z_d(Object(F.a)(this,this.mvk,"onMultipleFileChosen"));return}if(B.a.RF){a.Z_d(Object(F.a)(this,this.Zxk,"onSingleFileChosen"));return}a=a.Z_d(null);if(!a)return;
this.SL.push(a.files[0])}this.dQd()}bsf(a){if(a)if(this.MWa)for(const b of a.files)this.SL.push(b);else this.SL.push(a.files[0])}mvk(a){this.bsf(a);this.dQd()}jOi(a){a=this.qvd(a.fileName);return 0!==a?(this.FIa&&this.FIa.GMc(),2!==a&&3!==a||this.At(90,a),!1):!0}a4b(a){let b=!0;this.T1c&&a.FWc&&!this.RHl(a)&&(this.FIa&&(this.FIa.vac=!1),b=!1);!a.QGb||!this.hkb&&b||(this.adb.revokeObjectURL(a.QGb),a.QGb=null);if(b){switch(this.vPb){case 0:this.ia.La(K.a.PPc,2,a);break;case 1:this.ia.La(K.a.C4d,2,a)}this.fIh()}else Array.clear(this.SL)}q2d(a){if(a){let b=
-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}RHl(a){if(a.uL>this.n9c){if(this.mgc&&a.uL<this.Jze)return xa.a.J(34420823,822,50,"Upload large image: {0}",a.uL),a.t2d=!0;xa.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.uL/1024/1024,this.n9c/1024/1024);this.At(87,4);return!1}return!0}CUi(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+1)}m_e(a,b,c,f=null){if(a.t2d||this.MWa&&1<this.SL.length){const l=
this.FIa,x=this.SL[0];Array.remove(this.SL,x);const H=Tc.a.Ib;H&&H.Va("FChuckedPictureUpload","True");this.k6j().E1(a,this.Kck,x,f,this.Lck,U=>{l&&(l.vac=!1,l.dispose());b(U)},U=>{l&&(l.vac=!1,l.dispose());Array.clear(this.SL);c(U)})}else this.FIa&&(a=this.Bfj(f),this.FIa.wrl(b,c,a)),Array.clear(this.SL)}Bfj(a){const b=new Yc.a;b.$("PresentationId",this.Fe.presentationId.string);b.$(ee.a.Lna,this.Fe.sessionInfo);b.$("Canary",u.AFrameworkApplication.canary);b.$("access_token",u.AFrameworkApplication.accessToken);
b.$("Type",this.vPb.toString());a&&b.$("ImageToken",a);return b}Zxk(a){a&&(Array.add(this.SL,a.files[0]),this.dQd())}dQd(){if(this.$ud||!this.SL[0])Array.clear(this.SL);else{var a=new ZE;a.fileName=this.q2d(this.SL[0].name);this.FIa.vac=!0;this.lfh(a)}}lfh(a){this.jOi(a)?this.T1c?this.NQk(a):this.a4b(a):Array.clear(this.SL)}qvd(a,b=!1){if(a&&a.length){if(1===this.vPb&&this.oVj(a))return xa.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),3;if(this.Gbg(a))return 0;
this.CUi(a)?xa.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):xa.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.vPb?3:2}return 1}oVj(a){return!!a&&0<a.length&&ha.a.qg(a).endsWith(".svg")}l9i(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.Jmg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;case 3:return ResourceStrings.l_InvalidImageErrorMessage;
default:return""}}Jmg(){return this.Gbg(".svg")}Gbg(a){a=ha.a.qg(a);for(let b=0;b<this.Pfb.length;++b)if(this.Pfb[b]&&0<this.Pfb[b].length&&a.endsWith(this.Pfb[b].trim().toLowerCase()))return!0;return!1}At(a,b){if(87===a){const c=this.mgc?this.Jze:this.n9c;this.Rd.cH(a,f=>{f.jC=1;f.ZRa=[(c/1024/1024).toString()];return!1})}else{const c=this.k9i(b);this.Rd.cH(a,f=>{f.jC=1;f.message=c;return!1})}}k9i(a){return 2===a&&this.Jmg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.Pfb.join(", ")):ResourceStrings.invalidImageFileError}NQk(a){let b=this.SL[0];if(b){a.uL=b.size;a.file=b;if(b.size>this.n9c&&this.mgc)try{b=b.slice(0,6),a.FUf=!0}catch(c){xa.a.J(34420828,822,50,"File.slice throw exception"),this.hkb=!0,this.a4b(a)}this.sgc.jfh(b,c=>{this.J3i(c,a)})}}J3i(a,b){try{let c=a.target.result;b.FWc=c;b.FUf&&(c=this.adb.createObjectURL(b.file),b.QGb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.OIj(b.FWc)&&(this.hkb=!0,xa.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.a4b(b)};f.onerror=()=>{xa.a.J(20828428,822,50,"Read image failed");this.hkb=!0;this.a4b(b)};f.src=c}catch(c){xa.a.J(20828430,822,50,"GetBase64Image throw exception"),this.hkb=!0,this.a4b(b)}}OIj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(m.a)(OO,"PictureUploader",null,[1151]);class PO{constructor(a){this.Fe=a}o$a(){let a="pptPictureUpload.ashx";if(Oc.App.webServiceBase)a=Oc.App.webServiceBase+
a;else if(B.a.eg||B.a.Lua)a=bg.a.eta(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.jTa(),this.Fe.presentationId.string,u.AFrameworkApplication.c5b());this.Fe.podSessionId&&(a+=String.format("&{0}={1}",ee.a.haa,this.Fe.podSessionId));this.Fe.pk&&(a+=String.format("&waccluster={0}",this.Fe.pk));return a}iuc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}u.AFrameworkApplication.canary=a;u.AFrameworkApplication.ibc&&
xa.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(m.a)(PO,"PictureUploaderHelper",null,[1150]);class sA{constructor(a,b,c,f,l,x,H,U,ja,ya){this.vac=!1;this.aU=null;this.cma=!1;this.xf=this.NX=this.vXa=this.ydc=this.gic=this.Kl=this.Bx=this.Pue=null;this.mf=a;this.Q9j=f;this.Fe=c;this.K9=l;this.SCb=x;b&&(this.Kl=b.cloneNode(!0));this.T8j=H;this.KWa=U;this.Lbk=ja;(this.Mcb=ya)?this.lSf():this.IBi()}IBi(){this.aU=document.createElement("iframe");this.aU.style.visibility=
Ri.a.hidden;this.aU.id=sA.Cni;this.aU.className="ObjectInDialog";this.mf.appendChild(this.aU);this.gic=Object(F.a)(this,this.f7g,"onUploadFrameLoad");Id.a.addHandler(this.aU,"load",this.gic);B.a.RF&&this.f7g(null)}Z_d(a){u.AFrameworkApplication.Aa.Ihb();if(!this.Kl)return null;this.Mcb?Id.a.addHandler(this.Kl,"change",()=>{this.KWi(a)}):B.a.RF&&(this.Pue=a,this.ydc=Object(F.a)(this,this.CPc,"fileInputChange"),Id.a.addHandler(this.Kl,"change",this.ydc));try{this.Kl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);xa.a.J(19505501,818,10,c);return null}return this.Kl}KWi(a){a&&a(this.Kl)}CPc(){this.Pue&&this.Pue(this.Kl)}wrl(a,b,c){a||xa.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||xa.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.vXa=a;this.NX=b;if(c.Hb("ImageToken")||c.Hb("AudioToken"))a=this.Bx.action,a+=String.format("&{0}={1}",ee.a.SBk,1),this.Fe.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.Bx.action=a;for(let f of c.keys)this.R5h(f,c.ga(f));this.Mcb?this.xrl():this.Bx.submit()}xrl(){try{xa.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Bx);this.c8k(a)}catch(a){xa.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.zuc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.GMc()}}c8k(a){if(a){const b=this.Bx.action;this.xf=
new XMLHttpRequest;this.xf.open("POST",b);this.xf.onreadystatechange=Object(F.a)(this,this.dzk,"onUploadResponseReceived");this.xf.send(a)}}dzk(){4===this.xf.readyState&&(this.xf.status===dl.a.Uv?this.zuc(this.xf.responseText):(xa.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.xf.status,this.xf.responseText?!1:!0),this.zuc("Upload request failed")),this.GMc())}dispose(){this.K9(this);this.Mcb&&this.mf?this.mf.removeChild(this.Bx):this.mf&&this.aU&&(this.mf.contains(this.aU)&&
this.mf.removeChild(this.aU),this.gic&&Id.a.removeHandler(this.aU,"load",this.gic),this.gic=null);this.ydc&&(Id.a.removeHandler(this.Kl,"change",this.ydc),this.ydc=null);this.aU=this.Kl=this.Bx=this.mf=null}R5h(a,b){const c=this.eEi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Bx.appendChild(c)}eEi(){return this.Mcb?document.createElement("input"):this.aU.contentWindow.document.createElement("input")}f7g(a){try{if(!this.aU.contentWindow.document.body)return}catch(b){xa.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.zuc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.cma?this.vXa?(this.zuc(this.nnj(this.aU.contentWindow.document.body)),this.GMc()):xa.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.lSf()}lSf(){if(!this.cma){const a=this.T8j();this.Mcb?(this.Bx=document.createElement("form"),this.mf.appendChild(this.Bx)):(this.Bx=this.aU.contentWindow.document.createElement("form"),this.aU.contentWindow.document.body.appendChild(this.Bx));
this.qDi();this.Bx.id="formId";this.Bx.method="post";this.Bx.encoding="multipart/form-data";this.Bx.action=a;this.Bx.appendChild(this.Kl);this.cma=!0;this.Q9j(this)}}qDi(){this.Kl||(this.Mcb?(this.Kl=document.createElement("input"),this.Kl.style.opacity="0",this.Lbk&&(this.Kl.multiple="multiple")):this.Kl=this.aU.contentWindow.document.createElement("input"),this.Kl.type="file",this.Kl.accept=this.KWa,this.Kl.id="fileInputId",this.Kl.name="fileInputId")}delayedDispose(){this.dispose()}GMc(){const a=
new af.a(2,1,0,Object(F.a)(this,this.delayedDispose,"delayedDispose"),90,"82");u.AFrameworkApplication.ye.Db(a)}zuc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){xa.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.vXa?this.vXa(new mh.a(b.Result)):xa.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new fs.a,
{Code:94}),this.NX?this.NX(new gs.a(a)):xa.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}bhl(){return this.cma&&!this.vac}nnj(a){let b=null;this.SCb?(this.ZWk(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=B.a.Ej?a.innerText:a.innerHTML;return b||"No response got from server"}ZWk(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}sA.Cni="ppt_uploadframe";Object(m.a)(sA,
"UploadFrame",null,[1212,1213,1214]);class QO{constructor(a,b){this.qCb=[];this.Fe=a;this.SCb=b}FYd(a,b,c,f,l,x,H){if(0<this.qCb.length)for(let U=this.qCb.length-1;0<=U;U--)this.qCb[U].bhl()&&this.qCb[U].dispose();a=new sA(a,b,this.Fe,c,Object(F.a)(this,this.DNi,"disposeHandler"),this.SCb,f,l,x,H);Array.add(this.qCb,a)}DNi(a){Array.remove(this.qCb,a)}}Object(m.a)(QO,"UploadFrameFactory",null,[1149]);class RO extends vq{constructor(a,b,c,f,l){super(a,b);this.jc=c;this.pa=f;this.lec=l}Sr(a){var b="";
if(this.lec){const c=zn.SchemeColor.parse(a);c&&(c.color&&!c.Kta&&(b=Object(oa.a)(115,this.jc.kg(this.pa.Na.mb.Ua.node)),(b=c.resolve(b?b.ke:null))?c.ZP=Ol.g(b.B_a):xa.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Ol.c(a))),b=c.toString());xa.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Ol.c(b));this.Yk.setValue(kb.a.schemeColor,b);c&&c.Kta&&(a=Ol.i(c.ZP))}ha.a.Wa(a)||super.Sr(a)}}Object(m.a)(RO,"PptInsertionPointFormatting",
vq,[]);class $E{constructor(){this.Rra=this.rN=this.Sra=0;this.packageKey=this.Qx=this.opa=null;this.IKb=this.BYa=this.PZ=0;this.startTime=this.$s=this.KH=null}ujc(){return this.rN<this.opa.length?Object.assign(new $E,{Sra:this.rN,rN:this.rN+Math.min(this.Rra,this.opa.length-this.rN),Rra:this.Rra,opa:this.opa,Qx:this.Qx,packageKey:this.packageKey,KH:this.KH,$s:this.$s,PZ:0,BYa:this.BYa,IKb:this.IKb,startTime:new Date}):null}}Object(m.a)($E,"ChunkContext",null,[]);class SO{constructor(a,b,c,f,l){this.xf=
this.zJ=this.BH=null;this.Xec=b;this.hcc=c;this.zb=a;this.Fe=f;this.Jv=l}get r9(){return!!this.BH}E1(a,b,c,f,l,x,H,U,ja){this.r9?(xa.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.BH.Qx,f),ja&&ja(new gs.a(Object.assign(new fs.a,{Code:59})))):(0<l&&(this.zJ=Object.assign(new af.a(2,1,l,Object(F.a)(this,this.rM,"onTimeout"),90,"85"),{customData:ja}),this.zb.Db(this.zJ)),(this.BH=Object.assign(new $E,{Sra:0,
rN:0,Rra:a,opa:b,packageKey:c,Qx:f,KH:U,$s:ja,PZ:0,BYa:x,IKb:H,startTime:new Date}).ujc())?this.uPb(this.BH):(xa.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),ja&&ja(new gs.a(Object.assign(new fs.a,{Code:437})))))}Dpi(a){this.r9&&(xa.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.BH.Qx),this.BH.Qx===a&&this.abort())}uPb(a){this.Xec();if(this.hcc()||!this.r9)xa.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.Qx),this.reset();else{var b=this.Jxa(a);this.xf.onreadystatechange=()=>{this.xf&&4===this.xf.readyState&&this.SGe(a,this.xf.status)};this.xf.send(b)}}SGe(a,b){let c=Object.assign(new fs.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.xf.responseText)}catch(f){xa.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Qx)}if(b&&!b.Error&&b.Result){const f=a.ujc();f?(this.Jv.mMa(100*a.rN/
a.opa.length),this.uPb(f)):(xa.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Qx),this.Jv.mMa(100),this.reset(),a.KH&&a.KH(new mh.a(b.Result)))}b&&(c=b.Error)}else xa.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.Qx);c&&(a.PZ<a.BYa?(xa.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.Sra,a.rN,a.Qx),window.setTimeout(()=>{a.PZ++;this.uPb(a)},a.IKb)):(xa.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Sra,a.rN,a.Qx),this.reset(),a.$s&&a.$s(new gs.a(c))))}Jxa(a){this.xf=new XMLHttpRequest;this.xf.open("POST",this.o$a(),!0);u.AFrameworkApplication.accessToken&&(this.xf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.xf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.H7.toString()));
const b=a.packageKey,c=a.Sra,f=a.rN,l=!c&&f===a.opa.length,x=new FormData;x.append("FileName",a.Qx);b&&x.append("PackageKey",b);x.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.opa.length);xa.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.opa.length,a.Qx);a=l?a.opa:a.opa.slice(c,f);x.append("ChunkData",a);return x}o$a(){let a="PastedDataUpload.ashx";if(Oc.App.webServiceBase)a=Oc.App.webServiceBase+a;else if(B.a.eg||
B.a.Lua)a=bg.a.eta(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.jTa(),this.Fe.presentationId.string,u.AFrameworkApplication.c5b());this.Fe.podSessionId&&(a+=String.format("&{0}={1}",ee.a.haa,this.Fe.podSessionId));this.Fe.pk&&(a+=String.format("&waccluster={0}",this.Fe.pk));return a}rM(a){xa.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.BH.Qx);this.zJ=null;this.abort();(a=a.customData)&&a(new gs.a(Object.assign(new fs.a,{Code:299})))}abort(){if(this.r9){xa.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.BH.Qx);const a=this.xf;this.reset();a&&a.abort()}}reset(){this.zJ&&(this.zb.Lg(this.zJ),this.zJ=null);this.BH=this.xf=null}}Object(m.a)(SO,"ChunkedDataUploader",null,[1154]);class TO{constructor(){this.X7j=new mc.a(Object(F.a)(this,this.WJj,"isBrowerSupportObjectUrl"))}get DQj(){return this.X7j.value}WJj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(m.a)(TO,"PPTFileApiHelper",null,[1170]);class UO{aKj(){return window.FileReader?!0:!1}jfh(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}q2d(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(m.a)(UO,"PPTFileReaderHelper",null,[1166]);var PR=d(962),QR=d(623),Co;(function(a){a.Accent1="#4472C4";a.Accent2=
"#ED7D31";a.Accent3="#A5A5A5";a.Accent4="#FFC000";a.Accent5="#5B9BD5";a.Accent6="#70AD47";a.Hyperlink="#0563C1";a.ClickedHyperlink="#954F72";a.LightBackground="#FFFFFF";a.DarkBackground="#000000";a.TextColorLight="#E7E6E6";a.TextColorDark="#44546A"})(Co||(Co={}));Object(m.b)("DefaultOfficeThemeColorScheme",Co);var tA;(function(a){a.ThemeFamilyId="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}";a.VariantId="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"})(tA||(tA={}));Object(m.b)("DefaultOfficeThemeFamily",tA);const Wp=
a=>{if(a)return"#"+(16777216+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1);xa.a.J(509207453,811,10,"Color is null")};var RR=d(334),SR=d(446),TR=d(305),UR=d(538),Uv;(function(a){a.Insert="Insert";a.ReplaceAll="ReplaceAll"})(Uv||(Uv={}));Object(m.b)("MergeAction",Uv);var ap;(function(a){a.ChatPPTExitClicked="ChatPPTExitClicked";a.ChatPPTLikeClicked="ChatPPTLikeClicked";a.ChatPPTDislikeClicked="ChatPPTDislikeClicked";a.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked";a.ChatPPTShowDesigner="ChatPPTShowDesigner";
a.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart";a.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete";a.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation";a.ChatPPTInsertSlideCompleted="ChatPPTInsertSlideCompleted";a.ChatPPTSearchClicked="ChatPPTSearchClicked";a.ChatPPTSearchCompleted="ChatPPTSearchCompleted";a.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful"})(ap||(ap={}));Object(m.b)("ChatPPTEvents",ap);class VO{constructor(a,b,c,f,l,
x,H,U,ja,ya,Va,hb){this.p0=!1;this.reb=null;this.Ybd=this.jDg=!1;this.Su=yb=>{const Zb=ki.a.B3(ix.a.AZa,!1);Object(Ud.a)("ToggleRibbonModeOnModeSwitch")&&1!==yb.mode&&(this.la.cB&&Zb||this.la.VW)&&!this.p0&&this.showTaskPane()};this.zxk=yb=>{yb&&(this.p0=!1,xa.a.J(509166466,811,50,"Copilot: Close SDX in offline mode"))};this.zYe=(yb,Zb,fc)=>{if(1==fc)return 32;this.p0?(this.Xqg(!1),this.dGf()):(this.Xqg(!0),this.showTaskPane());return 32};this.snc=(yb,Zb,fc,Kc,Lc)=>{if(!Lc)return 8;null===Lc||void 0===
Lc?void 0:Lc.Mf(this.p0);return 32};this.Zvl=(yb,Zb)=>{this.p0||this.jDg||!(this.la.cB&&"SingleLine".match(appChrome.selectors.getRibbonMode())||this.la.VW)?this.p0&&"Multiline".match(appChrome.selectors.getRibbonMode())&&Zb.sle?this.dGf():!this.p0&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&Zb.sle&&this.showTaskPane():this.showTaskPane()};this.d7d=()=>{const yb={};yb.WE=this.la.VW?"Copilot (Preview)":"What do you want to do? [Beta]";yb.RAh=this.la.VW?"Copilot (Preview)":"What do you want to do?";
yb.assetId="FA000000121";yb.nonPersistedSettings=this.M4i();yb.E5=this.Qgb;Object(Ud.a)("AddClassOnSDXPaneContainer")&&(yb.PAh="ActionAITaskPane");return yb};this.mJa=(yb,Zb)=>{Zb&&(yb=Zb.instanceId)&&yb.length&&this.reb===yb&&(this.p0=!1,this.reb=null,Object(Ud.a)("EnableChatPPTEventListenerFromSDX")&&this.Hql())};this.Qgb=()=>{this.reb=this.USa();this.jDg=this.p0=!0;Object(Ud.a)("EnableChatPPTEventListenerFromSDX")&&this.Mpl()};this.eal=()=>{mj.UISurfaces.zr().then(yb=>{const Zb=this.USa();Zb&&
yb.setSelectedTaskPane(Zb);return null}).catch(yb=>{xa.a.J(509354912,811,10,"ChatPPTPane::SelectPane exception: {0}",yb.toString())})};this.iHk=yb=>Object(ql.a)(this,void 0,void 0,function*(){var Zb=yb.slides;let fc=[];for(var Kc of Zb){var Lc=Kc;if(!Lc)throw Error.argumentNull("slideData");var Gc=Lc.Images;Zb=[];var ae=[];for(var we of Gc)we&&(Zb.push(we.Prompt),ae.push({Url:we.Url,Format:""}));Gc=Lc.Title;const $d=Lc.KeyPoints;Lc=Lc.Notes;Gc&&$d||xa.a.J(509207452,811,15,"Copilot:InvalidOutlineInfo={0}{1}",
Gc?"":"slideTitle;",$d?"":"keyPoints;");fc.push({Title:Gc,ImagesQuery:Zb,Images:ae,KeyPoints:$d,Notes:Lc})}we={Title:"",Slides:fc};Zb=this.ua.Ba;Kc=this.ua.currentSlideIndex;Zb||xa.a.J(509207493,811,15,"Slide Node is Null. Using Office Default Theme Values");Zb&&Zb.ke?ae={["Accent1"]:Wp(Zb.ke.Accent1),["Accent2"]:Wp(Zb.ke.Accent2),["Accent3"]:Wp(Zb.ke.Accent3),["Accent4"]:Wp(Zb.ke.Accent4),["Accent5"]:Wp(Zb.ke.Accent5),["Accent6"]:Wp(Zb.ke.Accent6),["Hyperlink"]:Wp(Zb.ke.Hyperlink),["ClickedHyperlink"]:Wp(Zb.ke.FollowedHyperlink),
["LightBackground"]:Wp(Zb.ke.Light1),["DarkBackground"]:Wp(Zb.ke.Dark1),["TextColorLight"]:Wp(Zb.ke.Light2),["TextColorDark"]:Wp(Zb.ke.Dark2)}:(xa.a.J(509207489,811,50,"Slide Node is Null. Using Default Office Theme Color Scheme"),ae={["Accent1"]:Co.Accent1,["Accent2"]:Co.Accent2,["Accent3"]:Co.Accent3,["Accent4"]:Co.Accent4,["Accent5"]:Co.Accent5,["Accent6"]:Co.Accent6,["Hyperlink"]:Co.Hyperlink,["ClickedHyperlink"]:Co.ClickedHyperlink,["LightBackground"]:Co.LightBackground,["DarkBackground"]:Co.DarkBackground,
["TextColorLight"]:Co.TextColorLight,["TextColorDark"]:Co.TextColorDark});Lc=this.ua;Zb&&(null===Lc||void 0===Lc?0:Lc.presentation)&&Lc.presentation.t6b(Zb)?Lc="{"+Lc.presentation.t6b(Zb).ThemeFamilyId+"}":(xa.a.J(509207490,811,50,"Slide Node is Null. Using Default Office Theme Family Id"),Lc=tA.ThemeFamilyId);we={OutlineInput:{ColorScheme:ae,PresOutline:we,ThemeIds:[Lc],FRenderFirstThumb:!0},ClientName:"ChatPPT",MergeAction:yb.mergeAction?yb.mergeAction:Uv.Insert,CorrelationId:void 0,InsertPosition:{ReferenceSlide:{Cid:null===
Zb||void 0===Zb?void 0:Zb.cid,Sid:null===Zb||void 0===Zb?void 0:Zb.sid},InsertBefore:!1}};xa.a.J(509166875,811,15,"Copilot:MergeAction={0}",yb.mergeAction);we=yield this.gWa.IYf(we);return{slideIndex:-1===Kc||yb.mergeAction===Uv.ReplaceAll?fc.length-1:Kc+fc.length,success:we}});this.kel=yb=>{yb||xa.a.J(509166874,811,10,"No data received from SDX");try{const Zb=JSON.parse(yb),fc=Zb.mergeAction===Uv.ReplaceAll?1:Zb.slideIndex;!fc||!this.oc.pj()||fc>this.oc.pj()?xa.a.J(509166371,811,10,"Copilot:Invalid Slide Index provided to set focus"):
this.la.Jn?this.bYa.value.GJ(fc):this.Ge.GJ(fc)}catch(Zb){xa.a.J(509166873,811,10,"Copilot:Unexpected Error Occurred setting slideIndex:{0}",Zb.toString())}};this.KGj=yb=>{if(null==yb)xa.a.J(509207492,811,10,"No message received from SDX");else if(Object(Ud.a)("pptCreatorServiceForCopilotEnabled")){let Zb;try{Zb=JSON.parse(yb)}catch(fc){xa.a.J(509207491,811,10,"Unexpected error parsing sdx request data {0}",fc.toString());return}this.iHk(Zb).then(fc=>{fc?(xa.a.J(509211359,811,15,"Copilot:InsertSlideSuccessful={0}",
fc.success),this.I7k(JSON.stringify(fc))):xa.a.J(509166872,811,10,"Copilot:No Response From API")}).catch(fc=>{xa.a.J(509211358,811,10,"Copilot: Unexpected error in insert slide operation from copilot?: {0}",fc.toString())})}};this.I7k=yb=>{if(this.reb){var Zb=document.getElementById(this.reb);null==Zb?xa.a.J(509196E3,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.p0):(yb={type:ap.ChatPPTInsertSlideCompleted,message:yb},Zb.contentWindow&&Zb.contentWindow.postMessage(yb,"*"))}else xa.a.J(509166871,
811,10,"Copilot: SDX instance id is null",this.p0)};this.dEf=yb=>{if(null!==yb&&void 0!==yb&&yb.data)switch(yb.data.type){case ap.ChatPPTExecuteInsertSlideOperation:this.KGj(yb.data.message);break;case ap.ChatPPTShowDesigner:this.ia.processAction(K.a.G7g,2);break;case ap.ChatPPTQueryExecutionStart:this.la.cB&&this.ia.processAction(K.a.Evb,2);break;case ap.ChatPPTQueryExecutionComplete:this.la.cB&&this.eal();break;case ap.ChatPPTExitClicked:Object(Ud.a)("EnableFeedbackInChatPPTMode")?this.gAk():this.GTf();
break;case ap.ChatPPTLikeClicked:Object(Ud.a)("EnableFeedbackInChatPPTMode")&&this.wrk();break;case ap.ChatPPTDislikeClicked:Object(Ud.a)("EnableFeedbackInChatPPTMode")&&this.vrk();break;case ap.ChatPPTSearchClicked:this.nql(yb.data.message);break;case ap.ChatPPTSlideUpdateCheckSuccessful:Object(Ud.a)("SetFocusFromSDX")&&this.kel(yb.data.message)}};this.ia=a;this.Yc=b;if(!c&&Object(Ud.a)("EnableChatPPTPaneOnEditingMode"))throw Error.argumentNull("appFrame");this.la=x;this.kak=H;this.cpe=l;this.Yc.execute(yb=>
{yb.wGc(this.mJa)});f&&(this.he=f,this.he.lbi(this.Zvl));Object(Ud.a)("EnableChatPPTPaneOnEditingMode")&&c.PK(yb=>{this.Su(yb)});(this.la.VW||this.la.cB)&&Object(Ud.a)("EnhancementOfSDXPaneBootTime")&&gb.a.get_instance().ek(8,()=>{this.showTaskPane()});if(!U)throw Error.argumentNull("graphTopologyManager");if(!ja)throw Error.argumentNull("copilotProxy");if(this.la.Jn&&!ya)throw Error.argumentNull("sorterViewActorLazy");if(!this.la.Jn&&!Va)throw Error.argumentNull("thumbnailNavigationPaneView");if(!hb)throw Error.argumentNull("presentationReader");
this.ua=U;this.gWa=ja;this.Ge=Va;this.bYa=ya;this.oc=hb;Object(Ud.a)("FixAddInPaneVisibilityInOfflineMode")&&c&&(null===c||void 0===c?void 0:c.FPa(this.zxk))}wb(){this.ia.ya(K.a.N_b,Cb.a.view,this.zYe);this.ia.ya(K.a.N_b,Cb.a.notes,this.zYe);this.ia.ya(K.a.N_b,Cb.a.Pf,this.zYe);this.ia.je(K.a.N_b,4);Object(Ud.a)("ShowEnabledStateOfChatPPT")&&this.ia.ra(K.a.snc,Cb.a.application,this.snc,96)}Ee(){}Xqg(a){Object(Ud.a)("logTelemetryForOpenClosePane")&&xa.a.J(509613323,811,15,"ChatPPT-IsOpen:"+a)}showTaskPane(){if(this.p0)return 8;
const a=this.d7d();if(!a)return 8;this.ia.La(K.a.gga,2,a);return 32}dGf(){this.p0&&this.reb?this.ia.La(K.a.ttb,2,this.reb):this.p0=!1}M4i(){return Object(Ud.a)("NewSettingsForChatPPT")?{ChatPPTSessionID:Ug.a.create().toString(),AugloopClouldALServiceUrl:u.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl"),ShouldUseEnvSpecificALUrl:this.kak?"true":"false",PPTCreatorEnabled:Object(Ud.a)("pptCreatorServiceForCopilotEnabled")&&(this.la.VW||this.la.cB)?"true":"false",PPTClientOrigin:window.location.origin,
PPTCopilotSearchEnabled:!Object(Ud.a)("pptCopilotSearch")}:{xLl:Ug.a.create(),vLl:u.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl")}}USa(){var a;if(null!==(a=this.Yc)&&void 0!==a&&a.instance)return a=this.Yc.instance.pQ("FA000000121"),null===a||void 0===a?void 0:a.instanceId;xa.a.J(509207495,811,10,"Instance is null")}awl(){appChrome.onRibbonModeToggle()}GTf(){this.awl()}gAk(){xa.a.J(509613280,811,15,"Chat PPT opt out via SDX");this.rYe("optOut",!1,!0)}wrk(){xa.a.J(509613250,811,15,"Chat PPT like button clicked");
this.rYe("like",!0,!1)}vrk(){xa.a.J(509613249,811,15,"Chat PPT dislike button clicked");this.rYe("dislike",!1,!1)}rYe(a,b,c){if(this.cpe){var f=null;if(c){let l=this;f=function(){l.GTf()}}try{b?this.cpe.tml(a,f):this.cpe.bll(a,f)}catch(l){xa.a.J(509613584,811,10,"Missed opening dialog; Error:"+l.toString()+" isLikeDialog:"+b+" exitChatPPTMode:"+c),f(!1)}}else xa.a.J(509613464,811,10,"ActionAIFeedback is received as null")}nql(a){a&&!Object(Ud.a)("pptCopilotSearch")&&(a=Object.assign(new RR.a,{selection:Object.assign(new SR.a,
{neighborhood:a,mentionStart:0,mentionLength:null===a||void 0===a?void 0:a.length}),launchData:Object.assign(new TR.a,{landingTab:Object(Ud.a)("pptCopilotSearchLandingTab")?"File":"All"}),entryPoint:UR.a.searchBoxGenerateDeck}),this.ia.La(G.a.eYc,2,a),a=document.getElementById(this.USa()),null==a&&xa.a.J(509196033,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.p0),a.contentWindow.postMessage({type:ap.ChatPPTSearchCompleted,message:"1"},"*"))}Mpl(){this.Ybd||(window.addEventListener("message",
this.dEf),this.Ybd=!0)}Hql(){this.Ybd&&(window.removeEventListener("message",this.dEf),this.Ybd=!1)}}Object(m.a)(VO,"ActionAIActor",null,[352]);class WO{constructor(a,b){this.eDl=(c,f,l,x,H)=>{if(1===l)return 32;c=this.la.VCa?"DataSync: Fluid":"DataSync: Box4";H[wp.a.Value]=c;H[im.a.labelText]=c;H[wp.a.Visible]=!0;return 32};if(!a||!b)throw ia.ULS.sendTraceTag(509384847,844,10,"DataSyncActor:IActor: ActionManager or appSettings should not be null."),Error.argumentNull("actionManager and appSettings cannot be null.");
this.ia=a;this.la=b}wb(){this.ia.ra(K.a.$ch,de.a.frame,this.eDl,96)}Ee(){}}Object(m.a)(WO,"DataSyncActor",null,[352]);class XO{constructor(a){this.rre=a}tml(a,b){let c=this.L0f();c.initialFeedbackType="Smile";this.showDialog(a,c,b)}bll(a,b){let c=this.L0f();c.initialFeedbackType="Idea";this.showDialog(a,c,b)}showDialog(a,b,c){function f(x){xa.a.J(509613319,811,15,"Feedback dialog dismissed. FeedbackSent:"+x+" Source:"+a);c&&c(x)}let l=this.$s;mj.UISurfaces.n4f().then(x=>{x.initializeFeedbackModal(b,
f,l)})}$s(a){xa.a.J(509613318,811,10,"Error in submitting feedback: "+a)}L0f(){var a={};u.AFrameworkApplication.fa.BOd(a);a=this.rre.getContext(a)||{};a.uiType="Modal";a.screenshot=!0;a.showEmailAddress=!0;let b=a.telemetryGroup||{};b.processSessionId=a.sessionId;b.officeBuild=a.build;b.featureArea="Chat PPT";a.telemetryGroup=b;return a}}Object(m.a)(XO,"ActionAIFeedback",null,[]);var VR=d(1017),WR=d(1254);class YO{constructor(a){this.U0a=(b,c,f)=>{var l;c=new VR.a(new mc.a(()=>Oc.App.Kb?Oc.App.Kb.Kd.xi:
null),sa.InteractiveViewManager.instance,Db.a.instance.ub("Box4.ISelectionFactory"),Db.a.instance.ub("PowerPointWebEditor.ISlideReader"),Db.a.instance.ub("PowerPointWebEditor.IPPTWorkspace"),Db.a.instance.ub("PowerPointWebEditor.Graph.IGraphTopologyManager"),new WR.a,Db.a.instance.ub("Common.IActionManagerExtended"),Db.a.instance.ub("PowerPointWebEditor.IPptSelectionManager"),Db.a.instance.ub("PowerPointWebEditor.IClipServiceManager"),Db.a.instance.ub("PowerPointWebEditor.IPresentationReader"));b=
b===K.a.U0a?c.getSelectedSlidesAsPPTXStream():c.getAllSlidesAsPPTXStream();if(null===(l=null===b||void 0===b?void 0:b.selectedSlideIDs)||void 0===l||!l.length)return 16;if(1===f)return 2>b.selectedSlideIDs.length?16:32;this.ia.La(G.a.iYc,2,b);return 32};if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.wb()}wb(){this.ia.ya(K.a.U0a,rc.a.application,this.U0a);this.ia.ya(K.a.Y_e,rc.a.application,this.U0a)}Ee(){}}Object(m.a)(YO,"AICopilotActor",null,[352]);var ZO=d(1042),YR=d(1001);class $O{constructor(){this.dxg=
this.S$c=this.Wve=this.Xve=this.xBe=this.TC=this.Qla=this.K=null}get name(){return"PowerPointWebEditor.Actor"}Mka(a){return a.resolve("PowerPointWebEditor.IApplicationSettings").cB||a.resolve("PowerPointWebEditor.IApplicationSettings").VW}Zb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").cOj?a.register(1139,"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new nO(new yE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),
a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").Mzb,a.resolve("PowerPointWebEditor.IApplicationSettings").jlg,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(1139,
"Box4.Actors.IFormattingStewardBridge").ma().oa(()=>new yE(a.resolve("Box4.IFormattingEditor")));this.Mka(this.K)&&Ud.a("EnhancementOfSDXPaneBootTime")&&a.register(ZO.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new ZO.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),
this.Mka(this.K))).ma();a.register(1140,"PowerPointWebEditor.IGraphTransactionHelper").ma().oa(()=>new $M(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Ja("PowerPointWeb.Comments.ICommentFrame")));a.register(1141,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().oa(()=>new mN(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(478,"Box4.IInsertionPointFormatting").ma().oa(()=>
new RO(a.ub("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").z_c));a.register(1142,"Box4.IClipboardCommands").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new vE(u.AFrameworkApplication.Ta,K.a.rah,K.a.fid,K.a.hid,K.a.Bah):new vE(u.AFrameworkApplication.Ta,D.a.RZb,D.a.hIc,
D.a.Z7,D.a.mhd));a.register(595,"HtmlImport.IHtmlNormalizerSettings").ma().oa(()=>new wC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(578,"HtmlImport.IHtmlTranslatorSettings").ma().oa(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new kC(c.Gkg&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.BUa||c.vDk,c.BUa,c.pptCopyPasteTextWithHighlight,c.BUa,c.BUa||c.pptCopyPasteFontFamilyEnabled,
void 0,c.pptCopyPasteMarginAndIndentationEnabled,a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,c.BUa,f=>f.gzb&&c.Oke,()=>c.$ke)});a.register(569,"Box4.Actors.IBox4PasteStewardBridge").ma().oa(()=>new pO(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),
a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(uE.a,"Common.PressOnlyKeyEvent").ma().oa(()=>uE.a.instance());a.register(VE,"PowerPointWebEditor.PasteFromFloatieArgs").ma().oa(()=>new VE);a.register(1143,"PowerPointWebEditor.IPasteFloatieHelper").ma().oa(()=>new rO(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").plg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").uCa));a.register(wE,
"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().oa(()=>new wE);a.register(212,"Box4.IContextSetEditor").ma().oa(()=>Ih.ContextSetEditor.instance);a.register(1144,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().oa(()=>new oO(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));
a.register(gt,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().oa(()=>new gt(a.ub("Box4.IAutoCorrectScheduler"),a.ie("Box4.IUndoManager"),a.Ja("Box4.IExternalSelectionManager")));a.register(UE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().oa(()=>new UE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(1145,"Box4.Actors.IEopFormattingStrategy").ma().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").Kbb?
Object(oa.a)(1145,new dO):Object(oa.a)(1145,new zM));a.register(1146,"Box4.ISelectAllHandlers").ma().oa(()=>new ds(Uw.PageReader.instance,a.ie("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(1147,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().oa(()=>new bO(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(1148,"Box4.IFormatPainterStrategy").ma().oa(()=>new eO(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(373,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().oa(()=>new aO);a.register(374,"Box4.Actors.IDeleteTableSegmentStrategy").ma().oa(()=>new cO(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(1149,"PowerPointWebEditor.IUploadFrameFactory").ma().oa(()=>new QO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IApplicationSettings").dNj));a.register(1150,"PowerPointWebEditor.IPictureUploaderHelper").ma().oa(()=>new PO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1151,"PowerPointWebEditor.IPictureUploader").ma().oa(()=>new OO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),
a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1152,"PowerPointWebEditor.IChunkedPictureUploader").oa(()=>new Tv(a.resolve("Common.ITaskManager"),()=>{Tc.a.ybb()},Object(F.a)(sj.a.instance,sj.a.instance.X6a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));
a.register(1153,"PowerPointWebEditor.IWarningDialog").ma().oa(()=>new BO);a.register(557,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().oa(()=>new ER.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").xa));a.register(1154,"PowerPointWebEditor.IDataUploader").oa(()=>new SO(a.resolve("Common.ITaskManager"),()=>{Tc.a.ybb()},Object(F.a)(sj.a.instance,sj.a.instance.X6a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(1155,"PowerPointWebEditor.IPastedDataUploader").ma().oa(()=>new xO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(155,"PowerPointWebEditor.IMediaUploader").oa(()=>new QR.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
()=>{Tc.a.ybb()},sj.a.instance.X6a.bind(sj.a.instance)));a.register(1156,"PowerPointWebEditor.ISystemClipboard").ma().oa(()=>new zO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1157,"PowerPointWebEditor.IInternalClipboard").ma().oa(()=>new mO(a.resolve("PowerPointWebEditor.IApplicationSettings").Hig?
a.resolve("Box4.Graph.IGraphInstance").yd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").Hig?a.resolve("Box4.Graph.IGraphInstance").yd(8):null));a.register(1158,"PowerPointWebEditor.ICutCopyManager").ma().oa(()=>new kO(a.resolve("PowerPointWebEditor.IDesignModeManager").uCa,[new yO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").uCa,a.ie("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").CKj,a.resolve("PowerPointWebEditor.IApplicationSettings").rLj,a.resolve("PowerPointWebEditor.IApplicationSettings").BKj,
a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Zvb,a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager")),new es(a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IDesignModeManager").uCa,a.ie("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").DKj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(1159,"PowerPointWebEditor.IPasteManager").ma().oa(()=>
new Ah(a.ie("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").uCa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new tO(a.resolve("Common.IActionManagerExtended"),a.ie("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Lie,
a.resolve("PowerPointWebEditor.IApplicationSettings").klg),new uO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Mie),new HR.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),
a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").wRj,a.resolve("PowerPointWebEditor.IApplicationSettings").$Sj,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),new Xx(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new eA(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),u.AFrameworkApplication.PQ),new WE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));
a.register(766,"PowerPointWebEditor.ICopyPasteUtility").ma().oa(()=>new Cq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));
a.register(1160,"PowerPointWebEditor.IPasteHandlerUtil").ma().oa(()=>new sO);a.register(1161,"PowerPointWebEditor.IClipboardHelper").ma().oa(()=>new AE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.fTa().pk||vp.a.sJh,a.resolve("Common.IAppSettingsManager").Ga("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").Bc("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(1162,"PowerPointWebEditor.IClipServiceManager").ma().oa(()=>new jO(b.fTa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1163,"Box4.TableEditors.ITableStylePreviewGenerator").ma().oa(()=>new Dq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Yz.lLf,c=>new YD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),
c=>new WD(c),a.resolve("PowerPointWebEditor.IApplicationSettings").kaa));a.register(1164,"Box4.TableEditors.ITableStyleRibbonControls").ma().oa(()=>new UN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(1165,"Common.App.ImageProcessor.IImageProcessor").ma().oa(()=>new yM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));
a.register(1166,"PowerPointWebEditor.IPPTFileReaderHelper").ma().oa(()=>new UO);a.register(1167,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().oa(()=>new hA(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(1168,"PowerPointWebEditor.ILocalImageViewFactory").ma().oa(()=>new JO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").Oab));a.register(1169,
"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().oa(()=>new LO);a.register(631,"PPTe.IColorPickerBuilderFactory").ma().oa(()=>new rR.a);a.register(1170,"PowerPointWebEditor.IFileApiHelper").ma().oa(()=>new TO);a.register(1171,"PowerPointWebEditor.IInsertImageHelper").ma().oa(()=>new kN(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(xE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().oa(()=>new xE(a.resolve("Box4.Styles.IStyleEditor"),
a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),fd.a.instance,a.ub("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(1172,"PowerPointWebEditor.IFormatPainter").ma().oa(()=>
new FO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").yd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(1173,"PPTe.IResourceViewElementResolver").ma().oa(()=>new iO(b.fTa(),Oc.App.webServiceBase));a.register(1174,"PowerPointWebEditor.IOfflineModalCallout").ma().oa(()=>new GO(a.resolve("Box4.IAppFrame")));
a.register(1175,"PowerPointWebEditor.IPPTOfflineManager").ma().oa(()=>new AO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));
a.register(1176,"PowerPointWebEditor.IClipboardTelemetry").ma().oa(()=>new pu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").yd(8),a.resolve("Box4.Graph.IGraphInstance").yd(10),a.resolve("Box4.Graph.IGraphInstance").yd(12),a.resolve("Box4.Graph.IGraphInstance").yd(60),a.resolve("Box4.Graph.IGraphInstance").yd(7),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")))}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.FS;var f=b.wq;const l=c.od;var x=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),H=f.nhb;const U=a.resolve("Common.IActionManagerExtended"),ja=a.resolve("PowerPointWebEditor.IFrameContext"),ya=a.resolve("PowerPointWebEditor.IFocusManager"),Va=
a.resolve("PowerPointWebEditor.IFormatPainter"),hb=a.resolve("PowerPointWebEditor.CoauthManager"),yb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),Zb=Db.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),fc=Db.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Kc=Db.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Lc=Db.a.instance.resolve("Box4.ISelectionManager"),Gc=Db.a.instance.Ja("Box4.IExternalSelectionManager"),ae=Db.a.instance.resolve("PowerPoint.IPathManager");
var we=Db.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const $d=f.Kd,Te=Db.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=Db.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const Ze=Db.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Vf=Db.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),gg=Db.a.instance.resolve("PowerPointWebEditor.INotesView"),Qg=Db.a.instance.resolve("Box4.IFormatPainter"),Rg=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),
Wf=a.resolve("Common.Transaction.ITransactionFactory"),rg=a.resolve("PowerPointWebEditor.IPresentationReader"),Sg=a.resolve("PowerPointWebEditor.IShapeReader"),Gh=a.resolve("PowerPointWebEditor.Graph.ITableReader"),Zi=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),Ei=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var fj=a.resolve("PowerPointWebEditor.ITableEditor");const Fi=Db.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Gi=Db.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
Mk=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Cj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),Bk=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),Il=Db.a.instance.resolve("Box4.List.IListReader");var lk=a.resolve("Box4.Graph.IGraphIteratorFactory");const Jl=a.resolve("PPTe.IColorPickerBuilderFactory"),Vj=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.Qla=Db.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.TC=Db.a.instance.resolve("PowerPointWebEditor.IPasteManager");
const Wj=Db.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),sk=Db.a.instance.resolve("PPTe.IResourceViewElementResolver");Db.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");Db.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const kl=Db.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),vj=Db.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),vh=a.resolve("Common.Utils.IHighContrastDetector"),ll=
Db.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Xl=a.resolve("PowerPointWebEditor.IRibbonUser"),xm=a.resolve("Box4.CloudFontService"),Nk=a.resolve("Box4.CustomFontService");this.xBe=new $i(U,Zb,ya,ja.LCID,Kc,Wf,Gi,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),rg,new EO(Db.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Db.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),Wj,l,sk);this.Xve=new Rj(Gi,U,ya,Kc,Zb,Vj,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Te,Fi,vj,a.resolve("PowerPointWebEditor.IApplicationSettings").LOj,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.Ja("PowerPointWebEditor.IInsertShapeOverlayViewElement"),
a.resolve("PowerPointWebEditor.IApplicationSettings").Gyb,l.SGj,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").yd(10));this.Wve=new jA(Gi,U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Zb,Vj,a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,Te,Fi,vj,a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));we=new QM(U,ya,a.resolve("PowerPointWebEditor.IPptSelectionManager"),$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Wf,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),we,Zb,this.Qla,this.TC,a.resolve("PowerPointWebEditor.IDesignModeManager").uCa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),rg,Fi,Vj,a.resolve("PowerPointWebEditor.IWarningDialog"),
(qi,hg,Ld,Oe,yf,le,Fg,$h,ji)=>new sN(qi,hg,Ld,Oe,yf,le,Fg,$h,ji),vj,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),u.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):
null);const Ok=new li(U,ya,Wf,H,Va,Zb,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),Qg,Rg,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),vh,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Ma),pi=new rN(U,Zb,ja,Wf,Kc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));H=new bN(U,Wf,Kc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja,a.resolve("PowerPointWebEditor.IApplicationSettings"));x=[new GM(U,l,x,Kc,Wf,Zb),we,new Yx(U,l,u.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),ya,Zb,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Wf,Mk,$d,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),Vj,vj,a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),kl,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.TC,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new TM(U,Db.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),fc,a.ie("PowerPointWebEditor.IContextMenuUser"),$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),ya,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
l.pptContextMenuOnSelectionFixIsEnabled,l.Jn),new UM(U,Kc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.Tah,l.DIb),new ZN(U,l,jv.a.bxb,lk,a.resolve("Box4.IParagraphReader")),new $N(nu.instance),this.Xve,this.Wve,H,new $x(U,Zb,ya,ja.notesPane,gg,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,Db.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),
a.resolve("PowerPointWebEditor.View.IPPTPageView")),new qN(U,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),pi,new xN(U,ja,Xl,ya,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled"),a.resolve("PowerPointWebEditor.IApplicationSettings").cB),new AN(U,
Zb,ya,fc,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),Va,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.FC,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),
l.YP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.R6a),Ok,new FN(U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Zb,Wf,ya,Wj,sk,Kc,Sg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Nv(Gi,U,ya,Zb,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),
Sg,!!xm&&xm.isEnabled,!!Nk&&Nk.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new GN(Gi,U,ya,Zb,Kc,Sg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),Wf,l.ale,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),
a.resolve("PowerPointWebEditor.IApplicationSettings")),this.xBe,new HN(U,Zb,Wf,Gi,ya,Kc,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),rg,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),new IN(U,fc,ya,Zb,Gi,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),rg,Ze,(qi,hg)=>new PR.a(qi,hg),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
l.FC,l.ble),new LN(U,Zb,Kc,Wf,ya,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Te,rg,Fi,Vj,vj,a.resolve("PowerPointWebEditor.IShapeReader")),new NN(()=>Vf,new ON(Lc,jv.a.bxb,a.resolve("Box4.IContextSetEditor")),Gc,l),new VN(U,Zb,l,ya,Kc,Vf,a.Ja("PowerPointWebEditor.IAppForOfficeManager"),a.ie("PowerPointWebEditor.IAppforOfficeClassFactory"),Vj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ja("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Ja("PowerPointWebEditor.IAudioManagerStore")),new nA(U,Kc,Cj,ya,b,yb,Db.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new hO(U,a.Ja("PowerPointWebEditor.ICommentsPane"),ya,a.resolve("Common.IF6Manager"),
Kc,Cj,Zb,ae,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),rg,a.resolve("PowerPointWebEditor.IWindowUtils"),u.AFrameworkApplication.fa,l,b,c.fTa(),yb,Ze,Db.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),Db.a.instance.resolve("Box4.Graph.IGraphInstance").yd(7),Db.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),Db.a.instance.resolve("Common.ITaskManager"),u.AFrameworkApplication.Ke,Db.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),Db.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.Ja("PowerPointWeb.Comments.ICommentFrame"),a.Ja("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),ll,Db.a.instance.Ja("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),l.Jn?a.ie("PowerPointWebEditor.ISorterViewActorLazy"):null)];fj=new uu(U,lk,Zb,ya,Il,Sg,Gh,Ei,Zi,Fi,fj,l,Wf,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Kc,vj,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Xl,a.resolve("Box4.Styles.ITableStyleReader"));
x.push(new ru(U,Kc,ya,Il,a.resolve("Box4.ILineSpacingHelper"),Wf,Bk,lk,Oc.App.RLa.uLc(12),Oc.App.RLa.uLc(10),Sg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),l.ale,l.isPromoteDemoteOnParagraphEnabled,Jl,l.z_c,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),Qg,f,$d,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),
a.resolve("Box4.IInsertionPointFormatting"),Rg,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").ejb));x.push(fj);f=new SE(U,ya,Sg,Gi,Zb,Kc,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));x.push(f);l.Y_k&&x.push(new vN(U,ya,a.resolve("PowerPointWebEditor.IPresentationReader")));l.VHk&&x.push(new RM(U,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.TNb||l.$kb)&&x.push(new Rv(U,
l,Wf,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Kc,Gh,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.j4h&&x.push(new EM(Kc,u.AFrameworkApplication.fa,l,Object(F.a)(Tz.App.T5a,Tz.App.T5a.NXf,"forceUpdateRibbonControls")));this.Mka(this.K)&&Ud.a("EnhancementOfSDXPaneBootTime")&&x.push(new YR.a(l,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),U,$d,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Wf,this.K.ie("PowerPointWebEditor.IClassFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory"),this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),lk,Zb,vj));!this.Mka(this.K)||u.AFrameworkApplication.yM||u.AFrameworkApplication.iG||(lk=null,Object(Ud.a)("EnableFeedbackInChatPPTMode")&&(lk=this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),lk=new XO(lk)),f=!1,Object(Ud.a)("NewSettingsForChatPPT")&&(f=a.resolve("PowerPointWebEditor.IApplicationSettings").qUj),x.push(new VO(this.K.resolve("Common.IActionManagerExtended"),
this.K.Ja("PowerPointWebEditor.IAppForOfficeManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),lk,a.resolve("PowerPointWebEditor.IApplicationSettings"),f,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ICopilotProxy"),l.Jn?a.ie("PowerPointWebEditor.ISorterViewActorLazy"):null,a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IPresentationReader"))));
l.izh&&x.push(new YO(U));Ud.a("DataSyncModeOnStatusBar")&&"inner"===u.AFrameworkApplication.fa.Ga("Microsoft365Ring")&&x.push(new WO(U,l));for(const qi of x)qi.wb(),qi.Ee();Db.a.instance.Ja("PowerPointWebEditor.ISorterViewActorMain").execute(qi=>{qi.wb()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").eii(new MO(a.resolve("Common.ITaskManager"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));
const Hg=this;u.AFrameworkApplication.fa.gf(()=>{const qi=gx.a(a),hg=[new gO(U,Zb,Kc,ya,Vf,l.$Pj,hb,$d.Ef,a.Ja("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],Ld=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");
l.hla&&Ld&&hg.push(new cy(U,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),ll));Hg.S$c=new yN(U,Gi,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").yd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPresentationReader"),Kc,a.resolve("PowerPointWebEditor.IApplicationSettings").Jn,a.resolve("PowerPointWebEditor.IApplicationSettings").FC);
hg.push(Hg.S$c);hg.push(new CN(U,Kc,Vj,a.resolve("PowerPointWebEditor.IApplicationSettings").ska));hg.push(new BN(qi,Kc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ya,a.resolve("PowerPointWebEditor.View.ISelectionPane"),Ok,pi,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
ja,Sg,a.resolve("Box4.IPageView").Ma,a.resolve("Common.Transaction.ITransactionFactory")));hg.push(new WM(qi,Kc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,ya,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),Sg,l.J_i,l.Wfl,l.ska,a.resolve("PowerPointWebEditor.IImageViewManager")));hg.push(new YM(Kc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,ya,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("Common.IDynamicScriptLoaderProvider").Sw,Gh,Ei,Zi));l.Hkg?hg.push(new iN(qi,Kc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ya,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
Wf,l.DLe)):hg.push(new fN(qi,Kc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),U,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ya,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Wf,l.DLe));hg.push(new SM(qi,U,ya,$d));l.powerPointSmartLookupIsEnabled&&hg.push(new jN(Gi,U,$d,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Zb));l.SHk&&hg.push(new JM(a.resolve("Common.IDynamicScriptLoaderProvider").Sw,U,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));hg.push(new HM(U,Kc,ya,Wf,a.Ja("PowerPointWebEditor.IAudioManagerStore"),l.YP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));hg.push(new DM(U,Kc,Wf,$d,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),l.M3h,l.OIl,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));l.YHk&&hg.push(new pN(a.resolve("Common.IDynamicScriptLoaderProvider").Sw,l.WHk,l.XHk,U,Zb,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Kc,vj));l.pptoCaptionDiscoverabilityPaneEnabled&&
hg.push(new Kv(a.resolve("Common.IDynamicScriptLoaderProvider").Sw,U,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.THk));Hg.dxg=new VM(U,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Wf,a.resolve("Box4.Graph.IGraphInstance").yd(82));hg.push(Hg.dxg);for(const Oe of hg)Oe.wb(),Oe.Ee();ll.P3b=Ld});(new uN(c.VG(),c.y7d(),b,Cj,Kc,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).wb();u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.hb.Mle&&mR()}dispose(){this.Qla.dispose();this.TC.dispose();this.xBe.dispose();this.Xve.dispose();this.Wve.dispose();this.S$c&&this.S$c.dispose();
const a=this.K.Ja("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(m.a)($O,"ActorPackage",null,[2,3]);class aP{constructor(a,b,c,f,l,x,H,U,ja,ya){this.xH=!1;this.Vb=a;this.ua=b;this.Pg=c;this.sH=f;this.Tb=l;this.Gv=x;this.zb=H;this.Sva=U;this.HTg=ja;this.Oc=ya;this.$ze=[0,1,2,3];this.e5=new Rd.a;for(const Va of this.$ze)this.e5.$(Va,[]);this.e5.$(4,[]);this.Pg.rI(Object(F.a)(this,this.AB,"onActiveSlideChanged"));this.Sva.jk(Object(F.a)(this,this.qfd,"onMainMastersLoaded"));
this.HTg.Bia(Object(F.a)(this,this.IIe,"onSlideLoaded"));this.HTg.jk(Object(F.a)(this,this.Hna,"onSlidePropertyChanged"));this.Oc.KA(Object(F.a)(this,this.qM,"onSessionClosed"));this.Oc.KPa(Object(F.a)(this,this.S0,"onSessionRehydrating"));this.Oc.fC(Object(F.a)(this,this.Do,"onSessionRehydrated"));this.jQg=new Lx(Object(F.a)(this,this.rIk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.zb,3);this.iQg=new Lx(Object(F.a)(this,this.qIk,"prefetchSlideMasterImage"),250,6E4,8E3,500,
"slide master image",this.zb,3);this.AB(null,null)}AB(){this.o1d()}o1d(){const a=this.ua.Ba;a&&8===a.type&&a.Sa(kb.a.hj)&&a.Sa(kb.a.Cn)&&this.Pzl(a.hj,a.Cn)}rIk(){if(!this.xH){var a=this.e5.ga(0),b=this.e5.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.JUj(f.first,f.second)&&(Array.removeAt(a,c),Array.add(b,f),this.jQg.qsd(),this.Gv.pIk(f.first,f.second))}}}qIk(){if(!this.xH){this.ptd(1,2,c=>!!this.Tb.Q8a(c.first,c.second));var a=this.e5.ga(2);if(0<a.length){const c=a[0];var b=this.Tb.Q8a(c.first,
c.second);b&&this.OXe(b)?(b=b.qyb(new hr.a(b.oq,b.Vk)),this.iQg.qsd(),Array.removeAt(a,0),Array.add(this.e5.ga(3),c),this.sH.Dvb(b,!0,()=>{this.ptd(3,4,f=>!this.OXe(this.Tb.Q8a(f.first,f.second)));this.iQg.msd()})):(Array.removeAt(a,0),Array.add(this.e5.ga(4),c))}this.ptd(3,4,c=>!this.OXe(this.Tb.Q8a(c.first,c.second)))}}vFf(){for(const a of this.$ze)Array.clear(this.e5.ga(a));Array.clear(this.e5.ga(4))}IIe(a,b){(a=Object(oa.a)(116,b.node))&&a.fE&&this.Rjc(a)}Hna(a,b){a=b.property;b.node&&a===kb.a.Cn&&
b.node===this.ua.Ba&&this.o1d()}Rjc(a){if(this.GUj(a)&&a){const b=a.hj,c=a.Cn;b&&c&&(this.ptd(1,2,f=>f.first===b&&f.second===c),this.jQg.msd())}}qfd(a,b){a=b.property;if(a===kb.a.YFb||a===kb.a.zY)this.vFf(),this.o1d()}qM(){this.xH=!0}S0(){this.vFf()}Do(){this.xH=!1}Pzl(a,b){this.HUj(a,b)||this.IUj(a,b)||Array.add(this.e5.ga(0),new $w.a(a,b))}IUj(a,b){for(const c of this.$ze)for(const f of this.e5.ga(c))if(f.first===a&&f.second===b)return!0;return!1}HUj(a,b){for(const c of this.e5.ga(4))if(c.first===
a&&c.second===b)return!0;return!1}ptd(a,b,c){a=this.e5.ga(a);b=this.e5.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}OXe(a){if(!a)return!1;a=a.qyb(new hr.a(a.oq,a.Vk));if(null===a)return!1;for(const b of a)if(!this.sH.GWc.lmd(b).data)return!0;return!1}GUj(a){const b=this.Vb.Ef.sa(kb.a.Kwh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}JUj(a,b){var c=this.Tb.FI();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===
a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(m.a)(aP,"SlideMasterPrefetchManager",null,[261]);var ZR=d(971);class bP{constructor(a,b,c,f,l,x,H){this.Eb=!1;this.vX=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");if(!x)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.zb=x;this.Ir=a;this.Rb=b;this.gu=c;this.uy=f;this.qd=l;this.pBg=
H;this.Tek=new af.a(0,1,0,Object(F.a)(this,this.m_k,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Eb}nml(){if(!this.Eb&&this.Ir&&this.Ir.xa){this.vX=this.Rji();this.pBg||this.Ir.xa.appendChild(this.vX);this.Ir.setVisibility(!0);this.pBg&&this.qd.iuf(Object(F.a)(this,this.zed,"onCommentContainersChanged"));var a=new ZR.a(!0);this.uy.Qdh(a);this.Rb.ygb(1);this.Eb=!0}}zed(){this.Rb.AGc(Object(F.a)(this,this.hjh,"renderCommentShimmerOnSlideResize"));this.qd.zYk(Object(F.a)(this,
this.zed,"onCommentContainersChanged"))}hjh(){this.zb.Db(this.Tek);this.Rb.qld(Object(F.a)(this,this.hjh,"renderCommentShimmerOnSlideResize"))}m_k(){!this.vX||this.lUf()?xa.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.Ir.xa.appendChild(this.vX)}jcg(){if(this.Eb&&this.Ir&&this.Ir.xa&&this.lUf()){this.Ir.xa.removeChild(this.vX);this.vX=null;this.Eb=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();xa.a.J(523352018,809,50,pa.a.toJSON(a))}}PVi(){this.Eb&&
this.Ir&&this.Ir.xa&&(this.vX.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(F.a)(this,this.jcg,"hideShimmerUX"),600))}Rji(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.Sji());return a}Sji(){const a=document.createElement("div");a.className=this.gu?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";
const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const x=document.createElement("div");x.className="CommentShimmerActionStyles";a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(x);return a}lUf(){return!!document.getElementById("CommentShimmerContainer")}}Object(m.a)(bP,"CommentShimmerView",
null,[262]);class aF{constructor(a,b){this.Rb=a;this.Nwa=b;this.Nwa.Muf(Object(F.a)(this,this.Dnh,"scaleOnUIChanged"))}dispose(){this.Nwa.Nih(Object(F.a)(this,this.Dnh,"scaleOnUIChanged"))}D5(){}C5(a){2===a.behavior&&(a=a.actionId,a!==K.a.$0&&a!==K.a.Z0&&a!==K.a.Y0&&a!==K.a.Kna||this.updateCommandUI())}Dnh(){this.updateCommandUI()}updateCommandUI(){this.Rb.updateCommandUI()}}Object(m.a)(aF,"UpdateCommandUIActionListener",null,[141,106]);class bF{constructor(){this.correlationId=this.sessionId=this.KId=
null;this.actionId=0;this.rd=null}get zf(){return this.KId?this.KId:""}set zf(a){this.KId=a}}Object(m.a)(bF,"AssistanceSearchVariableUrlParameterSet",null,[]);class nr{constructor(){this.EP=!1;this.BP=!0;this.znf=this.qQb=null}get isInitialized(){return this.EP}initialize(a,b){const c=!!a&&!!b;c&&(this.qQb=a,this.znf=b);this.EP=c;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>
{f.C3("Enabled").then(l=>{this.BP=l;return null},()=>null)})}wb(a){a||(a=u.AFrameworkApplication.Ta);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.BP=u.AFrameworkApplication.TE,Db.a.instance.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",!0).then(c=>{this.BP=u.AFrameworkApplication.TE&&c;(c=u.AFrameworkApplication.Aa)&&
c.updateCommandUI();return null},()=>null)}));a.ya(G.a.ZKb,de.a.frame,Object(F.a)(this,this.kml,"showSearchResults"))}kml(a,b,c,f,l){if(1===c)return u.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.BP=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.BP)?8:zz.SessionStatusManager.instance.uka?8:32;ia.ULS.sendTraceTag(4761738,1302,50,"");bd.a.mark(4771);
if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new bF,{actionId:G.a.ZKb,rd:l});if(void 0!==a&&null!==a)l=nr.qnj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=G.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=G.a.xWd;break;case "btnShowTraining":case "Training":l.actionId=G.a.DCh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=
G.a.EJh}this.qQb.qkl(this.znf,l);bd.a.mark(4772);return 32}bd.a.mark(4772);return 8}dispose(){this.qQb&&(this.qQb.dispose(),this.qQb=null)}static get instance(){nr.Ka||(nr.Ka=new nr);return nr.Ka}static qnj(a){const b=new bF,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.zf=a.substr(f+1);return b}}nr.Ka=null;Object(m.a)(nr,"AssistanceActor",null,[106]);class cF{constructor(){this.V7e=this.$a=this.Pmb=null;this.IHd=!1}qkl(a,b){if(b.actionId!==
G.a.giveFeedback||u.AFrameworkApplication.TE)if(this.IHd&&!u.AFrameworkApplication.wsa)this.Pmb||(this.Pmb=this.V7e()),this.Pmb.Ql(a,b);else if(b.actionId===G.a.giveFeedback)this.bkl();else{a=a.MUc(b);b=null;try{ha.a.j9(a)&&(b=Od.a.vn(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no","AssistanceDisplayManager:HelpWindow"))}catch(c){throw ia.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+
c.message),c;}b?ia.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):ia.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else ia.ULS.sendTraceTag(554295451,356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.Pmb&&
(this.Pmb.dispose(),this.Pmb=null)}tsh(a,b,c){c&&Vk.b(a)?this.IHd=!1:(this.V7e=a,this.IHd=c);this.$a=b}bkl(){u.AFrameworkApplication.Ta.processAction(G.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new cF;null==c?f.tsh(a,b,u.AFrameworkApplication.myf||b.ka("HelpTabIsEnabled")):f.tsh(a,b,c);return f}}Object(m.a)(cF,"AssistanceDisplayManager",null,[1210,106]);class Vv{constructor(a,b,c,f,l){this.DG=a;this.GWh=b;this.JAc=c;this.eNh=f;this.HVh=l}get lcid(){return this.DG}get namespace(){return this.GWh}get MIa(){return this.JAc}get jfi(){return this.eNh}get locale(){return this.HVh}static Ymj(a){const b=
a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:Vv.igi}static createInstance(a){return new Vv(u.AFrameworkApplication.lcid,a,Vv.Ymj(u.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",Ya.a.xe(u.AFrameworkApplication.lcid).name)}}Vv.igi=16;Object(m.a)(Vv,"AssistanceSearchUrlParameterSet",null,[]);class dF{constructor(a,b){a=new Ee.QueryStringBuilder(a);a.yi("clid",b.lcid.toString());a.yi("p1",b.namespace);a.yi("ver",b.MIa.toString());
a.yi("apps",b.jfi);a.yi("lc",b.locale);this._url=a.toString()}MUc(a){const b=new Ee.QueryStringBuilder(this._url);b.yi("src","TellMe");b.yi("query",a.zf);b.yi("sessionid",a.sessionId);b.yi("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new dF(u.AFrameworkApplication.nyf,a)}}Object(m.a)(dF,"AssistanceSearchUrlProvider",null,[1209]);class eF{Zb(){}init(){u.AFrameworkApplication.Vrb&&!u.AFrameworkApplication.JNb&&nr.instance.wb(u.AFrameworkApplication.Ta)}dispose(){nr.instance.dispose()}geg(a){nr.instance.initialize(cF.createInstance(a,
u.AFrameworkApplication.fa),dF.createInstance(Vv.createInstance("PPWAEndUser")))}}Object(m.a)(eF,"AssistancePackage",null,[2,3]);var $R=d(1020);class cP{constructor(a,b,c,f,l,x){this.ia=a;this.Yc=b;this.rre=c;this.U6j=f;this.Nue=l;this.Yua=x}Ql(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case G.a.xWd:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case G.a.giveFeedback:a.feedback=this.Tyi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case G.a.DCh:a.query=
"showtraining";c=ResourceStrings.L_Training;break;case G.a.EJh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.zf,c=ResourceStrings.L_Help}const f={};f.WE=c;f.assetId="FA000000012";this.Yua.Eke&&b.actionId===G.a.giveFeedback&&(f.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");f.nonPersistedSettings=a;f.vIh=!1;b.actionId==G.a.xWd&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.La(K.a.gga,2,f)}}Cr(){const a=this.cxb();a&&this.ia&&this.ia.La(K.a.ttb,
2,a)}dispose(){}cxb(){if(this.Yc.instance){const a=this.Yc.instance.pQ("FA000000012");if(a)return a.instanceId}return null}Tyi(a){this.Yua.Eke||(this.Nue?this.Nue.$Tb?this.EDf():this.U6j.p0d(Object(F.a)(this,this.iWi,"feedbackDownloaded")):xa.a.J(512324302,1302,15,"feedbackFormManager is undefined"));a=a.rd?a.rd:{};u.AFrameworkApplication.fa.BOd(a);a=this.rre.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===
a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}EDf(){if($R.a.M0g())xa.a.J(512324300,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(F.a)(this,this.oah,"postScreenshotData"));return}catch(a){xa.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+
a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(F.a)(this,this.oah,"postScreenshotData"))}catch(a){xa.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}iWi(a){a&&(this.Nue.eog(a),this.EDf())}oah(a){a=a.toDataURL("image/jpeg");const b=this.cxb(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(m.a)(cP,"AgaveAssistancePane",null,
[1194,106]);class dP extends eF{constructor(){super();this.R7e=this.ybf=this.h$e=this.i$e=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Zb(a){this.Da=a}load(){this.init()}init(){super.init();!u.AFrameworkApplication.Vrb&&u.AFrameworkApplication.JNb?xa.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(xa.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?
(this.i$e=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.h$e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.ybf=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.R7e=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.geg(()=>new cP(this.Da.resolve("Common.IActionManagerExtended"),this.Da.Ja("PowerPointWebEditor.IAppForOfficeManager"),this.i$e,this.h$e,this.ybf,this.R7e))):this.geg(null))}}Object(m.a)(dP,
"PowerPointAssistancePackage",eF,[1138]);class fF{zYi(a,b,c){return a?this.zXi(b,c):this.AYi(b,c)}WVf(a,b,c){return a?this.bYi(b,c):this.UXi(b,c)}SXi(a){var b=a.yf?a.jg.Ye:a.jg.Ua;const c=new tb.GraphIterator;a.nq?c.Rc(a.nq):c.set(b.node);c.rc(14);a=new tb.GraphIterator;a.Rc(c);a.rc(14);b=Le.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Le.isLastCellInRow(a)){do if((f=Vd.moveToNextColumn(a))&&Le.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Le.isLastCellInRow(a))}if(!l&&
!Le.isLastCellInColumn(c)){do if((f=Vd.moveToNextRow(c))&&Le.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Le.isLastCellInColumn(c))}return l?f:null}$Xi(a){var b=a.yf?a.jg.Ye:a.jg.Ua;const c=new tb.GraphIterator;a.nq?c.Rc(a.nq):c.set(b.node);c.rc(14);a=new tb.GraphIterator;a.Rc(c);a.rc(14);b=Le.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Le.isFirstCellInRow(a)){do if((f=Vd.moveToPreviousColumn(a))&&Le.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Le.isFirstCellInRow(a))
}if(!l&&!Le.isFirstCellInColumn(c)){do if((f=Vd.moveToPreviousRow(c))&&Le.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Le.isFirstCellInColumn(c))}return l?f:null}XPc(a,b){var c=a.yf?a.jg.Ye:a.jg.Ua;const f=new tb.GraphIterator;a.nq?f.Rc(a.nq):f.set(c.node);f.rc(14);a=Le.findControllingCellFromNode(c.node);c=null;if(b){do{if(Le.isFirstCellInColumn(f))break;c=Vd.moveToPreviousRow(f)}while(c&&Le.findControllingCellFromNode(c)===a)}else{do{if(Le.isLastCellInColumn(f))break;c=Vd.moveToNextRow(f)}while(c&&
Le.findControllingCellFromNode(c)===a)}return c}VVf(a,b){if(!tk.l(a))return null;a=tb.GraphIterator.nb(a.currentNode);a.rc(14);let c;const f=od.TableReader.Ku(a.origin);do c=b?Vd.moveToPreviousRow(a):Vd.moveToNextRow(a);while(f&&c&&tk.h(a));return c}LYa(a,b,c,f,l){let x=null;Ta.OutlineElementNavigator.Re(a);const H=fe.OutlineElementReader.isRtl(a.currentNode);if(c)if(Vd.returnToCell(a),b=Le.isLastCellInRow(a),c=Le.isFirstCellInRow(a),l||!H&&c||H&&f&&b)Vd.returnToContainingRow(a),(f=this.VVf(a,!0))?
x=Qd.SelectionFactory.tj(f,!b):l&&(Ta.OutlineElementNavigator.Re(a),l=new tn.a,l.Rc(a),(a=Ta.OutlineElementNavigator.Vwa(l,!1,!1))&&(x=Qd.SelectionFactory.tj(a,!1)));else{do H?Vd.moveToNextColumn(a):Vd.moveToPreviousColumn(a);while(Le.isGhostCell(a)&&!Le.isFirstCellInColumn(a));Le.isGhostCell(a)||(x=Qd.SelectionFactory.tj(a.currentNode,!H))}else fe.OutlineElementReader.BC(a,b,H)||nb.SelectionEditor.Tg(b)||Vd.returnToCell(a),x=Qd.SelectionFactory.tj(a.currentNode,!H);return x}KYa(a,b,c,f,l){let x=
null;Ta.OutlineElementNavigator.Re(a);const H=fe.OutlineElementReader.isRtl(a.currentNode);if(c)if(Vd.returnToCell(a),c=Le.isLastCellInRow(a),b=Le.isFirstCellInRow(a),l||!H&&f&&c||H&&!f&&b)Vd.returnToContainingRow(a),(f=this.VVf(a,!1))?x=Qd.SelectionFactory.tj(f,b):(Ta.OutlineElementNavigator.Re(a),f=new tn.a,f.Rc(a),(a=Ta.OutlineElementNavigator.FJ(f,!1,!1))&&(x=Qd.SelectionFactory.tj(a,!0)));else{do H?Vd.moveToPreviousColumn(a):Vd.moveToNextColumn(a);while(Le.isGhostCell(a)&&!Le.isLastCellInRow(a));
Le.isGhostCell(a)||(x=Qd.SelectionFactory.tj(a.currentNode,H))}else fe.OutlineElementReader.BC(a,b,!H)||nb.SelectionEditor.Tg(b)||Vd.returnToCell(a),x=Qd.SelectionFactory.tj(a.currentNode,H);return x}}Object(m.a)(fF,"ATableCellSelectionStrategy",null,[1232]);class gF extends fF{constructor(){super()}UXi(a,b){var c=a.mb;let f=null;if(a.Hl){let l=null;if(b){if(c.nq=a.Gja,a=Object(oa.a)(Yl.TableCellNode,this.SXi(c)))a.isGhostCell&&(l=a,a=a.Xy()),f=c.OG.isValid&&c.OG.node&&a===c.OG.node?Qd.SelectionFactory.tj(c.OG.node,
!c.yf):Qd.SelectionFactory.Du(cr.TableNodeContext.create(Object(oa.a)(ug.a,a)),c.yf)}else if(c=a.ga(Math.max(0,Math.min(a.uja,a.gza))),c=Object(oa.a)(Yl.TableCellNode,c.jg.Ye.node),c.isControllingCell&&(c=c.M7d(2)),a=c.m_(),b=c.WRc().UIa,!a&&b&&(c=b.vWf),a=c)a.isGhostCell&&(l=a,a=a.Xy()),f=nb.SelectionEditor.Sl(Qd.SelectionFactory.wl(Object(oa.a)(ug.a,a)),!0,!1);f&&l&&(f.nq=tb.GraphIterator.nb(l))}return f}bYi(a,b){let c=a.mb,f=null;a.Hl&&(b?(c.nq=a.Gja,a=Object(oa.a)(Yl.TableCellNode,this.$Xi(c)),
b=null,a&&(a.isGhostCell&&(b=a,a=a.Xy()),(f=c.OG&&c.OG.isValid&&a===Object(oa.a)(123,c.OG.node)?Qd.SelectionFactory.tj(c.OG.node,!c.yf):Qd.SelectionFactory.Du(cr.TableNodeContext.create(Object(oa.a)(ug.a,a)),c.yf))&&b&&(f.nq=tb.GraphIterator.nb(Object(oa.a)(ug.a,b))))):(a.uja>a.gza?(c=a.t6,c.nq=c.yf?a.L0a:null):c.nq=c.yf?null:a.Gja,f=nb.SelectionEditor.Sl(Qd.SelectionFactory.wl(c.jg.Ua.node),!0,!1),f.nq=c.nq));return f}AYi(a,b){let c=a.mb;var f=null;if(a.Hl){const l=a.uja>a.gza;let x=null;if(b){if(c.nq=
a.Gja,a=Object(oa.a)(Yl.TableCellNode,this.XPc(c,!0)))a.isGhostCell&&(x=a,a=a.Xy()),f=l&&c.OG&&c.OG.isValid&&a===c.OG.node?Qd.SelectionFactory.tj(c.OG.node,!c.yf):Qd.SelectionFactory.Du(cr.TableNodeContext.create(Object(oa.a)(ug.a,a)),c.yf)}else l?(c=a.t6,c.yf&&(c=c.Jvb(),c.nq=a.L0a)):c.yf?c=c.Jvb():c.nq=a.Gja,f=Object(oa.a)(Yl.TableCellNode,this.XPc(c,!0)),f?f.isGhostCell&&(x=f,f=f.Xy()):(f=Object(oa.a)(Yl.TableCellNode,c.jg.Ua.node),x=c.nq?Object(oa.a)(Yl.TableCellNode,c.nq.currentNode):null),f=
Qd.SelectionFactory.tj(Object(oa.a)(ug.a,f),!0);f&&x&&(f.nq=tb.GraphIterator.nb(Object(oa.a)(ug.a,x)))}return f}zXi(a,b){let c=a.mb;var f=null;if(a.Hl){const l=a.uja<a.gza;let x=null;if(b){if(c.nq=a.Gja,a=Object(oa.a)(Yl.TableCellNode,this.XPc(c,!1)))a.isGhostCell&&(x=a,a=a.Xy()),f=l&&c.OG&&c.OG.isValid&&a===Object(oa.a)(123,c.OG.node)?Qd.SelectionFactory.tj(c.OG.node,!c.yf):Qd.SelectionFactory.Du(cr.TableNodeContext.create(Object(oa.a)(ug.a,a)),c.yf)}else l?(c=a.t6,c.yf&&(c=c.Jvb(),c.nq=a.L0a)):
c.yf?c=c.Jvb():c.nq=a.Gja,f=Object(oa.a)(Yl.TableCellNode,this.XPc(c,!1)),f?f&&f.isGhostCell&&(x=f,f=f.Xy()):(f=Object(oa.a)(Yl.TableCellNode,c.jg.Ua.node),x=c.nq?Object(oa.a)(Yl.TableCellNode,c.nq.currentNode):null),f=Qd.SelectionFactory.tj(Object(oa.a)(ug.a,f),!0);f&&x&&(f.nq=tb.GraphIterator.nb(Object(oa.a)(ug.a,x)))}return f}}Object(m.a)(gF,"TableCellSelectionStrategy",fF,[]);class eP extends kz{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){super(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc);this.p_h=
l;this.mTh=c;this.Dwc=Kc}Z0b(a,b){var c=Object(oa.a)(Xo,b);c&&c.KZa&&this.lri(this.mTh.G1e)&&(c=c.KZa.sa(Wl.a.Wb,""),this.Dwc.Bic(c),this.Dwc.KB(6,c));return super.Z0b(a,b)}lri(a){const b=new vC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;a=tb.GraphIterator.nb(a);let c=a.Gi();for(;c;)b.enqueue(c),c=a.jp()}return!1}IMc(a,b){var c=Object(oa.a)(Xo,b);if(c&&c.KZa){c=c.KZa.sa(Wl.a.Wb,"");const f=Object(oa.a)(5,this.p_h.Na.mb.Ye.node);f&&(f.Wb=c)}return super.IMc(a,b)}}Object(m.a)(eP,
"PPTClipboardOperationCutCopy",kz,[]);class fP{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){this.Ca=a;this.ld=b;this.es=c;this.DZ=x;this.Tc=l;this.Di=f;this.sr=H;this.kf=U;this.Rha=ja;this.yK=ya;this.Sha=Va;this.Dpb=hb;this.T4a=yb;this.$a=Zb;this.ik=fc;this.Dwc=Kc}create(){return new eP(this.Ca,this.ld,this.es,this.Di,this.Tc,this.DZ,this.sr,this.kf,this.Rha,this.yK,this.Sha,this.Dpb,this.T4a,this.$a,this.ik,this.Dwc)}}Object(m.a)(fP,"Factory",null,[380]);class gP{constructor(){}get Ghd(){return!1}jsb(){}get mYg(){return!1}set mYg(a){}get Ykk(){return!1}Ana(){}eZa(){}get w0g(){return-1}get XMc(){return null}}
Object(m.a)(gP,"NoImageSteward",null,[1230]);class hF{constructor(a){this.Mec=a}create(a,b){return this.Mec||1!==a?new gP(b):null}}Object(m.a)(hF,"PPTImageStewardFactory",null,[1224]);class Eq extends Zr{constructor(a,b,c,f,l,x,H){super(a,b,c);this.ia=f;this.wx=l;this.Cc=H;this.P$j=x.pDk;this.SWa=x.Mie;this.q$j=x.Lie;this.Mec=x.Mzb;this.Q$j=x.aSj}fke(a,b,c){const f=Eq.n_f(c);a=(!P.a.instance.ga(82)||this.eRj(a,b,f))&&super.fke(a,b,c);3===c.OQa?this.Cc.Hw(2,f):2===c.OQa&&this.Cc.Hw(3,f);a&&(this.Cc.Bic(f),
this.cGh(b,f));return a}wXe(a,b,c){const f=Eq.n_f(c);a.setAttribute(pu.a.LDf,f);let l=!1;const x=Eq.cRj(a);if(x)xa.a.J(17310354,826,50,null),l=!0;else if(this.Q$j&&1===a.getElementsByTagName("Table").length&&!b.iterator.rc(60))this.Cc.KB(6,f),l=!0;else{const H=Hb.b(a);H&&H.length||!Eq.y5b(a)||(xa.a.J(17310356,826,50,null),l=!0)}l&&!Eq.Pmh&&(u.AFrameworkApplication.JL("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Eq.Pmh=!0);if(!this.P$j)return!0;l&&(this.Mec&&this.Tkg(c)?
xa.a.J(36779848,826,50,"Paste text only action."):(xa.a.J(17310358,826,50,null),this.MTi(a.cloneNode(!0),x)));if(a=!l&&super.wXe(a,b,c))this.Cc.Bic(f),this.Cc.KB(1,f),this.cGh(b,f);return a}MTi(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.SWa||this.q$j)&&this.wx.fui(a.firstChild,a));Tc.a.Faa(()=>{this.ia.La(K.a.r9g,2,a)},100)}eRj(a,b,c){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Eq.Jlj(a);
if(1!==a.count)return!1;this.Cc.KB(6,c);a=a.ga(0);return!u.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.yxj(a)?!1:Eq.xRj(b)}c=Object(oa.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.jL())?c.getContainingTable():null);return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.al&&b.node.Sa(kb.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.Lp()}yxj(a){a=a.getElementsByTagName("Table");if(1===
a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");if(!f||!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}cGh(a,b){if(Object(oa.a)(5,a.node)&&a.iterator)if(a.iterator.rc(10)){if(a=Object(oa.a)(4,a.iterator.Pw(10)))a.Wb=b}else a.iterator.rc(60)&&(a=Object(oa.a)(1105,a.iterator.Pw(60)))&&(a.Wb=b)}static Jlj(a){a=a.getElementsByTagName("Table");
if(1===a.length){var b;return b=new Ka.a,b.add(a[0]),b}b=new Ka.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static xRj(a){return a.al&&a.node.Sa(kb.a.cellId)&&a.iterator.rc(14)?!0:!1}static y5b(a){a=a.getElementsByTagName(lf.a.W8);if(!a.length)return null;a=a[0];return a.src?a:null}static cRj(a){return!!a.firstChild&&!!a.firstChild.className&&
KR.a.$fg(a.firstChild.className)}static n_f(a){let b="";a&&a.KZa&&(b=a.KZa.sa(Wl.a.Wb,""));return b}}Eq.Pmh=!1;Object(m.a)(Eq,"PPTPasteCoordinator",Zr,[]);class hP{constructor(){}jsb(){}get Mca(){return!1}pY(){}mY(){}oY(){}nY(){}lY(){}kY(){}}Object(m.a)(hP,"TextOnlyTableSteward",null,[506,507]);class iF{constructor(a){this.Mec=a}create(a,b){return this.Mec||1!==a?new hP(b):null}}Object(m.a)(iF,"PPTTableStewardFactory",null,[475]);class jF{constructor(a,b,c){this.L8j=a;this.Iak=b;this.la=c}cQe(){this.L8j.execute(a=>
{this.la.Rke&&a.nQe(this.Iak.value)})}}Object(m.a)(jF,"AccessibilityActor",null,[]);class wu{get key(){return"LIST"}get e8(){return Box4Intl.Box4Strings.l_ListContentTitle}e3e(a){let b;b=null;const c=wu.Sf.jw(a);if(!c)return{returnValue:!1,Itb:b};a=this.Lbj(a,c);b=Object.assign(new gz,{a1:this.key,contentId:a.listId,bQ:a});return{returnValue:!0,Itb:b}}$Rc(a,b){a=a.bQ;const c=this.Qaj(a.IT),f=new Nj.a;b?(b=b.bQ,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
a.level)),f.add(c)):b.id.equals(a.id)&&b.IT.listType===a.IT.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));return f.toArray().join(" ")}Qaj(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.hX);else if(1===a.listType)switch(c){case 1:b=this.SAf;break;case 2:b=this.Hli;break;case 3:b=this.Ili;break;default:b=
this.SAf}return b}static get Sf(){return wu.Vg||(wu.Vg=Db.a.instance.resolve("Box4.List.IListReader"))}}wu.Vg=null;Object(m.a)(wu,"ListDetailsProvider",null,[518,519]);class iP{constructor(){this.IT=this.listId=this.id=null;this.level=0}}Object(m.a)(iP,"ListItemInfo",null,[]);class kF extends wu{constructor(a){super();this.uH=a}get SAf(){return ResourceStrings.l_BulletStyle1}get Hli(){return ResourceStrings.l_BulletStyle1}get Ili(){return ResourceStrings.l_BulletStyle1}Lbj(a,b){const c=this.uH.nda(a),
f=this.uH.Jbj(a);return Object.assign(new iP,{id:a.currentNode.id,listId:new ka.a(Ug.a.nil,f),IT:b,level:c+1})}}Object(m.a)(kF,"ListDetailsProvider",wu,[]);class jP{constructor(){this.lH=this.K=null}dispose(){}Zb(a){this.K=a;this.lH=this.K.resolve("Common.AFrameworkApplication");a.register(hF,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().oa(()=>new hF(a.resolve("PowerPointWebEditor.IApplicationSettings").Mzb));a.register(iF,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().oa(()=>
new iF(a.resolve("PowerPointWebEditor.IApplicationSettings").Mzb));a.register(Zr,"Box4.Actors.PasteCoordinator").ma().oa(()=>new Eq(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(380,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().oa(()=>new fP(u.AFrameworkApplication.Ta,Nc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),qd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),yj.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(kF,"PowerPointWebEditor.ListDetailsProvider").oa(()=>new kF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(jF,"PowerPointWebEditor.AccessibilityActor").ma().oa(()=>new jF(a.Ja("Box4.Accessibility.IAccessibilityContextManager"),a.ie("PowerPointWebEditor.ListDetailsProvider"),this.lH.FS.od));a.register(gF,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().oa(()=>
new gF)}init(){const a=Oc.App.OD.QS;Ux.oEj(this.lH.wq,this.K.resolve("Common.IReactContextualUILauncher"),a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));this.K.resolve("PowerPointWebEditor.AccessibilityActor").cQe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(m.a)(jP,"Box4DelayedLoadedPackage",null,[2,3]);class kP{constructor(a,b,c,f,l,x,H,U){this.Acb=this.kva=null;this.B2c=0;this.x2c=new Rd.a(0);this.Scb=this.ise=this.fdc=null;this.y2c=!1;this.Wwg=[ta.a.contextMenu,
ta.a.vza,ta.a.OM,ta.a.mouseDown,ta.a.pointerDown,ta.a.jQa,ta.a.sgb,ta.a.paste];this.dWg=[ta.a.Yf,ta.a.Il,ta.a.jy,ta.a.click,ta.a.doubleClick,ta.a.CR,ta.a.KSd,ta.a.EJ,ta.a.qdd];this.fJ=a;this.dpe=c||[];this.l5j=f||[];this.Kqe=l||[];this.lTg=x;this.Oc=b;this.Oc.B8h(Object(F.a)(this,this.x1g,"onAppClosing"));this.Oc.KA(Object(F.a)(this,this.DB,"onSessionEnd"));this.r9c=H;U&&(La.EventHandlerManager.instance.iQe(this.Wwg,Object(F.a)(this,this.Zqk,"onBeforeEventActionContextCreated")),La.EventHandlerManager.instance.Fgh(this.Wwg,
Object(F.a)(this,this.mqk,"onAfterEventActionContextCreated")),La.EventHandlerManager.instance.iQe(this.dWg,Object(F.a)(this,this.$qk,"onBeforeEventTriggered")),La.EventHandlerManager.instance.Fgh(this.dWg,Object(F.a)(this,this.nqk,"onAfterEventTriggered")));this.Rwe=!1}D5(a){if(2===a.behavior){var b=a.actionId;if(this.Noa(b)){var c=this.getCommandName(b);xa.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.Kcg(a,c,"",!1)+"; Current Event: "+(this.Scb||"")+"; Current ActionContext: "+
(Tc.a.Ib?Tc.a.Ib.toString():""));if(!this.B2c)if(this.y2c=!0,this.Sgl(a)){this.kva=Tc.a.Std(c);this.Rwe=!0;a=a.telemetryData;c=this.fdc;let f=this.ise;null===c&&a&&a[ni.a.zDa]&&(c=a[ni.a.zDa],f=Tc.a.Ilb(c));null!==f&&(this.kva.Va(ni.a.S5a,f.toFixed(2)),null!==c&&this.kva.Va(ni.a.zDa,c.toFixed(2)));a&&pa.a.forEach(a,(l,x)=>{this.kva.Aza(l,(null===x||void 0===x?void 0:x.toString())||"")},null);c=!1;Array.contains(Tl.l7k,b)?c=!0:this.kva.Ur=!0;c=c||this.Nj(b,a);this.kva.Nj=c}else this.kva=Tc.a.Ib}this.B2c++}}C5(a){if(2===
a.behavior){var b=a.actionId;if(this.Noa(b)){var c=Tc.a.Ib;const f=c?c.cK(ni.a.Arf).toString():"";xa.a.J(18956762,817,50,"ActionContextListener::OnAfterAction "+this.Kcg(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.Scb||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.cK(ni.a.BY).toString():""))}this.pjl(b)&&(c=this.x2c.wTc(b,0),this.x2c.add(b,c+1));this.B2c--;0<this.B2c||!Tc.a.Ib||!this.kva||(Tc.a.zk(ni.a.Z3h,a.response.toString()),
Tc.a.Ib!==this.kva||this.Acb||this.r1g(),this.kva=null)}}r1g(){const a=Tc.a.Ib;if(a){var b=new Date;a.Nj&&!a.GMb&&null===a.sF&&(a.sF=b);a.Aza(ni.a.T3h,(+b-+a.KD).toString());a.Ur?0<a.cK(ni.a.BY).length&&Tc.a.Ofa(a):Tc.a.ztd();this.Rwe&&(Tc.a.Ib=null,this.Rwe=!1)}}Noa(a){if(!this.lTg)return!1;if(Array.contains(this.dpe,a))return!0;a=u.AFrameworkApplication.Ta.dT(a);return!!a&&!(a.flags[32]||a.flags[64])}Nj(a,b){return Array.contains(this.l5j,a)?b&&ni.a.GFc in b?b[ni.a.GFc]:!0:!1}pjl(a){return this.lTg&&
Array.contains(this.Kqe,a)}Sgl(a){return this.r9c?!Tc.a.Ib:!Tc.a.Ib&&a.Oi}Kcg(a,b,c,f){if(null===a)return"null";b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.$Hc+", InvocationMethod="+a.sT+", CommandLocation="+a.xq+", CommandTabName="+a.Xra;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.fJ?this.fJ.W5(a):null;return b?b:a.toString()}x1g(){if(!(1>this.x2c.count)){var a={};this.x2c.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});
xa.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",xd.c(a));this.Oc.NXk(Object(F.a)(this,this.x1g,"onAppClosing"))}}DB(){Tc.a.Gsi()}Zqk(a){this.Scb=a.type;this.Acb=Tc.a.Std(this.Scb);this.Acb.Nj=!0;this.y2c=!1;a=Tc.a.Ctd(a);null!==a&&Tc.a.syl(a)&&this.Acb.Va(ni.a.zDa,a.toFixed(2))}mqk(){this.Acb&&Tc.a.Ib===this.Acb&&this.y2c&&this.r1g();Tc.a.Ib=null;this.y2c=!1;this.Acb=this.Scb=null}$qk(a){this.Scb=a.type;this.fdc=Tc.a.Ctd(a);null!==this.fdc&&(this.ise=Tc.a.Ilb(this.fdc))}nqk(){this.Scb=
this.ise=this.fdc=null}}Object(m.a)(kP,"ActionContextListener",null,[141]);var aS=d(374),bS=d(437);class lF{constructor(){this.K=null;this.bwg=[];this.Qk=null;this.Zva="";this.OX=[new jP,new $O];this.a$=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Zb(a){this.Zva=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());Cg.a.instance.ic("EditingPackageConfigureStart",Date.now());this.K=a;this.wb();for(const b of this.OX)b.Zb(a);
this.K.resolve("PowerPointWebEditor.IApplicationSettings").$ig&&this.K.register(261,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().oa(()=>new aP(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(aF,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().oa(()=>new aF(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}Prj(a,b,c){return 1===c?32:2===c?(this.JEj(),xa.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(K.a.Beg,
2),32):8}fEj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");a.Oq();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}ueg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.vLf=!0;b.xzh=a;b.Qpg()}B_j(a,b){xa.a.J(512497351,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.e0j().continueWith(l=>{var x=new Date;xa.a.J(512497350,813,50,
"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Tc.a.nf(c),Tc.a.nf(x),+x-+c);if(6===l.status){l=aK.a({});const H=(x=lD())&&l&&(b||a);xa.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:x,["shouldUseShapeBuilder"]:H});l=H?document.createElement("canvas"):null;f.CEj(l,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(l=>
{6!==l.status&&xa.a.J(512497348,835,10,"Exception: {0}",l.Yi)})}MFj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").Tpg()}JEj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").Nbb().continueWith(()=>{this.K.resolve("PowerPointWebEditor.WetInkView")})}wb(){this.K.resolve("Common.IActionManagerExtended").ya(K.a.Yjh,de.a.frame,Object(F.a)(this,this.Prj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;
this.Zva=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Zva,(new Date).getTime(),a);Cg.a.instance.ic("EditingPackageInitStart",Date.now());a?(this.Qk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.Qk.Iuf(Object(F.a)(this,this.Wdg,"initEditingPackage"))):this.Xdg()}Wdg(){this.Qk.Jih(Object(F.a)(this,this.Wdg,"initEditingPackage"));this.Xdg()}Xdg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Zva=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",
this.Zva,a.Kka,(new Date).getTime());a.bFa(()=>{this.SCj(a)});a.Vfg(()=>{this.Iyi()})}SCj(a){this.Zva=String.format("{0}, InitStartInternal:{1}",this.Zva,(new Date).getTime());Cg.a.instance.ic("EditingPackageInitStartInternal",Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new dP;f.Zb(this.K);f.load(b);for(const x of this.OX)x.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(Db.a.instance.resolve("PowerPointWebEditor.IImageViewManager").Fkb(),
c.OUa&&b.wq.kcg());this.fEj();this.K.resolve("Common.IActionManagerExtended").oaa(new kP(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Tl.dqg,Tl.W0j,c.Avi,c.mRj,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.QIa){let x=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=Kj.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma))?x=b.Bca:xa.a.J(512497347,809,10,"slideViewElement is null."):
xa.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").pj());this.K.register(262,"PowerPointWebEditor.ICommentShimmerView").ma().oa(()=>new bP(x,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Common.ITaskManager"),c.Vvi))}this.K.resolve("Common.IActionManagerExtended").oaa(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));
a.eua||(Ci.a.instance.xPe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&c.QIa&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),aS.a.sRk(),this.K.resolve("PowerPointWebEditor.ISessionState").R5("AppInteractive"),this.a$&&Cg.a.instance.ic("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").Z$("canvas","slide"),
c.podTransmitMetricsBeaconOnBoot&&(Tz.App.pLb(null,ai.a.contentEditable),this.x1j()),gb.a.get_instance().XJ(4),a.eua=!0);c.QIa&&((a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(a=a.XD(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").Jag(a)&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").nml(),xa.a.J(512497345,809,50,"CommentLandingSlide: true"))):xa.a.J(512497344,809,10,"activeSlide is null"));Cg.a.instance.ic(bS.a.k2d,(new Date).getTime());c.euc?
this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1246))):(a=Kx.a.create("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1246))),cl.a.ey(a));this.MFj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&xa.a.J(512497315,809,50,"HighContrastMode enabled");!c.Aie||a&&a.isInHighContrastMode?c.mee&&c.Aie&&this.ueg(!1):this.ueg(!0);c.lVc&&(this.bwg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),
this.B_j(c.YQc,c.Q0i));u.AFrameworkApplication.av||(u.AFrameworkApplication.av=xa.a.p1b());c.$ig&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.ub("Common.IFrameTimingMeter");l&&(xa.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Db(new af.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,
()=>{l.stop()},90,"93")));this.Zva=String.format("{0}, InitDone:{1}",this.Zva,(new Date).getTime());Cg.a.instance.ic("EditingPackageInitDone",Date.now());xa.a.J(512497313,809,50,this.Zva)}Iyi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");xa.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.aHh("{"+u.AFrameworkApplication.userSessionId+
"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").I8i();f&&(c.juc(0<f.length?2:1),c.uGh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").Y1j(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").uSf();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").yeg();xa.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
u.AFrameworkApplication.fa.gf(Object(F.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").iyh,"startServerRtcConnection"))}x1j(){if(Cg.a.instance.K$a)xa.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[ai.a.MDa,ai.a.dYf,ai.a.fYf,ai.a.MQc,ai.a.eYf,ai.a.Brb,ai.a.kHc,ai.a.Pca,ai.a.cQ,ai.a.contentEditable,ai.a.Huc,"UserClickTime",
"DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","BootJsStartTime","BootJsEndTime",ai.a.$ld,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime",
"EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",ai.a.o4b,ai.a.p4b,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime",
"OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart",
"ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])Cg.a.instance.Io(b)&&(a[b]=Cg.a.instance.hh(b));u.AFrameworkApplication.fa.Ga("PodSID")&&(a.PodSessionID=u.AFrameworkApplication.fa.Ga("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&
(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:Cg.a.instance.Io("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=Cg.a.instance.hh("ThumbnailShimmerHideTime"));xa.a.J(39184516,809,50,"Perf metrics: "+pa.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.GPj&&this.r3j(a,b)}}r3j(a,b){if(a[ai.a.cQ])if(a[ai.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[ai.a.contentEditable]-a[ai.a.cQ]>b.hhi){var c=
new Map;c.set("ContentEditable",a[ai.a.contentEditable].toString());c.set("ContentViewable",a[ai.a.cQ].toString());kf.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new Oj.a,{extendedProperties:c}))}c=b.iTi;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[ai.a.cQ]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[ai.a.cQ].toString()),kf.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],
!1,!0,!1,!1,Object.assign(new Oj.a,{extendedProperties:c})))}else xa.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else xa.a.J(512497309,809,15,"ContentEditable is null");else xa.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.OX)a.dispose();for(const a of this.bwg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();xa.a.J(38876352,809,50,"EditingPackage::Register time:{0}",
a);Cg.a.instance.ic("EditingPackageRegisterTime",a);z.a.instance.Dc(new lF)}}Object(m.a)(lF,"EditingPackage",null,[2,3]);var cS=d(579);class mF{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb,fc,Kc){this.ima=this.d$=!1;this.hM={};this.B4=this.mJ=null;this.pxa=()=>{this.d$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");
if(!x)throw Error.argumentNull("shapeReader");if(!H)throw Error.argumentNull("pageView");if(!U)throw Error.argumentNull("actionManager");if(!ja)throw Error.argumentNull("slideDimensionsHelper");if(!ya)throw Error.argumentNull("presentationReader");if(!Va)throw Error.argumentNull("transactionFactory");if(!hb)throw Error.argumentNull("pptPageView");if(!yb)throw Error.argumentNull("applicationSettings");if(!Zb)throw Error.argumentNull("viewElementEventHandlers");if(!fc)throw Error.argumentNull("viewCoreEventHandlers");
this.Rb=a;this.Kc=b;this.Le=c;this.GIa=f;this.pa=l;this.Fa=x;this.Fb=H;this.ia=U;this.gu=Kc;this.ty=ja;this.oc=ya;this.Jb=Va;this.tgc=hb;this.QAe=yb.qmh;this.SAe=yb.pmh;this.qd=Zb;this.BJ=fc}get ric(){return document.getElementById(S.AppFrame.mJh)}dispose(){this.d$=!1;this.Rb.kih(Object(F.a)(this,this.renderRuler,"renderRuler"));Id.a.removeHandler(this.ric,ta.a.scroll,Object(F.a)(this,this.Slb,"updateRulerLocation"));this.qd.lRe(Object(F.a)(this,this.Njc,"onCloseTextEditView"));this.qd.wld(Object(F.a)(this,
this.lkc,"onOpenTextEditView"));this.BJ.lld(this.pxa);this.mJ&&this.B4?(Ca.a.pKa(this.mJ,"ShowWACHorizontalRulerContainer"),Ca.a.zI(this.mJ,"HideWACHorizontalRulerContainer"),mj.UISurfaces.WTc().then(a=>{a.dispose(this.B4);return null}),this.mJ.removeChild(this.B4),this.GIa.removeChild(this.mJ),this.B4=this.mJ=null):xa.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.mJ&&this.B4){Ca.a.pKa(this.mJ,"HideWACHorizontalRulerContainer");
Ca.a.zI(this.mJ,"ShowWACHorizontalRulerContainer");var b=this.Kc.Ic;if(b&&b.Fd){var c=b.Fd;c=new hr.a(c.oq,c.Vk);b=this.ty.q6b(c,b.Bca?b.Bca.xa.style.visibility===Ri.a.visible:!1).width;c=this.Le.$h(this.Kc.Ic.JB).width;1===this.tgc.Fl||0>=b||0>=c?xa.a.J(512496003,824,50,"Ruler should not be rendered"):(this.hM.rulerCanvasProps=this.uFk(Rf.a.Gfa(b,0)),c=Object(F.a)(this,this.huk,"onIndentChange"),this.hM.onIndentChange=c,this.hM.indents=this.hM.rulerCanvasProps.textEditableArea?this.YFk():null,this.hM.rtl=
this.ima?!this.gu:this.gu,this.hM.inverted=this.ima?!this.gu:this.gu,this.B4.style.width=this.Le.Pc(b),this.Slb(null),mj.UISurfaces.WTc().then(f=>{f.renderRuler(this.B4,this.hM);return null}),b=window.performance.now(),xa.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else xa.a.J(512496004,824,50,"Unable to get slideViewElement")}else xa.a.J(512496005,824,50,"Ruler container div / Ruler div null")}uFk(a){const b={},c=ye.a.Ov(this.oc.Ym.eb(kb.a.slideWidth));var f=a/2;let l=
0,x=Rf.a.dK(a,0);b.zeroScale=Rf.a.dK(f,0);this.ima=!1;b.textEditableArea=!1;if(this.pa.z_()&&!this.pa.dVa()){f=this.pa.o_();var H=f.sc(this.Fb.Ma),U=H.rotation;U>this.QAe&&U<this.SAe&&(this.ima=!0);const ja=H.htmlElement.querySelector(".ShapeViewContent"),ya=this.Fa.eTc(f,this.Fb.Ld);U=0;f.Ng&&(U=f.ys().sc(this.Fb.Ma).htmlElement.offsetLeft);U+=H.htmlElement.offsetLeft+ja.parentNode.offsetLeft+(ya?ya.e:0);H=U+ja.offsetWidth;f=(this.ima?!this.gu:this.gu)?H:U;U>=l&&U<=x&&H>=l&&H<=x&&(l=U,x=H,b.zeroScale=
f,b.textEditableArea=!0)}U=ye.a.Tta(c)/a;a=U*Rf.a.Gfa(x-l,0);U*=Rf.a.Gfa(l,0);b.leftMargin=l;b.rightMargin=x;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=ye.a.fMa(a);b.leftBoundary=ye.a.fMa(U);return b}lkc(){this.d$&&this.renderRuler()}Njc(){this.d$&&this.renderRuler()}YFk(){var a={};if(32!==this.ia.La(D.a.eJb,2,a))return xa.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};
a=a.aB;if(!a)return xa.a.J(512496E3,824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?ye.a.fMa(a.kNb+a.QN):2===a.specialIndentType?ye.a.fMa(a.QN-a.kNb):ye.a.fMa(a.QN);c.value=ye.a.fMa(a.QN);f.value=ye.a.fMa(a.QN);return[b,c,f]}huk(a,b){const c=new cS.a;c.unit=1;c.value=ye.a.Tta(b);this.pCj(a,c)}pCj(a,b){var c=this.pa.o_();if(a&&b&&c){var f=window.performance.now(),l=this.Jb.me(15);l.nc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.La(K.a.fMb,2,b);l.jd=K.a.fMb;break;case "HangingIndent":c=
this.ia.La(K.a.hMb,2,b);l.jd=K.a.hMb;break;case "LeftIndent":c=this.ia.La(K.a.Cka,2,b);l.jd=K.a.Cka;break;default:xa.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();xa.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&xa.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else xa.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}OJ(){this.MOd();this.d$=!0;this.Rb.huf(Object(F.a)(this,
this.renderRuler,"renderRuler"));Id.a.addHandler(this.ric,ta.a.scroll,Object(F.a)(this,this.Slb,"updateRulerLocation"));this.qd.JGc(Object(F.a)(this,this.Njc,"onCloseTextEditView"));this.qd.NYb(Object(F.a)(this,this.lkc,"onOpenTextEditView"));this.BJ.qGc(this.pxa)}Slb(){if(this.d$){var a=this.Kc.Ic;a&&a.JB&&window.requestAnimationFrame(()=>{const b=Od.a.A9a(a.JB),c=Od.a.A9a(this.GIa);this.B4.style.marginLeft=this.Le.Pc(b.x-c.x+1)})}else xa.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}QRi(){if(this.mJ)return this.mJ;
this.mJ=document.createElement("div");this.mJ.id="WACHorizontalRulerContainer";this.mJ.className="WACHorizontalRulerContainer";this.mJ.setAttribute(Cc.a.ns,"ruler");this.mJ.setAttribute(Cc.a.ef,Cc.a.bCa);Sys.UI.DomElement.addCssClass(this.mJ,"HideWACHorizontalRulerContainer");return this.mJ}RRi(){if(this.B4)return this.B4;this.B4=document.createElement("div");this.B4.className="WACHorizontalRuler";this.B4.id="WACHorizontalRuler";return this.B4}MOd(){this.mJ=this.QRi();this.mJ.appendChild(this.RRi());
this.GIa.insertBefore(this.mJ,this.GIa.firstChild)}}Object(m.a)(mF,"HorizontalRuler",null,[349]);class nF{constructor(a,b,c,f,l){this.HLj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Rb=b;this.iSg=c;this.R5c=f;this.Obd=l}wb(){this.ia.ra(K.a.Aqd,Cb.a.application,Object(F.a)(this,this.Aqd,
"showHideRuler"),4);this.ia.ra(K.a.vjd,Cb.a.application,Object(F.a)(this,this.vjd,"queryRulerToggle"),96)}qDj(){this.K_c()&&(xa.a.J(523351431,824,15,"Ruler init is called"),this.iSg.teg())}Aqd(a,b,c){return this.K_c()?this.szj(c):this.jml(c)}zHh(){this.Rb.sG({ShowHideRuler:"ToggleButtonModel"})}jml(a){if(1===a)return 32;xa.a.J(523351432,824,15,"ShowRuler called");this.iSg.teg();this.orh(!0);this.Rb.Oq();this.zHh();return 32}szj(a){if(1===a)return 32;xa.a.J(523351433,824,15,"HideRuler called");this.JNi();
this.orh(!1);this.Rb.Oq();this.zHh();return 32}JNi(){this.K_c()&&(this.R5c.dispose(),this.Obd.dispose(),this.Rb.Oq())}vjd(a,b,c,f,l){if(1===c)return 32;l&&(l[Sh.a.On]=this.K_c());return 32}K_c(){return ki.a.B3(ix.a.Pah,this.HLj)}orh(a){ki.a.$J(u.AFrameworkApplication.fa.Ga("IsRulerOnCookieName"),a.toString(),ki.a.DJ)}}Object(m.a)(nF,"RulerActor",null,[]);class lP{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");
this.R5c=a;this.Obd=b;this.Rb=c}teg(){this.R5c.OJ();this.Obd.OJ();this.Rb.Oq();this.R5c.renderRuler();this.Obd.renderRuler()}}Object(m.a)(lP,"RulerFactory",null,[260]);class Fq{constructor(a,b,c,f,l,x,H,U,ja,ya,Va,hb,yb,Zb){this.nTd="HideWACVerticalRulerContainer";this.WBf="ShowWACVerticalRulerContainer";this.ima=this.d$=!1;this.o5=this.AJ=null;this.pxa=()=>{this.d$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!l)throw Error.argumentNull("selectionManager");if(!x)throw Error.argumentNull("shapeReader");if(!H)throw Error.argumentNull("pageView");if(!U)throw Error.argumentNull("slideDimensionsHelper");if(!ja)throw Error.argumentNull("presentationReader");if(!ya)throw Error.argumentNull("pptPageView");if(!Va)throw Error.argumentNull("applicationSettings");if(!hb)throw Error.argumentNull("viewElementEventHandlers");if(!yb)throw Error.argumentNull("viewCoreEventHandlers");this.Rb=a;this.Kc=b;this.Le=c;this.GIa=
f;this.pa=l;this.Fb=H;this.oc=ja;this.gu=Zb;this.ty=U;this.tgc=ya;this.QAe=Va.qmh;this.SAe=Va.pmh;this.qd=hb;this.BJ=yb}get ric(){return document.getElementById(S.AppFrame.mJh)}dispose(){this.d$=!1;Id.a.removeHandler(this.ric,ta.a.scroll,Object(F.a)(this,this.Slb,"updateRulerLocation"));this.Rb.kih(Object(F.a)(this,this.renderRuler,"renderRuler"));this.qd.lRe(Object(F.a)(this,this.Njc,"onCloseTextEditView"));this.qd.wld(Object(F.a)(this,this.lkc,"onOpenTextEditView"));this.BJ.lld(this.pxa);this.AJ&&
this.o5?(Ca.a.pKa(this.AJ,this.WBf),Ca.a.zI(this.AJ,this.nTd),mj.UISurfaces.WTc().then(a=>{a.dispose(this.o5);return null}),this.AJ.removeChild(this.o5),this.GIa.removeChild(this.AJ),this.o5=this.AJ=null):xa.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.AJ&&this.o5){Ca.a.pKa(this.AJ,this.nTd);Ca.a.zI(this.AJ,this.WBf);var b=this.Kc.Ic;if(b&&b.Fd){var c=b.Fd;c=new hr.a(c.oq,c.Vk);b=this.ty.q6b(c,b.Bca?b.Bca.xa.style.visibility===
Ri.a.visible:!1).height;c=this.Le.$h(this.Kc.Ic.JB).height;if(1===this.tgc.Fl||0>=b||0>=c)xa.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.$Fk(Rf.a.Gfa(b,1));f.rtl=this.ima?!this.gu:this.gu;f.inverted=this.ima?!this.gu:this.gu;this.o5.style.height=this.Le.Pc(b);this.Slb(null);mj.UISurfaces.WTc().then(l=>{l.renderRuler(this.o5,f);return null});b=window.performance.now();xa.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else xa.a.J(512495964,
824,50,"Unable to get slideViewElement")}else xa.a.J(512495965,824,50,"Ruler container div / Ruler div null")}$Fk(a){const b={},c=ye.a.Ov(this.oc.Ym.eb(kb.a.slideHeight));var f=a/2;let l=0;a=Rf.a.dK(a,0);b.zeroScale=Rf.a.dK(f,0);this.ima=!1;b.textEditableArea=!1;if(this.pa.z_()&&!this.pa.dVa()){f=this.pa.o_();var x=f.sc(this.Fb.Ma);const U=x.htmlElement.querySelector(".ShapeViewContent");var H=x.rotation;H>this.QAe&&H<this.SAe&&(this.ima=!0);H=0;f.Ng&&(H=f.ys().sc(this.Fb.Ma).htmlElement.offsetTop);
H+=x.htmlElement.offsetTop+U.parentNode.offsetTop+U.offsetTop;x=H+U.offsetHeight;f=(this.ima?!this.gu:this.gu)?x:H;H>=l&&H<=a&&x>=l&&x<=a&&(l=H,a=x,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}OJ(){this.MOd();this.d$=!0;Id.a.addHandler(this.ric,ta.a.scroll,Object(F.a)(this,this.Slb,"updateRulerLocation"));this.Rb.huf(Object(F.a)(this,this.renderRuler,"renderRuler"));this.qd.JGc(Object(F.a)(this,this.Njc,"onCloseTextEditView"));
this.qd.NYb(Object(F.a)(this,this.lkc,"onOpenTextEditView"));this.BJ.qGc(this.pxa)}Slb(){if(this.d$){var a=this.Kc.Ic;a&&a.JB&&window.requestAnimationFrame(()=>{const b=Od.a.A9a(a.JB),c=Od.a.A9a(this.GIa);this.o5.style.marginTop=this.Le.Pc(b.y-c.y+1)})}else xa.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}lkc(){this.d$&&this.renderRuler()}Njc(){this.d$&&this.renderRuler()}MOd(){this.AJ=this.NSi();this.AJ.appendChild(this.OSi());this.GIa.insertBefore(this.AJ,this.GIa.firstChild)}NSi(){if(this.AJ)return this.AJ;
this.AJ=document.createElement("div");this.AJ.id=Fq.Fni;this.AJ.className=Fq.Eni;this.AJ.setAttribute(Cc.a.ns,"ruler");this.AJ.setAttribute(Cc.a.ef,Cc.a.bCa);Sys.UI.DomElement.addCssClass(this.AJ,this.nTd);return this.AJ}OSi(){if(this.o5)return this.o5;this.o5=document.createElement("div");this.o5.className=Fq.Dni;this.o5.id=Fq.Gni;return this.o5}}Fq.Fni="WACVerticalRulerContainer";Fq.Eni="WACVerticalRulerContainer";Fq.Gni="WACVerticalRuler";Fq.Dni="WACVerticalRuler";Object(m.a)(Fq,"VerticalRuler",
null,[349]);class oF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Zb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").ejb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(mF,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().oa(()=>new mF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Yuc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
u.AFrameworkApplication.isRtl));this.K.register(Fq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().oa(()=>new Fq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Yuc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(260,"PowerPointWebEditor.Ruler.IRulerFactory").ma().oa(()=>new lP(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(nF,
"PowerPointWebEditor.Ruler.RulerActor").ma().oa(()=>new nF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").wb();gb.a.get_instance().ek(8,()=>{this.IGe()})}}IGe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").qDj()}dispose(){}static main(){z.a.instance.Dc(new oF)}}
Object(m.a)(oF,"PPTWebEditorRulerPackage",null,[2,3]);class uA{static get iLl(){return uA.jLl}}uA.jLl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(m.a)(uA,"ZoomDialogHtml",null,[]);class ey extends Zh.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.dYb=this.cYb=this.Da=this.Fvc=null;this.dLl=
"ZoomDialogBoxGroup";this.uPa=a;this.wFc=b;this.lrf=c;this.Nd=f;this.rg=this.Zji();this.xd=1;this.hg="ZoomDialog"}get UOe(){return"ListRadioBox"}get Hnc(){return"radiobox"}get Jdh(){return"WACZoomDialogRadioRow"}get TOe(){return"WACZoomDialogRadioRow-highlight"}get Mo(){return this.Nd}get I7(){return this.Fvc}mwh(a,b){if(this.KK)this.Tml(a,b);else{const c={};for(let f=0;f<this.uPa.length;f++)c[this.Hnc+f]=this.wFc[f]===b?!0:!1;this.Zi(a,Object(F.a)(this,this.fLl,"zoomDialogHandler"),c);this.vPe();
this.eQe()}}Tml(a,b){var c=Array(this.uPa.length);let f="";for(let l=0;l<this.uPa.length;l++){const x=l.toString();c[l]={["key"]:x,["text"]:this.uPa[l]};b===this.wFc[l]&&(f=x)}b={};b.dialogChoiceGroupProps={["id"]:this.dLl,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.Zi(a,Object(F.a)(this,this.kLl,"zoomDialogReactHandler"),c)}X6k(){this.Fvc=document.getElementsByName(this.UOe)[0];this.pQc(this.I7)}X7(){this.Da||(this.Da=document.getElementById("WACDialogText"));
this.Da&&(this.cYb||(this.cYb=Object(F.a)(this,this.eLl,"zoomDialogClickHandler"),this.yn.pb(ta.a.click,this.Da,this.cYb)),this.dYb||(this.dYb=Object(F.a)(this,this.gLl,"zoomDialogKeyDownHandler"),this.Rg.pb(ta.a.Yf,this.Da,this.dYb)));super.X7();this.Gb&&this.Rg.pb(ta.a.Il,this.Gb,Object(F.a)(this,this.zN,"dialogDefaultEnterKeyHandler"))}vPe(){this.Mo.yl().scope.zp(v.FocusManager.instance().Rqa);this.Mo.yl().scope.zp(v.FocusManager.instance().Sqa);this.Mo.yl().scope.bindAction(v.FocusManager.instance().Rqa,
G.a.gvc);this.Mo.yl().scope.bindAction(v.FocusManager.instance().Sqa,G.a.fvc)}eQe(){const a=document.getElementsByName(this.UOe);for(let b=0;b<a.length;b++){const c=a[b];Id.a.addHandler(c,ta.a.focus,Object(F.a)(this,this.Yjd,"radioButtonFocusHandler"));c.checked&&(this.Fvc=c)}}fLl(a,b){if(1===a)for(a=0;a<this.uPa.length;a++)if(b[this.Hnc+a]){this.lrf(this.wFc[a]);break}}Yjd(a){this.pQc(a.target)}eLl(a){a=a.Ec;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.Jdh))return!1;
a=this.J2f(a);a=document.getElementById(this.Hnc+a);this.pQc(a);return!0}kLl(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.lrf(this.wFc[a]))}gLl(a){a=a.qc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.J2f(this.I7);const c=this.uPa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.Hnc+b);this.pQc(a);return!0}zN(a){return a.eventName===
ta.a.Il&&a.qc.keyCode===Sys.UI.Key.enter?(super.zN(a),!0):!1}pQc(a){a&&(a.checked=!0,this.Mo.Ae&&this.Mo.Ae.name===this.gL||this.Mo.tf(this.gL),this.Mo.yl().vj.YE(a),a.focus(),this.I7&&Sys.UI.DomElement.removeCssClass(this.I7.parentNode,this.TOe),Sys.UI.DomElement.addCssClass(a.parentNode,this.TOe),this.Fvc=a)}J2f(a){return Number.parseInvariant(ha.a.substr(a.id,a.id.length-1,1))}AA(){super.AA();const a=document.getElementById(this.Nh("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}Zji(){let a="";for(let b=0;b<this.uPa.length;b++)a+=Zh.a.sC(ey.hLl,b.toString(),this.uPa[b],this.UOe);return a}dispose(){this.Da&&(this.yn&&this.cYb&&this.yn.yb(ta.a.click,this.Da,this.cYb),this.Rg&&this.dYb&&this.Rg.yb(ta.a.Yf,this.Da,this.dYb));this.yn&&this.Gb&&this.Rg.yb(ta.a.Il,this.Gb,Object(F.a)(this,this.zN,"dialogDefaultEnterKeyHandler"));super.dispose()}}ey.hLl=uA.iLl;Object(m.a)(ey,"ZoomDialog",Zh.a,[426]);class pF{constructor(){this.Af=null}create(a,
b,c,f){return this.Af=new ey(a,b,c,f)}}Object(m.a)(pF,"ZoomDialogFactory",null,[396]);class qF{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Zb(a){this.Da=a;this.Da.register(pF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").oa(()=>new pF).ma()}static main(){z.a.instance.Dc(new qF)}}Object(m.a)(qF,"ZoomPackage",null,[2,3]);class mP{constructor(a,b,c,f,l,x,H,U){this.bjk=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.fcd="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.Af=null;this.ia=a;this.Ea=b;this.oc=l;this.fj=c;this.Rb=f;this.Ik=x;this.xsg=H;this.rXg=U}wb(){this.ia.ra(K.a.NOe,rc.a.application,Object(F.a)(this,this.UMk,"queryZoom"),96);this.ia.ya(K.a.lJe,rc.a.application,Object(F.a)(this,this.ixj,"handleZoomConfig"));this.ia.ya(K.a.hvc,rc.a.application,Object(F.a)(this,this.jxj,"handleZoomToFit"));this.ia.ya(G.a.gvc,de.a.frame,Object(F.a)(this,this.lKh,"zoomDialogTabFocusHandler"));
this.ia.ya(G.a.fvc,de.a.frame,Object(F.a)(this,this.lKh,"zoomDialogTabFocusHandler"));u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(G.a.pub,de.a.frame,Object(F.a)(this,this.pub,"decreaseZoom")),this.ia.ya(G.a.uyb,de.a.frame,Object(F.a)(this,this.uyb,"increaseZoom")),this.ia.ya(G.a.mLl,de.a.frame,Object(F.a)(this,this.szk,"onZoomToPercentage")),this.ia.ra(G.a.VMk,de.a.frame,Object(F.a)(this,this.swk,"onQueryZoomPercentage"),96),Ud.a("ZoomShortCutsEnabled")&&(this.ia.ya(D.a.ALf,
de.a.frame,ld.ActionManager.Mg),this.ia.ya(D.a.zLf,de.a.frame,ld.ActionManager.Mg)))}Ee(){if(u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&Ud.a("ZoomShortCutsEnabled")){const a=this.Ea.Fc(zb.a.gj);a.bindAction(y.KeyInputManager.Oa(A.a.kvd,y.KeyInputManager.Oe),G.a.uyb);a.bindAction(y.KeyInputManager.Oa(A.a.nvd,y.KeyInputManager.Oe),G.a.uyb);a.bindAction(y.KeyInputManager.Oa(A.a.lvd,y.KeyInputManager.Oe),G.a.pub);a.bindAction(y.KeyInputManager.Oa(A.a.Muc,y.KeyInputManager.Oe),G.a.pub);this.xsg&&
qa.a.instance.pb(ta.a.kGb,this.xsg,Object(F.a)(this,this.zci,"adjustZoomOnMouseWheel"))}}zci(a){return a?a.ZZ?(0<a.FJh?this.pMa(this.H_g):0>a.FJh&&this.pMa(this.I_g),!0):!1:!1}get J7a(){return Math.round(100*this.fj.PU)}get I_g(){return Math.floor(this.J7a/10)/10+.1}get H_g(){return Math.ceil(this.J7a/10)/10-.1}UMk(a,b,c,f,l){if(!l||Ud.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.J7a)||0==this.J7a))return 8;l[oE.a.LabelText]=Math.round(100*this.fj.PU)+"%";this.Ik&&(this.Ik.baa(this.Ik.O0a,this.Ik.mKh),
this.Ik.Z$(this.Ik.O0a,this.Ik.mKh));return 32}ixj(a,b,c,f,l){if(1===c)return this.oc.pj()?32:8;if(!l)return 8;this.Af=new ey(this.bjk,this.fcd,Object(F.a)(this,this.Wvd,"zoomSettingAction"),v.FocusManager.instance(),!0);this.Af.mwh(CommonUIStrings.l_ZoomDialogTitle,this.fj.Ska?this.fcd[0]:this.fj.PU.toString());return 32}Wvd(a){if(a!==this.fcd[0]){const b=parseFloat(a);if(isNaN(b)){xa.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.fj.Ska=!1;this.fj.PU=b;this.fj.hmb=2}else this.fj.Ska=
!0;this.Rb.Oq();xa.a.J(512288458,827,50,"Succeeded to Zoom: {0}",a)}jxj(a,b,c,f,l){if(1===c)return Ud.a("ZoomToFitTTVRImprovement")&&this.rXg?this.oc.Ym&&!this.oc.pj()?8:32:this.oc.pj()?32:8;if(!l)return 8;if(Ud.a("ZoomToFitTTVRImprovement")&&this.rXg&&!this.oc.Ym)return xa.a.J(509212699,827,50,"Content Editable hasn't reached yet as presentation node hasn't been set"),8;this.Wvd(this.fcd[0]);return 32}lKh(a){if(!this.Af)return 8;var b=this.Af.Mo.yl().vj.b_;if(b===this.Af.Wv&&a===G.a.gvc||b===this.Af.wD&&
a===G.a.fvc)this.Af.I7||this.Af.X6k(),this.Af.Mo.yl().vj.YE(this.Af.I7);else if(b.id.startsWith(this.Af.Hnc)||b.className.startsWith(this.Af.Jdh))b=null,a===G.a.gvc?b=this.Af.wD:a===G.a.fvc&&(b=this.Af.Wv),this.Af.Mo.yl().vj.YE(b),Sys.UI.DomElement.removeCssClass(this.Af.I7.parentNode,this.Af.TOe);else if(a===G.a.gvc)this.Af.Mo.yl().nGb();else if(a===G.a.fvc)this.Af.Mo.yl().lGb();else return 16;return 32}uyb(a,b,c){if(1===c)return 32;this.pMa(this.I_g);xa.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");
return 32}pub(a,b,c){if(1===c)return 32;this.pMa(this.H_g);xa.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}szk(a,b,c,f,l){if(1===c)return 32;a=l.value/100;this.pMa(a);xa.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.hQ=Math.floor(100*a));return 32}swk(a,b,c,f,l){if(Ud.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.J7a)||0==this.J7a))return 8;l.MinValue=10;l.MaxValue=400;l.value=this.J7a;return 32}pMa(a){.1>a?a=.1:4<a&&(a=4);this.fj.Ska=!1;this.fj.PU=
a;this.fj.hmb=2;this.Rb.Oq()}}Object(m.a)(mP,"ZoomActor",null,[352]);class rF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Zb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");const b=this.K.resolve("Common.IActionManagerExtended"),c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new mP(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),
a.FQd,this.K.resolve("Common.IAppSettingsManager").getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ZoomToFitTTVRImprovement",!1));a.wb();a.Ee()}dispose(){}static main(){z.a.instance.Dc(new rF)}}Object(m.a)(rF,"PPTWebEditorZoomPackage",null,[2,3]);var dS=d(379),eS=d(348),nP=d(660),fS=d(143);class Wv extends nP.a{constructor(){super();this.contextId=this.context=this.numSlides=this.prompt=null;this.H_=Object.assign(new fS.a,{T_:Wv.getTypeName(),B_:Wv.getBaseTypes()})}static getTypeName(){return"AugLoop_Storyteller_StorytellerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(Wv,"StorytellerSignal",nP.a,[]);class gS{}Object(m.a)(gS,"StorytellerDebugParams",null,[]);const Tw=new Map;class oP{constructor(a){this.Dch=new Promise((b,c)=>{this.j2k=f=>{n("AugLoopGetQuestionsSucceeded",new Date);b(f)};this.sQe=f=>{n("AugLoopGetQuestionsFailed",new Date);c(f)}});this.xek=new Promise((b,c)=>{this.g2k=f=>{n("AugLoopGetOutlineSucceeded",new Date);b(f)};this.Vgh=f=>{n("AugLoopGetOutlineFailed",new Date);c(f)}});this.wek=new Promise((b,c)=>{this.$1k=f=>{n("AugLoopGetColorsSucceeded",
new Date);b(f)};this.Ugh=f=>{n("AugLoopGetColorsFailed",new Date);c(f)}});this.yek=new Promise((b,c)=>{this.q2k=f=>{n("AugLoopGetTemplatesSucceeded",new Date);b(f)};this.Wgh=f=>{n("AugLoopGetTemplatesFailed",new Date);c(f)}});this.promise=Promise.allSettled([this.xek,this.wek,this.yek]);this.tck=window.setTimeout(()=>{this.Vgh(`Timeout outlinePromise after ${a.OOe} ms`)},a.IAk);this.x6j=window.setTimeout(()=>{this.Ugh(`Timeout colorsPromise after ${a.BGf} ms`)},a.BGf);this.uhk=window.setTimeout(()=>
{this.Wgh(`Timeout templatePromise after ${a.jBh} ms`)},a.jBh);this.Eek=window.setTimeout(()=>{this.sQe(`Timeout questionsPromise after ${a.OOe} ms`)},a.OOe)}}Object(m.a)(oP,"DeferredStorytellerAugLoopPromise",null,[]);class sF{constructor(a,b){this.yre=new Map;this.rpe=new Map;this.la=a;this.hz=b;this.hz.execute(c=>{this.la.ka("StoryTellerShowQuestions")&&(c.pia("AugLoop_Storyteller_StorytellerQuestionsResponse"),c.kKa("AugLoop_Storyteller_StorytellerQuestionsResponse",this.s_.bind(this)));c.pia("AugLoop_Storyteller_StorytellerOutlineResponse");
c.kKa("AugLoop_Storyteller_StorytellerOutlineResponse",this.s_.bind(this));c.pia("AugLoop_Storyteller_StorytellerColorsResponse");c.kKa("AugLoop_Storyteller_StorytellerColorsResponse",this.s_.bind(this));c.pia("AugLoop_Storyteller_StorytellerTemplatesResponse");c.kKa("AugLoop_Storyteller_StorytellerTemplatesResponse",this.s_.bind(this))})}m8k(a,b,c){var f;if(a.contextId){var l=Object.assign(new Wv,Object.assign(Object.assign({},a),{debugParams:{debugMetadataEnabled:this.la.qZc,outlinePromptTemplate:null!==
(f=this.la.brl)&&void 0!==f?f:void 0}})),x=Object.assign(new eS.a,{parentPath:["Signal",Wv.getTypeName()],items:[Object.assign(new dS.a,{body:l})]});f=new oP({OOe:this.la.Bc("StoryTellerQuestionsAnnotationTimeout",1E4),IAk:this.la.Bc("StoryTellerOutlineAnnotationTimeout",2E4),BGf:this.la.Bc("StoryTellerColorsAnnotationTimeout",1E4),jBh:this.la.Bc("StoryTellerTemplatesAnnotationTimeout",1E4)});this.la.ka("StoryTellerShowQuestions")||f.sQe("ShowStoryTellerQuestions disabled");Promise.allSettled([f.Dch,
f.promise]).then(()=>{this.yre.delete(a.contextId);this.rpe.delete(a.contextId)});f.Dch.then(H=>b(H.questionsResponse)).catch(H=>{H=this.la.qZc?"":JSON.stringify(H);xa.a.J(509214794,817,10,`StorytellerAugLoopManager:sendStorytellerSignal questionsPromise Exception ${H}`)});f.promise.then(([H,U,ja])=>{var ya,Va,hb,yb,Zb,fc,Kc,Lc,Gc,ae,we,$d,Te,Ze;if("rejected"==H.status)return xa.a.J(509195422,817,10,`StorytellerAugLoopManager:sendStorytellerSignal Promise rejected - outline:${H.status}, colors:${U.status}, templates:${ja.status}`),
c(void 0);const Vf={ColorScheme:"fulfilled"==U.status?{Accent1:null===(ya=U.value.colorPalette)||void 0===ya?void 0:ya.accent1,Accent2:null===(Va=U.value.colorPalette)||void 0===Va?void 0:Va.accent2,Accent3:null===(hb=U.value.colorPalette)||void 0===hb?void 0:hb.accent3,Accent4:null===(yb=U.value.colorPalette)||void 0===yb?void 0:yb.accent4,Accent5:null===(Zb=U.value.colorPalette)||void 0===Zb?void 0:Zb.accent5,Accent6:null===(fc=U.value.colorPalette)||void 0===fc?void 0:fc.accent6,Hyperlink:null===
(Kc=U.value.colorPalette)||void 0===Kc?void 0:Kc.hyperlink,ClickedHyperlink:null===(Lc=U.value.colorPalette)||void 0===Lc?void 0:Lc.clickedHyperlink,LightBackground:null===(Gc=U.value.colorPalette)||void 0===Gc?void 0:Gc.lightBackground,DarkBackground:null===(ae=U.value.colorPalette)||void 0===ae?void 0:ae.darkBackground,TextColorLight:null===(we=U.value.colorPalette)||void 0===we?void 0:we.textColorLight,TextColorDark:null===($d=U.value.colorPalette)||void 0===$d?void 0:$d.textColorDark}:{},PresOutline:{Title:null===
(Te=H.value.presentation)||void 0===Te?void 0:Te.title,Slides:null===(Ze=H.value.presentation)||void 0===Ze?void 0:Ze.slides.map(gg=>{var Qg;return{Title:gg.title,Notes:gg.notes,KeyPoints:gg.keyPoints,ImagesQuery:gg.images,Images:null===(Qg=gg.imageUrls)||void 0===Qg?void 0:Qg.map(Rg=>({Url:Rg,Format:""}))}})},ThemeIds:"fulfilled"==ja.status?ja.value.templateIds:void 0};return c(Vf)}).catch(H=>{H=this.la.qZc?"":JSON.stringify(H);xa.a.J(509214863,817,10,`StorytellerAugLoopManager:sendStorytellerSignal outlinePromise Exception ${JSON.stringify(H)}`)});
this.yre.set(a.contextId,f);this.rpe.set(a.contextId,new Date);this.hz.execute(H=>{H.submitOperation(x);n("AugLoopOpSubmitted",new Date)})}else xa.a.J(509214865,817,10,"StorytellerAugLoopManager:sendStorytellerSignal No contextId")}s_(a){var b;if(a.contextId){var c=this.yre.get(a.contextId),f=this.rpe.get(a.contextId);if(c&&f){var l=null!==(b=a.loggableMetadata)&&void 0!==b?b:{};l.annotationType=a.ownerId;l.uOl=(+new Date-+f).toString();xa.a.J(509207583,817,50,`StorytellerAugLoopManager:handleAnnotationEvent ${JSON.stringify(l)}`);
a.debugMetadata&&0<Object.keys(a.debugMetadata).length&&console.log(`Storyteller Debug Info for ${a.ownerId}: ${JSON.stringify(a.debugMetadata)}`);return sF.cXj(a)?this.elh(!0,a,c):this.elh(!1,a,c)}xa.a.J(509214861,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No deferredPromise found")}else xa.a.J(509214862,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No contextId")}elh(a,b,c){switch(b.ownerId){case "StorytellerQuestions":clearTimeout(c.Eek);a?c.j2k(b):c.sQe(b);break;case "StorytellerOutline":clearTimeout(c.tck);
a?c.g2k(b):c.Vgh(b);break;case "StorytellerColors":clearTimeout(c.x6j);a?c.$1k(b):c.Ugh(b);break;case "StorytellerTemplates":clearTimeout(c.uhk);a?c.q2k(b):c.Wgh(b);break;default:xa.a.J(509214860,817,10,`StorytellerAugLoopManager:resolveOrRejectDeferredPromise Invalid type:${b.ownerId}, resolve:${a}`)}}static cXj(a){if(!a)return xa.a.J(509214859,822,10,"StorytellerAugLoopManager:isValidStorytellerAnnotation annotationItem is undefined."),!1;const b=null===a||void 0===a?void 0:a.status;if(!b||0!==
b.code)return xa.a.J(509214858,817,10,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} error response. status: ${b?JSON.stringify(b):""}`),!1;xa.a.J(509214857,817,50,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} is valid.`);return!0}dispose(){}}Object(m.a)(sF,"StorytellerAugLoopManager",null,[]);class fy extends Sys.EventArgs{constructor(a){super();this.CVi=a}}Object(m.a)(fy,"QueueShowingPanesEventEventArgs",Sys.EventArgs,[]);class tF{constructor(a,
b,c,f){this.M9c=5;this.V9c=new Date;this.Epe=0;this.gWa=a;this.Kgk=b;this.la=c;this.he=f}dispose(){}O_j(){n("LoadDialog",new Date);const a=document.createElement("div");a.style.height="0px";a.style.width="0px";a.style.display="none";document.body.appendChild(a);const b={enableTryAgainButton:this.la.ka("StoryTellerEnableTryAgainButton"),promptCharacterLimit:this.la.Bc("StoryTellerPromptCharacterLimit",200),disableInputFieldEditOnBlur:this.la.ka("StoryTellerDisableInputFieldEditOnBlur"),enablePromptCharacterLimit:this.la.ka("StoryTellerEnablePromptCharacterLimit")};
(new storytellerDialog.StorytellerDialogManager(a,this.LIe.bind(this),{settings:b},this.onClose.bind(this))).showDialog()}onClose(){this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.he.okd(new fy(!1))}LIe(a,b){void 0!=this.U9c&&this.la.ka("StoryTellerShowQuestions")||(this.U9c=a,this.Epe++,this.V9c=new Date,n("PromptSubmitted",this.V9c));if(b)switch(b.presentationLength){case "shortLength":this.M9c=5;break;case "mediumLength":this.M9c=8;break;case "longLength":this.M9c=11}const c=Object.assign(new Wv,
{prompt:this.U9c,numSlides:this.M9c,context:null===b||void 0===b?void 0:b.additionalContext,contextId:Ug.a.create().toString()});let f=()=>{},l=()=>{};b=new Promise((x,H)=>{f=(U,ja)=>{xa.a.J(509158928,817,15,`Storyteller${ja}Succeeded: ${JSON.stringify({totalDurationMs:+new Date-+this.V9c,augLoopContextId:c.contextId,attemptCount:this.Epe,events:Tw})}`);"PromptToOutlineFlow"===ja&&Tw.clear();x(U)};l=U=>{xa.a.J(509158927,817,10,`StorytellerFailed: ${JSON.stringify({reason:U,totalDurationMs:+new Date-
+this.V9c,augLoopContextId:c.contextId,attemptCount:this.Epe,events:Tw})}`);Tw.clear();H(U)}});this.Kgk.m8k(c,x=>Object(ql.a)(this,void 0,void 0,function*(){if(this.la.ka("StoryTellerShowQuestions")){if(!x)return xa.a.J(509195421,817,10,"StorytellerView:onSubmit:questionsCallback questionsAnnotation failed"),n("AugLoopGetQuestionsFailed",new Date),l("questionsAnnotation failed");if(this.U9c==a){const H={ColorScheme:{},PresOutline:{Title:void 0,Slides:[{Title:x.slide.title,Notes:x.slide.notes,KeyPoints:x.slide.keyPoints,
ImagesQuery:x.slide.images}]},ThemeIds:void 0};try{n("Send1stOutlineToPPT",new Date);const U=yield this.gWa.E4f(H);n("Send1stMergeSlides",new Date);this.gWa.NYg(U)}catch(U){xa.a.J(509211014,817,10,`StorytellerView:onSubmit:questionsCallback Exception ${U}`),n("QuestionsCallbackFailed",new Date),l(`${U}`)}n("QuestionsCallbackSucceeded",new Date);return f({prompts:x.qList,fShouldDismiss:!1},"PromptToQuestionFlow")}}else xa.a.J(509159458,817,10,"StorytellerView:onSubmit:questionsCallback ShowStoryTellerQuestions disabled")}),
x=>Object(ql.a)(this,void 0,void 0,function*(){if(!x)return xa.a.J(509195420,817,10,"StorytellerView:onSubmit:questionsCallback outlineAnnotation failed"),n("AugLoopGetOutlineFailed",new Date),l("outlineAnnotation failed");if(this.U9c!=a||!this.la.ka("ShowStoryTellerQuestions"))try{n("Send2ndOutlineToPPT",new Date);const H=yield this.gWa.E4f(x);n("Send2ndMergeSlides",new Date);yield this.gWa.NYg(H);this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.he.okd(new fy(!1));n("2ndMergeSlidesSucceeded",
new Date);return f({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(H){return xa.a.J(509211013,817,10,`StorytellerView:onSubmit:outlineCallback Exception ${H}`),n("OutlineCallbackFailed",new Date),l(`${H}`)}}));return b}}Object(m.a)(tF,"StorytellerView",null,[]);class pP{constructor(a,b,c){this.la=a;this.Ds=b;this.Xa=c}E4f(a){return new Promise((b,c)=>{const f=String.format("{0}?action=OutlineToPPT",this.la.Ga("CreatorServiceBase")),l={};l.PodSID=this.Xa.podSessionId;l.Client="Storyteller";
l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const x=new Date;this.Ds.mj(f,2,JSON.stringify(a),l,!1,0,H=>{var U;xa.a.J(509211020,817,50,"CopilotProxy:getOutlineToPPTAsync: Time Taken {0}",+new Date-+x);null!==(U=null===H||void 0===H?void 0:H.data)&&void 0!==U&&U.Sd||(xa.a.J(509211019,817,10,"CopilotProxy:getOutlineToPPTAsync: No response data"),c("No response data"));H.data.oe!==dl.a.Uv&&(xa.a.J(509211018,817,10,"CopilotProxy:getOutlineToPPTAsync: Bad Http Status {0}",H.data.oe),c(`Bad Http Status ${H.data.oe}`));
let ja;try{ja=JSON.parse(H.data.Sd)}catch(ya){xa.a.J(509211017,817,10,"CopilotProxy:getOutlineToPPTAsync: Exception when parsing the json"),c("Exception when parsing the json")}xa.a.J(509211016,817,50,"CopilotProxy:getOutlineToPPTAsync: call successful");b(ja)},H=>{var U,ja;const ya=new Date;xa.a.J(509211015,817,50,"CopilotProxy:getOutlineToPPTAsync: request failed Status {0}, Time Taken {1}",null===(U=null===H||void 0===H?void 0:H.data)||void 0===U?void 0:U.oe,+ya-+x);c(null===(ja=null===H||void 0===
H?void 0:H.data)||void 0===ja?void 0:ja.oe)},null)})}NYg(a){return Object(ql.a)(this,void 0,void 0,function*(){return new Promise((b,c)=>{a&&a.DownloadablePPTInfos&&0!=a.DownloadablePPTInfos.length||(xa.a.J(509211025,817,10,"CopilotProxy:mergeSlides: invalid outlineToPPTResponse"),c("invalid outlineToPPTResponse"));const f=String.format("{0}",this.la.Ga("MergeSlidesFromUrlEndpoint")),l={};l.PodSID=this.Xa.podSessionId;l.Client="Storyteller";l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
const x=new Date,H=a.DownloadablePPTInfos[0].DownloadUrl;if(!H)return xa.a.J(509159459,817,10,`CopilotProxy:mergeSlides: Error in getting DownloadUrl. Error Code: ${a.DownloadablePPTInfos[0].ErrorCode}.`),!1;this.Ds.mj(f,2,JSON.stringify({DownloadUrl:H,MergeAction:"ReplaceAll"}),l,!1,0,U=>{xa.a.J(509211024,817,50,"CopilotProxy:mergeSlides: Time Taken {0}",+new Date-+x);U.data.oe!==dl.a.Uv&&(xa.a.J(509211023,817,10,"CopilotProxy:mergeSlides: Bad Http Status {0}",U.data.oe),c(`Bad Http Status ${U.data.oe}`));
xa.a.J(509211022,817,50,"CopilotProxy:mergeSlides: call successful");b(!0)},U=>{var ja,ya;const Va=new Date;xa.a.J(509211021,817,50,"CopilotProxy:mergeSlides: request failed Status {0}, Time Taken {1}",null===(ja=null===U||void 0===U?void 0:U.data)||void 0===ja?void 0:ja.oe,+Va-+x);c(null===(ya=null===U||void 0===U?void 0:U.data)||void 0===ya?void 0:ya.oe)},null)})})}}Object(m.a)(pP,"CopilotProxy",null,[1177]);class uF{get name(){return"PowerPointWebEditor.Storyteller"}Zb(a){this.K=a;a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.K.register(tF,"PowerPointWebEditor.StorytellerView").as("PowerPointWebEditor.IStorytellerView").ma().oa(()=>new tF(new pP(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),u.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")),new sF(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier")));
const b=u.AFrameworkApplication.yM||u.AFrameworkApplication.iG;if(a.XUj&&a.HQ&&(""==a.YNb||"blank"==a.YNb)&&!b||a.qZc)a.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").okd(new fy(!0)),this.loadScript()}loadScript(){n("LoadDialogScript",new Date);gb.a.get_instance().ek(7,()=>{gx.a(this.K)("storytellerDialog").then(()=>{this.K.resolve("PowerPointWebEditor.IStorytellerView").O_j()}).catch(a=>{xa.a.J(509154954,817,10,`PPTWebEditorStorytellerPackage:loadScript Exception while loading storytellerDialog ${JSON.stringify(a)}`);
this.K.resolve("PowerPointWebEditor.IApplicationSettings").ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").okd(new fy(!1))})})}init(){this.Mgk=this.K.resolve("PowerPointWebEditor.IStorytellerView")}dispose(){this.Mgk.dispose()}static main(){z.a.instance.Dc(new uF)}}Object(m.a)(uF,"PPTWebEditorStorytellerPackage",null,[2,3]);var hS=d(545),qP=d(676),rP=d(226);class vF{get name(){return"Common.App.OAuth.OAuthPackage"}Zb(a){a.register(350,"Common.App.OAuth.IOAuthManager").ma().oa(()=>
new hS.OAuthManager)}init(){const a=Db.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.lAl(a)}lAl(a){const b=u.AFrameworkApplication.fa.Ga("FileSource");if(u.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===b){var c=rP.OAuthManagerSettings.hXd;if(c&&c.IsEnabled){var f=c.Application,l=rP.OAuthManagerSettings.authority;if(void 0!==f&&null!==f&&f.length&&void 0!==l&&null!==l&&l.length){var x=qP.a[a.P6],H=B.a.Sy,U=a.WD();
try{var ja=new Map;void 0!==ja&&null!==ja?(ja.set("SupportStatus",x),ja.set("Browser",H),ja.set("AuthStrategy",U)):ja=null}catch(Va){ja=null}kf.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ja);var ya=Od.a.uj();a.nV("Core",f).then(Va=>{const hb=Math.floor(Od.a.uj()-ya);x=qP.a[a.P6];H=B.a.Sy;U=a.WD();ia.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
hb,Va.IsSuccess,x,Va.ErrorCode,b,H,U);ja&&(ja.set("SupportStatus",x),ja.set("Browser",H),ja.set("AuthStrategy",U));var yb=Object.assign(new Oj.a,{durationMs:hb,extendedProperties:ja});if(Va.IsSuccess){if(kf.Health.instance.recordKpiSuccess("WacCorePFT",yb),Va="Bearer "+Va.Token,u.AFrameworkApplication.Ke.d6e=Va,yb=c.Endpoint){var Zb=Od.a.uj();u.AFrameworkApplication.Ke.Wqb(yb,1,null,{["Authorization"]:Va},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(fc=>{var Kc=Math.floor(Od.a.uj()-
Zb),Lc=null;fc.Tn?fc="Canceled":fc.tm?fc="Faulted":(Lc=fc.result,fc=Lc.succeeded?"Completed":"Failed");Kc={["TaskResult"]:fc,["BrowserTokenDurationMS"]:hb,["BrowserValidationDurationMS"]:Kc};Lc&&(Kc.HttpStatus=Lc.Wi.data.oe,Lc.succeeded&&(Lc=xd.a(Lc.Wi.data.Sd),Kc.ServerValidationDurationMS=Lc.ElapsedMilliseconds,Kc.ServerValidationResult=Lc.ValidatedToken,Kc.KMSI=Lc.KMSI,Kc.Scopes=Lc.Scopes,Kc.TokenExpirationS=Math.floor(parseInt(Lc.Expiration)-(new Date).getTime()/1E3)));ia.ULS.sendTraceTag(520632322,
3E3,"Completed"===fc?50:15,pa.a.toJSON(Kc))})}}else kf.Health.instance.recordKpiFailure("WacCorePFT",Va.ErrorCode,!1,!1,yb)}).catch(Va=>{var hb=Math.floor(Od.a.uj()-ya);hb=Object.assign(new Oj.a,{durationMs:hb,extendedProperties:ja});kf.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Va.toString(),!1,!1,hb)})}}}}dispose(){}static main(){z.a.instance.Dc(new vF)}}Object(m.a)(vF,"OAuthPackage",null,[2,3]);var sP=d(12);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");
Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");
Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");
Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");
Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");
Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");window.g_hermesExtJS=
Date.now();Object(sP.c)("Ext");X.main();ma.main();ve.main();Bb.main();lm.main();$l.main();z.a.instance.Dc(new Hj);Cm.main();sd.main();Qe.main();Hm.main();Bn.main();Qn.main();Ak.main();qo.main();Pi.main();js.main();Zp.main();ur.main();Ar.main();Type.registerNamespace("Common.App.AccountSwitching");mt.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");
Hp.main();Type.registerNamespace("Common");Cu.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Eu.main();Type.registerNamespace("Common.App.ImageProcessor");Type.registerNamespace("Common.App.NewAndOpen.Core");z.a.instance.Dc(new gw);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Hu.main();Uu.main();$u.main();Type.registerNamespace("Common.App.People");hv.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=
jq;uh.main();Type.registerNamespace("Common");z.a.instance.Dc(new zp);Type.registerNamespace("CAUI");Ir.main();Type.registerNamespace("Common.App.SaveStatus");z.a.instance.Dc(new AF);Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1139).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");qF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",
isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"}};BA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");
Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");CA.main();KA.main();MA.main();NA.main();OA.main();PA.main();UA.main();VA.main();cB.main();window.PowerPointEditingJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",
attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",
Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",
Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},
{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",
Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",
Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",
Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",
Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",
Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",
Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",
Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",
Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",
QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",
LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};KB.main();Type.registerNamespace("Common.App.Insights");
z.a.instance.Dc(new jH);Type.registerNamespace("Common.App.Activities");OB.main();Type.registerNamespace("Common.App.ActivityAggregator");TB.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=ar;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");UB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");VB.main();Type.registerNamespace("Common.App.EventsCacheManager");
WB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");ZB.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");bC.main();GC.main();KC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");MC.main();Type.registerNamespace("Common.App.VisibilityManagement");OC.main();Type.registerNamespace("Common.ModernFontPicker");
PC.main();QC.main();VC.main();aD.main();dD.main();mD.main();oD.main();uD.main();Oz.main();OD.main();QD.main();RD.main();eE.main();fE.main();gE.main();hE.main();jE.main();sE.main();tE.main();Type.registerNamespace("Common.App.OAuth");vF.main();lF.main();oF.main();rF.main();uF.main();Object(sP.b)("Ext")},125:function(I,Y,d){d.d(Y,"a",function(){return h});d.d(Y,"b",function(){return e});const h=n=>null===n||"undefined"===typeof n||!n.length,e=n=>null===n||"undefined"===typeof n},1254:function(I,Y,d){I=
d(0);class h{constructor(n,m,z,B){this.iPh=n;this.NZh=m;this.MZh=z;this.OZh=B}get Vzi(){return this.iPh}get $2k(){return this.NZh}get X2k(){return this.MZh}get resultType(){return this.OZh}}Object(I.a)(h,"SearchContext",null,[958]);d.d(Y,"a",function(){return e});class e{uGi(n,m,z){var B=z-m;let v;if(100<=B)B=m,v=z;else{B=Math.max(0,m+Math.ceil(B/2)-50);v=Math.min(n.length,B+100);B=Math.max(0,v-100);let A;if(B&&" "!==n.charAt(B-1)){A=Math.min(m,B+10);for(var y=B;y<A;++y)if(" "===n.charAt(y)){B=y+
1;break}}if(v!==n.length&&" "!==n.charAt(v))for(A=Math.max(z,v-10),y=v-1;y>=A;--y)if(" "===n.charAt(y)){v=y;break}}return new h(n.substring(B,v),m-B,z-B,"")}}Object(I.a)(e,"SearchContextFactory",null,[915])},155:function(I,Y,d){d.d(Y,"a",function(){return e});d.d(Y,"b",function(){return n});var h=d(43);const e=(m,z,B)=>{m=h.a.yk(m);m.Va("CommandId",z.toString());try{return B()}finally{m.finish(!0)}},n=(m,z,B,v)=>e(m+z,B,v)},209:function(I,Y,d){d.d(Y,"a",function(){return m});I=d(0);var h=d(27),e=
d(1128),n=d(47);class m{static N1f(){return m.Cbi+"_"+e.a.d8b+"_"+n.a.qN(h.AFrameworkApplication.userName)+"_"}static dRc(z){return z+"_"+e.a.d8b+"_"+n.a.qN(h.AFrameworkApplication.userName)+"_"}static l5f(){return m.FJk+"_"+e.a.d8b+"_"+n.a.qN(h.AFrameworkApplication.userName)+"_"}}m.P7="ack0";m.Q7="ack1";m.NGc="ack2";m.Cbi="ack3";m.PYb="ack4";m.Zuf="ack7";m.sne="ack8";m.cvh="ack9";m.aSd="ack10";m.jYe="ack13";m.avf="AddinDetailsRefreshed";m.Abi="DdaMethod";m.zbi="ControlId";m.RPd="SecurityOrigin";
m.k6a="ak0";m.OPd="ak1";m.QPd="ak2";m.nrb="ak4";m.Yuf="Office.AutoShowTaskpaneWithDocument";m.NPd="refreshRequired";m.bvf="value";m.Fbi="errorCode";m.F0d="SolutionId";m.D0d="MethodData";m.E0d="DynamicAddinCommandsMethodDispatchId";m.uPi="SourceControlId";m.sPi="OsfControl";m.tPi="RibbonUpdaterData";m.Jsd="AddinShared";m.FJk="__OSF_PRIVATECATALOG_ADDINIDS";Object(I.a)(m,"AddinConstantsString",null,[])},235:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.XGc="AfterValidate";h.autoCorrect=
"AutoCorrect";h.Ehi="BeforeValidate";h.YIi="CutAction";h.MPi="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";h.GYi="FinishingSelectionValidation";h.OBj="ImeTypingEnd";h.QBj="ImeTypingStart";h.hIj="IpMode";h.jy="KeyPress";h.Yf="KeyDown";h.Bok="NotFinishingSelectionValidation";h.ZAk="OvertypeEnd";h.aBk="OvertypeStart";h.dBk="PaddingChanged";h.M8g="ParagraphContentUpdated";h.kDk="PasteAction";h.zbl="SetMode";h.typingProcess="TypingProcess";h.bui="ClipboardModeBegin";h.cui="ClipboardModeEnd";
Object(I.a)(h,"EditEventKeys",null,[])},236:function(I,Y,d){d.d(Y,"a",function(){return n});var h=d(27),e=d(14);const n=m=>h.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk:Object(e.a)(m.resolve("Common.IDynamicScriptLoaderProvider").Sw,m.resolve("Common.IDynamicScriptLoaderProvider").Sw.loadScript,"loadScript")},251:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(57),n=d(27),m=d(47),z=d(582),B=d(1208),v=d(18);d(1200);var y=d(1005),A=d(29),E=d(76),u=d(123),J=d(33),
G=d(42),S=d(38),P=d(77),Q=d(54),D=d(74),O=d(59),X=d(88);d(419);var N=d(51),aa=d(421);class V{constructor(da,qa,F,sa,ia){this.LHd=da;this.T1h=F;this.S1h=qa;this.IRh=sa;this.bXh=ia}s5k(da,qa){qa.t5k(da,this.LHd,this.S1h,this.T1h,this.IRh,this.bXh)}}Object(I.a)(V,"MathPropertyObject",null,[]);var ca=d(32),fa=d(109);d.d(Y,"Box4PasteSteward",function(){return ma});class ma extends y.a{constructor(da,qa,F,sa,ia,Na,Ca,ha=null,Ba=null){super(da,Ca,ha,Ba);this.mo=this.s2=null;this.cqa=!1;this.o3a=null;this.kob=
-1;this.f4a=0;this.SLd=new v.a;fa.a(4223754,307,O.OutlineElementReader.Yg(da));this.s3a=qa;this.s3a.jsb(this);this.qF=F;this.qF.jsb(this);this.KCd=sa;this.Zo=ia;this.RVh=Na;this.XHd=P.ListReader.uk(this.Ab);ma.YEj();ma.MEj();ma.CFj()}get b9(){return this.s2||(this.s2=e.a.instance.ub("Box4.IInternalLinkManager"))}get cRa(){return this.mo}get w7a(){return this.XHd&&!this.qF.Mca}get L7a(){return 0<this.f4a}get Av(){return this.KCd}get eq(){return this.Zo}get k2c(){return this.RVh}get Sii(){return!!n.AFrameworkApplication.fa&&
n.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.mo=this.x6d(!1)}EQd(da){fa.a(4223762,307,O.OutlineElementReader.Yg(this.Ab)||D.OutlineReader.Zt(this.Ab));this.oGb(!1);var qa=new ca.GraphIterator;qa.Rc(this.Ab);da=y.a.Ph.Hca(this.Ab,this.XSa(da));this.yHc(qa,!1);fa.a(4223763,307,da===this.Ab.currentNode);fa.a(4223764,307,J.ParagraphReader.$d(da));-1!==this.mo.jE&&ma.paragraphEditor.ZJ(da,this.mo.jE);if(ma.paragraphEditor.Av&&!this.iZ.Cuh){if(this.mo.textIndent){let ia;
({unit:sa,returnValue:ia}=ma.ehd(this.mo.textIndent));var F=!1;if(ia||!P.ListReader.D8a){0>ia&&(F=!0,ia*=-1);var sa=ma.ZWd(ia,sa);F||ma.paragraphEditor.Av.Hjb(da,sa)}}!this.mo.marginLeft||ma.IL.E_c||P.ListReader.uk(qa)||({unit:qa,returnValue:F}=ma.ehd(this.mo.marginLeft),qa=ma.ZWd(F,qa),ma.paragraphEditor.Av.Jod(da,1,qa))}(ma.Tf.gg&&ma.Tf.Uy||S.a.instance.ga(45)&&A.App.OD.BOb)&&da.setValue(G.a.e$b,!0);this.mo.lineSpacing&&ma.paragraphEditor.w1(da,this.mo.lineSpacing);this.mo.paragraph=da;this.cqa=
!0}yHc(da,qa){fa.a(8128518,307,!qa);this.vM&&!S.a.instance.ga(76)&&(0<this.vM&&this.Av.SMc(da,this.vM),0>this.vM&&this.Av.Rhb(da,this.vM,0));S.a.instance.ga(29)&&(this.Ab.Rc(da),Q.OutlineElementNavigator.wi(this.Ab));!this.w7a||2===A.App.mode&&this.k2c.Kmc?da&&this.eq.FVe(da,this.L7a):this.eq.Wqh(da);this.vM=0}jtd(da){this.SLd.add(da)}fVd(){this.vM=0}U0(da,qa=null){fa.a(4223772,307,J.ParagraphReader.el(this.Ab));const F=this.Ab.currentNode;this.mo.Z2e(F);if(!this.iZ.l3e(qa)){n.AFrameworkApplication.hk("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");
var sa=F.Ra.last,ia=N.a.SQa(F),Na=!1;this.cqa&&(sa.formatting=this.mo.c9a.ae(sa),S.a.instance.ga(57)&&F.fv(),this.cqa=!1,Na=!0);da=this.iZ.lbe(da,qa);this.iZ.Foa(this.Ab.currentNode,this.mo.Cfa,qa);this.characterPropertiesEditor.replaceTextRange(ia,da);this.Sii&&Na&&(da=F.gvb(ia.Qa),da.formatting=this.mo.c9a.ae(da));S.a.instance.ga(2)}}Bna(da){this.iZ.q_c&&this.iZ.sZc(da)?(this.tA(),this.uA(da)):(fa.a(4223773,307,J.ParagraphReader.el(this.Ab)),da=N.a.SQa(this.Ab.currentNode),this.characterPropertiesEditor.hXc(da,
qa=>new aa.a(qa,aa.a.BMc),E.AParagraphNode.h_))}jZa(){}Ana(da){this.s3a.Ana(da)}zna(da){this.mo=da;this.cqa=!0}cxa(da){fa.a(4223774,307,J.ParagraphReader.el(this.Ab));fa.a(4223775,307,!this.o3a);fa.a(4223776,307,0>this.kob);this.o3a=da;this.kob=J.ParagraphReader.textLength(this.Ab.currentNode)}bxa(){fa.a(4223777,307,J.ParagraphReader.el(this.Ab));fa.a(4223778,307,!!this.o3a);fa.a(4223779,307,0<=this.kob);let da=N.a.createTextRange(this.Ab.currentNode,this.kob,J.ParagraphReader.textLength(this.Ab.currentNode)),
qa="",F="";this.b9&&({Xgh:qa,j0i:F}=this.b9.sDh(u.HyperlinkReader.oEa(this.o3a),!0)).returnValue&&(this.o3a=qa,F&&(this.characterPropertiesEditor.replaceTextRange(da,F),da=N.a.createTextRange(this.Ab.currentNode,this.kob,J.ParagraphReader.textLength(this.Ab.currentNode))));ma.hyperlinkEditor.oja(da,this.o3a,!1);this.cqa=!0;this.o3a=null;this.kob=-1}uA(da){this.EQd(da);this.mo.xtd(this.Ab.currentNode);da&&"P"===da.BU.i8b&&ma.paragraphEditor.ZKa(this.Ab.currentNode,this.mo.Vgd);this.iZ.Foa(this.Ab.currentNode,
this.mo.Cfa,da,this.mo.marginLeft,this.mo.textIndent)}tA(){fa.a(4223808,307,J.ParagraphReader.el(this.Ab));ma.hyperlinkEditor.URi(this.Ab.currentNode);Q.OutlineElementNavigator.Re(this.Ab)}dZa(){}cZa(){}hxa(){}lJa(){}Ena(){fa.a(4223809,307,O.OutlineElementReader.Yg(this.Ab)||D.OutlineReader.Zt(this.Ab));let da=!1;this.L7a||(da=this.w7a||!0);da||(this.vM+=1);this.f4a++}Cna(){this.f4a--;let da=!1;this.L7a||(da=this.w7a||!0);da||--this.vM}gxa(da){fa.a(4223810,307,O.OutlineElementReader.Yg(this.Ab)||
D.OutlineReader.Zt(this.Ab));fa.a(4223811,307,0!==da.listStyleType);this.eq.RLb(this.k_j(da))}Dna(){fa.a(4223813,307,O.OutlineElementReader.Yg(this.Ab));n.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ma.IL.E_c&&P.ListReader.uk(this.Ab)){const da=J.ParagraphReader.Jwb(this.Ab.currentNode),qa=this.k2c.u3f(this.Ab);this.eq.Nod(qa,da,null)}}eZa(da){this.s3a.eZa(da)}pY(da){this.qF.pY(da)}mY(){this.qF.mY()}oY(da){this.qF.oY(da)}nY(){this.qF.nY()}lY(da){this.qF.lY(da)}kY(){this.qF.kY()}static get paragraphEditor(){return ma.Vw||
(ma.Vw=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ma.zn||(ma.zn=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Tf(){return ma.fd||(ma.fd=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get CNb(){return ma.opf}static get IL(){return ma.AK||(ma.AK=e.a.instance.ub("Box4.List.ListSettings"))}static YEj(){const da=S.a.instance.ga(61);ma.tJa[1]=da?X.StyleReader.Jvd:X.StyleReader.sNb;ma.tJa[2]=da?X.StyleReader.Kvd:X.StyleReader.tNb;
ma.tJa[3]=da?X.StyleReader.Lvd:X.StyleReader.uNb;ma.tJa[4]=da?X.StyleReader.Mvd:X.StyleReader.vNb;ma.tJa[5]=da?X.StyleReader.Nvd:X.StyleReader.wNb;ma.tJa[6]=da?X.StyleReader.Ovd:X.StyleReader.xNb;ma.tJa[7]=da?null:X.StyleReader.asc}static MEj(){ma.eea.unspecified=0;ma.eea.defaultUnordered=1;ma.eea.defaultOrdered=1;ma.eea.none=0;ma.eea.disc=1;ma.eea.circle=2;ma.eea.square=3;ma.eea.decimal=1;ma.eea.lowerAlpha=2;ma.eea.lowerRoman=3;ma.eea.upperAlpha=4;ma.eea.upperRoman=5}static CFj(){ma.opf=X.StyleReader.zxb()}static y7a(da){return m.a.substring(da,
4,6)+m.a.substring(da,2,4)+m.a.substring(da,0,2)}static ehd(da){let qa,F;qa=0;const sa=da.length;F=parseFloat(m.a.substring(da,0,sa-2));da=m.a.substr(da,sa-2,2);switch(da){case "in":qa=3;break;case "px":qa=7;break;case "cm":qa=1;break;case "pt":qa=5;break;default:h.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",da),F=0}return{returnValue:F,unit:qa}}static ZWd(da,qa){let F=0;switch(qa){case 3:F=z.a.Tta(da);break;case 7:F=
B.a.Gfa(da,0);break;case 1:F=z.a.rUd(da);break;case 5:F=z.a.Tta(z.a.Shd(da));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",da,qa)}return F}}ma.Vw=null;ma.zn=null;ma.fd=null;ma.tJa=Array(8);ma.eea={};ma.opf=null;ma.AK=null;Object(I.a)(ma,"Box4PasteSteward",y.a,[])},265:function(I,Y,d){d.r(Y);I=d(0);d(387);var h=d(922);d(923);var e=d(27),n=d(97),m=d(57),z=d(37);class B{}Object(I.a)(B,"RibbonUpsellButtonCreator",
null,[]);class v extends Sys.EventArgs{constructor(aa){super();this.RJl=aa}}Object(I.a)(v,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(388);var y=d(364);d(174);var A=d(135);d(313);d(75);var E=d(225),u=d(163),J=d(67);class G{constructor(aa,V){this.cluster=aa;this.cMc=V}}Object(I.a)(G,"ImageInfo",null,[]);class S{constructor(aa,V,ca,fa,ma,da,qa,F,sa,ia,Na,Ca,ha,Ba,va=null,ta=null){this.id=aa;this.zFc=V;this.DFc=ca;this.CFc=fa;this.BFc=ma;this.AFc=da;this.FFc=qa;this.RNd=F;this.aNb=new G(sa,ia);this.Sqd=
new G(Na,Ca);this.sdd=new G(ha,Ba);va&&ta&&new G(va,ta)}}Object(I.a)(S,"PeoplesWellBaseSettings",null,[]);class P{constructor(){this.Pzf=null}}Object(I.a)(P,"BreadcrumbControls",null,[]);class Q{constructor(aa){this.id=aa}}new Q("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(I.a)(Q,"ChatButtonSettings",null,[]);class D{constructor(){this.id=this.image=this.label=this.command=null}}Object(I.a)(D,"SkypeButtonInfo",null,[]);class O{constructor(){this.E5e=
this.WBh=this.FSd=null}}Object(I.a)(O,"TopRowControls",null,[]);var X=d(201);d(47);d.d(Y,"CuiHelper",function(){return N});class N{constructor(aa,V,ca=null,fa,ma=null){this.yha=aa;this.nTh=X.a.Rlk(V,ma);this.nTh.push(CommonUIStrings);h.b();N.Ca=void 0===ca||null===ca?e.AFrameworkApplication.Ta:ca}static get Qyj(){return N.fqa||(N.fqa=m.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static jfj(aa,V,ca){return new S(N.lKe,z.a.Oui,z.a.LVd,z.a.Rui,z.a.Qui,z.a.Pui,z.a.Sui,z.a.k7a,aa,"per_SingleCollabUserGlyph_16x16x32",
V,"per_SingleCollabUserGlyph_32x32x32",ca,"per_MoreUsersGlyph_16x16x32",null,null)}static MNi(aa){aa.FSd&&(N.LNi(aa.FSd),aa.FSd=null);aa.WBh&&(N.KNi(),aa.WBh=null);aa.E5e&&(N.NNi(aa.E5e),aa.E5e=null);N.Qyj.vOk();let V;({T7b:V}=y.a.NOb(!1)).returnValue&&n.a.rCa(V)}static E8b(){e.AFrameworkApplication.Ta.processAction(z.a.E8b,2)}static KNi(){e.AFrameworkApplication.RNc&&u.EventHandlerManager.instance.iud(e.AFrameworkApplication.RNc)}static addButton(aa,V,ca,fa,ma,da,qa,F){V=A.a(aa,V,ca,fa,null,null,
null,da,null,null,void 0,void 0,ma);(aa=F.hostControl(aa,V,da))&&qa.appendChild(aa);return aa}static nLc(aa,V,ca){let fa;fa=document.createElement("span");fa.className="BreadcrumbItem";fa.id=V;fa.innerText=ca;fa.setAttribute("dir","auto");aa.appendChild(fa);return fa}static LNi(aa){aa.Pzf&&u.EventHandlerManager.instance.pBl(aa.Pzf)}static NNi(aa){E.a.instance.CFh(J.a.click,aa,N.Vxk,!0)}static Vxk(){e.AFrameworkApplication.B5e?(e.AFrameworkApplication.Aa.Brc(e.AFrameworkApplication.Aa.hb.D6f()),e.AFrameworkApplication.B5e=
!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static v0c(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.hb.v0c}}N.fqa=null;N.ggl="ShareServerWhite_20x20x32";N.p2d="ExternalHeaderFullTopBars";N.Vyj="HeaderTopBars";N.GSd="BreadcrumbBrand";N.HSd="BreadcrumbFolder";N.ISd="BreadcrumbTitle";N.uXf="FolderSeparator";N.l1e="sbTellMe";N.oZe="TellMe-SearchBox";N.y7g="btnOpenInClient";N.dXe="btnFileSharing";N.rnl="BasicChat";N.Mld="btnReplyWithChanges";N.bVf="jbtnGiveFeedback";
N.lKe="PeoplesWellControl";N.BQf="EditableBreadcrumbItem";N.Ca=null;N.Z3e=50;N.Oyj=null;Object(I.a)(N,"CuiHelper",null,[493])},304:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.myb="Image16by16Class";h.fBj="Image30by30Class";h.LEa="Image32by32Class";h.gde="Image48by48Class";h.labelText="LabelText";h.AYj="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.XU="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet=
"IconSet";h.Zfh="ReduxActions";Object(I.a)(h,"SharedControlCommandProperties",null,[])},305:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(I.a)(h,"LaunchData",null,[])},307:function(I,Y,d){I=d(0);var h=d(57),e=d(388),n=d(595),m=d(128),z=d(387),B=d(97),v=d(655),y=d(402),A=d(47),E=d(199),u=d(55),J=d(1112),G=d(27),S=d(165);class P{constructor(ha,Ba){this.cp=ha;this.distance=Ba}}Object(I.a)(P,"CpDistanceResult",null,[]);class Q{constructor(){this.DEa=
0;this.kt=null;this.lub=this.mub=this.fRa=this.SCa=0;this.Vsc=this.VFa=this.vLa=null;this.IAb=this.ada=this.ycd=0;this.f6e=this.y_d=!1;this.U1b=this.JDa=this.rja=this.h3=this.Bmc=0;this.nKh=this.HWf=this.Nrc=this.hNb=!1;this.result=null;this.i1b=this.nXd=this.A7a=this.g8=this.Dca=0;this.Rka=this.iLc=!1;this.cP=null}}Object(I.a)(Q,"CpFromPointState",null,[]);class D{constructor(ha,Ba,va,ta,Fa,pa,ka,Ha=null,Ya=0,Ka=null){this.HCa=this.cp=this.Qa=0;this.h1b=-1;this.deltaX=this.cJf=Number.MAX_VALUE;this.UYa=
0;this.xVa=-Number.MAX_VALUE;this.vVa=-Number.MAX_VALUE;this.O2d=this.G3b=this.isb=this.cHe=!1;this.element=ha;this.point=va;this.Jbb=ta;this.$Pe=Fa;this.ZPe=pa;this.qfg=ka;this.Uia=Ha;this.N6a=Ya;this.originalText=Ba;this.pJa=this.originalText.length;this.Mb=this.pJa-1;this.Y9b=4===this.Jbb||3===this.Jbb;this.cP=Ka}}Object(I.a)(D,"CpFromPointElementState",null,[]);var O=d(44);class X{constructor(ha,Ba,va){this.CpBegin=ha;this.CpEnd=Ba;this.IsEop=va}}Object(I.a)(X,"CpFromPointResult",null,[]);class N{constructor(ha,
Ba,va){this.LineBounds=ha;this.ClientRects=Ba;this.IsRangeMultipleLines=va}}Object(I.a)(N,"LineCoordinateResult",null,[]);class aa{constructor(ha,Ba,va,ta,Fa,pa){this.Vmb={};this.yTb=!0;this.Bog=this.wBc=this.UDc=this.iqb=this.g5a=null;this.ld=ha;this.wZ=Ba;this.PUh=va?va.ka("TextFidelityLayoutFixesEnabled"):!1;this.VTh=va?va.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.FTh=va?va.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.lOa=ta)||z.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");
this.KP=Fa;this.Q1h=pa}Ida(){this.yTb=!1}B7a(ha,Ba,va,ta=null){this.Bog=[];var Fa=ha.x6;if(!ha.textLength)return this.$rj(ha,Ba,va,ta);ta=Object.assign(new Q,{vLa:Array(Fa.length),VFa:Array(Fa.length),Vsc:Array(Fa.length),y_d:!0,kt:Fa,cP:ta});for(var pa=0;pa<=Fa.length;pa++){ta.SCa=0;ta.fRa=0;ta.mub=0;ta.lub=0;ta.DEa=0;ta.hNb=!1;ta.Nrc=!1;if(pa<Fa.length){if(!this.PXi(ha,ta,pa))continue}else{ta.IAb=pa-1;break}if(this.rYi(Ba,ta,pa))break}if(ta.f6e&&ta.Bmc<Ba.y&&Ba.y<ta.h3)return this.z6k(ha,Ba,va,
ta);ta.result=null;ta.Dca=-1;ta.g8=ta.JDa;ta.A7a=Number.MAX_VALUE;ta.nXd=0;ta.i1b=0;ta.iLc=!1;ta.Rka=!1;for(Fa=ta.ada;Fa<=ta.IAb;Fa++)if(pa=this.pYi(ha,Ba,va,Fa,ta))return pa;return this.Jqj(ha,Ba,va,ta)}$rj(ha,Ba,va,ta){const Fa=ha.isRtl;if(!va)return new X(0,0,!1);ha=this.iQa(ha,ta);return!Fa&&Ba.x>ha.x+ha.width/2||Fa&&Ba.x<ha.x+ha.width/2?new X(-1,-1,!0):new X(0,0,!0)}PXi(ha,Ba,va){if(this.Mri(Ba.kt[va].htmlElement)||Ba.kt[va].$yb)return!1;var ta=this.DSd(Ba.kt[va],Ba.cP);Ba.vLa[va]=ta;var Fa=
ta.y;let pa=ta.y+ta.height;Ba.kt[va].Zhg||Ba.kt[va].Rka||Ba.kt[va].W3&&!Ba.kt[va].IUa?({TLf:Fa,SLf:pa}=this.ovf(Ba.kt[va].htmlElement,Fa,pa),Ba.SCa=Ba.mub=Fa,Ba.fRa=Ba.lub=pa,Ba.VFa[va]=pa-Fa,Ba.Vsc[va]=Ba.VFa[va]):(this.Ijl(ha,va)?(ta=this.Ot(ha,Ba.U1b,void 0,void 0,void 0,Ba.cP),Fa=this.D5b(Ba.kt[va].htmlElement),ha=1<Fa?this.Ot(ha,Ba.U1b+Fa-1,void 0,void 0,void 0,Ba.cP):ta,Ba.SCa=Fa=ta.y,Ba.fRa=ta.y+ta.height,Ba.mub=ha.y,Ba.lub=ha.y+ha.height,Ba.VFa[va]=ta.height,Ba.Vsc[va]=ta.height):(ha=this.Q1h.amj(Ba.kt[va].htmlElement),
Ba.DEa=this.lOa.hkj(Ba.kt[va].htmlElement,ha),{TLf:Fa,SLf:pa}=this.ovf(Ba.kt[va].htmlElement,Fa,pa),Ba.nKh=1<Math.abs(ta.width-this.U$i(Ba.kt[va].htmlElement))||1<Math.abs(ta.height-this.T$i(Ba.kt[va].htmlElement)),Ba.nKh&&this.wZ.instance&&(ha=Math.round(ha*this.wZ.instance.i3),Ba.DEa=Math.round(Ba.DEa*this.wZ.instance.i3)),Ba.SCa=Fa-Ba.DEa,Ba.fRa=Fa+ha+Ba.DEa,Ba.mub=pa-ha-Ba.DEa,Ba.lub=pa+Ba.DEa,Ba.VFa[va]=ha+2*Ba.DEa,Ba.Vsc[va]=ha),Ba.ycd=Math.max(Ba.ycd,Ba.VFa[va]));Ba.HWf||(Ba.h3=Ba.SCa,Ba.rja=
Ba.fRa,Ba.HWf=!0);Ba.Nrc=Ba.mub>(Ba.SCa+Ba.fRa)/2;va=aa.hta(Ba.ycd);this.PUh&&(va=this.$Pd(Ba,va));Ba.hNb=this.TJj(Ba.h3,Ba.rja,Fa,va);return!0}TJj(ha,Ba,va,ta){return ha===Ba?va>Ba:va>=Ba-ta}$Pd(ha,Ba){return Ba=this.lOa.$Pd(!!ha.cP&&ha.cP.Yzb,ha.SCa,ha.fRa,Ba)}rYi(ha,Ba,va){if(Ba.hNb||Ba.Nrc){Ba.hNb?Ba.IAb=va-1:(Ba.h3=Math.min(Ba.h3,Ba.SCa),Ba.rja=Math.max(Ba.rja,Ba.fRa),Ba.IAb=va);Array.add(this.Bog,Ba.rja);if(ha.y<=Ba.rja)return!0;Ba.Bmc=Ba.rja;Ba.h3=Ba.mub;Ba.rja=Ba.lub;Ba.ada=va;Ba.JDa=Ba.U1b;
Ba.y_d=Ba.hNb;Ba.f6e=Ba.Nrc;Ba.ycd=Ba.kt[va].Rka||Ba.kt[va].W3&&!Ba.kt[va].IUa?0:Ba.VFa[va]}else Ba.h3=Math.min(Ba.h3,Ba.SCa),Ba.rja=Math.max(Ba.rja,Ba.lub);ha.y>Ba.Bmc&&ha.y<Ba.h3&&!Ba.kt[Ba.ada].Rka&&!Ba.kt[Ba.ada].W3&&Ba.h3-Ba.Bmc<Ba.Vsc[Ba.ada]/2&&(Ba.h3=ha.y);Ba.U1b+=this.OIi(Ba.kt[va]);return!1}z6k(ha,Ba,va,ta){if(ta.kt[ta.ada].W3)return va?new X(ta.JDa,ta.JDa,!1):new X(ta.JDa,ta.JDa+1,!1);if(va=this.bJf(ta.kt[ta.ada].htmlElement,ta.vLa[ta.ada],Ba,ta.y_d?4:3,ta.Bmc,ta.h3,ta.VFa[ta.ada],ha.isRtl,
ha.Uia,ta.JDa,ta.cP))return va=ta.JDa+va.cp,va=this.kvf(ha,Ba,va,ta.ada,ta.JDa,void 0,void 0,ta.cP),new X(va,va,!1);this.ld.Xb(v.a.cok,{["Reason"]:n.a.RUf});return null}pYi(ha,Ba,va,ta,Fa){if(Fa.kt[ta].$yb)return null;const pa=Fa.kt[ta].W3,ka=Fa.kt[ta].Rka;let Ha=!1;if(pa){if(Fa.vLa[ta].y>=Fa.h3&&(Fa.kt[ta].IUa||Fa.kt[ta].i_c)){var Ya=Fa.vLa[ta];const Ka=Ya.x+Ya.width/2,Pa=Math.abs(Ba.x-Ka);if(Pa<Fa.A7a||!Ya.width&&Pa===Fa.A7a)Fa.iLc=!0,Fa.A7a=Pa,Fa.Rka=!1,Fa.Dca=!va||!ha.isRtl&&Ba.x<Ka||ha.isRtl&&
Ba.x>Ka?Fa.g8:Fa.g8+1}if(!Fa.kt[ta].IUa&&!Fa.kt[ta].i_c){Ya=Fa.vLa[ta];if(!va&&Ba.x>Ya.x&&Ba.x<Ya.x+Ya.width&&!Fa.kt[ta].nOj)return new X(Fa.g8,Fa.g8+1,!1);Fa.result=Ba.x<Ya.x+Ya.width/2?new P(ha.isRtl?1:0,Math.max(Ya.x-Ba.x,0)):new P(ha.isRtl?0:1,Math.max(Ba.x-Ya.x-Ya.width,0))}}else ka?(ha=this.iQa(ha,Fa.cP),Ha=1>ha.width,Fa.result=new P(-1,y.a.CNc(Ba,ha))):Fa.result=this.bJf(Fa.kt[ta].htmlElement,Fa.vLa[ta],Ba,ta===Fa.ada&&Fa.f6e?1:ta===Fa.IAb&&!Fa.hNb&&Fa.Nrc?0:2,Fa.h3,Fa.rja,Fa.VFa[ta],ha.isRtl,
ha.Uia,Fa.g8,Fa.cP);Fa.result&&(Fa.result.distance<Fa.A7a||Ha&&Fa.result.distance<=Fa.A7a+1)&&(Fa.Dca=Fa.result.cp+Fa.g8,Fa.Rka=ka,Fa.A7a=Fa.result.distance,Fa.nXd=Fa.g8,Fa.i1b=ta,Fa.iLc=pa);Fa.g8=pa?Fa.g8+1:Fa.g8+this.D5b(Fa.kt[ta].htmlElement);return null}Jqj(ha,Ba,va,ta){if(-1===ta.Dca)return this.ld.Xb(v.a.oHj,{["Reason"]:n.a.MUf}),null;const Fa=ha.textLength;if(ta.Rka){if(va)return va=ta.vLa[ta.vLa.length-1],!ha.isRtl&&Ba.x<va.x+va.width/2||ha.isRtl&&Ba.x>va.x+va.width/2?new X(Fa,Fa,!1):new X(-1,
-1,!0);ta.Dca=Fa}ta.Dca>Fa&&(ta.Dca=Fa);!ta.iLc&&ta.Dca<Fa&&(ta.Dca=this.kvf(ha,Ba,ta.Dca,ta.i1b,ta.nXd,ta.i1b===ta.ada,ta.i1b===ta.IAb,ta.cP));return new X(ta.Dca,ta.Dca,!1)}kvf(ha,Ba,va,ta,Fa,pa=!1,ka=!1,Ha=null){const Ya=ha.isRtl,Ka=ha.characterData,Pa=ha.textLength;va=A.a.ox(Ka,va)?va-1:va;const Oa=A.a.gOj(Ka,va)?va+2:va+1,oa=this.Ot(ha,va,void 0,void 0,void 0,Ha);Ba=Ba.x>oa.x+oa.width/2;if(va-Fa===this.D5b(ha.x6[ta].htmlElement)&&ha.x6.length>ta+1&&ha.x6[ta+1].W3)return va;if(ha.x6[ta].aLj)return++va;
if(ha.x6[ta].$Kj)return va;let Xa=null,Hb=!1;0<va&&(Xa=this.Ot(ha,A.a.ox(Ka,va-1)?va-2:va-1,void 0,void 0,void 0,Ha),0<va-Fa?Hb=Xa.y+Xa.height/2>oa.y:pa||ha.x6[ta-1].W3||(Hb=!0));pa=null;let Ob=!1;if(this.FTh?Oa<=Pa:Oa<Pa)pa=this.Ot(ha,Oa,void 0,void 0,void 0,Ha),Oa-Fa<this.D5b(ha.x6[ta].htmlElement)?Ob=pa.y+pa.height/2<oa.y+oa.height:ka||ha.x6[ta+1].IUa||ha.x6[ta+1].i_c||(Ob=!0);Hb&&Ob?Xa.x<=oa.x&&pa.x>=oa.x?Ba&&(va=Oa):Xa.x>=oa.x&&pa.x<=oa.x?Ba||(va=Oa):Xa.x<pa.x?Ba||(va=Oa):pa.x<Xa.x&&Ba&&(va=
Oa):Hb||(Ob?pa.x>=oa.x&&Ba?va=Oa:pa.x<=oa.x&&!Ba&&(va=Oa):!A.a.fz(Ka.charCodeAt(va))&&(!Ya&&Ba||Ya&&!Ba)&&(va=Oa));return va}R$i(ha){return B.a.yv(ha)}T$i(ha){return ha.offsetHeight}U$i(ha){return ha.offsetWidth}Mri(ha){return!ha.parentNode}D5b(ha){return B.a.B9a(ha)}Ijl(ha,Ba){Ba=ha.x6[Ba];if(Ba.W3)return!1;ha=ha.htmlElement;Sys.UI.DomElement.containsCssClass(ha,"Paragraph")||(ha=ha.firstChild);return""!==ha.style.lineHeight&&ha.style.lineHeight!==Ba.htmlElement.style.lineHeight}OIi(ha){return ha.W3?
1:B.a.B9a(ha.htmlElement)}ovf(ha,Ba,va){va=new Sys.UI.Bounds(0,Ba,0,va-Ba);this.Ubi(ha,[va]);Ba=va.y;va=va.y+va.height;return{TLf:Ba,SLf:va}}Ubi(ha,Ba){if(ha=E.a.Vt(ha)){var va=ha.borderTopWidth,ta=va.indexOf("px");if(-1<ta)for(va=parseInt(va.substr(0,ta)),ta=0;ta<Ba.length;ta++)Ba[ta].y+=va,Ba[ta].height-=va;ha=ha.borderBottomWidth;va=ha.indexOf("px");if(-1<va)for(ha=parseInt(ha.substr(0,va)),va=0;va<Ba.length;va++)Ba[va].height-=ha}}bJf(ha,Ba,va,ta,Fa,pa,ka,Ha,Ya,Ka,Pa=null){if(this.XMj(ha))return this.ld.Xb(v.a.LYi,
{["Reason"]:n.a.QUf}),new P(0,y.a.CNc(va,Ba));if(this.WMj(ha))return this.ld.Xb(v.a.bQc,{["Reason"]:n.a.bQc}),null;ha=this.JCi(ha,va,ta,Fa,pa,ka,Ya,Ka,Pa);if(1>=ha.pJa)return new P(0,y.a.CNc(ha.point,Ba));this.W2k(ha);do{if(ha.Qa>ha.Mb)return this.EKb(),this.ld.Xb(v.a.bok,{["Reason"]:n.a.J_g}),null;this.Xmk(ha)}while(!ha.cHe);for(ha.HCa=!Ha&&ha.UYa<ha.point.x||Ha&&ha.UYa>ha.point.x?ha.Mb:ha.Qa;!ha.isb&&!this.Zhi(ha););if(ha.O2d)for(ha.cp=ha.Qa;ha.cp<=ha.Mb&&!this.c_j(ha);ha.cp++);return this.Isi(ha)}JCi(ha,
Ba,va,ta,Fa,pa,ka,Ha,Ya=null){return new D(ha,this.R$i(ha),Ba,va,ta,Fa,pa,ka,Ha,Ya)}XMj(ha){return!ha.firstChild}WMj(ha){return 3!==ha.firstChild.nodeType}W2k(ha){let Ba;if(0===ha.Jbb){ha.xVa=ha.$Pe;ha.vVa=ha.ZPe;for(var va=40;va<ha.pJa;va+=40)if(Ba=this.hQa(ha.element,ha.originalText,va,ha.Uia,ha.N6a,void 0,void 0,ha.cP),Ba.height&&Ba.y+Ba.height/2>ha.vVa){ha.Mb=va;break}}else if(1===ha.Jbb)for(ha.Mb=ha.pJa-1,ha.xVa=ha.$Pe,ha.vVa=ha.ZPe,va=ha.pJa-40;0<=va;va-=40){if(Ba=this.hQa(ha.element,ha.originalText,
va,ha.Uia,ha.N6a,void 0,void 0,ha.cP),Ba.height&&Ba.y+Ba.height/2<ha.xVa){ha.Qa=va;break}}else if(2===ha.Jbb)ha.Mb=ha.pJa-1,ha.xVa=ha.$Pe,ha.vVa=ha.ZPe;else if(3===ha.Jbb||4===ha.Jbb)for(va=0;va<ha.pJa+40;va+=40){const ta=va<ha.pJa?va:ha.pJa-1;Ba=this.hQa(ha.element,ha.originalText,ta,ha.Uia,ha.N6a,void 0,void 0,ha.cP);if(Ba.height&&(Ba.y+Ba.height<ha.point.y&&(ha.Qa=ta),Ba.y>ha.point.y)){ha.Mb=ta;break}}}Xmk(ha){const Ba=Math.floor((ha.Qa+ha.Mb)/2);ha.cp=Ba;let va=this.hQa(ha.element,ha.originalText,
ha.cp,ha.Uia,ha.N6a,void 0,void 0,ha.cP);for(;ha.cp<ha.Mb&&!va.height;)ha.cp++,va=this.hQa(ha.element,ha.originalText,ha.cp,ha.Uia,ha.N6a,void 0,void 0,ha.cP);ha.cp!==ha.Mb||va.height?!ha.Y9b&&va.y+va.height/2<ha.xVa||ha.Y9b&&va.y+ha.qfg<ha.point.y?ha.Qa=ha.cp+1:!ha.Y9b&&va.y+va.height/2>ha.vVa||ha.Y9b&&va.y>ha.point.y?ha.Mb=ha.cp-1:va.x<=ha.point.x&&va.x+va.width>=ha.point.x?(ha.isb=!0,ha.G3b=!0,ha.cHe=!0):(ha.cHe=!0,ha.UYa=va.x+va.width/2,ha.h1b=ha.cp,ha.deltaX=Math.abs(ha.UYa-ha.point.x),ha.Y9b&&
(ha.xVa=va.y,ha.vVa=va.y+ha.qfg)):ha.Mb=Ba-1}Zhi(ha){var Ba=Math.abs(ha.HCa-ha.cp);if(Ba<ha.cJf)ha.cJf=Ba;else return ha.isb=!0,ha.O2d=!0;Ba=Math.floor((ha.cp+ha.HCa)/2);Ba===ha.cp&&(Ba=ha.HCa);var va=this.hQa(ha.element,ha.originalText,Ba,ha.Uia,ha.N6a,void 0,void 0,ha.cP);if(0<va.height&&va.y+va.height/2<=ha.xVa||va.y+va.height/2>=ha.vVa)ha.HCa=ha.cp<ha.HCa?Ba-1:Ba+1;else if(va.x<=ha.point.x&&va.x+va.width>=ha.point.x)ha.cp=Ba,ha.G3b=!0,ha.isb=!0;else{va=va.x+va.width/2;const ta=Math.abs(ha.UYa-
va),Fa=Math.abs(ha.UYa-ha.point.x),pa=Math.abs(va-ha.point.x);pa<ha.deltaX&&(ha.h1b=Ba,ha.deltaX=pa);ta+pa===Fa?(ha.cp=Ba,ha.UYa=va):Fa+pa===ta?(ha.HCa=ha.cp<ha.HCa?ha.cp+1:ha.cp-1,ha.cp=Ba,ha.UYa=va):ta+Fa===pa&&(ha.isb=!0,ha.O2d=!0)}ha.HCa===ha.cp&&(ha.isb=!0);return!1}c_j(ha){var Ba=this.hQa(ha.element,ha.originalText,ha.cp,ha.Uia,ha.N6a,void 0,void 0,ha.cP);if(0<Ba.height&&Ba.y+Ba.height/2<=ha.xVa||Ba.y+Ba.height/2>=ha.vVa)return!1;if(Ba.x<=ha.point.x&&Ba.x+Ba.width>=ha.point.x)return ha.G3b=
!0;Ba=Math.abs(Ba.x+Ba.width/2-ha.point.x);Ba<ha.deltaX&&(ha.h1b=ha.cp,ha.deltaX=Ba);return!1}Isi(ha){if(!ha.G3b&&-1===ha.h1b)return this.EKb(),this.ld.Xb(v.a.dok,{["Reason"]:n.a.NUf}),null;ha.G3b?ha.deltaX=0:ha.cp=ha.h1b;A.a.ox(ha.originalText,ha.cp)&&ha.cp--;this.EKb();return new P(ha.cp,ha.deltaX)}Ot(ha,Ba,va=!1,ta=!1,Fa=!1,pa=null){let ka;ha||z.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ha=({i:oa,kt:ka,g8:Fa,Fnk:Ba}=this.X6f(ha,Ba,Fa)).returnValue,Ya="";Ya=ha.Uia;ha=B.a.yv(Ha.htmlElement);
let Ka=ha.length,Pa,Oa=!1;if(!Ka)if(Pa=Sys.UI.DomElement.getBounds(Ha.htmlElement),Oa=!0,!Pa.height&&oa<ka.length-1)oa++,Ha=ka[oa],ha=S.b(Ha.htmlElement),Ka=ha.length;else if(!Ha.htmlElement.firstChild||Ha.Zhg)return this.KP.Cga(Pa,pa,()=>Ha.htmlElement.offsetWidth/Ha.htmlElement.offsetHeight);var oa=!1;!Oa&&Ba>=Ka&&(Ba=Ka-1,oa=!0);if(Pa=Ha.W3||!Ha.htmlElement.firstChild||Ha.jhg?this.DSd(Ha,pa):this.hQa(Ha.htmlElement,ha,Ba,Ya,Fa,va,ta,pa))Oa?Pa.width=1:oa&&(Pa.x+=Pa.width,Pa.width=1);this.EKb();
return Pa}tEa(ha,Ba,va=!1,ta=!0){return this.X6f(ha,Ba,va,ta).returnValue}M$b(ha,Ba){return Ba.y>ha.y+ha.height-aa.hta(ha.height)}X6f(ha,Ba,va=!1,ta=!0){let Fa,pa,ka=ha;Fa=ha.x6;for(ha=pa=0;ha<Fa.length;ha++){if(Fa[ha].$yb)continue;let Ha;if(Fa[ha].W3){if(!Ba){va||this.nPj(Fa,ha)?ka=Fa[ha]:(ka=Fa[ha-1],Ba=Ha=B.a.B9a(ka.htmlElement),pa-=Ha);break}Ba--;pa++;continue}Ha=B.a.B9a(Fa[ha].htmlElement);let Ya=!1;if(this.VTh){const Ka=Fa[ha].htmlElement,Pa=Ka.nextSibling;Pa&&(Ya=Sys.UI.DomElement.containsCssClass(Ka,
"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(Pa,"Hyperlink"))}if(Ba<Ha||!Ba&&ta&&!Ya||ha>=Fa.length-1){ka=Fa[ha];break}else Ba-=Ha,pa+=Ha}return{returnValue:ka,i:ha,kt:Fa,g8:pa,Fnk:Ba}}nPj(ha,Ba){if(!Ba)return!0;const va=this.nsb(ha[Ba-1].htmlElement);ha=this.nsb(ha[Ba].htmlElement);return this.M$b(va,ha)}hQa(ha,Ba,va,ta,Fa,pa=!1,ka=!1,Ha=null){let Ya=va+1;va||Ba.length?A.a.ox(Ba,va)?va--:A.a.ox(Ba,Ya)&&Ya++:Ya=0;if(""!==ta)if(ta=Fa+va+"-"+ta,this.yTb){if(Fa=this.Vmb[ta],void 0!==Fa&&null!==
Fa)return ta=this.KP.Cga(Fa,Ha,()=>this.KP.z_f(ha,va)),ta=this.lOa.aQd(Ha,ha,ta)}else this.Vmb={},this.yTb=!0;Fa=this.Buc(ha,va,Ya);pa=pa&&(u.a.Ej||u.a.vo);if(!Fa&&!ka||pa)Ba=this.jlk(ha,Ba,va,Ya),Fa||(Fa=Ba),pa&&Fa&&(Fa.y=Ba.y,Fa.height=Ba.height);""!==ta&&Fa&&(this.Vmb[ta]=new Sys.UI.Bounds(Fa.x,Fa.y,Fa.width,Fa.height));ta=this.KP.Cga(Fa,Ha,()=>this.KP.z_f(ha,va));return ta=this.lOa.aQd(Ha,ha,ta)}Buc(ha,Ba,va){let ta=null;if(this.D5b(ha)<va)return null;u.a.dV&&(ta=this.ilk(ha,Ba,va));!ta&&u.a.Ej&&
(ta=this.klk(ha,Ba,va));return ta}Hzf(ha,Ba=null){return this.nsb(ha.htmlElement.firstChild,Ba)}DSd(ha,Ba=null){return ha.IUa?this.Hzf(ha,Ba):this.nsb(ha.htmlElement,Ba)}nsb(ha,Ba=null){var va=Sys.UI.DomElement.getBounds(ha);va=this.KP.Cga(va,Ba,()=>ha.offsetWidth/ha.offsetHeight);return va=this.lOa.aQd(Ba,ha,va)}jW(ha,Ba,va,ta,Fa,pa){return ha!==Ba.characterData.length||va?this.Rii(ha,Ba,va,ta,Fa,pa):this.Qii(Ba)}Qii(ha){const Ba=this.iQa(ha);return this.C1f(Ba,!ha.isRtl)}Rii(ha,Ba,va,ta,Fa,pa){var ka=
Ba.textLength;if(u.a.yT&&va&&0<ha&&ha<ka){var Ha=this.tEa(Ba,ha-1,!0),Ya=this.tEa(Ba,ha,!0);Ha===Ya&&(va=!1)}var Ka=va?ha-1:ha;A.a.ox(Ba.characterData,Ka)&&--Ka;var Pa=!0;Ya=this.tEa(Ba,Ka,!0,!1);if(Ya.W3)if(Ya.IUa){if(va)return this.jW(ha,Ba,!1,ta,!1,pa);Ha=this.Hzf(Ya)}else if(Ya.i_c){if(va)return this.jW(ha,Ba,!1,ta,!1,pa);if(ha)return this.jW(ha,Ba,!0,ta,!1,pa);Ha=this.DSd(Ya)}else Ha=this.nsb(Ya.htmlElement),Ya.EOj&&(Pa=!1);else{Ya=Ka;do{Ha=this.Ot(Ba,Ya,Fa,pa);if(!Ha)return null;Ya+=1}while(!Ha.height&&
Ya<=ka)}Ya=ka=Ba.isRtl;if(Pa){Pa=this.RGc(Ba,Ka,-1,Fa,pa);Fa=this.RGc(Ba,Ka,1,Fa,pa);pa=new Sys.UI.Point(Ha.x+Ha.width/2,Ha.y+Ha.height/2);Ka=Ha.y;var Oa=Ha.y+Ha.height;Ka=!Pa||Pa.y+Pa.height<=Ka;Oa=!Fa||Fa.y>=Oa;let oa=!1;Ka||Oa?Ka||A.a.fz(Ba.characterData.charCodeAt(ha))?Oa||(Fa.x>=pa.x?Ya=!1:Fa.x<=pa.x&&(Ya=!0),oa=Ya!==ka):(Pa.x<=pa.x?Ya=!1:Pa.x>=pa.x&&(Ya=!0),oa=Ya!==ka):Pa.x<=pa.x&&pa.x<=Fa.x?Ya=!1:Fa.x<=pa.x&&pa.x<=Pa.x?Ya=!0:Pa.x<Fa.x?(Ya=!0,oa=va?pa.x<Pa.x:Pa.x<pa.x):Fa.x<Pa.x&&(Ya=!1,oa=
va?Pa.x<pa.x:pa.x<Pa.x);if(oa&&u.a.RF){if(va&&!ta)return this.jW(ha,Ba,!1,!1);ha||(Ha=this.i8i(Ba,ka))}}return this.C1f(Ha,Ya===va)}RGc(ha,Ba,va,ta,Fa){if(0>va&&0>=Ba||0<va&&Ba>=ha.characterData.length-1)return null;const pa=Ba+va;return A.a.ox(ha.characterData,pa)?this.RGc(ha,pa,va,ta,Fa):this.tEa(ha,Ba,!0,!1).IUa?null:(Ba=this.Ot(ha,pa,ta,Fa))?Ba.height&&Ba.width?Ba:this.RGc(ha,pa,va,ta,Fa):null}i8i(ha,Ba){let va=null;for(var ta=0;ta<ha.x6.length;ta++){const Fa=ha.x6[ta];if(!Fa.$yb){va=Fa.htmlElement;
break}}for(ta=va.childNodes[0];ta&&1===ta.nodeType;)va=ta,ta=va.childNodes[0];ta=B.a.yv(va);B.a.Nx(va,(Ba?"\u202e":"\u202d")+ta);this.Ida();ha=this.Ot(ha,0);B.a.Nx(va,ta);this.Ida();return ha}C1f(ha,Ba){return new Sys.UI.Bounds(Ba?ha.x:ha.x+ha.width,ha.y,0,ha.height)}iQa(ha,Ba=null){return this.nsb(ha.NSf.htmlElement,Ba)}ilk(ha,Ba,va){this.EKb();try{const ta=ha.firstChild,Fa=ta.ownerDocument.createRange();Fa.setStart(ta,Ba);Fa.setEnd(ta,va);const pa=this.eej(Fa,(ka,Ha)=>(0<ka||Ba===va)&&0<Ha);if(!pa||
!pa.length)return null;this.jvf(ta,pa[0]);Fa.detach();return pa[0]}catch(ta){return null}}eej(ha,Ba){this.EKb();try{let va;va=ha.getClientRects();ha=[];for(let ta=0;ta<va.length;ta++){const Fa=va[ta];if(Fa){const pa=Math.floor(Fa.width/1),ka=Math.floor(Fa.height/1);if(Ba(pa,ka)){const Ha=new Sys.UI.Bounds(Math.floor(Fa.left/1),Math.floor(Fa.top/1),pa,ka);Array.add(ha,Ha)}}}return ha}catch(va){return null}}klk(ha,Ba,va){if(!u.a.INb)return null;let ta=null;try{ta=ha.ownerDocument.body.createTextRange(),
ta.moveToElementText(ha)}catch(Fa){return null}if(ta.collapse&&ta.move&&ta.moveEnd)ta.collapse(),ta.move("character",Ba),ta.moveEnd("character",va-Ba);else return null;Ba=new Sys.UI.Bounds(ta.boundingLeft,ta.boundingTop,ta.boundingWidth,ta.boundingHeight);if(!(Ba.x||Ba.y||Ba.width||Ba.height))return null;this.jvf(ha,Ba);ha=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==ha&&(Ba.x=Math.round(Ba.x/ha),Ba.y=Math.round(Ba.y/ha),Ba.width=Math.round(Ba.width/ha),Ba.height=Math.round(Ba.height/ha));
return Ba}jlk(ha,Ba,va,ta){this.g5a&&this.g5a.ownerDocument===ha.ownerDocument||(this.g5a=ha.ownerDocument.createElement("SPAN"),this.iqb=ha.ownerDocument.createElement("SPAN"),this.UDc=ha.ownerDocument.createElement("SPAN"));ha.firstChild!==this.g5a&&(this.wBc=new J.a(ha),B.a.Au(ha),this.lOa&&this.lOa.jti(this.g5a,this.iqb,this.UDc),ha.appendChild(this.g5a),ha.appendChild(this.iqb),ha.appendChild(this.UDc));B.a.Nx(this.g5a,A.a.substring(Ba,0,va));B.a.Nx(this.iqb,A.a.substring(Ba,va,ta));B.a.Nx(this.UDc,
A.a.substring(Ba,ta,Ba.length));G.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&u.a.Tj&&u.a.uKj&&" "===A.a.substring(Ba,va,ta)&&Sys.UI.DomElement.addCssClass(this.iqb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.iqb)}jvf(ha,Ba){this.Pbi(ha,[Ba])}Pbi(ha,Ba){try{if(void 0!==ha.ownerDocument.parentWindow){var va=ha.ownerDocument.parentWindow.frameElement;if(va&&("0"===va.frameBorder||"no"===va.frameBorder))for(ha=0;ha<Ba.length;ha++)Ba[ha].x+=2,Ba[ha].y+=2}}catch(ta){}}EKb(){this.wBc&&
this.wBc.restore();this.wBc=null}osb(ha,Ba){if(""!==Ba){let va;if(this.yTb){if(va=this.Vmb["VE-"+Ba])return ha=new Sys.UI.Bounds(va.x,va.y,va.width,va.height)}else this.Vmb={},this.yTb=!0;va=Sys.UI.DomElement.getBounds(ha);this.Vmb["VE-"+Ba]=va;return ha=new Sys.UI.Bounds(va.x,va.y,va.width,va.height)}return Sys.UI.DomElement.getBounds(ha)}static get instance(){return aa.Ka||(aa.Ka=new aa(e.a.instance,h.a.instance.Ja("Common.IZoomManager"),G.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),
h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static hta(ha){return O.SelectionEditor.hta(ha)}}aa.Ka=null;Object(I.a)(aa,"TextMetrics",null,[]);var V=d(98);class ca{get IUa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.Uac)}get W3(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.pN)}get i_c(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.fBk)}get EOj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
V.a.WFj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.VFj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.TFj)}get Zhg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.V0d)}get jhg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.aIf)}}Object(I.a)(ca,"ATextMetricsElement",null,[540]);var fa=d(33),ma=d(151);class da extends ca{constructor(ha){super();this.zP=ha}get htmlElement(){return this.zP}get Rka(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
V.a.CN)}get $yb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ma.a.fW)}get nOj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.jIj)}get aLj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.pii)||Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.YFj)}get $Kj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.oii)||Sys.UI.DomElement.containsCssClass(this.htmlElement,V.a.XFj)}}Object(I.a)(da,"TextMetricsLeafElement",ca,[570,540]);var qa=
d(54),F=d(59);class sa extends ca{constructor(ha){super();this.npb=ha;this.Ii=this.npb.gb;this.qXb=Array(ha.nt.length);for(ha=0;ha<this.npb.nt.length;ha++){const Ba=new da(this.npb.nt[ha]);this.qXb[ha]=Ba}}get x6(){return this.qXb}get paragraphId(){return this.Ii.id.toString()}get htmlElement(){return this.npb.htmlElement}get Uia(){return this.npb.Qc.Mh?this.npb.gb.id.toString():""}get textLength(){return fa.ParagraphReader.textLength(this.Ii)}get isRtl(){return F.OutlineElementReader.vm(qa.OutlineElementNavigator.UA(this.Ii))}get ps(){return fa.ParagraphReader.$d(this.Ii)&&
!this.Ii.SW}get characterData(){return this.Ii.characterData}get NSf(){return this.qXb.length?this.qXb[this.qXb.length-1]:null}static F7a(ha){return new sa(ha)}}Object(I.a)(sa,"TextMetricsParagraphElement",ca,[539,540]);var ia=d(51),Na=d(34);d.d(Y,"a",function(){return Ca});class Ca{static get g1b(){return Ca.GA||(Ca.GA=h.a.instance.ub("Box4.CharacterPointConverter"))}static get Wc(){return e.a.instance}static Ot(ha,Ba,va=!1,ta=!1,Fa=!1,pa=null){ha=sa.F7a(ha);return aa.instance.Ot(ha,Ba,va,ta,Fa,
pa)}static Buc(ha,Ba,va){return aa.instance.Buc(ha,Ba,va)}static osb(ha,Ba){return aa.instance.osb(ha,Ba)}static jW(ha,Ba,va,ta,Fa=!1,pa=!1){Ba=sa.F7a(Ba);return aa.instance.jW(ha,Ba,va,ta,Fa,pa)}static iQa(ha,Ba=null){ha=sa.F7a(ha);return aa.instance.iQa(ha,Ba)}static Ida(){aa.instance.Ida()}static B7a(ha,Ba,va,ta=null){let Fa=null,pa=null;try{const ka=sa.F7a(ha);let Ha=null;Fa=Ca.Wc.Vp(Na.a.J4i);(Ha=aa.instance.B7a(ka,Ba,va,ta))&&(pa=Ca.g1b?Ca.g1b.tMl(Ha,ha.gb):ia.a.QQa(Ha.CpBegin,Ha.CpEnd,Ha.IsEop,
ha.gb))}catch(ka){Ca.Wc.Xb(m.a.SKl,{["Reason"]:n.a.pTi,["ExceptionMessage"]:ka.message,["ExceptionCallstack"]:ka.stack}),pa=null}Fa&&Fa.end();return pa}static tEa(ha,Ba,va=!1,ta=!0){ha=sa.F7a(ha);return aa.instance.tEa(ha,Ba,va,ta).htmlElement}static M$b(ha,Ba){return aa.instance.M$b(ha,Ba)}}Ca.GA=null;Object(I.a)(Ca,"TextMetricsAdapter",null,[])},312:function(I,Y,d){I=d(0);var h=d(387),e=d(27),n=d(1227);const m=(B,v)=>{const y={};let A=null;switch(B){case 0:A="HtmlProcessor";var E=v.a;null!=E&&(y.SessionID=
E);var u=v.b.toString();null!=u&&(y.Elements=u);var J=v.c.toString();null!=J&&(y.PrunedElements=J);var G=v.d.toString();null!=G&&(y.TransparentElements=G);var S=v.e.toString();null!=S&&(y.VoidElements=S);var P=v.f.toString();null!=P&&(y.UnknownElements=P);break;case 1:A="WordConverter";var Q=v.a;null!=Q&&(y.SessionID=Q);var D=v.b.toString();null!=D&&(y.BulletsConverted=D);var O=v.c.toString();null!=O&&(y.NumberedConverted=O);break;case 2:A="FormattingSteward";var X=v.a;null!=X&&(y.SourceApp=X);var N=
v.b;null!=N&&(y.Browser=N);var aa=v.c;null!=aa&&(y.OperationId=aa);var V=v.d.toString();null!=V&&(y.Lang=V);var ca=v.e.toString();null!=ca&&(y.TextDir=ca);var fa=v.f.toString();null!=fa&&(y.Bold=fa);var ma=v.g.toString();null!=ma&&(y.Math=ma);var da=v.h.toString();null!=da&&(y.Italics=da);var qa=v.i.toString();null!=qa&&(y.Underline=qa);var F=v.j.toString();null!=F&&(y.Strikethrough=F);var sa=v.k.toString();null!=sa&&(y.Subscript=sa);var ia=v.l.toString();null!=ia&&(y.Superscript=ia);var Na=v.m.toString();
null!=Na&&(y.Fontsize=Na);var Ca=v.n.toString();null!=Ca&&(y.Fontface=Ca);var ha=v.o.toString();null!=ha&&(y.GrowFontsize=ha);var Ba=v.p.toString();null!=Ba&&(y.ShrinkFontsize=Ba);var va=v.q.toString();null!=va&&(y.FontColor=va);var ta=v.r.toString();null!=ta&&(y.FontHighlight=ta);var Fa=v.s.toString();null!=Fa&&(y.ParagraphStyle=Fa);var pa=v.t.toString();null!=pa&&(y.TextAlign=pa);var ka=v.u.toString();null!=ka&&(y.TextIndent=ka);var Ha=v.v.toString();null!=Ha&&(y.MarginLeft=Ha);var Ya=v.w.toString();
null!=Ya&&(y.ParagraphSpaceBefore=Ya);var Ka=v.x.toString();null!=Ka&&(y.ParagraphSpaceAfter=Ka);var Pa=v.y.toString();null!=Pa&&(y.LineSpace=Pa);var Oa=v.z.toString();null!=Oa&&(y.CellShadingColor=Oa);break;case 3:A="SemanticEvents";var oa=v.a;null!=oa&&(y.SessionID=oa);var Xa=v.b.toString();null!=Xa&&(y.Text=Xa);var Hb=v.c.toString();null!=Hb&&(y.LineBreak=Hb);var Ob=v.d.toString();null!=Ob&&(y.Image=Ob);var eb=v.e.toString();null!=eb&&(y.File=eb);var Eb=v.f.toString();null!=Eb&&(y.FormattingChange=
Eb);var oc=v.g.toString();null!=oc&&(y.Anchor=oc);var Sb=v.h.toString();null!=Sb&&(y.Paragraph=Sb);var qc=v.i.toString();null!=qc&&(y.Math=qc);var $a=v.j.toString();null!=$a&&(y.List=$a);var ab=v.k.toString();null!=ab&&(y.ListItem=ab);var Ib=v.l.toString();null!=Ib&&(y.RenderAugmentation=Ib);var gc=v.m.toString();null!=gc&&(y.Span=gc);break;case 4:A="SemanticTableEvents";var Ta=v.a;null!=Ta&&(y.SessionID=Ta);var Ab=v.b.toString();null!=Ab&&(y.Tables=Ab);var kc=v.c.toString();null!=kc&&(y.TableRow=
kc);var fb=v.d.toString();null!=fb&&(y.TableCell=fb);var Qb=v.e.toString();null!=Qb&&(y.TablePart=Qb);break;case 5:A="HtmlEvents";var mb=v.a;null!=mb&&(y.OperationId=mb);var Jb=v.b;null!=Jb&&(y.SourceApp=Jb);var Ub=v.c;null!=Ub&&(y.Browser=Ub);var tb=null==v.d?null:v.d.toString();null!=tb&&(y.Text=tb);var Bc=null==v.e?null:v.e.toString();null!=Bc&&(y.A=Bc);var Gb=null==v.f?null:v.f.toString();null!=Gb&&(y.Abbr=Gb);var Hc=null==v.g?null:v.g.toString();null!=Hc&&(y.Acronym=Hc);var $b=null==v.h?null:
v.h.toString();null!=$b&&(y.Address=$b);var lc=null==v.i?null:v.i.toString();null!=lc&&(y.Applet=lc);var Vb=null==v.j?null:v.j.toString();null!=Vb&&(y.Area=Vb);var ic=null==v.k?null:v.k.toString();null!=ic&&(y.B=ic);var qb=null==v.l?null:v.l.toString();null!=qb&&(y.Base=qb);var Wb=null==v.m?null:v.m.toString();null!=Wb&&(y.Basefont=Wb);var Xc=null==v.n?null:v.n.toString();null!=Xc&&(y.Bdo=Xc);var xb=null==v.o?null:v.o.toString();null!=xb&&(y.Big=xb);var Rb=null==v.p?null:v.p.toString();null!=Rb&&
(y.Blockquote=Rb);var wc=null==v.q?null:v.q.toString();null!=wc&&(y.Body=wc);var ud=null==v.r?null:v.r.toString();null!=ud&&(y.Br=ud);var uc=null==v.s?null:v.s.toString();null!=uc&&(y.Button=uc);var db=null==v.t?null:v.t.toString();null!=db&&(y.Caption=db);var Yb=null==v.u?null:v.u.toString();null!=Yb&&(y.Center=Yb);var Zc=null==v.v?null:v.v.toString();null!=Zc&&(y.Cite=Zc);var Kb=null==v.w?null:v.w.toString();null!=Kb&&(y.Code=Kb);var Yc=null==v.x?null:v.x.toString();null!=Yc&&(y.Col=Yc);var ec=
null==v.y?null:v.y.toString();null!=ec&&(y.Colgroup=ec);var rb=null==v.z?null:v.z.toString();null!=rb&&(y.Dd=rb);var ac=null==v.ba?null:v.ba.toString();null!=ac&&(y.Del=ac);var Jc=null==v.bb?null:v.bb.toString();null!=Jc&&(y.Dfn=Jc);var Db=null==v.bc?null:v.bc.toString();null!=Db&&(y.Dir=Db);var dd=null==v.bd?null:v.bd.toString();null!=dd&&(y.Div=dd);var Cd=null==v.be?null:v.be.toString();null!=Cd&&(y.Dl=Cd);var pd=null==v.bf?null:v.bf.toString();null!=pd&&(y.Dt=pd);var Ge=null==v.bg?null:v.bg.toString();
null!=Ge&&(y.Em=Ge);var kd=null==v.bh?null:v.bh.toString();null!=kd&&(y.Fieldset=kd);var Xf=null==v.bi?null:v.bi.toString();null!=Xf&&(y.Font=Xf);var Kd=null==v.bj?null:v.bj.toString();null!=Kd&&(y.Form=Kd);var lg=null==v.bk?null:v.bk.toString();null!=lg&&(y.Frame=lg);var ve=null==v.bl?null:v.bl.toString();null!=ve&&(y.Frameset=ve);var Ua=null==v.bm?null:v.bm.toString();null!=Ua&&(y.H=Ua);var Bb=null==v.bn?null:v.bn.toString();null!=Bb&&(y.Head=Bb);var mc=null==v.bo?null:v.bo.toString();null!=mc&&
(y.Hr=mc);var Nc=null==v.bp?null:v.bp.toString();null!=Nc&&(y.Html=Nc);var nd=null==v.bq?null:v.bq.toString();null!=nd&&(y.I=nd);var Dd=null==v.br?null:v.br.toString();null!=Dd&&(y.Iframe=Dd);var La=null==v.bs?null:v.bs.toString();null!=La&&(y.Img=La);var gb=null==v.bt?null:v.bt.toString();null!=gb&&(y.Input=gb);var vc=null==v.bu?null:v.bu.toString();null!=vc&&(y.Ins=vc);var td=null==v.bv?null:v.bv.toString();null!=td&&(y.Isindex=td);var Nd=null==v.bw?null:v.bw.toString();null!=Nd&&(y.Kbd=Nd);var Od=
null==v.bx?null:v.bx.toString();null!=Od&&(y.Label=Od);var Oc=null==v.by?null:v.by.toString();null!=Oc&&(y.Legend=Oc);var Af=null==v.bz?null:v.bz.toString();null!=Af&&(y.Li=Af);var Ae=null==v.ca?null:v.ca.toString();null!=Ae&&(y.Link=Ae);var Ye=null==v.cb?null:v.cb.toString();null!=Ye&&(y.Map=Ye);var Wd=null==v.cc?null:v.cc.toString();null!=Wd&&(y.Math=Wd);var je=null==v.cd?null:v.cd.toString();null!=je&&(y.Menu=je);var dg=null==v.ce?null:v.ce.toString();null!=dg&&(y.Meta=dg);var nf=null==v.cf?null:
v.cf.toString();null!=nf&&(y.Noframes=nf);var Cb=null==v.cg?null:v.cg.toString();null!=Cb&&(y.Noscript=Cb);var Cf=null==v.ch?null:v.ch.toString();null!=Cf&&(y.Object=Cf);var of=null==v.ci?null:v.ci.toString();null!=of&&(y.Ol=of);var Lg=null==v.cj?null:v.cj.toString();null!=Lg&&(y.Optgroup=Lg);var vd=null==v.ck?null:v.ck.toString();null!=vd&&(y.Option=vd);var Lh=null==v.cl?null:v.cl.toString();null!=Lh&&(y.P=Lh);var tf=null==v.cm?null:v.cm.toString();null!=tf&&(y.Param=tf);var Ue=null==v.cn?null:v.cn.toString();
null!=Ue&&(y.Pre=Ue);var ff=null==v.co?null:v.co.toString();null!=ff&&(y.Q=ff);var Ef=null==v.cp?null:v.cp.toString();null!=Ef&&(y.S=Ef);var wh=null==v.cq?null:v.cq.toString();null!=wh&&(y.Samp=wh);var xh=null==v.cr?null:v.cr.toString();null!=xh&&(y.Script=xh);var qd=null==v.cs?null:v.cs.toString();null!=qd&&(y.Select=qd);var Hf=null==v.ct?null:v.ct.toString();null!=Hf&&(y.Small=Hf);var Ag=null==v.cu?null:v.cu.toString();null!=Ag&&(y.Span=Ag);var He=null==v.cv?null:v.cv.toString();null!=He&&(y.Strike=
He);var af=null==v.cw?null:v.cw.toString();null!=af&&(y.Strong=af);var yd=null==v.cx?null:v.cx.toString();null!=yd&&(y.Style=yd);var me=null==v.cy?null:v.cy.toString();null!=me&&(y.Sub=me);var Ic=null==v.cz?null:v.cz.toString();null!=Ic&&(y.Sup=Ic);var Fe=null==v.da?null:v.da.toString();null!=Fe&&(y.Tables=Fe);var Uc=null==v.db?null:v.db.toString();null!=Uc&&(y.Tbody=Uc);var Uf=null==v.dc?null:v.dc.toString();null!=Uf&&(y.Td=Uf);var vg=null==v.dd?null:v.dd.toString();null!=vg&&(y.Textarea=vg);var Yg=
null==v.de?null:v.de.toString();null!=Yg&&(y.Tfoot=Yg);var Cc=null==v.df?null:v.df.toString();null!=Cc&&(y.Th=Cc);var Rc=null==v.dg?null:v.dg.toString();null!=Rc&&(y.Thead=Rc);var Ve=null==v.dh?null:v.dh.toString();null!=Ve&&(y.Title=Ve);var ob=null==v.di?null:v.di.toString();null!=ob&&(y.Tr=ob);var Mb=null==v.dj?null:v.dj.toString();null!=Mb&&(y.Tt=Mb);var nc=null==v.dk?null:v.dk.toString();null!=nc&&(y.U=nc);var Qc=null==v.dl?null:v.dl.toString();null!=Qc&&(y.Ul=Qc);var id=null==v.dm?null:v.dm.toString();
null!=id&&(y.Var=id);var ld=null==v.dn?null:v.dn.toString();null!=ld&&(y.Unknown=ld);break;case 6:A="List";var xd=v.a;null!=xd&&(y.SessionID=xd);var ue=v.b.toString();null!=ue&&(y.MaxListLevel=ue)}y.Table=A;return Sys.Serialization.JavaScriptSerializer.serialize(y)};d.d(Y,"a",function(){return z});class z{static get l9(){null==z.H3a&&(z.H3a=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return z.H3a}static get Sjg(){null==z.JDd&&(z.JDd=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return z.JDd}static RQ(B){h.ULS.sendTraceTag(5822145,307,50,B)}static x2f(B){const v={};v.a=B;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;return v}static H2j(B){z.l9||z.RQ(m(0,B))}static vae(B){const v={};v.a=B;v.b=0;v.c=0;return v}static G4j(B){z.l9||z.RQ(m(1,B))}static w2f(B,v){const y={};y.c=n.a[B];y.a=v;return y}static G2j(B,v){z.Sjg&&B&&(B.b=v,z.RQ(m(5,B)))}static k6f(B){const v={};v.a=B;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;v.g=0;v.h=0;v.i=0;v.j=0;
v.k=0;v.l=0;v.m=0;return v}static U3j(B){z.l9||z.RQ(m(3,B))}static l6f(B){const v={};v.a=B;v.b=0;v.c=0;v.d=0;v.e=0;return v}static V3j(B){z.l9||z.RQ(m(4,B))}static n7d(B,v){const y={};y.b=n.a[B];y.c=v;y.d=0;y.e=0;y.f=0;y.g=0;y.h=0;y.i=0;y.j=0;y.k=0;y.l=0;y.m=0;y.n=0;y.o=0;y.p=0;y.q=0;y.r=0;y.s=0;y.t=0;y.w=0;y.x=0;y.y=0;y.z=0;y.u=0;y.v=0;return y}static v2j(B,v){z.Sjg&&B&&(B.a=v,z.RQ(m(2,B)))}static Zbj(B){const v={};v.a=B;v.b=-1;return v}static $2j(B){!z.l9&&B&&0<=B.b&&z.RQ(m(6,B))}}z.H3a=null;z.JDd=
null;Object(I.a)(z,"UsageEditor",null,[])},330:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.jba=1E5;Object(I.a)(h,"ViewConstants",null,[])},331:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.re=this.$f=this.ge=this.Of=0}eVi(e){return e.re<this.$f&&this.re<e.$f&&e.ge<this.Of&&this.ge<e.Of}svb(e){return e.re>=this.re&&e.$f<=this.$f&&e.ge>=this.ge&&e.Of<=this.Of}XUi(e,n){return e>=this.DWf&&e<=this.lne&&n>=this.wWf&&n<=this.dne}bSa(){return 0>=
this.UO||0>=this.xR}equals(e){return e.re===this.re&&e.$f===this.$f&&e.ge===this.ge&&e.Of===this.Of}clone(){return Object.assign(new h,{re:this.re,$f:this.$f,ge:this.ge,Of:this.Of})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.re,this.$f,this.ge,this.Of)}get UO(){return this.$f-this.re}get xR(){return this.Of-this.ge}get lne(){return this.$f-1}get dne(){return this.Of-1}get DWf(){return this.re}get wWf(){return this.ge}}Object(I.a)(h,"CellRange",
null,[])},332:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.sW="data-copystatus";h.NQa="data-copyfailedreason";h.Gp="data-clipservice-ccpid";h.version="data-clipservice-version";h.location="data-clipservice-location";h.tD="data-clipservice-dc";h.type="data-clipservice-type";h.$Fe="data-clipservice-param";h.count="data-clipservice-count";h.kFa="data-clipservice-cut";h.iFa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.Yti="data-clipboardasbytes-url";
h.sJh="wacserver";h.sessionId="data-SessionId";h.ekb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.RBj="data-willexpire";h.vdg="ClipboardAsImage";h.zy="data-pkey";Object(I.a)(h,"ClipServiceConstants",null,[])},333:function(I,Y,d){d.d(Y,"a",function(){return E});I=d(0);var h=d(1200),e=d(42),n=d(479),m=d(161),z=d(39),B=d(63),v=d(28),y=d(968),A=d(969);class E{constructor(u){this.tE=u}get node(){return this.tE}get propertySet(){return this.tE}get Ww(){if(1074135132===this.tE.Ue)return 0;
if(1074135137===this.tE.Ue)return 1;v.a.J(18354962,802,10,"Invalid AppType {0}",n.a[this.tE.Ue]);return-1}get id(){return 0===this.Ww?this.propertySet.sa(z.a.KZ,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(z.a.KZ,null)}get GPf(){return this.propertySet.sa(e.a.CQd,null)}get visibility(){return this.propertySet.sa(e.a.fZb,!1)}get width(){return this.propertySet.sa(e.a.Hdi,320)}get row(){return this.propertySet.sa(e.a.Gdi,0)}get hgg(){return this.propertySet.sa(m.a.isForUILessAction,
!1)}get Sxa(){return this.propertySet.sa(e.a.Crb,null)}get version(){return this.propertySet.sa(e.a.qHc,null)}get store(){return this.propertySet.sa(e.a.pHc,null)}get storeType(){return this.propertySet.eb(z.a.cZb)}get ownerAddinSolutionId(){return this.propertySet.sa(z.a.j8g,null)}get sharedRuntimeId(){return this.propertySet.sa(m.a.sharedRuntimeId,null)}get settings(){const u={};y.a(this.node,(J,G)=>{A.b(G,u)});return u}get slideId(){return 0===this.Ww?B.a.UE(this.tE.eb(z.a.sid),this.tE.eb(z.a.cid)):
null}get shapeId(){const u=Object(h.a)(4,this.tE);return 0===this.Ww&&u?u.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(z.a.ownerAddinStoreType,null)}get asb(){return this.propertySet.sa(z.a.asb,-1)}get z6a(){return this.propertySet.sa(z.a.z6a,null)}}Object(I.a)(E,"AppReader",null,[767])},334:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(27);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ga("EditDocInClientUrl")}}Object(I.a)(e,"SmartLookupApplicationInterface",
null,[])},343:function(I,Y,d){var h=d(18),e=d(114),n=d(501),m=d(149),z=d(230);I=d(0);var B=d(206),v=d(28);class y{constructor(O,X,N,aa){this.type=O;this.stops=X;this.angle=N;this.TDk=aa}jV(){const O=B.b(this.stops,X=>X.jV()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",this.angle,O);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.TDk.jV(),O);v.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",
this.type));return z.Color.auto.jV()}static createLinearGradient(O,X){return new y(0,O,X,null)}static xFi(O,X){return new y(1,O,0,X)}}Object(I.a)(y,"GradientFill",null,[]);class A{constructor(O,X){this.left=O;this.top=X}jV(){return String.format("{0}% {1}%",this.left,this.top)}}Object(I.a)(A,"GradientPathCenter",null,[]);class E{constructor(O,X){this.color=O;this.position=X}jV(){return String.format("{0} {1}%",this.color.jV(),this.position)}}Object(I.a)(E,"GradientStop",null,[]);d.d(Y,"a",function(){return u});
d.d(Y,"g",function(){return J});d.d(Y,"e",function(){return G});d.d(Y,"b",function(){return S});d.d(Y,"c",function(){return P});d.d(Y,"f",function(){return Q});d.d(Y,"d",function(){return D});const u=O=>{O?(O=e.a(O),O=Object.assign(new n.a,{blipFillField:O.blipFillField||null,gradFillField:O.gradFillField||null,grpFillField:O.grpFillField||null,noFillField:O.noFillField||null,pattFillField:O.pattFillField||null,solidFillField:O.solidFillField||null})):O=null;return O},J=O=>{m.Box4ColorHelper.LRa(O)},
G=O=>{O=e.a(O);return!O||!O.blipFillField&&!O.gradFillField&&!O.grpFillField&&!O.noFillField&&!O.pattFillField&&!O.solidFillField},S=O=>{m.Box4ColorHelper.LRa(O)},P=O=>{S(O);O&&(O.cell3DField=null,O.extLstField=null,O.lnBField=null,O.lnBlToTrField=null,O.lnLField=null,O.lnRField=null,O.lnTField=null,O.lnTlToBrField=null)},Q=(O,X)=>{if(!O)return null;var N=O.gsLstField;if(N){var aa=new h.a;for(const V of N)N=m.Box4ColorHelper.gPc(V),m.Box4ColorHelper.rab(N)?v.a.J(18397184,822,15,"Encountered invalid gradient stop color."):
aa.add(new E(m.Box4ColorHelper.TJ(N,X),V.posField/1E3));X=aa.toArray()}else X=null;if(O.linField)return aa=90,O.linField.angFieldSpecified&&(aa=(O.linField.angField/6E4+90)%360),y.createLinearGradient(X,aa);if(O.pathField)return aa=new A(50,50),O.pathField.fillToRectField&&(aa=new A(O.pathField.fillToRectField.lField/1E3,O.pathField.fillToRectField.tField/1E3)),y.xFi(X,aa);v.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");return y.createLinearGradient(X,90)},D=O=>e.b(O)},
348:function(I,Y,d){I=d(0);var h=d(518),e=d(143);class n extends h.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:n.getTypeName(),B_:n.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(I.a)(n,"OperationWithSiblingContext",h.a,[]);d.d(Y,"a",function(){return m});class m extends n{constructor(){super();this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(I.a)(m,"AddOperation",n,[])},349:function(I,Y,d){I=d(0);var h=d(387),e=d(270),n=d(663),m=d(29),z=d(520);class B{}Object(I.a)(B,"ProofingFeedbackLoopRequestObject",null,[]);var v=d(521),y=d(34),A=d(519);d.d(Y,"a",function(){return E});class E extends n.a{constructor(u,J,G,S,P=null){super(J);this.tba=u;this.uUh=G;this.IYh=S;this.Ldf=!1;this.$a=P;this.errorType=1===(this.tba.CritiqueActions&1)?0:1}get proofingType(){return z.b(this.tba)}get traceId(){return this.tba.TraceId}get typeId(){return this.tba.TypeId}get xN(){return this.tba}get suggestions(){const u=
[];if(this.tba.Suggestions)for(const J of this.tba.Suggestions)u.push(J.Text);return u}get metadata(){const u=[];if(this.tba.Metadata&&0<this.tba.Metadata.length)for(const J of this.tba.Metadata)J.Name&&J.Value&&u.push(J);return u}aMa(u,J=0){this.Jlf.track(()=>Object.assign(new v.a,{E:2,T:this.proofingType,A:u,I:J,G:this.typeId}));if(this.uUh){var G=e.a.xe(this.lcid);let S="";G?S=G.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);G=null;h.ULS.sendTraceTag(39416218,
375,50,"Sending proofing context with feedback loop API");G=Object.assign(new B,{AppId:A.a[m.App.mode]+"_online",TraceId:this.traceId,LanguageId:S,CritiqueTypeId:this.typeId,EventId:this.Mjk(u),FlaggedText:this.token,SuggestionText:this.hlj(u),PreContextBegin:this.laa,PostContextEnd:this.KJa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.tba.Priority,Metadata:this.tba.Metadata});14!==G.EventId&&this.IYh.J7k(G)}}Mjk(u){switch(u){case y.a.yka:return 0;case y.a.cde:return 1;
case y.a.bDa:return 3;case y.a.kza:return 4;case y.a.lza:return 5;case y.a.mza:return 6;case y.a.Kub:return 13;default:return 14}}hlj(u){switch(u){case y.a.kza:return this.suggestions[0];case y.a.lza:return this.suggestions[1];case y.a.mza:return this.suggestions[2];case y.a.ILa:return this.suggestions[3];case y.a.JLa:return this.suggestions[4];default:return""}}get KEa(){return this.Ldf}set KEa(u){this.Ldf=u}}Object(I.a)(E,"EditorServiceErrorDetails",n.a,[615,616])},350:function(I,Y,d){var h=d(273),
e=d(791),n=d(1229),m=d(47),z=d(216),B=d(27);I=d(0);class v{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(I.a)(v,"RecentColor",null,[]);var y=d(230),A=d(245),E=d(231),u=d(264),J=d(1044),G=d(537),S=d(28);d.d(Y,"f",function(){return P});d.d(Y,"e",function(){return Q});d.d(Y,"d",function(){return D});d.d(Y,"c",function(){return O});d.d(Y,"g",function(){return X});d.d(Y,"b",function(){return N});d.d(Y,"a",function(){return aa});d.d(Y,"h",function(){return V});const P=(fa,ma,da,qa,F,sa,ia)=>
Q(fa,ma,da,qa,F,sa,ia,!1),Q=(fa,ma,da,qa,F,sa,ia,Na)=>{ma=Object.assign(new h.a,{Id:ma,ControlsId:da,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});qa=Object.assign(new e.a,{Id:qa,ExternalId:F,McuExternalId:String.format("{0}MCU",F),McuLayout:!0,Command:sa,Width:10});if(fa)if(F=[],1===ia||2===ia){Na=(new J.a).z5i(fa);({themeColors:fa,CBh:ia}=ca(Na,fa));for(var Ca=0;6>Ca;Ca++)for(var ha=0;ha<fa.length;ha++){sa=F;da=sa.push;var Ba=void 0,va=void 0;Ba=Na;var ta=fa[ha][Ca];va=fa[ha][0];var Fa=
ia[ha],pa=Ca,ka=ha;ta=m.a.hw(ta.r,2)+m.a.hw(ta.g,2)+m.a.hw(ta.b,2);({iKc:Ba,zOb:va}=Ba.b6d(va,ta,Fa,pa,ka));ta=Object.assign(new n.a,{Color:"#"+Ba,DisplayColor:"#"+ta,Alt:va});da.call(sa,ta)}}else for(Na=(new J.a).T_f(fa,Na),{themeColors:fa,CBh:ia}=ca(Na,fa),Ca=0;6>Ca;Ca++)for(ha=0;ha<fa.length;ha++)sa=F,da=sa.push,Ba=Na,ta=fa[ha][Ca],va=fa[ha][0],Fa=ia[ha],pa=Ca,ka=ha,ta=m.a.hw(ta.r,2)+m.a.hw(ta.g,2)+m.a.hw(ta.b,2),{iKc:va,zOb:Ba}=Ba.b6d(va,ta,Fa,pa,ka),{u3k:va,e6k:Ba,zOb:ta}={u3k:ta,e6k:va,zOb:Ba},
ta=Object.assign(new n.a,{Color:Ba,DisplayColor:"#"+va,Alt:ta}),da.call(sa,ta);else F=null;qa.Colors=F;Array.add(ma.ControlList,qa);return ma},D=(fa,ma,da,qa,F,sa)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:ma,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});da=Object.assign(new e.a,{Id:da,ExternalId:qa,Command:F,Width:10,Colors:[]});sa?(da.Colors.push(Object.assign(new n.a,{Color:"0000C0",Alt:m.a.ue(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),da.Colors.push(Object.assign(new n.a,
{Color:"0000FF",Alt:m.a.ue(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),da.Colors.push(Object.assign(new n.a,{Color:"00C0FF",Alt:m.a.ue(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),da.Colors.push(Object.assign(new n.a,{Color:"00FFFF",Alt:m.a.ue(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),da.Colors.push(Object.assign(new n.a,{Color:"50D092",Alt:m.a.ue(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),da.Colors.push(Object.assign(new n.a,
{Color:"50B000",Alt:m.a.ue(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),da.Colors.push(Object.assign(new n.a,{Color:"F0B000",Alt:m.a.ue(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),da.Colors.push(Object.assign(new n.a,{Color:"C07000",Alt:m.a.ue(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),da.Colors.push(Object.assign(new n.a,{Color:"602000",Alt:m.a.ue(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),da.Colors.push(Object.assign(new n.a,
{Color:"A03070",Alt:m.a.ue(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(da.Colors.push(Object.assign(new n.a,{Color:"#C00000",Alt:m.a.ue(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),da.Colors.push(Object.assign(new n.a,{Color:"#FF0000",Alt:m.a.ue(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),da.Colors.push(Object.assign(new n.a,{Color:"#FFC000",Alt:m.a.ue(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),da.Colors.push(Object.assign(new n.a,
{Color:"#FFFF00",Alt:m.a.ue(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),da.Colors.push(Object.assign(new n.a,{Color:"#92D050",Alt:m.a.ue(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),da.Colors.push(Object.assign(new n.a,{Color:"#00B050",Alt:m.a.ue(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),da.Colors.push(Object.assign(new n.a,{Color:"#00B0F0",Alt:m.a.ue(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),da.Colors.push(Object.assign(new n.a,
{Color:"#0070C0",Alt:m.a.ue(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),da.Colors.push(Object.assign(new n.a,{Color:"#002060",Alt:m.a.ue(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),da.Colors.push(Object.assign(new n.a,{Color:"#7030A0",Alt:m.a.ue(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(fa.ControlList,da);return fa},O=(fa,ma,da,qa,F,sa,ia)=>{ma=Object.assign(new h.a,{Id:ma,ControlsId:da,Title:ResourceStrings.L_RecentColors,ControlList:[]});
qa=Object.assign(new e.a,{Id:qa,ExternalId:F,Command:sa,Width:10,Colors:[]});if(ia)for(ia=0;fa&&ia<fa.length&&fa[ia];ia++)F=fa[ia],qa.Colors.push(Object.assign(new n.a,{Color:F.hex,Alt:m.a.ue(F.hex),DisplayColor:F.hex}));else for(ia=0;fa&&ia<fa.length&&fa[ia];ia++)F=fa[ia],qa.Colors.push(Object.assign(new n.a,{Color:"#"+F.hex,Alt:m.a.ue("#"+F.hex),DisplayColor:"#"+F.hex}));Array.add(ma.ControlList,qa);return ma},X=(fa,ma)=>{if(!ma)return fa;var da=new v;da.hex=ma;const qa=[];let F=0;qa[F++]=da;for(da=
0;fa&&da<fa.length&&10>da&&10>F&&fa[da];da++)fa[da].hex!==ma&&(qa[F++]=fa[da]);return qa},N=(fa,ma,da,qa,F,sa,ia,Na)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:ma,DisplayMode:"Menu16",ControlList:[]});da=Object.assign(new z.a,{Command:da,LabelText:qa,Image16by16:B.AFrameworkApplication.rm,Image16by16Class:ia,Id:F,ExternalId:sa,KeyTip:Na});Array.add(fa.ControlList,da);return fa},aa=(fa,ma,da,qa,F,sa,ia,Na)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:ma,DisplayMode:"Menu16",ControlList:[]});da=Object.assign(new z.a,
{Command:da,LabelText:qa,Image16by16:B.AFrameworkApplication.rm,Image16by16Class:ia,Id:F,ExternalId:sa,KeyTip:Na});Array.add(fa.ControlList,da);return fa},V=(fa,ma,da)=>{for(let Ba=0;Ba<fa.MenuSectionList.length;Ba++){var qa=fa.MenuSectionList[Ba],F=qa.ControlList;if(F&&0<F.length&&(F=F[0]))if(ma)if(qa.Id===G.a.themeColors&&da){var sa=E.i(ma.sD)||"";qa=da;var ia=F.Colors,Na="#";if(ia&&ia.length)if(m.a.Wa(sa))S.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");
else for(var Ca=0;Ca<ia.length;Ca++){var ha=ia[Ca].Color;if(!m.a.Wa(ha)&&(ha=(ha=A.a.parse(ia[Ca].Color))?ha.utc():u.SchemeColor.parse(ia[Ca].Color),qa&&ha&&ha.RPe(qa)&&ha.Kta&&(ha=E.i(ha.ZP),ha.toLowerCase()===sa.toLowerCase()))){Na=ia[Ca].Color;break}}qa=Na;F.SelectedColorId=qa}else{ia=E.i(E.g(ma.sD))||"";qa=F.Colors;sa="#";if(qa&&qa.length)if(m.a.Wa(ia))S.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Na=0;Na<qa.length;Na++)if(Ca=qa[Na].DisplayColor,
!m.a.Wa(Ca)&&Ca.replace("#","").toLowerCase()===ia.toLowerCase()){sa=qa[Na].Color;break}qa=sa;F.SelectedColorId=qa}else F.SelectedColorId="#"}},ca=(fa,ma)=>{let da;da=Array(10);da[0]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Background1));da[1]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Text1));da[2]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Background2));da[3]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Text2));da[4]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Accent1));da[5]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Accent2));
da[6]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Accent3));da[7]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Accent4));da[8]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Accent5));da[9]=fa.iL(y.Color.Ti(ma.PresetSchemeColorMapping.Accent6));fa=Array(10);fa[0]=ResourceStrings.l_ThemeLabel1;fa[1]=ResourceStrings.l_ThemeLabel2;fa[2]=ResourceStrings.l_ThemeLabel3;fa[3]=ResourceStrings.l_ThemeLabel4;fa[4]=ResourceStrings.l_ThemeLabel5;fa[5]=ResourceStrings.l_ThemeLabel6;fa[6]=ResourceStrings.l_ThemeLabel7;
fa[7]=ResourceStrings.l_ThemeLabel8;fa[8]=ResourceStrings.l_ThemeLabel9;fa[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:da,CBh:fa}}},378:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.uHf="CU";h.Bwi="CS";h.ywi="CE";h.Wme="KP";h.zul="TI";h.T2j="L";Object(I.a)(h,"CharacterBlockTrackerKeys",null,[])},379:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.source=this.id=null}}Object(I.a)(h,"Item",null,[])},380:function(I,
Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(36);class e{constructor(n,m){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=n;this.Flight=m}serialize(){return h.c([this.Zk(),this])}}Object(I.a)(e,"ACommonHandlerRequest",null,[])},381:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.Btc="ToolbarButton";h.yOb="ToolbarButtonHome";h.insertPicture="InsertPicture";h.zZe="SlideNavigationDesignMode";h.Yib="Retrigger";h.refresh="Refresh";h.typing="Typing";h.zNf=
"DesignElementsDeleted";h.AUd="ChangeSlideSize";h.Orb="ApplyTheme";h.uZe="SlideChangeLayout";h.mna="NewSlide";h.uUd="ChangeIconInSmartArt";h.dtb="ChangeIcon";h.insertTable="InsertTable";h.Bxa="PasteTable";h.iXc="InsertChart";h.UQd="ApplyReplaceObject";h.moreIdeas="MoreIdeas";h.newDocument="NewDocument";h.h_d="DesignTab";h.makeItVisual="MakeItVisual";h.yJa="PasteText";h.$Wd="ConvertedToPPT";h.fQd="AgendaToPPT";Object(I.a)(h,"DesignerTrigger",null,[])},382:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{}Object(I.a)(h,"OAuthResult",null,[])},386:function(I,Y,d){I=d(0);var h=d(55),e=d(27),n=d(47),m=d(106),z=d(1227),B=d(14),v=d(1200),y;(function(fa){fa[fa.none=0]="none";fa[fa.noSystemClipboardAccess=1]="noSystemClipboardAccess";fa[fa.cutCopyDisallowed=2]="cutCopyDisallowed";fa[fa.pasteDisallowed=3]="pasteDisallowed";fa[fa.invalidPasteContext=4]="invalidPasteContext";fa[fa.invalidCcpOperation=5]="invalidCcpOperation";fa[fa.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";fa[fa.pastedHtmlLengthExceeded=
7]="pastedHtmlLengthExceeded";fa[fa.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";fa[fa.noShapesPasted=9]="noShapesPasted";fa[fa.invalidImagePasteArgs=10]="invalidImagePasteArgs";fa[fa.invalidClipboardData=11]="invalidClipboardData";fa[fa.invalidCopiedShapes=12]="invalidCopiedShapes";fa[fa.invalidCopiedSlides=13]="invalidCopiedSlides";fa[fa.invalidHtmlContent=14]="invalidHtmlContent";fa[fa.textEditFailed=15]="textEditFailed";fa[fa.clipServiceDataInvalid=16]="clipServiceDataInvalid";fa[fa.crossDCPasteDisallowed=
17]="crossDCPasteDisallowed";fa[fa.imageTooLarge=18]="imageTooLarge";fa[fa.noAvailablePasteHandler=19]="noAvailablePasteHandler";fa[fa.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";fa[fa.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";fa[fa.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";fa[fa.copyObjectEmpty=23]="copyObjectEmpty";fa[fa.tableInvalid=24]="tableInvalid";fa[fa.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";fa[fa.userOffline=26]="userOffline";fa[fa.picklingPasteFailedDueToMaxSizeLimit=
27]="picklingPasteFailedDueToMaxSizeLimit";fa[fa.picklingInvalidCopyData=28]="picklingInvalidCopyData";fa[fa.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";fa[fa.chunkUploaderFailure=30]="chunkUploaderFailure";fa[fa.pasteCancelledByUser=31]="pasteCancelledByUser";fa[fa.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(y||(y={}));Object(I.b)("CcpFailure",y);var A=d(938),E=d(114),u=d(28),J=d(332),G;(function(fa){fa[fa.none=0]="none";fa[fa.text=1]="text";fa[fa.shape=2]="shape";fa[fa.textbox=
3]="textbox";fa[fa.normalShape=4]="normalShape";fa[fa.image=5]="image";fa[fa.table=6]="table";fa[fa.chart=7]="chart";fa[fa.video=8]="video";fa[fa.list=9]="list";fa[fa.ink=10]="ink";fa[fa.addin=11]="addin";fa[fa.smartArt=12]="smartArt";fa[fa.group=13]="group";fa[fa.placeholder=14]="placeholder";fa[fa.line=15]="line";fa[fa.activeX=16]="activeX";fa[fa.oleObject=17]="oleObject";fa[fa.media=18]="media";fa[fa.slide=19]="slide";fa[fa.mixed=20]="mixed"})(G||(G={}));Object(I.b)("ClipboardContentType",G);var S;
(function(fa){fa[fa.keyboard=0]="keyboard";fa[fa.menu=1]="menu";fa[fa.floatie=2]="floatie";fa[fa.ribbon=3]="ribbon"})(S||(S={}));Object(I.b)("ClipboardMethod",S);var P;(function(fa){fa[fa.copy=0]="copy";fa[fa.cut=1]="cut";fa[fa.paste=2]="paste"})(P||(P={}));Object(I.b)("ClipboardOperation",P);var Q;(function(fa){fa[fa.other=0]="other";fa[fa.pptOnline=1]="pptOnline";fa[fa.pptOnlineSameSession=2]="pptOnlineSameSession";fa[fa.pptOnlineCrossSession=3]="pptOnlineCrossSession";fa[fa.wordOnline=4]="wordOnline";
fa[fa.xlOnline=5]="xlOnline";fa[fa.oneNoteOnline=6]="oneNoteOnline";fa[fa.pptWin32=7]="pptWin32";fa[fa.wordWin32=8]="wordWin32";fa[fa.xlWin32=9]="xlWin32";fa[fa.oneNoteWin32=10]="oneNoteWin32";fa[fa.googleDocs=11]="googleDocs";fa[fa.pptDesktop=12]="pptDesktop";fa[fa.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(Q||(Q={}));Object(I.b)("ClipboardSource",Q);class D{constructor(){this.data={};this.Lzf=!1;this.Jkb=null}}Object(I.a)(D,"TelemetryEntry",null,[]);var O=d(1041),X=d(434),N=d(43),
aa=d(30),V=d(69);d.d(Y,"a",function(){return ca});class ca{constructor(fa,ma,da,qa,F,sa,ia,Na,Ca,ha,Ba,va){this.$sg=h.a.Sy;this.ZRg=this.Rzg=this.$3c="";this.qR=fa;this.QT=ma;this.Lv=new V.a;this.M$=new V.a;qa.HGc(Object(B.a)(this,this.AIe,"onRevisionProcessedOnServer"));F.ura(Object(B.a)(this,this.Ywl,"trackSlideCcpRevision"));sa.ura(Object(B.a)(this,this.Xwl,"trackShapeCcpRevision"));ia.ura(Object(B.a)(this,this.Uwl,"trackParagraphCcpRevision"));Na.ura(Object(B.a)(this,this.Twl,"trackNotesCcpRevision"));
Ca&&Ca.ura(Object(B.a)(this,this.Vwl,"trackPresentationCcpRevision"));this.LL=Ba;this.ia=ha;this.Erg=da.Wqd;this.Jv=va;if(fa=e.AFrameworkApplication.gd)this.Rzg=Object(v.a)(String,fa.Host)||"",this.ZRg=Object(v.a)(String,fa.Ring)||"",this.$3c=Object(v.a)(String,fa.WACDatacenter)||""}vAb(fa){return this.Lv.Hb(fa)}KB(fa,ma){n.a.Wa(ma)||(this.vAb(ma)?ca.contentType in this.Lv.ga(ma).data&&!this.cLj(ma,fa)||this.$V(ca.contentType,G[fa],ma):u.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+
ma))}k$a(fa,ma){if(!this.Lv.Hb(fa))return null;let da=null;if(this.Lv.ga(fa)&&!(ma in this.Lv.ga(fa).data))switch(ma){case ca.contentType:da="none";break;case ca.source:da="other"}return da?da:this.Lv.ga(fa).data[ma].toString()}k0f(fa){return this.k$a(fa,ca.contentType)}L_f(fa){return this.k$a(fa,ca.source)}c5i(fa){return this.k$a(fa,ca.operation)}H$b(fa){return"xlOnline"===this.L_f(fa)&&"chart"===this.k0f(fa)}e0c(fa){return"slide"===this.k0f(fa)&&"paste"===this.c5i(fa)}tCk(fa){const ma=G;for(let qa in ma){var da=
ma[qa];if(qa.toLowerCase()===fa.toLowerCase())return da}return 0}uCk(fa){const ma=Q;for(let qa in ma){var da=ma[qa];if(qa.toLowerCase()===fa.toLowerCase())return da}return 0}cLj(fa,ma){fa=this.tCk(this.Lv.ga(fa).data[ca.contentType].toString());return ma>fa}Hw(fa,ma){n.a.Wa(ma)||(this.vAb(ma)?ca.source in this.Lv.ga(ma).data&&!this.RUj(ma,fa)||this.$V(ca.source,Q[fa],ma):u.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+ma))}RUj(fa,ma){fa=this.uCk(this.Lv.ga(fa).data[ca.source].toString());
return ma>fa}Zh(fa,ma,da){n.a.Wa(da)||this.$V(fa,ma,da)}hP(fa,ma,da){const qa=N.a.Ib&&!n.a.Wa(N.a.Ib.actionName)?N.a.Ib.actionName:da,F=m.a.create().toString();this.Lv.$(F,Object.assign(new D,{Jkb:this.qR.Ci("UserAction","ClipboardTelemetry")}));this.$V(ca.MDf,F,F);this.$V(ca.actionName,qa,F);this.$V("ActualActionName",da,F);this.$V("CcpOperation",P[fa],F);this.$V("CcpMethod",S[ma],F);this.$V("CcpBrowser",this.$sg,F);this.$V("CcpHost",this.Rzg,F);this.$V("CcpDatacenter",this.$3c,F);this.$V("CcpRing",
this.ZRg,F);u.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.$sg,F,S[ma],P[fa],qa);return F}Hg(fa,ma,da=0){if(n.a.Wa(ma))u.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(n.a.Wa(ma)||!this.vAb(ma))u.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",ma);else{var qa=this.Lv.ga(ma);this.$V("CcpTotalMs",qa.Jkb.Vq.toString(),ma);this.$V(ca.NDf,
fa.toString(),ma);0!==da&&(this.$V("CcpFailureReason",y[da],ma),this.H$b(ma)?16===da?this.LL.fga(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,ca.Osb):(fa=Object.assign(new X.a(!0),{Wb:ma}),this.LL.fga(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,aa.a.PIf,aa.a.eXd,null,fa,!0,ca.Osb)):
25===da&&(u.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ma),this.LL.fga(ResourceStrings.l_DeferredContentPasteDialogTitle,ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,ca.Osb)));u.a.J(50733397,826,50,E.c(qa.data));this.H$b(ma)||this.e0c(ma)||this.Lv.remove(ma)}}bel(fa,ma){n.a.Wa(ma)||(this.Hw(0,ma),this.Mrh(fa,ma,0))}Mrh(fa,ma,da){if(fa){if(da>=O.a.vIc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",
O.a.vIc));if(1===fa.nodeType){for(var qa=fa.firstChild;qa;)this.Mrh(qa,ma,da+1),qa=qa.nextSibling;this.qWe(fa,ma)}}}qWe(fa,ma){const {ClipboardHelper:da}=d(712);if(!n.a.Wa(ma))if(!this.vAb(ma))u.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ma);else if(fa)if("head"===fa.tagName.toLowerCase()){var qa=this.QT.bUf(fa);n.a.Wa(qa)||this.Kdl(qa,ma)}else{qa=0;var F=fa.getAttribute(J.a.sessionId);F?qa=da.Slg(F.toString())?2:3:fa.getAttribute(A.a.hMf)?qa=5:fa.getAttribute(A.a.iMf)||
fa.getAttribute(A.a.mMf)?qa=1:fa.id&&fa.id.startsWith&&fa.id.startsWith(A.a.s9f)&&(qa=11);if(fa.className&&fa.className.split)for(const sa of fa.className.split(" "))if(sa.startsWith(h.a.QZb)&&sa.length===h.a.QZb.length+1&&(fa=parseInt(n.a.substring(sa,sa.length-1,sa.length)),isNaN(fa)||this.$V("CcpSourceBrowser",z.a[fa],ma)),0===qa)if(sa.startsWith(A.a.Aah))qa=1;else if(sa.startsWith(A.a.m7g))qa=6;else if(sa.startsWith(A.a.OJh))qa=4;else if(sa===A.a.b_g||sa===A.a.c_g)qa=8,this.KB(9,ma);0!==qa&&this.Hw(qa,
ma)}}Kdl(fa,ma){switch(fa){case "PowerPoint.Slide":this.Hw(7,ma);break;case "Word.Document":this.Hw(8,ma);break;case "Excel.Sheet":this.Hw(9,ma);break;case "OneNote.File":this.Hw(10,ma)}}$V(fa,ma,da){this.Lv.Hb(da)&&(this.Lv.ga(da).data[fa]=ma)}AIe(fa,ma){ma.taa&&!n.a.Wa(ma.taa.Id)&&this.M$.Hb(ma.taa.Id)&&this.IRf(ma.taa.Id,!ma.taa.Error,ma.taa.Error?ma.taa.Error.Code:0)}Ywl(fa,ma){this.Ftc(da=>{let qa=null;if(da=Object(v.a)(116,da.node))qa=da.Wb,da.Wb=null;return qa},ma)}Xwl(fa,ma){this.Ftc(da=>
{let qa=null;if(da=Object(v.a)(4,da.node))qa=da.Wb,da.Wb=null;return qa},ma)}Uwl(fa,ma){this.Ftc(da=>{let qa=null;if(da=Object(v.a)(5,da.node))qa=da.Wb,da.Wb=null;return qa},ma)}Twl(fa,ma){this.Ftc(da=>{let qa=null;if(da=Object(v.a)(1105,da.node))qa=da.Wb,da.Wb=null;return qa},ma)}Vwl(fa,ma){this.Ftc(da=>{let qa=null;if(da=Object(v.a)(537,da.node))qa=da.Wb,da.Wb=null;return qa},ma)}Ftc(fa,ma){ma.revisionId&&ma.node&&(fa=fa(ma),n.a.Wa(fa)||this.eyh(ma.revisionId.toString(),fa))}eyh(fa,ma){n.a.Wa(fa)||
n.a.Wa(ma)||this.M$.$(fa,ma)}IRf(fa,ma,da){if(!n.a.Wa(fa)&&this.M$.Hb(fa)){this.Erg&&"pptDesktopWithDataUpload"===this.L_f(this.M$.ga(fa))&&this.Jv.f1d();var qa={};qa[ca.MDf]=this.M$.ga(fa);qa[ca.NDf]=ma;qa[ca.$ti]=da;this.H$b(this.M$.ga(fa))?(qa[ca.source]="xlOnline",qa[ca.contentType]="chart",0!==da&&(ma=Object.assign(new X.a(!0),{Wb:this.M$.ga(fa)}),this.LL.fga(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,
!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,aa.a.PIf,aa.a.eXd,null,ma,!0,ca.Osb))):433===da?(this.e0c(this.M$.ga(fa))&&this.ia.processAction(aa.a.xI,2),this.LL.fga(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,ca.Osb)):434===da&&(this.e0c(this.M$.ga(fa))&&(this.Erg?this.ia.processAction(aa.a.WZd,2):this.ia.processAction(aa.a.xI,2)),this.LL.fga(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,ca.Osb));u.a.J(50733400,826,50,E.c(qa));(this.H$b(this.M$.ga(fa))||this.e0c(this.M$.ga(fa)))&&this.Lv.remove(this.M$.ga(fa));this.M$.remove(fa)}}UJj(fa){return!n.a.Wa(fa)&&this.Lv.Hb(fa)?this.Lv.ga(fa).Lzf:!1}Bic(fa){n.a.Wa(fa)||(this.vAb(fa)?this.Lv.ga(fa).Lzf=!0:u.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+fa))}}ca.source="CcpSource";ca.contentType="CcpContentType";ca.operation="CcpOperation";ca.NDf="CcpSuccess";ca.actionName=
"ActionName";ca.Osb=20;ca.MDf="CcpCorrelation";ca.YAi="CcpCopyIframeContent";ca.NFf="ClipServiceThrottled";ca.LDf="data-corr-id";ca.Gp="CcpId";ca.$ti="ClipServiceFailureReason";Object(I.a)(ca,"ClipboardTelemetry",null,[1176])},393:function(I,Y,d){I=d(0);var h=d(47),e=d(201),n=d(1208),m=d(1200),z=d(58);class B{constructor(){this.shapeType=this.NDe=this.vYg=this.S0g=this.R0g=0;this.hr=this.aq=this.Mp=this.Fj=!1;this.UHc=null}}Object(I.a)(B,"ShapeProperties",null,[]);var v=d(28),y=d(43),A=d(102),E=d(214);
d.d(Y,"a",function(){return u});class u{constructor(J,G,S,P,Q,D,O,X,N){this.Ms=J;this.Sk=G;this.Fa=O;this.tad=D.kjl;this.Dek=this.TFi();this.jq=S;this.UL=P;this.Te=Q.Ma;this.vO=D.Dua;this.tak=D.zza;this.Tb=N}D9g(J,G,S,P,Q,D=null){if(G){var O=this.Fa.D9a(S);O&&(Array.remove(S,O),Array.add(S,this.Fa.yr(O)));this.pxh(S);var X=S.length;O=Array(X);P=this.b4f(G,P);for(var N=0;N<X;N++){var aa=S[N],V=this.Ldj(aa,P);O[N]=Object.assign(new B,{R0g:V.x,S0g:V.y,vYg:aa.rx,NDe:aa.HC,shapeType:aa.shapeType,Fj:aa.Fj,
Mp:aa.Mp||2===aa.mediaType||1===aa.mediaType,aq:aa.ud,hr:aa.hr,UHc:""});O[N].Fj&&(V=Object(m.a)(117,aa.sc(this.Te)),O[N].UHc=V?V.NZe:"",v.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",aa.Wbe,this.UL.WW(aa),0<O[N].UHc.length))}N=G.Cb;aa=G.Ut();V=[];P=!0;var ca=J.hj===G.hj,fa=J.Cn===G.Cn,ma=!1;J!==G&&(ca?(ma=J.N$a||G.N$a,fa||(ma=J.F$a||G.F$a||ma),P=!ma):P=!1,P&&this.vO&&(J.oq!==G.oq||J.Vk!==G.Vk)&&(P=!1));for(var da=0;da<X;da++)this.jjl(S[da])||(V.push(S[da]),P&&(P=this.hhl(S[da],
fa)));S=V;v.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:P,["SameSlide"]:J===G,["SameMaster"]:ca,["SameLayout"]:fa,["ThemeOverrides"]:ma});X=[];da=ma=fa=ca=V=!1;for(let qa=0;qa<S.length;qa++){const F=O[qa];let sa=this.Sk.fDi(N.cid,N.sid,F.R0g,F.S0g,F.vYg,1>F.NDe?1:F.NDe,aa+S[qa].get_zIndex(),J.id,S[qa],F.shapeType,F.Fj,F.UHc,P);h.a.Wa(D)||(sa.Wb=D);X.push(sa);V=V||F.Fj;ca=ca||F.Mp;fa=fa||F.aq;ma=ma||F.hr;da=da||this.tak&&u.QRj(sa)}Q=u.Hkh(V,ca,fa,ma,da,Q);if(0<X.length&&(J=P?S:null,this.Ms.BW(X,
G,Q,J),P&&y.a.Ib)){if(J){G="";for(const qa of J)G+=this.Fa.c6b(qa)+",";y.a.Ib.Va(A.a.TAi,G);y.a.Ib.Va(A.a.Nfl,J.length.toString())}y.a.Ib.Nj=!0;y.a.Ib.GMb=!0}}}hIi(J,G,S,P,Q,D){var O=this.b4f(J,S);S=[];const X=G.Cjc,N=!!X&&!e.a.Wa(X.jmg);D=this.Kdj(D,O);for(O=0;O<G.objectCount;O++){const aa=this.Sk.rCi(J.cid,J.sid,D.x,D.y,Q);aa.isEditable=N&&X.jmg[O];S.push(aa)}0<S.length&&this.Ms.BW(S,J,P)}Kdj(J,G){const S=G*u.LS;G*=u.LS;let P=new z.a(S,G);J&&(P=this.Tb.Ata(J.clientWidth,J.clientHeight))&&(P.x+=
S,P.y+=G);return P}jjl(J){return J.DC&&this.tad||!J.qhg}hhl(J,G){return J.Wbe||this.UL.WW(J)||J.fl&&J.hasText&&!G&&10!==J.Hj&&12!==J.Hj||J.Dq?!1:!0}pxh(J){J.sort((G,S)=>G.get_zIndex()-S.get_zIndex())}CSj(J){return J?this.Dek.contains(J):!1}b4f(J,G){if(!J)return 0;if(!G)return u.zmi;let S,P;return G.$(S=J.Cb,(P=G.ga(S))+1),P}Ldj(J,G){var S=this.jq.presentation;if(!S)throw Error.argumentNull("Presentation is null");let P=J.wy,Q=J.yy;J=S.Pjj(S.xC(J.slideId));S=Math.round(u.LS/J)*J;J=n.a.rf(S,0);for(S=
n.a.rf(S,1);0<G;)P+=J,Q+=S,G--;return new z.a(P,Q)}czl(J){try{if(J&&J.clipboardData){const G=J.clipboardData.types;for(let S=0;S<G.length;S++){const P=J.clipboardData.getData(G[S]);if(this.hKj(P))return P}}}catch(G){}return null}hKj(J){return!!J&&0<J.length&&this.HWj(J)}HWj(J){J=J.trim().toLowerCase();return J.startsWith("http:")||J.startsWith("https:")}Kal(J,G,S){J&&(J.setAttribute(u.CBf,G.toString()),J.setAttribute(u.BBf,S.toString()),J.setAttribute(u.DBf,"true"))}TFi(){const J=new E.a;J.add("param");
J.add("map");J.add("area");J.add("script");J.add("noscript");J.add("col");J.add("colgroup");J.add("caption");J.add("head");J.add("title");J.add("link");J.add("meta");J.add("style");J.add("base");J.add("input");J.add("textarea");J.add("select");J.add("option");J.add("optgroup");J.add("button");J.add("hr");return J}paj(J){return this.gEh(J,u.CBf)}gaj(J){return this.gEh(J,u.BBf)}rOj(J){return J?"true"===J.getAttribute(u.DBf):!1}Nyl(J){if(this.Bmg(J)){const G=J.indexOf('"')+1,S=J.lastIndexOf('"');if(1<
G&&S>G&&(J=J.slice(G,S),J.startsWith(u.Gmi)))return J}return null}Bmg(J){return!!J&&J.length>u.eni&&J.startsWith(u.Hmi)}gEh(J,G){let S=0;this.rOj(J)&&(S=parseFloat(J.getAttribute(G)));return isNaN(S)?0:S}ITd(J){return this.JTd(J).returnValue}JTd(J){let G;G=2;let S=0,P=0,Q=0,D=0,O=0,X=0,N=0,aa=0,V=0,ca=0,fa=0,ma=0,da=0,qa=0,F=0,sa=0,ia=0;for(const Na of J)Na.ud?(G=2===G?6:20,S++):Na.Rf?(G=2===G?12:20,P++):Na.hr?(G=2===G?7:20,Q++):Na.Jf?(G=2===G?13:20,D++):22===Na.g7b?(G=2===G?10:20,O++):Na.Fj?(G=2===
G?5:20,X++):Na.px?(G=2===G?3:20,N++):Na.h4?(G=2===G?14:20,Na.DC&&V++,aa++):Na.fl?(G=2===G?14:20,Na.DC&&fa++,ca++):Na.az?(G=2===G?15:20,ma++):Na.tT?(G=2===G?16:20,da++):Na.Mp?(G=2===G?18:20,qa++):Na.Dq?(G=2===G?11:20,F++):Na.Sda?(G=2===G?17:20,sa++):(G=2===G?4:20,ia++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
J.length,S,P,Q,D,O,X,N,aa,V,ca,fa,ma,da,qa,F,sa,ia),contentType:G}}static g7k(J){for(const G of J)if(!G.qhg||G.isLocal)return!1;return!0}static QRj(J){return J&&4===J.RK?(!J.fill||!!J.fill.noFillField)&&(!J.lineStyle||!!J.lineStyle.noFillField):!1}static Hkh(J,G,S,P,Q,D){return J||G||S||P||Q?D:0}}u.DBf="data-from-ppt-online";u.CBf="data-image-width-mu";u.BBf="data-image-height-mu";u.Gmi="data:image/";u.Hmi="<img src=";u.eni=14;u.zmi=1;u.LS=15;Object(I.a)(u,"CopyPasteUtility",null,[766])},438:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.open="open";h.refresh="refresh";h.CTe="saveAs";h.translate="translate";h.modeSwitch="modeSwitch";h.SEi="createNew";h.convert="convert";Object(I.a)(h,"ReasonList",null,[])},439:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(I.a)(h,"Lambda",null,[845])},440:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.Grc="SlideTextTile";h.cXe=
"ShapeTextTile";Object(I.a)(h,"AugmentationSchemas",null,[])},441:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d(27);class h{static wb(){}static d1(e,n,m,z,B){return 1===m?32:h.ELk(e,B)?32:8}static dH(e,n,m,z,B){return 1===m?32:h.Zok(e,B)?32:8}static Zok(e,n){const m=h.kPh[e.toString()];if(void 0===m||null===m)return!1;m(e,n);return!0}static ELk(e,n){const m=h.nPh[e.toString()];if(void 0===m||null===m)return!1;m(e,n);return!0}}h.kPh={};h.nPh={};Object(I.a)(h,"DialogCuiControlActor",null,
[])},442:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.description=this.title=this.bQ=this.a1=null}}Object(I.a)(h,"CpContentDetails",null,[547])},443:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(106);class e{constructor(){this.Rvf=!1;this.sessionId=this.QFf=null;this.g7a=e.S1i()}static S1i(){return"CID"+h.a.create().toString()}static $fg(n){return n&&n.length?n.startsWith("CID")&&h.a.isValid(n.substring(3,n.length))?!0:!1:!1}}Object(I.a)(e,"InternalClipboardObject",
null,[])},444:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(443);class h extends d.a{constructor(e){super();this.Fd=e}get qkg(){return!this.Fd||!this.Fd.isConnected}get id(){return this.Fd.id}get isConnected(){return this.Fd.isConnected}}Object(I.a)(h,"InternalClipboardSlide",d.a,[])},445:function(I,Y,d){d.d(Y,"a",function(){return e});var h=d(108);const e=(n,m,z)=>{const B=new h.StandardDialog;B.xd=0;B.fP(n,m,z);return B}},446:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}
Object(I.a)(h,"SmartLookupSelection",null,[])},457:function(I,Y,d){I=d(0);var h=d(387),e=d(14),n=d(27),m=d(179),z=d(75),B=d(67),v=d(173),y=d(104),A=d(172);d(71);class E{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(I.a)(E,"MessageBarProps",null,[]);class u{constructor(X,N){this.onExecute=
this.label=this.type=null;this.label=X;this.type="AppButtonProps";this.onExecute=N}}Object(I.a)(u,"AppButtonProps",null,[]);var J=d(141),G=d(784),S=d(134),P=d(211),Q=d(106),D=d(37);d.d(Y,"a",function(){return O});class O{constructor(X,N,aa){this._message=this.YB=null;this.NDd=this.gnb=!1;this.Exd=0;this.xha="";this.mS=0;this.cF=this.ZR=this.Mpa=this.h7=this.T3a=this.CQb=this.BQb=this.AQb=this.zQb=this.jN=this.Q6=this.Yqa=this.NNa=null;this.Zmb=this.Ymb=!1;this.y8e=this.Wxd="";this.Uxd=!1;this.z8e=
this.$xd="";this.Yxd=!1;this.Zxd=this.Vxd=null;this.tUb=!1;this.Chf=this.Sob="";this.S3a=null;this.BTb=this.nef=!1;this.BCa=this.Z2=this.Cda=this.zP=this.businessBar=null;this.errorCode=0;this.Wvf=this.visible=!1;this.title=X;this.message=N;this.d9b=aa;this.id=0;this.image=1;this.WZc=!0;this.dzf=5}get htmlElement(){return this.zP}get WZc(){return this.NDd}set WZc(X){this.NDd=X}get dzf(){return this.Exd}set dzf(X){this.Exd=X}get title(){return this.YB}set title(X){this.YB!==X&&(this.YB=X,this.Yqa&&
(this.Yqa.innerText=this.YB))}get message(){return this._message}set message(X){this._message!==X&&(this._message=X,this.Q6&&(this.Q6.innerText=this._message))}get image(){return this.mS}set image(X){this.mS=X;4!==this.mS&&(this.Cda="")}get MEa(){return this.xha}set MEa(X){this.xha=X}get closeable(){return this.gnb}set closeable(X){this.gnb!==X&&(this.gnb=X,this.Mpa&&(this.Mpa.style.display=this.gnb?"table-cell":"none"))}get Lnc(){return n.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get QHl(){return n.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(X,
N,aa,V=!1){this.Wxd=X;this.Vxd=N;this.Ymb=!0;this.y8e=aa;this.Uxd=V}NOd(X,N){this.$xd=X;this.Zxd=N;this.Zmb=!0;this.z8e="";this.Yxd=!1}Tsf(X,N){this.Sob=X;this.S3a=N;this.tUb=!0}VFi(){var X=P.a.B3(n.AFrameworkApplication.fa.Ga("VNextStyleOptOutCookieName"),!1);X=this.QHl&&!X;this.zP=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",O.x8e,O.eZh,X?O.c3h:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.BCa&&null!==this.BCa&&(this.htmlElement.id=
this.BCa);X=()=>{J.UISurfaces.Icj().then(N=>{this.businessBar.hle||(N.initializeMessageBarInStore(),this.businessBar.hle=!0);const aa=Object.assign(new E,{message:this._message,messageTitle:this.YB,isMultiline:this.NDd,messageBarType:this.Exd});if(this.gnb){aa.closeable=!0;var V=this._message+". "+CommonUIStrings.l_DialogClose;this.YB&&(V=this.YB+". "+V);aa.dismissButtonAriaLabel=V;aa.onDismiss=()=>{this.EVd(this)}}4===this.mS&&(aa.messageBarIconProps={["iconName"]:this.Cda});this.tUb&&(aa.linkProps=
{["type"]:"AppLinkProps",["text"]:this.Sob,["handler"]:{["href"]:this.Chf,["target"]:"_blank"}},this.S3a&&(V=Object(e.a)(this,this.Xuk,"onMessageBarLinkClicked"),aa.linkProps.handler=V));this.Ymb&&(aa.firstActionButtonProps=new u(this.Wxd,()=>{this.Mli(this)}));this.Zmb&&(aa.secondActionButtonProps=new u(this.$xd,()=>{this.Oli(this)}));N.createNewMessageBarWithCallback?N.createNewMessageBarWithCallback(this.htmlElement,aa,()=>{n.AFrameworkApplication.Aa.Oq()}):N.createNewMessageBar(this.htmlElement,
aa);return null}).catch(()=>{h.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};m.a.get_instance().isCompleted(7)?X():m.a.get_instance().ek(7,X);this.d9b&&(n.AFrameworkApplication.Aa.Iy.pb(B.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),n.AFrameworkApplication.Aa.qG.KU(B.a.Il,this.htmlElement,Object(e.a)(this,this.GGe,"onBodyKeyUp"),this),this.nef&&!this.BTb&&(n.AFrameworkApplication.Aa.Qaa.pb(this.htmlElement,Object(e.a)(this,this.onClick,
"onClick"),null),this.BTb=!0));return this.htmlElement}createElement(){n.AFrameworkApplication.JL("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.Lnc)return this.VFi();this.zP=document.createElement("div");this.htmlElement.className=O.x8e;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.BCa&&null!==this.BCa&&(this.htmlElement.id=this.BCa);this.NNa=null;if(0!==this.mS){this.NNa=document.createElement("span");this.NNa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.NNa);
var X=null;let N=null;switch(this.mS){case 2:X=O.UQh;N=CommonUIStrings.l_DialogError;break;case 1:X=O.o3h;N=CommonUIStrings.l_DialogWarning;break;case 3:X=O.bTh;N=CommonUIStrings.l_DialogInfo;break;case 4:X=this.Cda,N=this.xha}this.NNa.title=N;this.NNa.setAttribute(S.a.ef,S.a.ayf);this.NNa.appendChild(z.createClusteredImage(24,24,X,O.SSh,!0,""))}X=Q.a.create().toString();this.jN=document.createElement("div");this.jN.id="BBTitleAndBody"+X;this.jN.className=O.bOh;this.jN.tabIndex=0;this.YB&&(this.Yqa=
document.createElement("p"),this.Yqa.innerText=this.YB,this.Yqa.className=O.cOh+" UIFontBold",this.Yqa.id="BBTitle"+X,this.Yqa.setAttribute("UNSELECTABLE","on"),this.jN.setAttribute(S.a.P2,this.Yqa.id),this.jN.appendChild(this.Yqa));this.Q6=document.createElement("p");this.Q6.className=O.XNh;this.Q6.innerText=this._message;this.Q6.id="BBBody"+X;this.Q6.setAttribute("UNSELECTABLE","on");this.Q6.style.width="100%";this.jN.setAttribute(S.a.Fra,this.Q6.id);this.Ymb&&this.gsf(this.Q6,this.y8e);this.Zmb&&
this.gsf(this.Q6,this.z8e);this.jN.appendChild(this.Q6);X=document.createElement("div");X.setAttribute(S.a.ef,S.a.vRd);X.appendChild(this.jN);this.htmlElement.appendChild(X);this.Ymb&&(this.AQb=document.createElement("span"),this.zQb=document.createElement("button"),this.vJf(this.AQb,this.zQb,this.Wxd,Object(e.a)(this,this.aBf,"buttonOneClickHandler")));this.Zmb&&(this.CQb=document.createElement("span"),this.BQb=document.createElement("button"),this.vJf(this.CQb,this.BQb,this.$xd,Object(e.a)(this,
this.bBf,"buttonTwoClickHandler")));this.tUb&&(this.T3a=document.createElement("span"),this.T3a.className=O.aOh,this.h7=document.createElement("a"),this.h7.className=G.a.$Nh,this.h7.innerText=this.Sob,this.S3a?(this.h7.tabIndex=0,n.AFrameworkApplication.Aa.Iy.KU(B.a.click,this.h7,Object(e.a)(this,this.ppg,"linkClickHandler"),this),n.AFrameworkApplication.Aa.qG.KU(B.a.Il,this.h7,Object(e.a)(this,this.e4g,"onLinkKeyUp"),this)):(this.h7.href=this.Chf,this.h7.target="_blank"),this.T3a.appendChild(this.h7),
this.htmlElement.appendChild(this.T3a));n.AFrameworkApplication.Aa.Iy.pb(B.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));n.AFrameworkApplication.Aa.qG.KU(B.a.Il,this.jN,Object(e.a)(this,this.GGe,"onBodyKeyUp"),this);this.nef&&!this.BTb&&(n.AFrameworkApplication.Aa.Qaa.pb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.BTb=!0);this.gnb&&(this.Mpa=document.createElement("span"),this.Mpa.className=O.FOh,this.ZR=document.createElement("a"),this.ZR.className=O.GOh,
this.ZR.tabIndex=0,this.ZR.title=CommonUIStrings.l_DialogClose,this.ZR.setAttribute(S.a.ef,S.a.yu),this.cF=z.createClusteredImage(16,16,O.HOh,"",!0,""),this.ZR.appendChild(this.cF),this.Mpa.style.display="table-cell",this.Mpa.appendChild(this.ZR),this.htmlElement.appendChild(this.Mpa),n.AFrameworkApplication.Aa.Iy.KU(B.a.click,this.ZR,Object(e.a)(this,this.i2g,"onCloseClick"),this),n.AFrameworkApplication.Aa.qG.KU(B.a.Il,this.ZR,Object(e.a)(this,this.j2g,"onCloseKeyUp"),this));return this.htmlElement}Hkl(){this.jN&&
this.jN.setAttribute(S.a.QK,S.a.Iia)}gsf(X,N){if(N&&""!==N){var aa=document.createElement("span");aa.className=O.g_h;aa.innerText=N;X.appendChild(aa)}}vJf(X,N,aa,V){X.className=O.ZNh;N.setAttribute("type","button");N.className=O.YNh;N.innerText=aa;X.appendChild(N);this.htmlElement.appendChild(X);n.AFrameworkApplication.Aa.Iy.KU(B.a.click,N,V,this)}blh(){this.Lnc||(this.jN.style.whiteSpace="nowrap",this.closeable?this.Mpa.style.width="auto":this.tUb?this.T3a.style.width="auto":this.Zmb?this.CQb.style.width=
"auto":this.Ymb?this.AQb.style.width="auto":this.jN.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.jN.style.whiteSpace="normal":this.closeable?this.Mpa.style.width="100%":this.tUb?this.T3a.style.width="100%":this.Zmb?this.CQb.style.width="100%":this.Ymb?this.AQb.style.width="100%":this.jN.style.width="100%")}Q3e(X,N){if(A.a.RGb()){var aa={};aa.WacSessionId=n.AFrameworkApplication.userSessionId;aa.ActionName="BusinessBar"+X;aa.InputMethod=N;h.ULS.sendTraceTag(35489761,
207,50,JSON.stringify(aa))}}lX(X,N,aa,V){this.Q3e(X,aa);A.a.mVa()&&y.c(N,!0,y.e,V,10)}aBf(X){this.Vxd(X.rD);this.lX("ButtonOne",D.a.VAf,"Mouse",2);this.Uxd&&(this.lX("Close",D.a.xsb,"Mouse_ButtonOne",2),this.close(X));return!0}Mli(X){this.Vxd(X);this.lX("ButtonOne",D.a.VAf,"Mouse",2);this.Uxd&&(this.lX("Close",D.a.xsb,"Mouse_ButtonOne",2),this.EVd(X))}bBf(X){this.Zxd(X.rD);this.lX("ButtonTwo",D.a.WAf,"Mouse",2);this.Yxd&&(this.lX("Close",D.a.xsb,"Mouse_ButtonTwo",2),this.close(X));return!0}Oli(X){this.Zxd(X);
this.lX("ButtonTwo",D.a.WAf,"Mouse",2);this.Yxd&&(this.lX("Close",D.a.xsb,"Mouse_ButtonTwo",2),this.EVd(X))}ppg(X){this.S3a(X.rD);this.lX("Link",D.a.ZAf,"Mouse",2);return!0}Xuk(){this.S3a(null)}e4g(X){return X.qc.keyCode!==v.a.tq||X.qc.altKey?!1:(this.S3a(X.rD),this.lX("Link",D.a.ZAf,"Keyboard",1),!0)}GGe(X){return X.qc.keyCode===v.a.tq&&!X.qc.altKey&&this.d9b?(this.d9b(X.rD,X),this.lX("Invoke",D.a.YAf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(n.AFrameworkApplication.Aa.Iy.yb(B.a.click,this.htmlElement,
Object(e.a)(this,this.onClick,"onClick")),this.BTb&&n.AFrameworkApplication.Aa.Qaa.yb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick")));this.ZR&&(n.AFrameworkApplication.Aa.Iy.yb(B.a.click,this.ZR,Object(e.a)(this,this.i2g,"onCloseClick")),n.AFrameworkApplication.Aa.qG.yb(B.a.Il,this.ZR,Object(e.a)(this,this.j2g,"onCloseKeyUp")));this.zQb&&n.AFrameworkApplication.Aa.Iy.yb(B.a.click,this.zQb,Object(e.a)(this,this.aBf,"buttonOneClickHandler"));this.BQb&&n.AFrameworkApplication.Aa.Iy.yb(B.a.click,
this.BQb,Object(e.a)(this,this.bBf,"buttonTwoClickHandler"));this.h7&&this.S3a&&(n.AFrameworkApplication.Aa.Iy.yb(B.a.click,this.h7,Object(e.a)(this,this.ppg,"linkClickHandler")),n.AFrameworkApplication.Aa.qG.yb(B.a.Il,this.h7,Object(e.a)(this,this.e4g,"onLinkKeyUp")));this.jN&&n.AFrameworkApplication.Aa.qG.yb(B.a.Il,this.jN,Object(e.a)(this,this.GGe,"onBodyKeyUp"));this.businessBar=this.ZR=this.Mpa=this.cF=this.T3a=this.h7=this.CQb=this.BQb=this.AQb=this.zQb=this.jN=this.Q6=this.zP=this.Yqa=this.NNa=
this.xha=null}onClick(X){this.lX("Invoke",D.a.YAf,"Mouse",2);return!!this.d9b&&this.d9b(this,X)}i2g(X){this.lX("Close",D.a.xsb,"Mouse",2);this.close(X);return!0}j2g(X){return X.qc.keyCode!==v.a.tq||X.qc.altKey?!1:(this.lX("Close",D.a.xsb,"Keyboard",1),this.close(X),!0)}close(X){const N=X.rD;this.businessBar.removeEntry(N);this.Ofg(N,X.Xf)}Ofg(X,N){if(X.Z2){const aa=n.AFrameworkApplication.Ta;aa.xq=10;aa.sT=N;X.Z2(X);aa.xq=0;aa.sT=0}}EVd(X){X&&this.businessBar&&(this.businessBar.removeEntry(X),this.Ofg(X,
0))}}O.x8e="WACBusinessBarEntry";O.cOh="WACBusinessBarTitle";O.XNh="WACBusinessBarBody";O.bOh="WACBusinessBarTitleBodyHolder";O.ZNh="WACBusinessBarButtonHolder";O.YNh="WACBusinessBarButton";O.aOh="WACBusinessBarLinkHolder";O.GOh="WACBusinessBarClose";O.FOh="WACBusinessBarCloseHolder";O.HOh="BusinessBarClose_16x16x32";O.SSh="WACBusinessBarImage";O.g_h="WACScreenReaderOnly";O.UQh="CancelRequest_24x24x32";O.o3h="Risks_24x24x32";O.bTh="Info_24x24x32";O.eZh="ReactBusinessBarEntry";O.c3h="VNextBusinessBarEntry";
Object(I.a)(O,"BusinessBarEntry",null,[455,106])},516:function(I,Y,d){d.d(Y,"a",function(){return m});I=d(0);var h=d(65),e=d(517),n=d(908);class m{q0b(z,B){if(1===z.nodeType&&B){var v=this.IW(B);z=this.eWf(z,v);this.uvi(v,z,B)}}eWf(z,B){const {CombineHelper:v}=d(1151),y=[];let A=null;for(let u=0;u<z.childNodes.length;u++){var E=z.childNodes[u];3===E.nodeType?(A||(A=new v(z,u,B)),A.R7h(u)):(A&&(A.end(y,u-1),A=null),E=this.eWf(E,B),Array.addRange(y,E))}A&&A.end(y,z.childNodes.length-1);return y}uvi(z,
B,v){z=z.clone();let y=!1;for(let A=B.length-1;0<=A;A--){const E=B[A].tvi();y=z.merge(E)||y}y&&this.setSelection(z,v)}setSelection(z,B){B=h.a.ZDa(B);B.setStart(z.start.element,z.start.offset);B.setEnd(z.end.element,z.end.offset)}IW(z){return(z=h.a.ZDa(z))?Object.assign(new n.a,{start:Object.assign(new e.a,{element:z.startContainer,offset:z.startOffset}),end:Object.assign(new e.a,{element:z.endContainer,offset:z.endOffset})}):new n.a}}m.unused=-1;Object(I.a)(m,"TextNodeCombiner",null,[1342])},517:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(I.a)(h,"SelectionSide",null,[])},518:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);Y=d(320);var h=d(143);class e extends Y.a{constructor(){super();this.items=this.parentRevId=
this.parentPath=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}}Object(I.a)(e,"Operation",Y.a,[])},519:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(I.b)("AppMode",h)},520:function(I,Y,d){d.d(Y,"a",function(){return e});
d.d(Y,"b",function(){return n});d.d(Y,"c",function(){return m});const h=z=>{switch(z){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=z=>h(m(z.Priority,z.Tag)),n=z=>m(z.Priority,z.Tag),m=(z,B)=>{switch(z){case 0:return 1;case 1:return 2;case 2:return B&1?5:3;case 3:return 4;default:return 0}}},521:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(I.a)(h,
"ProofingTraceMetrics",null,[])},522:function(I,Y,d){d.d(Y,"a",function(){return n});d.d(Y,"b",function(){return m});d.d(Y,"c",function(){return z});var h=d(27),e=d(523);const n=()=>{const B=h.AFrameworkApplication.Aa.hb.Uk;return(3===B||1===B||2===B||4===B)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},m=(B,v,y,A=!1)=>{v=1===v;1===B&&(v=2===h.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[B],v?"Editor":"Viewer",A?"Dime":"Unknown",y?y:"dimedefault")},
z=B=>{switch(B){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},523:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(I.b)("OfficeAppType",h)},524:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);
class h{}h.Iyf="AugEditorServiceTileCheckRequest";h.Jyf="AugEditorServiceTileCheckResponse";h.$Pi="EditorServiceTileCheckRequest";h.gGf="Proofing.ProofingRequest";h.GVd="Proofing.ProofingResponse";Object(I.a)(h,"ProofingAugmentationSchemaNames",null,[])},525:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.slideId=null;this.rbh=this.Frc=0}}Object(I.a)(h,"SlidePresenceInfo",null,[])},526:function(I,Y,d){d.d(Y,"a",function(){return m});I=d(0);var h=d(387),e=d(1062),
n=d(36);class m{execute(z,B,v=null){h.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",z.Zk());const y=new e.a,A=this.v8(z,B,v);A.continueWith(()=>{if(A.tm)y.rG(A.Yi);else if(A.Tn)y.L1();else{const E=A.result;if(E&&!E.succeeded&&E.Wi&&E.Wi.data&&5===A.result.Wi.data.status){const u=this.v8(z,B,v);u.continueWith(()=>{u.tm?y.rG(u.Yi):u.Tn?y.L1():y.PM(u.result)})}else y.PM(E)}});return y.task}v8(z,B,v){v=this.Gij(v);return B(v,{"Content-Type":"application/json; charset=utf-8"},z.serialize())}Gij(z){return z?
String.format("{0}/{1}",z,"people.ashx"):"people.ashx"}static U7a(z){if(!z)return h.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return n.a(z)}catch(B){h.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",B.message)}return null}}Object(I.a)(m,"CommonHandlerRequestManager",null,[])},527:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(387);class e{equals(n,m){if(!n||!m)return!n&&!m;if(n.UserId!==m.UserId){if(!e.KPf(n.Provider)||
!e.KPf(m.Provider))return!1;const B=n.UserId.startsWith(e.pYb);var z=m.UserId.startsWith(e.pYb);if(B&&z){if(n.Provider!==m.Provider)return h.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",n.Provider,m.Provider),!1;z=e.ZTf(n.UserId);m=e.ZTf(m.UserId);return!!z&&z===m}n=n.Email&&""!==n.Email?n.Email:B?e.E8a(n.UserId):n.UserId;m=m.Email&&""!==m.Email?m.Email:z?e.E8a(m.UserId):m.UserId;return!!n&&n===m}return n.Provider!==m.Provider?!1:n.Provider&&
""!==n.Provider||n.UserId&&""!==n.UserId?!0:n.DisplayName===m.DisplayName}KW(){return 0}static KPf(n){return"O365"===n||"AD"===n}static E8a(n){if(!n.startsWith(e.pYb))return null;n=n.substr(e.pYb.length);const m=n.lastIndexOf("::");return-1===m?null:n.substr(0,m)}static ZTf(n){if(!n.startsWith(e.pYb))return null;var m=n.lastIndexOf("::");if(-1===m)return null;m+=2;return m>=n.length?null:n.substr(m)}}e.pYb="S::";Object(I.a)(e,"CommentTaskPersonIdentityComparer",null,[342])},528:function(I,Y,d){d.d(Y,
"a",function(){return h});I=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(I.a)(h,"CrossDocumentMessage",null,[])},529:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(I.a)(h,"OtelTelemetryEvent",null,[])},530:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(I.a)(h,"CustomContentProps",null,[])},
531:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=e;this.commandId=n}}Object(I.a)(h,"CommandMetadata",null,[])},532:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(304);class h{}h.CommandValueId="CommandValueId";h.Description="Description";h.Image16by16Class=
d.a.myb;h.Image30by30Class=d.a.fBj;h.Image32by32Class=d.a.LEa;h.Image48by48Class=d.a.gde;h.On="On";h.LabelText=d.a.labelText;h.Visible=d.a.visible;h.SourceControlId="SourceControlId";h.DisplayMode="DisplayMode";h.Alt=d.a.alt;Object(I.a)(h,"ToggleButtonCommandProperties",null,[])},533:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.Hu="InputMethod";h.Haa="ShouldCanvasTakeFocus";h.Ztd="UILocation";Object(I.a)(h,"ReactRibbonConstants",null,[])},534:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1123),{IECustomEventFactory:n}=d(1124);h.Ka||(h.Ka="function"===typeof window.CustomEvent?new e:new n);return h.Ka}}h.Ka=null;Object(I.a)(h,"CustomEventFactory",null,[])},535:function(I,Y,d){d.d(Y,"a",function(){return e});d.d(Y,"b",function(){return m});var h=d(8);d(1062);const e=B=>n(B),n=B=>new Promise((v,y)=>{B.continueWith(A=>{A.tm?y(A.Yi.message):A.Tn?y(h.a.pLc()):v(null)})}),m=B=>z(B),z=B=>new Promise((v,y)=>{B.continueWith(()=>
{B.tm?y(B.Yi.message):B.Tn?y(h.a.pLc()):v(B.result)})})},536:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.alb=this.Bda=this.XY=null;this.s_c=this.brc=!1;this.ZJe=0;this.Wb=null;this.reset()}reset(){this.Bda=[];this.XY=null;this.alb=[];this.s_c=this.brc=!1;this.ZJe=0;this.Wb=null}}Object(I.a)(h,"HtmlPasteContext",null,[])},537:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.themeColors="Theme Colors";Object(I.a)(h,"ReactColorConstants",null,[])},
538:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.other=0]="other";e[e.searchBoxSearch=1]="searchBoxSearch";e[e.searchBoxDictionary=2]="searchBoxDictionary";e[e.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";e[e.smartLookupRibbon=4]="smartLookupRibbon";e[e.smartLookupContextMenu=5]="smartLookupContextMenu";e[e.entity=6]="entity";e[e.dictionary=7]="dictionary";e[e.web=8]="web";e[e.pictures=9]="pictures";e[e.files=10]="files";e[e.bookmarks=11]="bookmarks";e[e.help=12]=
"help";e[e.chartRecommendation=13]="chartRecommendation";e[e.linkSkill=14]="linkSkill";e[e.searchBoxFindInDocument=15]="searchBoxFindInDocument";e[e.searchBoxEntity=16]="searchBoxEntity";e[e.searchSkill=17]="searchSkill";e[e.controlF=18]="controlF";e[e.ribbonFindButton=19]="ribbonFindButton";e[e.reuseSlides=20]="reuseSlides";e[e.data=21]="data";e[e.contextMenuDictionary=22]="contextMenuDictionary";e[e.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";e[e.contextMenuSynonyms=24]="contextMenuSynonyms";
e[e.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";e[e.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";e[e.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";e[e.note=28]="note";e[e.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";e[e.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";e[e.dataDisambiguate=31]="dataDisambiguate";e[e.linkFiles=32]="linkFiles";e[e.searchBoxNoteL2=33]="searchBoxNoteL2";e[e.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";
e[e.actionAI=35]="actionAI";e[e.pasteAsNewSlide=36]="pasteAsNewSlide";e[e.slidesCompression=37]="slidesCompression";e[e.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";e[e.powerPointCopilot=39]="powerPointCopilot";e[e.tellMeService=40]="tellMeService";e[e.prefetch=99]="prefetch"})(h||(h={}));Object(I.b)("EntryPoint",h)},545:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(1221),n=d(676),m;(function(ta){ta[ta.external=0]="external";ta[ta.msa=1]="msa";ta[ta.aad=2]="aad"})(m||(m={}));Object(I.b)("AuthorityType",
m);var z=d(382);class B{constructor(ta){this.zWh=ta}initialize(){return Promise.resolve(0)}O1c(){return Promise.resolve(0)}nV(){h.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new z.a,{IsSuccess:!0,Token:this.zWh}))}Itd(){return Promise.resolve(Object.assign(new z.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Mrd(){return!1}z6b(){return"MockAuthTokenStrategy"}}
Object(I.a)(B,"MockAuthTokenStrategy",null,[425]);var v=d(722);class y{static get(ta,Fa,pa){if(!pa)return ta;let ka=0;return Promise.race([ta,new Promise(Ha=>{ka=window.setTimeout(()=>{Ha(Fa)},pa)})]).then(Ha=>{window.clearTimeout(ka);return Promise.resolve(Ha)}).catch(()=>{window.clearTimeout(ka);return Promise.resolve(Fa)})}}Object(I.a)(y,"PromiseWithTimeout",null,[]);var A=d(27),E=d(226);class u{constructor(ta,Fa,pa,ka,Ha){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=ta;this.scope=Fa;this.silentLogin=pa;this.options=ka;this.correlationId=Ha}}Object(I.a)(u,"TokenRequestParameters",null,[450]);var J=d(55),G=d(57);class S{constructor(){this.Zqf=null;let ta=A.AFrameworkApplication.fa.Ga(A.AFrameworkApplication.eK),Fa=A.AFrameworkApplication.fa.Ga(A.AFrameworkApplication.WEh);this.oqb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ta&&""!==ta?ta:"Unspecified",Fa&&""!==Fa?Fa:"Unspecified")}initialize(){return new Promise(ta=>
{G.a.instance.Ja("Common.App.WopiIdentity.IWopiIdentity").execute(Fa=>{this.Zqf=Fa;ta(0)})})}Fc(ta){const Fa=["HTTPS:","API:"];let pa=!1;const ka=ta.toLocaleUpperCase();for(const Ha of Fa)if(ka.startsWith(Ha)){pa=!0;break}return pa||this.VNj(ta)?ta+"/.default":ta}VNj(ta){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ta)}O1c(){return Promise.resolve(0)}nV(ta,Fa,pa,ka,Ha,Ya,Ka){if(J.a.NFa){Ha=E.OAuthManagerSettings.nJl;if(!Ha)return Fa=Object.assign(new z.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Fa);if(!Array.contains(Ha,ta))return Fa=Object.assign(new z.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ta}),Promise.resolve(Fa)}ta=this.Fc(pa);pa=new u(pa,ta,!ka,null,A.AFrameworkApplication.userSessionId);return this.Zqf.getAccessToken(pa,Fa,Ka).then(Pa=>Object.assign(new z.a,{IsSuccess:!0,Token:Pa.accessToken}),Pa=>Object.assign(new z.a,{IsSuccess:!1,ErrorCode:Pa}))}Itd(){return Promise.resolve(Object.assign(new z.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Mrd(){return!1}z6b(){return this.oqb}}Object(I.a)(S,"ParentFrameTokenStrategy",null,[425]);var P=d(14),Q=d(457),D=d(18);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Cch=this.gzf=null}}Object(I.a)(O,"PromiseWrapper",null,[]);class X{constructor(ta=0){this.cN=0;this.CVb=!1;this.vu=new D.a;this._timeout=ta}enqueue(ta){return new Promise((Fa,
pa)=>{this.vu.add(Object.assign(new O,{Cch:ta,resolve:Fa,reject:pa}));this.process()})}process(){if(this.CVb||this.cN===this.vu.count)return!1;const ta=this.vu.ga(this.cN++);try{this.CVb=!0,ta.Cch().then(Fa=>{this.CVb=!1;this.jWd(ta,Fa,null,!0)}).catch(Fa=>{this.CVb=!1;this.jWd(ta,null,Fa,!1)})}catch(Fa){this.CVb=!1,this.jWd(ta,null,Fa,!1)}return!0}jWd(ta,Fa,pa,ka){if(ka){const Ha=()=>{ta.resolve(Fa);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}else{const Ha=()=>
{ta.reject(pa);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}}}Object(I.a)(X,"PromiseQueue",null,[]);class N{constructor(){this.correlationId=this.resolve=null}}Object(I.a)(N,"ResolveWithCorrelation",null,[]);var aa=d(1200),V=d(82),ca=d(528),fa=d(126);class ma extends V.a{constructor(ta,Fa,pa,ka,Ha,Ya){super(!1,!1,!0);this.N$e=this.gha=null;this.Xba=ta;this.CYh=pa;this.dF=ka;this.n2h=Ha;this.D3a=Ya;this.IA=document.createElement("iframe");this.IA.id="SharedAuthInteractiveFrame";
this.IA.setAttribute("name","SharedAuthInteractiveFrame");this.IA.setAttribute("title","SharedAuthInteractiveFrame");this.IA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.IA.style.border="0";this.IA.style.height="48px";this.IA.style.width="190px";$addHandler(this.IA,"error",Object(P.a)(this,this.Txk,"onSharedAuthFrameError"));ta=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Xba,Fa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",A.AFrameworkApplication.userType);this.IA.src=ta;this.aQh=new Promise(Ka=>{this.N$e=Ka});this.O$e=!1}g6(){this.gha={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.CYh,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:A.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(P.a)(this,this.BDi,"createFrame"),["resolveDialogStyles"]:this.N$e}};this.xd=5;this.Zi(CommonUIStrings.l_SignIn,Object(P.a)(this,this.ngl,"sharedAuthConsentDialogHandler"),
this.gha)}tHh(ta=!1,Fa=5){this.gha&&this.gha.bodyControls&&(!0!==Object(aa.a)(Object,this.gha.bodyControls).frameLoaded&&(Object(aa.a)(Object,this.gha.bodyControls).frameLoaded=!0),ta!==Object(aa.a)(Object,this.gha.bodyControls).frameLoadSuccess&&(Object(aa.a)(Object,this.gha.bodyControls).frameLoadSuccess=ta),Fa!==this.gha.dialogButtonsOption&&(this.gha.dialogButtonsOption=null,this.xd=Fa),this.update(this.gha))}pml(ta,Fa){const pa=new ca.a(fa.a.rgl);pa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:A.AFrameworkApplication.isRtl,["messageCorrelationId"]:ta,["dialogStyles"]:Fa};this.dF.vjb(pa,this.IA.contentWindow,this.Xba)}LXf(){this.tHh(!1,6)}get Osh(){return this.IA}get fMi(){return this.aQh.then(ta=>{this.O$e=!0;return ta})}get gMi(){return this.O$e}Txk(){this.LXf()}BDi(){return this.IA}ngl(ta){0===ta&&(this.n2h.reject(Object.assign(new z.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.D3a(null))}}
Object(I.a)(ma,"SharedAuthConsentDialog",V.a,[454]);var da=d(667),qa=d(96),F=d(221),sa=d(65),ia=d(106),Na=d(89);class Ca{constructor(){this.IA=null;this.gzc=0;this.Yob=this.Hqb=this.wxd=this.D3a=this.CZ=this.$pf=null;this.dF=new da.a(null,null);this.oqb="SharedAuthTokenStrategy Unloaded";this.Xba=E.OAuthManagerSettings.pgl;this.jof=E.OAuthManagerSettings.ogl;this.Raf=E.OAuthManagerSettings.enableConsoleLogging;this.LQh=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.D0h=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.LOa={};this.lTh=new X(1500)}z6b(){return this.oqb}initialize(){var {OAuthManager:ta}=d(545);if("loadFrame"in this.LOa)return this.LOa.loadFrame.gzf;if(!this.Xba)return qa.Health.instance.recordKpiFailure(ta.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);
ta=this.vrd("loadFrame");this.gzc=sa.a.uj();var Fa=this.Xba+this.jof+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+A.AFrameworkApplication.userSessionId+"&WacUserType="+A.AFrameworkApplication.userType;this.IA=document.createElement("iframe");this.bXc(this.IA);this.IA.style.cssText="height:0;width:0;display:none;";this.IA.id="SharedAuthFrame";this.IA.setAttribute("name","SharedAuthFrame");this.IA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.IA.setAttribute("title","SharedAuthFrame");this.IA.src=Fa;document.body.appendChild(this.IA);Fa=sa.a.uj()-this.gzc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Fa,this.IA.src);return ta}O1c(ta){this.wxd=ta;const Fa=new ca.a(fa.a.Rsh);Fa.Values=this.Lyf(ta);ta=this.vrd("initFrame");this.dF.vjb(Fa,this.IA.contentWindow,this.Xba);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return ta}nV(ta,Fa,pa,ka,Ha,Ya){const Ka=new ca.a(fa.a.sgl),Pa=this.H5f();Ka.Values=this.MDh(ta,Fa,pa,ka,Ha,Ya,Pa);ta=this.vrd(Pa);ka&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.lTh.enqueue(()=>new Promise(Oa=>{this.kzl(Ya,Ka,Oa,Pa)})):(this.dF.vjb(Ka,this.IA.contentWindow,this.Xba),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Fa));return ta}kzl(ta,Fa,pa,ka){const Ha=
this.LOa[ka];Ha&&(this.Hqb=Fa,this.D3a=Object.assign(new N,{resolve:pa,correlationId:ka}),this.CZ=new ma(this.Xba,this.jof,ta,this.dF,Ha,pa),this.CZ.g6())}H5f(){return ia.a.create().toString()}MDh(ta,Fa,pa,ka,Ha,Ya,Ka){const Pa={};Pa.appName=ta;Pa.appId=Fa;Pa.target=pa;Pa.withPopup=ka;Pa.claims=Ha;Pa.promptMessage=Ya;Pa.messageCorrelationId=Ka;return Pa}bXc(ta){$addHandler(ta,"load",Object(P.a)(this,this.cuk,"onIFrameLoaded"));$addHandler(ta,"error",Object(P.a)(this,this.KHe,"onIFrameError"));this.dF.LBa(this.Xba);
this.dF.wu(fa.a.Ush);this.dF.HB(fa.a.Ush,Object(P.a)(this,this.nxk,"onScriptLoaded"));this.dF.wu(fa.a.Tsh);this.dF.HB(fa.a.Tsh,Object(P.a)(this,this.mxk,"onScriptInitialized"));this.dF.wu(fa.a.Psh);this.dF.HB(fa.a.Psh,Object(P.a)(this,this.Ktk,"onGetTokenResponse"));this.dF.wu(fa.a.Vsh);this.dF.HB(fa.a.Vsh,Object(P.a)(this,this.Ruk,"onLoginResponse"));this.dF.wu(fa.a.Ssh);this.dF.HB(fa.a.Ssh,Object(P.a)(this,this.quk,"onInteractiveFlowReady"));this.dF.wu(fa.a.Qsh);this.dF.HB(fa.a.Qsh,Object(P.a)(this,
this.Ztk,"onHideDialog"));this.dF.wu(fa.a.Nsh);this.dF.HB(fa.a.Nsh,Object(P.a)(this,this.Frk,"onCloseDialog"))}vrd(ta){const Fa=new O;Fa.startTime=sa.a.uj();const pa=new Promise((ka,Ha)=>{Fa.resolve=ka;Fa.reject=Ha});Fa.gzf=pa;this.LOa[ta]=Fa;return pa}cuk(){const ta=sa.a.uj()-this.gzc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ta)}KHe(ta){const {OAuthManager:Fa}=d(545),pa=sa.a.uj()-this.gzc,ka=Object.assign(new Na.a,{durationMs:pa});qa.Health.instance.recordKpiFailure(Fa.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,ka);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",pa,this.Raf?JSON.stringify(ta):"")}nxk(ta){const {OAuthManager:Fa}=d(545),pa=this.LOa.loadFrame;var ka=sa.a.uj()-pa.startTime,Ha=ta.Values.AuthLibrary.toString();ta=ta.Values.Success.toString();h.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ta,Ha,ka);Ha&&(this.oqb="SharedAuthTokenStrategy "+Ha);
Ha=Boolean.parse(ta);Ha||(ta=F.a.Rz(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.z6b()),ka=Object.assign(new Na.a,{durationMs:ka,extendedProperties:ta}),qa.Health.instance.recordKpiFailure(Fa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ka)));pa.resolve(Ha?0:1)}mxk(ta){if(ta.Values.interactive&&this.Hqb&&this.Hqb.Values.messageCorrelationId){const pa=this.Hqb.Values.messageCorrelationId.toString();if(ta.Values.interactive&&this.CZ){this.CZ.fMi.then(ka=>{this.dF.vjb(this.Hqb,this.CZ.Osh.contentWindow,
this.Xba);this.CZ.pml(pa,ka);this.CZ.tHh(!0);this.Hqb=null});return}}ta=this.LOa.initFrame;const Fa=sa.a.uj()-ta.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Fa);ta.resolve(0)}Ktk(ta){if(ta.Values.messageCorrelationId&&ta.Values.messageCorrelationId.toString()){var Fa=ta.Values.messageCorrelationId.toString(),pa=this.LOa[Fa];if(pa){var ka=sa.a.uj()-pa.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
ka);ta.Values.isSuccess&&ta.Values.isSuccess?pa.resolve(ta.Values.response):pa.reject(ta.Values.response);this.qEh(Fa)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}quk(){if(this.CZ.gMi)this.CZ.LXf();else if(this.wxd&&this.CZ){const ta=new ca.a(fa.a.Rsh);ta.Values=this.Lyf(this.wxd,
!0);this.dF.vjb(ta,this.CZ.Osh.contentWindow,this.Xba)}}Ztk(){this.CZ&&this.CZ.yce()}Frk(ta){ta.Values.cancelled&&ta.Values.cancelled&&ta.Values.messageCorrelationId&&this.qEh(ta.Values.messageCorrelationId.toString());this.CZ&&this.CZ.hide()}Lyf(ta,Fa=!1){const pa={};pa.appIds=this.o3i();pa.upn=ta.loginHint;pa.authority=ta.authority;pa.authorityType=Object(e.a)(m,ta.authorityType);pa.tenantId=ta.tenantId;pa.correlationId=A.AFrameworkApplication.userSessionId;pa.enableConsoleLogging=this.Raf;pa.enablePopupFlash=
this.LQh;pa.skipUpnCheck=this.D0h;pa.interactive=Fa;return pa}o3i(){const ta=[],Fa=E.OAuthManagerSettings.wQd;for(let pa in Fa)Array.add(ta,Fa[pa]);return ta}Itd(ta,Fa,pa,ka,Ha,Ya){const Ka=new ca.a(fa.a.qgl),Pa=this.H5f();Ka.Values=this.MDh(ta,Fa,pa,ka,Ha,Ya,Pa);this.$pf=Ka;ta=this.vrd(Pa);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Fa);this.dkl();return ta}Mrd(){return!0}dkl(){this.Yob||(this.Yob=new Q.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Yob.id=16,this.Yob.WZc=!1,this.Yob.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.dF.vjb(this.$pf,this.IA.contentWindow,this.Xba)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),A.AFrameworkApplication.Aa.hb.QFc(this.Yob,!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Ruk(ta){if(ta.Values.messageCorrelationId&&
ta.Values.messageCorrelationId.toString()){var Fa=this.LOa[ta.Values.messageCorrelationId.toString()];if(Fa){var pa=sa.a.uj()-Fa.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",pa);ta.Values.isSuccess&&ta.Values.isSuccess?Fa.resolve(ta.Values.response):Fa.reject(ta.Values.response)}else h.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}qEh(ta){this.D3a&&this.D3a.correlationId===ta&&(this.D3a.resolve(null),this.D3a=null)}}Object(I.a)(Ca,"SharedAuthTokenStrategy",null,[425]);class ha{constructor(ta){this.XId=ta;this.oqb="UnsupportedAuthTokenStrategy Reason="+n.a[this.XId]}initialize(){return Promise.resolve(0)}O1c(){return Promise.resolve(0)}nV(){return Promise.resolve(Object.assign(new z.a,{IsSuccess:!1,ErrorCode:n.a[this.XId],ErrorMessage:"Unable to get a token. Reason: ["+
n.a[this.XId]+"]"}))}Itd(){return Promise.resolve(Object.assign(new z.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Mrd(){return!1}z6b(){return this.oqb}}Object(I.a)(ha,"UnsupportedAuthTokenStrategy",null,[425]);var Ba=d(209);d.d(Y,"OAuthManager",function(){return va});class va{constructor(ta=null){this.P6=0;this.c2=null;this.J4a=0;const Fa=sa.a.uj();this.cTh=this.FLi(ta).then(pa=>
pa?this.GCj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(sa.a.uj()-Fa)),pa=F.a.Rz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Na.a,{durationMs:Math.floor(sa.a.uj()-Fa),extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,"StrategyPickFailed",!1,!0,pa)),Promise.resolve(1))).then(pa=>0!==pa?Promise.resolve(pa):this.C_j())}GLi(){var ta=E.OAuthManagerSettings.qmk;
ta&&0<ta.length?(this.P6=1,this.c2=new B(ta)):A.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||A.AFrameworkApplication.fa.ka("IsO365CommercialHost")?A.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.P6=2,this.c2=new ha(this.P6)):(ta=v.a.getAuthContext().loginHint)&&ta.length?E.OAuthManagerSettings.Q$a?(this.P6=1,this.c2=new S):(this.P6=1,this.c2=new Ca):(this.P6=3,this.c2=new ha(this.P6)):(this.P6=4,this.c2=new ha(this.P6))}WD(){return this.c2?this.c2.z6b()||"Unknown":"None"}FLi(ta=null){h.ULS.sendTraceTag(562128578,
3E3,50,"Creating OAuthManager.");const Fa=sa.a.uj();return A.AFrameworkApplication.fa.l$i().then(pa=>{pa?(this.GLi(),ta&&(this.c2=ta),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",E.OAuthManagerSettings.clientVersion,E.OAuthManagerSettings.appVersion,E.OAuthManagerSettings.rOi,this.WD(),Math.floor(sa.a.uj()-Fa))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(sa.a.uj()-Fa));return Promise.resolve(pa)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(sa.a.uj()-Fa));return Promise.resolve(!1)})}GCj(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.WD());const ta=sa.a.uj();return y.get(this.c2.initialize(),2,E.OAuthManagerSettings.bNe).then(Fa=>{if(0===Fa)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.WD(),Math.floor(sa.a.uj()-ta));else if(1===Fa){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(sa.a.uj()-ta));var pa=F.a.Rz();void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Na.a,{durationMs:Math.floor(sa.a.uj()-ta),extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,"StrategyInitFailed",!1,!0,pa))}else 2===Fa&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.WD(),Math.floor(sa.a.uj()-ta)),pa=F.a.Rz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Na.a,{durationMs:Math.floor(sa.a.uj()-ta),extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,"StrategyInitTimedOut",!1,!0,pa)));return Promise.resolve(Fa)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(sa.a.uj()-ta));return Promise.resolve(1)})}C_j(){h.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.WD());const ta=sa.a.uj();return y.get(this.c2.O1c(v.a.getAuthContext()),2,E.OAuthManagerSettings.bNe).then(Fa=>{if(0===Fa)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.WD(),Math.floor(sa.a.uj()-ta));else if(1===Fa){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(sa.a.uj()-ta));var pa=F.a.Rz();void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Na.a,
{durationMs:Math.floor(sa.a.uj()-ta),extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,"StrategyLoadFailed",!1,!0,pa))}else 2===Fa&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(sa.a.uj()-ta)),pa=F.a.Rz(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.WD()),pa=Object.assign(new Na.a,{durationMs:Math.floor(sa.a.uj()-ta),extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,
"StrategyLoadTimedOut",!1,!0,pa)));return Promise.resolve(Fa)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WD(),Math.floor(sa.a.uj()-ta));return Promise.resolve(1)})}nV(ta,Fa,pa=null){return this.QOb(ta,Fa,!1,null,"",pa)}NDh(ta,Fa,pa,ka,Ha=null){return this.QOb(ta,Fa,!0,pa,ka,Ha)}QOb(ta,Fa,pa,ka,Ha,Ya,Ka=0){Ka+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
ta,this.ijb(ta,Fa),this.WD(),Ka);var Pa=F.a.Rz();void 0!==Pa&&null!==Pa&&(Pa.set("AuthLibrary",this.WD()),Pa.set("AppName",ta),Pa.set("Target",this.ijb(ta,Fa)),qa.Health.instance.recordKpiUsage(va.kpiName,0,"WacOAuthFC",Pa));if(!E.OAuthManagerSettings.isEnabled){var Oa;return this.loe((Oa=new z.a,Oa.IsSuccess=!1,Oa.Token=null,Oa.ErrorCode="NotEnabled",Oa.ErrorMessage="OAuthManager is disabled.",Oa),ta)}const oa=E.OAuthManagerSettings.wQd[ta];if(void 0===oa||null===oa){h.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ta);var Xa;return this.loe((Xa=new z.a,Xa.IsSuccess=!1,Xa.Token=null,Xa.ErrorCode="DisallowedApp",Xa.ErrorMessage="Disallowed appName: "+ta,Xa),ta)}const Hb=sa.a.uj(),Ob=this;Pa=this.cTh.then(Sb=>Ob.gIj(ta,oa,Fa,pa,ka,Ha,Ya,Sb));Oa=pa?0:E.OAuthManagerSettings.bNe;let eb;Xa=(eb=new z.a,eb.IsSuccess=!1,eb.Token=null,eb.ErrorCode="authTokenStrategy_timeout",eb.ErrorMessage="Auth Strategy timed out after ["+
Oa+"] ms when fetching token",eb);let Eb=this,oc=this;return y.get(Pa,Xa,Oa).then(Sb=>Ka<=va.blk&&(Sb.ErrorCode===va.VBh||Sb.ErrorCode===va.crl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ka,Math.floor(sa.a.uj()-Hb)),Eb.QOb(ta,Fa,pa,ka,Ha,Ya,Ka)):Sb.ErrorCode===va.Wng&&!pa&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ka,va.lRf),va.EQi&&Eb.c2.Mrd()&&Eb.c2.Itd(ta,oa,Fa,
pa,ka,Ha).then(qc=>Promise.resolve(Eb.c2c(qc,ta,Fa,oa,Hb))).catch(()=>{let qc;const $a=(qc=new z.a,qc.IsSuccess=!1,qc.Token=null,qc.ErrorCode="authTokenStrategy_failure",qc.ErrorMessage="LoginPopup failed, GetToken could not be called",qc);return Promise.resolve(Eb.c2c($a,ta,Fa,oa,Hb))}),va.lRf)?Eb.QOb(ta,Fa,!0,ka,Ha,Ya,Ka):Promise.resolve(Eb.c2c(Sb,ta,Fa,oa,Hb))).catch(()=>{let Sb;const qc=(Sb=new z.a,Sb.IsSuccess=!1,Sb.Token=null,Sb.ErrorCode="authTokenStrategy_failure",Sb.ErrorMessage="Auth Strategy failed with an unknown error",
Sb);return Promise.resolve(oc.c2c(qc,ta,Fa,oa,Hb))})}gIj(ta,Fa,pa,ka,Ha,Ya,Ka,Pa){return 1===Pa||2===Pa?this.loe(Object.assign(new z.a,{IsSuccess:!1,Token:null,ErrorCode:1===Pa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ta):this.c2.nV(ta,Fa,pa,ka,Ha,Ya,Ka).then(Oa=>Promise.resolve(this.R_g(Oa,!0,ta))).catch(Oa=>Promise.resolve(this.R_g(Oa,!1,ta)))}c2c(ta,Fa,pa,ka,Ha){const Ya={};Ha=sa.a.uj()-Ha;Ya.IsSuccess=ta.IsSuccess;Ya.ErrorCode=ta.IsSuccess?"Success":ta.ErrorCode||
"";Ya.ErrorMessage=ta.IsSuccess?"Success":this.ijb(Fa,ta.ErrorMessage||"");Ya.Target=this.ijb(Fa,pa||"");Ya.TimeInMS=Math.floor(Ha);Ya.AuthLibrary=this.WD();Ya.AppName=Fa;Ya.AuthorityType=Object(e.a)(m,v.a.qRc());Ya.UserType=this.Gnj(v.a.getAuthContext());Ya.IsAuthSupportedInSession=n.a[this.P6];Ya.RequestCount=++this.J4a;Ya.AppId=ka;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ya));ta.IsSuccess||(pa=F.a.Rz(),void 0!==pa&&null!==pa&&(pa.set("AppName",Fa),pa.set("AuthLibrary",this.WD()),pa.set("ErrorCode",
ta.ErrorCode),pa.set("ErrorMessage",this.ijb(Fa,ta.ErrorMessage)),Fa=Object.assign(new Na.a,{durationMs:Ha,extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,"TryGetTokenFailure",!1,!0,Fa)));return ta}loe(ta,Fa){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Fa,this.ijb(Fa,ta.ErrorMessage));const pa=F.a.Rz();void 0!==pa&&null!==pa&&(pa.set("AppName",Fa),pa.set("AuthLibrary",this.WD()),pa.set("ErrorCode",ta.ErrorCode),
pa.set("ErrorMessage",this.ijb(Fa,ta.ErrorMessage)),Fa=Object.assign(new Na.a,{extendedProperties:pa}),qa.Health.instance.recordKpiFailure(va.kpiName,"FailureBeforeGetToken",!1,!0,Fa));return Promise.resolve(ta)}Mig(ta){return ta===Ba.a.Jsd}ijb(ta,Fa){return this.Mig(ta)&&Fa?"REDACTED":Fa}Gnj(ta){return A.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!ta.loginHint||1>ta.loginHint.length?"empty":-1<ta.loginHint.indexOf("guest#")?"guest":-1<ta.loginHint.indexOf("ext#")?"external":0>ta.upn.indexOf("@")?
"no-at":"supported"}rJj(){return 1===this.P6}R_g(ta,Fa,pa){let ka=null,Ha=null,Ya=null,Ka=null;ta?ta.ErrorCode||ta.ErrorMessage?(Ha=ta.ErrorCode?ta.ErrorCode:va.fTf,Ya=ta.ErrorMessage?ta.ErrorMessage:"No message"):ta.Token?Fa?ka=ta.Token:(Ha=va.PVk,Ya="A rejected promise returned a token."):(Ha=va.fTf,Ya=JSON.stringify(ta)):(Ha=va.hok,Ya="No result came from Auth Token Strategy");ta&&ta.Telemetry&&!this.Mig(pa)&&(Ka=ta.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ka)));if(Ha===va.Emk||
Ha===va.pwl)Ha=va.VBh,Ya="Auth Library Timed Out";Ha===va.Sgi&&-1<Ya.indexOf(va.E3h)&&(Ha=va.Wng);if(Ha||Ya)ka=null;return Object.assign(new z.a,{IsSuccess:!!ka,Token:ka,ErrorCode:Ha,ErrorMessage:Ya,Telemetry:Ka})}static get lRf(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get EQi(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}va.pwl="token_renewal_error";
va.fTf="Exception";va.hok="NoResult";va.PVk="RejectToken";va.Emk="monitor_window_timeout";va.VBh="Timeout";va.crl="authTokenStrategy_timeout";va.Sgi="login_required";va.E3h="AADSTS50058";va.Wng="Cookies Disabled";va.kpiName="OAuthManager";va.blk=2;Object(I.a)(va,"OAuthManager",null,[350])},549:function(I,Y,d){I=d(0);var h=d(387),e=d(353),n=d(57),m=d(67),z=d(173),B=d(93),v=d(27);d(14);var y=d(36),A=d(50),E=d(99);class u{constructor(){this.Hhb=this.O5=null;this.qCh=0}}Object(I.a)(u,"CandidateManager",
null,[]);var J=d(658),G=d(656),S=d(657);class P{constructor(){this.keyCode=0;this.hKl=this.gKl=null}}Object(I.a)(P,"PredictionKeptState",null,[]);class Q{constructor(){this.values={}}Idg(Fa,pa,ka){Fa=this.e7f(Fa);Fa[pa]=pa in Fa?Fa[pa]+ka:ka}add(Fa,pa,ka){this.e7f(Fa)[pa]=ka}ga(Fa){return this.values[Fa]}$(Fa,pa){return this.values[Fa]=pa}OHf(Fa){return Fa in this.values?!0:!1}e7f(Fa){let pa;Fa in this.values?pa=this.values[Fa]:(pa={},this.values[Fa]=pa);return pa}}Object(I.a)(Q,"PredictionState",
null,[]);class D{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(I.a)(D,"TypeAheadRoamingSettings",null,[]);var O=d(201),X=d(1200),N=d(18),aa=d(913),V=d(659);d(915);var ca=d(914);class fa{constructor(Fa){this.Vvc=null;this.xD=Fa;Fa=n.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Sw;const pa=n.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Fa,pa)}initialize(Fa,pa){const ka=new V.a;return Fa?pa?this.Vvc?this.Vvc:
v.AFrameworkApplication.Aa.hb.mig?this.Vvc=new Promise((Ha,Ya)=>{const Ka=v.AFrameworkApplication.Aj("al",2);pa.XAb(Ka).continueWith(Pa=>{Pa.tm?(this.j4g(),Ya(Pa.Yi.message)):(this.ieg(ka),Ha({}))})}):this.Vvc=Fa.loadScript("al").then(()=>{this.ieg(ka)}).catch(Ha=>{this.j4g();return Promise.reject(Ha)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}ieg(Fa){fa.RS.hG(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const pa=
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let ka=v.AFrameworkApplication.fa.Ga("OfficeApplicationName")||"";ka=ka.replace("Web","");Fa.appName=Fa.appName||ka;Fa.serviceUrl=Fa.serviceUrl||v.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl");Fa.appVersion=Fa.appVersion||v.AFrameworkApplication.fa.Ga("BuildVersion")||"";Fa.releaseAudienceGroup=Fa.releaseAudienceGroup||(v.AFrameworkApplication.gd?Object(X.a)(String,v.AFrameworkApplication.gd.AudienceGroup)||"":"");Fa.sessionId=Fa.sessionId||
v.AFrameworkApplication.fa.Ga("SessionId")||"";Fa.uiLanguage=Fa.uiLanguage||v.AFrameworkApplication.uiCulture;Fa.flights=this.z3i();Fa.initSession=Fa.initSession||!0;pa.initialize(Fa);pa.activateAnnotation(Object.assign(new aa.a,{annotationType:ca.a.getTypeName(),handler:this.xD}))},"WordPredictionAL:Initialize")}j4g(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}z3i(){var Fa=v.AFrameworkApplication.fa.Ga("FlightId"),pa=v.AFrameworkApplication.fa.WA("AugLoopFlightKeywordList");
Fa=this.dXi(Fa,pa);pa="";0<Fa.length&&(pa=O.a.join(Fa,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Fa.length].concat(Fa)));return pa}dXi(Fa,pa){const ka=new N.a;if(Fa&&""!==Fa&&pa&&0<pa.length){for(let Ha=0;Ha<pa.length;Ha++)pa[Ha]=pa[Ha].toLowerCase();Fa=Fa.toLowerCase().split(";");for(const Ha of Fa)O.a.any(pa,Ya=>-1<Ha.indexOf(Ya))&&ka.add(Ha)}return ka.toArray()}static get RS(){return e.a.instance}}Object(I.a)(fa,"WordPredictionAugLoopHandler",null,
[997]);var ma=d(142),da=d(181),qa=d(130);class F{constructor(Fa,pa,ka,Ha){this.$1b=null;this.wYg=Fa;this.N8k=ka;this.Fpi=Ha;this.A8k=pa;this.uMc=Array(Fa);this.Lkh();this.Ykh()}kCj(Fa,pa,ka){Fa>this.wYg-1||this.Hdg(this.uMc[Fa],pa,ka)}aab(Fa,pa){this.Hdg(this.$1b,Fa,pa)}lOd(Fa,pa){this.$1b[Fa]=pa}flush(){F.RS.hG(()=>{for(let Fa=0;Fa<this.uMc.length;Fa++){const pa=this.x2i(Fa);pa&&(pa.dataFields.push(Object.assign(new qa.a,{name:G.a.qP,int64:Fa})),ma.a.sendActivityEvent(pa))}this.Lkh()},"WPT:F")}VZi(){F.RS.hG(()=>
{const Fa=this.w2i();Fa&&ma.a.sendActivityEvent(Fa);this.Ykh()},"WPT:FSD")}QZi(Fa){F.RS.hG(()=>{const pa=this.v2i(Fa);pa&&ma.a.sendActivityEvent(pa)},"WPT:FCD")}w2i(){const Fa=this.D8d(this.N8k);for(var pa=0;pa<S.a.ySa.length;pa++)this.mOd(S.a.ySa[pa],this.$1b,Fa.dataFields);for(pa=0;pa<S.a.V4b.length;pa++)this.FYb(S.a.V4b[pa],this.$1b,Fa.dataFields);return Fa.dataFields.length?Fa:null}x2i(Fa){const pa=this.D8d(this.A8k);for(let ka=0;ka<G.a.ySa.length;ka++)this.mOd(G.a.ySa[ka],this.uMc[Fa],pa.dataFields);
return pa.dataFields.length?pa:null}v2i(Fa){const pa=this.D8d(this.Fpi);for(var ka=0;ka<J.a.ySa.length;ka++)this.mOd(J.a.ySa[ka],Fa,pa.dataFields);for(ka=0;ka<J.a.V4b.length;ka++)this.FYb(J.a.V4b[ka],Fa,pa.dataFields);return pa.dataFields.length?pa:null}Hdg(Fa,pa,ka){Fa[pa]=pa in Fa?Fa[pa]+ka:ka}D8d(Fa){const pa=new da.a;pa.name=Fa;pa.dataFields=[];return pa}mOd(Fa,pa,ka){Fa in pa&&Array.add(ka,Object.assign(new qa.a,{name:Fa,int64:pa[Fa]}))}FYb(Fa,pa,ka){Fa in pa&&Array.add(ka,Object.assign(new qa.a,
{name:Fa,string:pa[Fa]}))}Lkh(){for(let Fa=0;Fa<this.wYg;Fa++)this.uMc[Fa]={}}Ykh(){this.$1b={}}static get RS(){return e.a.instance}}Object(I.a)(F,"WordPredictionTelemetryHandler",null,[996]);var sa=d(64),ia=d(33),Na=d(385),Ca=d(307),ha=d(92);d(235);var Ba=d(51),va=d(34);d(348);d(379);d(1046);d.d(Y,"a",function(){return ta});class ta{static get RS(){return e.a.instance}static get QD(){ta.rwc||(ta.rwc=new u);return ta.rwc}static set QD(Fa){ta.rwc=Fa}static get A_c(){return ta.erf}static set A_c(Fa){ta.erf=
Fa}static get PJh(){ta.yNd||(ta.yNd=ta.LFi());return ta.yNd}static get settings(){ta.EDc||(ta.EDc=Object.assign(new D,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return ta.EDc}static set settings(Fa){ta.EDc=Fa}static get BZa(){ta.tId||(ta.tId=new Q);return ta.tId}static get $tl(){return ta.eKi}static get u6(){ta.ANd||(ta.ANd=new F(ta.$tl,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));
return ta.ANd}static get QIi(){return ta.P5a?ta.P5a.instance?ta.P5a.instance.i3:1:(ta.P5a=n.a.instance.Ja("Common.IZoomManager"),ta.P5a&&ta.P5a.instance?ta.P5a.instance.i3:1)}static get characterPropertiesEditor(){ta.tyd||(ta.tyd=n.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return ta.tyd}static get Rid(){ta.FId||n.a.instance.Ja("Box4.Proofing.IProofingSentenceSeparator").execute(Fa=>{Fa&&(ta.FId=Fa)});return ta.FId}static get iKl(){ta.zNd||(ta.zNd=n.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));
return ta.zNd}static G5k(){window.setTimeout(()=>{const Fa={};Fa.WordPredIsEnabled=ta.settings.WordPredIsEnabled;Fa.PredictionSeenCount=ta.settings.PredictionSeenCount;Fa.PredictionAccepted=ta.settings.PredictionAccepted;ta.iKl.XNl(y.c(Fa))},ta.zMf)}static hbe(Fa,pa){if(!Fa||!pa||Fa.eventName!==m.a.cQa)return!1;const ka=Fa.qc.keyCode;if(ta.Pgg(pa)){ta.ZTk();pa=pa.node;if((ka===z.a.oP||ka===z.a.Sq)&&ta.UUa)return B.a.Bn(Fa.qc),ta.JGj(pa),ta.TEl(ka),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),
!0;if(ka===z.a.pP)ta.A_c&&(ta.A_c=!1);else if(ka===z.a.T1&&ta.UUa)ta.A_c=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),ta.ZTa();else if(ka===z.a.tmb&&Fa.qc.ctrlKey&&ta.rId)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),ta.Wkh(),!1}if(ka===z.a.$lb&&Fa.qc.shiftKey||ka===z.a.cba&&Fa.qc.ctrlKey||ka===z.a.sMa&&Fa.qc.altKey)return!1;pa=ta.QD.O5;const Ha=ka===z.a.cZ||ka===z.a.K6||ka===z.a.Mga||ka===z.a.dba;if(Ha||Ha&&(Fa.qc.ctrlKey||Fa.qc.shiftKey)||ka!==z.a.cba&&Fa.qc.ctrlKey||
ka!==z.a.sMa&&Fa.qc.altKey||ka===z.a.TH||ta.UUa&&pa&&0<pa.Q8.length&&!pa.Q8.toLowerCase().startsWith(String.fromCharCode(ka).toLowerCase()))ta.ZTa(),ta.QD.O5=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");ta.Wkh();return!1}static Svj(){5>ta.settings.PredictionSeenCount&&(ta.settings.PredictionSeenCount+=1)}static ZTa(){Na.a.ZTa();ta.UUa=!1}static JGj(Fa){ta.RS.hG(()=>{var pa=document.getElementById("inlinePredictedWord");
if(pa){var ka=pa.innerText;if(ka&&0<ka.length&&(Fa=Fa?Fa:ta.Hej())){var Ha=new A.GraphTransaction(7);Ha.kd(Fa);var Ya=Fa.Ra.last,Ka=Ba.a.SQa(Fa),Pa=ha.a.xs(Ka);Ya.formatting=Pa.ae(Ya);ta.characterPropertiesEditor.replaceTextRange(Ka,ka,!0,!0,va.a.typing);Ha.dispose();ka=E.InteractiveViewManager.instance.Pd;Ha=Fa.mg(ka.Ma);Ha=Ca.a.Ot(Ha,ia.ParagraphReader.textLength(Fa));Ya=new Sys.UI.Point(Ha.x,Ha.y);Ya.y+=Ha.height;ka.E6(Ya,null,null,ka,!1);ta.UUa=!1;pa.innerText="";(pa=document.getElementById("inlinePlaceholderTab"))&&
ta.Aag()&&(pa.className="hidePanel")}}},"WPT:IIG")}static Abl(Fa){ta.aof=Fa;ta.u6.lOd(S.a.modelId,Fa.modelId);ta.u6.lOd(S.a.modelVersion,Fa.modelVersion);ta.u6.lOd(S.a.configId,Fa.configId)}static Ycj(){return ta.aof}static TQd(Fa,pa){const ka=ta.PJh;var Ha=document.getElementById("inlinePredictedWord");Ha&&(Ha.innerText=pa,(pa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<pa.length&&(pa=pa[pa.length-1],Ha.style.fontSize=pa.style.fontSize,
Ha.style.fontFamily=pa.style.fontFamily,Ha.style.color=pa.style.color,Ha.style.whiteSpace="pre",Ha=Ha.parentNode,Fa="suggestion: "+Fa,pa=document.getElementById("inlinePlaceholderTab"),pa.className="hidePanel",pa&&ta.Aag()&&(pa.className="inlinePlaceholderTab",Fa+=". Tab to accept"),Ha.parentNode.setAttribute("aria-label",Fa)),ka&&(ka.className="textareaCaretTracker"),ta.mcl()&&(ta.UUa=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static Pgg(Fa){Fa||(Fa=ta.h6i());if(Fa){const pa=
Fa.node;try{return ia.ParagraphReader.textLength(pa)<=Fa.Qa}catch(ka){}}return!1}static u1j(Fa){Fa=ta.BZa.ga(Fa);Fa=Fa[S.a.uQd]-Fa[S.a.Crc];300<Fa?(ta.u6.aab(S.a.fNf,Fa),ta.u6.aab(S.a.eNf,1)):(ta.u6.aab(S.a.Kyf,Fa),ta.u6.aab(S.a.Zvf,1))}static Z3d(Fa){ta.Iig("TextPredictionTelemetryIsEnabled")&&ta.u6.QZi(Fa)}static oqg(Fa,pa){Fa=ta.BZa.ga(Fa);const ka=Fa[S.a.Crc];pa?ta.u6.aab(S.a.uwh,Fa[S.a.$vf]-ka):ta.u6.aab(S.a.swh,Fa[S.a.Yvf]-ka)}static jbc(Fa){ta.u6.aab(Fa,1)}static Oua(Fa,pa,ka){ta.u6.kCj(Fa,
pa,ka)}static Yld(){ta.QD.O5=null;ta.QD.Hhb=null}static lIk(){ta.Blb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");ta.Svj();ta.eIj()}static Blb(Fa,pa){ta.Iig(pa)&&window.setTimeout(()=>{const ka=n.a.instance.Ja("Common.ISystemInitiatedFeedback");ka&&ka.execute(Ha=>{Ha.logActivity(Fa,pa)})},ta.zMf)}static Iig(Fa){return!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka(Fa)}static LFi(){var Fa=document.body;const pa=document.createElement("div");if(Fa){Fa.appendChild(pa);pa.setAttribute("id",
"textareaCaretTracker");pa.className="hidePanel";pa.setAttribute("role","alert");Fa=document.createElement("button");const ka=document.createElement("span");Fa.setAttribute("disabled",!0);Fa.setAttribute("aria-disabled",!0);Fa.setAttribute("aria-hidden",!0);ka.setAttribute("aria-disabled",!0);ka.setAttribute("aria-hidden",!0);ka.setAttribute("id","inlinePredictedWord");ka.className="inlinePredictedWord";Fa.className="inlinePredictedWordButton";Fa.appendChild(ka);pa.appendChild(Fa);pa.appendChild(ta.sHi());
(Fa=document.getElementById("WACViewPanel"))&&$addHandler(Fa,"scroll",ta.Stj)}return pa}static mcl(){const Fa=ta.PJh;var pa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");pa=(pa=pa?pa.getElementsByClassName("EOP")[0]:null)?pa.getBoundingClientRect():null;return Fa&&pa?(Fa.style.cssText="transform: scale("+ta.QIi+"); transform-origin: 0% 0%",Fa.style.top=pa.top+"px",Fa.style.left=pa.left+"px",!0):!1}static Aag(){return!ta.settings.PredictionAccepted}static eIj(){5!==ta.settings.PredictionSeenCount||
ta.settings.PredictionAccepted||(ta.Blb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),ta.G5k())}static sHi(){const Fa=document.createElement("button");Fa.setAttribute("aria-hidden",!0);Fa.className="hidePanel";Fa.id="inlinePlaceholderTab";Fa.disabled=!0;Fa.innerText="Tab";return Fa}static Stj(){ta.ZTa()}static Hej(){const Fa=sa.a.instance.Na.mb;return Fa&&Fa.Ye?Fa.Ye.node:null}static ZTk(){ta.WLd||(ta.WLd=window.setTimeout(ta.nsj,6E4*ta.dKi))}static nsj(){ta.u6.flush();ta.u6.VZi();ta.WLd=
0}static e3f(Fa){return Fa&&0<Fa.length&&(Fa=Fa.split(" "),0<Fa.length)?Fa[Fa.length-1].length:-1}static TEl(Fa){const pa=ta.QD.O5,ka=ta.QD.Hhb;pa&&(ta.rId=Object.assign(new P,{keyCode:Fa,gKl:pa,hKl:ka}))}static h6i(){const Fa=sa.a.instance.Na.mb;return Fa&&Fa.Ye?Fa.Ye:null}static Wkh(){ta.rId=null}}ta.eKi=30;ta.dKi=5;ta.zMf=5E3;ta.yNd=null;ta.FId=null;ta.tyd=null;ta.P5a=null;ta.erf=!1;ta.WLd=0;ta.ANd=null;ta.tId=null;ta.rId=null;ta.zNd=null;ta.EDc=null;ta.aof=null;ta.rwc=null;ta.UUa=!1;Object(I.a)(ta,
"WordPredictionHandler",null,[])},655:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.bok="NoCharacterPositionOnLine";h.dok="NoCharacterPositionOnSpan";h.cok="NoCharacterPositionOnMultilineSpan";h.D2b="DoNothingResult";h.Lja="FailedProcessingStep";h.I8a="FailedResult";h.bQc="FirstChildNotText";h.LYi="FirstChildNull";h.oHj="InvalidCharacterPositionResult";h.vh="NoExecute";h.Vo="NoApply";h.N1="UnexpectedState";Object(I.a)(h,"ActivityEventName",null,[])},656:function(I,Y,d){d.d(Y,"a",
function(){return h});I=d(0);class h{}h.qP="WordIndex";h.wjh="RenderedCandidateCount";h.T_g="NotRenderedCandidateCount";h.yDf="CandidateListCount";h.ELf="CumulativeIndexOfSeen";h.AIi="CumulativeIndexOfRejected";h.zIi="CumulativeIndexOfKept";h.DLf="CumulativeIndexOfCorrect";h.yIi="CumulativeIndexOfAcceptedCandidate";h.eoh="SeenCount";h.QVk="RejectedCount";h.gYj="KeptCount";h.PEh="TypedThroughCount";h.BIi="CumulativeScoreOfKept";h.CIi="CumulativeScoreOfRejected";h.GLf="CumulativeScoreOfTypeThrough";
h.xjh="RenderedCharSum";h.fYj="KeptCharSum";h.eYj="KeptCandidateTokenSum";h.VAl="UndoOfKeptCount";h.YAl="UndoneKeptCharCount";h.QEh="TypedThroughLastMatchingCharCount";h.language="Language";h.ySa=[h.wjh,h.T_g,h.yDf,h.ELf,h.AIi,h.zIi,h.DLf,h.yIi,h.eoh,h.QVk,h.gYj,h.PEh,h.BIi,h.CIi,h.GLf,h.xjh,h.fYj,h.eYj,h.VAl,h.YAl,h.QEh,h.language];Object(I.a)(h,"DataFieldsPerSentence",null,[])},657:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion=
"ModelVersion";h.jIk="PredictionAcceptedByTab";h.iIk="PredictionAcceptedByRightArrow";h.Kyf="AugLoopResponseTime";h.uwh="SignalRenderedTime";h.swh="SignalNotRenderedTime";h.fNf="DelayedResponseTime";h.Yml="SignalGeneratedCount";h.Zvf="AnnotationReceivedCount";h.cbh="PredictionRenderedCount";h.bbh="PredictionNotRenderedCount";h.U0d="EmptyPredictionResponseCount";h.Ewh="SkippedPredictionResponseCount";h.eNf="DelayedResponseCount";h.nok="NonEnglishSkipCount";h.Crc="SignalGenerationTime";h.uQd="AnnotationReceivedTime";
h.$vf="AnnotationRenderedTime";h.Yvf="AnnotationNotRenderedTime";h.ySa=[h.iIk,h.jIk,h.Kyf,h.uwh,h.swh,h.fNf,h.Yml,h.Zvf,h.cbh,h.bbh,h.U0d,h.Ewh,h.eNf,h.nok];h.V4b=[h.modelId,h.configId,h.modelVersion];Object(I.a)(h,"DataFieldsPerSession",null,[])},658:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.language="Language";h.DUd="CharIndex";h.sJc="CharIndexRendered";h.rog="KeptCharCount";h.modelId="ModelId";h.abh="PredictionLength";h.dbh="PredictionTokenCount";h.score="Score";h.status=
"Status";h.M3e="TypedThroughCharCount";h.qP="WordIndex";h.modelVersion="ModelVersion";h.TBh="TimeTakenAugloop";h.Rsd="TimeToRender";h.configId="ConfigId";h.ySa=[h.DUd,h.sJc,h.rog,h.abh,h.dbh,h.score,h.status,h.M3e,h.qP,h.TBh,h.Rsd];h.V4b=[h.language,h.modelId,h.configId,h.modelVersion];Object(I.a)(h,"DataFieldsPerCandidate",null,[])},659:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(I.a)(h,"InitializeParameters",null,[])},660:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);Y=d(320);var h=d(143);class e extends Y.a{constructor(){super();
this.timestamp=this.targetObject=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}}Object(I.a)(e,"Signal",Y.a,[])},661:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.ZGa=!0;this.d3c=this.G$c=this.wbd=this.e8c=null;this.Bla=e}copy(){return new h(this.Bla.copy())}move(e,n){this.ZGa=!0;this.Bla.move(e,n)}setOffsets(e){this.ZGa=!0;this.Bla.setOffsets(e)}Wf(){return this.Bla.Wf()}get hc(){this.mud();
return this.e8c}get kc(){this.mud();return this.wbd}get $b(){this.mud();return this.G$c}get Yb(){this.mud();return this.d3c}mud(){if(this.ZGa){var e=this.Bla.points;this.e8c=this.G$c=e[0].x;this.wbd=this.d3c=e[0].y;for(const n of e)this.e8c=Math.min(this.e8c,n.x),this.wbd=Math.min(this.wbd,n.y),this.G$c=Math.max(this.G$c,n.x),this.d3c=Math.max(this.d3c,n.y);this.ZGa=!1}}}Object(I.a)(h,"Boundary",null,[])},662:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.lG=e}}Object(I.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},663:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(57);class e{constructor(n){this.Vpg=this.errorType=0;this.originalText=this.token=null;this.KJa=this.laa=this.lcid=0;this.xJh=!1;this.Jlf=n}Yje(){const n=this.token?this.token:null;return 0!==this.errorType&&e.$Aj.contains(n,this.lcid)}static get $Aj(){return e.MNa||(e.MNa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.MNa=null;Object(I.a)(e,"ProofingErrorDetails",
null,[616])},664:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(h||(h={}));Object(I.b)("UserAction",h)},665:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);Y=d(110);class h extends Y.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}Zk(){return 4}static s0i(e,n){const m=new h;h.UKe(m,e,n);m.UserActionType=e.paragraphNode.GTb?"Edit":"Load";
return m}static UKe(e,n,m){e.Lcid=n.range.lcid;e.Input=n.Jna.substring(n.range.begin,n.range.end);e.ApplicationMode=m;0<=n.range.laa&&(e.PreContextText=n.Jna.substring(n.range.laa,n.range.begin));0<=n.range.KJa&&(e.PostContextText=n.Jna.substring(n.range.end,n.range.KJa))}static Dij(e,n,m,z,B,v,y,A){const {SpellingRequestObjectUpdatedV2:E}=d(1113),{SpellingRequestObjectUpdated:u}=d(1114);return A?E.O4d(n,m):e?u.O4d(n,m,z,B,v,y):h.s0i(n,m)}}Object(I.a)(h,"SpellingRequestObject",Y.a,[])},666:function(I,
Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(81);class e{static arb(n,m,z="GenericCommentsTask"){z=new h.a(2,1,0,()=>{m()},92,z);n.Db(z)}static Ys(n){return Error.create("SDXHostAPI Error : "+n,{["SDXHostAPIErrorCode"]:n})}}Object(I.a)(e,"OfficeSharedCommentsUtils",null,[])},667:function(I,Y,d){d.d(Y,"a",function(){return m});I=d(0);var h=d(387);Y=d(726);var e=d(1035),n=d(920);class m extends Y.a{constructor(z,B,v=null){super(z,B,v||e.a.instance,m.cEj)}static cEj(){n.a.sendTraceTag=m.u8k;n.a.debugAssertTag=
m.lJi}static u8k(z,B,v,...y){h.ULS.sendTraceTag.apply(null,[z,204,m.gIi(B),v].concat(y))}static lJi(){}static gIi(z){switch(z){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}m.fMe="wdPreviousSession";m.QLf="wdUserSession";Object(I.a)(m,"CommonCrossDocumentMessenger",Y.a,[])},668:function(I,Y,d){d.d(Y,"a",function(){return n});I=d(0);var h=d(387),e=d(27);class n{static jae(m,z){let B=null;if(m&&0<m.length&&z&&0<z.length){const v=window[z];
v?v&&m in v?B=v[m]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+m+" from dictionary "+z):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+z)}return B}static Hje(){const m=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",!1);m?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return m}}Object(I.a)(n,
"CommonUtils",null,[])},669:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(304);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.AYj;h.Visible=d.a.visible;h.ImageIsVisible="ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.myb;h.Image32by32Class=d.a.LEa;h.Image48by48Class=d.a.gde;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(I.a)(h,"FlyoutAnchorCommandProperties",
null,[])},670:function(I,Y,d){d.d(Y,"a",function(){return v});I=d(0);var h=d(265),e=d(27),n=d(364),m=d(199),z=d(97),B=d(65);class v{static I_a(y){let A,E;({wwl:A,xwl:E}=v.xXi());v.L5k(A,E,y)}static xXi(){({T7b:A}=n.a.NOb(!e.AFrameworkApplication.CQ));var y=$get(h.CuiHelper.Vyj);if(A)var A=document.getElementById(h.CuiHelper.p2d);else A=y.childNodes[0],y=y.childNodes[1];return{wwl:A,xwl:y}}static L5k(y,A,E){if(y&&A&&0<A.clientHeight){const u=-1!==A.parentNode.parentNode.className.indexOf("cui-ribbon");
v.Cnh(y,A,E,u)}}static Cnh(y,A,E,u){let J=null,G=null,S=null,P=null,Q=null,D=null,O=null,X=null,N=null,aa=null,V=null,ca=null,fa=null,ma=null,da=null,qa=null,F=null,sa=null,ia=null,Na=null;({bRf:J,aRf:G,cRf:S,l8a:P,m8a:Q,HRa:D,$S:O,vv:X,IRa:N,mQ:aa,JRa:V,dRf:Na}=v.IVf(y,J,G,S,P,Q,D,O,X,N,aa,V,Na));({g3b:ca,TG:fa,$Qf:ma,YQf:da,n8a:qa,Zub:F,$ub:sa,ZQf:ia}=v.gWf(A,ca,fa,ma,da,qa,F,sa,ia));y=[J,G,S,P,Q,D,O,X,N,aa,V,ma,da,qa,F,sa,ia,Na];for(var Ca of y)v.Ekl(Ca);Ca=[J,G,S,Q,O,X,aa,V,da,F,sa,ia];for(const ha of Ca)v.k4e(ha);
v.Vkh(G);v.cqh(fa,0);v.qSi(J,G,S,P,Q,D,O,X,N,aa,V,ca,fa,ma,da,qa,F,sa,ia,Na,u,E);v.Sbi(D,O)}static O5k(y,A){v.Cnh(y,null,A,!1)}static Sbi(y,A){y&&A&&(y.style.marginTop=(A.offsetHeight-y.offsetHeight)/2+"px")}static IVf(y,A,E,u,J,G,S,P,Q,D,O,X,N){for(let aa=0;y&&aa<y.childNodes.length;aa++){const V=y.childNodes[aa],ca=z.a.Yja(V),fa=!!V.id;-1!==ca.indexOf("cui-QATRowLeft")?A=V:-1!==ca.indexOf("cui-QATRowCenter")?E=V:-1!==ca.indexOf("cui-QATRowRight")?u=V:-1!==ca.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?
J=V:V.id===h.CuiHelper.GSd?G=V:V.id===h.CuiHelper.uXf?S=V:V.id===h.CuiHelper.HSd?P=V:V.id===h.CuiHelper.ISd?Q=V:fa&&v.mMj(V)?D=V:-1!==ca.indexOf("UsernameNameContainer")?O=V:-1!==ca.indexOf("UsernameNameItem")?X=V:-1!==ca.indexOf("FreemiumUpsellButton")&&(N=V);({bRf:A,aRf:E,cRf:u,l8a:J,m8a:G,HRa:S,$S:P,vv:Q,IRa:D,mQ:O,JRa:X,dRf:N}=v.IVf(V,A,E,u,J,G,S,P,Q,D,O,X,N))}return{bRf:A,aRf:E,cRf:u,l8a:J,m8a:G,HRa:S,$S:P,vv:Q,IRa:D,mQ:O,JRa:X,dRf:N}}static gWf(y,A,E,u,J,G,S,P,Q){for(let D=0;y&&D<y.childNodes.length;D++){const O=
y.childNodes[D],X=z.a.Yja(O),N=!!O.id;-1!==X.indexOf("cui-jewel-container")?A=O:-1!==X.indexOf("cui-tts")?E=O:-1!==X.indexOf("cui-TabRowInline")?J=O:-1!==X.indexOf("cui-TabRowRight")?Q=O:-1!==X.indexOf("cui-separator")?u=O:N&&O.id.startsWith(h.CuiHelper.y7g)&&!G?G=O:N&&O.id.startsWith(h.CuiHelper.bVf)?S=O:N&&O.id.startsWith(h.CuiHelper.lKe)&&(P=O);({g3b:A,TG:E,$Qf:u,YQf:J,n8a:G,Zub:S,$ub:P,ZQf:Q}=v.gWf(O,A,E,u,J,G,S,P,Q))}return{g3b:A,TG:E,$Qf:u,YQf:J,n8a:G,Zub:S,$ub:P,ZQf:Q}}static K5k(y,A,E,u,J,
G,S,P,Q){v.DR(y,A,Q)&&(v.$Vc(A),v.DR(y,A,Q)&&v.$Vc(A));v.DR(A,u,Q)&&(v.tL(E),v.tL(J),v.DR(A,u,Q)&&(v.$Vc(A),v.DR(A,u,Q)&&(v.$Vc(A),v.DR(A,u,Q)&&v.tL(u))));v.DR(u,P,Q)&&(v.tL(E),v.tL(J));y=[G,S,P];v.Wbg(u,P,y,Q);v.Wbg(A,P,y,Q)}static Wbg(y,A,E,u){let J=0;for(;J<E.length&&v.DR(y,A,u);)v.tL(E[J]),J++}static Shj(y){if(!y)return 0;if(void 0===y._scaleStep||null===y._scaleStep){let A=0;-1!==y.className.indexOf("cui-tts-scale1")?A=1:-1!==y.className.indexOf("cui-tts-scale2")&&(A=2);y._scaleStep=A}return parseInt(y._scaleStep)}static $Vc(y){let A=
v.Shj(y);2>A&&v.cqh(y,++A)}static cqh(y,A){y&&(y.className=v.x3k[A],y._scaleStep=A)}static DR(y,A,E){return y&&A?B.a.hpg(B.a.$h(y),B.a.$h(A),E):!1}static FHb(y,A,E){let u=0;y&&A&&(u=B.a.Cne(B.a.$h(y),B.a.$h(A),E));return u}static UWd(y){for(let A=0;y&&A<y.childNodes.length;A++)if(-1!==y.childNodes[A].className.indexOf("cui-cg"))return!0;return!1}static a7d(y){let A=null;for(let E=y.childNodes.length-1;y&&0<=E;E--){const u=y.childNodes[E];if(-1===u.className.indexOf("cui-cg"))break;A=u}return A}static LOb(y,
A,E){if(y&&!v.en(y)){var u=m.a.Vt(y);u=z.a.uM(u.paddingLeft)+z.a.uM(u.paddingRight);E=y.offsetWidth-E-u;let J=0;for(;A&&A!==y;)(u=m.a.Vt(A))&&(J+=z.a.uM(u.paddingLeft)+z.a.uM(u.paddingRight)),A=A.parentNode;E=Math.max(E,75+J);y.style.width=E+"px"}}static T0k(y,A,E){if(y&&A){let u=0,J=0;({left:u,top:J}=B.a.l1f(A,u,J));v.Lmk(y,E?u-y.offsetWidth:u+A.offsetWidth)}}static qSi(y,A,E,u,J,G,S,P,Q,D,O,X,N,aa,V,ca,fa,ma,da,qa,F,sa){F&&v.K5k(X,N,aa,V,ca,fa,ma,da,sa);v.UWd(N)?v.T5k(N,y,A,E,u,J,G,S,P,Q,D,O,qa,
sa):v.S5k(y,A,E,u,J,G,S,P,Q,D,O,qa,sa)}static S5k(y,A,E,u,J,G,S,P,Q,D,O,X,N){const aa=!!J,V=!!S,ca=!!P;let fa=0;if((V||ca)&&0<(fa=v.FHb(y,A,N))){let ma=V;ca&&(!V||P.offsetWidth>S.offsetWidth)&&(ma=!1);v.LOb(ma?S:P,ma?S:P,ma?fa:2*fa);V&&ca&&0<(fa=v.FHb(y,A,N))&&v.LOb(ma?S:P,ma?S:P,ma?fa:2*fa)}if(V&&v.DR(S,A,N)||aa&&v.DR(J,A,N))v.tL(u),v.tL(J),v.tL(G),v.tL(S),ca&&(v.k4e(A),v.k4e(P));v.ahh(A,E,P,Q,D,O,X,N);ca&&v.CDf(P,y,E,N)}static T5k(y,A,E,u,J,G,S,P,Q,D,O,X,N,aa){const V=!!P,ca=!!Q,fa=!!D,ma=!!N,da=
v.a7d(y);0<(A=v.FHb(A,da,aa))&&(V&&v.LOb(P,P,A),!V||v.DR(P,da,aa))&&(v.tL(J),v.tL(G),v.tL(S),v.tL(P));v.DR(y,E,aa)&&v.T0k(E,y,aa);v.ahh(E,u,Q,D,O,X,N,aa);0<(A=v.FHb(y,u,aa))&&(v.LOb(O,X,A),ma&&v.DR(y,u,aa)&&v.tL(N),fa&&v.DR(y,u,aa)&&v.tL(D));ca&&!v.en(E)&&v.CDf(Q,y,u,aa)}static ahh(y,A,E,u,J,G,S,P){const Q=!!E,D=!!u,O=!!J,X=!!S;let N=0;if((Q||O)&&0<(N=v.FHb(y,A,P))){const aa=!!y&&"absolute"!==y.style.position;let V=Q;O&&(!Q||J.offsetWidth>E.offsetWidth)&&(V=!1);v.LOb(V?E:J,V?E:G,V&&aa?2*N:N);Q&&O?
(0<(N=v.FHb(y,J,P))&&(V=!V,v.LOb(V?E:J,V?E:G,V&&aa?2*N:N)),v.DR(y,J,P)&&v.tL(y)):Q&&v.DR(y,A,P)&&v.tL(y)}X&&v.DR(y,A,P)&&v.tL(S);D&&v.DR(y,A,P)&&v.tL(u)}static en(y){if(!y)return!0;y=y._isHidden;return!(void 0===y||null===y||"0"===y)}static tL(y){y&&!v.en(y)&&(y.style.display="none",y._isHidden="1")}static Ekl(y){y&&v.en(y)&&(y.style.display="",y._isHidden="0")}static k4e(y){y&&(y.style.width="auto",y.style.maxWidth="none")}static Lmk(y,A){y&&(y.style.position="absolute",y.style.left=A+"px")}static Vkh(y){y&&
(y.style.position="static",y.style.left="auto")}static CDf(y,A,E,u){if(y&&y.parentNode&&y.parentNode.parentNode){var J=v.oEk(y);"auto"!==y.parentNode.style.width&&(y.style.width=y.parentNode.offsetWidth-J+"px");var G=u?E:A;A=u?A:E;E=B.a.$h(y.parentNode.parentNode);G=G?B.a.$h(G):new Sys.UI.Bounds(E.x,0,0,0);A=A?B.a.A9a(A):new Sys.UI.Point(E.x+E.width,0);"absolute"===y.parentNode.style.position?J=A.x-(G.x+G.width)-J-1:(E=B.a.$h(y.nextSibling?y.parentNode:y),E=E.x+E.width/2,J=2*Math.min(E-(G.x+G.width),
A.x-E)-J-1);y.style.maxWidth=J+"px"}}static oEk(y){var A=m.a.Vt(y);A=A?z.a.uM(A.paddingLeft)+z.a.uM(A.paddingRight):0;var E=m.a.Vt(y.parentNode);E=E?z.a.uM(E.paddingLeft)+z.a.uM(E.paddingRight):0;let u=0;for(;y.nextSibling;)y=y.nextSibling,u+=y.offsetWidth;return A+E+u}static mMj(y){return!!y.id&&(y.id.startsWith(h.CuiHelper.dXe)||y.id.startsWith(h.CuiHelper.Mld))}}v.x3k=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(I.a)(v,"RibbonTabScalingActor",null,[])},671:function(I,Y,d){d.d(Y,"a",function(){return y});
I=d(0);var h=d(387),e=d(14),n=d(27),m=d(142),z=d(57),B=d(181),v=d(130);class y{constructor(){this.F2=null;this.xof=!0}Rtd(){try{this.F2||(this.F2=z.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.xof=!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!0))}catch(A){h.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+A)}}cae(A,E,u){return this.F2?this.F2.getToken(A,
E,u):new Promise(J=>{z.a.instance.Ja("Common.App.SearchCommon.ISearchOAuthManager").execute(G=>{G?(this.F2=G,this.F2.getToken(A,E,u).then(S=>J(S))):J(null)})})}icj(){this.Rtd();return this.F2?this.F2.getToken("Search",n.AFrameworkApplication.Koe,!1):null}p7f(){if("Dev Box"===n.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},
750)});this.Rtd();return this.F2?this.F2.getToken("Search",n.AFrameworkApplication.U_e,!0):null}Rlj(){this.Rtd();return this.F2?this.F2.getToken("Search",this.Olj(),this.xof):null}Olj(){return n.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch")}xjj(){if("Dev Box"===n.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(A=>{window.setTimeout(()=>{A(window.TellMeSubstrateTokenOverride)},
750)});this.Rtd();return this.F2?this.F2.getToken("SmartLookup",this.wjj()):null}wjj(){return n.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint")}jcj(){return Object(e.a)(this,this.icj,"getLokiTokenPromise")}Zkj(){return Object(e.a)(this,this.p7f,"getSubstrateTokenPromise")}DMb(){return!!n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.DMb}Dmj(){const A={};this.DMb()&&(A.Loki=this.jcj(),A.Substrate=this.Zkj());return A}rbc(A){m.a.MKa(Object.assign(new B.a,{name:"Events",dataFields:[Object.assign(new v.a,
{name:"Event",string:"StringsLoaded"}),Object.assign(new v.a,{name:"Status",bool:A})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}z0j(){return n.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.rbc(!1);return!1}).then(()=>{this.rbc(!0);return!0}):new Promise((A,E)=>{const u=z.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Sw;u?u.loadScript("tellme-strings").then(()=>{this.rbc(!0);A(!0)}).catch(()=>{this.rbc(!1);
E(!1)}):(this.rbc(!1),E(!1))})}static LTj(){return!!n.AFrameworkApplication.Aa&&(n.AFrameworkApplication.Aa.hb.gac||n.AFrameworkApplication.Aa.hb.hAb)}static O_c(){return!!n.AFrameworkApplication.Aa&&n.AFrameworkApplication.Aa.hb.hAb}}Object(I.a)(y,"ReactSharedHeaderSearchUtils",null,[])},672:function(I,Y,d){d.d(Y,"a",function(){return y});I=d(0);var h=d(387),e=d(47),n=d(937),m=d(29),z=d(44),B=d(76),v=d(33);class y{constructor(A=2E3){this.kOa=A}yLj(){const A=y.IW();return this.RWj(A)}RWj(A){return 0<
this.cUc(A).mentionLength}getSelectedText(){const A=y.IW();return this.cUc(A)}cUc(A){return this.qij(A)}qij(A){var E=null;A&&A.Cca&&z.SelectionEditor.Tg(A.Ua)&&z.SelectionEditor.eAb(A.Ua)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),E=z.SelectionEditor.WRa(A.Ua,!1));E&&(A=E);if(!A)return Object.assign(new n.a,{neighborhood:"",mentionStart:0,mentionLength:0});const u=new Sys.StringBuilder;let J=E=0;const G=[],S=A.length;for(let Q=0;Q<S;Q++){const D=A.ga(Q);
if(!v.ParagraphReader.$d(D.node)||Array.contains(G,D.node.iMa))continue;G.push(D.node.iMa);let O=v.ParagraphReader.text(D.node),X=0;var P=v.ParagraphReader.wta(D.node,!0,!0,!0);let N=v.ParagraphReader.wta(D.node,!1,!0,!0),aa=0;for(;O.length<this.kOa&&(P||N);){if(!(aa%2)&&P){const V=v.ParagraphReader.text(P);O=V+" "+O;X+=V.length+1;P=v.ParagraphReader.wta(P,!0,!0,!0)}1===aa%2&&N&&(O=O+" "+v.ParagraphReader.text(N),N=v.ParagraphReader.wta(N,!1,!0,!0));aa++}P=Q===S-1;Q||-1===D.Qa||(E=D.Qa);J+=P&&-1!==
D.Mb?D.Mb:O.length;u.append(O);E+=X;J+=X;P||(u.append(" "),J++)}for(A=B.AParagraphNode.gld(u.toString()," ");E<J&&e.a.fz(A.charCodeAt(E));)E++;for(;J>E&&e.a.fz(A.charCodeAt(J-1));)J--;return this.pci(A,E,J)}pci(A,E,u){if(A.length>this.kOa){var J=u-E;if(J>this.kOa)A=A.substr(E,this.kOa),u=this.kOa,E=0;else{J=Math.max(E-Math.floor((this.kOa-J)/2),0);let G;G=Math.min(J+this.kOa,A.length);J=Math.max(G-this.kOa,0);E-=J;u-=J;A=A.substring(J,G)}}return Object.assign(new n.a,{neighborhood:A,mentionStart:E,
mentionLength:u-E})}static IW(){var A=m.App.Kb.Kd.Dn;if(!A)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;A=A.Lb;return A&&A.Na&&A.Na.length?A.Na.mb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(I.a)(y,"Box4InsightsSelection",null,[852,853])},673:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(I.a)(h,"NewOutlineElementInfo",null,[])},
674:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.Rdd="Listening";h.MGb="Warning";h.RYa="Error";Object(I.a)(h,"VoiceNotificationResourceStrings",null,[])},675:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.CoachButton="coachButton";h.MicButton="micButton";h.PrevButton="prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton="exitButton";
Object(I.a)(h,"SlideshowToolbarButtonIDs",null,[])},676:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(h||(h={}));Object(I.b)("SupportStatus",h)},677:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(443);class h extends d.a{constructor(e){super();
this.shapeNode=e}get qkg(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}Object(I.a)(h,"InternalClipboardShape",d.a,[])},678:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(956);class h extends d.a{constructor(e,n,m){super(e,n);this.Lwh=m}}Object(I.a)(h,"ClipServiceSlideCopyParams",d.a,[])},679:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(43);class e{constructor(n,m){this.vfb=!1;
this.jAd=this.Wof=-1;this.Uw=n;m&&this.start()}start(){this.vfb=!0;this.jAd=-1;const n=h.a.$Y();n&&(this.Wof=n)}stop(){this.vfb=!1;const n=h.a.$Y();n&&0<this.Laa&&n>=this.Laa&&(this.jAd=n-this.Laa)}get operation(){return this.Uw}get WNc(){return this.jAd}get Laa(){return this.Wof}}Object(I.a)(e,"PPTStopwatch",null,[])},680:function(I,Y,d){d.d(Y,"a",function(){return B});I=d(0);var h=d(1208),e=d(40),n=d(39),m=d(63),z=d(43);class B{static ULc(v,y,A,E,u,J,G,S,P,Q,D,O,X,N,aa){J=O.YQa(!1,v.cid,v.sid,0,
y.shapeType,J,G,S,P,Q+1);J.setValue(n.a.RK,y.mga);({Msh:E,Esh:N}=u.r6f(E,y,A,aa,X,N));X=X.Ld;J.setValue(e.a.rx,X.rf(aa.DM(E,A),0));J.setValue(e.a.HC,X.rf(aa.DM(N,A),1));J.setValue(n.a.RPb,J.rx);J.setValue(n.a.Zxb,J.HC);J.setValue(n.a.Ald,!0);J.Sca=h.a.FJa(E,0);J.Rca=h.a.FJa(N,1);J.setValue(n.a.BRa,0);J.setValue(n.a.CRa,0);J.setValue(n.a.QUa,!0);J.setValue(n.a.isResizable,!0);J.setValue(n.a.CL,!0);J.YN=!0;J.KUa=!0;aa=(X=95===y.mga||97===y.mga)||Array.contains(B.Gne,y.mga);J.CL=!X;J.isResizable=!0;
J.setValue(n.a.az,X);J.setValue(n.a.L_,95===y.mga);J.pG=m.a.UE(v.sid,v.cid);J.Dkb=J.get_shapeId();J.setValue(n.a.gua,!0);v=u.tJf(E,N,A);J.OU=v;(D.EL(J)||D.Vka(J))&&z.a.Ib&&(z.a.Ib.Nj=!0);aa?u.tqh(J):u.Eqh(J);return J}}B.Gne=[88,93,94,89,90,91,92];Object(I.a)(B,"InsertContentShapeNodeFactory",null,[])},681:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n,m,z){this.mga=e;this.shapeType=n;this.height=m;this.width=z}}Object(I.a)(h,"AutoShapeProps",null,[])},682:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(){super()}}Object(I.a)(h,"SlidesChangedArgs",Sys.EventArgs,[])},683:function(I,Y,d){d.d(Y,"a",function(){return e});d.d(Y,"b",function(){return n});var h=d(47);const e=m=>{m=btoa(m);m=m.replace(RegExp("\\+","g"),"-");m=m.replace(RegExp("\\/","g"),"_");return m=m.replace(RegExp("\\=+$","g"),"")},n=m=>{if(h.a.Wa(m))return null;const z=RegExp("%([0-9A-F]{2})","g");m=encodeURIComponent(m);let B="",v=0,y;for(;y=z.exec(m);){const A=
z.lastIndex-3;A>v&&(B+=m.substring(v,A));B+=h.a.fromCharCode(parseInt(String("0x"+y[1])));v=z.lastIndex}v<m.length&&(B+=m.substring(v,m.length));return btoa(B)}},684:function(I,Y,d){d.d(Y,"a",function(){return v});I=d(0);var h=d(27),e=d(176),n=d(93),m=d(14);Y=d(18);var z=d(28),B=d(68);class v{constructor(y,A,E,u,J,G,S,P,Q,D,O,X,N,aa){this.n5=this.Kl=this.Bx=null;this.QCf=!0;this.KWa=y;this.yik=A;this.Q8j=E;this.zdc=u;this.T4=G;this.fc=S;this.Rd=P;this.Qf=Q;this.mik=D;this.beb=O;this.tbk=X;this.sbk=
N;this.rbk=aa;this.gJ=J}openDialog(){this.ADi();h.AFrameworkApplication.Aa.Ihb();try{this.Kl.click()}catch(y){const A=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",y.message,y.stack);z.a.J(509727820,818,10,A);throw y;}}submit(){const y=this.Kl.files[0];this.n5=this.Q8j();this.n5.EGe&&this.n5.EGe(this.T4,this.fc,this.Rd,this.Qf);if(this.mik)this.FGl(y);else{const A=new FormData;for(let u of this.n5.YPd)A.append(u.key,u.value);A.append("fileInputId",y,y.name);const E=
new XMLHttpRequest;E.onreadystatechange=()=>{this.wHb(E)};E.open("POST",this.n5.iah);E.send(A)}}wHb(y){if(4===y.readyState){const A=y.status;if(!A||A>=e.a.Uv&&A<e.a.rhi){if(this.n5.onSuccess)this.n5.onSuccess(y.responseText,this.T4,this.fc,this.Rd,this.Qf,this.Kl)}else this.n5.xz&&this.n5.xz(y.responseText,this.T4,this.fc,this.Rd,this.Qf);this.dispose()}}FGl(y){this.beb().E1(this.zdc,this.gJ,y.size,y,this.n5.YPd.ga("MediaToken"),this.Qf,this.tbk,this.sbk,this.rbk,A=>{if(this.n5.onSuccess)this.n5.onSuccess(A.result,
this.T4,this.fc,this.Rd,this.Qf,this.Kl)},A=>{this.n5.xz&&this.n5.xz(A.error.Code.toString(),this.T4,this.fc,this.Rd,this.Qf)})}dispose(){this.Bx&&(n.a.removeHandler(this.Kl,"change",Object(m.a)(this,this.CPc,"fileInputChange")),document.body.removeChild(this.Bx),this.Kl=this.Bx=null,v.o5e.remove(this))}ADi(){this.Bx||(this.Bx=document.createElement("form"),this.Bx.id="uploadFormId",this.Bx.style.visibility=B.a.hidden,this.Bx.method="post",this.Bx.encoding="multipart/form-data",this.Bx.action="",
this.Kl=document.createElement("input"),this.Kl.style.visibility=B.a.hidden,this.Kl.type="file",this.Kl.id="uploadFileInputId",this.Kl.name="uploadFileInputId",this.Kl.accept=this.KWa,this.Bx.appendChild(this.Kl),document.body.appendChild(this.Bx),n.a.addHandler(this.Kl,"change",Object(m.a)(this,this.CPc,"fileInputChange")))}CPc(){this.Kl.value&&this.Kl.value.length?(this.QCf=!1,this.yik(this.Kl,this.Rd,this.Qf,this.zdc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static fZe(y,
A,E,u,J,G,S,P,Q,D,O,X,N,aa){for(let V of v.o5e)V.QCf&&V.dispose();y=new v(y,A,E,u,J,G,S,P,Q,D,O,X,N,aa);v.o5e.add(y);y.openDialog()}}v.o5e=new Y.a;Object(I.a)(v,"UploadFileDialog",null,[])},703:function(I,Y,d){d.r(Y);I=d(0);var h=d(387),e=d(192),n=d(931),m=d(1097),z=d(27),B=d(1096),v=d(14),y=d(1199),A=d(1200),E=d(29),u=d(465);class J extends u.a{constructor(Ca,ha,Ba,va,ta,Fa){super();this.init(Ca);this.Pl("DummyClipboardOperation");this.OEa(z.AFrameworkApplication.Ta,ha,va,ta,Fa);this.Ft=Ba;this.Dp=
8;this.GY()}run(){this.QNa=!0;this.Ejb(this.Ft);this.Qna();this.Dp=32}}Object(I.a)(J,"DummyClipboardOperation",u.a,[]);var G=d(97),S=d(128),P=d(119),Q=d(61);class D{constructor(Ca,ha,Ba){h.ULS.shipAssertTag(6305502,307,!!Ca);this.properties=Ca;this.ld=ha;this.Nqa=Ba}get Wc(){return this.ld}O4f(){return this.properties.sa(Q.a.FU,"")}hbh(){return!0}HDh(){let Ca,ha=!1;Ca=null;const Ba=this.O4f();if(this.Nqa||""!==Ba)try{({e8a:Ca,returnValue:ha}=this.u3e(Ba))}catch(va){h.ULS.shipAssertTag(4203138,307,
!1),this.Wc.Xb(S.a.Lja,{["Reason"]:P.a.Xzf}),G.a.rCa(Ca)}else h.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Wc.Xb(S.a.N1,{["Reason"]:P.a.g2d});return{returnValue:ha,QKc:Ca}}}Object(I.a)(D,"AStringInputImportStrategy",null,[517]);class O extends D{constructor(Ca,ha,Ba,va,ta){super(Ca,ha,ta);this.ik=Ba;this.FKd=va}u3e(Ca){const {ClipboardActor:ha}=d(703);let Ba;if(this.Nqa&&!Ca)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,
e8a:null};Ba=null;if(this.Nqa)return Ba=this.ik.qZa(Ca),{returnValue:!0,e8a:Ba};if(this.FKd){const va=this.properties.sa(Q.a.dKe,"");va&&(Ba=this.ik.qZa(va))}Ba||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),Ba=ha.B9g,Ba.innerHTML=Ca);return{returnValue:!0,e8a:Ba}}}Object(I.a)(O,"HtmlStringImportStrategy",D,[]);var X=d(47);class N extends D{constructor(Ca,ha,Ba){super(Ca,ha,Ba)}u3e(Ca){let ha;if(this.Nqa&&!Ca)return h.ULS.sendTraceTag(541172642,
307,10,"No htmlDomContent"),{returnValue:!1,e8a:null};ha=document.createElement("div");Ca=Ca.split(RegExp("\r\n|\r|\n"));for(var Ba=0;Ba<Ca.length-1;Ba++){const va=document.createElement("p");va.innerText=this.Jne(Ca[Ba]);ha.appendChild(va)}Ba=document.createElement("span");Ba.innerText=X.a.b1d(Ca[Ca.length-1]);ha.appendChild(Ba);return{returnValue:!0,e8a:ha}}Jne(Ca){return X.a.b1d(Ca.length?Ca:" ")}}Object(I.a)(N,"MultiLineTextImportStrategy",D,[]);class aa extends N{constructor(Ca,ha,Ba){super(Ca,
ha,Ba)}O4f(){return this.properties.sa(Q.a.mhb,"")}Jne(Ca){Ca=super.Jne(Ca);return Ca.length&&" "!==Ca?Ca:"\u00a0"}}Object(I.a)(aa,"MultiLinePlainTextImportStrategy",N,[]);class V extends D{constructor(Ca,ha,Ba){super(Ca,ha,Ba)}u3e(Ca){var {ClipboardActor:ha}=d(703);if(this.Nqa&&!Ca)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,e8a:null};ha=ha.B9g;ha.innerText=Ca;return{returnValue:!0,e8a:ha}}}Object(I.a)(V,"PlainTextImportStrategy",D,[]);var ca=d(388);class fa{constructor(Ca){this.fg=
this.cle=!1;this.DZ=Ca}hbh(){this.cle||(this.cle=!0,this.fg=!1,this.DZ.prepareForPaste(()=>{this.fg=!0}));return this.fg}HDh(){let Ca;this.cle=!1;Ca=this.DZ.paste();return Ca?Ca.hasChildNodes()?{returnValue:!0,QKc:Ca}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),fa.Wc.Xb(S.a.N1,{["Reason"]:P.a.g2d}),{returnValue:!1,QKc:Ca}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),fa.Wc.Xb(S.a.I8a,{["Reason"]:P.a.A0e}),{returnValue:!1,QKc:Ca})}static get Wc(){return ca.a.instance}}
Object(I.a)(fa,"SystemClipboardImportStrategy",null,[517]);var ma=d(64),da=d(38),qa=d(51),F=d(41),sa=d(34),ia=d(259);d.d(Y,"ClipboardActor",function(){return Na});class Na{constructor(Ca,ha,Ba,va,ta,Fa,pa,ka){this.A8e=null;this.lUb=0;this.DOh=Ca;this.DZ=ha;this.ld=Ba;this.ik=va;this.Tc=ta;this.Ca=Fa;this.Xs=pa;this.dgf=!!ka&&ka.ka("SupportImageDragDropExternalIsEnabled");this.RKd=!!ka&&ka.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.eN=new ia.a;this.eN.$(sa.a.paste,257);this.eN.$(sa.a.L5,
8449);this.eN.$(sa.a.Z7,1);this.eN.$(sa.a.vfg,513);this.eN.$(sa.a.reformatPastedContent,4097);this.eN.$(sa.a.e_a,12289);this.eN.$(sa.a.mhd,7);this.eN.$(sa.a.lhd,1);this.eN.$(sa.a.v9g,8193);this.eN.$(sa.a.copy,272);this.eN.$(sa.a.hIc,16);this.eN.$(sa.a.cut,304);this.eN.$(sa.a.RZb,48);this.eN.$(sa.a.idd,64);this.eN.$(sa.a.jdd,64);this.eN.$(sa.a.showPlaceholderGlossary,65536);this.dgf&&this.eN.$(sa.a.ZPf,1)}get PFf(){return this.DOh.value}get EA(){return this.DZ}wb(){this.Ca.ra(sa.a.fMk,F.a.application,
Object(v.a)(this,this.ojd,"queryPasteOptions"),97);this.Ca.ra(sa.a.gMk,F.a.application,Object(v.a)(this,this.ojd,"queryPasteOptions"),97);this.RKd?this.Ca.ra(sa.a.pdh,F.a.application,Object(v.a)(this,this.YNe,"queryReformatPasteOptions"),97):this.Ca.ra(sa.a.qdh,F.a.application,Object(v.a)(this,this.YNe,"queryReformatPasteOptions"),97);this.Ca.ra(sa.a.rdh,F.a.application,Object(v.a)(this,this.YNe,"queryReformatPasteOptions"),97);this.Ca.XV(sa.a.RZb,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),
1028);this.Ca.XV(sa.a.cut,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.MBa(sa.a.hIc,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"));this.Ca.MBa(sa.a.copy,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"));this.dgf&&this.Ca.XV(sa.a.ZPf,F.a.view,Object(v.a)(this,this.gPi,"dropBrowserContent"),1028);this.Ca.XV(sa.a.Z7,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.paste,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.L5,
F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.v9g,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.lhd,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.mhd,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.reformatPastedContent,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.XV(sa.a.e_a,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"),1028);this.Ca.ya(sa.a.Sld,F.a.view,
e.ActionManager.Mg);this.Ca.ya(sa.a.SDk,F.a.view,e.ActionManager.Mg);this.Ca.ya(sa.a.P9g,F.a.view,e.ActionManager.Mg);this.Ca.ya(sa.a.Q9g,F.a.view,e.ActionManager.Mg);this.Ca.ya(sa.a.R9g,F.a.view,e.ActionManager.Mg);this.Ca.ya(sa.a.O9g,F.a.view,e.ActionManager.Mg);this.Ca.MBa(sa.a.idd,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"));this.Ca.MBa(sa.a.jdd,F.a.view,Object(v.a)(this,this.jdd,"moveSelectedContentWithinCurrentParagraph"));this.Ca.MBa(sa.a.vfg,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"));
this.Ca.MBa(sa.a.showPlaceholderGlossary,F.a.view,Object(v.a)(this,this.oW,"clipboardAction"));this.Ca.ya(sa.a.BLf,F.a.view,e.ActionManager.Mg);this.Ca.ya(sa.a.cMf,F.a.view,e.ActionManager.Mg)}ojd(Ca,ha,Ba,va,ta){if(1===Ba)return 32;ta[n.a.On]=!1;return 32}gPi(Ca,ha,Ba,va,ta,Fa){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var pa=Fa.DataTransfer;Fa=pa.getData("text/html");pa=pa.getData("text/plain");let ka=!1;const Ha=new m.DictionaryPropertySet;0<Fa.length?(h.ULS.sendTraceTag(42530336,
307,50,"Drag and drop browser content with HTML"),Ha.setValue(Q.a.FU,Fa),ka=!0):0<pa.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ha.setValue(Q.a.mhb,pa),ka=!0);if(ka){const Ya=this.eN.ga(ha);return this.PFf.create(Ca,ha,Ya,new y.a(()=>this.XNf(Ya,Ha)),Ba,va,ta,Ha)}return null}YNe(Ca,ha,Ba,va,ta){if(ha=Object(A.a)(Object,ta))z.AFrameworkApplication.hk("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this.RKd&&
Ca===sa.a.qdh||this.RKd&&Ca===sa.a.pdh?(Ca=this.lUb!==sa.a.reformatPastedContent&&this.lUb!==sa.a.e_a,ha[n.a.On]=this.lUb===sa.a.reformatPastedContent||Ca):Ca===sa.a.rdh&&(ha[n.a.On]=this.lUb===sa.a.e_a);return 32}oW(Ca,ha,Ba,va,ta,Fa){if((z.AFrameworkApplication.yM||z.AFrameworkApplication.iG)&&!z.AFrameworkApplication.MRa||da.a.instance.ga(83))return new J(Ca,ha,Ba,va,ta,Fa);const pa=this.eN.ga(ha);1!==va&&pa&1&&(this.lUb=ha);1!==va&&Fa&&pa&1&&(this.A8e=Fa);1!==va&&!Fa&&pa&4096&&(Fa=this.A8e);return this.PFf.create(Ca,
ha,pa,new y.a(()=>this.XNf(pa,Fa)),Ba,va,ta,Fa)}jdd(Ca,ha,Ba,va,ta,Fa){Fa=qa.a.Lj(ma.a.instance.Na.mb.Ua.node,Fa);return this.oW(Ca,ha,Ba,va,ta,Fa)}XNf(Ca,ha){return Ca&256?new fa(this.EA):Ca&2?Ca&4096?new O(ha,this.ld,this.ik,E.App.instance.Q9b,E.App.instance.AMb):new V(ha,this.ld,E.App.instance.AMb):ha.Sa(Q.a.mhb)?new aa(ha,this.ld,E.App.instance.AMb):new O(ha,this.ld,this.ik,E.App.instance.Q9b,E.App.instance.AMb)}static get B9g(){return B.a.b$a("Box4PasteScratchPad")}}Object(I.a)(Na,"ClipboardActor",
null,[])},710:function(I,Y,d){I=d(0);var h=d(18),e=d(14),n=d(399),m=d(400);class z{constructor(u,J,G,S=0,P=0,Q=null,D=null){this.commandId=u;this.controlId=J;this.timeStamp=G;this.commandSurface=n.a[S];this.Hu=m.a[P];this.contentType=Q;this.usd=D}}Object(I.a)(z,"CommandActionInfo",null,[]);class B{constructor(){this.uMh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}gXj(u){return!this.uMh.exec(u)}}Object(I.a)(B,"EventsCacheLoggingUtils",null,[]);
var v=d(27),y=d(1120),A=d(757);d.d(Y,"a",function(){return E});class E{constructor(){this.bif=null;this.OFd=20;this.qyc=this.v2a=this.kRb=null}init(){this.bif=new B;this.kRb=new h.a;this.v2a=new h.a;this.qyc=new h.a;this.OFd=v.AFrameworkApplication.fa.Bc("MaxCommandClickedEventQueueSize",20);y.a.P9h(Object(e.a)(this,this.xvi,"commandClickEventRaised"));A.a.instance.buf(Object(e.a)(this,this.iRk,"recordActionEvent"))}U2e(u){u.count>this.OFd&&u.removeAt(this.OFd)}xvi(u,J){this.kRb.insert(0,new z(J.commandId,
J.controlId,J.time,J.commandSurface,J.Hu,J.contentType));this.U2e(this.kRb)}iRk(u,J){this.v2a.insert(0,new z(J.actionName,J.controlId,J.timeStamp,J.commandSurface,J.Hu,J.contentType,J.usd));this.U2e(this.v2a);this.bif.gXj(J.actionName)&&(this.qyc.insert(0,new z(J.actionName,J.controlId,J.timeStamp,J.commandSurface,J.Hu,J.contentType,J.usd)),this.U2e(this.qyc))}static get instance(){return E.Ka||(E.Ka=new E)}}E.Ka=null;Object(I.a)(E,"CommandClickEventsCache",null,[])},712:function(I,Y,d){d.r(Y);I=
d(0);var h=d(717),e=d(27),n=d(47),m=d(55),z=d(106),B=d(1201),v=d(1202),y=d(24),A=d(332);const E=(N,aa)=>{if(N){N=N.trim().toLowerCase();if("true"===N)return!0;if("false"===N)return!1}return aa};var u=d(729),J=d(28),G=d(955),S;(function(N){N[N.none=0]="none";N[N.internal=1]="internal";N[N.clipService=2]="clipService"})(S||(S={}));Object(I.b)("ClipboardIframeContent",S);var P=d(386),Q=d(677),D=d(444),O=d(49);d.d(Y,"ClipboardHelper",function(){return X});class X{constructor(N,aa,V,ca,fa,ma){this.m6j=
[A.a.sW,A.a.Gp,A.a.location,A.a.tD,A.a.type,A.a.$Fe,A.a.count,A.a.kFa,A.a.iFa,A.a.ekb,A.a.slideId,A.a.sessionId,A.a.timeStamp,A.a.zy];this.nAe=new h.a;this.Ize=new B.a(v.a.to());this.Jq=N;this.zug=aa;this.Cc=ma;if(V&&0<V.length){N=V.split(";");for(const da of N)N=this.e4f(da),0<N.length&&this.nAe.add(N)}this.n6j=ca;this.sxe=fa;if(this.r_c()){ca=e.AFrameworkApplication.fa.Ga("PicklingAPIMaxPackageSizeInMB").split(";");for(const da of ca)ca=da.split(":"),2===ca.length&&0<ca[0].length&&0<ca[1].length&&
this.Ize.add(ca[0],parseInt(ca[1]))}}Rvd(N,aa,V,ca,fa,ma,da){if(N.contentWindow&&N.contentWindow.document&&N.contentWindow.document.body){O.a.JJc(N);const F=O.a.Eca();var qa=document.createTextNode(O.a.yFe);F.appendChild(qa);qa=null;let sa=0;if(!aa)J.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",da),Sys.UI.DomElement.addCssClass(F,O.a.S0d);else if(aa.length&&aa[0]&&aa[0].g7a&&(Sys.UI.DomElement.addCssClass(F,this.Jq.Yq[0].g7a),
sa=1,V)){n.a.Wa(V.tD)&&J.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",V.Gp);sa=2;aa=u.a(V.dataType);F.setAttribute(A.a.sW,V.sW);F.setAttribute(A.a.NQa,V.NQa);F.setAttribute(A.a.Gp,V.Gp);F.setAttribute(A.a.version,V.version);F.setAttribute(A.a.location,V.location);F.setAttribute(A.a.tD,V.tD);F.setAttribute(A.a.type,aa);F.setAttribute(A.a.count,V.objectCount.toString());F.setAttribute(A.a.kFa,V.kFa);F.setAttribute(A.a.iFa,V.iFa);
F.setAttribute(A.a.zy,V.zy);const ia=(new Date).toUTCString();J.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",aa,V.kFa,ia);F.setAttribute(A.a.timeStamp,ia);if(1===V.dataType||2===V.dataType)aa=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ga("361"))+"?Id="+n.a.Ne(V.Gp)+"&DC="+n.a.Ne(V.tD)+"&pkey="+n.a.Ne(V.zy)+"&wdwaccluster="+n.a.Ne(V.tD)+"&DataType="+aa,F.setAttribute(A.a.Yti,aa);V.Cjc&&F.setAttribute(A.a.$Fe,
this.F8k(V.Cjc));1===V.dataType&&this.sxe&&(qa=O.a.RA(),qa.id=A.a.vdg,qa.setAttribute(A.a.RBj,"true"),V=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ga("361"))+"?Id="+n.a.Ne(V.Gp)+"&DC="+n.a.Ne(V.tD)+"&pkey="+n.a.Ne(V.zy)+"&wdwaccluster="+n.a.Ne(V.tD),qa.src=V)}F.setAttribute(A.a.sessionId,ca);F.setAttribute(A.a.ekb,fa?fa.join(","):"");ma?F.setAttribute(A.a.slideId,ma.cid.toString()+"+"+ma.sid.toString()):F.setAttribute(A.a.slideId,"");N.contentWindow.document.body.appendChild(F);
qa&&N.contentWindow.document.body.appendChild(qa);this.Cc.Zh(P.a.YAi,S[sa],da)}}FRj(N){var aa="";m.a.Tj?aa="Chromium":m.a.eg?aa="Firefox":m.a.L$b&&(aa="Safari");aa=this.Ize.Hb(aa)?this.Ize.ga(aa):0;(aa=Math.ceil(N)<=aa)||J.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",m.a.Sy,N);return aa}tMj(N){return N&&Sys.UI.DomElement.containsCssClass(N,O.a.S0d)?!0:!1}wMj(N){return!!N&&!!N.getAttribute&&E(N.getAttribute(A.a.iFa),!1)}VWj(N){return!!N&&!!N.un&&!!N.un.firstChild&&
!!N.un.firstChild.className&&this.WWj(N.un.firstChild.className)}WWj(N){return!!N&&N.startsWith("CID")&&z.a.isValid(N.substring(3,N.length))}MWj(N){return!!N&&!!N.Gp&&!!N.tD&&0!==N.dataType&&0<N.objectCount&&!!N.zy}fil(N){if(!this.HIj(N))return J.a.J(512329174,307,50,"DC '{0}' is not allowed",N.tD),!1;if(N.Msa&&"TimeStamp"in N.Msa){var aa=new Date(Date.parse(N.Msa.TimeStamp));N=60*this.n6j-5;aa=X.lCf(aa);if(aa>=N)return J.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",
N,aa),!1}return!0}e4f(N){return N?N.trim().toUpperCase():""}HIj(N){return!this.bje(N)||this.nAe.contains(this.e4f(N.tD))||this.nAe.contains("ALL")}Ggg(N){return!!N&&!!N.QW&&!!N.QW.length&&!!N.QW[0]}Hgg(N){return this.Ggg(N)&&Object(y.a)(D.a,N.QW[0])}AJj(N){return this.Ggg(N)&&Object(y.a)(Q.a,N.QW[0])}Bie(N){return!!N&&!!N.Bu&&this.fil(N.Bu)}zJj(N){return this.Bie(N)&&1===N.Bu.dataType}yJj(N){return this.Bie(N)&&2===N.Bu.dataType}xJj(N){return this.Bie(N)&&3===N.Bu.dataType}BJj(N){return!!N&&!!N.wM}CJj(N){return this.BJj(N)&&
1===N.wM.contentType}r_c(){return!(m.a.mx||m.a.L$b)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}fui(N,aa){if(N&&aa&&N.getAttribute)for(const V of this.m6j){const ca=N.getAttribute(V);ca&&aa.setAttribute(V,ca)}}bje(N){if(N.tD!==this.zug)return J.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",u.a(N.dataType),N.tD,this.zug,N.Gp)),!0;J.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",
u.a(N.dataType),N.tD,N.Gp));return!1}BUi(N,aa){var V=N.getAttribute(A.a.Gp),ca=parseInt(N.getAttribute(A.a.version)),fa=N.getAttribute(A.a.zy),ma=parseInt(N.getAttribute(A.a.sW)),da=parseInt(N.getAttribute(A.a.NQa)),qa=N.getAttribute(A.a.type);qa=qa?u.b(qa):2;var F=Object,sa=F.assign,ia=new G.a;ma=isNaN(ma)?32:ma;da=isNaN(da)?0:da;ca=isNaN(ca)?0:ca;var Na=N.getAttribute(A.a.location),Ca=N.getAttribute(A.a.tD),ha=N.getAttribute(A.a.count);ha=parseInt(ha);V=sa.call(F,ia,{sW:ma,NQa:da,Gp:V,version:ca,
location:Na,tD:Ca,dataType:qa,objectCount:isNaN(ha)?-1:ha,kFa:E(N.getAttribute(A.a.kFa),!1),iFa:E(N.getAttribute(A.a.iFa),!1),zy:fa});fa=X.IUi(N);qa=X.MUi(N);V.Msa={["SessionId"]:fa,["TimeStamp"]:qa?qa.toUTCString():""};aa=X.QSd(V,qa,this.Cc,aa);J.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",aa);if(N=N.getAttribute(A.a.$Fe))V.Cjc=this.gLi(N);return V}F8k(N){return JSON.stringify(N)}gLi(N){try{return JSON.parse(N)}catch(aa){return J.a.J(512329169,826,15,"{0} when parse json string: {1}",
aa.toString(),N),null}}static Ygg(N){return N&&N.Msa&&"SessionId"in N.Msa?X.Slg(N.Msa.SessionId.toString()):!1}static Slg(N){return n.a.Wa(N)||n.a.Wa(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===N.toLowerCase()}static QSd(N,aa,V,ca){const fa=u.a(N.dataType);N=String.format("A {0} ClipServiceObject was just created: '{1}'",fa,N);aa&&(aa=X.lCf(aa),N+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",aa),V.Zh("CopyPasteElapsedSec",
aa.toString(),ca));return N}static IUi(N){N=N.getAttribute(A.a.sessionId);return void 0===N||null===N?"":N}static MUi(N){N=N.getAttribute(A.a.timeStamp);return void 0===N||null===N?null:new Date(Date.parse(N))}static lCf(N){var aa=new Date;if(!N)throw Error.argumentNull("fromTime");if(!aa)throw Error.argumentNull("toTime");return(aa.getTime()-N.getTime())/1E3}}Object(I.a)(X,"ClipboardHelper",null,[1161])},722:function(I,Y,d){I=d(0);class h{}Object(I.a)(h,"AuthContext",null,[]);var e=d(27),n=d(226);
d.d(Y,"a",function(){return m});class m{static getAuthContext(){const z=e.AFrameworkApplication.fa.Ga("UserPrincipalName")||"";let B=z;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(B=n.OAuthManagerSettings.Fpk||z);return Object.assign(new h,{upn:z,loginHint:B,authority:n.OAuthManagerSettings.authority,authorityType:m.qRc(),tenantId:e.AFrameworkApplication.fa.Ga("TenantId")||""})}static qRc(){let z=0;const B=m.JZf();"aad"===B.toLowerCase()?
z=2:"msa"===B.toLowerCase()&&(z=1);return z}static JZf(){return e.AFrameworkApplication.fa.Ga("HostAuthType")||""}}Object(I.a)(m,"OAuthIdentity",null,[])},726:function(I,Y,d){I=d(0);var h=d(14),e=d(27),n=d(80),m=d(55),z=d(47),B=d(106);class v{constructor(G,S){this.message=G;this.Xi=S}}Object(I.a)(v,"CrossDocumentEventArgs",null,[]);var y=d(528),A=d(175),E=d(573),u=d(920);d.d(Y,"a",function(){return J});class J{constructor(G,S,P,Q){this._name="";this.HMa={};this.Eif=null;this.WVb=[];this.JSb=[];this.KSb=
[];this.jVb=[];this.Apf=G;this.zpf=S;this.m7={};this.yba={};this.TUb=P;J._id++;Q&&Q();this.zG=this.enable()}get KLa(){return this.zpf}get LAh(){return this.Apf}enable(){if(!E.a())return u.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.iHj();u.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.zG}iHj(){u.a.debugAssertTag(5018253,!!this.TUb,null);this.Eif=Object(h.a)(this,this.Vlk,"messageListener");this.TUb.ugi(this.Eif)}disable(){this.zG=!1;this.WVb=[];this.JSb=
[];this.KSb=[];this.jVb=[];this.Apf=null;this.zpf="";this.TUb.CLi();this.m7={};this.yba={}}dispose(){this.disable()}vke(G){return!!this.WVb&&Array.contains(this.WVb,G)||this.$jg(G)}$jg(G){return!!this.JSb&&Array.contains(this.JSb,G)}wu(G){u.a.debugAssertTag(5018259,!!this.WVb,null);Array.add(this.WVb,G);u.a.sendTraceTag(5018260,2,"Allow receiving : {0}",G)}Qrf(G){u.a.debugAssertTag(5018261,!!this.JSb,null);Array.add(this.JSb,G);u.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",G)}OPj(G){return!!this.KSb&&
Array.contains(this.KSb,G)}Rrf(G){u.a.debugAssertTag(5018263,!!this.KSb,null);Array.add(this.KSb,G);u.a.sendTraceTag(5018264,2,"Allow free sending: {0}",G)}k$b(G){G=n.a.sQ(G);return!!G&&!!this.jVb&&Array.contains(this.jVb,G)}LBa(G){u.a.debugAssertTag(5018265,!!this.jVb,null);if(G===J.aZb)return u.a.debugAssertTag(5018266,!1,null),!1;let S=n.a.sQ(G);if(!S)return u.a.sendTraceTag(5018267,4,"Get origin fail:{0}",G),!1;e.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&
(S=z.a.qg(S));Array.add(this.jVb,S);u.a.sendTraceTag(5018268,2,"Add origin:{0}",S);return!0}send(G,S=null){let P=this.KLa;if(S){S=n.a.sQ(S);if(!S)return!1;P=S}return this.vjb(G,this.LAh,P)}sendMessage(G,S,P=""){P=P&&""!==P?P:B.a.create().toString();return this.send(this.xJe(G,S,P,e.AFrameworkApplication.userSessionId))}postMessage(G){const S=B.a.create().toString();if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!G.shouldRetry)return this.send(this.xJe(G.messageId,G.values,S,
G.userSessionId));if(!this.m7[G.xFc]){this.wu(G.xFc);const P=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.HB(G.xFc,P)}this.HMa[S]="";return this.mah(G,S,1)}mah(G,S,P){if(""!==S&&S in this.HMa&&"ACK_RECEIVED"===this.HMa[S])return delete this.HMa[S],!0;if(P>G.Swa)return u.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',G.xFc,S),delete this.HMa[S],!1;u.a.sendTraceTag(40716251,1<P?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',
G.Swa-P,G.messageId,S);P++;window.setTimeout(()=>{this.mah(G,S,P)},G.P3h);G.values[A.a.O3h]=!0;return this.send(this.xJe(G.messageId,G.values,S,G.userSessionId))}ackMessageHandler(G){G=G.CorrelationId;""!==G&&G in this.HMa&&(u.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.HMa[G],G),this.HMa[G]="ACK_RECEIVED")}xJe(G,S,P,Q){G=new y.a(G);G.CorrelationId=P;S&&(G.Values=S);G.Values.wdUserSession=Q;return G}vjb(G,S,P){u.a.debugAssertTag(5018269,!!G,null);if(!this.zG)return!1;
u.a.debugAssertTag(5018270,!!S,null);u.a.debugAssertTag(5018271,!!P,null);if(!S||!P)return u.a.debugAssertTag(5018272,!1,null),!1;if(P===J.aZb&&!this.OPj(G.MessageId))return u.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:G.MessageId}),!1;G.SendTime=(new Date).getTime();let Q="";try{Q=Sys.Serialization.JavaScriptSerializer.serialize(G)}catch(D){return u.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:D.message}),!1}S=J.sendMessage(S,Q,P);u.a.sendTraceTag(5018275,2,
"Send {0}. {1}",S?"succeeded":"failed",{["id"]:G.MessageId,["origin"]:P});return S}HB(G,S){u.a.debugAssertTag(5018304,!!S,null);u.a.debugAssertTag(5018305,!!this.m7&&!!this.yba,null);this.zG&&(this.vke(G)?this.m7[G]!==S&&(u.a.debugAssertTag(5018307,!this.m7[G]&&!this.yba[G],null),this.m7[G]=S,delete this.yba[G]):u.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:G}))}g_a(G,S){u.a.debugAssertTag(40420062,!!S,null);u.a.debugAssertTag(40420063,!!this.yba&&!!this.m7,null);this.zG&&(this.vke(G)?
this.yba[G]!==S&&(u.a.debugAssertTag(40420065,!this.m7[G]&&!this.yba[G],null),this.yba[G]=S,delete this.m7[G]):u.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:G}))}qBl(G){this.zG&&(this.m7[G]&&delete this.m7[G],this.yba[G]&&delete this.yba[G])}Vlk(G){const S=this.Jcj(G);if(!S)return!1;if(this.m7[S.MessageId])return this.TUb.$Xc(this.m7[S.MessageId],S),!0;if(this.yba[S.MessageId]){let P=this.yba[S.MessageId];G=new v(S,G);this.TUb.SHj(P,G);return!0}return!1}Jcj(G){const S=new Date;this.G3j(G);
if(!G.origin||!G.source||void 0===G.data||null===G.data)return u.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const P=this.VXj(G.data);if(!P)return null;if(!this.k$b(G.origin)){if(!this.$jg(P.MessageId))return u.a.sendTraceTag(5018309,1,"{0}",{["id"]:P.MessageId}),null;if(!m.a.Uab&&G.source!==this.LAh)return u.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}u.a.debugAssertTag(5018311,!!P.Values,null);P.Values.m_Source=G.source;
P.Values.m_Origin=G.origin;P.Values.m_ReceivedTime=S.getTime();return P}VXj(G){if(!G)return null;let S=null;try{S=Sys.Serialization.JavaScriptSerializer.deserialize(G,!0)}catch(D){return 2>J.B$e&&(u.a.sendTraceTag(5018312,2,"Deser failed"),J.B$e++),null}if(!S)return u.a.debugAssertTag(5018313,!1,null),null;for(G=0;G<J.bMc.length;G++)if(!S[J.bMc[G]])return"MessageId"!==J.bMc[G]&&u.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",J.bMc[G]),null;if(S.Values)try{S.Values}catch(D){return u.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",D.message),null}else u.a.sendTraceTag(41502556,2,"No values in message");G=S.MessageId;if(!this.vke(G))return u.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:G}),null;const P=S.SendTime,Q=(new Date).getTime()-P;if(0>P)return u.a.sendTraceTag(520435660,2,"{0}",{["t"]:P,["id"]:G}),null;6E4<Q&&u.a.sendTraceTag(520435659,2,"{0}",{["t"]:P,["delta"]:Q,["id"]:G});-300>Q&&u.a.sendTraceTag(520435658,2,"{0}",{["t"]:P,["delta"]:Q,["id"]:G});G=new y.a;G.MessageId=S.MessageId;
G.SendTime=S.SendTime;G.CorrelationId=S.CorrelationId;S.Values&&(G.Values=S.Values);u.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",G.MessageId,G.SendTime,G.CorrelationId);return G}G3j(G){u.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:G.origin,["data"]:G.data,["source"]:G.source}))}static sendMessage(G,S,P){if(!E.a())return u.a.debugAssertTag(5018319,!1,null),!1;try{return G.postMessage(S,P),!0}catch(Q){u.a.sendTraceTag(5018320,
4,"{0}",{["exception"]:Q.message})}return!1}}J.bMc=["MessageId","SendTime"];J.aZb="*";J._id=0;J.B$e=0;Object(I.a)(J,"CrossDocumentMessenger",null,[106,469])},727:function(I,Y,d){d.r(Y);var h=d(278);I=d(0);var e=d(398),n=d(78),m=d(142),z=d(93),B=d(67),v=d(289),y=d(27),A=d(47),E=d(270),u=d(55),J=d(96),G=d(28),S=d(35),P=d(86),Q=d(949),D=d(941),O=d(939),X=d(942),N=d(943),aa=d(946),V=d(947),ca=d(944),fa=d(940),ma=d(948),da=d(945),qa=d(57);class F{createAuthProviderAsync(Ca){qa.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Zia();
return new Promise(ha=>{qa.a.instance.Ja("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(Ba=>{Ba=Ba.cCi(Ca);ha(Ba)})})}}Object(I.a)(F,"SlideShowAppForOfficeAuthFactory",null,[]);var sa=d(1003),ia=d(72);d.d(Y,"SlideShowCoreFrame",function(){return Na});class Na{constructor(Ca,ha,Ba,va,ta,Fa,pa,ka,Ha,Ya,Ka,Pa,Oa,oa){this.pn=this.Fgc=this.p9c=null;this.Oea=new e.a;this.va=new n.a;this.jDe="";this.vw=null;this.Vbd="";this.IBe=this.IAg=this.yhc=this.$Q=this.E$=this.D$=this.xva=this.K=null;this.Ahc=
!0;this.lXa=Date.now();this.jXa=Date.now();this.edb=this.kUg=0;this.YCb=!1;this.Psk=()=>{G.a.J(512309270,830,50,"SlideShowCoreFrame::OnEditHappened");this.jXa=Date.now()};this.Fuk=()=>{G.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.jXa=Date.now()};this.xwk=()=>{G.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.jXa=Date.now()};this.mf=Ca;this.la=ha;this.Hc=Ba;this.YBb=va;this.Ll=ta;this.Ub=Fa;this.iO=ka;this.du=pa;this.$Ce=Ha;this.qe=Ya;this.owg=
Ka;this.ai=Pa;this.FO=Oa;this.Ds=oa;this.rhk=m.a.getInstance();this.owg&&this.owg.execute(Xa=>{Xa.vGc(this.Psk)});this.ai&&(this.ai.q9h(this.Fuk),this.ai.lai(this.xwk));try{const Xa=this.c5=JSON.parse(this.la.Ga("Settings"))||{};Xa.slideshowcore||(Xa.slideshowcore={});Xa.slideshowcore&&Xa.slideshowcore.forceSvg&&"true"===Xa.slideshowcore.forceSvg.toString().toLowerCase()?this.$Ce=!0:this.$Ce&&(Xa.slideshowcore.forceSvg="True")}catch(Xa){G.a.J(512495906,830,15,"Exception in parsing settings:{0}",Xa),
this.c5={}}}preloadShaders(){this.PWe();this.Bpd();SlideShowCore.SlideShowCore.preloadShaders()}init(Ca,ha,Ba,va){return Object(h.a)(this,void 0,void 0,function*(){this.jDe=Ba;this.FO=va;this.Vbd=ha;if(this.vw)G.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.aec);else{this.xva=document.getElementById("HiddenFocusTrapAnchor");this.vw=document.createElement("div");this.vw.id="SlideShowBackground";this.vw.className="SlideShowBackground";this.vw.style.visibility=ia.a.Qs;this.vw.tabIndex=
-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";z.a.addHandler(this.vw,B.a.Twa,pa=>{this.jvk(pa)});v.a.instance.pb(this.vw,pa=>this.Hgb(pa));this.vw.appendChild(this.K);S.a("PresenterCoachTabFix")&&this.xva?this.mf.insertBefore(this.vw,this.xva):this.mf.appendChild(this.vw);var ta=this.la.Ga("pptSlideShowCoreCssUrl"),Fa=document.createElement("link");
Fa.setAttribute("rel","stylesheet");Fa.setAttribute("type","text/css");Fa.setAttribute("href",ta);this.K.appendChild(Fa);sa.a.instance.init(this.la,this.vw,this.Hc,this,this.Ll,this.Ub,this.iO);this.D$=document.getElementById("slideshowBeginningFocusTrap");this.E$=document.getElementById("slideshowEndFocusTrap");this.D$||this.E$||(this.D$=document.createElement("div"),this.D$.id="slideshowBeginningFocusTrap",this.D$.className="FocusTrap",this.D$.tabIndex=0,z.a.addHandler(this.D$,B.a.focus,pa=>{this.Akc(pa)}),
this.E$=document.createElement("div"),this.E$.id="slideshowEndFocusTrap",this.E$.className="FocusTrap",this.E$.tabIndex=0,z.a.addHandler(this.E$,B.a.focus,pa=>{this.Akc(pa)}),S.a("PresenterCoachTabFix")&&this.xva?(this.mf.insertBefore(this.D$,this.mf.firstChild),this.mf.insertBefore(this.E$,this.xva.nextSibling)):(ta=document.getElementById("slideshow-toolbar"),this.mf.insertBefore(this.D$,this.vw),this.mf.insertBefore(this.E$,ta)));this.aec=this.S6f(1)}yield this.aec})}S6f(Ca){return Object(h.a)(this,
void 0,void 0,function*(){const ha=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.FO),Ba={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};Ba["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const va=new Date;return new Promise((ta,Fa)=>{this.Ds.mj(ha,1,"",Ba,!1,0,pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.GHe(pa,va);G.a.J(509636751,830,50,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");
ta()}),pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.FHe(pa,Ca);G.a.J(509636750,830,50,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");Fa()}),null,null)})})}GHe(Ca,ha){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309283,830,50,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+ha);const Ba=JSON.parse(Ca.data.Sd);this.$Q=Ba.downloadUrl;A.a.Wa(this.$Q)?G.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",
Ba):(this.lXa=Date.now(),yield this.zDj())})}v5f(){const Ca={};Ca.settings=this.c5;Ca.retryCount=this.la.Bc("GetItemsRetryCount",3);Ca.retryOnCategories=this.la.Ga("GetItemsRetryCategories").split(";");const ha={};ha.Slide=ResourceStrings.l_Slide;ha.AnimNum=ResourceStrings.l_AccSsAnimNum;ha.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;ha.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;ha.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;ha.AnimTotalPlural=
ResourceStrings.l_AccSsAnimTotalPlural;Ca.localizedStrings=ha;return Ca}zDj(){return Object(h.a)(this,void 0,void 0,function*(){this.PWe();this.Bpd();this.p9c=new PodsProxy.PodsProxy(this.la.O9a?this.la.$Sc:this.la.podsWebServiceBase,{DownloadUrl:this.$Q,DocID:y.AFrameworkApplication.gh,CustomFontCatalogUrl:this.la.Ga("CustomFontCatalogURL")},this.la.GJa?A.a.fT(this.la.GJa).toLowerCase():"",this.Oea,this.U4f(),this.V4f());this.Fgc=new SlideShowCore.DefaultResourceProviders(this.p9c,this.Oea,this.v5f());
const Ca={};Ca.initTime=Na.T5b();Ca.uiHost="Unified App";Ca.serverUrl=A.a.Ne(this.la.podsWebServiceBase);Ca.userSessionId=this.jDe;Ca.jsScriptsBasePath=this.la.Ga("StaticContentHost")+"pptscripts/ssapp/";Ca.fileHost=this.la.Ga("FileHost");Ca.isRtl=y.AFrameworkApplication.isRtl;Ca.applicationLcid=y.AFrameworkApplication.lcid;Ca.applicationLocaleName=y.AFrameworkApplication.uiCulture;Ca.areThirdPartyAddInsAllowed=y.AFrameworkApplication.Hia;Ca.theWsaClient=y.AFrameworkApplication.jj;Ca.appForOfficeContextActivationParameters=
Q.a.g7f(this.qe);Ca.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;Ca.acceptLanguage=E.a.xe(y.AFrameworkApplication.lcid).name;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ModernSlideShowAddInSSO",!1)&&(Ca.appForOfficeAuthFactory=new F);const ha={};ha.settings=this.c5;ha.transitionResourceCDNPath=this.la.aMf;ha.transitionDisabledList=this.la.cMa;ha.clickTargetEnabled=!0;ha.mediaEnabled=!0;ha.gifEnabled=!0;ha.convertGifToVideo=!0;ha.crossSlideAudioEnabled=!0;ha.editAudioEnabled=
this.la.ka("PPTOAudioPlaybackOptionsEnabled");ha.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");ha.useNewYoutubePlayer=!0;ha.useNewVimeoPlayer=!0;ha.useOnlineVideoPlayer=!0;ha.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");ha.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");ha.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;ha.enableSVGAsWebGLTexture=!u.a.eg&&this.la.ka("SlideShowShapeBuilderSVGEnabled");ha.maxSvgTextureSize=this.la.Bc("ShapeBuilderMaxSvgTextureSize",
2048);ha.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");ha.slideSizeMax={["x"]:this.la.Bc("SlideShowMaxWidth",1504),["y"]:this.la.Bc("SlideShowMaxHeight",849)};ha.slideSizeMin={["x"]:this.la.Bc("SlideShowMinWidth",348),["y"]:this.la.Bc("SlideShowMinHeight",261)};ha.slideSizeDefault={["x"]:this.la.Bc("SlideShowDefaultWidth",1504),["y"]:this.la.Bc("SlideShowDefaultHeight",849)};ha.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");ha.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");
ha.disabledChangeGates=this.la.Ga("PPTDisabledChangeGates");ha.combineBootRequest=!0;ha.localVideoTelemetryEnabled=this.la.ka("IsGFXVideoLocalTelemetryEnabled");ha.imageSettings={["imageAppendOption"]:"all"};const Ba={["slideShowCoreSettings"]:ha,["appSettings"]:Ca};this.pn=new SlideShowCore.SlideShowCore(this.K,this.Fgc,this.Oea,Ba);new SlideShowCore.PrefetchAddon(this.pn,this.Oea,{["forwardPrefechCount"]:this.la.Bc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Bc("PptModernSlideShowBackwardPrefetchCount",
5),["forwardPrerenderCount"]:this.la.Bc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.la.Bc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.pn,this.Oea);this.kUg=Date.now();this.IBe=this.pn.init();this.pn.events.on("slideLocationChanged",()=>{this.Qfd()});this.pn.events.on("animationStateChanged",()=>{this.Qfd()});this.pn.events.on("slideDimensionsChanged",()=>{this.getCurrentSlideDimensions()});this.pn.events.on("exitFromEndOfShow",
()=>{this.tHe(!0)});this.pn.events.on("blankSlideStateChanged",va=>{this.grk(va)});this.pn.events.on("slideshowError",va=>{this.Ped(va)});return new Promise(va=>{this.IBe.then(()=>{this.Ahc=!1;this.IAg=new SlideShowCore.InputsAddon(this.pn,this.K,y.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.pn,Ba,this.Oea);new SlideShowCore.TransitionLoggerAddon(this.pn,Ba,this.Oea);new SlideShowCore.PerfCheckerAddon(this.pn,Ba,this.Oea);this.yhc=new SlideShowCore.SlideShowInkAddon(this.pn,
this.Oea,this.K,()=>this.YBb.loadScript("slideshowink"),{["telemetryLogger"]:this.rhk});this.IAg.events.on("keydown",ta=>{this.jJa(ta)});G.a.J(509636749,830,50,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");va()})})})}V4f(){const Ca={};Ca.timeout=this.la.Bc("PptModernSlideShowGetItemsTimeoutMs",3E4);Ca.throwHttpErrors=!1;Ca.enableServerSpecificErrorCode=S.a("SSCore.EnableServerSpecificErrorCode");return Ca}Bpd(){try{const Ca=this.c5;if(Ca.slideshowcore){const ha={};ha.settings=Ca;
ha.logger=this.Oea;ha.disabledChangeGates=this.la.Ga("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(ha)}}catch(Ca){G.a.J(509703488,830,15,"Exception in passing settings to slideshowcore:{0}",Ca)}}PWe(){try{const Ca=this.c5;if(Ca.podsproxy){const ha={};ha.settings=Ca;window.PodsProxy.setupGlobals_PodsProxy(ha)}}catch(Ca){G.a.J(512309267,830,15,"Exception in passing settings to podsproxy:{0}",Ca)}}NHh(Ca,ha){return Object(h.a)(this,void 0,void 0,function*(){this.PWe();this.Bpd();
this.p9c=new PodsProxy.PodsProxy(this.la.O9a?this.la.$Sc:this.la.podsWebServiceBase,{DownloadUrl:this.$Q,DocID:y.AFrameworkApplication.gh,CustomFontCatalogUrl:this.la.Ga("CustomFontCatalogURL")},this.la.GJa?A.a.fT(this.la.GJa).toLowerCase():"",this.Oea,this.U4f(),this.V4f());const Ba=this.Fgc;this.Fgc=new SlideShowCore.DefaultResourceProviders(this.p9c,this.Oea,this.v5f());yield this.pn.updateResourceProviders(this.Fgc,{shouldRerenderSlide:!0});Ba&&Ba.dispose();G.a.J(593827098,830,50,"Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",
Ca,ha,Date.now(),this.mbb())})}FHe(Ca,ha){return Object(h.a)(this,void 0,void 0,function*(){const Ba=Ca.data?Ca.data.oe:-1;0<ha--?(G.a.J(512309281,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",Ba),yield this.S6f(ha)):G.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",Ba)})}jrd(Ca,ha,Ba,va,ta,Fa,pa,ka,Ha){Object(h.a)(this,void 0,void 0,function*(){this.aec&&(G.a.J(509617947,
830,50,"SlideShowCoreFrame::StartFrom - initPromise {0}",this.aec),yield this.aec,this.mbb()||this.show());if(this.pn&&!A.a.Wa(this.$Q)){const Ya={};this.jXa>this.lXa||this.Ahc?(this.c5.slideshowcore.vetoBootDurationMs=this.la.Bc("PptModernSlideShowEditVetoBootDurationMs",8E3),Ya.BootScenario=this.jXa>this.lXa?"AfterEdit":"Init",G.a.J(509703459,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Bc("PptModernSlideShowEditVetoBootDurationMs",
8E3),this.jXa,this.lXa,this.Ahc)):(this.c5.slideshowcore.vetoBootDurationMs=this.la.Bc("PptModernSlideShowCachedVetoBootDurationMs",2E3),Ya.BootScenario="Relaunch",G.a.J(509703458,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Bc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.jXa,this.lXa,this.Ahc));this.Bpd();this.jXa>this.lXa&&(yield this.OHh(1));Ya.startFromTime=Ha-window.performance.timing.navigationStart;
Ya.SSCoreFrameStartTime=Na.T5b();sa.a.instance.CXk();this.K.style.top="0";this.D$&&this.E$&&(this.D$.tabIndex=0,this.E$.tabIndex=0);const Ka={["slideId"]:{["sid"]:Ca,["cid"]:0}};Ka.slideIndex=ha-1;this.du.K9b&&!this.du.i9?this.kri(Ka,Ya):this.qWf(Ka,Ya)}else G.a.J(512495901,830,15,"Failed to get download Url")})}prev(){this.pn&&this.pn.prevStep("0_anim").then(()=>{})}next(){this.pn&&this.pn.nextStep("0_anim",3).then(()=>{})}show(){this.wtc(!0)}mbb(){return this.vw&&this.vw.style.visibility===ia.a.Dz?
!0:!1}N8(){return"Modern"}wtc(Ca){sa.a.instance.setVisibility(Ca&&this.Hc.Kh);this.vw&&(Ca?(this.vw.style.visibility=ia.a.Dz,$addHandler(window,"visibilitychange",ha=>{this.lZa(ha)})):(this.vw.style.visibility=ia.a.Qs,$removeHandler(window,"visibilitychange",ha=>{this.lZa(ha)})))}exit(){this.tHe(!1)}WQc(){this.tHe(!1)}transcribe(Ca,ha,Ba,va,ta,Fa,pa){const ka=!!this.Ub&&!!this.Ub.instance&&(this.Ub.instance.dSa||this.Ub.instance.dr);(this.Ub&&this.Ub.instance&&this.Ub.instance.vr&&this.Ub.instance.ADa||
ka)&&!this.Ub.instance.xvb()?G.a.J(512495900,830,50,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(sa.a.instance.transcribe(Ca,ha,Ba,va,ta,Fa,pa),this.Hc.Kh&&this.pn.recordSessionStats({["metadata"]:"subtitles"}),this.c0d())}qWf(Ca,ha){this.pn.clearNavigationState();const Ba={navigationType:"init"};Ba.startFromTime=ha.startFromTime;ha.waitedForInit=this.Ahc;ha.startInitTime=this.kUg;ha.beforeInitPromise=Na.T5b();this.IBe.then(()=>{ha.afterInitPromise=Na.T5b();
Ba.bootMetrics=ha;if(0>Ca.slideIndex)this.pn.gotoFirstSlide(!0,Ba).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)});else{const va={};va.actionContext=Ba;va.fSkipTransition=!0;this.pn.gotoSlide(Ca,va).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}})}kri(Ca,ha){const Ba=this.la.Bc("PptModernSlideShowCheckFullscreenCounter",10);let va=Ba;this.edb=window.setInterval(()=>
{va--;G.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",va);if(this.du.i9||0>=va){window.clearInterval(this.edb);this.edb=0;const ta=20*(Ba-va);ha.checkFullscreenMs=ta;G.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",ta);this.qWf(Ca,ha)}},20)}c0d(){let Ca=0,ha=100;this.Hc.Kh&&sa.a.instance.isVisible()&&("AboveSlide"===this.Hc.Tv?(Ca=15,ha=85):"BelowSlide"===this.Hc.Tv&&(ha=85));const Ba=document.getElementById("LiveURLBarLayerHost");
this.YCb&&Ba?(this.K.style.top=String.format("calc({0}% + {1})",Ca.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",ha.toString(),"26px")):(this.K.style.top=Ca.toString()+"%",this.K.style.height=ha.toString()+"%")}setMicrophoneState(Ca){sa.a.instance.setMicrophoneState(Ca)}vOb(Ca,ha=""){this.YCb=Ca;sa.a.instance.lCh(Ca,ha);this.c0d()}toggleTranscriberUIVisibility(Ca){sa.a.instance.setVisibility(Ca);sa.a.instance.SGc();this.c0d()}f2e(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}restoreFocus(){this.vw&&this.vw.style.visibility!==ia.a.Qs&&!this.pje()&&this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.pn){const Ca=this.pn.getSlideLocation();Ca?this.va.raiseEvent("OnGetCurrentPosition",new X.a({["SlideId"]:Ca.slideId.sid,["SlideIndex"]:Ca.slideIndex})):G.a.J(512495897,830,15,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.pn){const Ca=this.pn.getSlideLocation();if(Ca){const ha=this.pn.getAnimationState(!0),
Ba=ha.timelineStates,va=[];for(let ta=0;ta<Ba.length;ta+=1)va.push({["TimeLineId"]:Ba[ta].timelineId,["Step"]:Ba[ta].step,["LastClickTime"]:Ba[ta].lastClickTime,["StartTimeOffset"]:ha.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new X.a({["SlideId"]:Ca.slideId.sid,["SlideIndex"]:Ca.slideIndex,["TimeLineMappings"]:va}))}else G.a.J(512495896,830,15,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.pn&&this.vw&&this.vw.style.visibility!==
ia.a.Qs){const Ca=document.getElementById(this.$Ce?"svg-canvas":"webgl-canvas");Ca&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new N.a({["SlideHeight"]:Ca.offsetHeight,["SlideWidth"]:Ca.offsetWidth,["SlideLeftBound"]:Ca.offsetLeft,["SlideBottomBound"]:Ca.offsetTop+Ca.offsetHeight}))}}tTa(Ca){this.pn&&this.pn.gotoSlide({["slideIndex"]:Ca},{actionContext:{navigationType:"goto"},fSkipTransition:!1}).then(()=>{})}p9f(Ca,ha){if(this.pn){const Ba={},va=[];let ta=0;for(let Fa=0;Fa<ha.length;Fa+=1){const pa=
{};pa.timelineId=ha[Fa].TimeLineId;pa.step=ha[Fa].Step;pa.lastClickTime=ha[Fa].LastClickTime;ta=ha[Fa].StartTimeOffset;va.push(pa)}Ba.timelineStates=va;Ba.startTimeOffset=ta;ha={actionContext:{navigationType:"goto"}};ha.animationState=Ba;ha.fSkipTransition=!1;this.pn.gotoSlide({["slideIndex"]:Ca},ha).then(()=>{})}}OHh(Ca){return Object(h.a)(this,void 0,void 0,function*(){G.a.J(512309260,830,50,"updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.FO);const ha=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.la.podsWebServiceBase,this.FO),Ba={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};Ba["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const va=new Date;return new Promise((ta,Fa)=>{this.Ds.mj(ha,1,"",Ba,!1,0,pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.Ttk(pa,va);G.a.J(509636748,830,50,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");ta()}),pa=>Object(h.a)(this,void 0,void 0,function*(){yield this.Rtk(pa,
Ca);G.a.J(509636747,830,50,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");Fa()}),null,null)})})}Ttk(Ca,ha){return Object(h.a)(this,void 0,void 0,function*(){const Ba=new Date;G.a.J(512309279,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",+Ba-+ha);const va=JSON.parse(Ca.data.Sd);this.$Q=va.downloadUrl;A.a.Wa(this.$Q)?G.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",
va):(this.lXa=Date.now(),yield this.NHh(ha,Ba))})}Rtk(Ca,ha){return Object(h.a)(this,void 0,void 0,function*(){const Ba=Ca.data?Ca.data.oe:-1;0<ha--?(G.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",Ba),yield this.OHh(ha)):G.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",Ba)})}refreshPodSession(Ca,ha,Ba=1){G.a.J(512309259,830,50,"RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",
this.FO,Ca);this.FO=Ca;this.Vbd=ha;Ca=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.FO);ha={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ha["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const va=new Date;this.Ds.mj(Ca,1,"",ha,!1,0,ta=>Object(h.a)(this,void 0,void 0,function*(){yield this.Utk(ta,va)}),ta=>Object(h.a)(this,void 0,void 0,function*(){yield this.Stk(ta,Ba)}),null,null)}Utk(Ca,ha){return Object(h.a)(this,
void 0,void 0,function*(){var Ba=new Date;G.a.J(512309275,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+Ba-+ha);const va=JSON.parse(Ca.data.Sd);this.$Q=va.downloadUrl;A.a.Wa(this.$Q)?(G.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",va),this.mbb()&&(Ba=P.a.Uh(413),y.AFrameworkApplication.vp(Ba),J.Health.instance.recordQosError(P.a.lja(Ba),["SlideShowACE"],!1,!0,!0,
!0,null),this.pn&&this.pn.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.lXa=Date.now(),yield this.NHh(ha,Ba))})}Stk(Ca,ha){Ca=Ca.data?Ca.data.oe:-1;0<ha--?(G.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",Ca),this.refreshPodSession(this.FO,this.Vbd,ha)):(G.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",
Ca),this.mbb()&&this.exit())}setVisibility(Ca){this.wtc(Ca)}hga(Ca){this.vw&&(this.vw.style.cursor=Ca?"default":"none");sa.a.instance.hga(Ca)}setOsfLocalStorage(){}iLe(Ca){if(this.yhc)this.yhc.onInkManagerActivity(Ca)}jJa(Ca){this.EUe(Ca)}EUe(Ca){this.va.raiseEvent("OnSpecialKey",new fa.a({["Key"]:Ca.keyCode,["ShiftKey"]:Ca.shiftKey}))}Qoh(){}Akc(){this.vw&&this.restoreFocus()}U4f(){const Ca=new Map;Ca.set("X-UserSessionId",this.jDe);Ca.set("X-WacNoAuth","1");Ca.set("X-WacCluster",this.Vbd);Ca.set("Client",
"Unified App");this.la.Raj&&Ca.set("UseDocCache","True");return Ca}tHe(Ca=!1){this.edb&&(G.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.edb),window.clearInterval(this.edb),this.edb=0);this.yhc&&this.yhc.resetInkCanvas();this.D$&&this.E$&&(this.D$.tabIndex=-1,this.E$.tabIndex=-1);if(this.pn){const ha=this.pn.getSlideLocation();this.pn.endSession(Na.T5b());ha?this.va.raiseEvent("OnExit",new O.a({["SlideId"]:ha.slideId.sid,["IsBeforeReady"]:!1,
["SlideIndex"]:ha.slideIndex,["IsFromEndOfSlideshow"]:Ca})):G.a.J(512495889,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.wtc(!1);sa.a.instance.v_e()}Qfd(){if(this.pn&&this.vw&&this.vw.style.visibility!==ia.a.Qs){const Ca=this.pn.getSlideLocation();if(Ca){const ha=this.pn.getAnimationState(!0),Ba=ha.timelineStates,va=[];for(let ta=0;ta<Ba.length;ta+=1)va.push({["TimeLineId"]:Ba[ta].timelineId,
["Step"]:Ba[ta].step,["LastClickTime"]:Ba[ta].lastClickTime,["StartTimeOffset"]:ha.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new V.a({["SlideId"]:Ca.slideId.sid,["SlideIndex"]:Ca.slideIndex,["TimeLineMappings"]:va}))}else G.a.J(512495888,830,50,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}grk(Ca){if(this.pn&&this.vw&&this.vw.style.visibility!==ia.a.Qs)switch(Ca){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;
case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:G.a.J(512495887,830,50,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",Ca)}}Ped(Ca){if(this.pn){G.a.J(512495886,830,15,"SlideshowCoreFrame.OnErrorHandler {0}",Ca);let ha;Ca.startsWith("Server")&&(Ca="GetItemsRequestFailed");switch(Ca){case "GetItemsFailedDownloadFile":G.a.J(512495885,830,50,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.FO);this.va.raiseEvent("OnPodSessionExpired",
new aa.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.FO}));return;case "LoadFailed":ha=407;break;case "GetItemsFailedInvalidResponse":ha=408;break;case "GetItemsRequestFailed":ha=409;break;case "GetItemsTimeout":ha=411;break;case "EnsureSlideFailed":ha=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":ha=414;break;default:ha=359}if(0!==ha)if(this.mbb()){const Ba=P.a.Uh(ha);y.AFrameworkApplication.vp(Ba);Ca=409===ha?Ca:P.a.lja(Ba);J.Health.instance.recordQosError(Ca,
["SlideShowACE"],!1,!0,!0,!0,null);this.pn.recordSessionStats({["errorName"]:Ca})}else G.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",Ca)}}wgd(Ca){G.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.pn&&this.vw&&this.vw.style.visibility!==ia.a.Qs&&this.va.raiseEvent("OnTranscriberStartedEventId",new ma.a({["TranscriberSessionId"]:Ca}));this.Hc.zvb=!0}lZa(){G.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");
window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new da.a(!1))}pje(){return!!this.Ub&&!!this.Ub.instance&&this.Ub.instance.qUf}BGc(Ca){this.va.addHandler("OnSlideshowReady",Ca)}rld(Ca){this.va.removeHandler("OnSlideshowReady",Ca)}oPd(Ca){this.va.addHandler("OnBrowserEvent",Ca)}YQe(Ca){this.va.removeHandler("OnBrowserEvent",Ca)}quf(Ca){this.va.addHandler("OnFullscreenClick",Ca)}tih(Ca){this.va.removeHandler("OnFullscreenClick",Ca)}qPd(Ca){this.va.addHandler("OnSlideshowContextMenu",
Ca)}$Qe(Ca){this.va.removeHandler("OnSlideshowContextMenu",Ca)}Aia(Ca){this.va.addHandler("OnExit",Ca)}Rfa(Ca){this.va.removeHandler("OnExit",Ca)}nuf(Ca){this.va.addHandler("OnSlideshowError",Ca)}qih(Ca){this.va.removeHandler("OnSlideshowError",Ca)}xGc(Ca){this.va.addHandler("OnGetCurrentSlideDimensions",Ca)}pld(Ca){this.va.removeHandler("OnGetCurrentSlideDimensions",Ca)}MYb(Ca){this.va.addHandler("OnGetCurrentPosition",Ca)}Cib(Ca){this.va.removeHandler("OnGetCurrentPosition",Ca)}CGc(Ca){this.va.addHandler("OnSpecialKey",
Ca)}tld(Ca){this.va.removeHandler("OnSpecialKey",Ca)}Duf(Ca){this.va.addHandler("OnVisibilityChangeEventId",Ca)}hRe(Ca){this.va.removeHandler("OnVisibilityChangeEventId",Ca)}vPd(Ca){this.va.addHandler("OnPodSessionExpired",Ca)}dRe(Ca){this.va.removeHandler("OnPodSessionExpired",Ca)}tuf(Ca){this.va.addHandler("OnLogEndOfTranscriptionSession",Ca)}vih(Ca){this.va.removeHandler("OnLogEndOfTranscriptionSession",Ca)}GPa(Ca){this.va.addHandler("OnPositionChangeEventId",Ca)}Dib(Ca){this.va.removeHandler("OnPositionChangeEventId",
Ca)}suf(Ca){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Ca)}uih(Ca){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Ca)}sPd(Ca){this.va.addHandler("OnEnterEndOfShowEventId",Ca)}aRe(Ca){this.va.removeHandler("OnEnterEndOfShowEventId",Ca)}uPd(Ca){this.va.addHandler("OnLeaveEndOfShowEventId",Ca)}cRe(Ca){this.va.removeHandler("OnLeaveEndOfShowEventId",Ca)}Auf(Ca){this.va.addHandler("OnSubtitleUpdatedEventId",Ca)}Cih(Ca){this.va.removeHandler("OnSubtitleUpdatedEventId",Ca)}Cuf(Ca){this.va.addHandler("OnTranscriberStartedEventId",
Ca)}Dih(Ca){this.va.removeHandler("OnTranscriberStartedEventId",Ca)}Kuf(Ca){this.va.addHandler("RecordQosErrorEventId",Ca)}Kih(Ca){this.va.addHandler("RecordQosErrorEventId",Ca)}jvk(Ca){this.va.raiseEvent("OnBrowserEvent",new D.a({["ClientX"]:Ca.clientX,["ClientY"]:Ca.clientY}))}Hgb(Ca){this.va.raiseEvent("OnSlideshowContextMenu",new ca.a({["ClientX"]:Ca.clientPoint.x,["ClientY"]:Ca.clientPoint.y}));return!0}static T5b(){return Math.round(window.performance.now())}}Object(I.a)(Na,"SlideShowCoreFrame",
null,[326])},729:function(I,Y,d){I=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.htb="chart";Object(I.a)(h,"ClipserviceDataConstants",null,[]);d.d(Y,"b",function(){return e});d.d(Y,"a",function(){return n});const e=m=>m===h.slideType?1:m===h.shapeType?2:m===h.htb?3:0,n=m=>1===m?h.slideType:2===m?h.shapeType:""},730:function(I,Y,d){I=d(0);var h=d(18),e=d(47),n=d(844),m=d(230),z=d(245),B=d(231),v=d(492);class y{constructor(E,u){this.B_a=E;this.description=u}}Object(I.a)(y,"ColorEntry",null,
[]);d.d(Y,"a",function(){return A});class A{constructor(E){this.Jqe={};this.SBe=null;this.Bm=E}get Ipl(){if(!this.SBe){const E=new Sys.StringBuilder;for(let u of this.standardColors)E.append(String.format(A.uTd,this.bCh(u.B_a),this.X1e(u.B_a),u.description));this.SBe=E.toString()}return this.SBe}get standardColors(){let E;return E=new h.a,E.add(new y(12582912,ResourceStrings.L_FontColorDarkRed)),E.add(new y(16711680,ResourceStrings.L_FontColorRed)),E.add(new y(16760832,ResourceStrings.L_FontColorOrange)),
E.add(new y(16776960,ResourceStrings.L_FontColorYellow)),E.add(new y(9621584,ResourceStrings.L_FontColorLightGreen)),E.add(new y(45136,ResourceStrings.L_FontColorDarkGreen)),E.add(new y(45296,ResourceStrings.L_FontColorLightBlue)),E.add(new y(28864,ResourceStrings.L_FontColorBlue)),E.add(new y(8288,ResourceStrings.L_FontColorDarkBlue)),E.add(new y(7352480,ResourceStrings.L_FontColorPurple)),E}bCh(E){return String.format("#{0}",B.i(E))}X1e(E){return B.i(E)}utc(E){return Object.assign(new z.a,{ThemeColor:E.ThemeColor,
ColorLuminance:E.ColorLuminance,FTintColor:E.FTintColor}).toString()}xae(E,u,J){const G=new Sys.StringBuilder;G.append(this.OSd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,E));this.U7h(G);G.append(this.NSd());G.append(this.OSd("StandardColors",ResourceStrings.L_StandardFontColor,!1,E));G.append(this.Ipl);G.append(this.NSd());u&&0<u.length&&(G.append(this.OSd("RecentColors",ResourceStrings.L_RecentColors,!1,J)),G.append(this.Bgj(u)),G.append(this.NSd()));return G.toString()}Bgj(E){const u=new Sys.StringBuilder;
for(let J=0;J<E.length;J++){const G=E[J];u.append(String.format(A.uTd,"#"+G.hex,G.hex,"#"+G.hex))}return u.toString()}OSd(E,u,J,G){return String.format(A.pmi,E,u,"ColorPicker",J?'McuLayout = "true" ':"",G)}NSd(){return A.omi}U7h(E){const u=Array(10);u[0]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Background1));u[1]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Text1));u[2]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Background2));u[3]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Text2));
u[4]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent1));u[5]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent2));u[6]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent3));u[7]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent4));u[8]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent5));u[9]=this.iL(m.Color.Ti(this.Bm.PresetSchemeColorMapping.Accent6));const J=Array(10);J[0]=ResourceStrings.l_ThemeLabel1;J[1]=ResourceStrings.l_ThemeLabel2;J[2]=ResourceStrings.l_ThemeLabel3;
J[3]=ResourceStrings.l_ThemeLabel4;J[4]=ResourceStrings.l_ThemeLabel5;J[5]=ResourceStrings.l_ThemeLabel6;J[6]=ResourceStrings.l_ThemeLabel7;J[7]=ResourceStrings.l_ThemeLabel8;J[8]=ResourceStrings.l_ThemeLabel9;J[9]=ResourceStrings.l_ThemeLabel10;for(let G=0;5>=G;G++)for(let S=0;S<u.length;S++)E.append(this.N1i(u[S][G],u[S][0],J[S],G,S))}iL(E){const u=e.a.hw(E.r,2)+e.a.hw(E.g,2)+e.a.hw(E.b,2);if(this.Jqe[u])return this.Jqe[u];const J=v.a.sSa(E),G=[];Array.add(G,E);if(E.A2d())for(var S=0;S<n.a.GJh.length;++S)E=
v.a.M4b(J),E.darken(n.a.GJh[S]/100),Array.add(G,E.Cta());else if(E.fVi())for(S=0;S<n.a.uzf.length;++S)E=v.a.M4b(J),E.lighten(n.a.uzf[S]/100),Array.add(G,E.Cta());else if(J.lum<A.Zli)for(S=0;S<n.a.qrg.length;++S)E=v.a.M4b(J),E.lighten(n.a.qrg[S]/100),Array.add(G,E.Cta());else if(J.lum>A.Yli)for(S=0;S<n.a.prg.length;++S)E=v.a.M4b(J),E.darken(n.a.prg[S]/100),Array.add(G,E.Cta());else for(S=0;S<n.a.kKc.length+n.a.yGf.length;++S)E=v.a.M4b(J),S<n.a.kKc.length?E.lighten(n.a.kKc[S]/100):E.darken(n.a.yGf[S-
n.a.kKc.length]/100),Array.add(G,E.Cta());return this.Jqe[u]=G}N1i(E,u,J,G,S){E=this.X1e(E.B_a);({iKc:u,zOb:J}=this.b6d(u,E,J,G,S));return String.format(A.uTd,u,E,J)}b6d(E,u,J,G,S){var P;var Q=P=null;if(0>G)return{iKc:P,zOb:Q};u=Object.assign(new z.a,{RGBColor:u,ThemeColor:S,ColorLuminance:0,FTintColor:!1});G?(S=v.a.sSa(E),Q=G-1,S.lum?1===S.lum?(G=!1,Q=[242,217,191,166,127][Q]):.8<S.lum?(G=!1,Q=[229,191,127,64,25][Q]):.2>S.lum?(G=!0,Q=[25,64,127,191,229][Q]):(S=[51,102,153],P=[191,127],Q=(G=Q<S.length)?
S[Q]:P[Q-S.length]):(G=!0,Q=[127,166,191,217,242][Q]),Q=255-Q,Q=Math.round(100*Q/255),u.ColorLuminance=100-Q,u.FTintColor=G,Q=String.format(G?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,E.toString(),J,Q)):Q=String.format(ResourceStrings.l_ColorPickerTooltipBase,E.toString(),J);P=this.utc(u);return{iKc:P,zOb:Q}}}A.pmi='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';A.omi="</Colors></ColorPicker></Controls></MenuSection>";
A.uTd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';A.Zli=.2;A.Yli=.8;Object(I.a)(A,"ColorPickerBuilder",null,[])},731:function(I,Y,d){var h=d(106),e=d(55),n=d(80),m=d(27),z=d(36),B=d(87),v=d(29),y=d(232),A=d(325),E=d(28),u=d(970);I=d(0);class J{constructor(){this.xz=this.onSuccess=this.EGe=this.YPd=this.iah=null}}Object(I.a)(J,"UploadFileDialogData",null,[]);var G=d(69),S=d(35);I=d(78);d.d(Y,"d",function(){return Q});d.d(Y,"e",function(){return D});d.d(Y,"a",function(){return aa});d.d(Y,
"c",function(){return V});d.d(Y,"b",function(){return ca});const P=new I.a,Q=(fa,ma,da,qa,F)=>{const sa=String.format("{0}{1}",da,h.a.create().toString());return Object.assign(new J,{YPd:N(sa,qa),iah:X(da,qa),EGe:(ia,Na)=>{switch(da){case "video":Na.blockContent(F,fa);break;default:Na.blockContent(ia,"Insert Media")}},onSuccess:(ia,Na,Ca,ha,Ba,va)=>{ma(fa,sa,Na,Ca,Ba,va,F)},xz:(ia,Na,Ca,ha,Ba)=>{Ca.UN(Na)?E.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+Na.gja):Ca.UN(F)&&E.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+F.gja);S.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(da)?Ca.fK(F):Ca.fK(Na);Na=null;try{const va=z.a(ia);Na=va?va.Error:null}catch(va){E.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",ia)}if(!Na){let va;S.a("FixHideShimmerIssueOnUploadFailure")&&ia&&!isNaN(parseInt(ia))&&(va=Enum.parse(y.a,
y.a[parseInt(ia)],!0));Na=Object.assign(new A.a,{Code:va?va:444})}Ba&&(Ba.finish(),Ba=null);E.a.J(509727821,822,10,"Upload media failed");aa(da)?V(ResourceStrings.l_FileInsertFailedMessageTitle,Na&&449===Na.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):O(ha,Ba,Na.Code,null)}})},D=(fa,ma,da,qa)=>new Promise((F,sa)=>{const ia=new u.a(qa);E.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}, media file size: {2}",
fa&&fa.value?fa.files.length:0,u.a.R6d(fa),u.a.B1f(fa));da&&da.Va("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}, media file size: {2}",fa&&fa.value?fa.files.length:0,u.a.R6d(fa),"video"===qa?"":u.a.B1f(fa)));if(fa&&fa.value&&fa.value.length)if(ia.fIl(fa.value)){var Na=fa.files[0];if(ia.gIl(Na.size))ia.qri(Na).then(Ca=>{Ca?(da&&da.Va("MediaFileValidationPassedOnUI","true"),F(!0)):(aa(qa)?V(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,
[ia.Zma.join(", ")]):O(ma,da,443,[ia.Zma.join(", ")]),sa(443))},()=>{E.a.J(509727825,822,10,"Invalid media file, fileType:{0}",qa);aa(qa)?V(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ia.Zma.join(", ")]):O(ma,da,443,[ia.Zma.join(", ")]);sa(443)});else{E.a.J(509727826,822,10,"video"===qa?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${Na.size}`);Na=S.a("FetchMediaSizeLimitFromValidationHelper")?ia.vfc.toString():"16";const Ca=
"video"===qa?450:442;aa(qa)?V(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,[Na]):O(ma,da,Ca,[Na]);sa(442)}}else E.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===qa||void 0===qa?void 0:qa.toString(),u.a.R6d(fa)),aa(qa)?V(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ia.Zma.join(", ")]):O(ma,da,441,[ia.Zma.join(", ")]),sa(441);else aa(qa)?V(ResourceStrings.l_FileInsertFailedMessageTitle,
ResourceStrings.l_FileInsertFailedMessage,null):O(ma,da,440,null),sa(440)}),O=(fa,ma,da,qa)=>{ma&&(ma.Va("MediaFileValidationPassedOnUI","false"),da&&ma.Va("ErrorCode",da.toString()),ma.finish());fa.cH(da,F=>{F.jC=1;F.ZRa=qa;return!1})},X=(fa,ma)=>{let da="MediaUpload.ashx";if(v.App.webServiceBase)da=v.App.webServiceBase+da;else if(e.a.eg||e.a.Lua)da=n.a.eta(da);let qa="";switch(fa){case "audio":qa="audio";break;case "captions":qa="captions";break;case "video":qa="video";break;default:E.a.J(509727824,
822,10,"Media::GetMediaUploadEndpoint: file type not supported")}da+=String.format("?MediaType={0}&{1}&{2}&{3}",qa,m.AFrameworkApplication.jTa(),ma.presentationId.string,m.AFrameworkApplication.c5b());ma.podSessionId&&(da+=String.format("&{0}={1}",B.a.haa,ma.podSessionId));ma.pk&&(da+=String.format("&waccluster={0}",ma.pk));return da},N=(fa,ma)=>{const da=new G.a;da.$("PresentationId",ma.presentationId.string);da.$(B.a.Lna,ma.sessionInfo);da.$("Canary",m.AFrameworkApplication.canary);da.$("access_token",
m.AFrameworkApplication.accessToken);da.$("MediaToken",fa);return da},aa=fa=>S.a("EnableCalloutNotificationsForVideos")&&"video".match(fa)?!0:!1,V=(fa,ma,da)=>{let qa=new A.a;qa.Title=fa;qa.Message=ma;qa.ExtraErrorParam=da;P.raiseEvent("videoCalloutNotificationEvent",qa)},ca=fa=>{P.addHandler("videoCalloutNotificationEvent",fa)}},907:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.uFe="TraceIdNoBar";h.E1c="TraceIdLeftBar";h.zmd="TraceIdRightBar";h.fIc="TraceIdBothBar";Object(I.a)(h,
"ConsistencyCheckTraceIdType",null,[])},908:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(517);class e{constructor(){this.start=new h.a;this.end=new h.a}clone(){return Object.assign(new e,{start:this.start.clone(),end:this.end.clone()})}merge(n){let m=!1;n.start&&(m=this.start.merge(n.start));n.end&&(m=this.end.merge(n.end)||m);return m}}Object(I.a)(e,"TextNodeSelection",null,[])},909:function(I,Y,d){d.d(Y,"a",function(){return 19})},910:function(I,Y,d){d.d(Y,"a",function(){return n});
var h=d(47),e=d(27);const n=m=>{if(h.a.Wa(m))return!1;var z=e.AFrameworkApplication.fa.Ga("PPTDisabledChangeGates");return z?(z=z.split(";"))&&0<z.length?0>Array.indexOf(z,m):!0:!1}},911:function(I,Y,d){d.r(Y);d.d(Y,"WordPredictionAugLoopResponseManager",function(){return A});I=d(0);Y=d(18);var h=d(353),e=d(912),n=d(658),m=d(656),z=d(657),B=d(549),v=d(64),y=d(33);class A{s7b(E){A.RS.hG(()=>{this.ehl(E)||(this.B2e(E),this.aGl(),this.Iei())},"WPT:PR")}Iei(){const E=B.a.QD.O5,u=B.a.QD.Hhb;if(E){var J=
v.a.instance.Na.mb;if(J&&J.Ye&&B.a.Pgg(J.Ye)){J=J.Ye.node;var G=y.ParagraphReader.text(J);G=G.substring(E.Znd,G.length);J=this.r7d(J,E,G);"string"===typeof J?J.length?(E.Q8=J,E.ZMb+=1,B.a.TQd(E.text,J),this.dFl(),E.KJe=G,this.cFl(E)):u&&0===u[n.a.status]?(this.bHh(),B.a.Yld()):this.rGl():(this.bHh(),B.a.Yld())}}}cFl(E){A.nwd.count>=A.gWh&&A.nwd.removeAt(0);A.nwd.add(this.eui(E))}eui(E){return Object.assign(new e.a,{id:E.id,Pya:E.Pya,Hx:E.Hx,Znd:E.Znd,text:E.text,Q8:E.Q8,K_b:E.K_b,V6a:E.V6a,score:E.score,
l2e:E.l2e,k2e:E.k2e,qP:E.qP,ZMb:E.ZMb,KJe:E.KJe})}ehl(E){if(E&&E.parentPath&&7===E.parentPath.length){const u=E.parentPath[6];B.a.BZa.add(u,z.a.uQd,(new Date).getTime());B.a.u1j(u)}else return B.a.jbc(z.a.U0d),!0;return B.a.UUa?(E=this.o8f(E),E=this.ibh(E[0]),E[n.a.status]=5,B.a.Z3d(E),B.a.jbc(z.a.Ewh),!0):!1}B2e(E){(E=this.o8f(E))&&E.length?(B.a.QD.O5=E[0],B.a.QD.qCh=E.length,B.a.QD.Hhb=this.ibh(E[0])):(B.a.Yld(),B.a.jbc(z.a.U0d))}o8f(E){if(!E||!E.items||!E.parentPath||7!==E.parentPath.length)return null;
var u=E.items[0];let J;try{J=u.body}catch(D){return null}u=E.parentPath[2];const G=parseInt(E.parentPath[3]),S=parseInt(E.parentPath[4]),P=E.parentPath[5];E=E.parentPath[6];if(!J.predictions.length)return null;B.a.Abl(J.modelInfo);const Q=Array(J.predictions.length);for(let D=0;D<J.predictions.length;D++){const O=J.predictions[D];if(O.text){const X=O.characterRange,N=O.tokenRange;Q[D]=Object.assign(new e.a,{id:P,Pya:E,Hx:u,Znd:G,text:O.text,Q8:O.text.substr(X.start),K_b:X.start,V6a:X.length,score:O.score,
l2e:N.start,k2e:N.length,qP:S,ZMb:0})}}return Q}ibh(E){const u={};u[n.a.language]="en-US";const J=B.a.Ycj();u[n.a.modelId]=J.modelId;u[n.a.modelVersion]=J.modelVersion;u[n.a.configId]=J.configId;u[n.a.DUd]=E.V6a;u[n.a.sJc]=E.V6a;u[n.a.rog]=E.Q8.length;u[n.a.abh]=E.text.length;u[n.a.dbh]=E.text.split(" ").length;u[n.a.score]=E.score;u[n.a.status]=0;u[n.a.M3e]=E.Q8.length;u[n.a.qP]=E.qP;E=B.a.BZa.ga(E.Pya);u[n.a.TBh]=E[z.a.uQd]-E[z.a.Crc];u[n.a.Rsd]=0;return u}aGl(){const E=B.a.QD.O5;E&&(B.a.Oua(E.qP,
m.a.yDf,B.a.QD.qCh),B.a.Oua(E.qP,m.a.DLf,E.V6a))}dFl(){const E=B.a.QD.O5,u=B.a.QD.Hhb;if(E&&1===E.ZMb){const J=(new Date).getTime();B.a.BZa.Idg(E.Pya,z.a.$vf,J);B.a.oqg(E.Pya,!0);B.a.jbc(z.a.cbh);const G=B.a.BZa.ga(E.Pya)[z.a.Crc];u[n.a.Rsd]=J-G;u[n.a.status]=1;u[n.a.sJc]=E.text.length-E.Q8.length;B.a.Oua(E.qP,m.a.eoh,1);B.a.Oua(E.qP,m.a.wjh,1);B.a.Oua(E.qP,m.a.xjh,E.Q8.length);B.a.Oua(E.qP,m.a.ELf,E.text.length-E.Q8.length);B.a.lIk()}}rGl(){const E=B.a.QD.O5,u=B.a.QD.Hhb;E&&(u[n.a.status]=3,u[n.a.sJc]=
0,u[n.a.M3e]=E.text.length-u[n.a.DUd],B.a.Z3d(u),B.a.Oua(E.qP,m.a.PEh,1),B.a.Oua(E.qP,m.a.GLf,E.score),B.a.Oua(E.qP,m.a.QEh,E.text.length-E.V6a),B.a.Yld())}bHh(){const E=B.a.QD.O5,u=B.a.QD.Hhb;if(E){if(0===u[n.a.status]){const J=(new Date).getTime();B.a.BZa.Idg(E.Pya,z.a.Yvf,J);B.a.oqg(E.Pya,!1);B.a.jbc(z.a.bbh);const G=B.a.BZa.ga(E.Pya)[z.a.Crc];u[n.a.Rsd]=J-G;B.a.Oua(E.qP,m.a.T_g,1);u[n.a.status]=6}B.a.Z3d(u)}}r7d(E,u,J){let G=null;u.Hx===E.id.toString()&&J&&u.K_b<J.length&&(E=J.substring(0,u.K_b)+
u.text,E=E.replace(RegExp("\\u00a0","g")," "),J=J.replace(RegExp("\\u00a0","g")," "),0<E.length&&0<J.length&&(E.indexOf(J)||(G=E.substring(J.length,E.length))));return G}static get RS(){return h.a.instance}}A.gWh=4;A.nwd=new Y.a;Object(I.a)(A,"WordPredictionAugLoopResponseManager",null,[])},912:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.Hx=this.Pya=this.id=null;this.qP=this.Znd=0;this.Q8=this.text=null;this.ZMb=this.k2e=this.l2e=this.score=this.V6a=this.K_b=
0;this.KJe=null}}Object(I.a)(h,"Candidate",null,[])},913:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(I.a)(h,"ActivateAnnotationParameters",null,[])},914:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);Y=d(609);var h=d(143);class e extends Y.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),
B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(I.a)(e,"TextPredictionAnnotation",Y.a,[])},915:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.operation=null}}Object(I.a)(h,"SubmitOperationParameters",null,[])},916:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,n,m){super();this.actionId=e;this.Bzb=n;this.revisionId=
m}}Object(I.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},917:function(I,Y,d){d.d(Y,"c",function(){return z});d.d(Y,"b",function(){return B});d.d(Y,"a",function(){return v});var h=d(18),e=d(387),n=d(27),m=d(36);const z=y=>{if(!y)return null;let A;try{A=m.b(y)}catch(E){A=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",E)}return A},B=(y,A)=>{let E=[];if(y.breadcrumbs&&0<y.breadcrumbs.length)E=y.breadcrumbs;else{const u=y.service_info;
u&&u.friendly_service_name&&Array.add(E,u.friendly_service_name);y.display_path&&Array.addRange(E,y.display_path)}return E.join(A?" \u00ab ":" \u200f\u00bb ")},v=(y,A=!1)=>{if(!y)return[];if(!y.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!y.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];y=y.documents.items;const E=new h.a;for(let J=0;J<y.length;J++){const G=y[J];var u=G.web_url;if(!u){e.ULS.sendTraceTag(578320064,202,
15,"Empty web_url");if(!G.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}u=String.format("{0}?web=1",G.url)}const S={};S.DocumentUrl=u;S.MruId=G.mru_id;{u=G;let P=u.title;P?(u.extension&&(P=String.format("{0}.{1}",P,u.extension)),u=P):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),u="")}S.FileName=u;S.IsPinned=G.is_pinned;S.Path=B(G,n.AFrameworkApplication.isRtl);A&&(S.App=G.app,S.TimeStamp=G.time_stamp);E.add(S)}return E.toArray()}},918:function(I,Y,d){d.d(Y,"a",function(){return y});
I=d(0);var h=d(387),e=d(1019),n=d(1200),m=d(14),z=d(18),B=d(40),v=d(35);class y{constructor(A,E,u,J,G,S,P,Q,D){this.BR=new e.a;this.rQg=A;this.Tb=E;this.hB=G;this.Fa=u;this.Yc=S;this.Kbc=P;this.Yl=J;this.Hh=Q;this.la=D;this.nDj()}get Jd(){return this.Yc.instance}get xF(){return this.Kbc.value}nDj(){this.BR.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.BR.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.BR.$(2,[ResourceStrings.l_PhTypeCenterTitle,
ResourceStrings.l_ClickToAddTitle]);this.BR.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.BR.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.BR.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.BR.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.BR.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.BR.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);
this.BR.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.BR.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.BR.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.BR.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}q6f(A,E){A&&(this.rda(A,E),A.zua?E.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.k9d(A,null,E));return null}cjj(A){if(!this.rQg.instance||!A)return null;
A=this.rQg.instance.v6f(A);if(!A||!A.length)return null;const E=A.length;return 1===E?String.format(ResourceStrings.l_ShapePresenceForOneUser,A[0].userName):2===E?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,A[0].userName,A[1].userName):3===E?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,A[0].userName,A[1].userName,A[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,E)}U$d(A){let E="";A&&A.VN&&A.image.title&&0<A.image.title.length&&(E=A.image.title);
A&&(E=String.format(ResourceStrings.l_ThumbnailInfoNew,A.slideIndex+1,this.Tb.pj(),E),A=this.wmj(A),0<A.length&&(E+=A));return E}wmj(A){const E=new Sys.StringBuilder;A.isSelected&&E.append(ResourceStrings.L_SlideIsSelected);A.en&&E.append(ResourceStrings.l_SlideIsHidden);const u=Object(n.a)(116,A.Fd);if(u){var J=u.$Sa();J&&!this.Yl.Cke(J)&&E.append(ResourceStrings.l_SlideHasNotes);(J=u.XD())&&this.hB.instance&&this.hB.instance.Uag(J)&&(J=this.hB.instance.RRc(J),E.append(1===J?ResourceStrings.l_SlideHasOneComment:
String.format(ResourceStrings.l_SlideHasCommentsWithCount,J)))}A.AQ&&E.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(A.Jhb&&(A=A.Jhb.M8())&&0<A.length)if(1===A.length)E.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,A[0].userName));else{J="";for(const G of A)J+=G.userName+",";E.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,J))}u&&u.isUnread&&E.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return E.toString()}T9a(A,E){return String.format(ResourceStrings.l_MultipleSlidesSelected,
A,E)}V7i(A,E){return String.format(ResourceStrings.l_DesignerSuggestionSelected,A+1,E)}Fjj(){return ResourceStrings.l_SlidePanel}qdj(){return ResourceStrings.l_MultipleShapes}GUk(A){A&&(this.la.R6a&&A.S5(Object(m.a)(this,this.u4i,"getCameoAccMessage")),A.S5(Object(m.a)(this,this.slj,"getTableAccMessage")),A.S5(Object(m.a)(this,this.caj,"getImageAccMessage")),A.S5(Object(m.a)(this,this.ycj,"getMediaAccMessage")),A.S5(Object(m.a)(this,this.K4i,"getChartAccMessage")),this.Ypd?(A.S5(Object(m.a)(this,
this.O6f,"getSmartArtAccMessage")),A.S5(Object(m.a)(this,this.k9d,"getPlaceHolderAccMessage"))):(A.S5(Object(m.a)(this,this.k9d,"getPlaceHolderAccMessage")),A.S5(Object(m.a)(this,this.O6f,"getSmartArtAccMessage"))),A.S5(Object(m.a)(this,this.lmj,"getTextboxAccMessage")),A.S5(Object(m.a)(this,this.Sij,"getShapeGroupAccMessage")),A.S5(Object(m.a)(this,this.Pij,"getShapeAccMessage")),A.S5(Object(m.a)(this,this.E2i,"getAddinAccMessage")),A.S5(Object(m.a)(this,this.j2i,"get3DAccMessage")))}k9d(A,E,u,J=
null){if(A&&u&&A.fl&&(this.DUc(A,u),E=A.get_altTitle(),this.BR.Hb(A.Hj))){J&&J(String.format("{0} {1}",this.BR.ga(A.Hj)[0],ResourceStrings.l_Placeholder));if(A.zT||!u.count){u=this.BR.ga(A.Hj)[0];J="";if(!this.Ypd||A.zT)J=this.BR.ga(A.Hj)[1];return String.format(A.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,u,E,J,A.get_alt())}A=String.format(A.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,
this.BR.ga(A.Hj)[0],E,A.get_alt());u.insert(0,document.createTextNode(A))}return null}lmj(A,E,u,J=null){if(A&&u&&A.px)if(this.DUc(A,u),J&&J(ResourceStrings.L_TextBox),0<u.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,A.get_altTitle(),A.get_alt()),u.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,A.get_altTitle(),
A.get_alt());return null}O6f(A,E,u,J=null){if(A&&u&&A.Rf)if(this.DUc(A,u),J&&J(ResourceStrings.L_SmartArt),0<u.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.Q6f(A)||"",A.get_altTitle(),A.get_alt()),u.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.Q6f(A)||"",A.get_altTitle(),A.get_alt());return null}rda(A,
E){A&&E&&this.Fa.LJ(A,u=>{u.Sa(B.a.pq)&&this.b3f(u,E)})}DUc(A,E){if(A&&E){const u=this.Ypd?new z.a:E;let J=!1;this.Fa.LJ(A,G=>{const S=this.Hh.YW(G),P=this.Hh.hhb(G);S&&u.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,P)));J=this.b3f(G,u)||J});this.Ypd&&J&&E.addRange(u);E.count||(A=A.o1e)&&E.add(document.createTextNode(A))}}get Ypd(){return v.a("AriaMessageHelper.FixAccMessageForEmptyList")}b3f(A,E){let u;const J=A.sa(B.a.$sc,null),G=A.sa(B.a.pq,"");if(G&&E){if(J){let S=
0,P=null,Q;for(let D=0;D<J.length+1;D++)Q=this.Fa.aTc(A,D),P&&P!==Q&&(u=document.createElement("span"),u.setAttribute("lang",P),u.innerText=G.substring(S,J[D-1]),S=J[D-1],E.add(u)),P=Q;u=document.createElement("span");P&&u.setAttribute("lang",P);u.innerText=G.substring(S,G.length)}else u=document.createElement("span"),(A=this.Fa.aTc(A,0))&&u.setAttribute("lang",A),u.innerText=G;E.add(u)}return!!G&&0<G.length}slj(A,E,u,J=null){return A&&A.ud?(J&&J(ResourceStrings.L_Table),String.format(A.get_alt()?
ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,A.get_altTitle(),A.get_alt())):null}caj(A,E,u,J=null){return A&&A.Fj?(J&&J(ResourceStrings.l_Image),String.format(A.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,A.get_altTitle(),A.get_alt())):null}u4i(A,E,u,J=null){if(!A||!A.sFa)return null;J&&J(ResourceStrings.l_Cameo);return A.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,A.get_altTitle(),A.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):
String.format(ResourceStrings.l_AccMessageCameo,A.get_altTitle(),ResourceStrings.l_CameoLearnMoreMessage)}ycj(A,E,u,J=null){if(A){if(0===A.mediaType)return null;if(1===A.mediaType)return J&&J(ResourceStrings.l_Audio),this.la.YP?String.format(ResourceStrings.l_AccMessageCanvasAudio,A.shapeName):String.format(A.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,A.get_altTitle(),A.get_alt());if(2===A.mediaType)return J&&J(ResourceStrings.l_Video),String.format(A.get_alt()?
ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,A.get_altTitle(),A.get_alt())}return null}K4i(A,E,u,J=null){return A&&A.hr?(J&&J(ResourceStrings.l_Chart),String.format(A.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.L4i(A)||"",A.get_altTitle(),A.get_alt())):null}Sij(A,E,u,J=null){return A&&A.Jf?(J&&J(ResourceStrings.L_GroupObjects),v.a("GroupShapeAltTitleFixEnabled")?String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:
ResourceStrings.l_AccMessageShapeGroup,A.ex().length,A.get_alt()):String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,A.get_altTitle(),A.get_alt())):null}Pij(A,E,u,J=null){if(A&&u&&A.zua&&!A.px)if(this.DUc(A,u),E=this.Fa.x6f(A),A.gFa&&(E=ResourceStrings.l_DecorativeLabel),J&&J(E||ResourceStrings.l_TextShape),0<u.count)A=String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,E||ResourceStrings.l_TextShape,
A.get_altTitle(),A.get_alt()),u.insert(0,document.createTextNode(A));else return String.format(A.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,E||ResourceStrings.l_TextShape,A.get_altTitle(),A.get_alt());return null}E2i(A,E,u,J=null){return A&&A.Dq&&this.Jd&&this.xF?(A=this.xF.b3(A),A=this.Jd.iwb(A.id),J&&J(A?A.nca:null),A?A.nca:null):null}j2i(A,E,u,J=null){return A&&A.U3?(J&&J(ResourceStrings.l_3DModel),String.format(A.get_alt()?ResourceStrings.l_AccMessage3DAlt:
ResourceStrings.l_AccMessage3D,A.get_altTitle(),A.get_alt())):null}Q6f(A){return A.smartArtInfo?y.X9d(A.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(h.ULS.sendTraceTag(588375196,815,10,"SmartArt {0}#{1} has no SmartArtInfo",A.slideId?A.slideId.toString():"",A.get_shapeId()),null)}L4i(A){return y.X9d(A.htb,0,102,"L_ChartType")}djj(A,E){return(A=this.Fa.UTc(A))&&E?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,E,A):null}static kmj(A){return y.X9d(A,1,177,"L_SAType")}static X9d(A,
E,u,J){return A>=E&&A<=u&&(A=ResourceStrings[J+A])?A:null}}Object(I.a)(y,"AriaMessageHelper",null,[1046])},919:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n=null,m=null,z=null,B=!1,v=null){this.DisplayName=this.ClientId=this.Provider=this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=n;this.DisplayName=m;this.Email=z;this.IsAnonymous=B;this.ClientId=v}}Object(I.a)(h,"Person",null,[])},920:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{static v8k(){}static mJi(){}}h.sendTraceTag=h.v8k;h.debugAssertTag=h.mJi;Object(I.a)(h,"BULS",null,[])},921:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(1009),e=d(27),n=d(166),m=d(57);class z{constructor(B,v,y,A,E,u){this.Pba=B;this.Qba=v;this.sCd=y;this.sP=A;this.Gxc=E;this.Nmb=u}get uvh(){return!this.Qba&&!this.sCd}get L0g(){return 2===this.Nmb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get SSf(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Mcg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get WTa(){return CommonUIStrings.l_OICErrorHelpLink}get Nbg(){return"OICFailure"}get icon(){return 3}get yrf(){return 2===
this.Nmb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get sRa(){return CommonUIStrings.l_DefaultDialogTitle}sQk(B){this.V0g(B)}OZj(B){this.V0g(B)}V0g(B){let v=10;1===B?(m.a.instance.resolve("Common.IOfficeTrialExperience").wne(this.Nmb),v=3):2===B&&((!this.sCd||this.sCd(this.sP))&&this.Qba&&h.a.instance.fFi(this.Qba,this.Pba,this.sP),v=5);(0===B||1===B)&&this.Pba&&this.Pba(this.sP);e.AFrameworkApplication.Oib(n.a.C7g,this.Gxc,v);this.dispose()}dispose(){this.sP=
this.Qba=this.Pba=null}}Object(I.a)(z,"AOICErrorDialogWithTrial",null,[106])},922:function(I,Y,d){d.d(Y,"b",function(){return m});d.d(Y,"g",function(){return z});d.d(Y,"d",function(){return B});d.d(Y,"f",function(){return y});d.d(Y,"e",function(){return A});d.d(Y,"c",function(){return E});d.d(Y,"a",function(){return u});var h=d(27);d(715);var e=d(1117),n=d(522);d(470);const m=()=>h.AFrameworkApplication.isEmbedded,z=()=>{const J=h.AFrameworkApplication.Aa.hb.$N;return!m()&&!h.AFrameworkApplication.hideHeader&&
n.a()&&(J||1===h.AFrameworkApplication.h0i)},B=()=>h.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),v=()=>h.AFrameworkApplication.vuh&&!m()&&!h.AFrameworkApplication.hideHeader,y=()=>v()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ga(h.AFrameworkApplication.eK)||"").toLowerCase()&&!h.AFrameworkApplication.Sbg,A=()=>!h.AFrameworkApplication.uce&&v(),E=()=>!m()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),u=()=>{if(h.AFrameworkApplication.lcg)return null;
var J=!!h.AFrameworkApplication.Aa&&h.AFrameworkApplication.Aa.hb.$N;if((h.AFrameworkApplication.ple&&h.AFrameworkApplication.m_a||h.AFrameworkApplication.Euc)&&J)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(265).CuiHelper.Mld});if(h.AFrameworkApplication.workflowEnabled){J="";switch(h.AFrameworkApplication.evc){case "Assign":J=CommonUIStrings.l_Assign;break;case "Submit":J=CommonUIStrings.l_Submit}if(""!==J)return Object.assign(new e.a,{command:"2988588587",
label:J,id:"btnWorkflow"})}return null}},923:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}Object(I.a)(h,"RibbonPeripheralSection",null,[])},924:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.isForAlertableKpi=this.extendedProperties=null}}Object(I.a)(h,"IKpiUsageOptionalProperties",null,[])},925:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=
null}}Object(I.a)(h,"KpiUsageParams",null,[])},926:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.doNotEmitAggregatedCount=this.areaName=this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(I.a)(h,"FeatureUsageAndHealthConfig",null,[])},927:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(I.a)(h,"ImageProps",null,[])},928:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(I.a)(h,"CalloutParameters",null,[])},929:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}Object(I.a)(h,"ICalloutProps",null,[])},930:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";Object(I.a)(h,"ComboBoxCommandProperties",null,[])},931:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl="IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(I.a)(h,"GalleryButtonCommandProperties",null,[])},932:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(241);class h extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.IconName=this.Label=null}get ControlType(){return 12}}Object(I.a)(h,"ErrorViewProps",d.a,[])},933:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(241);class h extends d.a{constructor(){super();this.Items=null}get ControlType(){return 13}}Object(I.a)(h,"AddInListProps",d.a,[])},934:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}
Object(I.a)(h,"PersonaInfo",null,[])},935:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}Object(I.a)(h,"PersonaIdentifiers",null,[])},936:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.gm=e}f5d(e){const n=[];if(e)for(let B in e){var m=B,z=e[B];const v=this.gm.M6d(m);if(v)for(let y of v)n.push(appChrome.actions.updateControlHiddenState(y,z));else if(m=this.gm.B$i(m))for(const y of m)if(y.externalUxCommandIds)for(const A of y.externalUxCommandIds)n.push(appChrome.actions.updateControlHiddenState(A,
z));else n.push(appChrome.actions.updateGroupHiddenState(y.externalUxGroupId,z))}return n}u2i(e){const n=[];if(e)for(let m in e){if(!e[m])continue;const z=m;z&&n.push(appChrome.actions.deactivateRibbonTab(z))}return n}}Object(I.a)(h,"ReactRibbonTrimmingHelper",null,[])},937:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(I.a)(h,"InsightsParameters",null,[])},938:function(I,Y,d){d.d(Y,"a",function(){return h});
I=d(0);class h{}h.hMf="data-ccp-timestamp";h.iMf="data-clipservice-ccpid";h.mMf="data-shapeids";h.s9f="docs-internal-guid-";h.m7g="SCXO";h.Aah="SCXP";h.OJh="SCXW";h.b_g="MsoListParagraphCxSpFirst";h.c_g="MsoListParagraphCxSpLast";Object(I.a)(h,"HtmlContentMetadataConstants",null,[])},939:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.GJj=e.IsBeforeReady;this.BNj=e.IsFromEndOfSlideshow;
this.summary=e.Summary}}Object(I.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},940:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(I.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},941:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(I.a)(h,"OnBrowserEventArgs",Sys.EventArgs,
[])},942:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.stc=e.TimeLineMappings}}Object(I.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},943:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.Jwh=e.SlideLeftBound;this.Gwh=e.SlideBottomBound}}Object(I.a)(h,
"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},944:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(I.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},945:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(I.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},946:function(I,
Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(I.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},947:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.stc=e.TimeLineMappings}}Object(I.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},948:function(I,
Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(1200);class e extends Sys.EventArgs{constructor(n){super();this.ECh=null;this.ECh="string"===typeof n?Object(h.a)(String,n):n.TranscriberSessionId}}Object(I.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},949:function(I,Y,d){d.d(Y,"a",function(){return y});I=d(0);var h=d(387),e=d(270),n=d(27),m=d(174),z=d(55),B=d(47),v=d(226);class y{static g7f(A){const E={};E.appSettings=y.WBi();E.singleSignOnSettings=y.E6f();E.appVersion="16";E.appUILocale=
e.a.xe(n.AFrameworkApplication.lcid).Svb;E.dataLocale=e.a.xe(n.AFrameworkApplication.lcid).Svb;E.osfOmexBaseUrl=n.AFrameworkApplication.fa.Ga("50");E.firstPartyManifestCDNUrl=n.AFrameworkApplication.fa.Ga("565");E.sdxCdnUrl=n.AFrameworkApplication.fa.Ga("649");E.sdxDmsUrl=n.AFrameworkApplication.fa.Ga("650");E.sdxAssetsToPrefetchMapping=n.AFrameworkApplication.fa.Ga("974");E.docUrl=A?A.documentUrl:"";E.pageBaseUrl=m.a.iP;E.lcid=n.AFrameworkApplication.lcid.toString();E.allowExternalMarketplace=n.AFrameworkApplication.fa.ka("51");
E.localizedScriptsUrl=m.a.iP+n.AFrameworkApplication.fa.Ga("52");A=A?A.hdg:"";E.localizedImagesUrl=m.a.iP+A;E.localizedStylesUrl=m.a.iP+A;E.localizedResourcesUrl=m.a.H3h(A);E.enableAddinCommands=n.AFrameworkApplication.fa.ka("203");E.enableMyApps=n.AFrameworkApplication.fa.ka("186");E.enableMyOrg=n.AFrameworkApplication.fa.ka("187");E.enableUploadFileDevCatalog=n.AFrameworkApplication.fa.ka("203")&&!n.AFrameworkApplication.fa.ka("847");E.enableDevCatalog=n.AFrameworkApplication.fa.ka("221");E.devCatalogUrl=
n.AFrameworkApplication.fa.Ga("220");E.enablePrivateCatalog=n.AFrameworkApplication.fa.ka("305");E.showSignOutFromPrivateCatalogMessage=n.AFrameworkApplication.fa.ka("307");E.enableBlackForestRedirect=n.AFrameworkApplication.fa.ka("348");E.enableSingleSignOnForAddin=n.AFrameworkApplication.fa.ka("342")&&n.AFrameworkApplication.gJj;E.enableTaskpaneUpgradeToAppCommand=n.AFrameworkApplication.fa.ka("381");E.hideAppsExtensionUrl=n.AFrameworkApplication.hideAppsExtensionUrl;E.enableAnonymousUseLegacyCatalogService=
n.AFrameworkApplication.fa.ka("549");E.enableInsertDialogAccessibilityFix=n.AFrameworkApplication.fa.ka("584");E.enableFirstPartySDXErrorMessages=n.AFrameworkApplication.fa.ka("677");E.disableAppsForOfficeThirdParty=n.AFrameworkApplication.fa.ka("569");E.wacSessionId=n.AFrameworkApplication.userSessionId;E.disableLogging=!n.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");E.loggableUserId=n.AFrameworkApplication.fa.Ga("LoggableUserId");E.sessionStartInfoJson=n.AFrameworkApplication.fa.Ga("SessionStartInfoJson");
E.wopiHostOriginFromPostMessage=n.AFrameworkApplication.wopiHostOriginFromPostMessage;E.wopiHostOriginFromWacPropBag=n.AFrameworkApplication.fa.Ga("PostMessageOrigin");E.wacIsEmbedded=n.AFrameworkApplication.fa.ka("IsEmbedded");E.accessibilityAllowFocusAddinTaskpane=n.AFrameworkApplication.fa.ka("1055");E.disableMicrophonePermission=z.a.bO(1)&&n.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&n.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");E.isHostFrameTrustCheckEnabledForAddIns=
n.AFrameworkApplication.fa.ka("1100");E.isHostFrameTrusted=n.AFrameworkApplication.isHostFrameTrusted;E.hostAllowedSdxEmbedding=n.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");E.hostAllowedOfficeStore=n.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");E.hostInstallAddIns=n.AFrameworkApplication.fa.Ga("HostInstallAddIns");E.hostInstallAddInsIsEnabled=n.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");E.approvedAddIns=n.AFrameworkApplication.fa.Ga("ApprovedAddIns");E.isUpnCheckEnabled=
n.AFrameworkApplication.fa.ka("1132");E.wacUpn=n.AFrameworkApplication.fa.Ga("UserPrincipalName");E.isReactRibbonEnabled=!0;E.enableSetFocusOnTaskpaneOnUserAction=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);E.enableMyOrg&&E.docUrl&&(A=E.docUrl.split("/"),E.spBaseUrl=2<A.length?A[0]+"//"+A[2]:null,E.spBaseUrl||h.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",E.docUrl)));
E.userNameHashCode=B.a.qN(n.AFrameworkApplication.userName);E.envCode=n.AFrameworkApplication.fa.Bc("312",0).toString();return E}static WBi(){const A={};A.AddinRibbonIdAllowUnknown=n.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");A.AddinRibbonNativeGroupControlIsEnabled=!0;A.AddinRibbonTabAutoFocusIsEnabled=!0;A.AddinRibbonTabPositionIsEnabled=!0;A.AgaveAddinUploadEnabled=n.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");A.DevConsoleEnabled=n.AFrameworkApplication.fa.ka("AddinDevConsoleLog");
A.ManifestParserDevConsoleEnabled=!0;A.flightingTreatmentVariables=n.AFrameworkApplication.fa.hQc;return A}static E6f(){try{const A={};z.a.NFa&&v.OAuthManagerSettings.Q$a&&(A.UiHostSupportsAuthTokenAddinList=y.dQc);A.UiHostSupportsAuthToken=v.OAuthManagerSettings.Q$a;return A}catch(A){h.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",A.message)}return null}}y.dQc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
Object(I.a)(y,"AppForOfficeHelper",null,[])},950:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.z_g=e}}Object(I.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},951:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n,m){this.pYa={};this.i9c=e;this.dDb=n;this.oec=m}Gta(e,n,m,z){n=h.LMf;if(this.dDb)if(this.oec){const B=e.UserId?e.UserId.toLowerCase():null;m=m?m.toLowerCase():null;n=B&&B in this.pYa?
this.pYa[B]:m&&m in this.pYa?this.pYa[m]:this.i9c.Gta(e,z);!B||B in this.pYa||(this.pYa[B]=n);!m||m in this.pYa||(this.pYa[m]=n)}else n=this.i9c.Gta(e,z);return n}}h.LMf="#C0C0C0";Object(I.a)(h,"PresenceColorProvider",null,[307])},952:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.lG=e}}Object(I.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},953:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(1149),e=d(27),n=d(36),
m=d(80);class z{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}sLb(){return n.c([this.Zk(),this])}execute(B,v,y){let A="RoamingAppsHandler.ashx";h.a.instance.WSe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(A=m.a.Ki(A,"wdEnableRoaming","1"));e.AFrameworkApplication.Ke.mj(A,2,this.sLb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.kxb(),B,v,y,void 0,void 0,void 0,void 0,"6")}}Object(I.a)(z,"ARoamingAppsRequest",null,[])},954:function(I,Y,d){d.d(Y,"a",
function(){return 2});d.d(Y,"c",function(){return h});d.d(Y,"b",function(){return e});const h=(n,m,z=2)=>{let B;if(0>m||m>n[n.length-1])throw Error.argumentOutOfRange("y");B=!0;let v=0,y;const A=n.length-1;for(y=0;y<A;y++){const E=v;v=n[y+1];if(m<v){v-m<z&&y<A-1?y++:m-E>=z&&(B=!1);break}}return{returnValue:y<A?y:-1,Ike:B}},e=(n,m,z=2)=>{let B;if(0>m||m>n[n.length-1])throw Error.argumentOutOfRange("x");B=!0;let v=0,y;const A=n.length-1;for(y=0;y<A;y++){const E=v;v=n[y+1];if(m<v){v-m<z&&y<A-1?y++:m-
E>=z&&(B=!1);break}}return{returnValue:y<A?y:-1,Ike:B}}},955:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.NQa=this.sW=0;this.skipUndo=!1;this.Gp=this.selectionSlide=null;this.version=0;this.tD=this.location=null;this.dataType=0;this.Cjc=null;this.objectCount=0;this.iFa=this.kFa=!1;this.zy=this.Msa=this.nodes=null}toString(){const e=JSON.stringify(this.Msa);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",
this.Gp,this.version,this.tD,this.dataType,this.objectCount,this.kFa,this.iFa,e,this.sW)}}Object(I.a)(h,"ClipServiceObject",null,[])},956:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n){this.Bu=e;this.Wb=n}}Object(I.a)(h,"ClipServiceCopyParams",null,[])},957:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(387),e=d(97);Y=d(1130);var n=d.n(Y),m=d(910);class z{static Kod(B,v,y){if(B&&y&&(e.a.rCa(B),v&&""!==v))try{m.a("HtmlStringSanitizeByDomPurify")&&(v=
n.a.sanitize(v));const A=z.pQh.parseFromString(v,"text/html");if(A&&A.body){const E=A.body.childNodes;for(v=0;v<E.length;v+=1)B.appendChild(E[v].cloneNode(!0))}}catch(A){h.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",y,A.message)}}}z.pQh=new DOMParser;Object(I.a)(z,"DOMParserHelper",null,[])},958:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(14),e=d(75),n=d(67),m=d(134);class z extends Sys.UI.Control{constructor(B,v,y,A){super(document.createElement("div"));
this.V6=this.T6=this.cF=this.C2a=this.kS=this.RMa=this.BOa=null;this.VSb=this.ENa=!1;this.content=this.YB=null;this.gba=0;this.hzf=null;this.RZ=0;this.dgd=null;this.ypf=B;this.opb=v;this.GP=y;this.CVd=A;this.ii=v.ownerDocument;this.Q7b=this.Ar=this.DTb=!1}get IJ(){this.BOa||(this.BOa=this.ii.createElement("div"),this.BOa.id=this.Nh("WACCalloutOuter"),this.BOa.className="WACCalloutOuter",this.BOa.setAttribute(m.a.ef,m.a.yRd),this.BOa.style.width=this.gba+"px");return this.BOa}get dsb(){if(!this.RMa){this.RMa=
this.ii.createElement("div");this.RMa.id=this.Nh("WACCalloutBeakContainer");this.RMa.className="WACCalloutBeakContainer";var B="CalloutBeakTopFilled_32x16x32";if(5===this.RZ||6===this.RZ||4===this.RZ)B="CalloutBeakBottomFilled_32x16x32";B=e.createClusteredImage(32,16,B,"WACCalloutBeak",!0,"");this.RMa.appendChild(B)}return this.RMa}set dsb(B){this.RMa=B}get yL(){return this.DTb}get title(){return this.YB}set title(B){this.YB!==B&&(this.YB=B,this.T6&&(this.T6.innerText=this.YB))}get Ar(){return this.ENa}set Ar(B){this.ENa!==
B&&(this.ENa=B,this.kS&&(this.kS.contains(this.cF)&&!this.ENa?this.kS.removeChild(this.cF):!this.kS.contains(this.cF)&&this.ENa&&this.csf()))}get Q7b(){return this.VSb}set Q7b(B){this.VSb!==B&&(this.VSb=B,this.kS&&(this.kS.contains(this.T6)&&!this.VSb?this.kS.removeChild(this.T6):!this.kS.contains(this.T6)&&this.VSb&&this.Ctf()))}show(){this.DTb||(this.dDi(),this.sgi(),this.opb.appendChild(this.IJ),this.IJ.style.display="Block",this.kWe(),this.DTb=!0,this.dgd&&this.dgd())}dismiss(){this.DTb&&(this.ALi(),
this.opb.removeChild(this.IJ),this.DTb=!1,this.CVd&&this.CVd())}dispose(){this.dismiss();this.T6=this.cF=this.C2a=this.RMa=this.kS=this.BOa=null;Sys.Component.prototype.dispose.call(this)}Nh(B){return this.get_element().id+B}dDi(){this.kS=this.ii.createElement("div");this.kS.id=this.Nh("WACCalloutHeader");this.kS.className="WACCalloutHeader";this.Ar&&this.csf();this.Q7b&&this.Ctf();this.C2a=this.ii.createElement("div");this.C2a.id=this.Nh("WACCalloutContent");this.C2a.className="WACCalloutContent";
this.C2a.style.width=190<this.gba?this.gba-26+"px":"164px";this.C2a.appendChild(this.content);this.IJ.appendChild(this.dsb);this.IJ.appendChild(this.kS);this.IJ.appendChild(this.C2a)}csf(){this.cF=this.ii.createElement("a");this.cF.className="WACCalloutCloseAnchor";this.cF.id=this.Nh("WACCalloutCloseAnchor");this.cF.href="#";this.kS.appendChild(this.cF);const B=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.cF.appendChild(B)}Ctf(){this.T6=
this.ii.createElement("div");this.T6.className="WACCalloutTitle UIFontBold";this.T6.style.width=190<this.gba?this.gba-30+"px":"160px";this.T6.id=this.Nh("WACCalloutTitle");this.T6.innerText=this.title;this.kS.contains(this.cF)?this.kS.insertBefore(this.T6,this.cF):this.kS.appendChild(this.T6)}kWe(){var B=this.ypf;let v;if(1===this.RZ){var y=this.hzf.y+16;v=-16}else 2===this.RZ||3===this.RZ||0===this.RZ?(y=B.y+B.height+15,v=-15):(y=B.y-this.IJ.clientHeight-15-2,v=this.IJ.clientHeight-1);this.IJ.style.top=
y+"px";this.dsb.style.top=v+"px";1===this.RZ?(B=this.hzf.x-16,this.IJ.style.left="50%",this.IJ.style.marginLeft=-this.gba/2+"px",y=Sys.UI.DomElement.getBounds(this.IJ),this.dsb.style.left=B-y.x+"px"):(y=B.x+this.ypf.width/2,2===this.RZ||5===this.RZ?(B=20,y-=36):0===this.RZ||4===this.RZ?(B=this.gba/2-16,y-=this.gba/2):(B=this.gba-20-32,y=y-this.gba+36),this.IJ.style.left=y+"px",this.dsb.style.left=B+"px")}sgi(){this.Ar&&!this.V6&&(this.V6=Object(h.a)(this,this.Z2,"closeHandler"),this.GP.pb(n.a.click,
this.cF,this.V6,null))}ALi(){this.Ar&&this.V6&&(this.GP.yb(n.a.click,this.cF,this.V6),this.V6=null)}Z2(){this.dismiss();return!0}}Object(I.a)(z,"Callout",Sys.UI.Control,[961])},959:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=
this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(I.a)(h,"CT_LineProperties",null,[])},960:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(I.a)(h,"CT_PresetLineDashProperties",null,[])},961:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e){this.dgk=e}get erc(){return this.dgk}}Object(I.a)(h,
"ShowHideNotesData",null,[])},962:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(892);class h extends d.a{constructor(e,n){super(n);this.WGg=e;this.Qdb=0}yUf(){const e=(new Date).getTime(),n=e-this.Qdb;if(0<this.Qdb&&0>=this.WGg-n)return this.Qdb=0,this.jUd(),!0;this.Qdb=e;this.jUd();this.setTimeout(this.WGg);return!1}}Object(I.a)(h,"FunctionDelayer",d.a,[])},963:function(I,Y,d){d.d(Y,"b",function(){return e});d.d(Y,"a",function(){return n});d.d(Y,"c",function(){return m});var h=d(47);
d(402);d(29);d(61);const e=(z,B)=>{const v=[];if(z.length!==B.length)return v;for(let y=0;y<z.length;y++){const A={};A.key=B[y];A.text=z[y];A.type="AppComboBoxItem";v[y]=A}return v},n=(z,B,v,y,A)=>({["unitType"]:z,["unitPlaceholder"]:h.a.LKe(B),["minValue"]:v,["maxValue"]:y,["step"]:A}),m=z=>"1.00"===z?1:"1.50"===z?1.5:"2.00"===z?2:0},964:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{static add(e,n,m,z,B){h.ysg[h.$Yf(e,n,m,z,B)]=!0}static contains(e,n,m,z,B){return h.$Yf(e,n,m,z,
B)in h.ysg}static $Yf(e,n,m,z,B){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),n,m.toLowerCase(),z.toLowerCase(),B.toLowerCase())}}h.ysg={};Object(I.a)(h,"AppsInsertedStorage",null,[])},965:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.myAddins=0]="myAddins";e[e.adminManaged=1]="adminManaged";e[e.popular=2]="popular"})(h||(h={}));Object(I.b)("AddinCollectionType",h)},966:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{}Object(I.a)(h,"AppsForOfficeEntitlementQueryInfo",
null,[])},967:function(I,Y,d){d.d(Y,"a",function(){return E});I=d(0);var h=d(105),e=d(1200),n=d(40),m=d(42),z=d(32),B=d(84),v=d(247),y=d(39),A=d(968);class E{static UBi(u,J,G){u=Object(e.a)(B.a,u.createInstance(1074135137));E.btf(u,J,G);return u}static z4h(u,J){z.GraphIterator.nb(u).Cl(J,19)}static btf(u,J,G){u.setValue(m.a.lHc,0===J.targetType);u.setValue(m.a.Crb,J.solutionId);u.setValue(m.a.qHc,J.version);u.setValue(m.a.dZb,J.storeType);u.setValue(m.a.pHc,J.storeId);u.setValue(y.a.cZb,G.WKc(J.storeType));
J.assetId&&u.setValue(y.a.vQd,J.assetId);u.setValue(y.a.cwf,J.assetStoreId);void 0===J.isAddinCommands?u.setValue(y.a.isAddinCommands,!1):u.setValue(y.a.isAddinCommands,J.isAddinCommands);J.sharedRuntimeId&&-1!==J.backgroundState&&(u.setValue(y.a.asb,J.backgroundState),u.setValue(y.a.z6a,J.sharedRuntimeId));0===J.targetType&&(u.setValue(y.a.Dq,!0),G=J.height?J.height:200,u.setValue(n.a.rx,J.width?J.width:200),u.setValue(n.a.HC,G))}static TFh(u,J,G){const S=h.a.Bqc(G);A.b(J,Q=>{Q=Q.eb(m.a.nHc);return!!Q&&
!(Q in S)});A.a(J,(Q,D)=>{const O=D.eb(m.a.nHc);O&&O in S&&(E.VBl(D,S[O],Q),delete S[O])});const P=z.GraphIterator.nb(J);h.a.forEach(S,(Q,D)=>{P.Cl(E.VBi(u,Q,D),21)},null)}static VBi(u,J,G){u=Object(e.a)(B.a,u.createInstance(1074135139));u.setValue(m.a.nHc,J);u.setValue(m.a.oHc,G);return u}static VBl(u,J,G){u.setValue(m.a.oHc,J);G.sa(m.a.lHc,!0)?v.d(G,u,E.C4k):v.d(G,u,E.V4k)}}E.C4k=[y.a.sid,y.a.cid,y.a.shapeId];E.V4k=[m.a.Crb];Object(I.a)(E,"AppEditor",null,[])},968:function(I,Y,d){d.d(Y,"a",function(){return n});
d.d(Y,"b",function(){return m});var h=d(32),e=d(969);const n=(z,B)=>{const v=new h.GraphIterator;v.set(z);let y=v.Bb(21);for(;y;)e.a(y)&&B(z,y),y=v.Cf(21)},m=(z,B)=>{const v=new h.GraphIterator;v.set(z);let y=v.Bb(21);for(;y&&y!==z;)y=e.a(y)&&B(y)?v.tRa(21):v.Dj(21)}},969:function(I,Y,d){d.d(Y,"b",function(){return e});d.d(Y,"a",function(){return n});var h=d(42);const e=(m,z)=>{z[m.eb(h.a.nHc)]=m.eb(h.a.oHc)},n=m=>1074135139===m.Ue},970:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=
d(47),e=d(93),n=d(28),m=d(35);class z{constructor(B){this.Zma=null;this.vfc=0;this.zdc=B;switch(this.zdc){case "audio":this.Zma=z.vik;this.vfc=z.P5j;break;case "captions":this.Zma=z.wik;this.vfc=z.e6j;break;case "video":this.Zma=z.xik;this.vfc=z.Fik;break;default:n.a.J(509727835,822,10,"Invalid file type")}}static set SHl(B){z.xik=B}static set NIl(B){z.Fik=B}qri(B){switch(this.zdc){case "audio":return z.ori(B);case "captions":return z.pri(B);case "video":return m.a("DisableVideoAsFileCheck")?new Promise(v=>
{v(!0)}):z.rri(B);default:return n.a.J(509727834,822,10,"Invalid file type"),new Promise(v=>{v(!1)})}}fIl(B){B=h.a.qg(B);for(let v=0;v<this.Zma.length;++v){const y=this.Zma[v];if(y&&0<y.length&&B.endsWith(y))return!0}return!1}gIl(B){return B<=1048576*this.vfc}static ori(B){return new Promise((v,y)=>{if(B&&B.size){var A=document.createElement("video"),E=URL.createObjectURL(B);A.setAttribute("src",E);e.a.addHandler(A,"loadedmetadata",()=>{URL.revokeObjectURL(E);const u=A.videoHeight,J=A.videoWidth;
0<A.duration&&!u&&!J?v(!0):(n.a.J(509727832,822,10,"Invalid audio File"),v(!1))});e.a.addHandler(A,"error",()=>{URL.revokeObjectURL(E);n.a.J(509727831,822,10,"Invalid audio File");y(ResourceStrings.L_InvalidAudioFileError)})}else n.a.J(509727833,822,10,"Empty media File"),v(!1)})}static pri(B){return new Promise((v,y)=>{if(B&&B.size){var A=URL.createObjectURL(B),E=document.createElement("video"),u=document.createElement("track");E.appendChild(u);e.a.addHandler(u,"load",()=>{URL.revokeObjectURL(A);
v(!0)});e.a.addHandler(u,"error",()=>{URL.revokeObjectURL(A);n.a.J(509727829,822,10,"Invalid captions File");y(ResourceStrings.l_InvalidCaptionsFileError)});u.setAttribute("src",A);u.setAttribute("default","true")}else n.a.J(509727830,822,10,"Empty captions File"),v(!1)})}static rri(B){return new Promise((v,y)=>{if(B&&B.size){var A=document.createElement("video"),E=URL.createObjectURL(B);A.setAttribute("src",E);e.a.addHandler(A,"loadedmetadata",()=>{URL.revokeObjectURL(E);const u=A.videoHeight,J=
A.videoWidth;0<A.duration&&0<u&&0<J?v(!0):(n.a.J(509727837,822,10,"Invalid video File"),v(!1))});e.a.addHandler(A,"error",()=>{URL.revokeObjectURL(E);n.a.J(509727836,822,10,"Invalid video File");y(ResourceStrings.L_InvalidVideoFileError)})}else n.a.J(509727838,822,10,"Empty media File"),v(!1)})}static B1f(B){return B&&B.value?B.files[0].size.toString():"Invalid number of files"}static R6d(B){if(!B||!B.value)return"Input file name is null";const v=B.value.lastIndexOf(".");return-1===v?"":B.value.substring(v+
1,v+5)}}z.P5j=16;z.e6j=16;z.wik=[".vtt"];z.vik=[".mp3",".wav",".m4a",".aac",".oga"];Object(I.a)(z,"MediaValidationHelper",null,[])},971:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e){super();this.jUf=e}}Object(I.a)(h,"CommentContainersChangedEventArgs",Sys.EventArgs,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.ext.js.map