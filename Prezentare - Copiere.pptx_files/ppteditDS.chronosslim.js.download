'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1036:function(I,Y,d){I=d(0);var h;(function(n){n[n.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";n[n.peopleImageClassName=1]="peopleImageClassName";n[n.peopleImageClusterPath=4]="peopleImageClusterPath";n[n.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";n[n.imageDimension=6]="imageDimension";n[n.rtl=8]="rtl";n[n.pointerInputManager=9]="pointerInputManager";n[n.clickInputManager=
10]="clickInputManager";n[n.vertical=11]="vertical";n[n.zIndex=12]="zIndex";n[n.contextMenuInputManager=13]="contextMenuInputManager";n[n.imageDomElement=14]="imageDomElement";n[n.useIdleTooltip=15]="useIdleTooltip";n[n.viewportBoundsCallback=16]="viewportBoundsCallback";n[n.flipHorizontalDirection=17]="flipHorizontalDirection";n[n.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";n[n.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";n[n.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(I.b)("PresenceTooltipSettingKeys",h);d.d(Y,"a",function(){return e});class e{constructor(){this.Ny={}}get(n,m=null){n=h[n];return"number"===typeof m?(m=this.Ny[n])?Number.parseInvariant(m.toString()):0:this.Ny[n]}add(n,m){this.Ny[h[n]]=m}MD(n,m){h[n]in this.Ny||(this.Ny[h[n]]=m)}remove(n){delete this.Ny[h[n]]}}Object(I.a)(e,"PresenceTooltipSettings",null,[])},1047:function(I,Y,d){I=d(0);class h{constructor(n,m,z){this.xPc=n;this.sFh=m;this.R5e=z}}Object(I.a)(h,"ThemeData",null,[]);
d.d(Y,"a",function(){return e});class e{}e.bza=[new h("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",4),new h("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new h("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new h("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new h("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new h("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new h("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new h("0507925b-6ac9-4358-8e18-c330545d08f8",
"Slice",4),new h("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new h("98dff888-2449-4d28-977c-6306c017633e","Banded",4),new h("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new h("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new h("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new h("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new h("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new h("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new h("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
"Celestial",4),new h("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new h("4c5440d6-04d2-4954-96cf-f251137069b2","Metropolitan",8),new h("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new h("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new h("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new h("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(I.a)(e,"DesignManager_data",null,[])},1144:function(I,Y,d){I=d(0);var h=d(14),e=d(1200),n=d(237),m=d(238),z=d(67),B=d(97);class v extends n.a{constructor(D,
O){super(D);this.Df=null;this.lI=O.get(8,!1);this.dS=O.get(6,0);this.element=D;this.element.className=v.W8a;this.D5a=this.createElement("ul");this.element.appendChild(this.D5a);this.Ln=O.get(10);this.Ln.pb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.$o=O.get(9);this.$o.pb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut"));this.$o.pb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"));this.bN=O.get(13);this.bN.pb(this.element,
Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior"))}bW(D){this.addHandler(m.a.kp,D)}g1(D){this.removeHandler(m.a.kp,D)}get bba(){return this.Df}dispose(){this.element&&(this.Ln.yb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.$o.yb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.$o.yb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut")),this.bN.yb(this.element,Object(h.a)(this,this.Px,
"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(D,O,X){this.hide();!D||0>=D.length||(this.lI?this.element.style.right=O+"px":this.element.style.left=O+"px",this.element.style.top=X+"px",this.aPd(D),this.visible=!0)}aPd(D){this.Df=D;B.a.Au(this.D5a);for(let O=D.length-1;0<=O;O--)this.Xx(D[O])}Xx(D){const O=document.createElement("li");O.style.backgroundColor=D.color;O.style.height=this.dS+"px";O.id="fly_"+D.clientId;O.style.lineHeight=this.dS+"px";B.a.Nx(O,
D.userName);O.setAttribute("dir","auto");this.D5a.appendChild(O)}onClick(){this.hide();return!1}yz(D){this.raiseEvent(m.a.kp,new m.a(3,D));return!1}}v.W8a="prFlyout UIFont";Object(I.a)(v,"PresenceTooltipFlyoutControl",n.a,[]);var y=d(75);class A extends n.a{constructor(D,O,X){super(D);this.gN=null;this.Df=[];this.element.className="prGlyph";this.Jc=O;this.v7=this.Jc.get(9);this.yn=this.Jc.get(10);this.bN=this.Jc.get(13);this.Jce();this.Xx(X);this.E3a=!1}get TO(){return this.Df.length}get bba(){return this.Df}bW(D){this.addHandler(m.a.kp,
D)}g1(D){this.removeHandler(m.a.kp,D)}dispose(){this.Y3e();super.dispose()}Xx(D){Array.add(this.Df,D);2===this.TO?this.Zaa(!0):1===this.TO?this.Zaa(!1):this.Zaa(this.E3a)}RJ(D){this.q3d(D)&&(1<this.TO&&this.Zaa(!0),1===this.TO?this.Zaa(!1):1>this.TO&&this.hide())}show(){this.Zaa(2<=this.TO);this.visible=!0}hide(){this.visible=!1}F7d(D){return D?this.k5b(0,5):this.k5b(1,4)}q3d(D){for(let O=0;O<this.TO;O++)if(this.Df[O].clientId===D)return D=this.Df[O],Array.removeAt(this.Df,O),D;return null}Zaa(D){this.E3a!==
D&&(this.gN&&this.element.removeChild(this.gN),this.gN=this.F7d(D),this.element.appendChild(this.gN),this.E3a=D);this.gN.childNodes[0].style.backgroundColor=this.Df[this.Df.length-1].color}k5b(D,O){const X=this.Jc.get(6,0),N=this.Jc.get(14);return y.createClusteredImageFromClusterWithImageClass(X,X,this.Jc.get(D),this.Jc.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,N?N.cloneNode(!0):null)}cD(D){3!==D.Xf&&this.raiseEvent(m.a.kp,new m.a(2,D));return!1}onClick(D){this.raiseEvent(m.a.kp,
new m.a(1,D));return!0}yz(D){3!==D.Xf&&this.raiseEvent(m.a.kp,new m.a(3,D));return!1}Y3e(){this.element&&(this.v7.yb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.v7.yb(z.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.v7.yb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut")),this.yn.yb(z.a.doubleClick,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.yn.yb(z.a.click,
this.element,Object(h.a)(this,this.onClick,"onClick")),this.bN.yb(this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")))}Jce(){this.element&&(this.v7.pb(z.a.pointerDown,this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")),this.v7.pb(z.a.pointerOver,this.element,Object(h.a)(this,this.cD,"onPointerOver")),this.v7.pb(z.a.pointerOut,this.element,Object(h.a)(this,this.yz,"onPointerOut")),this.yn.pb(z.a.doubleClick,this.element,Object(h.a)(this,
this.Px,"stopPropagationAndPreventDefaultBehavior")),this.yn.pb(z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.bN.pb(this.element,Object(h.a)(this,this.Px,"stopPropagationAndPreventDefaultBehavior")))}}Object(I.a)(A,"PresenceTooltipGlyph",n.a,[]);var E=d(118);d(65);var u=d(201);class J extends n.a{constructor(D,O,X){super(D);this.Df=[];this.hm=[];this.iI=0;this.eia=this.c7=!1;this.fQb=null;this.vha={};this.Jc=X;this.Vi=X.get(8,!1);this.CG=X.get(11,!1);D=X.get(12,0);this.imageDimension=
X.get(6,0);this.f5a=O;this.element.id=J.i9a();this.element.className=n.a.aub("prControl",this.Vi);D&&(this.zIndex=D);this.rtl=this.Vi;this.Djb(O);this.Hz=this.createElement("div");this.Hz.className=this.CG?"prContainerV":"prContainerHr";this.element.appendChild(this.Hz);this.ySb=Array(this.iI);for(O=0;O<this.iI;O++)this.iw[O]=new v(this.createElement("div"),this.Jc),this.iw[O].bW(Object(h.a)(this,this.fG,"onInteractivityChanged")),this.element.appendChild(this.iw[O].element)}get Khb(){return u.a.clone(this.Df)}getGlyph(D){return this.vha[D]}get iw(){return this.ySb}get nYb(){return this.fQb}get uLa(){return this.imageDimension+
2}get width(){return this.CG?this.uLa:this.f5a}get height(){return this.CG?this.f5a:this.uLa}bW(D){this.addHandler(m.a.kp,D)}g1(D){this.removeHandler(m.a.kp,D)}dispose(){if(this.iw)for(const D of this.iw)D.g1(Object(h.a)(this,this.fG,"onInteractivityChanged")),E.a.Kx(D);E.a.Xmd(this.hm);this.hm=this.ySb=null;super.dispose()}iga(){this.ON();this.qkb();this.visible=!0;this.c7=!1}skb(){!this.hm||1>this.hm.length||(this.ON(),this.visible=!0,this.qkb(),this.JJa(this.hm[this.hm.length-1]),this.c7=!0)}Lya(){if(this.hm&&
!(1>this.hm.length)){this.visible=!0;this.qkb();var D=0;for(const O of this.hm)this.JJa(O,D++);this.c7=!1;this.eia=!0}}hide(){this.visible=!1;this.ON();for(let D=0;D<this.hm.length;D++)this.hm[D].hide();this.c7=!1}R_b(){if(!this.eia)return!1;let D=0;for(const O of this.iw)O.visible&&D++;return this.eia=0<D&&(this.Df.length<=this.iI?D===this.Df.length:D===this.iI)}Xx(D){if(!(0>=this.iI)){D.clientId||(D.clientId=(J.Cha++).toString());if(D.clientId in this.vha){var O=this.bT(D.clientId);if(0<=O){O=this.Df[O];
if(O.color===D.color&&O.userName===D.userName)return;this.RJ(D.clientId)}}O=this.R_b();var X=0;if(this.Df.length<this.iI){var N=new A(this.createElement("div"),this.Jc,D);N.bW(Object(h.a)(this,this.fG,"onInteractivityChanged"));this.Vi&&!this.CG&&0<this.Df.length?this.Hz.insertBefore(N.element,this.Hz.firstChild):(this.Hz.appendChild(N.element),X=this.hm.length);Array.add(this.hm,N)}else this.Vi&&!this.CG?N=this.hm[0]:(X=this.hm.length-1,N=this.hm[X]),N.Xx(D);N.show();this.vha[D.clientId]=N;Array.add(this.Df,
D);this.nuc(N,X);O&&this.Lya()}}RJ(D){const O=this.R_b();O&&this.ON();this.hoa(D);this.Df.length>=this.iI&&this.hm.length<this.iI&&this.wPe();0>=this.Df.length?this.hide():O&&this.Lya()}qgb(){}hoa(D){var O=this.bT(D);0>O||(D=this.Df[O],Array.removeAt(this.Df,O),O=this.vha[D.clientId],delete this.vha[D.clientId],O.RJ(D.clientId),this.nuc(O),0>=O.TO&&(this.Hz.removeChild(O.element),Array.remove(this.hm,O),O.dispose()))}Zjb(){}wPe(){var D=this.Q8d();!D||1>=D.bba.length||(D=Array.clone(this.Df),D.forEach(O=>
{this.hoa(O.clientId)}),D.forEach(O=>{this.Xx(O)}))}bT(D){for(let O=0;O<this.Df.length;O++)if(this.Df[O].clientId===D)return O;return-1}Q8d(){return this.Vi&&!this.CG?this.hm[0]:this.hm[this.hm.length-1]}position(D,O){this.element.style.top=O+"px";this.element.style.left=D+"px"}qkb(){for(let D=0;D<this.hm.length;D++)this.hm[D].show()}ON(){for(let D=0;D<this.iI;D++)this.iw[D].hide();this.eia=!1}JJa(D,O=0){if(D)if(this.fQb=D,this.CG){const X=this.imageDimension;if(1<D.bba.length)this.iw[O].show(D.bba,
X,this.height-this.imageDimension);else{const N=this.Hz.children.length;for(let aa=0;aa<this.Hz.children.length;aa++)D.element===this.Hz.children[aa]&&this.iw[O].show(D.bba,X,this.height-(N-aa)*this.uLa+2)}}else this.iw[O].show(D.bba,this.width,0)}fG(D,O){var X=Object(e.a)(A,D);X=X?this.b4b(X):-1;if(2===O.type||1===O.type&&-1!==X&&!this.iw[X].visible)this.JJa(D);else if(1===O.type)this.ON(),this.c7=!1;else if(3===O.type){if(this.F3b(O.Xi))return;this.c7||this.ON()}this.raiseEvent(m.a.kp,O)}F3b(D){D=
J.X9a(D);let O=!1;for(const X of this.iw)if(B.a.mua(X.element,D)){O=!0;break}return this.Hz!==D&&B.a.mua(this.Hz,D)||O}nuc(D,O=0){const X=this.jie(D);X&&0>=D.TO?this.iw[O].hide():X?this.JJa(D):this.iw[O].hide()}b4b(D){let O=0;for(const X of this.hm){if(D===X)return O;O++}return-1}jie(D){const O=this.b4b(D);return!!this.nYb&&D===this.nYb&&-1!==O&&this.iw[O].visible}Djb(D){this.iI=D===this.imageDimension?1:Math.floor(D/this.uLa);this.CG?(this.element.style.height=D+"px",this.element.style.width=this.imageDimension+
"px"):(this.element.style.width=D+"px",this.element.style.height=this.imageDimension+"px")}static i9a(){return String.format("{0}-{1}","presencetooltip",J.Cha++)}static X9a(D){D=D.qc.rawEvent;return D.relatedTarget||D.toElement}}J.Cha=0;Object(I.a)(J,"PresenceTooltipControl",n.a,[487,106]);var G=d(225),S=d(289),P=d(267);d.d(Y,"a",function(){return Q});class Q{constructor(D){this.Jc=D;this.Jc.MD(10,G.a.instance);this.Jc.MD(9,P.a.instance);this.Jc.MD(6,16);this.Jc.MD(13,S.a.instance)}zLc(D,O){return new J(D,
O,this.Jc)}Ttb(D){return new J(D,16,this.Jc)}}Object(I.a)(Q,"PresenceTooltipFactory",null,[486])},1158:function(I,Y,d){I=d(0);class h{}h.taskPaneWidth=330;Object(I.a)(h,"AppsForOfficeConstants",null,[]);d.d(Y,"a",function(){return e});class e{constructor(){this.rW=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.bNc=this.dialogTop=this.gNc=this.dialogLeft=null;this.taskPaneWidth=h.taskPaneWidth;this.WE=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings=
{};this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.hNc=this.dNc=!0}}Object(I.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1233:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);var h;(function(e){e[e.isEnabled=1]="isEnabled";e[e.execute=2]="execute";e[e.animation=3]="animation"})(h||(h={}));Object(I.b)("ActionBehavior",h)},1234:function(I,Y,d){d.d(Y,"a",function(){return B});I=d(0);var h=d(82),e=d(121),
n=d(27),m=d(95),z=d(220);class B extends h.a{constructor(v,y=!1){super(v,!1,y)}get Dzb(){return!1}get gL(){return z.a.p2b+"/modeless"}get KAb(){return null}set KAb(v){}get GAb(){return null}set GAb(v){}Zi(v,y=null,A=null){this.KK&&(A.isModal=!1);super.Zi(v,y,A)}hide(){if(n.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Gb)this.SGh(),n.AFrameworkApplication.Aa.Mw.Ko(e.AFrame.v5),super.hide()}w5h(){const v=n.AFrameworkApplication.Aa.Mw,
y=n.AFrameworkApplication.Aa.Vr;v.K2(this.gL);v.uia(this.gL);y.Fc(this.gL).parent=e.AFrame.gj}mra(){m.FocusManager.SM()&&(super.mra(),this.w5h(),n.AFrameworkApplication.Aa.Mw.pI(e.AFrame.v5))}Bib(){if(m.FocusManager.SM()&&!n.AFrameworkApplication.Ug){const v=m.FocusManager.instance();v.X0(this.gL);const y=v.uQ(this.gL);y&&y.vj.YE(null);v.iKb(this.gL)}}naa(){"DL"===this.fra||"DP"===this.fra?super.naa():n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?(this.SGh(),
this.Syf()&&this.ywh(this.Gb.clientHeight,this.Gb.clientWidth)):this.AA()}AA(){this.ywh(h.a.q$e,h.a.t$e)}ywh(v,y){if(this.GAb&&this.KAb){let A,E;A=z.a.Wlc+this.KAb;E=z.a.Vlc+this.GAb;A+v>this.fka()&&(A=this.fka()-v);E+y>this.xta()&&(E=this.xta()-y);this.Tqd(A,E)}else super.AA()}J8d(v){if(!v)return null;v.endsWith("px")&&(v=v.substring(0,v.length-2));return z.a.Kzb(v)?((v=parseInt(v))||(v=1),v):null}SGh(){if(this.Gb&&this.Gb.style){var v=this.J8d(this.Gb.style.top);v&&(this.KAb=v-z.a.Wlc);if(v=n.AFrameworkApplication.isRtl?
this.J8d(this.Gb.style.right):this.J8d(this.Gb.style.left))this.GAb=v-z.a.Vlc}}}Object(I.a)(B,"ModelessCustomDialog",h.a,[])},1237:function(I,Y,d){function h(w,T){return T.B0c?w.map(ea=>{if(!ea||!ea.activityFeedItemPayload)return ea;const ra=JSON.parse(ea.activityFeedItemPayload);var wa=ra.actor;if(!wa||wa.pictureUrl)return ea;const Za=wa.userPrincipalName||wa.email;if(!Za)return ea;wa=T.eub(Za,wa.provider,Q.AFrameworkApplication.gh,Bg.default);if(!wa)return ea;ra.actor.pictureUrl=wa;return Object.assign(Object.assign({},
ea),{activityFeedItemPayload:JSON.stringify(ra)})}):w}function e(w,T){const ea=new Map,ra=new Map;w.forEach(wa=>{if(wa&&wa.activityFeedItemPayload&&(wa=JSON.parse(wa.activityFeedItemPayload).actor)){var Za=wa.email||wa.userPrincipalName;Za&&!ra.has(Za)&&ra.set(Za,new Ci.a(Za,void 0,wa.name))}});ra.forEach(wa=>{const Za=T.Gta(wa,jf.catchUpFlyout);ea.set(wa.UserId,Za)});return ea}d.r(Y);var n=d(0),m=d(387),z=d(1201),B=d(1202),v=d(14),y=d(1200),A;(function(w){w[w.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";
w[w.cloudPolicySettings=1]="cloudPolicySettings";w[w.alternateAuthToken=2]="alternateAuthToken"})(A||(A={}));Object(n.b)("ApplicationFeatureHelperRequestType",A);class E{constructor(){this.message=null;this.zv=0}}Object(n.a)(E,"HttpRequstToPromiseRejectData",null,[]);var u=d(96),J=d(80),G=d(176),S=d(47);class P{constructor(w,T){this.$a=w;this.Xh=T}q1b(w,T,ea,ra=null,wa=null,Za=null,ub=null,zb=null){const tc=A[ea],pc=tc+"RequestFailure";u.Health.instance.recordKpiUsage(pc,0,"jpittsdirects",null);return new Promise((bc,
yc)=>{m.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",tc);const $c=null!=ub?ub:this.$a.Bc("ApplicationFeatureHelperRequestQueueTimeout",15E3),gd=null!=zb?zb:this.$a.Bc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Xh.ZV(w,1,null,this.v7d(ea,ra),Za,1,md=>{m.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",tc);try{if(void 0===md||null===md||void 0===
md.data||null===md.data||void 0===md.data.Sd||null===md.data.Sd){u.Health.instance.recordKpiFailure(pc,"Invalid RequestSucceededEventArgs",!1,!0,null);let Zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",tc);yc(this.hka(Zd,md))}else if(md.data.oe!==G.a.Uv){u.Health.instance.recordKpiFailure(pc,"HttpStatusCode_"+md.data.oe.toString(),!1,!0,null);let Zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
md.data.oe,tc);yc(this.hka(Zd,md))}else{void 0!==wa&&null!==wa&&void 0!==md.data.sj&&null!==md.data.sj&&wa(md.data.sj);var Sc=T(md.data.Sd);if(Sc)m.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",tc),bc(Sc);else{u.Health.instance.recordKpiFailure(pc,"Parse Failure",!1,!0,null);let Zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",tc);yc(this.hka(Zd,
md))}}}catch(Zd){u.Health.instance.recordKpiFailure(pc,"Unexpected Failure",!1,!0,null),Sc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Zd,tc),yc(this.hka(Sc,md))}},md=>{if(md.data){u.Health.instance.recordKpiFailure(pc,"HttpStatusCode_"+md.data.oe.toString(),!1,!0,null);var Sc=S.a.$Tc(md.data.Sd||"No Data");Sc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
md.data.oe,Sc,tc)}else u.Health.instance.recordKpiFailure(pc,"Invalid RequestFailedEventArgs",!1,!0,null),Sc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",tc);yc(this.hka(Sc,md))},null,void 0,void 0,$c,gd)})}hka(w,T){const ea=new E;ea.message=w;ea.zv=T&&T.data?T.data.oe:-1;return ea}v7d(w,T){const ea={};ea["x-UserDataSignature"]=this.$a.Ga("UserDataSignature");ea["x-LicensingIsEnabled"]=this.$a.ka("LicensingIsEnabled").toString();
ea["x-CacheIsEnabled"]=this.$a.ka("LicensingRedisIsEnabled").toString();ea["x-OcpsIsEnabled"]=this.$a.ka("OcpsIsEnabled").toString();ea["x-LicensingAADIdIsEnabled"]=this.$a.ka("LicensingAadIdIsEnabled").toString();0===w&&(ea["x-LicenseCheckOnTenantEnabled"]="true",ea["x-SupportUserConsentDependentFeatures"]="true",ea["x-AFHUserConsentGroupValue"]="0",ea["x-UseShellServiceForUserConsentGroup"]="true",ea["x-SMBUserLicensingEnabled"]="true",ea["x-AFHPIPLComplianceEnabled"]=J.a.hT(window.location.href,
"wd_afhpipl")||"false");if(T)for(let ra of T.keys)ea[ra]=T.ga(ra);return ea}}Object(n.a)(P,"HttpRequestToPromiseUtility",null,[]);var Q=d(27),D;(function(w){w[w.loki=0]="loki";w[w.augloopACLP=1]="augloopACLP"})(D||(D={}));Object(n.b)("AlternateAuthSupportApp",D);var O=d(226),X=d(36);class N{constructor(){this.Token=null;this.ExpirationTime=0}}Object(n.a)(N,"WacAlternateAuthToken",null,[]);class aa{constructor(w,T){this.owl=3E5;if(void 0===w||null===w||void 0===T||null===T)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.$a=w;this.Ovc=new z.a(B.a.to());this.eTb=new P(w,T);void 0!==O.OAuthManagerSettings.Joe&&null!==O.OAuthManagerSettings.Joe&&void 0!==O.OAuthManagerSettings.j2c&&null!==O.OAuthManagerSettings.j2c&&0<O.OAuthManagerSettings.j2c&&(w=new N,w.Token=O.OAuthManagerSettings.Joe,w.ExpirationTime=O.OAuthManagerSettings.j2c,this.Ovc.$("loki",w))}d3i(){let w=null;this.Ovc.Hb(D[0])&&(w=this.Ovc.ga(D[0]));return void 0===w||null===w||this.dWj(w)?this.xWi():Promise.resolve(w.Token)}dWj(w){return w.ExpirationTime-
Date.now()<this.owl}xWi(){const w=new z.a(B.a.to());w.$("X-AlternateAuthApp",D[0]);return this.eTb.q1b(this.NSa("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.lCk,"parseAlternateAuthTokenResponse"),2,w).then(T=>{m.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",D[0]);this.Ovc.$(D[0],T);return T.Token},T=>{T=Object(y.a)(E,T);m.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
T.message,T.zv);return null})}lCk(w){let T=null;({rv:T}=X.d(w));m.ULS.sendTraceTag(545821457,3004,T?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",w);return T}NSa(w){return String.format("{0}{1}?{2}",this.$a.Ga("WebServiceBase"),w,Q.AFrameworkApplication.gh)}}Object(n.a)(aa,"AlternateAuthHelper",null,[434]);var V=d(1063);class ca{constructor(w,T,ea){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=w;this.isEnabled=T;this.tierName=ea}}Object(n.a)(ca,
"FeatureStateChangeArgs",null,[]);var fa=d(221),ma=d(224),da=d(55),qa=d(105),F=d(106),sa;(function(w){w[w.Enabled=0]="Enabled";w[w.Disabled=1]="Disabled"})(sa||(sa={}));Object(n.b)("FeatureState",sa);var ia=d(57),Na=d(37),Ca=d(89);class ha{constructor(w,T,ea=null,ra=null,wa=null){this.hSa=this.OV=this.ymf=this.bOa=this.aEc=null;this.eTb=new P(w,T);this.$a=w;this.AVh=w.Bc("LicensingMaxRetryAttempts",0);this.Szc=w.ka("IsO365ConsumerHost");this.PDd=w.ka("IsO365CommercialHost");this.wDd=w.ka("PremiumUpsellIsEnabled");
this.yob=!1;this.jFd=0;this.u9e=ea;this.Fqf=ra;this.Ca=wa;this.aOa=w.ka("LicensingIsEnabled");this.n4a=w.ka("OcpsIsEnabled")&&this.PDd;this.hNd=w.ka("ShowPrivacyDialog")&&!!ra;this.WCd=w.ka("IsAnonymousUser");this.vPc=new Promise(Za=>{Za(!1)});this.m1a=new Promise(Za=>{Za(!0)});this.gSa=new z.a(B.a.to());this.jFc=!0;this.xhf=this.Cbj();this.Dke()&&!this.WCd?(void 0!==Q.AFrameworkApplication.Aa&&null!==Q.AFrameworkApplication.Aa&&(this.aEc=Q.AFrameworkApplication.Aa.gV,void 0!==this.aEc&&null!==this.aEc&&
(this.bOa=this.aEc.aGb("WebServiceCall","ApplicationFeatureHelperService"))),this.hSa=this.o3e()):this.hSa=new Promise(Za=>{Za({})});this.hSa.catch(Za=>{Za=Object(y.a)(E,Za);m.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Za?Za.zv.toString():"Unknown")});this.jFc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Za=>{this.yob=Za;return null})}Cbj(){const w=this.$a.Cu("AllLicensedFeatures")?this.$a.WA("AllLicensedFeatures"):[],T=new V.a;for(let ea=
0;ea<w.length;ea++)T.add(w[ea]);return T}Dke(){return this.PDd||this.Szc}o3e(w=0,T=!1){m.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",T);const ea=fa.a.Rz();ea&&(ea.set("retryAttempt",w.toString()),ea.set("forceRefresh",T.toString()),ea.set("isO365ConsumerHost",this.Szc.toString()),ea.set("isO365CommercialHost",this.PDd.toString()),ea.set("isFreemiumUpsellSettingEnabled",this.wDd.toString()));u.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",ea);u.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",ea);void 0!==this.bOa&&null!==this.bOa&&this.bOa.start();let ra=null;T&&(ra=new z.a(B.a.to()),ra.$("x-LicensingForceRefresh","true"));this.ymf=new Date;return(this.aOa?this.eTb.q1b(this.NSa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.oCk,"parseApplicationFeatureHelperResponse"),0,ra,Object(v.a)(this,this.IJk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(wa=>
{const Za=Object.assign(new Ca.a,{durationMs:this.yyh()});Za.extendedProperties=ea;Za.extendedProperties&&wa&&(Za.extendedProperties.set("featureCount",qa.a.count(wa).toString()),Za.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in wa).toString()),Za.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in wa).toString()),"FreemiumUpsell"in wa&&Za.extendedProperties.set("isFreemiumUpsellEnabled",wa.FreemiumUpsell.toString()),this.OV&&Za.extendedProperties.set("fromCache",
(this.OV<this.ymf).toString()));u.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Za);return wa},wa=>{const Za=Object.assign(new Ca.a,{durationMs:this.yyh()}),ub=Object(y.a)(E,wa);if(!ub)return m.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Za),new Promise((zb,tc)=>{tc(wa)});Za.extendedProperties=
ea;Za.extendedProperties&&Za.extendedProperties.set("status",ub.zv.toString());u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Za);return 408===ub.zv&&++w<=this.AVh?this.o3e(w):new Promise((zb,tc)=>{tc(ub)})})}oCk(w){(w=X.b(w))?(m.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),m.ULS.sendTraceTag(50938594,3004,50,"{0}",w)):m.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return w.Features}NSa(w){var T=String.format("{0}{1}",this.$a.Ga("WebServiceBase"),w);this.$a.Cu("ApplicationFeatureHelperHttpCachingEnabled")&&this.$a.ka("ApplicationFeatureHelperHttpCachingEnabled")&&(w=ha.hTc(this.$a))&&0<w.length&&(this.jFc&&(w+="ucbf"),T=new ma.QueryStringBuilder(T),T.yi("afhskey",w),T=T.toString());return T}isFeatureEnabled(w,T){if(!this.n4a&&!this.hNd&&!this.aOa)return this.m1a;m.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
w);if("ConnectedServices"===w){var ea=this.n4a?this.u9e.C3("ControllerConnectedServicesEnabled"):this.m1a;const Za=this.hNd?this.Fqf.getSettings().then(ub=>2!==ub.mC,()=>T):this.m1a;return ea.then(ub=>ub?Za:this.vPc)}if("FreemiumUpsell"===w&&(!this.wDd||!this.Szc||this.WCd))return this.vPc;ea=null;ea=this.n4a?this.u9e.isFeatureEnabled(w):this.m1a;let ra=null;ra=this.aOa?this.MMj(w,T):this.m1a;let wa=null;wa=this.hNd?this.Fqf.isFeatureEnabled(w):this.m1a;return ea.then(Za=>Za?wa.then(ub=>ub?ra:this.vPc):
this.vPc).then(Za=>{this.rqg(w,Za,!0);return Za},()=>{this.rqg(w,T,!1);return T})}rqg(w,T,ea){m.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",w,T,ea)}getFeatureTier(w,T){if(!this.aOa)return new Promise(ea=>{ea(2)});m.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",w);return this.hSa.then(ea=>this.FUc(w,ea,T),()=>T)}isFreemiumUpsellEnabled(){if(this.wDd&&this.Szc&&!this.WCd){if(this.yob&&2!==this.jFd||
!this.yob&&1!==this.jFd)m.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.yob.toString()),this.jFd=this.yob?2:1;return this.yob}return!1}launchUpsellExperience(w,T=null){m.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",w));var ea=fa.a.Rz();ea&&(ea.set("experienceId",w),T&&ea.set("campaignId",T));u.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",ea);if(ea=ia.a.instance.ub("Common.IInProductMessagingUIManager")){const ra=Object(v.a)(this,this.Lrj,"handleDimeTaskComplete");ea.Uog(w,ra,T)}else m.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.La(Na.a.OQc,2,{["experience"]:w})}rib(w,T){if(!this.aOa)return null;if(!w||!T)return m.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const ea=F.a.create().toString();this.gSa.Hb(w)||this.gSa.$(w,new z.a(B.a.to()));this.gSa.ga(w).add(ea,T);m.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",ea,w));return ea}dKb(w,T){this.aOa&&(w&&this.gSa.Hb(w)?T&&F.a.isValid(T)?this.gSa.ga(w).Hb(T)?(m.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
T,w)),this.gSa.ga(w).remove(T)):m.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",T,w)):m.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",T,w)):m.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
w)))}FUc(w,T,ea){return this.jFc?w in T?T[w].LicenseTier:ea:w in T?this.ZCk(T[w],ea):ea}ZCk(w,T){switch(w.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return T}}Lrj(){m.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.hSa.then(w=>{this.egh(w)}).catch(()=>{this.egh({})})}egh(w){m.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const T=this.o3e(0,!0);T.then(ea=>
{this.hSa=T;qa.a.count(ea)>qa.a.count(w)?u.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let ra of this.gSa.keys)if(ra in ea){const wa=this.FUc(ra,ea,0);ra in w?this.FUc(ra,w,0)!==wa&&this.LFe(ra,!0,wa):this.LFe(ra,!0,wa)}else ra in w&&this.LFe(ra,!1,this.FUc(ra,w,0))}).catch(ea=>{u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);
m.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ea))})}LFe(w,T,ea){m.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",w,T,ea);T=new ca(w,T,ea);ea=this.gSa.ga(w);for(let ra of ea)try{ra.value(T)}catch(wa){m.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
w,ra.key,wa.message))}}LMj(w,T){if(this.aOa){const ea=this.xhf.contains(w);let ra=!0,wa="",Za=!1;return this.hSa.then(ub=>{w in ub?(ub=ub[w],wa=sa[ub.FeatureState],ra=1!==ub.FeatureState):ra=!ea;this.Bqg(w,ea,wa,Za,T,ra);return ra},()=>{Za=!0;ea&&(ra=T);this.Bqg(w,ea,wa,Za,T,ra);return ra})}return this.m1a}Bqg(w,T,ea,ra,wa,Za){m.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",w,T,ra,ea,
wa,Za)}MMj(w,T){if(this.jFc)return this.LMj(w,T);if(this.aOa){if(this.xhf.contains(w))return this.hSa.then(ea=>w in ea,()=>T);m.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",w)}return this.m1a}IJk(w){try{w&&"Date"in w&&(this.OV=new Date(w.Date),m.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.OV.toString()))}catch(T){m.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",T)}}yyh(){if(void 0!==this.bOa&&null!==this.bOa){const w=this.bOa.Vq;this.bOa.stop();return w}return null}static hTc(w){try{if(da.a.g0e){const T=w.Ga("UserDataSignature").split(".");if(1<T.length){const ea=window.self.atob(T[1]),ra=JSON.parse(ea).LocalStorageKey;if(void 0!==ra&&null!==ra&&0<ra.length)return ra}}}catch(T){m.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",T.toString())}return null}}Object(n.a)(ha,
"ApplicationFeatureHelper",null,[435]);var Ba=d(18);class va{constructor(w,T){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=w.PolicySettings;w=new Date;w.setMinutes(w.getMinutes()+T);this.ExpirationTime=w.getTime()}}Object(n.a)(va,"CloudPolicySettingsCacheData",null,[]);var ta=d(373),Fa=d(239),pa=d(284);class ka{static rwh(){return Q.AFrameworkApplication.fa.ka("SideCarIsEnabled")?ka.fnd&&ka.YYc?new Promise(w=>{w(!0)}):new Promise((w,T)=>{ka.fnd=pa.a.create(Q.AFrameworkApplication.fa.Ga("SideCarUrl"));
Fa.a.ey(ka.fnd);ka.fnd.DS((ea,ra)=>{(ka.YYc=ra.succeeded)?w(ra.succeeded):T(ra.succeeded)})}):new Promise(w=>{w(!1)})}}ka.YYc=!1;ka.fnd=null;Object(n.a)(ka,"SideCarLoader",null,[]);class Ha{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(n.a)(Ha,"CloudPolicySettingsData",null,[]);class Ya{constructor(w,T){this.wyd=0;this.aKc=null;this.eTb=new P(w,T);this.$a=w;T=w.Ga("HostAuthType");this.n4a=w.ka("OcpsIsEnabled")&&w.ka("IsO365CommercialHost")&&!(void 0===
T||null===T)&&"aad"===T.toLowerCase();this.Mjf=X.b(w.Ga("OcpsDefaultSettings")||"{}");this.AUb=this.hTc();T=this.$a.Cu("ServicesControlsMicrosoftControllerServicesList")?this.$a.WA("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.bxc=new V.a;for(let ea=0;ea<T.length;ea++)this.bxc.add(T[ea]);this.n4a&&!w.ka("IsAnonymousUser")&&w.ka("SideCarIsEnabled")?this.aKc=this.uzl():this.aKc=this.n3e(this.n4a,this.NSa("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.vCk,"parseCloudPolicySettingsResponse"));
this.aKc.then(()=>null).catch(ea=>{ea=Object(y.a)(E,ea);m.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",ea?ea.zv.toString():"Unknown")})}C3(w,T=!0){if(!this.n4a){const Za=this;return new Promise(ub=>{ub(Za.P5b(w))})}let ea=this,ra=this;const wa=this.aKc.then(Za=>{try{let ub=null;Za.PolicySettings&&"unknown"in Za.PolicySettings&&(ub=Za.PolicySettings.unknown);if(ub){if(w in ub&&void 0!==ub[w]&&null!==ub[w])return new Promise(tc=>{tc("0"!==ub[w])});
const zb=w.toLowerCase();if(zb in ub&&void 0!==ub[zb]&&null!==ub[zb])return new Promise(tc=>{tc("0"!==ub[zb])});m.ULS.sendTraceTag(51512667,3004,50,"Policy"+w+" not found, using default");return new Promise(tc=>{tc(ea.P5b(w))})}return new Promise(zb=>{zb(ea.P5b(w))})}catch(ub){return m.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+w+" policy value. Error Message: {0}",ub.message),ea.handleError(ub.toString(),T,ea.P5b(w))}},Za=>ra.handleError(Za,T,ra.P5b(w)));wa.then(Za=>{m.ULS.sendTraceTag(50651667,
3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",w,Za);return null});return wa}isFeatureEnabled(w,T=!0){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.OMj(w,T);let ea=new Promise(wa=>{wa(!0)}),ra="";this.bxc.contains(w)&&(ra="ControllerConnectedServicesEnabled",ea=this.C3(ra,T));ea.then(wa=>{m.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
w,wa,ra);return null});return ea}OMj(w,T=!0){let ea=new Promise(wa=>{wa(!0)}),ra="";"mso_sendASmile"===w?ra="Enabled":"Survey"===w||"FloodgateSurvey"===w?ra="SurveyEnabled":this.bxc.contains(w)&&(ra="ControllerConnectedServicesEnabled");""!==ra&&(ea=this.C3(ra,T));ea.then(wa=>{m.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",w,wa,ra);return null});return ea}handleError(w,T,ea){return T?new Promise(ra=>{ra(ea)}):
new Promise((ra,wa)=>{wa(w)})}n3e(w,T,ea){if(!w)return Promise.resolve(new Ha);let ra=!1,wa=null;u.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Za=this.tXd("GetCloudPolicySettings");return(new Promise((ub,zb)=>{if(void 0!==this.AUb&&null!==this.AUb&&0<this.AUb.length){const tc=this.azl();if(void 0!==tc&&null!==tc){ra=!0;ub(tc);return}}this.eTb.q1b(T,ea,1,null,Object(v.a)(this,this.PJk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.$a.Bc("CloudPolicySettingsRequestQueueTimeout",
15E3),this.$a.Bc("CloudPolicySettingsRequestSentTimeout",3E4)).then(tc=>{m.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.fAl(tc);ub(tc);return tc},tc=>{zb(tc);return null})})).then(ub=>{({Hy:Za,returnValue:wa}=this.srd(Za));var zb=fa.a.Rz();zb&&zb.set("FromCache",ra.toString());zb=Object.assign(new Ca.a,{durationMs:wa,extendedProperties:zb});u.Health.instance.recordKpiSuccess("GetCloudPolicySettings",zb);return ub})}uzl(){return ka.rwh().then(()=>{m.ULS.sendTraceTag(593282845,
3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}NSa(w){return String.format("{0}{1}",this.$a.Ga("WebServiceBase"),w)}vCk(w){let T=null;({rv:T}=X.d(w));w=!!T;m.ULS.sendTraceTag(50622687,3004,w?50:10,"ParseCloudPolicySettingsResponse: Success={0}",w);return T}PJk(w){try{if(void 0!==w&&null!==w&&"CheckIn-Interval"in w){const T=parseInt(w["CheckIn-Interval"]);void 0!==T&&null!==T&&0<T&&(this.wyd=T)}}catch(T){m.ULS.sendTraceTag(51662934,
3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",T)}}P5b(w){return w in this.Mjf?"0"!==this.Mjf[w]:!0}azl(){try{const w=ta.a.instance.getItem(this.AUb);if(void 0===w||null===w)return m.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;m.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",w);const T=JSON.parse(w);if(void 0===T||null===T)return m.ULS.sendTraceTag(51662938,
3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===T.ExpirationTime||null===T.ExpirationTime)return m.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(T.ExpirationTime)).getTime()<Date.now())return m.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const ea=new Ha;ea.PolicySettings=T.PolicySettings;
ea.ControllerConnectedServicesFeatureNames=new Ba.a;this.$a.Cu("ServicesControlsMicrosoftControllerServicesList")&&this.$a.WA("ServicesControlsMicrosoftControllerServicesList");for(let ra of this.bxc)ea.ControllerConnectedServicesFeatureNames.add(ra);m.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return ea}catch(w){return m.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",w.toString()),null}}fAl(w){try{if(void 0===
w||null===w||void 0===w.PolicySettings||null===w.PolicySettings)m.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.wyd)m.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const T=new va(w,this.wyd),ea=JSON.stringify(T);m.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",ea);ta.a.instance.setItem(this.AUb,ea);m.ULS.sendTraceTag(51662947,
3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(T){m.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",T.toString())}}hTc(){const w=ha.hTc(this.$a);return w&&0<w.length?"OCPS"+w:null}tXd(w){const T=ia.a.instance.ub("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==T&&null!==T?T.Ci("WebServiceCall",w):null}srd(w){if(void 0!==w&&null!==w){const T=w.Vq;w.stop();return{returnValue:T,Hy:null}}return{returnValue:null,
Hy:w}}}Object(n.a)(Ya,"CloudPolicySettingsHelper",null,[432]);class Ka{constructor(){this.RPf=this.zIh=this.mC=0;this.SPf=this.AIh=this.x7a="";this.hLd=this.Jza=2}clone(){const w=new Ka;w.mC=this.mC;w.zIh=this.zIh;w.RPf=this.RPf;w.x7a=this.x7a;w.AIh=this.AIh;w.SPf=this.SPf;w.Jza=this.Jza;w.hLd=this.src;return w}get src(){return this.hLd}serialize(w=null){const T={};if(!w||w.contains(Ka.Dgb))T[Ka.Dgb]=this.mC;if(!w||w.contains(Ka.Fjc))T[Ka.Fjc]=this.x7a;if(!w||w.contains(Ka.Gjc))T[Ka.Gjc]=this.Jza;
return JSON.stringify(T)}static create(w,T=null){const ea=new Ka;ea.hLd=w;void 0!==T&&null!==T&&(Ka.Dgb in T&&(ea.mC=T[Ka.Dgb]),Ka.Fjc in T&&(ea.x7a=T[Ka.Fjc]),Ka.Gjc in T&&(ea.Jza=T[Ka.Gjc]));return ea}static deserialize(w,T){try{const ea=JSON.parse(w);if(void 0!==ea&&null!==ea)return Ka.create(T,ea);m.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",w);throw Error.argument("settingsData");}catch(ea){throw m.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
ea.toString()),ea;}}}Ka.Dgb="CCS";Ka.Fjc="CCSTime";Ka.Gjc="OfficePrivacyRoamedNoticeShown";Object(n.a)(Ka,"UserPrivacySettings",null,[]);var Pa=d(211);class Oa{constructor(w,T){if(void 0===w||null===w||void 0===T||null===T)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=w;this.Xh=T;this.zKd=this.Jc=null}NSa(w){var T=String.format("{0}RoamingServiceHandler.ashx?action=",this.$a.appSettings.RoamingServiceHandlerWebServiceBase||"");T=new Sys.StringBuilder(T);T.append(w);T.append("&");
T.append(Q.AFrameworkApplication.gh);return T.toString()}executeRequest(w,T,ea,ra=null){return this.Xh.Wqb(w,T,ra,null,2,ea,"33",!1,null,6E4)}saveSettings(w){return new Promise((T,ea)=>{try{if(void 0===this.Jc||null===this.Jc||void 0===w||null===w)m.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),ea("Can't determine setting changes to save");else{var ra=this.Jc.mC!==w.mC;if(2===this.Jc.src&&ra)this.B5k(w),T(!0);else{var wa=this.G8k(w);if(void 0===
wa||null===wa||!wa.length)m.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ea("No changes to save");else if(1===this.Jc.src)T(this.tEh(wa));else if(0===this.Jc.src){m.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",wa);const Za=this.executeRequest(this.NSa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",wa);Za.continueWith(()=>{if(Za.Tn||Za.tm)m.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
T(!1);else{var ub=Za.result;void 0!==ub.Wi&&null!==ub.Wi&&void 0!==ub.Wi.data&&null!==ub.Wi.data&&ub.Wi.data.oe===G.a.Uv?(m.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),T(!0)):(m.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),T(!1))}})}}}}catch(Za){m.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Za.toString()),T(!1)}})}G8k(w){if(void 0===this.Jc||null===this.Jc||void 0===w||null===w)throw Error.invalidOperation("User Privacy settings have not been initialized");
const T=new Ba.a;0===w.src?(this.Jc.mC!==w.mC&&(T.add(Ka.Dgb),T.add(Ka.Fjc)),this.Jc.Jza!==w.Jza&&T.add(Ka.Gjc)):1===w.src&&this.Jc.mC!==w.mC&&T.add(Ka.Dgb);return T.count?w.serialize(T):(m.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.zKd){const w=this;this.zKd=new Promise(T=>{try{w.Jc?T(w.Jc.clone()):w.jzl().then(ea=>{w.Jc=ea;T(w.Jc.clone());return null},()=>{w.hzl().then(ea=>{w.Jc=ea;T(w.Jc.clone());return null},()=>{w.izl().then(ea=>
{w.Jc=ea;T(w.Jc.clone());return null},()=>{m.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");w.Jc=new Ka;T(w.Jc.clone());return null});return null});return null})}catch(ea){m.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",ea.toString()),w.Jc=new Ka,T(w.Jc.clone())}})}return this.zKd}jzl(){return new Promise((w,T)=>{try{const ra=-1!==window.location.href.indexOf("&wd_pn=2");if(this.$a.ka("PrivacyDialogShouldCheckRoaming")||
ra){var ea=this.executeRequest(this.NSa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");ea.continueWith(()=>{try{if(ea.Tn||ea.tm)m.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const wa=ea.result;if(wa&&wa.Wi&&wa.Wi.data)if(wa.Wi.data.oe!==G.a.Uv)m.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",wa.Wi.data.oe);else{if(wa.Wi.data.Sd){w(Oa.parse(wa.Wi.data.Sd,0));m.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",wa.Wi.data.Sd);return}m.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else m.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");T("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(wa){m.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
wa.toString()),T("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else m.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),T("Roaming should not be used")}catch(ra){m.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",ra.toString()),T("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}hzl(){return new Promise((w,T)=>{try{const ea=Pa.a.get("WacUPToggleState");let ra=null;void 0!==
ea&&null!==ea&&0<ea.length&&(ra=decodeURIComponent(ea));if(void 0!==ra&&null!==ra&&0<ra.length){const wa=Oa.parse(ra,1);m.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",wa.toString());w(wa)}else{const wa=Ka.create(1),Za=new Ba.a;Za.add(Ka.Dgb);const ub=wa.serialize(Za);this.tEh(ub)?(m.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ub),w(wa)):(m.ULS.sendTraceTag(51258450,
3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ub),T("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(ea){m.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",ea.toString()),T("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}izl(){return new Promise(w=>{try{var T=-1!==window.location.href.indexOf("&wdccsoff=1");let ea=Ka.create(2);T?(ea.mC=2,Q.AFrameworkApplication.DOf(),m.ULS.sendTraceTag(51258451,
3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",ea.toString())):(ea.mC=1,m.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",ea.toString()));w(ea)}catch(ea){m.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ea.toString()),T=Ka.create(2),T.mC=1,w(T)}})}B5k(w){m.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===w.mC?Q.AFrameworkApplication.DOf():
Q.AFrameworkApplication.vQi();m.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",w)}tEh(w){try{m.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",w);const T=this.$a.Ga("PrivacyCookieDomain")||"";if(!T||!T.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");m.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",w);return Pa.a.csh("WacUPToggleState",w,Pa.a.DJ,T)}catch(T){return m.ULS.sendTraceTag(50860942,
3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",T.toString()),!1}}isFeatureEnabled(w){return this.getSettings().then(T=>{const ea=this.$a.Cu("ServicesControlsMicrosoftControllerServicesList")?this.$a.WA("ServicesControlsMicrosoftControllerServicesList"):[],ra=new V.a;for(let wa=0;wa<ea.length;wa++)ra.add(ea[wa]);return ra.contains(w)?2!==T.mC:!0},()=>{m.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",w);return!0})}static parse(w,T){try{return m.ULS.sendTraceTag(50860943,
3004,50,"Parsing user privacy settings {0} from {1}",w,T),Ka.deserialize(w,T)}catch(ea){throw m.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",ea.toString()),ea;}}}Object(n.a)(Oa,"UserPrivacySettingsHelper",null,[433]);var oa=d(70);class Xa{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Zb(w){this.Da=w;this.Da.register(432,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().oa(()=>new Ya(Q.AFrameworkApplication.fa,
Q.AFrameworkApplication.Ke));this.Da.register(433,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().oa(()=>new Oa(Q.AFrameworkApplication.fa,Q.AFrameworkApplication.Ke));this.Da.register(434,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().oa(()=>new aa(Q.AFrameworkApplication.fa,Q.AFrameworkApplication.Ke));this.Da.register(435,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().oa(()=>new ha(Q.AFrameworkApplication.fa,Q.AFrameworkApplication.Ke,
this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),Q.AFrameworkApplication.Ta))}init(){Q.AFrameworkApplication.fa.gf(()=>{const w=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Q.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(w.isFeatureEnabled("LicensingTestFeature",!1).then(T=>{m.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
T,Q.AFrameworkApplication.fa.Ga("IsAnonymousUser"));return null}),w.getFeatureTier("LicensingTestFeature",0).then(T=>{m.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",T,Q.AFrameworkApplication.fa.Ga("IsAnonymousUser"));return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.lul()})}dispose(){}lul(){try{Q.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&ka.rwh().then(w=>
{m.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",w);return w})}catch(w){}}static main(){oa.a.instance.Dc(new Xa)}}Object(n.a)(Xa,"ApplicationFeatureHelperPackage",null,[2,3]);var Hb=d(512),Ob=d(6);class eb{constructor(w,T){this.Xh=w;this.FD=T}Lx(w,T,ea,ra=null){return this.gOi(w,ra,wa=>this.Xh.Wqb(wa,2,ea,T,2,void 0,void 0,void 0,void 0,void 0,"2"))}gOi(w,T,ea){const ra=!!T&&""!==T;let wa=w;ra&&(wa=J.a.a6a(w,"perfTag",T));const Za=new Date;
return Hb.a.then(ea(wa),ub=>{const zb=+new Date-+Za;if(!ub||!ub.Wi||!ub.Wi.data)return ub;ra&&ub.Wi.data.request&&this.$7k(ub.Wi.data.request.getResolvedUrl(),T,zb);return ub})}$7k(w,T,ea){w=this.FD.Ygj(w);if(w.count&&(w=Ob.last(w))){const ra={Message:"Request durations for activities calls."};ra.PerfTag=T;ra.CustomDuration=ea;ra.PerformanceDuration=w.duration;m.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(ra))}}}Object(n.a)(eb,"CatchUpNetworkingWrapper",null,[652]);var Eb=d(380);class oc extends Eb.a{constructor(w,
T){super(w,T)}Zk(){return 6}}Object(n.a)(oc,"GetActivityFeedRequest",Eb.a,[]);class Sb extends Eb.a{constructor(w,T,ea,ra,wa,Za){super(w,T);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=ea;this.ActivityStatesToSet=ra;this.ActivityStatesToReset=wa;this.ResetUnseenCount=Za}Zk(){return 7}}Object(n.a)(Sb,"UpdateActivityFeedStateRequest",Eb.a,[]);var qc=d(526);class $a{constructor(w,T,ea){this.hjf=w;this.l2a=T;this.w2a=ea}getActivityFeed(w){return Hb.a.then(this.w2a.execute(new oc(this.l2a(),
null),(T,ea,ra)=>this.hjf.Lx(T,ea,ra,"ActivityFeed"),w),T=>{if(!T)return m.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!T.Wi)return m.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!T.Wi.data)return m.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!T.Wi.data.Sd)return m.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;T=qc.a.U7a(T.Wi.data.Sd);
return T?T:(m.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}$Bl(w,T,ea,ra,wa){return Hb.a.then(this.w2a.execute(new Sb(this.l2a(),null,T,ea,ra,wa),(Za,ub,zb)=>this.hjf.Lx(Za,ub,zb,"UpdateActivityFeedState"),w),Za=>{try{return Za.succeeded}catch(ub){return m.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+ub.message),!1}})}}Object(n.a)($a,"CatchUpRequestHandler",null,[651]);var ab=d(214);class Ib{constructor(w){this.eqb=w;this.Uhf=
new ab.a}B1j(){this.s2j()}s2j(){if(this.eqb){var w=T=>{this.Uhf.contains("CatchUpChangesFeedback")||(this.Uhf.add("CatchUpChangesFeedback"),T.logActivity("CatchUpChangesFeedback",null))};this.eqb.execute(T=>{window.setTimeout(()=>{w(T)},2E4)})}else m.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(n.a)(Ib,"FloodgateEventLogger",null,[]);class gc{constructor(w){this.eYh=w}get duration(){return this.eYh.duration}}Object(n.a)(gc,"PerformanceResourceTimingWrapper",
null,[]);class Ta{constructor(w){this.FD=w}Ygj(w){const T=new Ba.a;if(!this.FD)return T;w=this.FD.getEntriesByName(w,"resource");if(!w)return T;for(const ea of w)T.add(new gc(ea));return T}}Object(n.a)(Ta,"PerformanceWrapper",null,[]);class Ab{constructor(){this.Da=null}get name(){return"Common.App.CatchUpActivity"}Zb(w){this.Da=w;this.Da.register(eb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().oa(()=>new eb(Q.AFrameworkApplication.Ke,
new Ta(window.performance)));this.Da.register($a,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().oa(()=>new $a(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>Q.AFrameworkApplication.gh,new qc.a));this.Da.register(Ib,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().oa(()=>new Ib(this.Da.Ja("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){oa.a.instance.Dc(new Ab)}}Object(n.a)(Ab,"CatchUpActivityPackage",null,[2,3]);var kc=d(1199),fb=d(108);class Qb{constructor(w,T,ea){this.JYe=this.KYe=this.LYe=!1;this.XYe=!w&&!T;this.YYe=!w&&!ea;this.XYe||this.YYe||(this.LYe=!w,this.KYe=!T,this.JYe=!ea)}}Object(n.a)(Qb,"RenameDisabledDialogInfo",null,[]);class mb extends fb.StandardDialog{constructor(w,T,ea,ra,wa){super();this.p1e=[];this.r2=new Qb(w,T,ea);
this.rPa=ra;this.UNa=wa;this.hg="RenameDisabledDialog";this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose);this.fel();this.D_k()}fel(){this.r2.XYe?this.vrc(this.rPa?this.UNa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.r2.YYe?this.vrc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.j6h();this.MFc(this.p1e)}vrc(w){Array.add(this.p1e,w)}j6h(){const w=[];this.r2.LYe||
Array.add(w,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.r2.KYe||Array.add(w,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.r2.JYe||Array.add(w,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<w.length&&Array.add(this.p1e,w)}}Object(n.a)(mb,"ReactRenameDisabledDialogBase",fb.StandardDialog,[]);class Jb extends mb{constructor(w,T,ea,ra,wa){super(w,T,ea,ra,wa)}D_k(){this.cGb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(n.a)(Jb,"ReactRenameDisabledDialog",
mb,[]);var Ub=d(82);class tb{static get rg(){return Ub.a.sC(tb.so,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}tb.so="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(n.a)(tb,"RenameDisabledDialogHtml",null,[]);class Bc extends Ub.a{constructor(w,T,ea,ra,wa){super();this.r2=new Qb(w,T,ea);this.rPa=ra;this.UNa=wa;this.hg="RenameDisabledDialog";this.xd=0;this.Xe(1,CommonUIStrings.l_DialogClose);this.rg=tb.rg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.c6("RenameRow")}fxa(){if(this.r2.XYe){let w;w=this.rPa?this.UNa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Bc.vrc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),w)}else this.r2.YYe?Bc.vrc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.uzj()}uzj(){this.r2.LYe&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.r2.KYe&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.r2.JYe&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static vrc(w,T,ea){w.style.display="none";T.innerText=ea}}Object(n.a)(Bc,"RenameDisabledDialog",Ub.a,[]);var Gb=d(73);class Hc{constructor(w,T){this.$3a=0;this.Ca=w;this.Upa=T}initialize(w){if(!this.Ca||!this.Upa)return!1;this.$3a=w;this.wb();return!0}wb(){this.Ca.ya(Na.a.xKc,Gb.a.frame,Object(v.a)(this,this.xKc,"commitNewDocumentTitle"))}xKc(w,T,ea,ra,wa){if(1===ea)return this.Ca.processAction(Na.a.renameFile,
1);w=S.a.XG(this.Upa.Xw);wa=(0,wa.getNewDocumentTitle)();wa.length>this.$3a&&(wa=wa.substr(0,this.$3a));if(32!==this.Ca.La(Na.a.renameFile,2,wa))return this.rPb(w),8;this.rPb(wa);return 32}rPb(w){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(w))}static uC(){return new Hc(Q.AFrameworkApplication.Ta,Q.AFrameworkApplication.Eu)}}Object(n.a)(Hc,"ReactRenameUIHandler",null,[702]);var $b=d(265),lc=d(670),Vb=d(575),ic=d(67),qb=d(180),Wb=d(267),Xc=d(134),xb=d(65);class Rb{constructor(w,T,ea,
ra,wa,Za,ub,zb,tc,pc,bc,yc){this._initialized=!1;this._element=null;this.$3a=0;this.kKd=this.yCd=!1;this.Ca=w;this.Hxd=T;this.Rg=ea;this.$o=ra;this.Upa=wa;this.xnf=Za;this.uDc=ub;this.Cyd=zb;this.fqa=tc;this.yff=pc;this.kj=bc;this.sDd=yc}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(w,T,ea){if(!(this.Ca&&this.Upa&&this.xnf&&this.uDc&&this.Cyd&&T)||0>=w)return!1;this._element=T;this._element.title=ea;this._element.setAttribute(Xc.a.ef,Xc.a.yu);this._element.setAttribute("Unselectable",
"on");this.$3a=w;this.OJ();return this._initialized=!0}OJ(){this.Hxd&&(this.Hxd.pb(ic.a.blur,this._element,Object(v.a)(this,this.onBlur,"onBlur")),this.Hxd.pb(ic.a.paste,this._element,Object(v.a)(this,this.Uvk,"onPaste")));this.Rg.pb(ic.a.Yf,this._element,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.$o.pb(ic.a.pointerDown,this._element,Object(v.a)(this,this.ixa,"onPointerDown"));this.$o.pb(ic.a.CR,this._element,Object(v.a)(this,this.nIe,"onPointerUp"))}onBlur(){this.isActive&&!this.yCd&&(this.yff||
this.Cyd(this._element),this.gHf(),this.wZd(!1));return this.yCd=!1}Uvk(){m.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(w){return this.isActive?this.Auk(w):this.Buk(w)}Auk(w){let T=!1;switch(w.qc.keyCode){case Sys.UI.Key.enter:this.gHf();this.wZd(this.kj||this.sDd);T=!0;break;case Sys.UI.Key.tab:this.yff&&this.Cyd(this._element);break;case Sys.UI.Key.esc:this.CSe(),this.wZd(this.kj||this.sDd),T=!0}return T}Buk(w){let T=!1;switch(w.qc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.nDh(this.sDd),
this.isActive&&this.uDc(this._element),T=!0}return T}ixa(){this.isActive||(this.nDh(!1),this.isActive&&(this._element.focus(),this.uDc(this._element),this.kKd=!0));return!1}nIe(){return this.kKd?(this.uDc(this._element),this.kKd=!1,!0):!1}Wzb(){return 32===this.Ca.processAction(Na.a.renameFile,1)}gHf(){const w=S.a.XG(this.Upa.Xw);let T=this._element.innerText.trim();T.length>this.$3a&&(T=T.substr(0,this.$3a));T!==w&&""!==T?32!==this.Ca.La(Na.a.renameFile,2,T)?this.CSe():this.rPb(T):this.CSe()}CSe(){this.rPb(S.a.XG(this.Upa.Xw))}rPb(w){this._initialized&&
(this._element.innerText=w,this.xnf())}nDh(w){this.Wzb()?this.isActive||(w&&(this.yCd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Xc.a.ef,Xc.a.fyf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,$b.CuiHelper.BQf),this.fqa&&this.fqa.execute(T=>{T.peh(!0)}),w&&this._element.focus(),m.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(Na.a.UMb,
2)}wZd(w){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Xc.a.ef,Xc.a.yu);Sys.UI.DomElement.removeCssClass(this._element,$b.CuiHelper.BQf);this.fqa&&this.fqa.execute(T=>{T.peh(!1)});w&&(this._element.blur(),this._element.focus())}static I_a(){lc.a.I_a(Q.AFrameworkApplication.isRtl)}static uC(){return new Rb(Q.AFrameworkApplication.Ta,Vb.a.instance,qb.KeyInputManager.instance,Wb.a.instance,Q.AFrameworkApplication.Eu,Rb.I_a,
xb.a.O6k,xb.a.AFf,ia.a.instance.Ja("Common.App.Header.HeaderEventSource"),da.a.NF,da.a.Ni,da.a.eg)}}Object(n.a)(Rb,"RenameUIHandler",null,[702]);class wc{static get instance(){return Q.AFrameworkApplication.Aa.hb.$N?wc.Ka||(wc.Ka=Hc.uC()):wc.Ka||(wc.Ka=Rb.uC())}}wc.Ka=null;Object(n.a)(wc,"RenameUIHandlerFactory",null,[]);class ud{constructor(){this.mFe=this.Hnk=this.GIi=null}}Object(n.a)(ud,"RenameMruEntryProperties",null,[]);var uc=d(175),db=d(126),Yb=d(438),Zc;(function(w){w[w.unknown=-1]="unknown";
w[w.success=0]="success";w[w.renameInvalidFileName=1]="renameInvalidFileName";w[w.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";w[w.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";w[w.permissionDenied=4]="permissionDenied";w[w.serverCommunicationFailure=5]="serverCommunicationFailure";w[w.fileNameTooLong=6]="fileNameTooLong"})(Zc||(Zc={}));Object(n.b)("CommonOperationResult",Zc);class Kb{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc){this.Jff=w;this.Ca=T;this.cha=ea;this.fF=
ra;this.Q3a=wa;this.V2h=Za;this.rPa=ub;this.pqf=zb;this.uZh=tc;this.UNa=pc;this.$a=bc;this.tZh=yc}wb(){Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.$N||this.An.ya(Na.a.E8b,Gb.a.frame,Object(v.a)(this,this.E8b,"initializeRenameUIHandler"));this.An.ya(Na.a.UMb,Gb.a.frame,Object(v.a)(this,this.UMb,"showRenameDisabledDialog"));this.An.ya(Na.a.renameFile,Gb.a.frame,Object(v.a)(this,this.renameFile,"renameFile"));this.An.ra(Na.a.fileNameUpdate,Gb.a.frame,Object(v.a)(this,this.USk,"refreshFilename"),
64);this.An.ra(Na.a.ldd,Gb.a.frame,Object(v.a)(this,this.ldd,"moveToFolderCompleteByHost"),64);this.An.ya(Na.a.pgb,Gb.a.frame,Object(v.a)(this,this.pgb,"moveToFolder"));(Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||Q.AFrameworkApplication.Aa&&(Q.AFrameworkApplication.fa.ka("PostMessageEmbedded")||Q.AFrameworkApplication.fa.ka("IsJsApi"))&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&Q.AFrameworkApplication.kT().execute(w=>{w.wu(db.a.IZg);w.HB(db.a.IZg,Kb.aRk);w.wu(db.a.b3d);w.HB(db.a.b3d,Kb.ZQk)})}Wzb(){return 0===this.tZh.D5f()?32:8}hHl(){return this.PA?this.rPa?this.PA.g0d:this.PA.RDa:!0}E8b(){return wc.instance.initialize(Q.AFrameworkApplication.EPc,Q.AFrameworkApplication.RNc,Q.AFrameworkApplication.$ih||CommonUIStrings.l_RenameFileTooltip)?32:8}UMb(){const w=this.hHl(),T=this.V2h();m.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Q3a,T,w,this.rPa);Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.GC&&Q.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new Jb(this.Q3a,!T,!w,this.rPa,this.UNa()):new Bc(this.Q3a,!T,!w,this.rPa,this.UNa());return 32}renameFile(w,T,ea,ra,wa){if(1===ea)return this.Wzb();if(!Q.AFrameworkApplication.w8a)return 8;if(8===this.Wzb())return this.An.processAction(Na.a.UMb,2),8;m.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Q.AFrameworkApplication.w8a(wa,Object(v.a)(this,
this.qkc,"onRenameFileSuccess"),Object(v.a)(this,this.Lwk,"onRenameFileFailure"));return 32}qkc(w,T){w?0!==w.OperationResult?this.k$f(w.OperationResult):(this.U7k(T,w.NewName),this.lCl(w,Object(v.a)(Q.AFrameworkApplication.Aa.hb,Q.AFrameworkApplication.Aa.hb.hHh,"updateOpenInClientDocumentUrl")),Q.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&Q.AFrameworkApplication.Aa.updateCommandUI(),this.uZh.QFh()):this.k$f(5)}U7k(w,T){const ea={};ea[uc.a.RWi]=T;w.sendMessage(db.a.b3d,ea)}lCl(w,
T){this.wCl(w);Q.AFrameworkApplication.kNc=w.DirectInvokeDavUrl;T=T(w.EditDocInClientUrl);const ea=new ud;ea.mFe=this.fF.Xw;ea.GIi=T;ea.Hnk=w.EditDocInClientUrl;this.An.La(Na.a.ajh,2,ea)}k$f(w){switch(w){case 1:w=new fb.StandardDialog,w.xd=0,w.fP(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.mlh()}}wCl(w){this.fF.Xw=Kb.Mdi(this.fF.Xw,w.NewName);w.BreadcrumbFolderName&&(this.fF.breadcrumbFolderName=w.BreadcrumbFolderName);w.BreadcrumbFolderUrl&&(this.fF.breadcrumbFolderUrl=
w.BreadcrumbFolderUrl);this.pqf(w.NewName)}Lwk(w){const T=new fb.StandardDialog;T.xd=0;switch(w){case 1:m.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");T.tkb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:m.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");T.tkb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:m.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:w}),T.tkb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}Q.AFrameworkApplication.kT().execute(ea=>{ea.sendMessage(db.a.QWi,{["FailureMessage"]:Zc[w]})});this.mlh()}USk(w,T,ea){if(1===ea)return this.Wzb();if(!Q.AFrameworkApplication.Isa)return 8;Q.AFrameworkApplication.Isa(Object(v.a)(this,this.oHb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.Vfd,"onRefreshFilenameFailure"),!1);return 32}pgb(w,T,ea,ra,
wa){if(1===ea)return Q.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===ea){const Za={};w=Q.AFrameworkApplication.ubb;T=Q.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");w=(!w||w&&T)&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Za[uc.a.Mrl]=w;wa&&wa.MoveButtonClickedTime&&(Za[uc.a.Imk]=wa.MoveButtonClickedTime.getTime());Q.AFrameworkApplication.kT().execute(ub=>{ub.sendMessage(db.a.pgb,Za)});wa&&wa.MoveButtonClickedTime&&
((w=fa.a.Rz())&&w.set("MovePostDuration",((new Date).getTime()-wa.MoveButtonClickedTime.getTime()).toString()),u.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",w));return 32}return 8}ldd(w,T,ea,ra,wa){if(1===ea)return Q.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.Wzb():8;if(2===ea){if(!Q.AFrameworkApplication.Jpc)return u.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!wa)return u.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(wa[uc.a.wLj])if(wa[uc.a.cIh])if(w=wa[uc.a.cIh].toLowerCase(),T=Q.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),ea=Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),T&&Q.AFrameworkApplication.ubb&&ea){const Za={};Za[uc.a.PJb]="1";Za[uc.a.documentUrl]=w;Za[uc.a.reason]=Yb.a.CTe;u.Health.instance.recordKpiSuccess("MoveToFolder",null);Q.AFrameworkApplication.kT().execute(ub=>{ub.sendMessage(db.a.lDa,Za)})}else if(!Q.AFrameworkApplication.ubb&&
ea)u.Health.instance.recordKpiSuccess("MoveToFolder",null),xb.a.vn(w,xb.a.hba(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return u.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else u.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Q.AFrameworkApplication.Isa(Object(v.a)(this,this.oHb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.Vfd,"onRefreshFilenameFailure"),!1),Q.AFrameworkApplication.Jpc(),u.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32}Djl(w,T){return w&&T?w!==this.fF.breadcrumbFolderName||T!==this.fF.breadcrumbFolderUrl:!1}oHb(w,T){w&&(w.NewName!==S.a.XG(this.fF.Xw)||this.Djl(w.BreadcrumbFolderName,w.BreadcrumbFolderUrl))&&this.qkc(w,T)}Vfd(){}mlh(){this.pqf(S.a.XG(this.fF.Xw))}get An(){return this.Ca.value}get PA(){return this.cha.value}static get instance(){return Kb.Ka||(Kb.Ka=Kb.m9a())}static m9a(){return new Kb(Q.AFrameworkApplication.C$b,new kc.a(()=>Q.AFrameworkApplication.Ta),new kc.a(()=>Q.AFrameworkApplication.PA),
Q.AFrameworkApplication.Eu,Q.AFrameworkApplication.PQ,()=>Q.AFrameworkApplication.Iuc,Q.AFrameworkApplication.woc,Object(v.a)(wc.instance,wc.instance.rPb,"updateTitle"),ia.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>Q.AFrameworkApplication.BT,Q.AFrameworkApplication.fa,ia.a.instance.resolve("Common.IRenameProps"))}static Mdi(w,T){w=S.a.fT(w);return T+w}static aRk(w){const T=w.Values[uc.a.XPj];m.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",T);
T?Q.AFrameworkApplication.Ta.La(Na.a.ldd,2,w.Values):u.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static ZQk(w){Q.AFrameworkApplication.Ta.La(Na.a.renameFile,2,w.Values.NewName)}}Kb.Ka=null;Object(n.a)(Kb,"RenameActor",null,[]);var Yc=d(388),ec=d(655),rb=d(595),ac=d(198);class Jc{constructor(w,T){this.Ca=w;this.Kzd=T}wb(){this.Ca.ya(Na.a.SYe,Gb.a.frame,Object(v.a)(this,this.gml,"showRenameDialogAction"))}gml(w,T,ea){w=32;if(1===ea)return ac.SessionStatusManager.instance.uka||
Q.AFrameworkApplication.KQ?8:32;2===ea&&(32!==this.Ca.processAction(Na.a.renameFile,1)?(this.Ca.processAction(Na.a.UMb,2),Yc.a.instance.Xb(ec.a.Lja,{["Reason"]:rb.a.f_k}),w=8):32===this.Ca.processAction(Na.a.urc,1)?this.Ca.processAction(Na.a.urc,2):this.Kzd.value.create().g6());return w}}Object(n.a)(Jc,"RenameDialogActor",null,[672]);class Db{constructor(w,T,ea){this.dialog=null;this.Ca=w;this.fF=T;this.wNa=ea}Sgj(){const w={};w.nameInputProps={["type"]:"AppInputProps",["id"]:Db.Mub,["label"]:CommonUIStrings.l_RenameDialogLabel,
["value"]:S.a.XG(this.fF.Xw),["maxLength"]:this.wNa};return w}g6(){const w={["id"]:"RenameDialog",["bodyControls"]:this.Sgj()};this.dialog=new Ub.a(!1,!1,!0);this.dialog.xd=1;this.dialog.hg="RenameDialog";this.dialog.Zi(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.rRe,"renameDialogHandler"),w)}rRe(w,T){if(T&&1===w){if(T[Db.Mub]&&(w=S.a.XG(this.fF.Xw),T=(T[Db.Mub]||"").trim(),T!==w&&""!==T)){this.Ca.La(Na.a.renameFile,2,T);return}Yc.a.instance.Xb(ec.a.D2b,{["Reason"]:rb.a.oVf})}}}Db.Mub=
"txtDocumentName";Object(n.a)(Db,"ReactRenameDialog",null,[705]);class dd{static get rg(){return Ub.a.sC(dd.so,CommonUIStrings.l_RenameDialogLabel)}}dd.so="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(n.a)(dd,"RenameDialogHtml",null,[]);class Cd extends Ub.a{constructor(w,T,ea){super();this.Ca=w;this.fF=T;this.wNa=
ea;this.hg="RenameDialog";this.rg=dd.rg}g6(){var w={["txtDocumentName"]:S.a.XG(this.fF.Xw)};this.Zi(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.rRe,"renameDialogHandler"),w);w=document.getElementById(Cd.Mub);0<this.wNa&&(w.maxLength=this.wNa);w.focus()}rRe(w,T){if(1===w&&(w=S.a.XG(this.fF.Xw),T=(T[Cd.Mub]||"").trim(),T!==w&&""!==T)){this.Ca.La(Na.a.renameFile,2,T);return}Yc.a.instance.Xb(ec.a.D2b,{["Reason"]:rb.a.oVf})}}Cd.Mub="txtDocumentName";Object(n.a)(Cd,"RenameDialog",Ub.a,[705]);
class pd{constructor(w){this.Upa=null;this.wNa=0;this.Ca=w;this._initialized=!1}initialize(w,T){this.Upa=w;this.wNa=T;this._initialized=!0}create(){return this._initialized?Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.GC&&Q.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new Db(this.Ca,this.Upa,this.wNa):new Cd(this.Ca,this.Upa,this.wNa):null}}Object(n.a)(pd,"RenameDialogFactory",null,[673]);var Ge=d(121),kd=d(104),Xf=d(71),Kd=d(81),lg=d(133);class ve{constructor(w,T){this.Ca=
w;this.Nd=T}wb(){this.Ca.ya(Na.a.urc,Gb.a.frame,Object(v.a)(this,this.hml,"showRenameFlyoutAction"))}lpi(){return Xf.d("setDocumentTitleFlyoutOpened")&&Q.AFrameworkApplication.Aa.hb.$N}hml(w,T,ea){if(1===ea)return this.lpi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}o7h(){ve.sUj&&Q.AFrameworkApplication.vua&&lg.a.instance.Db(new Kd.a(5,1,5E3,()=>{32===this.Ca.processAction(Na.a.urc,1)&&this.Nd&&this.Nd.Ae.name===Ge.AFrame.yW&&(kd.a("RenameFloatieShownOnNewDocumentLoad",
!0),this.Ca.processAction(Na.a.urc,2))}))}static get sUj(){ve.Zzc&&null!=ve.Zzc||(Q.AFrameworkApplication.bGa("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ve.Zzc=Q.AFrameworkApplication.fa?Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ve.Zzc}}ve.Zzc=null;Object(n.a)(ve,"RenameFlyoutActor",null,[669]);class Ua{constructor(w,T,ea,ra,wa){this.IVd=null;this.cha=wa;this.Kff=ea;this.Jff=
ra;this.X2h=w;this.UNa=T}get PA(){return this.cha.value}D5f(){if(!this.Jff())return 5;if(this.UNa())return 1;if(this.PA){if(this.Kff&&!this.PA.g0d)return 3;if(!this.Kff&&!this.PA.RDa)return 4}return this.X2h()?0:2}}Object(n.a)(Ua,"RenameProps",null,[668]);var Bb=d(69);class mc{constructor(w,T,ea,ra,wa,Za){this.WB=!1;this.bFd=new Bb.a;this.Inb=T;this.txc=ea;this.Gwc=ra;this.$a=wa;this.gia=Za}enable(){this.WB||(this.QFh(),this.k_e(),this.WB=!0)}generateKey(w,T,ea){return String.format("{0}/{1}/{2}",
ea,w,T)}Waj(){const w=S.a.XG(this.Inb().Xw);return this.generateKey(this.Inb().breadcrumbFolderName,this.Inb().breadcrumbFolderUrl,w)}Xaj(w,T,ea){return w&&T?this.generateKey(w,T,ea):ea}xMi(w,T,ea){return w&&w!==this.Inb().breadcrumbFolderName||T&&T!==this.Inb().breadcrumbFolderUrl?!0:ea!==S.a.XG(this.Inb().Xw)}QFh(){const w=this.Waj();this.bFd.$(w,new Date)}rKe(w){this.iil(w)&&this.xrf(w)}iil(w){const T=this.Gwc();return T?this.gia&&this.gia.Xab||!T.zje||!Q.AFrameworkApplication.Isa?(this.Cyh(w),
this.WB=!1):!0:!1}t6g(w,T,ea,ra){const wa=this.xMi(w,T,ea);w=this.Xaj(w,T,ea);T=this.bFd.Uf(w).returnValue;wa&&!T&&(this.n$f(ra),m.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Qua));wa||this.bFd.$(w,this.txc())}}Object(n.a)(mc,"ARenamedFileChecker",null,[650]);class Nc extends mc{constructor(w,T,ea,ra,wa,Za,ub,zb){super(w,T,ea,ra,wa,Za);this.fmf=wa;this.sZh=ub;this.mCd=zb}get Qua(){return"RenamedFileCheckerUsingSettingsRefresh"}k_e(){this.fmf.xPd(Object(v.a)(this,this.oag,"handleSettingsRefresh"))}oag(w,
T){T&&T.sjc&&T.Wpk&&(T.gAb("BreadcrumbDocName")||T.gAb("BreadcrumbFolderName")||T.gAb("BreadcrumbFolderUrl")||T.gAb("DirectInvokeDAVUrl")||T.gAb("EditDocInClientUrl"))&&(m.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Qua),this.rKe(T))}Cyh(){this.fmf.Bih(Object(v.a)(this,this.oag,"handleSettingsRefresh"))}xrf(w){if(w&&w.sjc){const T=w.sjc;this.t6g(T.Ga("BreadcrumbFolderName"),T.Ga("BreadcrumbFolderUrl"),T.Ga("BreadcrumbDocName"),w)}}n$f(w){const T={OperationResult:0,classId:1};
w=w.sjc;T.BreadcrumbFolderName=w.Ga("BreadcrumbFolderName");T.BreadcrumbFolderUrl=w.Ga("BreadcrumbFolderUrl");T.DirectInvokeDavUrl=w.Ga("DirectInvokeDAVUrl");T.EditDocInClientUrl=w.Ga("EditDocInClientUrl");w=w.Ga("BreadcrumbDocName");T.NewName=Q.AFrameworkApplication.MNc?w:S.a.XG(w);this.mCd.execute(ea=>{this.cIj(T,ea)})}cIj(w,T){this.sZh().qkc(w,T)}}Object(n.a)(Nc,"RenamedFileCheckerUsingSettingsRefresh",mc,[]);class nd extends mc{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc){super(w,ea,ra,wa,Za,tc);
this.cWb=this.rFc=null;this.jYh=T;this.Ca=ub;this.Zd=zb;pc&&pc.execute(bc=>{this.FVk(bc)})}get Qua(){return"RenamedFileCheckerUsingTask"}FVk(w){this.rFc=w;this.rFc.FGc(Object(v.a)(this,this.C7b,"handleVisibilityChange"))}C7b(w,T){!this.WB||0!==T.newState&&1!==T.newState||this.cWb||(this.k_e(),this.rKe(this.cWb))}k_e(){this.cWb=new Kd.a(3,2,this.jYh(),Object(v.a)(this,this.rKe,"performRenameFileCheckTick"),89);this.Zd.Db(this.cWb)}Cyh(w){this.Zd.Lg(w)}xrf(w){this.rFc&&2===this.rFc.m6a?this.KWk(w):
Q.AFrameworkApplication.Isa(Object(v.a)(this,this.oHb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.Vfd,"onRefreshFilenameFailure"),!0)}KWk(w){this.Zd.Lg(w);this.cWb=null}oHb(w){w&&this.t6g(w.BreadcrumbFolderName,w.BreadcrumbFolderUrl,w.NewName,null)}n$f(){this.Ca.processAction(Na.a.fileNameUpdate,2)}Vfd(){}}Object(n.a)(nd,"RenamedFileCheckerUsingTask",mc,[]);var Dd=d(95);class La{constructor(){this.$a=this.Da=null}get name(){return"Common.App.RenameFile"}Zb(w){this.Da=w;this.$a=Q.AFrameworkApplication.fa;
this.Da.register(Jc,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").oa(()=>new Jc(Q.AFrameworkApplication.Ta,this.Da.ie("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(pd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").oa(()=>new pd(Q.AFrameworkApplication.Ta)).ma();this.Da.register(650,"Common.App.Rename.IRenamedFileChecker").oa(()=>this.ZFi()).ma();this.Da.register(ve,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").oa(()=>
new ve(Q.AFrameworkApplication.Ta,Dd.FocusManager.instance())).ma()}ZFi(){if(this.$a.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const w=this.Da.ub("Common.IRefreshableAppSettings");if(w&&w.TSj)return new Nc(()=>w.Bc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>Q.AFrameworkApplication.Eu,()=>new Date,()=>Q.AFrameworkApplication.PA,w,this.Da.ub("Common.ISessionStatus"),()=>Kb.instance,this.Da.Ja("Postmessage.IHostPostmessenger"))}return new nd(()=>this.$a.Bc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.$a.Bc("RenamedFileCheckerPingIntervalInMs",12E4),()=>Q.AFrameworkApplication.Eu,()=>new Date,()=>Q.AFrameworkApplication.PA,Q.AFrameworkApplication.fa,Q.AFrameworkApplication.Ta,Q.AFrameworkApplication.ye,this.Da.ub("Common.ISessionStatus"),this.Da.Ja("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.$a.gf(Object(v.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){const w=Q.AFrameworkApplication.Aa.hb.$N;Q.AFrameworkApplication.C$b()&&wc.instance.initialize(Q.AFrameworkApplication.EPc,
w?null:Q.AFrameworkApplication.RNc,w?null:Q.AFrameworkApplication.$ih||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(Ua,"Common.App.Rename.RenameProps").as("Common.IRenameProps").oa(()=>new Ua(()=>Q.AFrameworkApplication.Iuc,()=>Q.AFrameworkApplication.BT,Q.AFrameworkApplication.woc,Q.AFrameworkApplication.C$b,new kc.a(()=>Q.AFrameworkApplication.PA))).ma(),Kb.instance.wb(),this.$a.ka("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(Q.AFrameworkApplication.Eu,
Q.AFrameworkApplication.EPc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").wb()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").wb(),Q.AFrameworkApplication.woc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").o7h())}dispose(){}}Object(n.a)(La,"PackageManager",null,[2,3]);const gb=w=>{try{return X.a(w)}catch(T){}return null};class vc{constructor(w,T,ea,ra,wa,Za){this.o2=!1;this.tS=null;this.dId=!1;this.Ca=
w;this.Xh=T;this.cha=ea;this.uhf=ra;this.$a=wa;this.tVh=Za}init(w,T){T&&w.Ja("Common.Interface.IRtcBasicProvider").execute(Object(v.a)(this,this.cSd,"awaitRtc"))}cSd(w){const T=w.lM.task;T.continueWith(()=>{this.tS=T.result;this.dId&&(this.tS.Zfa(2,null,!0),this.dId=!1);this.tS.WBa((ea,ra)=>{2===ra.type&&this.An.processAction(Na.a.fileNameUpdate,2)});this.tS.f6a((ea,ra)=>{2===ra.newState&&this.An.processAction(Na.a.fileNameUpdate,2)});2===this.tS.connectionState&&this.An.processAction(Na.a.fileNameUpdate,
2)})}Isa(w){this.yTf(w,!0)}yTf(w,T){const ea=this.cli(w.Awh),ra={};ra[vc.cIf]=vc.dIf;this.skh.mj(ea,2,"",ra,!1,2,Object(v.a)(this,this.oHb,"onRefreshFilenameSuccess"),T?Object(v.a)(this,this.Ewk,"onRefreshFilenameFailureRetry"):Object(v.a)(this,this.j5g,"onRefreshFilenameFailureNoRetry"),w)}oHb(w){this.o2=!1;const T=gb(w.data.Sd);w.data.state.onSuccess(T,this.uhf.value)}Ewk(w){5!==w.data.status||this.o2?this.j5g(w):(this.o2=!0,this.yTf(w.data.state,!1))}j5g(w){w.data.state.xz(-1)}w8a(w){this.zTf(w,
!0)}zTf(w,T){const ea=this.dli(),ra={};ra[vc.cIf]=vc.dIf;ra[vc.mxj]=S.a.Ne(w.Ckh);ra[vc.kxj]=this.tVh.value.IVd;this.skh.mj(ea,2,"",ra,!1,2,Object(v.a)(this,this.qkc,"onRenameFileSuccess"),T?Object(v.a)(this,this.Mwk,"onRenameFileFailureRetry"):Object(v.a)(this,this.p5g,"onRenameFileFailureNoRetry"),w)}dli(){return this.GAf()}cli(w){let T=this.GAf();return T=J.a.Ki(T,vc.qxj,w?"2":"1")}GAf(){let w=(this.$a.value.appSettings.RenameWebServiceBase||"")+vc.lxj;w=J.a.Ki(w,vc.nxj,S.a.Ne(Q.AFrameworkApplication.gh));
this.PA&&this.PA.zje&&(w=J.a.Ki(w,vc.pxj,"1"));return w}qkc(w){this.o2=!1;const T=gb(w.data.Sd);w.data.state.onSuccess(T,this.uhf.value);this.i0g()}i0g(){this.tS?this.tS.Zfa(2,null,!0):this.dId=!0}Mwk(w){5!==w.data.status||this.o2?this.p5g(w):(this.o2=!0,this.zTf(w.data.state,!1))}p5g(w){w.data.state.xz(-1)}get An(){return this.Ca.value}get skh(){return this.Xh.value}get PA(){return this.cha.value}static get instance(){return vc.Ka||(vc.Ka=vc.m9a())}static m9a(){return new vc(new kc.a(()=>Q.AFrameworkApplication.Ta),
new kc.a(()=>Q.AFrameworkApplication.Ke),new kc.a(()=>Q.AFrameworkApplication.PA),new kc.a(()=>ia.a.instance.resolve("Postmessage.IHostPostmessenger")),new kc.a(()=>Q.AFrameworkApplication.fa),new kc.a(()=>ia.a.instance.resolve("Common.IRenameProps")))}}vc.cIf="Content-Type";vc.dIf="application/json; charset=utf-8";vc.lxj="renamehandler.ashx";vc.nxj="qs";vc.mxj="n";vc.pxj="sl";vc.kxj="X-CoauthLockId";vc.qxj="u";vc.Ka=null;Object(n.a)(vc,"ExecuteRenameFileHandler",null,[]);class td{constructor(){this.xz=
this.onSuccess=null;this.Awh=!1}}Object(n.a)(td,"ExecuteRefreshFilenameData",null,[]);class Nd{constructor(){this.xz=this.onSuccess=this.Ckh=null}}Object(n.a)(Nd,"ExecuteRenameFileData",null,[]);class Od{constructor(){this.Da=null;this.LAd=vc.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Zb(w){this.Da=w}init(){Q.AFrameworkApplication.fa.gf(Object(v.a)(this,this.Pm,"onFullAppSettingsReady"))}Pm(){Q.AFrameworkApplication.C$b()&&(vc.instance.init(this.Da,Q.AFrameworkApplication.woc),
Q.AFrameworkApplication.w8a=Object(v.a)(this,this.w8a,"executeRenameFile"),Q.AFrameworkApplication.Isa=Object(v.a)(this,this.Isa,"executeRefreshFilename"),Q.AFrameworkApplication.Jpc=Object(v.a)(this,this.Jpc,"sendFileNameAndLocationUpdateNotification"))}w8a(w,T,ea){const ra=new Nd;ra.Ckh=w;ra.onSuccess=T;ra.xz=ea;this.LAd.w8a(ra)}Isa(w,T,ea){const ra=new td;ra.onSuccess=w;ra.xz=T;ra.Awh=ea;this.LAd.Isa(ra)}Jpc(){this.LAd.i0g()}dispose(){}}Object(n.a)(Od,"PackageManager",null,[2,3]);class Oc{constructor(w,
T,ea,ra,wa,Za){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=w;this.WebAffinitizedUrl=T;this.PolicyCookie=ea;this.PolicyCookieTTL=ra;this.WasServiceDown=wa;this.AffinitizedUrl=Za}}Object(n.a)(Oc,"SafeLinksData",null,[]);class Af{constructor(w,T){this.lsd=w;this.Hy=T}}Object(n.a)(Af,"SafeLinksGetUrlReputationRequestData",null,[]);class Ae{constructor(w,T,ea,ra){this.$a=w;this.Xh=T;
this.gSh=ea;Ae.Yh=ra}Ktd(w,T,ea){try{var ra=null;Ae.Yh&&(ra=Ae.Yh.Ci("WebServiceCall","SafeLinksGetUrlReputation"));const wa=new Af(T,ra);ra={};ra.AffinitizedUrl=w;ra.TargetUrl=T;ra.PolicyCookie=ea;const Za=X.c(ra);this.Xh.mj(this.gSh,2,Za,null,!1,2,Object(v.a)(this,this.Mtk,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.Ltk,"onGetUrlReputationFailureCallback"),wa,void 0,void 0,3E3,3E3,"36");return!0}catch(wa){m.ULS.sendTraceTag(588788033,378,10,wa.message)}return!1}Mtk(w){let T="OnGetUrlReputationSuccessCallback: ",
ea=10;const ra=w.data.state;try{const wa=X.b(w.data.Sd).reputationResults[0],Za=wa.navigateUrl.length,ub=ra.lsd.length,zb=wa.navigateUrl===ra.lsd;wa.navigateUrl&&0<wa.navigateUrl.length&&(ra.lsd=wa.navigateUrl);T+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",w.data.oe,wa.verdict,ub.toString(),Za.toString(),zb.toString());ea=50}catch(wa){T+=String.format("Exception {0}",wa.message)}this.s$f(ra,T,ea)}Ltk(w){let T="OnGetUrlReputationFailureCallback: ";
const ea=w.data.state;try{T+=String.format("HttpStatus {0}",w.data.oe)}catch(ra){T+=String.format("Exception {0}",ra.message)}this.s$f(ea,T,10)}s$f(w,T,ea){w.Hy&&(w.Hy.stop(),w.Hy=null);m.ULS.sendTraceTag(588788034,378,ea,T);xb.a.vn(w.lsd,void 0,"noopener,noreferrer","SafeLinksNav")}}Ae.Yh=null;Object(n.a)(Ae,"SafeLinksNavigationHelper",null,[]);var Ye;(function(w){w[w.enabledByPolicy=0]="enabledByPolicy";w[w.disabledByPolicy=1]="disabledByPolicy";w[w.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";
w[w.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Ye||(Ye={}));Object(n.b)("SafeLinksNavigationState",Ye);var Wd=d(496);class je{constructor(w,T,ea,ra=!1,wa=null,Za=null){this.i3a=this.h3a=0;this.L9b=this.Myc=!1;this.GOa=null;this.Gob=!0;this.CDc=null;m.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.$a=w;this.Xh=T;this.Epa=ea;je.Yh=Za;this.p3h=ra?this.$a.Ga("SafeLinksHandlerWebServiceBase"):this.$a.Ga("WebServiceBase");this.Y2h=this.$a.Ga("SafeLinksHashedUserId");
this.JKl=this.$a.Ga("SafeLinksWorkloadIdHeaderValue");this.MAc=this.$a.Bc("SafeLinksMaxGetPolicyBootRetries",2);this.NAc=this.$a.Bc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Ezc=this.wTj();this.Dzc=this.vTj();m.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Ezc,this.Dzc);if(this.Ezc&&this.Dzc){T=(w=this.mwb())?w.IsSafeLinksEnabled.toLowerCase():"";ea=this.Yke();m.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",
T,ea);var ub=!w||"unknown"===T||w.WasServiceDown||ea,zb=fa.a.Rz();zb&&(zb.set("shouldGetSafeLinksDataFromServer",ub.toString()),zb.set("isSafeLinksEnabledCacheValue",T.toString()));wa?(this.Gob=!1,wa.execute(tc=>{tc.isFeatureEnabled("MsoUrlreputation",!0).then(pc=>{this.Gob=pc;zb.set("isUserLicensedForSafeLinks",this.Gob.toString());u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",zb);this.Gob&&ub&&this.XTc(!0);return null})})):(u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",
0,"jpittsdirects",zb),ub&&this.XTc(!0))}}get appName(){return this.Epa}get Fvd(){return this.p3h}get userId(){return this.Y2h}get wfj(){const w=this.Fvd?this.Fvd+"/":"",T=new ma.QueryStringBuilder("SafeLinksHandler.ashx");T.yi("app",this.appName);this.$a.ka("SafeLinksUseDebugHeader")&&T.yi("action","debug");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&T.yi("s2satpop","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&T.yi("s2se03","1");return String.format("{0}{1}&{2}",w,T.toString(),Q.AFrameworkApplication.gh)}get rnj(){const w=this.Fvd?this.Fvd+"/":"",T=new ma.QueryStringBuilder("SafeLinksHandler.ashx");T.yi("app",this.appName);this.$a.ka("SafeLinksUseDebugHeader")&&T.yi("action","debug");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&T.yi("s2satpop","1");this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&T.yi("s2saat","1");
this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&T.yi("s2se03","1");T.yi("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",w,T.toString(),Q.AFrameworkApplication.gh)}get vnk(){je.VJd||(je.VJd=new Ae(this.$a,this.Xh,this.rnj,je.Yh));return je.VJd}Ktd(w){if(!w)return m.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var T=this.lOj(w);m.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
T,this.Ezc,this.Dzc,this.Gob);if(!(T&&this.Ezc&&this.Dzc&&this.Gob))return!1;T=0;const ea=({state:T}=this.Bjl()).returnValue;m.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Ye[T]);const ra=fa.a.Rz();ra&&ra.set("SafeLinksNavigationState",Ye[T]);u.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",ra);if(!ea)return 2!==T&&3!==T||u.Health.instance.recordKpiFailure("SafeLinksNavigations",Ye[T],!1,!0,null),!1;m.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.Ojl())return this.Yke()?!1:this.vnk.Ktd(this.O2i(),w,this.Y4f());if(!this.Yke())return this.cEh(w),!0;this.GOa=w;m.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.L9b=!1;this.XTc();return!0}lOj(w){w=w.toLowerCase();const T=this.$a.WA("SafeLinksUnsupportedProtocols");if(T)for(let ea=0;ea<T.length;ea++)if(w.startsWith(T[ea]))return!1;return!0}XTc(w=!1){var T=fa.a.Rz();T&&T.set("isOnBootRequest",w.toString());
u.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",T);u.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",T);T=this.tXd("SafeLinksGetPolicy");this.Xh.mj(this.wfj,1,null,null,!0,2,Object(v.a)(this,this.Ohj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.Nhj,"getSafeLinksDataFromServer_OnFailureCallback"),T,void 0,void 0,void 0,void 0,"23");this.L9b=w;this.Myc=!0;w?this.h3a++:this.i3a++}Ohj(w){let T=G.a.yok,
ea="";try{this.Myc=this.L9b=!1;var ra=w.data.state;const yc=({Hy:ra}=this.srd(ra)).returnValue,$c=Object.assign(new Ca.a,{durationMs:yc});u.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",$c);m.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",w.data.oe,w.data.Sd.length,yc);if(w.data.oe!==G.a.Uv)ea="Unexpected httpStatus: "+w.data.oe.toString();else{ra=null;try{ra=X.b(w.data.Sd)}catch(gd){ea="Exception:"+
gd.toString()+" deserializing response";return}if(ra){var wa=ra.IsSafeLinksEnabled;if(void 0===wa||null===wa||0>=wa.length)ea="Invalid isSafeLinksEnabledString";else{m.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",wa);var Za=je.UJe(wa);if(void 0===ra.WebAffinitizedUrl||null===ra.WebAffinitizedUrl||0>=ra.WebAffinitizedUrl.length)ea="Invalid WebAffinitizedUrl";else if(void 0===ra.PolicyCookie||null===ra.PolicyCookie||0>=ra.PolicyCookie.length)ea="Invalid PolicyCookie";else if(void 0===
ra.PolicyCookieTTL||null===ra.PolicyCookieTTL)ea="Invalid PolicyCookieTTL";else{var ub=ra.WebAffinitizedUrl,zb=ra.PolicyCookie,tc=ra.AffinitizedUrl,pc=new Date;pc.setMinutes(pc.getMinutes()+(5<ra.PolicyCookieTTL?ra.PolicyCookieTTL-5:0));var bc=new Oc(wa,ub,zb,pc.getTime(),!1,tc);this.wph(bc);T=w.data.oe;this.GOa&&(Za?(this.cEh(this.GOa),this.i3a=this.h3a=0):(m.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),u.Health.instance.recordKpiFailure("SafeLinksNavigations",
"disabledByPolicy",!0,!0,null),xb.a.qQc(this.GOa)),this.GOa=null)}}}else ea="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(yc){ea="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+yc.toString()}finally{T!==G.a.Uv&&this.r$f(T,ea)}}Nhj(w){this.Myc=!1;let T=500,ea="";try{let ra=w.data.state;const wa=({Hy:ra}=this.srd(ra)).returnValue,Za=Object.assign(new Ca.a,{durationMs:wa});T=w.data.oe;u.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+T.toString(),!1,!0,Za);ea="Request Failed, Status="+Wd.a[w.data.status]+" Duration: "+wa}catch(ra){ea="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+ra.toString()}finally{this.r$f(T,ea)}}r$f(w,T=""){try{if(m.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",w,T),this.h3a<this.MAc&&this.i3a<this.NAc)this.XTc(this.L9b);else{this.L9b=!1;m.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.h3a,this.i3a,w,T);T=null;const ea=fa.a.Rz();ea&&(ea.set("HttpStatus",w.toString()),T=Object.assign(new Ca.a,{extendedProperties:ea}));u.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,T);const ra=new Oc("false","","",0,!0,"");this.wph(ra);this.GOa&&(m.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),u.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),xb.a.qQc(this.GOa),this.GOa=null)}}catch(ea){m.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",ea.toString())}}cEh(w){const T=this.Y4f(),ea=this.joj(),ra={};ra.Url=w;ra.SafeLinksCookie=T;ra.CorrelationId=F.a.create().toString();ra.WorkloadId=this.JKl;ra.UserAgentInfo=da.a.Sy+"|"+this.appName;m.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",ra.CorrelationId);xb.a.eid(xb.a.hba(4),ea,ra)}wTj(){const w=this.$a.Ga("IsSafeLinksEnabledForUser");
return w?je.UJe(w):!1}vTj(){const w=this.$a.WA("SafeLinksDisabledBrowsers");if(da.a.wT){if(this.$a.Cu("SafeLinksForTeamsIsEnabled")&&this.$a.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(w,"Electron"))return!1}else if(Array.contains(w,da.a.Sy))return!1;return"officecomhwa"===(this.$a.Ga(Q.AFrameworkApplication.eK)||"").toLowerCase()?!1:!0}Ojl(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&da.a.VZc?!0:da.a.wT}Bjl(){let w;w=0;const T=this.mwb(),ea=T?T.IsSafeLinksEnabled:"";if(""!==ea)return T.WasServiceDown?(m.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===ea.toLowerCase()?(m.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:je.UJe(ea),state:w};if(this.Myc)return w=3,m.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:w};if(this.h3a>=
this.MAc||this.i3a>=this.NAc)return w=2,m.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.h3a,this.MAc,this.i3a,this.NAc),{returnValue:!1,state:w};m.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.MAc+this.NAc-(this.h3a+this.i3a));return{returnValue:!0,state:w}}Y4f(){const w=
this.mwb();return w?w.PolicyCookie:""}joj(){const w=this.mwb();return w?w.WebAffinitizedUrl:""}O2i(){const w=this.mwb();return w?w.AffinitizedUrl:""}q9i(){const w=new Date;try{const T=this.mwb();w.setTime(T?T.PolicyCookieTTL:0)}catch(T){m.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",T)}return w}Yke(){const w=this.q9i();return!!w&&w.getTime()<Date.now()}mwb(){if(!this.CDc){const w=ta.a.instance.getItem(this.userId);if(!w||""===w)return null;this.CDc=
JSON.parse(w)}return this.CDc}wph(w){if(void 0===w||null===w)throw Error.argumentNull("safeLinksData");if(void 0===w.IsSafeLinksEnabled||null===w.IsSafeLinksEnabled||0>=w.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.CDc=w;w.WasServiceDown||this.QKl(w)}QKl(w){w=JSON.stringify(w);ta.a.instance.setItem(this.userId,w)}tXd(w){return void 0!==je.Yh&&null!==je.Yh?je.Yh.Ci("WebServiceCall",w):null}srd(w){if(void 0!==w&&null!==w){const T=w.Vq;w.stop();return{returnValue:T,
Hy:null}}return{returnValue:null,Hy:w}}static UJe(w){return"false"!==w.toLowerCase()?!0:!1}}je.Yh=null;je.VJd=null;Object(n.a)(je,"SafeLinksManager",null,[541]);const dg=w=>{switch(w){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},nf=w=>{switch(w){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var Cb=d(212);class Cf{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}Zb(w){this.K=w}init(){Q.AFrameworkApplication.fa.gf(Object(v.a)(this,
this.Pm,"onFullAppSettingsReady"))}Pm(){const w=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),T=w?w.vg:!1;w.pptSafeLinksIsEnabled&&(this.K.register(je,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().oa(()=>new je(Q.AFrameworkApplication.fa,Q.AFrameworkApplication.Ke,String.format("{0}-{1}",dg(Q.AFrameworkApplication.Aa.hb.Uk),nf(Q.AFrameworkApplication.Aa.hb.$Ia)),T)).ma(),this.K.ub("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){oa.a.instance.Dc(Cb.a(new Cf,
0))}}Object(n.a)(Cf,"SafeLinksPackage",null,[2,3]);var of=d(346),Lg=d(288),vd=d(1205),Lh=d(87),tf=d(29),Ue=d(173),ff=d(93),Ef=d(1038);class wh{constructor(w,T,ea,ra,wa,Za){this.DG=w;this._id=T;this.Zzd=ra;this.nQh=wa;this.oQh=Za;this.Dxc=this.nub;void 0!==ea&&null!==ea&&(this.nub=ea)}get defaultValue(){return this.Dxc}get lcid(){return this.DG}get id(){return this._id}get nub(){return(this.nQh||wh.zaf)(this.Zzd)}set nub(w){(this.oQh||wh.Aaf)(this.Zzd,w)}get Vf(){return this.Zzd}static qr(){wh.zaf=
()=>null;wh.Aaf=()=>{}}}wh.zaf=null;wh.Aaf=null;Object(n.a)(wh,"GrammarSettingOption",null,[626]);wh.qr();class xh{constructor(w,T,ea){this.M3d=w;this.XTe=T;this.Onk=ea}}Object(n.a)(xh,"TwoLevelCacheKey",null,[]);var qd=d(34),Hf=d(217),Ag=d(2);class He extends Ub.a{constructor(w,T,ea,ra){super();this.pJd=this.I7=this.lcf=this.sRb=null;this.Mo=ra;this.gzd=w;this.hg=He.id;this.nXh=()=>{this.sRb=ea?qa.a.Bqc(ea):{};this.lcf=ea?qa.a.Bqc(ea):{};const wa=this.Bji(),Za=He.MCi(wa,He.$nd(Object(v.a)(this,this.LCi,
"createCritiqueTypeSettingsTracker"))(He.owi(zb=>this.sRb=zb)));Za(ea||{});var ub=He.$nd(He.KHi())(zb=>zb.cloneNode(!0));He.NCi(wa,He.kCi(He.cGi(T),He.KCi(ub))(ea))(w.toString());this.pJd=this.fli();ub=zb=>{if("click"===zb.type||zb.keyCode===Ue.a.tq||zb.keyCode===Ue.a.DPb)this.sRb[w.toString()]={},wa.reset(),He.m1k(Za)};ff.a.addHandler(this.t_a,ic.a.click,ub);ff.a.addHandler(this.t_a,ic.a.Yf,ub)};this.rg=""}get t_a(){return this.pJd}FWj(){var w=He.AQe(this.sRb),T=He.AQe(this.lcf);if(!w&&!T)return!1;
let ea;try{ea=w?Object(y.a)(Object,w[this.gzd.toString()]):{};var ra=T?Object(y.a)(Object,T[this.gzd.toString()]):{}}catch(ub){return m.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!ea&&!ra)return!1;ea=ea?ea:{};ra=ra?ra:{};w=String.format("language: {0}",this.gzd.toString());T=!1;for(let ub in ea){var wa=ub,Za=ea[ub];wa in ra&&ra[wa]===Za||(T=!0,w=String.format("{0}, [{1}, {2}]",w,wa,Za))}for(let ub in ra)ra=ub,ra in ea||(T=!0,w=String.format("{0}, [{1}, default]",w,ra));T&&
m.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",w);return T}Zi(w,T,ea){super.Zi(w,T,ea);this.XQk()}zN(w){return w.Ec.id===He.Kkh?!1:super.zN(w)}W6k(){this.Mo.yl().edd();this.I7=this.Mo.yl().vj.b_}XQk(){this.Mo.yl().scope.zp(Dd.FocusManager.instance().Rqa);this.Mo.yl().scope.zp(Dd.FocusManager.instance().Sqa);this.Mo.yl().scope.bindAction(Dd.FocusManager.instance().Rqa,qd.a.f7b);this.Mo.yl().scope.bindAction(Dd.FocusManager.instance().Sqa,qd.a.e7b);this.Mo.yl().scope.bindAction(qb.KeyInputManager.Oa(Ue.a.dba,
0),qd.a.eVc);this.Mo.yl().scope.bindAction(qb.KeyInputManager.Oa(Ue.a.Mga,0),qd.a.dVc);this.Mo.yl().scope.bindAction(qb.KeyInputManager.Oa(Ue.a.cZ,0),qd.a.eVc);this.Mo.yl().scope.bindAction(qb.KeyInputManager.Oa(Ue.a.K6,0),qd.a.dVc)}get settings(){return He.AQe(this.sRb)}fxa(){super.fxa();this.nXh()}Bji(){const w=He.Xji(),T=He.TZb("WACDialogRow",w);this.PP.insertBefore(T,this.PP.firstChild);return w}LCi(w){const T=Ef.a.merge(null,w);return ea=>{ea.nub===(w&&w[ea.lcid]?w[ea.lcid][ea.id]:null)||ea.nub!==
ea.defaultValue?He.w4f(T,ea.lcid)[ea.id]=ea.nub:delete He.w4f(T,ea.lcid)[ea.id];this.I7=this.Z9i(ea.Vf);return T}}Z9i(w){return w?(w=w.getElementsByTagName(Sys.UI.DomElement.containsCssClass(w,He.BYj)?"select":"input"))?w[0]:null:null}dispose(){this.t_a&&(ff.a.dhh(this.t_a),this.pJd=null);super.dispose()}fli(){const w=document.createElement("input");w.id=He.Kkh;w.type="reset";w.setAttribute("form",He.PXf);w.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";w.value=CommonUIStrings.l_ResetAll;
const T=He.TZb("GrammarSettingsDialogResetButtonContainer",w),ea=document.getElementById("WACDialogButtonPanel");ea.parentNode.insertBefore(T,ea);return w}static get I1b(){return"CritiqueType"}static owi(w){return T=>ea=>w(T(ea))}static $nd(w){return T=>ea=>T(w(ea))}static AQe(w){const T={};qa.a.forEach(w,(ea,ra)=>{0<Hf.a(ra).length&&(T[ea]=ra)},null);return T}static Xji(){const w=document.createElement("form");w.id=He.PXf;Sys.UI.DomElement.addCssClass(w,"WACDialogList");Sys.UI.DomElement.addCssClass(w,
He.fIi);return w}static MCi(w,T){const ea=He.dQk(w,ic.a.change);return ra=>{const wa=T(ra);ea(Za=>{Za=Za.target.parentNode;Sys.UI.DomElement.containsCssClass(Za,He.I1b)&&wa(Za[He.wyf])})}}static dQk(w,T){let ea=null;return ra=>{ea&&ff.a.removeHandler(w,T,ea);ff.a.addHandler(w,T,ra);ea=ra}}static w4f(w,T){return w[T]=w[T]||{}}static m1k(w){m.ULS.sendTraceTag(36489289,375,50,"User click reset all button");w(null)}static cGi(w){let T=null;return ea=>{T=ea;return w.request(Number.parseInvariant(ea)).CWRCo(ra=>
T===ea?ra.result:null,He.zZd)}}static NCi(w,T){const ea=He.D3i(ra=>He.Kvl(ra.children));return ra=>{const wa=ea(ra,w);w.innerHTML="";(wa?Ag.Task.Rt(wa):T(ra)).continueWith(Za=>{Za=Za.result;for(let ub=0;ub<Za.length;ub++)w.appendChild(Za[ub])},He.zZd)}}static kCi(w,T){return ea=>ra=>w(ra).CWRCo(wa=>Ob.toArray(Ob.select(Ob.asEnumerable(wa.result),Za=>T(ea,Za,ra))),He.zZd)}static Kvl(w){const T=[];for(let ea=0;ea<w.length;ea++)T.push(w[ea]);return T}static D3i(w){const T={};let ea=null;return(ra,wa)=>
{ea&&!T[ea]&&(wa=w(wa))&&(T[ea]=wa);ea=ra;return T[ra]}}static KHi(){const w={};return T=>{w[T.M3d]=w[T.M3d]||{};const ea=w[T.M3d];ea[T.XTe]=ea[T.XTe]||T.Onk();return ea[T.XTe]}}static KCi(w){return(T,ea,ra)=>{const wa=w(new xh(ra,ea.Id,()=>He.Jji(ea)));wa.setAttribute("role","group");const Za=He.JDf+ea.Name;wa.setAttribute("aria-labelledby",Za);for(const ub of ea.CritiqueTypeInfoList){const zb=He.k1i(ra,ub,T,w);wa.appendChild(zb);zb.setAttribute("aria-labelledby",Za)}return wa}}static k1i(w,T,ea,
ra){ra=ra(new xh(w,T.Id,()=>T.IsBinaryCritiqueType?He.Hji(T):He.Pki(T)));w=new wh(w,T.Id,ea&&ea[w]?ea[w][T.Id]:null,ra,T.IsBinaryCritiqueType?wa=>wa.children[0].checked:wa=>wa.children[1].selectedIndex,T.IsBinaryCritiqueType?(wa,Za)=>{wa.children[0].checked=Za}:(wa,Za)=>{wa.children[1].selectedIndex=Za});ra[He.wyf]=w;return ra}static Jji(w){w=He.Kji(w.Name);w.className="WACWritingStylesDialogCategoryTitle";return He.TZb("CritiqueCategory",w)}static Hji(w){const T=He.Lji();T.id=w.Id;0<w.DefaultCritiqueValue&&
T.setAttribute("checked","checked");w=He.sAf(w.Name,w.Id);w.className="WACDialogLabel";const ea=He.TZb(He.I1b,T,w);ea.appendChild(T);ea.appendChild(w);return ea}static Pki(w){w=He.zki(w.Id,w.Name,He.Uki(w.CritiqueTypeValues,w.DefaultCritiqueValue),w.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(w,He.I1b);return w}static Uki(w,T){return Ob.toArray(Ob.Si(Ob.asEnumerable(w||[]),(ea,ra)=>{ea=He.Tki(ea,ra.toString());ra===T&&ea.setAttribute("selected","selected");return ea}))}static zki(w,T,ea,ra){T=
He.sAf(T,w);const wa=document.createElement("select");wa.id=w;wa.className="WACDialogList";ea=ea||[];for(w=0;w<ea.length;w++)wa.appendChild(ea[w]),ra===w&&(ea[w].selected=!0);return He.TZb("GrammarSettingsDialogLabeledInlineList",T,wa)}static Tki(w,T){const ea=document.createElement("option");ea.text=w;ea.value=T;return ea}static Lji(){const w=document.createElement("input");w.type="checkbox";w.className="WACDialogCheckBox";return w}static sAf(w,T){const ea=document.createElement("label");ea.innerText=
w;ea.setAttribute("for",T);return ea}static Kji(w){const T=document.createElement("div");T.innerText=w;T.id=He.JDf+w;return T}static TZb(w=null,...T){const ea=document.createElement("div");ea.className=w;for(const ra of T)ea.appendChild(ra);return ea}}He.id="GrammarSettingsDialog";He.PXf="CritiqueTypeSettings";He.fIi="CritiquesList";He.BYj="GrammarSettingsDialogLabeledInlineList";He.Kkh="ResetButton";He.JDf="WritingStylesCategory_";He.zZd=11;He.wyf="CritiqueType";Object(n.a)(He,"GrammarSettingsDialog",
Ub.a,[]);var af=d(141),yd=d(315),me=d(1127),Ic=d(41),Fe=d(350),Uc=d(60),Uf=d(155),vg=d(48),Yg=d(890),Cc=d(28),Rc=d(30);class Ve{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(n.a)(Ve,"EffectDataInfo",null,[]);var ob=d(853);class Mb{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(n.a)(Mb,"AddAnimationInfo",null,[]);class nc{constructor(){this.TargetEffects=null}}Object(n.a)(nc,"DeleteAnimationInfo",
null,[]);class Qc{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(n.a)(Qc,"TargetEffect",null,[]);class id{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(n.a)(id,"ReplaceAnimationInfo",null,[]);class ld{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(n.a)(ld,"ModifyAnimationInfo",null,[]);class xd{constructor(){this.StartType=0;this.TargetEffects=
null}}Object(n.a)(xd,"ChangeAnimationRelationshipInfo",null,[]);var ue=d(352),Rd=d(149),ce=d(90);class Ne{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(n.a)(Ne,"ChangeAnimationBuildTypeInfo",null,[]);class oe{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(n.a)(oe,"ReorderAnimationEffectsInfo",null,[]);var Yd;(function(w){w[w.OnClick=0]="OnClick";w[w.WithPrevious=1]="WithPrevious";w[w.AfterPrevious=2]="AfterPrevious";w[w.Invalid=3]="Invalid"})(Yd||(Yd=
{}));Object(n.b)("AnimationStartType",Yd);var Id;(function(w){w[w.Default=0]="Default";w[w.AsOneObject=1]="AsOneObject";w[w.AllAtOnce=2]="AllAtOnce";w[w.ByParagraph=3]="ByParagraph";w[w.OnyByOne=4]="OnyByOne"})(Id||(Id={}));Object(n.b)("AnimationBuildType",Id);var zf;(function(w){w[w.AddAnimation=0]="AddAnimation";w[w.DeleteAnimation=1]="DeleteAnimation";w[w.ReplaceAnimation=2]="ReplaceAnimation";w[w.ModifyAnimation=3]="ModifyAnimation";w[w.ChangeAnimationRelationshipInfo=4]="ChangeAnimationRelationshipInfo";
w[w.ChangeBuildType=5]="ChangeBuildType";w[w.ReorderAnimation=6]="ReorderAnimation"})(zf||(zf={}));Object(n.b)("AnimationActionType",zf);var od;(function(w){w[w.Degree=0]="Degree";w[w.Color=1]="Color";w[w.Transparency=2]="Transparency";w[w.Scale=3]="Scale"})(od||(od={}));Object(n.b)("EffectDataPropType",od);var gf;(function(w){w[w.Delay=0]="Delay";w[w.Duration=1]="Duration";w[w.Direction=2]="Direction";w[w.EffectData=3]="EffectData"})(gf||(gf={}));Object(n.b)("ModifyAnimationPropertyType",gf);var Lf=
d(35);class ke{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc){this.n6="Existing";this.sLa="ExistingInMenu";this.OZe="AnimationExisting";this.PZe="AnimationExistingInMenu";this.QWa=!1;this.uhb=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;yc=this.pa.tk();if(!yc||!bc||!bc.length)return 8;if(1===$c)return 32;$c=this.jka(bc,yc);md.MenuItems=this.Dji(bc,yc,$c);return 32};this.Sna=(bc,yc,$c,gd,md)=>{bc=md.queryResult;md=md.SourceControlId;gd=yc=-1;md!==this.n6&&({effectType:gd,effectId:yc}=this.Gk.oSc(md));var Sc=this.yx.qy;
if(!this.pa.tk())return 8;if(1!==$c)return 32;$c=this.Gk.pSc(md);var Zd=$c.label;if(md===this.n6||md===this.sLa)Zd=ResourceStrings.L_ExistingButtonDescription;this.h9a(md,$c.image,$c.label,bc,Zd);let Pe=Zd=!1;const qe=0==Sc.length?0:Sc[0].EffectId,cg=0==Sc.length?0:Sc[0].EffectType,mg=!this.Gk.lzb(Sc);Sc=this.Gk.B9b(Sc);mg||Sc||(Zd=yc===qe&&gd===cg,Pe=this.Gk.aZc(cg,qe));md===this.n6?(Pe=this.NLk(this.n6,bc,Sc,Pe,mg,$c.image,cg,qe),bc.VU(mg||Sc||Pe)):md===this.sLa?(Pe=ke.LLk(bc,Sc,mg,Pe),bc.VU(mg||
Sc||Pe)):bc.VU(Zd);return 32};this.Bz=(bc,yc,$c,gd,md)=>{yc=this.yx.qy;var Sc=this.pa.tk();let Zd=!0;gd=this.getSelectedShapes();if(!gd||!gd.length)if(Zd=!1,gd=this.jka(yc,Sc),!gd||!gd.length)return Cc.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;if(!ke.amg(Sc,gd)||this.Cua(gd))return 8;if(1===$c)return Sc=0<yc.length&&!this.Gk.lzb(yc),$c=ke.PTj(gd),Sc&&$c?8:bc===Rc.a.BLb||bc===Rc.a.Z_a?(gd=0<yc.length&&this.Gk.B9b(yc),$c=!1,Sc||gd||($c=this.Gk.aZc(0<yc.length?
yc[0].EffectType:-1,0<yc.length?yc[0].EffectId:-1)),bc===Rc.a.Z_a&&($c=Sc?!0:!1),Sc||gd||$c?32:16):bc===Rc.a.ALb?ke.QTj(gd)?32:16:32;bc=md.SourceControlId;if(!bc)return 8;if(bc===this.n6||bc===this.sLa||bc===this.OZe||bc===this.PZe)return 32;bc=this.Gk.oSc(bc);(bc=ke.k3i(gd,bc.effectId,bc.effectType,Zd,yc))&&this.i_(Sc,bc);return 32};this.xZg=(bc,yc,$c)=>{const gd=this.yx.qy;yc=this.pa.tk();if(!yc||!gd||!gd.length)return 8;var md=this.jka(gd,yc);if(!md||!md.length)return Cc.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),
8;if(this.Cua(md))return 8;switch(bc){case Rc.a.yEe:bc=!1;break;case Rc.a.zEe:bc=!0;break;default:return 8}md=this.Gk.hdj(yc,gd,bc);if(1===$c)return md.isEnabled?32:8;if(!md.Gkd)return Cc.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;$c=ke.P8(gd);$c=ke.NKf($c,md.Gkd,bc);this.i_(yc,$c);return 32};this.vya=(bc,yc,$c,gd,md)=>{yc=this.yx.qy;bc=this.pa.tk();if(!bc||!yc||!yc.length)return 8;gd=this.jka(yc,bc);if(!gd||!gd.length)return Cc.a.J(509677842,
800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.Cua(gd))return 8;if(1===$c)return 32;$c=Rd.Box4ColorHelper.oV(md);if(!$c)return Cc.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;$c=Rd.Box4ColorHelper.Tib($c,bc.ke);if(!$c)return Cc.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;md=new ob.a;md.AnimationAction=1;gd=new ld;gd.TargetEffects=ke.P8(yc);gd.ModifyAnimPropType=3;yc=new Ve;yc.Color=[$c.r,$c.g,$c.b];
yc.EffectDataPropType=1;gd.EffectData=yc;md.ModifyAnimationInfo=gd;this.i_(bc,md);return 32};this.pNe=()=>{const bc=this.yx.qy;var yc=this.pa.tk();if(!yc||!bc||!bc.length)return 8;yc=this.jka(bc,yc);return yc&&yc.length?this.Gk.Roi(yc,this.Fa,bc)?32:16:(Cc.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.X_a=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;yc=this.pa.tk();if(!yc||!bc||!bc.length)return 8;gd=this.jka(bc,yc);if(!gd||!gd.length)return Cc.a.J(509677838,
800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.Cua(gd))return 8;if(1===$c)return 32;$c=this.Gk.t5b(md.MenuItemId);md=new ob.a;md.AnimationAction=1;gd=new ld;gd.TargetEffects=ke.P8(bc);gd.ModifyAnimPropType=2;gd.Direction=$c;md.ModifyAnimationInfo=gd;this.i_(yc,md);return 32};this.MZa=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;if(!this.pa.tk()||!bc||!bc.length)return 8;yc=md.queryResult;md=this.Gk.t5b(md.MenuItemId);ke.RIj(bc)&&yc.Mf(bc[0].Direction===md);return 32};
this.PKa=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;yc=this.pa.tk();if(!yc||!bc||!bc.length)return 8;gd=this.jka(bc,yc);if(!gd||!gd.length)return Cc.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.Cua(gd))return 8;if(1===$c)return 32;$c=md.MenuItemId;md=new ob.a;md.AnimationAction=5;gd=new Ne;gd.TargetEffects=ke.P8(bc);gd.BuildType=ke.i4i($c);md.ChangeAnimationBuildTypeInfo=gd;this.i_(yc,md);return 32};this.Tna=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;if(!this.pa.tk()||
!bc||!bc.length)return 8;yc=md.queryResult;md=this.Gk.P9d(md.MenuItemId);ke.PIj(bc)&&yc.Mf(bc[0].BuildType===md);return 32};this.Y_a=(bc,yc,$c,gd,md)=>{yc=this.yx.qy;bc=this.pa.tk();if(!bc||!yc||!yc.length)return 8;gd=this.jka(yc,bc);if(!gd||!gd.length)return Cc.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.Cua(gd))return 8;if(1===$c)return 32;gd=md.MenuItemId;$c=new ob.a;$c.AnimationAction=1;md=new ld;md.TargetEffects=ke.P8(yc);md.ModifyAnimPropType=
3;yc=this.J8i(gd);if(!yc)return Cc.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;md.EffectData=yc;$c.ModifyAnimationInfo=md;this.i_(bc,$c);return 32};this.NZa=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;if(!this.pa.tk()||!bc||!bc.length)return 8;md.queryResult.Mf(this.Gk.kHf(ke.K8i(bc[0].EffectData),md.MenuItemId));return 32};this.q9k=(bc,yc,$c,gd,md)=>{yc=this.yx.qy;bc=this.pa.tk();if(!bc||!yc||!yc.length)return 8;gd=this.jka(yc,bc);if(!gd||!gd.length)return Cc.a.J(509677836,
800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.Cua(gd))return 8;if(1===$c)return 32;$c=md.CommandValueId;if(!$c||!$c.trim().length)return Cc.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;$c=ke.ukj($c);if(3==$c)return Cc.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;md=ke.P8(yc);$c=ke.wJf(md,$c);this.i_(bc,$c);return 32};this.ZIb=(bc,yc,$c,gd,md)=>
{bc=this.yx.qy;if(!this.pa.tk()||!bc||!bc.length)return this.UUe(md,""),32;yc=bc[0].StartType;$c=!0;for(const Sc of bc)if(yc!=Sc.StartType){$c=!1;break}$c?this.UUe(md,Yd[yc].toString()):this.UUe(md,"");return 32};this.p9k=(bc,yc,$c,gd,md)=>{bc=this.pa.tk();yc=this.yx.qy;if(!bc||!yc||!yc.length)return 8;gd=this.jka(yc,bc);if(!gd||!gd.length)return Cc.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.Cua(gd))return 8;const Sc=!this.Gk.lzb(yc);
if(ke.$lg(gd)&&Sc)return 8;if(1===$c)return 32;($c=Math.floor(1E3*md.Number))||($c=10);md=ke.P8(yc);$c=ke.xLc(md,1,$c);this.i_(bc,$c);return 32};this.VJa=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;if(!this.pa.tk()||!bc||!bc.length)return this.CLb(md,"0.00"),32;yc=bc[0].Duration;$c=!0;for(const Sc of bc)if(yc!=Sc.Duration){$c=!1;break}$c?this.CLb(md,Number(yc/1E3).toFixed(2)):this.CLb(md,"0.01");return 32};this.jwj=(bc,yc,$c)=>1==$c?32:Uf.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.QWa.toString(),
bc,()=>{(this.QWa=!this.QWa)?this.iYe(!1):this.Rbg();return 32});this.Lmc=(bc,yc,$c,gd,md)=>{md&&md.Mf(this.QWa);return 32};this.iYe=bc=>{const yc=this.vC();var $c=Object(v.a)(this,this.iqj,"applyAnimationAction");yc.lNl=$c;$c=Object(v.a)(this,this.kqj,"handleAnimationSelectionChangeFromPane");yc.iY=$c;$c=this.getSelectedShapes();yc.YMl=!$c||!$c.length;if($c=this.pa.tk()){yc.cNl=!$c.EEa;var gd=$c.Ek();yc.dW=$c.kRc(gd);yc.ZNl=this.yx.qy.map(Sc=>Sc.EffectNodeId);var md={title:ResourceStrings.L_AnimationGalleryGroup,
hideHeader:!1,width:yc.sBk,location:2,contentProps:yc,onOpen:()=>{},onClose:()=>{this.QWa=!1},isModernPane:!0};af.UISurfaces.zr().then(Sc=>{bc?this.QWa&&Sc.updateTaskPane(vg.a.PPa,md):Sc.showTaskPane(vg.a.PPa,md);return null}).catch(Sc=>{Cc.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",Sc.toString())})}else Cc.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.Cxk=()=>{this.QWa&&this.iYe(!0)};this.iqj=bc=>{switch(bc.actionType){case 0:this.Wpj();
break;case 2:this.Avj(bc);break;case 1:this.yrj(bc);break;case 3:this.otj(bc);break;case 4:this.Uqj(bc);break;case 5:break;case 6:this.zvj(bc);break;default:Cc.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};this.kqj=bc=>{const yc=this.pa.tk();yc&&bc&&bc.length?this.yx.OOd(bc,yc):Cc.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.Wpj=()=>{var bc=this.getSelectedShapes();
const yc=this.pa.tk();yc&&bc&&bc.length?(bc=ke.kZf(bc,10,0,!1))&&this.i_(yc,bc):Cc.a.J(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};this.Avj=bc=>{if(bc&&bc.Djh){var yc=bc.Djh.effectId,$c=bc.Djh.effectType,gd=this.yx.qy;(bc=this.pa.tk())&&gd&&gd.length?(yc=ke.E5f(gd,yc,$c))&&this.i_(bc,yc):Cc.a.J(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else Cc.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};
this.yrj=bc=>{if(bc&&bc.zKi){var yc=this.pa.tk();bc=bc.zKi.eMl;yc&&bc&&bc.length?(bc=ke.Llj(bc),bc=ke.HJf(bc),this.i_(yc,bc)):Cc.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else Cc.a.J(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.vC=()=>({type:"AnimationPaneProps",sBk:Yg.a,aNl:!0});this.qui=()=>{this.Rbg();return 32};this.kCl=()=>{this.iYe(!0);return 32};this.Rbg=()=>{af.UISurfaces.zr().then(bc=>
{bc.hideTaskPane(vg.a.PPa,2);return null}).catch(bc=>{Cc.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",bc.toString())})};this.o9k=(bc,yc,$c,gd,md)=>{yc=this.yx.qy;bc=this.pa.tk();if(!bc||!yc||!yc.length)return 8;gd=this.jka(yc,bc);if(!gd||!gd.length)return Cc.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.Cua(gd))return 8;const Sc=!this.Gk.lzb(yc);if(ke.$lg(gd)&&Sc)return 8;if(1===$c)return 32;$c=Math.floor(1E3*md.Number);
md=ke.P8(yc);$c=ke.xLc(md,0,$c);this.i_(bc,$c);return 32};this.UJa=(bc,yc,$c,gd,md)=>{bc=this.yx.qy;if(!this.pa.tk()||!bc||!bc.length)return this.CLb(md,"0.00"),32;yc=bc[0].Delay;$c=!0;for(const Sc of bc)if(yc!=Sc.Delay){$c=!1;break}$c?this.CLb(md,Number(yc/1E3).toFixed(2)):this.CLb(md,"0.00");return 32};this.Dji=(bc,yc,$c)=>{var gd;const md=new yd.a;md.Id="AnimationMenuEffectOptions";md.UpdateDynamically=!0;md.Title=ResourceStrings.L_EffectOptions;md.MenuSectionList=[];if(!this.Gk.B9b(bc)){const Sc=
bc[0];md.MenuSectionList.push(this.Gk.QTc(Sc.EffectId,Sc.EffectType,"Direction","2289594085","3782857737"));if(this.Gk.xme(Sc))if(md.MenuSectionList.push(Fe.f(yc.ke,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),md.MenuSectionList.push(Fe.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.QIj(bc)){const Zd=null===(gd=Sc.EffectData)||void 0===gd?void 0:gd.Color;gd=new ce.a(ce.a.Glh(Zd));
Fe.h(md,gd,yc.ke)}else Fe.h(md,null,yc.ke);md.MenuSectionList.push(this.Gk.QTc(Sc.EffectId,Sc.EffectType,"EffectData","2949363495","4132852551"))}md.MenuSectionList.push(this.Gk.xgj($c,this.Fa,bc));return md};this.J8i=bc=>{let yc=new Ve;const $c=this.Gk.E6d(bc);return bc.toLowerCase().startsWith("spin")?(yc.Degree=parseFloat($c),yc.EffectDataPropType=0,yc):bc.toLowerCase().startsWith("transparency")?(yc.Transparency=parseFloat($c),yc.EffectDataPropType=2,yc):bc.toLowerCase().startsWith("growshrink")?
(yc.Scale=parseFloat($c),yc.EffectDataPropType=3,yc):null};this.NLk=(bc,yc,$c,gd,md,Sc,Zd,Pe)=>{if(md)return!1;if($c)return this.h9a(bc,Sc,ResourceStrings.L_AnimationMultiple,yc,ResourceStrings.L_AnimationMultiple),gd;gd&&(Sc=this.Gk.oUc(Zd,Pe),{image:Sc,label:$c}=this.Gk.pSc(Sc),this.h9a(bc,Sc,$c,yc,$c));return gd};this.h9a=(bc,yc,$c,gd,md)=>{let Sc;Sc=bc===this.n6?"298832323":bc===this.sLa?"1264919631":"2676673376";yc=yc.substring((Uc.a.ylc+"_").length,yc.length-6);const Zd=new me.a;Zd.Id=bc;Zd.ExternalId=
"Animation"+bc;Zd.Icon=yc;Zd.Command=Sc;Zd.QueryCommand="1852964326";Zd.LabelText=$c;Zd.FullIconStyle={root:{width:"32px",height:"32px"}};Zd.PreviewIconStyle={root:{width:"24px",height:"24px"}};Zd.Alt=md;gd.w3=Zd};this.getSelectedShapes=()=>{let bc=[];const yc=this.pa.Wd();if(!yc)return bc;for(const $c of yc)$c.get_smartArtModelId()?bc.push(this.Fa.yr($c)):$c.Ng?bc.push(this.Fa.ys($c)):bc.push($c);return bc};this.jka=(bc,yc)=>{const $c=[];if(!bc||!bc.length||!yc)return $c;const gd=yc.Ek();if(!gd||
!gd.length)return $c;yc=new Map;for(const md of gd)yc.set(md.id.toString(),md);for(const md of bc){bc=ue.a.Hf(md.ShapeId);bc=yc.get(bc.toString());if(!bc)return[];$c.push(bc)}return $c};this.i_=(bc,yc)=>{const $c=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{$c.nc(bc),bc.Ara=yc}finally{$c&&$c.dispose()}};this.Cua=bc=>{if(!bc||0==bc.length)return!1;for(const yc of bc)if(this.fc.$c(yc))return!0;return!1};this.UUe=(bc,yc)=>{bc.YZ=yc;bc.Qpc()};this.CLb=(bc,yc)=>{bc.queryResult.Kaa=yc};if(!w)throw Error.argumentNull("actionManager");
if(!T)throw Error.argumentNull("selectionManager");if(!ea)throw Error.argumentNull("focusManager");if(!ra)throw Error.argumentNull("transactionFactory");if(!wa)throw Error.argumentNull("animationHelper");if(!Za)throw Error.argumentNull("graphActionBlockingManager");if(!ub)throw Error.argumentNull("shapeReader");if(!zb)throw Error.argumentNull("pathManager");if(!tc)throw Error.argumentNull("effectSelectionManager");this.ia=w;this.pa=T;this.Ea=ea;this.Jb=ra;this.ggc=zb.qk(Uc.a.yhd);this.Gk=wa;this.fc=
Za;this.Fa=ub;this.yx=tc;this.la=pc}wb(){this.ia.ra(Rc.a.fHc,Ic.a.application,this.q9k,4);this.ia.ra(Rc.a.ZIb,Ic.a.application,this.ZIb,97);this.ia.ra(Rc.a.kod,Ic.a.application,this.p9k,4);this.ia.ra(Rc.a.VJa,Ic.a.application,this.VJa,97);this.ia.ra(Rc.a.yvh,Ic.a.application,this.jwj,4);this.ia.ra(Rc.a.Lmc,Ic.a.application,this.Lmc,96);this.ia.ra(Rc.a.jod,Ic.a.application,this.o9k,4);this.ia.ra(Rc.a.UJa,Ic.a.application,this.UJa,97);this.ia.ra(Rc.a.Sna,Ic.a.application,this.Sna,97);this.ia.ra(Rc.a.Bz,
Ic.a.application,this.Bz,5);this.ia.ra(Rc.a.ALb,Ic.a.application,this.Bz,5);this.ia.ra(Rc.a.BLb,Ic.a.application,this.Bz,5);this.ia.ra(Rc.a.Z_a,Ic.a.application,this.Bz,5);this.ia.ra(Rc.a.qNe,Ic.a.application,this.pNe,100);this.ia.ra(Rc.a.X_a,Ic.a.application,this.X_a,5);this.ia.ra(Rc.a.MZa,Ic.a.application,this.MZa,97);this.ia.ra(Rc.a.Y_a,Ic.a.application,this.Y_a,4);this.ia.ra(Rc.a.NZa,Ic.a.application,this.NZa,96);this.ia.ra(Rc.a.lod,Ic.a.application,this.PKa,5);this.ia.ra(Rc.a.mod,Ic.a.application,
this.PKa,5);this.ia.ra(Rc.a.nod,Ic.a.application,this.PKa,5);this.ia.ra(Rc.a.ood,Ic.a.application,this.PKa,5);this.ia.ra(Rc.a.Tna,Ic.a.application,this.Tna,97);this.ia.ra(Rc.a.uhb,Ic.a.application,this.uhb,96);this.ia.ra(Rc.a.vya,Ic.a.application,this.vya,4);this.ia.ra(Rc.a.yEe,Ic.a.application,this.xZg,4);this.ia.ra(Rc.a.zEe,Ic.a.application,this.xZg,4);this.ia.ra(Rc.a.Olb,Ic.a.application,this.kCl,4);this.ia.ra(Rc.a.XFf,Ic.a.application,this.qui,4);this.la.cB&&Lf.a("AnimationGalleryActionAIEnabled")&&
this.ia.ra(Rc.a.sQd,Ic.a.application,Object(v.a)(this,this.Vae,"handleAnimationGalleryActionAI"),4);this.pa.wF(this.Cxk)}Ee(){}Vae(w,T){if(T.contextId!==Ic.a.application)return 2;w=this.getSelectedShapes();return!ke.amg(this.pa.tk(),w)||this.Cua(w)?8:32}Uqj(w){if(w&&w.mqi){var T=this.yx.qy,ea=this.pa.tk();ea&&T&&T.length?(w=w.mqi,T=ke.P8(T),T=ke.wJf(T,w.qOl),this.i_(ea,T)):Cc.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else Cc.a.J(509444174,
800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}otj(w){if(w&&w.ymk){var T=this.yx.qy,ea=this.pa.tk();ea&&T&&T.length?(T=ke.P8(T),(w=ke.H5i(w.ymk,T))?this.i_(ea,w):Cc.a.J(509444170,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")):Cc.a.J(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else Cc.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}zvj(w){var T=
w.loa;if(w&&T){var ea=this.yx.qy,ra=w.loa.ENl;if((w=this.pa.tk())&&ea&&ea.length&&ra){var wa=new Qc;wa.EffectNodeId=ra.hQi;wa.ShapeId=ra.shapeId;ea=ke.P8(ea);T=ke.NKf(ea,wa,T.$Ml);this.i_(w,T)}else Cc.a.J(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else Cc.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static H5i(w,T){switch(w.hNl){case 0:return ke.xLc(T,0,w.delay);case 1:return ke.xLc(T,
1,w.duration);default:return null}}QIj(w){var T;if(!(w&&w.length&&!this.Gk.B9b(w)&&this.Gk.xme(w[0])&&w[0].EffectData&&w[0].EffectData.Color))return!1;const ea=null===(T=w[0].EffectData)||void 0===T?void 0:T.Color;for(const ra of w){if(!ra.EffectData||!ra.EffectData.Color)return!1;w=ra.EffectData.Color;if(w[0]!=ea[0]||w[1]!=ea[1]||w[2]!=ea[2])return!1}return!0}static wJf(w,T){const ea=new ob.a;ea.AnimationAction=4;const ra=new xd;ra.TargetEffects=w;ra.StartType=T;ea.ChangeAnimationRelationshipInfo=
ra;return ea}static xLc(w,T,ea){const ra=new ob.a;ra.AnimationAction=1;const wa=new ld;wa.TargetEffects=w;wa.ModifyAnimPropType=T;1===T?wa.Duration=ea:wa.Delay=ea;ra.ModifyAnimationInfo=wa;return ra}static NKf(w,T,ea){const ra=new ob.a;ra.AnimationAction=6;const wa=new oe;wa.TargetEffects=w;wa.IsLater=ea;wa.RefEffect=T;ra.ReorderAnimationEffectsInfo=wa;return ra}}ke.Llj=w=>{const T=[];if(!w||!w.length)return T;for(const ea of w)w=new Qc,w.EffectNodeId=ea.hQi,w.ShapeId=ea.shapeId,T.push(w);return T};
ke.i4i=w=>{switch(w){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};ke.k3i=(w,T,ea,ra,wa)=>0==T&&0==ea?ke.Q7i(wa):ra?ke.kZf(w,T,ea,!0):ke.E5f(wa,T,ea);ke.E5f=(w,T,ea)=>{let ra=new ob.a;ra.AnimationAction=2;let wa=new id;if(!w||!w.length)return Cc.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;wa.TargetEffects=ke.P8(w);wa.EffectId=T;wa.EffectType=ea;ra.ReplaceAnimationInfo=
wa;return ra};ke.Q7i=w=>w&&w.length?ke.HJf(ke.P8(w)):(Cc.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null);ke.kZf=(w,T,ea,ra)=>{let wa=new ob.a;wa.AnimationAction=0;let Za=new Mb;Za.EffectId=T;Za.EffectType=ea;Za.ShapeIds=[];Za.FRemoveExisting=ra;for(const ub of w)Za.ShapeIds.push(ub.id.toString());wa.AddAnimationInfo=Za;return wa};ke.HJf=w=>{const T=new ob.a;T.AnimationAction=3;const ea=new nc;ea.TargetEffects=w;T.DeleteAnimationInfo=ea;
return T};ke.ukj=w=>{switch(w.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};ke.P8=w=>{if(!w||!w.length)return null;const T=[];for(const ea of w)w=new Qc,w.EffectNodeId=ea.EffectNodeId,w.ShapeId=ea.ShapeId,T.push(w);return T};ke.PTj=w=>{if(!w||0==w.length)return!1;for(const T of w)if(T.U3)return!0;return!1};ke.$lg=w=>{if(!w||0==w.length)return!1;for(const T of w)if(1===T.mediaType||2===T.mediaType)return!0;return!1};ke.amg=(w,T)=>
{if(!w||!T||!T.length)return!1;for(const ea of T)if(ea.tT||ea.Dq||ea.Mp)return!1;return!0};ke.QTj=w=>{if(!w||!w.length)return!1;for(const T of w)if(T.ud||T.hr||T.Mp)return!1;return!0};ke.RIj=w=>{if(!w||!w.length)return!1;const T=w[0].Direction;for(let ea=1;ea<w.length;ea++)if(w[ea].Direction!=T)return!1;return!0};ke.PIj=w=>{if(!w||!w.length)return!1;const T=w[0].BuildType;for(let ea=1;ea<w.length;ea++)if(w[ea].BuildType!=T)return!1;return!0};ke.K8i=w=>{if(!w)return"";switch(w.EffectDataPropType){case 0:return w.Degree.toString();
case 3:return w.Scale.toString();case 2:return w.Transparency.toString()}return""};ke.LLk=(w,T,ea,ra)=>{ea?(w.f9a=ResourceStrings.L_AnimationExisting,ra&&(ra=!1)):T&&(w.f9a=ResourceStrings.L_AnimationMultiple);return ra};Object(n.a)(ke,"AnimationActor",null,[352]);class vf{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=
!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(n.a)(vf,"EditAnimationInfo",null,[]);var ng;(function(w){w[w.invalid=0]="invalid";w[w.basicBlockList=1]="basicBlockList";w[w.alternatingHexagons=2]="alternatingHexagons";w[w.pictureCaptionList=3]="pictureCaptionList";w[w.linedList=4]="linedList";w[w.verticalBulletList=5]="verticalBulletList";w[w.verticalBoxList=6]="verticalBoxList";w[w.verticalBracketList=7]="verticalBracketList";
w[w.varyingWidthList=8]="varyingWidthList";w[w.tabList=9]="tabList";w[w.horizontalBulletList=10]="horizontalBulletList";w[w.squareAccentList=11]="squareAccentList";w[w.pictureAccentList=12]="pictureAccentList";w[w.bendingPictureAccentList=13]="bendingPictureAccentList";w[w.stackedList=14]="stackedList";w[w.increasingCircleProcess=15]="increasingCircleProcess";w[w.pieProcess=16]="pieProcess";w[w.detailedProcess=17]="detailedProcess";w[w.groupedList=18]="groupedList";w[w.horizontalPictureList=19]="horizontalPictureList";
w[w.continuousPictureList=20]="continuousPictureList";w[w.pictureStrips=21]="pictureStrips";w[w.verticalPictureList=22]="verticalPictureList";w[w.alternatingPictureBlocks=23]="alternatingPictureBlocks";w[w.verticalPictureAccentList=24]="verticalPictureAccentList";w[w.titledPictureAccentList=25]="titledPictureAccentList";w[w.verticalBlockList=26]="verticalBlockList";w[w.verticalChevronList=27]="verticalChevronList";w[w.verticalAccentList=28]="verticalAccentList";w[w.verticalArrowList=29]="verticalArrowList";
w[w.trapezoidList=30]="trapezoidList";w[w.descendingBlockList=31]="descendingBlockList";w[w.tableList=32]="tableList";w[w.segmentedProcess=33]="segmentedProcess";w[w.verticalCurvedList=34]="verticalCurvedList";w[w.pyramidList=35]="pyramidList";w[w.targetList=36]="targetList";w[w.hierarchyList=37]="hierarchyList";w[w.verticalCircleList=38]="verticalCircleList";w[w.tableHierarchy=39]="tableHierarchy";w[w.architectureLayout=40]="architectureLayout";w[w.basicProcess=41]="basicProcess";w[w.stepUpProcess=
42]="stepUpProcess";w[w.stepDownProcess=43]="stepDownProcess";w[w.accentProcess=44]="accentProcess";w[w.pictureAccentProcess=45]="pictureAccentProcess";w[w.alternatingFlow=46]="alternatingFlow";w[w.continuousBlockProcess=47]="continuousBlockProcess";w[w.increasingArrowsProcess=48]="increasingArrowsProcess";w[w.interconnectedBlockProcess=49]="interconnectedBlockProcess";w[w.continuousArrowProcess=50]="continuousArrowProcess";w[w.convergingText=51]="convergingText";w[w.processArrows=52]="processArrows";
w[w.circleAccentTimeline=53]="circleAccentTimeline";w[w.basicTimeline=54]="basicTimeline";w[w.circleProcess=55]="circleProcess";w[w.basicChevronProcess=56]="basicChevronProcess";w[w.chevronAccentProcess=57]="chevronAccentProcess";w[w.closedChevronProcess=58]="closedChevronProcess";w[w.chevronList=59]="chevronList";w[w.subStepProcess=60]="subStepProcess";w[w.phasedProcess=61]="phasedProcess";w[w.randomtoResultProcess=62]="randomtoResultProcess";w[w.verticalProcess=63]="verticalProcess";w[w.staggeredProcess=
64]="staggeredProcess";w[w.processList=65]="processList";w[w.circleArrowProcess=66]="circleArrowProcess";w[w.basicBendingProcess=67]="basicBendingProcess";w[w.repeatingBendingProcess=68]="repeatingBendingProcess";w[w.verticalBendingProcess=69]="verticalBendingProcess";w[w.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";w[w.upwardArrow=71]="upwardArrow";w[w.descendingProcess=72]="descendingProcess";w[w.circularBendingProcess=73]="circularBendingProcess";w[w.equation=74]="equation";
w[w.verticalEquation=75]="verticalEquation";w[w.funnel=76]="funnel";w[w.gear=77]="gear";w[w.arrowRibbon=78]="arrowRibbon";w[w.opposingArrows=79]="opposingArrows";w[w.convergingArrows=80]="convergingArrows";w[w.divergingArrows=81]="divergingArrows";w[w.basicCycle=82]="basicCycle";w[w.textCycle=83]="textCycle";w[w.blockCycle=84]="blockCycle";w[w.nondirectionalCycle=85]="nondirectionalCycle";w[w.continuousCycle=86]="continuousCycle";w[w.multidirectionalCycle=87]="multidirectionalCycle";w[w.segmentedCycle=
88]="segmentedCycle";w[w.basicPie=89]="basicPie";w[w.hexagonRadial=90]="hexagonRadial";w[w.radialCycle=91]="radialCycle";w[w.basicRadial=92]="basicRadial";w[w.divergingRadial=93]="divergingRadial";w[w.radialVenn=94]="radialVenn";w[w.cycleMatrix=95]="cycleMatrix";w[w.radialCluster=96]="radialCluster";w[w.organizationChart=97]="organizationChart";w[w.pictureOrganizationChart=98]="pictureOrganizationChart";w[w.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";w[w.halfCircleOrganizationChart=
100]="halfCircleOrganizationChart";w[w.circlePictureHierarchy=101]="circlePictureHierarchy";w[w.hierarchy=102]="hierarchy";w[w.labeledHierarchy=103]="labeledHierarchy";w[w.horizontalOrganizationChart=104]="horizontalOrganizationChart";w[w.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";w[w.horizontalHierarchy=106]="horizontalHierarchy";w[w.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";w[w.balance=108]="balance";w[w.circleRelationship=109]="circleRelationship";w[w.hexagonCluster=
110]="hexagonCluster";w[w.opposingIdeas=111]="opposingIdeas";w[w.plusandMinus=112]="plusandMinus";w[w.reverseList=113]="reverseList";w[w.counterbalanceArrows=114]="counterbalanceArrows";w[w.segmentedPyramid=115]="segmentedPyramid";w[w.nestedTarget=116]="nestedTarget";w[w.convergingRadial=117]="convergingRadial";w[w.radialList=118]="radialList";w[w.tabbedArc=119]="tabbedArc";w[w.basicTarget=120]="basicTarget";w[w.basicVenn=121]="basicVenn";w[w.linearVenn=122]="linearVenn";w[w.stackedVenn=123]="stackedVenn";
w[w.interconnectedRings=124]="interconnectedRings";w[w.basicMatrix=125]="basicMatrix";w[w.titledMatrix=126]="titledMatrix";w[w.gridMatrix=127]="gridMatrix";w[w.basicPyramid=128]="basicPyramid";w[w.invertedPyramid=129]="invertedPyramid";w[w.accentedPicture=130]="accentedPicture";w[w.circularPictureCallout=131]="circularPictureCallout";w[w.radialPictureList=132]="radialPictureList";w[w.snapshotPictureList=133]="snapshotPictureList";w[w.spiralPicture=134]="spiralPicture";w[w.captionedPictures=135]="captionedPictures";
w[w.bendingPictureCaption=136]="bendingPictureCaption";w[w.pictureFrame=137]="pictureFrame";w[w.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";w[w.bendingPictureBlocks=139]="bendingPictureBlocks";w[w.bendingPictureCaptionList=140]="bendingPictureCaptionList";w[w.titledPictureBlocks=141]="titledPictureBlocks";w[w.pictureGrid=142]="pictureGrid";w[w.pictureAccentBlocks=143]="pictureAccentBlocks";w[w.themePictureAccent=144]="themePictureAccent";w[w.themePictureGrid=145]="themePictureGrid";
w[w.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";w[w.alternatingPictureCircles=147]="alternatingPictureCircles";w[w.titlePictureLineup=148]="titlePictureLineup";w[w.pictureLineup=149]="pictureLineup";w[w.framedTextPicture=150]="framedTextPicture";w[w.bubblePictureList=151]="bubblePictureList";w[w.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";w[w.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";w[w.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";
w[w.accentHomeChevronProcess=155]="accentHomeChevronProcess";w[w.basicProcessNew=156]="basicProcessNew";w[w.basicTimelineNew=157]="basicTimelineNew";w[w.chevronBlockProcess=158]="chevronBlockProcess";w[w.hexagonTimeline=159]="hexagonTimeline";w[w.horizontalActionList=160]="horizontalActionList";w[w.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";w[w.roundedRectangleTimeline=162]="roundedRectangleTimeline";w[w.verticalDownArrowProcess=163]="verticalDownArrowProcess";w[w.verticalHollowActionList=
164]="verticalHollowActionList";w[w.verticalSolidActionList=165]="verticalSolidActionList";w[w.dropPinTimeline=166]="dropPinTimeline";w[w.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";w[w.horizontalPathTimeline=168]="horizontalPathTimeline";w[w.iconLabelList=169]="iconLabelList";w[w.iconCircleList=170]="iconCircleList";w[w.iconLabelDescriptionList=171]="iconLabelDescriptionList";w[w.iconVerticalSolidList=172]="iconVerticalSolidList";w[w.iconCircleLabelList=173]="iconCircleLabelList";w[w.iconCircleOutlineLabelList=
174]="iconCircleOutlineLabelList";w[w.iconLeafLabelList=175]="iconLeafLabelList";w[w.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";w[w.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(ng||(ng={}));Object(n.b)("SmartArtLayout",ng);var wg;(function(w){w[w.title=0]="title";w[w.body=1]="body";w[w.centerTitle=2]="centerTitle";w[w.subTitle=3]="subTitle";w[w.slideNum=5]="slideNum";w[w.footer=6]="footer";w[w.object=8]="object";w[w.graph=9]="graph";w[w.table=10]="table";
w[w.clipArt=11]="clipArt";w[w.orgChart=12]="orgChart";w[w.media=13]="media";w[w.picture=15]="picture"})(wg||(wg={}));Object(n.b)("PlaceholderType",wg);class bf{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc){this.n6="Existing";this.sLa="ExistingInMenu";this.OZe="AnimationExisting";this.PZe="AnimationExistingInMenu";this.ia=w;this.jq=T;this.pa=ea;this.ggc=pc.qk(Uc.a.yhd);this.Jb=wa;this.Ea=ra;this.Gk=Za;this.fc=ub;this.n$j=zb.pptAnimationMarkersEnabled;this.Fa=tc;this.la=zb}wb(){this.ia.ra(Rc.a.Sna,Ic.a.application,
Object(v.a)(this,this.Sna,"queryAnimationGallery"),97);this.ia.ra(Rc.a.PNe,Ic.a.application,Object(v.a)(this,this.PNe,"queryMoreAnimationGallery"),96);this.ia.ra(Rc.a.Bz,Ic.a.application,Object(v.a)(this,this.Bz,"setAnimation"),5);this.ia.ra(Rc.a.ALb,Ic.a.application,Object(v.a)(this,this.Bz,"setAnimation"),5);this.ia.ra(Rc.a.BLb,Ic.a.application,Object(v.a)(this,this.Bz,"setAnimation"),5);this.ia.ra(Rc.a.Z_a,Ic.a.application,Object(v.a)(this,this.Bz,"setAnimation"),5);this.ia.ra(Rc.a.qNe,Ic.a.application,
Object(v.a)(this,this.pNe,"queryEffectOptions"),100);this.ia.ra(Rc.a.X_a,Ic.a.application,Object(v.a)(this,this.X_a,"setAnimationDirection"),5);this.ia.ra(Rc.a.MZa,Ic.a.application,Object(v.a)(this,this.MZa,"queryAnimationDirection"),97);this.ia.ra(Rc.a.Y_a,Ic.a.application,Object(v.a)(this,this.Y_a,"setAnimationEffectData"),4);this.ia.ra(Rc.a.NZa,Ic.a.application,Object(v.a)(this,this.NZa,"queryAnimationEffectData"),96);this.ia.ra(Rc.a.lod,Ic.a.application,Object(v.a)(this,this.PKa,"setAnimationSequence"),
5);this.ia.ra(Rc.a.mod,Ic.a.application,Object(v.a)(this,this.PKa,"setAnimationSequence"),5);this.ia.ra(Rc.a.nod,Ic.a.application,Object(v.a)(this,this.PKa,"setAnimationSequence"),5);this.ia.ra(Rc.a.ood,Ic.a.application,Object(v.a)(this,this.PKa,"setAnimationSequence"),5);this.ia.ra(Rc.a.Tna,Ic.a.application,Object(v.a)(this,this.Tna,"queryAnimationSequence"),97);this.ia.ra(Rc.a.FRe,Ic.a.application,Object(v.a)(this,this.raa,"reorderAnimation"),4);this.ia.ra(Rc.a.GRe,Ic.a.application,Object(v.a)(this,
this.raa,"reorderAnimation"),4);this.ia.ra(Rc.a.uhb,Ic.a.application,Object(v.a)(this,this.uhb,"populateAnimationEffectOptions"),96);this.ia.ra(Rc.a.vya,Ic.a.application,Object(v.a)(this,this.vya,"setAnimationColor"),4);this.la.cB&&Lf.a("AnimationGalleryActionAIEnabled")&&this.ia.ra(Rc.a.sQd,Ic.a.application,Object(v.a)(this,this.Vae,"handleAnimationGalleryActionAI"),4)}Ee(){}uhb(w,T,ea,ra,wa){w=this.vQ();T=this.pa.tk();if(!T||!w)return 8;if(1===ea)return 32;ea=bf.L3(T,w);if(!ea||0===ea.EffectId)return 16;
wa.MenuItems=this.Cji(ea,T,w);return 32}Sna(w,T,ea,ra,wa){w=wa.queryResult;wa=wa.SourceControlId;var Za=ra=-1;wa!==this.n6&&({effectType:Za,effectId:ra}=this.Gk.oSc(wa));T=this.vQ();var ub=this.pa.tk();if(!ub||!T)return 8;if(1!==ea)return 32;({image:ea,label:pc}=this.Gk.pSc(wa));var zb=pc;if(wa===this.n6||wa===this.sLa)zb=ResourceStrings.L_ExistingButtonDescription;this.h9a(wa,ea,pc,w,zb);var tc=bf.L3(ub,T);var pc=tc?tc.EffectId:0;zb=tc?tc.EffectType:0;const bc=!this.Gk.Cab(tc,T);tc=this.Gk.Bke(tc,
T);this.n$j&&(ub=ub?ub.kTa(T):null,tc=tc&&!this.Gk.zTj(ub));ra=!bc&&!tc&&ra===pc&&Za===zb;Za=bc?!1:this.Gk.aZc(zb,pc);wa===this.n6||wa===this.sLa?(Za=wa===this.n6?this.OLk(this.n6,w,tc,Za,ea,zb,pc):bf.MLk(w,tc,Za),w.VU(bc||tc||Za)):T&&w.VU(ra);return 32}Vae(w,T){if(T.contextId!==Ic.a.application)return 2;w=this.vQ();return!this.pa.tk()||!w||w.tT||w.Dq||w.Mp?8:this.fc.$c(w)?16:32}OLk(w,T,ea,ra,wa,Za,ub){ea?this.h9a(w,wa,ResourceStrings.L_AnimationMultiple,T,ResourceStrings.L_AnimationMultiple):ra&&
(wa=this.Gk.oUc(Za,ub),{image:wa,label:ea}=this.Gk.pSc(wa),this.h9a(w,wa,ea,T,ea));return ra}h9a(w,T,ea,ra,wa){let Za;Za=w===this.n6?"298832323":w===this.sLa?"1264919631":"2676673376";T=T.substring((Uc.a.ylc+"_").length,T.length-6);w=Object.assign(new me.a,{Id:w,ExternalId:"Animation"+w,Icon:T,Command:Za,QueryCommand:"1852964326",LabelText:ea,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:wa});ra.w3=w}PNe(w,T){if(T.contextId!==Ic.a.application)return 2;
w=this.vQ();return!this.pa.tk()||!w||w.tT||w.Dq||w.Mp?8:this.fc.$c(w)?16:32}Bz(w,T,ea,ra,wa){T=this.vQ();var Za=this.pa.tk();if(!Za||!T||T.tT||T.Dq||T.Mp)return 8;if(this.fc.$c(T))return 16;var ub=(ra=bf.L3(Za,T))?ra.EffectId:-1,zb=ra?ra.EffectType:-1;if(1===ea)return w===Rc.a.BLb||w===Rc.a.Z_a?(Za=this.Gk.aZc(zb,ub),ea=!!ra&&!this.Gk.Cab(ra,T),w===Rc.a.Z_a&&(Za=ea?!0:!1),T=!!ra&&this.Gk.Bke(ra,T),T=ea||T,Za||T?32:16):w===Rc.a.ALb?T.ud||T.hr||T.Mp?16:32:32;w=wa.SourceControlId;if(!w)return 8;if(w===
this.n6||w===this.sLa||w===this.OZe||w===this.PZe)return 32;({effectType:wa,effectId:ea}=this.Gk.oSc(w));ub=this.Gk.C7i(w);zb=this.Gk.z7i(w);ra=T.pab()?bf.l6b(Za,T):ra;ra||(ra=new vf,ra.Id=T.id.toString(),ra.BuildIds=[Za.U2b+1],ra.HasTrigger=!1,ra.BuildId=Za.U2b+1,ra.SequenceIndex=0,ra.IsTextRangeType=!1);ra.HasExisting=!1;ra.HasMultiple=!1;ra.EffectType=wa;ra.SequenceId=1;ra.EffectId=ea;ra.Direction=ub;ra.EffectData=zb;ra.IsTrigger=!1;this.K3b(Za,T,ra);m.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",
w,Za.Cb.sid,T.id);this.a4j(Za);return 32}vya(w,T,ea,ra,wa){T=this.jq.presentation;if(!T)throw Error.argumentNull("Presentation is null");w=this.vQ();if(!w)return 8;T=Object(y.a)(116,T.xC(w.slideId));if(!T)return 8;ra=bf.L3(T,w);if(!(ra&&wa&&T&&w))return 8;if(this.fc.$c(w))return 16;if(1===ea)return 32;ea=Rd.Box4ColorHelper.oV(wa);ea=Rd.Box4ColorHelper.Tib(ea,T.ke);if(!ea)return 8;ra.EffectData=String.format("{0},{1},{2}",ea.r.toString(16),ea.g.toString(16),ea.b.toString(16));this.K3b(T,w,ra);return 32}pNe(){const w=
this.vQ();var T=this.pa.tk();return T&&w?this.fc.$c(w)?16:(T=bf.L3(T,w))&&this.Gk.Qoi(w,this.Fa,T)?32:16:8}raa(w,T,ea){T=this.vQ();const ra=this.pa.tk();if(!ra||!T)return 8;if(this.fc.$c(T))return 16;const wa=bf.l6b(ra,T);let Za;switch(w){case Rc.a.FRe:Za=!1;break;case Rc.a.GRe:Za=!0;break;default:return 8}let ub=!1;if(T&&(ub=!!wa&&!wa.HasTrigger&&1===wa.BuildIds.length)){let zb=!1,tc=!1;({s_b:zb,u_b:tc}=bf.Voi(ra,wa));ub=Za?tc&&ub:zb&&ub}if(1===ea)return ub?32:8;if(ub){ea=this.Jb.Ad(15,void 0,()=>
{this.pa.ij();this.Ea.Ed()});try{ea.nc(ra),ea.jd=w,ra.raa(T,Za)}finally{ea&&ea.dispose()}}return 32}X_a(w,T,ea,ra,wa){w=this.vQ();T=this.pa.tk();if(!T||!w)return 8;if(1===ea)return 32;if(this.fc.$c(w))return 16;ea=bf.l6b(T,w);if(!ea)return 8;wa=wa.MenuItemId;ea.Direction=this.Gk.t5b(wa);this.K3b(T,w,ea);m.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.Gk.oUc(ea.EffectType,ea.EffectId),wa,T.sid,w.id);
return 32}MZa(w,T,ea,ra,wa){T=this.vQ();ra=this.pa.tk();if(!ra||!T)return 8;w=wa.queryResult;wa=this.Gk.t5b(wa.MenuItemId);T=bf.L3(ra,T);1===ea&&T&&w.Mf(T.Direction===wa);return 32}PKa(w,T,ea,ra,wa){w=wa.MenuItemId;T=this.vQ();ra=this.pa.tk();if(!ra||!T)return 8;if(1===ea)return 32;if(this.fc.$c(T))return 16;ea=bf.l6b(ra,T);if(!ea)return 8;ea.SequenceId=this.Gk.P9d(w);this.K3b(ra,T,ea);return 32}Tna(w,T,ea,ra,wa){w=this.vQ();T=this.pa.tk();if(!T||!w)return 8;w=bf.L3(T,w);T=wa.queryResult;wa=this.Gk.P9d(wa.MenuItemId);
1===ea&&w&&T.Mf(w.SequenceId===wa);return 32}Y_a(w,T,ea,ra,wa){w=this.vQ();T=this.pa.tk();if(!T||!w)return 8;if(1===ea)return 32;if(this.fc.$c(w))return 16;ea=bf.l6b(T,w);if(!ea)return 8;if(!wa)return 2;ea.EffectData=this.Gk.E6d(wa.MenuItemId);this.K3b(T,w,ea);return 32}NZa(w,T,ea,ra,wa){w=this.vQ();T=this.pa.tk();if(!T||!w)return 8;w=bf.L3(T,w);1===ea&&w&&wa.queryResult.Mf(this.Gk.kHf(w.EffectData,wa.MenuItemId));return 32}K3b(w,T,ea){const ra=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});
try{ra.nc(w),w.kqc(T,ea)}finally{ra&&ra.dispose()}}Cji(w,T,ea){const ra=Object.assign(new yd.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});Array.add(ra.MenuSectionList,this.Gk.QTc(w.EffectId,w.EffectType,"Direction","2289594085","3782857737"));this.Gk.bhg(w)&&(Array.add(ra.MenuSectionList,Fe.f(T.ke,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(ra.MenuSectionList,
Fe.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(ra.MenuSectionList,this.Gk.QTc(w.EffectId,w.EffectType,"EffectData","2949363495","4132852551"));Array.add(ra.MenuSectionList,this.Gk.wgj(ea,this.Fa,w));return ra}a4j(w){if(w){var T=w.Ek(),ea=String.format("{0}#{1}",w.sid,w.cid);if(T&&0<T.length)for(const ra of T)if(T=w.qEa(ra)){const wa=T.EffectId,Za=T.EffectType,ub=T.Direction,zb=this.Gk.oUc(Za,wa),tc=this.Fa.l2f(ra),
pc=bf.ejj(ra,tc);m.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",zb,wa,Za,ub,ra.$D().length,tc,pc,T.SequenceId,ea,ra.id)}}}vQ(){const w=this.pa.Jp();return w?w.get_smartArtModelId()?this.Fa.yr(w):w.Ng?this.Fa.ys(w):w:null}static MLk(w,T,ea){T?w.f9a=ResourceStrings.L_AnimationMultiple:(w.f9a=ResourceStrings.L_AnimationExisting,ea&&(ea=!1));return ea}static Voi(w,
T){let ea,ra;if(!T)return{s_b:!1,u_b:!1};const wa=w.H0d,Za=w.U2b,ub=T.BuildIds[0];ra=ea=!0;0===T.StartType?ea=ub>wa?!0:!1:ra=ub<Za?!0:!1;if(ub===wa||ub===Za){if(!ub)return{s_b:!1,u_b:ra};for(const zb of w.kQ)if(zb.Id!==T.Id)for(const tc of zb.BuildIds)if(0===T.StartType){if(tc>=ub)return ra=!0,{s_b:ea,u_b:ra}}else if(tc===ub)return ea=!0,{s_b:ea,u_b:ra};0===T.StartType?ra=!1:ea=!1}return{s_b:ea,u_b:ra}}static L3(w,T){return w&&T?w.L3(T):null}static l6b(w,T){return w&&T?w.qEa(T):null}static ejj(w,
T){return 24===T?ng[w.smartArtInfo.SmartArtLayout]:1===T?w.shapeType.toString():14===T?wg[w.Hj]:"Unknown"}}Object(n.a)(bf,"AnimationActorLegacy",null,[352]);class Pd{constructor(w,T,ea,ra){this.Af=null;this.Ca=w;this.pnb=T;this.nSh=ea;this.DId=ra;this.DId.init();this.pnb.init()}wb(){this.Ca.ra(qd.a.AHb,Ic.a.application,Object(v.a)(this,this.AHb,"openGrammarSettings"),1028);this.Ca.ya(qd.a.f7b,Gb.a.frame,Object(v.a)(this,this.y9f,"grammarDialogTabFocusHandler"));this.Ca.ya(qd.a.e7b,Gb.a.frame,Object(v.a)(this,
this.y9f,"grammarDialogTabFocusHandler"));this.Ca.ya(qd.a.eVc,Gb.a.frame,Object(v.a)(this,this.x9f,"grammarDialogOptionFocusHandler"));this.Ca.ya(qd.a.dVc,Gb.a.frame,Object(v.a)(this,this.x9f,"grammarDialogOptionFocusHandler"))}AHb(w,T,ea,ra,wa){w=this.x0f();if(1===ea)return this.DId.request(w).result&&this.DId.request(w).result.length?6===this.pnb.W3a.status?32:8:8;this.Af=this.nSh(w,this.pnb.W3a.result);this.Af.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,Za=>{m.ULS.sendTraceTag(36489285,
375,50,"User click button of {0}",1===Za?"OK":0===Za?"Cancel":"");1===Za&&(this.Af.FWj()?(m.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.pnb.saveSettings(this.Af.settings)):m.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});w=ea="";wa&&(ea+=wa.SourceControlId,w+=wa.Alt);m.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+ea+", Alt: "+w);return 32}x0f(){return Q.AFrameworkApplication.lcid}y9f(w){if(!this.Af)return 2;
var T=this.Af.Mo.yl().vj.b_;if(T===this.Af.Wv&&w===qd.a.f7b||T===this.Af.t_a&&w===qd.a.e7b)this.Af.I7?this.Af.Mo.yl().vj.YE(this.Af.I7):this.Af.W6k();else if(Sys.UI.DomElement.containsCssClass(T,He.I1b)||T.parentNode&&Sys.UI.DomElement.containsCssClass(T.parentNode,He.I1b))T=null,w===qd.a.f7b?T=this.Af.t_a:w===qd.a.e7b&&(T=this.Af.Wv),this.Af.Mo.yl().vj.YE(T);else if(w===qd.a.f7b)this.Af.Mo.yl().nGb();else if(w===qd.a.e7b)this.Af.Mo.yl().lGb();else return 2;return 32}x9f(w){if(!this.Af)return 2;let T=
this.Af.Mo.yl().vj.b_;if(T===this.Af.Wv||T===this.Af.t_a||T===this.Af.wD)return 2;w===qd.a.dVc&&this.Af.Mo.yl().nGb();w===qd.a.eVc&&this.Af.Mo.yl().lGb();T=this.Af.Mo.yl().vj.b_;T===this.Af.t_a?this.Af.Mo.yl().lGb():T===this.Af.Wv?this.Af.Mo.yl().nGb():this.Af.I7=T;return 32}}Object(n.a)(Pd,"GrammarSettingsActor",null,[]);class Md extends Pd{constructor(w,T,ea,ra,wa,Za,ub){super(w,T,ea,ra);this.ob=wa;this.Gxe=Za;this.Fa=ub}x0f(){let w=Q.AFrameworkApplication.lcid;if(this.ob.K_(this.ob.Na)){var T=
this.ob.Wd();T&&1===T.length&&(T=this.Fa.VSa(T[0]),0<T&&(w=T))}else this.ob.Na.mb&&(T=this.Gxe.bTc(this.ob.Pj),0<T&&(w=T));return w}}Object(n.a)(Md,"EditorSettingsActor",Pd,[]);var Mh=d(63),Bh=d(325),Vh=d(245),Jg=d(445),Of=d(43);class bi{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc){this.CUd=null;this.vag=($c,gd,md)=>{var Sc;gd=this.pa.Qe();if(!gd||!gd.length)return Cc.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const Zd of gd)if(!Zd||
this.fc.$c(Zd))return Cc.a.J(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.khl(gd))return Cc.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),8;if(1===md)return 32;null===(Sc=Of.a.Ib)||void 0===Sc?void 0:Sc.Va("SlideCount",gd.length.toString());md=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()});try{md.nc(this.ua.Ba);md.jd=$c;for(const Zd of gd)Zd.Moc=!0}finally{md&&
md.dispose()}return 32};this.ia=w;this.Ea=T;this.fc=ea;this.pa=ra;this.Jb=wa;this.RX=Za;this.ua=ub;this.nB=zb;this.iR=tc;this.eye=pc;this.Rd=bc;this.Ha=yc}wb(){this.ia.ra(Rc.a.ata,Ic.a.application,Object(v.a)(this,this.yag,"handleSlidesSolidFill"),4);this.ia.ra(Rc.a.FQc,Ic.a.application,Object(v.a)(this,this.yag,"handleSlidesSolidFill"),4);this.ia.ra(Rc.a.D4d,Ic.a.application,Object(v.a)(this,this.xag,"handleSlidesPicture"),4);this.ia.ra(Rc.a.RXf,Ic.a.application,Object(v.a)(this,this.xag,"handleSlidesPicture"),
4);this.ia.ra(Rc.a.C4d,Ic.a.application,Object(v.a)(this,this.nwj,"handleSlidesFinalizePicture"),4);this.ia.ra(Rc.a.DQc,Ic.a.application,Object(v.a)(this,this.Q9f,"handleApplyAll"),4);this.ia.ra(Rc.a.QXf,Ic.a.application,Object(v.a)(this,this.Q9f,"handleApplyAll"),4);this.ia.ra(Rc.a.WKe,Ic.a.application,Object(v.a)(this,this.quj,"handlePopulateFillMenu"),96);this.ia.ra(Rc.a.Z$g,Ic.a.application,Object(v.a)(this,this.ruj,"handlePopulateFillMenuForCanvasContextMenu"),96);this.ia.ra(Rc.a.qEe,Ic.a.application,
Object(v.a)(this,this.utj,"handleMoreFormatBackgroundColors"),96);this.ia.ra(Rc.a.nid,Ic.a.application,Object(v.a)(this,this.vtj,"handleMoreFormatBackgroundColorsResponse"),4);this.ia.ra(Rc.a.EQc,Ic.a.application,this.vag,4);this.ia.ra(Rc.a.SXf,Ic.a.application,this.vag,4)}Ee(){}quj(w,T,ea,ra,wa){w=this.ua.Ba;if(!w||this.fc.$c(w))return 16;if(1===ea)return 32;if(!wa)return Cc.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;ea=w.ke;if(!ea)return Cc.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),
8;w=this.RX.Ef.c8;T=Object.assign(new yd.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(T.MenuSectionList,Fe.f(ea,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(T.MenuSectionList,Fe.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));w&&0<w.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(T.MenuSectionList,
Fe.c(w,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(T.MenuSectionList,Fe.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));
wa.MenuItems=T;return 32}ruj(w,T,ea,ra,wa){w=this.ua.Ba;if(!w||this.fc.$c(w))return 16;if(1===ea)return 32;if(!wa)return Cc.a.J(512623376,822,10,"HandlePopulateFillMenuForCanvasContextMenu requires actionData"),8;T=w.ke;if(!T)return Cc.a.J(512623374,822,10,"HandlePopulateFillMenuForCanvasContextMenu failed to get theme information from slide"),8;ea=this.RX.Ef.c8;ra=Rc.a.FQc.toString();w=Object.assign(new yd.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});w.MenuSectionList.push(Fe.f(T,"Theme Colors",
"Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromCanvas",ra,1));w.MenuSectionList.push(Fe.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromCanvas",ra,!1));T=Rc.a.nid.toString();ea&&0<ea.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),w.MenuSectionList.push(Fe.c(ea,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",T,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!0));w.MenuSectionList.push(Fe.a("More Format Background Color","Color.Menu.Controls",Rc.a.qEe.toString(),ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));wa.MenuItems=w;return 32}yag(w,T,ea,ra,wa){T=this.pa.Qe();if(!T||!T.length)return 16;for(const Za of T)if(!Za||this.fc.$c(Za))return 16;if(1===ea)return 32;ea=bi.chd(wa);if(!ea)return 8;Of.a.Ib&&
Of.a.Ib.Va("SlideCount",T.length.toString());wa=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()});try{wa.nc(this.ua.Ba);wa.jd=w;for(const Za of T)Za.csb=ea}finally{wa&&wa.dispose()}return 32}xag(w,T,ea){this.CUd=this.ua.Ba;w=this.pa.Qe();if(!w||!w.length)return 16;for(const ra of w)if(!ra||this.fc.$c(ra)||Mh.a.ix(ra.Cb))return 16;if(1===ea)return 32;this.Oqd(!1);return 32}Q9f(w,T,ea){T=this.ua.Ba;if(!T||this.fc.$c(T))return 16;if(1===ea)return 32;ea=T.Cb;T=this.RX.Ef;if(!T)return 8;const ra=this.Jb.Ad(15,
void 0,()=>{this.Ea.Ed();this.pa.Qh()});try{ra.nc(T),ra.jd=w,T.Frb=ea}finally{ra&&ra.dispose()}return 32}khl(w){const T=this.RX.Ef;if(!T)return Cc.a.J(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const ra of w)if((w=ra.HS)&&-1==w.indexOf("/BgSource/ContentMaster")&&-1==w.indexOf("/BgSource/MainMaster")){var ea=T.nYi(ra.hj,ra.Cn);if(!ea)return Cc.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),
!0;ea=ea.HS;if(!ea||!w.match(ea))return!0}return!1}nwj(w,T,ea,ra,wa){T=this.pa.Qe();if(!T||!T.length)return 16;for(const ub of T)if(!ub||!ub.isConnected)return 16;if(1===ea)return 32;this.iR.rhb=new Date;const Za=Of.a.Ib;this.nB.m_e(wa,ub=>{Of.a.BI(Za,()=>{this.pwj(ub,w)})},ub=>{this.B7b(ub.error)});this.ua.Ba===this.CUd&&(this.Ea.Ed(),this.pa.Qh());return 32}utj(w,T,ea,ra,wa){w=this.ua.Ba;if(!w||this.fc.$c(w))return Cc.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),
16;if(this.Ha.FC&&Lf.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.pa.Qe().length:1!==this.pa.Qe().length)return 16;if(1===ea)return this.ia.La(Rc.a.renderColorPicker,1,wa);ea=Vh.a.parse(w.HS);if(!ea)return 8;wa=ea.YLa();ea=null;wa&&(ea=Rd.Box4ColorHelper.cta(wa));wa={};wa.currentColor=ea;wa.handleCommand=Rc.a.nid;return this.ia.La(Rc.a.renderColorPicker,2,wa)}vtj(w,T,ea,ra,wa){if(1===ea)return this.ia.La(Rc.a.ata,ea,wa);if(!wa)return Cc.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),
16;w=this.ia.La(Rc.a.ata,ea,wa);32===w&&this.ia.La(Rc.a.QBa,ea,wa);return w}Oqd(w){this.eye?Jg.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.nB&&(this.nB.vPb=1,this.nB.Ech(w))}pwj(w,T){this.iR.vZa=new Date;(w=w.result)?this.Cqi(w,T):(T=Object.assign(new Bh.a,{Code:94}),this.B7b(T))}Cqi(w,T){const ea=this.pa.Qe(),ra=this.Jb.Ad(15);try{ra.nc(this.CUd);ra.jd=T;for(const wa of ea)wa.zC=w.ItemId}finally{ra&&ra.dispose()}if(w=Of.a.Ib)w.actionName="FormatBackgroundPicture",
w.Va("PictureUploadStart",Of.a.nf(this.iR.rhb)),w.Va("PictureUploadDurationMS",(+this.iR.vZa-+this.iR.rhb).toString())}B7b(w){this.iR.vZa=new Date;this.Rd.cH(w.Code,T=>{T.jC=1;T.ZRa=w.ExtraErrorParam;return!1})}static chd(w){return Vh.a.parse(w.Color)}}Object(n.a)(bi,"FormatBackgroundActor",null,[352]);var ij=d(76),ig=d(33),oj=d(419),fh=d(32),Qd=d(154);const $e=w=>{let T=w.isBold?"b:1;":"";T+=w.isItalic?"i:1;":"";T+=w.iE?"u:1;":"";T+=w.PF?"s:1;":"";T+=w.isSuperscript?"sup:1;":"";return T+=w.QF?"sub:1;":
""},yh=(w,T,ea)=>{let ra=null;for(var wa,Za=ig.ParagraphReader.text(w),ub=0;w.Ra&&ub<w.Ra.length;){var zb=w.Ra.ga(ub),tc=zb.cp;wa=ub<w.Ra.length-1?w.Ra.ga(ub+1).cp:ig.ParagraphReader.textLength(w);if(-1!==T&&wa<=T)ub++;else{if(-1!==ea&&tc>ea)break;var pc="";zb.formatting?pc=$e(zb.formatting.cache):(zb=oj.c(w.Ra,zb.cp).n1c)&&(pc=$e(zb.cache));zb=tc;-1!==T&&(zb=Math.max(T,tc));tc=wa;-1!==ea&&(tc=Math.min(ea,wa));tc=S.a.substring(Za,zb,tc);0<tc.length&&(wa=document.createElement("span"),wa.setAttribute("style",
pc),wa.innerText=tc,ra||(ra=document.createElement("p")),ra.appendChild(wa));ub++}}if(ra&&ig.ParagraphReader.YW(w)){T=ra;ea=T.setAttribute;ub=new fh.GraphIterator;ub.set(w);ub.rc(11);ub.Jg(11);Za="";if(w.Sf.jw(ub))switch(ub=w.Sf.jw(ub),w=ig.ParagraphReader.hhb(w),pc=ub.hX,ub.listType){case 0:switch(ub.listStyle){case 1:Za="decimal";break;case 2:Za="loweralpha";break;case 3:Za="lowerroman";break;case 4:Za="upperalpha";break;case 5:Za="upperroman";break;default:Za="decimal"}Za=String.format("lt:{0};in:{1};li:{2}",
Za,w,pc);break;case 1:switch(ub.listStyle){case 1:Za="disc";break;case 2:Za="circle";break;case 3:Za="square";break;default:Za="disc"}Za=String.format("lt:{0};in:{1}",Za,w)}ea.call(T,"style",Za)}return ra},Ti=w=>{if(w){var T;(T=ia.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?T=T.JN(w):(Cc.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),T=null);if(T){w=null;T=T.i$a();for(let ea=0;ea<T.length;ea++){const ra=fe(Object(y.a)(ij.AParagraphNode,T[ea].n4b));w=gi(ra,w)}return w}w=
Array.isArray(w.$D())?w.$D():null;return fe(w&&0<w.length?w[0]:null)}return null},fe=w=>{let T=null;for(;w;){const ea=yh(w,-1,-1);T=gi(ea,T);w=ig.ParagraphReader.wta(w,!1,!0,!1)}return T},gi=(w,T)=>{w&&(T||(T=document.createElement("div")),T.appendChild(w));return T},vi=w=>{const T=Object.assign(new Qd.a,{Source:6});ia.a.instance.resolve("PowerPointWebEditor.IErrorHandler").zs(T,w,ea=>{ea.jC=1;ea.tCa=0;ea.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;ea.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;
return!1})};class bk{constructor(w,T,ea,ra){this.tAg=!1;this.W$c="";this.ia=w;this.Ea=T;this.ob=ea;const wa=new Date;ra("immersiveReader").then(()=>{this.tAg=!0;Cc.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+wa)}).catch(Za=>{const ub=+new Date-+wa;Cc.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",ub,Za.toString());const zb=new Map;zb.set("JSLoadDurationInMs",ub.toString());zb.set("Exception",Za.toString());
u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new Ca.a,{extendedProperties:zb}))})}wb(){this.ia.ya(Rc.a.immersiveReader,Ic.a.view,Object(v.a)(this,this.ydg,"immersiveReaderHandler"));this.ia.ya(Rc.a.rde,Ic.a.view,Object(v.a)(this,this.ydg,"immersiveReaderHandler"))}Ee(){this.Ea.Fc(vg.a.lQ).bindAction(qb.KeyInputManager.Oa(Ue.a.svc,qb.KeyInputManager.Oe|4),Rc.a.immersiveReader)}X2i(w){let T="";for(w=Object(y.a)(ij.AParagraphNode,w.node);w;){const ea=
ig.ParagraphReader.wta(w,!0,!0,!1);if(ea)w=ea;else break}for(;w;)T+="\n"+ig.ParagraphReader.text(w),w=ig.ParagraphReader.wta(w,!1,!0,!1);return T}pki(){var w=this.ob.Qe();let T=null;if(!w)return null;for(const ea of w)if(w=ea.lTa())for(const ra of w)w=Ti(ra),T=gi(w,T);return T}oki(){let w=null;var T=this.ob.Na;if(!T)return null;for(let wa of T)if(wa)for(T=0;T<wa.length;T++){var ea=wa.ga(T),ra=null;if(ea.contextId===Ic.a.outline||ea.contextId===Ic.a.Pf)if(ig.ParagraphReader.$d(ea.node)){for(ea=Object(y.a)(ij.AParagraphNode,
ea.node);ea;)if(ra=ig.ParagraphReader.wta(ea,!0,!0,!1))ea=ra;else break;ra=fe(ea)}else ra=Ti(Object(y.a)(4,ea.node));else ea.contextId!==Ic.a.endOfParagraph&&ig.ParagraphReader.$d(ea.node)&&(ra=yh(Object(y.a)(ij.AParagraphNode,ea.node),ea.Qa,ea.Mb));w=gi(ra,w)}return w}tki(){let w;return(w=this.ob.Bs()?this.pki():this.oki())?w.innerHTML:""}$lj(){let w="";const T=this.ob.Na.mb;if(T)for(let ea=0;ea<T.length;ea++){const ra=T.ga(ea),wa=ra.Qa,Za=ra.Mb-wa;let ub;if(ig.ParagraphReader.$d(ra.node))switch(ub=
ra.node.characterData,ra.contextId){case Ic.a.paragraph:w+=ub+"\r";break;case Ic.a.textRange:0<Za&&(w+=ub.substr(wa,Za));break;case Ic.a.endOfParagraph:w+="\r";break;case Ic.a.Pf:w+=this.X2i(ra)}}return w}Xog(){const w=new XMLHttpRequest,T=ia.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var ea=ia.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;ea=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",ea,T);w.open("GET",
ea,!0);const ra=F.a.create().toString();w.setRequestHeader("X-UserSessionId",Q.AFrameworkApplication.userSessionId);w.setRequestHeader("X-CorrelationID",ra);w.setRequestHeader("X-WacCluster",ia.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").pk);let wa=null;const Za=new Map;w.onreadystatechange=()=>{if(4===w.readyState)if(200===w.status){var ub=+new Date-+wa;Cc.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",ub);Za.set("AuthTokenDurationInMs",ub.toString());
ub=w.responseText.replace('"',"");const zb=new Date,tc=Lf.a("EnableSendingHTMLToIR")?[{["content"]:this.W$c,["mimeType"]:"text/html"}]:[{["content"]:this.W$c}];immersiveReader.launchAsync(ub,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:tc},null).then(pc=>{pc=(pc=Object(y.a)(Object,pc))?pc.sessionId:"";const bc=+new Date-+zb,yc=+new Date-+wa;Cc.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
bc,pc);Za.set("LaunchAsyncDurationInMs",bc.toString());Za.set("IRResponseSessionId",pc);Za.set("UserPerceivedDurationInMs",yc.toString());u.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new Ca.a,{extendedProperties:Za}))}).catch(pc=>{vi(T);const bc=+new Date-+zb,yc=+new Date-+wa;Cc.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",bc,pc);Za.set("LaunchAsyncDurationInMs",bc.toString());Za.set("ErrorJson",pc.toString());Za.set("UserPerceivedDurationInMs",
yc.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new Ca.a,{extendedProperties:Za}))})}else vi(T),ub=+new Date-+wa,Cc.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",ub,w.status,ra),Za.set("CorrelationId",ra),Za.set("StatusCode",w.status.toString()),Za.set("UserPerceivedDurationInMs",ub.toString()),u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered",
"RequestForAuthTokenFailed",!1,!0,Object.assign(new Ca.a,{extendedProperties:Za}));else Cc.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",ra,w.status)};wa=new Date;Cc.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",wa.getTime(),ra);ea=new Map;ea.set("CorrelationId",ra);ea.set("Info","RequestingAuthToken");u.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,ea);w.send(null)}ydg(w,
T,ea){if(1===ea||6===this.ia.xq){if(!this.tAg)return 8;this.W$c=Lf.a("EnableSendingHTMLToIR")?this.tki():this.$lj();if(""===this.W$c)return 8}2===ea&&this.Xog();return 32}}Object(n.a)(bk,"ImmersiveReaderActor",null,[352]);var Zg=d(583),Ek=d(787);class Ch{constructor(w){this.customData=null;this.oQ=w}}Object(n.a)(Ch,"PropertySetChangedState",null,[]);class Ui{static MJk(w,T,ea){if(w&&T){var ra=new Ch(T),wa=(Za,ub,zb)=>{ea.LJk(Za,ub,zb,ra)};w=new Ek.a(T,w);w.MGc=wa;w.rJc=wa;w.yld=wa;w.Lfa()}}}Object(n.a)(Ui,
"PropertySetChangedManager",null,[]);class pg{constructor(w){this.QYh=w}LJk(w,T,ea,ra){const wa=this.QYh[w.id.toString()];wa&&wa(w,T,ea,ra)}}Object(n.a)(pg,"PropertyChangedProcessor",null,[]);var Mg=d(1097),gh=d(441),Ie=d(61),Ia=d(582),lb=d(402),Lb=d(963);class hc{constructor(){this.fNe=this.N1c=this.ZWc=null}}Object(n.a)(hc,"ParagraphDialogResults",null,[]);class Pc extends Ub.a{constructor(w,T,ea){super(void 0,void 0,!0);this.qva=null;if(null===w)throw Error.argumentNull("properties");this.Dea=
w.clone();this.h$=w.clone();this.lB=ea;this.ia=T;this.Bek=new kc.a(Object(v.a)(this,this.SFi,"createPropertyChangedHandlers"))}sqd(){this.hg="ParagraphDialog";const w={};w.bodyControls=this.F5d();this.Zi(ResourceStrings.L_ParagraphDialogTitle,Object(v.a)(this,this.w_d,"dialogResultHandler"),w)}w_d(w,T){1===w&&(this.XEl(T),w=Object.assign(new hc,{ZWc:this.Dea,N1c:this.h$,fNe:this.Bek}),this.ia.La(Rc.a.hHf,2,w));this.dispose()}F5d(){this.qva=Pc.z6d();const w={};this.Oxi(w);this.bxi(w);var T=Lb.a("Inch",
3,0,56,.1);const ea=Lb.a("Character",2,0,56,.1);T=[T,ea];this.qyi(w,T);this.gxi(w,T);T=[Lb.a("Point",5,0,1584,1)];this.hxi(w,T);this.axi(w,T);this.Pxi(w);return w}XEl(w){this.eCl(w);this.MFl(w);this.tCl(w);this.uCl(w);this.cCl(w);this.kEl(w)}SFi(){const w={};w[Ie.a.jE.id.toString()]=Object(v.a)(this.lB,this.lB.ZXj,"justificationChangedHandler");w[Ie.a.IHb.id.toString()]=Object(v.a)(this.lB,this.lB.E8g,"paraIndentLeftChangedHandler");w[Ie.a.JHb.id.toString()]=Object(v.a)(this.lB,this.lB.E8g,"paraIndentLeftChangedHandler");
w[Ie.a.kga.id.toString()]=Object(v.a)(this.lB,this.lB.RZe,"specialIndentChangedHandler");w[Ie.a.iNb.id.toString()]=Object(v.a)(this.lB,this.lB.RZe,"specialIndentChangedHandler");w[Ie.a.jNb.id.toString()]=Object(v.a)(this.lB,this.lB.RZe,"specialIndentChangedHandler");w[Ie.a.ux.id.toString()]=Object(v.a)(this.lB,this.lB.ZZj,"lineSpacingChangedHandler");w[Ie.a.MHb.id.toString()]=Object(v.a)(this.lB,this.lB.H8g,"paraSpacingAfterChangedHandler");w[Ie.a.LHb.id.toString()]=Object(v.a)(this.lB,this.lB.H8g,
"paraSpacingAfterChangedHandler");w[Ie.a.PHb.id.toString()]=Object(v.a)(this.lB,this.lB.J8g,"paraSpacingBeforeChangedHandler");w[Ie.a.OHb.id.toString()]=Object(v.a)(this.lB,this.lB.J8g,"paraSpacingBeforeChangedHandler");return w}Pxi(w){var T=Pc.Gbj(this.Dea),ea="multiple"===T;w.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,
["options"]:Lb.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:T,["allowFreeForm"]:!1};T=0;let ra=!1;this.Dea.Sa(Ie.a.ux)&&ea&&(T=this.Dea.eb(Ie.a.ux),0<=T&&(ra=!0));ea=[Lb.a("none",0,0,9.99,.5)];ea={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:ea,["numberFormatInfo"]:this.qva,["validReservedValues"]:[""]};ea.value=ra?T:"";w.atSpinButtonProps=ea}axi(w,T){w.afterSpacingSpinButtonProps=Pc.vpd(Pc.QZf(this.Dea,Ie.a.MHb,Ie.a.LHb),{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Ia.a.W0b(5),
["validUnits"]:T,["numberFormatInfo"]:this.qva,["validReservedValues"]:[""]})}hxi(w,T){w.beforeSpacingSpinButtonProps=Pc.vpd(Pc.QZf(this.Dea,Ie.a.PHb,Ie.a.OHb),{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Ia.a.W0b(5),["validUnits"]:T,["numberFormatInfo"]:this.qva,["validReservedValues"]:[""]})}gxi(w,T){let ea,ra;({V7g:ra,W7g:ea}=Pc.F2f(this.Dea,
Ie.a.JHb,Ie.a.IHb,!1));T={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Ia.a.W0b(ea),["validUnits"]:T,["numberFormatInfo"]:this.qva,["validReservedValues"]:[""]};T=Pc.vpd(ra,T);w.beforeTextSpinButtonProps=T}qyi(w,T){var ea={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:Lb.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},ra=this.Dea.Sa(Ie.a.kga)?this.Dea.eb(Ie.a.kga):-1;Pc.wmg(ra)?ea.selectedKey=ra.toString():ea.defaultSelectedKey="";w.specialIndentationComboBoxProps=ea;({V7g:ea,W7g:ra}=Pc.F2f(this.Dea,Ie.a.jNb,Ie.a.iNb,1!==ra&&2!==ra));T={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Ia.a.W0b(ra),["validUnits"]:T,["numberFormatInfo"]:this.qva};T=Pc.vpd(ea,T);w.bySpinButtonProps=T}bxi(w){const T={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:Lb.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,
Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},ea=this.Dea.Sa(Ie.a.jE)?this.Dea.eb(Ie.a.jE):0;Pc.dPj(ea)?T.selectedKey=ea.toString():T.defaultSelectedKey="";w.alignmentComboBoxProps=T}Oxi(w){w.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};w.indentationLabelProps=
{["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};w.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}kEl(w){if(w.lineSpacingComboBoxProps){const T=w.lineSpacingComboBoxProps.selectedKey.toString();let ea=Lb.c(T);"multiple"===T&&(w=w.atSpinButtonProps)&&(ea=parseFloat(w.value.toString()));this.h$.setValue(Ie.a.ux,
ea);this.h$.setValue(Ie.a.jX,2)}}cCl(w){if(w.afterSpacingSpinButtonProps){w=w.afterSpacingSpinButtonProps;var T=Ia.a.V0b(w.unitType.toString().toLowerCase());""!==w.value.toString()&&(T=4===T?2:4,this.h$.setValue(Ie.a.MHb,parseInt(w.value.toString())),this.h$.setValue(Ie.a.LHb,T))}}uCl(w){if(w.beforeSpacingSpinButtonProps){w=w.beforeSpacingSpinButtonProps;var T=Ia.a.V0b(w.unitType.toString().toLowerCase());""!==w.value.toString()&&(T=4===T?2:4,this.h$.setValue(Ie.a.PHb,parseInt(w.value.toString())),
this.h$.setValue(Ie.a.OHb,T))}}tCl(w){if(w.beforeTextSpinButtonProps){var T=w.beforeTextSpinButtonProps;w=Ia.a.V0b(T.unitType.toString().toLowerCase());if(""!==T.value.toString()){T=parseFloat(T.value.toString());let ea;2===w?ea=2:(ea=1,T=Ia.a.LEh(T,w));this.h$.setValue(Ie.a.JHb,T);this.h$.setValue(Ie.a.IHb,ea)}}}MFl(w){var T=w.bySpinButtonProps,ea=w.didChangeSpecialIndentationComboBoxValue;if(T&&""!==T.value.toString()||ea)if(w.specialIndentationComboBoxProps&&(w=w.specialIndentationComboBoxProps,
ea=-1,w.selectedKey&&(w=w.selectedKey.toString(),ea=parseInt(w)),Pc.wmg(ea)&&this.h$.setValue(Ie.a.kga,ea)),T){w=parseFloat(T.value.toString());T=Ia.a.V0b(T.unitType.toString().toLowerCase());if(0>w||isNaN(w))w=0;2===T?ea=2:(ea=1,w=Ia.a.LEh(w,T));this.h$.setValue(Ie.a.jNb,w);this.h$.setValue(Ie.a.iNb,ea)}}eCl(w){w.alignmentComboBoxProps&&(w=w.alignmentComboBoxProps,w.selectedKey&&(w=parseInt(w.selectedKey.toString()),0<=w&&this.h$.setValue(Ie.a.jE,w)))}static QZf(w,T,ea){if(w.Sa(T)&&w.Sa(ea)){ea=
w.eb(ea);if(2!==ea&&4!==ea)return Number.NaN;w=w.eb(T);2===ea&&(w*=Pc.dFk);return w}return Number.NaN}static vpd(w,T){T.value=isNaN(w)?"":w;return T}static z6d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static F2f(w,T,ea,ra){let wa=3;Lf.a("BySpinButtonDefaultvalueFix")&&ra?T=0:w.Sa(T)&&w.Sa(ea)&&!ra?(T=w.eb(T),2===w.eb(ea)?wa=2:T=Ia.a.rIl(T,wa)):T=Number.NaN;return{V7g:T,
W7g:wa}}static dPj(w){return 1===w||2===w||3===w||6===w}static wmg(w){return 1===w||2===w||0===w}static Gbj(w){if(Pc.Txj(w)){w=w.eb(Ie.a.ux);var T="multiple";lb.a.$y(w,1)?T="1.00":lb.a.$y(w,1.5)?T="1.50":lb.a.$y(w,2)&&(T="2.00");return T}}static Txj(w){return w.Sa(Ie.a.ux)&&w.Sa(Ie.a.jX)&&2===w.eb(Ie.a.jX)?!0:!1}}Pc.dFk=72;Object(n.a)(Pc,"ReactParagraphDialog",Ub.a,[]);class Td{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc){this.Lre=[];this.ia=w;this.pa=T;this.Vea=ea;this.m$=ra;this.Jb=wa;this.Hh=Za;
this.JHa=ub;this.Fa=zb;this.lB=tc;this.Sea=pc;this.aVg=bc}wb(){this.ia.ra(Rc.a.OAb,Ic.a.application,Object(v.a)(this,this.ABk,"paragraphDialogHandler"),4);this.ia.ra(Rc.a.hHf,Ic.a.application,Object(v.a)(this,this.bwi,"commitParagraphDialogHandler"),4);this.ia.ra(Rc.a.odh,Ic.a.view,gh.a.d1,96);this.ia.ra(Rc.a.edh,Ic.a.view,gh.a.d1,96);this.ia.ra(Rc.a.Bdh,Ic.a.view,gh.a.d1,96);this.ia.ra(Rc.a.Cdh,Ic.a.view,gh.a.d1,96);this.ia.ra(Rc.a.Adh,Ic.a.view,gh.a.d1,96);this.ia.ra(Rc.a.zdh,Ic.a.view,gh.a.d1,
96);this.ia.ra(Rc.a.idh,Ic.a.view,gh.a.d1,96);this.ia.ra(Rc.a.jdh,Ic.a.view,gh.a.d1,96);this.ia.ya(Rc.a.I7g,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.Cxh,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.Kdg,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.Fxh,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.Exh,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.J7g,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.K7g,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.E7g,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.Dxh,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.D7g,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.M7g,Ic.a.view,
gh.a.dH);this.ia.ya(Rc.a.L7g,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.Gxh,Ic.a.view,gh.a.dH);this.ia.ya(Rc.a.njd,Ic.a.paragraph,Object(v.a)(this,this.agj,"getPropertiesForParagraphDialog"));this.ia.ya(Rc.a.njd,Ic.a.view,this.Sea);this.ia.je(Rc.a.njd,96)}Ee(){}ABk(w,T,ea){if(this.pa.Bs()||this.pa.k9())return 16;w=this.pa.Wd();if(!this.Fa.p_(w,!0).length&&!this.pa.Zka())return 16;if(1===ea)return 32;this.aVg&&Cc.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.xq,
"PptRibbon.Home"===this.ia.Xra);Array.clear(this.Lre);this.ia.processAction(Rc.a.njd,2);return(ea=Zg.APropertySet.Maj(this.Lre))?((new Pc(ea,this.ia,this.lB)).sqd(),32):16}bwi(w,T,ea,ra,wa){if(1===ea)return 32;if(!(wa&&wa.ZWc&&wa.N1c&&wa.fNe))return 16;T=this.pa.tk();this.lB.UCj();ea=this.Jb.me(15);try{ea.nc(T),ea.jd=w,wa.ZWc.equals(wa.N1c)||this.Dui(),Ui.MJk(wa.ZWc,wa.N1c,new pg(wa.fNe.value))}finally{ea&&ea.dispose()}if(this.aVg){let Za;({qLh:w,rLh:wa,tLh:T,sLh:ea,pLh:ra,uLh:Za}=this.lB.Ytl());
Cc.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",w,wa,T,ea,ra,Za)}Of.a.nP(!0,!0);return 32}agj(w,T,ea){if(1===ea)return 32;T=T.node;w=new Mg.DictionaryPropertySet;w.setValue(Ie.a.jE,this.Hh.HN(T));ea=this.Vea.cTa(T);w.setValue(Ie.a.jX,ea.unit);w.setValue(Ie.a.ux,ea.value);ea=this.Vea.LW(T);w.setValue(Ie.a.OHb,ea.beforeSpacing.unit);w.setValue(Ie.a.PHb,ea.beforeSpacing.value);
w.setValue(Ie.a.LHb,ea.afterSpacing.unit);w.setValue(Ie.a.MHb,ea.afterSpacing.value);ea=this.m$.K8(T);w.setValue(Ie.a.IHb,1);w.setValue(Ie.a.JHb,ea.UM);T=this.JHa.mTa(T);w.setValue(Ie.a.kga,T.specialIndentType);w.setValue(Ie.a.iNb,T.unit);w.setValue(Ie.a.jNb,T.value);this.Lre.push(w);return 32}Dui(){if(this.pa.gH()){var w=this.pa.Wd();w=this.Fa.p_(w);for(const T of w)T.$sa()}}}Object(n.a)(Td,"ParagraphDialogActor",null,[352]);var ie;(function(w){w[w.unspecified=-1]="unspecified";w[w.none=0]="none";
w[w.left=1]="left";w[w.center=2]="center";w[w.right=3]="right";w[w.inner=4]="inner";w[w.outer=5]="outer";w[w.both=6]="both";w[w.distribute=7]="distribute";w[w.margin=8]="margin";w[w.highKashida=9]="highKashida";w[w.lowKashida=10]="lowKashida";w[w.mediumKashida=11]="mediumKashida";w[w.numTab=12]="numTab";w[w.thaiDistribute=13]="thaiDistribute";w[w.start=14]="start";w[w.end=15]="end"})(ie||(ie={}));Object(n.b)("Justification",ie);var Sd=d(579);class wf{constructor(){this.value=this.unit=0}}Object(n.a)(wf,
"ParagraphSpacingCommandData",null,[]);class Pf{constructor(){this.yxh=this.F8g=this.I8g=this.K8g=!1}}Object(n.a)(Pf,"PptPropertySetChangedState",null,[]);class og{constructor(w){this.Xle=this.cke=this.Vle=this.Wle=this.rke=this.jke=!1;this.Wec={};this.ia=w;this.$Cj()}ZXj(w,T,ea){ea&&(w=this.Wec[ie[ea]],void 0!==w&&null!==w&&(this.ia.processAction(w,2),this.jke=!0))}ZZj(w,T,ea){void 0!==ea&&null!==ea&&(this.ia.La(Rc.a.Kna,2,ea),this.rke=!0)}J8g(w,T,ea,ra){void 0!==ea&&null!==ea&&(w=og.vRc(ra),!w.K8g&&
null!==ra&&ra.oQ.Sa(Ie.a.OHb)&&ra.oQ.Sa(Ie.a.PHb)&&(T=ra.oQ.eb(Ie.a.PHb),ra=ra.oQ.eb(Ie.a.OHb),w.K8g=!0,this.ia.La(Rc.a.Vjb,2,Object.assign(new wf,{value:T,unit:ra})),this.Wle=!0))}H8g(w,T,ea,ra){void 0!==ea&&null!==ea&&(w=og.vRc(ra),!w.I8g&&null!==ra&&ra.oQ.Sa(Ie.a.LHb)&&ra.oQ.Sa(Ie.a.MHb)&&(T=ra.oQ.eb(Ie.a.MHb),ra=ra.oQ.eb(Ie.a.LHb),w.I8g=!0,this.ia.La(Rc.a.Ujb,2,Object.assign(new wf,{value:T,unit:ra})),this.Vle=!0))}E8g(w,T,ea,ra){void 0!==ea&&null!==ea&&(T=og.vRc(ra),!T.F8g&&null!==ra&&ra.oQ.Sa(Ie.a.IHb)&&
ra.oQ.Sa(Ie.a.JHb)&&(w=ra.oQ.eb(Ie.a.JHb),ra=ra.oQ.eb(Ie.a.IHb),T.F8g=!0,T=new Sd.a,T.unit=ra,T.value=w,this.ia.La(Rc.a.Cka,2,T),this.cke=!0))}RZe(w,T,ea,ra){void 0!==ea&&null!==ea&&(ea=og.vRc(ra),!ea.yxh&&null!==ra&&ra.oQ.Sa(Ie.a.iNb)&&ra.oQ.Sa(Ie.a.jNb)&&(T=0,ra.oQ.Sa(Ie.a.kga)&&(T=ra.oQ.eb(Ie.a.kga)),w=ra.oQ.eb(Ie.a.jNb),ra=ra.oQ.eb(Ie.a.iNb),ea.yxh=!0,ea=0,1===T?ea=Rc.a.eMb:2===T?ea=Rc.a.gMb:0===T&&(ea=Rc.a.iMb),T=new Sd.a,T.unit=ra,T.value=w,this.ia.La(ea,2,T),this.Xle=!0))}Ytl(){return{qLh:this.jke,
rLh:this.rke,tLh:this.Wle,sLh:this.Vle,pLh:this.cke,uLh:this.Xle}}UCj(){this.Xle=this.cke=this.Vle=this.Wle=this.rke=this.jke=!1}$Cj(){this.Wec.left=qd.a.leftJustify;this.Wec.center=qd.a.centerJustify;this.Wec.right=qd.a.rightJustify;this.Wec.both=qd.a.fullJustify}static vRc(w){w.customData||(w.customData=new Pf);return w.customData}}Object(n.a)(og,"ParagraphLevelPropertyChangedHandlers",null,[558]);var Dh=d(532),Bi=d(201),Vi=d(270),kh=d(349),mi=d(40),sh=d(51),Ng=d(84),Wh=d(161);class Gg{constructor(w,
T){this.kvb=w;this.Gh=T}}Object(n.a)(Gg,"DoNotCheckCritiqueTypeActionData",null,[]);var eg=d(24);class Tj{Y6a(w){return(w=Object(y.a)(Gg,w))?Object(eg.a)(kh.a,w.Gh):!1}OIe(w,T){if(T=Object(y.a)(Gg,T)){const ea=T.Gh;ea&&(ea.aMa(w,T.kvb),m.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",T.kvb))}}}Object(n.a)(Tj,"DoNotCheckCritiqueTypeCallback",null,[613]);var aj=d(465),pj=d(50);class Ji extends aj.a{constructor(w,T,ea,ra,wa,Za,ub){super();
this.KCe=null;this.init(w);this.Pl("WholePresentationOperation");this.OEa(Q.AFrameworkApplication.Ta,T,ea,ra,wa);this.meb=0;this.dXg=ub;this.nzg=Za;this.eGa=wa;this.Abc=T;this.Y6a()?1===this.behavior&&(this.Dp=32,this.GY()):(this.Dp=8,this.GY())}run(){0===this.meb&&this.TWe();1===this.meb&&this.PMe();2===this.meb&&this.V0e();3===this.meb&&this.J3d()}Y6a(){return this.dXg.Y6a(this.eGa)}OIe(){this.dXg.OIe(this.Abc,this.eGa)}TWe(){this.KCe=new pj.GraphTransaction(3);this.KCe.nc(this.nzg.node);this.meb=
1}PMe(){this.Yw||this.Ejb(this.nzg.CE);1!==this.Qna()&&(this.meb=2)}V0e(){this.OIe();this.KCe.dispose();this.meb=3}J3d(){this.GY()}}Object(n.a)(Ji,"WholePresentationOperation",aj.a,[]);var yg=d(52);class Aa{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc){this.IEa=!1;this.ia=w;this.Arg=T;this.bG=ea;this.Jb=ra;this.N3c=wa;this.ua=Za;this.Fa=ub;this.u$=bc;this.Gxe=zb;this.NC=tc;this.ob=yc;this.lad=pc.Ish;this.fak=pc.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.F$j=pc.pptHideProofingErrorIsEnabled;
this.EEj()}get J1b(){return this.bG.VUa?this.N3c.instance:null}wb(){this.ia.ra(Rc.a.dJb,yg.a.application,Object(v.a)(this,this.dJb,"queryLanguage"),96);this.ia.ra(Rc.a.Egd,yg.a.application,Object(v.a)(this,this.Zzk,"openPPTLanguageDialogView"),4);this.bG.djg&&this.ia.ra(qd.a.EWc,Ic.a.Pf,Object(v.a)(this,this.EWc,"ignoreProofingError"),4);this.bG.kje&&(this.fak?(this.ia.ya(qd.a.Kub,Ic.a.paragraph,Object(v.a)(this,this.zPf,"doNotCheckThisCritiqueTypeForNode")),this.ia.ya(qd.a.Kub,Ic.a.section,Object(v.a)(this,
this.zPf,"doNotCheckThisCritiqueTypeForNode")),this.ia.XV(qd.a.Kub,Ic.a.Pf,Object(v.a)(this,this.$Ni,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.ra(Rc.a.B2b,Ic.a.Pf,Object(v.a)(this,this.B2b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.ra(qd.a.Kub,Ic.a.Pf,Object(v.a)(this,this.B2b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.F$j&&(this.ia.ra(Rc.a.ejd,yg.a.application,Object(v.a)(this,this.ejd,"queryHideProofingErrors"),100),this.ia.ra(Rc.a.hcg,yg.a.application,Object(v.a)(this,
this.$vl,"toggleHideProofingErrors"),4))}Ee(){}EEj(){this.IEa=Aa.zce;m.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.IEa);this.IEa&&this.ecg(this.IEa)}ejd(w,T,ea,ra,wa){if(1===ea)return 32;if(!wa)return 8;wa[Dh.a.On]=this.IEa;return 32}$vl(w,T,ea,ra,wa){if(1===ea)return 32;if(!(wa&&Dh.a.On in wa))return 8;this.IEa=wa[Dh.a.On];Aa.zce=this.IEa;this.ecg(this.IEa);m.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",this.IEa);return 32}zPf(w,T,ea,ra,
wa){if(!T)return 8;w=T.node;if(!w)return 8;if(T.contextId===Ic.a.section&&!w.sa(Wh.a.jig,!1))return 32;if(T.contextId===Ic.a.paragraph&&w.sa(Wh.a.Tda,!1)){T=Object(y.a)(Gg,wa);if(!T)return 8;wa=T.Gh;if(!wa)return 8;T.kvb+=this.Ghh(w,wa.typeId,wa.lcid)}return 2}$Ni(w,T,ea,ra,wa){var Za=this.h7i();Za=new Gg(0,Za);this.ia.mi(ea,Rc.a.B2b,ra,!1,wa,Za);ea=sh.a.create(Object(y.a)(Ng.a,this.ua.presentation));m.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",
ra);return new Ji(w,T,ra,wa,Za,ea,new Tj)}B2b(w,T,ea,ra,wa){w=Object(y.a)(Gg,wa);if(!w)return 8;ra=w.Gh;if(!ra)return 8;if(1===ea)return 32;if(!T.node)return 8;m.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",ra.lcid,ra.typeId);w.kvb+=this.rXk(ra.typeId,ra.lcid);this.J1b&&this.J1b.IMi(ra.lcid.toString(),ra.typeId);return 32}EWc(w,T,ea){if(1===ea)return 32;m.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");ea=this.NC.OSa(T);
if(!ea||!ea.Gh)return 8;T=T.node;var ra=this.ua.Ba;if(!T||!ra)return 8;ra=this.Jb.me(Aa.Umj(ea));try{ra.nc(T),this.NC.qKa(T,[ea],!0),T.setValue(mi.a.PHf,!0)}finally{ra&&ra.dispose()}ea.Gh.aMa(w,1);this.ob.dVa()||Of.a.nP(!0,!1);m.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}ecg(w){this.u$.HXe=w}h7i(){var w=this.ob.Na.mb;if(!w)return null;w=this.NC.OSa(w.Ua);if(!w||!w.Gh)return null;w=Object(y.a)(kh.a,w.Gh);return!w||0>=w.lcid?null:w}rXk(w,T){const ea=new Date;
if(!this.ua.Ba)return 0;const ra=this.ua.Ba.Ek();if(!ra)return 0;let wa=0,Za=0;const ub=this.Jb.me(3);try{ub.nc(this.ua.Ba);for(const zb of ra)this.Fa.LJ(zb,tc=>{++Za;tc.Sa(mi.a.pq)&&tc.sa(Wh.a.Tda,!1)&&(wa+=this.Ghh(tc,w,T))})}finally{ub&&ub.dispose()}m.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+ea,Za,ra.length,wa);return wa}Ghh(w,T,ea){const ra=this.NC.GF(w,wa=>{wa=Object(y.a)(kh.a,
wa.Gh);return!!wa&&wa.typeId===T&&wa.lcid===ea});if(Bi.a.Wa(ra))return 0;this.NC.qKa(w,ra);return ra.length}dJb(w,T,ea,ra,wa){wa.tIc=this.jbj();return 32}jbj(){let w=Q.AFrameworkApplication.lcid;if(this.ob.K_(this.ob.Na)){var T=this.ob.Wd();if(1<T.length||1!==T.length)return"";T=this.Fa.VSa(T[0]);0<T&&(w=T)}else this.ob.Na.mb&&(T=this.Gxe.bTc(this.ob.Pj),0<T&&(w=T));return Vi.a.xe(w)?Vi.a.xe(w).displayName:Vi.a.xe(Q.AFrameworkApplication.lcid).displayName}gUj(){const w=this.ob.Wd();return 1===w.length&&
w[0].D_c}Zzk(w,T,ea){if(2!==ea)return 32;this.lad&&this.ob.K_(this.ob.Na)&&this.gUj()?(m.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.Arg.value.getInstance(!0).trc()):this.ob.Na.mb&&(m.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.Arg.value.getInstance(!1).trc());return 32}static get zce(){const w=Pa.a.get("PowerPointHideProofingErrors");return w?"true"===w.toLowerCase():!1}static set zce(w){Pa.a.$J("PowerPointHideProofingErrors",
w.toString(),30)||m.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",w.toString())}static Umj(w){return 1===w.Gh.proofingType?15:3}}Object(n.a)(Aa,"ProofingActor",null,[352]);var Ma=d(273),cb=d(585);class Fb{constructor(w,T){this.ke=w.toLowerCase();this.variant=T}}Object(n.a)(Fb,"ThemeVariant",null,[]);var dc=d(39),zc=d(1047);class Vc{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc){this.w4c=null;this.x4c=0;this.uxg=this.v4c=!1;this.XFg=null;this.Asb=new Fb("",
0);this.DVg={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",
["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",
["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=w;this.Ea=T;this.fc=ea;this.pa=wa;this.Jb=ra;this.Vb=ub;this.ua=zb;this.oc=tc;this.Ihk=pc;this.$6c=bc;this.dBg=yc}wb(){this.ia.ra(Rc.a.gw,yg.a.application,Object(v.a)(this,this.Dag,"handleThemeChange"),
4);this.ia.ra(Rc.a.oCa,yg.a.application,Object(v.a)(this,this.Dag,"handleThemeChange"),4);this.ia.ra(Rc.a.ijd,yg.a.application,Object(v.a)(this,this.ijd,"queryMoreThemeGallery"),96);this.ia.ra(Rc.a.QNe,yg.a.application,Object(v.a)(this,this.QNe,"queryMoreVariantGallery"),96);this.ia.ra(Rc.a.zz,yg.a.application,Object(v.a)(this,this.zz,"queryThemes"),97);this.ia.ra(Rc.a.Fnc,yg.a.application,Object(v.a)(this,this.Fnc,"queryThemeVariants"),97);this.ia.ra(Rc.a.bid,yg.a.application,Object(v.a)(this,this.bid,
"populateVariantGallery"),96)}Ee(){}zz(w,T,ea,ra,wa){wa&&wa.XU&&(w=this.DVg[wa.XU]===this.$Da().ke,wa.VZa.Mf(w));return 32}Fnc(w,T,ea,ra,wa){if(wa&&wa.XU){w=this.$Da();T=w.ke;ea=wa.XU;try{var Za=Number.parseInvariant(ea.substring(ea.length-1,ea.length))}catch(ub){Za=0}wa=wa.VZa;wa.Mf(w.variant===Za);Za=Vc.dZf(ea,Za,T);wa.w3=Za}return 32}ijd(w,T,ea){if(T.contextId!==Ic.a.application)return 2;w=this.pa.tk();var ra=this.$Da();T=Vc.Bxb(ra.ke);ra=ra.variant-1;return this.fc.$c(w)?16:1!==ea||(m.ULS.sendTraceTag(512499972,
801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",T,ra),this.oc.pj())?32:8}QNe(w,T,ea){if(T.contextId!==Ic.a.application)return 2;var ra=this.pa.tk();T=this.$Da();w=Vc.Bxb(T.ke);T=T.variant-1;if(this.fc.$c(ra))return 16;if(1===ea)if(ea=Vc.S6b(this.$Da().ke),ra=this.Ihk.iXj(ea),ea&&ra)m.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",w,T);else return 16;return 32}Dag(w,
T,ea,ra,wa){T=this.pa.Qe();ra=this.ua.Ba;if(!ra||w===Rc.a.oCa&&this.$Da()===this.Asb||this.fc.$c(ra))return 16;if(1===ea)return 32;ea=Object(y.a)(String,wa);if(null===ea)return 8;wa=this.DVg[ea];return w===Rc.a.gw?this.iEk(ra,wa,T):w===Rc.a.oCa?this.jEk(ra,ea):8}iEk(w,T,ea){if(!w)return 16;1>=this.aJf()||this.dBg&&ea&&1<ea.length?(this.hRd(w,T,0,!1,ea),m.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Vc.Bxb(T),0,w.Cb.sid)):(this.w4c=
T,this.x4c=0,this.v4c=!1,w=new fb.StandardDialog,w.xd=1,w.fP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.ZDf,"changeThemeHandler")));return 32}jEk(w,T){if(!w)return 16;const ea=this.$Da();let ra;try{if(ra=Number.parseInvariant(T.substring(7,T.length))-1,0>ra||ra>Vc.S6b(ea.ke))ra=-1}catch(wa){ra=-1}1>=this.aJf()?(this.hRd(w,ea.ke,ra,!0,null),m.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",
Vc.Bxb(ea.ke),ra,w.Cb.sid)):(this.w4c=ea.ke,this.x4c=ra,this.v4c=!0,w=new fb.StandardDialog,w.xd=1,w.fP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.ZDf,"changeThemeHandler")));return 32}$Da(){let w=null;var T=this.ua.Ba;if(T){T=T.hj;const ra=this.oc.FI();if(ra&&T)for(var ea of ra)if(ea.Id===T){w=ea;break}}if(!w)return this.uxg?this.XFg:this.Asb;if(Object(Lf.a)("EnableNonEmptyGuidFixForThemeActor")){if(!w.ThemeFamilyId||Vc.Bxb(w.ThemeFamilyId)===
Vc.ZBf)return this.Asb}else if(!w.ThemeFamilyId||w.ThemeFamilyId===Vc.dni)return this.Asb;ea="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===w.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===w.ThemeFamilyId;return!this.$6c&&ea?this.Asb:new Fb(w.ThemeFamilyId,w.VariantIndex+1)}aJf(){const w=this.oc.FI();let T=0;if(w)for(const ea of w)ea.InContent&&(T+=1);return T}ZDf(w){const T=this.ua.Ba;if(T){var ea=this.w4c,ra=this.x4c,wa=this.v4c;this.w4c=null;this.x4c=-1;this.v4c=!1;1===w&&(this.hRd(T,ea,ra,
wa,null),m.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Vc.Bxb(ea),ra,T.Cb.sid))}}hRd(w,T,ea,ra,wa){this.XFg=(this.uxg=ra)?new Fb(T,0):this.Asb;const Za=this.Jb.Ad(15,void 0,()=>{this.Ea.Ed();this.pa.Qh()},void 0,!0);try{if(Za.nc(w),Za.jd=ra?Rc.a.oCa:Rc.a.gw,this.dBg&&wa)for(const ub of wa)ub.setValue(dc.a.J1e,T),ub.setValue(dc.a.eba,ea),ub.setValue(dc.a.bfi,1<wa.length);else w.setValue(dc.a.J1e,T),w.setValue(dc.a.eba,ea)}finally{Za&&
Za.dispose()}this.fc.NZb(this.Vb.Ef,w,"ChangeTheme")}bid(w,T,ea,ra,wa){if(1===ea)return 32;w=Math.max(Vc.S6b(this.$Da().ke),4);T=this.$Da().ke;wa.MenuItems=Vc.Agj(w,T);return 32}static S6b(w){for(let T=0;T<zc.a.bza.length;++T)if(zc.a.bza[T].xPc===w)return zc.a.bza[T].R5e;return 0}static Bxb(w){for(let T=0;T<zc.a.bza.length;++T)if(zc.a.bza[T].xPc===w)return zc.a.bza[T].sFh;return Vc.ZBf}static ZVi(w){let T="";for(let ea=0;ea<zc.a.bza.length;++ea)zc.a.bza[ea].xPc===w&&(T=zc.a.bza[ea].sFh.replace(" ",
""));return T}static Agj(w,T){const ea=Object.assign(new yd.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var ra=Object.assign(new Ma.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(ea.MenuSectionList,ra);const wa=Object.assign(new cb.a,{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(ra.ControlList,
wa);for(ra=1;ra<=w;++ra)Array.add(wa.GalleryItems,Vc.dZf("Variant"+ra,ra,T));return ea}static dZf(w,T,ea){ea=!Vc.S6b(ea)||T>Vc.S6b(ea)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",Vc.ZVi(ea),T);return Object.assign(new me.a,{Id:w,ExternalId:w,Icon:ea,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,T),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}
Vc.dni="00000000-0000-0000-0000-000000000000";Vc.ZBf="Unsupported Theme";Object(n.a)(Vc,"ThemeActor",null,[352]);var rd=d(473);class Z{}Z.none=0;Z.cut=0;Z.random=1;Z.blinds=2;Z.TUd=3;Z.GCa=4;Z.dissolve=5;Z.fade=6;Z.hMa=7;Z.nPe=8;Z.Hvd=9;Z.wipe=10;Z.Fsh=11;Z.split=13;Z.Ofl=17;Z.Tfl=18;Z.wedge=19;Z.push=20;Z.NVd=21;Z.Pvf=23;Z.wheel=26;Z.Csh=27;Z.Zuc=28;Z.OKb=29;Z.BEa=30;Z.$oc=39;Z.q0e=42;Z.flip=43;Z.xM=44;Z.OJl=47;Z.L2d=48;Z.u0d=49;Z.TIi=50;Z.j6e=51;Z.$Ik=52;Z.V_i=53;Z.iIi=54;Z.gKe=55;Z.o8g=56;Z.BJe=
57;Z.hQd=58;Z.pJe=59;Z.morph=60;Z.pan=36;Z.S4d=38;Z.aXd=37;Z.m0d=33;Z.window=34;Z.y4b=32;Z.zoom=31;Z.cLl=22;Object(n.a)(Z,"TransitionTypes",null,[]);class Da{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc){this.ia=w;this.Vb=T;this.ua=ea;this.pa=wa;this.Ea=Za;this.Jb=ra;this.rn=ub;this.fc=zb;this.ZDg=tc.fRj;this.kn=tc.FC;this.g7c=tc.jSj;this.ggc=pc.qk(Uc.a.yhd);this.VGa=tc.cB;this.Fb=bc}wb(){this.g7c?(this.ZDg?(this.ia.ra(Rc.a.Qj,Ic.a.application,Object(v.a)(this,this.Fdl,"setSlidesTransitionGalleryExceptExisting"),
5),this.ia.ra(Rc.a.zj,Ic.a.application,Object(v.a)(this,this.yMk,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.ra(Rc.a.Ioa,Ic.a.application,Object(v.a)(this,this.Gdl,"setSlidesTransitionGalleryExisting"),5),this.ia.ra(Rc.a.Dya,Ic.a.application,Object(v.a)(this,this.Hdl,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.ra(Rc.a.Vna,Ic.a.application,Object(v.a)(this,this.zMk,"querySlidesTransitionGalleryExisting"),97),this.ia.ra(Rc.a.Rxa,Ic.a.application,Object(v.a)(this,this.AMk,"querySlidesTransitionGalleryExistingInMenu"),
97)):(this.ia.ra(Rc.a.Qj,Ic.a.application,Object(v.a)(this,this.lWe,"setSlidesTransitionGallery"),5),this.ia.ra(Rc.a.zj,Ic.a.application,Object(v.a)(this,this.gOe,"querySlidesTransitionGallery"),97),this.ia.ra(Rc.a.Ioa,Ic.a.application,Object(v.a)(this,this.lWe,"setSlidesTransitionGallery"),5),this.ia.ra(Rc.a.Dya,Ic.a.application,Object(v.a)(this,this.lWe,"setSlidesTransitionGallery"),5),this.ia.ra(Rc.a.Vna,Ic.a.application,Object(v.a)(this,this.gOe,"querySlidesTransitionGallery"),97),this.ia.ra(Rc.a.Rxa,
Ic.a.application,Object(v.a)(this,this.gOe,"querySlidesTransitionGallery"),97)),this.ia.ra(Rc.a.vqc,Ic.a.application,Object(v.a)(this,this.Edl,"setSlidesTransitionEffectOption"),5),this.ia.ra(Rc.a.Xjd,Ic.a.application,Object(v.a)(this,this.wMk,"querySlidesTransitionEffectOption"),97),this.ia.ra(Rc.a.iib,Ic.a.application,Object(v.a)(this,this.xMk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.ra(Rc.a.hIb,Ic.a.application,Object(v.a)(this,this.bGk,"populateSlidesTransitionEffectOptions"),
96),this.ia.ra(Rc.a.Qxa,Ic.a.application,Object(v.a)(this,this.vMk,"querySlidesTransitionDuration"),97),this.ia.ra(Rc.a.Yjb,Ic.a.application,Object(v.a)(this,this.Ddl,"setSlidesTransitionDuration"),5)):(this.ZDg?(this.ia.ra(Rc.a.Qj,Ic.a.application,Object(v.a)(this,this.Bel,"setTransitionGalleryExceptExisting"),5),this.ia.ra(Rc.a.zj,Ic.a.application,Object(v.a)(this,this.QMk,"queryTransitionGalleryExceptExisting"),97),this.ia.ra(Rc.a.Ioa,Ic.a.application,Object(v.a)(this,this.Cel,"setTransitionGalleryExisting"),
5),this.ia.ra(Rc.a.Dya,Ic.a.application,Object(v.a)(this,this.Eel,"setTransitionGalleryExistingInMenu"),5),this.ia.ra(Rc.a.Vna,Ic.a.application,Object(v.a)(this,this.Vna,"queryTransitionGalleryExisting"),97),this.ia.ra(Rc.a.Rxa,Ic.a.application,Object(v.a)(this,this.Rxa,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.ra(Rc.a.Qj,Ic.a.application,Object(v.a)(this,this.zWe,"setTransitionGallery"),5),this.ia.ra(Rc.a.zj,Ic.a.application,Object(v.a)(this,this.zj,"queryTransitionGallery"),97),this.ia.ra(Rc.a.Ioa,
Ic.a.application,Object(v.a)(this,this.zWe,"setTransitionGallery"),5),this.ia.ra(Rc.a.Dya,Ic.a.application,Object(v.a)(this,this.zWe,"setTransitionGallery"),5),this.ia.ra(Rc.a.Vna,Ic.a.application,Object(v.a)(this,this.zj,"queryTransitionGallery"),97),this.ia.ra(Rc.a.Rxa,Ic.a.application,Object(v.a)(this,this.zj,"queryTransitionGallery"),97)),this.ia.ra(Rc.a.vqc,Ic.a.application,Object(v.a)(this,this.Ael,"setTransitionEffectOption"),5),this.ia.ra(Rc.a.Xjd,Ic.a.application,Object(v.a)(this,this.PMk,
"queryTransitionEffectOption"),97),this.ia.ra(Rc.a.iib,Ic.a.application,Object(v.a)(this,this.iib,"queryTransitionEffectOptionsAnchor"),100),this.ia.ra(Rc.a.hIb,Ic.a.application,Object(v.a)(this,this.hIb,"populateTransitionEffectOptions"),96),this.ia.ra(Rc.a.Qxa,Ic.a.application,Object(v.a)(this,this.Qxa,"queryTransitionDuration"),97),this.ia.ra(Rc.a.Yjb,Ic.a.application,Object(v.a)(this,this.Yjb,"setTransitionDuration"),5));this.ia.ra(Rc.a.Xjb,Ic.a.application,Object(v.a)(this,this.Xjb,"setTransitionApplyAll"),
4);this.ia.ra(Rc.a.KJb,Ic.a.application,Object(v.a)(this,this.KJb,"queryTransitionApplyAll"),96)}Ee(){}hIb(w,T,ea,ra,wa){if(this.kn&&1!==this.pa.Qe().length)return 16;if(1===ea)return 32;w=(w=this.ua.Ba)?w.ho:null;if(!w)return 16;if(!wa)return 8;w=this.rn.Dxb(w);w.next&&(wa.MenuItems=this.LAf(w));return 32}zj(w,T,ea,ra,wa){if(!wa)return 8;w=wa.queryResult;wa=wa.SourceControlId;T=this.rn.xQ(wa);if(!T)return 8;w.QDa=Da.W4d(T.uc,T.pc,this.ggc);T=this.ua.Ba;if(!T)return 16;1===ea&&((ea=T.ho)?(ea=this.rn.qTa(ea),
w.VU(!ea&&"TransitionExisting"===wa||ea===wa)):w.VU("TransitionNone"===wa));return 32}QMk(w,T,ea,ra,wa){if(!wa||w!==Rc.a.zj)return 8;w=wa.queryResult;wa=wa.SourceControlId;T=this.rn.xQ(wa);if(!T)return 8;ra=T.uc.split("_")[1]+"_24";T=Da.wSa(wa,wa,ra,"2024601249","149145197",T.pc,T.pc);w.w3=T;T=this.ua.Ba;if(!T)return 16;1===ea&&((ea=T.ho)?(ea=this.rn.qTa(ea),w.VU(ea===wa)):w.VU("TransitionNone"===wa));return 32}Vna(w,T,ea,ra,wa){if(!wa||w!==Rc.a.Vna)return 8;w=wa.queryResult;wa=wa.SourceControlId;
if(!wa||"TransitionExisting"!==wa)return 16;T=this.rn.xQ(wa);if(!T)return 8;ra=T.uc.split("_")[1]+"_24";T=Da.wSa(wa,wa,ra,"3752636652","3476251476",T.pc,T.pc);w.w3=T;T=this.ua.Ba;if(!T)return 16;if(1===ea&&(ea=T.ho)){ea=this.rn.qTa(ea);T=this.rn.w0c(ea,this.rn.Pwb());if(ea&&!T){ra=this.rn.xQ(ea);if(!ra)return 8;const Za=ra.uc.split("_")[1]+"_24";wa=Da.wSa(wa,wa,Za,"3752636652","3476251476",ra.pc,ra.pc);w.w3=wa}w.VU(!ea||!!ea&&!T)}return 32}Rxa(w,T,ea,ra,wa){if(!wa||w!==Rc.a.Rxa)return 8;w=wa.queryResult;
wa=wa.SourceControlId;if(!wa||"TransitionExistingInMenu"!==wa)return 16;T=this.rn.xQ(wa);if(!T)return 8;ra=T.uc.split("_")[1]+"_24";wa=Da.wSa(wa,wa,ra,"4036532528","2831233208",T.pc,T.pc);w.w3=wa;wa=this.ua.Ba;if(!wa)return 16;1===ea&&(ea=wa.ho)&&(ea=this.rn.qTa(ea),w.VU(!ea));return 32}iib(w,T,ea){w=this.ua.Ba;if(!w)return 16;w=this.rn.Dxb(w.ho);return!w||!w.next||this.kn&&1!==this.pa.Qe().length?16:1===ea?32:8}zWe(w,T,ea,ra,wa){if(!wa)return 8;T=wa.SourceControlId;wa=w===Rc.a.Ioa||w===Rc.a.Dya;
ra=this.ua.Ba;if(!ra||this.fc.$c(ra)||this.kn&&1!==this.pa.Qe().length)return 16;var Za=ra.ho;const ub=!!this.rn.pTa(Za);if(wa&&(!Za||ub))return 16;if(1===ea)return 32;Za=this.rn.xQ(T);if(!Za)return 8;if(!wa&&2===ea&&T){Of.a.zk("SlideCount","1");ea=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{ea.nc(ra),ea.jd=w,ra.ho=Za.tc}finally{ea&&ea.dispose()}m.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
T,Za.next||"null",ra.Cb.sid)}return 32}Bel(w,T,ea,ra,wa){if(!wa)return 8;T=wa.SourceControlId;ra=this.ua.Ba;if(!ra)return 16;if(w!==Rc.a.Qj)return 8;if(this.fc.$c(ra)||this.kn&&1!==this.pa.Qe().length)return 16;if(1===ea)return 32;wa=this.rn.xQ(T);if(!wa)return 8;if(2===ea&&T){Of.a.zk("SlideCount","1");ea=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{ea.nc(ra),ea.jd=w,ra.ho=wa.tc}finally{ea&&ea.dispose()}m.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
T,wa.next||"null",ra.Cb.sid)}return 32}Cel(w,T,ea,ra,wa){if(!wa)return 8;T=this.ua.Ba;if(!T)return 16;if(w!==Rc.a.Ioa)return 8;if(this.kn&&1!==this.pa.Qe().length)return 16;if(1!==ea)return 8;w=T.ho;ea=!!this.rn.pTa(w);T=this.rn.Dxb(w);T=this.rn.w0c(T?T.parent:null,this.rn.Pwb());return w&&!ea||!T?32:16}Eel(w,T,ea,ra,wa){if(!wa)return 8;T=this.ua.Ba;if(!T)return 16;if(w!==Rc.a.Dya)return 8;if(this.kn&&1!==this.pa.Qe().length)return 16;if(1!==ea)return 8;w=T.ho;ea=!!this.rn.pTa(w);return!w||ea?16:
32}Xjb(w,T,ea){T=this.ua.Ba;if(!T||this.fc.$c(T)||this.kn&&1!==this.pa.Qe().length)return 16;if(1===ea)return 32;Of.a.zk("SlideCount","1");ea=this.Vb.Ef;const ra=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{ra.nc(ea),ra.jd=w,ea.Grb=T.Cb}finally{ra&&ra.dispose()}m.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}KJb(w,T,ea,ra,wa){w=this.ua.Ba?!0:!1;if(!wa)return 8;wa=wa.queryResult;wa.QDa=Da.W4d("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,
this.ggc);wa.VU(w);return w?32:16}Ael(w,T,ea,ra,wa){if(!wa)return 8;T=wa.MenuItemId;if(this.kn&&1!==this.pa.Qe().length)return 16;if(1===ea)return 32;ea=this.ua.Ba;if(!ea||this.fc.$c(ea))return 16;ra=ea?ea.ho:null;wa=this.rn.xQ(T);if(!ra||!wa||!wa.tc)return 16;ra.TransitionType=wa.tc.TransitionType;ra.Direction=wa.tc.Direction;ra.Duration=wa.tc.Duration;Of.a.zk("SlideCount","1");const Za=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{Za.nc(ea),Za.jd=w,ea.ho=ra}finally{Za&&Za.dispose()}m.ULS.sendTraceTag(512499932,
801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",wa.parent,T,ea.Cb.sid);return 32}PMk(w,T,ea,ra,wa){if(!wa)return 8;w=wa.queryResult;wa=wa.MenuItemId;T=this.ua.Ba;if(!T)return 16;1===ea&&w.Mf(this.rn.pTa(T.ho)===wa);return 32}Qxa(w,T,ea,ra,wa){w=this.ua.Ba;if(!w)return 16;if(!wa)return 8;w=w.ho;if(wa=wa.queryResult)wa.Kaa=w?(w.Duration/1E3).toString():"0";return 32}Yjb(w,T,ea,ra,wa){T=this.ua.Ba;if(!T||this.fc.$c(T))return 16;
if(!wa)return 8;if(this.kn&&1!==this.pa.Qe().length)return 16;ra=Math.floor(1E3*wa.Number);wa=T.ho;if(!wa)return 16;Of.a.Ib&&(Of.a.Ib.actionName="SetTransitionDuration");if(1===ea)return"TransitionNone"===this.rn.qTa(wa)?16:32;if(2===ea){wa.Duration=ra;const Za=this.Ea.Ae;Of.a.zk("SlideCount","1");ea=this.Jb.Ad(15,void 0,()=>{this.pa.ij();!Za||Za.name!==vg.a.sg&&Za.name!==vg.a.Az||this.Ea.Ed()});try{ea.nc(T),ea.jd=w,T.ho=wa}finally{ea&&ea.dispose()}}return 32}bGk(w,T,ea,ra,wa){if(1===ea)return 32;
if(!wa)return 8;T=this.pa.Qe();if(!T||!T.length)return 16;w=T[0].ho;if(!w)return 16;w=this.rn.Dxb(w);if(1<T.length)for(const Za of T){T=Za.ho;if(!T)return 16;T=this.rn.Dxb(T);if(w.parent!==T.parent)return 16}w.next&&(wa.MenuItems=this.LAf(w));return 32}gOe(w,T,ea,ra,wa){if(!wa)return 8;w=wa.queryResult;wa=wa.SourceControlId;T=this.rn.xQ(wa);if(!T)return 8;w.QDa=Da.W4d(T.uc,T.pc,this.ggc);T=this.pa.Qe();if(!T||!T.length)return 16;1===ea&&(ea="",({gpa:ea}=this.vRa(T)).returnValue&&w.VU(!ea&&"TransitionExisting"===
wa||ea===wa));return 32}yMk(w,T,ea,ra,wa){if(!wa||w!==Rc.a.zj)return 8;w=wa.queryResult;wa=wa.SourceControlId;T=this.rn.xQ(wa);if(!T)return 8;ra=T.uc.split("_")[1]+"_24";T=Da.wSa(wa,wa,ra,"2024601249","149145197",T.pc,T.pc);w.w3=T;T=this.pa.Qe();if(!T||!T.length)return 16;1===ea&&(ea="",({gpa:ea}=this.vRa(T)).returnValue&&w.VU(ea===wa));return 32}zMk(w,T,ea,ra,wa){if(!wa||w!==Rc.a.Vna)return 8;w=wa.queryResult;wa=wa.SourceControlId;if(!wa||"TransitionExisting"!==wa)return 16;T=this.rn.xQ(wa);if(!T)return 8;
ra=T.uc.split("_")[1]+"_24";T=Da.wSa(wa,wa,ra,"3752636652","3476251476",T.pc,T.pc);w.w3=T;T=this.pa.Qe();if(!T||!T.length)return 16;if(1===ea&&(ea="",({gpa:ea}=this.vRa(T)).returnValue)){T=this.rn.w0c(ea,this.rn.Pwb());if(ea&&!T){ra=this.rn.xQ(ea);if(!ra)return 8;const Za=ra.uc.split("_")[1]+"_24";wa=Da.wSa(wa,wa,Za,"3752636652","3476251476",ra.pc,ra.pc);w.w3=wa}w.VU(!ea||!!ea&&!T)}return 32}AMk(w,T,ea,ra,wa){if(!wa||w!==Rc.a.Rxa)return 8;w=wa.queryResult;wa=wa.SourceControlId;if(!wa||"TransitionExistingInMenu"!==
wa)return 16;T=this.rn.xQ(wa);if(!T)return 8;ra=T.uc.split("_")[1]+"_24";wa=Da.wSa(wa,wa,ra,"4036532528","2831233208",T.pc,T.pc);w.w3=wa;wa=this.pa.Qe();if(!wa||!wa.length)return 16;1===ea&&(ea="",({gpa:ea}=this.vRa(wa)).returnValue&&w.VU(!ea));return 32}xMk(w,T,ea){w=this.pa.Qe();if(!w||!w.length)return 16;T=this.rn.Dxb(w[0].ho);return!T||!T.next||1<w.length&&!this.vRa(w).returnValue?16:1===ea?32:8}lWe(w,T,ea,ra,wa){if(!wa)return 8;T=wa.SourceControlId;wa=w===Rc.a.Ioa||w===Rc.a.Dya;ra=this.pa.Qe();
if(!ra||!ra.length)return 16;for(var Za of ra)if(this.fc.$c(Za))return 16;Za="";const ub=({gpa:Za}=this.vRa(ra)).returnValue;if(wa&&(!ub||Za))return 16;if(1===ea)return 32;Za=this.rn.xQ(T);if(!Za)return 8;if(!wa&&2===ea&&T){Of.a.zk("SlideCount",ra.length.toString());ea=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{ea.nc(this.Vb.Ef);ea.jd=w;for(const zb of ra)zb.ho=Za.tc}finally{ea&&ea.dispose()}m.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
T,Za.next||"null")}return 32}Mil(){if(!Object(Lf.a)("ToggleMorphTransitionToNoneForActionAi")||!this.VGa)return!1;const w=this.pa.Qe();let T=!0;for(const ea of w)if(!ea.ho||ea.AZe!==Z.morph){T=!1;break}return T}Fdl(w,T,ea,ra,wa){if(!wa)return 8;T=wa.SourceControlId;this.Mil()&&(T="TransitionNone");if(w!==Rc.a.Qj)return 8;ra=this.pa.Qe();if(!ra||!ra.length)return 16;for(var Za of ra)if(this.fc.$c(Za))return 16;if(1===ea)return 32;Za=this.rn.xQ(T);if(!Za)return 8;if(2===ea&&T){Of.a.zk("SlideCount",
ra.length.toString());ea=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()},()=>{1===this.Fb.Fl&&this.Ea.Cj(vg.a.MB,!0)});try{ea.nc(this.Vb.Ef);ea.jd=w;for(const ub of ra)ub.ho=Za.tc}finally{ea&&ea.dispose()}m.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",T,Za.next||"null")}return 32}Gdl(w,T,ea,ra,wa){if(!wa)return 8;T=this.pa.Qe();if(!T||!T.length)return 16;if(w!==Rc.a.Ioa||1!==ea)return 8;ra="";w=({gpa:ra}=this.vRa(T)).returnValue;
ea=!!ra;T=ra&&0<ra.length?this.rn.xQ(ra):null;T=this.rn.w0c(T?T.parent:null,this.rn.Pwb());return!w||ea&&T?16:32}Hdl(w,T,ea,ra,wa){if(!wa)return 8;T=this.pa.Qe();if(!T||!T.length)return 16;if(w!==Rc.a.Dya||1!==ea)return 8;w="";return!({gpa:w}=this.vRa(T)).returnValue||w?16:32}Edl(w,T,ea,ra,wa){if(!wa)return 8;T=wa.MenuItemId;if(1===ea)return 32;ea=this.pa.Qe();if(!ea||!ea.length)return 16;for(var Za of ea)if(this.fc.$c(Za)||!Za.ho)return 16;Za=this.rn.xQ(T);if(!Za||!Za.tc)return 16;Of.a.zk("SlideCount",
ea.length.toString());ra=this.Jb.Ad(15,void 0,()=>{this.pa.ij();this.Ea.Ed()});try{ra.nc(this.Vb.Ef);ra.jd=w;for(const ub of ea){let zb=ub.ho;zb.TransitionType=Za.tc.TransitionType;zb.Direction=Za.tc.Direction;zb.Duration=Za.tc.Duration;ub.ho=zb}}finally{ra&&ra.dispose()}m.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",Za.parent,T);return 32}wMk(w,T,ea,ra,wa){if(!wa)return 8;w=wa.queryResult;wa=wa.MenuItemId;T=
this.pa.Qe();if(!T||!T.length)return 16;1===ea&&(ea="",({gpa:ea}=this.hOi(T)).returnValue&&w.Mf(ea===wa));return 32}vMk(w,T,ea,ra,wa){if(!wa)return 8;w=this.pa.Qe();if(!w||!w.length)return 16;if(wa=wa.queryResult)w=Da.Xjj(w),wa.Kaa=w;return 32}Ddl(w,T,ea,ra,wa){if(!wa)return 8;T=this.pa.Qe();if(!T||!T.length)return 16;for(const Za of T)if(this.fc.$c(Za))return 16;wa=Math.floor(1E3*wa.Number);for(const Za of T)if(!Za.ho)return 16;Of.a.Ib&&(Of.a.Ib.actionName="SetTransitionDuration");if(1===ea){for(const Za of T)if("TransitionNone"===
this.rn.qTa(Za.ho))return 16;return 32}if(2===ea){const Za=this.Ea.Ae;Of.a.zk("SlideCount",T.length.toString());ea=this.Jb.Ad(15,void 0,()=>{this.pa.ij();!Za||Za.name!==vg.a.sg&&Za.name!==vg.a.Az||this.Ea.Ed()});try{ea.nc(this.Vb.Ef);ea.jd=w;for(const ub of T){const zb=ub.ho;zb.Duration=wa;ub.ho=zb}}finally{ea&&ea.dispose()}}return 32}vRa(w){let T;T="";if(!w||!w.length)return{returnValue:!1,gpa:T};T=this.rn.qTa(w[0].ho);let ea=!0;if(1<w.length)for(const ra of w)if(w=this.rn.qTa(ra?ra.ho:null),T!==
w){ea=!1;break}ea||(T="");return{returnValue:ea,gpa:T}}hOi(w){let T;T="";if(!w||!w.length)return{returnValue:!1,gpa:T};T=this.rn.pTa(w[0].ho);let ea=!0;if(1<w.length)for(const ra of w)if(w=this.rn.pTa(ra?ra.ho:null),T!==w){ea=!1;break}ea||(T="");return{returnValue:ea,gpa:T}}LAf(w){const T=Object.assign(new yd.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),ea=Object.assign(new Ma.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",
DisplayMode:"Menu32",ControlList:[]});Array.add(T.MenuSectionList,ea);let ra=null;for(w=({key:ra}=this.rn.c4f(w)).returnValue;w;)Array.add(ea.ControlList,Object.assign(new rd.a,{Command:"961566706",Id:ra,ExternalId:"TransitionEffectOptions"+ra,QueryCommand:"3535869262"})),{key:ra,returnValue:w}=this.rn.c4f(w);return T}static Xjj(w){let T;if(!w||!w.length)return"0";const ea=w[0].ho;T=ea?(ea.Duration/1E3).toString():"0";let ra=!0;if(1<w.length)for(const wa of w)if((w=wa?wa.ho:null)||ea){if(!w&&ea||
w&&!ea){ra=!1;break}if(T!==(w.Duration/1E3).toString()){ra=!1;break}}ra||(T="0");return T}static W4d(w,T,ea){w=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',w,ea);T=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',T);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',w,T)}static wSa(w,T,ea,ra,wa,Za,ub){return Object.assign(new me.a,{Id:w,ExternalId:T,
Icon:ea,Command:ra,QueryCommand:wa,LabelText:Za,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:ub})}}Object(n.a)(Da,"TransitionActor",null,[352]);var Wa=d(1019);class ib{constructor(){this.effectId=this.effectType=0;this.labelText=this.Se=this.En=this.Sn=null}}Object(n.a)(ib,"AnimInfo",null,[]);class nb{constructor(){this.Gj=this.labelText=this.Se=this.id=null}}Object(n.a)(nb,"EffectOption",null,[]);class jc extends nb{constructor(){super();
this.value=null}}Object(n.a)(jc,"EffectData",nb,[]);class cc{constructor(w){this.TVa=w;cc.Gl||(cc.Gl=new Wa.a,cc.Gl.add("FromBottom",Object.assign(new nb,{id:"FromBottom",Se:cc.ff("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Gj:CommonUIStrings.l_AnimationFromBottomKeytip})),cc.Gl.add("FromBottomLeft",Object.assign(new nb,{id:"FromBottomLeft",Se:cc.ff("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,Gj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),
cc.Gl.add("FromLeft",Object.assign(new nb,{id:"FromLeft",Se:cc.ff("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Gj:CommonUIStrings.l_AnimationFromLeftKeytip})),cc.Gl.add("FromTopLeft",Object.assign(new nb,{id:"FromTopLeft",Se:cc.ff("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Gj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),cc.Gl.add("FromTop",Object.assign(new nb,{id:"FromTop",Se:cc.ff("AnimEffectPropFromTop"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Gj:CommonUIStrings.l_AnimationFromTopKeytip})),cc.Gl.add("FromTopRight",Object.assign(new nb,{id:"FromTopRight",Se:cc.ff("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Gj:CommonUIStrings.l_AnimationFromTopRightKeytip})),cc.Gl.add("FromRight",Object.assign(new nb,{id:"FromRight",Se:cc.ff("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,Gj:CommonUIStrings.l_AnimationFromRightKeytip})),
cc.Gl.add("FromBottomRight",Object.assign(new nb,{id:"FromBottomRight",Se:cc.ff("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Gj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),cc.Gl.add("ToBottom",Object.assign(new nb,{id:"ToBottom",Se:cc.ff("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Gj:CommonUIStrings.l_AnimationFromBottomKeytip})),cc.Gl.add("ToBottomLeft",Object.assign(new nb,{id:"ToBottomLeft",Se:cc.ff("AnimEffectPropFromTopRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Gj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),cc.Gl.add("ToLeft",Object.assign(new nb,{id:"ToLeft",Se:cc.ff("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Gj:CommonUIStrings.l_AnimationFromLeftKeytip})),cc.Gl.add("ToTopLeft",Object.assign(new nb,{id:"ToTopLeft",Se:cc.ff("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,Gj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),
cc.Gl.add("ToTop",Object.assign(new nb,{id:"ToTop",Se:cc.ff("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Gj:CommonUIStrings.l_AnimationFromTopKeytip})),cc.Gl.add("ToTopRight",Object.assign(new nb,{id:"ToTopRight",Se:cc.ff("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Gj:CommonUIStrings.l_AnimationFromTopRightKeytip})),cc.Gl.add("ToRight",Object.assign(new nb,{id:"ToRight",Se:cc.ff("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,
Gj:CommonUIStrings.l_AnimationFromRightKeytip})),cc.Gl.add("ToBottomRight",Object.assign(new nb,{id:"ToBottomRight",Se:cc.ff("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Gj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),cc.Gl.add("Horizontal",Object.assign(new nb,{id:"Horizontal",Se:cc.ff("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Gj:CommonUIStrings.l_AnimationHorizontalKeytip})),cc.Gl.add("HorizontalIn",
Object.assign(new nb,{id:"HorizontalIn",Se:cc.ff("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Gj:CommonUIStrings.l_AnimationHorizontalInKeytip})),cc.Gl.add("HorizontalOut",Object.assign(new nb,{id:"HorizontalOut",Se:cc.ff("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,Gj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),cc.Gl.add("Vertical",Object.assign(new nb,{id:"Vertical",Se:cc.ff("AnimEffectPropVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Gj:CommonUIStrings.l_AnimationVerticalKeytip})),cc.Gl.add("VerticalIn",Object.assign(new nb,{id:"VerticalIn",Se:cc.ff("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Gj:CommonUIStrings.l_AnimationVerticalInKeytip})),cc.Gl.add("VerticalOut",Object.assign(new nb,{id:"VerticalOut",Se:cc.ff("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,Gj:CommonUIStrings.l_AnimationVerticalOutKeytip})),
cc.Gl.add("LeftDown",Object.assign(new nb,{id:"LeftDown",Se:cc.ff("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Gj:CommonUIStrings.l_AnimationLeftDownKeytip})),cc.Gl.add("LeftUp",Object.assign(new nb,{id:"LeftUp",Se:cc.ff("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,Gj:CommonUIStrings.l_AnimationLeftUpKeytip})),cc.Gl.add("RightDown",Object.assign(new nb,{id:"RightDown",Se:cc.ff("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,
Gj:CommonUIStrings.l_AnimationRightDownKeytip})),cc.Gl.add("RightUp",Object.assign(new nb,{id:"RightUp",Se:cc.ff("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Gj:CommonUIStrings.l_AnimationRightUpKeytip})),cc.Gl.add("In",Object.assign(new nb,{id:"In",Se:cc.ff("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,Gj:CommonUIStrings.l_AnimationInKeytip})),cc.Gl.add("InBottom",Object.assign(new nb,{id:"InBottom",Se:cc.ff("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Gj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),cc.Gl.add("InCenter",Object.assign(new nb,{id:"InCenter",Se:cc.ff("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Gj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),cc.Gl.add("InSlightly",Object.assign(new nb,{id:"InSlightly",Se:cc.ff("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Gj:CommonUIStrings.l_AnimationInSlightlyKeytip})),
cc.Gl.add("Out",Object.assign(new nb,{id:"Out",Se:cc.ff("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Gj:CommonUIStrings.l_AnimationOutKeytip})),cc.Gl.add("OutBottom",Object.assign(new nb,{id:"OutBottom",Se:cc.ff("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,Gj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),cc.Gl.add("OutCenter",Object.assign(new nb,{id:"OutCenter",Se:cc.ff("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,
Gj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),cc.Gl.add("OutSlightly",Object.assign(new nb,{id:"OutSlightly",Se:cc.ff("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Gj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),cc.Gl.add("FloatUp",Object.assign(new nb,{id:"FloatUp",Se:cc.ff("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,Gj:CommonUIStrings.l_AnimationOutKeytip})),cc.Gl.add("FloatDown",Object.assign(new nb,{id:"FloatDown",
Se:cc.ff("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Gj:CommonUIStrings.l_AnimationDownKeytip})),cc.Gl.add("ObjectCenter",Object.assign(new nb,{id:"ObjectCenter",Se:cc.ff("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Gj:CommonUIStrings.l_AnimationObjectCenterKeytip})),cc.Gl.add("SlideCenter",Object.assign(new nb,{id:"SlideCenter",Se:cc.ff("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,
Gj:CommonUIStrings.l_AnimationSlideCenterKeytip})),cc.Gl.add("ObjectCenterOut",Object.assign(new nb,{id:"ObjectCenterOut",Se:cc.ff("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Gj:CommonUIStrings.l_AnimationObjectCenterKeytip})),cc.Gl.add("SlideCenterOut",Object.assign(new nb,{id:"SlideCenterOut",Se:cc.ff("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Gj:CommonUIStrings.l_AnimationSlideCenterKeytip})),
cc.Gl.add("Clockwise",Object.assign(new nb,{id:"Clockwise",Se:cc.ff("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Gj:CommonUIStrings.l_AnimationClockWiseKeytip})),cc.Gl.add("CounterClockwise",Object.assign(new nb,{id:"CounterClockwise",Se:cc.ff("AnimEffectPropCounterclockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Gj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),cc.Gl.add("Across",Object.assign(new nb,{id:"Across",Se:cc.ff("AnimEffectPropHorizontal"),
labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Gj:CommonUIStrings.l_AnimationAcrossKeytip})),cc.Gl.add("Up",Object.assign(new nb,{id:"Up",Se:cc.ff("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Gj:CommonUIStrings.l_AnimationUpKeytip})),cc.Gl.add("Down",Object.assign(new nb,{id:"Down",Se:cc.ff("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,Gj:CommonUIStrings.l_AnimationDownKeytip})),cc.Gl.add("GrowShrinkHorizontal",Object.assign(new nb,
{id:"GrowShrinkHorizontal",Se:cc.ff("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Gj:CommonUIStrings.l_AnimationHorizontalKeytip})),cc.Gl.add("GrowShrinkVertical",Object.assign(new nb,{id:"GrowShrinkVertical",Se:cc.ff("AnimEffectPropGrowShrinkVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Gj:CommonUIStrings.l_AnimationVerticalKeytip})),cc.Gl.add("GrowShrinkBoth",Object.assign(new nb,{id:"GrowShrinkBoth",Se:cc.ff("AnimEffectPropBoth"),
labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Gj:CommonUIStrings.l_AnimationBothKeytip})));cc.YS||(cc.YS=new Wa.a,cc.YS.add("Spin_Quarter",Object.assign(new jc,{id:"Spin_Quarter",Se:cc.ff("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Gj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),cc.YS.add("Spin_Half",Object.assign(new jc,{id:"Spin_Half",Se:cc.ff("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Gj:CommonUIStrings.l_AnimationHalfSpinKeytip})),
cc.YS.add("Spin_Full",Object.assign(new jc,{id:"Spin_Full",Se:cc.ff("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Gj:CommonUIStrings.l_AnimationFullSpinKeytip})),cc.YS.add("Spin_Two",Object.assign(new jc,{id:"Spin_Two",Se:cc.ff("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,value:"720",Gj:CommonUIStrings.l_AnimationTwoSpinKeytip})),cc.YS.add("Transparency_25",Object.assign(new jc,{id:"Transparency_25",Se:cc.ff("AnimEffectPropTransparent25"),
labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Gj:CommonUIStrings.l_Animation25PerKeytip})),cc.YS.add("Transparency_50",Object.assign(new jc,{id:"Transparency_50",Se:cc.ff("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Gj:CommonUIStrings.l_Animation50PerKeytip})),cc.YS.add("Transparency_75",Object.assign(new jc,{id:"Transparency_75",Se:cc.ff("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,
value:"0.25",Gj:CommonUIStrings.l_Animation75PerKeytip})),cc.YS.add("Transparency_100",Object.assign(new jc,{id:"Transparency_100",Se:cc.ff("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Gj:CommonUIStrings.l_Animation100PerKeytip})),cc.YS.add("GrowShrink_Tiny",Object.assign(new jc,{id:"GrowShrink_Tiny",Se:cc.ff("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Gj:CommonUIStrings.l_AnimationTinyKeytip})),
cc.YS.add("GrowShrink_Smaller",Object.assign(new jc,{id:"GrowShrink_Smaller",Se:cc.ff("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Gj:CommonUIStrings.l_AnimationSmallerKeytip})),cc.YS.add("GrowShrink_Larger",Object.assign(new jc,{id:"GrowShrink_Larger",Se:cc.ff("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,value:"150",Gj:CommonUIStrings.l_AnimationLargerKeytip})),cc.YS.add("GrowShrink_Huge",Object.assign(new jc,
{id:"GrowShrink_Huge",Se:cc.ff("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Gj:CommonUIStrings.l_AnimationHugeKeytip})));if(!cc.jm)if(cc.jm=new Wa.a,cc.jm.add("Existing",Object.assign(new ib,{effectType:-1,effectId:-1,Se:cc.ff("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,Sn:[],En:[]})),cc.jm.add("None",Object.assign(new ib,{effectType:0,effectId:0,Se:cc.ff("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,Sn:[],En:[]})),cc.jm.add("Appear",
Object.assign(new ib,{effectType:0,effectId:1,Se:cc.ff("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,Sn:[],En:[]})),cc.jm.add("FadeIn",Object.assign(new ib,{effectType:0,effectId:10,Se:cc.ff("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,Sn:[],En:[]})),this.TVa){cc.jm.add("FlyIn",Object.assign(new ib,{effectType:0,effectId:2,Se:cc.ff("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,Sn:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),
En:[]}));cc.jm.add("Wipe",Object.assign(new ib,{effectType:0,effectId:22,Se:cc.ff("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,Sn:["FromBottom","FromLeft","FromRight","FromTop"],En:[]}));cc.jm.add("Zoom",Object.assign(new ib,{effectType:0,effectId:53,Se:cc.ff("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,Sn:["ObjectCenter","SlideCenter"],En:[]}));cc.jm.add("Checkerboard",Object.assign(new ib,{effectType:0,effectId:5,Se:cc.ff("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,
Sn:["Across","Down"],En:[]}));cc.jm.add("BasicZoom",Object.assign(new ib,{effectType:0,effectId:23,Se:cc.ff("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,Sn:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),En:[]}));cc.jm.add("Blinds",Object.assign(new ib,{effectType:0,effectId:3,Se:cc.ff("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,Sn:["Horizontal","Vertical"],En:[]}));let T;cc.jm.add("Box",(T=new ib,T.effectType=0,T.effectId=4,T.Se=cc.ff("AnimFxEntranceShape"),
T.labelText=ResourceStrings.L_AnimationBox,T.Sn=["In","Out"],T.En=[],T));let ea;cc.jm.add("PeekIn",(ea=new ib,ea.effectType=0,ea.effectId=12,ea.Se=cc.ff("AnimFxEntranceGeneric"),ea.labelText=ResourceStrings.L_AnimationPeekIn,ea.Sn=["FromBottom","FromLeft","FromRight","FromTop"],ea.En=[],ea));let ra;cc.jm.add("Expand",(ra=new ib,ra.effectType=0,ra.effectId=55,ra.Se=cc.ff("AnimFxEntranceGeneric"),ra.labelText=ResourceStrings.L_AnimationExpand,ra.Sn=[],ra.En=[],ra));let wa;cc.jm.add("GrowAndTurn",(wa=
new ib,wa.effectType=0,wa.effectId=31,wa.Se=cc.ff("AnimFxEntranceGrowAndTurn"),wa.labelText=ResourceStrings.L_AnimationGrowAndTurn,wa.Sn=[],wa.En=[],wa));let Za;cc.jm.add("RandomBars",(Za=new ib,Za.effectType=0,Za.effectId=14,Za.Se=cc.ff("AnimFxEntranceRandomBars"),Za.labelText=ResourceStrings.L_AnimationRandomBars,Za.Sn=["Horizontal","Vertical"],Za.En=[],Za));let ub;cc.jm.add("RiseUp",(ub=new ib,ub.effectType=0,ub.effectId=37,ub.Se=cc.ff("AnimFxEntranceGeneric"),ub.labelText=ResourceStrings.L_AnimationRiseUp,
ub.Sn=[],ub.En=[],ub));let zb;cc.jm.add("Split",(zb=new ib,zb.effectType=0,zb.effectId=16,zb.Se=cc.ff("AnimFxEntranceSplit"),zb.labelText=ResourceStrings.L_AnimationSplit,zb.Sn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],zb.En=[],zb));let tc;cc.jm.add("Strips",(tc=new ib,tc.effectType=0,tc.effectId=18,tc.Se=cc.ff("AnimFxEntranceGeneric"),tc.labelText=ResourceStrings.L_AnimationStrips,tc.Sn=["LeftDown","LeftUp","RightDown","RightUp"],tc.En=[],tc));let pc;cc.jm.add("Stretch",(pc=new ib,
pc.effectType=0,pc.effectId=17,pc.Se=cc.ff("AnimFxEntranceGeneric"),pc.labelText=ResourceStrings.L_AnimationStretch,pc.Sn=["Across","FromBottom","FromLeft","FromRight","FromTop"],pc.En=[],pc));let bc;cc.jm.add("Exit_Disappear",(bc=new ib,bc.effectType=1,bc.effectId=1,bc.Se=cc.ff("AnimFxExitDisappear"),bc.labelText=ResourceStrings.L_AnimationDisappear,bc.Sn=[],bc.En=[],bc));let yc;cc.jm.add("Exit_Fade",(yc=new ib,yc.effectType=1,yc.effectId=10,yc.Se=cc.ff("AnimFxExitFadeOut"),yc.labelText=ResourceStrings.L_AnimationFade,
yc.Sn=[],yc.En=[],yc));let $c;cc.jm.add("Exit_FlyOut",($c=new ib,$c.effectType=1,$c.effectId=2,$c.Se=cc.ff("AnimFxExitFlyOut"),$c.labelText=ResourceStrings.L_AnimationFlyOut,$c.Sn="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),$c.En=[],$c));let gd;cc.jm.add("Exit_Wipe",(gd=new ib,gd.effectType=1,gd.effectId=22,gd.Se=cc.ff("AnimFxExitWipe"),gd.labelText=ResourceStrings.L_AnimationWipe,gd.Sn=["FromBottom","FromLeft","FromRight","FromTop"],gd.En=[],gd));let md;
cc.jm.add("Exit_Zoom",(md=new ib,md.effectType=1,md.effectId=53,md.Se=cc.ff("AnimFxExitFadedZoom"),md.labelText=ResourceStrings.L_AnimationZoom,md.Sn=["ObjectCenterOut","SlideCenterOut"],md.En=[],md));let Sc;cc.jm.add("Exit_Checkerboard",(Sc=new ib,Sc.effectType=1,Sc.effectId=5,Sc.Se=cc.ff("AnimFxExitGeneric"),Sc.labelText=ResourceStrings.L_AnimationCheckerboard,Sc.Sn=["Across","Up"],Sc.En=[],Sc));let Zd;cc.jm.add("Exit_BasicZoom",(Zd=new ib,Zd.effectType=1,Zd.effectId=23,Zd.Se=cc.ff("AnimFxExitGeneric"),
Zd.labelText=ResourceStrings.L_AnimationBasicZoom,Zd.Sn="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),Zd.En=[],Zd));let Pe;cc.jm.add("Exit_Blinds",(Pe=new ib,Pe.effectType=1,Pe.effectId=3,Pe.Se=cc.ff("AnimFxExitGeneric"),Pe.labelText=ResourceStrings.L_AnimationBlinds,Pe.Sn=["Horizontal","Vertical"],Pe.En=[],Pe));let qe;cc.jm.add("Exit_Box",(qe=new ib,qe.effectType=1,qe.effectId=4,qe.Se=cc.ff("AnimFxExitShape"),qe.labelText=ResourceStrings.L_AnimationBox,qe.Sn=["In","Out"],qe.En=[],
qe));let cg;cc.jm.add("Exit_PeekOut",(cg=new ib,cg.effectType=1,cg.effectId=12,cg.Se=cc.ff("AnimFxExitGeneric"),cg.labelText=ResourceStrings.L_AnimationPeekOut,cg.Sn=["ToBottom","ToLeft","ToRight","ToTop"],cg.En=[],cg));let mg;cc.jm.add("Exit_RandomBars",(mg=new ib,mg.effectType=1,mg.effectId=14,mg.Se=cc.ff("AnimFxExitRandomBars"),mg.labelText=ResourceStrings.L_AnimationRandomBars,mg.Sn=["Horizontal","Vertical"],mg.En=[],mg));let Zf;cc.jm.add("Exit_Split",(Zf=new ib,Zf.effectType=1,Zf.effectId=16,
Zf.Se=cc.ff("AnimFxExitSplit"),Zf.labelText=ResourceStrings.L_AnimationSplit,Zf.Sn=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Zf.En=[],Zf));let Sj;cc.jm.add("Exit_Strips",(Sj=new ib,Sj.effectType=1,Sj.effectId=18,Sj.Se=cc.ff("AnimFxExitGeneric"),Sj.labelText=ResourceStrings.L_AnimationStrips,Sj.Sn=["LeftDown","LeftUp","RightDown","RightUp"],Sj.En=[],Sj));let Rk;cc.jm.add("Exit_Stretchy",(Rk=new ib,Rk.effectType=1,Rk.effectId=17,Rk.Se=cc.ff("AnimFxExitGeneric"),Rk.labelText=ResourceStrings.L_AnimationStretchy,
Rk.Sn=[],Rk.En=[],Rk));let Fj;cc.jm.add("Exit_Zoom",(Fj=new ib,Fj.effectType=1,Fj.effectId=53,Fj.Se=cc.ff("AnimFxExitFadedZoom"),Fj.labelText=ResourceStrings.L_AnimationZoom,Fj.Sn=["ObjectCenterOut","SlideCenterOut"],Fj.En=[],Fj));let Si;cc.jm.add("Emphasis_Spin",(Si=new ib,Si.effectType=2,Si.effectId=8,Si.Se=cc.ff("AnimFxEmphasisSpin"),Si.labelText=ResourceStrings.L_AnimationSpin,Si.Sn=["Clockwise","CounterClockwise"],Si.En=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],Si));let nk;cc.jm.add("Emphasis_Transparency",
(nk=new ib,nk.effectType=2,nk.effectId=9,nk.Se=cc.ff("AnimFxEmphasisTransparency"),nk.labelText=ResourceStrings.L_AnimationTransparency,nk.Sn=[],nk.En=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],nk));let Dk;cc.jm.add("Emphasis_GrowShrink",(Dk=new ib,Dk.effectType=2,Dk.effectId=6,Dk.Se=cc.ff("AnimFxEmphasisGrowShrink"),Dk.labelText=ResourceStrings.L_AnimationGrowShrink,Dk.Sn=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],Dk.En=["GrowShrink_Tiny","GrowShrink_Smaller",
"GrowShrink_Larger","GrowShrink_Huge"],Dk));let Zj;cc.jm.add("Emphasis_FillColor",(Zj=new ib,Zj.effectType=2,Zj.effectId=1,Zj.Se=cc.ff("AnimFxEmphasisChangeFillColor"),Zj.labelText=ResourceStrings.L_AnimationFillColor,Zj.Sn=[],Zj.En=[],Zj));let Al;cc.jm.add("Emphasis_FontColor",(Al=new ib,Al.effectType=2,Al.effectId=3,Al.Se=cc.ff("AnimFxEmphasisChangeFontColor"),Al.labelText=ResourceStrings.L_AnimationFontColor,Al.Sn=[],Al.En=[],Al));let ak;cc.jm.add("Emphasis_LineColor",(ak=new ib,ak.effectType=
2,ak.effectId=7,ak.Se=cc.ff("AnimFxEmphasisChangeLineColor"),ak.labelText=ResourceStrings.L_AnimationLineColor,ak.Sn=[],ak.En=[],ak))}else cc.jm.add("FlyIn",Object.assign(new ib,{effectType:0,effectId:2,Se:cc.ff("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,Sn:["FromBottom","FromLeft","FromTop","FromRight"],En:[]}))}W4b(w,T){let ea=null;cc.jm.forEach((ra,wa)=>{wa.effectType===w&&wa.effectId===T&&(ea=wa);return!0});return ea}oUc(w,T){let ea=null;cc.jm.forEach((ra,wa)=>{wa.effectType===
w&&wa.effectId===T&&(ea=ra);return!0});return ea}QTc(w,T,ea,ra,wa){const Za=Object.assign(new Ma.a,{Id:"MenuSectionEffectOptions"+ea,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});w=this.W4b(T,w);if(!w)return Za;if((w=cc.L8i(w,ea))&&w.length)for(T=0;T<w.length;T++){const ub=cc.M8i(w[T],ea),zb="AnimationEffectOptions"+("Direction"===ea?"Direction":"Data")+ub.id;Array.add(Za.ControlList,Object.assign(new rd.a,{Command:ra,Id:ub.id,ExternalId:zb,QueryCommand:wa}))}return Za}oSc(w){var T;
return(T=cc.jm.ga(w))?(w=T.effectType,T=T.effectId,{returnValue:!0,effectType:w,effectId:T}):{returnValue:!1,effectType:-1,effectId:-1}}pSc(w){let T,ea;T=cc.ff("AnimFxMultiple");ea=ResourceStrings.L_AnimationExisting;if(w=cc.jm.ga(w))T=w.Se,ea=w.labelText;return{image:T,label:ea}}aZc(w,T){if(0===w){if(0!==T&&1!==T&&2!==T&&10!==T)return!0}else if(0<w)return!0;return!1}Cab(w,T){return w&&T?this.TVa?(T=T.pab()?w.IsTrigger:w.HasTrigger,!!this.W4b(w.EffectType,w.EffectId)&&!T):!w.HasExisting:!0}S_c(w){return w?
this.lzb(Array(w)):!0}lzb(w){if(!w||!w.length)return!0;for(const T of w)if(null==this.W4b(T.EffectType,T.EffectId))return!1;return!0}Bke(w,T){return T&&w&&this.TVa?T.pab()?!1:w.HasMultiple:!1}B9b(w){if(!w||!w.length)return!1;const T=w[0].EffectId,ea=w[0].EffectType;for(let ra=1;ra<w.length;ra++){const wa=w[ra];if(wa.EffectId!=T||wa.EffectType!=ea)return!0}return!1}bhg(w){if(w&&this.TVa&&2===w.EffectType)switch(w.EffectId){case 1:case 3:case 7:return!0}return!1}xme(w){if(!w)return!1;if(2===w.EffectType)switch(w.EffectId){case 1:case 3:case 7:return!0}return!1}C7i(w){w=
cc.jm.ga(w);return this.t5b(w.Sn[0])}z7i(w){return(w=cc.jm.ga(w))&&w.En.length?this.E6d(w.En[0]):""}t5b(w){switch(w){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;
case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;
case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;default:return 0}}E6d(w){return(w=cc.YS.ga(w))?w.value:""}kHf(w,T){return(T=cc.YS.ga(T))&&parseFloat(w)===parseFloat(T.value)?!0:!1}P9d(w){switch(w){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}Ooi(w){if(null===w)throw Error.argumentNull("animation");
const T=this.W4b(w.EffectType,w.EffectId);return!!T&&(0<T.Sn.length||0<T.En.length||this.bhg(w))}Poi(w){if(!w)return!1;const T=this.W4b(w.EffectType,w.EffectId);return!!T&&(0<T.Sn.length||0<T.En.length||this.xme(w))}Qoi(w,T,ea){return this.Cab(ea,w)&&!this.Bke(ea,w)&&(this.Ooi(ea)||this.HCf(w,T,ea)||this.RTd(w,T,ea)||this.FCf(w,T,ea)||this.STd(w,ea))}Roi(w,T,ea){if(!(w&&T&&ea&&ea.length&&this.lzb(ea)))return!1;w=cc.nJf(w,ea);T=this.ICf(T,w)||this.KCf(T,w)||this.GCf(T,w)||this.MCf(w);let ra;this.B9b(ea)||
(ra=this.Poi(ea[0]));return ra||T}wgj(w,T,ea){const ra=Object.assign(new Ma.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});this.HCf(w,T,ea)&&Array.add(ra.ControlList,Object.assign(new rd.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.FCf(w,T,ea)&&this.TVa&&Array.add(ra.ControlList,Object.assign(new rd.a,{Command:"2048458448",Id:"AllAtOnce",
ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.RTd(w,T,ea)&&Array.add(ra.ControlList,Object.assign(new rd.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.STd(w,ea)&&Array.add(ra.ControlList,Object.assign(new rd.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return ra}xgj(w,T,ea){const ra=new Ma.a;ra.Id="MenuSectionEffectOptionsSequence";
ra.ControlsId="MenuSectionEffectOptionsSequence.Controls";ra.DisplayMode="Menu32";ra.ControlList=[];if(!(w&&w.length&&T&&ea&&ea.length))return ra;w=cc.nJf(w,ea);this.ICf(T,w)&&(ea=new rd.a,ea.Command="1850236812",ea.Id="AsOneObject",ea.ExternalId="AnimationEffectOptionsSequenceAsOneObject",ea.QueryCommand="1125291975",ra.ControlList.push(ea));this.GCf(T,w)&&(ea=new rd.a,ea.Command="2048458448",ea.Id="AllAtOnce",ea.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",ea.QueryCommand="1125291975",ra.ControlList.push(ea));
this.KCf(T,w)&&(T=new rd.a,T.Command="3467781846",T.Id="ByParagraph",T.ExternalId="AnimationEffectOptionsSequenceByParagraph",T.QueryCommand="1125291975",ra.ControlList.push(T));this.MCf(w)&&(T=new rd.a,T.Command="1486892994",T.Id="OneByOne",T.ExternalId="AnimationEffectOptionsSequenceOneByOne",T.QueryCommand="1125291975",ra.ControlList.push(T));return ra}zTj(w){let T=!0,ea=0;if(!w)return!1;for(const ra of w)if(T)ea=ra.EffectId,T=!1;else if(ra.EffectId!==ea)return!1;return!0}hdj(w,T,ea){const ra=
{isEnabled:!1,Gkd:null};if(!w||!T||!T.length)return ra;w=cc.rcj(w);if(!w.length)return ra;const wa=w.map(Za=>Za.EffectNodeId);T=T.map(Za=>Za.EffectNodeId).sort((Za,ub)=>Za-ub);if(!cc.NTj(T,wa))return ra;if(ea){ea=wa.indexOf(T[T.length-1]);if(-1==ea||ea==wa.length-1)return ra;ra.isEnabled=!0;ra.Gkd=cc.I7f(w[ea+1])}else{ea=wa.indexOf(T[0]);if(-1==ea||0==ea)return ra;ra.isEnabled=!0;ra.Gkd=cc.I7f(w[ea-1])}return ra}static nJf(w,T){const ea=new Map;for(const ra of w)ea.set(ra.id.toString(),ra);w=new Map;
for(const ra of T)T=ue.a.Hf(ra.ShapeId),T=ea.get(T.toString()),w.set(ra,T);return w}static I7f(w){const T=new Qc;T.EffectNodeId=w.EffectNodeId;T.ShapeId=w.ShapeId;return T}static NTj(w,T){if(!(w&&w.length&&T&&T.length)||w.length>T.length)return!1;const ea=w[w.length-1],ra=T.indexOf(w[0]);return T.indexOf(ea)-ra+1==w.length}static rcj(w){const T=[];if(!w)return T;w=w.dW;if(!w||!w.Sequences)return T;for(const ea of w.Sequences[0].Effects)T.push(ea);return T.sort((ea,ra)=>ea.EffectNodeId-ra.EffectNodeId)}HCf(w,
T,ea){return 0!==ea.SequenceId&&0!==ea.EffectId&&this.Cab(ea,w)&&(w.Rf||2!==ea.EffectType||1!==ea.EffectId&&7!==ea.EffectId)&&(w.h4||this.STd(w,ea)||this.RTd(w,T,ea))}Toi(w,T,ea){return w&&0!==ea.BuildType&&0!==ea.EffectId&&this.S_c(ea)&&(w.Rf||2!==ea.EffectType||1!==ea.EffectId&&7!==ea.EffectId)&&(w.h4||this.LCf(w,ea)||this.JCf(w,T,ea))}ICf(w,T){for(let [ea,ra]of T)if(!this.Toi(ra,w,ea))return!1;return!0}FCf(w,T,ea){return 0!==ea.SequenceId&&!w.h4&&!w.ud&&0!==ea.EffectId&&this.Cab(ea,w)&&(w.Rf||
2!==ea.EffectType||1!==ea.EffectId&&7!==ea.EffectId)&&(w.fl||w.Rf||w.isEditable&&0<T.rda(w).length)}Soi(w,T,ea){return w&&0!==ea.BuildType&&!w.h4&&!w.ud&&0!==ea.EffectId&&this.S_c(ea)&&(w.Rf||2!==ea.EffectType||1!==ea.EffectId&&7!==ea.EffectId)&&(w.fl||w.Rf||w.isEditable&&0<T.rda(w).length)}GCf(w,T){for(let [ea,ra]of T)if(!this.Soi(ra,w,ea))return!1;return!0}RTd(w,T,ea){return 0!==ea.SequenceId&&!w.Rf&&!w.h4&&!w.ud&&0!==ea.EffectId&&this.Cab(ea,w)&&(2!==ea.EffectType||1!==ea.EffectId&&7!==ea.EffectId)&&
(w.fl||w.isEditable&&0<T.rda(w).length)}JCf(w,T,ea){return w&&0!==ea.BuildType&&!w.Rf&&!w.h4&&!w.ud&&0!==ea.EffectId&&this.S_c(ea)&&(2!==ea.EffectType||1!==ea.EffectId&&7!==ea.EffectId)&&(w.fl||w.isEditable&&0<T.rda(w).length)}KCf(w,T){for(let [ea,ra]of T)if(!this.JCf(ra,w,ea))return!1;return!0}STd(w,T){return 0!==T.SequenceId&&w.Rf&&0!==T.EffectId&&this.Cab(T,w)}LCf(w,T){return w&&0!==T.BuildType&&w.Rf&&0!==T.EffectId&&this.S_c(T)}MCf(w){for(let [T,ea]of w)if(!this.LCf(ea,T))return!1;return!0}static ff(w){return Uc.a.ylc+
"_"+w+"_32x32x32"}static L8i(w,T){switch(T){case "Direction":return w.Sn;case "EffectData":return w.En;default:return null}}static M8i(w,T){switch(T){case "Direction":return cc.Gl.ga(w);case "EffectData":return cc.YS.ga(w);default:return null}}}cc.Gl=null;cc.YS=null;cc.jm=null;Object(n.a)(cc,"AnimationHelper",null,[596]);class Ad{constructor(w,T,ea,ra,wa,Za,ub){this.lE=null;this.B0e=!1;this.zHa=ea;this.pa=w;(this.Cva=ra)&&wa.execute(zb=>{this.lE=zb});this.ta=ub;this.ia=T;this.bma=Za}selectShape(){this.pa&&
!this.pa.fX(this.ta)&&this.pa.selectShape(this.ta,!0)}onVolumeChanged(w){const T={ActionFromPlayer:!0};.2>=w?(T.SourceControlId="SetVolumeLow",this.ia.La(Rc.a.xpd,2,T)):.2<w&&.8>w?(T.SourceControlId="SetVolumeMedium",this.ia.La(Rc.a.ypd,2,T)):.8<=w&&(T.SourceControlId="SetVolumeHigh",this.ia.La(Rc.a.wpd,2,T));this.selectShape()}onPlayToggled(w){const T={ActionFromPlayer:!0};w?this.ia.La(Rc.a.NHc,2,T):this.ia.La(Rc.a.zZb,2,T);this.selectShape()}onMuteToggled(w){if(w)this.ia.La(Rc.a.zpd,2,{ActionFromPlayer:!0,
SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(w){w&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(w){w||this.pa.Nle(this.ta)||(w=this.hL())&&w.showHidePlayer(!1)}onPlayerClicked(){this.Cva&&this.ia.processAction(Rc.a.WOb,2)}onPlayerError(w){Cc.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",w);w&&-1<w.indexOf("PIPELINE_ERROR_READ")&&
this.zHa.t8d(this.bma.podSessionId,this.ta).then(T=>{const ea=this.hL();ea&&ea.setAudioSrc(T)})}onKeyDown(w){w===Ue.a.Zlb?(w=this.hL())&&w.removeFocusFromPlayer():w===Ue.a.Sq&&(this.B0e=!0)}onBlur(){const w=this.hL();w&&(this.B0e?w.setFocusOnPlayer():w.removeFocusFromPlayer());this.B0e=!1}hL(){return this.Cva&&this.lE?this.lE.hL(this.ta):null}}Object(n.a)(Ad,"AudioLibraryCallback",null,[614]);class Xd{constructor(w,T,ea,ra,wa,Za){this.zHa=w;this.pa=T;this.ia=ea;this.Cva=ra;this.hcb=Za;this.bma=wa}$Bi(w){return new Ad(this.pa,
this.ia,this.zHa,this.Cva,this.hcb,this.bma,w)}}Object(n.a)(Xd,"AudioLibraryCallbackFactory",null,[560]);class xe{constructor(w,T,ea,ra){this.volume=w;this.mute=T;this.repeat=ea;this.rewind=ra}}Object(n.a)(xe,"MediaProperties",null,[]);class Ff{constructor(w,T,ea,ra){this.N5j=w;this.kye=T;this.zHa=ea;this.bma=ra}createAudioManager(w,T,ea){return new Promise((ra,wa)=>{this.kye("audioPlayback").then(()=>{window.self.audioPlayback?(Cc.a.J(512497818,801,50,"audio script is loaded successfully"),ra(this.aCi(w,
T,ea))):(Cc.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),wa("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(Za=>{Cc.a.J(512497817,801,10,"Failed to load audio script "+Za.toString());wa("Failed to load audio script ")})})}aCi(w,T,ea){const ra=T.media;let wa=null;ra&&(wa=new xe(ra.vlmField,ra.mteField,ra.repeatField,ra.rewindField));const Za=audioPlayback.pptAudioFactoryGlobal.createAudioManager(w,
ea,this.N5j.$Bi(T),wa);this.zHa.t8d(this.bma.podSessionId,T).then(ub=>{Za&&Za.setAudioSrc(ub)});return Za}}Object(n.a)(Ff,"AudioManagerFactory",null,[561]);var xg=d(1252);class Eg{constructor(){this.qBb=new xg.a}rTk(w,T){T&&this.qBb.$(T.id,w)}yFh(w){w&&this.qBb.Hb(w.id)&&(this.qBb.ga(w.id).dispose(),this.qBb.remove(w.id))}hL(w){return w&&this.qBb.Hb(w.id)?this.qBb.ga(w.id):null}}Object(n.a)(Eg,"AudioManagerStore",null,[559]);class De{iXj(w){return!De.Pwb(De.sIl)||w>De.R5e?!0:!1}static Pwb(w){return(w=
document.getElementById(w))?w:null}}De.sIl="PptRibbon.Design.ThemeVariants-MaxSize";De.R5e=4;Object(n.a)(De,"ThemeHelper",null,[587]);class zd{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=0}}Object(n.a)(zd,"EditTransitionInfo",null,[]);class Gd{constructor(){this.next=this.parent=this.tc=this.Ix=this.uc=this.pc=null}}Object(n.a)(Gd,"Transition",null,[]);class fd{}fd.none=0;fd.WZi=5;fd.XZi=4;fd.cvl=1;fd.xpj=1;fd.Thi=2;fd.A8=0;fd.rSa=1;fd.NDa=2;fd.Xvb=3;fd.RQc=
4;fd.QQc=5;fd.UQc=6;fd.TQc=7;fd.aVc=2;fd.oUa=1;fd.mpj=1;fd.$Sd=0;fd.Qli=1;fd.Pli=2;fd.opj=0;fd.npj=1;fd.r9f=2;fd.ypj=3;fd.Gae=0;fd.Y6b=1;fd.$Uc=0;fd.t$a=1;fd.mii=1;fd.wzf=0;fd.kxh=2;fd.vol=0;fd.evl=3;fd.dvl=1;fd.wheel=1;fd.Rlh=29;fd.oYf=0;fd.m0i=1;fd.v0i=2;fd.F0i=3;fd.nYf=8;fd.l0i=9;fd.u0i=10;fd.E0i=11;fd.pYf=12;fd.p0i=13;fd.x0i=14;fd.I0i=15;fd.qYf=4;fd.q0i=5;fd.y0i=6;fd.J0i=7;fd.w0i=0;fd.G0i=1;fd.A0i=2;fd.n0i=3;fd.jYf=4;fd.H0i=5;fd.B0i=6;fd.o0i=7;Object(n.a)(fd,"TransitionEffectOptions",null,[]);
class Mc{constructor(w,T){let ea=0;this.Ac=new Wa.a;this.VGa=T;this.Ac.$("TransitionExisting",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionExisting,uc:Mc.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Ac.$("TransitionExistingInMenu",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionExisting,uc:Mc.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Ac.$("TransitionNone",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionNone,uc:Mc.Gc("TransitionNone"),tc:Object.assign(new zd,
{TransitionType:Z.none,Direction:fd.Thi,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Ac.$("TransitionFade",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFade,uc:Mc.Gc("TransitionFadeSmoothly"),tc:Object.assign(new zd,{TransitionType:Z.Pvf,Direction:fd.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Ac.$("TransitionFadeSmoothly",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionSmoothly,Ix:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,
uc:Mc.Gc("TransitionFadeSmoothly"),tc:Object.assign(new zd,{TransitionType:Z.Pvf,Direction:fd.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Ac.$("TransitionFadeThroughBlack",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionThroughBlack,Ix:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,uc:Mc.Gc("TransitionFadeThroughBlack"),tc:Object.assign(new zd,{TransitionType:Z.fade,Direction:fd.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));
let ra=[];if(w){ra=w.toLowerCase().split(",");for(let wa=0;wa<ra.length;wa++)ra[wa]=ra[wa].trim()}Array.contains(ra,"push")||(this.Ac.$("TransitionPush",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionPush,uc:Mc.Gc("TransitionPushUp"),tc:Object.assign(new zd,{TransitionType:Z.push,Direction:fd.rSa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Ac.$("TransitionPushFromBottom",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottom,Ix:CommonUIStrings.l_TransitionPushFromBottomKeytip,
uc:Mc.Gc("TransitionPushUp"),tc:Object.assign(new zd,{TransitionType:Z.push,Direction:fd.rSa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Ac.$("TransitionPushFromLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromLeft,Ix:CommonUIStrings.l_TransitionPushFromLeftKeytip,uc:Mc.Gc("TransitionPushRight"),tc:Object.assign(new zd,{TransitionType:Z.push,Direction:fd.NDa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),
this.Ac.$("TransitionPushFromRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromRight,Ix:CommonUIStrings.l_TransitionPushFromRightKeytip,uc:Mc.Gc("TransitionPushLeft"),tc:Object.assign(new zd,{TransitionType:Z.push,Direction:fd.A8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Ac.$("TransitionPushFromTop",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTop,Ix:CommonUIStrings.l_TransitionPushFromTopKeytip,uc:Mc.Gc("TransitionPushDown"),
tc:Object.assign(new zd,{TransitionType:Z.push,Direction:fd.Xvb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(ra,"cut")||(this.Ac.$("TransitionCut",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionCut,uc:Mc.Gc("TransitionCut"),tc:Object.assign(new zd,{TransitionType:Z.cut,Direction:fd.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Ac.$("TransitionCutNone",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionNone,Ix:CommonUIStrings.l_TransitionCutNoneKeytip,
uc:Mc.Gc("TransitionCut"),tc:Object.assign(new zd,{TransitionType:Z.cut,Direction:fd.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.Ac.$("TransitionCutThroughBlack",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionThroughBlack,Ix:CommonUIStrings.l_TransitionCutThroughBlackKeytip,uc:Mc.Gc("TransitionCutThroughBlack"),tc:Object.assign(new zd,{TransitionType:Z.cut,Direction:fd.cvl,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));
Array.contains(ra,"wipe")||(this.Ac.$("TransitionWipe",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionWipe,uc:Mc.Gc("TransitionWipeLeft"),tc:Object.assign(new zd,{TransitionType:Z.wipe,Direction:fd.A8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Ac.$("TransitionWipeFromRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromRight,Ix:CommonUIStrings.l_TransitionWipeFromRightKeytip,uc:Mc.Gc("TransitionWipeLeft"),tc:Object.assign(new zd,
{TransitionType:Z.wipe,Direction:fd.A8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Ac.$("TransitionWipeFromTop",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTop,Ix:CommonUIStrings.l_TransitionWipeFromTopKeytip,uc:Mc.Gc("TransitionWipeDown"),tc:Object.assign(new zd,{TransitionType:Z.wipe,Direction:fd.Xvb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Ac.$("TransitionWipeFromLeft",Object.assign(new Gd,
{pc:ResourceStrings.L_TransitionFromLeft,Ix:CommonUIStrings.l_TransitionWipeFromLeftKeytip,uc:Mc.Gc("TransitionWipeRight"),tc:Object.assign(new zd,{TransitionType:Z.wipe,Direction:fd.NDa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Ac.$("TransitionWipeFromBottom",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottom,Ix:CommonUIStrings.l_TransitionWipeFromBottomKeytip,uc:Mc.Gc("TransitionWipeUp"),tc:Object.assign(new zd,{TransitionType:Z.wipe,
Direction:fd.rSa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Ac.$("TransitionWipeFromTopRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTopRight,Ix:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,uc:Mc.Gc("TransitionStripsLeftDown"),tc:Object.assign(new zd,{TransitionType:Z.Hvd,Direction:fd.UQc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Ac.$("TransitionWipeFromBottomRight",
Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottomRight,Ix:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,uc:Mc.Gc("TransitionStripsLeftUp"),tc:Object.assign(new zd,{TransitionType:Z.Hvd,Direction:fd.RQc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Ac.$("TransitionWipeFromTopLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTopLeft,Ix:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,uc:Mc.Gc("TransitionStripsRightDown"),
tc:Object.assign(new zd,{TransitionType:Z.Hvd,Direction:fd.TQc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Ac.$("TransitionWipeFromBottomLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottomLeft,Ix:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,uc:Mc.Gc("TransitionStripsRightUp"),tc:Object.assign(new zd,{TransitionType:Z.Hvd,Direction:fd.QQc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));this.VGa&&Lf.a("MorphTransitionActionAIEnabled")&&
this.Ac.$("TransitionMorphActionAI",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionMorph,uc:Mc.Gc("TransitionByObject"),tc:Object.assign(new zd,{TransitionType:Z.morph,Direction:fd.$Sd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"}));Array.contains(ra,"morph")||(this.Ac.$("TransitionMorph",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionMorph,uc:Mc.Gc("TransitionByObject"),tc:Object.assign(new zd,{TransitionType:Z.morph,Direction:fd.$Sd,Duration:2E3,
IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Ac.$("TransitionMorphByObject",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionByObject,Ix:CommonUIStrings.l_TransitionMorphObjectsKeytip,uc:Mc.Gc("TransitionByObject"),tc:Object.assign(new zd,{TransitionType:Z.morph,Direction:fd.$Sd,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Ac.$("TransitionMorphByWord",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionByWord,
Ix:CommonUIStrings.l_TransitionMorphWordsKeytip,uc:Mc.Gc("TransitionByWord"),tc:Object.assign(new zd,{TransitionType:Z.morph,Direction:fd.Qli,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Ac.$("TransitionMorphByChar",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionByChar,Ix:CommonUIStrings.l_TransitionMorphCharactersKeytip,uc:Mc.Gc("TransitionByChar"),tc:Object.assign(new zd,{TransitionType:Z.morph,Direction:fd.Pli,Duration:2E3,IsManualAdvance:!0}),
parent:"TransitionMorph"})));Array.contains(ra,"split")||(this.Ac.$("TransitionSplit",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionSplit,uc:Mc.Gc("TransitionSplitOutVertical"),tc:Object.assign(new zd,{TransitionType:Z.split,Direction:fd.r9f,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.Ac.$("TransitionSplitVerticalOut",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionVerticalOut,Ix:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,
uc:Mc.Gc("TransitionSplitOutVertical"),tc:Object.assign(new zd,{TransitionType:Z.split,Direction:fd.r9f,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Ac.$("TransitionSplitHorizontalIn",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionHorizontalIn,Ix:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,uc:Mc.Gc("TransitionSplitInHorizontal"),tc:Object.assign(new zd,{TransitionType:Z.split,Direction:fd.npj,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Ac.$("TransitionSplitHorizontalOut",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionHorizontalOut,Ix:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,uc:Mc.Gc("TransitionSplitOutHorizontal"),tc:Object.assign(new zd,{TransitionType:Z.split,Direction:fd.opj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Ac.$("TransitionSplitVerticalIn",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionVerticalIn,
Ix:CommonUIStrings.l_TransitionSplitVerticalInKeytip,uc:Mc.Gc("TransitionSplitInVertical"),tc:Object.assign(new zd,{TransitionType:Z.split,Direction:fd.ypj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(ra,"randombars")){this.Ac.$("TransitionRandomBars",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionRandomBars,uc:Mc.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new zd,{TransitionType:Z.nPe,Direction:fd.t$a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",
next:"TransitionRandomBarsVertical"}));this.Ac.$("TransitionRandomBarsVertical",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionVertical,Ix:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,uc:Mc.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new zd,{TransitionType:Z.nPe,Direction:fd.t$a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let wa,Za;this.Ac.$("TransitionRandomBarsHorizontal",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionHorizontal,
Za.Ix=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Za.uc=Mc.Gc("TransitionRandomBarsHorizontal"),Za.tc=(wa=new zd,wa.TransitionType=Z.nPe,wa.Direction=fd.$Uc,wa.Duration=1E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionRandomBars",Za))}if(!Array.contains(ra,"shape")){let wa,Za;this.Ac.$("TransitionShape",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionShape,Za.uc=Mc.Gc("TransitionShapeCircle"),Za.tc=(wa=new zd,wa.TransitionType=Z.Csh,wa.Direction=fd.none,wa.Duration=800,wa.IsManualAdvance=
!0,wa),Za.parent="TransitionShape",Za.next="TransitionShapeCircle",Za));let ub,zb;this.Ac.$("TransitionShapeCircle",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionCircle,zb.Ix=CommonUIStrings.l_TransitionShapeCircleKeytip,zb.uc=Mc.Gc("TransitionShapeCircle"),zb.tc=(ub=new zd,ub.TransitionType=Z.Csh,ub.Direction=fd.none,ub.Duration=800,ub.IsManualAdvance=!0,ub),zb.parent="TransitionShape",zb.next="TransitionShapeDiamond",zb));let tc,pc;this.Ac.$("TransitionShapeDiamond",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionDiamond,
pc.Ix=CommonUIStrings.l_TransitionShapeDiamondKeytip,pc.uc=Mc.Gc("TransitionShapeDiamond"),pc.tc=(tc=new zd,tc.TransitionType=Z.Ofl,tc.Direction=fd.none,tc.Duration=800,tc.IsManualAdvance=!0,tc),pc.parent="TransitionShape",pc.next="TransitionShapePlus",pc));let bc,yc;this.Ac.$("TransitionShapePlus",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionPlus,yc.Ix=CommonUIStrings.l_TransitionShapePlusKeytip,yc.uc=Mc.Gc("TransitionShapePlus"),yc.tc=(bc=new zd,bc.TransitionType=Z.Tfl,bc.Direction=fd.none,bc.Duration=
1E3,bc.IsManualAdvance=!0,bc),yc.parent="TransitionShape",yc.next="TransitionShapeIn",yc));let $c,gd;this.Ac.$("TransitionShapeIn",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionIn,gd.Ix=CommonUIStrings.l_TransitionShapeInKeytip,gd.uc=Mc.Gc("TransitionBoxIn"),gd.tc=($c=new zd,$c.TransitionType=Z.Fsh,$c.Direction=fd.Y6b,$c.Duration=1200,$c.IsManualAdvance=!0,$c),gd.parent="TransitionShape",gd.next="TransitionShapeOut",gd));let md,Sc;this.Ac.$("TransitionShapeOut",(Sc=new Gd,Sc.pc=ResourceStrings.L_TransitionOut,
Sc.Ix=CommonUIStrings.l_TransitionShapeOutKeytip,Sc.uc=Mc.Gc("TransitionBoxOut"),Sc.tc=(md=new zd,md.TransitionType=Z.Fsh,md.Direction=fd.Gae,md.Duration=1200,md.IsManualAdvance=!0,md),Sc.parent="TransitionShape",Sc))}if(!Array.contains(ra,"reveal")){let wa,Za;this.Ac.$("TransitionReveal",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionReveal,Za.uc=Mc.Gc("TransitionRevealSmoothlyFromRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.$oc,wa.Direction=fd.kxh,wa.Duration=3400,wa.IsManualAdvance=!0,wa),Za.parent=
"TransitionReveal",Za.next="TransitionRevealSmoothlyFromRight",Za));let ub,zb;this.Ac.$("TransitionRevealSmoothlyFromRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionSmoothlyFromRight,zb.uc=Mc.Gc("TransitionRevealSmoothlyFromRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.$oc,ub.Direction=fd.kxh,ub.Duration=3400,ub.IsManualAdvance=!0,ub),zb.parent="TransitionReveal",zb.next="TransitionRevealSmoothlyFromLeft",zb));let tc,pc;this.Ac.$("TransitionRevealSmoothlyFromLeft",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionSmoothlyFromLeft,
pc.uc=Mc.Gc("TransitionRevealSmoothlyFromLeft"),pc.tc=(tc=new zd,tc.TransitionType=Z.$oc,tc.Direction=fd.vol,tc.Duration=3400,tc.IsManualAdvance=!0,tc),pc.parent="TransitionReveal",pc.next="TransitionRevealFromRight",pc));let bc,yc;this.Ac.$("TransitionRevealFromRight",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionThroughBlackFromRight,yc.uc=Mc.Gc("TransitionRevealFromRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.$oc,bc.Direction=fd.evl,bc.Duration=3400,bc.IsManualAdvance=!0,bc),yc.parent="TransitionReveal",
yc.next="TransitionRevealFromLeft",yc));let $c,gd;this.Ac.$("TransitionRevealFromLeft",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionThroughBlackFromLeft,gd.uc=Mc.Gc("TransitionRevealFromLeft"),gd.tc=($c=new zd,$c.TransitionType=Z.$oc,$c.Direction=fd.dvl,$c.Duration=3400,$c.IsManualAdvance=!0,$c),gd.parent="TransitionReveal",gd))}if(!Array.contains(ra,"cover")){let wa,Za;this.Ac.$("TransitionCover",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionCover,Za.uc=Mc.Gc("TransitionCoverLeft"),Za.tc=(wa=new zd,
wa.TransitionType=Z.GCa,wa.Direction=fd.A8,wa.Duration=1E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionCover",Za.next="TransitionCoverFromRight",Za));let ub,zb;this.Ac.$("TransitionCoverFromRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionCoverLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.GCa,ub.Direction=fd.A8,ub.Duration=1E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionCover",zb.next="TransitionCoverFromTop",zb));let tc,pc;this.Ac.$("TransitionCoverFromTop",
(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromTop,pc.uc=Mc.Gc("TransitionCoverDown"),pc.tc=(tc=new zd,tc.TransitionType=Z.GCa,tc.Direction=fd.Xvb,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),pc.parent="TransitionCover",pc.next="TransitionCoverFromLeft",pc));let bc,yc;this.Ac.$("TransitionCoverFromLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromLeft,yc.uc=Mc.Gc("TransitionCoverRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.GCa,bc.Direction=fd.NDa,bc.Duration=1E3,bc.IsManualAdvance=!0,bc),yc.parent=
"TransitionCover",yc.next="TransitionCoverFromBottom",yc));let $c,gd;this.Ac.$("TransitionCoverFromBottom",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromBottom,gd.uc=Mc.Gc("TransitionCoverUp"),gd.tc=($c=new zd,$c.TransitionType=Z.GCa,$c.Direction=fd.rSa,$c.Duration=1E3,$c.IsManualAdvance=!0,$c),gd.parent="TransitionCover",gd.next="TransitionCoverFromTopRight",gd));let md,Sc;this.Ac.$("TransitionCoverFromTopRight",(Sc=new Gd,Sc.pc=ResourceStrings.L_TransitionFromTopRight,Sc.uc=Mc.Gc("TransitionCoverLeftDown"),
Sc.tc=(md=new zd,md.TransitionType=Z.GCa,md.Direction=fd.UQc,md.Duration=1E3,md.IsManualAdvance=!0,md),Sc.parent="TransitionCover",Sc.next="TransitionCoverFromBottomRight",Sc));let Zd,Pe;this.Ac.$("TransitionCoverFromBottomRight",(Pe=new Gd,Pe.pc=ResourceStrings.L_TransitionFromBottomRight,Pe.uc=Mc.Gc("TransitionCoverLeftUp"),Pe.tc=(Zd=new zd,Zd.TransitionType=Z.GCa,Zd.Direction=fd.RQc,Zd.Duration=1E3,Zd.IsManualAdvance=!0,Zd),Pe.parent="TransitionCover",Pe.next="TransitionCoverFromTopLeft",Pe));
let qe,cg;this.Ac.$("TransitionCoverFromTopLeft",(cg=new Gd,cg.pc=ResourceStrings.L_TransitionFromTopLeft,cg.uc=Mc.Gc("TransitionCoverRightDown"),cg.tc=(qe=new zd,qe.TransitionType=Z.GCa,qe.Direction=fd.TQc,qe.Duration=1E3,qe.IsManualAdvance=!0,qe),cg.parent="TransitionCover",cg.next="TransitionCoverFromBottomLeft",cg));let mg,Zf;this.Ac.$("TransitionCoverFromBottomLeft",(Zf=new Gd,Zf.pc=ResourceStrings.L_TransitionFromBottomLeft,Zf.uc=Mc.Gc("TransitionCoverRightUp"),Zf.tc=(mg=new zd,mg.TransitionType=
Z.GCa,mg.Direction=fd.QQc,mg.Duration=1E3,mg.IsManualAdvance=!0,mg),Zf.parent="TransitionCover",Zf))}if(!Array.contains(ra,"uncover")){let wa,Za;this.Ac.$("TransitionUncover",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionUncover,Za.uc=Mc.Gc("TransitionUncoverLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.hMa,wa.Direction=fd.A8,wa.Duration=750,wa.IsManualAdvance=!0,wa),Za.parent="TransitionUncover",Za.next="TransitionUncoverFromRight",Za));let ub,zb;this.Ac.$("TransitionUncoverFromRight",(zb=new Gd,zb.pc=
ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionUncoverLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.hMa,ub.Direction=fd.A8,ub.Duration=750,ub.IsManualAdvance=!0,ub),zb.parent="TransitionUncover",zb.next="TransitionUncoverFromTop",zb));let tc,pc;this.Ac.$("TransitionUncoverFromTop",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromTop,pc.uc=Mc.Gc("TransitionUncoverDown"),pc.tc=(tc=new zd,tc.TransitionType=Z.hMa,tc.Direction=fd.Xvb,tc.Duration=750,tc.IsManualAdvance=!0,tc),pc.parent="TransitionUncover",
pc.next="TransitionUncoverFromLeft",pc));let bc,yc;this.Ac.$("TransitionUncoverFromLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromLeft,yc.uc=Mc.Gc("TransitionUncoverRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.hMa,bc.Direction=fd.NDa,bc.Duration=750,bc.IsManualAdvance=!0,bc),yc.parent="TransitionUncover",yc.next="TransitionUncoverFromBottom",yc));let $c,gd;this.Ac.$("TransitionUncoverFromBottom",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromBottom,gd.uc=Mc.Gc("TransitionUncoverUp"),gd.tc=
($c=new zd,$c.TransitionType=Z.hMa,$c.Direction=fd.rSa,$c.Duration=750,$c.IsManualAdvance=!0,$c),gd.parent="TransitionUncover",gd.next="TransitionUncoverFromTopRight",gd));this.Ac.$("TransitionUncoverFromTopRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTopRight,uc:Mc.Gc("TransitionUncoverLeftDown"),tc:Object.assign(new zd,{TransitionType:Z.hMa,Direction:fd.UQc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Ac.$("TransitionUncoverFromBottomRight",
Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottomRight,uc:Mc.Gc("TransitionUncoverLeftUp"),tc:Object.assign(new zd,{TransitionType:Z.hMa,Direction:fd.RQc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.Ac.$("TransitionUncoverFromTopLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTopLeft,uc:Mc.Gc("TransitionUncoverRightDown"),tc:Object.assign(new zd,{TransitionType:Z.hMa,Direction:fd.TQc,Duration:750,IsManualAdvance:!0}),
parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Ac.$("TransitionUncoverFromBottomLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottomLeft,uc:Mc.Gc("TransitionUncoverRightUp"),tc:Object.assign(new zd,{TransitionType:Z.hMa,Direction:fd.QQc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(ra,"menusectionexciting")){if(!Array.contains(ra,"fallover")){this.Ac.$("TransitionFallOver",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFallOver,
uc:Mc.Gc("TransitionFallOverLeft"),tc:Object.assign(new zd,{TransitionType:Z.L2d,Direction:fd.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let wa,Za;this.Ac.$("TransitionFallOverLeft",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionGoLeft,Za.uc=Mc.Gc("TransitionFallOverLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.L2d,wa.Direction=fd.none,wa.Duration=2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionFallOver",Za.next="TransitionFallOverRight",Za));
let ub,zb;this.Ac.$("TransitionFallOverRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionGoRight,zb.uc=Mc.Gc("TransitionFallOverRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.L2d,ub.Direction=fd.oUa,ub.Duration=2E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionFallOver",zb))}if(!Array.contains(ra,"drape")){let wa,Za;this.Ac.$("TransitionDrape",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionDrape,Za.uc=Mc.Gc("TransitionDrapeLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.u0d,wa.Direction=fd.none,wa.Duration=
2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionDrape",Za.next="TransitionDrapeLeft",Za));let ub,zb;this.Ac.$("TransitionDrapeLeft",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionGoLeft,zb.uc=Mc.Gc("TransitionDrapeLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.u0d,ub.Direction=fd.none,ub.Duration=2E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionDrape",zb.next="TransitionDrapeRight",zb));let tc,pc;this.Ac.$("TransitionDrapeRight",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionGoRight,pc.uc=Mc.Gc("TransitionDrapeRight"),
pc.tc=(tc=new zd,tc.TransitionType=Z.u0d,tc.Direction=fd.oUa,tc.Duration=2E3,tc.IsManualAdvance=!0,tc),pc.parent="TransitionDrape",pc))}if(!Array.contains(ra,"curtains")){let wa,Za;this.Ac.$("TransitionCurtains",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionCurtains,Za.uc=Mc.Gc("TransitionCurtains"),Za.tc=(wa=new zd,wa.TransitionType=Z.TIi,wa.Direction=fd.none,wa.Duration=6E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionCurtains",Za))}if(!Array.contains(ra,"wind")){let wa,Za;this.Ac.$("TransitionWind",
(Za=new Gd,Za.pc=ResourceStrings.L_TransitionWind,Za.uc=Mc.Gc("TransitionWindRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.j6e,wa.Direction=fd.none,wa.Duration=2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionWind",Za.next="TransitionWindRight",Za));let ub,zb;this.Ac.$("TransitionWindRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionGoRight,zb.uc=Mc.Gc("TransitionWindRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.j6e,ub.Direction=fd.none,ub.Duration=2E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionWind",
zb.next="TransitionWindLeft",zb));let tc,pc;this.Ac.$("TransitionWindLeft",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionGoLeft,pc.uc=Mc.Gc("TransitionWindLeft"),pc.tc=(tc=new zd,tc.TransitionType=Z.j6e,tc.Direction=fd.oUa,tc.Duration=2E3,tc.IsManualAdvance=!0,tc),pc.parent="TransitionWind",pc))}if(!Array.contains(ra,"prestige")){let wa,Za;this.Ac.$("TransitionPrestige",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionPrestige,Za.uc=Mc.Gc("TransitionPrestige"),Za.tc=(wa=new zd,wa.TransitionType=Z.$Ik,
wa.Direction=fd.none,wa.Duration=2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionPrestige",Za))}if(!Array.contains(ra,"fracture")){let wa,Za;this.Ac.$("TransitionFracture",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionFracture,Za.uc=Mc.Gc("TransitionFracture"),Za.tc=(wa=new zd,wa.TransitionType=Z.V_i,wa.Direction=fd.none,wa.Duration=2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionFracture",Za))}if(!Array.contains(ra,"crush")){let wa,Za;this.Ac.$("TransitionCrush",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionCrush,
Za.uc=Mc.Gc("TransitionCrush"),Za.tc=(wa=new zd,wa.TransitionType=Z.iIi,wa.Direction=fd.none,wa.Duration=2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionCrush",Za))}if(!Array.contains(ra,"peeloff")){let wa,Za;this.Ac.$("TransitionPeelOff",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionPeelOff,Za.uc=Mc.Gc("TransitionPeelOffLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.gKe,wa.Direction=fd.none,wa.Duration=1250,wa.IsManualAdvance=!0,wa),Za.parent="TransitionPeelOff",Za.next="TransitionPeelOffLeft",Za));
let ub,zb;this.Ac.$("TransitionPeelOffLeft",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionGoLeft,zb.uc=Mc.Gc("TransitionPeelOffLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.gKe,ub.Direction=fd.none,ub.Duration=1250,ub.IsManualAdvance=!0,ub),zb.parent="TransitionPeelOff",zb.next="TransitionPeelOffRight",zb));let tc,pc;this.Ac.$("TransitionPeelOffRight",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionGoRight,pc.uc=Mc.Gc("TransitionPeelOffRight"),pc.tc=(tc=new zd,tc.TransitionType=Z.gKe,tc.Direction=fd.oUa,
tc.Duration=1250,tc.IsManualAdvance=!0,tc),pc.parent="TransitionPeelOff",pc))}if(!Array.contains(ra,"pagecurl")){let wa,Za;this.Ac.$("TransitionPageCurl",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionPageCurl,Za.uc=Mc.Gc("TransitionTwoPageCurlFromRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.BJe,wa.Direction=fd.none,wa.Duration=1250,wa.IsManualAdvance=!0,wa),Za.parent="TransitionPageCurl",Za.next="TransitionPageCurlDoubleLeft",Za));let ub,zb;this.Ac.$("TransitionPageCurlDoubleLeft",(zb=new Gd,zb.pc=
ResourceStrings.L_TransitionEffectOptionDoubleLeft,zb.uc=Mc.Gc("TransitionTwoPageCurlFromRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.BJe,ub.Direction=fd.none,ub.Duration=1250,ub.IsManualAdvance=!0,ub),zb.parent="TransitionPageCurl",zb.next="TransitionPageCurlDoubleRight",zb));let tc,pc;this.Ac.$("TransitionPageCurlDoubleRight",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionEffectOptionDoubleRight,pc.uc=Mc.Gc("TransitionTwoPageCurlFromLeft"),pc.tc=(tc=new zd,tc.TransitionType=Z.BJe,tc.Direction=fd.oUa,
tc.Duration=1250,tc.IsManualAdvance=!0,tc),pc.parent="TransitionPageCurl",pc.next="TransitionPageCurlSingleLeft",pc));let bc,yc;this.Ac.$("TransitionPageCurlSingleLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionEffectOptionSingleLeft,yc.uc=Mc.Gc("TransitionPageCurlFromRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.o8g,bc.Direction=fd.none,bc.Duration=1250,bc.IsManualAdvance=!0,bc),yc.parent="TransitionPageCurl",yc.next="TransitionPageCurlSingleRight",yc));let $c,gd;this.Ac.$("TransitionPageCurlSingleRight",
(gd=new Gd,gd.pc=ResourceStrings.L_TransitionEffectOptionSingleRight,gd.uc=Mc.Gc("TransitionPageCurlFromLeft"),gd.tc=($c=new zd,$c.TransitionType=Z.o8g,$c.Direction=fd.oUa,$c.Duration=1250,$c.IsManualAdvance=!0,$c),gd.parent="TransitionPageCurl",gd))}if(!Array.contains(ra,"airplane")){let wa,Za;this.Ac.$("TransitionAirplane",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionAirplane,Za.uc=Mc.Gc("TransitionAirplaneRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.hQd,wa.Direction=fd.none,wa.Duration=1250,wa.IsManualAdvance=
!0,wa),Za.parent="TransitionAirplane",Za.next="TransitionAirplaneRight",Za));let ub,zb;this.Ac.$("TransitionAirplaneRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionGoRight,zb.uc=Mc.Gc("TransitionAirplaneRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.hQd,ub.Direction=fd.none,ub.Duration=1250,ub.IsManualAdvance=!0,ub),zb.parent="TransitionAirplane",zb.next="TransitionAirplaneLeft",zb));let tc,pc;this.Ac.$("TransitionAirplaneLeft",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionGoLeft,pc.uc=Mc.Gc("TransitionAirplaneLeft"),
pc.tc=(tc=new zd,tc.TransitionType=Z.hQd,tc.Direction=fd.oUa,tc.Duration=1250,tc.IsManualAdvance=!0,tc),pc.parent="TransitionAirplane",pc))}if(!Array.contains(ra,"origami")){let wa,Za;this.Ac.$("TransitionOrigami",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionOrigami,Za.uc=Mc.Gc("TransitionOrigamiRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.pJe,wa.Direction=fd.none,wa.Duration=3250,wa.IsManualAdvance=!0,wa),Za.parent="TransitionOrigami",Za.next="TransitionOrigamiRight",Za));let ub,zb;this.Ac.$("TransitionOrigamiRight",
(zb=new Gd,zb.pc=ResourceStrings.L_TransitionGoRight,zb.uc=Mc.Gc("TransitionOrigamiRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.pJe,ub.Direction=fd.none,ub.Duration=3250,ub.IsManualAdvance=!0,ub),zb.parent="TransitionOrigami",zb.next="TransitionOrigamiLeft",zb));let tc,pc;this.Ac.$("TransitionOrigamiLeft",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionGoLeft,pc.uc=Mc.Gc("TransitionOrigamiLeft"),pc.tc=(tc=new zd,tc.TransitionType=Z.pJe,tc.Direction=fd.oUa,tc.Duration=3250,tc.IsManualAdvance=!0,tc),pc.parent=
"TransitionOrigami",pc))}Array.contains(ra,"dissolve")||this.Ac.$("TransitionDissolve",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionDissolve,uc:Mc.Gc("TransitionDissolve"),tc:Object.assign(new zd,{TransitionType:Z.dissolve,Direction:fd.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(ra,"checker")||(this.Ac.$("TransitionChecker",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionChecker,uc:Mc.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new zd,
{TransitionType:Z.TUd,Direction:fd.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Ac.$("TransitionCheckerFromLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromLeft,uc:Mc.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new zd,{TransitionType:Z.TUd,Direction:fd.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Ac.$("TransitionCheckerFromTop",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTop,
uc:Mc.Gc("TransitionCheckerboardDown"),tc:Object.assign(new zd,{TransitionType:Z.TUd,Direction:fd.mpj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(ra,"blinds")){this.Ac.$("TransitionBlinds",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionBlinds,uc:Mc.Gc("TransitionBlindsVertical"),tc:Object.assign(new zd,{TransitionType:Z.blinds,Direction:fd.wzf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let wa,Za;this.Ac.$("TransitionBlindsVertical",
(Za=new Gd,Za.pc=ResourceStrings.L_TransitionVertical,Za.uc=Mc.Gc("TransitionBlindsVertical"),Za.tc=(wa=new zd,wa.TransitionType=Z.blinds,wa.Direction=fd.wzf,wa.Duration=1600,wa.IsManualAdvance=!0,wa),Za.parent="TransitionBlinds",Za.next="TransitionBlindsHorizontal",Za));let ub,zb;this.Ac.$("TransitionBlindsHorizontal",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionHorizontal,zb.uc=Mc.Gc("TransitionBlindsHorizontal"),zb.tc=(ub=new zd,ub.TransitionType=Z.blinds,ub.Direction=fd.mii,ub.Duration=1600,ub.IsManualAdvance=
!0,ub),zb.parent="TransitionBlinds",zb))}if(!Array.contains(ra,"wheel")){let wa,Za;this.Ac.$("TransitionWheel",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionWheel,Za.uc=Mc.Gc("TransitionWheelClockwise1"),Za.tc=(wa=new zd,wa.TransitionType=Z.wheel,wa.Direction=fd.wheel,wa.Duration=1E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionWheel",Za.next="TransitionWheelClockwise",Za));let ub,zb;this.Ac.$("TransitionWheelClockwise",(zb=new Gd,zb.pc=ResourceStrings.l_TransitionWheelClockWise,zb.uc=Mc.Gc("TransitionWheelClockwise1"),
zb.tc=(ub=new zd,ub.TransitionType=Z.wheel,ub.Direction=fd.wheel,ub.Duration=1E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionWheel",zb.next="TransitionWheelCounterclockwise",zb));let tc,pc;this.Ac.$("TransitionWheelCounterclockwise",(pc=new Gd,pc.pc=ResourceStrings.l_TransitionWheelCounterClockWise,pc.uc=Mc.Gc("TransitionWheelCounterclockwise1"),pc.tc=(tc=new zd,tc.TransitionType=Z.OJl,tc.Direction=fd.wheel,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),pc.parent="TransitionWheel",pc.next="TransitionWheelWedge",
pc));let bc,yc;this.Ac.$("TransitionWheelWedge",(yc=new Gd,yc.pc=ResourceStrings.l_TransitionWheelWedge,yc.uc=Mc.Gc("TransitionWedge"),yc.tc=(bc=new zd,bc.TransitionType=Z.wedge,bc.Direction=fd.none,bc.Duration=1E3,bc.IsManualAdvance=!0,bc),yc.parent="TransitionWheel",yc))}if(!Array.contains(ra,"ripple")){let wa,Za;this.Ac.$("TransitionRipple",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionRipple,Za.uc=Mc.Gc("TransitionRipple"),Za.tc=(wa=new zd,wa.TransitionType=Z.OKb,wa.Direction=fd.Rlh,wa.Duration=
1400,wa.IsManualAdvance=!0,wa),Za.parent="TransitionRipple",Za.next="TransitionRippleCenter",Za));let ub,zb;this.Ac.$("TransitionRippleCenter",(zb=new Gd,zb.pc=ResourceStrings.L_EffectOptionsDirectionCenter,zb.uc=Mc.Gc("TransitionRipple"),zb.tc=(ub=new zd,ub.TransitionType=Z.OKb,ub.Direction=fd.Rlh,ub.Duration=1400,ub.IsManualAdvance=!0,ub),zb.parent="TransitionRipple",zb.next="TransitionRippleBottomLeft",zb));let tc,pc;this.Ac.$("TransitionRippleBottomLeft",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromBottomLeft,
pc.uc=Mc.Gc("TransitionRippleBottomLeft"),pc.tc=(tc=new zd,tc.TransitionType=Z.OKb,tc.Direction=fd.QQc,tc.Duration=1500,tc.IsManualAdvance=!0,tc),pc.parent="TransitionRipple",pc.next="TransitionRippleBottomRight",pc));let bc,yc;this.Ac.$("TransitionRippleBottomRight",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromBottomRight,yc.uc=Mc.Gc("TransitionRippleBottomRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.OKb,bc.Direction=fd.RQc,bc.Duration=1500,bc.IsManualAdvance=!0,bc),yc.parent="TransitionRipple",
yc.next="TransitionRippleTopRight",yc));let $c,gd;this.Ac.$("TransitionRippleTopRight",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromTopRight,gd.uc=Mc.Gc("TransitionRippleTopRight"),gd.tc=($c=new zd,$c.TransitionType=Z.OKb,$c.Direction=fd.UQc,$c.Duration=1500,$c.IsManualAdvance=!0,$c),gd.parent="TransitionRipple",gd.next="TransitionRippleTopLeft",gd));let md,Sc;this.Ac.$("TransitionRippleTopLeft",(Sc=new Gd,Sc.pc=ResourceStrings.L_TransitionFromTopLeft,Sc.uc=Mc.Gc("TransitionRippleTopLeft"),Sc.tc=
(md=new zd,md.TransitionType=Z.OKb,md.Direction=fd.TQc,md.Duration=1500,md.IsManualAdvance=!0,md),Sc.parent="TransitionRipple",Sc))}if(!Array.contains(ra,"glitter")){let wa,Za;this.Ac.$("TransitionGlitter",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionGlitter,Za.uc=Mc.Gc("TransitionGlitterHexagonLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.BEa,wa.Direction=fd.jYf,wa.Duration=3900,wa.IsManualAdvance=!0,wa),Za.parent="TransitionGlitter",Za.next="TransitionGlitterHexagonLeft",Za));let ub,zb;this.Ac.$("TransitionGlitterHexagonLeft",
(zb=new Gd,zb.pc=ResourceStrings.L_TransitionHexagonsFromLeft,zb.uc=Mc.Gc("TransitionGlitterHexagonLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.BEa,ub.Direction=fd.jYf,ub.Duration=3900,ub.IsManualAdvance=!0,ub),zb.parent="TransitionGlitter",zb.next="TransitionGlitterHexagonTop",zb));let tc,pc;this.Ac.$("TransitionGlitterHexagonTop",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionHexagonsFromTop,pc.uc=Mc.Gc("TransitionGlitterHexagonTop"),pc.tc=(tc=new zd,tc.TransitionType=Z.BEa,tc.Direction=fd.H0i,tc.Duration=
3900,tc.IsManualAdvance=!0,tc),pc.parent="TransitionGlitter",pc.next="TransitionGlitterHexagonRight",pc));let bc,yc;this.Ac.$("TransitionGlitterHexagonRight",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionHexagonsFromRight,yc.uc=Mc.Gc("TransitionGlitterHexagonRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.BEa,bc.Direction=fd.B0i,bc.Duration=3900,bc.IsManualAdvance=!0,bc),yc.parent="TransitionGlitter",yc.next="TransitionGlitterHexagonBottom",yc));let $c,gd;this.Ac.$("TransitionGlitterHexagonBottom",(gd=
new Gd,gd.pc=ResourceStrings.L_TransitionHexagonsFromBottom,gd.uc=Mc.Gc("TransitionGlitterHexagonBottom"),gd.tc=($c=new zd,$c.TransitionType=Z.BEa,$c.Direction=fd.o0i,$c.Duration=3900,$c.IsManualAdvance=!0,$c),gd.parent="TransitionGlitter",gd.next="TransitionGlitterDiamondLeft",gd));let md,Sc;this.Ac.$("TransitionGlitterDiamondLeft",(Sc=new Gd,Sc.pc=ResourceStrings.L_TransitionDiamondsFromLeft,Sc.uc=Mc.Gc("TransitionGlitterDiamondLeft"),Sc.tc=(md=new zd,md.TransitionType=Z.BEa,md.Direction=fd.w0i,
md.Duration=3900,md.IsManualAdvance=!0,md),Sc.parent="TransitionGlitter",Sc.next="TransitionGlitterDiamondTop",Sc));let Zd,Pe;this.Ac.$("TransitionGlitterDiamondTop",(Pe=new Gd,Pe.pc=ResourceStrings.L_TransitionDiamondsFromTop,Pe.uc=Mc.Gc("TransitionGlitterDiamondTop"),Pe.tc=(Zd=new zd,Zd.TransitionType=Z.BEa,Zd.Direction=fd.G0i,Zd.Duration=3900,Zd.IsManualAdvance=!0,Zd),Pe.parent="TransitionGlitter",Pe.next="TransitionGlitterDiamondRight",Pe));let qe,cg;this.Ac.$("TransitionGlitterDiamondRight",
(cg=new Gd,cg.pc=ResourceStrings.L_TransitionDiamondsFromRight,cg.uc=Mc.Gc("TransitionGlitterDiamondRight"),cg.tc=(qe=new zd,qe.TransitionType=Z.BEa,qe.Direction=fd.A0i,qe.Duration=3900,qe.IsManualAdvance=!0,qe),cg.parent="TransitionGlitter",cg.next="TransitionGlitterDiamondBottom",cg));let mg,Zf;this.Ac.$("TransitionGlitterDiamondBottom",(Zf=new Gd,Zf.pc=ResourceStrings.L_TransitionDiamondsFromBottom,Zf.uc=Mc.Gc("TransitionGlitterDiamondBottom"),Zf.tc=(mg=new zd,mg.TransitionType=Z.BEa,mg.Direction=
fd.n0i,mg.Duration=3900,mg.IsManualAdvance=!0,mg),Zf.parent="TransitionGlitter",Zf))}if(!Array.contains(ra,"vortex")){let wa,Za;this.Ac.$("TransitionVortex",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionVortex,Za.uc=Mc.Gc("TransitionVortexFromLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.Zuc,wa.Direction=fd.NDa,wa.Duration=4E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionVortex",Za.next="TransitionVortexFromLeft",Za));let ub,zb;this.Ac.$("TransitionVortexFromLeft",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromLeft,
zb.uc=Mc.Gc("TransitionVortexFromLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.Zuc,ub.Direction=fd.NDa,ub.Duration=4E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionVortex",zb.next="TransitionVortexFromTop",zb));let tc,pc;this.Ac.$("TransitionVortexFromTop",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromTop,pc.uc=Mc.Gc("TransitionVortexFromTop"),pc.tc=(tc=new zd,tc.TransitionType=Z.Zuc,tc.Direction=fd.Xvb,tc.Duration=4E3,tc.IsManualAdvance=!0,tc),pc.parent="TransitionVortex",pc.next="TransitionVortexFromRight",
pc));let bc,yc;this.Ac.$("TransitionVortexFromRight",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromRight,yc.uc=Mc.Gc("TransitionVortexFromRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.Zuc,bc.Direction=fd.A8,bc.Duration=4E3,bc.IsManualAdvance=!0,bc),yc.parent="TransitionVortex",yc.next="TransitionVortexFromBottom",yc));let $c,gd;this.Ac.$("TransitionVortexFromBottom",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromBottom,gd.uc=Mc.Gc("TransitionVortexFromBottom"),gd.tc=($c=new zd,$c.TransitionType=
Z.Zuc,$c.Direction=fd.rSa,$c.Duration=4E3,$c.IsManualAdvance=!0,$c),gd.parent="TransitionVortex",gd))}Array.contains(ra,"switch")||(this.Ac.$("TransitionSwitch",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionSwitch,uc:Mc.Gc("TransitionSwitchRight"),tc:Object.assign(new zd,{TransitionType:Z.q0e,Direction:fd.aVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Ac.$("TransitionSwitchRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionGoRight,
uc:Mc.Gc("TransitionSwitchRight"),tc:Object.assign(new zd,{TransitionType:Z.q0e,Direction:fd.aVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Ac.$("TransitionSwitchLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionGoLeft,uc:Mc.Gc("TransitionSwitchLeft"),tc:Object.assign(new zd,{TransitionType:Z.q0e,Direction:fd.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(ra,"flip")){this.Ac.$("TransitionFlip",
Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFlip,uc:Mc.Gc("TransitionFlipRight"),tc:Object.assign(new zd,{TransitionType:Z.flip,Direction:fd.aVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Ac.$("TransitionFlipRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionGoRight,uc:Mc.Gc("TransitionFlipRight"),tc:Object.assign(new zd,{TransitionType:Z.flip,Direction:fd.aVc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));
let wa,Za;this.Ac.$("TransitionFlipLeft",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionGoLeft,Za.uc=Mc.Gc("TransitionFlipLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.flip,wa.Direction=fd.none,wa.Duration=1250,wa.IsManualAdvance=!0,wa),Za.parent="TransitionFlip",Za))}if(!Array.contains(ra,"galleryicon")){let wa,Za;this.Ac.$("TransitionGalleryIcon",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionGallery,Za.uc=Mc.Gc("TransitionGalleryRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.S4d,wa.Direction=fd.A8,wa.Duration=
1600,wa.IsManualAdvance=!0,wa),Za.parent="TransitionGalleryIcon",Za.next="TransitionGalleryIconFromRight",Za));let ub,zb;this.Ac.$("TransitionGalleryIconFromRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionGalleryRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.S4d,ub.Direction=fd.A8,ub.Duration=1600,ub.IsManualAdvance=!0,ub),zb.parent="TransitionGalleryIcon",zb.next="TransitionGalleryIconFromLeft",zb));let tc,pc;this.Ac.$("TransitionGalleryIconFromLeft",(pc=new Gd,
pc.pc=ResourceStrings.L_TransitionFromLeft,pc.uc=Mc.Gc("TransitionGalleryLeft"),pc.tc=(tc=new zd,tc.TransitionType=Z.S4d,tc.Direction=fd.NDa,tc.Duration=1600,tc.IsManualAdvance=!0,tc),pc.parent="TransitionGalleryIcon",pc))}if(!Array.contains(ra,"cube")){let wa,Za;this.Ac.$("TransitionCube",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionCube,Za.uc=Mc.Gc("TransitionCubeFromRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.xM,wa.Direction=fd.oYf,wa.Duration=1200,wa.IsManualAdvance=!0,wa),Za.parent="TransitionCube",
Za.next="TransitionCubeFromRight",Za));let ub,zb;this.Ac.$("TransitionCubeFromRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionCubeFromRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.xM,ub.Direction=fd.oYf,ub.Duration=1200,ub.IsManualAdvance=!0,ub),zb.parent="TransitionCube",zb.next="TransitionCubeFromBottom",zb));let tc,pc;this.Ac.$("TransitionCubeFromBottom",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromBottom,pc.uc=Mc.Gc("TransitionCubeFromBottom"),pc.tc=(tc=
new zd,tc.TransitionType=Z.xM,tc.Direction=fd.m0i,tc.Duration=1200,tc.IsManualAdvance=!0,tc),pc.parent="TransitionCube",pc.next="TransitionCubeFromLeft",pc));let bc,yc;this.Ac.$("TransitionCubeFromLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromLeft,yc.uc=Mc.Gc("TransitionCubeFromLeft"),yc.tc=(bc=new zd,bc.TransitionType=Z.xM,bc.Direction=fd.v0i,bc.Duration=1200,bc.IsManualAdvance=!0,bc),yc.parent="TransitionCube",yc.next="TransitionCubeFromTop",yc));let $c,gd;this.Ac.$("TransitionCubeFromTop",
(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromTop,gd.uc=Mc.Gc("TransitionCubeFromTop"),gd.tc=($c=new zd,$c.TransitionType=Z.xM,$c.Direction=fd.F0i,$c.Duration=1200,$c.IsManualAdvance=!0,$c),gd.parent="TransitionCube",gd))}if(!Array.contains(ra,"doors")){let wa,Za;this.Ac.$("TransitionDoors",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionDoors,Za.uc=Mc.Gc("TransitionDoorsVertical"),Za.tc=(wa=new zd,wa.TransitionType=Z.m0d,wa.Direction=fd.t$a,wa.Duration=1400,wa.IsManualAdvance=!0,wa),Za.parent="TransitionDoors",
Za.next="TransitionDoorsVertical",Za));let ub,zb;this.Ac.$("TransitionDoorsVertical",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionVertical,zb.uc=Mc.Gc("TransitionDoorsVertical"),zb.tc=(ub=new zd,ub.TransitionType=Z.m0d,ub.Direction=fd.t$a,ub.Duration=1400,ub.IsManualAdvance=!0,ub),zb.parent="TransitionDoors",zb.next="TransitionDoorsHorizontal",zb));let tc,pc;this.Ac.$("TransitionDoorsHorizontal",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionHorizontal,pc.uc=Mc.Gc("TransitionDoorsHorizontal"),pc.tc=
(tc=new zd,tc.TransitionType=Z.m0d,tc.Direction=fd.$Uc,tc.Duration=1400,tc.IsManualAdvance=!0,tc),pc.parent="TransitionDoors",pc))}if(!Array.contains(ra,"box")){let wa,Za;this.Ac.$("TransitionBox",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionBox,Za.uc=Mc.Gc("TransitionBoxFromRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.xM,wa.Direction=fd.nYf,wa.Duration=1600,wa.IsManualAdvance=!0,wa),Za.parent="TransitionBox",Za.next="TransitionBoxFromRight",Za));let ub,zb;this.Ac.$("TransitionBoxFromRight",(zb=new Gd,
zb.pc=ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionBoxFromRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.xM,ub.Direction=fd.nYf,ub.Duration=1600,ub.IsManualAdvance=!0,ub),zb.parent="TransitionBox",zb.next="TransitionBoxFromBottom",zb));let tc,pc;this.Ac.$("TransitionBoxFromBottom",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromBottom,pc.uc=Mc.Gc("TransitionBoxFromBottom"),pc.tc=(tc=new zd,tc.TransitionType=Z.xM,tc.Direction=fd.l0i,tc.Duration=1600,tc.IsManualAdvance=!0,tc),pc.parent=
"TransitionBox",pc.next="TransitionBoxFromLeft",pc));let bc,yc;this.Ac.$("TransitionBoxFromLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromLeft,yc.uc=Mc.Gc("TransitionBoxFromLeft"),yc.tc=(bc=new zd,bc.TransitionType=Z.xM,bc.Direction=fd.u0i,bc.Duration=1600,bc.IsManualAdvance=!0,bc),yc.parent="TransitionBox",yc.next="TransitionBoxFromTop",yc));let $c,gd;this.Ac.$("TransitionBoxFromTop",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromTop,gd.uc=Mc.Gc("TransitionBoxFromTop"),gd.tc=($c=new zd,
$c.TransitionType=Z.xM,$c.Direction=fd.E0i,$c.Duration=1600,$c.IsManualAdvance=!0,$c),gd.parent="TransitionBox",gd))}if(!Array.contains(ra,"comb")){let wa,Za;this.Ac.$("TransitionComb",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionComb,Za.uc=Mc.Gc("TransitionCombHorizontal"),Za.tc=(wa=new zd,wa.TransitionType=Z.NVd,wa.Direction=fd.none,wa.Duration=1E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionComb",Za.next="TransitionCombHorizontal",Za));let ub,zb;this.Ac.$("TransitionCombHorizontal",(zb=new Gd,
zb.pc=ResourceStrings.L_TransitionHorizontal,zb.uc=Mc.Gc("TransitionCombHorizontal"),zb.tc=(ub=new zd,ub.TransitionType=Z.NVd,ub.Direction=fd.$Uc,ub.Duration=1E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionComb",zb.next="TransitionCombVertical",zb));let tc,pc;this.Ac.$("TransitionCombVertical",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionVertical,pc.uc=Mc.Gc("TransitionCombVertical"),pc.tc=(tc=new zd,tc.TransitionType=Z.NVd,tc.Direction=fd.t$a,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),pc.parent=
"TransitionComb",pc))}if(!Array.contains(ra,"zoom")){let wa,Za;this.Ac.$("TransitionZoom",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionZoom,Za.uc=Mc.Gc("TransitionZoomIn"),Za.tc=(wa=new zd,wa.TransitionType=Z.zoom,wa.Direction=fd.Y6b,wa.Duration=900,wa.IsManualAdvance=!0,wa),Za.parent="TransitionZoom",Za.next="TransitionZoomIn",Za));let ub,zb;this.Ac.$("TransitionZoomIn",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionIn,zb.uc=Mc.Gc("TransitionZoomIn"),zb.tc=(ub=new zd,ub.TransitionType=Z.zoom,ub.Direction=
fd.Y6b,ub.Duration=900,ub.IsManualAdvance=!0,ub),zb.parent="TransitionZoom",zb.next="TransitionZoomOut",zb));let tc,pc;this.Ac.$("TransitionZoomOut",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionOut,pc.uc=Mc.Gc("TransitionZoomOut"),pc.tc=(tc=new zd,tc.TransitionType=Z.zoom,tc.Direction=fd.Gae,tc.Duration=900,tc.IsManualAdvance=!0,tc),pc.parent="TransitionZoom",pc.next="TransitionZoomAndRotate",pc));let bc,yc;this.Ac.$("TransitionZoomAndRotate",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionZoomAndRotate,
yc.uc=Mc.Gc("TransitionNewsFlash"),yc.tc=(bc=new zd,bc.TransitionType=Z.cLl,bc.Direction=fd.none,bc.Duration=1500,bc.IsManualAdvance=!0,bc),yc.parent="TransitionZoom",yc))}if(!Array.contains(ra,"random")){let wa,Za;this.Ac.$("TransitionRandom",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionRandom,Za.uc=Mc.Gc("TransitionRandom"),Za.tc=(wa=new zd,wa.TransitionType=Z.random,wa.Direction=fd.xpj,wa.Duration=1500,wa.IsManualAdvance=!0,wa),Za.parent="TransitionRandom",Za))}}if(!Array.contains(ra,"menusectiondynamiccontent")){if(!Array.contains(ra,
"pan")){let wa,Za;this.Ac.$("TransitionPan",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionPan,Za.uc=Mc.Gc("TransitionPanFromBottom"),Za.tc=(wa=new zd,wa.TransitionType=Z.pan,wa.Direction=fd.rSa,wa.Duration=1300,wa.IsManualAdvance=!0,wa),Za.parent="TransitionPan",Za.next="TransitionPanFromBottom",Za));this.Ac.$("TransitionPanFromBottom",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromBottom,uc:Mc.Gc("TransitionPanFromBottom"),tc:Object.assign(new zd,{TransitionType:Z.pan,Direction:fd.rSa,Duration:1300,
IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Ac.$("TransitionPanFromLeft",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromLeft,uc:Mc.Gc("TransitionPanFromLeft"),tc:Object.assign(new zd,{TransitionType:Z.pan,Direction:fd.NDa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Ac.$("TransitionPanFromRight",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromRight,uc:Mc.Gc("TransitionPanFromRight"),tc:Object.assign(new zd,
{TransitionType:Z.pan,Direction:fd.A8,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Ac.$("TransitionPanFromTop",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionFromTop,uc:Mc.Gc("TransitionPanFromTop"),tc:Object.assign(new zd,{TransitionType:Z.pan,Direction:fd.Xvb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(ra,"conveyor")){this.Ac.$("TransitionConveyor",Object.assign(new Gd,{pc:ResourceStrings.L_TransitionConveyor,
uc:Mc.Gc("TransitionConveyorRight"),tc:Object.assign(new zd,{TransitionType:Z.aXd,Direction:fd.A8,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let wa,Za;this.Ac.$("TransitionConveyorFromRight",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionFromRight,Za.uc=Mc.Gc("TransitionConveyorRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.aXd,wa.Direction=fd.A8,wa.Duration=1600,wa.IsManualAdvance=!0,wa),Za.parent="TransitionConveyor",Za.next="TransitionConveyorFromLeft",
Za));let ub,zb;this.Ac.$("TransitionConveyorFromLeft",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromLeft,zb.uc=Mc.Gc("TransitionConveyorLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.aXd,ub.Direction=fd.NDa,ub.Duration=1600,ub.IsManualAdvance=!0,ub),zb.parent="TransitionConveyor",zb))}if(!Array.contains(ra,"rotate")){let wa,Za;this.Ac.$("TransitionRotate",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionRotate,Za.uc=Mc.Gc("TransitionRotateLeft"),Za.tc=(wa=new zd,wa.TransitionType=Z.xM,wa.Direction=fd.qYf,
wa.Duration=2E3,wa.IsManualAdvance=!0,wa),Za.parent="TransitionRotate",Za.next="TransitionRotateFromRight",Za));let ub,zb;this.Ac.$("TransitionRotateFromRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionRotateLeft"),zb.tc=(ub=new zd,ub.TransitionType=Z.xM,ub.Direction=fd.qYf,ub.Duration=2E3,ub.IsManualAdvance=!0,ub),zb.parent="TransitionRotate",zb.next="TransitionRotateFromBottom",zb));let tc,pc;this.Ac.$("TransitionRotateFromBottom",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromBottom,
pc.uc=Mc.Gc("TransitionRotateTop"),pc.tc=(tc=new zd,tc.TransitionType=Z.xM,tc.Direction=fd.q0i,tc.Duration=2E3,tc.IsManualAdvance=!0,tc),pc.parent="TransitionRotate",pc.next="TransitionRotateFromLeft",pc));let bc,yc;this.Ac.$("TransitionRotateFromLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromLeft,yc.uc=Mc.Gc("TransitionRotateRight"),yc.tc=(bc=new zd,bc.TransitionType=Z.xM,bc.Direction=fd.y0i,bc.Duration=2E3,bc.IsManualAdvance=!0,bc),yc.parent="TransitionRotate",yc.next="TransitionRotateFromTop",
yc));let $c,gd;this.Ac.$("TransitionRotateFromTop",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromTop,gd.uc=Mc.Gc("TransitionRotateBottom"),gd.tc=($c=new zd,$c.TransitionType=Z.xM,$c.Direction=fd.J0i,$c.Duration=2E3,$c.IsManualAdvance=!0,$c),gd.parent="TransitionRotate",gd))}if(!Array.contains(ra,"window")){let wa,Za;this.Ac.$("TransitionWindow",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionWindow,Za.uc=Mc.Gc("TransitionWindowVertical"),Za.tc=(wa=new zd,wa.TransitionType=Z.window,wa.Direction=fd.t$a,
wa.Duration=1500,wa.IsManualAdvance=!0,wa),Za.parent="TransitionWindow",Za.next="TransitionWindowVertical",Za));let ub,zb;this.Ac.$("TransitionWindowVertical",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionVertical,zb.uc=Mc.Gc("TransitionWindowVertical"),zb.tc=(ub=new zd,ub.TransitionType=Z.window,ub.Direction=fd.t$a,ub.Duration=1500,ub.IsManualAdvance=!0,ub),zb.parent="TransitionWindow",zb.next="TransitionWindowHorizontal",zb));let tc,pc;this.Ac.$("TransitionWindowHorizontal",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionHorizontal,
pc.uc=Mc.Gc("TransitionWindowHorizontal"),pc.tc=(tc=new zd,tc.TransitionType=Z.window,tc.Direction=fd.$Uc,tc.Duration=1500,tc.IsManualAdvance=!0,tc),pc.parent="TransitionWindow",pc))}if(!Array.contains(ra,"orbit")){let wa,Za;this.Ac.$("TransitionOrbit",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionOrbit,Za.uc=Mc.Gc("TransitionOrbitFromRight"),Za.tc=(wa=new zd,wa.TransitionType=Z.xM,wa.Direction=fd.pYf,wa.Duration=1600,wa.IsManualAdvance=!0,wa),Za.parent="TransitionOrbit",Za.next="TransitionOrbitFromRight",
Za));let ub,zb;this.Ac.$("TransitionOrbitFromRight",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionFromRight,zb.uc=Mc.Gc("TransitionOrbitFromRight"),zb.tc=(ub=new zd,ub.TransitionType=Z.xM,ub.Direction=fd.pYf,ub.Duration=1600,ub.IsManualAdvance=!0,ub),zb.parent="TransitionOrbit",zb.next="TransitionOrbitFromBottom",zb));let tc,pc;this.Ac.$("TransitionOrbitFromBottom",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionFromBottom,pc.uc=Mc.Gc("TransitionOrbitFromBottom"),pc.tc=(tc=new zd,tc.TransitionType=Z.xM,
tc.Direction=fd.p0i,tc.Duration=1600,tc.IsManualAdvance=!0,tc),pc.parent="TransitionOrbit",pc.next="TransitionOrbitFromLeft",pc));let bc,yc;this.Ac.$("TransitionOrbitFromLeft",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionFromLeft,yc.uc=Mc.Gc("TransitionOrbitFromLeft"),yc.tc=(bc=new zd,bc.TransitionType=Z.xM,bc.Direction=fd.x0i,bc.Duration=1600,bc.IsManualAdvance=!0,bc),yc.parent="TransitionOrbit",yc.next="TransitionOrbitFromTop",yc));let $c,gd;this.Ac.$("TransitionOrbitFromTop",(gd=new Gd,gd.pc=ResourceStrings.L_TransitionFromTop,
gd.uc=Mc.Gc("TransitionOrbitFromTop"),gd.tc=($c=new zd,$c.TransitionType=Z.xM,$c.Direction=fd.I0i,$c.Duration=1600,$c.IsManualAdvance=!0,$c),gd.parent="TransitionOrbit",gd))}if(!Array.contains(ra,"flythrough")){let wa,Za;this.Ac.$("TransitionFlyThrough",(Za=new Gd,Za.pc=ResourceStrings.L_TransitionFlyThrough,Za.uc=Mc.Gc("TransitionFlyThroughIn"),Za.tc=(wa=new zd,wa.TransitionType=Z.y4b,wa.Direction=fd.Y6b,wa.Duration=800,wa.IsManualAdvance=!0,wa),Za.parent="TransitionFlyThrough",Za.next="TransitionFlyThroughIn",
Za));let ub,zb;this.Ac.$("TransitionFlyThroughIn",(zb=new Gd,zb.pc=ResourceStrings.L_TransitionIn,zb.uc=Mc.Gc("TransitionFlyThroughIn"),zb.tc=(ub=new zd,ub.TransitionType=Z.y4b,ub.Direction=fd.Y6b,ub.Duration=800,ub.IsManualAdvance=!0,ub),zb.parent="TransitionFlyThrough",zb.next="TransitionFlyThroughOut",zb));let tc,pc;this.Ac.$("TransitionFlyThroughOut",(pc=new Gd,pc.pc=ResourceStrings.L_TransitionOut,pc.uc=Mc.Gc("TransitionFlyThroughOut"),pc.tc=(tc=new zd,tc.TransitionType=Z.y4b,tc.Direction=fd.Gae,
tc.Duration=800,tc.IsManualAdvance=!0,tc),pc.parent="TransitionFlyThrough",pc.next="TransitionFlyThroughInWithBounce",pc));let bc,yc;this.Ac.$("TransitionFlyThroughInWithBounce",(yc=new Gd,yc.pc=ResourceStrings.L_TransitionInWithBounce,yc.uc=Mc.Gc("TransitionFlyThroughIn"),yc.tc=(bc=new zd,bc.TransitionType=Z.y4b,bc.Direction=fd.WZi,bc.Duration=900,bc.IsManualAdvance=!0,bc),yc.parent="TransitionFlyThrough",yc.next="TransitionFlyThroughOutWithBounce",yc));let $c,gd;this.Ac.$("TransitionFlyThroughOutWithBounce",
(gd=new Gd,gd.pc=ResourceStrings.L_TransitionOutWithBounce,gd.uc=Mc.Gc("TransitionFlyThroughOut"),gd.tc=($c=new zd,$c.TransitionType=Z.y4b,$c.Direction=fd.XZi,$c.Duration=900,$c.IsManualAdvance=!0,$c),gd.parent="TransitionFlyThrough",gd))}}this.Ac.forEach((wa,Za)=>{wa===Za.parent&&++ea;return!0})}pTa(w){let T=null;w?this.Ac.forEach((ea,ra)=>{ra.tc&&ra.tc.TransitionType===w.TransitionType&&ra.tc.Direction===w.Direction&&(T=ea);return!0}):T="TransitionNone";return T}xQ(w){return this.Ac.ga(w)}Dxb(w){return(w=
this.pTa(w))?this.Ac.ga(this.Ac.ga(w).parent):null}qTa(w){return(w=this.pTa(w))?this.Ac.ga(w).parent:null}c4f(w){let T,ea=null;T=null;w&&w.next&&(T=w.next,ea=this.xQ(T));return{returnValue:ea,key:T}}Pwb(){var w=[Mc.U0i,Mc.lQk,Mc.mQk];for(const T of w)if(w=document.getElementById(T))return w;return null}w0c(w,T){return w&&T&&T.childNodes?w.startsWith(Mc.V0i)?T.contains(document.getElementById(w)):!1:!T&&w?"TransitionExisting"===w||"TransitionNone"===w||"TransitionMorph"===w||"TransitionCut"===w||"TransitionFade"===
w||"TransitionPush"===w||"TransitionWipe"===w:!1}static Gc(w){return Uc.a.ylc+"_"+w+"_32x32x32"}}Mc.U0i="PptRibbon.Transition.Gallery-MaxSize-1-0";Mc.lQk="Transitions";Mc.mQk="Transitions-previewWrapper";Mc.V0i="Transition";Object(n.a)(Mc,"TransitionHelper",null,[586]);var uk=d(236);class Ki{constructor(w){this.Y4e=(T,ea,ra,wa,Za)=>1===ra?32:Za?32:16;this.ia=w}wb(){this.ia.ra(Rc.a.$Fh,Ic.a.application,this.Y4e,4);this.ia.ra(Rc.a.lGh,Ic.a.application,this.Y4e,4);this.ia.ra(Rc.a.DHh,Ic.a.application,
this.Y4e,4)}Ee(){}}Object(n.a)(Ki,"PictureEnhancementActor",null,[352]);class bj{constructor(){this.nh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}Zb(w){this.K=w;this.nh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").kEa(0,this.name);this.K.register(558,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().oa(()=>new og(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").YP){const T=uk.a(this.K);
this.K.register(559,"PowerPointWebEditor.IAudioManagerStore").ma().oa(()=>new Eg);this.K.register(560,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().oa(()=>new Xd(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").YP,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Ja("PowerPointWebEditor.IAudioManagerStore")));
this.K.register(561,"PowerPointWebEditor.IAudioManagerFactory").ma().oa(()=>new Ff(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),T,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let w=this.nh.zu("resolve");var T=this.K.resolve("Common.AFrameworkApplication");const ea=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
ra=ea.od;T=T.wq;const wa=this.K.resolve("Common.IActionManagerExtended"),Za=this.K.resolve("PowerPointWebEditor.IFocusManager");T=T.Kd;const ub=this.K.resolve("Common.Transaction.ITransactionFactory"),zb=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),tc=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),pc=this.K.resolve("PowerPointWebEditor.PictureContext"),bc=this.K.resolve("PowerPoint.IPathManager");var yc=this.K.resolve("PowerPointWebEditor.IPresentationReader");
const $c=this.K.resolve("PowerPointWebEditor.IShapeReader"),gd=this.K.resolve("PowerPointWebEditor.IPictureUploader"),md=this.K.ie("PowerPointWebEditor.IPPTLanguageDialogFactory"),Sc=this.K.resolve("Box4.IParagraphReader");this.nh.Fu(w);w=this.nh.zu("regactors");yc=[new Td(wa,zb,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),Sc,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
$c,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),tf.App.RLa.uLc(12),ra.telemetryForPptParagraphSettingEnabled),new Vc(wa,Za,tc,ub,zb,bc,T,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yc,new De,ra.fkg,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled")),new Da(wa,T,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ub,zb,Za,new Mc(ra.cMa,this.K.resolve("PowerPointWebEditor.IApplicationSettings").cB),
tc,ra,bc,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];ra.zrb?yc.push(new ke(wa,zb,Za,ub,new cc(ra.lRd),tc,$c,bc,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))):yc.push(new bf(wa,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),zb,Za,ub,new cc(ra.lRd),tc,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),$c,bc));ra.powerPointFormatBackgroundEnabled&&yc.push(new bi(wa,Za,tc,zb,
ub,T,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),gd,pc,Q.AFrameworkApplication.PQ,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ra));ra.VXf&&yc.push(new Ki(wa));for(const Zd of yc)Zd.wb(),Zd.Ee();this.nh.Fu(w);Q.AFrameworkApplication.fa.gf(()=>{w=this.nh.zu("regfullactors");const Zd=[],Pe=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");Pe.VUa=this.K.resolve("Common.IAppSettingsManager").ka("299");ea.od.UIb&&Zd.push(new Aa(wa,md,Pe,this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.Ja("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),zb));this.K.resolve("PowerPointWebEditor.IApplicationSettings").y8b&&Zd.push(new bk(wa,Za,zb,uk.a(this.K)));for(const qe of Zd)qe.wb(),qe.Ee();Pe.VUa&&
(new Md(wa,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(qe,cg)=>new He(qe,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),cg,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),zb,this.K.resolve("Box4.ILanguageReader"),$c)).wb();this.nh.Fu(w)})}dispose(){}}Object(n.a)(bj,"AdvancedPackage",null,[2,3]);class wi{get container(){return ia.a.instance.resolve("PowerPointWebEditor.IRibbonPane").xa}}Object(n.a)(wi,"PPTFloatPaneContainer",null,
[505]);class za{constructor(w,T,ea=null){this.Nfb=new Wa.a(0);this.vZa=null;this.rhb=this.vZa=tf.App.Vm;this.Xte=w;this.wWg=1E3*T;this.fzg=ea||(()=>(new Date).getTime())}Rhi(w){this.Xte&&this.Nfb.add(w,(new Date).getTime())}ORf(w){this.Xte&&(this.Nfb.remove(w),this.Bwl(this.fzg()-this.wWg))}Bwl(w){if(this.Nfb.count){var T=[];this.Nfb.forEach((ea,ra)=>{ra<w&&T.push(ea);return!0});for(const ea of T)this.Nfb.remove(ea)}}get wig(){return this.rhb<=this.vZa}rxj(){if(!this.Xte||!this.Nfb.count)return!1;
let w=!1;const T=this.fzg();this.Nfb.forEach((ea,ra)=>T-ra<this.wWg?(w=!0,!1):!0);return w}}Object(n.a)(za,"PictureContext",null,[562]);var sb=d(902),Nb=d(437);class Ac{constructor(){this.Odb=this.pye=this.tGg=this.uGg=!1;this.nh=this.U4=this.gEb=this.PGg=this.K=null;this.Jcc=[new bj];this.OX=[]}get name(){return"PowerPointWebEditor.Chronos"}Zb(w){this.K=w;this.U4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.nh=this.U4.kEa(0,this.name);for(let T=0;T<this.Jcc.length;++T)Array.add(this.OX,
Cb.a(this.Jcc[T],0));for(const T of this.OX)T.Zb(w);Ac.xxi(w);this.K.register(za,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().oa(()=>new za(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}rkc(w,T){w=of.a.instance;for(let ra=0;ra<T.entries.length;ra++){var ea=T.entries[ra];ea.url=J.a.removeParameter(ea.url,
Q.AFrameworkApplication.WV);const wa=J.a.boa(ea.url);let Za=!1;if("about:blank"===ea.url||wa.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===wa&&"2"===J.a.hT(ea.url,"u")||this.Odb&&(Za=wa.endsWith("PowerPoint.ashx"))&&ea.url.endsWith("ib=1"))ea.behavior=1;else{if(Za||wa.endsWith("PowerPoint.ashx")||wa.endsWith("GetUpdates")||wa.endsWith("images.ashx")||wa.endsWith("GetThumb"))ea.behavior=2;if(!this.uGg&&wa.endsWith("PowerPoint.ashx")&&"true"===J.a.hT(ea.url,Lh.a.XBk))ea=ea.NB,w.ic(Lg.a.JWd,parseInt(String(ea.fetchStart))),
w.ic(Lg.a.Mzi,parseInt(String(ea.responseStart))),w.ic(Lg.a.Ezi,parseInt(String(ea.responseEnd-ea.responseStart))),this.uGg=!0;else if(!this.tGg&&wa.endsWith("PowerPoint.ashx")&&"true"===J.a.hT(ea.url,"dSlide")){this.tGg=!0;ea=ea.NB;w.ic("SlideImageFetchStart",parseInt(String(ea.fetchStart)));w.ic("SlideImageResponseStart",parseInt(String(ea.responseStart)));w.ic("SlideImageDownloadDuration",parseInt(String(ea.responseEnd-ea.responseStart)));let ub;({transferSize:ub}=Ac.CEh(ea)).returnValue&&w.ic("SlideImageSize",
ub)}else if(!this.pye&&wa.endsWith("images.ashx")&&"true"===J.a.hT(ea.url,"minimalboot")&&J.a.hT(ea.url,"index")===this.PGg){this.pye=!0;ea=ea.NB;w.ic("MBootFetchStart",parseInt(String(ea.fetchStart)));w.ic("MBootResponseStart",parseInt(String(ea.responseStart)));w.ic("MBootDownload",parseInt(String(ea.responseEnd-ea.responseStart)));let ub;({transferSize:ub}=Ac.CEh(ea)).returnValue&&w.ic("MBootSize",ub)}}}}wbl(){const w=window.self.FirstSlideRequestIndex;void 0===w||null===w?this.pye=!0:this.PGg=
w.toString()}init(){Cc.a.J(512497358,809,50,"ChronosPackage::Init");const w=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),T=this.K.resolve("Common.ITaskManager");for(var ea of this.OX)this.nh.zu(ea.name),ea.init(),this.nh.Fu(ea.name);this.K.resolve("Common.IAppSettingsManager").gf(()=>{if(w.podsAnimationSuggestionEnabled){const ra=this.nh.zu("animationpreview");this.XDj();this.nh.Fu(ra)}});this.K.resolve("Common.IActionManagerExtended").oaa(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));
ea=ia.a.instance.resolve("Box4.IProofingManager");if(null!==ea){let ra=this.nh.zu("proofingresume");ea.resume();this.nh.Fu(ra)}if(w.wua||!w.cVa)ea=this.nh.zu("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").ayh(),this.nh.Fu(ea);this.wbl();this.Odb=w.podsUseRealtimeCoauthReplicationTimerForInbound;ea=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");ea.Zb(30,0);ea.Wtf(Object(v.a)(this,this.rkc,"onResourceTimingEntriesAvailable"));ea.activate();w.OUa&&
(this.gEb=window.self.PerfMeterData,void 0!==this.gEb&&null!==this.gEb&&(T.Db(new Kd.a(3,2,6E4,Object(v.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Cc.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").KA(()=>{this.collectPerfMeterData(null)})));w.ka("IsPasteTextFloatieEnabled")&&this.K.resolve("Common.IActionManagerExtended").oaa(this.K.resolve("Box4.ITextPasteFloatieManager"));this.G_j(w)}G_j(w){Cc.a.J(512497356,
809,50,"Start to download chronos1 js file");if(w.euc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Xca("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1241)));else{w=vd.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1241)));const T=this.K.resolve("PowerPointWebEditor.ISessionState");w.DS(()=>{T&&T.R5("Chronos1DownloadFinished")});Fa.a.ey(w)}}collectPerfMeterData(){if(0<this.gEb.length){const w=[];for(const T of this.gEb)w.push({["Id"]:T.Id,["Value"]:T.Value.toFixed(2),
["Start"]:T.Start.toFixed(2),["Duration"]:T.Duration.toFixed(2)});Cc.a.J(512497355,813,50,JSON.stringify(w));this.gEb.length=0}}dispose(){for(var w of this.OX)w.dispose();w=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");w.deactivate(!0);w.cih(Object(v.a)(this,this.rkc,"onResourceTimingEntriesAvailable"))}XDj(){const w=vd.a.create("pptedit.animationpreview",null,()=>d.e(18).then(d.bind(null,1255)));try{Fa.a.ey(w)}catch(T){Cc.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",
T.toString())}}static xxi(w){w.register(505,"Common.IFloatPaneContainer").ma().oa(()=>new wi)}static CEh(w){w=parseInt(String(sb.a(w,"transferSize")));return{returnValue:!w.toString().startsWith("NaN"),transferSize:w}}static main(){Q.AFrameworkApplication.Ug&&da.a.eg?Cc.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(of.a.instance.ic(Nb.a.VUd,(new Date).getTime()),oa.a.instance.Dc(Cb.a(new Ac,0)))}}Object(n.a)(Ac,"ChronosPackage",null,[2,3]);class Jd{constructor(w,
T,ea,ra,wa,Za,ub){this.eFb=this.KT=!1;this.ua=w;this.jc=T;this.eu=ea;this.lq=ra;this.acb=Za;this.he=wa;this.xx=this.ua.Ba;this.Kc=ub}initialize(){this.eu.jk(Object(v.a)(this,this.kh,"onPropertyChanged"));this.he.g6a(Object(v.a)(this,this.faa,"onRibbonTabSwitched"));this.lq.aW(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.lq.grb(Object(v.a)(this,this.Gna,"onShapeViewElementAdded"));this.lq.Lai(Object(v.a)(this,this.Z5g,"onShapesAllSelected"))}dispose(){this.eu.Cm(Object(v.a)(this,
this.kh,"onPropertyChanged"));this.he.pKb(Object(v.a)(this,this.faa,"onRibbonTabSwitched"));this.lq.ioa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.lq.uoc(Object(v.a)(this,this.Gna,"onShapeViewElementAdded"));this.lq.JZk(Object(v.a)(this,this.Z5g,"onShapesAllSelected"))}kh(w,T){T.property===dc.a.VQc&&this.KT&&this.jc.kg(T.node)===this.xx&&this.jKa(this.KT)}faa(w,T){if(this.KT=!!T.W$&&0<=T.W$.indexOf("Animation"))this.eFb=!0;this.jKa(this.KT)}Gna(w,T){(w=this.ua.Ba)&&
w.aO&&w===this.xx&&(T=T.Jw)&&T.shapeNode&&this.xx&&this.LFa(this.xx.Cb,T.shapeNode)&&this.jKa(this.KT)}LFa(w,T){return w&&T?w.equals(T.slideId):!1}onActiveSlideDomReady(w,T){(w=Object(y.a)(116,T.Ba))&&this.xx&&this.xx.Cb!==w.Cb&&(this.xx=w,this.jKa(this.KT))}Z5g(){this.Baa()}Baa(){if(this.KT&&this.xx&&this.xx.EEa&&this.eFb){var w=this.xx.Ek();if(w&&0<w.length)for(const T of w)T&&T.pab()&&(w=this.acb.ZG(T))&&(w.W_b(),w.Baa(!0))}}jKa(w){if(this.eFb&&this.xx&&this.xx.aO&&this.Kc.Ic&&this.Kc.Ic.eHc){var T=
this.xx.Ek();if(T&&0<T.length)for(const ea of T)ea&&(T=this.acb.ZG(ea))&&(T.visible=w,T.qib())}}}Object(n.a)(Jd,"AnimationMarkerManagerLegacy",null,[106]);var ge=d(78),re=d(58);class Xe{constructor(w,T){this.height=w;this.top=T}}Object(n.a)(Xe,"ParagraphProperties",null,[]);var $f=d(49),Tg=d(68),hh=d(138),qj=d(169),de=d(196),Yf=d(188);class vk{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc,$c,gd,md){this.Afc=this.iA=this.hfb=this.Hk=this.Eb=!1;this.va=new ge.a;this.Sfc=this.vd=1;this.qn=this.nn=this.$g=
this.xb=this.rb=null;this.Jm=Sc=>{Sc&&this.yO?(this.rb=new hh.a,this.rb.ur("AnimationMarkerView"),this.yO.appendChild(this.rb.xa),this.xb=new Yf.a,this.xb.Yj(0),this.rb.appendChild(this.xb.viewport),this.$g=new qj.a,this.$g.Yj(1),this.$g.setVisibility(!1),this.xb.appendChild(this.$g),this.nn=new hh.a,this.nn.ur("ShapeAnimationMarkerContainer"),this.nn.xa.id=this.ta.id.toString(),this.nn.lh(20,this.rb.xa.clientHeight),this.nn.Yj(1),this.rb.appendChild(this.nn),this.qn=new hh.a,this.qn.ur("TextAnimationMarkerContainer"),
this.qn.xa.id=this.ta.id.toString(),this.qn.lh(20,this.rb.xa.clientHeight),this.qn.Yj(1),this.rb.appendChild(this.qn),this.Zf.pb(ic.a.mq,this.nn.xa,this.dD),this.Zf.pb(ic.a.Ns,this.nn.xa,this.dD),this.Zf.pb(ic.a.mq,this.qn.xa,this.dD),this.Zf.pb(ic.a.Ns,this.qn.xa,this.dD),this.Zf.pb(ic.a.EJ,this.nn.xa,this.vTa),this.Zf.pb(ic.a.EJ,this.qn.xa,this.vTa),this.Zf.pb(ic.a.mouseDown,this.nn.xa,this.vTa),this.Zf.pb(ic.a.mouseDown,this.qn.xa,this.vTa),this.Zc.pb(ic.a.click,this.qn.xa,this.pVc),this.Zc.pb(ic.a.click,
this.nn.xa,this.pVc),this.setVisibility()):Cc.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",Sc?"m_markerViewParentElement":"parent")};this.LN=()=>!0;this.vTa=Sc=>{if(!Sc&&!Sc.Ec.id.startsWith(Uc.a.yrb)&&!Sc.Ec.id.startsWith("overlappedMarker"))return Cc.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;Sc.eventName==ic.a.EJ&&this.$He(Sc);Sc=Sc.qc;Sc.preventDefault();Sc.stopPropagation();return!0};this.pVc=Sc=>{Sc=Sc.qc;Sc.preventDefault();
Sc.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let Sc=this.Eb&&!this.iA;this.ta&&this.ta.isHiddenShape&&(Sc=!1);this.rb&&this.rb.Qd(Sc);this.nn&&this.nn.Qd(Sc);this.qn&&this.qn.Qd(Sc)};this.Baa=Sc=>{if(this.Rda()){this.hfb=Sc;Sc=[this.nn.xa.childNodes,this.qn.xa.childNodes];for(const Zd of Sc)for(Sc=0;Zd&&Sc<Zd.length;Sc++)this.Cpc(Zd[Sc],this.hfb)}};this.Z6k=Sc=>{if(this.Rda()){var Zd=[this.nn.xa.childNodes,this.qn.xa.childNodes];for(const Pe of Zd)for(Zd=0;Pe&&Zd<
Pe.length;Zd++){const qe=this.X4b(Pe[Zd]);for(const cg of Sc)qe.includes(cg)&&this.Cpc(Pe[Zd],!0)}}};this.X4b=Sc=>{if(!Sc||!this.ta)return null;Sc=Sc.getAttribute("AnimProps");if(!Sc||!Sc.toString()||!Sc.toString().trim().length)return null;Sc=Sc.toString().split(" ");if(!Sc||!Sc.length)return null;const Zd=[];for(const Pe of Sc){if(!Pe||!Pe.trim().length)return null;Zd.push(Number.parseInvariant(Pe.trim()))}return Zd};this.Rda=()=>{const Sc=!!this.ta&&!!this.yO&&!!this.nn&&!!this.qn;Sc||Cc.a.J(509682579,
800,10,"AnimationMarkerView: the containers are not exist.");return Sc};this.zQa=()=>{this.$ia(!0);this.$ia(!1)};this.$ia=Sc=>{if(this.Zf&&this.Zc&&this.Rda()&&(Sc=Sc?this.qn.xa:this.nn.xa)&&Sc.childNodes&&0<Sc.childNodes.length){const Zd=Sc.childNodes;for(const Pe=0;Pe<Zd.length;)Sc.removeChild(Zd[Pe])}};this.aOd=()=>{if(this.Rda()){var Sc=this.jc.kg(this.ta);if(Sc)if((Sc=Sc.Owb(this.ta))&&Sc.length){var Zd=!1,Pe=!1,qe=[];for(const cg of Sc)cg.IsTextRangeType?Pe=!0:(Zd=!0,qe.push(cg));this.Afc=Zd&&
Pe;this.kMa(!0);this.kMa(!1);this.$ia(!1);0<qe.length&&(this.R2b(qe,this.Pi.DM(this.ta.fp.kc,this.vd),this.Pi.DM(this.ta.fp.Yb-this.ta.fp.kc,this.vd),!1,-1)||Cc.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));Pe?this.H1d():this.$ia(!0)}else this.zQa();else Cc.a.J(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.H1d=()=>{const Sc=new Kd.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.zb.Db(Sc)};this.ensureTextIsRenderedAndDrawMarkers=
()=>{this.Hk||(this.hse(),this.S2b())};this.S2b=()=>{this.$ia(!0);if(this.gce()){var Sc=this.b$d();if(Sc&&Sc.length){var Zd;if(({top:Zd}=this.j$d()).returnValue){var Pe=0;for(let cg=0;cg<Sc.length;cg++){var qe=this.jc.kg(this.ta);if(!qe){Cc.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(qe=qe.T8d(this.ta,cg))&&0<qe.length&&Sc[cg]&&(Pe+=this.R2b(qe,Sc[cg].top-Zd,Sc[cg].height,!0,cg))}Pe||Cc.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Cc.a.J(509682575,
800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Cc.a.J(509682576,800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.b$d=()=>{const Sc=[];var Zd=fh.GraphIterator.nb(this.ta);Zd=this.Ml.c3(Zd,Zd.currentNode);for(var Pe;Zd.moveNext();)(Pe=Zd.currentNode)&&this.Hh.$d(Pe)&&Pe&&(Pe=Pe.sc(this.vz))&&Pe.htmlElement&&(Pe=this.yta(Pe.htmlElement))&&Pe.height&&Sc.push(Pe);return Sc};this.yta=Sc=>{if(!Sc)return Cc.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),
null;Sc=Sc.querySelectorAll(".TextRun");if(!Sc||!Sc.length)return null;let Zd=0,Pe=0;let qe,cg=!1;for(let Zf=0;Zf<Sc.length&&Sc[Zf];Zf++){var mg=Sc[Zf].getClientRects();({top:mg,bottom:qe}=this.r3d(mg)).returnValue&&(Zf?(Zd=Zd>mg?mg:Zd,Pe=Pe<qe?qe:Pe):(Zd=mg,Pe=qe),cg=!0)}if(cg)return new Xe(Pe-Zd,Zd);Cc.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.R2b=(Sc,Zd,Pe,qe)=>{if(!this.Rda()||!Sc||!Sc.length)return 0;const cg=qe?this.qn.xa:this.nn.xa;
Pe=(Pe=Math.floor(this.Pi.Qm(Pe)/21))?Pe:1;let mg=0,Zf=null,Sj=null,Rk=!0,Fj=!1;for(let Dk=0;Dk<Sc.length;Dk++){const Zj=Sc[Dk];var Si=new hh.a;Si.xa.id=Uc.a.yrb+Zj.ClickOrder;Si.lh(20,16);Si.Yj(1);if(Zj.IsTrigger){var nk=this.EYd();Si.xa.appendChild(nk)}else Si.xa.innerText=Zj.ClickOrder.toString();let Al=nk=!1;Dk<Pe?(qe&&(Si.xa.style.position=Tg.a.absolute,Si.xa.style.top=$f.a.Pc(this.Pi.Qm(Zd)+21*mg)),Fj=this.hfb||this.yx.DWd(Zj.EffectNodeId),Si.xa.setAttribute(Tg.a.Tra,Fj?"animMarkerSelected":
"animMarkerUnselected"),cg.appendChild(Si.xa),mg++):Dk===Pe?(Rk=Rk&&Zj.EffectId===Zf.EffectId,nk=!0,Al=Zf.IsTrigger):Rk=Rk&&Zj.EffectId===Zf.EffectId;nk&&Sj.xa.appendChild(this.TSd(Al,Rk,Fj));Zf=Zj;Sj||(Sj=Si);qe?(Si=[],(nk=this.X4b(Sj.xa))&&Si.push(...nk),Si.push(Zj.EffectNodeId),Sj.xa.setAttribute("AnimProps",Si.join(" "))):Si.xa.setAttribute("AnimProps",Zj.EffectNodeId)}this.MM();return mg};this.TSd=(Sc,Zd,Pe)=>{const qe=new hh.a;qe.xa.id="overlappedMarker";qe.xa.style.marginTop=Sc?"3px":"-13px";
qe.xa.setAttribute(Tg.a.Tra,"overlappedMarker "+(Pe?"animMarkerSelected":"animMarkerUnselected"));Zd&&this.u1(qe.xa,"SameEffectOverlapped",1);return qe.xa};this.MM=()=>{this.kCe(this.rb.xa,!0)};this.gce=()=>{var Sc=this.jc.kg(this.ta);if(!Sc)return Cc.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;Sc=Sc.Owb(this.ta);if(!Sc||!Sc.length)return!1;for(const Zd of Sc)if(Zd.IsTextRangeType)return!0;return!1};this.kMa=Sc=>{if(this.Rda()){var Zd=Sc?this.nn.xa:this.qn.xa,
Pe,qe;Zd&&({x:Pe,y:qe}=this.q8d(Sc)).returnValue&&(Zd.style.position=Tg.a.absolute,Zd.style.left=$f.a.Pc(Pe),Zd.style.zIndex="20000",Sc?Zd.style.top=$f.a.Pc(qe):this.S2b())}};this.$He=Sc=>{if(this.va&&Sc&&this.Ea&&Sc.Ec){var Zd=Sc.Ec.id.startsWith("overlappedMarker")&&Sc.Ec.offsetParent?Sc.Ec.offsetParent:Sc.Ec;(Zd=this.X4b(Zd))?(Sc.ctrlKey?this.yx.jqj(Zd,this.jc.kg(this.ta)):(this.yx.psa(),this.yx.OOd(Zd,this.jc.kg(this.ta))),this.va.raiseEvent("OnMarkerClick",Sc),this.Ea.Ed()):Cc.a.J(509682566,
800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.Rl=()=>{this.xb&&(this.oPb(),this.xb.Rl())};this.oPb=()=>{if(this.ta&&this.$g){var Sc=this.ta.fp.points;Sc=vk.xra(Sc,this.uxb());this.$g.zt(Sc)}};this.uxb=()=>{let Sc=Uc.a.lLb;this.ta.Rf||!this.ta.Fua&&!this.ta.fl||(Sc+=6);return Sc};this.Yp=()=>{this.xb&&this.Sfc!==this.vd&&this.qib();return null};this.Qq=()=>{};this.Xu=()=>{};this.Ij=Sc=>{this.Sfc=this.vd;this.vd=Sc};this.setZIndex=Sc=>{this.xb&&this.xb.LB(Sc)};this.draw=
()=>{this.qib()};this.qib=()=>{this.rb&&this.yO&&this.Eb&&!this.iA&&(this.zQa(),this.aOd());this.setVisibility()};this.dD=Sc=>{if(!this.va||!Sc)return!1;this.va.raiseEvent("OnSelectionAreaHover",Sc);Sc.eventName===ic.a.mq?this.u1(Sc.Ec,"animMarkerHovered",1):Sc.eventName===ic.a.Ns&&this.u1(Sc.Ec,"animMarkerHovered",2);return!0};this.Cpc=(Sc,Zd)=>{Sc?Zd?(this.u1(Sc,"animMarkerUnselected",2),this.u1(Sc,"animMarkerSelected",1)):(this.u1(Sc,"animMarkerSelected",2),this.u1(Sc,"animMarkerUnselected",1)):
Cc.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.u1=(Sc,Zd,Pe)=>{const qe=this.MVc(Sc);switch(Pe){case 0:Sc.setAttribute(Tg.a.Tra,Zd);qe&&Sc.lastChild.setAttribute(Tg.a.Tra,Zd);break;case 1:Sys.UI.DomElement.addCssClass(Sc,Zd);qe&&Sys.UI.DomElement.addCssClass(Sc.lastChild,Zd);break;case 2:Sys.UI.DomElement.removeCssClass(Sc,Zd),qe&&Sys.UI.DomElement.removeCssClass(Sc.lastChild,Zd)}};this.MVc=Sc=>!!Sc&&!!Sc.lastChild&&!!Sc.lastChild.id&&"overlappedMarker"===Sc.lastChild.id;
this.setPosition=()=>{};this.NE=Sc=>{this.iA=Sc;this.iA||(this.Xr(),this.Baa(!0));this.setVisibility()};this.cE=()=>null;this.Ox=()=>{};this.GB=()=>[];this.Ty=()=>{};this.lD=()=>{};this.Xr=()=>{!this.Hk&&this.yO&&(this.kMa(!0),this.kMa(!1))};this.EYd=()=>{const Sc=new de.a;Sc.lh(10,10);Sc.xa.setAttribute(Tg.a.Tra,"pointer-events-none");Sc.Eya("0 0 2048 2048");const Zd=new qj.a;Zd.r1("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
Zd.OE("#E67E22");Zd.Yu("#FFFF00");Zd.mr(5);Sc.appendChild(Zd);return Sc.xa};if(!w)throw Error.argumentNull("shapeNode");if(!T)throw Error.argumentNull("slideReader");if(!ea)throw Error.argumentNull("traverserFactory");if(!ra)throw Error.argumentNull("paragraphReader");if(!ub)throw Error.argumentNull("activeSlideViewManager");if(!zb)throw Error.argumentNull("mouseInputManager");if(!tc)throw Error.argumentNull("clickInputManager");if(!pc)throw Error.argumentNull("focusManagers");if(!md)throw Error.argumentNull("effectSelectionManager");
if(!yc)throw Error.argumentNull("pptUnitConversion");this.ta=w;this.jc=T;this.Ml=ea;this.Hh=ra;this.vz=Za;this.kCe=wa;this.yO=ub.Ic?ub.Ic.eHc:null;this.tBe=ub.Ic?ub.Ic.Erc:null;this.Zf=zb;this.Zc=tc;this.Ea=pc;this.zb=bc;this.K9=$c;this.hse=gd;this.Pi=yc;this.yx=md}dispose(){this.Hk||(this.K9(),this.Hk=!0,this.Eb=!1,this.zQa(),this.Zc&&this.nn&&this.Zc.yb(ic.a.click,this.nn.xa,this.pVc),this.Zf&&this.nn&&(this.Zf.yb(ic.a.mq,this.nn.xa,this.dD),this.Zf.yb(ic.a.Ns,this.nn.xa,this.dD),this.Zf.yb(ic.a.EJ,
this.nn.xa,this.vTa),this.Zf.yb(ic.a.mouseDown,this.nn.xa,this.vTa)),this.nn=null,this.Zc&&this.qn&&this.Zc.yb(ic.a.click,this.qn.xa,this.pVc),this.Zf&&this.qn&&(this.Zf.yb(ic.a.mq,this.qn.xa,this.dD),this.Zf.yb(ic.a.Ns,this.qn.xa,this.dD),this.Zf.yb(ic.a.EJ,this.qn.xa,this.vTa),this.Zf.yb(ic.a.mouseDown,this.qn.xa,this.vTa)),this.Ea=this.Hh=this.ta=this.Ml=this.jc=this.Pi=this.yx=this.xb=this.$g=this.yO=this.rb=this.qn=null)}get visible(){return this.Eb}set visible(w){this.Eb=w}get JB(){return this.xb}get qq(){return this.$g}get te(){return this.rb}j$d(){return this.getClientRects(this.tBe)}getClientRects(w){let T,
ea;T=ea=0;if(!w)return Cc.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:T,top:ea};w=w.getClientRects();if(!w||!w.length||!w[0])return Cc.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:T,top:ea};ea=Math.round(w[0].top);T=Math.round(w[0].left);return{returnValue:!0,left:T,top:ea}}r3d(w){let T,ea;T=ea=0;if(!w||!w.length||!w[0])return Cc.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:T,bottom:ea};T=w[0].top;ea=w[0].bottom;for(let ra=1;ra<w.length&&w[ra];ra++)T=w[ra].top>T?T:w[ra].top,ea=w[ra].bottom<ea?ea:w[ra].bottom;return{returnValue:!0,top:T,bottom:ea}}q8d(w){let T,ea;T=ea=0;if(!this.ta)return{returnValue:!1,x:T,y:ea};var ra=Object(y.a)(117,this.ta.sc(this.vz));if(!ra)return{returnValue:!1,x:T,y:ea};ra=ra.us();if(!ra)return{returnValue:!1,x:T,y:ea};T=w?ra.hc-(this.Afc?61:35):ra.hc-20-15;ea=ra.kc;return{returnValue:!0,x:T,y:ea}}}vk.xra=(w,T)=>[new re.a(w[0]._x-
T,w[0]._y-T),new re.a(w[1]._x+T,w[1]._y-T),new re.a(w[2]._x+T,w[2]._y+T),new re.a(w[3]._x-T,w[3]._y+T)];Object(n.a)(vk,"AnimationMarkerView",null,[544,430,431,106]);class Gj{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc,$c,gd){this.Y6c=this.hfb=this.Hk=this.Eb=!1;this.aWa=this.jcc=-1;this.Afc=this.iA=!1;this.va=new ge.a;this.Sfc=this.vd=1;this.qn=this.nn=this.$g=this.xb=this.rb=null;this.ta=w;this.jc=T;this.Ml=ea;this.Hh=ra;this.vz=Za;this.kCe=wa;this.yO=ub.Ic?ub.Ic.eHc:null;this.tBe=ub.Ic?ub.Ic.Erc:
null;this.Zf=zb;this.Zc=tc;this.Ea=pc;this.zb=bc;this.K9=$c;this.hse=gd;this.Pi=yc}dispose(){this.Hk||(this.K9(),this.Hk=!0,this.Eb=!1,this.W_b(),this.zQa(),this.Zf&&this.nn&&(this.Zf.yb(ic.a.mq,this.nn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.yb(ic.a.Ns,this.nn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover"))),this.nn=null,this.Zf&&this.qn&&(this.Zf.yb(ic.a.mq,this.qn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.yb(ic.a.Ns,this.qn.xa,Object(v.a)(this,this.dD,
"onSelectionAreaHover"))),this.xb=this.$g=this.yO=this.rb=this.qn=null)}get visible(){return this.Eb}set visible(w){this.Eb=w}get JB(){return this.xb}get qq(){return this.$g}get te(){return this.rb}Jm(w){w&&this.yO?(this.rb=new hh.a,this.rb.ur("AnimationMarkerView"),this.yO.appendChild(this.rb.xa),this.xb=new Yf.a,this.xb.Yj(0),this.rb.appendChild(this.xb.viewport),this.$g=new qj.a,this.$g.Yj(1),this.$g.setVisibility(!1),this.xb.appendChild(this.$g),this.nn=new hh.a,this.nn.ur("ShapeAnimationMarkerContainer"),
this.nn.xa.id=this.ta.id.toString(),this.nn.lh(20,this.rb.xa.clientHeight),this.nn.Yj(1),this.rb.appendChild(this.nn),this.qn=new hh.a,this.qn.ur("TextAnimationMarkerContainer"),this.qn.xa.id=this.ta.id.toString(),this.qn.lh(20,this.rb.xa.clientHeight),this.qn.Yj(1),this.rb.appendChild(this.qn),this.Zf.pb(ic.a.mq,this.nn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.pb(ic.a.Ns,this.nn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.Zf.pb(ic.a.mq,this.qn.xa,Object(v.a)(this,
this.dD,"onSelectionAreaHover")),this.Zf.pb(ic.a.Ns,this.qn.xa,Object(v.a)(this,this.dD,"onSelectionAreaHover")),this.setVisibility()):Cc.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",w?"m_markerViewParentElement":"parent")}LN(w){let T=!1;w&&w.Ec.id.startsWith(Uc.a.yrb)||w.Ec.id.startsWith("overlappedMarker")?(this.$He(w),T=!0):(this.W_b(),this.Baa(!0));return T}setSelection(w){if(w&&!this.Y6c||!w)this.Baa(w),this.W_b()}setVisibility(){let w=this.Eb&&!this.iA;this.ta&&this.ta.isHiddenShape&&
(w=!1);this.rb&&this.rb.Qd(w);this.nn&&this.nn.Qd(w);this.qn&&this.qn.Qd(w)}Baa(w){if(this.Rda()){this.hfb=w;w=[this.nn.xa.childNodes,this.qn.xa.childNodes];for(const T of w)for(w=0;T&&w<T.length;w++)this.Cpc(T[w],this.hfb)}}X4b(w){if(!w||!this.ta)return null;w=w.getAttribute("AnimProps");if(!w||!w.toString()||!w.toString().trim().length)return null;w=w.toString().split(" ");if(!w||4!==w.length)return null;const T=[];for(const ea of w){if(!ea||!ea.trim().length)return null;T.push(Number.parseInvariant(ea.trim()))}return T}Rda(){const w=
!!this.ta&&!!this.yO&&!!this.nn&&!!this.qn;w||Cc.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return w}zQa(){this.$ia(!0);this.$ia(!1)}$ia(w){if(this.Zf&&this.Zc&&this.Rda()&&(w=w?this.qn.xa:this.nn.xa)&&w.childNodes&&0<w.childNodes.length){const T=w.childNodes;for(const ea=0;ea<T.length;)w.removeChild(T[ea])}}aOd(){if(this.Rda()){var w=this.uZf(this.ta);if(w&&w.length){var T=!1,ea=!1,ra=[];for(const wa of w)wa.IsTextRangeType?ea=!0:(T=!0,ra.push(wa));this.Afc=T&&ea;
this.kMa(!0);this.kMa(!1);this.$ia(!1);0<ra.length&&(Cc.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.R2b(ra,this.Pi.DM(this.ta.fp.kc,this.vd),this.Pi.DM(this.ta.fp.Yb-this.ta.fp.kc,this.vd),!1,-1)||Cc.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));ea?this.H1d():this.$ia(!0);if(!ea&&-1!==this.aWa||-1!==this.aWa&&-1===this.aWa&&!T)this.jVd(),this.Baa(!0)}else this.zQa()}}H1d(){const w=new Kd.a(2,1,0,Object(v.a)(this,this.ensureTextIsRenderedAndDrawMarkers,
"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.zb.Db(w)}ensureTextIsRenderedAndDrawMarkers(){this.Hk||(this.hse(),this.S2b())}S2b(){this.$ia(!0);if(this.gce(this.ta)){var w=this.b$d();if(w&&w.length){var T;if(({top:T}=this.j$d()).returnValue){var ea=0;Cc.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let wa=0;wa<w.length;wa++){var ra=this.jc.kg(this.ta);if(!ra)return;(ra=ra.DTc(this.ta,wa))&&0<ra.length&&w[wa]&&(ea+=this.R2b(ra,w[wa].top-T,w[wa].height,!0,
wa))}ea||Cc.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Cc.a.J(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Cc.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}b$d(){const w=[];var T=fh.GraphIterator.nb(this.ta);T=this.Ml.c3(T,T.currentNode);for(var ea;T.moveNext();)(ea=T.currentNode)&&this.Hh.$d(ea)&&ea&&(ea=ea.sc(this.vz))&&ea.htmlElement&&(ea=this.yta(ea.htmlElement))&&ea.height&&w.push(ea);
return w}j$d(){return this.getClientRects(this.tBe)}getClientRects(w){let T,ea;T=ea=0;if(!w)return Cc.a.J(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:T,top:ea};w=w.getClientRects();if(!w||!w.length||!w[0])return Cc.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:T,top:ea};ea=Math.round(w[0].top);T=Math.round(w[0].left);return{returnValue:!0,left:T,top:ea}}yta(w){if(!w)return Cc.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),
null;w=w.querySelectorAll(".TextRun");if(!w||!w.length)return null;let T=0,ea=0;let ra,wa=!1;for(let ub=0;ub<w.length&&w[ub];ub++){var Za=w[ub].getClientRects();({top:Za,bottom:ra}=this.r3d(Za)).returnValue&&(ub?(T=T>Za?Za:T,ea=ea<ra?ra:ea):(T=Za,ea=ra),wa=!0)}if(wa)return new Xe(ea-T,T);Cc.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}r3d(w){let T,ea;T=ea=0;if(!w||!w.length||!w[0])return Cc.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:T,bottom:ea};T=w[0].top;ea=w[0].bottom;for(let ra=1;ra<w.length&&w[ra];ra++)T=w[ra].top>T?T:w[ra].top,ea=w[ra].bottom<ea?ea:w[ra].bottom;return{returnValue:!0,top:T,bottom:ea}}R2b(w,T,ea,ra,wa){if(!this.Rda()||!w||!w.length)return 0;const Za=ra?this.qn.xa:this.nn.xa;ea=(ea=Math.floor(this.Pi.Qm(ea)/21))?ea:1;let ub=0,zb=null,tc=new hh.a,pc=!1,bc=!1;const yc=wa===this.aWa&&w.length<this.jcc+1;for(let gd=0;gd<w.length;gd++){const md=w[gd],Sc=new hh.a;Sc.xa.id=Uc.a.yrb+md.BuildId;
Sc.lh(20,16);Sc.Yj(1);if(md.IsTrigger){var $c=this.EYd();Sc.xa.appendChild($c)}else Sc.xa.innerText=md.BuildId.toString();let Zd=$c=!1;gd<ea?(ra&&(Sc.xa.style.position=Tg.a.absolute,Sc.xa.style.top=$f.a.Pc(this.Pi.Qm(T)+21*ub)),Sc.xa.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",gd,wa,md.BuildId,md.EffectId)),bc=this.hfb||yc&&w.length-1===gd||this.Y6c&&this.jcc===gd&&this.aWa===wa,Sc.xa.setAttribute(Tg.a.Tra,bc?"animMarkerSelected":"animMarkerUnselected"),Za.appendChild(Sc.xa),ub++):gd===
ea&&tc.xa?(pc=pc&&md.EffectId===zb.EffectId,$c=!0,Zd=zb.IsTrigger):pc=pc&&md.EffectId===zb.EffectId;$c&&tc.xa.appendChild(this.TSd(Zd,pc,bc));tc=Sc;zb=md}this.MM();return ub}TSd(w,T,ea){const ra=new hh.a;ra.xa.id="overlappedMarker";ra.xa.style.marginTop=w?"3px":"-13px";ra.xa.setAttribute(Tg.a.Tra,"overlappedMarker "+(ea?"animMarkerSelected":"animMarkerUnselected"));T&&this.u1(ra.xa,"SameEffectOverlapped",1);return ra.xa}MM(){this.kCe(this.rb.xa,!0)}uZf(w){if(!w)return null;const T=this.jc.kg(w);return T?
T.kTa(w):null}gce(w){w=this.uZf(w);if(!w||!w.length)return!1;for(const T of w)if(T.IsTextRangeType)return!0;return!1}kMa(w){if(this.Rda()){var T=w?this.nn.xa:this.qn.xa,ea,ra;T&&({x:ea,y:ra}=this.q8d(w)).returnValue&&(T.style.position=Tg.a.absolute,T.style.left=$f.a.Pc(ea),T.style.zIndex="20000",w?T.style.top=$f.a.Pc(ra):this.S2b())}}q8d(w){let T,ea;T=ea=0;if(!this.ta)return{returnValue:!1,x:T,y:ea};var ra=Object(y.a)(117,this.ta.sc(this.vz));if(!ra)return{returnValue:!1,x:T,y:ea};ra=ra.us();if(!ra)return{returnValue:!1,
x:T,y:ea};T=w?ra.hc-(this.Afc?61:35):ra.hc-20-15;ea=ra.kc;return{returnValue:!0,x:T,y:ea}}$He(w){if(this.va&&w&&this.Ea&&w.Ec){var T=w.Ec.id.startsWith("overlappedMarker")&&w.Ec.offsetParent?w.Ec.offsetParent:w.Ec;this.$9k(T);this.MVc(T)&&!this.ATj(T)&&this.jVd();this.Baa(!1);this.Cpc(T,!0);this.va.raiseEvent("OnMarkerClick",w);this.Ea.Ed()}}W_b(){this.Y6c=!1;this.aWa=this.jcc=-1;this.jVd()}$9k(w){(w=this.X4b(w))?(this.Y6c=!0,this.jcc=w[0],this.aWa=w[1],this.ta.qya=this.jcc,this.ta.KKa=this.aWa):
Cc.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}jVd(){this.ta&&(this.ta.qya=-1,this.ta.KKa=-1)}Rl(){this.xb&&(this.oPb(),this.xb.Rl())}oPb(){if(this.ta&&this.$g){var w=this.ta.fp.points;w=Gj.xra(w,this.uxb());this.$g.zt(w)}}uxb(){let w=Uc.a.lLb;this.ta.Rf||!this.ta.Fua&&!this.ta.fl||(w+=6);return w}Yp(){this.xb&&this.Sfc!==this.vd&&this.qib();return null}Qq(){}Xu(){}Ij(w){this.Sfc=this.vd;this.vd=w}setZIndex(w){this.xb&&this.xb.LB(w)}draw(){this.qib()}qib(){this.rb&&
this.yO&&this.Eb&&!this.iA&&this.aOd();this.setVisibility()}dD(w){if(!this.va||!w)return!1;this.va.raiseEvent("OnSelectionAreaHover",w);w.eventName===ic.a.mq?this.u1(w.Ec,"animMarkerHovered",1):w.eventName===ic.a.Ns&&this.u1(w.Ec,"animMarkerHovered",2);return!0}Cpc(w,T){w&&(T?(this.u1(w,"animMarkerUnselected",2),this.u1(w,"animMarkerSelected",1)):(this.u1(w,"animMarkerSelected",2),this.u1(w,"animMarkerUnselected",1)))}u1(w,T,ea){const ra=this.MVc(w);switch(ea){case 0:w.setAttribute(Tg.a.Tra,T);ra&&
w.lastChild.setAttribute(Tg.a.Tra,T);break;case 1:Sys.UI.DomElement.addCssClass(w,T);ra&&Sys.UI.DomElement.addCssClass(w.lastChild,T);break;case 2:Sys.UI.DomElement.removeCssClass(w,T),ra&&Sys.UI.DomElement.removeCssClass(w.lastChild,T)}}MVc(w){return!!w&&!!w.lastChild&&!!w.lastChild.id&&"overlappedMarker"===w.lastChild.id}ATj(w){return!!w&&!!w.lastChild&&!!w.lastChild.id&&0<=w.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}NE(w){(this.iA=w)?this.W_b():(this.Xr(),this.Baa(!0));
this.setVisibility()}cE(){return null}Ox(){}GB(){return[]}Ty(){}lD(){}Xr(){!this.Hk&&this.yO&&(this.kMa(!0),this.kMa(!1))}EYd(){const w=new de.a;w.lh(10,10);w.xa.setAttribute(Tg.a.Tra,"pointer-events-none");w.Eya("0 0 2048 2048");const T=new qj.a;T.r1("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");T.OE("#E67E22");T.Yu("#FFFF00");
T.mr(5);w.appendChild(T);return w.xa}static xra(w,T){return[new re.a(w[0]._x-T,w[0]._y-T),new re.a(w[1]._x+T,w[1]._y-T),new re.a(w[2]._x+T,w[2]._y+T),new re.a(w[3]._x-T,w[3]._y+T)]}}Object(n.a)(Gj,"AnimationMarkerViewLegacy",null,[543,430,431,106]);var Pm=d(280),ok=d(1233),wk=d(189);class Am{constructor(w,T,ea,ra,wa,Za,ub,zb,tc){this.eFb=this.KT=!1;this.qy=[];this.V$c=new Set;this.initialize=()=>{this.eu.jk(this.kh);this.he.g6a(this.faa);this.lq.aW(this.onActiveSlideDomReady);this.lq.grb(this.Gna);
this.lq.HPd(this.gZa);this.pa.wF(this.iY)};this.dispose=()=>{this.eu.Cm(this.kh);this.he.pKb(this.faa);this.lq.ioa(this.onActiveSlideDomReady);this.lq.uoc(this.Gna);this.lq.mRe(this.gZa);this.pa.aya(this.iY);this.ia=this.V$c=this.qy=this.xx=this.jc=this.pa=this.lq=this.he=this.eu=null};this.gZa=()=>{this.t7b()};this.iY=()=>{this.t7b()};this.t7b=()=>{const pc=this.pa.Wd();this.ptb();const bc=this.xx.Ek();if(bc&&bc.length){var yc=new Set;for(const $c of pc)yc.add($c.id);for(const $c of bc)yc.has($c.id)?
this.utf($c):this.Rhh($c);this.ia.La(Rc.a.Olb,ok.a.execute,null)}};this.jqj=(pc,bc)=>{bc&&pc&&pc.length&&(this.DWd(pc[0])?(bc=this.qy.filter(yc=>!pc.includes(yc.EffectNodeId)),this.ptb(),this.psa(),this.POd(bc)):(bc=this.jc.vZf(pc,bc),this.pOd(bc),bc=Object.assign([],this.qy),this.ptb(),this.psa(),this.POd(bc)),this.ia.La(Rc.a.Olb,ok.a.execute,null))};this.psa=()=>{const pc=this.pa.Wd();this.pa.psa(pc)};this.POd=pc=>{if(pc&&pc.length){this.pOd(pc);var bc=this.xx.Ek();if(bc&&bc.length){pc=new Map;
for(var yc of this.qy){var $c=ue.a.Hf(yc.ShapeId);if(!$c){Cc.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");return}$c=$c.toString();pc.has($c)||pc.set($c,new Set);$c=pc.get($c);null===$c||void 0===$c?void 0:$c.add(yc.EffectNodeId)}for(const gd of bc)if(yc=this.acb.ZG(gd))yc.Baa(!1),bc=gd.id.toString(),(bc=pc.has(bc)?pc.get(bc):null)&&bc.size&&yc.Z6k(Array.from(bc));this.he.Dy(new wk.a(7))}}};this.OOd=(pc,bc)=>{bc&&pc&&pc.length&&(this.ptb(),pc=this.jc.vZf(pc,
bc),this.POd(pc),this.ia.La(Rc.a.Olb,ok.a.execute,null))};this.utf=pc=>{if(pc){var bc=this.jc.kg(pc);bc&&(bc=bc.Owb(pc),this.pOd(bc),this.acb.ZG(pc).Baa(!0))}};this.Rhh=pc=>{pc&&(pc=this.acb.ZG(pc))&&pc.Baa(!1)};this.pOd=pc=>{if(pc&&pc.length)for(const bc of pc)this.DWd(bc.EffectNodeId)||(this.qy.push(bc),this.V$c.add(bc.EffectNodeId))};this.DWd=pc=>this.V$c.has(pc);this.kh=(pc,bc)=>{bc&&bc.property===dc.a.tQd&&this.KT&&this.jc.kg(bc.node)===this.xx&&(this.jKa(this.KT),this.tFl(),this.he.Dy(new wk.a(7)),
this.ia.La(Rc.a.Olb,ok.a.execute,null))};this.faa=(pc,bc)=>{if(bc){if(this.KT=!!bc.W$&&0<=bc.W$.indexOf("Animation"))this.eFb=!0;this.jKa(this.KT);this.KT?(this.t7b(),this.he.Dy(new wk.a(7))):this.ia.La(Rc.a.XFf,ok.a.execute,null)}};this.Gna=(pc,bc)=>{pc=this.ua.Ba;bc&&pc&&pc.aO&&pc===this.xx&&(bc=bc.Jw)&&bc.shapeNode&&this.xx&&this.LFa(this.xx.Cb,bc.shapeNode)&&(this.jKa(this.KT),this.ia.La(Rc.a.Olb,ok.a.execute,null))};this.LFa=(pc,bc)=>pc&&bc?pc.equals(bc.slideId):!1;this.onActiveSlideDomReady=
(pc,bc)=>{bc&&(pc=Object(y.a)(116,bc.Ba))&&this.xx&&this.xx.Cb!==pc.Cb&&(this.xx=pc,this.ptb(),this.jKa(this.KT),this.ia.La(Rc.a.Olb,ok.a.execute,null))};this.jKa=pc=>{if(this.eFb&&this.xx&&this.xx.aO&&this.Kc.Ic&&this.Kc.Ic.eHc){var bc=this.xx.Ek();if(bc&&bc.length)for(const yc of bc)if(bc=this.acb.ZG(yc))bc.visible=pc,bc.qib()}};this.ptb=()=>{this.V$c.clear();this.qy.length=0};if(!w)throw Error.argumentNull("actionManager");if(!T)throw Error.argumentNull("graphTopologyManager");if(!ea)throw Error.argumentNull("slideReader");
if(!ra)throw Error.argumentNull("graphNodeEventHandlers");if(!wa)throw Error.argumentNull("viewElementEventHandler");if(!Za)throw Error.argumentNull("viewEventNotifier");if(!ub)throw Error.argumentNull("animationMarkerViewManager");if(!zb)throw Error.argumentNull("activeSlideViewManager");if(!tc)throw Error.argumentNull("selectionManager");this.ia=w;this.ua=T;this.jc=ea;this.eu=ra;this.lq=wa;this.acb=ub;this.he=Za;this.xx=this.ua.Ba;this.Kc=zb;this.pa=tc}tFl(){var w=this.pa.Wd();this.ptb();const T=
this.xx.Ek();if(T&&T.length)if(w&&w.length){var ea=new Set;for(const ra of w)ea.add(ra.id);for(const ra of T)ea.has(ra.id)?this.utf(ra):this.Rhh(ra)}else w=this.xx.kRc(T),w.length&&(w=w.filter(ra=>ra.IsModifiedPreviously).map(ra=>ra.EffectNodeId),this.OOd(w,this.xx))}}Object(n.a)(Am,"EffectSelectionManager",null,[538,106]);class Fk{constructor(){this.K=null;this.LCb=!1}get name(){return"PowerPointWebEditor.Animations"}Zb(w){this.K=w;(this.LCb=this.K.resolve("PowerPointWebEditor.IApplicationContext").od.zrb)?
(this.K.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().oa(()=>new Pm.a((T,ea)=>{let ra=null;const wa=Object(y.a)(117,T.sc(this.K.resolve("Box4.IPageView").Ma));wa&&!wa.Al&&wa.xa&&(ra=new vk(T,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(wa,wa.MM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),Q.AFrameworkApplication.ye,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ea,()=>{wa.wDa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),ra.Jm(wa.xa),ra.setZIndex(4),ra.visible=!1,wa.MM(ra.te.xa,!0),wa.rra(ra,4));return ra})),this.K.register(Am,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().oa(()=>
new Am(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))):(this.K.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().oa(()=>new Pm.a((T,ea)=>{let ra=null;const wa=Object(y.a)(117,T.sc(this.K.resolve("Box4.IPageView").Ma));wa&&!wa.Al&&wa.xa&&(ra=new Gj(T,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(v.a)(wa,
wa.MM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),Q.AFrameworkApplication.ye,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ea,()=>{wa.wDa()}),ra.Jm(wa.xa),ra.setZIndex(4),ra.visible=!1,wa.MM(ra.te.xa,!0),wa.rra(ra,4));return ra})),this.K.register(Jd,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().oa(()=>
new Jd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").yd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.LCb?
this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.LCb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){oa.a.instance.Dc(Cb.a(new Fk,0))}}Object(n.a)(Fk,"PPTWebEditorAnimationsPackage",null,[2,3]);var Ih=d(1043),yj=d(124);class zj{constructor(w,
T,ea,ra){this.ia=w;this.Ea=T;this.Wue=ea;this.oc=ra}wb(){this.ia.ya(Rc.a.find,Ic.a.view,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Rc.a.find,Ic.a.notes,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Rc.a.find,Ic.a.Pf,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Na.a.findInDocument,Ic.a.view,Object(v.a)(this,this.findInDocument,"findInDocument"));this.ia.je(Rc.a.find,0);this.ia.ya(Rc.a.h1,Ic.a.view,Object(v.a)(this,this.h1,"replaceText"));this.ia.ya(Rc.a.h1,Ic.a.notes,
Object(v.a)(this,this.h1,"replaceText"));this.ia.ya(Rc.a.h1,Ic.a.Pf,Object(v.a)(this,this.h1,"replaceText"));this.ia.je(Rc.a.h1,4)}Ee(){const w=[this.Ea.Fc(yj.a.PD),this.Ea.Fc(yj.a.T2),this.Ea.Fc(vg.a.sg),this.Ea.Fc(vg.a.lQ)];for(const T of w)T.bindAction(qb.KeyInputManager.Oa(Ue.a.wpa,qb.KeyInputManager.Oe),Rc.a.find),T.bindAction(qb.KeyInputManager.Oa(Ue.a.rmb,qb.KeyInputManager.Oe),Rc.a.h1)}findText(w,T,ea){return T.contextId!==Ic.a.view&&T.contextId!==Ic.a.notes&&T.contextId!==Ic.a.Pf?2:1===ea?
this.oc.pj()?32:8:2===ea?(this.Wue.Yxh(T),Cc.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}h1(w,T,ea){return T.contextId!==Ic.a.view&&T.contextId!==Ic.a.notes&&T.contextId!==Ic.a.Pf?2:1===ea?this.oc.pj()?32:8:2===ea?(this.Wue.lql(T),Cc.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(w,T,ea,ra,wa){if(T.contextId!==Ic.a.view&&T.contextId!==Ic.a.notes&&T.contextId!==Ic.a.Pf)return 2;if(1===ea)return 32;if(2===ea){if(!wa)return 8;w=wa.CommandValueId||"";Cc.a.J(539773089,
820,50,"Find. ActionData QueryLength: {0}",w.length);this.Wue.Upl(T,w);Cc.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(n.a)(zj,"FindReplaceTextActor",null,[352]);var Zl=d(1234);class vn extends Zl.a{constructor(w,T,ea){super(!1,!0);this.Ase=!1;this.R$c=null;this.HDb=!1;this.Qwg=this.eyg=null;this.Vue=!0;this.eve=this.fve=this.dve=!1;this.Fma=null;this.k$c=!1;this.yAe=!0;this.xTg=this.exe=!1;this.cRg=this.eRg=null;this.LGg=0;this.Ea=w;this.I9=T;
this.xhk="FindReplaceTextDialog";this.d0=ResourceStrings.l_FindTextTitle;ea&&(this.d0=ResourceStrings.l_ReplaceTextTitle);this.hxe=ea;this.GV=!1}g6(){this.Zi(this.d0,this.I9,this.F8());this.Ase=!1}dispose(){super.dispose();this.Ase=!0}KMi(){this.dve=this.Vue=!1;this.H6(this.d0,this.I9,this.F8())}jRf(w){w&&(this.Ea.tf(Ge.AFrame.v5),this.dve=!0);this.Vue=!0;this.H6(this.d0,this.I9,this.F8())}X7b(){this.hide()}l$k(w){this.R$c=w.searchString;this.HDb=w.matchCase;this.Fma=w.replaceString}Al(){return this.Ase}h0a(w,
T){this.Qwg=w;this.LGg=T;this.xTg=0===T;this.H6(this.d0,this.I9,this.F8())}Cod(w){this.eyg=w;this.H6(this.d0,this.I9,this.F8())}Xod(w){this.eRg=w;this.H6(this.d0,this.I9,this.F8())}$Ve(w){this.cRg=w;this.H6(this.d0,this.I9,this.F8())}get M_a(){return this.R$c}set M_a(w){this.R$c=w}get matchCase(){return this.HDb}set matchCase(w){this.HDb=w}get LRe(){return this.Fma}set LRe(w){this.Fma=w}LQi(w){w&&(this.Ea.tf(Ge.AFrame.v5),this.fve=!0);this.k$c=!0;this.H6(this.d0,this.I9,this.F8())}E_d(){this.fve=
this.k$c=!1;this.H6(this.d0,this.I9,this.F8())}KQi(w){w&&(this.Ea.tf(Ge.AFrame.v5),this.eve=!0);this.yAe=!0;this.H6(this.d0,this.I9,this.F8())}MMi(){this.eve=this.yAe=!1;this.H6(this.d0,this.I9,this.F8())}msl(){this.d0=ResourceStrings.l_ReplaceTextTitle;this.hxe=!0;this.k$c=!1;this.H6(this.d0,this.I9,this.F8());this.Ea.tf(Ge.AFrame.v5)}JQi(){this.exe=!0;this.H6(this.d0,this.I9,this.F8())}W3i(){return{["searchString"]:this.R$c,["findNextButtonAriaLabel"]:this.eyg,["errorMessage"]:this.Qwg,["findNextButtonIsEnabled"]:this.Vue,
["focusFindNextButton"]:this.dve,["focusDialog"]:Object(v.a)(this,this.ZZi,"focusDialog"),["isReplaceActive"]:this.hxe,["replaceButtonIsEnabled"]:this.k$c,["replaceAllButtonIsEnabled"]:this.yAe,["showMessageAsError"]:this.xTg,["messageStatus"]:this.LGg,["focusReplaceButton"]:this.fve,["focusReplaceAllButton"]:this.eve,["replaceButtonAriaLabel"]:this.eRg,["replaceAllButtonAriaLabel"]:this.cRg,["readOnlyModeEnabled"]:this.exe}}F8(){return{["id"]:this.xhk,["bodyControls"]:this.W3i(),["isModal"]:!1}}ZZi(){this.Ea.tf(Ge.AFrame.v5)}}
Object(n.a)(vn,"ReactFindReplaceTextDialog",Zl.a,[584]);class lm{constructor(w){this.Ea=w}getInstance(w,T){return new vn(this.Ea.value,w,T)}}Object(n.a)(lm,"FindReplaceTextDialogFactory",null,[509]);class $l{constructor(){this.w6=this.yga=this.paragraphIndex=this.LR=this.slideIndex=0}reset(){this.slideIndex=this.LR=this.paragraphIndex=0;this.yga=this.w6=-1}clone(){const w=new $l;w.slideIndex=this.slideIndex;w.LR=this.LR;w.paragraphIndex=this.paragraphIndex;w.yga=this.yga;w.w6=this.w6;return w}}Object(n.a)($l,
"TextPosition",null,[]);class mm{constructor(){this.Lxe=this.T3c=null;this.gP=new $l;this.lm=new $l;this.state=this.Qya=0;this.Nsb=this.X1d=!1;this.pattern=this.R1b=this.T1b=null;this.matchCase=!1;this.reset()}reset(){this.Qya=0;this.gP.reset();this.lm.reset();this.state=0;this.Nsb=this.X1d=!1;this.Lxe=this.dRa=this.R1b=this.T1b=null}get dRa(){return this.T3c}set dRa(w){if(this.T3c=w)this.Lxe=this.T3c}get IYj(){return this.Lxe}}Object(n.a)(mm,"FindContext",null,[]);var xk=d(53),cl=d(94);class If{constructor(){this.ShouldMatchCase=
!1}}Object(n.a)(If,"MatchTextInfo",null,[]);class Bl{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(n.a)(Bl,"ReplaceAllTextInfo",null,[]);var rj=d(961),Bm=d(162),dn=d(972),xa=d(327);class hi{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc,$c,gd,md,Sc,Zd,Pe,qe,cg,mg,Zf,Sj){this.QHa=this.wm=this.nE=null;this.Bd=new mm;this.Fma=this.$F="";this.sfc=!1;this.KEb=this.neb=0;this.JEb=Date.now();this.j$c=-1;this.Uue=0;this.O9c=-1;this.ia=w;this.Adc=
T;this.Ea=ea;this.Nq=ra;this.oc=wa;this.Fa=Za;this.Yl=ub;this.Rva=zb;this.Fb=tc;this.zb=pc;this.Vb=bc;this.ua=yc;this.Qb=$c;this.Jb=Sc;this.he=gd;this.Iq=md;this.jJ=Zd;this.pIa=Pe;this.fGg=qe;this.Oeb=cg;this.cek=mg;this.LL=Sj;this.dRg=Zf}Yxh(w){this.nE=w;this.wm=this.fGg.value.getInstance(Object(v.a)(this,this.ZVf,"findReplaceTextDialogResultHandler"),!1);this.$F&&(this.wm.M_a=this.$F,this.O9c=-1);this.wm.g6();3!=this.ia.mode&&this.wm.JQi();this.XUa()&&this.C_d()}Upl(w,T){this.XUa()||(this.$F=T);
this.Yxh(w);this.XUa()||(this.wm.M_a=this.$F,this.wm.g6(),this.M2e(T,!1))}lql(w){this.nE=w;this.wm=this.fGg.value.getInstance(Object(v.a)(this,this.ZVf,"findReplaceTextDialogResultHandler"),!0);this.$F&&(this.wm.M_a=this.$F);this.wm.g6();this.XUa()&&this.C_d()}ZVf(w,T){if(T)switch(this.wm.l$k(T),w){case 1:this.Brk();break;case 2:this.Crk();break;case 3:this.Drk(this.wm.LRe);break;default:this.hkl(),this.clearSelection(),this.Bd.reset(),this.wm.X7b()}else Cc.a.J(512496416,820,10,"Got null control value for findreplace dialog")}Kag(){return this.Bd.T1b&&
this.WNd!==this.Bd.T1b.le}M2e(w,T){this.FOf();if(0===this.Bd.state||3===this.Bd.state||w!==this.$F||T!==this.sfc||this.Kag())this.VCj(w,T),this.O9c=-1;this.Bd.Nsb=!1;this.Sed()}get WNd(){return this.ua.Ba?this.ua.Ba.le:0}VCj(w,T){const ea=w===this.$F&&3===this.Bd.state&&!this.Kag(),ra=this.Bd.gP.clone();this.Bd.reset();this.$F=w;this.sfc=T;ea?this.Bd.gP=ra.clone():(this.Bd.gP.slideIndex=this.WNd,this.T9i());this.Bd.lm=this.Bd.gP.clone()}Sed(){this.uYi(this.$F,this.sfc)?4!==this.Bd.state&&this.setSelection():
(m.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.o3b())}uYi(w,T){var ea=this.ua.presentation;if(!ea)throw Error.argumentNull("Presentation is null");if(ea=ea.slides||[],ea.length){this.Bd.Qya=ea.length;const ra=ea.length+this.Bd.gP.slideIndex;for(;this.Bd.lm.slideIndex<=ra;){const wa=this.Bd.lm.slideIndex%ea.length,Za=this.wYi(ea[wa],w,T,this.Bd.lm.slideIndex===ra?this.Bd.gP.LR:hi.ODe);if(Za&&(this.Bd.T1b=this.oc.zl(Za.Cb)))return!0;if(7===this.Bd.state)return this.Bd.Nsb&&(Cc.a.J(512496414,
820,50,"call into PerformBackendFind recursively."),this.Bd.state=0),this.hEk(ea[wa]?ea[wa].Cb:null,w,T);if(3===this.Bd.state)break;let ub;(ub=this.Bd.lm).slideIndex=ub.slideIndex+1;this.Bd.lm.LR=0}}else this.Bd.state=1;return!1}wYi(w,T,ea,ra){if(!w)return null;var wa=this.oc.zl(w.Cb),Za=this.Qb.Nc(wa);wa=wa.lTa()||[];(Za=Za.Bb(27))&&wa.push(Za);if(!wa.length)return this.Bd.state=7,null;for(;this.Bd.lm.LR<=Math.min(wa.length-1,ra);){if(this.Bd.R1b=this.vYi(wa[this.Bd.lm.LR],T,ea,this.Bd.lm.LR===ra?
this.Bd.gP.paragraphIndex:hi.ODe))return w;let ub;(ub=this.Bd.lm).LR=ub.LR+1;this.Bd.lm.paragraphIndex=0}return null}vYi(w,T,ea,ra){if(!this.Yl.wFa(w)&&w.DC)return null;const wa=cl.a.createInstance(w);let Za=0;for(;wa.moveNext()&&this.Bd.lm.paragraphIndex<=ra;){const ub=wa.currentNode;if(ig.ParagraphReader.$d(ub)&&Za++===this.Bd.lm.paragraphIndex){if(this.Bd.dRa=this.sYi(ub,T,ea,this.Bd.lm.paragraphIndex===ra?this.Bd.gP.yga:hi.ODe))return w;let zb;(zb=this.Bd.lm).paragraphIndex=zb.paragraphIndex+
1;this.Bd.lm.yga=this.Bd.lm.w6=-1}}return null}sYi(w,T,ea,ra){if(!ig.ParagraphReader.$d(w))return null;let wa=w.Hwb();if(!wa.length)return null;wa=wa.substring(0,Math.min(wa.length,ra));return this.xYi(wa,Math.max(0,this.Bd.lm.w6),T,ea)?w:null}xYi(w,T,ea,ra){let wa=w,Za=ea;ra||(wa=w.toLowerCase(),Za=ea.toLowerCase());w=wa.indexOf(Za,-1===T?0:T);if(-1!==w)return this.Bd.lm.yga=w,this.Bd.lm.w6=w+Za.length,this.Bd.state=2,this.Bd.X1d=!0;this.Bd.state=1;return!1}T9i(){var w=Bm.b(this.nE);w=w?w.Lb:null;
if(!w||!w.Na)m.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(w.Na.mb){var T=w.Na.mb.Ua;if(ig.ParagraphReader.$d(T.node)){w=Object(y.a)(5,T.node);this.Bd.gP.yga=T.Qa;this.Bd.gP.w6=T.Qa;const ea=this.Fa.oda(T.node);ea?(this.Bd.gP.LR=ea.get_zIndex()-1,this.Bd.gP.paragraphIndex=this.J4f(w)):this.Yl.gxb(T.node)&&(T=this.ua.Ba?this.ua.Ba.lTa():null,this.Bd.gP.LR=T?T.length:0,this.Bd.gP.paragraphIndex=this.J4f(w))}else this.Fa.KFa(T.node)&&(this.Bd.gP.LR=T.node.get_zIndex()-
1)}}J4f(w){w=this.Qb.Nc(w);if(!w.D6(ea=>10===ea.type||60===ea.type||16===ea.type))return 0;w.zc();const T=w.yq;w.zc();return Math.max(0,w.FSa(T))}n_g(){const w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");return this.Bd.gP.slideIndex||this.Bd.gP.LR?this.Bd.lm.slideIndex<(w.slides||[]).length:!1}t9f(){const w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");this.Bd.lm.slideIndex=w.slides?w.slides.length:0;this.Bd.Nsb=!1;this.Sed()}SYc(){return this.wm.Al()}Wqk(w){if(!this.SYc()){Cc.a.J(512496409,
820,50,"OnBackendFindSucceeded");var T=Mh.a.empty;({slideId:T}=Mh.a.LDh(w));(w=this.oc.kka(T))?(T=w.slideIndex,T>this.Bd.gP.slideIndex&&T<this.Bd.lm.slideIndex?this.o3b():this.Vb.Ba!==w?(this.Nq.aW(Object(v.a)(this,this.VGb,"onActiveSlideDomChanged")),this.Vb.Ba=w):(this.Bd.state=5,this.Bd.Nsb=!0,this.Bd.lm.slideIndex=this.Bd.lm.slideIndex>T?T+this.Bd.Qya:T,this.Bd.lm.LR=0,this.Bd.lm.paragraphIndex=0,this.Bd.lm.yga=-1,this.Bd.lm.w6=-1,this.Sed())):this.n_g()?this.t9f():this.o3b()}}VGb(){Cc.a.J(512496408,
820,50,"OnActiveSlideDomChanged");this.Nq.ioa(Object(v.a)(this,this.VGb,"onActiveSlideDomChanged"));this.SYc()||this.QHa||(this.QHa=new Kd.a(3,1,0,Object(v.a)(this,this.rIe,"onPostActiveSlideDomChangedTask"),90,"30"),this.zb.Db(this.QHa))}rIe(){Cc.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.QHa=null;if(!this.SYc())if(4===this.Bd.state){const w=this.WNd;this.Bd.lm.slideIndex=this.Bd.lm.slideIndex>w?w+this.Bd.Qya:w;this.Bd.state=5;this.Bd.Nsb=!0;this.Sed()}else 2===this.Bd.state?this.setSelection():
this.o3b()}Vqk(){this.SYc()||(Cc.a.J(512496406,820,50,"OnBackendFindFailed"),this.n_g()?this.t9f():this.o3b())}hEk(w,T,ea){Cc.a.J(512496405,820,50,"PerformBackendFind");this.Adc.findText(T,ea,w.toString(),Object(v.a)(this,this.Wqk,"onBackendFindSucceeded"),Object(v.a)(this,this.Vqk,"onBackendFindFailed"));this.Bd.state=4;return!0}o3b(){this.Bd.state=this.Bd.X1d?3:1;Cc.a.J(512496404,820,50,"End of Find: {0}",this.Bd.state);this.clearSelection();this.h0a(0,"")}getShapeType(w){return w.px?ResourceStrings.L_TextBox:
w.hr?ResourceStrings.l_Chart:w.ud?ResourceStrings.L_Table:w.Rf?ResourceStrings.L_SmartArt:w.Mp?ResourceStrings.L_Media:w.Fj?ResourceStrings.l_Picture:w.fl?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var w=this.Bd.dRa,T=this.Bd.T1b;if(this.Vb.Ba!==T)this.Nq.aW(Object(v.a)(this,this.VGb,"onActiveSlideDomChanged")),this.Vb.Ba=T;else{w=xk.SelectionFactory.f3(w,this.Bd.lm.yga,this.Bd.lm.w6);if(this.Yl.wFa(this.Bd.R1b))this.ia.La(Rc.a.lLa,2,new rj.a(!0)),this.Ea.tf(yj.a.T2),
this.Rva.setSelection(w),this.h0a(this.Bd.lm.slideIndex%this.oc.pj()+1,ResourceStrings.l_NotesPaneType);else{T=this.Bd.R1b;const ea=this.Bd.R1b.mg(this.Fb.Ma);if(ea)if(ea.$p){let ra;(ra=this.Bd.lm).LR=ra.LR+1;this.Bd.lm.paragraphIndex=0;this.Bd.lm.yga=0;this.Bd.lm.w6=0;ea.Fqd()}else this.cek&&T.Rf?(this.he.Feh(new xa.a(T)),this.pIa.setSelection(w)):(this.Ea.tf(vg.a.sg),this.Fb.setSelection(w));this.h0a(this.Bd.lm.slideIndex%this.oc.pj()+1,this.getShapeType(T))}Cc.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",
this.Bd.lm.slideIndex,this.Bd.lm.LR,this.Bd.lm.paragraphIndex,this.Bd.lm.yga,this.Bd.lm.w6);this.X0d()}}clearSelection(){var w=Bm.b(this.nE);if(w=w?w.Lb:null){var T=this.Bd.IYj;T&&(T=xk.SelectionFactory.Sg(T,0),w.setSelection(T))}else Cc.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}h0a(w,T){const ea=new Sys.StringBuilder,ra=new Sys.StringBuilder;let wa=!1;w!=this.O9c?(this.O9c=w,this.Uue=1):this.Uue++;switch(this.Bd.state){case 1:wa=!0;ea.append(ResourceStrings.l_FindTextNotFound);
break;case 3:ea.append(ResourceStrings.l_FindTextFindOver);break;case 6:wa=!0;ea.append(ResourceStrings.l_FindTextFindAgain);break;case 2:ra.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.Uue,w,T));break;default:Cc.a.J(512496400,820,50,"Find Text: {0}",this.Bd.state)}this.vbl(ea.toString(),wa,ra.toString());this.X0d()}Yxl(w){w=this.$_k(w);32===w&&this.M2e(this.$F,this.sfc);16===w&&(this.wm.h0a(ResourceStrings.l_ReplaceTextErrorMessage,0),this.wm.E_d(),this.wm.jRf(!0))}$_k(w){return Of.a.c2d("SingleReplaceAction",
Rc.a.h1,()=>{w||(w="",Cc.a.J(512496399,820,50,"Replacing with empty string"));var T=this.Bd.dRa;if(!T)return Cc.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var ea=this.Bd.lm.yga;const ra=this.Bd.lm.w6;if(-1===ea||-1===ra)return Cc.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const wa=this.Iq.me(15);wa.kd(T);this.jJ.replaceTextRange(sh.a.createTextRange(T,ea,ra),w,!0,!1,Rc.a.h1);T=ea+w.length;ea=T!==this.Bd.lm.w6;this.Bd.lm.w6=T;wa.dispose();
ea&&this.setSelection();return 32})}X0d(){this.wm.jRf(1===this.neb);this.oRf();this.wm.KQi(3===this.neb)}oRf(){this.Bd.dRa?this.wm.LQi(2===this.neb):this.wm.E_d()}FOf(){this.wm.KMi();this.wm.E_d();this.wm.MMi()}vbl(w,T,ea){2===this.neb?(this.wm.Xod(ResourceStrings.l_ReplaceTextReplaced+". "+ea),this.wm.Cod("")):(this.wm.Cod(ea),this.wm.Xod(""));this.wm.$Ve("");this.wm.h0a(w,T?0:1)}ETi(w,T){const ea=Of.a.yk("FindNext");ea.Va("CommandId",w.toString());ea.Va("IsReadOnlyModeEnabled",this.wm.exe.toString());
try{T()}finally{ea.finish(!0)}}Brk(){S.a.Wa(this.wm.M_a)||this.ETi(Rc.a.find,()=>{Cc.a.J(512496396,820,50,"Find Text Started");this.neb=1;this.M2e(this.wm.M_a,this.wm.matchCase);return 32})}Crk(){this.wm.hxe?(Cc.a.J(512496394,820,50,"Replace Text Started"),this.neb=2,this.Yxl(this.wm.LRe)):(this.wm.msl(),Cc.a.J(512496395,820,50,"Find dialog switched to replace dialog"),this.oRf())}Drk(w){this.XUa()?Cc.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.KEb,
Date.now()-this.KEb):S.a.Wa(this.wm.M_a)||(Lf.a("FixReplaceAllTimeOutError")&&(this.ua.presentation.Tfa=-16),this.$F=this.wm.M_a,this.Fma=w?w:"",this.KEb=Date.now(),this.neb=3,this.C_d(),this.sXi(this.ua.Ba,this.$F,this.Fma,this.sfc),0<this.dRg&&(this.j$c=window.setTimeout(()=>{this.q5g()},this.dRg)),16===this.replaceAll()&&(this.JEb=Date.now(),this.xFf(),this.q5g()))}replaceAll(){return Of.a.c2d("ReplaceAllAction",Rc.a.h1,()=>{Cc.a.J(512496392,820,50,"ReplaceAll Text Started");const w=this.ua.presentation;
if(w){const T=this.Jb.Ad(15);try{T.nc(w),this.Oeb.jk(Object(v.a)(this,this.Sgb,"onPresentationPropertyChange")),w.rKb=Object.assign(new Bl,{NewStr:this.Fma,OldStr:this.$F,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,MatchTxtInfo:Object.assign(new If,{ShouldMatchCase:this.wm.matchCase})})}finally{T&&T.dispose()}return 32}return 16})}sXi(w,T,ea,ra){if(w){w=this.oc.zl(w.Cb);var wa=this.Qb.Nc(w);w=w.lTa()||[];(wa=wa.Bb(27))&&w.push(wa);if(w.length)for(wa=0;wa<=w.length-1;)this.BYi(w[wa],
T,ea,ra),wa++}else Cc.a.J(512496391,820,50,"slide must not be null.")}BYi(w,T,ea,ra){if(this.Yl.wFa(w)||!w.DC)for(w=cl.a.createInstance(w);w.moveNext();){const wa=w.currentNode;if(!ig.ParagraphReader.$d(wa))continue;let Za=null;(Za=this.tYi(wa,T,ra))&&Za.characterData.replace(T,ea)}}tYi(w,T,ea){if(!ig.ParagraphReader.$d(w))return Cc.a.J(512496390,820,50,"node must be ParagraphNode"),null;const ra=w.Hwb();return ra.length?this.yYi(ra,T,ea)?w:null:null}yYi(w,T,ea){let ra=w,wa=T;ea||(ra=w.toLowerCase(),
wa=T.toLowerCase());return-1!==ra.indexOf(wa,0)?!0:!1}Sgb(w,T){if(!this.XUa())Cc.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(T.property===dc.a.HRe){this.xFf();w=Object(y.a)(537,T.node);if(-1!==w.Tfa){var ea=2;if(0===w.Tfa){T=ResourceStrings.l_FindTextNotFound;var ra=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;ea=0;var wa=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===w.Tfa?(T=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,w.Tfa,this.$F,
this.Fma),ra=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,w.Tfa,this.$F,this.Fma)):(T=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,w.Tfa,this.$F,this.Fma),ra=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,w.Tfa,this.$F,this.Fma)),wa=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else wa=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,T=ra=ResourceStrings.l_ReplaceAllErrorMessage,ea=0,Cc.a.J(512496388,820,
10,"Invalid ReplaceAllTextCount");this.JEb=Date.now();Cc.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.JEb-this.KEb);this.iRf(T,ea);this.Oeb.Cm(Object(v.a)(this,this.Sgb,"onPresentationPropertyChange"));this.wm.Al()&&this.kYe(wa,ra,10);w.Tfa=-16}}XUa(){return this.KEb>this.JEb}C_d(){var w=String.format(ResourceStrings.l_ReplaceAllInProgress,this.$F);this.wm.h0a(w,3);w=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,
this.$F);this.wm.$Ve(w);w=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.$F);this.wm.Xod(w);w=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.$F);this.wm.Cod(w);this.FOf()}iRf(w,T){this.wm.h0a(w,T);this.wm.$Ve(w);this.wm.Xod("");this.wm.Cod("");this.X0d()}hkl(){if(this.XUa()){var w=String.format(ResourceStrings.l_ReplaceAllInProgress,this.$F);this.kYe(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,
w,1024)}}kYe(w,T,ea){this.LL?(this.LL.I_d(),Cc.a.J(512496385,820,50,"Callout notification called for Replace All operation"),w=Object.assign(new dn.a,{title:w,message:T,timeoutInSeconds:ea}),w=this.LL.bvh(w),w.CUa&&Cc.a.J(512496384,820,10,"Error in callout notification: Error:{0}",w.message)):Cc.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}q5g(){let w=!1;this.XUa()&&(w=!0,this.JEb=Date.now());Cc.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",
w,this.JEb-this.KEb);this.iRf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.Oeb.Cm(Object(v.a)(this,this.Sgb,"onPresentationPropertyChange"));this.wm.Al()&&this.kYe(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);this.ua.presentation.Tfa=-16}xFf(){-1!==this.j$c&&(window.clearTimeout(this.j$c),this.j$c=-1)}}hi.ODe=1024;Object(n.a)(hi,"FindReplaceTextHandler",null,[510]);class Hj{constructor(w){this.AGg=this.lUg=null;this.HDb=!1;this.V4=w}findText(w,
T,ea,ra,wa){this.AGg=w;this.HDb=T;this.lUg=ea;this.V4.DF(ra,wa,null)}get oql(){return this.lUg}get matchCase(){return this.HDb}get vcd(){return this.AGg}}Object(n.a)(Hj,"FindTextManager",null,[508]);var ql=d(389),Ug=d(110);class dl extends Ug.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}Zk(){return 54}static wWd(w,T,ea){const ra=new dl;ra.SlideID=ea;ra.MatchText=w;ra.MatchCase=T;return ra}}Object(n.a)(dl,"FindTextRequest",Ug.a,[]);class yk extends ql.a{constructor(w,
T,ea,ra){super();this.MGa=this.wIa=null;this.sO=this.t4=!1;this.Dcc=null;this.Rd=ea;this.D2c=!1;this.Adc=T;this.Xa=ra;this.Mm=w;this.enabled=2;this.Mm.register(this)}DF(w,T){this.D2c=!0;this.wIa=w;this.MGa=T;this.Mm.zaa()}forceOutbound(){}tka(){return this.D2c&&!this.t4}NN(){return!1}MTa(){return this.Vd&&2===this.Vd.status?!0:this.tka()}uKb(){if(1===this._state)this.Dcc=this.Xa.podSessionId,this.Vd.JH=dl.wWd(this.Adc.value.vcd,this.Adc.value.matchCase,this.Adc.value.oql),this.Vd.status=1,this._state=
3;else if(3===this._state&&this.Vd&&2===this.Vd.status){if(2!==this.Vd.statusCode)this.DH();else{if(!this.Vd.Qr||1!==this.Vd.Qr.length){this.DH();return}const w=this.Vd.Qr[0];0===w.StatusCode?(this.R0(),this.wIa&&this.wIa(w.SlideID)):(this.DH(w),124===w.StatusCode&&this.Rd.zs(w.ServerError,this.Dcc))}this.Dcc=null}}DH(w=null){this.D2c=!1;this._state=1;Cc.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",
w?w.StatusCode:-1,this.Vd?Wd.a[this.Vd.statusCode]:"NULL",this.Vd?this.Vd.zv:-1,this.sO,this.Dcc||"NULL");this.sO=!0;this.MGa&&this.MGa(-1,-1)}R0(){this.D2c=!1;this._state=1;Cc.a.J(25012056,818,this.sO?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",this.sO,this.Dcc||"NULL");this.sO=!1}dispose(){this.t4||(1===this._state&&this.Mm.unregister(this),this.t4=!0)}}Object(n.a)(yk,"FindTextReplicator",ql.a,[106]);class el{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Zb(w){this.K=
w;this.K.register(508,"PowerPointWebEditor.IFindTextManager").ma().oa(()=>new Hj(new yk(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.ie("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(509,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().oa(()=>new lm(this.K.ie("PowerPointWebEditor.IFocusManager")));const T=new Ih.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),
this.K.resolve("PowerPointWebEditor.IRibbonPane").xa);this.K.register(510,"PowerPointWebEditor.IFindReplaceTextHandler").ma().oa(()=>new hi(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),
this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.ie("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").yd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("Common.IAppSettingsManager").Bc("ReplaceAllClientTimeoutMS",0),T))}init(){let w=new zj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"));w.wb();w.Ee()}dispose(){}static main(){oa.a.instance.Dc(Cb.a(new el,0))}}Object(n.a)(el,"PPTWebEditorFindTextPackage",null,[2,3]);class Cm{constructor(w){this.Ha=w}get yQd(){return"PowerPoint"}get ECf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get GLj(){return this.Ha.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get wAb(){return this.Ha.powerPointEditorFirstRunExperienceUIIsEnabled}get eng(){return this.Ha.powerPointEditorFirstRunExperienceTestIsEnabled}get CZi(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get UYg(){return 24}get Slh(){return 4E3}get epc(){return this.Ha.roamingServiceHandlerWebServiceBase||
""}}Object(n.a)(Cm,"FirstRunExperienceLauncherSettings",null,[608]);class am{constructor(w){this.iyg=w}Rkl(w){this.iyg&&this.iyg.sYe(w)}}Object(n.a)(am,"FirstRunExperienceManager",null,[500]);class kf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Zb(w){if(!w)throw Error.argumentNull("container");this.K=w;this.K.register(500,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().oa(()=>new am(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").gf(()=>
{this.sYe()})}dispose(){}sYe(){var w=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!w)throw Error.argumentNull("appSettings");const T=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");T&&(w=new Cm(w),T.Rkl(w))}static main(){oa.a.instance.Dc(new kf)}}Object(n.a)(kf,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var Dm=d(179),rc=d(398);class Em{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(n.a)(Em,"CatchUpConfiguration",null,[]);class Tc{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(n.a)(Tc,"SharedControllerFactoryParameters",null,[]);const df=(w,T)=>{if(!w)throw Error.create(String.format("Argument {0} is null.",T));},Aj=w=>{if(!w.navigationId)return Cc.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const T=window.atob(w.navigationId);return T&&""!==T?{["NavigationId"]:T}:null}catch(T){return Cc.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",T),null}};class ti{constructor(w){df(w,"ActivityContentManager.IActionManagerExtended");
this.ia=w}doesContentExist(w){if(!w)return Cc.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(w.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(w=Aj(w))?32===this.ia.La(Na.a.Oub,2,w):!1;default:return!1}}}Object(n.a)(ti,"ActivityContentManager",null,[501]);class rf{constructor(w){this.An=w}shouldShowEmptyExperienceButton(){return Q.AFrameworkApplication.H0c()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.An.La(Na.a.yrc,
2,null)}onInviteOthersButtonClick(){this.An.La(Na.a.Tsa,2,null)}}Object(n.a)(rf,"EmptyCatchUpBehaviorManager",null,[504]);class Ll{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(n.a)(Ll,"Person",null,[]);var ck=d(650),K=d(232),Fm=d(168);class Ml extends Ug.a{constructor(w){super();this.StartTime=null;this.StartTime=w}Zk(){return 93}}Object(n.a)(Ml,"GetFileRevisionHistoryRequest",Ug.a,[]);class cj{constructor(w,T,ea){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=w;this.UserId=T;this.ProviderId=ea}}Object(n.a)(cj,"Author",null,[]);const xi=(w,T)=>w&&T?w.providerIdField===T.ProviderId?w.userIdField===T.UserId:w.userNameField===T.UserName:!1;var jj=d(246);class kj{constructor(w,T,ea){this.y5c=this.icb=null;this.vi=w;this.wcb=ea;this.wcb.d$h(Object(v.a)(this,this.o3g,"onFileRevisionHistoryReady"));T.gf(()=>{this.icb=new cj(T.Ga("UserName"),T.Ga("387"),T.Ga("388"))})}dispose(){this.wcb.HYk(Object(v.a)(this,this.o3g,
"onFileRevisionHistoryReady"));this.icb=null}A9i(w,T,ea){w&&ea&&(this.y5c=ea,w=new jj.a(new Ml(w),ra=>{this.Oqg(ra,T);this.Wfd(ra)},ra=>{this.Oqg(ra,T);return this.Ugb(ra)}),this.vi.Db(w))}o3g(w,T){w=null;const ea=[];S.a.Wa(T.GPc)||(({GPc:T}=this.Hzl(T.GPc)).returnValue?Fm.b(T.fileRevisionEntriesField,ra=>this.SQj(ra.changesDataField),ra=>{ea.push(ra.changesDataField)}):w="ErrorGetFileRevisionHistoryParseJsonException");this.wHe(ea,w)}Wfd(w){let T=null;w.ServerError&&0!==w.ServerError.Code?T=K.a[w.ServerError.Code]:
0!==w.StatusCode&&(T=ck.a[w.StatusCode]);T&&this.wHe(null,T)}Ugb(w){Cc.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+w.toString());this.wHe(null,"ErrorGetFileRevisionHistoryFailed");return!0}wHe(w,T){this.y5c&&(w=this.A2i(w),this.y5c(w,T),this.y5c=null)}Hzl(w){let T;T=null;try{T=Sys.Serialization.JavaScriptSerializer.deserialize(w)}catch(ea){Cc.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+ea)}return{returnValue:!!T,GPc:T}}SQj(w){return!xi(w,this.icb)}Oqg(w,T){w.cya&&
T.Xm("GetAuthorNamesRequestInvokedTime",w.cya);T.Va("GetAuthorNamesRequestCorrelationId",w.Jh)}A2i(w){if(!w)return[];const T=Array(w.length);for(let ra=0;ra<w.length;ra++){var ea=w[ra];ea=Object.assign(new Ll,{displayName:ea.userNameField,id:ea.userIdField,provider:ea.providerIdField});T[ra]=ea}return T}}Object(n.a)(kj,"FileRevisionHistoryService",null,[607,106]);class zh{constructor(w,T){df(w,"FlyoutFocus.IF6Manager");df(T,"FlyoutFocus.IFocusManagerHelper");this.Og=w;this.oE=T}initialize(){this.oE.X8(vg.a.S6a,
vg.a.gj,null,Object(v.a)(this,this.$Zi,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.Og.pI(vg.a.S6a)}disableF6Focus(){this.Og.Ko(vg.a.S6a)}$Zi(){const w=document.getElementById("flyoutItem0");w&&(Cc.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),w.focus())}}Object(n.a)(zh,"FlyoutFocus",null,[566]);class Mn{constructor(w,T,ea,ra){this.i3c=null;this.gtg=this.yzg=this.TCb=this.K6c=!1;df(T,"FlyoutRibbonButton.IActionManagerExtended");df(ea,"FlyoutRibbonButton.IFocusManager");
df(ra,"FlyoutRibbonButton.FloodgateEventLogger");this.Rb=w;this.ia=T;this.Ea=ea;this.u8j=ra;this.y8j=new Date}initialize(){Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Lf.a("DelayRegisterCatchUpActions")||this.wb()}registerButtonClickedEvent(w){this.i3c&&Cc.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.i3c=w.buttonClickedCallback}onFlyoutInitialized(){this.K6c&&Cc.a.J(571532948,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const w=(new Date).getTime()-this.y8j.getTime();Cc.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",w);this.K6c=!0;kd.c(Na.a.Tpi,!0,kd.e,0,0,w);Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Lf.a("DelayRegisterCatchUpActions")&&this.wb();this.Rb&&this.Rb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(w){this.TCb!==w.flyoutIsVisible&&
(this.TCb=w.flyoutIsVisible,this.Rb&&this.Rb.updateCommandUI(!0),this.TCb&&this.gtg?this.Ea.tf(vg.a.S6a):this.TCb||this.Ea.tf(vg.a.gj),this.TCb||this.u8j.B1j())}wb(){this.ia.ya(Na.a.gCh,Gb.a.frame,Object(v.a)(this,this.Hyk,"onToggleCatchUpFlyout"));this.ia.ra(Na.a.Gdh,Gb.a.frame,Object(v.a)(this,this.rwk,"onQueryToggleCatchUpFlyout"),96)}Hyk(w,T,ea){if(1===ea)return this.K6c?(this.yzg||(this.yzg=!0,Cc.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.i3c)return 8;this.gtg=!0;this.i3c();
return 32}rwk(w,T,ea,ra,wa){wa[Dh.a.Visible]=!0;wa[Dh.a.On]=this.TCb&&this.K6c;return 32}}Object(n.a)(Mn,"FlyoutRibbonButton",null,[565]);const dk=w=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+w)};class Se{constructor(w,T,ea,ra,wa,Za){df(w,"PowerPointActivityNavigationManager.IActionManagerExtended");df(T,"PowerPointActivityNavigationManager.IPresentationReader");df(ea,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");
df(ra,"PowerPointActivityNavigationManager.IRibbonUser");df(Za,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=w;this.oc=T;this.Ge=ea;this.pB=ra;this.lfk=wa;this.p5j=Za}navigateToActivity(w){if(w.fromSummaryString)return this.wal(),this.wpj(),this.tpj(),this.kkl(),Promise.resolve(1);w=w.activity;if(!w)return Cc.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!w.navigationId)return Cc.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),
Promise.resolve(4);if(!this.p5j.doesContentExist(w))return Promise.resolve(2);switch(w.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:w=Aj(w);if(!w)return Promise.resolve(5);w=this.ia.La(Na.a.s0b,2,w);return Promise.resolve(32===w?1:6);default:return Promise.resolve(7)}}wal(){const w=this.oc.Ym;w?w.CDa=!0:Cc.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}wpj(){this.pB.selectRibbonTabById(this.lfk)}tpj(){var w=this.oc.Ym;if(w&&w.slides){var T=
null;for(const ea of w.slides)if(ea&&(w=this.oc.zl(ea.Cb))&&w.isUnread){T=w;break}T?(this.Ge.Dod(),this.Ge.GJ(T.le)):Cc.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Cc.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}kkl(){this.ia.La(Rc.a.rkb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(n.a)(Se,"PowerPointActivityNavigationManager",null,[502]);var Bg;(function(w){w[w.default=0]="default";w[w.D48X48=
1]="D48X48";w[w.D64X64=2]="D64X64";w[w.D96X96=3]="D96X96";w[w.D120X120=4]="D120X120";w[w.D240X240=5]="D240X240";w[w.D360X360=6]="D360X360";w[w.D432X432=7]="D432X432";w[w.D504X504=8]="D504X504";w[w.D648X648=9]="D648X648"})(Bg||(Bg={}));Object(n.b)("ProfilePhotoDimension",Bg);var Ci=d(919),jf;(function(w){w[w.canvasPresence=0]="canvasPresence";w[w.coauthGallery=1]="coauthGallery";w[w.comment=2]="comment";w[w.ip=3]="ip";w[w.thumbnailPresence=4]="thumbnailPresence";w[w.trackChange=5]="trackChange";w[w.catchUpFlyout=
6]="catchUpFlyout"})(jf||(jf={}));Object(n.b)("PersonSourceType",jf);class yi{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(n.a)(yi,"ActivityFeedItem",null,[]);class Cl{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(n.a)(Cl,"ActivityFeedPayload",null,[]);class Ud{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=
null}}Object(n.a)(Ud,"ActivityRequestPayload",null,[]);var ag=d(535);class Jf{constructor(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(n.a)(Jf,"Activity",null,[]);class Gm{}Object(n.a)(Gm,"FeedItemPayloadActor",null,[]);class Dc{}Object(n.a)(Dc,"FeedItemPayload",null,[]);class Dl{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc){this.Qf=this.Xxe=null;df(w,"PowerPointActivityRequestManager.IJsonpHelperManager");
df(T,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");df(ea,"PowerPointActivityRequestManager.IFileRevisionHistoryService");df(ra,"PowerPointActivityRequestManager.IAppSettingsManager");df(wa,"PowerPointActivityRequestManager.IApplicationSettings");df(Za,"PowerPointActivityRequestManager.IActionManagerExtended");df(ub,"PowerPointActivityRequestManager.ICatchUpRequestHandler");df(zb,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");df(tc,"PowerPointActivityRequestManager.IPeopleColorUtils");
this.kHa=w;this.Vik=T;this.m8j=ea;this.Pb=ra;this.ia=Za;this.p3c=ub;this.sek=zb;this.i9c=tc;this.PSg=pc}requestWYWAActivities(){return new Promise((w,T)=>{this.Qf=Of.a.yk("ShowWYWACallout",2);this.Vik.i3k(ea=>{ea=this.zKk(ea);Dl.isExpectedError(ea)?w(Dl.CMc):ea?(Cc.a.J(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",ea),T(ea)):this.m8j.A9i(this.Xxe,this.Qf,(ra,wa)=>{wa&&(Cc.a.J(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",wa),T(wa));w(Dl.eAi(ra))})},ea=>{const ra=!!ea.data&&
Dl.IMj(ea.data.oe);ea=this.kHa.cka(ea);Cc.a.J(509223007,3012,ra?50:10,"OnReadRoamingFailed() - Error: {0}",ea);ra?w(Dl.CMc):T(ea)})})}requestActivities(){return Promise.resolve(Dl.CMc)}requestRelevantActivities(){return Promise.resolve(Dl.CMc)}requestActivityFeed(){return this.p3c?ag.b(this.p3c.getActivityFeed(this.PSg)).then(w=>{w=Dl.oxl(w);return{activityFeedItems:h(w,this.sek),personaColorMap:e(w,this.i9c)}}):Promise.resolve(Object.assign(new Cl,{activityFeedItems:[]}))}updateActivityState(w){return this.p3c?
ag.b(this.p3c.$Bl(this.PSg,w.itemIds,w.activityStatesToSet||0,w.activityStatesToReset||0,w.resetUnseenCount)):Promise.resolve(!1)}zKk(w){w=w.data.Sd;if(!w)return"ErrorReadRoamingEmptyResponseBody";let T;try{T=JSON.parse(w)}catch(ea){return ea.toString()}w=null;if(!T.Error){if(!T.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");w=T.Timestamp}this.Xxe=this.kGl(w);Cc.a.J(509223006,3012,100,"Timestamp for retrieving activities: "+this.Xxe);return T.Error}kGl(w){const T=
{};var ea=this.Pb.Bc("AppWaterlineOverrideTimestampValue",0);return ea?(w=new Date(1E3*ea),T.timestamp=w,this.ia.La(Rc.a.Kqd,2,T),w.format("yyyy-MM-ddTHH:mm:ssZ")):w?(ea=this.Pb.Bc("AppWaterlineOverrideDaysValue",0))?(w=new Date(+new Date(w)-+new Date(864E5*ea)),T.timestamp=w,this.ia.La(Rc.a.Kqd,2,T),w.format("yyyy-MM-ddTHH:mm:ssZ")):w:null}static eAi(w){return w?Object.assign(new Ud,{actors:w}):null}static oxl(w){const T=[];if(!w)return T;for(const ea of w)T.push(Object.assign(new yi,{id:ea.id,type:ea.type,
collectionId:ea.collectionId,activityState:ea.activityState,activityFeedItemPayload:ea.activityFeedItemPayload,timestamp:ea.timestamp}));return T}static isExpectedError(w){return"ErrorDocNotInRoamingList"===w||"ErrorLastViewedDocListIsEmpty"===w}static IMj(w){return 403===w}}Dl.CMc=Object.assign(new Ud,{activities:[],actors:[],hasMore:!1,highWaterline:"",lowWaterline:"",wywaWaterline:""});Object.assign(new Ud,{activities:[Object.assign(new Jf,{activityId:"activityId1",type:3,actors:[Object.assign(new Ll,
{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new Jf,{activityId:"activityId2",type:4,actors:[Object.assign(new Ll,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});Object.assign(new Cl,{activityFeedItems:[Object.assign(new yi,{id:"FeedItemId1",type:"UserAtMentioned",
collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new yi,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(n.a)(Dl,"PowerPointActivityRequestManager",null,[503]);var Nl=d(260);class Xh{constructor(w,T,ea,ra,wa,Za){this.Jdb=!1;this.$Fg=null;this.Oc=w;this.Ds=T;this.ufk=ea;this.kHa=ra;this.zb=wa;this.cFb=Za}initialize(){this.Oc&&(this.Oc.JPa(Object(v.a)(this,this.YGb,"onBeforeSessionEnd")),this.Oc.KA(Object(v.a)(this,this.qM,"onSessionClosed")));this.c6k()}i3k(w,T){const ea=this.O5f("getPPTDocLastViewedTimestamp");this.Lx(ea,1,w,T)}YGb(){this.ZJh()}qM(){this.Jdb=
!0}c6k(){if(this.zb){var w=new Kd.a(3,2,3E4,Object(v.a)(this,this.h1k,"requestWriteWaterline"),90,"29");this.zb.Db(w)}}h1k(){!this.Jdb&&3E4<+Of.a.Mac-+this.$Fg&&(this.ZJh(),this.$Fg=Of.a.Mac)}ZJh(){const w=this.O5f("savePPTDocLastViewedTimestamp");this.cFb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.Ds.LKa(w,""):this.Lx(w,2,Object(v.a)(this,this.qzk,"onWriteWaterlineSucceeded"),Object(v.a)(this,this.pzk,"onWriteWaterlineFailed"))}qzk(w){let T=null;try{const ea=w.data.Sd;T=ea?JSON.parse(ea).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(ea){T="ErrorWriteRoamingParseJsonResponseException",Cc.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+ea)}finally{T&&this.drg(T)}Cc.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+w.data.pv-+w.data.yI,+w.data.Xt-+w.data.yI)}pzk(w){this.drg("ErrorReadRoamingFailed");Cc.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.kHa.cka(w))}O5f(w){return this.ufk+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
w,Q.AFrameworkApplication.gh)}Lx(w,T,ea,ra){const wa={};wa["X-StatelessPopsAffinityRoutingEnabled"]=this.cFb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Ds.mj(w,T,null,wa,!1,1,ea,ra,null,void 0,void 0,void 0,void 0,Nl.a("5"))}drg(w){Cc.a.J(572555924,811,50,w)}}Object(n.a)(Xh,"PowerPointWaterlineUpdater",null,[]);class th{get name(){return"PowerPointWebEditor.Activity"}get lie(){return Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").gf(Object(v.a)(this,this.uKi,"delayedInit"))}Zb(w){this.K=w}dispose(){this.K=this.o3c=null}fhl(w){return!w||w.ka("IsAnonymousUser")?!1:w.ka("PPTCatchUpFlyoutIsEnabled")}uKi(){const w=this.K.resolve("Common.IAppSettingsManager");this.fhl(w)&&(dk("Begin"),this.MOi(),this.h2j())}MOi(){Dm.a.get_instance().ek(7,()=>{dk("ScriptDownload");uk.a(this.K)("catchUpActivity").catch(()=>{Cc.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.KCj()).catch(()=>{Cc.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}h2j(){Cc.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.lie&&Cc.a.J(526718752,3012,50,"ActivityFeedData is enabled")}KCj(){const w=new kj(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),T=this.K.resolve("Common.AFrameworkApplication");this.K.register(Xh,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().oa(()=>new Xh(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Q.AFrameworkApplication.Ke,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(501,"Common.App.CatchUpActivity.IActivityContentManager").ma().oa(()=>new ti(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(502,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().oa(()=>new Se(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Uc.a.BQk,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let ea=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").vg&&
(ea=this.K.resolve("Common.IAppSettingsManager").Ga("368")+"p");this.K.register(503,"Common.App.CatchUpActivity.IActivityRequestManager").ma().oa(()=>new Dl(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),w,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
this.K.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.K.resolve("Common.App.People.IPeopleColorUtils"),ea));this.K.register(Mn,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().oa(()=>new Mn(T.wq,Q.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(zh,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().oa(()=>
new zh(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));this.K.register(504,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().oa(()=>new rf(this.K.resolve("Common.IActionManagerExtended")));this.o3c=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new Tc,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:Q.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.lie?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:Q.AFrameworkApplication.uiCulture,ulsLogger:new rc.a}));if(!this.o3c)return Promise.reject("Failure to create CatchUpApp");
this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.o3c.setWebpackPublicPath(Q.AFrameworkApplication.nga);dk("InitializeCatchUpApp");return this.o3c.initialize(Object.assign(new Em,{activityFeedDataEnabled:this.lie,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){oa.a.instance.Dc(Cb.a(new th,
0))}}Object(n.a)(th,"PPTWebEditorActivityPackage",null,[2,3]);var Li=d(732);class $g extends Sys.EventArgs{constructor(w,T){super();this.shape=w;this.CDa=T}}Object(n.a)($g,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class L{constructor(w,T,ea,ra,wa,Za,ub){this.Qf=null;this.ia=w;this.ua=T;this.mR=ea;this.C$c=ra;this.Tb=wa;this.Lc=Za;this.afb=ub}dispose(){this.Qf&&(this.Qf=null)}Ee(){}wb(){this.ia.ya(Rc.a.DDe,yg.a.application,Object(v.a)(this,this.ltj,"handleMarkAsRead"));this.ia.ya(Rc.a.rkb,
yg.a.application,Object(v.a)(this,this.kwj,"handleShowHideChanges"));this.ia.ra(Rc.a.cOe,Ic.a.application,Object(v.a)(this,this.Suj,"handleQueryShowHideChanges"),96);this.ia.ra(Rc.a.Kqd,yg.a.application,Object(v.a)(this,this.lwj,"handleShowRevisionTrackingWithUrlOverrides"),96)}ltj(w,T,ea,ra,wa){if(1===ea)return this.Tb.pj()?32:8;w=new Date;if(!wa)throw Error.argumentNull("actionData is null");if(wa.SlideNode){if(wa=Object(y.a)(116,wa.SlideNode))Cc.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",
wa.slideIndex+1)),this.mR.Bac?this.mR.qcd(wa,!0):(wa.iX=w,this.mR.WPe(wa))}else this.EDe(w);return 32}EDe(w){const T=this.ua.presentation;if(!T)throw Error.argumentNull("Presentation is null");this.Qf=Of.a.yk("MarkActivitiesAsRead",1);Cc.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.mR.Bac?this.mR.EDe():(Fm.b(T.slides||[],null,ea=>{if(ea=Object(y.a)(116,ea))ea.iX=w}),this.mR.bgh())}kwj(w,T,ea,ra,wa){if(1===ea)return this.Tb.pj()?32:8;const Za=this.Tb.Ym;
w=this.ua.Ba;if(!(Za&&w&&w.isConnected&&wa))return 16;ea=T=!1;switch(wa.ShowRevisionTrackingStatus){case 0:ea=T=!1;break;case 2:T=!0;ea=!1;break;case 3:ea=T=!0;break;case 1:T=Za.CDa&&!this.mR.pVd?!0:!Za.CDa;ea=!0;break;default:return 8}if(this.mR.pVd&&!ea)return 32;wa=wa.InvokeSource;Za.CDa=T;this.mR.pVd=T&&ea;ea&&this.afb.N3j(wa,T);wa=w.Ek();Fm.b(wa,null,ub=>{this.C$c.zPk(new $g(ub,Za.CDa))});this.Lc.Dy(new wk.a(1));return 32}Suj(w,T,ea,ra,wa){w=this.Tb.Ym;if(!w)return 16;wa.Mf(w.CDa);return 32}lwj(w,
T,ea,ra,wa){w=this.ua.presentation;if(!wa||!w||!w.slides)return 8;wa=wa.timestamp;if(!wa)return 8;for(const Za of w.slides)Object(y.a)(116,Za).iX=wa;this.mR.XPe(w.slides);return 32}}Object(n.a)(L,"RevisionTrackingActor",null,[352,106]);class M{constructor(w){this.backgroundColor=this.foregroundColor=null;w&&w.isInHighContrastMode&&w.highContrastColors?(this.foregroundColor=w.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=w.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=
this.foregroundColor="#006BFF"}}Object(n.a)(M,"RevisionTrackingColorProvider",null,[]);class Ja{constructor(){this.va=new ge.a}DPk(w){this.va.raiseEvent("SlideUSC",w)}IPd(w){this.va.addHandler("SlideUSC",w)}oRe(w){this.va.removeHandler("SlideUSC",w)}gPk(w){this.va.raiseEvent("ShapeUSC",w)}Dai(w){this.va.addHandler("ShapeUSC",w)}DZk(w){this.va.removeHandler("ShapeUSC",w)}zPk(w){this.va.raiseEvent("ShowHideSC",w)}Oai(w){this.va.addHandler("ShowHideSC",w)}KZk(w){this.va.removeHandler("ShowHideSC",w)}}
Object(n.a)(Ja,"RevisionTrackingEventSource",null,[610,611,612]);class pb extends Sys.EventArgs{constructor(w,T){super();this.shape=w;this.slide=T}}Object(n.a)(pb,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Tb{constructor(){this.cid=this.sid=0}}Object(n.a)(Tb,"Slide",null,[]);class Wc{constructor(w,T){this.dt=this.mk=null;this.mk=Object.assign(new Tb,{sid:w.sid,cid:w.cid});this.dt=T}}Object(n.a)(Wc,"SlideLastViewedVersion",null,[]);class sd{constructor(){this.v=0;this.lv=this.defLv=
null;this.v=1}}Object(n.a)(sd,"SlideLastViewedVersions",null,[]);class Ed extends Sys.EventArgs{constructor(w){super();this.slide=w}}Object(n.a)(Ed,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class ee{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc,$c,gd,md,Sc){this.Ecb=this.icb=null;this.hyg=!1;this.Uve=null;this.N7c=0;this.zDb=this.cfc=null;this.Fze=[];this.R9c=null;this.$$c=!1;this.Kxa=null;this.Cbe=this.Bbe=this.pVd=!1;Cc.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");
this.PAe=w;this.ua=T;this.zb=ea;this.jc=ra;this.Tb=wa;this.qd=Za;this.eic=ub;this.Oc=zb;this.Qk=tc;this.C$c=bc;this.YSg=pc;this.Pb=$c;this.ajk=yc.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.jEg=yc.jTj;this.oTg=!0;this.xH=!1;this.$Ha=new Wa.a;this.Oc.IGc(Object(v.a)(this,this.Fna,"onSessionAccessTokenExpired"));Q.AFrameworkApplication.Yz&&this.Oc.LGc(Object(v.a)(this,this.zfa,"onWopiTokenRefreshed"));this.Pb.gf(()=>{this.Bbe=!0;this.initialize();this.bgh();this.Bbe=!1});this.afb=gd;
this.Fb=md;this.qgk=Sc}get Bac(){return Lf.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.icb&&(this.qd.ioa(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.qd.uoc(Object(v.a)(this,this.Gna,"onShapeViewElementAdded")),this.eic.WQe(Object(v.a)(this,this.Ogb,"onMarkedUndo")),this.Oc.kRe(Object(v.a)(this,this.YGb,"onBeforeSessionEnd")),this.Oc.paa(Object(v.a)(this,this.qM,"onSessionClosed")),this.Oc.Sfa(Object(v.a)(this,this.Do,"onSessionRehydrated")),this.Qk.OZk(Object(v.a)(this,
this.f6g,"onSlideChangesDataChanged")),this.Qk.tZk(Object(v.a)(this,this.e5g,"onPresentationLastModifiedTimeReceived")),this.jEg&&this.YSg.Cm(Object(v.a)(this,this.S5g,"onShapePropertyChanged")),this.Oc.Pih(Object(v.a)(this,this.Fna,"onSessionAccessTokenExpired")))}initialize(){Cc.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.Uve=new Date;this.N7c=this.Uve.getTime();this.z9k();this.qd.aW(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.qd.grb(Object(v.a)(this,
this.Gna,"onShapeViewElementAdded"));this.eic.KYb(Object(v.a)(this,this.Ogb,"onMarkedUndo"));this.Oc.JPa(Object(v.a)(this,this.YGb,"onBeforeSessionEnd"));this.Oc.KA(Object(v.a)(this,this.qM,"onSessionClosed"));this.Oc.fC(Object(v.a)(this,this.Do,"onSessionRehydrated"));this.Qk.Uai(Object(v.a)(this,this.f6g,"onSlideChangesDataChanged"));this.Qk.iai(Object(v.a)(this,this.e5g,"onPresentationLastModifiedTimeReceived"));this.jEg&&this.YSg.jk(Object(v.a)(this,this.S5g,"onShapePropertyChanged"));this.Kxa=
this.ua.Ba;this.Ecb=this.G7i();this.getSlideLastViewedVersions();const w=new Kd.a(3,2,this.ajk,()=>{this.getSlideLastViewedVersions()},90,"12");this.zb.Db(w)}onActiveSlideDomReady(w,T){w=Object(y.a)(116,T.Ba);this.Kxa&&w!==this.Kxa&&this.zXe()&&(this.Kxa.isConnected&&(this.Kxa.isUnread&&this.qcd(this.Kxa,!0),!this.Bac&&this.Kxa.changesData&&(this.Kxa.iX=this.Kxa.changesData.dtField)),w&&w.isUnread&&this.lgh(w));this.Kxa=w;this.N7c=Date.now()}Ogb(w,T){T.actionId!==qd.a.fUa&&T.Bzb&&(w=this.ua.Ba)&&
w.isConnected&&w.isUnread&&this.zXe()&&this.qcd(w,!0)}YGb(){this.zXe()&&this.ZBl();this.Uvd()}qM(){this.afb.log();this.xH=!0}Do(){this.xH=!1;this.cfc&&this.SFh(this.cfc)}SFh(w){var T=this.ua.presentation;if(!T)throw Error.argumentNull("Presentation is null");T=T.slides||[];0<T.length&&(this.FFl(T,w),this.XPe(T))}ywk(w){this.Cbe=!0;Cc.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");w&&(this.$Ha=new Wa.a,this.forEach(w.lv,ra=>{const wa=ra.mk.sid;(!this.$Ha.Hb(wa)||this.$Ha.ga(wa).dt<ra.dt)&&
this.$Ha.$(wa,ra)}));const T=Of.a.Mac;let ea=!1;this.zDb&&this.PAe.FXj&&T!==this.zDb&&(this.cfc&&X.c(this.XYf())===X.c(this.cfc)||(ea=!0));w&&w.defLv&&(this.Ecb=w.defLv,this.oTg=!1,w.lv&&0<w.lv.length&&this.SFh(w));ea&&this.Uvd();this.zDb=Of.a.Mac;this.Cbe=!1}f6g(w,T){this.forEach(T.slides,ea=>{this.Kie(ea.changesData)||(this.ua.Ba&&ea.Cb!==this.ua.Ba.Cb||this.Cyj(Object(y.a)(116,ea)))&&this.WPe(Object(y.a)(116,ea))})}e5g(w,T){this.oTg&&(this.Ecb=T.YIk)}S5g(w,T){w=T.property;T=Object(y.a)(4,T.node);
w===dc.a.NKb&&(w=this.jc.kg(T),w===this.ua.Ba&&w.isUnread&&T.changesData.dtField<=w.changesData.dtField&&(Cc.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.N7c),this.VPe(this.ua.Ba,T)))}Gna(w,T){w=T.Jw.shapeNode;this.ua.Ba.isUnread&&this.LFa(this.ua.Ba.Cb,w)&&!this.Kie(w.changesData)&&(this.Fze.push(w),this.R9c||(this.R9c=new Kd.a(2,1,0,Object(v.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),
90,"13"),this.zb.Db(this.R9c)))}getSlideLastViewedVersions(){this.xH||this.$$c||this.PAe.getSlideLastViewedVersionInfo(Object(v.a)(this,this.ywk,"onReceiveLastViewedVersionInfo"))}Uvd(){if(!this.xH&&!this.$$c){var w=this.XYf();this.PAe.putSlideLastViewedVersionInfo(w);this.cfc=w}}XYf(){const w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");const T=Object.assign(new sd,{defLv:this.Ecb}),ea=[];this.forEach(w.slides||[],ra=>{ra=ra.Cb;const wa=this.Tb.zl(ra);wa&&wa.iX&&(!ra.cid&&
this.$Ha.Hb(ra.sid)?ra=Mh.a.UE(ra.sid,this.$Ha.ga(ra.sid).mk.cid):ra.cid&&this.$Ha.Hb(ra.sid)&&ra.cid!==this.$Ha.ga(ra.sid).mk.cid&&Cc.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",ra.sid,this.$Ha.ga(ra.sid),ra.cid),ea.push(new Wc(ra,wa.iX)))});T.lv=ea;return T}FFl(w,T){const ea=T.lv;this.forEach(w,ra=>{const wa=Object(y.a)(116,ra);this.forEach(ea,Za=>{wa&&this.Ffi(wa,Za.mk)&&(!wa.iX||wa.iX<Za.dt)&&(wa.iX=Za.dt)})})}Ffi(w,T){return w.cid&&T.cid?w.sid===
T.sid&&w.cid===T.cid:w.sid===T.sid}XPe(w){this.forEach(w,T=>{this.WPe(Object(y.a)(116,T))})}bgh(){var w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");w=w.slides||[];0<w.length&&this.XPe(w)}lgh(w){this.rJh(w,T=>{this.VPe(w,T)})}WPe(w){if(w&&w.isConnected&&w.changesData){const T=this.xYc(w.changesData,this.dTc(w));T!==w.isUnread&&(this.SXg(w,T),this.Tzl(),w===this.ua.Ba&&this.lgh(w))}}VPe(w,T){if(T&&T.isConnected&&T.Sa(dc.a.NKb)){const ea=this.xYc(T.changesData,this.dTc(w));
this.QXg(w,T,ea)}}QXg(w,T,ea){ea!==T.isUnread&&(Cc.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",T.isUnread,ea),T.isUnread=ea,this.C$c.gPk(new pb(T,w)))}SXg(w,T){T!==w.isUnread&&(Cc.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",w.isUnread,T,w.Cb.toString()),w.isUnread=T,this.C$c.DPk(new Ed(w)))}qcd(w,T){if(this.Bac){if(!w)throw Error.argumentNull("ISlideNode is null");this.EFl(w);Cc.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",
w.Cb.toString(),w.isUnread,T);if(!w.isUnread)return!1}this.rJh(w,ea=>{this.QXg(w,ea,!1)});this.SXg(w,!1);this.Bac&&T&&this.Uvd();return!0}EDe(){const w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");let T=!1;this.forEach(w.slides,ea=>{ea=this.qcd(Object(y.a)(116,ea),!1);T||(T=ea)});Cc.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",T);T&&this.Uvd()}rJh(w,T){w&&(w=w.Ek(),this.forEach(w,ea=>{T(ea)}))}forEach(w,T){Fm.b(w,null,T)}Kie(w){return xi(w,
this.icb)}xYc(w,T){return!!w&&!!w.dtField&&!this.Kie(w)&&w.dtField>T}G7i(){const w=this.Tb.Ym;if(w&&w.TLe)return w.TLe;Cc.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}chg(w){const T=Object(y.a)(116,this.qgk.G6f(w));return T&&T.isUnread&&w&&this.xYc(w.changesData,this.dTc(T))}z9k(){this.icb=new cj(this.Pb.Ga("UserName"),this.Pb.Ga("387"),this.Pb.Ga("388"))}EFl(w){w.iX=w&&w.changesData?w.changesData.dtField:this.Ecb}ZBl(){const w=this.ua.Ba;w&&(w.iX=w.changesData?
w.changesData.dtField:this.Ecb)}dTc(w){return w.iX||this.Ecb}Tzl(){this.hyg||(this.hyg=!0,Cc.a.J(512262741,804,50,"First revision tracking view render completed!"))}Cyj(w){return w.isConnected&&w.changesData&&w.changesData.dtField?w.changesData.dtField<=this.Uve&&this.xYc(w.changesData,this.dTc(w)):!1}LFa(w,T){return w.equals(T.slideId)}tryHighlightInsertedShapes(){Cc.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-
this.N7c);this.R9c=null;const w=this.ua.Ba;if(w&&w.isUnread){const T=w.Cb;for(const ea of this.Fze)this.LFa(T,ea)&&this.VPe(w,ea)}Array.clear(this.Fze)}Fna(){this.$$c=!0}zfa(w,T){try{T.t0c?(Cc.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),this.$$c=!1):Cc.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(ea){Cc.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",ea)}}zXe(){return 1!==
this.Fb.Fl}}Object(n.a)(ee,"RevisionTrackingManager",null,[]);class kb{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc){this.ua=w;this.Tb=T;this.MAe=ea;this.qd=ra;this.b5=wa;this.Fa=Za;this.y3c=ub;this.Hfb=zb;this.Te=tc;this.eHa=pc;this.K$j=bc;this.jIg=!1;this.qd.irb(Object(v.a)(this,this.j7g,"onVisibleThumbnailRangeChanged"));this.qd.KPd(Object(v.a)(this,this.uHb,"onThumbnailRefresh"));this.qd.Hai(Object(v.a)(this,this.R5g,"onShapePresenceStateChanged"));this.qd.gbi(Object(v.a)(this,this.U6g,"onThumbnailPresenceStateChanged"));
this.qd.M$h(Object(v.a)(this,this.Rxk,"onShapeViewElementShowRevisionTrackingHint"));this.qd.J$h(Object(v.a)(this,this.Kxk,"onShapeViewElementHideRevisionTrackingHint"));this.b5.IPd(Object(v.a)(this,this.iZa,"onSlideUnreadStateChanged"));this.b5.Dai(Object(v.a)(this,this.X5g,"onShapeUnreadStateChanged"));this.b5.Oai(Object(v.a)(this,this.a6g,"onShowHideStateChanged"))}dispose(){this.qd.Yih(Object(v.a)(this,this.j7g,"onVisibleThumbnailRangeChanged"));this.qd.XZk(Object(v.a)(this,this.uHb,"onThumbnailRefresh"));
this.qd.GZk(Object(v.a)(this,this.R5g,"onShapePresenceStateChanged"));this.qd.WZk(Object(v.a)(this,this.U6g,"onThumbnailPresenceStateChanged"));this.b5.oRe(Object(v.a)(this,this.iZa,"onSlideUnreadStateChanged"));this.b5.DZk(Object(v.a)(this,this.X5g,"onShapeUnreadStateChanged"));this.b5.KZk(Object(v.a)(this,this.a6g,"onShowHideStateChanged"))}j7g(){const w=this.ua.presentation;if(!w)throw Error.argumentNull("Presentation is null");Fm.b(w.slides||[],null,T=>{(T=this.Tb.zl(T.Cb))&&T.isUnread&&this.ZYe(T)})}uHb(w,
T){w=this.Tb.zl(T.QBh);w.isUnread&&this.ZYe(w)}iZa(w,T){w=T.slide;w.isUnread?this.ZYe(w):this.zXk(w)}X5g(w,T){w=T.shape;T=T.slide;w&&(w.isUnread?T===this.ua.Ba&&this.VYe(w):this.PQe(w))}R5g(w,T){w=T.shape;w.As?this.PQe(w):w.isUnread&&this.VYe(w,!0)}U6g(w,T){w=T.slide;w.As&&!this.VXe?this.EXk(w):w.isUnread&&this.Gml(w)}a6g(w,T){w=T.shape;T.CDa&&w.isUnread?this.VYe(w):this.PQe(w)}get VXe(){return this.K$j}ZYe(w){w&&w.isConnected&&this.Vud(w,T=>{T.awh();w.As&&!this.VXe||this.otf(T)})}zXk(w){w&&w.isConnected&&
this.Vud(w,T=>{T.Mhh();T.MQe()})}Gml(w){w.As&&!this.VXe||this.Vud(w,Object(v.a)(this,this.otf,"addRevisionTrackingPawnForThumbnail"))}EXk(w){this.Vud(w,T=>{T.MQe()})}ruh(){const w=this.Tb.Ym;return!this.eHa||this.eHa&&w.CDa}VYe(w,T=!1){this.ruh()&&!w.As&&w.Sa(dc.a.NKb)&&(Object(y.a)(117,w.sc(this.Te))?(this.MAe.ZG(w).display(()=>this.Fa.UTc(w)),this.xzl(),Cc.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",T)):Cc.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}PQe(w){const T=
this.MAe.IF(w);T?T.dismiss():this.ruh()&&w.isUnread&&Cc.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Vud(w,T){w&&((w=Object(y.a)(609,w.mg(this.Hfb)))?T(w):Cc.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}otf(w){w.LOd(this.y3c.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}Rxk(w,T){this.LHh(T.Jw.shapeNode,!0)}Kxk(w,T){this.LHh(T.Jw.shapeNode,!1)}LHh(w,
T){(w=this.MAe.IF(w))&&(T?w.Nya():w.t_())}xzl(){this.jIg||(this.jIg=!0,kd.c(Na.a.Upi))}}Object(n.a)(kb,"RevisionTrackingPresenter",null,[]);class cf{uKf(){const w=new de.a;w.lh(10,10);w.Eya("0 0 10 10");w.xa.setAttribute("class","ModernRevisionTrackingIconSVG");const T=new qj.a;T.r1("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");T.xa.setAttribute("class","ModernRevisionTrackingIconPath");w.appendChild(T);return w.xa}}Object(n.a)(cf,"RevisionTrackingSVGProvider",null,[499]);class Tf{constructor(){this.D$c=
this.qbd=this.pbd=this.Tye=0}p4j(){this.qbd+=1}N3j(w,T){switch(w){case 2:T&&(this.pbd+=1);break;case 0:T?(this.D$c+=1,Cc.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Cc.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:T&&(this.Tye+=1)}}log(){Cc.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",
this.Tye,this.pbd,this.qbd,this.D$c);0<this.pbd+this.qbd+this.D$c&&kd.c(Na.a.nUd)}}Object(n.a)(Tf,"RevisionTrackingTelemetry",null,[]);var zg=d(1036),ci=d(1144),ah=d(75),Qe=d(577);class Di{constructor(w,T,ea,ra,wa){this.fcb=null;this.ZHa=w;this.afb=T;this.lc=wa;this.Vb=ea;this.pa=ra;this.ZHa.bW(Object(v.a)(this,this.fG,"onInteractivityChanged"))}dispose(){this.ZHa&&this.ZHa.dispose();this.fcb=this.ZHa=null}display(w,T){this.fcb||(this.fcb=new Qe.a);this.fcb.color=w;this.fcb.userName=T;this.ZHa.Xx(this.fcb)}dismiss(){this.ZHa.RJ(this.fcb.clientId)}Nya(){this.ZHa.Lya()}t_(){this.ZHa.iga()}get HRd(){const w=
this.ZHa.Khb;return 0<w.length?w[0]:null}fG(w,T){w={InvokeSource:2,ShowRevisionTrackingStatus:null};1===T.type?(this.Vb.Ba!==this.lc?(this.lc&&(this.Vb.Ba=this.lc,this.pa.ay()),w.ShowRevisionTrackingStatus=3):w.ShowRevisionTrackingStatus=1,Q.AFrameworkApplication.Ta.La(Rc.a.rkb,2,w)):2===T.type?this.lc&&this.Vb.Ba===this.lc&&(w.ShowRevisionTrackingStatus=2,Q.AFrameworkApplication.Ta.La(Rc.a.rkb,2,w),this.afb.p4j()):3===T.type&&this.lc&&this.Vb.Ba===this.lc&&(w.ShowRevisionTrackingStatus=0,Q.AFrameworkApplication.Ta.La(Rc.a.rkb,
2,w))}}Object(n.a)(Di,"ThumbnailRevisionTrackingPawn",null,[629,106]);d(301);class pk{constructor(w,T,ea,ra,wa,Za){this.Le=w;w=ah.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");T=T.qk("pegal.png");ea=ea.uKf();this.oek=this.HHi(Q.AFrameworkApplication.isRtl,w,T,ea);this.afb=ra;this.Vb=wa;this.pa=Za}yFi(w,T){return new Di(this.oek.Ttb(w),this.afb,this.Vb,this.pa,T)}Pc(w){return this.Le.Pc(w)}HHi(w,T,ea,ra){const wa=new zg.a;wa.add(1,T);wa.add(4,ea);wa.add(6,16);wa.add(8,w);wa.add(12,
2);wa.add(11,!1);wa.add(14,ra);return new ci.a(wa)}}Object(n.a)(pk,"RevisionTrackingThumbnailGadgetsFactory",null,[498]);class ch{constructor(w,T,ea){this.M6c=this.Vec=!0;this.Ds=w;this.kHa=T;this.la=ea}get FXj(){return this.Vec}getSlideLastViewedVersionInfo(w){if(this.M6c){Cc.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var T=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
"getPPTSlideLastViewedMetadata",Q.AFrameworkApplication.gh),ea={};ea["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.mj(T,1,null,ea,!1,2,Object(v.a)(this,this.Qtk,"onGetVersionInfoSucceeded"),Object(v.a)(this,this.Ptk,"onGetVersionInfoFailed"),w,void 0,void 0,void 0,void 0,Nl.a("12"));this.M6c=!1}else Cc.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(w){if(this.Vec){Cc.a.J(25203106,
824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var T=X.c(w),ea=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;if(T.length>ea)Cc.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",w.lv.length,T.length,ea);else{ea=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",Q.AFrameworkApplication.gh);
if(Q.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Ds.LKa(ea,T);else{const ra={};ra["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Ds.mj(ea,2,T,ra,!1,2,Object(v.a)(this,this.owk,"onPutVersionInfoSucceeded"),Object(v.a)(this,this.nwk,"onPutVersionInfoFailed"),w.lv.length,void 0,void 0,void 0,void 0,Nl.a("13"))}this.Vec=!1}}else Cc.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}Qtk(w){this.M6c=
!0;let T=0;try{let ea=null;w.data.Sd&&0<w.data.Sd.trim().length&&(T=w.data.Sd.length,ea=JSON.parse(w.data.Sd,Object(v.a)(this,this.UXj,"jsonDateReviver")));const ra=w.data.state;ra(ea)}catch(ea){Cc.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",ea.toString())}w=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",T,JSON.stringify(w.data.yI),JSON.stringify(w.data.Xt),JSON.stringify(w.data.pv));Cc.a.J(25203139,824,50,
w)}Ptk(w){this.M6c=!0;w=this.kHa.cka(w);Cc.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",w)}owk(w){this.Vec=!0;Cc.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+w.data.pv-+w.data.yI,+w.data.Xt-+w.data.yI)}nwk(w){this.Vec=!0;const T=this.kHa.cka(w);Cc.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",T,w.data.state)}UXj(w,T){return"dt"===w||"defLv"===w?new Date(T):T}}Object(n.a)(ch,"RoamingCacheProxy",
null,[497,106]);var hf=d(689),Ij=d(116);class Kf{constructor(w,T,ea){this.Ag=w;this.wJ=Object(y.a)(hf.a,this.Ag.Hsh);this.y3c=T;this.Tgk=ea;this.Ag.akg=!0}display(w){let T;T=this.Tgk.uKf();this.wJ.ntf(this.y3c.backgroundColor,w,T);this.Ag.$Ob(this.y3c.foregroundColor);this.Ag.setVisibility()}dismiss(){this.wJ.clear();this.Ag.$Ob(Ij.a.none);this.Ag.setVisibility()}Jm(w){this.Ag.Jm(w)}lD(w){this.Ag.lD(w)}Yp(){return this.Ag.Yp()}LN(w){return this.Ag.azb(w)}Ox(w){this.Ag.Ox(w)}dispose(){this.Ag.dispose()}Ty(){this.Ag.Ty()}cE(w){return this.Ag.cE(w)}GB(w){return this.Ag.GB(w)}draw(w,
T){this.Ag.draw(w,T)}get visible(){return this.Ag.visible}set visible(w){this.Ag.visible=w}setPosition(w,T){this.Ag.setPosition(w,T)}Ij(w){this.Ag.Ij(w)}Qq(w){this.Ag.Qq(w)}Xu(w){this.Ag.Xu(w)}setZIndex(w){this.Ag.setZIndex(w)}NE(w,T){this.Ag.NE(w,T)}Nya(){this.wJ.Nya()}t_(){this.wJ.t_()}setSelection(){}}Object(n.a)(Kf,"ShapeRevisionTrackingView",null,[534,430,431,106]);class ne{constructor(){this.K=null;this.eHa=this.aDb=this.uO=this.I4=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Zb(w){this.K=
w;w.resolve("Common.IAppSettingsManager").gf(()=>{this.uO=w.resolve("PowerPointWebEditor.IApplicationContext").od.vg;this.aDb=w.resolve("PowerPointWebEditor.IApplicationContext").od.URj;this.I4=w.resolve("PowerPointWebEditor.IApplicationContext").od.Kle;this.eHa=w.resolve("PowerPointWebEditor.IApplicationContext").od.Jke;this.register();this.resolve()})}dispose(){this.I4&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const w=this.K;this.uO&&this.aDb&&w.register(Li.a,"PowerPointWebEditor.PodsInfoSender").ma().oa(()=>new Li.a(Q.AFrameworkApplication.Ke,w.resolve("PowerPointWebEditor.ISessionInfoOwner"),w.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),w.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),w.resolve("PowerPointWebEditor.IErrorHandler"),w.resolve("Common.ITaskManager"),w.resolve("Common.IAppSettingsManager")));
this.I4&&(w.register(Tf,"RevisionTrackingTelemetry").ma().oa(()=>new Tf),w.register(ee,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().oa(()=>new ee(w.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),w.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),w.resolve("Common.ITaskManager"),w.resolve("PowerPointWebEditor.ISlideReader"),w.resolve("PowerPointWebEditor.IPresentationReader"),w.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
w.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),w.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),w.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),w.resolve("Box4.Graph.IGraphInstance").yd(10),w.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),w.resolve("PowerPointWebEditor.IApplicationSettings"),w.resolve("Common.IAppSettingsManager"),w.resolve("RevisionTrackingTelemetry"),w.resolve("PowerPointWebEditor.View.IPPTPageView"),w.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),
w.register(kb,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().oa(()=>new kb(w.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),w.resolve("PowerPointWebEditor.IPresentationReader"),w.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),w.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),w.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),w.resolve("PowerPointWebEditor.IShapeReader"),
w.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),w.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,w.resolve("Box4.IPageView").Ma,w.resolve("PowerPointWebEditor.IApplicationSettings").Jke,w.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),w.register(497,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().oa(()=>new ch(Q.AFrameworkApplication.Ke,w.resolve("PowerPointWebEditor.IJsonpHelperManager"),w.resolve("PowerPointWebEditor.IApplicationSettings"))),
w.register(498,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().oa(()=>new pk(w.resolve("PowerPoint.IBrowserHelperManager"),w.resolve("PowerPoint.IPathManager"),w.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),w.resolve("RevisionTrackingTelemetry"),w.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),w.resolve("PowerPointWebEditor.IPptSelectionManager"))),w.register(Ja,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().oa(()=>
new Ja),w.register(397,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().oa(()=>new Pm.a((T,ea)=>{let ra=null;const wa=Object(y.a)(117,T.sc(w.resolve("Box4.IPageView").Ma));wa&&!wa.Al&&(T=w.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").uYd(w.resolve("PowerPointWebEditor.IPptSelectionManager"),(Za,ub,zb)=>w.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").DGi(Za,ub,zb,w.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
T,ea,wa.SU),ra=new Kf(T,w.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),w.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),ra.Jm(wa.SU),wa.rra(ra,1),ra.visible=wa.BQ||wa.Un);return ra})),w.register(M,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().oa(()=>new M(w.resolve("Common.Utils.IHighContrastDetector"))),w.register(499,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().oa(()=>new cf),
this.uO&&this.eHa&&w.register(L,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().oa(()=>new L(w.resolve("Common.IActionManagerExtended"),w.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),w.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),w.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),w.resolve("PowerPointWebEditor.IPresentationReader"),w.resolve("PowerPointWebEditor.View.IViewEventSource"),w.resolve("RevisionTrackingTelemetry"))))}resolve(){this.uO&&
this.aDb&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.I4&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.eHa)){const w=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");w.wb();w.Ee()}}static main(){oa.a.instance.Dc(Cb.a(new ne,0))}}Object(n.a)(ne,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var xf=d(408),wn=d(216),Nn=d(135);class en{constructor(w){this.gPa=[qd.a.Esc,qd.a.Fsc,qd.a.Gsc,qd.a.Hsc,qd.a.Isc];this.R$e=w}X0f(w){return this.R$e?this.R$e.jSc(w.Ua):null}create(w){return w?(w=this.v1b(w))?Nn.m(w):"":""}ZCi(w){w=w.suggestions;if(!w||!w.count)return null;w=({rNf:T}=this.qHi(w)).returnValue;var T=en.$Di(T);const ea=Object.assign(new xf.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:ah.getImageClassWithCluster(Q.AFrameworkApplication.PN,en.tMi),Image16by16:Q.AFrameworkApplication.rm,Menu:Object.assign(new yd.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});w&&Array.add(ea.Menu.MenuSectionList,w);Array.add(ea.Menu.MenuSectionList,T);return ea}qHi(w){let T;const ea=Object.assign(new Ma.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
T=null;for(let ra=0,wa=Math.min(this.gPa.length,w.count);ra<wa;++ra){if(!T&&""===w.ga(ra).suggestion){T=this.gPa[ra].toString();continue}const Za=Object.assign(new wn.a,{ExternalId:"btnDictationCorrectionSuggestion"+ra,Command:this.gPa[ra].toString(),LabelText:w.ga(ra).suggestion});Array.add(ea.ControlList,Za)}return ea.ControlList.length?{returnValue:ea,rNf:T}:{returnValue:null,rNf:T}}v1b(w){if(w=this.ZCi(w)){const T=Object.assign(new Ma.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(T.ControlList,w);return T}return null}static $Di(w){const T=Object.assign(new Ma.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),ea=Object.assign(new wn.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(T.ControlList,ea);w&&(w=Object.assign(new wn.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:w,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(T.ControlList,w));return T}}en.tMi="Insertaudio_16x16x32";Object(n.a)(en,"DictationCorrectionContextMenuManager",null,[533]);var Rf=d(442);class ko{constructor(w,T){this.mxc=null;this.sr=w;this.tZ=T}get key(){return"DICTATIONCORRECTION"}get e8(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(w){this.sr.$d(w.node)?this.mxc=w.node:this.mxc=null}Qtc(w){let T;T=null;if(!this.mxc)return{returnValue:!1,
KBa:T};w=this.tZ.c8i(this.mxc,w);if(!w)return{returnValue:!1,KBa:T};T=Object.assign(new Rf.a,{a1:this.key,bQ:w,description:this.h6d()});return{returnValue:!0,KBa:T}}h6d(){return Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(n.a)(ko,"DictationCorrectionDetailsProvider",null,[521,519]);var dh=d(614),zk=d(142);class dj{constructor(w,T,ea=-1){this.TriggerType="click";this.TreatedInUX=
"true";this.PhraseId=w.wEk;this.CorrectionId=w.id;switch(T){case 0:this.EditType="alternate";this.AlternateId=ea;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:m.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(n.a)(dj,"CorrectionEvent",null,[]);class xn{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(n.a)(xn,"CorrectionTelemetry",null,[]);class Jj{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(n.a)(Jj,"CorrectionsSessionTelemetry",null,[]);class Le{constructor(){this.nS=!1;this.wwd=this.eFd=0}start(){this.nS||(this.nS=!0,this.eFd=this.getTime())}stop(){this.nS&&(this.wwd+=this.getTime()-this.eFd,this.nS=!1)}get Vq(){return this.wwd+(this.nS?this.getTime()-this.eFd:0)}getTime(){return(new Date).getTime()}}Object(n.a)(Le,"DictationCorrectionsSessionTimer",null,[]);class Do{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(n.a)(Do,"SessionInfo",null,[]);class El{constructor(){this.FinalText="";this.PhraseIds=null}}Object(n.a)(El,"TextInfo",null,[]);var Mf=d(181),Be=d(130);class lo{constructor(w){this.yjf=this.PGd=this.QGd=0;this.iMh="Office.Voice.Online.DictationCorrectionsSession";this.X4a=null;this.Wpb=Object.assign(new Do,{TextInfo:[new El]});this.vcf=w}startSession(){this.X4a||(this.Wpb.StartTime=(new Date).toISOString(),
this.X4a=new Le);this.X4a.start()}pauseSession(){this.X4a.stop()}endSession(){this.X4a.stop();var w=new Mf.a;w.name=this.iMh;w.samplingPolicy=2;w.durationMs=this.X4a.Vq;w.dataFields=[];Array.add(w.dataFields,Object.assign(new Be.a,{name:"CorrectionSessionId",string:this.tya}));Array.add(w.dataFields,Object.assign(new Be.a,{name:"StartTime",string:this.Wpb.StartTime}));Array.add(w.dataFields,Object.assign(new Be.a,{name:"NumberOfCorrectionsMarked",int64:this.QGd}));Array.add(w.dataFields,Object.assign(new Be.a,
{name:"NumberOfCorrectionsMade",int64:this.PGd}));Array.add(w.dataFields,Object.assign(new Be.a,{name:"NumberOfCorrectionsDismissed",int64:this.yjf}));zk.a.sendActivityEvent(w);if(tf.App.f_&&0<tf.App.f_.p$g.length){this.Wpb.AlternateEditCount=this.PGd;this.Wpb.Duration=Math.floor(this.X4a.Vq/1E3);this.Wpb.TextInfo[0].PhraseIds=tf.App.f_.p$g;var T=new Jj;T.ClientSessionId=this.tya;T.SessionInfo=this.Wpb;if(w=this.vcf())T=X.c(T),w.nqg(T)}}wsk(w){this.QGd+=w}H2g(w,T,ea=-1){0===T?this.PGd++:1===T&&this.yjf++;
var ra=new xn;ra.ClientSessionId=this.tya;ra.CorrectionEvents=[new dj(w,T,ea)];if(w=this.vcf())ra=X.c(ra),w.nqg(ra)}get tya(){return tf.App.f_?tf.App.f_.tya:""}}Object(n.a)(lo,"DictationCorrectionsTelemetry",null,[]);var yn=d(44),ek=d(42);class Gf{constructor(w,T,ea){this.vN=w;this.Mb=T;this.QG=ea}}Object(n.a)(Gf,"DictationCorrectionRange",null,[]);var nm=d(362);class lh{constructor(w,T,ea){this.bca=this.Tq=null;this.mnb=w;this.dAa=T;this.ZBc=new nm.a(new dh.a);this.exc=ea;this.Zna()}Nhe(w){this.dAa.eDa&&
ig.ParagraphReader.$d(w)&&this.ZBc.contains(w.id)&&this.mnb.Nhe(w)}Rpl(){this.dAa.eDa=!0;this.Tq=new lo(()=>this.bca);this.Tq.startSession()}Iql(){this.dAa.eDa=!1;var w=tf.App.Kb.Kd.Dn.xg;if(w){w=w.Fh;for(let T of this.ZBc){const ea=w.Be(T);ea&&ig.ParagraphReader.$d(ea)&&this.mnb.fti(ea)}}this.exc.clear();this.ZBc.clear();this.Tq.endSession()}N2k(w){if(this.dAa.eDa){var T=w.sa(ek.a.x_d,null);if(!Bi.a.Wa(T)){var ea=new Ba.a,ra=Math.min(T.length,w.Ra.length);for(let wa=0;wa<ra;wa++){const Za=this.exc.D6i(T[wa]);
if(Za){const ub=w.Ra.ga(wa).cp;ea.add(new Gf(ub,ub+Za.source.length,Za))}}this.mnb.Qjk(w,ea)}}}s4e(w,T){if(!T)return!1;if(!this.dAa.eDa||!w)return T.add(null),!1;T.add(w.sv?w.sv.QG.key:null);return!!w.sv}q5k(w,T){this.dAa.eDa&&T&&Ob.AT(T,ea=>!!ea)?w.we(ek.a.x_d,T.toArray()):w.removeProperty(ek.a.x_d)}Egh(w){this.bca=w}Zna(){this.mnb.R8h(Object(v.a)(this,this.tsk,"onDictationCorrectionMarkerAdded"));ff.a.addHandler(window.self,ic.a.blur,()=>{this.Tq&&this.dAa.eDa&&this.Tq.pauseSession()});ff.a.addHandler(window.self,
ic.a.focus,()=>{this.Tq&&this.dAa.eDa&&this.Tq.startSession()});this.mnb.S8h(Object(v.a)(this,this.usk,"onDictationCorrectionMarkerRemoved"))}usk(w,T){this.exc.zWk(T.ZIf)}tsk(w,T){this.ZBc.add(T.EBk);this.Tq&&this.Tq.wsk(T.skk);this.exc.l5h(T.ZIf)}ssk(w,T){this.Tq&&this.Tq.H2g(w,0,T)}vsk(w){this.Tq&&this.Tq.H2g(w,1)}c8i(w,T){if(!this.dAa.eDa)return null;w=sh.a.Lj(w,T);return this.mnb.jSc(w)}}Object(n.a)(lh,"DictationCorrectionManager",null,[532]);class pe extends Sys.EventArgs{constructor(w,T){super();
this.EBk=w;this.skk=T?T.count:0;this.ZIf=T}}Object(n.a)(pe,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Ol{constructor(w,T,ea,ra,wa){this.gYh=w;this._id=T;this.UOh=ra;this.jXb=wa;this.Mt=ea;this.bUb=String.format("{0}_{1}",w,T)}get wEk(){return this.gYh}get id(){return this._id}get source(){return this.Mt}get confidence(){return this.UOh}get suggestions(){return this.jXb}get key(){return this.bUb}Blk(w){this.suggestions.addRange(w.suggestions)}}Object(n.a)(Ol,"DictationCorrectionDetails",
null,[]);class zn{constructor(w,T,ea){this.Mn=w;this.sPh=T;this.mXh=ea}get QG(){return this.sPh}get G3g(){return this.mXh}get He(){return this.Mn}ae(w){return new zn(w||this.He,this.QG,this.G3g)}}Object(n.a)(zn,"DictationCorrectionObject",null,[144]);class Pl{constructor(w,T){this.source=w;this.suggestion=T}}Object(n.a)(Pl,"DictationCorrectionSuggestion",null,[]);class Qm{constructor(w){this.fh=w;this.Pa=new ge.a}R8h(w){this.Pa.addHandler("ADCM",w)}S8h(w){this.Pa.addHandler("RDCM",w)}Qjk(w,T){this.$jk(w,
T)}$jk(w,T){if(w&&T&&T.count&&(T=Qm.dIl(w,T))&&T.count){this.rti(w,T);var ea=new Ba.a;for(var ra of T)ea.add(ra.vN),ea.add(ra.Mb);w.r1d(ea);for(let wa of T)ra=w.Ra.eT(wa.vN),ra.sv=new zn(ra,wa.QG,Object(v.a)(this,this.Ttj,"handleParagraphSplit")),ra.isFromErrorRangeSplit=!0,ra=w.Ra.eT(wa.Mb),ra.isDictationCorrectionEnd=!0,ra.isFromErrorRangeSplit=!0;0<T.count&&this.Pa.raiseEvent("ADCM",new pe(w.id,T))}}W0f(w){const T=new Ba.a;if(w){let ea=null,ra=-1;for(let wa=0;wa<w.Ra.length;wa++){const Za=w.Ra.ga(wa);
Za.sv?(ra=Za.cp,ea=Za.sv.QG):Za.isDictationCorrectionEnd&&(ea?T.add(new Gf(ra,Za.cp,ea)):m.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),ea=null)}}return T}koc(w,T){if(w&&T&&T.count){for(let ea of T){let ra=w.Ra.eT(ea.vN);ra&&(ra.sv=null);if(ra=w.Ra.eT(ea.Mb))ra.isDictationCorrectionEnd=!1}this.Pa.raiseEvent("RDCM",new pe(w.id,T))}}fti(w){if(w)for(let T=0;T<w.Ra.length;T++){const ea=w.Ra.ga(T);ea.sv&&(ea.sv=null);ea.isDictationCorrectionEnd&&(ea.isDictationCorrectionEnd=
!1)}}jSc(w){if(!w||!yn.SelectionEditor.gk(w)&&!yn.SelectionEditor.Tg(w))return null;const T=w.node;let ea=w.Qa;w=w.Mb;let ra=0,wa=null;for(let Za=0;Za<T.Ra.length;Za++){const ub=T.Ra.ga(Za);if(ub.sv&&ea>=ub.cp)wa=ub.sv,ra=ub.cp;else if(wa&&ub.isDictationCorrectionEnd){if(w<=ub.cp)return new Gf(ra,ub.cp,wa.QG);wa=null}}return null}eIl(w,T,ea){if(!w)return!1;w=ig.ParagraphReader.text(w);return Qm.UIh(w,T.source,ea)}Nhe(w){if(w){var T=this.W0f(w);if(T&&0<T.count){const ea=new Ba.a,ra=ig.ParagraphReader.text(w);
for(let wa of T)Qm.TIh(ra,wa)||ea.add(wa);this.koc(w,ea)}}}rti(w,T){T.ga(0);T.ga(T.count-1);const ea=this.W0f(w);let ra=0,wa=0;const Za=new Ba.a;for(;wa<T.count&&ra<ea.count;){const ub=T.ga(wa),zb=ea.ga(ra);ub.Mb<zb.vN?wa++:(zb.Mb>ub.vN&&Za.add(zb),ra++)}this.koc(w,Za)}Ttj(w,T){const ea=T.He;for(var ra=w.Ra.Twb(ea.cp)+1;ra<w.Ra.length;ra++){const wa=w.Ra.ga(ra);if(wa.isDictationCorrectionEnd){let Za;this.koc(w,(Za=new Ba.a,Za.add(new Gf(ea.cp,wa.cp,T.QG)),Za));break}}}oyk(w,T){(w=tf.App.Kb.Kd.Dn.xg)&&
(T=w.Fh.Be(ue.a.Hf(T.nodeId)))&&ig.ParagraphReader.$d(T)&&this.AWk(T)}AWk(w){if(w){var T=0,ea=!1,ra=!1,wa=new Ba.a;for(let Za=0;Za<w.Ra.length;Za++){const ub=w.Ra.ga(Za);ub.sv&&(T=Za,ea=!0);ea&&(ub.Up||ub.GL)&&(ra=!0);ub.isDictationCorrectionEnd&&ea&&(ea=!1,ra&&(ra=w.Ra.ga(T),ra.sv&&ra.sv.QG&&wa.add(new Gf(ra.cp,ub.cp,ra.sv.QG)),ra.sv=null,ra=ub.isDictationCorrectionEnd=!1))}this.Pa.raiseEvent("RDCM",new pe(w.id,wa))}}static dIl(w,T){if(!T.count)return T;T.Sc((ra,wa)=>ra.vN!==wa.vN?ra.vN-wa.vN:ra.Mb-
wa.Mb);w=ig.ParagraphReader.text(w);const ea=new Ba.a;for(let ra=0;ra<T.count;ra++){const wa=T.ga(ra);if(wa.vN>w.length||wa.Mb>w.length)break;if(!Qm.TIh(w,wa))continue;if(!ea.count){ea.add(wa);continue}const Za=ea.ga(ea.count-1);wa.vN>Za.Mb?ea.add(wa):Za.vN===wa.vN&&Za.Mb===wa.Mb&&Za.QG.Blk(wa.QG)}return ea}static UIh(w,T,ea){if(ea+T.length<=w.length){for(let ra=0;ra<T.length;ra++)if(T.charAt(ra)!==w.charAt(ra+ea))return!1;return!0}return!1}static TIh(w,T){return!w||T.vN>w.length||T.Mb>w.length||
!T.QG||!T.QG.source?!1:Qm.UIh(w,T.QG.source,T.vN)}}Object(n.a)(Qm,"DictationCorrectionRangeEditor",null,[531]);class Rm{constructor(){this.eDa=!1}}Object(n.a)(Rm,"DictationCorrectionSettings",null,[]);var Uj=d(15);class di{constructor(){this.gXb=new Uj.ScriptSharpLegacyMap}l5h(w){if(w&&w.count)for(let T of w)T.QG?(w=T.QG.key,this.gXb.Hb(w)||this.gXb.add(w,T.QG)):m.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}zWk(w){if(w&&w.count)for(let T of w)T.QG?this.gXb.remove(T.QG.key):m.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}D6i(w){if(!w)return null;let T;return({value:T}=this.gXb.Uf(w)).returnValue?T:null}clear(){this.gXb=new Uj.ScriptSharpLegacyMap}}Object(n.a)(di,"DictationCorrectionStorage",null,[568]);class mf{constructor(w,T,ea,ra,wa,Za,ub){this.fh=w;this.GRb=T;this.tZ=ea;this.Ca=ra;this.Tc=wa;this.kf=Za;this.Ak=ub}wb(){this.Ca.ya(qd.a.Esc,Ic.a.Pf,Object(v.a)(this,this.Jsc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.Fsc,Ic.a.Pf,Object(v.a)(this,this.Jsc,"takeSuggestedDictationCorrectionAction"));
this.Ca.ya(qd.a.Gsc,Ic.a.Pf,Object(v.a)(this,this.Jsc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.Hsc,Ic.a.Pf,Object(v.a)(this,this.Jsc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.Isc,Ic.a.Pf,Object(v.a)(this,this.Jsc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.Dsc,Ic.a.Pf,Object(v.a)(this,this.Dsc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.ya(qd.a.Esc,Ic.a.view,Object(v.a)(this,this.xtb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.Fsc,Ic.a.view,
Object(v.a)(this,this.xtb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.Gsc,Ic.a.view,Object(v.a)(this,this.xtb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.Hsc,Ic.a.view,Object(v.a)(this,this.xtb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.Isc,Ic.a.view,Object(v.a)(this,this.xtb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.Dsc,Ic.a.view,Object(v.a)(this,this.xtb,"collapseIpThenExecuteAction"));this.Ca.je(qd.a.Esc,96);this.Ca.je(qd.a.Fsc,96);this.Ca.je(qd.a.Gsc,96);this.Ca.je(qd.a.Hsc,
96);this.Ca.je(qd.a.Isc,96);this.Ca.je(qd.a.Dsc,96)}mei(w,T,ea){const ra=this.Ak.me(15);try{ra.kd(w);let wa;this.GRb.koc(w,(wa=new Ba.a,wa.add(T),wa));const Za=T.QG.suggestions.ga(ea);if(this.GRb.eIl(w,Za,T.vN)){const ub=sh.a.createTextRange(w,T.vN,T.vN+Za.source.length);this.fh.replaceTextRange(ub,Za.suggestion);this.tZ.ssk(T.QG,ea)}else m.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{ra&&ra.dispose()}}Jsc(w,T,ea){2===ea&&T.al&&(ea=this.GRb.jSc(T))&&this.mei(T.node,ea,this.F6i(w));
return 32}xtb(w,T,ea,ra,wa){if(2===ea){T=this.Tc.Na.mb;if(!T)return 2;T=this.kf.Sl(T,!0,!1);return this.Ca.mi(T.Ua,w,ea,!1,ra,wa)}return 32}Dsc(w,T,ea){if(2===ea&&T.al&&(w=this.GRb.jSc(T))){let ra;this.GRb.koc(T.node,(ra=new Ba.a,ra.add(w),ra));this.tZ.vsk(w.QG)}return 32}F6i(w){switch(w){case qd.a.Esc:return 0;case qd.a.Fsc:return 1;case qd.a.Gsc:return 2;case qd.a.Hsc:return 3;case qd.a.Isc:return 4;default:return-1}}}Object(n.a)(mf,"DictationCorrectionsActor",null,[567]);var Wi=d(321),fn=d(64);
class Eo{constructor(){this.S$e=this.Da=null}get name(){return"Box4.DictationCorrections"}Zb(w){this.Da=w;this.Da.register(531,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().oa(()=>new Qm(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(532,"Box4.DictationCorrections.IDictationCorrectionManager").ma().oa(()=>new lh(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new Rm,new di));this.Da.register(533,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().oa(()=>
new en(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.S$e=new mf(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),Q.AFrameworkApplication.Ta,fn.a.instance,Wi.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.S$e.wb();
this.LTk(this.Da.Ja("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const w=this.Da.ub("Box4.Proofing.IErrorRangeEditor"),T=this.Da.ub("Box4.DictationCorrections.IDictationCorrectionRangeEditor");Q.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&w&&T&&w.$9h(Object(v.a)(T,T.oyk,"onSpellingErrorRangesChangedEventHandler"));tf.App.Kb.updateCommandUI()}dispose(){}LTk(w,
T,ea){w&&w.execute(ra=>{ra.f_a(new ko(T,ea))})}}Object(n.a)(Eo,"DictationCorrectionsPackageManager",null,[2,3]);d(1213);d(717);var On=d(483);class fl{constructor(w,T,ea,ra=null,wa=null){this.Mn=w;this.JG=T;this.EUh=ea;this._id=ra;this.RCd=wa}get He(){return this.Mn}get type(){return this.JG}get wk(){return this.EUh}get id(){return this._id}get mfg(){return this.RCd}ae(w){return new fl(w,this.type,this.wk,this.id,this.mfg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.wk,this.id?this.id.toString():"<null>")}}Object(n.a)(fl,"IntentObject",null,[144]);d(602);class fk{constructor(w,T,ea,ra=null,wa=null){On.a(w);this.JG=w;this.Jxd=T;this.uAd=ea;this._id=ra;this.RCd=wa}get type(){return this.JG}get begin(){return this.Jxd}get end(){return this.uAd}get id(){return this._id}get mfg(){return this.RCd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(n.a)(fk,"IntentRange",
null,[215]);d(361);d(158);d(213);class ej{constructor(w){this.fh=w}}Object(n.a)(ej,"IntentRangeEditor",null,[529]);class Mi{constructor(){this.Da=null}get name(){return"Box4.Intent"}Zb(w){this.Da=w;this.Da.register(ej,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().oa(()=>new ej(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){oa.a.instance.Dc(new Mi)}}Object(n.a)(Mi,"PackageManager",null,[2,3]);
var Hm=d(1158),Ql=d(1121),Pn=d(304),gn=d(1122),Fo=d(930),bm=d(793);class Bd{}Bd.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");Bd.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");Bd.jJl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
Bd.ahi=["en-US","en-CA","en-GB","en-AU","en-IN"];Bd.bhi="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");Bd.KJi="en-US";Bd.jMi="btnStartDictation";Bd.uMi="btnDictationFloatieToggle";Bd.oMi="Dictation";Bd.vMi="DictationFloatieToggle";Bd.pOf="Insertaudio_32x32x32";Bd.oOf=
"Insertaudio_16x16x32";Bd.nMi="JotInsertAudioRecordingShort_32x32x32";Bd.mMi="JotInsertAudioRecordingShort_16x16x32";Bd.Wol="speechOn.wav";Bd.Vol="speechOff.wav";Object(n.a)(Bd,"DictationConstants",null,[]);class Nh{constructor(w){this.Egf=w;this.nNa=(w=Vi.a.xe(w))?w.displayName:this.Egf;this.DG=w?w.LCID:Nh.DZj}get g1c(){return this.Egf}get displayName(){return this.nNa}get LCID(){return this.DG}}Nh.DZj=1033;Object(n.a)(Nh,"DictationLanguage",null,[]);class Je{constructor(w,T,ea,ra,wa,Za,ub,zb,tc){this.rAc=
null;this.Lcf=!1;this.vba=null;this.Dqb=!1;this.Ca=w;this.tZ=tf.App.e1a;this.Hxc=tf.App.f_;this.m2=ea;this.eDc=T;this.Kf=ra;this.yP=wa;this.ug=ub;this.Nd=tc;this.ug.xL&&(this.vba=Za);this.gNh=zb}wb(){this.Ca.ra(qd.a.Plc,Ic.a.view,Object(v.a)(this,this.Plc,"populateDictationLanguages"),96);this.Ca.ra(qd.a.hVe,Ic.a.view,Object(v.a)(this,this.hVe,"setDictationLanguage"),1028);this.Ca.ra(qd.a.ZNe,Ic.a.view,Object(v.a)(this,this.ZNe,"querySelectedDictationLanguage"),96);this.Ca.ra(qd.a.oOb,Ic.a.view,Object(v.a)(this,
this.oOb,"toggleDictation"),1028);this.Ca.ra(qd.a.Zid,Ic.a.view,Object(v.a)(this,this.Zid,"queryDictation"),96);this.Ca.ra(qd.a.lOf,Ic.a.view,Object(v.a)(this,this.aHb,"onDictationError"),64);this.Ca.ra(qd.a.qOf,Ic.a.view,Object(v.a)(this,this.aHb,"onDictationError"),64);this.Ca.ra(qd.a.tOf,Ic.a.view,Object(v.a)(this,this.Ask,"onDictationRecordingStarted"),64);this.Ca.ra(qd.a.uOf,Ic.a.view,Object(v.a)(this,this.Bsk,"onDictationRecordingStopped"),64);this.Ca.ra(qd.a.rOf,Ic.a.view,Object(v.a)(this,
this.zsk,"onDictationModifyRunLanguage"),64);this.Ca.ra(qd.a.nOf,Ic.a.view,Object(v.a)(this,this.ysk,"onDictationFocusLost"),64);this.Ca.ra(qd.a.wOf,Ic.a.view,Object(v.a)(this,this.$sk,"onFailedToInsertText"),64);this.Ca.ra(qd.a.sOf,Ic.a.view,Object(v.a)(this,this.Dsk,"onDictationTimeout"),64);this.Ca.ra(qd.a.W$g,Ic.a.view,Object(v.a)(this,this.Plc,"populateDictationLanguages"),96);this.Ca.ra(qd.a.iVe,Ic.a.view,Object(v.a)(this,this.iVe,"setDictationSettingsLanguage"),1028);this.Ca.ra(qd.a.nNe,Ic.a.view,
Object(v.a)(this,this.nNe,"queryDictationSettingsLanguage"),96);this.Ca.ra(qd.a.qMi,Ic.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.ra(qd.a.rMi,Ic.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.ra(qd.a.pMi,Ic.a.view,Object(v.a)(this,this.Yvl,"toggleAutoPunctuation"),96);this.Ca.ra(qd.a.GLk,Ic.a.view,Object(v.a)(this,this.NMk,"queryToggleAutoPunctuation"),96);this.Ca.ra(qd.a.sMi,Ic.a.view,Object(v.a)(this,this.kwl,"toggleVoiceCommands"),96);this.Ca.ra(qd.a.HLk,
Ic.a.view,Object(v.a)(this,this.OMk,"queryToggleVoiceCommands"),96);this.Ca.ra(qd.a.atd,Ic.a.view,Object(v.a)(this,this.atd,"toggleDictationInFloatie"),1028);this.Ca.ra(qd.a.mOf,Ic.a.view,Object(v.a)(this,this.xsk,"onDictationFloatieDismissed"),1028);this.Ca.ra(qd.a.lMi,Ic.a.view,Object(v.a)(this,this.Vvk,"onPauseDictationCommand"),96);this.Ca.ra(qd.a.kMi,Ic.a.view,Object(v.a)(this,this.Ysk,"onExitDictationCommand"),96);const w=qb.KeyInputManager.Oa(Ue.a.GIh,1);this.Nd.Fc(Ge.AFrame.gj).bindAction(w,
qd.a.vOf);this.Ca.ra(qd.a.vOf,Ic.a.view,Object(v.a)(this,this.Csk,"onDictationShortcut"),1028)}iSc(){return Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.Np?this.ug.xL?Bd.vMi:Bd.oMi:this.ug.xL?Bd.uMi:Bd.jMi}Zid(w,T,ea,ra,wa){if(1===ea)return 32;wa&&(w=!!Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.Np,this.vba?wa[w?Dh.a.On:Ql.a.On]=this.vba.isVisible():(ea=this.m2.EI(),ea=(T=2===ea)||1===ea,w?(wa[Dh.a.On]=ea,wa[Pn.a.IconSet]=T?(new gn.a("JotInsertAudioRecordingShort_20")).iconSet:
Q.AFrameworkApplication.Aa.hb.Ooa?(new gn.a("InsertAudio_32")).iconSet:(new gn.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(wa[Ql.a.On]=ea,T?(wa[Ql.a.Image32by32Class]=ah.getImageClass(Bd.nMi),wa[Ql.a.Image16by16Class]=ah.getImageClass(Bd.mMi)):(wa[Ql.a.Image32by32Class]=ah.getImageClass(Bd.pOf),wa[Ql.a.Image16by16Class]=ah.getImageClass(Bd.oOf)))));return 32}oOb(w,T,ea){if(2===ea)if(this.vba)this.jCh();else return this.b2d();return 32}atd(w,T,ea){return 2!==ea?32:this.b2d()}Plc(w,T,
ea,ra,wa){if(1===ea)return 32;this.BFk(wa,w===qd.a.W$g);return 32}ZNe(w,T,ea,ra,wa){if(1===ea)return 32;wa&&((w=wa.MenuItemId)&&w===this.ug.US?(wa[Dh.a.On]=!0,this.rAc=wa.SourceControlId):wa[Dh.a.On]=!1);return 32}nNe(w,T,ea,ra,wa){if(1===ea)return 32;wa&&(wa[Fo.a.Value]=(new Nh(this.ug.US)).displayName);return 32}hVe(w,T,ea,ra,wa){if(1===ea)return 32;wa&&(w=wa.SourceControlId,this.rAc!==w&&(this.ug.US=wa.MenuItemId,this.QGh(this.rAc),this.QGh(w),this.rAc=w,2===this.m2.EI()&&this.$U()));return 32}iVe(w,
T,ea,ra,wa){if(1===ea)return 32;if(wa){w=wa.MenuItemId;if(this.ug.US!==w){this.ug.US=w;if(this.vba)this.vba.onDictationLanguageChanged(w);2===this.m2.EI()&&this.$U()}this.w4e()}return 32}showHelpPane(w,T,ea,ra,wa){if(1===ea)return 32;w=this.gNh.value;if(!w)return 0;wa&&(wa={},wa.query="AssetID="+(this.ug.NGl?Je.vSh:Je.bCd),wa=Object.assign(new Hm.a,{nonPersistedSettings:wa}),w.gga(Je.aCd,wa));return 32}Yvl(w,T,ea,ra,wa){if(1===ea)return this.ug.zie?32:8;wa&&this.ug&&(this.ug.useAutoPunctuation=wa[Dh.a.On]);
2===this.m2.EI()&&this.$U();this.w4e();return 32}kwl(w,T,ea,ra,wa){if(1===ea)return this.ug.Gme?32:8;wa&&this.ug&&(this.ug.BPb=wa[Dh.a.On]);2===this.m2.EI()&&(this.m2.$U(),this.fPb());this.qGh();return 32}NMk(w,T,ea,ra,wa){if(1===ea)return 32;wa&&this.ug&&(wa[Dh.a.On]=this.ug.useAutoPunctuation);return 32}OMk(w,T,ea,ra,wa){if(1===ea)return 32;wa&&this.ug&&(wa[Dh.a.On]=this.ug.BPb);return 32}xsk(w,T,ea){2===ea&&this.uOc();return 32}Vvk(w,T,ea){2===ea&&this.ug.xL&&2===this.m2.EI()&&this.$U();return 32}Ysk(w,
T,ea){2===ea&&this.ug.xL&&this.uOc();return 32}k5h(){const w=Object.assign(new Ma.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),T=Object.assign(new rd.a,{Id:"DictationLanguageList_"+this.iSc(),ExternalId:"DictationLanguageList_"+this.iSc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.iSc(),QueryCommand:"2417470717",Image16by16Class:ah.getImageClass(Bd.oOf),Image32by32Class:ah.getImageClass(Bd.pOf),
Visible:!0,AriaLabel:Xc.a.Wfi});Array.add(w.ControlList,T);return w}BFk(w,T){w.MenuItems=Object.assign(new yd.a,{Id:T?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!T){var ea=this.k5h();Array.add(w.MenuItems.MenuSectionList,ea)}ea=this.ug.Ach;0<ea.length&&(ea=Je.LLc(ea,"dictationProdcutionLanguages","",T),Array.add(w.MenuItems.MenuSectionList,ea));ea=this.ug.zbh;0<ea.length&&(T=Je.LLc(ea,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,
T),Array.add(w.MenuItems.MenuSectionList,T));w.PopulationXML=Nn.l(w.MenuItems);this.Lcf=!0}fPb(){const w=this.eDc.value;if(w){const T=this.iSc();if(Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.Np){const ea={};ea[T]=this.ug.xL?"ToggleButtonModel":"SplitButtonModel";this.Lcf&&!this.ug.xL&&(ea["DictationLanguageList_"+T]="ToggleButtonModel");w.dPb(ea)}this.w4e();this.qGh()}}w4e(){if(this.ug.xL){const w=this.eDc.value;Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.Np&&w.dPb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}qGh(){if(this.ug.xL){const w=
this.eDc.value;Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.Np&&w.dPb({DictationSettingsVoiceCommands:"CheckboxModel"})}}QGh(w){const T=this.eDc.value;if(T&&Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.Np){const ea={};ea[w]="ToggleButtonModel";T.dPb(ea)}}aHb(w,T,ea){2===ea&&(this.ug.xL?this.uOc():this.$U());return 32}$sk(w,T,ea){2===ea&&this.$U();return 32}Ask(w,T,ea){2===ea&&this.fPb();return 32}Bsk(w,T,ea){2===ea&&(this.m2.$U(),this.fPb());return 32}zsk(w,T,ea,ra,wa){2===
ea&&wa&&(w=Vi.a.xe(this.ug.US),this.Kf.Zpc(this.yP.xs(wa),w.LCID,wa.Mb));return 32}ysk(w,T,ea){2===ea&&this.$U();return 32}Dsk(w,T,ea){2===ea&&this.$U();return 32}jCh(){this.Dqb||(this.Dqb=!0,this.vba.isVisible()?(this.uOc(),this.Dqb=!1):this.showFloatie(),this.fPb())}showFloatie(){this.vba.showFloatie((new Nh(this.ug.US)).displayName).then(()=>{0===this.m2.EI()&&this.m2.Ekb().then(()=>{this.Dqb=!1}).catch(w=>{this.Dqb=!1;m.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",w)});this.ug.x9b&&
this.tZ&&this.tZ.Rpl();this.Hxc&&this.Hxc.startSession()}).catch(()=>{this.Dqb=!1})}b2d(){const w=this.m2.EI();if(1===w||3===w)return 1;0===w?this.Ekb():this.$U();return 32}uOc(){const w=this.m2.EI();1!==w&&(this.vba&&this.vba.hideFloatie(),this.tZ&&this.tZ.Iql(),0!==w&&this.$U(),this.Hxc&&this.Hxc.endSession(),this.fPb())}$U(){this.m2.$U();this.fPb()}Ekb(){this.m2.Ekb().then(()=>{}).catch(w=>{m.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",w)})}Csk(w,T,ea){return 2===ea&&this.ug&&
this.ug.PLj?this.ug.xL&&this.vba&&!this.vba.isVisible()?(this.jCh(),32):this.b2d():32}static createInstance(w,T,ea,ra,wa,Za,ub,zb){return Je.Ka||(Je.Ka=new Je(Q.AFrameworkApplication.Ta,w,T,ea,ra,wa,Za,ub,zb))}static LLc(w,T,ea,ra){ea=Object.assign(new Ma.a,{DisplayMode:"Menu",Title:ea,Id:T,ControlsId:"ctr"+T,ControlList:[]});for(const wa of w){w=T+"_"+wa.g1c;const Za=wa.displayName,ub=wa.g1c;ra?(w=Object.assign(new bm.a,{Id:w,ExternalId:w,LabelText:Za,Command:"3662249320",MenuItemId:ub,Visible:!0}),
Array.add(ea.ControlList,w)):(w=Object.assign(new rd.a,{Id:w,ExternalId:w,LabelText:Za,Command:"2863762275",MenuItemId:ub,QueryCommand:"2739750502",Visible:!0,AriaLabel:Xc.a.Rrb}),Array.add(ea.ControlList,w))}return ea}}Je.Ka=null;Je.aCd="FA000000012";Je.bCd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";Je.vSh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(n.a)(Je,"DictationActor",null,[605]);var sj=d(271),Ee=d(1119),gl=d(157);class Ni{constructor(w,T){this.uZ=null;this.Fba=!1;this.gNa=null;this.cQh=w;this.ug=
T}isVisible(){return this.Fba}mYc(){return this.Fba&&!!this.uZ}JRi(){if(this.uZ)return!0;this.uZ=this.cQh.value;if(!this.uZ)return!1;this.uZ.hOl(qd.a.atd);this.uZ.bOl(qd.a.mOf);ff.a.addHandler(window.self,ic.a.resize,()=>{this.fxj()});const w=Dd.FocusManager.instance().Fc(gl.AppFrame.X7a);w.M7(T=>{this.IZi(T)});w.OBa((T,ea)=>{this.HZi(ea)});w.bJ=!0;w.BSe=!0;sj.a.instance.K2(gl.AppFrame.X7a,!0);sj.a.instance.Ko(gl.AppFrame.X7a);return!0}IZi(w){this.mYc()&&w.name!==Ge.AFrame.ZO&&this.uZ.focus()}HZi(w){this.mYc()&&
w.name!==Ge.AFrame.ZO&&this.uZ.blur()}showFloatie(w){return this.Fba?Promise.resolve(null):this.JRi()?new Promise((T,ea)=>{this.uZ.VMl().then(()=>{this.uZ.showDictationFloatie(this.Lwb(),!1,w,this.ug.useAutoPunctuation);this.gNa=w;this.Fba=!0;sj.a.instance.pI(gl.AppFrame.X7a);T(null)}).catch(()=>{ea("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.mYc()&&(this.uZ.dismissDictationFloatie(),sj.a.instance.Ko(gl.AppFrame.X7a),
this.Fba=!1)}showDictationWarning(w){this.mYc()&&this.uZ.showDictationWarning(w)}onDictationLanguageChanged(w){this.gNa=w}Lwb(){var w=tf.App.Kb.d8a.getBoundingClientRect();const T=w.left+w.width/2-44;w=w.top+w.height-70;return Object.assign(new Ee.a,{x:T,y:w})}fxj(){this.Fba&&this.uZ&&(this.uZ.dismissDictationFloatie(),this.uZ.showDictationFloatie(this.Lwb(),!1,this.gNa,this.ug.useAutoPunctuation))}}Object(n.a)(Ni,"DictationFloatieManager",null,[]);class mh{constructor(){this.Oha=this.NAa=0;this.eyc=
null;this.Iba=!0;this.xvc="";this.ug=this.Dh=null;this.OAa=this.Nba=this.zNa=this.Gt=this.Kj=0;this.xAd=this.nZ="";this.ZVb=this.fRb=0;this.RAd=this.hBd=this.gBd=!1;this.eLd="";this.IVb=this.HSb=this.Yh=this.l2=null;this.fzd=this.SAc=this.RAc=this.EMd=this.Vpf=this.v5a=this.t5a=0}set Lyi(w){this.nZ=w}get tya(){return tf.App.f_?tf.App.f_.tya:""}get r1a(){return tf.App.f_?tf.App.f_.r1a:""}set r1a(w){tf.App.f_&&(tf.App.f_.r1a=w)}onFragment(w){this.zNa||(this.zNa=(new Date).getTime());this.HSb&&(this.HSb.stop(),
this.t5a+=this.HSb.Vq,this.HSb.start());this.NAa++;this.OAa+=w.split(" ").length}onFinalPhrase(w){this.zNa||(this.zNa=(new Date).getTime());this.IVb&&(this.IVb.stop(),this.v5a+=this.IVb.Vq,this.IVb.start());this.OAa=0;this.Oha++;this.Nba+=w.split(" ").length}onConnectionStarted(w){this.fRb=(new Date).getTime();this.Lyi=w;this.Yh&&(this.HSb=this.Yh.Ci("WebServiceCall","FragmentResponse"),this.IVb=this.Yh.Ci("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.ZVb=(new Date).getTime()}onMicrophoneError(w){this.onCustomError("MicrophoneError",
w)}onCustomError(w,T=null){this.Iba=!1;this.eyc=w;this.setEndReason(T||w)}setEndReason(w){this.xAd=w}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(w,T){this.fzd=T;w?(this.EMd+=T,T>this.SAc&&(this.SAc=T)):(this.Vpf=T,T>this.RAc&&(this.RAc=T))}onFocusLost(){this.gBd=!0}onFocusLostWhileStarting(){this.hBd=!0}onFailedToStartTurn(){this.RAd=!0}onSpeechSessionStarted(w){this.eLd=w}setDictationLatency(w){this.l2=w}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(n.a)(mh,"AbstractDictationSessionTelemetry",null,[636]);class Rl{}Rl.seen="Seen";Rl.tried="Tried";Rl.kept="Kept";Object(n.a)(Rl,"FunnelStatus",null,[]);class An{constructor(){this.dataFields=this.name=null}}Object(n.a)(An,"Contract",null,[]);class xp extends mh{constructor(w,T){super();this.D9e=this.C9e=this.Z7e=!1;this.VFd=this.QFd=this.$Id=0;this.eGd=this.dGd=2147483647;this.DMd=this.BMd=0;this.ug=w;this.Kj=(new Date).getTime();this.Yh=T;this.r1a=F.a.create().toString();this.Dh=new Mf.a;
this.Dh.dataFields=[];this.xvc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(w,T,ea){w=w+this.fzd-(this.$Id+(T+ea)/1E4);this.BMd+=w;this.QFd<w&&(this.QFd=w);this.dGd>w&&(this.dGd=w)}onPartialResultAnnotationResponse(w,T,ea){w=w+this.fzd-(this.$Id+(T+ea)/1E4);this.DMd+=w;this.VFd<w&&(this.VFd=w);this.eGd>w&&(this.eGd=w)}setRecordingStartTime(w){this.$Id=w}onCommandCalled(){this.C9e=!0}onAugloopError(w){this.Iba=!1;this.Z7e=!0;this.eyc=w}onCommandError(){this.D9e=!0}endActivity(){this.Nba+=
this.OAa;this.Gt=(new Date).getTime();this.Dh.succeeded=this.Iba;this.Dh.durationMs=this.Gt-this.Kj;Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"Success",bool:this.Iba}));this.Iba||Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"error",string:this.eyc}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"SessionID",string:this.tya}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"SpeechSessionID",string:this.eLd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,
{name:"TurnID",string:this.r1a}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"NumberOfWords",int64:0<this.OAa?this.OAa+this.Nba:this.Nba}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"NumberOfFragments",int64:this.NAa}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"NumberOfFinalPhrases",int64:this.Oha}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"Language",string:this.ug.US}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"connectionID",
string:this.nZ}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"IsUsingFloatie",bool:this.ug.xL}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"UseAutoPunctuation",bool:this.ug.useAutoPunctuation}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"EndReason",string:this.xAd}));this.zNa&&Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TimeToGetFirstResult",int64:this.zNa-
this.fRb}));this.Iba&&(Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TimeToStartRecording",int64:this.ZVb-this.Kj})),Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TimeToOpenConnection",int64:this.fRb-this.ZVb})));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"FocusLost",bool:this.gBd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"FocusLostWhileStarting",bool:this.hBd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"FailedToStartTurn",
bool:this.RAd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MaxTimeToInsertFragment",int64:this.RAc}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MaxTimeToInsertPhrase",int64:this.SAc}));var w=Rl.seen;this.Iba&&0<this.Nba&&(w=0<this.Oha?Rl.kept:Rl.tried);Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"DictationFunnel",contract:Object.assign(new An,{name:"Office.System.Funnel",dataFields:[Object.assign(new Be.a,{name:"Name",string:"Dictation"}),Object.assign(new Be.a,
{name:"State",string:w})]})}));this.Dh.name=this.xvc;this.Dh.samplingPolicy=2;Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"AugloopFailed",bool:this.Z7e}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"CommandsUsed",bool:this.C9e}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"CommandsFailed",bool:this.D9e}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.QFd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.dGd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.VFd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.eGd}));w=0<this.Oha?this.BMd/this.Oha:0;const T=0<this.NAa?this.DMd/this.NAa:0;Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"AverageFinalResultUserPerceivedLatency",double:w}));Array.add(this.Dh.dataFields,
Object.assign(new Be.a,{name:"AveragePartialResultUserPerceivedLatency",double:T}));zk.a.sendActivityEvent(this.Dh)}}Object(n.a)(xp,"AugloopDictationTelemetry",mh,[]);var Go=d(218);class Bn{constructor(w){this.O6=w}play(){this.O6.play()}pause(){this.O6.pause()}get paused(){return this.O6.paused}get currentTime(){return this.O6.currentTime}set currentTime(w){this.O6.currentTime=w}get duration(){return this.O6.duration}get error(){const w=this.O6.error;return w?w.code:0}get readyState(){return this.O6.readyState}get src(){return this.O6.getAttribute("src")}set src(w){this.O6.setAttribute("src",
w)}get preload(){return this.O6.getAttribute("preload")}set preload(w){this.O6.setAttribute("preload",w)}get Vf(){return this.O6}}Object(n.a)(Bn,"AudioElement",null,[]);class Ho{constructor(){this.WGd=this.VGd=this.v5a=this.t5a=this.Uzd=0}onAudioData(){this.Uzd||(this.Uzd=(new Date).getTime())}onFragment(w){this.t5a+=this.c8f(w);this.VGd++}Xvk(w){this.v5a+=this.c8f(w);this.WGd++}MZf(){return this.WGd?this.v5a/this.WGd:0}F3i(){return this.VGd?this.t5a/this.VGd:this.MZf()}c8f(w){if(!w)return 0;const T=
(new Date).getTime();let ea=null;return({rv:ea}=X.d(w)).returnValue?T-this.Uzd-(ea.Offset+ea.Duration)/1E4:0}}Object(n.a)(Ho,"DictationLatency",null,[]);class ei{constructor(w,T){this.a7=0;this.cLd=this.dLd=null;this.YTb=!1;this.YAc=null;this.Hzc=!1;this.l2=this.Tq=null;this.yG=T;this.Aba=w}onFinalText(w,T){if(2===this.a7){var ea=w.size;if(1!==ea&&(m.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",ea),!ea))return;T=T.get("JsonResult");this.l2&&this.l2.Xvk(T);this.yG.onFinalPhrase(w.values().next().value,
T)}}onFragmentText(w,T){if(2===this.a7){var ea=w.size;if(1!==ea&&(m.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",ea),!ea))return;T=T.get("JsonResult");if(this.l2)this.l2.onFragment(T);this.yG.onFragment(w.values().next().value)}}onError(w){if(0!==this.a7&&3!==this.a7&&"ErrorNone"!==w){this.a7=3;switch(w){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.yG.aqk(w);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.yG.Xrk(w);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.yG.rM(w);break;case "ErrorInitialSilenceTimeout":this.yG.juk(w);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.yG.onMicrophoneError(w);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.yG.EHe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.yG.EHe("NotFoundError");break;case "ErrorAudioNotReadableError":this.yG.EHe("NotReadableError");break;default:this.yG.Uyk(w)}this.a7=0}}onSpeechRecognitionStarted(w){window.self.document.hasFocus()?(this.a7=2,this.YTb=!1,this.yG.onRecordingStarted(),this.yG.onConnectionStarted(w),this.dLd||
(this.dLd=Object.assign(new Bn(document.createElement("audio")),{src:Go.a.box4Image(Bd.Wol)})),this.dLd.play()):(this.b4e(),this.yG.onFocusLost())}onSpeechEnd(){this.b4e();0!==this.EI()&&(this.a7=3,this.yG.Cwk(),this.a7=0,this.cLd||(this.cLd=Object.assign(new Bn(document.createElement("audio")),{src:Go.a.box4Image(Bd.Vol)})),this.cLd.play())}onAudioData(w){if(this.l2)this.l2.onAudioData();if(this.Aba){var T=0;for(const ea of w)T+=Math.pow(ea,2);w=Math.sqrt(T/w.length)>ei.Jol;!this.YTb&&w?(this.YTb=
!0,this.YAc=null):this.YTb&&!w&&(this.YAc?(new Date).getTime()>=this.YAc+ei.$lk&&(this.YTb=!1):this.YAc=(new Date).getTime())}}onSpeechSessionStarted(w){this.yG.onSpeechSessionStarted(w)}onEventUpdate(w){if(this.Aba&&"QualityStatusUpdate"===w.eventName)switch(w.shortCode){case 13:case 2:this.Aba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.Aba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.Aba.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}M0a(w,
T){this.yG.QRa(!1);this.yG.Mx=w;this.yG.ugg=T;this.$Tk();this.Tq=w;this.a7=1;this.l2=new Ho;this.Tq&&this.Tq.setDictationLatency(this.l2)}EI(){return this.a7}$Tk(){this.Hzc||(ff.a.addHandler(window.self,ic.a.blur,Object(v.a)(this,this.x3g,"onFocusLostEventHandler")),this.Hzc=!0)}b4e(){this.Hzc&&(ff.a.removeHandler(window.self,ic.a.blur,Object(v.a)(this,this.x3g,"onFocusLostEventHandler")),this.Hzc=!1)}x3g(){if(1===this.a7){if(this.Tq)this.Tq.onFocusLostWhileStarting()}else 2===this.a7&&(this.b4e(),
this.yG.onFocusLost())}}ei.Jol=350;ei.$lk=350;Object(n.a)(ei,"FrontdoorSpeechClientObserver",null,[661]);class te extends ei{constructor(w,T){super(w,T);this.BNa=new ei(w,T)}onFinalText(w,T){this.BNa.onFinalText(w,T)}onFragmentText(w,T){this.BNa.onFragmentText(w,T)}onError(w){this.BNa.onError(w)}onSpeechRecognitionStarted(w){this.BNa.onSpeechRecognitionStarted(w)}onSpeechEnd(){this.BNa.onSpeechEnd()}onAudioData(w){this.BNa.onAudioData(w)}M0a(w,T){this.BNa.M0a(w,T)}EI(){return this.BNa.EI()}}Object(n.a)(te,
"AugloopFrontdoorSpeechObserverAbstractDecorator",ei,[]);class Oi extends te{constructor(w,T,ea){super(w,T);this.Tc=ea}onFinalText(w,T){super.onFinalText(w,T)}onFragmentText(w,T){if(this.Ele())super.onFragmentText(w,T)}onError(w){super.onError(w)}onSpeechRecognitionStarted(w=null){const T=F.a.create().toString();super.onSpeechRecognitionStarted(w?w:T)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(w){super.onAudioData(w)}M0a(w,T){super.M0a(w,T)}EI(){return super.EI()}Ele(){const w=this.Tc.Na.mb.Ua;
return w.Mb!==w.Qa?!1:!0}}Object(n.a)(Oi,"AugloopFrontdoorSpeechObserverDecorator",te,[]);class hd{constructor(w){this.Rqf=w}onVoiceCommand(w){this.Rqf.onVoiceCommand(w)}setDictationSessionTelemetry(w){this.Rqf.setDictationSessionTelemetry(w)}}Object(n.a)(hd,"AugloopVoiceCommandObserverAbstractDecorator",null,[638]);class Kj extends hd{constructor(w,T,ea){super(w);this.i2=T;this.Tc=ea}onVoiceCommand(w){this.Ele()&&this.i2.wOl();super.onVoiceCommand(w)}setDictationSessionTelemetry(w){super.setDictationSessionTelemetry(w)}Ele(){const w=
this.Tc.Na.mb.Ua;return w.Mb!==w.Qa?!1:!0}}Object(n.a)(Kj,"AugloopVoiceCommandObserverDecorator",hd,[]);class jg{constructor(w){this.ug=w}nqg(w){const T=Q.AFrameworkApplication.Ke;if(T){var ea=this.ug.tYf;ea&&""!==ea&&T.mj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",ea),2,w,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(n.a)(jg,"FrontdoorCorrectionsTelemetryLogger",null,[639]);class bp{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(n.a)(bp,"SpeechDictationSettings",null,[]);class cp{constructor(w,T,ea,ra){this.Tzd=this.Ly=null;this.i2=w;this.Aba=T;this.yG=ea;this.jnb=ra;this.initializeCommandsDictionary()}onVoiceCommand(w){if(this.Tzd)this.Tzd.onCommandCalled();var T=4;if(({value:T}=this.Ly.Uf(w.commandId,0)).returnValue&&4!==T){let ea=null;w.commandValue&&(ea=new z.a(B.a.to()),ea.add("commandValue",w.commandValue));this.yG.QRa(!1);T=this.i2.executeCommand(T,ea);if(w.offset&&
w.duration)this.jnb.onCommandFinished(w.commandId,T,w.offset,w.duration)}}setDictationSessionTelemetry(w){this.Tzd=w}initializeCommandsDictionary(){this.Ly=new z.a(B.a.to());this.Ly.add("Word.Editing.Undo",2);this.Ly.add("Word.Editing.Bold",5);this.Ly.add("Word.Editing.Italics",6);this.Ly.add("Word.Editing.Underline",10);this.Ly.add("Word.Editing.StrikeThrough",20);this.Ly.add("Word.Editing.Subscript",19);this.Ly.add("Word.Editing.Superscript",18);this.Ly.add("Word.Editing.RemoveBold",11);this.Ly.add("Word.Editing.RemoveUnderline",
13);this.Ly.add("Word.Editing.RemoveItalics",12);this.Ly.add("Word.Editing.RemoveStrikeThrough",21);this.Ly.add("Word.Editing.RemoveSubscript",22);this.Ly.add("Word.Editing.RemoveSuperscript",24);this.Ly.add("Word.Editing.Paste",7);this.Ly.add("Word.Editing.InsertTable",8);this.Ly.add("Word.Editing.InsertComment",9);this.Ly.add("Word.Editing.InsertBullet",23);this.Ly.add("Word.Editing.FullJustify",14);this.Ly.add("Word.Editing.CenterJustify",15);this.Ly.add("Word.Editing.LeftJustify",16);this.Ly.add("Word.Editing.RightJustify",
17);this.Ly.add("Command.Exit",1);this.Ly.add("Command.Pause",0);this.Ly.add("Command.ShowHelp",26);this.Ly.add("Command.ShowCommand",27);this.Ly.add("Word.Editing.RemoveFormatting",28)}}Object(n.a)(cp,"VoiceCommandObserver",null,[638]);var Sl=d(973);class Im{constructor(w,T,ea,ra,wa,Za,ub){this.Tq=this.VXb=null;this.WAj=0;this.jnb=wa;this.ug=ub;wa=new bp;wa.dictationLanguage=ub.US;wa.useAutoPunctuation=ub.useAutoPunctuation?"Intelligent":"Explicit";wa.useCorrections=ub.x9b.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
wa;this.C7=new Oi(w,Za,ra);this.Sqf=new Kj(new cp(T,w,Za,this.jnb),T,ra);this.Uvc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.G7e=Array(ea);this.Uvc.setAnnotationResultCallback(Object.assign(new Sl.a,{handler:zb=>{for(const tc of this.G7e)tc.onAnnotationResult(zb)}}));this.aXb=new alVoiceClient.SpeechToTextClient(this.Uvc,this.C7,ub.Wlb||ub.avd,!1);this.Srf(this.aXb.getAnnotationObserver());this.UXb=new alVoiceClient.VoiceCommandingClient(this.Uvc,this.Sqf,this.C7);this.Srf(this.UXb.getAnnotationObserver());
ub.x9b&&(w=new jg(ub),(T=tf.App.e1a)&&T.Egh(w))}leg(w,T){return new Promise(ea=>{const ra=new bp;ra.dictationLanguage=w;ra.useAutoPunctuation=this.ug.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=ra;this.Tq=T;ea(this.hEj())})}Ekb(w){if(!this.aXb)return 3;this.VXb.startVoiceSessionFromMicrophoneInput();this.C7.M0a(this.Tq,w);w=this.ug.BPb;this.aXb.initializeAsync(w?[1]:[1,0],this.Tq);w&&this.vql();return 0}$U(w){if(w&&this.C7)this.C7.onSpeechEnd();
this.aXb&&this.aXb.uninitializeAsync();this.VXb&&(this.VXb.stopVoiceSession(),this.VXb=null);this.Tq=null;this.ug.BPb&&this.Vql()}EI(){return this.C7.EI()}hEj(){this.ug.BPb&&this.Sqf.setDictationSessionTelemetry(this.Tq);this.VXb=new alVoiceClient.VoiceSession(this.Uvc,this.C7,this.ug.Wlb,this.jnb,this.Tq);return 0}vql(){this.UXb&&this.UXb.initializeAsync(this.Tq)}Vql(){this.UXb&&this.UXb.uninitializeAsync()}Srf(w){this.G7e[this.WAj++]=w}}Object(n.a)(Im,"AugloopSpeechClientProxy",null,[619]);class Rh extends mh{constructor(w,
T){super();this.ug=w;this.Kj=(new Date).getTime();this.Yh=T;this.r1a=F.a.create().toString();this.Dh=new Mf.a;this.Dh.dataFields=[];this.xvc="Office.Voice.Online.DictationSession"}endActivity(){this.Nba+=this.OAa;this.Gt=(new Date).getTime();this.Dh.succeeded=this.Iba;this.Dh.durationMs=this.Gt-this.Kj;Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"Success",bool:this.Iba}));this.Iba||Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"error",string:this.eyc}));Array.add(this.Dh.dataFields,
Object.assign(new Be.a,{name:"SessionID",string:this.tya}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"SpeechSessionID",string:this.eLd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TurnID",string:this.r1a}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"NumberOfWords",int64:0<this.OAa?this.OAa+this.Nba:this.Nba}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"NumberOfFragments",int64:this.NAa}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,
{name:"NumberOfFinalPhrases",int64:this.Oha}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"Language",string:this.ug.US}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"connectionID",string:this.nZ}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"IsUsingFloatie",bool:this.ug.xL}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"UseAutoPunctuation",bool:this.ug.useAutoPunctuation}));
Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"EndReason",string:this.xAd}));this.zNa&&Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TimeToGetFirstResult",int64:this.zNa-this.fRb}));this.Iba&&(Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TimeToStartRecording",int64:this.ZVb-this.Kj})),Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"TimeToOpenConnection",int64:this.fRb-this.ZVb})));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"FocusLost",
bool:this.gBd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"FocusLostWhileStarting",bool:this.hBd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"FailedToStartTurn",bool:this.RAd}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"AverageFragmentLatency",double:this.l2?this.l2.F3i():0<this.NAa?this.t5a/this.NAa:0}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"AveragePhraseLatency",double:this.l2?this.l2.MZf():0<this.Oha?this.v5a/this.Oha:0}));
Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"AveragePhraseInsertionLatency",double:0<this.Oha?this.EMd/this.Oha:0}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"AverageFragmentInsertionLatency",double:0<this.NAa?this.Vpf/this.NAa:0}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MaxTimeToInsertFragment",int64:this.RAc}));Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"MaxTimeToInsertPhrase",int64:this.SAc}));let w=Rl.seen;this.Iba&&0<this.Nba&&
(w=0<this.Oha?Rl.kept:Rl.tried);Array.add(this.Dh.dataFields,Object.assign(new Be.a,{name:"DictationFunnel",contract:Object.assign(new An,{name:"Office.System.Funnel",dataFields:[Object.assign(new Be.a,{name:"Name",string:"Dictation"}),Object.assign(new Be.a,{name:"State",string:w})]})}));this.Dh.name=this.xvc;this.Dh.samplingPolicy=2;zk.a.sendActivityEvent(this.Dh)}}Object(n.a)(Rh,"DictationSessionTelemetry",mh,[]);var Gk=d(1153);class Lj{constructor(w,T){this.sBc=w;this.ATh=T}getAccessToken(w){this.ATh&&
this.sBc?this.sBc.nV("OfficeDictation",Q.AFrameworkApplication.fa.Ga("DictationResourceID")).then(T=>{T.IsSuccess?w(T.Token):w(Lj.w0d)}).catch(()=>{w(Lj.w0d)}):w(Lj.w0d)}}Lj.w0d="dictation access token";Object(n.a)(Lj,"AuthenticationProvider",null,[]);class mo{constructor(w){this.HTh=w;this.TEc=new rc.a}debugAssertTag(w,T,ea,ra){this.Tvd(ra);this.TEc.debugAssertTag(w,T,ea,ra)}debugTraceTag(w,T,ea,ra){this.Tvd(ra);this.TEc.debugTraceTag(w,T,ea,ra)}sendTraceTag(w,T,ea,ra){this.Tvd(ra);this.TEc.sendTraceTag(w,
T,ea,ra)}shipAssertTag(w,T,ea,ra){this.Tvd(ra);this.TEc.shipAssertTag(w,T,ea,ra)}Tvd(w){if(this.HTh){const T=window.console;T&&T.log(String.format("FDSpeechService: {0}",w))}}}Object(n.a)(mo,"FrontdoorExternalLogger",null,[257]);class Jm{constructor(){this.accessToken=null}}Object(n.a)(Jm,"IAuthenticationProvider",null,[]);class om{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(n.a)(om,"ISpeechConfig",null,[]);class Km{constructor(w,T,ea,ra,wa){this.Tq=this.jqb=null;this.rLd=!1;this.C7=new ei(ea,ra);this.yV=w;this.ug=T;this.zNh=new Lj(wa,T.OLj);this.ug.x9b&&(w=new jg(T),(T=tf.App.e1a)&&T.Egh(w))}leg(w,T){return new Promise(ea=>{this.zNh.getAccessToken(ra=>{ea(this.KDj(w,T,ra))})})}KDj(w,T,ea){this.Tq=T;w=this.EXd(w);ea=Object.assign(new Jm,
{accessToken:ea});T=new mo(this.ug.UYc);this.jqb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(w,this.C7,ea,null,T);return this.jqb?0:(m.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}Ekb(w){if(!this.jqb)return 3;this.C7.M0a(this.Tq,w);this.jqb.startSpeechRecognition();return 0}$U(w){if(!this.rLd){this.rLd=!0;if(this.jqb)try{this.jqb.stopSpeechRecognition()}catch(T){m.ULS.shipAssertTag(593277727,394,!1,T.message)}if(w&&this.C7)this.C7.onSpeechEnd();
this.Tq=null;this.rLd=!1}}EI(){return this.C7.EI()}EXd(w){const T=new om;T.speechMode="Dictation";T.sourceLanguage=w;(w=this.ug.tYf)&&""!==w&&(T.speechFDBase=String.format("wss://{0}/",w));T.properties=new Map;this.yV&&(T.properties.set("DictationInsertionPointLeft",this.yV.N7f()),T.properties.set("DictationInsertionPointRight",this.yV.Tlj()));T.properties.set("Corrections","true");T.properties.set("punctuation",this.ug&&this.ug.useAutoPunctuation?"Intelligent":"Explicit");this.ug.UYc&&T.properties.set("EnableAudioLogging",
this.ug.UYc.toString());switch(Gk.a.IQd){case "Word":T.clientApp=1;break;case "PowerPoint":T.clientApp=0;break;case "OneNote":T.clientApp=2}return T}}Object(n.a)(Km,"FrontdoorSpeechClientProxy",null,[619]);class lj{static Rjl(){lj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static okl(){lj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static Fll(w){lj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
w)}static Pml(){lj.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(w,T){lj.Af||(lj.Af=new fb.StandardDialog,lj.Af.Ar=Q.AFrameworkApplication.Kda,lj.Af.xd=0,lj.Af.Xe(1,CommonUIStrings.l_DialogClose),lj.Af.fP(w,T,()=>{lj.Af=null}))}}lj.Af=null;Object(n.a)(lj,"Dialogs",null,[]);class Cn{constructor(w,T,ea,ra,wa,Za,ub,zb){this.cpb=this.Iqb=!1;this.Mx=null;this.yV=w;this.ugg=T;this.Ca=ea;this.VMa=ra;this.ug=wa;this.i2=Za;
this.cRb=ub;this.Aba=zb;this.Plf=new V.a;for(w=0;w<Cn.Olf.length;w++)this.Plf.add(Cn.Olf.charAt(w).toString())}onFinalPhrase(w,T=null){let ea=!0;if(this.Mx)this.Mx.onFinalPhrase(w);if(this.cRb&&this.i2){var ra=this.cRb.xNl(w);if(ra){this.QRa(!1);this.i2.executeCommand(ra.commandId,null);return}}ra=(new Date).getTime();if(1===w.length&&"\n"===w)this.abe("",null),this.sTf();else{let wa=w.indexOf("\n");for(0<wa&&wa!==w.length-1&&(ea=!1);0<=wa;)this.abe(w.substr(0,wa),ea?T:null),this.sTf(),w=w.substr(wa+
1),wa=w.indexOf("\n"),ea=!1;this.abe(w,ea?T:null)}w=(new Date).getTime();if(this.Mx)this.Mx.onTextInserted(!0,w-ra)}onFragment(w){if(this.Iqb)var T=this.CUc(w);else{if(!this.ord())return;T=this.cpb?this.CUc(w):w}if(this.Mx)this.Mx.onFragment(w);w=!0;const ea=(new Date).getTime();this.yV&&!this.yV.Ydi(T)&&(this.l$f(),w=!1);T=(new Date).getTime();if(this.Mx)this.Mx.onTextInserted(!1,T-ea);w&&this.i2&&this.i2.qNl()}onRecordingStarted(){this.Ca.processAction(qd.a.tOf,2);if(this.Mx)this.Mx.onRecordingStarted()}onMicrophoneError(w=
""){this.G$f(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,w)}aHb(w){if(this.Mx)this.Mx.onCustomError(w);this.Ca.La(qd.a.lOf,2,w)}aqk(w){this.aHb(w);lj.Rjl()}Xrk(w){this.aHb(w);lj.okl()}Uyk(w){this.aHb(w);lj.Pml()}rM(w){this.Mx&&this.Mx.setEndReason(w);this.Ca.La(qd.a.sOf,2,w)}juk(w){this.rM(w);this.rml()}Cwk(){this.QRa(!1);this.Ca.processAction(qd.a.uOf,2)}onConnectionStarted(w){if(this.Mx)this.Mx.onConnectionStarted(w)}EHe(w){this.G$f(this.Mcj(w),w)}onFocusLost(){if(this.Mx)this.Mx.onFocusLost();
this.Ca.processAction(qd.a.nOf,2)}SUj(w){return this.ugg&&!S.a.Ime(w)&&!this.Plf.contains(w.toString())}CUc(w){return 0<w.length&&this.SUj(w.charAt(0))?" "+w:w}ord(){if(this.Iqb)return!0;if(this.yV){const w=this.yV.N7f();this.cpb=!1;w&&0<w.length&&(this.cpb=!S.a.Ime(w.charAt(w.length-1))&&!w.endsWith("\u201c"));return this.Iqb=this.yV.ord()}if(this.Mx)this.Mx.onFailedToStartTurn();this.i2&&this.i2.sNl();return!1}QRa(w){this.cpb=this.Iqb=!1;this.yV&&(w&&this.yV.zmk(),this.yV.QRa())}onSpeechSessionStarted(w){if(this.Mx)this.Mx.onSpeechSessionStarted(w);
this.ug.UYc&&this.oYe(w)}G$f(w,T=""){if(this.Mx)this.Mx.onMicrophoneError(T);this.Ca.processAction(qd.a.qOf,2);lj.Fll(w)}Mcj(w){w=w.trimStart();return w.startsWith("NotAllowedError")||w.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:w.startsWith("NotFoundError")||w.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:w.startsWith("NotReadableError")||w.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}rml(){this.VMa&&this.VMa.execute(w=>{w.Dkl()})}oYe(w){this.VMa&&this.VMa.execute(T=>{T.oYe(String.format("ServiceSessionID:{0} ClientSessionId: {1}",w,this.Xti))})}abe(w,T){if(this.Iqb||this.ord()){if(this.yV){const ea=this.cpb?this.CUc(w):w;(this.ug.x9b&&Object(eg.a)(618,this.yV)?this.yV.XMl(ea,T,0<w.length&&w.charAt(0)!==ea.charAt(0)):this.yV.nGj(this.cpb?this.CUc(w):w))||this.l$f()}this.QRa(!0)}}l$f(){if(this.Mx)this.Mx.onTextInsertionError();
this.Ca.processAction(qd.a.wOf,2)}sTf(){this.Ca.processAction(qd.a.zB,2)}get Xti(){return tf.App.f_?tf.App.f_.tya:""}}Cn.Olf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(n.a)(Cn,"SpeechClientObserverController",null,[]);class Qn{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc){this.cRb=this.i2=this.Aba=this.Tq=this.ePa=null;this.Sw=w;this.dQh=T;this.Tc=ea;this.VMa=ra;this.Yh=wa;this.ug=Za;this.sBc=bc;this.iof=yc;this.ug.xL&&(this.Aba=ub);if(this.ug.Lhg||this.ug.Wlb)this.i2=
zb;this.ug.Lhg&&(this.cRb=tc);this.jnb=pc}Ekb(){this.VMa&&this.VMa.execute(w=>{w.fzj()});return new Promise((w,T)=>{this.ePa?this.DTf(w,T):this.v0j().then(()=>{var ea=this.dQh.value;ea?(ea=ea.YCi(),this.ePa=this.fHi(ea),this.DTf(w,T)):T(4)}).catch(()=>{T(2)})})}DTf(w,T){this.M0a().then(ea=>{0===ea?w(0):T(ea)}).catch(ea=>{T(ea)})}M0a(){return new Promise((w,T)=>{this.Tq=new Rh(this.ug,this.Yh);if(this.ug.avd||this.ug.Wlb)this.Tq=new xp(this.ug,this.Yh);this.ePa.leg(this.ug.US,this.Tq).then(ea=>{0!==
ea?w(ea):w(this.ePa.Ekb(this.Ong()))}).catch(ea=>{T(ea)})})}v0j(){return this.ug.avd||this.ug.Wlb?this.Ppg("alVoiceClient",!0):this.Ppg("PPTSpeechClient")}Ppg(w,T=!1){return!T&&this.iof&&Q.AFrameworkApplication.Aa.hb.mig?(T=Q.AFrameworkApplication.Aj(w,2),ag.a(this.iof.XAb(T))):this.Sw?this.Sw.loadScript(w):new Promise((ea,ra)=>{ra("Unable to load speech client "+w)})}$U(w=!0){0!==this.EI()&&(this.ePa&&this.ePa.$U(w),this.Tq&&(this.Tq.endActivity(),this.Tq=null))}EI(){return this.ePa?this.ePa.EI():
0}Ong(){return"zh-CN"!==this.ug.US&&"ja-JP"!==this.ug.US}fHi(w){const T=new Cn(w,this.Ong(),Q.AFrameworkApplication.Ta,this.VMa,this.ug,this.i2,this.cRb,this.Aba);return this.ug.avd||this.ug.Wlb?new Im(this.Aba,this.i2,2,this.Tc,this.jnb,T,this.ug):new Km(w,this.ug,this.Aba,T,this.sBc)}}Object(n.a)(Qn,"DictationManager",null,[]);class Tl{constructor(){this.clf=[];this.r1a=this.uKd=""}startSession(){this.uKd=F.a.create().toString();this.clf=[]}endSession(){this.uKd=""}get tya(){return this.uKd}get p$g(){return this.clf}}
Object(n.a)(Tl,"DictationSessionInfo",null,[530]);class Hk{constructor(w,T,ea){this.eNd=this.QXb=this.bNd=this.PXb=!1;this.gNa="";this.$a=w?w:Q.AFrameworkApplication.fa;this.L3a=T;this.Tc=ea}get useAutoPunctuation(){if(!this.xL||!this.zie)return!1;if(this.bNd)return this.PXb;const w=ta.a.instance.getItem("WACDictationFUseAutoPunctuation");this.PXb=void 0===w||null===w?this.$a.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(Bd.ahi,this.US):!1:Boolean.parse(w);this.bNd=!0;return this.PXb}set useAutoPunctuation(w){this.xL&&
this.zie&&(this.PXb=w,this.bNd=!0,ta.a.instance.setItem("WACDictationFUseAutoPunctuation",this.PXb.toString()))}get BPb(){if(!this.xL||!this.Gme)return!1;if(this.eNd)return this.QXb;const w=ta.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.QXb=void 0===w||null===w?!0:Boolean.parse(w);this.eNd=!0;return this.QXb}set BPb(w){this.xL&&this.Gme&&(this.QXb=w,this.eNd=!0,ta.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.QXb.toString()))}get zie(){return Array.contains(Bd.bhi,
this.US)}get Gme(){return this.Wlb&&Array.contains(Bd.jJl,this.US)}get US(){""===this.gNa&&(this.gNa=this.B7i());return this.gNa}set US(w){w&&(this.gNa=w)}get x9b(){return this.xL}get xL(){return this.$a.ka("WacBox4DictationFloatieIsEnabled")}get NGl(){return this.$a.ka("WacBox4DictationInternalArticle")}get tYf(){return this.$a.Ga("DictationFrontdoorDomain")}get avd(){return this.$a.ka("WacBox4DictationUseAugloopService")}get Lhg(){return this.$a.ka("WacBox4DictationCommandsIsEnabled")&&this.xL}get Wlb(){return this.$a.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get OLj(){return this.$a.ka("WacDictationAuthenticationEnabled")}get UYc(){return this.$a.ka("DictationDebugModeEnabled")}get Ach(){return this.getSupportedLanguages(0)}get zbh(){return this.getSupportedLanguages(1)}get PLj(){return da.a.rzh&&
this.$a.ka("UserCanUseDictation")}getSupportedLanguages(w){const T=[];w=0===w?Bd.productionLanguages:Bd.previewLanguages;for(const ea of w)Array.add(T,new Nh(ea));T.sort((ea,ra)=>ea.displayName.localeCompare(ra.displayName));return T}B7i(){if(this.L3a&&this.Tc){const w=this.L3a.bTc(this.Tc.Pj);for(const T of this.Ach)if(T.LCID===w)return T.g1c;for(const T of this.zbh)if(T.LCID===w)return T.g1c}return Bd.KJi}}Object(n.a)(Hk,"DictationSettings",null,[]);class pm{constructor(){this.Q$e=this.Da=null}get name(){return"Box4.Dictation"}Zb(w){this.Da=
w;const T=ia.a.instance.ub("Common.IDynamicScriptLoaderProvider");let ea=null;T&&(ea=T.Sw);const ra=ia.a.instance.ie("Box4.Dictation.IDictationHostFactory");this.Da.register(Hk,"Box4.Dictation.DictationSettings").ma().oa(()=>new Hk(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const wa=ia.a.instance.ie("Common.IDictationFloatieController");this.Da.register(Ni,"Box4.Dictation.DictationFloatieManager").ma().oa(()=>new Ni(wa,
this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(Qn,"Box4.Dictation.DictationManager").ma().oa(()=>new Qn(ea,ra,this.Da.resolve("Box4.ISelectionManager"),w.Ja("Box4.IBusinessBarController"),w.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.ub("Box4.DictationCommands.IDictationCommandManager"),this.Da.ub("Box4.DictationCommands.IDictationCommandParser"),
this.Da.ub("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(530,"Box4.Dictation.IDictationSessionInfo").ma().oa(()=>new Tl)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.Q$e=Je.createInstance(this.Da.ie("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),
this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.ie("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Dd.FocusManager.instance());this.Q$e.wb();tf.App.Kb.updateCommandUI()}dispose(){}}Object(n.a)(pm,"DictationPackageManager",null,[2,3]);class qm{constructor(w,T,ea){this.PX=null;this.UF=this.wX=-1;this.pCb=!1;this.jJ=w;this.pa=T;this.ia=ea}N7f(){return this.Q7f(!1)}Tlj(){return this.Q7f(!0)}ord(){this.PX&&this.QRa();const w=
this.pa.Na.mb;if(w){const T=w.Ua;if(T&&ig.ParagraphReader.$d(T.node))return this.PX=T.node,this.UF=w.Ua.U5a,this.wX=w.Ua.oYb,this.pCb=!0}return!1}QRa(){this.PX=null;this.pCb=!1;this.wX=this.UF=-1}Ydi(w){if(this.PX){const T=new pj.GraphTransaction(15);try{T.kd(this.PX);const ea=this.pCb&&this.UF!==this.wX?sh.a.createTextRange(this.PX,this.UF,this.wX):sh.a.Lj(this.PX,this.wX);this.jJ.replaceTextRange(ea,w);this.wX=this.pCb?this.UF+w.length:this.wX+w.length;const ra=xk.SelectionFactory.Sg(this.PX,this.wX);
this.pa.setSelection(ra);this.pCb=!1;return!0}finally{T&&T.dispose()}}return!1}nGj(w){if(this.PX){const T=new pj.GraphTransaction(15);try{T.kd(this.PX);const ea=this.UF!==this.wX?sh.a.createTextRange(this.PX,this.UF,this.wX):sh.a.Lj(this.PX,this.wX);this.jJ.replaceTextRange(ea,w);this.wX=this.UF+w.length;const ra=xk.SelectionFactory.Sg(this.PX,this.wX);this.pa.setSelection(ra);this.pCb=!1;return!0}finally{T&&T.dispose()}}return!1}zmk(){var w=this.d8i();this.ia&&w&&w.U5a!==w.oYb&&0<=w.U5a&&(w=sh.a.createTextRange(w.node,
w.U5a,w.oYb),this.ia.La(qd.a.rOf,2,w))}d8i(){return this.PX?this.UF!==this.wX?sh.a.createTextRange(this.PX,this.UF,this.wX):sh.a.Lj(this.PX,this.wX):null}Q7f(w){var T=this.pa.Na.mb;if(T){var ea=T.Ua;if(ea&&(T=ea.node,ig.ParagraphReader.$d(T)&&(ea=w?ea.oYb:ea.U5a,T=ig.ParagraphReader.text(T),ea<=T.length)))return w?T.substring(ea,T.length):T.substring(0,ea)}return""}}Object(n.a)(qm,"DictationHost",null,[563]);class Vg{constructor(w,T,ea){this.jJ=w;this.pa=T;this.ia=ea}YCi(){return new qm(this.jJ,this.pa,
this.ia)}}Object(n.a)(Vg,"DictationHostFactory",null,[528]);class Dn{get name(){return"PowerPointWebEditor.Dictation"}Zb(w){w.register(Vg,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().oa(()=>new Vg(w.resolve("Box4.ICharacterPropertiesEditor"),w.resolve("Box4.ISelectionManager"),Q.AFrameworkApplication.Ta))}init(){}dispose(){}static main(){oa.a.instance.Dc(new Dn)}}Object(n.a)(Dn,"PPTWebEditorDictationPackage",null,[2,3]);var rl=d(457);class Fl{constructor(w,
T,ea=null){this.id=w.Id;ea||(ea="");this.eRk=ea;this.sensitivityLabel=w}}Object(n.a)(Fl,"AutoPolicyLabelData",null,[]);class cm{constructor(w,T){this.V7=w;this.displayName=T}}Object(n.a)(cm,"PolicyLabelRequestState",null,[]);class Io{constructor(){this.bUe=this.wFe=""}}Object(n.a)(Io,"PolicyStrings",null,[]);class Sk{static get Sme(){return Sk.aYj}}Sk.aYj="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(n.a)(Sk,"JustificationDialogHtml",null,[]);class nh extends Ub.a{constructor(w,T){super(!1,!1,nh.Q1);this.XNa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.HCc=null;this.GCc=!1;this.vDc=w;this.xD=T;this.rg=this.$ji();this.xd=1;this.hg=nh.id;this.Xe(1,CommonUIStrings.l_DialogChange);this.jD(1,!1);this.xya(0)}GYe(){if(nh.Q1)this.Zi(CommonUIStrings.l_SensitivityJustificationTitle,
Object(v.a)(this,this.cfh,"reactJustificationDialogHandler"),this.x5f(this.GCc));else{const w={};for(let T=0;T<this.XNa.length;T++)w[nh.SOe+T]=!1;w[nh.Wsc]="";this.Zi(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.$Xj,"justificationDialogHandler"),w);this.eQe();ff.a.addHandler($get(nh.Wsc),ic.a.input,Object(v.a)(this,this.sul,"textAreaHandler"))}}validate(){if(nh.Q1)return this.WIh(this.HCc);const w=$get(nh.Wsc);return w.disabled?!0:this.WIh(w.value)}WIh(w){const T=2>w.length,
ea=500<w.length,ra=RegExp("[{|}|;|\\\\]").test(w);w=""===S.a.yQe(w);return!T&&!ea&&!ra&&!w}$Xj(w,T){let ea="";if(1===w)for(let ra=0;ra<this.XNa.length;ra++)if(T[nh.SOe+ra]){ea=ra===this.XNa.length-1?T[nh.Wsc]:this.XNa[ra];break}this.xD(w,this.vDc,ea)}cfh(w){let T="";1===w&&this.HCc&&(T=this.HCc);this.xD(w,this.vDc,T)}yuk(w){this.HCc=w;w=this.validate();this.GCc!==w&&(this.GCc=w,this.H6(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.cfh,"reactJustificationDialogHandler"),this.x5f(this.GCc)))}x5f(w){return{["id"]:this.hg,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!w},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(v.a)(this,this.yuk,"onJustificationUpdated")}}sul(w){w.target&&this.jD(1,this.validate())}$ji(){return Ub.a.sC(nh.Sme,Q.AFrameworkApplication.rm,ah.getImageClass(nh.JEa),CommonUIStrings.l_SensitivityJustificationMessage,this.XNa[0],this.XNa[1],this.XNa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}eQe(){const w=document.getElementsByName(nh.t_j);for(let T=0;T<w.length;T++)ff.a.addHandler(w[T],ic.a.focus,Object(v.a)(this,this.Yjd,"radioButtonFocusHandler")),
ff.a.addHandler(w[T],ic.a.click,Object(v.a)(this,this.Yjd,"radioButtonFocusHandler"))}Yjd(w){if(w=w.target){w.checked=!0;var T=$get(nh.Wsc);w.id===nh.SOe+(this.XNa.length-1)?(T.disabled=!1,Sys.UI.DomElement.setVisible(T,!0),T.focus()):(T.disabled=!0,w.focus());this.jD(1,this.validate())}}static get Q1(){return Q.AFrameworkApplication.Aa.hb.GC&&Q.AFrameworkApplication.Aa.hb.ile}}nh.Sme=Sk.Sme;nh.t_j="ListRadioBox";nh.SOe="radiobox";nh.Wsc="txtJustification";nh.JEa="Info_32x32x32";nh.id="JustificationDialog";
Object(n.a)(nh,"JustificationDialog",Ub.a,[]);class Ik extends Ub.a{constructor(w,T,ea){super(!1,!1,!0);if(w&&ea){var ra={["id"]:"MandatoryLabellingDialog"};this.$Ph=ea;this.nFd=T;if(!Q.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.nFd&&""!==this.nFd)ra.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.nFd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
T={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(T.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:w});ra.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:T};w={["id"]:"MandatoryLabellingDialog",["bodyControls"]:ra};ra.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;ra.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.Zi(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(v.a)(this,this.Hjk,"mandatoryLabellingDialogHandler"),w)}else m.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}Hjk(w,T){1===w&&T.selectedLabel&&(w=T.selectedLabel,""!==w&&this.$Ph(w))}}Object(n.a)(Ik,"MandatoryLabellingDialog",Ub.a,[]);class Bj{constructor(){this.iqa=!!Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.hb.GC}FEi(w,T,ea){this.iqa&&new Ik(w,T,ea)}static get instance(){return Bj.Ka||
(Bj.Ka=new Bj)}}Bj.Ka=null;Object(n.a)(Bj,"MandatoryLabellingDialogFactory",null,[588]);class ef{}ef.Aql="sbProtectForm14";ef.Dql="SBStatusBarMarkAsReadOnly14";ef.FZj="Info_16x16x32";ef.rEf="QuickSearchCompletedToday_16x16x32";ef.oPe="CommonControlCheckboxCheck_16";ef.fCh="On";ef.visible="Visible";ef.YZi="ImageIsVisible";ef.XU="SourceControlId";ef.menuItemId="MenuItemId";ef.menu="Menu";ef.iwf="AppLockId";ef.value="Value";ef.labelText="LabelText";ef.alt="Alt";ef.edg="Image16by16";ef.myb="Image16by16Class";
ef.zql="SBProtectForm_16";ef.Cql="SBStatusBarMarkAsReadOnly_16";ef.icon="Icon";ef.iconColor="IconColor";ef.customTooltip="CustomTooltip";ef.GQk="MipTagDynamicFillWithOutline_20";ef.HQk="MipTagLockDynamicFillWithOutline_20";ef.FQk="MipTagErrorOutline_20";ef.IQk="MipTagQuestionOutline_20";ef.C2e="transparent";ef.GAl="UILocation";Object(n.a)(ef,"PolicyConstants",null,[]);class hn extends Ub.a{constructor(w,T,ea){super(!1,!1,hn.Q1);this.vDc=w;this.w2=T;this.xD=ea;this.xd=1;this.hg=hn.id;this.xya(1);this.xya(0)}hZe(){const w=
{["id"]:"UserDefinedPermissionsDialog"};hn.Q1&&this.Zi("Defined Permissions",Object(v.a)(this,this.lHl,"userDefinedPermissionsDialogHandler"),w)}lHl(w){1!==w&&this.xD(w,this.vDc,"",this.w2)}static get Q1(){return Q.AFrameworkApplication.Aa.hb.GC&&Q.AFrameworkApplication.Aa.hb.ile}}hn.id="UserDefinedPermissionsDialog";Object(n.a)(hn,"UserDefinedPermissionsDialog",Ub.a,[]);var zi=d(586),hl=d(193),dp=d(470);class Ai{constructor(w,T,ea,ra){this.JEd=this.eUb=null;this.hff=this.YDd=this.xEd=this.OTb=this.zgf=
this.hif=this.wzd=!1;this.qnb=this.iAa=this.aBa=this.PMa=this.w2=this.jv=this.Wha=this.Eh=null;this.lPh=this.Axd=0;this.VAd=this.ggf=this.n8e=this.jId=null;this.Ca=w;this.Rh=T;this.$a=ea;this.Zj=ra;this.OUb={};this.glf={};this.jif={};this.i9b=ea.ka("WacApplyManualPolicyLabelIsEnabled");this.Zj.value.GPd(Object(v.a)(this,this.sMe,"processAutoSensitivityLabel"));this.Zj.value.Suf(Object(v.a)(this,this.sMe,"processAutoSensitivityLabel"));this.Zj.value.jPd(Object(v.a)(this,this.Wyk,"onUpdateLabelInfo"));
Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.PK(Object(v.a)(this,this.SSk,"refreshDocumentPolicyLabelsOnModeChange"));ea.ka("SupportsPolicies")&&ea.Ga("AppliedPolicyId")&&(this.eUb=ea.Ga("IrmPolicyTitle"),this.JEd=ea.Ga("IrmPolicyDescription"));this.IId=ea.ka("ProtectedFile");this.CNh=this.$a.Bc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.DNh=this.$a.Bc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get vua(){return Q.AFrameworkApplication.vua||!!this.ggf&&this.ggf()}wb(){this.Ca.ya(Na.a.fJe,
Gb.a.frame,Object(v.a)(this,this.NNc,"documentLabelPaneHandler"));this.Ca.ra(Na.a.iJb,Gb.a.frame,Object(v.a)(this,this.iJb,"queryPolicyLabel"),96);Xf.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel")&&(this.Ca.ya(Na.a.u7g,Gb.a.frame,Object(v.a)(this,this.NNc,"documentLabelPaneHandler")),this.Ca.ra(Na.a.enc,Gb.a.frame,Object(v.a)(this,this.enc,"queryPolicyShortLabel"),96));this.Ca.ya(Na.a.slb,Gb.a.frame,Object(v.a)(this,this.slb,"toggleSensitivity"));
this.Ca.ya(Na.a.vhb,Gb.a.frame,Object(v.a)(this,this.vhb,"populateSensitivityFlyout"));this.Ca.ya(Na.a.Qjb,Gb.a.frame,Object(v.a)(this,this.Qjb,"setSensitivity"));this.Ca.ra(Na.a.jnc,Gb.a.frame,Object(v.a)(this,this.jnc,"querySensitivity"),96);this.Ca.ya(Na.a.bib,Gb.a.frame,Object(v.a)(this,this.bib,"querySensitivityToggleButton"));this.Ca.ya(Na.a.aib,Gb.a.frame,Object(v.a)(this,this.aib,"querySensitivitySubFlyout"));this.kYb(Na.a.slb)||this.Ca.je(Na.a.slb,4);this.kYb(Na.a.vhb)||this.Ca.je(Na.a.vhb,
4);this.kYb(Na.a.Qjb)||this.Ca.je(Na.a.Qjb,4);this.kYb(Na.a.bib)||this.Ca.je(Na.a.bib,4);this.kYb(Na.a.aib)||this.Ca.je(Na.a.aib,4);this.Rh.updateCommandUI();Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Xf.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Zj.value.iYk(Object(v.a)(this,this.qgh,"registerActionsHandler"))}qgh(){this.wb()}xFh(){this.Ca.PJ(Na.a.fJe,
Gb.a.frame,Object(v.a)(this,this.NNc,"documentLabelPaneHandler"));this.Ca.PJ(Na.a.iJb,Gb.a.frame,Object(v.a)(this,this.iJb,"queryPolicyLabel"));Xf.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel")&&(this.Ca.PJ(Na.a.u7g,Gb.a.frame,Object(v.a)(this,this.NNc,"documentLabelPaneHandler")),this.Ca.PJ(Na.a.enc,Gb.a.frame,Object(v.a)(this,this.enc,"queryPolicyShortLabel")));this.Ca.PJ(Na.a.slb,Gb.a.frame,Object(v.a)(this,this.slb,"toggleSensitivity"));
this.Ca.PJ(Na.a.vhb,Gb.a.frame,Object(v.a)(this,this.vhb,"populateSensitivityFlyout"));this.Ca.PJ(Na.a.Qjb,Gb.a.frame,Object(v.a)(this,this.Qjb,"setSensitivity"));this.Ca.PJ(Na.a.jnc,Gb.a.frame,Object(v.a)(this,this.jnc,"querySensitivity"));this.Ca.PJ(Na.a.bib,Gb.a.frame,Object(v.a)(this,this.bib,"querySensitivityToggleButton"));this.Ca.PJ(Na.a.aib,Gb.a.frame,Object(v.a)(this,this.aib,"querySensitivitySubFlyout"))}slb(){return 32}CZf(w){const T="mandatoryLabelling_"+w.Id;this.jif[T]=w.Id;return{["type"]:"AppToggleButtonProps",
["id"]:T,["label"]:w.DisplayName,["hideLabel"]:!1,["customTooltip"]:w.Tooltip}}tbb(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}tcj(){const w=[],T=this.Wha;for(let ra in T){var ea=T[ra];const wa=this.jv[ra];if(wa&&wa.Enabled&&!wa.HasUserDefinedPermissions)if(ea.count){const Za={["sections"]:[],["shouldAutoOpen"]:!1},ub={["id"]:"mandatoryLabelling_flyoutMenuSection_"+wa.Id,["controls"]:[]};for(let zb of ea)(ea=this.jv[zb])&&ea.Enabled&&!ea.HasUserDefinedPermissions&&
Array.add(ub.controls,this.CZf(ea));Array.add(Za.sections,ub);Array.add(w,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+wa.Id,["label"]:wa.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Za})}else Array.add(w,this.CZf(wa))}return w}vhb(w,T,ea,ra,wa){if(1===ea||!this.Zj.value.Qrb(!0))return 32;wa.MenuItems=Object.assign(new yd.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(wa.MenuItems.MenuSectionList,this.LLc(!this.isReactRibbonEnabled()));
this.Eh.CustomUrl&&Array.add(wa.MenuItems.MenuSectionList,this.lEi(this.isReactRibbonEnabled()?this.Eh.CustomUrl:S.a.ue(this.Eh.CustomUrl)));this.isReactRibbonEnabled()||(wa.PopulationXML=Nn.l(wa.MenuItems));return 32}jnc(w,T,ea,ra,wa){if(1===ea||!wa||!this.i9b)return 32;this.Eh=this.Zj.value.uu;if(this.Zj.value.Qrb(!0)&&(wa[ef.visible]=!0,this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.zgf||(kd.a("MipLabelsAvailable"),this.zgf=!0):kd.a("MipLabelsAvailable"),
this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.Eh&&this.Eh.AreLabelsAvailable&&(w=ia.a.instance.Ja("Common.ISystemInitiatedFeedback")))){const Za=Ai.Wa(this.Eh.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";w.execute(ub=>{ub.logActivity(Za,null)})}return 32}bib(w,T,ea,ra,wa){if(1===ea||!wa)return 32;let Za,ub;wa[ef.fCh]=!!(Za=wa[ef.menuItemId])&&!!(ub=this.OUb[Za])&&ub===this.Eh.AppliedPolicyId;
return 32}aib(w,T,ea,ra,wa){if(1===ea||!wa)return 32;let Za,ub,zb;w=!!(Za=wa[ef.XU])&&!!(ub=this.OUb[Za])&&!!(zb=this.Wha[ub])&&zb.contains(this.Eh.AppliedPolicyId);wa[ef.YZi]=w;wa[ef.fCh]=w;return 32}Qjb(w,T,ea,ra,wa){if(1===ea||!wa)return 32;w=this.OUb[wa[ef.XU]];T=this.HAl(wa[ef.GAl]);ea=new Be.a;ea.name="SensitivityPickerLocation";ea.int64=T;kd.a("SensitivityPickerUsage",void 0,void 0,[ea]);return this.bLa(w,wa,2)}XYc(){return!!Q.AFrameworkApplication.Aa&&1===Q.AFrameworkApplication.Aa.mode}SSk(){this.YDd&&
!this.XYc()&&(this.YDd=!1,this.Zj.value.RSk())}Cxl(){this.Eh.DefaultLabelId&&this.Eh.MandatoryLabelingEnforced?this.wzd||this.XYc()?this.Eh.AppliedPolicyId?this.Q1d(""):(this.Zj.value.fTj(this.Zj.value.Pac)||this.XYc())&&this.PRf():this.Kph():this.Eh.DefaultLabelId?this.Kph():this.Eh.MandatoryLabelingEnforced&&(this.Eh.AppliedPolicyId?this.Q1d(""):this.PRf())}Wjg(){return this.Eh.MandatoryLabelingEnforced?this.Eh&&this.Eh.AreLabelsAvailable?this.$a.ka("TestOverrideIsReactDialogEnabled")||this.Rh&&
this.Rh.hb&&this.Rh.hb.GC?!0:(m.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(m.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(m.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}PRf(){!this.Wjg()||Q.AFrameworkApplication.KQ||this.hif||(this.hif=Q.AFrameworkApplication.KQ=!0,m.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),
this.Zj.value.aeh("",1),this.Zj.value.FOd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.Fjk()}))}Q1d(w){this.Wjg()&&Q.AFrameworkApplication.KQ&&(Q.AFrameworkApplication.KQ=!1,m.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.Zj.value.HQe(),this.Zj.value.aeh(w,2))}Fjk(){Bj.instance.FEi(this.tcj(),this.Eh.CustomUrl,Object(v.a)(this,
this.Gjk,"mandatoryLabellingDialogCallback"))}Gjk(w){this.Q1d(this.jif[w])}azf(){return this.$a.ka("CoAuthForProtectedFilesEnabled")&&this.$a.ka("SupportsOfficeClientCoauthoring")&&this.$a.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.VAd&&this.vua}bLa(w,T,ea,ra=null){this.Zj.value.ePk(ea);let wa=32,Za=!1,ub=!0;const zb=2===ea||8===ea||16===ea,tc=w===this.Eh.AppliedPolicyId;if(this.n8e&&this.n8e(w,zb))m.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",
ea),this.Rh.updateCommandUI();else if(T&&ef.iwf in T&&this.Zj.value.KVe(T[ef.iwf]),w)if(this.Zj.value.hmg()||this.azf()&&this.xEd)m.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",ea),this.Rh.updateCommandUI(),zb&&this.ZGc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.$a.ka("HasDocumentEditRights"))if(this.Zj.value.opi(w))if(!this.tbb()&&
this.jv[w]&&this.jv[w].HasUserDefinedPermissions&&!tc)m.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",ea),1!==ea&&4!==ea&&this.Xci();else if(zb&&this.Eh.MandatoryLabelingEnforced&&tc)m.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",ea),this.ZGc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);
else{if(zb&&this.$a.ka("WacLabelingJustificationDialogIsEnabled")&&this.Eh.RequiredDowngradeJustification&&(tc||this.jv[w].RequiredDowngradeJustification)&&(this.tbb()?!this.hff&&!ra:!this.w2))return m.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",ea),this.GYe(w),wa;if(this.tbb()&&this.jv[w].HasUserDefinedPermissions&&!tc)return m.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",ea),this.hZe(w,ra),wa;if(this.azf()&&!this.VAd())this.Axd<
this.CNh?(m.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.Axd,ea),this.xEd=!0,this.Axd++,Ag.Task.delay(this.DNh).continueWith(()=>{this.xEd=!1;this.bLa(w,T,ea)})):(m.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",ea),Za=1!==ea,ub=!1,wa=8);else{if(this.sRj(w)&&(m.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",
ea),1===ea||8===ea||4===ea))return wa;m.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",ea);this.setPolicyLabel(tc?"":w,this.tbb()?ra:this.w2,"",ea);return wa}}else m.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",ea),this.Rh.updateCommandUI(),zb&&this.ZGc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else m.ULS.sendTraceTag(558892739,
306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",ea),this.Rh.updateCommandUI(),zb&&this.ZGc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else m.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",ea),this.Rh.updateCommandUI(),Za=zb,ub=!1,wa=8;this.Zj.value.yeh(0,ea,Za,ub);return wa}jxf(w,T,ea=null,ra=!1){u.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",
0,"wordclpfc",null);this.$a.ka("SupportsOfficeClientCoauthoring")&&this.$a.ka("CoAuthForProtectedFilesIsEnabled")?(this.OTb=!1,(this.Eh=this.Zj.value.uu)&&!this.Eh.AppliedPolicyId?this.OTb=!0:this.Eh&&this.Eh.PolicyLabelAssignmentMethod&&(this.OTb=hl.e(this.Eh.PolicyLabelAssignmentMethod)===hl.e("standard"))):this.OTb=ra;w=Ai.Wa(w)?null:this.jv[w];(T=Ai.Wa(T)?null:this.jv[T])?this.aBa=new Fl(T,!0,ea):(this.Zj.value.Yxa(29),this.iAa=null);w?this.PMa=new Fl(w,!1):this.qnb=null;this.sMe(null,null)}Eei(w){this.bLa(w,
null,16)}Eal(){this.jv={};if(this.Eh=this.Zj.value.uu)for(const w of this.Eh.SensitivityLabels)this.jv[w.Id]=w}sRj(w){if(this.Wha&&w in this.Wha){w=this.Wha[w];for(let T of w)if((w=this.jv[T])&&w.Enabled)return!0}return!1}acl(){this.Wha={};if(this.Eh=this.Zj.value.uu){for(const w of this.Eh.SensitivityLabels)w.ParentId||(this.Wha[w.Id]=new Ba.a);for(const w of this.Eh.SensitivityLabels){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemoveDisabledLabelsFromChildLabel",!1)){if(!(w.ParentId&&
w.ParentId in this.Wha&&w.Enabled))continue}else if(!(w.ParentId&&w.ParentId in this.Wha))continue;this.Wha[w.ParentId].add(w.Id)}}}pMk(){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.Eh=this.Zj.value.uu;const w=this.i9b&&this.isReactRibbonEnabled()&&this.Zj.value.Qrb();Ai.Nib(w)}else this.i9b&&this.isReactRibbonEnabled()?(this.Eh=this.Zj.value.uu,this.Zj.value.Qrb()?(Ai.Nib(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!1))):Ai.Nib(!1)):Ai.Nib(!1)}WTk(w){this.VAd=w}Kph(){if(this.$a.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.XYc())this.YDd=!0;else if(!this.wzd)if(this.wzd=!0,this.Eh=this.Zj.value.uu,this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.Eh&&this.Eh.DefaultLabelId)if(!this.Eh.AppliedPolicyId)m.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Eh.DefaultLabelType),this.bLa(this.Eh.DefaultLabelId,null,
1);else if(B.a.to().equals(this.Eh.DefaultLabelType,"documentLibraryDefault")){const w=this.jv[this.Eh.AppliedPolicyId],T=this.jv[this.Eh.DefaultLabelId];this.Eh.AppliedPolicyId!==this.Eh.DefaultLabelId&&B.a.to().equals(this.Eh.PolicyLabelAssignmentMethod,"standard")&&w.Order<T.Order&&(m.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Eh.DefaultLabelType),this.bLa(this.Eh.DefaultLabelId,null,1))}}else this.Eh&&this.Eh.DefaultLabelId&&!this.Eh.AppliedPolicyId&&
(m.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Eh.DefaultLabelId),this.bLa(this.Eh.DefaultLabelId,null,1))}sMe(){if(!this.Zj.value.hmg()){var w=this.jv[this.Eh.AppliedPolicyId];this.OTb&&this.PMa&&this.qnb!==this.PMa.id&&(!w||w.Order<this.PMa.sensitivityLabel.Order)&&(w=this.bLa(this.PMa.id,{},4),32!==w?m.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+w):(this.qnb=this.PMa.id,this.iAa&&(w=this.jv[this.iAa])&&
w.Order<=this.PMa.sensitivityLabel.Order&&(this.Zj.value.Yxa(29),this.iAa=null)));w=this.jv[this.Zj.value.uu.AppliedPolicyId];if(this.aBa&&this.iAa!==this.aBa.id&&(!w||w.Order<this.aBa.sensitivityLabel.Order)){const T=this.aBa.id;this.Zj.value.Yxa(29);this.Zj.value.OFc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.c9d(this.aBa.sensitivityLabel))+" "+this.aBa.eRk,CommonUIStrings.l_PolicyLabelRecommendationButton,()=>{this.bLa(T,{},
8)});this.iAa=this.aBa.id}this.aBa=this.PMa=null}}setPolicyLabel(w,T,ea,ra=2){this.tbb()?T&&(this.hff=!0):this.w2=T;this.Zj.value.setPolicyLabel(w);this.Rh.updateCommandUI();ea=new cm(ra,this.c9d(this.jv[w]));this.Zj.value.WVe(w,this.tbb()?T:this.w2,ea)}$zi(w,T,ea,ra){1===w&&this.setPolicyLabel(T,ra,ea)}Zzi(w,T,ea){1===w?this.tbb()?this.bLa(T,null,2,ea):this.setPolicyLabel(T===this.Eh.AppliedPolicyId?"":T,ea,""):this.Rh.updateCommandUI()}GYe(w){(new nh(w,Object(v.a)(this,this.Zzi,"continueToSetPolicyLabelFromJustificationDialog"))).GYe()}hZe(w,
T){(new hn(w,T,Object(v.a)(this,this.$zi,"continueToSetPolicyLabelFromUDPDialog"))).hZe()}ZGc(w="",T=""){const ea=new fb.StandardDialog;ea.Ar=Q.AFrameworkApplication.Kda;ea.xd=0;ea.Xe(1,CommonUIStrings.l_DialogClose);ea.fP(w,T,null)}uii(w){1===w&&this.Zj.value.NPk()}Xci(){const w=new fb.StandardDialog;w.Ar=Q.AFrameworkApplication.Kda;w.xd=1;w.Xe(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);w.Xe(0,CommonUIStrings.l_DialogClose);w.fP(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(v.a)(this,this.uii,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Rh&&!!this.Rh.hb&&this.Rh.hb.Oo}Rzb(){return this.Rh&&this.Rh.hb?this.Rh.hb.Rzb:!1}NNc(){return 32}iJb(w,T,ea,ra,wa){if(1===ea)return 32;this.Eh=this.Zj.value.uu;if(!this.Eh||!wa)return 32;wa[ef.value]="";wa[ef.labelText]="";wa[ef.alt]=null;wa[ef.edg]=null;wa[ef.myb]=null;wa[ef.customTooltip]="";wa[ef.visible]=!1;wa[ef.iconColor]="";ea=T=w=wa[ef.icon]="";if(!this.Eh.AreLabelsAvailable){if(!this.eUb)return 32;
w=this.eUb;ea=ef.C2e;this.JEd&&(T=this.JEd)}else if(this.Eh.AppliedPolicyId){ra=null;if(Xf.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.ClpQueryShortLabel"))this.jv&&(ra=this.jv[this.Eh.AppliedPolicyId]);else for(const Za of this.Eh.SensitivityLabels)if(Za.Id.toLowerCase()===this.Eh.AppliedPolicyId.toLowerCase()){ra=Za;break}ra&&(w=this.c9d(ra),T=ra.Tooltip,this.IId=Q.AFrameworkApplication.iG=ra.IsEndpointProtectionEnabled,ea=this.S_f(ra))}this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)?(w?(wa[ef.value]=w,wa[ef.labelText]=w,wa[ef.customTooltip]=T,this.oqh(ea,this.IId,wa)):(wa[ef.iconColor]=ef.C2e,this.Eh.MandatoryLabelingEnforced?(wa[ef.value]=wa[ef.labelText]=this.JTc().bUe,wa[ef.icon]=ef.FQk):(wa[ef.value]=wa[ef.labelText]=this.JTc().wFe,wa[ef.icon]=ef.IQk)),wa[ef.visible]=!0):w&&(wa[ef.value]=w,wa[ef.labelText]=w,this.Rzb()?wa[ef.customTooltip]=T:wa[ef.alt]=T,this.oqh(ea,this.IId,wa),wa[ef.visible]=!0);return 32}enc(w,T,ea,ra,wa){if(1===ea)return 32;this.Eh=this.Zj.value.uu;
if(!this.Eh||!wa)return 32;wa[ef.labelText]="";if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.Eh.HideBarByDefault)return 32;w="";if(this.Eh.AreLabelsAvailable)if(this.Eh.AppliedPolicyId){if(!this.jv)return 32;(T=this.jv[this.Zj.value.uu.AppliedPolicyId])&&(w=T.ParentId&&this.jv[T.ParentId]?this.jv[T.ParentId].DisplayName:T.DisplayName)}else w=this.Eh.MandatoryLabelingEnforced?this.JTc().bUe:this.JTc().wFe;else{if(!this.eUb)return 32;w=this.eUb}wa[ef.labelText]=
w;return 32}c9d(w){return w?this.jv?w.ParentId&&this.jv[w.ParentId]?this.jv[w.ParentId].DisplayName+"\\"+w.DisplayName:w.DisplayName:(m.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),w.DisplayName):""}oqh(w,T,ea){this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(ea[ef.icon]=this.G7f(T),ea[ef.iconColor]=this.H7f(w)):this.Rzb()?ea[ef.icon]=T?ef.zql:ef.Cql:(ea[ef.edg]=Q.AFrameworkApplication.rm,ea[ef.myb]=T?
ah.getImageClass(ef.Aql):ah.getImageClass(ef.Dql))}lEi(w){const T=this.Pt("LearnMoreSection",!0);w=Object.assign(new wn.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:w,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:Q.AFrameworkApplication.rm,Image16by16Class:ah.getImageClass(ef.FZj),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(T.ControlList,w);return T}sLf(w,T,ea=!1){let ra;ra="Toggle_"+w.Id;ra="Sensitivity_"+ra;const wa=
w.DisplayName,Za=w.Tooltip;var ub=w.Id===this.Eh.AppliedPolicyId,zb=ea?S.a.ue(ra):ra;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(ub=this.S_f(w),T=Object.assign(new rd.a,{Id:zb,ExternalId:zb,LabelText:ea?S.a.ue(wa):wa,Command:"2935633379",MenuItemId:zb,QueryCommand:"991261903",Visible:!0,Alt:ea?S.a.ue(Za):Za,AriaLabel:Xc.a.Rrb,IconColor:this.H7f(ub),KeyTip:T}),T.ExternalImageId=this.G7f(w.IsEndpointProtectionEnabled)):(zb=Object.assign(new zi.a,{Id:zb,ExternalId:zb,
LabelText:ea?S.a.ue(wa):wa,Command:"2935633379",MenuItemId:zb,QueryCommand:"991261903",CheckedImage:Q.AFrameworkApplication.rm,Visible:!0,Alt:ea?S.a.ue(Za):Za,IsChecked:ub,AriaLabel:Xc.a.Rrb,KeyTip:T}),this.isReactRibbonEnabled()?(zb.CheckedImageClass=ah.getImageClass(ef.oPe),zb.ExternalImageId=ef.oPe):zb.CheckedImageClass=ah.getImageClass(ef.rEf),T=zb);zb=ra;this.OUb[zb]=w.Id;this.glf[w.Id]=zb;return T}Pt(w,T=!1){return Object.assign(new Ma.a,{Title:"",Id:w,DisplayMode:ef.menu,ShowMenuSectionSeparator:T,
ControlsId:"Ctrl_"+w,ControlList:[]})}lHi(w,T,ea,ra){w=Ai.Zih()?this.Pt(w+"Sub"):this.Pt(T+"Sub");T=1;for(let wa of ea)(ea=this.jv[wa])&&ea.Enabled&&(Array.add(w.ControlList,this.sLf(ea,T.toString(),ra)),T++);return w}LLc(w=!1){const T=this.Pt("SensitivitySection");let ea=1;const ra=this.Wha;for(let Za in ra){const ub=ra[Za],zb=this.jv[Za];if(zb&&zb.Enabled){if(ub.count){const tc="Sensitivity_"+zb.Name;var wa=w?S.a.ue(tc):tc;wa=Ai.Zih()?"Label"+this.lPh++:wa;const pc=Object.assign(new xf.a,{Id:wa,
ExternalId:wa,LabelText:w?S.a.ue(zb.DisplayName):zb.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new yd.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Xc.a.Rrb,KeyTip:ea.toString(),Alt:w?S.a.ue(zb.Tooltip):zb.Tooltip});this.isReactRibbonEnabled()?pc.ExternalImageId=ef.oPe:(pc.Image16by16=Q.AFrameworkApplication.rm,pc.Image16by16Class=ah.getImageClass(ef.rEf));Array.add(pc.Menu.MenuSectionList,
this.lHi(wa,tc,ub,w));Array.add(T.ControlList,pc);this.OUb[pc.Id]=zb.Id;this.glf[zb.Id]=pc.Id}else Array.add(T.ControlList,this.sLf(zb,ea.toString(),w));ea++}}return T}kYb(w){return!!this.Ca.dT(w)&&!!this.Ca.dT(w).flags&&!!this.Ca.dT(w).flags.length}Wyk(w,T){T.onSuccess&&this.jv&&(w=this.jv[this.Zj.value.uu.AppliedPolicyId])&&(this.iAa&&(T=this.jv[this.iAa])&&T.Order<=w.Order&&(this.Zj.value.Yxa(29),this.iAa=null),this.qnb&&this.qnb!==w.Id&&(this.Zj.value.Yxa(28),this.qnb=null))}G7f(w){return w?ef.HQk:
ef.GQk}H7f(w){return w?w:ef.C2e}S_f(w){if(w.Color||!w.ParentId)return w.Color;const T=this.jv[w.ParentId];return T?T.Color:w.Color}HAl(w){switch(w){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}JTc(){this.jId||(this.jId=Object.assign(new Io,{wFe:HeaderStrings.NoSensitivityLabel,bUe:HeaderStrings.SelectASensitivityLabel}));return this.jId}static Zih(){if(null!=Ai.TCc)return Ai.TCc;Q.AFrameworkApplication.bGa("ce2ai523-t;6f627846-c");Ai.TCc=Q.AFrameworkApplication.fa?Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RenameCLPControlIds",
!1):!1;return Ai.TCc}static Nib(w){Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(w?(dp.a.baa("ribbon","sensitivity"),dp.a.Z$("ribbon","sensitivity")):dp.a.aaa("ribbon","sensitivity"));Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Xf.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!w))}static Wa(w){return w&&w.length?!1:!0}}Ai.TCc=null;Object(n.a)(Ai,"PolicyActor",null,[564]);var ui=d(1203),Mj;(function(w){w[w.unknown=0]="unknown";w[w.boot=1]="boot";w[w.refresh=2]="refresh";w[w.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(Mj||(Mj={}));Object(n.b)("GetPolicyLabelsReason",Mj);class Tk extends Sys.EventArgs{constructor(w,T,ea,ra,wa,Za){super();this.ysb=w;this.title=T;this.message=ea;this.buttonText=ra;this.a_b=wa;this.H_c=Za}}Object(n.a)(Tk,"AddAutoPolicyBusinessBarEntryEventArgs",
Sys.EventArgs,[]);class Jo extends Sys.EventArgs{constructor(w,T,ea,ra,wa){super();this.ysb=w;this.title=T;this.message=ea;this.buttonText=ra;this.a_b=wa}}Object(n.a)(Jo,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Sm;(function(w){w[w.none=0]="none";w[w.reasonDefaultLabel=1]="reasonDefaultLabel";w[w.reasonManual=2]="reasonManual";w[w.reasonAutomatic=4]="reasonAutomatic";w[w.reasonRecommended=8]="reasonRecommended";w[w.reasonMandatory=16]="reasonMandatory"})(Sm||(Sm={}));
Object(n.b)("ApplyLabelFlags",Sm);class jn extends Sys.EventArgs{constructor(w,T,ea){super();this.jGf=w;this.iGf=T;this.existingLabelPriority=ea}}Object(n.a)(jn,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class kn extends Sys.EventArgs{constructor(){super()}}Object(n.a)(kn,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class no extends Sys.EventArgs{constructor(){super()}}Object(n.a)(no,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class ze{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=
null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;
this.CustomUrl="";this.HideBarByDefault=!1}}Object(n.a)(ze,"GetPolicyLabelsData",null,[]);class ln extends Sys.EventArgs{constructor(w=!1){super();this.onSuccess=w}}Object(n.a)(ln,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Ko extends Sys.EventArgs{constructor(w,T){super();this.DXg=w;this.xQd=T}}Object(n.a)(Ko,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class rm extends Sys.EventArgs{constructor(w,T,ea,ra){super();this.title=w;this.jFk=T;this.buttonText=ea;this.mrk=ra}}Object(n.a)(rm,
"PolicyTipEventArgs",Sys.EventArgs,[]);class oo extends Sys.EventArgs{constructor(w,T){super();this.ysb=w;this.H_c=T}}Object(n.a)(oo,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class En extends Sys.EventArgs{constructor(){super()}}Object(n.a)(En,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class ni extends Sys.EventArgs{constructor(w,T){super();this.P$g=w;this.V7=T}}Object(n.a)(ni,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class Og extends Sys.EventArgs{constructor(w,
T,ea,ra=null,wa=null,Za=null,ub=null){super();this.errorType=w;this.Dll=ea;this.title=ra;this.message=wa;this.buttonText=Za;this.a_b=ub}}Object(n.a)(Og,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Ak extends Sys.EventArgs{constructor(){super()}}Object(n.a)(Ak,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class sc extends Sys.EventArgs{constructor(w){super();this.dil=w}}Object(n.a)(sc,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Xi=d(690),Gl=d(452);class dm{static U$k(w,
T){if(!w||!T||w.count!==T.count)return!1;for(let ea of w)if(!T.contains(ea))return!1;return!0}static toArray(w){if(!w)return null;const T=Array(w.count);let ea=0;for(let ra of w)T[ea]=ra,ea++;return T}}Object(n.a)(dm,"HashSetUtils",null,[]);var gk=d(777);class We{constructor(w,T,ea,ra=0,wa=null){this.szd=this.Jaf=null;this.aPa=this.PSb=this.QSb=0;this.Wga="";this.W4a=this.ygf=this.qxd=this.bDd=this.Uza=this.CFd=null;this.jff=!1;this.h2a=null;this.iCd=0;this.mCc=this.Z4a=this.f3a=this.lCc=null;this.Pa=
new ge.a;this.dqc=this.U5b=this.tS=null;this.XCd=!1;this.Pac=null;this.$a=w;this.Xh=T;this.Yh=ea;this.PAc=ra;this.uu=new ze;this.flf=this.$a.Ga("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.uG=wa;this.i9b=w.ka("WacApplyManualPolicyLabelIsEnabled");this.r9b=w.ka("CoAuthForProtectedFilesIsEnabled");this.Qkb=w.ka("SupportsOfficeClientCoauthoring");this.fUj=!1;this.icl=3E4;this.Zd=lg.a.instance;w.ka("SupportsPolicies")&&kd.a("MipSupportsPolicies");this.r9b&&this.Qkb&&kd.a("MipSupportsOfficeClientCoauthoring")}get yie(){return this.XCd}cai(w){this.Pa.addHandler("PolicyTipEvent",
w)}jPd(w){this.Pa.addHandler("LabelInfoUpdateEvent",w)}iYk(w){this.Pa.removeHandler("LabelInfoUpdateEvent",w)}GPd(w){this.Pa.addHandler("SetPolicyLabelEventKey",w)}Sih(w){this.Pa.removeHandler("SetPolicyLabelEventKey",w)}Suf(w){this.Pa.addHandler("SetPolicyLabelFailureEventKey",w)}d9h(w){this.Pa.addHandler("GetAutoPolicyLabelEventKey",w);this.yie&&(m.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.$Oe(new kn(0)))}O8h(w){this.Pa.addHandler("CreateAutoCLPSecurityNodesEventKey",
w)}qbi(w){this.Pa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",w)}rbi(w){this.Pa.addHandler("UpdateAutoCLPSITNodesEventKey",w)}s8h(w){this.Pa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",w)}qai(w){this.Pa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",w)}t8h(w){this.Pa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",w)}rai(w){this.Pa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",w)}x9h(w){this.Pa.addHandler("MandatoryLabellingAppHandlerEventKey",w)}nbi(w){this.Pa.addHandler("UDPLabelingAppHandlerEventKey",
w)}get GMj(){if(!this.Jaf)return!1;for(const w of this.Jaf.l5d())if(!w.Capabilities||!w.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get Mlg(){return!!this.tS}oDj(w){w&&this.r9b&&this.Qkb&&w.execute(Object(v.a)(this,this.cSd,"awaitRtc"))}AUk(w){this.bDd=w}Dri(){return this.bDd?this.bDd():!1}qTk(w){this.qxd=w}EF(){return(new Date).getTime()}cSd(w){if(!this.Mlg){var T=w.lM.task;T.continueWith(()=>{this.tS=T.result;this.tS.WBa(Object(v.a)(this,this.Euk,"onLabelChangeUpdateOverRtc"))})}}Euk(w,
T){12===T.type&&(this.ygf?this.ygf():this.JSa(this.Wga,2,this.Uza,!0))}d1f(){this.Yh&&(this.lCc=this.Yh.Ci("WebServiceCall","Call Get Policy Endpoint On Server"));var w=gk.a.MCa(1,1);this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(w=new Xi.a(this.ixb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,w),this.Xh.send(w).XJb(Object(v.a)(this,this.x2g,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.w2g,"onDataLossPolicyFailureCallback"))):
this.Xh.mj(this.ixb("datalosspolicy"),1,null,null,!0,2,Object(v.a)(this,this.x2g,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.w2g,"onDataLossPolicyFailureCallback"),null);this.QSb++;m.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.flf,this.QSb)}RSk(){this.JSa(this.Wga,2,this.Uza)}JSa(w,T=0,ea=null,ra=!1){u.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.L6d(void 0,T));this.U5b=this.EF();
const wa=this.OXd(T);this.mSc(w,wa,ea,ra,T);this.TRe(!0)}x2g(w){this.O$g();let T="";({data:T}=this.j3e(w)).returnValue&&(m.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.QSb=0,this.Yh&&(this.mCc=this.Yh.Ci("Task","Parse and Handle Get Policy Response")),this.nCk(T),this.mCc&&(this.mCc.stop(),this.mCc=null))}w2g(w){this.O$g();this.QSb<=this.PAc?this.d1f():(m.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",
w?w.data?w.data.DKb:null:null),this.QSb=0)}hmg(){return 0<this.aPa}setPolicyLabel(w){this.uu.AppliedPolicyId=w}WVe(w,T,ea=null){const ra=this.UDi(ea);this.hcl(w,T,ra,ea)}H5g(w){this.Z4a&&(this.Z4a.stop(),this.Z4a=null);let T,ea;({qoh:T,Rqh:ea}=this.n6f(w));const ra=w.data.state,wa=ra?ra.V7:2;let Za="";({data:Za}=this.j3e(w)).returnValue?(m.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",wa),this.aPa=0,this.UCk(Za,T,ea,ra)):this.QSe(wa)}ePk(w){u.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.L6d(w));this.dqc=this.EF();m.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Pa.raiseEvent("SetPolicyLabelTriggeredEventKey",new Ak(w))}Xok(){this.r9b&&this.Qkb&&this.Mlg&&this.tS.Zfa(12,null,!0)}G5g(w){this.Z4a&&(this.Z4a.stop(),this.Z4a=null);let T;({qoh:ea,Rqh:T}=this.n6f(w));if(this.aPa<=this.PAc)this.WVe(ea,T);else{var ea=(ea=w.data.state)?ea.V7:2;m.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",
w?w.data?w.data.DKb:null:null,ea);this.Pac="WACServerConnectionFailed";this.aPa=0;this.QSe(ea)}}fTj(w){if(w&&("LabelNotSupported"===w||"LabelErrorRetryLater"===w||"CoherencyFailure"===w||"LabelIdNotFound"===w||"LabelDisabled"===w))return m.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",w),!0;m.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",w);return!1}opi(w){if(!w)return!1;let T=null,ea=null;for(const ra of this.uu.SensitivityLabels)ra.Id===w&&(T=ra),ra.Id===
this.Wga&&(ea=ra);if(!T)return!1;if(this.r9b&&this.Qkb){if(this.qxd&&this.qxd()||this.GMj)return!0}else if(Q.AFrameworkApplication.PA&&Q.AFrameworkApplication.PA.RDa||this.Uza&&this.Uza())return!0;return T.IsEndpointProtectionEnabled===(!!ea&&ea.IsEndpointProtectionEnabled)}OFc(w,T,ea,ra,wa){28===w?this.Mdh(new Tk(w,T,ea,ra,wa,!1)):this.Mdh(new Tk(w,T,ea,ra,wa,!0))}Yxa(w){28===w?this.oeh(new oo(w,!1)):this.oeh(new oo(w,!0))}BNk(w,T,ea){m.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");
this.Pa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new jn(w,T,ea))}QPk(w){m.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Pa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new jn(null,null,w))}RPk(w,T){m.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Pa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new jn(w,T,null))}aeh(w,T){m.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===T?"Reading":"Edit")+
" switch event.");this.Pa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Ko(w,T))}FOd(w,T,ea,ra,wa){37===w&&this.fNk(new Jo(37,T,ea,ra,wa))}HQe(){this.POk(new En)}NPk(){m.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Pa.raiseEvent("UDPLabelingAppHandlerEventKey",new sc(!0))}Qrb(w=!1){const T=!!this.uu&&this.uu.AreLabelsAvailable&&!!this.uu.SensitivityLabels&&0<this.uu.SensitivityLabels.length&&Bi.a.any(this.uu.SensitivityLabels,ea=>!!ea&&ea.Enabled);T||w||Ai.Nib(!1);
return T}C3g(w){this.f3a&&(this.f3a.stop(),this.f3a=null);var T="";this.TRe(!1);({data:T}=this.j3e(w)).returnValue?(m.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.PSb=0,T=this.ECk(T),w=this.Z4f(w.data),u.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.eRc(void 0,w,this.U5b)),this.U5b=null,w=new kn(w),this.UNk(w),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?T&&this.Ggl()?this.yie?this.qCl():(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",
!1)||this.lLc(),this.$Oe(w),this.XCd=!0):T||this.lkd():!this.yie&&T&&this.$a.ka("WacApplyManualPolicyLabelIsEnabled")&&this.Pxf()?(this.$Oe(w),this.XCd=!0):T||this.lkd()):this.lkd()}Ggl(){if(!this.$a.ka("WacApplyManualPolicyLabelIsEnabled"))return m.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.Pxf())return!1;if(""===this.Wga)return m.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),
!0;if(this.h2a===this.iCd)return m.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;m.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}lLc(){this.WFh();m.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.W4a.count,this.h2a);const w=dm.toArray(this.W4a);this.BNk(w,
w,this.h2a)}qCl(){var w=this.W4a;this.WFh();dm.U$k(w,this.W4a)||(m.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.W4a.count),w=dm.toArray(this.W4a),this.RPk(w,w));this.jff&&(m.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.h2a),this.QPk(this.h2a))}WFh(){const w=new ui.a(B.a.to());for(const T of this.uu.SensitivityLabels)if(T&&T.AutoLabelingSensitiveTypeIds&&0<T.AutoLabelingSensitiveTypeIds.length)for(const ea of T.AutoLabelingSensitiveTypeIds)ea&&
w.add(ea);this.W4a=w}B3g(w){const T=this.Z4f(w.data);u.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.eRc(void 0,T,this.U5b));this.U5b=null;this.f3a&&(this.f3a.stop(),this.f3a=null);if(this.PSb<=this.PAc){if(this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const ea=w.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in ea&&ea[gk.a.PTe]&&"HostAttributionInfo.ScenarioTypeParamName"in ea&&ea[gk.a.QTe]){w.data.request.get_headers();
w.data.request.get_headers();w=this.OXd(T);this.mSc(this.Wga,w,this.Uza,void 0,T);return}}this.JSa(this.Wga,T,this.Uza)}else m.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",w?w.data?w.data.DKb:null:null),this.lkd(),this.PSb=0,this.TRe(!1)}Z4f(w){return w.state?w.state:0}ixb(w,T=!1){let ea=String.format("{0}{1}?action={2}&{3}",this.$a.Ga("PolicyHandlerWebServiceBase")||Q.AFrameworkApplication.Aa.hb.lna,this.flf,w,Q.AFrameworkApplication.gh);"setpolicylabel"===
w&&Q.AFrameworkApplication.PA&&Q.AFrameworkApplication.PA.zje&&(ea=J.a.Ki(ea,"sl","1"));T&&(ea=J.a.Ki(ea,"cbd","1"));return ea}n6f(w){let T,ea;T=ea=null;w&&w.data&&w.data.request&&w.data.request.get_headers()&&(T=w.data.request.get_headers()[Gl.a.roh],ea=w.data.request.get_headers()[Gl.a.Sqh]);return{qoh:T,Rqh:ea}}j3e(w){w=w?w.data?w.data.Sd:null:null;return w&&w.length&&!this.bUj(w)?{returnValue:!0,data:w}:(m.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,
data:w})}nCk(w){let T;try{T=X.b(w)}catch(ea){m.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(T)if(T.IsPolicyTipAvailable)switch(T.IsPolicyTipAvailable.toLowerCase()){case "false":m.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":m.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.szd=T.NavigateUrl;this.Vll(T.GeneralText,Object(v.a)(this,
this.jsk,"onDataLossPolicyOverrideButtonClick"));break;default:m.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",T.IsPolicyTipAvailable)}else m.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else m.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}OAi(w){switch(w){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;
case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}UCk(w,T,ea,ra){var wa=ra?ra.V7:2;let Za=0,ub="",zb;if(({rv:zb}=X.d(w)).returnValue)if(zb){ub=
"Success";w=this.OXd(3);if(zb.IsSuccessful){u.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.eRc(wa,void 0,this.dqc));this.Pac=this.dqc=null;m.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",wa);2===wa&&this.Yxa(29);this.cdl(T,wa);this.Xok();this.Yxa(28);ra&&4===wa&&this.OFc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,ra.displayName),
CommonUIStrings.l_DialogOk,()=>{});kd.a("MipAppliedLabels",void 0,void 0,[Object.assign(new Be.a,{name:"SetPolicyLabelApplyFlag",string:Sm[wa]})]);this.mSc(T,w,this.Uza,void 0,3);return}m.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",wa,zb.FailureReason);this.Pac=zb.FailureReason;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?Za=this.OAi(zb.FailureReason):
"FileTooLarge"===zb.FailureReason?Za=7:"LabelNotSupported"===zb.FailureReason?Za=13:"LabelDisabled"===zb.FailureReason?Za=9:"MinorVersionLimitExceeded"===zb.FailureReason&&(Za=15);this.fUj&&0<=zb.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(ra=new Kd.a(2,1,this.icl,()=>{m.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.aPa);this.aPa<=this.PAc&&this.WVe(T,ea)}),this.Zd.Db(ra));this.r9b&&this.Qkb&&
this.mSc(this.uu.AppliedPolicyId,w,this.Uza,!0,3)}else ub="setPolicyLabelData null.",m.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",wa);else ub="TryDeserialize failed.",m.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",wa);this.QSe(wa,Za);wa=this.eRc(wa,void 0,this.dqc);this.dqc=null;wa.extendedProperties.set("SetPolicyLabelDataFailureReason",this.Pac);
wa.extendedProperties.set("SetPolicyLabelDataParseStatus",ub.toString());u.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,wa)}QSe(w,T=0){const ea=2===w||8===w||16===w;this.setPolicyLabel(this.Wga);this.Zdh(new ln);this.yeh(T,w,ea,!1)}cdl(w,T){this.setPolicyLabel(this.Wga=w);if(""===w)Q.AFrameworkApplication.iG=!1,Q.AFrameworkApplication.l3b=!1;else for(const ea of this.uu.SensitivityLabels)if(ea.Id===w){Q.AFrameworkApplication.iG=ea.IsEndpointProtectionEnabled;
break}this.dPk(new ni(w,T))}eEl(){for(const w of this.uu.SensitivityLabels)w&&w.Enabled&&(w.Id===this.Wga&&(this.jff=this.h2a!==w.Order,this.h2a=w.Order),w.Order>this.iCd&&(this.iCd=w.Order))}ECk(w){if(!({rv:w}=X.d(w)).returnValue)return m.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!w)return m.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!w.AreLabelsAvailable)return!1;this.uu=w;this.Wga=
w.AppliedPolicyId;this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.eEl();this.Qrb()&&m.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.Zdh(new ln(!0));return!0}Pxf(){if(!this.Qrb())return m.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const w of this.uu.SensitivityLabels)if(w&&w.AutoLabelingSensitiveTypeIds&&0<w.AutoLabelingSensitiveTypeIds.length)return!0;
m.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}Zdh(w){m.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Pa.raiseEvent("LabelInfoUpdateEvent",w)}UNk(w){m.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Pa.raiseEvent("GetPolicyLabelEventKey",w)}lkd(){Ai.Nib(!1);this.Pa.raiseEvent("GetPolicyLabelFailureEventKey",new no)}$Oe(w){this.uG&&this.uG.execute(T=>{T=[T.isFeatureEnabled("MsoClpSpTwo",
!0),T.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(T).then(ea=>{Bi.a.any(ea,ra=>ra)&&(m.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Pa.raiseEvent("GetAutoPolicyLabelEventKey",w),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.lLc(),kd.a("MipAutoClassificationEnabled"));return null})})}L6d(w=null,T=null){const ea=new Map;ea.set("ClpCoauth",this.Qkb.toString());null!=w&&ea.set("ApplyLabelFlags",
Sm[w]);null!=T&&ea.set("GetPolicyLabelsReason",Mj[T]);return ea}eRc(w=null,T=null,ea=null){const ra=new Ca.a;ra.extendedProperties=this.L6d(w,T);null!=ea&&(ra.durationMs=this.EF()-ea);return ra}dPk(w){m.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Pa.raiseEvent("SetPolicyLabelEventKey",w)}Mdh(w){m.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");w&&w.H_c&&kd.a("MipRecommendations");this.Pa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",
w)}oeh(w){m.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Pa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",w)}fNk(w){m.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Pa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",w)}POk(w){m.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.Pa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",
w)}Vll(w,T=null){m.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Pa.raiseEvent("PolicyTipEvent",new rm(CommonUIStrings.l_PolicyBusinessBarTitle,w,CommonUIStrings.l_PolicyOverrideButton,T))}yeh(w,T,ea,ra=!0){m.ULS.sendTraceTag(42074656,306,ra?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",T);ra=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let wa=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,Za=null,ub=null;switch(w){case 2:ra=
CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;wa=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:wa=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:ra=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;wa=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:ra=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
wa=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:ra=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;wa=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:wa=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:ra=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;wa=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:ra=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,wa=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Za=CommonUIStrings.l_LearnMore,ub=()=>{this.jcl()}}w=new Og(w,T,ea,ra,wa,Za,ub);this.Pa.raiseEvent("SetPolicyLabelFailureEventKey",w)}KVe(w){this.CFd=w}jsk(){this.szd?(m.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),xb.a.qQc(this.szd)):m.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}bUj(w){if(!w.startsWith("<")||
-1===w.indexOf("Error")&&-1===w.indexOf("Unavailable"))return!1;m.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}O$g(){this.lCc&&(this.lCc.stop(),this.lCc=null)}s2i(w){if(!w)return"manual";switch(w.V7){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}x3i(w){if(!w)return"privileged";
w=w.V7;let T="privileged";if(4===w||1===w)T="standard";return T}mSc(w,T,ea=null,ra=!1,wa=0){this.$a.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.Wga=w,this.Uza=ea,this.Yh&&(this.f3a=this.Yh.Ci("WebServiceCall","Call Get Policy Endpoint On Server")),ea={},ea[Gl.a.cei]=w,this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(w=new Xi.a(this.ixb("getpolicylabels",ra),1,null,ea,!0,2,wa,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,T),this.Xh.send(w).XJb(Object(v.a)(this,
this.C3g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.B3g,"onGetPolicyLabelsFailureCallback"))):this.Xh.mj(this.ixb("getpolicylabels",ra),1,null,ea,!0,2,Object(v.a)(this,this.C3g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.B3g,"onGetPolicyLabelsFailureCallback"),wa,void 0,void 0,void 0,void 0,"22"),this.PSb++,m.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.PSb))}hcl(w,T,ea,ra=null){if(this.i9b){this.Yh&&(this.Z4a=this.Yh.Ci("WebServiceCall",
"Call Set Policy Endpoint On Server"));var wa={};wa[Gl.a.roh]=w;T&&(wa[Gl.a.Sqh]=encodeURIComponent(T));this.CFd&&(wa[Gl.a.Adi]=this.CFd);ra?(wa[Gl.a.Pqh]=this.s2i(ra),wa[Gl.a.Qqh]=this.x3i(ra),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===ra.V7&&this.uu.DefaultLabelType&&(wa[Gl.a.gcl]=this.uu.DefaultLabelType)):(wa[Gl.a.Pqh]="manual",wa[Gl.a.Qqh]="privileged");this.Qkb&&this.uu&&(wa[Gl.a.iFk]=this.uu.PolicyLabelVersionToken);this.$a.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(w=new Xi.a(this.ixb("setpolicylabel",!0),1,null,wa,!0,2,ra,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ea),this.Xh.send(w).XJb(Object(v.a)(this,this.H5g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.G5g,"onSetPolicyLabelFailureCallback"))):this.Xh.mj(this.ixb("setpolicylabel",!0),1,null,wa,!0,2,Object(v.a)(this,this.H5g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.G5g,"onSetPolicyLabelFailureCallback"),ra,void 0,void 0,void 0,void 0,
"32");this.aPa++;m.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.aPa)}else m.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}jcl(){const w=new fb.StandardDialog,T=this.$a.Ga("BreadcrumbFolderUrl");T?(w.xd=11,w.Xe(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),w.Xe(2,CommonUIStrings.l_DialogOk)):(w.xd=0,w.Xe(1,CommonUIStrings.l_DialogOk));
w.zOd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");w.EWk();w.fP(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,ea=>{1===ea&&T&&xb.a.vn(T,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}OXd(w){switch(w){case 1:return gk.a.MCa(1,1);case 2:return gk.a.MCa(7,1);case 3:return gk.a.MCa(8,
1);default:return gk.a.MCa(7,0)}}UDi(w=null){if(!w)return gk.a.MCa(8,0);switch(w.V7){case 1:case 16:return gk.a.MCa(1,1);case 4:case 2:case 8:return gk.a.MCa(8,1);default:return gk.a.MCa(8,0)}}TRe(w){this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",w)}}Object(n.a)(We,"PolicyManager",null,[527]);class po{constructor(){this.xKd=this.kId=this.iif=this.dmf=this.d8e=this.xn=this.IOa=this.Da=this.Zj=null}get name(){return"Common.App.Policy"}init(){Q.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&
(Q.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&Q.AFrameworkApplication.Aa&&(this.Zj=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Zj.cai(Object(v.a)(this,this.Ull,"showPolicyBusinessBar")),m.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),Dm.a.get_instance().ek(6,()=>{this.Zj.d1f()})),Q.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&Q.AFrameworkApplication.fa.ka("SupportsPolicies")?Dm.a.get_instance().ek(6,Object(v.a)(this,
this.sqk,"onAfterRibbonBehaviorAttached")):Ai.Nib(!1))}dispose(){}Zb(w){w.register(527,"Common.App.Policy.Contracts.IPolicyManager").ma().oa(()=>new We(Q.AFrameworkApplication.fa,Q.AFrameworkApplication.Ke,Q.AFrameworkApplication.Aa.gV,Q.AFrameworkApplication.fa.Bc("MaxGetPolicyRetries",1),w.Ja("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Q.AFrameworkApplication.Aa.hb.Uk));w.register(Ai,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().oa(()=>
new Ai(Q.AFrameworkApplication.Ta,Q.AFrameworkApplication.Aa,Q.AFrameworkApplication.fa,w.ie("Common.App.Policy.Contracts.IPolicyManager")));this.Da=w}sqk(){this.xn=this.Da.ub("CommonUI.BusinessBar");this.Zj||(this.Zj=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.IOa=this.Da.resolve("Common.App.Policy.PolicyActor");Q.AFrameworkApplication.fa&&Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Xf.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Zj.jPd(Object(v.a)(this.IOa,this.IOa.qgh,"registerActionsHandler")):this.IOa.wb();this.Zj.jPd(Object(v.a)(this,this.dEl,"updateLabelInfo"));Q.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&(this.Zj.Suf(Object(v.a)(this,this.dwj,"handleSetPolicyLabelFailure")),this.Zj.s8h(Object(v.a)(this,this.OFc,"addAutoPolicyBusinessBarEntry")),this.Zj.qai(Object(v.a)(this,this.Yxa,"removeAutoPolicyBusinessBarEntry")),
this.Zj.t8h(Object(v.a)(this,this.FOd,"addMandatoryLabellingBusinessBarEntry")),this.Zj.rai(Object(v.a)(this,this.HQe,"removeMandatoryLabellingBusinessBarEntry")))}dEl(){this.IOa.acl();this.IOa.Eal();this.IOa.pMk();const w=this.Zj.Dri();Q.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&!w?this.IOa.Cxl():m.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",Q.AFrameworkApplication.fa.ka("HasDocumentEditRights"),
w);Q.AFrameworkApplication.Aa.updateCommandUI()}Ull(w,T){this.kId&&this.xn.Lda(38)&&this.xn.removeEntry(this.kId);w=this.X4f(T.title,T.jFk,38,T.mrk,T.buttonText);Q.AFrameworkApplication.Aa.hb.QFc(w,!0)?(this.kId=w,m.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):m.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}dwj(w,T){T.Dll&&(this.xKd&&this.xn.Lda(21)&&this.xn.removeEntry(this.xKd),
w=this.X4f(T.title,T.message,21,null,null,T.a_b,T.buttonText),Q.AFrameworkApplication.Aa.hb.QFc(w,!0)?(this.xKd=w,m.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):m.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Yxa(w,T){(w=T.H_c?this.dmf:this.d8e)&&this.xn&&this.xn.Lda(T.ysb)&&this.xn.removeEntry(w)}OFc(w,T){this.xn&&(this.Zj.Yxa(T.ysb),w=new rl.a(T.title,T.message,
null),w.id=T.ysb,w.closeable=!0,w.image=3,w.addButton(T.buttonText,T.a_b,T.buttonText,!0),this.xn.Zh(w,!1),T.H_c?this.dmf=w:this.d8e=w)}FOd(w,T){this.xn&&(w=new rl.a(T.title,T.message,null),w.id=T.ysb,w.closeable=!1,w.image=3,w.addButton(T.buttonText,T.a_b,T.buttonText,!1),this.xn.Zh(w,!1),this.iif=w)}HQe(){const w=this.iif;w&&this.xn&&this.xn.Lda(w.id)&&this.xn.removeEntry(w)}X4f(w,T,ea,ra=null,wa=null,Za=null,ub=null){w=new rl.a(w,T,null);w.id=ea;w.closeable=!0;ra&&w.Tsf(wa,ra);Za&&w.addButton(ub,
Za,ub);return w}static main(){oa.a.instance.Dc(new po)}}Object(n.a)(po,"PackageManager",null,[2,3]);var Lo=d(291),qo=d(320),Mo=d(143);class Tm extends qo.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new Mo.a,{T_:Tm.getTypeName(),B_:Tm.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}Object(n.a)(Tm,"SecurityShared",qo.a,[]);class em extends Tm{constructor(){super();this.existingLabelPriority=
null;this.H_=Object.assign(new Mo.a,{T_:em.getTypeName(),B_:em.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(n.a)(em,"CLP",Tm,[]);var Nj=d(348),Rn=d(379),mn=d(691);class ro extends Ug.a{constructor(w){super();this.TenantId=null;this.TenantId=w}Zk(){return 103}}Object(n.a)(ro,"GetAppliedPolicyIdRequest",Ug.a,[]);class Uk extends Sys.EventArgs{constructor(w){super();this.Dia=w}}Object(n.a)(Uk,"OnAppliedPolicyReceivedEventArgs",
Sys.EventArgs,[]);class ep{constructor(w,T,ea){this.J0=this.mve=this.x5c=null;this.va=new ge.a;this.b$b=!1;this.vi=w;this.wcb=T;this.Pb=ea;this.wcb.D9h(Object(v.a)(this,this.A1g,"onAppliedPolicyIdReady"));this.wcb.n$h(Object(v.a)(this,this.X3g,"onIsManuallyAppliedReady"))}E9h(w){this.va.addHandler("AppliedPolicyEventReceivedKey",w)}dispose(){this.wcb.rYk(Object(v.a)(this,this.A1g,"onAppliedPolicyIdReady"));this.wcb.OYk(Object(v.a)(this,this.X3g,"onIsManuallyAppliedReady"))}DZf(w,T){w?(this.J0=w,this.x5c=
T,w=new jj.a(new ro(w),ea=>{this.Wfd(ea)},ea=>this.Ugb(ea)),this.vi.Db(w)):Cc.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}Paj(w,T){!T||S.a.Wa(w)?Cc.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.J0=w,this.mve=T,w=new jj.a(new ro(w),ea=>{this.Wfd(ea)},ea=>this.Ugb(ea)),this.vi.Db(w))}A1g(w,T){w="";S.a.Wa(T.Dia)||(w=T.Dia);"00000000-0000-0000-0000-000000000000"===w?(T=S.a.Wa(this.J0)?this.Pb.Ga("TenantId"):this.J0,this.DZf(T,
this.x5c)):this.qGe(w,null)}X3g(w,T){this.wuk(T.b$b)}Wfd(w){let T=null;w.ServerError&&0!==w.ServerError.Code?T=K.a[w.ServerError.Code]:0!==w.StatusCode&&(T=ck.a[w.StatusCode]);T&&this.qGe("",T)}Ugb(){Cc.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.qGe("","ErrorGetAppliedPolicyIdFailed");return!0}qGe(w,T){T&&Cc.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+T);this.x5c?this.x5c(w,T):Cc.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");Cc.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");
w=new Uk(w);this.va.raiseEvent("AppliedPolicyEventReceivedKey",w)}wuk(w){this.mve?this.mve(w,null):Cc.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(n.a)(ep,"AppliedPolicyIdService",null,[405,106]);class yp{constructor(w,T,ea,ra){this.lEb=w;this.hGa=T;this.jU=ea;this.la=ra}s_(w){var T=w.automatic||{},ea=T.sensitivityLabel||{};T=this.xie()?T.id:ea.id;ea=w.recommended||{};const ra=ea.sensitivityLabel||{};w=this.xie()?ea.id:ra.id;ea=this.xie()?ea.policyTip:ra.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?
this.lEb.jxf(T,w,ea,!this.jU.uu.AppliedPolicyId||!this.hGa.b$b):this.lEb.jxf(T,w,ea,!this.jU.uu.AppliedPolicyId)}xie(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(n.a)(yp,"AutoClpAnnotationEventHandler",null,[]);class Qk{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(n.a)(Qk,"PolicyInfo",null,[]);var No=d(1004);class t{constructor(){this.aIb=
this.startTime=null}}Object(n.a)(t,"PollingData",null,[]);class ba{constructor(w,T,ea,ra,wa,Za,ub,zb,tc,pc,bc,yc){this.iTg=this.XCb=!1;this.o4c=null;this.ICg=!1;this.ia=w;this.lEb=T;this.jU=ea;this.J0=ra;this.Aug=new Ba.a;this.M8j=wa;this.hGa=Za;this.zb=ub;this.gTg=zb;this.Gq=tc;this.kJ=pc;this.Kv=bc;this.mc=yc;this.sKg=Q.AFrameworkApplication.fa.Bc("ClpLabelPollingIntervalMs",3E4);this.Rze=Q.AFrameworkApplication.fa.Bc("ClpLabelPollingTimeoutMs",3E5);this.Yma=Q.AFrameworkApplication.fa.Ga("UserName");
this.uik=Q.AFrameworkApplication.fa.Ga("UserPrincipalName");this.q7j=this.p8i()}p8i(){let w;if(Q.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(w=Q.AFrameworkApplication.fa.Ga("EditDocInClientUrl"))return Cc.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),w;Cc.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(w=Q.AFrameworkApplication.fa.Ga("WOPISrc"))||Cc.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");
Cc.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return w}dispose(){this.lEb=null;if(this.XCb){this.jU.Sih(Object(v.a)(this,this.F5g,"onSetLabelSucceeded"));for(let w of this.Aug)this.jU.Sih(w)}}init(){this.lEb.wb();this.lEb.Ee();if(Q.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&Q.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const w=Object(y.a)(No.a,tf.App.Ih);w&&this.jU.qTk(Object(v.a)(w,w.kfi,"areAllCoauthorsInSessionClientMipTrusted"));this.jU.oDj(this.M8j);
0<this.sKg&&0<this.Rze&&this.hGa.E9h(Object(v.a)(this,this.Jsk,"onDocumentContentPolicyChanged"));Q.AFrameworkApplication.vua&&this.gTg.WTk(()=>this.Gq.kKh);this.Gq.i4&&(Cc.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.Gq.i4),this.jU.KVe(this.Gq.i4));this.kJ.s9h(()=>{Cc.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.Gq.i4);this.jU.KVe(this.Gq.i4)})}this.jU.nbi(Object(v.a)(this,this.hfi,"applyUdpLabeling"));this.jU.AUk(Object(v.a)(this,
this.KKj,"isClpBlockedByAppSpecificScenario"));this.jU.x9h(Object(v.a)(this,this.Dei,"applyMandatoryLabeling"));this.jU.GPd(Object(v.a)(this,this.F5g,"onSetLabelSucceeded"));this.XCb=!0}hfi(w,T){T.dil&&Q.AFrameworkApplication.Ta.processAction(Rc.a.openInClient,2)}KKj(){const w=!this.mc.getState(2)&&!this.mc.mkg;this.iTg!==w&&(this.mc.Vqg(),Cc.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",w),this.iTg=w);return w}get Dia(){return this.jU.uu.AppliedPolicyId}OUk(w){this.jU.GPd(w);
this.Aug.add(w)}sEk(w,T,ea){const ra=new Qk;ra.TenantId=this.J0;ra.LabelId=w;ra.ApplyLabelType=T;ra.LabelJson=ba.aZi(X.c(ea));ra.SkipContentMarking=!1;ra.UserName=this.Yma;ra.UserPrincipalName=this.uik;ra.DocLocation=this.q7j;Cc.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.ia.La(Rc.a.qah,2,ra)}Dei(w,T){if(T&&0!==T.xQd){(w=1===T.xQd)?this.Kv.Hzh():(this.Kv.Ezh(),""!==T.DXg&&this.gTg.Eei(T.DXg));T=w?1:3;var ea=Q.AFrameworkApplication.Ta.mode;T!==ea?Cc.a.J(512263625,
822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",T,ea):this.ICg=w}else Cc.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}F5g(w,T){this.sEk(T.P$g,T.V7,this.jU.uu);Cc.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}B2d(w){w&&this.Dia?w=this.Dia.toLowerCase()===w.toLowerCase():(Cc.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!w,!this.Dia),w=w===this.Dia);Cc.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",w);return w}nFk(w){const T=Object(y.a)(t,w.customData);if(T){var ea=+new Date-+T.startTime;Cc.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",ea);this.B2d(T.aIb)||ea>this.Rze||T.aIb!==this.o4c?(Cc.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.B2d(T.aIb),ea>this.Rze,T.aIb!==this.o4c),
this.zb.Lg(w)):(Cc.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.jU.JSa(T.aIb,void 0,ba.NPa,!0))}else Cc.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.zb.Lg(w)}yrl(w){Cc.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const T=new Kd.a(2,2,this.sKg,Object(v.a)(this,this.nFk,"pollingTaskCallback"),90,"113");T.customData=Object.assign(new t,{startTime:new Date,aIb:w});this.zb.Db(T)}Jsk(w,T){Cc.a.J(512263616,
822,50,"OnDocumentContentPolicyChanged: Notification received");T.Dia||Cc.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.o4c=T.Dia;this.B2d(this.o4c)?Cc.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.yrl(T.Dia)}static NPa(){const w=tf.App.Ih.amIAlone,T=tf.App.Ih.NPa;let ea=!1;const ra=Object(y.a)(No.a,tf.App.Ih);ra&&(ea=ra.lfi());Cc.a.J(512263585,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",
w,T,ea);return w||T&&ea}static aZi(w){w=w.replace(RegExp(":null","gi"),':""');return w=w.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(n.a)(ba,"PptPolicyManager",null,[106]);class ua{constructor(w,T,ea,ra){this.n5j=w;this.oc=T;this.Jb=ea;this.la=ra}wb(){this.n5j.ra(Rc.a.qah,yg.a.application,Object(v.a)(this,this.uqj,"handleApplySensitivity"),4)}Ee(){}uqj(w,T,ea,ra,wa){if(!(Q.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&Q.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&
this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&Q.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(T.contextId!==yg.a.application)return 2;if(!wa||!Object(eg.a)(Qk,wa))return 8;w=Object(y.a)(Qk,wa);if(S.a.Wa(w.TenantId))return Cc.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(S.a.Wa(w.LabelJson))return Cc.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===ea)return 32;ea=this.oc.Ym;T=this.Jb.Ad(7);
try{T.nc(ea),ea.bIb=w}finally{T&&T.dispose()}return 32}}Object(n.a)(ua,"SetPolicyActor",null,[352]);class Ra{constructor(){this.Rbc=this.B9c=this.Pb=this.hGa=this.K=null;this.SQg=!0}get name(){return"PowerPointWebEditor.Policy"}Zb(w){this.K=w;this.K.register(405,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().oa(()=>new ep(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.Pb=
this.K.resolve("Common.IAppSettingsManager");this.Pb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.Pb.Qyb(Object(v.a)(this,this.Pm,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").gf(Object(v.a)(this,this.Pm,"onFullAppSettingsReady"))}dispose(){}Pm(){if(this.Pb.ka("WacLabelingPoliciesIsEnabled")&&this.Pb.ka("SupportsPolicies")&&this.Pb.ka("890"))this.hGa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),
Dm.a.get_instance().ek(10,Object(v.a)(this,this.tqk,"onAfterRibbonDisplayed")),Lo.a.$u(this.K.Ja("Common.App.Policy.Contracts.IPolicyManager")).continueWith(w=>{const T=new ua(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));w=w.result;this.B9c=new ba(this.K.resolve("Common.IActionManagerExtended"),T,w,this.Pb.Ga("TenantId"),
this.K.Ja("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.B9c.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").fjb){const w=
this.K.resolve("PowerPointWebEditor.IPPTRumTracker");w.aaa(w.Y5,w.Woh)}}tqk(){Lo.a.$u(this.K.Ja("Common.App.Policy.Contracts.IPolicyManager")).continueWith(w=>{const T=w.result;Q.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(Cc.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.Rbc=new kc.a(()=>new yp(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),T,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.Pb.Ga("TenantId"))),T.d9h(Object(v.a)(this,this.sTk,"registerAutoClpAnnotationEventHandler")),Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(T.O8h(Object(v.a)(this,this.lLc,"createAutoCLPSecurityNodes")),T.qbi(Object(v.a)(this,this.oCl,"updateAutoCLPLabelPriorityNode")),T.rbi(Object(v.a)(this,this.pCl,"updateAutoCLPSITNodes"))));(w=this.Pb.Ga("AppliedPolicyId"))||Q.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&Q.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?
Q.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?T.JSa(w,void 0,ba.NPa):T.JSa(w):(w=this.Pb.Ga("TenantId"),S.a.Wa(w)?Cc.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Cc.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.hGa.DZf(w,(ea,ra)=>{ra&&Cc.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+ra);S.a.Wa(ea)&&(ea="",Cc.a.J(512274580,822,50,
"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));Q.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?T.JSa(ea,void 0,ba.NPa):T.JSa(ea)}),this.hGa.Paj(w,(ea,ra)=>{ra?Cc.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+ra):this.hGa.b$b=ea}),this.B9c.OUk(Object(v.a)(this,this.bEl,"updateIsManuallyApplied"))))})}sTk(){const w=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");
this.SQg&&(w.Gn||this.B9c.ICg&&w.z$b)&&(this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(T=>{Cc.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?(T.pia("AugLoop_SecurityClp_LabellingAnnotation"),T.kKa("AugLoop_SecurityClp_LabellingAnnotation",Object(v.a)(this.Rbc.value,this.Rbc.value.s_,"handleAnnotationEvent"))):
(T.pia("AugLoop_Automatic_Clp_LabellingAnnotation"),T.kKa("AugLoop_Automatic_Clp_LabellingAnnotation",Object(v.a)(this.Rbc.value,this.Rbc.value.s_,"handleAnnotationEvent")))}),this.SQg=!1)}lLc(w,T){w=[Object.assign(new Rn.a,{id:"clp",body:Object.assign(new em,{existingLabelPriority:T.existingLabelPriority,partialDocSITs:T.jGf,fullDocSITs:T.iGf})})];const ea=Object.assign(new Nj.a,{parentPath:["session","doc","security"],items:w});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ra=>
{Cc.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");ra.submitOperation(ea)})}oCl(w,T){w=[Object.assign(new Rn.a,{id:"clp",body:Object.assign(new em,{existingLabelPriority:T.existingLabelPriority})})];const ea=Object.assign(new mn.a,{parentPath:["session","doc","security"],items:w});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ra=>{Cc.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");
ra.submitOperation(ea)})}pCl(w,T){w=[Object.assign(new Rn.a,{id:"clp",body:Object.assign(new em,{partialDocSITs:T.jGf,fullDocSITs:T.iGf})})];const ea=Object.assign(new mn.a,{parentPath:["session","doc","security"],items:w});this.K.Ja("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ra=>{Cc.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");ra.submitOperation(ea)})}bEl(w,T){T&&(this.hGa.b$b=T.P$g&&0!==T.V7?2===T.V7||8===T.V7||16===
T.V7?!0:!1:!1)}static main(){oa.a.instance.Dc(new Ra)}}Object(n.a)(Ra,"PPTWebEditorPolicyPackage",null,[2,3]);var jb=d(12);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Object(jb.c)("Chronosslim");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
Xa.main();Type.registerNamespace("Common.App.CatchUpActivity");Ab.main();Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.Rename");oa.a.instance.Dc(new La,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");oa.a.instance.Dc(new Od);Type.registerNamespace("Common.App.SafeLinks");Cf.main();Ac.main();Fk.main();el.main();kf.main();th.main();ne.main();oa.a.instance.Dc(new Eo);Mi.main();oa.a.instance.Dc(new pm);Dn.main();Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");po.main();Ra.main();Object(jb.b)("Chronosslim")},212:function(I,Y,d){I=d(0);var h=d(57);class e{constructor(z,B,v,y,A){this.bHa=!1;this.FCb=z;this.MBb=B;this.Ybc=v;this.B$j=A;this.ZDb=y.kEa(v,B.name)}get UAf(){return this.Ybc}Zb(z){this.ZDb.lzf();this.MBb.Zb(z);this.ZDb.DRf()}init(){this.ZDb.zu(this.MBb.name+"_d");this.B$j?this.FCb.mDj(this,this.Ybc):this.FCb.lDj(this,this.Ybc)}kDj(){this.ZDb.Fu(this.MBb.name+
"_d");this.ZDb.nzf();this.MBb.init();this.bHa=!0;this.ZDb.GRf()}dispose(){this.bHa&&this.MBb.dispose()}get name(){return this.MBb.name}}Object(I.a)(e,"DelayLoadedPackage",null,[589,2,3]);class n{constructor(z,B){this.FCb=null;z.execute(v=>{this.FCb=v});this.b6j=B}create(z,B,v){return this.FCb?new e(this.FCb,z,B,this.b6j.value,v):z}static get instance(){return n.Ka||(n.Ka=new n(h.a.instance.Ja("PowerPointWebEditor.DelayLoadedPackageInitializer"),h.a.instance.ie("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}
n.Ka=null;Object(I.a)(n,"DelayLoadedPackageFactory",null,[]);d.d(Y,"a",function(){return m});const m=(z,B)=>n.instance.create(z,B,!1)},237:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=
e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}Px(){return!0}static aub(e,n){return e+(n?"Rtl":"")}}Object(I.a)(h,"BasePresenceControl",d.a,[106,484])},238:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h extends Sys.EventArgs{constructor(e,
n){super();this.type=e;this.Xi=n}}h.kp="InteractivityChanged";Object(I.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,[])},280:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);var h=d(1019);class e{constructor(n){this.kl=new h.a;this.sYa=n}ZG(n){const m=n.id;let z=null;this.kl.Hb(m)?z=this.kl.ga(m):(this.sYa&&(z=this.sYa(n,()=>{this.loc(m)})),z&&this.kl.$(m,z));return z}IF(n){n=n.id;return this.kl.Hb(n)?this.kl.ga(n):null}loc(n){this.kl.remove(n)}}Object(I.a)(e,"ShapeComponentViewManager",
null,[397])},447:function(I,Y,d){d.d(Y,"a",function(){return z});I=d(0);var h=d(67),e=d(14),n=d(330),m=d(116);class z{constructor(B,v,y,A,E,u,J,G,S,P,Q,D){this.h_b=1;this.bU=v;this.hi=B;this.Bqe=y;this.Le=S;this.qp=P;this.Zc=Q;this.hIa=G;this.FHa=E;this.GHa=A;this.AO=u;this.Le.addCssClass(this.hi,"prControl");this.hi.style.width=this.Le.Pc(v);this.Kr=J.$Kf();this.PGa=J.ZKf();this.Kr.Sia(B);this.PGa.Sia(B,v,v);this.HXa=D;this.Zna()}dispose(){this.cuc();this.clear();this.Kr.dispose();this.PGa.dispose();
this.Le.removeCssClass(this.hi,"prControl")}get Dfa(){return m.a.none}clear(){this.Ura();this.qtb();this.FKb()}setZIndex(B){this.hi.style.zIndex=String(B)}Jic(){this.HXa.xa.style.zIndex=String(this.h_b+n.a.jba)}FKb(){this.HXa.xa.style.zIndex="0"}God(B,v,y=null){B=this.hIa.MXd(this.bU,this.bU,this.Bqe,B,"",y);this.Kr.Eoa(B,v)}Z5a(B,v){this.PGa.add(B,v)}qtb(){this.PGa.clear()}Ura(){this.Kr.clear()}onClick(){return!0}Zna(){this.GHa&&this.qp.pb(h.a.pointerOver,this.hi,this.GHa);this.FHa&&this.qp.pb(h.a.pointerOut,
this.hi,this.FHa);this.AO?this.Zc.pb(h.a.click,this.hi,this.AO):this.Zc.pb(h.a.click,this.hi,Object(e.a)(this,this.onClick,"onClick"));this.Zc.pb(h.a.doubleClick,this.hi,Object(e.a)(this,this.onClick,"onClick"))}cuc(){this.GHa&&this.qp.yb(h.a.pointerOver,this.hi,this.GHa);this.FHa&&this.qp.yb(h.a.pointerOut,this.hi,this.FHa);this.AO?this.Zc.yb(h.a.click,this.hi,this.AO):this.Zc.yb(h.a.click,this.hi,Object(e.a)(this,this.onClick,"onClick"));this.Zc.yb(h.a.doubleClick,this.hi,Object(e.a)(this,this.onClick,
"onClick"))}}Object(I.a)(z,"ShapePawn",null,[398])},689:function(I,Y,d){d.d(Y,"a",function(){return y});I=d(0);var h=d(1200),e=d(14),n=d(104),m=d(37),z=d(28),B=d(447),v=d(116);class y{constructor(A,E,u,J,G,S){this.w4a=this.GGa=null;this.kr=Object(h.a)(B.a,J.tYd(A,E,u,Object(e.a)(this,this.cD,"onPointerOver"),Object(e.a)(this,this.yz,"onPointerOut"),G));this.MHa=0;this.Oc=S;this.Oc.KA(Object(e.a)(this,this.DB,"onSessionEnd"));this.clear()}dispose(){this.kr.dispose();this.GGa=null}get Dfa(){return this.w4a}setZIndex(A){this.kr.setZIndex(A)}ntf(A,
E,u){this.w4a=A;this.GGa=E;this.kr.God("UnreadNotification_16x16x32",this.Dfa,u)}clear(){this.kr.clear();this.w4a=v.a.none}Nya(){this.t_();this.kr.Z5a(this.Dfa,this.w2b);this.kr.Jic()}t_(){this.kr.qtb();this.kr.FKb()}DB(){z.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.MHa);0<this.MHa&&n.c(m.a.nUd)}get w2b(){return this.GGa?this.GGa():""}cD(){this.Nya();z.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.MHa+=1;return!0}yz(){this.t_();return!0}}Object(I.a)(y,
"ShapeRevisionTrackingPawn",null,[398])},690:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(e,n,m,z,B,v,y,A=null,E=null,u=!1,J=null,G=null,S=null,P=null,Q=!1,D=null,O=null,X=null,N=null,aa=null,V=null){this.url=e;this.uIl=n;this.body=m;this.headers=z;this.UXe=B;this.priority=v;this.state=y;this.zJh=A;this.Koc=E;this.Oi=u;this.ZMk=J;this.z8k=G;this.name=S;this.ehb=P;this.A4d=Q;this.Ngd=D;this.Vy=O;this.Ryb=X;this.CKb=N;this.Fzj=aa;this.responseType=V}}Object(I.a)(h,"ClientRequest",
null,[])},691:function(I,Y,d){d.d(Y,"a",function(){return e});I=d(0);Y=d(518);var h=d(143);class e extends Y.a{constructor(){super();this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(I.a)(e,"UpdateOperation",Y.a,[])},732:function(I,Y,d){I=d(0);var h=d(27),e=d(106),n=d(81),m=d(14),z=d(36),B=d(87),v=d(28),y=d(260);class A{constructor(){this.TenantId=this.LoggableUserId=
this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(I.a)(A,"PodsInfo",null,[]);d.d(Y,"a",function(){return E});class E{constructor(u,J,G,S,P,Q,D){v.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Pb=D;this.Ds=u;this.Xa=J;this.Oc=G;this.pz=S;this.Rd=P;this.zb=Q;this.XCb=
!1;this.GXa=0;this.Pb.gf(Object(m.a)(this,this.initialize,"initialize"))}initialize(){v.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.Oc.fC(Object(m.a)(this,this.Do,"onSessionRehydrated"));this.pz.frb(Object(m.a)(this,this.vfa,"onPodSessionRefreshed"));this.XCb=!0}dispose(){this.XCb&&(this.Oc.Sfa(Object(m.a)(this,this.Do,"onSessionRehydrated")),this.pz.Fib(Object(m.a)(this,this.vfa,"onPodSessionRefreshed")),this.XCb=!1)}sendInfoToPods(){var u=this.Pb.Ga("361"),
J=this.Xa.podSessionId;const G=this.Xa.pk,S=h.AFrameworkApplication.userSessionId,P=e.a.create().toString();v.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",P);u=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",u,J);J={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};J["X-UserSessionId"]=S;J["X-CorrelationID"]=P;J["X-WacCluster"]=G;try{const Q=Object.assign(new A,{UserName:this.Pb.Ga(B.a.cCk),UserId:this.Pb.Ga("387"),
ProviderId:this.Pb.Ga("388"),FileSource:this.Pb.Ga("FileSource"),LoggableUserId:this.Pb.Ga("LoggableUserId"),TenantId:this.Pb.Ga("TenantId"),BrowserCacheAllowed:this.Pb.ka("535")&&this.Pb.ka("431"),EnableMacrosForProtectedFile:h.AFrameworkApplication.l3b,ServerDocId:this.Pb.Ga("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ga("ComplianceDomainPrefix"),IsO365CommercialHost:this.Pb.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.Pb.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Pb.ka("PPTClpSwitchEnabled")&&
this.Pb.ka("SupportsOfficeClientCoauthoring")}),D=z.c(Q);this.Ds.mj(u,2,D,J,!1,1,Object(m.a)(this,this.uxk,"onSendUserInfoSucceeded"),Object(m.a)(this,this.txk,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,y.a("6"))}catch(Q){v.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",Q)}}uxk(){v.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.GXa=0}txk(){v.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.GXa?this.m3k():this.ipj()}m3k(){this.GXa++;
v.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.GXa);const u=new n.a(1,1,5E3,Object(m.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.zb.Db(u)}ipj(){v.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.GXa);this.Rd.cH(307,null);this.GXa=0}Do(){this.GXa=0;v.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}vfa(){this.GXa=0;v.a.J(512262864,
804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(I.a)(E,"PodsInfoSender",null,[])},972:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.message=this.title=null;this.tbg=!1;this.MIb=null;this.ybg=!1;this.ind=null;this.A6k=this.qJk=0;this.B6k=this.rJk=null;this.timeoutInSeconds=0}}Object(I.a)(h,"CalloutNotificationMessageAttributes",null,[])},973:function(I,Y,d){d.d(Y,"a",function(){return h});I=d(0);class h{constructor(){this.handler=
null}}Object(I.a)(h,"SetAnnotationResultCallbackParameters",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/18831228/wdjs/ppteditDS.chronosslim.js.map